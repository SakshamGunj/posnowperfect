var OH=Object.defineProperty;var UH=(t,e,r)=>e in t?OH(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var Or=(t,e,r)=>UH(t,typeof e!="symbol"?e+"":e,r);function MH(t,e){for(var r=0;r<e.length;r++){const s=e[r];if(typeof s!="string"&&!Array.isArray(s)){for(const n in s)if(n!=="default"&&!(n in t)){const i=Object.getOwnPropertyDescriptor(s,n);i&&Object.defineProperty(t,n,i.get?i:{enumerable:!0,get:()=>s[n]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function r(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(n){if(n.ep)return;n.ep=!0;const i=r(n);fetch(n.href,i)}})();var QH=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function bD(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var wD={exports:{}},N2={},ND={exports:{}},ss={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ty=Symbol.for("react.element"),VH=Symbol.for("react.portal"),HH=Symbol.for("react.fragment"),$H=Symbol.for("react.strict_mode"),KH=Symbol.for("react.profiler"),zH=Symbol.for("react.provider"),qH=Symbol.for("react.context"),WH=Symbol.for("react.forward_ref"),GH=Symbol.for("react.suspense"),YH=Symbol.for("react.memo"),XH=Symbol.for("react.lazy"),VT=Symbol.iterator;function JH(t){return t===null||typeof t!="object"?null:(t=VT&&t[VT]||t["@@iterator"],typeof t=="function"?t:null)}var CD={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},jD=Object.assign,SD={};function Cp(t,e,r){this.props=t,this.context=e,this.refs=SD,this.updater=r||CD}Cp.prototype.isReactComponent={};Cp.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Cp.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function ED(){}ED.prototype=Cp.prototype;function zS(t,e,r){this.props=t,this.context=e,this.refs=SD,this.updater=r||CD}var qS=zS.prototype=new ED;qS.constructor=zS;jD(qS,Cp.prototype);qS.isPureReactComponent=!0;var HT=Array.isArray,_D=Object.prototype.hasOwnProperty,WS={current:null},TD={key:!0,ref:!0,__self:!0,__source:!0};function ID(t,e,r){var s,n={},i=null,o=null;if(e!=null)for(s in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)_D.call(e,s)&&!TD.hasOwnProperty(s)&&(n[s]=e[s]);var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];n.children=c}if(t&&t.defaultProps)for(s in l=t.defaultProps,l)n[s]===void 0&&(n[s]=l[s]);return{$$typeof:Ty,type:t,key:i,ref:o,props:n,_owner:WS.current}}function ZH(t,e){return{$$typeof:Ty,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function GS(t){return typeof t=="object"&&t!==null&&t.$$typeof===Ty}function e$(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var $T=/\/+/g;function o5(t,e){return typeof t=="object"&&t!==null&&t.key!=null?e$(""+t.key):e.toString(36)}function ib(t,e,r,s,n){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Ty:case VH:o=!0}}if(o)return o=t,n=n(o),t=s===""?"."+o5(o,0):s,HT(n)?(r="",t!=null&&(r=t.replace($T,"$&/")+"/"),ib(n,e,r,"",function(d){return d})):n!=null&&(GS(n)&&(n=ZH(n,r+(!n.key||o&&o.key===n.key?"":(""+n.key).replace($T,"$&/")+"/")+t)),e.push(n)),1;if(o=0,s=s===""?".":s+":",HT(t))for(var l=0;l<t.length;l++){i=t[l];var c=s+o5(i,l);o+=ib(i,e,r,c,n)}else if(c=JH(t),typeof c=="function")for(t=c.call(t),l=0;!(i=t.next()).done;)i=i.value,c=s+o5(i,l++),o+=ib(i,e,r,c,n);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Ov(t,e,r){if(t==null)return t;var s=[],n=0;return ib(t,s,"","",function(i){return e.call(r,i,n++)}),s}function t$(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var to={current:null},ob={transition:null},r$={ReactCurrentDispatcher:to,ReactCurrentBatchConfig:ob,ReactCurrentOwner:WS};function kD(){throw Error("act(...) is not supported in production builds of React.")}ss.Children={map:Ov,forEach:function(t,e,r){Ov(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return Ov(t,function(){e++}),e},toArray:function(t){return Ov(t,function(e){return e})||[]},only:function(t){if(!GS(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};ss.Component=Cp;ss.Fragment=HH;ss.Profiler=KH;ss.PureComponent=zS;ss.StrictMode=$H;ss.Suspense=GH;ss.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=r$;ss.act=kD;ss.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var s=jD({},t.props),n=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=WS.current),e.key!==void 0&&(n=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)_D.call(e,c)&&!TD.hasOwnProperty(c)&&(s[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)s.children=r;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];s.children=l}return{$$typeof:Ty,type:t.type,key:n,ref:i,props:s,_owner:o}};ss.createContext=function(t){return t={$$typeof:qH,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:zH,_context:t},t.Consumer=t};ss.createElement=ID;ss.createFactory=function(t){var e=ID.bind(null,t);return e.type=t,e};ss.createRef=function(){return{current:null}};ss.forwardRef=function(t){return{$$typeof:WH,render:t}};ss.isValidElement=GS;ss.lazy=function(t){return{$$typeof:XH,_payload:{_status:-1,_result:t},_init:t$}};ss.memo=function(t,e){return{$$typeof:YH,type:t,compare:e===void 0?null:e}};ss.startTransition=function(t){var e=ob.transition;ob.transition={};try{t()}finally{ob.transition=e}};ss.unstable_act=kD;ss.useCallback=function(t,e){return to.current.useCallback(t,e)};ss.useContext=function(t){return to.current.useContext(t)};ss.useDebugValue=function(){};ss.useDeferredValue=function(t){return to.current.useDeferredValue(t)};ss.useEffect=function(t,e){return to.current.useEffect(t,e)};ss.useId=function(){return to.current.useId()};ss.useImperativeHandle=function(t,e,r){return to.current.useImperativeHandle(t,e,r)};ss.useInsertionEffect=function(t,e){return to.current.useInsertionEffect(t,e)};ss.useLayoutEffect=function(t,e){return to.current.useLayoutEffect(t,e)};ss.useMemo=function(t,e){return to.current.useMemo(t,e)};ss.useReducer=function(t,e,r){return to.current.useReducer(t,e,r)};ss.useRef=function(t){return to.current.useRef(t)};ss.useState=function(t){return to.current.useState(t)};ss.useSyncExternalStore=function(t,e,r){return to.current.useSyncExternalStore(t,e,r)};ss.useTransition=function(){return to.current.useTransition()};ss.version="18.3.1";ND.exports=ss;var R=ND.exports;const bi=bD(R),s$=MH({__proto__:null,default:bi},[R]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n$=R,a$=Symbol.for("react.element"),i$=Symbol.for("react.fragment"),o$=Object.prototype.hasOwnProperty,l$=n$.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c$={key:!0,ref:!0,__self:!0,__source:!0};function BD(t,e,r){var s,n={},i=null,o=null;r!==void 0&&(i=""+r),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(s in e)o$.call(e,s)&&!c$.hasOwnProperty(s)&&(n[s]=e[s]);if(t&&t.defaultProps)for(s in e=t.defaultProps,e)n[s]===void 0&&(n[s]=e[s]);return{$$typeof:a$,type:t,key:i,ref:o,props:n,_owner:l$.current}}N2.Fragment=i$;N2.jsx=BD;N2.jsxs=BD;wD.exports=N2;var a=wD.exports,JC={},FD={exports:{}},el={},PD={exports:{}},DD={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(re,G){var Ae=re.length;re.push(G);e:for(;0<Ae;){var he=Ae-1>>>1,I=re[he];if(0<n(I,G))re[he]=G,re[Ae]=I,Ae=he;else break e}}function r(re){return re.length===0?null:re[0]}function s(re){if(re.length===0)return null;var G=re[0],Ae=re.pop();if(Ae!==G){re[0]=Ae;e:for(var he=0,I=re.length,U=I>>>1;he<U;){var V=2*(he+1)-1,L=re[V],K=V+1,fe=re[K];if(0>n(L,Ae))K<I&&0>n(fe,L)?(re[he]=fe,re[K]=Ae,he=K):(re[he]=L,re[V]=Ae,he=V);else if(K<I&&0>n(fe,Ae))re[he]=fe,re[K]=Ae,he=K;else break e}}return G}function n(re,G){var Ae=re.sortIndex-G.sortIndex;return Ae!==0?Ae:re.id-G.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],d=[],u=1,A=null,h=3,f=!1,p=!1,m=!1,g=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x(re){for(var G=r(d);G!==null;){if(G.callback===null)s(d);else if(G.startTime<=re)s(d),G.sortIndex=G.expirationTime,e(c,G);else break;G=r(d)}}function E(re){if(m=!1,x(re),!p)if(r(c)!==null)p=!0,W(T);else{var G=r(d);G!==null&&Q(E,G.startTime-re)}}function T(re,G){p=!1,m&&(m=!1,y(w),w=-1),f=!0;var Ae=h;try{for(x(G),A=r(c);A!==null&&(!(A.expirationTime>G)||re&&!B());){var he=A.callback;if(typeof he=="function"){A.callback=null,h=A.priorityLevel;var I=he(A.expirationTime<=G);G=t.unstable_now(),typeof I=="function"?A.callback=I:A===r(c)&&s(c),x(G)}else s(c);A=r(c)}if(A!==null)var U=!0;else{var V=r(d);V!==null&&Q(E,V.startTime-G),U=!1}return U}finally{A=null,h=Ae,f=!1}}var j=!1,C=null,w=-1,S=5,F=-1;function B(){return!(t.unstable_now()-F<S)}function k(){if(C!==null){var re=t.unstable_now();F=re;var G=!0;try{G=C(!0,re)}finally{G?D():(j=!1,C=null)}}else j=!1}var D;if(typeof v=="function")D=function(){v(k)};else if(typeof MessageChannel<"u"){var q=new MessageChannel,te=q.port2;q.port1.onmessage=k,D=function(){te.postMessage(null)}}else D=function(){g(k,0)};function W(re){C=re,j||(j=!0,D())}function Q(re,G){w=g(function(){re(t.unstable_now())},G)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(re){re.callback=null},t.unstable_continueExecution=function(){p||f||(p=!0,W(T))},t.unstable_forceFrameRate=function(re){0>re||125<re?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):S=0<re?Math.floor(1e3/re):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(re){switch(h){case 1:case 2:case 3:var G=3;break;default:G=h}var Ae=h;h=G;try{return re()}finally{h=Ae}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(re,G){switch(re){case 1:case 2:case 3:case 4:case 5:break;default:re=3}var Ae=h;h=re;try{return G()}finally{h=Ae}},t.unstable_scheduleCallback=function(re,G,Ae){var he=t.unstable_now();switch(typeof Ae=="object"&&Ae!==null?(Ae=Ae.delay,Ae=typeof Ae=="number"&&0<Ae?he+Ae:he):Ae=he,re){case 1:var I=-1;break;case 2:I=250;break;case 5:I=1073741823;break;case 4:I=1e4;break;default:I=5e3}return I=Ae+I,re={id:u++,callback:G,priorityLevel:re,startTime:Ae,expirationTime:I,sortIndex:-1},Ae>he?(re.sortIndex=Ae,e(d,re),r(c)===null&&re===r(d)&&(m?(y(w),w=-1):m=!0,Q(E,Ae-he))):(re.sortIndex=I,e(c,re),p||f||(p=!0,W(T))),re},t.unstable_shouldYield=B,t.unstable_wrapCallback=function(re){var G=h;return function(){var Ae=h;h=G;try{return re.apply(this,arguments)}finally{h=Ae}}}})(DD);PD.exports=DD;var d$=PD.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var u$=R,Yo=d$;function Wt(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var RD=new Set,Bx={};function qf(t,e){W0(t,e),W0(t+"Capture",e)}function W0(t,e){for(Bx[t]=e,t=0;t<e.length;t++)RD.add(e[t])}var Yd=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ZC=Object.prototype.hasOwnProperty,A$=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,KT={},zT={};function h$(t){return ZC.call(zT,t)?!0:ZC.call(KT,t)?!1:A$.test(t)?zT[t]=!0:(KT[t]=!0,!1)}function f$(t,e,r,s){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return s?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function m$(t,e,r,s){if(e===null||typeof e>"u"||f$(t,e,r,s))return!0;if(s)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function ro(t,e,r,s,n,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=s,this.attributeNamespace=n,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var ii={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){ii[t]=new ro(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];ii[e]=new ro(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){ii[t]=new ro(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){ii[t]=new ro(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){ii[t]=new ro(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){ii[t]=new ro(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){ii[t]=new ro(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){ii[t]=new ro(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){ii[t]=new ro(t,5,!1,t.toLowerCase(),null,!1,!1)});var YS=/[\-:]([a-z])/g;function XS(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(YS,XS);ii[e]=new ro(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(YS,XS);ii[e]=new ro(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(YS,XS);ii[e]=new ro(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){ii[t]=new ro(t,1,!1,t.toLowerCase(),null,!1,!1)});ii.xlinkHref=new ro("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){ii[t]=new ro(t,1,!1,t.toLowerCase(),null,!0,!0)});function JS(t,e,r,s){var n=ii.hasOwnProperty(e)?ii[e]:null;(n!==null?n.type!==0:s||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(m$(e,r,n,s)&&(r=null),s||n===null?h$(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):n.mustUseProperty?t[n.propertyName]=r===null?n.type===3?!1:"":r:(e=n.attributeName,s=n.attributeNamespace,r===null?t.removeAttribute(e):(n=n.type,r=n===3||n===4&&r===!0?"":""+r,s?t.setAttributeNS(s,e,r):t.setAttribute(e,r))))}var cu=u$.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Uv=Symbol.for("react.element"),i0=Symbol.for("react.portal"),o0=Symbol.for("react.fragment"),ZS=Symbol.for("react.strict_mode"),e4=Symbol.for("react.profiler"),LD=Symbol.for("react.provider"),OD=Symbol.for("react.context"),eE=Symbol.for("react.forward_ref"),t4=Symbol.for("react.suspense"),r4=Symbol.for("react.suspense_list"),tE=Symbol.for("react.memo"),Zu=Symbol.for("react.lazy"),UD=Symbol.for("react.offscreen"),qT=Symbol.iterator;function ag(t){return t===null||typeof t!="object"?null:(t=qT&&t[qT]||t["@@iterator"],typeof t=="function"?t:null)}var Tn=Object.assign,l5;function Eg(t){if(l5===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);l5=e&&e[1]||""}return`
`+l5+t}var c5=!1;function d5(t,e){if(!t||c5)return"";c5=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var s=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){s=d}t.call(e.prototype)}else{try{throw Error()}catch(d){s=d}t()}}catch(d){if(d&&s&&typeof d.stack=="string"){for(var n=d.stack.split(`
`),i=s.stack.split(`
`),o=n.length-1,l=i.length-1;1<=o&&0<=l&&n[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(n[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||n[o]!==i[l]){var c=`
`+n[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=l);break}}}finally{c5=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?Eg(t):""}function p$(t){switch(t.tag){case 5:return Eg(t.type);case 16:return Eg("Lazy");case 13:return Eg("Suspense");case 19:return Eg("SuspenseList");case 0:case 2:case 15:return t=d5(t.type,!1),t;case 11:return t=d5(t.type.render,!1),t;case 1:return t=d5(t.type,!0),t;default:return""}}function s4(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case o0:return"Fragment";case i0:return"Portal";case e4:return"Profiler";case ZS:return"StrictMode";case t4:return"Suspense";case r4:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case OD:return(t.displayName||"Context")+".Consumer";case LD:return(t._context.displayName||"Context")+".Provider";case eE:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case tE:return e=t.displayName||null,e!==null?e:s4(t.type)||"Memo";case Zu:e=t._payload,t=t._init;try{return s4(t(e))}catch{}}return null}function g$(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return s4(e);case 8:return e===ZS?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function VA(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function MD(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function x$(t){var e=MD(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),s=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var n=r.get,i=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return n.call(this)},set:function(o){s=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return s},setValue:function(o){s=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Mv(t){t._valueTracker||(t._valueTracker=x$(t))}function QD(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),s="";return t&&(s=MD(t)?t.checked?"true":"false":t.value),t=s,t!==r?(e.setValue(t),!0):!1}function Hb(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function n4(t,e){var r=e.checked;return Tn({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function WT(t,e){var r=e.defaultValue==null?"":e.defaultValue,s=e.checked!=null?e.checked:e.defaultChecked;r=VA(e.value!=null?e.value:r),t._wrapperState={initialChecked:s,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function VD(t,e){e=e.checked,e!=null&&JS(t,"checked",e,!1)}function a4(t,e){VD(t,e);var r=VA(e.value),s=e.type;if(r!=null)s==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(s==="submit"||s==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?i4(t,e.type,r):e.hasOwnProperty("defaultValue")&&i4(t,e.type,VA(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function GT(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var s=e.type;if(!(s!=="submit"&&s!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function i4(t,e,r){(e!=="number"||Hb(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var _g=Array.isArray;function C0(t,e,r,s){if(t=t.options,e){e={};for(var n=0;n<r.length;n++)e["$"+r[n]]=!0;for(r=0;r<t.length;r++)n=e.hasOwnProperty("$"+t[r].value),t[r].selected!==n&&(t[r].selected=n),n&&s&&(t[r].defaultSelected=!0)}else{for(r=""+VA(r),e=null,n=0;n<t.length;n++){if(t[n].value===r){t[n].selected=!0,s&&(t[n].defaultSelected=!0);return}e!==null||t[n].disabled||(e=t[n])}e!==null&&(e.selected=!0)}}function o4(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Wt(91));return Tn({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function YT(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(Wt(92));if(_g(r)){if(1<r.length)throw Error(Wt(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:VA(r)}}function HD(t,e){var r=VA(e.value),s=VA(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),s!=null&&(t.defaultValue=""+s)}function XT(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function $D(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function l4(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?$D(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Qv,KD=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,s,n){MSApp.execUnsafeLocalFunction(function(){return t(e,r,s,n)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Qv=Qv||document.createElement("div"),Qv.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Qv.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Fx(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var Wg={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},y$=["Webkit","ms","Moz","O"];Object.keys(Wg).forEach(function(t){y$.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Wg[e]=Wg[t]})});function zD(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||Wg.hasOwnProperty(t)&&Wg[t]?(""+e).trim():e+"px"}function qD(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var s=r.indexOf("--")===0,n=zD(r,e[r],s);r==="float"&&(r="cssFloat"),s?t.setProperty(r,n):t[r]=n}}var v$=Tn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function c4(t,e){if(e){if(v$[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Wt(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Wt(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Wt(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Wt(62))}}function d4(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var u4=null;function rE(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var A4=null,j0=null,S0=null;function JT(t){if(t=By(t)){if(typeof A4!="function")throw Error(Wt(280));var e=t.stateNode;e&&(e=_2(e),A4(t.stateNode,t.type,e))}}function WD(t){j0?S0?S0.push(t):S0=[t]:j0=t}function GD(){if(j0){var t=j0,e=S0;if(S0=j0=null,JT(t),e)for(t=0;t<e.length;t++)JT(e[t])}}function YD(t,e){return t(e)}function XD(){}var u5=!1;function JD(t,e,r){if(u5)return t(e,r);u5=!0;try{return YD(t,e,r)}finally{u5=!1,(j0!==null||S0!==null)&&(XD(),GD())}}function Px(t,e){var r=t.stateNode;if(r===null)return null;var s=_2(r);if(s===null)return null;r=s[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(t=t.type,s=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!s;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(Wt(231,e,typeof r));return r}var h4=!1;if(Yd)try{var ig={};Object.defineProperty(ig,"passive",{get:function(){h4=!0}}),window.addEventListener("test",ig,ig),window.removeEventListener("test",ig,ig)}catch{h4=!1}function b$(t,e,r,s,n,i,o,l,c){var d=Array.prototype.slice.call(arguments,3);try{e.apply(r,d)}catch(u){this.onError(u)}}var Gg=!1,$b=null,Kb=!1,f4=null,w$={onError:function(t){Gg=!0,$b=t}};function N$(t,e,r,s,n,i,o,l,c){Gg=!1,$b=null,b$.apply(w$,arguments)}function C$(t,e,r,s,n,i,o,l,c){if(N$.apply(this,arguments),Gg){if(Gg){var d=$b;Gg=!1,$b=null}else throw Error(Wt(198));Kb||(Kb=!0,f4=d)}}function Wf(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function ZD(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function ZT(t){if(Wf(t)!==t)throw Error(Wt(188))}function j$(t){var e=t.alternate;if(!e){if(e=Wf(t),e===null)throw Error(Wt(188));return e!==t?null:t}for(var r=t,s=e;;){var n=r.return;if(n===null)break;var i=n.alternate;if(i===null){if(s=n.return,s!==null){r=s;continue}break}if(n.child===i.child){for(i=n.child;i;){if(i===r)return ZT(n),t;if(i===s)return ZT(n),e;i=i.sibling}throw Error(Wt(188))}if(r.return!==s.return)r=n,s=i;else{for(var o=!1,l=n.child;l;){if(l===r){o=!0,r=n,s=i;break}if(l===s){o=!0,s=n,r=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===r){o=!0,r=i,s=n;break}if(l===s){o=!0,s=i,r=n;break}l=l.sibling}if(!o)throw Error(Wt(189))}}if(r.alternate!==s)throw Error(Wt(190))}if(r.tag!==3)throw Error(Wt(188));return r.stateNode.current===r?t:e}function eR(t){return t=j$(t),t!==null?tR(t):null}function tR(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=tR(t);if(e!==null)return e;t=t.sibling}return null}var rR=Yo.unstable_scheduleCallback,eI=Yo.unstable_cancelCallback,S$=Yo.unstable_shouldYield,E$=Yo.unstable_requestPaint,Gn=Yo.unstable_now,_$=Yo.unstable_getCurrentPriorityLevel,sE=Yo.unstable_ImmediatePriority,sR=Yo.unstable_UserBlockingPriority,zb=Yo.unstable_NormalPriority,T$=Yo.unstable_LowPriority,nR=Yo.unstable_IdlePriority,C2=null,zc=null;function I$(t){if(zc&&typeof zc.onCommitFiberRoot=="function")try{zc.onCommitFiberRoot(C2,t,void 0,(t.current.flags&128)===128)}catch{}}var dc=Math.clz32?Math.clz32:F$,k$=Math.log,B$=Math.LN2;function F$(t){return t>>>=0,t===0?32:31-(k$(t)/B$|0)|0}var Vv=64,Hv=4194304;function Tg(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function qb(t,e){var r=t.pendingLanes;if(r===0)return 0;var s=0,n=t.suspendedLanes,i=t.pingedLanes,o=r&268435455;if(o!==0){var l=o&~n;l!==0?s=Tg(l):(i&=o,i!==0&&(s=Tg(i)))}else o=r&~n,o!==0?s=Tg(o):i!==0&&(s=Tg(i));if(s===0)return 0;if(e!==0&&e!==s&&!(e&n)&&(n=s&-s,i=e&-e,n>=i||n===16&&(i&4194240)!==0))return e;if(s&4&&(s|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=s;0<e;)r=31-dc(e),n=1<<r,s|=t[r],e&=~n;return s}function P$(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function D$(t,e){for(var r=t.suspendedLanes,s=t.pingedLanes,n=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-dc(i),l=1<<o,c=n[o];c===-1?(!(l&r)||l&s)&&(n[o]=P$(l,e)):c<=e&&(t.expiredLanes|=l),i&=~l}}function m4(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function aR(){var t=Vv;return Vv<<=1,!(Vv&4194240)&&(Vv=64),t}function A5(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function Iy(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-dc(e),t[e]=r}function R$(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var s=t.eventTimes;for(t=t.expirationTimes;0<r;){var n=31-dc(r),i=1<<n;e[n]=0,s[n]=-1,t[n]=-1,r&=~i}}function nE(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var s=31-dc(r),n=1<<s;n&e|t[s]&e&&(t[s]|=e),r&=~n}}var Ms=0;function iR(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var oR,aE,lR,cR,dR,p4=!1,$v=[],CA=null,jA=null,SA=null,Dx=new Map,Rx=new Map,rA=[],L$="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function tI(t,e){switch(t){case"focusin":case"focusout":CA=null;break;case"dragenter":case"dragleave":jA=null;break;case"mouseover":case"mouseout":SA=null;break;case"pointerover":case"pointerout":Dx.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Rx.delete(e.pointerId)}}function og(t,e,r,s,n,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:r,eventSystemFlags:s,nativeEvent:i,targetContainers:[n]},e!==null&&(e=By(e),e!==null&&aE(e)),t):(t.eventSystemFlags|=s,e=t.targetContainers,n!==null&&e.indexOf(n)===-1&&e.push(n),t)}function O$(t,e,r,s,n){switch(e){case"focusin":return CA=og(CA,t,e,r,s,n),!0;case"dragenter":return jA=og(jA,t,e,r,s,n),!0;case"mouseover":return SA=og(SA,t,e,r,s,n),!0;case"pointerover":var i=n.pointerId;return Dx.set(i,og(Dx.get(i)||null,t,e,r,s,n)),!0;case"gotpointercapture":return i=n.pointerId,Rx.set(i,og(Rx.get(i)||null,t,e,r,s,n)),!0}return!1}function uR(t){var e=Jh(t.target);if(e!==null){var r=Wf(e);if(r!==null){if(e=r.tag,e===13){if(e=ZD(r),e!==null){t.blockedOn=e,dR(t.priority,function(){lR(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function lb(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=g4(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var s=new r.constructor(r.type,r);u4=s,r.target.dispatchEvent(s),u4=null}else return e=By(r),e!==null&&aE(e),t.blockedOn=r,!1;e.shift()}return!0}function rI(t,e,r){lb(t)&&r.delete(e)}function U$(){p4=!1,CA!==null&&lb(CA)&&(CA=null),jA!==null&&lb(jA)&&(jA=null),SA!==null&&lb(SA)&&(SA=null),Dx.forEach(rI),Rx.forEach(rI)}function lg(t,e){t.blockedOn===e&&(t.blockedOn=null,p4||(p4=!0,Yo.unstable_scheduleCallback(Yo.unstable_NormalPriority,U$)))}function Lx(t){function e(n){return lg(n,t)}if(0<$v.length){lg($v[0],t);for(var r=1;r<$v.length;r++){var s=$v[r];s.blockedOn===t&&(s.blockedOn=null)}}for(CA!==null&&lg(CA,t),jA!==null&&lg(jA,t),SA!==null&&lg(SA,t),Dx.forEach(e),Rx.forEach(e),r=0;r<rA.length;r++)s=rA[r],s.blockedOn===t&&(s.blockedOn=null);for(;0<rA.length&&(r=rA[0],r.blockedOn===null);)uR(r),r.blockedOn===null&&rA.shift()}var E0=cu.ReactCurrentBatchConfig,Wb=!0;function M$(t,e,r,s){var n=Ms,i=E0.transition;E0.transition=null;try{Ms=1,iE(t,e,r,s)}finally{Ms=n,E0.transition=i}}function Q$(t,e,r,s){var n=Ms,i=E0.transition;E0.transition=null;try{Ms=4,iE(t,e,r,s)}finally{Ms=n,E0.transition=i}}function iE(t,e,r,s){if(Wb){var n=g4(t,e,r,s);if(n===null)w5(t,e,s,Gb,r),tI(t,s);else if(O$(n,t,e,r,s))s.stopPropagation();else if(tI(t,s),e&4&&-1<L$.indexOf(t)){for(;n!==null;){var i=By(n);if(i!==null&&oR(i),i=g4(t,e,r,s),i===null&&w5(t,e,s,Gb,r),i===n)break;n=i}n!==null&&s.stopPropagation()}else w5(t,e,s,null,r)}}var Gb=null;function g4(t,e,r,s){if(Gb=null,t=rE(s),t=Jh(t),t!==null)if(e=Wf(t),e===null)t=null;else if(r=e.tag,r===13){if(t=ZD(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Gb=t,null}function AR(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(_$()){case sE:return 1;case sR:return 4;case zb:case T$:return 16;case nR:return 536870912;default:return 16}default:return 16}}var AA=null,oE=null,cb=null;function hR(){if(cb)return cb;var t,e=oE,r=e.length,s,n="value"in AA?AA.value:AA.textContent,i=n.length;for(t=0;t<r&&e[t]===n[t];t++);var o=r-t;for(s=1;s<=o&&e[r-s]===n[i-s];s++);return cb=n.slice(t,1<s?1-s:void 0)}function db(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Kv(){return!0}function sI(){return!1}function tl(t){function e(r,s,n,i,o){this._reactName=r,this._targetInst=n,this.type=s,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(r=t[l],this[l]=r?r(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Kv:sI,this.isPropagationStopped=sI,this}return Tn(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Kv)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Kv)},persist:function(){},isPersistent:Kv}),e}var jp={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},lE=tl(jp),ky=Tn({},jp,{view:0,detail:0}),V$=tl(ky),h5,f5,cg,j2=Tn({},ky,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:cE,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==cg&&(cg&&t.type==="mousemove"?(h5=t.screenX-cg.screenX,f5=t.screenY-cg.screenY):f5=h5=0,cg=t),h5)},movementY:function(t){return"movementY"in t?t.movementY:f5}}),nI=tl(j2),H$=Tn({},j2,{dataTransfer:0}),$$=tl(H$),K$=Tn({},ky,{relatedTarget:0}),m5=tl(K$),z$=Tn({},jp,{animationName:0,elapsedTime:0,pseudoElement:0}),q$=tl(z$),W$=Tn({},jp,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),G$=tl(W$),Y$=Tn({},jp,{data:0}),aI=tl(Y$),X$={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},J$={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Z$={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function eK(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=Z$[t])?!!e[t]:!1}function cE(){return eK}var tK=Tn({},ky,{key:function(t){if(t.key){var e=X$[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=db(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?J$[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:cE,charCode:function(t){return t.type==="keypress"?db(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?db(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),rK=tl(tK),sK=Tn({},j2,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),iI=tl(sK),nK=Tn({},ky,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:cE}),aK=tl(nK),iK=Tn({},jp,{propertyName:0,elapsedTime:0,pseudoElement:0}),oK=tl(iK),lK=Tn({},j2,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),cK=tl(lK),dK=[9,13,27,32],dE=Yd&&"CompositionEvent"in window,Yg=null;Yd&&"documentMode"in document&&(Yg=document.documentMode);var uK=Yd&&"TextEvent"in window&&!Yg,fR=Yd&&(!dE||Yg&&8<Yg&&11>=Yg),oI=" ",lI=!1;function mR(t,e){switch(t){case"keyup":return dK.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function pR(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var l0=!1;function AK(t,e){switch(t){case"compositionend":return pR(e);case"keypress":return e.which!==32?null:(lI=!0,oI);case"textInput":return t=e.data,t===oI&&lI?null:t;default:return null}}function hK(t,e){if(l0)return t==="compositionend"||!dE&&mR(t,e)?(t=hR(),cb=oE=AA=null,l0=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return fR&&e.locale!=="ko"?null:e.data;default:return null}}var fK={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function cI(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!fK[t.type]:e==="textarea"}function gR(t,e,r,s){WD(s),e=Yb(e,"onChange"),0<e.length&&(r=new lE("onChange","change",null,r,s),t.push({event:r,listeners:e}))}var Xg=null,Ox=null;function mK(t){_R(t,0)}function S2(t){var e=u0(t);if(QD(e))return t}function pK(t,e){if(t==="change")return e}var xR=!1;if(Yd){var p5;if(Yd){var g5="oninput"in document;if(!g5){var dI=document.createElement("div");dI.setAttribute("oninput","return;"),g5=typeof dI.oninput=="function"}p5=g5}else p5=!1;xR=p5&&(!document.documentMode||9<document.documentMode)}function uI(){Xg&&(Xg.detachEvent("onpropertychange",yR),Ox=Xg=null)}function yR(t){if(t.propertyName==="value"&&S2(Ox)){var e=[];gR(e,Ox,t,rE(t)),JD(mK,e)}}function gK(t,e,r){t==="focusin"?(uI(),Xg=e,Ox=r,Xg.attachEvent("onpropertychange",yR)):t==="focusout"&&uI()}function xK(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return S2(Ox)}function yK(t,e){if(t==="click")return S2(e)}function vK(t,e){if(t==="input"||t==="change")return S2(e)}function bK(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var fc=typeof Object.is=="function"?Object.is:bK;function Ux(t,e){if(fc(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),s=Object.keys(e);if(r.length!==s.length)return!1;for(s=0;s<r.length;s++){var n=r[s];if(!ZC.call(e,n)||!fc(t[n],e[n]))return!1}return!0}function AI(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function hI(t,e){var r=AI(t);t=0;for(var s;r;){if(r.nodeType===3){if(s=t+r.textContent.length,t<=e&&s>=e)return{node:r,offset:e-t};t=s}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=AI(r)}}function vR(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?vR(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function bR(){for(var t=window,e=Hb();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=Hb(t.document)}return e}function uE(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function wK(t){var e=bR(),r=t.focusedElem,s=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&vR(r.ownerDocument.documentElement,r)){if(s!==null&&uE(r)){if(e=s.start,t=s.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var n=r.textContent.length,i=Math.min(s.start,n);s=s.end===void 0?i:Math.min(s.end,n),!t.extend&&i>s&&(n=s,s=i,i=n),n=hI(r,i);var o=hI(r,s);n&&o&&(t.rangeCount!==1||t.anchorNode!==n.node||t.anchorOffset!==n.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(n.node,n.offset),t.removeAllRanges(),i>s?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var NK=Yd&&"documentMode"in document&&11>=document.documentMode,c0=null,x4=null,Jg=null,y4=!1;function fI(t,e,r){var s=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;y4||c0==null||c0!==Hb(s)||(s=c0,"selectionStart"in s&&uE(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),Jg&&Ux(Jg,s)||(Jg=s,s=Yb(x4,"onSelect"),0<s.length&&(e=new lE("onSelect","select",null,e,r),t.push({event:e,listeners:s}),e.target=c0)))}function zv(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var d0={animationend:zv("Animation","AnimationEnd"),animationiteration:zv("Animation","AnimationIteration"),animationstart:zv("Animation","AnimationStart"),transitionend:zv("Transition","TransitionEnd")},x5={},wR={};Yd&&(wR=document.createElement("div").style,"AnimationEvent"in window||(delete d0.animationend.animation,delete d0.animationiteration.animation,delete d0.animationstart.animation),"TransitionEvent"in window||delete d0.transitionend.transition);function E2(t){if(x5[t])return x5[t];if(!d0[t])return t;var e=d0[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in wR)return x5[t]=e[r];return t}var NR=E2("animationend"),CR=E2("animationiteration"),jR=E2("animationstart"),SR=E2("transitionend"),ER=new Map,mI="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ah(t,e){ER.set(t,e),qf(e,[t])}for(var y5=0;y5<mI.length;y5++){var v5=mI[y5],CK=v5.toLowerCase(),jK=v5[0].toUpperCase()+v5.slice(1);ah(CK,"on"+jK)}ah(NR,"onAnimationEnd");ah(CR,"onAnimationIteration");ah(jR,"onAnimationStart");ah("dblclick","onDoubleClick");ah("focusin","onFocus");ah("focusout","onBlur");ah(SR,"onTransitionEnd");W0("onMouseEnter",["mouseout","mouseover"]);W0("onMouseLeave",["mouseout","mouseover"]);W0("onPointerEnter",["pointerout","pointerover"]);W0("onPointerLeave",["pointerout","pointerover"]);qf("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));qf("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));qf("onBeforeInput",["compositionend","keypress","textInput","paste"]);qf("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));qf("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));qf("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ig="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),SK=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ig));function pI(t,e,r){var s=t.type||"unknown-event";t.currentTarget=r,C$(s,e,void 0,t),t.currentTarget=null}function _R(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var s=t[r],n=s.event;s=s.listeners;e:{var i=void 0;if(e)for(var o=s.length-1;0<=o;o--){var l=s[o],c=l.instance,d=l.currentTarget;if(l=l.listener,c!==i&&n.isPropagationStopped())break e;pI(n,l,d),i=c}else for(o=0;o<s.length;o++){if(l=s[o],c=l.instance,d=l.currentTarget,l=l.listener,c!==i&&n.isPropagationStopped())break e;pI(n,l,d),i=c}}}if(Kb)throw t=f4,Kb=!1,f4=null,t}function ln(t,e){var r=e[C4];r===void 0&&(r=e[C4]=new Set);var s=t+"__bubble";r.has(s)||(TR(e,t,2,!1),r.add(s))}function b5(t,e,r){var s=0;e&&(s|=4),TR(r,t,s,e)}var qv="_reactListening"+Math.random().toString(36).slice(2);function Mx(t){if(!t[qv]){t[qv]=!0,RD.forEach(function(r){r!=="selectionchange"&&(SK.has(r)||b5(r,!1,t),b5(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[qv]||(e[qv]=!0,b5("selectionchange",!1,e))}}function TR(t,e,r,s){switch(AR(e)){case 1:var n=M$;break;case 4:n=Q$;break;default:n=iE}r=n.bind(null,e,r,t),n=void 0,!h4||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(n=!0),s?n!==void 0?t.addEventListener(e,r,{capture:!0,passive:n}):t.addEventListener(e,r,!0):n!==void 0?t.addEventListener(e,r,{passive:n}):t.addEventListener(e,r,!1)}function w5(t,e,r,s,n){var i=s;if(!(e&1)&&!(e&2)&&s!==null)e:for(;;){if(s===null)return;var o=s.tag;if(o===3||o===4){var l=s.stateNode.containerInfo;if(l===n||l.nodeType===8&&l.parentNode===n)break;if(o===4)for(o=s.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===n||c.nodeType===8&&c.parentNode===n))return;o=o.return}for(;l!==null;){if(o=Jh(l),o===null)return;if(c=o.tag,c===5||c===6){s=i=o;continue e}l=l.parentNode}}s=s.return}JD(function(){var d=i,u=rE(r),A=[];e:{var h=ER.get(t);if(h!==void 0){var f=lE,p=t;switch(t){case"keypress":if(db(r)===0)break e;case"keydown":case"keyup":f=rK;break;case"focusin":p="focus",f=m5;break;case"focusout":p="blur",f=m5;break;case"beforeblur":case"afterblur":f=m5;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=nI;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=$$;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=aK;break;case NR:case CR:case jR:f=q$;break;case SR:f=oK;break;case"scroll":f=V$;break;case"wheel":f=cK;break;case"copy":case"cut":case"paste":f=G$;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=iI}var m=(e&4)!==0,g=!m&&t==="scroll",y=m?h!==null?h+"Capture":null:h;m=[];for(var v=d,x;v!==null;){x=v;var E=x.stateNode;if(x.tag===5&&E!==null&&(x=E,y!==null&&(E=Px(v,y),E!=null&&m.push(Qx(v,E,x)))),g)break;v=v.return}0<m.length&&(h=new f(h,p,null,r,u),A.push({event:h,listeners:m}))}}if(!(e&7)){e:{if(h=t==="mouseover"||t==="pointerover",f=t==="mouseout"||t==="pointerout",h&&r!==u4&&(p=r.relatedTarget||r.fromElement)&&(Jh(p)||p[Xd]))break e;if((f||h)&&(h=u.window===u?u:(h=u.ownerDocument)?h.defaultView||h.parentWindow:window,f?(p=r.relatedTarget||r.toElement,f=d,p=p?Jh(p):null,p!==null&&(g=Wf(p),p!==g||p.tag!==5&&p.tag!==6)&&(p=null)):(f=null,p=d),f!==p)){if(m=nI,E="onMouseLeave",y="onMouseEnter",v="mouse",(t==="pointerout"||t==="pointerover")&&(m=iI,E="onPointerLeave",y="onPointerEnter",v="pointer"),g=f==null?h:u0(f),x=p==null?h:u0(p),h=new m(E,v+"leave",f,r,u),h.target=g,h.relatedTarget=x,E=null,Jh(u)===d&&(m=new m(y,v+"enter",p,r,u),m.target=x,m.relatedTarget=g,E=m),g=E,f&&p)t:{for(m=f,y=p,v=0,x=m;x;x=Sm(x))v++;for(x=0,E=y;E;E=Sm(E))x++;for(;0<v-x;)m=Sm(m),v--;for(;0<x-v;)y=Sm(y),x--;for(;v--;){if(m===y||y!==null&&m===y.alternate)break t;m=Sm(m),y=Sm(y)}m=null}else m=null;f!==null&&gI(A,h,f,m,!1),p!==null&&g!==null&&gI(A,g,p,m,!0)}}e:{if(h=d?u0(d):window,f=h.nodeName&&h.nodeName.toLowerCase(),f==="select"||f==="input"&&h.type==="file")var T=pK;else if(cI(h))if(xR)T=vK;else{T=xK;var j=gK}else(f=h.nodeName)&&f.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(T=yK);if(T&&(T=T(t,d))){gR(A,T,r,u);break e}j&&j(t,h,d),t==="focusout"&&(j=h._wrapperState)&&j.controlled&&h.type==="number"&&i4(h,"number",h.value)}switch(j=d?u0(d):window,t){case"focusin":(cI(j)||j.contentEditable==="true")&&(c0=j,x4=d,Jg=null);break;case"focusout":Jg=x4=c0=null;break;case"mousedown":y4=!0;break;case"contextmenu":case"mouseup":case"dragend":y4=!1,fI(A,r,u);break;case"selectionchange":if(NK)break;case"keydown":case"keyup":fI(A,r,u)}var C;if(dE)e:{switch(t){case"compositionstart":var w="onCompositionStart";break e;case"compositionend":w="onCompositionEnd";break e;case"compositionupdate":w="onCompositionUpdate";break e}w=void 0}else l0?mR(t,r)&&(w="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(w="onCompositionStart");w&&(fR&&r.locale!=="ko"&&(l0||w!=="onCompositionStart"?w==="onCompositionEnd"&&l0&&(C=hR()):(AA=u,oE="value"in AA?AA.value:AA.textContent,l0=!0)),j=Yb(d,w),0<j.length&&(w=new aI(w,t,null,r,u),A.push({event:w,listeners:j}),C?w.data=C:(C=pR(r),C!==null&&(w.data=C)))),(C=uK?AK(t,r):hK(t,r))&&(d=Yb(d,"onBeforeInput"),0<d.length&&(u=new aI("onBeforeInput","beforeinput",null,r,u),A.push({event:u,listeners:d}),u.data=C))}_R(A,e)})}function Qx(t,e,r){return{instance:t,listener:e,currentTarget:r}}function Yb(t,e){for(var r=e+"Capture",s=[];t!==null;){var n=t,i=n.stateNode;n.tag===5&&i!==null&&(n=i,i=Px(t,r),i!=null&&s.unshift(Qx(t,i,n)),i=Px(t,e),i!=null&&s.push(Qx(t,i,n))),t=t.return}return s}function Sm(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function gI(t,e,r,s,n){for(var i=e._reactName,o=[];r!==null&&r!==s;){var l=r,c=l.alternate,d=l.stateNode;if(c!==null&&c===s)break;l.tag===5&&d!==null&&(l=d,n?(c=Px(r,i),c!=null&&o.unshift(Qx(r,c,l))):n||(c=Px(r,i),c!=null&&o.push(Qx(r,c,l)))),r=r.return}o.length!==0&&t.push({event:e,listeners:o})}var EK=/\r\n?/g,_K=/\u0000|\uFFFD/g;function xI(t){return(typeof t=="string"?t:""+t).replace(EK,`
`).replace(_K,"")}function Wv(t,e,r){if(e=xI(e),xI(t)!==e&&r)throw Error(Wt(425))}function Xb(){}var v4=null,b4=null;function w4(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var N4=typeof setTimeout=="function"?setTimeout:void 0,TK=typeof clearTimeout=="function"?clearTimeout:void 0,yI=typeof Promise=="function"?Promise:void 0,IK=typeof queueMicrotask=="function"?queueMicrotask:typeof yI<"u"?function(t){return yI.resolve(null).then(t).catch(kK)}:N4;function kK(t){setTimeout(function(){throw t})}function N5(t,e){var r=e,s=0;do{var n=r.nextSibling;if(t.removeChild(r),n&&n.nodeType===8)if(r=n.data,r==="/$"){if(s===0){t.removeChild(n),Lx(e);return}s--}else r!=="$"&&r!=="$?"&&r!=="$!"||s++;r=n}while(r);Lx(e)}function EA(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function vI(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var Sp=Math.random().toString(36).slice(2),Oc="__reactFiber$"+Sp,Vx="__reactProps$"+Sp,Xd="__reactContainer$"+Sp,C4="__reactEvents$"+Sp,BK="__reactListeners$"+Sp,FK="__reactHandles$"+Sp;function Jh(t){var e=t[Oc];if(e)return e;for(var r=t.parentNode;r;){if(e=r[Xd]||r[Oc]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=vI(t);t!==null;){if(r=t[Oc])return r;t=vI(t)}return e}t=r,r=t.parentNode}return null}function By(t){return t=t[Oc]||t[Xd],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function u0(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Wt(33))}function _2(t){return t[Vx]||null}var j4=[],A0=-1;function ih(t){return{current:t}}function mn(t){0>A0||(t.current=j4[A0],j4[A0]=null,A0--)}function rn(t,e){A0++,j4[A0]=t.current,t.current=e}var HA={},Pi=ih(HA),vo=ih(!1),bf=HA;function G0(t,e){var r=t.type.contextTypes;if(!r)return HA;var s=t.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===e)return s.__reactInternalMemoizedMaskedChildContext;var n={},i;for(i in r)n[i]=e[i];return s&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=n),n}function bo(t){return t=t.childContextTypes,t!=null}function Jb(){mn(vo),mn(Pi)}function bI(t,e,r){if(Pi.current!==HA)throw Error(Wt(168));rn(Pi,e),rn(vo,r)}function IR(t,e,r){var s=t.stateNode;if(e=e.childContextTypes,typeof s.getChildContext!="function")return r;s=s.getChildContext();for(var n in s)if(!(n in e))throw Error(Wt(108,g$(t)||"Unknown",n));return Tn({},r,s)}function Zb(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||HA,bf=Pi.current,rn(Pi,t),rn(vo,vo.current),!0}function wI(t,e,r){var s=t.stateNode;if(!s)throw Error(Wt(169));r?(t=IR(t,e,bf),s.__reactInternalMemoizedMergedChildContext=t,mn(vo),mn(Pi),rn(Pi,t)):mn(vo),rn(vo,r)}var Pd=null,T2=!1,C5=!1;function kR(t){Pd===null?Pd=[t]:Pd.push(t)}function PK(t){T2=!0,kR(t)}function oh(){if(!C5&&Pd!==null){C5=!0;var t=0,e=Ms;try{var r=Pd;for(Ms=1;t<r.length;t++){var s=r[t];do s=s(!0);while(s!==null)}Pd=null,T2=!1}catch(n){throw Pd!==null&&(Pd=Pd.slice(t+1)),rR(sE,oh),n}finally{Ms=e,C5=!1}}return null}var h0=[],f0=0,ew=null,tw=0,bl=[],wl=0,wf=null,Dd=1,Rd="";function Lh(t,e){h0[f0++]=tw,h0[f0++]=ew,ew=t,tw=e}function BR(t,e,r){bl[wl++]=Dd,bl[wl++]=Rd,bl[wl++]=wf,wf=t;var s=Dd;t=Rd;var n=32-dc(s)-1;s&=~(1<<n),r+=1;var i=32-dc(e)+n;if(30<i){var o=n-n%5;i=(s&(1<<o)-1).toString(32),s>>=o,n-=o,Dd=1<<32-dc(e)+n|r<<n|s,Rd=i+t}else Dd=1<<i|r<<n|s,Rd=t}function AE(t){t.return!==null&&(Lh(t,1),BR(t,1,0))}function hE(t){for(;t===ew;)ew=h0[--f0],h0[f0]=null,tw=h0[--f0],h0[f0]=null;for(;t===wf;)wf=bl[--wl],bl[wl]=null,Rd=bl[--wl],bl[wl]=null,Dd=bl[--wl],bl[wl]=null}var qo=null,$o=null,bn=!1,sc=null;function FR(t,e){var r=Cl(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function NI(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,qo=t,$o=EA(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,qo=t,$o=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=wf!==null?{id:Dd,overflow:Rd}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=Cl(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,qo=t,$o=null,!0):!1;default:return!1}}function S4(t){return(t.mode&1)!==0&&(t.flags&128)===0}function E4(t){if(bn){var e=$o;if(e){var r=e;if(!NI(t,e)){if(S4(t))throw Error(Wt(418));e=EA(r.nextSibling);var s=qo;e&&NI(t,e)?FR(s,r):(t.flags=t.flags&-4097|2,bn=!1,qo=t)}}else{if(S4(t))throw Error(Wt(418));t.flags=t.flags&-4097|2,bn=!1,qo=t}}}function CI(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;qo=t}function Gv(t){if(t!==qo)return!1;if(!bn)return CI(t),bn=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!w4(t.type,t.memoizedProps)),e&&(e=$o)){if(S4(t))throw PR(),Error(Wt(418));for(;e;)FR(t,e),e=EA(e.nextSibling)}if(CI(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Wt(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){$o=EA(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}$o=null}}else $o=qo?EA(t.stateNode.nextSibling):null;return!0}function PR(){for(var t=$o;t;)t=EA(t.nextSibling)}function Y0(){$o=qo=null,bn=!1}function fE(t){sc===null?sc=[t]:sc.push(t)}var DK=cu.ReactCurrentBatchConfig;function dg(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Wt(309));var s=r.stateNode}if(!s)throw Error(Wt(147,t));var n=s,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var l=n.refs;o===null?delete l[i]:l[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(Wt(284));if(!r._owner)throw Error(Wt(290,t))}return t}function Yv(t,e){throw t=Object.prototype.toString.call(e),Error(Wt(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function jI(t){var e=t._init;return e(t._payload)}function DR(t){function e(y,v){if(t){var x=y.deletions;x===null?(y.deletions=[v],y.flags|=16):x.push(v)}}function r(y,v){if(!t)return null;for(;v!==null;)e(y,v),v=v.sibling;return null}function s(y,v){for(y=new Map;v!==null;)v.key!==null?y.set(v.key,v):y.set(v.index,v),v=v.sibling;return y}function n(y,v){return y=kA(y,v),y.index=0,y.sibling=null,y}function i(y,v,x){return y.index=x,t?(x=y.alternate,x!==null?(x=x.index,x<v?(y.flags|=2,v):x):(y.flags|=2,v)):(y.flags|=1048576,v)}function o(y){return t&&y.alternate===null&&(y.flags|=2),y}function l(y,v,x,E){return v===null||v.tag!==6?(v=k5(x,y.mode,E),v.return=y,v):(v=n(v,x),v.return=y,v)}function c(y,v,x,E){var T=x.type;return T===o0?u(y,v,x.props.children,E,x.key):v!==null&&(v.elementType===T||typeof T=="object"&&T!==null&&T.$$typeof===Zu&&jI(T)===v.type)?(E=n(v,x.props),E.ref=dg(y,v,x),E.return=y,E):(E=gb(x.type,x.key,x.props,null,y.mode,E),E.ref=dg(y,v,x),E.return=y,E)}function d(y,v,x,E){return v===null||v.tag!==4||v.stateNode.containerInfo!==x.containerInfo||v.stateNode.implementation!==x.implementation?(v=B5(x,y.mode,E),v.return=y,v):(v=n(v,x.children||[]),v.return=y,v)}function u(y,v,x,E,T){return v===null||v.tag!==7?(v=df(x,y.mode,E,T),v.return=y,v):(v=n(v,x),v.return=y,v)}function A(y,v,x){if(typeof v=="string"&&v!==""||typeof v=="number")return v=k5(""+v,y.mode,x),v.return=y,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Uv:return x=gb(v.type,v.key,v.props,null,y.mode,x),x.ref=dg(y,null,v),x.return=y,x;case i0:return v=B5(v,y.mode,x),v.return=y,v;case Zu:var E=v._init;return A(y,E(v._payload),x)}if(_g(v)||ag(v))return v=df(v,y.mode,x,null),v.return=y,v;Yv(y,v)}return null}function h(y,v,x,E){var T=v!==null?v.key:null;if(typeof x=="string"&&x!==""||typeof x=="number")return T!==null?null:l(y,v,""+x,E);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Uv:return x.key===T?c(y,v,x,E):null;case i0:return x.key===T?d(y,v,x,E):null;case Zu:return T=x._init,h(y,v,T(x._payload),E)}if(_g(x)||ag(x))return T!==null?null:u(y,v,x,E,null);Yv(y,x)}return null}function f(y,v,x,E,T){if(typeof E=="string"&&E!==""||typeof E=="number")return y=y.get(x)||null,l(v,y,""+E,T);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case Uv:return y=y.get(E.key===null?x:E.key)||null,c(v,y,E,T);case i0:return y=y.get(E.key===null?x:E.key)||null,d(v,y,E,T);case Zu:var j=E._init;return f(y,v,x,j(E._payload),T)}if(_g(E)||ag(E))return y=y.get(x)||null,u(v,y,E,T,null);Yv(v,E)}return null}function p(y,v,x,E){for(var T=null,j=null,C=v,w=v=0,S=null;C!==null&&w<x.length;w++){C.index>w?(S=C,C=null):S=C.sibling;var F=h(y,C,x[w],E);if(F===null){C===null&&(C=S);break}t&&C&&F.alternate===null&&e(y,C),v=i(F,v,w),j===null?T=F:j.sibling=F,j=F,C=S}if(w===x.length)return r(y,C),bn&&Lh(y,w),T;if(C===null){for(;w<x.length;w++)C=A(y,x[w],E),C!==null&&(v=i(C,v,w),j===null?T=C:j.sibling=C,j=C);return bn&&Lh(y,w),T}for(C=s(y,C);w<x.length;w++)S=f(C,y,w,x[w],E),S!==null&&(t&&S.alternate!==null&&C.delete(S.key===null?w:S.key),v=i(S,v,w),j===null?T=S:j.sibling=S,j=S);return t&&C.forEach(function(B){return e(y,B)}),bn&&Lh(y,w),T}function m(y,v,x,E){var T=ag(x);if(typeof T!="function")throw Error(Wt(150));if(x=T.call(x),x==null)throw Error(Wt(151));for(var j=T=null,C=v,w=v=0,S=null,F=x.next();C!==null&&!F.done;w++,F=x.next()){C.index>w?(S=C,C=null):S=C.sibling;var B=h(y,C,F.value,E);if(B===null){C===null&&(C=S);break}t&&C&&B.alternate===null&&e(y,C),v=i(B,v,w),j===null?T=B:j.sibling=B,j=B,C=S}if(F.done)return r(y,C),bn&&Lh(y,w),T;if(C===null){for(;!F.done;w++,F=x.next())F=A(y,F.value,E),F!==null&&(v=i(F,v,w),j===null?T=F:j.sibling=F,j=F);return bn&&Lh(y,w),T}for(C=s(y,C);!F.done;w++,F=x.next())F=f(C,y,w,F.value,E),F!==null&&(t&&F.alternate!==null&&C.delete(F.key===null?w:F.key),v=i(F,v,w),j===null?T=F:j.sibling=F,j=F);return t&&C.forEach(function(k){return e(y,k)}),bn&&Lh(y,w),T}function g(y,v,x,E){if(typeof x=="object"&&x!==null&&x.type===o0&&x.key===null&&(x=x.props.children),typeof x=="object"&&x!==null){switch(x.$$typeof){case Uv:e:{for(var T=x.key,j=v;j!==null;){if(j.key===T){if(T=x.type,T===o0){if(j.tag===7){r(y,j.sibling),v=n(j,x.props.children),v.return=y,y=v;break e}}else if(j.elementType===T||typeof T=="object"&&T!==null&&T.$$typeof===Zu&&jI(T)===j.type){r(y,j.sibling),v=n(j,x.props),v.ref=dg(y,j,x),v.return=y,y=v;break e}r(y,j);break}else e(y,j);j=j.sibling}x.type===o0?(v=df(x.props.children,y.mode,E,x.key),v.return=y,y=v):(E=gb(x.type,x.key,x.props,null,y.mode,E),E.ref=dg(y,v,x),E.return=y,y=E)}return o(y);case i0:e:{for(j=x.key;v!==null;){if(v.key===j)if(v.tag===4&&v.stateNode.containerInfo===x.containerInfo&&v.stateNode.implementation===x.implementation){r(y,v.sibling),v=n(v,x.children||[]),v.return=y,y=v;break e}else{r(y,v);break}else e(y,v);v=v.sibling}v=B5(x,y.mode,E),v.return=y,y=v}return o(y);case Zu:return j=x._init,g(y,v,j(x._payload),E)}if(_g(x))return p(y,v,x,E);if(ag(x))return m(y,v,x,E);Yv(y,x)}return typeof x=="string"&&x!==""||typeof x=="number"?(x=""+x,v!==null&&v.tag===6?(r(y,v.sibling),v=n(v,x),v.return=y,y=v):(r(y,v),v=k5(x,y.mode,E),v.return=y,y=v),o(y)):r(y,v)}return g}var X0=DR(!0),RR=DR(!1),rw=ih(null),sw=null,m0=null,mE=null;function pE(){mE=m0=sw=null}function gE(t){var e=rw.current;mn(rw),t._currentValue=e}function _4(t,e,r){for(;t!==null;){var s=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,s!==null&&(s.childLanes|=e)):s!==null&&(s.childLanes&e)!==e&&(s.childLanes|=e),t===r)break;t=t.return}}function _0(t,e){sw=t,mE=m0=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(go=!0),t.firstContext=null)}function Bl(t){var e=t._currentValue;if(mE!==t)if(t={context:t,memoizedValue:e,next:null},m0===null){if(sw===null)throw Error(Wt(308));m0=t,sw.dependencies={lanes:0,firstContext:t}}else m0=m0.next=t;return e}var Zh=null;function xE(t){Zh===null?Zh=[t]:Zh.push(t)}function LR(t,e,r,s){var n=e.interleaved;return n===null?(r.next=r,xE(e)):(r.next=n.next,n.next=r),e.interleaved=r,Jd(t,s)}function Jd(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var eA=!1;function yE(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function OR(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Hd(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function _A(t,e,r){var s=t.updateQueue;if(s===null)return null;if(s=s.shared,ys&2){var n=s.pending;return n===null?e.next=e:(e.next=n.next,n.next=e),s.pending=e,Jd(t,r)}return n=s.interleaved,n===null?(e.next=e,xE(s)):(e.next=n.next,n.next=e),s.interleaved=e,Jd(t,r)}function ub(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var s=e.lanes;s&=t.pendingLanes,r|=s,e.lanes=r,nE(t,r)}}function SI(t,e){var r=t.updateQueue,s=t.alternate;if(s!==null&&(s=s.updateQueue,r===s)){var n=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?n=i=o:i=i.next=o,r=r.next}while(r!==null);i===null?n=i=e:i=i.next=e}else n=i=e;r={baseState:s.baseState,firstBaseUpdate:n,lastBaseUpdate:i,shared:s.shared,effects:s.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function nw(t,e,r,s){var n=t.updateQueue;eA=!1;var i=n.firstBaseUpdate,o=n.lastBaseUpdate,l=n.shared.pending;if(l!==null){n.shared.pending=null;var c=l,d=c.next;c.next=null,o===null?i=d:o.next=d,o=c;var u=t.alternate;u!==null&&(u=u.updateQueue,l=u.lastBaseUpdate,l!==o&&(l===null?u.firstBaseUpdate=d:l.next=d,u.lastBaseUpdate=c))}if(i!==null){var A=n.baseState;o=0,u=d=c=null,l=i;do{var h=l.lane,f=l.eventTime;if((s&h)===h){u!==null&&(u=u.next={eventTime:f,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var p=t,m=l;switch(h=e,f=r,m.tag){case 1:if(p=m.payload,typeof p=="function"){A=p.call(f,A,h);break e}A=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=m.payload,h=typeof p=="function"?p.call(f,A,h):p,h==null)break e;A=Tn({},A,h);break e;case 2:eA=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,h=n.effects,h===null?n.effects=[l]:h.push(l))}else f={eventTime:f,lane:h,tag:l.tag,payload:l.payload,callback:l.callback,next:null},u===null?(d=u=f,c=A):u=u.next=f,o|=h;if(l=l.next,l===null){if(l=n.shared.pending,l===null)break;h=l,l=h.next,h.next=null,n.lastBaseUpdate=h,n.shared.pending=null}}while(!0);if(u===null&&(c=A),n.baseState=c,n.firstBaseUpdate=d,n.lastBaseUpdate=u,e=n.shared.interleaved,e!==null){n=e;do o|=n.lane,n=n.next;while(n!==e)}else i===null&&(n.shared.lanes=0);Cf|=o,t.lanes=o,t.memoizedState=A}}function EI(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var s=t[e],n=s.callback;if(n!==null){if(s.callback=null,s=r,typeof n!="function")throw Error(Wt(191,n));n.call(s)}}}var Fy={},qc=ih(Fy),Hx=ih(Fy),$x=ih(Fy);function ef(t){if(t===Fy)throw Error(Wt(174));return t}function vE(t,e){switch(rn($x,e),rn(Hx,t),rn(qc,Fy),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:l4(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=l4(e,t)}mn(qc),rn(qc,e)}function J0(){mn(qc),mn(Hx),mn($x)}function UR(t){ef($x.current);var e=ef(qc.current),r=l4(e,t.type);e!==r&&(rn(Hx,t),rn(qc,r))}function bE(t){Hx.current===t&&(mn(qc),mn(Hx))}var Nn=ih(0);function aw(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var j5=[];function wE(){for(var t=0;t<j5.length;t++)j5[t]._workInProgressVersionPrimary=null;j5.length=0}var Ab=cu.ReactCurrentDispatcher,S5=cu.ReactCurrentBatchConfig,Nf=0,_n=null,ba=null,Ua=null,iw=!1,Zg=!1,Kx=0,RK=0;function ui(){throw Error(Wt(321))}function NE(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!fc(t[r],e[r]))return!1;return!0}function CE(t,e,r,s,n,i){if(Nf=i,_n=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Ab.current=t===null||t.memoizedState===null?MK:QK,t=r(s,n),Zg){i=0;do{if(Zg=!1,Kx=0,25<=i)throw Error(Wt(301));i+=1,Ua=ba=null,e.updateQueue=null,Ab.current=VK,t=r(s,n)}while(Zg)}if(Ab.current=ow,e=ba!==null&&ba.next!==null,Nf=0,Ua=ba=_n=null,iw=!1,e)throw Error(Wt(300));return t}function jE(){var t=Kx!==0;return Kx=0,t}function Rc(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ua===null?_n.memoizedState=Ua=t:Ua=Ua.next=t,Ua}function Fl(){if(ba===null){var t=_n.alternate;t=t!==null?t.memoizedState:null}else t=ba.next;var e=Ua===null?_n.memoizedState:Ua.next;if(e!==null)Ua=e,ba=t;else{if(t===null)throw Error(Wt(310));ba=t,t={memoizedState:ba.memoizedState,baseState:ba.baseState,baseQueue:ba.baseQueue,queue:ba.queue,next:null},Ua===null?_n.memoizedState=Ua=t:Ua=Ua.next=t}return Ua}function zx(t,e){return typeof e=="function"?e(t):e}function E5(t){var e=Fl(),r=e.queue;if(r===null)throw Error(Wt(311));r.lastRenderedReducer=t;var s=ba,n=s.baseQueue,i=r.pending;if(i!==null){if(n!==null){var o=n.next;n.next=i.next,i.next=o}s.baseQueue=n=i,r.pending=null}if(n!==null){i=n.next,s=s.baseState;var l=o=null,c=null,d=i;do{var u=d.lane;if((Nf&u)===u)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),s=d.hasEagerState?d.eagerState:t(s,d.action);else{var A={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(l=c=A,o=s):c=c.next=A,_n.lanes|=u,Cf|=u}d=d.next}while(d!==null&&d!==i);c===null?o=s:c.next=l,fc(s,e.memoizedState)||(go=!0),e.memoizedState=s,e.baseState=o,e.baseQueue=c,r.lastRenderedState=s}if(t=r.interleaved,t!==null){n=t;do i=n.lane,_n.lanes|=i,Cf|=i,n=n.next;while(n!==t)}else n===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function _5(t){var e=Fl(),r=e.queue;if(r===null)throw Error(Wt(311));r.lastRenderedReducer=t;var s=r.dispatch,n=r.pending,i=e.memoizedState;if(n!==null){r.pending=null;var o=n=n.next;do i=t(i,o.action),o=o.next;while(o!==n);fc(i,e.memoizedState)||(go=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),r.lastRenderedState=i}return[i,s]}function MR(){}function QR(t,e){var r=_n,s=Fl(),n=e(),i=!fc(s.memoizedState,n);if(i&&(s.memoizedState=n,go=!0),s=s.queue,SE($R.bind(null,r,s,t),[t]),s.getSnapshot!==e||i||Ua!==null&&Ua.memoizedState.tag&1){if(r.flags|=2048,qx(9,HR.bind(null,r,s,n,e),void 0,null),$a===null)throw Error(Wt(349));Nf&30||VR(r,e,n)}return n}function VR(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=_n.updateQueue,e===null?(e={lastEffect:null,stores:null},_n.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function HR(t,e,r,s){e.value=r,e.getSnapshot=s,KR(e)&&zR(t)}function $R(t,e,r){return r(function(){KR(e)&&zR(t)})}function KR(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!fc(t,r)}catch{return!0}}function zR(t){var e=Jd(t,1);e!==null&&uc(e,t,1,-1)}function _I(t){var e=Rc();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:zx,lastRenderedState:t},e.queue=t,t=t.dispatch=UK.bind(null,_n,t),[e.memoizedState,t]}function qx(t,e,r,s){return t={tag:t,create:e,destroy:r,deps:s,next:null},e=_n.updateQueue,e===null?(e={lastEffect:null,stores:null},_n.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(s=r.next,r.next=t,t.next=s,e.lastEffect=t)),t}function qR(){return Fl().memoizedState}function hb(t,e,r,s){var n=Rc();_n.flags|=t,n.memoizedState=qx(1|e,r,void 0,s===void 0?null:s)}function I2(t,e,r,s){var n=Fl();s=s===void 0?null:s;var i=void 0;if(ba!==null){var o=ba.memoizedState;if(i=o.destroy,s!==null&&NE(s,o.deps)){n.memoizedState=qx(e,r,i,s);return}}_n.flags|=t,n.memoizedState=qx(1|e,r,i,s)}function TI(t,e){return hb(8390656,8,t,e)}function SE(t,e){return I2(2048,8,t,e)}function WR(t,e){return I2(4,2,t,e)}function GR(t,e){return I2(4,4,t,e)}function YR(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function XR(t,e,r){return r=r!=null?r.concat([t]):null,I2(4,4,YR.bind(null,e,t),r)}function EE(){}function JR(t,e){var r=Fl();e=e===void 0?null:e;var s=r.memoizedState;return s!==null&&e!==null&&NE(e,s[1])?s[0]:(r.memoizedState=[t,e],t)}function ZR(t,e){var r=Fl();e=e===void 0?null:e;var s=r.memoizedState;return s!==null&&e!==null&&NE(e,s[1])?s[0]:(t=t(),r.memoizedState=[t,e],t)}function e8(t,e,r){return Nf&21?(fc(r,e)||(r=aR(),_n.lanes|=r,Cf|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,go=!0),t.memoizedState=r)}function LK(t,e){var r=Ms;Ms=r!==0&&4>r?r:4,t(!0);var s=S5.transition;S5.transition={};try{t(!1),e()}finally{Ms=r,S5.transition=s}}function t8(){return Fl().memoizedState}function OK(t,e,r){var s=IA(t);if(r={lane:s,action:r,hasEagerState:!1,eagerState:null,next:null},r8(t))s8(e,r);else if(r=LR(t,e,r,s),r!==null){var n=Yi();uc(r,t,s,n),n8(r,e,s)}}function UK(t,e,r){var s=IA(t),n={lane:s,action:r,hasEagerState:!1,eagerState:null,next:null};if(r8(t))s8(e,n);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,l=i(o,r);if(n.hasEagerState=!0,n.eagerState=l,fc(l,o)){var c=e.interleaved;c===null?(n.next=n,xE(e)):(n.next=c.next,c.next=n),e.interleaved=n;return}}catch{}finally{}r=LR(t,e,n,s),r!==null&&(n=Yi(),uc(r,t,s,n),n8(r,e,s))}}function r8(t){var e=t.alternate;return t===_n||e!==null&&e===_n}function s8(t,e){Zg=iw=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function n8(t,e,r){if(r&4194240){var s=e.lanes;s&=t.pendingLanes,r|=s,e.lanes=r,nE(t,r)}}var ow={readContext:Bl,useCallback:ui,useContext:ui,useEffect:ui,useImperativeHandle:ui,useInsertionEffect:ui,useLayoutEffect:ui,useMemo:ui,useReducer:ui,useRef:ui,useState:ui,useDebugValue:ui,useDeferredValue:ui,useTransition:ui,useMutableSource:ui,useSyncExternalStore:ui,useId:ui,unstable_isNewReconciler:!1},MK={readContext:Bl,useCallback:function(t,e){return Rc().memoizedState=[t,e===void 0?null:e],t},useContext:Bl,useEffect:TI,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,hb(4194308,4,YR.bind(null,e,t),r)},useLayoutEffect:function(t,e){return hb(4194308,4,t,e)},useInsertionEffect:function(t,e){return hb(4,2,t,e)},useMemo:function(t,e){var r=Rc();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var s=Rc();return e=r!==void 0?r(e):e,s.memoizedState=s.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},s.queue=t,t=t.dispatch=OK.bind(null,_n,t),[s.memoizedState,t]},useRef:function(t){var e=Rc();return t={current:t},e.memoizedState=t},useState:_I,useDebugValue:EE,useDeferredValue:function(t){return Rc().memoizedState=t},useTransition:function(){var t=_I(!1),e=t[0];return t=LK.bind(null,t[1]),Rc().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var s=_n,n=Rc();if(bn){if(r===void 0)throw Error(Wt(407));r=r()}else{if(r=e(),$a===null)throw Error(Wt(349));Nf&30||VR(s,e,r)}n.memoizedState=r;var i={value:r,getSnapshot:e};return n.queue=i,TI($R.bind(null,s,i,t),[t]),s.flags|=2048,qx(9,HR.bind(null,s,i,r,e),void 0,null),r},useId:function(){var t=Rc(),e=$a.identifierPrefix;if(bn){var r=Rd,s=Dd;r=(s&~(1<<32-dc(s)-1)).toString(32)+r,e=":"+e+"R"+r,r=Kx++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=RK++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},QK={readContext:Bl,useCallback:JR,useContext:Bl,useEffect:SE,useImperativeHandle:XR,useInsertionEffect:WR,useLayoutEffect:GR,useMemo:ZR,useReducer:E5,useRef:qR,useState:function(){return E5(zx)},useDebugValue:EE,useDeferredValue:function(t){var e=Fl();return e8(e,ba.memoizedState,t)},useTransition:function(){var t=E5(zx)[0],e=Fl().memoizedState;return[t,e]},useMutableSource:MR,useSyncExternalStore:QR,useId:t8,unstable_isNewReconciler:!1},VK={readContext:Bl,useCallback:JR,useContext:Bl,useEffect:SE,useImperativeHandle:XR,useInsertionEffect:WR,useLayoutEffect:GR,useMemo:ZR,useReducer:_5,useRef:qR,useState:function(){return _5(zx)},useDebugValue:EE,useDeferredValue:function(t){var e=Fl();return ba===null?e.memoizedState=t:e8(e,ba.memoizedState,t)},useTransition:function(){var t=_5(zx)[0],e=Fl().memoizedState;return[t,e]},useMutableSource:MR,useSyncExternalStore:QR,useId:t8,unstable_isNewReconciler:!1};function Zl(t,e){if(t&&t.defaultProps){e=Tn({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function T4(t,e,r,s){e=t.memoizedState,r=r(s,e),r=r==null?e:Tn({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var k2={isMounted:function(t){return(t=t._reactInternals)?Wf(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var s=Yi(),n=IA(t),i=Hd(s,n);i.payload=e,r!=null&&(i.callback=r),e=_A(t,i,n),e!==null&&(uc(e,t,n,s),ub(e,t,n))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var s=Yi(),n=IA(t),i=Hd(s,n);i.tag=1,i.payload=e,r!=null&&(i.callback=r),e=_A(t,i,n),e!==null&&(uc(e,t,n,s),ub(e,t,n))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=Yi(),s=IA(t),n=Hd(r,s);n.tag=2,e!=null&&(n.callback=e),e=_A(t,n,s),e!==null&&(uc(e,t,s,r),ub(e,t,s))}};function II(t,e,r,s,n,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(s,i,o):e.prototype&&e.prototype.isPureReactComponent?!Ux(r,s)||!Ux(n,i):!0}function a8(t,e,r){var s=!1,n=HA,i=e.contextType;return typeof i=="object"&&i!==null?i=Bl(i):(n=bo(e)?bf:Pi.current,s=e.contextTypes,i=(s=s!=null)?G0(t,n):HA),e=new e(r,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=k2,t.stateNode=e,e._reactInternals=t,s&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=n,t.__reactInternalMemoizedMaskedChildContext=i),e}function kI(t,e,r,s){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,s),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,s),e.state!==t&&k2.enqueueReplaceState(e,e.state,null)}function I4(t,e,r,s){var n=t.stateNode;n.props=r,n.state=t.memoizedState,n.refs={},yE(t);var i=e.contextType;typeof i=="object"&&i!==null?n.context=Bl(i):(i=bo(e)?bf:Pi.current,n.context=G0(t,i)),n.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(T4(t,e,i,r),n.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof n.getSnapshotBeforeUpdate=="function"||typeof n.UNSAFE_componentWillMount!="function"&&typeof n.componentWillMount!="function"||(e=n.state,typeof n.componentWillMount=="function"&&n.componentWillMount(),typeof n.UNSAFE_componentWillMount=="function"&&n.UNSAFE_componentWillMount(),e!==n.state&&k2.enqueueReplaceState(n,n.state,null),nw(t,r,n,s),n.state=t.memoizedState),typeof n.componentDidMount=="function"&&(t.flags|=4194308)}function Z0(t,e){try{var r="",s=e;do r+=p$(s),s=s.return;while(s);var n=r}catch(i){n=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:n,digest:null}}function T5(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function k4(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var HK=typeof WeakMap=="function"?WeakMap:Map;function i8(t,e,r){r=Hd(-1,r),r.tag=3,r.payload={element:null};var s=e.value;return r.callback=function(){cw||(cw=!0,Q4=s),k4(t,e)},r}function o8(t,e,r){r=Hd(-1,r),r.tag=3;var s=t.type.getDerivedStateFromError;if(typeof s=="function"){var n=e.value;r.payload=function(){return s(n)},r.callback=function(){k4(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){k4(t,e),typeof s!="function"&&(TA===null?TA=new Set([this]):TA.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),r}function BI(t,e,r){var s=t.pingCache;if(s===null){s=t.pingCache=new HK;var n=new Set;s.set(e,n)}else n=s.get(e),n===void 0&&(n=new Set,s.set(e,n));n.has(r)||(n.add(r),t=sz.bind(null,t,e,r),e.then(t,t))}function FI(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function PI(t,e,r,s,n){return t.mode&1?(t.flags|=65536,t.lanes=n,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=Hd(-1,1),e.tag=2,_A(r,e,1))),r.lanes|=1),t)}var $K=cu.ReactCurrentOwner,go=!1;function Hi(t,e,r,s){e.child=t===null?RR(e,null,r,s):X0(e,t.child,r,s)}function DI(t,e,r,s,n){r=r.render;var i=e.ref;return _0(e,n),s=CE(t,e,r,s,i,n),r=jE(),t!==null&&!go?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~n,Zd(t,e,n)):(bn&&r&&AE(e),e.flags|=1,Hi(t,e,s,n),e.child)}function RI(t,e,r,s,n){if(t===null){var i=r.type;return typeof i=="function"&&!DE(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=i,l8(t,e,i,s,n)):(t=gb(r.type,null,s,e,e.mode,n),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&n)){var o=i.memoizedProps;if(r=r.compare,r=r!==null?r:Ux,r(o,s)&&t.ref===e.ref)return Zd(t,e,n)}return e.flags|=1,t=kA(i,s),t.ref=e.ref,t.return=e,e.child=t}function l8(t,e,r,s,n){if(t!==null){var i=t.memoizedProps;if(Ux(i,s)&&t.ref===e.ref)if(go=!1,e.pendingProps=s=i,(t.lanes&n)!==0)t.flags&131072&&(go=!0);else return e.lanes=t.lanes,Zd(t,e,n)}return B4(t,e,r,s,n)}function c8(t,e,r){var s=e.pendingProps,n=s.children,i=t!==null?t.memoizedState:null;if(s.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},rn(g0,Lo),Lo|=r;else{if(!(r&1073741824))return t=i!==null?i.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,rn(g0,Lo),Lo|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=i!==null?i.baseLanes:r,rn(g0,Lo),Lo|=s}else i!==null?(s=i.baseLanes|r,e.memoizedState=null):s=r,rn(g0,Lo),Lo|=s;return Hi(t,e,n,r),e.child}function d8(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function B4(t,e,r,s,n){var i=bo(r)?bf:Pi.current;return i=G0(e,i),_0(e,n),r=CE(t,e,r,s,i,n),s=jE(),t!==null&&!go?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~n,Zd(t,e,n)):(bn&&s&&AE(e),e.flags|=1,Hi(t,e,r,n),e.child)}function LI(t,e,r,s,n){if(bo(r)){var i=!0;Zb(e)}else i=!1;if(_0(e,n),e.stateNode===null)fb(t,e),a8(e,r,s),I4(e,r,s,n),s=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var c=o.context,d=r.contextType;typeof d=="object"&&d!==null?d=Bl(d):(d=bo(r)?bf:Pi.current,d=G0(e,d));var u=r.getDerivedStateFromProps,A=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";A||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==s||c!==d)&&kI(e,o,s,d),eA=!1;var h=e.memoizedState;o.state=h,nw(e,s,o,n),c=e.memoizedState,l!==s||h!==c||vo.current||eA?(typeof u=="function"&&(T4(e,r,u,s),c=e.memoizedState),(l=eA||II(e,r,l,s,h,c,d))?(A||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=s,e.memoizedState=c),o.props=s,o.state=c,o.context=d,s=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),s=!1)}else{o=e.stateNode,OR(t,e),l=e.memoizedProps,d=e.type===e.elementType?l:Zl(e.type,l),o.props=d,A=e.pendingProps,h=o.context,c=r.contextType,typeof c=="object"&&c!==null?c=Bl(c):(c=bo(r)?bf:Pi.current,c=G0(e,c));var f=r.getDerivedStateFromProps;(u=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==A||h!==c)&&kI(e,o,s,c),eA=!1,h=e.memoizedState,o.state=h,nw(e,s,o,n);var p=e.memoizedState;l!==A||h!==p||vo.current||eA?(typeof f=="function"&&(T4(e,r,f,s),p=e.memoizedState),(d=eA||II(e,r,d,s,h,p,c)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(s,p,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(s,p,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),e.memoizedProps=s,e.memoizedState=p),o.props=s,o.state=p,o.context=c,s=d):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),s=!1)}return F4(t,e,r,s,i,n)}function F4(t,e,r,s,n,i){d8(t,e);var o=(e.flags&128)!==0;if(!s&&!o)return n&&wI(e,r,!1),Zd(t,e,i);s=e.stateNode,$K.current=e;var l=o&&typeof r.getDerivedStateFromError!="function"?null:s.render();return e.flags|=1,t!==null&&o?(e.child=X0(e,t.child,null,i),e.child=X0(e,null,l,i)):Hi(t,e,l,i),e.memoizedState=s.state,n&&wI(e,r,!0),e.child}function u8(t){var e=t.stateNode;e.pendingContext?bI(t,e.pendingContext,e.pendingContext!==e.context):e.context&&bI(t,e.context,!1),vE(t,e.containerInfo)}function OI(t,e,r,s,n){return Y0(),fE(n),e.flags|=256,Hi(t,e,r,s),e.child}var P4={dehydrated:null,treeContext:null,retryLane:0};function D4(t){return{baseLanes:t,cachePool:null,transitions:null}}function A8(t,e,r){var s=e.pendingProps,n=Nn.current,i=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(n&2)!==0),l?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(n|=1),rn(Nn,n&1),t===null)return E4(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=s.children,t=s.fallback,i?(s=e.mode,i=e.child,o={mode:"hidden",children:o},!(s&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=P2(o,s,0,null),t=df(t,s,r,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=D4(r),e.memoizedState=P4,t):_E(e,o));if(n=t.memoizedState,n!==null&&(l=n.dehydrated,l!==null))return KK(t,e,o,s,l,n,r);if(i){i=s.fallback,o=e.mode,n=t.child,l=n.sibling;var c={mode:"hidden",children:s.children};return!(o&1)&&e.child!==n?(s=e.child,s.childLanes=0,s.pendingProps=c,e.deletions=null):(s=kA(n,c),s.subtreeFlags=n.subtreeFlags&14680064),l!==null?i=kA(l,i):(i=df(i,o,r,null),i.flags|=2),i.return=e,s.return=e,s.sibling=i,e.child=s,s=i,i=e.child,o=t.child.memoizedState,o=o===null?D4(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~r,e.memoizedState=P4,s}return i=t.child,t=i.sibling,s=kA(i,{mode:"visible",children:s.children}),!(e.mode&1)&&(s.lanes=r),s.return=e,s.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=s,e.memoizedState=null,s}function _E(t,e){return e=P2({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Xv(t,e,r,s){return s!==null&&fE(s),X0(e,t.child,null,r),t=_E(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function KK(t,e,r,s,n,i,o){if(r)return e.flags&256?(e.flags&=-257,s=T5(Error(Wt(422))),Xv(t,e,o,s)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=s.fallback,n=e.mode,s=P2({mode:"visible",children:s.children},n,0,null),i=df(i,n,o,null),i.flags|=2,s.return=e,i.return=e,s.sibling=i,e.child=s,e.mode&1&&X0(e,t.child,null,o),e.child.memoizedState=D4(o),e.memoizedState=P4,i);if(!(e.mode&1))return Xv(t,e,o,null);if(n.data==="$!"){if(s=n.nextSibling&&n.nextSibling.dataset,s)var l=s.dgst;return s=l,i=Error(Wt(419)),s=T5(i,s,void 0),Xv(t,e,o,s)}if(l=(o&t.childLanes)!==0,go||l){if(s=$a,s!==null){switch(o&-o){case 4:n=2;break;case 16:n=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:n=32;break;case 536870912:n=268435456;break;default:n=0}n=n&(s.suspendedLanes|o)?0:n,n!==0&&n!==i.retryLane&&(i.retryLane=n,Jd(t,n),uc(s,t,n,-1))}return PE(),s=T5(Error(Wt(421))),Xv(t,e,o,s)}return n.data==="$?"?(e.flags|=128,e.child=t.child,e=nz.bind(null,t),n._reactRetry=e,null):(t=i.treeContext,$o=EA(n.nextSibling),qo=e,bn=!0,sc=null,t!==null&&(bl[wl++]=Dd,bl[wl++]=Rd,bl[wl++]=wf,Dd=t.id,Rd=t.overflow,wf=e),e=_E(e,s.children),e.flags|=4096,e)}function UI(t,e,r){t.lanes|=e;var s=t.alternate;s!==null&&(s.lanes|=e),_4(t.return,e,r)}function I5(t,e,r,s,n){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:s,tail:r,tailMode:n}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=s,i.tail=r,i.tailMode=n)}function h8(t,e,r){var s=e.pendingProps,n=s.revealOrder,i=s.tail;if(Hi(t,e,s.children,r),s=Nn.current,s&2)s=s&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&UI(t,r,e);else if(t.tag===19)UI(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}s&=1}if(rn(Nn,s),!(e.mode&1))e.memoizedState=null;else switch(n){case"forwards":for(r=e.child,n=null;r!==null;)t=r.alternate,t!==null&&aw(t)===null&&(n=r),r=r.sibling;r=n,r===null?(n=e.child,e.child=null):(n=r.sibling,r.sibling=null),I5(e,!1,n,r,i);break;case"backwards":for(r=null,n=e.child,e.child=null;n!==null;){if(t=n.alternate,t!==null&&aw(t)===null){e.child=n;break}t=n.sibling,n.sibling=r,r=n,n=t}I5(e,!0,r,null,i);break;case"together":I5(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function fb(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Zd(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),Cf|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Wt(153));if(e.child!==null){for(t=e.child,r=kA(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=kA(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function zK(t,e,r){switch(e.tag){case 3:u8(e),Y0();break;case 5:UR(e);break;case 1:bo(e.type)&&Zb(e);break;case 4:vE(e,e.stateNode.containerInfo);break;case 10:var s=e.type._context,n=e.memoizedProps.value;rn(rw,s._currentValue),s._currentValue=n;break;case 13:if(s=e.memoizedState,s!==null)return s.dehydrated!==null?(rn(Nn,Nn.current&1),e.flags|=128,null):r&e.child.childLanes?A8(t,e,r):(rn(Nn,Nn.current&1),t=Zd(t,e,r),t!==null?t.sibling:null);rn(Nn,Nn.current&1);break;case 19:if(s=(r&e.childLanes)!==0,t.flags&128){if(s)return h8(t,e,r);e.flags|=128}if(n=e.memoizedState,n!==null&&(n.rendering=null,n.tail=null,n.lastEffect=null),rn(Nn,Nn.current),s)break;return null;case 22:case 23:return e.lanes=0,c8(t,e,r)}return Zd(t,e,r)}var f8,R4,m8,p8;f8=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};R4=function(){};m8=function(t,e,r,s){var n=t.memoizedProps;if(n!==s){t=e.stateNode,ef(qc.current);var i=null;switch(r){case"input":n=n4(t,n),s=n4(t,s),i=[];break;case"select":n=Tn({},n,{value:void 0}),s=Tn({},s,{value:void 0}),i=[];break;case"textarea":n=o4(t,n),s=o4(t,s),i=[];break;default:typeof n.onClick!="function"&&typeof s.onClick=="function"&&(t.onclick=Xb)}c4(r,s);var o;r=null;for(d in n)if(!s.hasOwnProperty(d)&&n.hasOwnProperty(d)&&n[d]!=null)if(d==="style"){var l=n[d];for(o in l)l.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(Bx.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in s){var c=s[d];if(l=n!=null?n[d]:void 0,s.hasOwnProperty(d)&&c!==l&&(c!=null||l!=null))if(d==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(r||(r={}),r[o]=c[o])}else r||(i||(i=[]),i.push(d,r)),r=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(Bx.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&ln("scroll",t),i||l===c||(i=[])):(i=i||[]).push(d,c))}r&&(i=i||[]).push("style",r);var d=i;(e.updateQueue=d)&&(e.flags|=4)}};p8=function(t,e,r,s){r!==s&&(e.flags|=4)};function ug(t,e){if(!bn)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var s=null;r!==null;)r.alternate!==null&&(s=r),r=r.sibling;s===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:s.sibling=null}}function Ai(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,s=0;if(e)for(var n=t.child;n!==null;)r|=n.lanes|n.childLanes,s|=n.subtreeFlags&14680064,s|=n.flags&14680064,n.return=t,n=n.sibling;else for(n=t.child;n!==null;)r|=n.lanes|n.childLanes,s|=n.subtreeFlags,s|=n.flags,n.return=t,n=n.sibling;return t.subtreeFlags|=s,t.childLanes=r,e}function qK(t,e,r){var s=e.pendingProps;switch(hE(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ai(e),null;case 1:return bo(e.type)&&Jb(),Ai(e),null;case 3:return s=e.stateNode,J0(),mn(vo),mn(Pi),wE(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(t===null||t.child===null)&&(Gv(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,sc!==null&&($4(sc),sc=null))),R4(t,e),Ai(e),null;case 5:bE(e);var n=ef($x.current);if(r=e.type,t!==null&&e.stateNode!=null)m8(t,e,r,s,n),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!s){if(e.stateNode===null)throw Error(Wt(166));return Ai(e),null}if(t=ef(qc.current),Gv(e)){s=e.stateNode,r=e.type;var i=e.memoizedProps;switch(s[Oc]=e,s[Vx]=i,t=(e.mode&1)!==0,r){case"dialog":ln("cancel",s),ln("close",s);break;case"iframe":case"object":case"embed":ln("load",s);break;case"video":case"audio":for(n=0;n<Ig.length;n++)ln(Ig[n],s);break;case"source":ln("error",s);break;case"img":case"image":case"link":ln("error",s),ln("load",s);break;case"details":ln("toggle",s);break;case"input":WT(s,i),ln("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!i.multiple},ln("invalid",s);break;case"textarea":YT(s,i),ln("invalid",s)}c4(r,i),n=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?s.textContent!==l&&(i.suppressHydrationWarning!==!0&&Wv(s.textContent,l,t),n=["children",l]):typeof l=="number"&&s.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&Wv(s.textContent,l,t),n=["children",""+l]):Bx.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&ln("scroll",s)}switch(r){case"input":Mv(s),GT(s,i,!0);break;case"textarea":Mv(s),XT(s);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(s.onclick=Xb)}s=n,e.updateQueue=s,s!==null&&(e.flags|=4)}else{o=n.nodeType===9?n:n.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=$D(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof s.is=="string"?t=o.createElement(r,{is:s.is}):(t=o.createElement(r),r==="select"&&(o=t,s.multiple?o.multiple=!0:s.size&&(o.size=s.size))):t=o.createElementNS(t,r),t[Oc]=e,t[Vx]=s,f8(t,e,!1,!1),e.stateNode=t;e:{switch(o=d4(r,s),r){case"dialog":ln("cancel",t),ln("close",t),n=s;break;case"iframe":case"object":case"embed":ln("load",t),n=s;break;case"video":case"audio":for(n=0;n<Ig.length;n++)ln(Ig[n],t);n=s;break;case"source":ln("error",t),n=s;break;case"img":case"image":case"link":ln("error",t),ln("load",t),n=s;break;case"details":ln("toggle",t),n=s;break;case"input":WT(t,s),n=n4(t,s),ln("invalid",t);break;case"option":n=s;break;case"select":t._wrapperState={wasMultiple:!!s.multiple},n=Tn({},s,{value:void 0}),ln("invalid",t);break;case"textarea":YT(t,s),n=o4(t,s),ln("invalid",t);break;default:n=s}c4(r,n),l=n;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?qD(t,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&KD(t,c)):i==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&Fx(t,c):typeof c=="number"&&Fx(t,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Bx.hasOwnProperty(i)?c!=null&&i==="onScroll"&&ln("scroll",t):c!=null&&JS(t,i,c,o))}switch(r){case"input":Mv(t),GT(t,s,!1);break;case"textarea":Mv(t),XT(t);break;case"option":s.value!=null&&t.setAttribute("value",""+VA(s.value));break;case"select":t.multiple=!!s.multiple,i=s.value,i!=null?C0(t,!!s.multiple,i,!1):s.defaultValue!=null&&C0(t,!!s.multiple,s.defaultValue,!0);break;default:typeof n.onClick=="function"&&(t.onclick=Xb)}switch(r){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Ai(e),null;case 6:if(t&&e.stateNode!=null)p8(t,e,t.memoizedProps,s);else{if(typeof s!="string"&&e.stateNode===null)throw Error(Wt(166));if(r=ef($x.current),ef(qc.current),Gv(e)){if(s=e.stateNode,r=e.memoizedProps,s[Oc]=e,(i=s.nodeValue!==r)&&(t=qo,t!==null))switch(t.tag){case 3:Wv(s.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Wv(s.nodeValue,r,(t.mode&1)!==0)}i&&(e.flags|=4)}else s=(r.nodeType===9?r:r.ownerDocument).createTextNode(s),s[Oc]=e,e.stateNode=s}return Ai(e),null;case 13:if(mn(Nn),s=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(bn&&$o!==null&&e.mode&1&&!(e.flags&128))PR(),Y0(),e.flags|=98560,i=!1;else if(i=Gv(e),s!==null&&s.dehydrated!==null){if(t===null){if(!i)throw Error(Wt(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Wt(317));i[Oc]=e}else Y0(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Ai(e),i=!1}else sc!==null&&($4(sc),sc=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(s=s!==null,s!==(t!==null&&t.memoizedState!==null)&&s&&(e.child.flags|=8192,e.mode&1&&(t===null||Nn.current&1?Ca===0&&(Ca=3):PE())),e.updateQueue!==null&&(e.flags|=4),Ai(e),null);case 4:return J0(),R4(t,e),t===null&&Mx(e.stateNode.containerInfo),Ai(e),null;case 10:return gE(e.type._context),Ai(e),null;case 17:return bo(e.type)&&Jb(),Ai(e),null;case 19:if(mn(Nn),i=e.memoizedState,i===null)return Ai(e),null;if(s=(e.flags&128)!==0,o=i.rendering,o===null)if(s)ug(i,!1);else{if(Ca!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=aw(t),o!==null){for(e.flags|=128,ug(i,!1),s=o.updateQueue,s!==null&&(e.updateQueue=s,e.flags|=4),e.subtreeFlags=0,s=r,r=e.child;r!==null;)i=r,t=s,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return rn(Nn,Nn.current&1|2),e.child}t=t.sibling}i.tail!==null&&Gn()>ep&&(e.flags|=128,s=!0,ug(i,!1),e.lanes=4194304)}else{if(!s)if(t=aw(o),t!==null){if(e.flags|=128,s=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),ug(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!bn)return Ai(e),null}else 2*Gn()-i.renderingStartTime>ep&&r!==1073741824&&(e.flags|=128,s=!0,ug(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(r=i.last,r!==null?r.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Gn(),e.sibling=null,r=Nn.current,rn(Nn,s?r&1|2:r&1),e):(Ai(e),null);case 22:case 23:return FE(),s=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==s&&(e.flags|=8192),s&&e.mode&1?Lo&1073741824&&(Ai(e),e.subtreeFlags&6&&(e.flags|=8192)):Ai(e),null;case 24:return null;case 25:return null}throw Error(Wt(156,e.tag))}function WK(t,e){switch(hE(e),e.tag){case 1:return bo(e.type)&&Jb(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return J0(),mn(vo),mn(Pi),wE(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return bE(e),null;case 13:if(mn(Nn),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Wt(340));Y0()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return mn(Nn),null;case 4:return J0(),null;case 10:return gE(e.type._context),null;case 22:case 23:return FE(),null;case 24:return null;default:return null}}var Jv=!1,ji=!1,GK=typeof WeakSet=="function"?WeakSet:Set,hr=null;function p0(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(s){Dn(t,e,s)}else r.current=null}function L4(t,e,r){try{r()}catch(s){Dn(t,e,s)}}var MI=!1;function YK(t,e){if(v4=Wb,t=bR(),uE(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var s=r.getSelection&&r.getSelection();if(s&&s.rangeCount!==0){r=s.anchorNode;var n=s.anchorOffset,i=s.focusNode;s=s.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var o=0,l=-1,c=-1,d=0,u=0,A=t,h=null;t:for(;;){for(var f;A!==r||n!==0&&A.nodeType!==3||(l=o+n),A!==i||s!==0&&A.nodeType!==3||(c=o+s),A.nodeType===3&&(o+=A.nodeValue.length),(f=A.firstChild)!==null;)h=A,A=f;for(;;){if(A===t)break t;if(h===r&&++d===n&&(l=o),h===i&&++u===s&&(c=o),(f=A.nextSibling)!==null)break;A=h,h=A.parentNode}A=f}r=l===-1||c===-1?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(b4={focusedElem:t,selectionRange:r},Wb=!1,hr=e;hr!==null;)if(e=hr,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,hr=t;else for(;hr!==null;){e=hr;try{var p=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var m=p.memoizedProps,g=p.memoizedState,y=e.stateNode,v=y.getSnapshotBeforeUpdate(e.elementType===e.type?m:Zl(e.type,m),g);y.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var x=e.stateNode.containerInfo;x.nodeType===1?x.textContent="":x.nodeType===9&&x.documentElement&&x.removeChild(x.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Wt(163))}}catch(E){Dn(e,e.return,E)}if(t=e.sibling,t!==null){t.return=e.return,hr=t;break}hr=e.return}return p=MI,MI=!1,p}function ex(t,e,r){var s=e.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var n=s=s.next;do{if((n.tag&t)===t){var i=n.destroy;n.destroy=void 0,i!==void 0&&L4(e,r,i)}n=n.next}while(n!==s)}}function B2(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var s=r.create;r.destroy=s()}r=r.next}while(r!==e)}}function O4(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function g8(t){var e=t.alternate;e!==null&&(t.alternate=null,g8(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Oc],delete e[Vx],delete e[C4],delete e[BK],delete e[FK])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function x8(t){return t.tag===5||t.tag===3||t.tag===4}function QI(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||x8(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function U4(t,e,r){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=Xb));else if(s!==4&&(t=t.child,t!==null))for(U4(t,e,r),t=t.sibling;t!==null;)U4(t,e,r),t=t.sibling}function M4(t,e,r){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(s!==4&&(t=t.child,t!==null))for(M4(t,e,r),t=t.sibling;t!==null;)M4(t,e,r),t=t.sibling}var Xa=null,tc=!1;function Vu(t,e,r){for(r=r.child;r!==null;)y8(t,e,r),r=r.sibling}function y8(t,e,r){if(zc&&typeof zc.onCommitFiberUnmount=="function")try{zc.onCommitFiberUnmount(C2,r)}catch{}switch(r.tag){case 5:ji||p0(r,e);case 6:var s=Xa,n=tc;Xa=null,Vu(t,e,r),Xa=s,tc=n,Xa!==null&&(tc?(t=Xa,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):Xa.removeChild(r.stateNode));break;case 18:Xa!==null&&(tc?(t=Xa,r=r.stateNode,t.nodeType===8?N5(t.parentNode,r):t.nodeType===1&&N5(t,r),Lx(t)):N5(Xa,r.stateNode));break;case 4:s=Xa,n=tc,Xa=r.stateNode.containerInfo,tc=!0,Vu(t,e,r),Xa=s,tc=n;break;case 0:case 11:case 14:case 15:if(!ji&&(s=r.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){n=s=s.next;do{var i=n,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&L4(r,e,o),n=n.next}while(n!==s)}Vu(t,e,r);break;case 1:if(!ji&&(p0(r,e),s=r.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=r.memoizedProps,s.state=r.memoizedState,s.componentWillUnmount()}catch(l){Dn(r,e,l)}Vu(t,e,r);break;case 21:Vu(t,e,r);break;case 22:r.mode&1?(ji=(s=ji)||r.memoizedState!==null,Vu(t,e,r),ji=s):Vu(t,e,r);break;default:Vu(t,e,r)}}function VI(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new GK),e.forEach(function(s){var n=az.bind(null,t,s);r.has(s)||(r.add(s),s.then(n,n))})}}function Wl(t,e){var r=e.deletions;if(r!==null)for(var s=0;s<r.length;s++){var n=r[s];try{var i=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:Xa=l.stateNode,tc=!1;break e;case 3:Xa=l.stateNode.containerInfo,tc=!0;break e;case 4:Xa=l.stateNode.containerInfo,tc=!0;break e}l=l.return}if(Xa===null)throw Error(Wt(160));y8(i,o,n),Xa=null,tc=!1;var c=n.alternate;c!==null&&(c.return=null),n.return=null}catch(d){Dn(n,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)v8(e,t),e=e.sibling}function v8(t,e){var r=t.alternate,s=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Wl(e,t),Tc(t),s&4){try{ex(3,t,t.return),B2(3,t)}catch(m){Dn(t,t.return,m)}try{ex(5,t,t.return)}catch(m){Dn(t,t.return,m)}}break;case 1:Wl(e,t),Tc(t),s&512&&r!==null&&p0(r,r.return);break;case 5:if(Wl(e,t),Tc(t),s&512&&r!==null&&p0(r,r.return),t.flags&32){var n=t.stateNode;try{Fx(n,"")}catch(m){Dn(t,t.return,m)}}if(s&4&&(n=t.stateNode,n!=null)){var i=t.memoizedProps,o=r!==null?r.memoizedProps:i,l=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&VD(n,i),d4(l,o);var d=d4(l,i);for(o=0;o<c.length;o+=2){var u=c[o],A=c[o+1];u==="style"?qD(n,A):u==="dangerouslySetInnerHTML"?KD(n,A):u==="children"?Fx(n,A):JS(n,u,A,d)}switch(l){case"input":a4(n,i);break;case"textarea":HD(n,i);break;case"select":var h=n._wrapperState.wasMultiple;n._wrapperState.wasMultiple=!!i.multiple;var f=i.value;f!=null?C0(n,!!i.multiple,f,!1):h!==!!i.multiple&&(i.defaultValue!=null?C0(n,!!i.multiple,i.defaultValue,!0):C0(n,!!i.multiple,i.multiple?[]:"",!1))}n[Vx]=i}catch(m){Dn(t,t.return,m)}}break;case 6:if(Wl(e,t),Tc(t),s&4){if(t.stateNode===null)throw Error(Wt(162));n=t.stateNode,i=t.memoizedProps;try{n.nodeValue=i}catch(m){Dn(t,t.return,m)}}break;case 3:if(Wl(e,t),Tc(t),s&4&&r!==null&&r.memoizedState.isDehydrated)try{Lx(e.containerInfo)}catch(m){Dn(t,t.return,m)}break;case 4:Wl(e,t),Tc(t);break;case 13:Wl(e,t),Tc(t),n=t.child,n.flags&8192&&(i=n.memoizedState!==null,n.stateNode.isHidden=i,!i||n.alternate!==null&&n.alternate.memoizedState!==null||(kE=Gn())),s&4&&VI(t);break;case 22:if(u=r!==null&&r.memoizedState!==null,t.mode&1?(ji=(d=ji)||u,Wl(e,t),ji=d):Wl(e,t),Tc(t),s&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!u&&t.mode&1)for(hr=t,u=t.child;u!==null;){for(A=hr=u;hr!==null;){switch(h=hr,f=h.child,h.tag){case 0:case 11:case 14:case 15:ex(4,h,h.return);break;case 1:p0(h,h.return);var p=h.stateNode;if(typeof p.componentWillUnmount=="function"){s=h,r=h.return;try{e=s,p.props=e.memoizedProps,p.state=e.memoizedState,p.componentWillUnmount()}catch(m){Dn(s,r,m)}}break;case 5:p0(h,h.return);break;case 22:if(h.memoizedState!==null){$I(A);continue}}f!==null?(f.return=h,hr=f):$I(A)}u=u.sibling}e:for(u=null,A=t;;){if(A.tag===5){if(u===null){u=A;try{n=A.stateNode,d?(i=n.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=A.stateNode,c=A.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=zD("display",o))}catch(m){Dn(t,t.return,m)}}}else if(A.tag===6){if(u===null)try{A.stateNode.nodeValue=d?"":A.memoizedProps}catch(m){Dn(t,t.return,m)}}else if((A.tag!==22&&A.tag!==23||A.memoizedState===null||A===t)&&A.child!==null){A.child.return=A,A=A.child;continue}if(A===t)break e;for(;A.sibling===null;){if(A.return===null||A.return===t)break e;u===A&&(u=null),A=A.return}u===A&&(u=null),A.sibling.return=A.return,A=A.sibling}}break;case 19:Wl(e,t),Tc(t),s&4&&VI(t);break;case 21:break;default:Wl(e,t),Tc(t)}}function Tc(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(x8(r)){var s=r;break e}r=r.return}throw Error(Wt(160))}switch(s.tag){case 5:var n=s.stateNode;s.flags&32&&(Fx(n,""),s.flags&=-33);var i=QI(t);M4(t,i,n);break;case 3:case 4:var o=s.stateNode.containerInfo,l=QI(t);U4(t,l,o);break;default:throw Error(Wt(161))}}catch(c){Dn(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function XK(t,e,r){hr=t,b8(t)}function b8(t,e,r){for(var s=(t.mode&1)!==0;hr!==null;){var n=hr,i=n.child;if(n.tag===22&&s){var o=n.memoizedState!==null||Jv;if(!o){var l=n.alternate,c=l!==null&&l.memoizedState!==null||ji;l=Jv;var d=ji;if(Jv=o,(ji=c)&&!d)for(hr=n;hr!==null;)o=hr,c=o.child,o.tag===22&&o.memoizedState!==null?KI(n):c!==null?(c.return=o,hr=c):KI(n);for(;i!==null;)hr=i,b8(i),i=i.sibling;hr=n,Jv=l,ji=d}HI(t)}else n.subtreeFlags&8772&&i!==null?(i.return=n,hr=i):HI(t)}}function HI(t){for(;hr!==null;){var e=hr;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:ji||B2(5,e);break;case 1:var s=e.stateNode;if(e.flags&4&&!ji)if(r===null)s.componentDidMount();else{var n=e.elementType===e.type?r.memoizedProps:Zl(e.type,r.memoizedProps);s.componentDidUpdate(n,r.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&EI(e,i,s);break;case 3:var o=e.updateQueue;if(o!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}EI(e,o,r)}break;case 5:var l=e.stateNode;if(r===null&&e.flags&4){r=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var u=d.memoizedState;if(u!==null){var A=u.dehydrated;A!==null&&Lx(A)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Wt(163))}ji||e.flags&512&&O4(e)}catch(h){Dn(e,e.return,h)}}if(e===t){hr=null;break}if(r=e.sibling,r!==null){r.return=e.return,hr=r;break}hr=e.return}}function $I(t){for(;hr!==null;){var e=hr;if(e===t){hr=null;break}var r=e.sibling;if(r!==null){r.return=e.return,hr=r;break}hr=e.return}}function KI(t){for(;hr!==null;){var e=hr;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{B2(4,e)}catch(c){Dn(e,r,c)}break;case 1:var s=e.stateNode;if(typeof s.componentDidMount=="function"){var n=e.return;try{s.componentDidMount()}catch(c){Dn(e,n,c)}}var i=e.return;try{O4(e)}catch(c){Dn(e,i,c)}break;case 5:var o=e.return;try{O4(e)}catch(c){Dn(e,o,c)}}}catch(c){Dn(e,e.return,c)}if(e===t){hr=null;break}var l=e.sibling;if(l!==null){l.return=e.return,hr=l;break}hr=e.return}}var JK=Math.ceil,lw=cu.ReactCurrentDispatcher,TE=cu.ReactCurrentOwner,Il=cu.ReactCurrentBatchConfig,ys=0,$a=null,ga=null,ai=0,Lo=0,g0=ih(0),Ca=0,Wx=null,Cf=0,F2=0,IE=0,tx=null,mo=null,kE=0,ep=1/0,Bd=null,cw=!1,Q4=null,TA=null,Zv=!1,hA=null,dw=0,rx=0,V4=null,mb=-1,pb=0;function Yi(){return ys&6?Gn():mb!==-1?mb:mb=Gn()}function IA(t){return t.mode&1?ys&2&&ai!==0?ai&-ai:DK.transition!==null?(pb===0&&(pb=aR()),pb):(t=Ms,t!==0||(t=window.event,t=t===void 0?16:AR(t.type)),t):1}function uc(t,e,r,s){if(50<rx)throw rx=0,V4=null,Error(Wt(185));Iy(t,r,s),(!(ys&2)||t!==$a)&&(t===$a&&(!(ys&2)&&(F2|=r),Ca===4&&sA(t,ai)),wo(t,s),r===1&&ys===0&&!(e.mode&1)&&(ep=Gn()+500,T2&&oh()))}function wo(t,e){var r=t.callbackNode;D$(t,e);var s=qb(t,t===$a?ai:0);if(s===0)r!==null&&eI(r),t.callbackNode=null,t.callbackPriority=0;else if(e=s&-s,t.callbackPriority!==e){if(r!=null&&eI(r),e===1)t.tag===0?PK(zI.bind(null,t)):kR(zI.bind(null,t)),IK(function(){!(ys&6)&&oh()}),r=null;else{switch(iR(s)){case 1:r=sE;break;case 4:r=sR;break;case 16:r=zb;break;case 536870912:r=nR;break;default:r=zb}r=T8(r,w8.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function w8(t,e){if(mb=-1,pb=0,ys&6)throw Error(Wt(327));var r=t.callbackNode;if(T0()&&t.callbackNode!==r)return null;var s=qb(t,t===$a?ai:0);if(s===0)return null;if(s&30||s&t.expiredLanes||e)e=uw(t,s);else{e=s;var n=ys;ys|=2;var i=C8();($a!==t||ai!==e)&&(Bd=null,ep=Gn()+500,cf(t,e));do try{tz();break}catch(l){N8(t,l)}while(!0);pE(),lw.current=i,ys=n,ga!==null?e=0:($a=null,ai=0,e=Ca)}if(e!==0){if(e===2&&(n=m4(t),n!==0&&(s=n,e=H4(t,n))),e===1)throw r=Wx,cf(t,0),sA(t,s),wo(t,Gn()),r;if(e===6)sA(t,s);else{if(n=t.current.alternate,!(s&30)&&!ZK(n)&&(e=uw(t,s),e===2&&(i=m4(t),i!==0&&(s=i,e=H4(t,i))),e===1))throw r=Wx,cf(t,0),sA(t,s),wo(t,Gn()),r;switch(t.finishedWork=n,t.finishedLanes=s,e){case 0:case 1:throw Error(Wt(345));case 2:Oh(t,mo,Bd);break;case 3:if(sA(t,s),(s&130023424)===s&&(e=kE+500-Gn(),10<e)){if(qb(t,0)!==0)break;if(n=t.suspendedLanes,(n&s)!==s){Yi(),t.pingedLanes|=t.suspendedLanes&n;break}t.timeoutHandle=N4(Oh.bind(null,t,mo,Bd),e);break}Oh(t,mo,Bd);break;case 4:if(sA(t,s),(s&4194240)===s)break;for(e=t.eventTimes,n=-1;0<s;){var o=31-dc(s);i=1<<o,o=e[o],o>n&&(n=o),s&=~i}if(s=n,s=Gn()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*JK(s/1960))-s,10<s){t.timeoutHandle=N4(Oh.bind(null,t,mo,Bd),s);break}Oh(t,mo,Bd);break;case 5:Oh(t,mo,Bd);break;default:throw Error(Wt(329))}}}return wo(t,Gn()),t.callbackNode===r?w8.bind(null,t):null}function H4(t,e){var r=tx;return t.current.memoizedState.isDehydrated&&(cf(t,e).flags|=256),t=uw(t,e),t!==2&&(e=mo,mo=r,e!==null&&$4(e)),t}function $4(t){mo===null?mo=t:mo.push.apply(mo,t)}function ZK(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var s=0;s<r.length;s++){var n=r[s],i=n.getSnapshot;n=n.value;try{if(!fc(i(),n))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function sA(t,e){for(e&=~IE,e&=~F2,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-dc(e),s=1<<r;t[r]=-1,e&=~s}}function zI(t){if(ys&6)throw Error(Wt(327));T0();var e=qb(t,0);if(!(e&1))return wo(t,Gn()),null;var r=uw(t,e);if(t.tag!==0&&r===2){var s=m4(t);s!==0&&(e=s,r=H4(t,s))}if(r===1)throw r=Wx,cf(t,0),sA(t,e),wo(t,Gn()),r;if(r===6)throw Error(Wt(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Oh(t,mo,Bd),wo(t,Gn()),null}function BE(t,e){var r=ys;ys|=1;try{return t(e)}finally{ys=r,ys===0&&(ep=Gn()+500,T2&&oh())}}function jf(t){hA!==null&&hA.tag===0&&!(ys&6)&&T0();var e=ys;ys|=1;var r=Il.transition,s=Ms;try{if(Il.transition=null,Ms=1,t)return t()}finally{Ms=s,Il.transition=r,ys=e,!(ys&6)&&oh()}}function FE(){Lo=g0.current,mn(g0)}function cf(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,TK(r)),ga!==null)for(r=ga.return;r!==null;){var s=r;switch(hE(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&Jb();break;case 3:J0(),mn(vo),mn(Pi),wE();break;case 5:bE(s);break;case 4:J0();break;case 13:mn(Nn);break;case 19:mn(Nn);break;case 10:gE(s.type._context);break;case 22:case 23:FE()}r=r.return}if($a=t,ga=t=kA(t.current,null),ai=Lo=e,Ca=0,Wx=null,IE=F2=Cf=0,mo=tx=null,Zh!==null){for(e=0;e<Zh.length;e++)if(r=Zh[e],s=r.interleaved,s!==null){r.interleaved=null;var n=s.next,i=r.pending;if(i!==null){var o=i.next;i.next=n,s.next=o}r.pending=s}Zh=null}return t}function N8(t,e){do{var r=ga;try{if(pE(),Ab.current=ow,iw){for(var s=_n.memoizedState;s!==null;){var n=s.queue;n!==null&&(n.pending=null),s=s.next}iw=!1}if(Nf=0,Ua=ba=_n=null,Zg=!1,Kx=0,TE.current=null,r===null||r.return===null){Ca=1,Wx=e,ga=null;break}e:{var i=t,o=r.return,l=r,c=e;if(e=ai,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,u=l,A=u.tag;if(!(u.mode&1)&&(A===0||A===11||A===15)){var h=u.alternate;h?(u.updateQueue=h.updateQueue,u.memoizedState=h.memoizedState,u.lanes=h.lanes):(u.updateQueue=null,u.memoizedState=null)}var f=FI(o);if(f!==null){f.flags&=-257,PI(f,o,l,i,e),f.mode&1&&BI(i,d,e),e=f,c=d;var p=e.updateQueue;if(p===null){var m=new Set;m.add(c),e.updateQueue=m}else p.add(c);break e}else{if(!(e&1)){BI(i,d,e),PE();break e}c=Error(Wt(426))}}else if(bn&&l.mode&1){var g=FI(o);if(g!==null){!(g.flags&65536)&&(g.flags|=256),PI(g,o,l,i,e),fE(Z0(c,l));break e}}i=c=Z0(c,l),Ca!==4&&(Ca=2),tx===null?tx=[i]:tx.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var y=i8(i,c,e);SI(i,y);break e;case 1:l=c;var v=i.type,x=i.stateNode;if(!(i.flags&128)&&(typeof v.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(TA===null||!TA.has(x)))){i.flags|=65536,e&=-e,i.lanes|=e;var E=o8(i,l,e);SI(i,E);break e}}i=i.return}while(i!==null)}S8(r)}catch(T){e=T,ga===r&&r!==null&&(ga=r=r.return);continue}break}while(!0)}function C8(){var t=lw.current;return lw.current=ow,t===null?ow:t}function PE(){(Ca===0||Ca===3||Ca===2)&&(Ca=4),$a===null||!(Cf&268435455)&&!(F2&268435455)||sA($a,ai)}function uw(t,e){var r=ys;ys|=2;var s=C8();($a!==t||ai!==e)&&(Bd=null,cf(t,e));do try{ez();break}catch(n){N8(t,n)}while(!0);if(pE(),ys=r,lw.current=s,ga!==null)throw Error(Wt(261));return $a=null,ai=0,Ca}function ez(){for(;ga!==null;)j8(ga)}function tz(){for(;ga!==null&&!S$();)j8(ga)}function j8(t){var e=_8(t.alternate,t,Lo);t.memoizedProps=t.pendingProps,e===null?S8(t):ga=e,TE.current=null}function S8(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=WK(r,e),r!==null){r.flags&=32767,ga=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Ca=6,ga=null;return}}else if(r=qK(r,e,Lo),r!==null){ga=r;return}if(e=e.sibling,e!==null){ga=e;return}ga=e=t}while(e!==null);Ca===0&&(Ca=5)}function Oh(t,e,r){var s=Ms,n=Il.transition;try{Il.transition=null,Ms=1,rz(t,e,r,s)}finally{Il.transition=n,Ms=s}return null}function rz(t,e,r,s){do T0();while(hA!==null);if(ys&6)throw Error(Wt(327));r=t.finishedWork;var n=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(Wt(177));t.callbackNode=null,t.callbackPriority=0;var i=r.lanes|r.childLanes;if(R$(t,i),t===$a&&(ga=$a=null,ai=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Zv||(Zv=!0,T8(zb,function(){return T0(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=Il.transition,Il.transition=null;var o=Ms;Ms=1;var l=ys;ys|=4,TE.current=null,YK(t,r),v8(r,t),wK(b4),Wb=!!v4,b4=v4=null,t.current=r,XK(r),E$(),ys=l,Ms=o,Il.transition=i}else t.current=r;if(Zv&&(Zv=!1,hA=t,dw=n),i=t.pendingLanes,i===0&&(TA=null),I$(r.stateNode),wo(t,Gn()),e!==null)for(s=t.onRecoverableError,r=0;r<e.length;r++)n=e[r],s(n.value,{componentStack:n.stack,digest:n.digest});if(cw)throw cw=!1,t=Q4,Q4=null,t;return dw&1&&t.tag!==0&&T0(),i=t.pendingLanes,i&1?t===V4?rx++:(rx=0,V4=t):rx=0,oh(),null}function T0(){if(hA!==null){var t=iR(dw),e=Il.transition,r=Ms;try{if(Il.transition=null,Ms=16>t?16:t,hA===null)var s=!1;else{if(t=hA,hA=null,dw=0,ys&6)throw Error(Wt(331));var n=ys;for(ys|=4,hr=t.current;hr!==null;){var i=hr,o=i.child;if(hr.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var d=l[c];for(hr=d;hr!==null;){var u=hr;switch(u.tag){case 0:case 11:case 15:ex(8,u,i)}var A=u.child;if(A!==null)A.return=u,hr=A;else for(;hr!==null;){u=hr;var h=u.sibling,f=u.return;if(g8(u),u===d){hr=null;break}if(h!==null){h.return=f,hr=h;break}hr=f}}}var p=i.alternate;if(p!==null){var m=p.child;if(m!==null){p.child=null;do{var g=m.sibling;m.sibling=null,m=g}while(m!==null)}}hr=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,hr=o;else e:for(;hr!==null;){if(i=hr,i.flags&2048)switch(i.tag){case 0:case 11:case 15:ex(9,i,i.return)}var y=i.sibling;if(y!==null){y.return=i.return,hr=y;break e}hr=i.return}}var v=t.current;for(hr=v;hr!==null;){o=hr;var x=o.child;if(o.subtreeFlags&2064&&x!==null)x.return=o,hr=x;else e:for(o=v;hr!==null;){if(l=hr,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:B2(9,l)}}catch(T){Dn(l,l.return,T)}if(l===o){hr=null;break e}var E=l.sibling;if(E!==null){E.return=l.return,hr=E;break e}hr=l.return}}if(ys=n,oh(),zc&&typeof zc.onPostCommitFiberRoot=="function")try{zc.onPostCommitFiberRoot(C2,t)}catch{}s=!0}return s}finally{Ms=r,Il.transition=e}}return!1}function qI(t,e,r){e=Z0(r,e),e=i8(t,e,1),t=_A(t,e,1),e=Yi(),t!==null&&(Iy(t,1,e),wo(t,e))}function Dn(t,e,r){if(t.tag===3)qI(t,t,r);else for(;e!==null;){if(e.tag===3){qI(e,t,r);break}else if(e.tag===1){var s=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(TA===null||!TA.has(s))){t=Z0(r,t),t=o8(e,t,1),e=_A(e,t,1),t=Yi(),e!==null&&(Iy(e,1,t),wo(e,t));break}}e=e.return}}function sz(t,e,r){var s=t.pingCache;s!==null&&s.delete(e),e=Yi(),t.pingedLanes|=t.suspendedLanes&r,$a===t&&(ai&r)===r&&(Ca===4||Ca===3&&(ai&130023424)===ai&&500>Gn()-kE?cf(t,0):IE|=r),wo(t,e)}function E8(t,e){e===0&&(t.mode&1?(e=Hv,Hv<<=1,!(Hv&130023424)&&(Hv=4194304)):e=1);var r=Yi();t=Jd(t,e),t!==null&&(Iy(t,e,r),wo(t,r))}function nz(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),E8(t,r)}function az(t,e){var r=0;switch(t.tag){case 13:var s=t.stateNode,n=t.memoizedState;n!==null&&(r=n.retryLane);break;case 19:s=t.stateNode;break;default:throw Error(Wt(314))}s!==null&&s.delete(e),E8(t,r)}var _8;_8=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||vo.current)go=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return go=!1,zK(t,e,r);go=!!(t.flags&131072)}else go=!1,bn&&e.flags&1048576&&BR(e,tw,e.index);switch(e.lanes=0,e.tag){case 2:var s=e.type;fb(t,e),t=e.pendingProps;var n=G0(e,Pi.current);_0(e,r),n=CE(null,e,s,t,n,r);var i=jE();return e.flags|=1,typeof n=="object"&&n!==null&&typeof n.render=="function"&&n.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,bo(s)?(i=!0,Zb(e)):i=!1,e.memoizedState=n.state!==null&&n.state!==void 0?n.state:null,yE(e),n.updater=k2,e.stateNode=n,n._reactInternals=e,I4(e,s,t,r),e=F4(null,e,s,!0,i,r)):(e.tag=0,bn&&i&&AE(e),Hi(null,e,n,r),e=e.child),e;case 16:s=e.elementType;e:{switch(fb(t,e),t=e.pendingProps,n=s._init,s=n(s._payload),e.type=s,n=e.tag=oz(s),t=Zl(s,t),n){case 0:e=B4(null,e,s,t,r);break e;case 1:e=LI(null,e,s,t,r);break e;case 11:e=DI(null,e,s,t,r);break e;case 14:e=RI(null,e,s,Zl(s.type,t),r);break e}throw Error(Wt(306,s,""))}return e;case 0:return s=e.type,n=e.pendingProps,n=e.elementType===s?n:Zl(s,n),B4(t,e,s,n,r);case 1:return s=e.type,n=e.pendingProps,n=e.elementType===s?n:Zl(s,n),LI(t,e,s,n,r);case 3:e:{if(u8(e),t===null)throw Error(Wt(387));s=e.pendingProps,i=e.memoizedState,n=i.element,OR(t,e),nw(e,s,null,r);var o=e.memoizedState;if(s=o.element,i.isDehydrated)if(i={element:s,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){n=Z0(Error(Wt(423)),e),e=OI(t,e,s,r,n);break e}else if(s!==n){n=Z0(Error(Wt(424)),e),e=OI(t,e,s,r,n);break e}else for($o=EA(e.stateNode.containerInfo.firstChild),qo=e,bn=!0,sc=null,r=RR(e,null,s,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Y0(),s===n){e=Zd(t,e,r);break e}Hi(t,e,s,r)}e=e.child}return e;case 5:return UR(e),t===null&&E4(e),s=e.type,n=e.pendingProps,i=t!==null?t.memoizedProps:null,o=n.children,w4(s,n)?o=null:i!==null&&w4(s,i)&&(e.flags|=32),d8(t,e),Hi(t,e,o,r),e.child;case 6:return t===null&&E4(e),null;case 13:return A8(t,e,r);case 4:return vE(e,e.stateNode.containerInfo),s=e.pendingProps,t===null?e.child=X0(e,null,s,r):Hi(t,e,s,r),e.child;case 11:return s=e.type,n=e.pendingProps,n=e.elementType===s?n:Zl(s,n),DI(t,e,s,n,r);case 7:return Hi(t,e,e.pendingProps,r),e.child;case 8:return Hi(t,e,e.pendingProps.children,r),e.child;case 12:return Hi(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(s=e.type._context,n=e.pendingProps,i=e.memoizedProps,o=n.value,rn(rw,s._currentValue),s._currentValue=o,i!==null)if(fc(i.value,o)){if(i.children===n.children&&!vo.current){e=Zd(t,e,r);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var c=l.firstContext;c!==null;){if(c.context===s){if(i.tag===1){c=Hd(-1,r&-r),c.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var u=d.pending;u===null?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}i.lanes|=r,c=i.alternate,c!==null&&(c.lanes|=r),_4(i.return,r,e),l.lanes|=r;break}c=c.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(Wt(341));o.lanes|=r,l=o.alternate,l!==null&&(l.lanes|=r),_4(o,r,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Hi(t,e,n.children,r),e=e.child}return e;case 9:return n=e.type,s=e.pendingProps.children,_0(e,r),n=Bl(n),s=s(n),e.flags|=1,Hi(t,e,s,r),e.child;case 14:return s=e.type,n=Zl(s,e.pendingProps),n=Zl(s.type,n),RI(t,e,s,n,r);case 15:return l8(t,e,e.type,e.pendingProps,r);case 17:return s=e.type,n=e.pendingProps,n=e.elementType===s?n:Zl(s,n),fb(t,e),e.tag=1,bo(s)?(t=!0,Zb(e)):t=!1,_0(e,r),a8(e,s,n),I4(e,s,n,r),F4(null,e,s,!0,t,r);case 19:return h8(t,e,r);case 22:return c8(t,e,r)}throw Error(Wt(156,e.tag))};function T8(t,e){return rR(t,e)}function iz(t,e,r,s){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Cl(t,e,r,s){return new iz(t,e,r,s)}function DE(t){return t=t.prototype,!(!t||!t.isReactComponent)}function oz(t){if(typeof t=="function")return DE(t)?1:0;if(t!=null){if(t=t.$$typeof,t===eE)return 11;if(t===tE)return 14}return 2}function kA(t,e){var r=t.alternate;return r===null?(r=Cl(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function gb(t,e,r,s,n,i){var o=2;if(s=t,typeof t=="function")DE(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case o0:return df(r.children,n,i,e);case ZS:o=8,n|=8;break;case e4:return t=Cl(12,r,e,n|2),t.elementType=e4,t.lanes=i,t;case t4:return t=Cl(13,r,e,n),t.elementType=t4,t.lanes=i,t;case r4:return t=Cl(19,r,e,n),t.elementType=r4,t.lanes=i,t;case UD:return P2(r,n,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case LD:o=10;break e;case OD:o=9;break e;case eE:o=11;break e;case tE:o=14;break e;case Zu:o=16,s=null;break e}throw Error(Wt(130,t==null?t:typeof t,""))}return e=Cl(o,r,e,n),e.elementType=t,e.type=s,e.lanes=i,e}function df(t,e,r,s){return t=Cl(7,t,s,e),t.lanes=r,t}function P2(t,e,r,s){return t=Cl(22,t,s,e),t.elementType=UD,t.lanes=r,t.stateNode={isHidden:!1},t}function k5(t,e,r){return t=Cl(6,t,null,e),t.lanes=r,t}function B5(t,e,r){return e=Cl(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function lz(t,e,r,s,n){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=A5(0),this.expirationTimes=A5(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=A5(0),this.identifierPrefix=s,this.onRecoverableError=n,this.mutableSourceEagerHydrationData=null}function RE(t,e,r,s,n,i,o,l,c){return t=new lz(t,e,r,l,c),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Cl(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:s,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},yE(i),t}function cz(t,e,r){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i0,key:s==null?null:""+s,children:t,containerInfo:e,implementation:r}}function I8(t){if(!t)return HA;t=t._reactInternals;e:{if(Wf(t)!==t||t.tag!==1)throw Error(Wt(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(bo(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Wt(171))}if(t.tag===1){var r=t.type;if(bo(r))return IR(t,r,e)}return e}function k8(t,e,r,s,n,i,o,l,c){return t=RE(r,s,!0,t,n,i,o,l,c),t.context=I8(null),r=t.current,s=Yi(),n=IA(r),i=Hd(s,n),i.callback=e??null,_A(r,i,n),t.current.lanes=n,Iy(t,n,s),wo(t,s),t}function D2(t,e,r,s){var n=e.current,i=Yi(),o=IA(n);return r=I8(r),e.context===null?e.context=r:e.pendingContext=r,e=Hd(i,o),e.payload={element:t},s=s===void 0?null:s,s!==null&&(e.callback=s),t=_A(n,e,o),t!==null&&(uc(t,n,o,i),ub(t,n,o)),o}function Aw(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function WI(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function LE(t,e){WI(t,e),(t=t.alternate)&&WI(t,e)}function dz(){return null}var B8=typeof reportError=="function"?reportError:function(t){console.error(t)};function OE(t){this._internalRoot=t}R2.prototype.render=OE.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Wt(409));D2(t,e,null,null)};R2.prototype.unmount=OE.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;jf(function(){D2(null,t,null,null)}),e[Xd]=null}};function R2(t){this._internalRoot=t}R2.prototype.unstable_scheduleHydration=function(t){if(t){var e=cR();t={blockedOn:null,target:t,priority:e};for(var r=0;r<rA.length&&e!==0&&e<rA[r].priority;r++);rA.splice(r,0,t),r===0&&uR(t)}};function UE(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function L2(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function GI(){}function uz(t,e,r,s,n){if(n){if(typeof s=="function"){var i=s;s=function(){var d=Aw(o);i.call(d)}}var o=k8(e,s,t,0,null,!1,!1,"",GI);return t._reactRootContainer=o,t[Xd]=o.current,Mx(t.nodeType===8?t.parentNode:t),jf(),o}for(;n=t.lastChild;)t.removeChild(n);if(typeof s=="function"){var l=s;s=function(){var d=Aw(c);l.call(d)}}var c=RE(t,0,!1,null,null,!1,!1,"",GI);return t._reactRootContainer=c,t[Xd]=c.current,Mx(t.nodeType===8?t.parentNode:t),jf(function(){D2(e,c,r,s)}),c}function O2(t,e,r,s,n){var i=r._reactRootContainer;if(i){var o=i;if(typeof n=="function"){var l=n;n=function(){var c=Aw(o);l.call(c)}}D2(e,o,t,n)}else o=uz(r,e,t,n,s);return Aw(o)}oR=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=Tg(e.pendingLanes);r!==0&&(nE(e,r|1),wo(e,Gn()),!(ys&6)&&(ep=Gn()+500,oh()))}break;case 13:jf(function(){var s=Jd(t,1);if(s!==null){var n=Yi();uc(s,t,1,n)}}),LE(t,1)}};aE=function(t){if(t.tag===13){var e=Jd(t,134217728);if(e!==null){var r=Yi();uc(e,t,134217728,r)}LE(t,134217728)}};lR=function(t){if(t.tag===13){var e=IA(t),r=Jd(t,e);if(r!==null){var s=Yi();uc(r,t,e,s)}LE(t,e)}};cR=function(){return Ms};dR=function(t,e){var r=Ms;try{return Ms=t,e()}finally{Ms=r}};A4=function(t,e,r){switch(e){case"input":if(a4(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var s=r[e];if(s!==t&&s.form===t.form){var n=_2(s);if(!n)throw Error(Wt(90));QD(s),a4(s,n)}}}break;case"textarea":HD(t,r);break;case"select":e=r.value,e!=null&&C0(t,!!r.multiple,e,!1)}};YD=BE;XD=jf;var Az={usingClientEntryPoint:!1,Events:[By,u0,_2,WD,GD,BE]},Ag={findFiberByHostInstance:Jh,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},hz={bundleType:Ag.bundleType,version:Ag.version,rendererPackageName:Ag.rendererPackageName,rendererConfig:Ag.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:cu.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=eR(t),t===null?null:t.stateNode},findFiberByHostInstance:Ag.findFiberByHostInstance||dz,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var e1=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!e1.isDisabled&&e1.supportsFiber)try{C2=e1.inject(hz),zc=e1}catch{}}el.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Az;el.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!UE(e))throw Error(Wt(200));return cz(t,e,null,r)};el.createRoot=function(t,e){if(!UE(t))throw Error(Wt(299));var r=!1,s="",n=B8;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(s=e.identifierPrefix),e.onRecoverableError!==void 0&&(n=e.onRecoverableError)),e=RE(t,1,!1,null,null,r,!1,s,n),t[Xd]=e.current,Mx(t.nodeType===8?t.parentNode:t),new OE(e)};el.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Wt(188)):(t=Object.keys(t).join(","),Error(Wt(268,t)));return t=eR(e),t=t===null?null:t.stateNode,t};el.flushSync=function(t){return jf(t)};el.hydrate=function(t,e,r){if(!L2(e))throw Error(Wt(200));return O2(null,t,e,!0,r)};el.hydrateRoot=function(t,e,r){if(!UE(t))throw Error(Wt(405));var s=r!=null&&r.hydratedSources||null,n=!1,i="",o=B8;if(r!=null&&(r.unstable_strictMode===!0&&(n=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),e=k8(e,null,t,1,r??null,n,!1,i,o),t[Xd]=e.current,Mx(t),s)for(t=0;t<s.length;t++)r=s[t],n=r._getVersion,n=n(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,n]:e.mutableSourceEagerHydrationData.push(r,n);return new R2(e)};el.render=function(t,e,r){if(!L2(e))throw Error(Wt(200));return O2(null,t,e,!1,r)};el.unmountComponentAtNode=function(t){if(!L2(t))throw Error(Wt(40));return t._reactRootContainer?(jf(function(){O2(null,null,t,!1,function(){t._reactRootContainer=null,t[Xd]=null})}),!0):!1};el.unstable_batchedUpdates=BE;el.unstable_renderSubtreeIntoContainer=function(t,e,r,s){if(!L2(r))throw Error(Wt(200));if(t==null||t._reactInternals===void 0)throw Error(Wt(38));return O2(t,e,r,!1,s)};el.version="18.3.1-next-f1338f8080-20240426";function F8(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(F8)}catch(t){console.error(t)}}F8(),FD.exports=el;var fz=FD.exports,YI=fz;JC.createRoot=YI.createRoot,JC.hydrateRoot=YI.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Gx(){return Gx=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},Gx.apply(this,arguments)}var fA;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(fA||(fA={}));const XI="popstate";function mz(t){t===void 0&&(t={});function e(s,n){let{pathname:i,search:o,hash:l}=s.location;return K4("",{pathname:i,search:o,hash:l},n.state&&n.state.usr||null,n.state&&n.state.key||"default")}function r(s,n){return typeof n=="string"?n:hw(n)}return gz(e,r,null,t)}function ra(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function P8(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function pz(){return Math.random().toString(36).substr(2,8)}function JI(t,e){return{usr:t.state,key:t.key,idx:e}}function K4(t,e,r,s){return r===void 0&&(r=null),Gx({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Ep(e):e,{state:r,key:e&&e.key||s||pz()})}function hw(t){let{pathname:e="/",search:r="",hash:s=""}=t;return r&&r!=="?"&&(e+=r.charAt(0)==="?"?r:"?"+r),s&&s!=="#"&&(e+=s.charAt(0)==="#"?s:"#"+s),e}function Ep(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substr(r),t=t.substr(0,r));let s=t.indexOf("?");s>=0&&(e.search=t.substr(s),t=t.substr(0,s)),t&&(e.pathname=t)}return e}function gz(t,e,r,s){s===void 0&&(s={});let{window:n=document.defaultView,v5Compat:i=!1}=s,o=n.history,l=fA.Pop,c=null,d=u();d==null&&(d=0,o.replaceState(Gx({},o.state,{idx:d}),""));function u(){return(o.state||{idx:null}).idx}function A(){l=fA.Pop;let g=u(),y=g==null?null:g-d;d=g,c&&c({action:l,location:m.location,delta:y})}function h(g,y){l=fA.Push;let v=K4(m.location,g,y);d=u()+1;let x=JI(v,d),E=m.createHref(v);try{o.pushState(x,"",E)}catch(T){if(T instanceof DOMException&&T.name==="DataCloneError")throw T;n.location.assign(E)}i&&c&&c({action:l,location:m.location,delta:1})}function f(g,y){l=fA.Replace;let v=K4(m.location,g,y);d=u();let x=JI(v,d),E=m.createHref(v);o.replaceState(x,"",E),i&&c&&c({action:l,location:m.location,delta:0})}function p(g){let y=n.location.origin!=="null"?n.location.origin:n.location.href,v=typeof g=="string"?g:hw(g);return v=v.replace(/ $/,"%20"),ra(y,"No window.location.(origin|href) available to create URL for href: "+v),new URL(v,y)}let m={get action(){return l},get location(){return t(n,o)},listen(g){if(c)throw new Error("A history only accepts one active listener");return n.addEventListener(XI,A),c=g,()=>{n.removeEventListener(XI,A),c=null}},createHref(g){return e(n,g)},createURL:p,encodeLocation(g){let y=p(g);return{pathname:y.pathname,search:y.search,hash:y.hash}},push:h,replace:f,go(g){return o.go(g)}};return m}var ZI;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(ZI||(ZI={}));function xz(t,e,r){return r===void 0&&(r="/"),yz(t,e,r)}function yz(t,e,r,s){let n=typeof e=="string"?Ep(e):e,i=ME(n.pathname||"/",r);if(i==null)return null;let o=D8(t);vz(o);let l=null;for(let c=0;l==null&&c<o.length;++c){let d=Bz(i);l=Tz(o[c],d)}return l}function D8(t,e,r,s){e===void 0&&(e=[]),r===void 0&&(r=[]),s===void 0&&(s="");let n=(i,o,l)=>{let c={relativePath:l===void 0?i.path||"":l,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};c.relativePath.startsWith("/")&&(ra(c.relativePath.startsWith(s),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+s+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(s.length));let d=BA([s,c.relativePath]),u=r.concat(c);i.children&&i.children.length>0&&(ra(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),D8(i.children,e,u,d)),!(i.path==null&&!i.index)&&e.push({path:d,score:Ez(d,i.index),routesMeta:u})};return t.forEach((i,o)=>{var l;if(i.path===""||!((l=i.path)!=null&&l.includes("?")))n(i,o);else for(let c of R8(i.path))n(i,o,c)}),e}function R8(t){let e=t.split("/");if(e.length===0)return[];let[r,...s]=e,n=r.endsWith("?"),i=r.replace(/\?$/,"");if(s.length===0)return n?[i,""]:[i];let o=R8(s.join("/")),l=[];return l.push(...o.map(c=>c===""?i:[i,c].join("/"))),n&&l.push(...o),l.map(c=>t.startsWith("/")&&c===""?"/":c)}function vz(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:_z(e.routesMeta.map(s=>s.childrenIndex),r.routesMeta.map(s=>s.childrenIndex)))}const bz=/^:[\w-]+$/,wz=3,Nz=2,Cz=1,jz=10,Sz=-2,ek=t=>t==="*";function Ez(t,e){let r=t.split("/"),s=r.length;return r.some(ek)&&(s+=Sz),e&&(s+=Nz),r.filter(n=>!ek(n)).reduce((n,i)=>n+(bz.test(i)?wz:i===""?Cz:jz),s)}function _z(t,e){return t.length===e.length&&t.slice(0,-1).every((s,n)=>s===e[n])?t[t.length-1]-e[e.length-1]:0}function Tz(t,e,r){let{routesMeta:s}=t,n={},i="/",o=[];for(let l=0;l<s.length;++l){let c=s[l],d=l===s.length-1,u=i==="/"?e:e.slice(i.length)||"/",A=Iz({path:c.relativePath,caseSensitive:c.caseSensitive,end:d},u),h=c.route;if(!A)return null;Object.assign(n,A.params),o.push({params:n,pathname:BA([i,A.pathname]),pathnameBase:Rz(BA([i,A.pathnameBase])),route:h}),A.pathnameBase!=="/"&&(i=BA([i,A.pathnameBase]))}return o}function Iz(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,s]=kz(t.path,t.caseSensitive,t.end),n=e.match(r);if(!n)return null;let i=n[0],o=i.replace(/(.)\/+$/,"$1"),l=n.slice(1);return{params:s.reduce((d,u,A)=>{let{paramName:h,isOptional:f}=u;if(h==="*"){let m=l[A]||"";o=i.slice(0,i.length-m.length).replace(/(.)\/+$/,"$1")}const p=l[A];return f&&!p?d[h]=void 0:d[h]=(p||"").replace(/%2F/g,"/"),d},{}),pathname:i,pathnameBase:o,pattern:t}}function kz(t,e,r){e===void 0&&(e=!1),r===void 0&&(r=!0),P8(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let s=[],n="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,c)=>(s.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(s.push({paramName:"*"}),n+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?n+="\\/*$":t!==""&&t!=="/"&&(n+="(?:(?=\\/|$))"),[new RegExp(n,e?void 0:"i"),s]}function Bz(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return P8(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function ME(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,s=t.charAt(r);return s&&s!=="/"?null:t.slice(r)||"/"}function Fz(t,e){e===void 0&&(e="/");let{pathname:r,search:s="",hash:n=""}=typeof t=="string"?Ep(t):t;return{pathname:r?r.startsWith("/")?r:Pz(r,e):e,search:Lz(s),hash:Oz(n)}}function Pz(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(n=>{n===".."?r.length>1&&r.pop():n!=="."&&r.push(n)}),r.length>1?r.join("/"):"/"}function F5(t,e,r,s){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(s)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Dz(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function QE(t,e){let r=Dz(t);return e?r.map((s,n)=>n===r.length-1?s.pathname:s.pathnameBase):r.map(s=>s.pathnameBase)}function VE(t,e,r,s){s===void 0&&(s=!1);let n;typeof t=="string"?n=Ep(t):(n=Gx({},t),ra(!n.pathname||!n.pathname.includes("?"),F5("?","pathname","search",n)),ra(!n.pathname||!n.pathname.includes("#"),F5("#","pathname","hash",n)),ra(!n.search||!n.search.includes("#"),F5("#","search","hash",n)));let i=t===""||n.pathname==="",o=i?"/":n.pathname,l;if(o==null)l=r;else{let A=e.length-1;if(!s&&o.startsWith("..")){let h=o.split("/");for(;h[0]==="..";)h.shift(),A-=1;n.pathname=h.join("/")}l=A>=0?e[A]:"/"}let c=Fz(n,l),d=o&&o!=="/"&&o.endsWith("/"),u=(i||o===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(d||u)&&(c.pathname+="/"),c}const BA=t=>t.join("/").replace(/\/\/+/g,"/"),Rz=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),Lz=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,Oz=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function Uz(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const L8=["post","put","patch","delete"];new Set(L8);const Mz=["get",...L8];new Set(Mz);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Yx(){return Yx=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},Yx.apply(this,arguments)}const HE=R.createContext(null),Qz=R.createContext(null),lh=R.createContext(null),U2=R.createContext(null),sd=R.createContext({outlet:null,matches:[],isDataRoute:!1}),O8=R.createContext(null);function Vz(t,e){let{relative:r}=e===void 0?{}:e;_p()||ra(!1);let{basename:s,navigator:n}=R.useContext(lh),{hash:i,pathname:o,search:l}=M8(t,{relative:r}),c=o;return s!=="/"&&(c=o==="/"?s:BA([s,o])),n.createHref({pathname:c,search:l,hash:i})}function _p(){return R.useContext(U2)!=null}function du(){return _p()||ra(!1),R.useContext(U2).location}function U8(t){R.useContext(lh).static||R.useLayoutEffect(t)}function Li(){let{isDataRoute:t}=R.useContext(sd);return t?sq():Hz()}function Hz(){_p()||ra(!1);let t=R.useContext(HE),{basename:e,future:r,navigator:s}=R.useContext(lh),{matches:n}=R.useContext(sd),{pathname:i}=du(),o=JSON.stringify(QE(n,r.v7_relativeSplatPath)),l=R.useRef(!1);return U8(()=>{l.current=!0}),R.useCallback(function(d,u){if(u===void 0&&(u={}),!l.current)return;if(typeof d=="number"){s.go(d);return}let A=VE(d,JSON.parse(o),i,u.relative==="path");t==null&&e!=="/"&&(A.pathname=A.pathname==="/"?e:BA([e,A.pathname])),(u.replace?s.replace:s.push)(A,u.state,u)},[e,s,o,i,t])}const $z=R.createContext(null);function Kz(t){let e=R.useContext(sd).outlet;return e&&R.createElement($z.Provider,{value:t},e)}function uu(){let{matches:t}=R.useContext(sd),e=t[t.length-1];return e?e.params:{}}function M8(t,e){let{relative:r}=e===void 0?{}:e,{future:s}=R.useContext(lh),{matches:n}=R.useContext(sd),{pathname:i}=du(),o=JSON.stringify(QE(n,s.v7_relativeSplatPath));return R.useMemo(()=>VE(t,JSON.parse(o),i,r==="path"),[t,o,i,r])}function zz(t,e){return qz(t,e)}function qz(t,e,r,s){_p()||ra(!1);let{navigator:n}=R.useContext(lh),{matches:i}=R.useContext(sd),o=i[i.length-1],l=o?o.params:{};o&&o.pathname;let c=o?o.pathnameBase:"/";o&&o.route;let d=du(),u;if(e){var A;let g=typeof e=="string"?Ep(e):e;c==="/"||(A=g.pathname)!=null&&A.startsWith(c)||ra(!1),u=g}else u=d;let h=u.pathname||"/",f=h;if(c!=="/"){let g=c.replace(/^\//,"").split("/");f="/"+h.replace(/^\//,"").split("/").slice(g.length).join("/")}let p=xz(t,{pathname:f}),m=Jz(p&&p.map(g=>Object.assign({},g,{params:Object.assign({},l,g.params),pathname:BA([c,n.encodeLocation?n.encodeLocation(g.pathname).pathname:g.pathname]),pathnameBase:g.pathnameBase==="/"?c:BA([c,n.encodeLocation?n.encodeLocation(g.pathnameBase).pathname:g.pathnameBase])})),i,r,s);return e&&m?R.createElement(U2.Provider,{value:{location:Yx({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:fA.Pop}},m):m}function Wz(){let t=rq(),e=Uz(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,n={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return R.createElement(R.Fragment,null,R.createElement("h2",null,"Unexpected Application Error!"),R.createElement("h3",{style:{fontStyle:"italic"}},e),r?R.createElement("pre",{style:n},r):null,null)}const Gz=R.createElement(Wz,null);class Yz extends R.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,r){return r.location!==e.location||r.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:r.error,location:r.location,revalidation:e.revalidation||r.revalidation}}componentDidCatch(e,r){console.error("React Router caught the following error during render",e,r)}render(){return this.state.error!==void 0?R.createElement(sd.Provider,{value:this.props.routeContext},R.createElement(O8.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Xz(t){let{routeContext:e,match:r,children:s}=t,n=R.useContext(HE);return n&&n.static&&n.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=r.route.id),R.createElement(sd.Provider,{value:e},s)}function Jz(t,e,r,s){var n;if(e===void 0&&(e=[]),r===void 0&&(r=null),s===void 0&&(s=null),t==null){var i;if(!r)return null;if(r.errors)t=r.matches;else if((i=s)!=null&&i.v7_partialHydration&&e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let o=t,l=(n=r)==null?void 0:n.errors;if(l!=null){let u=o.findIndex(A=>A.route.id&&(l==null?void 0:l[A.route.id])!==void 0);u>=0||ra(!1),o=o.slice(0,Math.min(o.length,u+1))}let c=!1,d=-1;if(r&&s&&s.v7_partialHydration)for(let u=0;u<o.length;u++){let A=o[u];if((A.route.HydrateFallback||A.route.hydrateFallbackElement)&&(d=u),A.route.id){let{loaderData:h,errors:f}=r,p=A.route.loader&&h[A.route.id]===void 0&&(!f||f[A.route.id]===void 0);if(A.route.lazy||p){c=!0,d>=0?o=o.slice(0,d+1):o=[o[0]];break}}}return o.reduceRight((u,A,h)=>{let f,p=!1,m=null,g=null;r&&(f=l&&A.route.id?l[A.route.id]:void 0,m=A.route.errorElement||Gz,c&&(d<0&&h===0?(nq("route-fallback"),p=!0,g=null):d===h&&(p=!0,g=A.route.hydrateFallbackElement||null)));let y=e.concat(o.slice(0,h+1)),v=()=>{let x;return f?x=m:p?x=g:A.route.Component?x=R.createElement(A.route.Component,null):A.route.element?x=A.route.element:x=u,R.createElement(Xz,{match:A,routeContext:{outlet:u,matches:y,isDataRoute:r!=null},children:x})};return r&&(A.route.ErrorBoundary||A.route.errorElement||h===0)?R.createElement(Yz,{location:r.location,revalidation:r.revalidation,component:m,error:f,children:v(),routeContext:{outlet:null,matches:y,isDataRoute:!0}}):v()},null)}var Q8=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(Q8||{}),V8=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(V8||{});function Zz(t){let e=R.useContext(HE);return e||ra(!1),e}function eq(t){let e=R.useContext(Qz);return e||ra(!1),e}function tq(t){let e=R.useContext(sd);return e||ra(!1),e}function H8(t){let e=tq(),r=e.matches[e.matches.length-1];return r.route.id||ra(!1),r.route.id}function rq(){var t;let e=R.useContext(O8),r=eq(),s=H8();return e!==void 0?e:(t=r.errors)==null?void 0:t[s]}function sq(){let{router:t}=Zz(Q8.UseNavigateStable),e=H8(V8.UseNavigateStable),r=R.useRef(!1);return U8(()=>{r.current=!0}),R.useCallback(function(n,i){i===void 0&&(i={}),r.current&&(typeof n=="number"?t.navigate(n):t.navigate(n,Yx({fromRouteId:e},i)))},[t,e])}const tk={};function nq(t,e,r){tk[t]||(tk[t]=!0)}function aq(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function M2(t){let{to:e,replace:r,state:s,relative:n}=t;_p()||ra(!1);let{future:i,static:o}=R.useContext(lh),{matches:l}=R.useContext(sd),{pathname:c}=du(),d=Li(),u=VE(e,QE(l,i.v7_relativeSplatPath),c,n==="path"),A=JSON.stringify(u);return R.useEffect(()=>d(JSON.parse(A),{replace:r,state:s,relative:n}),[d,A,n,r,s]),null}function iq(t){return Kz(t.context)}function os(t){ra(!1)}function oq(t){let{basename:e="/",children:r=null,location:s,navigationType:n=fA.Pop,navigator:i,static:o=!1,future:l}=t;_p()&&ra(!1);let c=e.replace(/^\/*/,"/"),d=R.useMemo(()=>({basename:c,navigator:i,static:o,future:Yx({v7_relativeSplatPath:!1},l)}),[c,l,i,o]);typeof s=="string"&&(s=Ep(s));let{pathname:u="/",search:A="",hash:h="",state:f=null,key:p="default"}=s,m=R.useMemo(()=>{let g=ME(u,c);return g==null?null:{location:{pathname:g,search:A,hash:h,state:f,key:p},navigationType:n}},[c,u,A,h,f,p,n]);return m==null?null:R.createElement(lh.Provider,{value:d},R.createElement(U2.Provider,{children:r,value:m}))}function rk(t){let{children:e,location:r}=t;return zz(z4(e),r)}new Promise(()=>{});function z4(t,e){e===void 0&&(e=[]);let r=[];return R.Children.forEach(t,(s,n)=>{if(!R.isValidElement(s))return;let i=[...e,n];if(s.type===R.Fragment){r.push.apply(r,z4(s.props.children,i));return}s.type!==os&&ra(!1),!s.props.index||!s.props.children||ra(!1);let o={id:s.props.id||i.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(o.children=z4(s.props.children,i)),r.push(o)}),r}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function q4(){return q4=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},q4.apply(this,arguments)}function lq(t,e){if(t==null)return{};var r={},s=Object.keys(t),n,i;for(i=0;i<s.length;i++)n=s[i],!(e.indexOf(n)>=0)&&(r[n]=t[n]);return r}function cq(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function dq(t,e){return t.button===0&&(!e||e==="_self")&&!cq(t)}function W4(t){return t===void 0&&(t=""),new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,r)=>{let s=t[r];return e.concat(Array.isArray(s)?s.map(n=>[r,n]):[[r,s]])},[]))}function uq(t,e){let r=W4(t);return e&&e.forEach((s,n)=>{r.has(n)||e.getAll(n).forEach(i=>{r.append(n,i)})}),r}const Aq=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],hq="6";try{window.__reactRouterVersion=hq}catch{}const fq="startTransition",sk=s$[fq];function mq(t){let{basename:e,children:r,future:s,window:n}=t,i=R.useRef();i.current==null&&(i.current=mz({window:n,v5Compat:!0}));let o=i.current,[l,c]=R.useState({action:o.action,location:o.location}),{v7_startTransition:d}=s||{},u=R.useCallback(A=>{d&&sk?sk(()=>c(A)):c(A)},[c,d]);return R.useLayoutEffect(()=>o.listen(u),[o,u]),R.useEffect(()=>aq(s),[s]),R.createElement(oq,{basename:e,children:r,location:l.location,navigationType:l.action,navigator:o,future:s})}const pq=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",gq=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,G4=R.forwardRef(function(e,r){let{onClick:s,relative:n,reloadDocument:i,replace:o,state:l,target:c,to:d,preventScrollReset:u,viewTransition:A}=e,h=lq(e,Aq),{basename:f}=R.useContext(lh),p,m=!1;if(typeof d=="string"&&gq.test(d)&&(p=d,pq))try{let x=new URL(window.location.href),E=d.startsWith("//")?new URL(x.protocol+d):new URL(d),T=ME(E.pathname,f);E.origin===x.origin&&T!=null?d=T+E.search+E.hash:m=!0}catch{}let g=Vz(d,{relative:n}),y=xq(d,{replace:o,state:l,target:c,preventScrollReset:u,relative:n,viewTransition:A});function v(x){s&&s(x),x.defaultPrevented||y(x)}return R.createElement("a",q4({},h,{href:p||g,onClick:m||i?s:v,ref:r,target:c}))});var nk;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(nk||(nk={}));var ak;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(ak||(ak={}));function xq(t,e){let{target:r,replace:s,state:n,preventScrollReset:i,relative:o,viewTransition:l}=e===void 0?{}:e,c=Li(),d=du(),u=M8(t,{relative:o});return R.useCallback(A=>{if(dq(A,r)){A.preventDefault();let h=s!==void 0?s:hw(d)===hw(u);c(t,{replace:h,state:n,preventScrollReset:i,relative:o,viewTransition:l})}},[d,c,u,s,n,r,t,i,o,l])}function $8(t){let e=R.useRef(W4(t)),r=R.useRef(!1),s=du(),n=R.useMemo(()=>uq(s.search,r.current?null:e.current),[s.search]),i=Li(),o=R.useCallback((l,c)=>{const d=W4(typeof l=="function"?l(n):l);r.current=!0,i("?"+d,c)},[i,n]);return[n,o]}let yq={data:""},vq=t=>typeof window=="object"?((t?t.querySelector("#_goober"):window._goober)||Object.assign((t||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:t||yq,bq=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,wq=/\/\*[^]*?\*\/|  +/g,ik=/\n+/g,nA=(t,e)=>{let r="",s="",n="";for(let i in t){let o=t[i];i[0]=="@"?i[1]=="i"?r=i+" "+o+";":s+=i[1]=="f"?nA(o,i):i+"{"+nA(o,i[1]=="k"?"":e)+"}":typeof o=="object"?s+=nA(o,e?e.replace(/([^,])+/g,l=>i.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,c=>/&/.test(c)?c.replace(/&/g,l):l?l+" "+c:c)):i):o!=null&&(i=/^--/.test(i)?i:i.replace(/[A-Z]/g,"-$&").toLowerCase(),n+=nA.p?nA.p(i,o):i+":"+o+";")}return r+(e&&n?e+"{"+n+"}":n)+s},Cd={},K8=t=>{if(typeof t=="object"){let e="";for(let r in t)e+=r+K8(t[r]);return e}return t},Nq=(t,e,r,s,n)=>{let i=K8(t),o=Cd[i]||(Cd[i]=(c=>{let d=0,u=11;for(;d<c.length;)u=101*u+c.charCodeAt(d++)>>>0;return"go"+u})(i));if(!Cd[o]){let c=i!==t?t:(d=>{let u,A,h=[{}];for(;u=bq.exec(d.replace(wq,""));)u[4]?h.shift():u[3]?(A=u[3].replace(ik," ").trim(),h.unshift(h[0][A]=h[0][A]||{})):h[0][u[1]]=u[2].replace(ik," ").trim();return h[0]})(t);Cd[o]=nA(n?{["@keyframes "+o]:c}:c,r?"":"."+o)}let l=r&&Cd.g?Cd.g:null;return r&&(Cd.g=Cd[o]),((c,d,u,A)=>{A?d.data=d.data.replace(A,c):d.data.indexOf(c)===-1&&(d.data=u?c+d.data:d.data+c)})(Cd[o],e,s,l),o},Cq=(t,e,r)=>t.reduce((s,n,i)=>{let o=e[i];if(o&&o.call){let l=o(r),c=l&&l.props&&l.props.className||/^go/.test(l)&&l;o=c?"."+c:l&&typeof l=="object"?l.props?"":nA(l,""):l===!1?"":l}return s+n+(o??"")},"");function Q2(t){let e=this||{},r=t.call?t(e.p):t;return Nq(r.unshift?r.raw?Cq(r,[].slice.call(arguments,1),e.p):r.reduce((s,n)=>Object.assign(s,n&&n.call?n(e.p):n),{}):r,vq(e.target),e.g,e.o,e.k)}let z8,Y4,X4;Q2.bind({g:1});let eu=Q2.bind({k:1});function jq(t,e,r,s){nA.p=e,z8=t,Y4=r,X4=s}function ch(t,e){let r=this||{};return function(){let s=arguments;function n(i,o){let l=Object.assign({},i),c=l.className||n.className;r.p=Object.assign({theme:Y4&&Y4()},l),r.o=/ *go\d+/.test(c),l.className=Q2.apply(r,s)+(c?" "+c:"");let d=t;return t[0]&&(d=l.as||t,delete l.as),X4&&d[0]&&X4(l),z8(d,l)}return n}}var Sq=t=>typeof t=="function",fw=(t,e)=>Sq(t)?t(e):t,Eq=(()=>{let t=0;return()=>(++t).toString()})(),q8=(()=>{let t;return()=>{if(t===void 0&&typeof window<"u"){let e=matchMedia("(prefers-reduced-motion: reduce)");t=!e||e.matches}return t}})(),_q=20,W8=(t,e)=>{switch(e.type){case 0:return{...t,toasts:[e.toast,...t.toasts].slice(0,_q)};case 1:return{...t,toasts:t.toasts.map(i=>i.id===e.toast.id?{...i,...e.toast}:i)};case 2:let{toast:r}=e;return W8(t,{type:t.toasts.find(i=>i.id===r.id)?1:0,toast:r});case 3:let{toastId:s}=e;return{...t,toasts:t.toasts.map(i=>i.id===s||s===void 0?{...i,dismissed:!0,visible:!1}:i)};case 4:return e.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(i=>i.id!==e.toastId)};case 5:return{...t,pausedAt:e.time};case 6:let n=e.time-(t.pausedAt||0);return{...t,pausedAt:void 0,toasts:t.toasts.map(i=>({...i,pauseDuration:i.pauseDuration+n}))}}},xb=[],tf={toasts:[],pausedAt:void 0},Gf=t=>{tf=W8(tf,t),xb.forEach(e=>{e(tf)})},Tq={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},Iq=(t={})=>{let[e,r]=R.useState(tf),s=R.useRef(tf);R.useEffect(()=>(s.current!==tf&&r(tf),xb.push(r),()=>{let i=xb.indexOf(r);i>-1&&xb.splice(i,1)}),[]);let n=e.toasts.map(i=>{var o,l,c;return{...t,...t[i.type],...i,removeDelay:i.removeDelay||((o=t[i.type])==null?void 0:o.removeDelay)||(t==null?void 0:t.removeDelay),duration:i.duration||((l=t[i.type])==null?void 0:l.duration)||(t==null?void 0:t.duration)||Tq[i.type],style:{...t.style,...(c=t[i.type])==null?void 0:c.style,...i.style}}});return{...e,toasts:n}},kq=(t,e="blank",r)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:e,ariaProps:{role:"status","aria-live":"polite"},message:t,pauseDuration:0,...r,id:(r==null?void 0:r.id)||Eq()}),Py=t=>(e,r)=>{let s=kq(e,t,r);return Gf({type:2,toast:s}),s.id},yr=(t,e)=>Py("blank")(t,e);yr.error=Py("error");yr.success=Py("success");yr.loading=Py("loading");yr.custom=Py("custom");yr.dismiss=t=>{Gf({type:3,toastId:t})};yr.remove=t=>Gf({type:4,toastId:t});yr.promise=(t,e,r)=>{let s=yr.loading(e.loading,{...r,...r==null?void 0:r.loading});return typeof t=="function"&&(t=t()),t.then(n=>{let i=e.success?fw(e.success,n):void 0;return i?yr.success(i,{id:s,...r,...r==null?void 0:r.success}):yr.dismiss(s),n}).catch(n=>{let i=e.error?fw(e.error,n):void 0;i?yr.error(i,{id:s,...r,...r==null?void 0:r.error}):yr.dismiss(s)}),t};var Bq=(t,e)=>{Gf({type:1,toast:{id:t,height:e}})},Fq=()=>{Gf({type:5,time:Date.now()})},sx=new Map,Pq=1e3,Dq=(t,e=Pq)=>{if(sx.has(t))return;let r=setTimeout(()=>{sx.delete(t),Gf({type:4,toastId:t})},e);sx.set(t,r)},Rq=t=>{let{toasts:e,pausedAt:r}=Iq(t);R.useEffect(()=>{if(r)return;let i=Date.now(),o=e.map(l=>{if(l.duration===1/0)return;let c=(l.duration||0)+l.pauseDuration-(i-l.createdAt);if(c<0){l.visible&&yr.dismiss(l.id);return}return setTimeout(()=>yr.dismiss(l.id),c)});return()=>{o.forEach(l=>l&&clearTimeout(l))}},[e,r]);let s=R.useCallback(()=>{r&&Gf({type:6,time:Date.now()})},[r]),n=R.useCallback((i,o)=>{let{reverseOrder:l=!1,gutter:c=8,defaultPosition:d}=o||{},u=e.filter(f=>(f.position||d)===(i.position||d)&&f.height),A=u.findIndex(f=>f.id===i.id),h=u.filter((f,p)=>p<A&&f.visible).length;return u.filter(f=>f.visible).slice(...l?[h+1]:[0,h]).reduce((f,p)=>f+(p.height||0)+c,0)},[e]);return R.useEffect(()=>{e.forEach(i=>{if(i.dismissed)Dq(i.id,i.removeDelay);else{let o=sx.get(i.id);o&&(clearTimeout(o),sx.delete(i.id))}})},[e]),{toasts:e,handlers:{updateHeight:Bq,startPause:Fq,endPause:s,calculateOffset:n}}},Lq=eu`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,Oq=eu`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,Uq=eu`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,Mq=ch("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${Lq} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${Oq} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${t=>t.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${Uq} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,Qq=eu`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,Vq=ch("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${t=>t.secondary||"#e0e0e0"};
  border-right-color: ${t=>t.primary||"#616161"};
  animation: ${Qq} 1s linear infinite;
`,Hq=eu`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,$q=eu`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,Kq=ch("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${Hq} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${$q} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${t=>t.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,zq=ch("div")`
  position: absolute;
`,qq=ch("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,Wq=eu`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,Gq=ch("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${Wq} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,Yq=({toast:t})=>{let{icon:e,type:r,iconTheme:s}=t;return e!==void 0?typeof e=="string"?R.createElement(Gq,null,e):e:r==="blank"?null:R.createElement(qq,null,R.createElement(Vq,{...s}),r!=="loading"&&R.createElement(zq,null,r==="error"?R.createElement(Mq,{...s}):R.createElement(Kq,{...s})))},Xq=t=>`
0% {transform: translate3d(0,${t*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,Jq=t=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${t*-150}%,-1px) scale(.6); opacity:0;}
`,Zq="0%{opacity:0;} 100%{opacity:1;}",eW="0%{opacity:1;} 100%{opacity:0;}",tW=ch("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,rW=ch("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,sW=(t,e)=>{let r=t.includes("top")?1:-1,[s,n]=q8()?[Zq,eW]:[Xq(r),Jq(r)];return{animation:e?`${eu(s)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${eu(n)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},nW=R.memo(({toast:t,position:e,style:r,children:s})=>{let n=t.height?sW(t.position||e||"top-center",t.visible):{opacity:0},i=R.createElement(Yq,{toast:t}),o=R.createElement(rW,{...t.ariaProps},fw(t.message,t));return R.createElement(tW,{className:t.className,style:{...n,...r,...t.style}},typeof s=="function"?s({icon:i,message:o}):R.createElement(R.Fragment,null,i,o))});jq(R.createElement);var aW=({id:t,className:e,style:r,onHeightUpdate:s,children:n})=>{let i=R.useCallback(o=>{if(o){let l=()=>{let c=o.getBoundingClientRect().height;s(t,c)};l(),new MutationObserver(l).observe(o,{subtree:!0,childList:!0,characterData:!0})}},[t,s]);return R.createElement("div",{ref:i,className:e,style:r},n)},iW=(t,e)=>{let r=t.includes("top"),s=r?{top:0}:{bottom:0},n=t.includes("center")?{justifyContent:"center"}:t.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:q8()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${e*(r?1:-1)}px)`,...s,...n}},oW=Q2`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,t1=16,lW=({reverseOrder:t,position:e="top-center",toastOptions:r,gutter:s,children:n,containerStyle:i,containerClassName:o})=>{let{toasts:l,handlers:c}=Rq(r);return R.createElement("div",{id:"_rht_toaster",style:{position:"fixed",zIndex:9999,top:t1,left:t1,right:t1,bottom:t1,pointerEvents:"none",...i},className:o,onMouseEnter:c.startPause,onMouseLeave:c.endPause},l.map(d=>{let u=d.position||e,A=c.calculateOffset(d,{reverseOrder:t,gutter:s,defaultPosition:e}),h=iW(u,A);return R.createElement(aW,{id:d.id,key:d.id,onHeightUpdate:c.updateHeight,className:d.visible?oW:"",style:h},d.type==="custom"?fw(d.message,d):n?n(d):R.createElement(nW,{toast:d,position:u}))}))},Z=yr,ok={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G8=function(t){const e=[];let r=0;for(let s=0;s<t.length;s++){let n=t.charCodeAt(s);n<128?e[r++]=n:n<2048?(e[r++]=n>>6|192,e[r++]=n&63|128):(n&64512)===55296&&s+1<t.length&&(t.charCodeAt(s+1)&64512)===56320?(n=65536+((n&1023)<<10)+(t.charCodeAt(++s)&1023),e[r++]=n>>18|240,e[r++]=n>>12&63|128,e[r++]=n>>6&63|128,e[r++]=n&63|128):(e[r++]=n>>12|224,e[r++]=n>>6&63|128,e[r++]=n&63|128)}return e},cW=function(t){const e=[];let r=0,s=0;for(;r<t.length;){const n=t[r++];if(n<128)e[s++]=String.fromCharCode(n);else if(n>191&&n<224){const i=t[r++];e[s++]=String.fromCharCode((n&31)<<6|i&63)}else if(n>239&&n<365){const i=t[r++],o=t[r++],l=t[r++],c=((n&7)<<18|(i&63)<<12|(o&63)<<6|l&63)-65536;e[s++]=String.fromCharCode(55296+(c>>10)),e[s++]=String.fromCharCode(56320+(c&1023))}else{const i=t[r++],o=t[r++];e[s++]=String.fromCharCode((n&15)<<12|(i&63)<<6|o&63)}}return e.join("")},Y8={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let n=0;n<t.length;n+=3){const i=t[n],o=n+1<t.length,l=o?t[n+1]:0,c=n+2<t.length,d=c?t[n+2]:0,u=i>>2,A=(i&3)<<4|l>>4;let h=(l&15)<<2|d>>6,f=d&63;c||(f=64,o||(h=64)),s.push(r[u],r[A],r[h],r[f])}return s.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(G8(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):cW(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let n=0;n<t.length;){const i=r[t.charAt(n++)],l=n<t.length?r[t.charAt(n)]:0;++n;const d=n<t.length?r[t.charAt(n)]:64;++n;const A=n<t.length?r[t.charAt(n)]:64;if(++n,i==null||l==null||d==null||A==null)throw new dW;const h=i<<2|l>>4;if(s.push(h),d!==64){const f=l<<4&240|d>>2;if(s.push(f),A!==64){const p=d<<6&192|A;s.push(p)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class dW extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const uW=function(t){const e=G8(t);return Y8.encodeByteArray(e,!0)},mw=function(t){return uW(t).replace(/\./g,"")},X8=function(t){try{return Y8.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AW(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hW=()=>AW().__FIREBASE_DEFAULTS__,fW=()=>{if(typeof process>"u"||typeof ok>"u")return;const t=ok.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},mW=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&X8(t[1]);return e&&JSON.parse(e)},V2=()=>{try{return hW()||fW()||mW()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},J8=t=>{var e,r;return(r=(e=V2())===null||e===void 0?void 0:e.emulatorHosts)===null||r===void 0?void 0:r[t]},Z8=t=>{const e=J8(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const s=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),s]:[e.substring(0,r),s]},eL=()=>{var t;return(t=V2())===null||t===void 0?void 0:t.config},tL=t=>{var e;return(e=V2())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pW{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,s)=>{r?this.reject(r):this.resolve(s),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,s))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gW(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},s=e||"demo-project",n=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${s}`,aud:s,iat:n,exp:n+3600,auth_time:n,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[mw(JSON.stringify(r)),mw(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ea(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function xW(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ea())}function yW(){var t;const e=(t=V2())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function vW(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function bW(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function wW(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function NW(){const t=Ea();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function rL(){return!yW()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function sL(){try{return typeof indexedDB=="object"}catch{return!1}}function CW(){return new Promise((t,e)=>{try{let r=!0;const s="validate-browser-context-for-indexeddb-analytics-module",n=self.indexedDB.open(s);n.onsuccess=()=>{n.result.close(),r||self.indexedDB.deleteDatabase(s),t(!0)},n.onupgradeneeded=()=>{r=!1},n.onerror=()=>{var i;e(((i=n.error)===null||i===void 0?void 0:i.message)||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jW="FirebaseError";class Au extends Error{constructor(e,r,s){super(r),this.code=e,this.customData=s,this.name=jW,Object.setPrototypeOf(this,Au.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Dy.prototype.create)}}class Dy{constructor(e,r,s){this.service=e,this.serviceName=r,this.errors=s}create(e,...r){const s=r[0]||{},n=`${this.service}/${e}`,i=this.errors[e],o=i?SW(i,s):"Error",l=`${this.serviceName}: ${o} (${n}).`;return new Au(n,l,s)}}function SW(t,e){return t.replace(EW,(r,s)=>{const n=e[s];return n!=null?String(n):`<${s}?>`})}const EW=/\{\$([^}]+)}/g;function _W(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function pw(t,e){if(t===e)return!0;const r=Object.keys(t),s=Object.keys(e);for(const n of r){if(!s.includes(n))return!1;const i=t[n],o=e[n];if(lk(i)&&lk(o)){if(!pw(i,o))return!1}else if(i!==o)return!1}for(const n of s)if(!r.includes(n))return!1;return!0}function lk(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ry(t){const e=[];for(const[r,s]of Object.entries(t))Array.isArray(s)?s.forEach(n=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(n))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(s));return e.length?"&"+e.join("&"):""}function kg(t){const e={};return t.replace(/^\?/,"").split("&").forEach(s=>{if(s){const[n,i]=s.split("=");e[decodeURIComponent(n)]=decodeURIComponent(i)}}),e}function Bg(t){const e=t.indexOf("?");if(!e)return"";const r=t.indexOf("#",e);return t.substring(e,r>0?r:void 0)}function TW(t,e){const r=new IW(t,e);return r.subscribe.bind(r)}class IW{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(s=>{this.error(s)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,s){let n;if(e===void 0&&r===void 0&&s===void 0)throw new Error("Missing Observer.");kW(e,["next","error","complete"])?n=e:n={next:e,error:r,complete:s},n.next===void 0&&(n.next=P5),n.error===void 0&&(n.error=P5),n.complete===void 0&&(n.complete=P5);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?n.error(this.finalError):n.complete()}catch{}}),this.observers.push(n),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(s){typeof console<"u"&&console.error&&console.error(s)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function kW(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function P5(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function In(t){return t&&t._delegate?t._delegate:t}class $A{constructor(e,r,s){this.name=e,this.instanceFactory=r,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uh="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BW{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const s=new pW;if(this.instancesDeferred.set(r,s),this.isInitialized(r)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:r});n&&s.resolve(n)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){var r;const s=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),n=(r=e==null?void 0:e.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(s)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:s})}catch(i){if(n)return null;throw i}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(PW(e))try{this.getOrInitializeService({instanceIdentifier:Uh})}catch{}for(const[r,s]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(r);try{const i=this.getOrInitializeService({instanceIdentifier:n});s.resolve(i)}catch{}}}}clearInstance(e=Uh){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Uh){return this.instances.has(e)}getOptions(e=Uh){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const n=this.getOrInitializeService({instanceIdentifier:s,options:r});for(const[i,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(i);s===l&&o.resolve(n)}return n}onInit(e,r){var s;const n=this.normalizeInstanceIdentifier(r),i=(s=this.onInitCallbacks.get(n))!==null&&s!==void 0?s:new Set;i.add(e),this.onInitCallbacks.set(n,i);const o=this.instances.get(n);return o&&e(o,n),()=>{i.delete(e)}}invokeOnInitCallbacks(e,r){const s=this.onInitCallbacks.get(r);if(s)for(const n of s)try{n(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:FW(e),options:r}),this.instances.set(e,s),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch{}return s||null}normalizeInstanceIdentifier(e=Uh){return this.component?this.component.multipleInstances?e:Uh:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function FW(t){return t===Uh?void 0:t}function PW(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DW{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new BW(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var cs;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(cs||(cs={}));const RW={debug:cs.DEBUG,verbose:cs.VERBOSE,info:cs.INFO,warn:cs.WARN,error:cs.ERROR,silent:cs.SILENT},LW=cs.INFO,OW={[cs.DEBUG]:"log",[cs.VERBOSE]:"log",[cs.INFO]:"info",[cs.WARN]:"warn",[cs.ERROR]:"error"},UW=(t,e,...r)=>{if(e<t.logLevel)return;const s=new Date().toISOString(),n=OW[e];if(n)console[n](`[${s}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};let $E=class{constructor(e){this.name=e,this._logLevel=LW,this._logHandler=UW,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in cs))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?RW[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,cs.DEBUG,...e),this._logHandler(this,cs.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,cs.VERBOSE,...e),this._logHandler(this,cs.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,cs.INFO,...e),this._logHandler(this,cs.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,cs.WARN,...e),this._logHandler(this,cs.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,cs.ERROR,...e),this._logHandler(this,cs.ERROR,...e)}};const MW=(t,e)=>e.some(r=>t instanceof r);let ck,dk;function QW(){return ck||(ck=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function VW(){return dk||(dk=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const nL=new WeakMap,J4=new WeakMap,aL=new WeakMap,D5=new WeakMap,KE=new WeakMap;function HW(t){const e=new Promise((r,s)=>{const n=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{r(FA(t.result)),n()},o=()=>{s(t.error),n()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(r=>{r instanceof IDBCursor&&nL.set(r,t)}).catch(()=>{}),KE.set(e,t),e}function $W(t){if(J4.has(t))return;const e=new Promise((r,s)=>{const n=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{r(),n()},o=()=>{s(t.error||new DOMException("AbortError","AbortError")),n()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});J4.set(t,e)}let Z4={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return J4.get(t);if(e==="objectStoreNames")return t.objectStoreNames||aL.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return FA(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function KW(t){Z4=t(Z4)}function zW(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const s=t.call(R5(this),e,...r);return aL.set(s,e.sort?e.sort():[e]),FA(s)}:VW().includes(t)?function(...e){return t.apply(R5(this),e),FA(nL.get(this))}:function(...e){return FA(t.apply(R5(this),e))}}function qW(t){return typeof t=="function"?zW(t):(t instanceof IDBTransaction&&$W(t),MW(t,QW())?new Proxy(t,Z4):t)}function FA(t){if(t instanceof IDBRequest)return HW(t);if(D5.has(t))return D5.get(t);const e=qW(t);return e!==t&&(D5.set(t,e),KE.set(e,t)),e}const R5=t=>KE.get(t);function WW(t,e,{blocked:r,upgrade:s,blocking:n,terminated:i}={}){const o=indexedDB.open(t,e),l=FA(o);return s&&o.addEventListener("upgradeneeded",c=>{s(FA(o.result),c.oldVersion,c.newVersion,FA(o.transaction),c)}),r&&o.addEventListener("blocked",c=>r(c.oldVersion,c.newVersion,c)),l.then(c=>{i&&c.addEventListener("close",()=>i()),n&&c.addEventListener("versionchange",d=>n(d.oldVersion,d.newVersion,d))}).catch(()=>{}),l}const GW=["get","getKey","getAll","getAllKeys","count"],YW=["put","add","delete","clear"],L5=new Map;function uk(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(L5.get(e))return L5.get(e);const r=e.replace(/FromIndex$/,""),s=e!==r,n=YW.includes(r);if(!(r in(s?IDBIndex:IDBObjectStore).prototype)||!(n||GW.includes(r)))return;const i=async function(o,...l){const c=this.transaction(o,n?"readwrite":"readonly");let d=c.store;return s&&(d=d.index(l.shift())),(await Promise.all([d[r](...l),n&&c.done]))[0]};return L5.set(e,i),i}KW(t=>({...t,get:(e,r,s)=>uk(e,r)||t.get(e,r,s),has:(e,r)=>!!uk(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XW{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(JW(r)){const s=r.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(r=>r).join(" ")}}function JW(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const ej="@firebase/app",Ak="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tu=new $E("@firebase/app"),ZW="@firebase/app-compat",eG="@firebase/analytics-compat",tG="@firebase/analytics",rG="@firebase/app-check-compat",sG="@firebase/app-check",nG="@firebase/auth",aG="@firebase/auth-compat",iG="@firebase/database",oG="@firebase/data-connect",lG="@firebase/database-compat",cG="@firebase/functions",dG="@firebase/functions-compat",uG="@firebase/installations",AG="@firebase/installations-compat",hG="@firebase/messaging",fG="@firebase/messaging-compat",mG="@firebase/performance",pG="@firebase/performance-compat",gG="@firebase/remote-config",xG="@firebase/remote-config-compat",yG="@firebase/storage",vG="@firebase/storage-compat",bG="@firebase/firestore",wG="@firebase/vertexai-preview",NG="@firebase/firestore-compat",CG="firebase",jG="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tj="[DEFAULT]",SG={[ej]:"fire-core",[ZW]:"fire-core-compat",[tG]:"fire-analytics",[eG]:"fire-analytics-compat",[sG]:"fire-app-check",[rG]:"fire-app-check-compat",[nG]:"fire-auth",[aG]:"fire-auth-compat",[iG]:"fire-rtdb",[oG]:"fire-data-connect",[lG]:"fire-rtdb-compat",[cG]:"fire-fn",[dG]:"fire-fn-compat",[uG]:"fire-iid",[AG]:"fire-iid-compat",[hG]:"fire-fcm",[fG]:"fire-fcm-compat",[mG]:"fire-perf",[pG]:"fire-perf-compat",[gG]:"fire-rc",[xG]:"fire-rc-compat",[yG]:"fire-gcs",[vG]:"fire-gcs-compat",[bG]:"fire-fst",[NG]:"fire-fst-compat",[wG]:"fire-vertex","fire-js":"fire-js",[CG]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gw=new Map,EG=new Map,rj=new Map;function hk(t,e){try{t.container.addComponent(e)}catch(r){tu.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function Sf(t){const e=t.name;if(rj.has(e))return tu.debug(`There were multiple attempts to register component ${e}.`),!1;rj.set(e,t);for(const r of gw.values())hk(r,t);for(const r of EG.values())hk(r,t);return!0}function H2(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function Mc(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _G={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},PA=new Dy("app","Firebase",_G);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TG{constructor(e,r,s){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new $A("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw PA.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tp=jG;function iL(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const s=Object.assign({name:tj,automaticDataCollectionEnabled:!1},e),n=s.name;if(typeof n!="string"||!n)throw PA.create("bad-app-name",{appName:String(n)});if(r||(r=eL()),!r)throw PA.create("no-options");const i=gw.get(n);if(i){if(pw(r,i.options)&&pw(s,i.config))return i;throw PA.create("duplicate-app",{appName:n})}const o=new DW(n);for(const c of rj.values())o.addComponent(c);const l=new TG(r,s,o);return gw.set(n,l),l}function zE(t=tj){const e=gw.get(t);if(!e&&t===tj&&eL())return iL();if(!e)throw PA.create("no-app",{appName:t});return e}function Wc(t,e,r){var s;let n=(s=SG[t])!==null&&s!==void 0?s:t;r&&(n+=`-${r}`);const i=n.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const l=[`Unable to register library "${n}" with version "${e}":`];i&&l.push(`library name "${n}" contains illegal characters (whitespace or "/")`),i&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),tu.warn(l.join(" "));return}Sf(new $A(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IG="firebase-heartbeat-database",kG=1,Xx="firebase-heartbeat-store";let O5=null;function oL(){return O5||(O5=WW(IG,kG,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Xx)}catch(r){console.warn(r)}}}}).catch(t=>{throw PA.create("idb-open",{originalErrorMessage:t.message})})),O5}async function BG(t){try{const r=(await oL()).transaction(Xx),s=await r.objectStore(Xx).get(lL(t));return await r.done,s}catch(e){if(e instanceof Au)tu.warn(e.message);else{const r=PA.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});tu.warn(r.message)}}}async function fk(t,e){try{const s=(await oL()).transaction(Xx,"readwrite");await s.objectStore(Xx).put(e,lL(t)),await s.done}catch(r){if(r instanceof Au)tu.warn(r.message);else{const s=PA.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});tu.warn(s.message)}}}function lL(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FG=1024,PG=30*24*60*60*1e3;class DG{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new LG(r),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){var e,r;try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=mk();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i)?void 0:(this._heartbeatsCache.heartbeats.push({date:i,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const l=new Date(o.date).valueOf();return Date.now()-l<=PG}),this._storage.overwrite(this._heartbeatsCache))}catch(s){tu.warn(s)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=mk(),{heartbeatsToSend:s,unsentEntries:n}=RG(this._heartbeatsCache.heartbeats),i=mw(JSON.stringify({version:2,heartbeats:s}));return this._heartbeatsCache.lastSentHeartbeatDate=r,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(r){return tu.warn(r),""}}}function mk(){return new Date().toISOString().substring(0,10)}function RG(t,e=FG){const r=[];let s=t.slice();for(const n of t){const i=r.find(o=>o.agent===n.agent);if(i){if(i.dates.push(n.date),pk(r)>e){i.dates.pop();break}}else if(r.push({agent:n.agent,dates:[n.date]}),pk(r)>e){r.pop();break}s=s.slice(1)}return{heartbeatsToSend:r,unsentEntries:s}}class LG{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return sL()?CW().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await BG(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var r;if(await this._canUseIndexedDBPromise){const n=await this.read();return fk(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var r;if(await this._canUseIndexedDBPromise){const n=await this.read();return fk(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function pk(t){return mw(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OG(t){Sf(new $A("platform-logger",e=>new XW(e),"PRIVATE")),Sf(new $A("heartbeat",e=>new DG(e),"PRIVATE")),Wc(ej,Ak,t),Wc(ej,Ak,"esm2017"),Wc("fire-js","")}OG("");var UG="firebase",MG="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Wc(UG,MG,"app");function qE(t,e){var r={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(r[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(t);n<s.length;n++)e.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(t,s[n])&&(r[s[n]]=t[s[n]]);return r}function cL(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const QG=cL,dL=new Dy("auth","Firebase",cL());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xw=new $E("@firebase/auth");function VG(t,...e){xw.logLevel<=cs.WARN&&xw.warn(`Auth (${Tp}): ${t}`,...e)}function yb(t,...e){xw.logLevel<=cs.ERROR&&xw.error(`Auth (${Tp}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mc(t,...e){throw WE(t,...e)}function Gc(t,...e){return WE(t,...e)}function uL(t,e,r){const s=Object.assign(Object.assign({},QG()),{[e]:r});return new Dy("auth","Firebase",s).create(e,{appName:t.name})}function $d(t){return uL(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function WE(t,...e){if(typeof t!="string"){const r=e[0],s=[...e.slice(1)];return s[0]&&(s[0].appName=t.name),t._errorFactory.create(r,...s)}return dL.create(t,...e)}function Lr(t,e,...r){if(!t)throw WE(e,...r)}function Ld(t){const e="INTERNAL ASSERTION FAILED: "+t;throw yb(e),new Error(e)}function ru(t,e){t||Ld(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sj(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function HG(){return gk()==="http:"||gk()==="https:"}function gk(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $G(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(HG()||bW()||"connection"in navigator)?navigator.onLine:!0}function KG(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ly{constructor(e,r){this.shortDelay=e,this.longDelay=r,ru(r>e,"Short delay should be less than long delay!"),this.isMobile=xW()||wW()}get(){return $G()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GE(t,e){ru(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AL{static initialize(e,r,s){this.fetchImpl=e,r&&(this.headersImpl=r),s&&(this.responseImpl=s)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ld("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ld("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ld("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zG={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qG=new Ly(3e4,6e4);function dh(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function uh(t,e,r,s,n={}){return hL(t,n,async()=>{let i={},o={};s&&(e==="GET"?o=s:i={body:JSON.stringify(s)});const l=Ry(Object.assign({key:t.config.apiKey},o)).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const d=Object.assign({method:e,headers:c},i);return vW()||(d.referrerPolicy="no-referrer"),AL.fetch()(fL(t,t.config.apiHost,r,l),d)})}async function hL(t,e,r){t._canInitEmulator=!1;const s=Object.assign(Object.assign({},zG),e);try{const n=new GG(t),i=await Promise.race([r(),n.promise]);n.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw r1(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const l=i.ok?o.errorMessage:o.error.message,[c,d]=l.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw r1(t,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw r1(t,"email-already-in-use",o);if(c==="USER_DISABLED")throw r1(t,"user-disabled",o);const u=s[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw uL(t,u,d);mc(t,u)}}catch(n){if(n instanceof Au)throw n;mc(t,"network-request-failed",{message:String(n)})}}async function Oy(t,e,r,s,n={}){const i=await uh(t,e,r,s,n);return"mfaPendingCredential"in i&&mc(t,"multi-factor-auth-required",{_serverResponse:i}),i}function fL(t,e,r,s){const n=`${e}${r}?${s}`;return t.config.emulator?GE(t.config,n):`${t.config.apiScheme}://${n}`}function WG(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class GG{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,s)=>{this.timer=setTimeout(()=>s(Gc(this.auth,"network-request-failed")),qG.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function r1(t,e,r){const s={appName:t.name};r.email&&(s.email=r.email),r.phoneNumber&&(s.phoneNumber=r.phoneNumber);const n=Gc(t,e,s);return n.customData._tokenResponse=r,n}function xk(t){return t!==void 0&&t.enterprise!==void 0}class YG{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const r of this.recaptchaEnforcementState)if(r.provider&&r.provider===e)return WG(r.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function XG(t,e){return uh(t,"GET","/v2/recaptchaConfig",dh(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function JG(t,e){return uh(t,"POST","/v1/accounts:delete",e)}async function mL(t,e){return uh(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nx(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function ZG(t,e=!1){const r=In(t),s=await r.getIdToken(e),n=YE(s);Lr(n&&n.exp&&n.auth_time&&n.iat,r.auth,"internal-error");const i=typeof n.firebase=="object"?n.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:n,token:s,authTime:nx(U5(n.auth_time)),issuedAtTime:nx(U5(n.iat)),expirationTime:nx(U5(n.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function U5(t){return Number(t)*1e3}function YE(t){const[e,r,s]=t.split(".");if(e===void 0||r===void 0||s===void 0)return yb("JWT malformed, contained fewer than 3 sections"),null;try{const n=X8(r);return n?JSON.parse(n):(yb("Failed to decode base64 JWT payload"),null)}catch(n){return yb("Caught error parsing JWT payload as JSON",n==null?void 0:n.toString()),null}}function yk(t){const e=YE(t);return Lr(e,"internal-error"),Lr(typeof e.exp<"u","internal-error"),Lr(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Jx(t,e,r=!1){if(r)return e;try{return await e}catch(s){throw s instanceof Au&&eY(s)&&t.auth.currentUser===t&&await t.auth.signOut(),s}}function eY({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tY{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var r;if(e){const s=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),s}else{this.errorBackoff=3e4;const n=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nj{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=nx(this.lastLoginAt),this.creationTime=nx(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yw(t){var e;const r=t.auth,s=await t.getIdToken(),n=await Jx(t,mL(r,{idToken:s}));Lr(n==null?void 0:n.users.length,r,"internal-error");const i=n.users[0];t._notifyReloadListener(i);const o=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?pL(i.providerUserInfo):[],l=sY(t.providerData,o),c=t.isAnonymous,d=!(t.email&&i.passwordHash)&&!(l!=null&&l.length),u=c?d:!1,A={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:l,metadata:new nj(i.createdAt,i.lastLoginAt),isAnonymous:u};Object.assign(t,A)}async function rY(t){const e=In(t);await yw(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function sY(t,e){return[...t.filter(s=>!e.some(n=>n.providerId===s.providerId)),...e]}function pL(t){return t.map(e=>{var{providerId:r}=e,s=qE(e,["providerId"]);return{providerId:r,uid:s.rawId||"",displayName:s.displayName||null,email:s.email||null,phoneNumber:s.phoneNumber||null,photoURL:s.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nY(t,e){const r=await hL(t,{},async()=>{const s=Ry({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:n,apiKey:i}=t.config,o=fL(t,n,"/v1/token",`key=${i}`),l=await t._getAdditionalHeaders();return l["Content-Type"]="application/x-www-form-urlencoded",AL.fetch()(o,{method:"POST",headers:l,body:s})});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function aY(t,e){return uh(t,"POST","/v2/accounts:revokeToken",dh(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I0{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Lr(e.idToken,"internal-error"),Lr(typeof e.idToken<"u","internal-error"),Lr(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):yk(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){Lr(e.length!==0,"internal-error");const r=yk(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(Lr(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:s,refreshToken:n,expiresIn:i}=await nY(e,r);this.updateTokensAndExpiration(s,n,Number(i))}updateTokensAndExpiration(e,r,s){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+s*1e3}static fromJSON(e,r){const{refreshToken:s,accessToken:n,expirationTime:i}=r,o=new I0;return s&&(Lr(typeof s=="string","internal-error",{appName:e}),o.refreshToken=s),n&&(Lr(typeof n=="string","internal-error",{appName:e}),o.accessToken=n),i&&(Lr(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new I0,this.toJSON())}_performRefresh(){return Ld("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hu(t,e){Lr(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Od{constructor(e){var{uid:r,auth:s,stsTokenManager:n}=e,i=qE(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new tY(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=s,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new nj(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const r=await Jx(this,this.stsTokenManager.getToken(this.auth,e));return Lr(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return ZG(this,e)}reload(){return rY(this)}_assign(e){this!==e&&(Lr(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>Object.assign({},r)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new Od(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(e){Lr(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let s=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),s=!0),r&&await yw(this),await this.auth._persistUserIfCurrent(this),s&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Mc(this.auth.app))return Promise.reject($d(this.auth));const e=await this.getIdToken();return await Jx(this,JG(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){var s,n,i,o,l,c,d,u;const A=(s=r.displayName)!==null&&s!==void 0?s:void 0,h=(n=r.email)!==null&&n!==void 0?n:void 0,f=(i=r.phoneNumber)!==null&&i!==void 0?i:void 0,p=(o=r.photoURL)!==null&&o!==void 0?o:void 0,m=(l=r.tenantId)!==null&&l!==void 0?l:void 0,g=(c=r._redirectEventId)!==null&&c!==void 0?c:void 0,y=(d=r.createdAt)!==null&&d!==void 0?d:void 0,v=(u=r.lastLoginAt)!==null&&u!==void 0?u:void 0,{uid:x,emailVerified:E,isAnonymous:T,providerData:j,stsTokenManager:C}=r;Lr(x&&C,e,"internal-error");const w=I0.fromJSON(this.name,C);Lr(typeof x=="string",e,"internal-error"),Hu(A,e.name),Hu(h,e.name),Lr(typeof E=="boolean",e,"internal-error"),Lr(typeof T=="boolean",e,"internal-error"),Hu(f,e.name),Hu(p,e.name),Hu(m,e.name),Hu(g,e.name),Hu(y,e.name),Hu(v,e.name);const S=new Od({uid:x,auth:e,email:h,emailVerified:E,displayName:A,isAnonymous:T,photoURL:p,phoneNumber:f,tenantId:m,stsTokenManager:w,createdAt:y,lastLoginAt:v});return j&&Array.isArray(j)&&(S.providerData=j.map(F=>Object.assign({},F))),g&&(S._redirectEventId=g),S}static async _fromIdTokenResponse(e,r,s=!1){const n=new I0;n.updateFromServerResponse(r);const i=new Od({uid:r.localId,auth:e,stsTokenManager:n,isAnonymous:s});return await yw(i),i}static async _fromGetAccountInfoResponse(e,r,s){const n=r.users[0];Lr(n.localId!==void 0,"internal-error");const i=n.providerUserInfo!==void 0?pL(n.providerUserInfo):[],o=!(n.email&&n.passwordHash)&&!(i!=null&&i.length),l=new I0;l.updateFromIdToken(s);const c=new Od({uid:n.localId,auth:e,stsTokenManager:l,isAnonymous:o}),d={uid:n.localId,displayName:n.displayName||null,photoURL:n.photoUrl||null,email:n.email||null,emailVerified:n.emailVerified||!1,phoneNumber:n.phoneNumber||null,tenantId:n.tenantId||null,providerData:i,metadata:new nj(n.createdAt,n.lastLoginAt),isAnonymous:!(n.email&&n.passwordHash)&&!(i!=null&&i.length)};return Object.assign(c,d),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vk=new Map;function Ud(t){ru(t instanceof Function,"Expected a class definition");let e=vk.get(t);return e?(ru(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,vk.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gL{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}gL.type="NONE";const bk=gL;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vb(t,e,r){return`firebase:${t}:${e}:${r}`}class k0{constructor(e,r,s){this.persistence=e,this.auth=r,this.userKey=s;const{config:n,name:i}=this.auth;this.fullUserKey=vb(this.userKey,n.apiKey,i),this.fullPersistenceKey=vb("persistence",n.apiKey,i),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Od._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,s="authUser"){if(!r.length)return new k0(Ud(bk),e,s);const n=(await Promise.all(r.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let i=n[0]||Ud(bk);const o=vb(s,e.config.apiKey,e.name);let l=null;for(const d of r)try{const u=await d._get(o);if(u){const A=Od._fromJSON(e,u);d!==i&&(l=A),i=d;break}}catch{}const c=n.filter(d=>d._shouldAllowMigration);return!i._shouldAllowMigration||!c.length?new k0(i,e,s):(i=c[0],l&&await i._set(o,l.toJSON()),await Promise.all(r.map(async d=>{if(d!==i)try{await d._remove(o)}catch{}})),new k0(i,e,s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wk(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(bL(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(xL(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(NL(e))return"Blackberry";if(CL(e))return"Webos";if(yL(e))return"Safari";if((e.includes("chrome/")||vL(e))&&!e.includes("edge/"))return"Chrome";if(wL(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,s=t.match(r);if((s==null?void 0:s.length)===2)return s[1]}return"Other"}function xL(t=Ea()){return/firefox\//i.test(t)}function yL(t=Ea()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function vL(t=Ea()){return/crios\//i.test(t)}function bL(t=Ea()){return/iemobile/i.test(t)}function wL(t=Ea()){return/android/i.test(t)}function NL(t=Ea()){return/blackberry/i.test(t)}function CL(t=Ea()){return/webos/i.test(t)}function XE(t=Ea()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function iY(t=Ea()){var e;return XE(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function oY(){return NW()&&document.documentMode===10}function jL(t=Ea()){return XE(t)||wL(t)||CL(t)||NL(t)||/windows phone/i.test(t)||bL(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SL(t,e=[]){let r;switch(t){case"Browser":r=wk(Ea());break;case"Worker":r=`${wk(Ea())}-${t}`;break;default:r=t}const s=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${Tp}/${s}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lY{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const s=i=>new Promise((o,l)=>{try{const c=e(i);o(c)}catch(c){l(c)}});s.onAbort=r,this.queue.push(s);const n=this.queue.length-1;return()=>{this.queue[n]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const s of this.queue)await s(e),s.onAbort&&r.push(s.onAbort)}catch(s){r.reverse();for(const n of r)try{n()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:s==null?void 0:s.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cY(t,e={}){return uh(t,"GET","/v2/passwordPolicy",dh(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dY=6;class uY{constructor(e){var r,s,n,i;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(r=o.minPasswordLength)!==null&&r!==void 0?r:dY,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(n=(s=e.allowedNonAlphanumericCharacters)===null||s===void 0?void 0:s.join(""))!==null&&n!==void 0?n:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var r,s,n,i,o,l;const c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(r=c.meetsMinPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(s=c.meetsMaxPasswordLength)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(n=c.containsLowercaseLetter)!==null&&n!==void 0?n:!0),c.isValid&&(c.isValid=(i=c.containsUppercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(o=c.containsNumericCharacter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(l=c.containsNonAlphanumericCharacter)!==null&&l!==void 0?l:!0),c}validatePasswordLengthOptions(e,r){const s=this.customStrengthOptions.minPasswordLength,n=this.customStrengthOptions.maxPasswordLength;s&&(r.meetsMinPasswordLength=e.length>=s),n&&(r.meetsMaxPasswordLength=e.length<=n)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let s;for(let n=0;n<e.length;n++)s=e.charAt(n),this.updatePasswordCharacterOptionsStatuses(r,s>="a"&&s<="z",s>="A"&&s<="Z",s>="0"&&s<="9",this.allowedNonAlphanumericCharacters.includes(s))}updatePasswordCharacterOptionsStatuses(e,r,s,n,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=s)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=n)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AY{constructor(e,r,s,n){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=s,this.config=n,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Nk(this),this.idTokenSubscription=new Nk(this),this.beforeStateQueue=new lY(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=dL,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=n.sdkClientVersion}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=Ud(r)),this._initializationPromise=this.queue(async()=>{var s,n;if(!this._deleted&&(this.persistenceManager=await k0.create(this,e),!this._deleted)){if(!((s=this._popupRedirectResolver)===null||s===void 0)&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((n=this.currentUser)===null||n===void 0?void 0:n.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await mL(this,{idToken:e}),s=await Od._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(s)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var r;if(Mc(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(l,l))}):this.directlySetCurrentUser(null)}const s=await this.assertedPersistence.getCurrentUser();let n=s,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,l=n==null?void 0:n._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===l)&&(c!=null&&c.user)&&(n=c.user,i=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(n)}catch(o){n=s,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return Lr(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await yw(e)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=KG()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Mc(this.app))return Promise.reject($d(this));const r=e?In(e):null;return r&&Lr(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&Lr(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Mc(this.app)?Promise.reject($d(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Mc(this.app)?Promise.reject($d(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ud(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await cY(this),r=new uY(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Dy("auth","Firebase",e())}onAuthStateChanged(e,r,s){return this.registerStateListener(this.authStateSubscription,e,r,s)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,s){return this.registerStateListener(this.idTokenSubscription,e,r,s)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const s=this.onAuthStateChanged(()=>{s(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),s={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(s.tenantId=this.tenantId),await aY(this,s)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,r){const s=await this.getOrInitRedirectPersistenceManager(r);return e===null?s.removeCurrentUser():s.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&Ud(e)||this._popupRedirectResolver;Lr(r,this,"argument-error"),this.redirectPersistenceManager=await k0.create(this,[Ud(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,s;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===e?this._currentUser:((s=this.redirectUser)===null||s===void 0?void 0:s._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const s=(r=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==s&&(this.lastNotifiedUid=s,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,s,n){if(this._deleted)return()=>{};const i=typeof r=="function"?r:r.next.bind(r);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(Lr(l,this,"internal-error"),l.then(()=>{o||i(this.currentUser)}),typeof r=="function"){const c=e.addObserver(r,s,n);return()=>{o=!0,c()}}else{const c=e.addObserver(r);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Lr(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=SL(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);const s=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());s&&(r["X-Firebase-Client"]=s);const n=await this._getAppCheckToken();return n&&(r["X-Firebase-AppCheck"]=n),r}async _getAppCheckToken(){var e;const r=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return r!=null&&r.error&&VG(`Error while retrieving App Check token: ${r.error}`),r==null?void 0:r.token}}function Yf(t){return In(t)}class Nk{constructor(e){this.auth=e,this.observer=null,this.addObserver=TW(r=>this.observer=r)}get next(){return Lr(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let $2={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function hY(t){$2=t}function EL(t){return $2.loadJS(t)}function fY(){return $2.recaptchaEnterpriseScript}function mY(){return $2.gapiScript}function pY(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const gY="recaptcha-enterprise",xY="NO_RECAPTCHA";class yY{constructor(e){this.type=gY,this.auth=Yf(e)}async verify(e="verify",r=!1){async function s(i){if(!r){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,l)=>{XG(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)l(new Error("recaptcha Enterprise site key undefined"));else{const d=new YG(c);return i.tenantId==null?i._agentRecaptchaConfig=d:i._tenantRecaptchaConfigs[i.tenantId]=d,o(d.siteKey)}}).catch(c=>{l(c)})})}function n(i,o,l){const c=window.grecaptcha;xk(c)?c.enterprise.ready(()=>{c.enterprise.execute(i,{action:e}).then(d=>{o(d)}).catch(()=>{o(xY)})}):l(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((i,o)=>{s(this.auth).then(l=>{if(!r&&xk(window.grecaptcha))n(l,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let c=fY();c.length!==0&&(c+=l),EL(c).then(()=>{n(l,i,o)}).catch(d=>{o(d)})}}).catch(l=>{o(l)})})}}async function Ck(t,e,r,s=!1){const n=new yY(t);let i;try{i=await n.verify(r)}catch{i=await n.verify(r,!0)}const o=Object.assign({},e);return s?Object.assign(o,{captchaResp:i}):Object.assign(o,{captchaResponse:i}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function aj(t,e,r,s){var n;if(!((n=t._getRecaptchaConfig())===null||n===void 0)&&n.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await Ck(t,e,r,r==="getOobCode");return s(t,i)}else return s(t,e).catch(async i=>{if(i.code==="auth/missing-recaptcha-token"){console.log(`${r} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await Ck(t,e,r,r==="getOobCode");return s(t,o)}else return Promise.reject(i)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vY(t,e){const r=H2(t,"auth");if(r.isInitialized()){const n=r.getImmediate(),i=r.getOptions();if(pw(i,e??{}))return n;mc(n,"already-initialized")}return r.initialize({options:e})}function bY(t,e){const r=(e==null?void 0:e.persistence)||[],s=(Array.isArray(r)?r:[r]).map(Ud);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(s,e==null?void 0:e.popupRedirectResolver)}function wY(t,e,r){const s=Yf(t);Lr(s._canInitEmulator,s,"emulator-config-failed"),Lr(/^https?:\/\//.test(e),s,"invalid-emulator-scheme");const n=!1,i=_L(e),{host:o,port:l}=NY(e),c=l===null?"":`:${l}`;s.config.emulator={url:`${i}//${o}${c}/`},s.settings.appVerificationDisabledForTesting=!0,s.emulatorConfig=Object.freeze({host:o,port:l,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:n})}),CY()}function _L(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function NY(t){const e=_L(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const s=r[2].split("@").pop()||"",n=/^(\[[^\]]+\])(:|$)/.exec(s);if(n){const i=n[1];return{host:i,port:jk(s.substr(i.length+1))}}else{const[i,o]=s.split(":");return{host:i,port:jk(o)}}}function jk(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function CY(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JE{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return Ld("not implemented")}_getIdTokenResponse(e){return Ld("not implemented")}_linkToIdToken(e,r){return Ld("not implemented")}_getReauthenticationResolver(e){return Ld("not implemented")}}async function jY(t,e){return uh(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function SY(t,e){return Oy(t,"POST","/v1/accounts:signInWithPassword",dh(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function EY(t,e){return Oy(t,"POST","/v1/accounts:signInWithEmailLink",dh(t,e))}async function _Y(t,e){return Oy(t,"POST","/v1/accounts:signInWithEmailLink",dh(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zx extends JE{constructor(e,r,s,n=null){super("password",s),this._email=e,this._password=r,this._tenantId=n}static _fromEmailAndPassword(e,r){return new Zx(e,r,"password")}static _fromEmailAndCode(e,r,s=null){return new Zx(e,r,"emailLink",s)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e;if(r!=null&&r.email&&(r!=null&&r.password)){if(r.signInMethod==="password")return this._fromEmailAndPassword(r.email,r.password);if(r.signInMethod==="emailLink")return this._fromEmailAndCode(r.email,r.password,r.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const r={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return aj(e,r,"signInWithPassword",SY);case"emailLink":return EY(e,{email:this._email,oobCode:this._password});default:mc(e,"internal-error")}}async _linkToIdToken(e,r){switch(this.signInMethod){case"password":const s={idToken:r,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return aj(e,s,"signUpPassword",jY);case"emailLink":return _Y(e,{idToken:r,email:this._email,oobCode:this._password});default:mc(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function B0(t,e){return Oy(t,"POST","/v1/accounts:signInWithIdp",dh(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TY="http://localhost";class Ef extends JE{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new Ef(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):mc("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:s,signInMethod:n}=r,i=qE(r,["providerId","signInMethod"]);if(!s||!n)return null;const o=new Ef(s,n);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const r=this.buildRequest();return B0(e,r)}_linkToIdToken(e,r){const s=this.buildRequest();return s.idToken=r,B0(e,s)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,B0(e,r)}buildRequest(){const e={requestUri:TY,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=Ry(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IY(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function kY(t){const e=kg(Bg(t)).link,r=e?kg(Bg(e)).deep_link_id:null,s=kg(Bg(t)).deep_link_id;return(s?kg(Bg(s)).link:null)||s||r||e||t}class ZE{constructor(e){var r,s,n,i,o,l;const c=kg(Bg(e)),d=(r=c.apiKey)!==null&&r!==void 0?r:null,u=(s=c.oobCode)!==null&&s!==void 0?s:null,A=IY((n=c.mode)!==null&&n!==void 0?n:null);Lr(d&&u&&A,"argument-error"),this.apiKey=d,this.operation=A,this.code=u,this.continueUrl=(i=c.continueUrl)!==null&&i!==void 0?i:null,this.languageCode=(o=c.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(l=c.tenantId)!==null&&l!==void 0?l:null}static parseLink(e){const r=kY(e);try{return new ZE(r)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ip{constructor(){this.providerId=Ip.PROVIDER_ID}static credential(e,r){return Zx._fromEmailAndPassword(e,r)}static credentialWithLink(e,r){const s=ZE.parseLink(r);return Lr(s,"argument-error"),Zx._fromEmailAndCode(e,s.code,s.tenantId)}}Ip.PROVIDER_ID="password";Ip.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Ip.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TL{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uy extends TL{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aA extends Uy{constructor(){super("facebook.com")}static credential(e){return Ef._fromParams({providerId:aA.PROVIDER_ID,signInMethod:aA.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return aA.credentialFromTaggedObject(e)}static credentialFromError(e){return aA.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return aA.credential(e.oauthAccessToken)}catch{return null}}}aA.FACEBOOK_SIGN_IN_METHOD="facebook.com";aA.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iA extends Uy{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return Ef._fromParams({providerId:iA.PROVIDER_ID,signInMethod:iA.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return iA.credentialFromTaggedObject(e)}static credentialFromError(e){return iA.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:s}=e;if(!r&&!s)return null;try{return iA.credential(r,s)}catch{return null}}}iA.GOOGLE_SIGN_IN_METHOD="google.com";iA.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oA extends Uy{constructor(){super("github.com")}static credential(e){return Ef._fromParams({providerId:oA.PROVIDER_ID,signInMethod:oA.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return oA.credentialFromTaggedObject(e)}static credentialFromError(e){return oA.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return oA.credential(e.oauthAccessToken)}catch{return null}}}oA.GITHUB_SIGN_IN_METHOD="github.com";oA.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lA extends Uy{constructor(){super("twitter.com")}static credential(e,r){return Ef._fromParams({providerId:lA.PROVIDER_ID,signInMethod:lA.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return lA.credentialFromTaggedObject(e)}static credentialFromError(e){return lA.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:s}=e;if(!r||!s)return null;try{return lA.credential(r,s)}catch{return null}}}lA.TWITTER_SIGN_IN_METHOD="twitter.com";lA.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function BY(t,e){return Oy(t,"POST","/v1/accounts:signUp",dh(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _f{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,s,n=!1){const i=await Od._fromIdTokenResponse(e,s,n),o=Sk(s);return new _f({user:i,providerId:o,_tokenResponse:s,operationType:r})}static async _forOperation(e,r,s){await e._updateTokensIfNecessary(s,!0);const n=Sk(s);return new _f({user:e,providerId:n,_tokenResponse:s,operationType:r})}}function Sk(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vw extends Au{constructor(e,r,s,n){var i;super(r.code,r.message),this.operationType=s,this.user=n,Object.setPrototypeOf(this,vw.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:r.customData._serverResponse,operationType:s}}static _fromErrorAndOperation(e,r,s,n){return new vw(e,r,s,n)}}function IL(t,e,r,s){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?vw._fromErrorAndOperation(t,i,e,s):i})}async function FY(t,e,r=!1){const s=await Jx(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return _f._forOperation(t,"link",s)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function PY(t,e,r=!1){const{auth:s}=t;if(Mc(s.app))return Promise.reject($d(s));const n="reauthenticate";try{const i=await Jx(t,IL(s,n,e,t),r);Lr(i.idToken,s,"internal-error");const o=YE(i.idToken);Lr(o,s,"internal-error");const{sub:l}=o;return Lr(t.uid===l,s,"user-mismatch"),_f._forOperation(t,n,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&mc(s,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kL(t,e,r=!1){if(Mc(t.app))return Promise.reject($d(t));const s="signIn",n=await IL(t,s,e),i=await _f._fromIdTokenResponse(t,s,n);return r||await t._updateCurrentUser(i.user),i}async function DY(t,e){return kL(Yf(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function BL(t){const e=Yf(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function FL(t,e,r){if(Mc(t.app))return Promise.reject($d(t));const s=Yf(t),o=await aj(s,{returnSecureToken:!0,email:e,password:r,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",BY).catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&BL(t),c}),l=await _f._fromIdTokenResponse(s,"signIn",o);return await s._updateCurrentUser(l.user),l}function ij(t,e,r){return Mc(t.app)?Promise.reject($d(t)):DY(In(t),Ip.credential(e,r)).catch(async s=>{throw s.code==="auth/password-does-not-meet-requirements"&&BL(t),s})}function RY(t,e,r,s){return In(t).onIdTokenChanged(e,r,s)}function LY(t,e,r){return In(t).beforeAuthStateChanged(e,r)}function Em(t){return In(t).signOut()}const bw="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PL{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(bw,"1"),this.storage.removeItem(bw),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OY=1e3,UY=10;class DL extends PL{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=jL(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const s=this.storage.getItem(r),n=this.localCache[r];s!==n&&e(r,n,s)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((o,l,c)=>{this.notifyListeners(o,c)});return}const s=e.key;r?this.detachListener():this.stopPolling();const n=()=>{const o=this.storage.getItem(s);!r&&this.localCache[s]===o||this.notifyListeners(s,o)},i=this.storage.getItem(s);oY()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(n,UY):n()}notifyListeners(e,r){this.localCache[e]=r;const s=this.listeners[e];if(s)for(const n of Array.from(s))n(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,s)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:s}),!0)})},OY)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}DL.type="LOCAL";const MY=DL;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RL extends PL{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}RL.type="SESSION";const LL=RL;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QY(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K2{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(n=>n.isListeningto(e));if(r)return r;const s=new K2(e);return this.receivers.push(s),s}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:s,eventType:n,data:i}=r.data,o=this.handlersMap[n];if(!(o!=null&&o.size))return;r.ports[0].postMessage({status:"ack",eventId:s,eventType:n});const l=Array.from(o).map(async d=>d(r.origin,i)),c=await QY(l);r.ports[0].postMessage({status:"done",eventId:s,eventType:n,response:c})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}K2.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e3(t="",e=10){let r="";for(let s=0;s<e;s++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VY{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,s=50){const n=typeof MessageChannel<"u"?new MessageChannel:null;if(!n)throw new Error("connection_unavailable");let i,o;return new Promise((l,c)=>{const d=e3("",20);n.port1.start();const u=setTimeout(()=>{c(new Error("unsupported_event"))},s);o={messageChannel:n,onMessage(A){const h=A;if(h.data.eventId===d)switch(h.data.status){case"ack":clearTimeout(u),i=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),l(h.data.response);break;default:clearTimeout(u),clearTimeout(i),c(new Error("invalid_response"));break}}},this.handlers.add(o),n.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:d,data:r},[n.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yc(){return window}function HY(t){Yc().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OL(){return typeof Yc().WorkerGlobalScope<"u"&&typeof Yc().importScripts=="function"}async function $Y(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function KY(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function zY(){return OL()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UL="firebaseLocalStorageDb",qY=1,ww="firebaseLocalStorage",ML="fbase_key";class My{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function z2(t,e){return t.transaction([ww],e?"readwrite":"readonly").objectStore(ww)}function WY(){const t=indexedDB.deleteDatabase(UL);return new My(t).toPromise()}function oj(){const t=indexedDB.open(UL,qY);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const s=t.result;try{s.createObjectStore(ww,{keyPath:ML})}catch(n){r(n)}}),t.addEventListener("success",async()=>{const s=t.result;s.objectStoreNames.contains(ww)?e(s):(s.close(),await WY(),e(await oj()))})})}async function Ek(t,e,r){const s=z2(t,!0).put({[ML]:e,value:r});return new My(s).toPromise()}async function GY(t,e){const r=z2(t,!1).get(e),s=await new My(r).toPromise();return s===void 0?null:s.value}function _k(t,e){const r=z2(t,!0).delete(e);return new My(r).toPromise()}const YY=800,XY=3;class QL{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await oj(),this.db)}async _withRetries(e){let r=0;for(;;)try{const s=await this._openDb();return await e(s)}catch(s){if(r++>XY)throw s;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return OL()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=K2._getInstance(zY()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var e,r;if(this.activeServiceWorker=await $Y(),!this.activeServiceWorker)return;this.sender=new VY(this.activeServiceWorker);const s=await this.sender._send("ping",{},800);s&&!((e=s[0])===null||e===void 0)&&e.fulfilled&&!((r=s[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||KY()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await oj();return await Ek(e,bw,"1"),await _k(e,bw),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(s=>Ek(s,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(s=>GY(s,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>_k(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(n=>{const i=z2(n,!1).getAll();return new My(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],s=new Set;if(e.length!==0)for(const{fbase_key:n,value:i}of e)s.add(n),JSON.stringify(this.localCache[n])!==JSON.stringify(i)&&(this.notifyListeners(n,i),r.push(n));for(const n of Object.keys(this.localCache))this.localCache[n]&&!s.has(n)&&(this.notifyListeners(n,null),r.push(n));return r}notifyListeners(e,r){this.localCache[e]=r;const s=this.listeners[e];if(s)for(const n of Array.from(s))n(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),YY)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}QL.type="LOCAL";const JY=QL;new Ly(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZY(t,e){return e?Ud(e):(Lr(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t3 extends JE{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return B0(e,this._buildIdpRequest())}_linkToIdToken(e,r){return B0(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return B0(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function eX(t){return kL(t.auth,new t3(t),t.bypassAuthState)}function tX(t){const{auth:e,user:r}=t;return Lr(r,e,"internal-error"),PY(r,new t3(t),t.bypassAuthState)}async function rX(t){const{auth:e,user:r}=t;return Lr(r,e,"internal-error"),FY(r,new t3(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VL{constructor(e,r,s,n,i=!1){this.auth=e,this.resolver=s,this.user=n,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(s){this.reject(s)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:s,postBody:n,tenantId:i,error:o,type:l}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:r,sessionId:s,tenantId:i||void 0,postBody:n||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(c))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return eX;case"linkViaPopup":case"linkViaRedirect":return rX;case"reauthViaPopup":case"reauthViaRedirect":return tX;default:mc(this.auth,"internal-error")}}resolve(e){ru(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ru(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sX=new Ly(2e3,1e4);class x0 extends VL{constructor(e,r,s,n,i){super(e,r,n,i),this.provider=s,this.authWindow=null,this.pollId=null,x0.currentPopupAction&&x0.currentPopupAction.cancel(),x0.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Lr(e,this.auth,"internal-error"),e}async onExecution(){ru(this.filter.length===1,"Popup operations only handle one event");const e=e3();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(Gc(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Gc(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,x0.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,s;if(!((s=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||s===void 0)&&s.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Gc(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,sX.get())};e()}}x0.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nX="pendingRedirect",bb=new Map;class aX extends VL{constructor(e,r,s=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,s),this.eventId=null}async execute(){let e=bb.get(this.auth._key());if(!e){try{const s=await iX(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(s)}catch(r){e=()=>Promise.reject(r)}bb.set(this.auth._key(),e)}return this.bypassAuthState||bb.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function iX(t,e){const r=cX(e),s=lX(t);if(!await s._isAvailable())return!1;const n=await s._get(r)==="true";return await s._remove(r),n}function oX(t,e){bb.set(t._key(),e)}function lX(t){return Ud(t._redirectPersistence)}function cX(t){return vb(nX,t.config.apiKey,t.name)}async function dX(t,e,r=!1){if(Mc(t.app))return Promise.reject($d(t));const s=Yf(t),n=ZY(s,e),o=await new aX(s,n,r).execute();return o&&!r&&(delete o.user._redirectEventId,await s._persistUserIfCurrent(o.user),await s._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uX=10*60*1e3;class AX{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(s=>{this.isEventForConsumer(e,s)&&(r=!0,this.sendToConsumer(e,s),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!hX(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var s;if(e.error&&!HL(e)){const n=((s=e.error.code)===null||s===void 0?void 0:s.split("auth/")[1])||"internal-error";r.onError(Gc(this.auth,n))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const s=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&s}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=uX&&this.cachedEventUids.clear(),this.cachedEventUids.has(Tk(e))}saveEventToCache(e){this.cachedEventUids.add(Tk(e)),this.lastProcessedEventTime=Date.now()}}function Tk(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function HL({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function hX(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return HL(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fX(t,e={}){return uh(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mX=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,pX=/^https?/;async function gX(t){if(t.config.emulator)return;const{authorizedDomains:e}=await fX(t);for(const r of e)try{if(xX(r))return}catch{}mc(t,"unauthorized-domain")}function xX(t){const e=sj(),{protocol:r,hostname:s}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&s===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&o.hostname===s}if(!pX.test(r))return!1;if(mX.test(t))return s===t;const n=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+n+"|"+n+")$","i").test(s)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yX=new Ly(3e4,6e4);function Ik(){const t=Yc().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function vX(t){return new Promise((e,r)=>{var s,n,i;function o(){Ik(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Ik(),r(Gc(t,"network-request-failed"))},timeout:yX.get()})}if(!((n=(s=Yc().gapi)===null||s===void 0?void 0:s.iframes)===null||n===void 0)&&n.Iframe)e(gapi.iframes.getContext());else if(!((i=Yc().gapi)===null||i===void 0)&&i.load)o();else{const l=pY("iframefcb");return Yc()[l]=()=>{gapi.load?o():r(Gc(t,"network-request-failed"))},EL(`${mY()}?onload=${l}`).catch(c=>r(c))}}).catch(e=>{throw wb=null,e})}let wb=null;function bX(t){return wb=wb||vX(t),wb}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wX=new Ly(5e3,15e3),NX="__/auth/iframe",CX="emulator/auth/iframe",jX={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},SX=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function EX(t){const e=t.config;Lr(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?GE(e,CX):`https://${t.config.authDomain}/${NX}`,s={apiKey:e.apiKey,appName:t.name,v:Tp},n=SX.get(t.config.apiHost);n&&(s.eid=n);const i=t._getFrameworks();return i.length&&(s.fw=i.join(",")),`${r}?${Ry(s).slice(1)}`}async function _X(t){const e=await bX(t),r=Yc().gapi;return Lr(r,t,"internal-error"),e.open({where:document.body,url:EX(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:jX,dontclear:!0},s=>new Promise(async(n,i)=>{await s.restyle({setHideOnLeave:!1});const o=Gc(t,"network-request-failed"),l=Yc().setTimeout(()=>{i(o)},wX.get());function c(){Yc().clearTimeout(l),n(s)}s.ping(c).then(c,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TX={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},IX=500,kX=600,BX="_blank",FX="http://localhost";class kk{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function PX(t,e,r,s=IX,n=kX){const i=Math.max((window.screen.availHeight-n)/2,0).toString(),o=Math.max((window.screen.availWidth-s)/2,0).toString();let l="";const c=Object.assign(Object.assign({},TX),{width:s.toString(),height:n.toString(),top:i,left:o}),d=Ea().toLowerCase();r&&(l=vL(d)?BX:r),xL(d)&&(e=e||FX,c.scrollbars="yes");const u=Object.entries(c).reduce((h,[f,p])=>`${h}${f}=${p},`,"");if(iY(d)&&l!=="_self")return DX(e||"",l),new kk(null);const A=window.open(e||"",l,u);Lr(A,t,"popup-blocked");try{A.focus()}catch{}return new kk(A)}function DX(t,e){const r=document.createElement("a");r.href=t,r.target=e;const s=document.createEvent("MouseEvent");s.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RX="__/auth/handler",LX="emulator/auth/handler",OX=encodeURIComponent("fac");async function Bk(t,e,r,s,n,i){Lr(t.config.authDomain,t,"auth-domain-config-required"),Lr(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:s,v:Tp,eventId:n};if(e instanceof TL){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",_W(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[u,A]of Object.entries({}))o[u]=A}if(e instanceof Uy){const u=e.getScopes().filter(A=>A!=="");u.length>0&&(o.scopes=u.join(","))}t.tenantId&&(o.tid=t.tenantId);const l=o;for(const u of Object.keys(l))l[u]===void 0&&delete l[u];const c=await t._getAppCheckToken(),d=c?`#${OX}=${encodeURIComponent(c)}`:"";return`${UX(t)}?${Ry(l).slice(1)}${d}`}function UX({config:t}){return t.emulator?GE(t,LX):`https://${t.authDomain}/${RX}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M5="webStorageSupport";class MX{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=LL,this._completeRedirectFn=dX,this._overrideRedirectResult=oX}async _openPopup(e,r,s,n){var i;ru((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const o=await Bk(e,r,s,sj(),n);return PX(e,o,e3())}async _openRedirect(e,r,s,n){await this._originValidation(e);const i=await Bk(e,r,s,sj(),n);return HY(i),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:n,promise:i}=this.eventManagers[r];return n?Promise.resolve(n):(ru(i,"If manager is not set, promise should be"),i)}const s=this.initAndGetManager(e);return this.eventManagers[r]={promise:s},s.catch(()=>{delete this.eventManagers[r]}),s}async initAndGetManager(e){const r=await _X(e),s=new AX(e);return r.register("authEvent",n=>(Lr(n==null?void 0:n.authEvent,e,"invalid-auth-event"),{status:s.onEvent(n.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:s},this.iframes[e._key()]=r,s}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(M5,{type:M5},n=>{var i;const o=(i=n==null?void 0:n[0])===null||i===void 0?void 0:i[M5];o!==void 0&&r(!!o),mc(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=gX(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return jL()||yL()||XE()}}const QX=MX;var Fk="@firebase/auth",Pk="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VX{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(s=>{e((s==null?void 0:s.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){Lr(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HX(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function $X(t){Sf(new $A("auth",(e,{options:r})=>{const s=e.getProvider("app").getImmediate(),n=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=s.options;Lr(o&&!o.includes(":"),"invalid-api-key",{appName:s.name});const c={apiKey:o,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:SL(t)},d=new AY(s,n,i,c);return bY(d,r),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,s)=>{e.getProvider("auth-internal").initialize()})),Sf(new $A("auth-internal",e=>{const r=Yf(e.getProvider("auth").getImmediate());return(s=>new VX(s))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),Wc(Fk,Pk,HX(t)),Wc(Fk,Pk,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KX=5*60,zX=tL("authIdTokenMaxAge")||KX;let Dk=null;const qX=t=>async e=>{const r=e&&await e.getIdTokenResult(),s=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(s&&s>zX)return;const n=r==null?void 0:r.token;Dk!==n&&(Dk=n,await fetch(t,{method:n?"POST":"DELETE",headers:n?{Authorization:`Bearer ${n}`}:{}}))};function WX(t=zE()){const e=H2(t,"auth");if(e.isInitialized())return e.getImmediate();const r=vY(t,{popupRedirectResolver:QX,persistence:[JY,MY,LL]}),s=tL("authTokenSyncURL");if(s&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(s,location.origin);if(location.origin===i.origin){const o=qX(i.toString());LY(r,o,()=>o(r.currentUser)),RY(r,l=>o(l))}}const n=J8("auth");return n&&wY(r,`http://${n}`),r}function GX(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}hY({loadJS(t){return new Promise((e,r)=>{const s=document.createElement("script");s.setAttribute("src",t),s.onload=e,s.onerror=n=>{const i=Gc("internal-error");i.customData=n,r(i)},s.type="text/javascript",s.charset="UTF-8",GX().appendChild(s)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});$X("Browser");var Rk=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var uf,$L;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(C,w){function S(){}S.prototype=w.prototype,C.D=w.prototype,C.prototype=new S,C.prototype.constructor=C,C.C=function(F,B,k){for(var D=Array(arguments.length-2),q=2;q<arguments.length;q++)D[q-2]=arguments[q];return w.prototype[B].apply(F,D)}}function r(){this.blockSize=-1}function s(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(s,r),s.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function n(C,w,S){S||(S=0);var F=Array(16);if(typeof w=="string")for(var B=0;16>B;++B)F[B]=w.charCodeAt(S++)|w.charCodeAt(S++)<<8|w.charCodeAt(S++)<<16|w.charCodeAt(S++)<<24;else for(B=0;16>B;++B)F[B]=w[S++]|w[S++]<<8|w[S++]<<16|w[S++]<<24;w=C.g[0],S=C.g[1],B=C.g[2];var k=C.g[3],D=w+(k^S&(B^k))+F[0]+3614090360&4294967295;w=S+(D<<7&4294967295|D>>>25),D=k+(B^w&(S^B))+F[1]+3905402710&4294967295,k=w+(D<<12&4294967295|D>>>20),D=B+(S^k&(w^S))+F[2]+606105819&4294967295,B=k+(D<<17&4294967295|D>>>15),D=S+(w^B&(k^w))+F[3]+3250441966&4294967295,S=B+(D<<22&4294967295|D>>>10),D=w+(k^S&(B^k))+F[4]+4118548399&4294967295,w=S+(D<<7&4294967295|D>>>25),D=k+(B^w&(S^B))+F[5]+1200080426&4294967295,k=w+(D<<12&4294967295|D>>>20),D=B+(S^k&(w^S))+F[6]+2821735955&4294967295,B=k+(D<<17&4294967295|D>>>15),D=S+(w^B&(k^w))+F[7]+4249261313&4294967295,S=B+(D<<22&4294967295|D>>>10),D=w+(k^S&(B^k))+F[8]+1770035416&4294967295,w=S+(D<<7&4294967295|D>>>25),D=k+(B^w&(S^B))+F[9]+2336552879&4294967295,k=w+(D<<12&4294967295|D>>>20),D=B+(S^k&(w^S))+F[10]+4294925233&4294967295,B=k+(D<<17&4294967295|D>>>15),D=S+(w^B&(k^w))+F[11]+2304563134&4294967295,S=B+(D<<22&4294967295|D>>>10),D=w+(k^S&(B^k))+F[12]+1804603682&4294967295,w=S+(D<<7&4294967295|D>>>25),D=k+(B^w&(S^B))+F[13]+4254626195&4294967295,k=w+(D<<12&4294967295|D>>>20),D=B+(S^k&(w^S))+F[14]+2792965006&4294967295,B=k+(D<<17&4294967295|D>>>15),D=S+(w^B&(k^w))+F[15]+1236535329&4294967295,S=B+(D<<22&4294967295|D>>>10),D=w+(B^k&(S^B))+F[1]+4129170786&4294967295,w=S+(D<<5&4294967295|D>>>27),D=k+(S^B&(w^S))+F[6]+3225465664&4294967295,k=w+(D<<9&4294967295|D>>>23),D=B+(w^S&(k^w))+F[11]+643717713&4294967295,B=k+(D<<14&4294967295|D>>>18),D=S+(k^w&(B^k))+F[0]+3921069994&4294967295,S=B+(D<<20&4294967295|D>>>12),D=w+(B^k&(S^B))+F[5]+3593408605&4294967295,w=S+(D<<5&4294967295|D>>>27),D=k+(S^B&(w^S))+F[10]+38016083&4294967295,k=w+(D<<9&4294967295|D>>>23),D=B+(w^S&(k^w))+F[15]+3634488961&4294967295,B=k+(D<<14&4294967295|D>>>18),D=S+(k^w&(B^k))+F[4]+3889429448&4294967295,S=B+(D<<20&4294967295|D>>>12),D=w+(B^k&(S^B))+F[9]+568446438&4294967295,w=S+(D<<5&4294967295|D>>>27),D=k+(S^B&(w^S))+F[14]+3275163606&4294967295,k=w+(D<<9&4294967295|D>>>23),D=B+(w^S&(k^w))+F[3]+4107603335&4294967295,B=k+(D<<14&4294967295|D>>>18),D=S+(k^w&(B^k))+F[8]+1163531501&4294967295,S=B+(D<<20&4294967295|D>>>12),D=w+(B^k&(S^B))+F[13]+2850285829&4294967295,w=S+(D<<5&4294967295|D>>>27),D=k+(S^B&(w^S))+F[2]+4243563512&4294967295,k=w+(D<<9&4294967295|D>>>23),D=B+(w^S&(k^w))+F[7]+1735328473&4294967295,B=k+(D<<14&4294967295|D>>>18),D=S+(k^w&(B^k))+F[12]+2368359562&4294967295,S=B+(D<<20&4294967295|D>>>12),D=w+(S^B^k)+F[5]+4294588738&4294967295,w=S+(D<<4&4294967295|D>>>28),D=k+(w^S^B)+F[8]+2272392833&4294967295,k=w+(D<<11&4294967295|D>>>21),D=B+(k^w^S)+F[11]+1839030562&4294967295,B=k+(D<<16&4294967295|D>>>16),D=S+(B^k^w)+F[14]+4259657740&4294967295,S=B+(D<<23&4294967295|D>>>9),D=w+(S^B^k)+F[1]+2763975236&4294967295,w=S+(D<<4&4294967295|D>>>28),D=k+(w^S^B)+F[4]+1272893353&4294967295,k=w+(D<<11&4294967295|D>>>21),D=B+(k^w^S)+F[7]+4139469664&4294967295,B=k+(D<<16&4294967295|D>>>16),D=S+(B^k^w)+F[10]+3200236656&4294967295,S=B+(D<<23&4294967295|D>>>9),D=w+(S^B^k)+F[13]+681279174&4294967295,w=S+(D<<4&4294967295|D>>>28),D=k+(w^S^B)+F[0]+3936430074&4294967295,k=w+(D<<11&4294967295|D>>>21),D=B+(k^w^S)+F[3]+3572445317&4294967295,B=k+(D<<16&4294967295|D>>>16),D=S+(B^k^w)+F[6]+76029189&4294967295,S=B+(D<<23&4294967295|D>>>9),D=w+(S^B^k)+F[9]+3654602809&4294967295,w=S+(D<<4&4294967295|D>>>28),D=k+(w^S^B)+F[12]+3873151461&4294967295,k=w+(D<<11&4294967295|D>>>21),D=B+(k^w^S)+F[15]+530742520&4294967295,B=k+(D<<16&4294967295|D>>>16),D=S+(B^k^w)+F[2]+3299628645&4294967295,S=B+(D<<23&4294967295|D>>>9),D=w+(B^(S|~k))+F[0]+4096336452&4294967295,w=S+(D<<6&4294967295|D>>>26),D=k+(S^(w|~B))+F[7]+1126891415&4294967295,k=w+(D<<10&4294967295|D>>>22),D=B+(w^(k|~S))+F[14]+2878612391&4294967295,B=k+(D<<15&4294967295|D>>>17),D=S+(k^(B|~w))+F[5]+4237533241&4294967295,S=B+(D<<21&4294967295|D>>>11),D=w+(B^(S|~k))+F[12]+1700485571&4294967295,w=S+(D<<6&4294967295|D>>>26),D=k+(S^(w|~B))+F[3]+2399980690&4294967295,k=w+(D<<10&4294967295|D>>>22),D=B+(w^(k|~S))+F[10]+4293915773&4294967295,B=k+(D<<15&4294967295|D>>>17),D=S+(k^(B|~w))+F[1]+2240044497&4294967295,S=B+(D<<21&4294967295|D>>>11),D=w+(B^(S|~k))+F[8]+1873313359&4294967295,w=S+(D<<6&4294967295|D>>>26),D=k+(S^(w|~B))+F[15]+4264355552&4294967295,k=w+(D<<10&4294967295|D>>>22),D=B+(w^(k|~S))+F[6]+2734768916&4294967295,B=k+(D<<15&4294967295|D>>>17),D=S+(k^(B|~w))+F[13]+1309151649&4294967295,S=B+(D<<21&4294967295|D>>>11),D=w+(B^(S|~k))+F[4]+4149444226&4294967295,w=S+(D<<6&4294967295|D>>>26),D=k+(S^(w|~B))+F[11]+3174756917&4294967295,k=w+(D<<10&4294967295|D>>>22),D=B+(w^(k|~S))+F[2]+718787259&4294967295,B=k+(D<<15&4294967295|D>>>17),D=S+(k^(B|~w))+F[9]+3951481745&4294967295,C.g[0]=C.g[0]+w&4294967295,C.g[1]=C.g[1]+(B+(D<<21&4294967295|D>>>11))&4294967295,C.g[2]=C.g[2]+B&4294967295,C.g[3]=C.g[3]+k&4294967295}s.prototype.u=function(C,w){w===void 0&&(w=C.length);for(var S=w-this.blockSize,F=this.B,B=this.h,k=0;k<w;){if(B==0)for(;k<=S;)n(this,C,k),k+=this.blockSize;if(typeof C=="string"){for(;k<w;)if(F[B++]=C.charCodeAt(k++),B==this.blockSize){n(this,F),B=0;break}}else for(;k<w;)if(F[B++]=C[k++],B==this.blockSize){n(this,F),B=0;break}}this.h=B,this.o+=w},s.prototype.v=function(){var C=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);C[0]=128;for(var w=1;w<C.length-8;++w)C[w]=0;var S=8*this.o;for(w=C.length-8;w<C.length;++w)C[w]=S&255,S/=256;for(this.u(C),C=Array(16),w=S=0;4>w;++w)for(var F=0;32>F;F+=8)C[S++]=this.g[w]>>>F&255;return C};function i(C,w){var S=l;return Object.prototype.hasOwnProperty.call(S,C)?S[C]:S[C]=w(C)}function o(C,w){this.h=w;for(var S=[],F=!0,B=C.length-1;0<=B;B--){var k=C[B]|0;F&&k==w||(S[B]=k,F=!1)}this.g=S}var l={};function c(C){return-128<=C&&128>C?i(C,function(w){return new o([w|0],0>w?-1:0)}):new o([C|0],0>C?-1:0)}function d(C){if(isNaN(C)||!isFinite(C))return A;if(0>C)return g(d(-C));for(var w=[],S=1,F=0;C>=S;F++)w[F]=C/S|0,S*=4294967296;return new o(w,0)}function u(C,w){if(C.length==0)throw Error("number format error: empty string");if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(C.charAt(0)=="-")return g(u(C.substring(1),w));if(0<=C.indexOf("-"))throw Error('number format error: interior "-" character');for(var S=d(Math.pow(w,8)),F=A,B=0;B<C.length;B+=8){var k=Math.min(8,C.length-B),D=parseInt(C.substring(B,B+k),w);8>k?(k=d(Math.pow(w,k)),F=F.j(k).add(d(D))):(F=F.j(S),F=F.add(d(D)))}return F}var A=c(0),h=c(1),f=c(16777216);t=o.prototype,t.m=function(){if(m(this))return-g(this).m();for(var C=0,w=1,S=0;S<this.g.length;S++){var F=this.i(S);C+=(0<=F?F:4294967296+F)*w,w*=4294967296}return C},t.toString=function(C){if(C=C||10,2>C||36<C)throw Error("radix out of range: "+C);if(p(this))return"0";if(m(this))return"-"+g(this).toString(C);for(var w=d(Math.pow(C,6)),S=this,F="";;){var B=E(S,w).g;S=y(S,B.j(w));var k=((0<S.g.length?S.g[0]:S.h)>>>0).toString(C);if(S=B,p(S))return k+F;for(;6>k.length;)k="0"+k;F=k+F}},t.i=function(C){return 0>C?0:C<this.g.length?this.g[C]:this.h};function p(C){if(C.h!=0)return!1;for(var w=0;w<C.g.length;w++)if(C.g[w]!=0)return!1;return!0}function m(C){return C.h==-1}t.l=function(C){return C=y(this,C),m(C)?-1:p(C)?0:1};function g(C){for(var w=C.g.length,S=[],F=0;F<w;F++)S[F]=~C.g[F];return new o(S,~C.h).add(h)}t.abs=function(){return m(this)?g(this):this},t.add=function(C){for(var w=Math.max(this.g.length,C.g.length),S=[],F=0,B=0;B<=w;B++){var k=F+(this.i(B)&65535)+(C.i(B)&65535),D=(k>>>16)+(this.i(B)>>>16)+(C.i(B)>>>16);F=D>>>16,k&=65535,D&=65535,S[B]=D<<16|k}return new o(S,S[S.length-1]&-2147483648?-1:0)};function y(C,w){return C.add(g(w))}t.j=function(C){if(p(this)||p(C))return A;if(m(this))return m(C)?g(this).j(g(C)):g(g(this).j(C));if(m(C))return g(this.j(g(C)));if(0>this.l(f)&&0>C.l(f))return d(this.m()*C.m());for(var w=this.g.length+C.g.length,S=[],F=0;F<2*w;F++)S[F]=0;for(F=0;F<this.g.length;F++)for(var B=0;B<C.g.length;B++){var k=this.i(F)>>>16,D=this.i(F)&65535,q=C.i(B)>>>16,te=C.i(B)&65535;S[2*F+2*B]+=D*te,v(S,2*F+2*B),S[2*F+2*B+1]+=k*te,v(S,2*F+2*B+1),S[2*F+2*B+1]+=D*q,v(S,2*F+2*B+1),S[2*F+2*B+2]+=k*q,v(S,2*F+2*B+2)}for(F=0;F<w;F++)S[F]=S[2*F+1]<<16|S[2*F];for(F=w;F<2*w;F++)S[F]=0;return new o(S,0)};function v(C,w){for(;(C[w]&65535)!=C[w];)C[w+1]+=C[w]>>>16,C[w]&=65535,w++}function x(C,w){this.g=C,this.h=w}function E(C,w){if(p(w))throw Error("division by zero");if(p(C))return new x(A,A);if(m(C))return w=E(g(C),w),new x(g(w.g),g(w.h));if(m(w))return w=E(C,g(w)),new x(g(w.g),w.h);if(30<C.g.length){if(m(C)||m(w))throw Error("slowDivide_ only works with positive integers.");for(var S=h,F=w;0>=F.l(C);)S=T(S),F=T(F);var B=j(S,1),k=j(F,1);for(F=j(F,2),S=j(S,2);!p(F);){var D=k.add(F);0>=D.l(C)&&(B=B.add(S),k=D),F=j(F,1),S=j(S,1)}return w=y(C,B.j(w)),new x(B,w)}for(B=A;0<=C.l(w);){for(S=Math.max(1,Math.floor(C.m()/w.m())),F=Math.ceil(Math.log(S)/Math.LN2),F=48>=F?1:Math.pow(2,F-48),k=d(S),D=k.j(w);m(D)||0<D.l(C);)S-=F,k=d(S),D=k.j(w);p(k)&&(k=h),B=B.add(k),C=y(C,D)}return new x(B,C)}t.A=function(C){return E(this,C).h},t.and=function(C){for(var w=Math.max(this.g.length,C.g.length),S=[],F=0;F<w;F++)S[F]=this.i(F)&C.i(F);return new o(S,this.h&C.h)},t.or=function(C){for(var w=Math.max(this.g.length,C.g.length),S=[],F=0;F<w;F++)S[F]=this.i(F)|C.i(F);return new o(S,this.h|C.h)},t.xor=function(C){for(var w=Math.max(this.g.length,C.g.length),S=[],F=0;F<w;F++)S[F]=this.i(F)^C.i(F);return new o(S,this.h^C.h)};function T(C){for(var w=C.g.length+1,S=[],F=0;F<w;F++)S[F]=C.i(F)<<1|C.i(F-1)>>>31;return new o(S,C.h)}function j(C,w){var S=w>>5;w%=32;for(var F=C.g.length-S,B=[],k=0;k<F;k++)B[k]=0<w?C.i(k+S)>>>w|C.i(k+S+1)<<32-w:C.i(k+S);return new o(B,C.h)}s.prototype.digest=s.prototype.v,s.prototype.reset=s.prototype.s,s.prototype.update=s.prototype.u,$L=s,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=u,uf=o}).apply(typeof Rk<"u"?Rk:typeof self<"u"?self:typeof window<"u"?window:{});var s1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var KL,Fg,zL,Nb,lj,qL,WL,GL;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(N,M,ne){return N==Array.prototype||N==Object.prototype||(N[M]=ne.value),N};function r(N){N=[typeof globalThis=="object"&&globalThis,N,typeof window=="object"&&window,typeof self=="object"&&self,typeof s1=="object"&&s1];for(var M=0;M<N.length;++M){var ne=N[M];if(ne&&ne.Math==Math)return ne}throw Error("Cannot find global object")}var s=r(this);function n(N,M){if(M)e:{var ne=s;N=N.split(".");for(var Se=0;Se<N.length-1;Se++){var ct=N[Se];if(!(ct in ne))break e;ne=ne[ct]}N=N[N.length-1],Se=ne[N],M=M(Se),M!=Se&&M!=null&&e(ne,N,{configurable:!0,writable:!0,value:M})}}function i(N,M){N instanceof String&&(N+="");var ne=0,Se=!1,ct={next:function(){if(!Se&&ne<N.length){var vt=ne++;return{value:M(vt,N[vt]),done:!1}}return Se=!0,{done:!0,value:void 0}}};return ct[Symbol.iterator]=function(){return ct},ct}n("Array.prototype.values",function(N){return N||function(){return i(this,function(M,ne){return ne})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},l=this||self;function c(N){var M=typeof N;return M=M!="object"?M:N?Array.isArray(N)?"array":M:"null",M=="array"||M=="object"&&typeof N.length=="number"}function d(N){var M=typeof N;return M=="object"&&N!=null||M=="function"}function u(N,M,ne){return N.call.apply(N.bind,arguments)}function A(N,M,ne){if(!N)throw Error();if(2<arguments.length){var Se=Array.prototype.slice.call(arguments,2);return function(){var ct=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(ct,Se),N.apply(M,ct)}}return function(){return N.apply(M,arguments)}}function h(N,M,ne){return h=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?u:A,h.apply(null,arguments)}function f(N,M){var ne=Array.prototype.slice.call(arguments,1);return function(){var Se=ne.slice();return Se.push.apply(Se,arguments),N.apply(this,Se)}}function p(N,M){function ne(){}ne.prototype=M.prototype,N.aa=M.prototype,N.prototype=new ne,N.prototype.constructor=N,N.Qb=function(Se,ct,vt){for(var zt=Array(arguments.length-2),Qr=2;Qr<arguments.length;Qr++)zt[Qr-2]=arguments[Qr];return M.prototype[ct].apply(Se,zt)}}function m(N){const M=N.length;if(0<M){const ne=Array(M);for(let Se=0;Se<M;Se++)ne[Se]=N[Se];return ne}return[]}function g(N,M){for(let ne=1;ne<arguments.length;ne++){const Se=arguments[ne];if(c(Se)){const ct=N.length||0,vt=Se.length||0;N.length=ct+vt;for(let zt=0;zt<vt;zt++)N[ct+zt]=Se[zt]}else N.push(Se)}}class y{constructor(M,ne){this.i=M,this.j=ne,this.h=0,this.g=null}get(){let M;return 0<this.h?(this.h--,M=this.g,this.g=M.next,M.next=null):M=this.i(),M}}function v(N){return/^[\s\xa0]*$/.test(N)}function x(){var N=l.navigator;return N&&(N=N.userAgent)?N:""}function E(N){return E[" "](N),N}E[" "]=function(){};var T=x().indexOf("Gecko")!=-1&&!(x().toLowerCase().indexOf("webkit")!=-1&&x().indexOf("Edge")==-1)&&!(x().indexOf("Trident")!=-1||x().indexOf("MSIE")!=-1)&&x().indexOf("Edge")==-1;function j(N,M,ne){for(const Se in N)M.call(ne,N[Se],Se,N)}function C(N,M){for(const ne in N)M.call(void 0,N[ne],ne,N)}function w(N){const M={};for(const ne in N)M[ne]=N[ne];return M}const S="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function F(N,M){let ne,Se;for(let ct=1;ct<arguments.length;ct++){Se=arguments[ct];for(ne in Se)N[ne]=Se[ne];for(let vt=0;vt<S.length;vt++)ne=S[vt],Object.prototype.hasOwnProperty.call(Se,ne)&&(N[ne]=Se[ne])}}function B(N){var M=1;N=N.split(":");const ne=[];for(;0<M&&N.length;)ne.push(N.shift()),M--;return N.length&&ne.push(N.join(":")),ne}function k(N){l.setTimeout(()=>{throw N},0)}function D(){var N=G;let M=null;return N.g&&(M=N.g,N.g=N.g.next,N.g||(N.h=null),M.next=null),M}class q{constructor(){this.h=this.g=null}add(M,ne){const Se=te.get();Se.set(M,ne),this.h?this.h.next=Se:this.g=Se,this.h=Se}}var te=new y(()=>new W,N=>N.reset());class W{constructor(){this.next=this.g=this.h=null}set(M,ne){this.h=M,this.g=ne,this.next=null}reset(){this.next=this.g=this.h=null}}let Q,re=!1,G=new q,Ae=()=>{const N=l.Promise.resolve(void 0);Q=()=>{N.then(he)}};var he=()=>{for(var N;N=D();){try{N.h.call(N.g)}catch(ne){k(ne)}var M=te;M.j(N),100>M.h&&(M.h++,N.next=M.g,M.g=N)}re=!1};function I(){this.s=this.s,this.C=this.C}I.prototype.s=!1,I.prototype.ma=function(){this.s||(this.s=!0,this.N())},I.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function U(N,M){this.type=N,this.g=this.target=M,this.defaultPrevented=!1}U.prototype.h=function(){this.defaultPrevented=!0};var V=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var N=!1,M=Object.defineProperty({},"passive",{get:function(){N=!0}});try{const ne=()=>{};l.addEventListener("test",ne,M),l.removeEventListener("test",ne,M)}catch{}return N}();function L(N,M){if(U.call(this,N?N.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,N){var ne=this.type=N.type,Se=N.changedTouches&&N.changedTouches.length?N.changedTouches[0]:null;if(this.target=N.target||N.srcElement,this.g=M,M=N.relatedTarget){if(T){e:{try{E(M.nodeName);var ct=!0;break e}catch{}ct=!1}ct||(M=null)}}else ne=="mouseover"?M=N.fromElement:ne=="mouseout"&&(M=N.toElement);this.relatedTarget=M,Se?(this.clientX=Se.clientX!==void 0?Se.clientX:Se.pageX,this.clientY=Se.clientY!==void 0?Se.clientY:Se.pageY,this.screenX=Se.screenX||0,this.screenY=Se.screenY||0):(this.clientX=N.clientX!==void 0?N.clientX:N.pageX,this.clientY=N.clientY!==void 0?N.clientY:N.pageY,this.screenX=N.screenX||0,this.screenY=N.screenY||0),this.button=N.button,this.key=N.key||"",this.ctrlKey=N.ctrlKey,this.altKey=N.altKey,this.shiftKey=N.shiftKey,this.metaKey=N.metaKey,this.pointerId=N.pointerId||0,this.pointerType=typeof N.pointerType=="string"?N.pointerType:K[N.pointerType]||"",this.state=N.state,this.i=N,N.defaultPrevented&&L.aa.h.call(this)}}p(L,U);var K={2:"touch",3:"pen",4:"mouse"};L.prototype.h=function(){L.aa.h.call(this);var N=this.i;N.preventDefault?N.preventDefault():N.returnValue=!1};var fe="closure_listenable_"+(1e6*Math.random()|0),ee=0;function de(N,M,ne,Se,ct){this.listener=N,this.proxy=null,this.src=M,this.type=ne,this.capture=!!Se,this.ha=ct,this.key=++ee,this.da=this.fa=!1}function ue(N){N.da=!0,N.listener=null,N.proxy=null,N.src=null,N.ha=null}function Ie(N){this.src=N,this.g={},this.h=0}Ie.prototype.add=function(N,M,ne,Se,ct){var vt=N.toString();N=this.g[vt],N||(N=this.g[vt]=[],this.h++);var zt=H(N,M,Se,ct);return-1<zt?(M=N[zt],ne||(M.fa=!1)):(M=new de(M,this.src,vt,!!Se,ct),M.fa=ne,N.push(M)),M};function Y(N,M){var ne=M.type;if(ne in N.g){var Se=N.g[ne],ct=Array.prototype.indexOf.call(Se,M,void 0),vt;(vt=0<=ct)&&Array.prototype.splice.call(Se,ct,1),vt&&(ue(M),N.g[ne].length==0&&(delete N.g[ne],N.h--))}}function H(N,M,ne,Se){for(var ct=0;ct<N.length;++ct){var vt=N[ct];if(!vt.da&&vt.listener==M&&vt.capture==!!ne&&vt.ha==Se)return ct}return-1}var je="closure_lm_"+(1e6*Math.random()|0),Ce={};function oe(N,M,ne,Se,ct){if(Array.isArray(M)){for(var vt=0;vt<M.length;vt++)oe(N,M[vt],ne,Se,ct);return null}return ne=me(ne),N&&N[fe]?N.K(M,ne,d(Se)?!!Se.capture:!1,ct):He(N,M,ne,!1,Se,ct)}function He(N,M,ne,Se,ct,vt){if(!M)throw Error("Invalid event type");var zt=d(ct)?!!ct.capture:!!ct,Qr=De(N);if(Qr||(N[je]=Qr=new Ie(N)),ne=Qr.add(M,ne,Se,zt,vt),ne.proxy)return ne;if(Se=ie(),ne.proxy=Se,Se.src=N,Se.listener=ne,N.addEventListener)V||(ct=zt),ct===void 0&&(ct=!1),N.addEventListener(M.toString(),Se,ct);else if(N.attachEvent)N.attachEvent(ve(M.toString()),Se);else if(N.addListener&&N.removeListener)N.addListener(Se);else throw Error("addEventListener and attachEvent are unavailable.");return ne}function ie(){function N(ne){return M.call(N.src,N.listener,ne)}const M=we;return N}function le(N,M,ne,Se,ct){if(Array.isArray(M))for(var vt=0;vt<M.length;vt++)le(N,M[vt],ne,Se,ct);else Se=d(Se)?!!Se.capture:!!Se,ne=me(ne),N&&N[fe]?(N=N.i,M=String(M).toString(),M in N.g&&(vt=N.g[M],ne=H(vt,ne,Se,ct),-1<ne&&(ue(vt[ne]),Array.prototype.splice.call(vt,ne,1),vt.length==0&&(delete N.g[M],N.h--)))):N&&(N=De(N))&&(M=N.g[M.toString()],N=-1,M&&(N=H(M,ne,Se,ct)),(ne=-1<N?M[N]:null)&&ae(ne))}function ae(N){if(typeof N!="number"&&N&&!N.da){var M=N.src;if(M&&M[fe])Y(M.i,N);else{var ne=N.type,Se=N.proxy;M.removeEventListener?M.removeEventListener(ne,Se,N.capture):M.detachEvent?M.detachEvent(ve(ne),Se):M.addListener&&M.removeListener&&M.removeListener(Se),(ne=De(M))?(Y(ne,N),ne.h==0&&(ne.src=null,M[je]=null)):ue(N)}}}function ve(N){return N in Ce?Ce[N]:Ce[N]="on"+N}function we(N,M){if(N.da)N=!0;else{M=new L(M,this);var ne=N.listener,Se=N.ha||N.src;N.fa&&ae(N),N=ne.call(Se,M)}return N}function De(N){return N=N[je],N instanceof Ie?N:null}var Ve="__closure_events_fn_"+(1e9*Math.random()>>>0);function me(N){return typeof N=="function"?N:(N[Ve]||(N[Ve]=function(M){return N.handleEvent(M)}),N[Ve])}function Fe(){I.call(this),this.i=new Ie(this),this.M=this,this.F=null}p(Fe,I),Fe.prototype[fe]=!0,Fe.prototype.removeEventListener=function(N,M,ne,Se){le(this,N,M,ne,Se)};function Re(N,M){var ne,Se=N.F;if(Se)for(ne=[];Se;Se=Se.F)ne.push(Se);if(N=N.M,Se=M.type||M,typeof M=="string")M=new U(M,N);else if(M instanceof U)M.target=M.target||N;else{var ct=M;M=new U(Se,N),F(M,ct)}if(ct=!0,ne)for(var vt=ne.length-1;0<=vt;vt--){var zt=M.g=ne[vt];ct=Be(zt,Se,!0,M)&&ct}if(zt=M.g=N,ct=Be(zt,Se,!0,M)&&ct,ct=Be(zt,Se,!1,M)&&ct,ne)for(vt=0;vt<ne.length;vt++)zt=M.g=ne[vt],ct=Be(zt,Se,!1,M)&&ct}Fe.prototype.N=function(){if(Fe.aa.N.call(this),this.i){var N=this.i,M;for(M in N.g){for(var ne=N.g[M],Se=0;Se<ne.length;Se++)ue(ne[Se]);delete N.g[M],N.h--}}this.F=null},Fe.prototype.K=function(N,M,ne,Se){return this.i.add(String(N),M,!1,ne,Se)},Fe.prototype.L=function(N,M,ne,Se){return this.i.add(String(N),M,!0,ne,Se)};function Be(N,M,ne,Se){if(M=N.i.g[String(M)],!M)return!0;M=M.concat();for(var ct=!0,vt=0;vt<M.length;++vt){var zt=M[vt];if(zt&&!zt.da&&zt.capture==ne){var Qr=zt.listener,as=zt.ha||zt.src;zt.fa&&Y(N.i,zt),ct=Qr.call(as,Se)!==!1&&ct}}return ct&&!Se.defaultPrevented}function X(N,M,ne){if(typeof N=="function")ne&&(N=h(N,ne));else if(N&&typeof N.handleEvent=="function")N=h(N.handleEvent,N);else throw Error("Invalid listener argument");return 2147483647<Number(M)?-1:l.setTimeout(N,M||0)}function _e(N){N.g=X(()=>{N.g=null,N.i&&(N.i=!1,_e(N))},N.l);const M=N.h;N.h=null,N.m.apply(null,M)}class ke extends I{constructor(M,ne){super(),this.m=M,this.l=ne,this.h=null,this.i=!1,this.g=null}j(M){this.h=arguments,this.g?this.i=!0:_e(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function lt(N){I.call(this),this.h=N,this.g={}}p(lt,I);var mt=[];function pt(N){j(N.g,function(M,ne){this.g.hasOwnProperty(ne)&&ae(M)},N),N.g={}}lt.prototype.N=function(){lt.aa.N.call(this),pt(this)},lt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ze=l.JSON.stringify,Me=l.JSON.parse,rt=class{stringify(N){return l.JSON.stringify(N,void 0)}parse(N){return l.JSON.parse(N,void 0)}};function ht(){}ht.prototype.h=null;function Qe(N){return N.h||(N.h=N.i())}function Ge(){}var gt={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function St(){U.call(this,"d")}p(St,U);function Vt(){U.call(this,"c")}p(Vt,U);var Kt={},qe=null;function Xe(){return qe=qe||new Fe}Kt.La="serverreachability";function Ke(N){U.call(this,Kt.La,N)}p(Ke,U);function We(N){const M=Xe();Re(M,new Ke(M))}Kt.STAT_EVENT="statevent";function Ft(N,M){U.call(this,Kt.STAT_EVENT,N),this.stat=M}p(Ft,U);function Ct(N){const M=Xe();Re(M,new Ft(M,N))}Kt.Ma="timingevent";function xr(N,M){U.call(this,Kt.Ma,N),this.size=M}p(xr,U);function vr(N,M){if(typeof N!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){N()},M)}function Pr(){this.g=!0}Pr.prototype.xa=function(){this.g=!1};function Mr(N,M,ne,Se,ct,vt){N.info(function(){if(N.g)if(vt)for(var zt="",Qr=vt.split("&"),as=0;as<Qr.length;as++){var Vr=Qr[as].split("=");if(1<Vr.length){var Es=Vr[0];Vr=Vr[1];var qs=Es.split("_");zt=2<=qs.length&&qs[1]=="type"?zt+(Es+"="+Vr+"&"):zt+(Es+"=redacted&")}}else zt=null;else zt=vt;return"XMLHTTP REQ ("+Se+") [attempt "+ct+"]: "+M+`
`+ne+`
`+zt})}function Jr(N,M,ne,Se,ct,vt,zt){N.info(function(){return"XMLHTTP RESP ("+Se+") [ attempt "+ct+"]: "+M+`
`+ne+`
`+vt+" "+zt})}function ye(N,M,ne,Se){N.info(function(){return"XMLHTTP TEXT ("+M+"): "+se(N,ne)+(Se?" "+Se:"")})}function Le(N,M){N.info(function(){return"TIMEOUT: "+M})}Pr.prototype.info=function(){};function se(N,M){if(!N.g)return M;if(!M)return null;try{var ne=JSON.parse(M);if(ne){for(N=0;N<ne.length;N++)if(Array.isArray(ne[N])){var Se=ne[N];if(!(2>Se.length)){var ct=Se[1];if(Array.isArray(ct)&&!(1>ct.length)){var vt=ct[0];if(vt!="noop"&&vt!="stop"&&vt!="close")for(var zt=1;zt<ct.length;zt++)ct[zt]=""}}}}return ze(ne)}catch{return M}}var z={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},ce={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},xe;function Pe(){}p(Pe,ht),Pe.prototype.g=function(){return new XMLHttpRequest},Pe.prototype.i=function(){return{}},xe=new Pe;function Ze(N,M,ne,Se){this.j=N,this.i=M,this.l=ne,this.R=Se||1,this.U=new lt(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Ye}function Ye(){this.i=null,this.g="",this.h=!1}var Je={},et={};function ft(N,M,ne){N.L=1,N.v=ud(us(M)),N.m=ne,N.P=!0,At(N,null)}function At(N,M){N.F=Date.now(),Ht(N),N.A=us(N.v);var ne=N.A,Se=N.R;Array.isArray(Se)||(Se=[String(Se)]),Dr(ne.i,"t",Se),N.C=0,ne=N.j.J,N.h=new Ye,N.g=pe(N.j,ne?M:null,!N.m),0<N.O&&(N.M=new ke(h(N.Y,N,N.g),N.O)),M=N.U,ne=N.g,Se=N.ca;var ct="readystatechange";Array.isArray(ct)||(ct&&(mt[0]=ct.toString()),ct=mt);for(var vt=0;vt<ct.length;vt++){var zt=oe(ne,ct[vt],Se||M.handleEvent,!1,M.h||M);if(!zt)break;M.g[zt.key]=zt}M=N.H?w(N.H):{},N.m?(N.u||(N.u="POST"),M["Content-Type"]="application/x-www-form-urlencoded",N.g.ea(N.A,N.u,N.m,M)):(N.u="GET",N.g.ea(N.A,N.u,null,M)),We(),Mr(N.i,N.u,N.A,N.l,N.R,N.m)}Ze.prototype.ca=function(N){N=N.target;const M=this.M;M&&xa(N)==3?M.j():this.Y(N)},Ze.prototype.Y=function(N){try{if(N==this.g)e:{const qs=xa(this.g);var M=this.g.Ba();const Kl=this.g.Z();if(!(3>qs)&&(qs!=3||this.g&&(this.h.h||this.g.oa()||um(this.g)))){this.J||qs!=4||M==7||(M==8||0>=Kl?We(3):We(2)),Ar(this);var ne=this.g.Z();this.X=ne;t:if(Nt(this)){var Se=um(this.g);N="";var ct=Se.length,vt=xa(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){ns(this),or(this);var zt="";break t}this.h.i=new l.TextDecoder}for(M=0;M<ct;M++)this.h.h=!0,N+=this.h.i.decode(Se[M],{stream:!(vt&&M==ct-1)});Se.length=0,this.h.g+=N,this.C=0,zt=this.h.g}else zt=this.g.oa();if(this.o=ne==200,Jr(this.i,this.u,this.A,this.l,this.R,qs,ne),this.o){if(this.T&&!this.K){t:{if(this.g){var Qr,as=this.g;if((Qr=as.g?as.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!v(Qr)){var Vr=Qr;break t}}Vr=null}if(ne=Vr)ye(this.i,this.l,ne,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Ia(this,ne);else{this.o=!1,this.s=3,Ct(12),ns(this),or(this);break e}}if(this.P){ne=!0;let qa;for(;!this.J&&this.C<zt.length;)if(qa=kt(this,zt),qa==et){qs==4&&(this.s=4,Ct(14),ne=!1),ye(this.i,this.l,null,"[Incomplete Response]");break}else if(qa==Je){this.s=4,Ct(15),ye(this.i,this.l,zt,"[Invalid Chunk]"),ne=!1;break}else ye(this.i,this.l,qa,null),Ia(this,qa);if(Nt(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),qs!=4||zt.length!=0||this.h.h||(this.s=1,Ct(16),ne=!1),this.o=this.o&&ne,!ne)ye(this.i,this.l,zt,"[Invalid Chunked Response]"),ns(this),or(this);else if(0<zt.length&&!this.W){this.W=!0;var Es=this.j;Es.g==this&&Es.ba&&!Es.M&&(Es.j.info("Great, no buffering proxy detected. Bytes received: "+zt.length),_u(Es),Es.M=!0,Ct(11))}}else ye(this.i,this.l,zt,null),Ia(this,zt);qs==4&&ns(this),this.o&&!this.J&&(qs==4?jc(this.j,this):(this.o=!1,Ht(this)))}else Nc(this.g),ne==400&&0<zt.indexOf("Unknown SID")?(this.s=3,Ct(12)):(this.s=0,Ct(13)),ns(this),or(this)}}}catch{}finally{}};function Nt(N){return N.g?N.u=="GET"&&N.L!=2&&N.j.Ca:!1}function kt(N,M){var ne=N.C,Se=M.indexOf(`
`,ne);return Se==-1?et:(ne=Number(M.substring(ne,Se)),isNaN(ne)?Je:(Se+=1,Se+ne>M.length?et:(M=M.slice(Se,Se+ne),N.C=Se+ne,M)))}Ze.prototype.cancel=function(){this.J=!0,ns(this)};function Ht(N){N.S=Date.now()+N.I,ir(N,N.I)}function ir(N,M){if(N.B!=null)throw Error("WatchDog timer not null");N.B=vr(h(N.ba,N),M)}function Ar(N){N.B&&(l.clearTimeout(N.B),N.B=null)}Ze.prototype.ba=function(){this.B=null;const N=Date.now();0<=N-this.S?(Le(this.i,this.A),this.L!=2&&(We(),Ct(17)),ns(this),this.s=2,or(this)):ir(this,this.S-N)};function or(N){N.j.G==0||N.J||jc(N.j,N)}function ns(N){Ar(N);var M=N.M;M&&typeof M.ma=="function"&&M.ma(),N.M=null,pt(N.U),N.g&&(M=N.g,N.g=null,M.abort(),M.ma())}function Ia(N,M){try{var ne=N.j;if(ne.G!=0&&(ne.g==N||Pt(ne.h,N))){if(!N.K&&Pt(ne.h,N)&&ne.G==3){try{var Se=ne.Da.g.parse(M)}catch{Se=null}if(Array.isArray(Se)&&Se.length==3){var ct=Se;if(ct[0]==0){e:if(!ne.u){if(ne.g)if(ne.g.F+3e3<N.F)$l(ne),Cu(ne);else break e;pd(ne),Ct(18)}}else ne.za=ct[1],0<ne.za-ne.T&&37500>ct[2]&&ne.F&&ne.v==0&&!ne.C&&(ne.C=vr(h(ne.Za,ne),6e3));if(1>=ot(ne.h)&&ne.ca){try{ne.ca()}catch{}ne.ca=void 0}}else di(ne,11)}else if((N.K||ne.g==N)&&$l(ne),!v(M))for(ct=ne.Da.g.parse(M),M=0;M<ct.length;M++){let Vr=ct[M];if(ne.T=Vr[0],Vr=Vr[1],ne.G==2)if(Vr[0]=="c"){ne.K=Vr[1],ne.ia=Vr[2];const Es=Vr[3];Es!=null&&(ne.la=Es,ne.j.info("VER="+ne.la));const qs=Vr[4];qs!=null&&(ne.Aa=qs,ne.j.info("SVER="+ne.Aa));const Kl=Vr[5];Kl!=null&&typeof Kl=="number"&&0<Kl&&(Se=1.5*Kl,ne.L=Se,ne.j.info("backChannelRequestTimeoutMs_="+Se)),Se=ne;const qa=N.g;if(qa){const Sc=qa.g?qa.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Sc){var vt=Se.h;vt.g||Sc.indexOf("spdy")==-1&&Sc.indexOf("quic")==-1&&Sc.indexOf("h2")==-1||(vt.j=vt.l,vt.g=new Set,vt.h&&(jt(vt,vt.h),vt.h=null))}if(Se.D){const Ec=qa.g?qa.g.getResponseHeader("X-HTTP-Session-Id"):null;Ec&&(Se.ya=Ec,ks(Se.I,Se.D,Ec))}}ne.G=3,ne.l&&ne.l.ua(),ne.ba&&(ne.R=Date.now()-N.F,ne.j.info("Handshake RTT: "+ne.R+"ms")),Se=ne;var zt=N;if(Se.qa=P(Se,Se.J?Se.ia:null,Se.W),zt.K){Lt(Se.h,zt);var Qr=zt,as=Se.L;as&&(Qr.I=as),Qr.B&&(Ar(Qr),Ht(Qr)),Se.g=zt}else Eu(Se);0<ne.i.length&&ju(ne)}else Vr[0]!="stop"&&Vr[0]!="close"||di(ne,7);else ne.G==3&&(Vr[0]=="stop"||Vr[0]=="close"?Vr[0]=="stop"?di(ne,7):Hl(ne):Vr[0]!="noop"&&ne.l&&ne.l.ta(Vr),ne.v=0)}}We(4)}catch{}}var so=class{constructor(N,M){this.g=N,this.map=M}};function li(N){this.l=N||10,l.PerformanceNavigationTiming?(N=l.performance.getEntriesByType("navigation"),N=0<N.length&&(N[0].nextHopProtocol=="hq"||N[0].nextHopProtocol=="h2")):N=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=N?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Ka(N){return N.h?!0:N.g?N.g.size>=N.j:!1}function ot(N){return N.h?1:N.g?N.g.size:0}function Pt(N,M){return N.h?N.h==M:N.g?N.g.has(M):!1}function jt(N,M){N.g?N.g.add(M):N.h=M}function Lt(N,M){N.h&&N.h==M?N.h=null:N.g&&N.g.has(M)&&N.g.delete(M)}li.prototype.cancel=function(){if(this.i=Er(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const N of this.g.values())N.cancel();this.g.clear()}};function Er(N){if(N.h!=null)return N.i.concat(N.h.D);if(N.g!=null&&N.g.size!==0){let M=N.i;for(const ne of N.g.values())M=M.concat(ne.D);return M}return m(N.i)}function _r(N){if(N.V&&typeof N.V=="function")return N.V();if(typeof Map<"u"&&N instanceof Map||typeof Set<"u"&&N instanceof Set)return Array.from(N.values());if(typeof N=="string")return N.split("");if(c(N)){for(var M=[],ne=N.length,Se=0;Se<ne;Se++)M.push(N[Se]);return M}M=[],ne=0;for(Se in N)M[ne++]=N[Se];return M}function jr(N){if(N.na&&typeof N.na=="function")return N.na();if(!N.V||typeof N.V!="function"){if(typeof Map<"u"&&N instanceof Map)return Array.from(N.keys());if(!(typeof Set<"u"&&N instanceof Set)){if(c(N)||typeof N=="string"){var M=[];N=N.length;for(var ne=0;ne<N;ne++)M.push(ne);return M}M=[],ne=0;for(const Se in N)M[ne++]=Se;return M}}}function ms(N,M){if(N.forEach&&typeof N.forEach=="function")N.forEach(M,void 0);else if(c(N)||typeof N=="string")Array.prototype.forEach.call(N,M,void 0);else for(var ne=jr(N),Se=_r(N),ct=Se.length,vt=0;vt<ct;vt++)M.call(void 0,Se[vt],ne&&ne[vt],N)}var Qs=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ci(N,M){if(N){N=N.split("&");for(var ne=0;ne<N.length;ne++){var Se=N[ne].indexOf("="),ct=null;if(0<=Se){var vt=N[ne].substring(0,Se);ct=N[ne].substring(Se+1)}else vt=N[ne];M(vt,ct?decodeURIComponent(ct.replace(/\+/g," ")):"")}}}function ps(N){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,N instanceof ps){this.h=N.h,kn(this,N.j),this.o=N.o,this.g=N.g,sl(this,N.s),this.l=N.l;var M=N.i,ne=new bc;ne.i=M.i,M.g&&(ne.g=new Map(M.g),ne.h=M.h),vh(this,ne),this.m=N.m}else N&&(M=String(N).match(Qs))?(this.h=!1,kn(this,M[1]||"",!0),this.o=Ad(M[2]||""),this.g=Ad(M[3]||"",!0),sl(this,M[4]),this.l=Ad(M[5]||"",!0),vh(this,M[6]||"",!0),this.m=Ad(M[7]||"")):(this.h=!1,this.i=new bc(null,this.h))}ps.prototype.toString=function(){var N=[],M=this.j;M&&N.push(Ul(M,om,!0),":");var ne=this.g;return(ne||M=="file")&&(N.push("//"),(M=this.o)&&N.push(Ul(M,om,!0),"@"),N.push(encodeURIComponent(String(ne)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),ne=this.s,ne!=null&&N.push(":",String(ne))),(ne=this.l)&&(this.g&&ne.charAt(0)!="/"&&N.push("/"),N.push(Ul(ne,ne.charAt(0)=="/"?Ml:Hp,!0))),(ne=this.i.toString())&&N.push("?",ne),(ne=this.m)&&N.push("#",Ul(ne,xu)),N.join("")};function us(N){return new ps(N)}function kn(N,M,ne){N.j=ne?Ad(M,!0):M,N.j&&(N.j=N.j.replace(/:$/,""))}function sl(N,M){if(M){if(M=Number(M),isNaN(M)||0>M)throw Error("Bad port number "+M);N.s=M}else N.s=null}function vh(N,M,ne){M instanceof bc?(N.i=M,$p(N.i,N.h)):(ne||(M=Ul(M,gu)),N.i=new bc(M,N.h))}function ks(N,M,ne){N.i.set(M,ne)}function ud(N){return ks(N,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),N}function Ad(N,M){return N?M?decodeURI(N.replace(/%25/g,"%2525")):decodeURIComponent(N):""}function Ul(N,M,ne){return typeof N=="string"?(N=encodeURI(N).replace(M,Vp),ne&&(N=N.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),N):null}function Vp(N){return N=N.charCodeAt(0),"%"+(N>>4&15).toString(16)+(N&15).toString(16)}var om=/[#\/\?@]/g,Hp=/[#\?:]/g,Ml=/[#\?]/g,gu=/[#\?@]/g,xu=/#/g;function bc(N,M){this.h=this.g=null,this.i=N||null,this.j=!!M}function on(N){N.g||(N.g=new Map,N.h=0,N.i&&ci(N.i,function(M,ne){N.add(decodeURIComponent(M.replace(/\+/g," ")),ne)}))}t=bc.prototype,t.add=function(N,M){on(this),this.i=null,N=wc(this,N);var ne=this.g.get(N);return ne||this.g.set(N,ne=[]),ne.push(M),this.h+=1,this};function lm(N,M){on(N),M=wc(N,M),N.g.has(M)&&(N.i=null,N.h-=N.g.get(M).length,N.g.delete(M))}function bh(N,M){return on(N),M=wc(N,M),N.g.has(M)}t.forEach=function(N,M){on(this),this.g.forEach(function(ne,Se){ne.forEach(function(ct){N.call(M,ct,Se,this)},this)},this)},t.na=function(){on(this);const N=Array.from(this.g.values()),M=Array.from(this.g.keys()),ne=[];for(let Se=0;Se<M.length;Se++){const ct=N[Se];for(let vt=0;vt<ct.length;vt++)ne.push(M[Se])}return ne},t.V=function(N){on(this);let M=[];if(typeof N=="string")bh(this,N)&&(M=M.concat(this.g.get(wc(this,N))));else{N=Array.from(this.g.values());for(let ne=0;ne<N.length;ne++)M=M.concat(N[ne])}return M},t.set=function(N,M){return on(this),this.i=null,N=wc(this,N),bh(this,N)&&(this.h-=this.g.get(N).length),this.g.set(N,[M]),this.h+=1,this},t.get=function(N,M){return N?(N=this.V(N),0<N.length?String(N[0]):M):M};function Dr(N,M,ne){lm(N,M),0<ne.length&&(N.i=null,N.g.set(wc(N,M),m(ne)),N.h+=ne.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const N=[],M=Array.from(this.g.keys());for(var ne=0;ne<M.length;ne++){var Se=M[ne];const vt=encodeURIComponent(String(Se)),zt=this.V(Se);for(Se=0;Se<zt.length;Se++){var ct=vt;zt[Se]!==""&&(ct+="="+encodeURIComponent(String(zt[Se]))),N.push(ct)}}return this.i=N.join("&")};function wc(N,M){return M=String(M),N.j&&(M=M.toLowerCase()),M}function $p(N,M){M&&!N.j&&(on(N),N.i=null,N.g.forEach(function(ne,Se){var ct=Se.toLowerCase();Se!=ct&&(lm(this,Se),Dr(this,ct,ne))},N)),N.j=M}function nl(N,M){const ne=new Pr;if(l.Image){const Se=new Image;Se.onload=f(_o,ne,"TestLoadImage: loaded",!0,M,Se),Se.onerror=f(_o,ne,"TestLoadImage: error",!1,M,Se),Se.onabort=f(_o,ne,"TestLoadImage: abort",!1,M,Se),Se.ontimeout=f(_o,ne,"TestLoadImage: timeout",!1,M,Se),l.setTimeout(function(){Se.ontimeout&&Se.ontimeout()},1e4),Se.src=N}else M(!1)}function cm(N,M){const ne=new Pr,Se=new AbortController,ct=setTimeout(()=>{Se.abort(),_o(ne,"TestPingServer: timeout",!1,M)},1e4);fetch(N,{signal:Se.signal}).then(vt=>{clearTimeout(ct),vt.ok?_o(ne,"TestPingServer: ok",!0,M):_o(ne,"TestPingServer: server error",!1,M)}).catch(()=>{clearTimeout(ct),_o(ne,"TestPingServer: error",!1,M)})}function _o(N,M,ne,Se,ct){try{ct&&(ct.onload=null,ct.onerror=null,ct.onabort=null,ct.ontimeout=null),Se(ne)}catch{}}function yu(){this.g=new rt}function wh(N,M,ne){const Se=ne||"";try{ms(N,function(ct,vt){let zt=ct;d(ct)&&(zt=ze(ct)),M.push(Se+vt+"="+encodeURIComponent(zt))})}catch(ct){throw M.push(Se+"type="+encodeURIComponent("_badmap")),ct}}function vu(N){this.l=N.Ub||null,this.j=N.eb||!1}p(vu,ht),vu.prototype.g=function(){return new bu(this.l,this.j)},vu.prototype.i=function(N){return function(){return N}}({});function bu(N,M){Fe.call(this),this.D=N,this.o=M,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}p(bu,Fe),t=bu.prototype,t.open=function(N,M){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=N,this.A=M,this.readyState=1,To(this)},t.send=function(N){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const M={headers:this.u,method:this.B,credentials:this.m,cache:void 0};N&&(M.body=N),(this.D||l).fetch(new Request(this.A,M)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ql(this)),this.readyState=0},t.Sa=function(N){if(this.g&&(this.l=N,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=N.headers,this.readyState=2,To(this)),this.g&&(this.readyState=3,To(this),this.g)))if(this.responseType==="arraybuffer")N.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in N){if(this.j=N.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;dm(this)}else N.text().then(this.Ra.bind(this),this.ga.bind(this))};function dm(N){N.j.read().then(N.Pa.bind(N)).catch(N.ga.bind(N))}t.Pa=function(N){if(this.g){if(this.o&&N.value)this.response.push(N.value);else if(!this.o){var M=N.value?N.value:new Uint8Array(0);(M=this.v.decode(M,{stream:!N.done}))&&(this.response=this.responseText+=M)}N.done?Ql(this):To(this),this.readyState==3&&dm(this)}},t.Ra=function(N){this.g&&(this.response=this.responseText=N,Ql(this))},t.Qa=function(N){this.g&&(this.response=N,Ql(this))},t.ga=function(){this.g&&Ql(this)};function Ql(N){N.readyState=4,N.l=null,N.j=null,N.v=null,To(N)}t.setRequestHeader=function(N,M){this.u.append(N,M)},t.getResponseHeader=function(N){return this.h&&this.h.get(N.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const N=[],M=this.h.entries();for(var ne=M.next();!ne.done;)ne=ne.value,N.push(ne[0]+": "+ne[1]),ne=M.next();return N.join(`\r
`)};function To(N){N.onreadystatechange&&N.onreadystatechange.call(N)}Object.defineProperty(bu.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(N){this.m=N?"include":"same-origin"}});function Vl(N){let M="";return j(N,function(ne,Se){M+=Se,M+=":",M+=ne,M+=`\r
`}),M}function Nh(N,M,ne){e:{for(Se in ne){var Se=!1;break e}Se=!0}Se||(ne=Vl(ne),typeof N=="string"?ne!=null&&encodeURIComponent(String(ne)):ks(N,M,ne))}function Ss(N){Fe.call(this),this.headers=new Map,this.o=N||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}p(Ss,Fe);var Ch=/^https?$/i,wu=["POST","PUT"];t=Ss.prototype,t.Ha=function(N){this.J=N},t.ea=function(N,M,ne,Se){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+N);M=M?M.toUpperCase():"GET",this.D=N,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():xe.g(),this.v=this.o?Qe(this.o):Qe(xe),this.g.onreadystatechange=h(this.Ea,this);try{this.B=!0,this.g.open(M,String(N),!0),this.B=!1}catch(vt){jh(this,vt);return}if(N=ne||"",ne=new Map(this.headers),Se)if(Object.getPrototypeOf(Se)===Object.prototype)for(var ct in Se)ne.set(ct,Se[ct]);else if(typeof Se.keys=="function"&&typeof Se.get=="function")for(const vt of Se.keys())ne.set(vt,Se.get(vt));else throw Error("Unknown input type for opt_headers: "+String(Se));Se=Array.from(ne.keys()).find(vt=>vt.toLowerCase()=="content-type"),ct=l.FormData&&N instanceof l.FormData,!(0<=Array.prototype.indexOf.call(wu,M,void 0))||Se||ct||ne.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[vt,zt]of ne)this.g.setRequestHeader(vt,zt);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Io(this),this.u=!0,this.g.send(N),this.u=!1}catch(vt){jh(this,vt)}};function jh(N,M){N.h=!1,N.g&&(N.j=!0,N.g.abort(),N.j=!1),N.l=M,N.m=5,Sh(N),hd(N)}function Sh(N){N.A||(N.A=!0,Re(N,"complete"),Re(N,"error"))}t.abort=function(N){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=N||7,Re(this,"complete"),Re(this,"abort"),hd(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),hd(this,!0)),Ss.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Eh(this):this.bb())},t.bb=function(){Eh(this)};function Eh(N){if(N.h&&typeof o<"u"&&(!N.v[1]||xa(N)!=4||N.Z()!=2)){if(N.u&&xa(N)==4)X(N.Ea,0,N);else if(Re(N,"readystatechange"),xa(N)==4){N.h=!1;try{const zt=N.Z();e:switch(zt){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var M=!0;break e;default:M=!1}var ne;if(!(ne=M)){var Se;if(Se=zt===0){var ct=String(N.D).match(Qs)[1]||null;!ct&&l.self&&l.self.location&&(ct=l.self.location.protocol.slice(0,-1)),Se=!Ch.test(ct?ct.toLowerCase():"")}ne=Se}if(ne)Re(N,"complete"),Re(N,"success");else{N.m=6;try{var vt=2<xa(N)?N.g.statusText:""}catch{vt=""}N.l=vt+" ["+N.Z()+"]",Sh(N)}}finally{hd(N)}}}}function hd(N,M){if(N.g){Io(N);const ne=N.g,Se=N.v[0]?()=>{}:null;N.g=null,N.v=null,M||Re(N,"ready");try{ne.onreadystatechange=Se}catch{}}}function Io(N){N.I&&(l.clearTimeout(N.I),N.I=null)}t.isActive=function(){return!!this.g};function xa(N){return N.g?N.g.readyState:0}t.Z=function(){try{return 2<xa(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(N){if(this.g){var M=this.g.responseText;return N&&M.indexOf(N)==0&&(M=M.substring(N.length)),Me(M)}};function um(N){try{if(!N.g)return null;if("response"in N.g)return N.g.response;switch(N.H){case"":case"text":return N.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in N.g)return N.g.mozResponseArrayBuffer}return null}catch{return null}}function Nc(N){const M={};N=(N.g&&2<=xa(N)&&N.g.getAllResponseHeaders()||"").split(`\r
`);for(let Se=0;Se<N.length;Se++){if(v(N[Se]))continue;var ne=B(N[Se]);const ct=ne[0];if(ne=ne[1],typeof ne!="string")continue;ne=ne.trim();const vt=M[ct]||[];M[ct]=vt,vt.push(ne)}C(M,function(Se){return Se.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function za(N,M,ne){return ne&&ne.internalChannelParams&&ne.internalChannelParams[N]||M}function Nu(N){this.Aa=0,this.i=[],this.j=new Pr,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=za("failFast",!1,N),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=za("baseRetryDelayMs",5e3,N),this.cb=za("retryDelaySeedMs",1e4,N),this.Wa=za("forwardChannelMaxRetries",2,N),this.wa=za("forwardChannelRequestTimeoutMs",2e4,N),this.pa=N&&N.xmlHttpFactory||void 0,this.Xa=N&&N.Tb||void 0,this.Ca=N&&N.useFetchStreams||!1,this.L=void 0,this.J=N&&N.supportsCrossDomainXhr||!1,this.K="",this.h=new li(N&&N.concurrentRequestLimit),this.Da=new yu,this.P=N&&N.fastHandshake||!1,this.O=N&&N.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=N&&N.Rb||!1,N&&N.xa&&this.j.xa(),N&&N.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&N&&N.detectBufferingProxy||!1,this.ja=void 0,N&&N.longPollingTimeout&&0<N.longPollingTimeout&&(this.ja=N.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Nu.prototype,t.la=8,t.G=1,t.connect=function(N,M,ne,Se){Ct(0),this.W=N,this.H=M||{},ne&&Se!==void 0&&(this.H.OSID=ne,this.H.OAID=Se),this.F=this.X,this.I=P(this,null,this.W),ju(this)};function Hl(N){if(fd(N),N.G==3){var M=N.U++,ne=us(N.I);if(ks(ne,"SID",N.K),ks(ne,"RID",M),ks(ne,"TYPE","terminate"),Cc(N,ne),M=new Ze(N,N.j,M),M.L=2,M.v=ud(us(ne)),ne=!1,l.navigator&&l.navigator.sendBeacon)try{ne=l.navigator.sendBeacon(M.v.toString(),"")}catch{}!ne&&l.Image&&(new Image().src=M.v,ne=!0),ne||(M.g=pe(M.j,null),M.g.ea(M.v)),M.F=Date.now(),Ht(M)}Iu(N)}function Cu(N){N.g&&(_u(N),N.g.cancel(),N.g=null)}function fd(N){Cu(N),N.u&&(l.clearTimeout(N.u),N.u=null),$l(N),N.h.cancel(),N.s&&(typeof N.s=="number"&&l.clearTimeout(N.s),N.s=null)}function ju(N){if(!Ka(N.h)&&!N.s){N.s=!0;var M=N.Ga;Q||Ae(),re||(Q(),re=!0),G.add(M,N),N.B=0}}function _h(N,M){return ot(N.h)>=N.h.j-(N.s?1:0)?!1:N.s?(N.i=M.D.concat(N.i),!0):N.G==1||N.G==2||N.B>=(N.Va?0:N.Wa)?!1:(N.s=vr(h(N.Ga,N,M),Tu(N,N.B)),N.B++,!0)}t.Ga=function(N){if(this.s)if(this.s=null,this.G==1){if(!N){this.U=Math.floor(1e5*Math.random()),N=this.U++;const ct=new Ze(this,this.j,N);let vt=this.o;if(this.S&&(vt?(vt=w(vt),F(vt,this.S)):vt=this.S),this.m!==null||this.O||(ct.H=vt,vt=null),this.P)e:{for(var M=0,ne=0;ne<this.i.length;ne++){t:{var Se=this.i[ne];if("__data__"in Se.map&&(Se=Se.map.__data__,typeof Se=="string")){Se=Se.length;break t}Se=void 0}if(Se===void 0)break;if(M+=Se,4096<M){M=ne;break e}if(M===4096||ne===this.i.length-1){M=ne+1;break e}}M=1e3}else M=1e3;M=md(this,ct,M),ne=us(this.I),ks(ne,"RID",N),ks(ne,"CVER",22),this.D&&ks(ne,"X-HTTP-Session-Id",this.D),Cc(this,ne),vt&&(this.O?M="headers="+encodeURIComponent(String(Vl(vt)))+"&"+M:this.m&&Nh(ne,this.m,vt)),jt(this.h,ct),this.Ua&&ks(ne,"TYPE","init"),this.P?(ks(ne,"$req",M),ks(ne,"SID","null"),ct.T=!0,ft(ct,ne,null)):ft(ct,ne,M),this.G=2}}else this.G==3&&(N?Su(this,N):this.i.length==0||Ka(this.h)||Su(this))};function Su(N,M){var ne;M?ne=M.l:ne=N.U++;const Se=us(N.I);ks(Se,"SID",N.K),ks(Se,"RID",ne),ks(Se,"AID",N.T),Cc(N,Se),N.m&&N.o&&Nh(Se,N.m,N.o),ne=new Ze(N,N.j,ne,N.B+1),N.m===null&&(ne.H=N.o),M&&(N.i=M.D.concat(N.i)),M=md(N,ne,1e3),ne.I=Math.round(.5*N.wa)+Math.round(.5*N.wa*Math.random()),jt(N.h,ne),ft(ne,Se,M)}function Cc(N,M){N.H&&j(N.H,function(ne,Se){ks(M,Se,ne)}),N.l&&ms({},function(ne,Se){ks(M,Se,ne)})}function md(N,M,ne){ne=Math.min(N.i.length,ne);var Se=N.l?h(N.l.Na,N.l,N):null;e:{var ct=N.i;let vt=-1;for(;;){const zt=["count="+ne];vt==-1?0<ne?(vt=ct[0].g,zt.push("ofs="+vt)):vt=0:zt.push("ofs="+vt);let Qr=!0;for(let as=0;as<ne;as++){let Vr=ct[as].g;const Es=ct[as].map;if(Vr-=vt,0>Vr)vt=Math.max(0,ct[as].g-100),Qr=!1;else try{wh(Es,zt,"req"+Vr+"_")}catch{Se&&Se(Es)}}if(Qr){Se=zt.join("&");break e}}}return N=N.i.splice(0,ne),M.D=N,Se}function Eu(N){if(!N.g&&!N.u){N.Y=1;var M=N.Fa;Q||Ae(),re||(Q(),re=!0),G.add(M,N),N.v=0}}function pd(N){return N.g||N.u||3<=N.v?!1:(N.Y++,N.u=vr(h(N.Fa,N),Tu(N,N.v)),N.v++,!0)}t.Fa=function(){if(this.u=null,Am(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var N=2*this.R;this.j.info("BP detection timer enabled: "+N),this.A=vr(h(this.ab,this),N)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Ct(10),Cu(this),Am(this))};function _u(N){N.A!=null&&(l.clearTimeout(N.A),N.A=null)}function Am(N){N.g=new Ze(N,N.j,"rpc",N.Y),N.m===null&&(N.g.H=N.o),N.g.O=0;var M=us(N.qa);ks(M,"RID","rpc"),ks(M,"SID",N.K),ks(M,"AID",N.T),ks(M,"CI",N.F?"0":"1"),!N.F&&N.ja&&ks(M,"TO",N.ja),ks(M,"TYPE","xmlhttp"),Cc(N,M),N.m&&N.o&&Nh(M,N.m,N.o),N.L&&(N.g.I=N.L);var ne=N.g;N=N.ia,ne.L=1,ne.v=ud(us(M)),ne.m=null,ne.P=!0,At(ne,N)}t.Za=function(){this.C!=null&&(this.C=null,Cu(this),pd(this),Ct(19))};function $l(N){N.C!=null&&(l.clearTimeout(N.C),N.C=null)}function jc(N,M){var ne=null;if(N.g==M){$l(N),_u(N),N.g=null;var Se=2}else if(Pt(N.h,M))ne=M.D,Lt(N.h,M),Se=1;else return;if(N.G!=0){if(M.o)if(Se==1){ne=M.m?M.m.length:0,M=Date.now()-M.F;var ct=N.B;Se=Xe(),Re(Se,new xr(Se,ne)),ju(N)}else Eu(N);else if(ct=M.s,ct==3||ct==0&&0<M.X||!(Se==1&&_h(N,M)||Se==2&&pd(N)))switch(ne&&0<ne.length&&(M=N.h,M.i=M.i.concat(ne)),ct){case 1:di(N,5);break;case 4:di(N,10);break;case 3:di(N,6);break;default:di(N,2)}}}function Tu(N,M){let ne=N.Ta+Math.floor(Math.random()*N.cb);return N.isActive()||(ne*=2),ne*M}function di(N,M){if(N.j.info("Error code "+M),M==2){var ne=h(N.fb,N),Se=N.Xa;const ct=!Se;Se=new ps(Se||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||kn(Se,"https"),ud(Se),ct?nl(Se.toString(),ne):cm(Se.toString(),ne)}else Ct(2);N.G=0,N.l&&N.l.sa(M),Iu(N),fd(N)}t.fb=function(N){N?(this.j.info("Successfully pinged google.com"),Ct(2)):(this.j.info("Failed to ping google.com"),Ct(1))};function Iu(N){if(N.G=0,N.ka=[],N.l){const M=Er(N.h);(M.length!=0||N.i.length!=0)&&(g(N.ka,M),g(N.ka,N.i),N.h.i.length=0,m(N.i),N.i.length=0),N.l.ra()}}function P(N,M,ne){var Se=ne instanceof ps?us(ne):new ps(ne);if(Se.g!="")M&&(Se.g=M+"."+Se.g),sl(Se,Se.s);else{var ct=l.location;Se=ct.protocol,M=M?M+"."+ct.hostname:ct.hostname,ct=+ct.port;var vt=new ps(null);Se&&kn(vt,Se),M&&(vt.g=M),ct&&sl(vt,ct),ne&&(vt.l=ne),Se=vt}return ne=N.D,M=N.ya,ne&&M&&ks(Se,ne,M),ks(Se,"VER",N.la),Cc(N,Se),Se}function pe(N,M,ne){if(M&&!N.J)throw Error("Can't create secondary domain capable XhrIo object.");return M=N.Ca&&!N.pa?new Ss(new vu({eb:ne})):new Ss(N.pa),M.Ha(N.J),M}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function $e(){}t=$e.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function tt(){}tt.prototype.g=function(N,M){return new dt(N,M)};function dt(N,M){Fe.call(this),this.g=new Nu(M),this.l=N,this.h=M&&M.messageUrlParams||null,N=M&&M.messageHeaders||null,M&&M.clientProtocolHeaderRequired&&(N?N["X-Client-Protocol"]="webchannel":N={"X-Client-Protocol":"webchannel"}),this.g.o=N,N=M&&M.initMessageHeaders||null,M&&M.messageContentType&&(N?N["X-WebChannel-Content-Type"]=M.messageContentType:N={"X-WebChannel-Content-Type":M.messageContentType}),M&&M.va&&(N?N["X-WebChannel-Client-Profile"]=M.va:N={"X-WebChannel-Client-Profile":M.va}),this.g.S=N,(N=M&&M.Sb)&&!v(N)&&(this.g.m=N),this.v=M&&M.supportsCrossDomainXhr||!1,this.u=M&&M.sendRawJson||!1,(M=M&&M.httpSessionIdParam)&&!v(M)&&(this.g.D=M,N=this.h,N!==null&&M in N&&(N=this.h,M in N&&delete N[M])),this.j=new sr(this)}p(dt,Fe),dt.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},dt.prototype.close=function(){Hl(this.g)},dt.prototype.o=function(N){var M=this.g;if(typeof N=="string"){var ne={};ne.__data__=N,N=ne}else this.u&&(ne={},ne.__data__=ze(N),N=ne);M.i.push(new so(M.Ya++,N)),M.G==3&&ju(M)},dt.prototype.N=function(){this.g.l=null,delete this.j,Hl(this.g),delete this.g,dt.aa.N.call(this)};function _t(N){St.call(this),N.__headers__&&(this.headers=N.__headers__,this.statusCode=N.__status__,delete N.__headers__,delete N.__status__);var M=N.__sm__;if(M){e:{for(const ne in M){N=ne;break e}N=void 0}(this.i=N)&&(N=this.i,M=M!==null&&N in M?M[N]:void 0),this.data=M}else this.data=N}p(_t,St);function $t(){Vt.call(this),this.status=1}p($t,Vt);function sr(N){this.g=N}p(sr,$e),sr.prototype.ua=function(){Re(this.g,"a")},sr.prototype.ta=function(N){Re(this.g,new _t(N))},sr.prototype.sa=function(N){Re(this.g,new $t)},sr.prototype.ra=function(){Re(this.g,"b")},tt.prototype.createWebChannel=tt.prototype.g,dt.prototype.send=dt.prototype.o,dt.prototype.open=dt.prototype.m,dt.prototype.close=dt.prototype.close,GL=function(){return new tt},WL=function(){return Xe()},qL=Kt,lj={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},z.NO_ERROR=0,z.TIMEOUT=8,z.HTTP_ERROR=6,Nb=z,ce.COMPLETE="complete",zL=ce,Ge.EventType=gt,gt.OPEN="a",gt.CLOSE="b",gt.ERROR="c",gt.MESSAGE="d",Fe.prototype.listen=Fe.prototype.K,Fg=Ge,Ss.prototype.listenOnce=Ss.prototype.L,Ss.prototype.getLastError=Ss.prototype.Ka,Ss.prototype.getLastErrorCode=Ss.prototype.Ba,Ss.prototype.getStatus=Ss.prototype.Z,Ss.prototype.getResponseJson=Ss.prototype.Oa,Ss.prototype.getResponseText=Ss.prototype.oa,Ss.prototype.send=Ss.prototype.ea,Ss.prototype.setWithCredentials=Ss.prototype.Ha,KL=Ss}).apply(typeof s1<"u"?s1:typeof self<"u"?self:typeof window<"u"?window:{});const Lk="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ma=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Ma.UNAUTHENTICATED=new Ma(null),Ma.GOOGLE_CREDENTIALS=new Ma("google-credentials-uid"),Ma.FIRST_PARTY=new Ma("first-party-uid"),Ma.MOCK_USER=new Ma("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let kp="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tf=new $E("@firebase/firestore");function Wm(){return Tf.logLevel}function qt(t,...e){if(Tf.logLevel<=cs.DEBUG){const r=e.map(r3);Tf.debug(`Firestore (${kp}): ${t}`,...r)}}function ea(t,...e){if(Tf.logLevel<=cs.ERROR){const r=e.map(r3);Tf.error(`Firestore (${kp}): ${t}`,...r)}}function If(t,...e){if(Tf.logLevel<=cs.WARN){const r=e.map(r3);Tf.warn(`Firestore (${kp}): ${t}`,...r)}}function r3(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mr(t="Unexpected state"){const e=`FIRESTORE (${kp}) INTERNAL ASSERTION FAILED: `+t;throw ea(e),new Error(e)}function br(t,e){t||mr()}function pr(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tt={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Gt extends Au{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xc{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YL{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class YX{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(Ma.UNAUTHENTICATED))}shutdown(){}}class XX{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class JX{constructor(e){this.t=e,this.currentUser=Ma.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){br(this.o===void 0);let s=this.i;const n=c=>this.i!==s?(s=this.i,r(c)):Promise.resolve();let i=new Xc;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Xc,e.enqueueRetryable(()=>n(this.currentUser))};const o=()=>{const c=i;e.enqueueRetryable(async()=>{await c.promise,await n(this.currentUser)})},l=c=>{qt("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>l(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?l(c):(qt("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Xc)}},0),o()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(s=>this.i!==e?(qt("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):s?(br(typeof s.accessToken=="string"),new YL(s.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return br(e===null||typeof e=="string"),new Ma(e)}}class ZX{constructor(e,r,s){this.l=e,this.h=r,this.P=s,this.type="FirstParty",this.user=Ma.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class eJ{constructor(e,r,s){this.l=e,this.h=r,this.P=s}getToken(){return Promise.resolve(new ZX(this.l,this.h,this.P))}start(e,r){e.enqueueRetryable(()=>r(Ma.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class tJ{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class rJ{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,r){br(this.o===void 0);const s=i=>{i.error!=null&&qt("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.R;return this.R=i.token,qt("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?r(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>s(i))};const n=i=>{qt("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>n(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?n(i):qt("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(br(typeof r.token=="string"),this.R=r.token,new tJ(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sJ(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let s=0;s<t;s++)r[s]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XL{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=Math.floor(256/e.length)*e.length;let s="";for(;s.length<20;){const n=sJ(40);for(let i=0;i<n.length;++i)s.length<20&&n[i]<r&&(s+=e.charAt(n[i]%e.length))}return s}}function $r(t,e){return t<e?-1:t>e?1:0}function tp(t,e,r){return t.length===e.length&&t.every((s,n)=>r(s,e[n]))}function JL(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wt{constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new Gt(Tt.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new Gt(Tt.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<-62135596800)throw new Gt(Tt.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Gt(Tt.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return wt.fromMillis(Date.now())}static fromDate(e){return wt.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),s=Math.floor(1e6*(e-1e3*r));return new wt(r,s)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?$r(this.nanoseconds,e.nanoseconds):$r(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sr{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Sr(e)}static min(){return new Sr(new wt(0,0))}static max(){return new Sr(new wt(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ey{constructor(e,r,s){r===void 0?r=0:r>e.length&&mr(),s===void 0?s=e.length-r:s>e.length-r&&mr(),this.segments=e,this.offset=r,this.len=s}get length(){return this.len}isEqual(e){return ey.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof ey?e.forEach(s=>{r.push(s)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,s=this.limit();r<s;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const s=Math.min(e.length,r.length);for(let n=0;n<s;n++){const i=e.get(n),o=r.get(n);if(i<o)return-1;if(i>o)return 1}return e.length<r.length?-1:e.length>r.length?1:0}}class Cs extends ey{construct(e,r,s){return new Cs(e,r,s)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const s of e){if(s.indexOf("//")>=0)throw new Gt(Tt.INVALID_ARGUMENT,`Invalid segment (${s}). Paths must not contain // in them.`);r.push(...s.split("/").filter(n=>n.length>0))}return new Cs(r)}static emptyPath(){return new Cs([])}}const nJ=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class jn extends ey{construct(e,r,s){return new jn(e,r,s)}static isValidIdentifier(e){return nJ.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),jn.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new jn(["__name__"])}static fromServerFormat(e){const r=[];let s="",n=0;const i=()=>{if(s.length===0)throw new Gt(Tt.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(s),s=""};let o=!1;for(;n<e.length;){const l=e[n];if(l==="\\"){if(n+1===e.length)throw new Gt(Tt.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[n+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new Gt(Tt.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);s+=c,n+=2}else l==="`"?(o=!o,n++):l!=="."||o?(s+=l,n++):(i(),n++)}if(i(),o)throw new Gt(Tt.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new jn(r)}static emptyPath(){return new jn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nr{constructor(e){this.path=e}static fromPath(e){return new nr(Cs.fromString(e))}static fromName(e){return new nr(Cs.fromString(e).popFirst(5))}static empty(){return new nr(Cs.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Cs.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return Cs.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new nr(new Cs(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nw{constructor(e,r,s,n){this.indexId=e,this.collectionGroup=r,this.fields=s,this.indexState=n}}function cj(t){return t.fields.find(e=>e.kind===2)}function Mh(t){return t.fields.filter(e=>e.kind!==2)}Nw.UNKNOWN_ID=-1;class Cb{constructor(e,r){this.fieldPath=e,this.kind=r}}class ty{constructor(e,r){this.sequenceNumber=e,this.offset=r}static empty(){return new ty(0,Xo.min())}}function ZL(t,e){const r=t.toTimestamp().seconds,s=t.toTimestamp().nanoseconds+1,n=Sr.fromTimestamp(s===1e9?new wt(r+1,0):new wt(r,s));return new Xo(n,nr.empty(),e)}function eO(t){return new Xo(t.readTime,t.key,-1)}class Xo{constructor(e,r,s){this.readTime=e,this.documentKey=r,this.largestBatchId=s}static min(){return new Xo(Sr.min(),nr.empty(),-1)}static max(){return new Xo(Sr.max(),nr.empty(),-1)}}function s3(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=nr.comparator(t.documentKey,e.documentKey),r!==0?r:$r(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tO="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class rO{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ah(t){if(t.code!==Tt.FAILED_PRECONDITION||t.message!==tO)throw t;qt("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bt{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&mr(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new bt((s,n)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(s,n)},this.catchCallback=i=>{this.wrapFailure(r,i).next(s,n)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof bt?r:bt.resolve(r)}catch(r){return bt.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):bt.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):bt.reject(r)}static resolve(e){return new bt((r,s)=>{r(e)})}static reject(e){return new bt((r,s)=>{s(e)})}static waitFor(e){return new bt((r,s)=>{let n=0,i=0,o=!1;e.forEach(l=>{++n,l.next(()=>{++i,o&&i===n&&r()},c=>s(c))}),o=!0,i===n&&r()})}static or(e){let r=bt.resolve(!1);for(const s of e)r=r.next(n=>n?bt.resolve(n):s());return r}static forEach(e,r){const s=[];return e.forEach((n,i)=>{s.push(r.call(this,n,i))}),this.waitFor(s)}static mapArray(e,r){return new bt((s,n)=>{const i=e.length,o=new Array(i);let l=0;for(let c=0;c<i;c++){const d=c;r(e[d]).next(u=>{o[d]=u,++l,l===i&&s(o)},u=>n(u))}})}static doWhile(e,r){return new bt((s,n)=>{const i=()=>{e()===!0?r().next(()=>{i()},n):s()};i()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q2{constructor(e,r){this.action=e,this.transaction=r,this.aborted=!1,this.V=new Xc,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{r.error?this.V.reject(new ax(e,r.error)):this.V.resolve()},this.transaction.onerror=s=>{const n=n3(s.target.error);this.V.reject(new ax(e,n))}}static open(e,r,s,n){try{return new q2(r,e.transaction(n,s))}catch(i){throw new ax(r,i)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(qt("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const r=this.transaction.objectStore(e);return new iJ(r)}}class DA{constructor(e,r,s){this.name=e,this.version=r,this.p=s,DA.S(Ea())===12.2&&ea("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return qt("SimpleDb","Removing database:",e),Vh(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!sL())return!1;if(DA.v())return!0;const e=Ea(),r=DA.S(e),s=0<r&&r<10,n=sO(e),i=0<n&&n<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||s||i)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.C)==="YES"}static F(e,r){return e.store(r)}static S(e){const r=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),s=r?r[1].split("_").slice(0,2).join("."):"-1";return Number(s)}async M(e){return this.db||(qt("SimpleDb","Opening database:",this.name),this.db=await new Promise((r,s)=>{const n=indexedDB.open(this.name,this.version);n.onsuccess=i=>{const o=i.target.result;r(o)},n.onblocked=()=>{s(new ax(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},n.onerror=i=>{const o=i.target.error;o.name==="VersionError"?s(new Gt(Tt.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?s(new Gt(Tt.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):s(new ax(e,o))},n.onupgradeneeded=i=>{qt("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',i.oldVersion);const o=i.target.result;this.p.O(o,n.transaction,i.oldVersion,this.version).next(()=>{qt("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=r=>this.N(r)),this.db}L(e){this.N=e,this.db&&(this.db.onversionchange=r=>e(r))}async runTransaction(e,r,s,n){const i=r==="readonly";let o=0;for(;;){++o;try{this.db=await this.M(e);const l=q2.open(this.db,e,i?"readonly":"readwrite",s),c=n(l).next(d=>(l.g(),d)).catch(d=>(l.abort(d),bt.reject(d))).toPromise();return c.catch(()=>{}),await l.m,c}catch(l){const c=l,d=c.name!=="FirebaseError"&&o<3;if(qt("SimpleDb","Transaction failed with error:",c.message,"Retrying:",d),this.close(),!d)return Promise.reject(c)}}}close(){this.db&&this.db.close(),this.db=void 0}}function sO(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}class aJ{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return Vh(this.B.delete())}}class ax extends Gt{constructor(e,r){super(Tt.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${r}`),this.name="IndexedDbTransactionError"}}function hh(t){return t.name==="IndexedDbTransactionError"}class iJ{constructor(e){this.store=e}put(e,r){let s;return r!==void 0?(qt("SimpleDb","PUT",this.store.name,e,r),s=this.store.put(r,e)):(qt("SimpleDb","PUT",this.store.name,"<auto-key>",e),s=this.store.put(e)),Vh(s)}add(e){return qt("SimpleDb","ADD",this.store.name,e,e),Vh(this.store.add(e))}get(e){return Vh(this.store.get(e)).next(r=>(r===void 0&&(r=null),qt("SimpleDb","GET",this.store.name,e,r),r))}delete(e){return qt("SimpleDb","DELETE",this.store.name,e),Vh(this.store.delete(e))}count(){return qt("SimpleDb","COUNT",this.store.name),Vh(this.store.count())}U(e,r){const s=this.options(e,r),n=s.index?this.store.index(s.index):this.store;if(typeof n.getAll=="function"){const i=n.getAll(s.range);return new bt((o,l)=>{i.onerror=c=>{l(c.target.error)},i.onsuccess=c=>{o(c.target.result)}})}{const i=this.cursor(s),o=[];return this.W(i,(l,c)=>{o.push(c)}).next(()=>o)}}G(e,r){const s=this.store.getAll(e,r===null?void 0:r);return new bt((n,i)=>{s.onerror=o=>{i(o.target.error)},s.onsuccess=o=>{n(o.target.result)}})}j(e,r){qt("SimpleDb","DELETE ALL",this.store.name);const s=this.options(e,r);s.H=!1;const n=this.cursor(s);return this.W(n,(i,o,l)=>l.delete())}J(e,r){let s;r?s=e:(s={},r=e);const n=this.cursor(s);return this.W(n,r)}Y(e){const r=this.cursor({});return new bt((s,n)=>{r.onerror=i=>{const o=n3(i.target.error);n(o)},r.onsuccess=i=>{const o=i.target.result;o?e(o.primaryKey,o.value).next(l=>{l?o.continue():s()}):s()}})}W(e,r){const s=[];return new bt((n,i)=>{e.onerror=o=>{i(o.target.error)},e.onsuccess=o=>{const l=o.target.result;if(!l)return void n();const c=new aJ(l),d=r(l.primaryKey,l.value,c);if(d instanceof bt){const u=d.catch(A=>(c.done(),bt.reject(A)));s.push(u)}c.isDone?n():c.K===null?l.continue():l.continue(c.K)}}).next(()=>bt.waitFor(s))}options(e,r){let s;return e!==void 0&&(typeof e=="string"?s=e:r=e),{index:s,range:r}}cursor(e){let r="next";if(e.reverse&&(r="prev"),e.index){const s=this.store.index(e.index);return e.H?s.openKeyCursor(e.range,r):s.openCursor(e.range,r)}return this.store.openCursor(e.range,r)}}function Vh(t){return new bt((e,r)=>{t.onsuccess=s=>{const n=s.target.result;e(n)},t.onerror=s=>{const n=n3(s.target.error);r(n)}})}let Ok=!1;function n3(t){const e=DA.S(Ea());if(e>=12.2&&e<13){const r="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(r)>=0){const s=new Gt("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${r}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Ok||(Ok=!0,setTimeout(()=>{throw s},0)),s}}return t}class oJ{constructor(e,r){this.asyncQueue=e,this.Z=r,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){qt("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{qt("IndexBackfiller",`Documents written: ${await this.Z.ee()}`)}catch(r){hh(r)?qt("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",r):await Ah(r)}await this.X(6e4)})}}class lJ{constructor(e,r){this.localStore=e,this.persistence=r}async ee(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",r=>this.te(r,e))}te(e,r){const s=new Set;let n=r,i=!0;return bt.doWhile(()=>i===!0&&n>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!s.has(o))return qt("IndexBackfiller",`Processing collection: ${o}`),this.ne(e,o,n).next(l=>{n-=l,s.add(o)});i=!1})).next(()=>r-n)}ne(e,r,s){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,r).next(n=>this.localStore.localDocuments.getNextDocuments(e,r,n,s).next(i=>{const o=i.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.re(n,i)).next(l=>(qt("IndexBackfiller",`Updating offset: ${l}`),this.localStore.indexManager.updateCollectionGroup(e,r,l))).next(()=>o.size)}))}re(e,r){let s=e;return r.changes.forEach((n,i)=>{const o=eO(i);s3(o,s)>0&&(s=o)}),new Xo(s.readTime,s.documentKey,Math.max(r.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xo{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=s=>this.ie(s),this.se=s=>r.writeSequenceNumber(s))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}xo.oe=-1;function W2(t){return t==null}function ry(t){return t===0&&1/t==-1/0}function nO(t){return typeof t=="number"&&Number.isInteger(t)&&!ry(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xi(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=Uk(e)),e=cJ(t.get(r),e);return Uk(e)}function cJ(t,e){let r=e;const s=t.length;for(let n=0;n<s;n++){const i=t.charAt(n);switch(i){case"\0":r+="";break;case"":r+="";break;default:r+=i}}return r}function Uk(t){return t+""}function Qc(t){const e=t.length;if(br(e>=2),e===2)return br(t.charAt(0)===""&&t.charAt(1)===""),Cs.emptyPath();const r=e-2,s=[];let n="";for(let i=0;i<e;){const o=t.indexOf("",i);switch((o<0||o>r)&&mr(),t.charAt(o+1)){case"":const l=t.substring(i,o);let c;n.length===0?c=l:(n+=l,c=n,n=""),s.push(c);break;case"":n+=t.substring(i,o),n+="\0";break;case"":n+=t.substring(i,o+1);break;default:mr()}i=o+2}return new Cs(s)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mk=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jb(t,e){return[t,Xi(e)]}function aO(t,e,r){return[t,Xi(e),r]}const dJ={},uJ=["prefixPath","collectionGroup","readTime","documentId"],AJ=["prefixPath","collectionGroup","documentId"],hJ=["collectionGroup","readTime","prefixPath","documentId"],fJ=["canonicalId","targetId"],mJ=["targetId","path"],pJ=["path","targetId"],gJ=["collectionId","parent"],xJ=["indexId","uid"],yJ=["uid","sequenceNumber"],vJ=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],bJ=["indexId","uid","orderedDocumentKey"],wJ=["userId","collectionPath","documentId"],NJ=["userId","collectionPath","largestBatchId"],CJ=["userId","collectionGroup","largestBatchId"],iO=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],jJ=[...iO,"documentOverlays"],oO=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],lO=oO,a3=[...lO,"indexConfiguration","indexState","indexEntries"],SJ=a3,EJ=[...a3,"globals"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dj extends rO{constructor(e,r){super(),this._e=e,this.currentSequenceNumber=r}}function Ta(t,e){const r=pr(t);return DA.F(r._e,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qk(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function Xf(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function cO(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class an{constructor(e,r){this.comparator=e,this.root=r||ei.EMPTY}insert(e,r){return new an(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,ei.BLACK,null,null))}remove(e){return new an(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ei.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return r.value;s<0?r=r.left:s>0&&(r=r.right)}return null}indexOf(e){let r=0,s=this.root;for(;!s.isEmpty();){const n=this.comparator(e,s.key);if(n===0)return r+s.left.size;n<0?s=s.left:(r+=s.left.size+1,s=s.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,s)=>(e(r,s),!1))}toString(){const e=[];return this.inorderTraversal((r,s)=>(e.push(`${r}:${s}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new n1(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new n1(this.root,e,this.comparator,!1)}getReverseIterator(){return new n1(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new n1(this.root,e,this.comparator,!0)}}class n1{constructor(e,r,s,n){this.isReverse=n,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=r?s(e.key,r):1,r&&n&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class ei{constructor(e,r,s,n,i){this.key=e,this.value=r,this.color=s??ei.RED,this.left=n??ei.EMPTY,this.right=i??ei.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,s,n,i){return new ei(e??this.key,r??this.value,s??this.color,n??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,s){let n=this;const i=s(e,n.key);return n=i<0?n.copy(null,null,null,n.left.insert(e,r,s),null):i===0?n.copy(null,r,null,null,null):n.copy(null,null,null,null,n.right.insert(e,r,s)),n.fixUp()}removeMin(){if(this.left.isEmpty())return ei.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let s,n=this;if(r(e,n.key)<0)n.left.isEmpty()||n.left.isRed()||n.left.left.isRed()||(n=n.moveRedLeft()),n=n.copy(null,null,null,n.left.remove(e,r),null);else{if(n.left.isRed()&&(n=n.rotateRight()),n.right.isEmpty()||n.right.isRed()||n.right.left.isRed()||(n=n.moveRedRight()),r(e,n.key)===0){if(n.right.isEmpty())return ei.EMPTY;s=n.right.min(),n=n.copy(s.key,s.value,null,null,n.right.removeMin())}n=n.copy(null,null,null,null,n.right.remove(e,r))}return n.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ei.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ei.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw mr();const e=this.left.check();if(e!==this.right.check())throw mr();return e+(this.isRed()?0:1)}}ei.EMPTY=null,ei.RED=!0,ei.BLACK=!1;ei.EMPTY=new class{constructor(){this.size=0}get key(){throw mr()}get value(){throw mr()}get color(){throw mr()}get left(){throw mr()}get right(){throw mr()}copy(e,r,s,n,i){return this}insert(e,r,s){return new ei(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zs{constructor(e){this.comparator=e,this.data=new an(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,s)=>(e(r),!1))}forEachInRange(e,r){const s=this.data.getIteratorFrom(e[0]);for(;s.hasNext();){const n=s.getNext();if(this.comparator(n.key,e[1])>=0)return;r(n.key)}}forEachWhile(e,r){let s;for(s=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();s.hasNext();)if(!e(s.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new Vk(this.data.getIterator())}getIteratorFrom(e){return new Vk(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(s=>{r=r.add(s)}),r}isEqual(e){if(!(e instanceof zs)||this.size!==e.size)return!1;const r=this.data.getIterator(),s=e.data.getIterator();for(;r.hasNext();){const n=r.getNext().key,i=s.getNext().key;if(this.comparator(n,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new zs(this.comparator);return r.data=e,r}}class Vk{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function _m(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yo{constructor(e){this.fields=e,e.sort(jn.comparator)}static empty(){return new yo([])}unionWith(e){let r=new zs(jn.comparator);for(const s of this.fields)r=r.add(s);for(const s of e)r=r.add(s);return new yo(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return tp(this.fields,e.fields,(r,s)=>r.isEqual(s))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dO extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aa{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(n){try{return atob(n)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new dO("Invalid base64 string: "+i):i}}(e);return new aa(r)}static fromUint8Array(e){const r=function(n){let i="";for(let o=0;o<n.length;++o)i+=String.fromCharCode(n[o]);return i}(e);return new aa(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const s=new Uint8Array(r.length);for(let n=0;n<r.length;n++)s[n]=r.charCodeAt(n);return s}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return $r(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}aa.EMPTY_BYTE_STRING=new aa("");const _J=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function su(t){if(br(!!t),typeof t=="string"){let e=0;const r=_J.exec(t);if(br(!!r),r[1]){let n=r[1];n=(n+"000000000").substr(0,9),e=Number(n)}const s=new Date(t);return{seconds:Math.floor(s.getTime()/1e3),nanos:e}}return{seconds:vn(t.seconds),nanos:vn(t.nanos)}}function vn(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function KA(t){return typeof t=="string"?aa.fromBase64String(t):aa.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function G2(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="server_timestamp"}function i3(t){const e=t.mapValue.fields.__previous_value__;return G2(e)?i3(e):e}function sy(t){const e=su(t.mapValue.fields.__local_write_time__.timestampValue);return new wt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TJ{constructor(e,r,s,n,i,o,l,c,d){this.databaseId=e,this.appId=r,this.persistenceKey=s,this.host=n,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=c,this.useFetchStreams=d}}class kf{constructor(e,r){this.projectId=e,this.database=r||"(default)"}static empty(){return new kf("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof kf&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mA={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Sb={nullValue:"NULL_VALUE"};function Bf(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?G2(t)?4:uO(t)?9007199254740991:Y2(t)?10:11:mr()}function td(t,e){if(t===e)return!0;const r=Bf(t);if(r!==Bf(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return sy(t).isEqual(sy(e));case 3:return function(n,i){if(typeof n.timestampValue=="string"&&typeof i.timestampValue=="string"&&n.timestampValue.length===i.timestampValue.length)return n.timestampValue===i.timestampValue;const o=su(n.timestampValue),l=su(i.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(n,i){return KA(n.bytesValue).isEqual(KA(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(n,i){return vn(n.geoPointValue.latitude)===vn(i.geoPointValue.latitude)&&vn(n.geoPointValue.longitude)===vn(i.geoPointValue.longitude)}(t,e);case 2:return function(n,i){if("integerValue"in n&&"integerValue"in i)return vn(n.integerValue)===vn(i.integerValue);if("doubleValue"in n&&"doubleValue"in i){const o=vn(n.doubleValue),l=vn(i.doubleValue);return o===l?ry(o)===ry(l):isNaN(o)&&isNaN(l)}return!1}(t,e);case 9:return tp(t.arrayValue.values||[],e.arrayValue.values||[],td);case 10:case 11:return function(n,i){const o=n.mapValue.fields||{},l=i.mapValue.fields||{};if(Qk(o)!==Qk(l))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(l[c]===void 0||!td(o[c],l[c])))return!1;return!0}(t,e);default:return mr()}}function ny(t,e){return(t.values||[]).find(r=>td(r,e))!==void 0}function zA(t,e){if(t===e)return 0;const r=Bf(t),s=Bf(e);if(r!==s)return $r(r,s);switch(r){case 0:case 9007199254740991:return 0;case 1:return $r(t.booleanValue,e.booleanValue);case 2:return function(i,o){const l=vn(i.integerValue||i.doubleValue),c=vn(o.integerValue||o.doubleValue);return l<c?-1:l>c?1:l===c?0:isNaN(l)?isNaN(c)?0:-1:1}(t,e);case 3:return Hk(t.timestampValue,e.timestampValue);case 4:return Hk(sy(t),sy(e));case 5:return $r(t.stringValue,e.stringValue);case 6:return function(i,o){const l=KA(i),c=KA(o);return l.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const l=i.split("/"),c=o.split("/");for(let d=0;d<l.length&&d<c.length;d++){const u=$r(l[d],c[d]);if(u!==0)return u}return $r(l.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const l=$r(vn(i.latitude),vn(o.latitude));return l!==0?l:$r(vn(i.longitude),vn(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return $k(t.arrayValue,e.arrayValue);case 10:return function(i,o){var l,c,d,u;const A=i.fields||{},h=o.fields||{},f=(l=A.value)===null||l===void 0?void 0:l.arrayValue,p=(c=h.value)===null||c===void 0?void 0:c.arrayValue,m=$r(((d=f==null?void 0:f.values)===null||d===void 0?void 0:d.length)||0,((u=p==null?void 0:p.values)===null||u===void 0?void 0:u.length)||0);return m!==0?m:$k(f,p)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===mA.mapValue&&o===mA.mapValue)return 0;if(i===mA.mapValue)return 1;if(o===mA.mapValue)return-1;const l=i.fields||{},c=Object.keys(l),d=o.fields||{},u=Object.keys(d);c.sort(),u.sort();for(let A=0;A<c.length&&A<u.length;++A){const h=$r(c[A],u[A]);if(h!==0)return h;const f=zA(l[c[A]],d[u[A]]);if(f!==0)return f}return $r(c.length,u.length)}(t.mapValue,e.mapValue);default:throw mr()}}function Hk(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return $r(t,e);const r=su(t),s=su(e),n=$r(r.seconds,s.seconds);return n!==0?n:$r(r.nanos,s.nanos)}function $k(t,e){const r=t.values||[],s=e.values||[];for(let n=0;n<r.length&&n<s.length;++n){const i=zA(r[n],s[n]);if(i)return i}return $r(r.length,s.length)}function rp(t){return uj(t)}function uj(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const s=su(r);return`time(${s.seconds},${s.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return KA(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return nr.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let s="[",n=!0;for(const i of r.values||[])n?n=!1:s+=",",s+=uj(i);return s+"]"}(t.arrayValue):"mapValue"in t?function(r){const s=Object.keys(r.fields||{}).sort();let n="{",i=!0;for(const o of s)i?i=!1:n+=",",n+=`${o}:${uj(r.fields[o])}`;return n+"}"}(t.mapValue):mr()}function Ff(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Aj(t){return!!t&&"integerValue"in t}function ay(t){return!!t&&"arrayValue"in t}function Kk(t){return!!t&&"nullValue"in t}function zk(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Eb(t){return!!t&&"mapValue"in t}function Y2(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="__vector__"}function ix(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Xf(t.mapValue.fields,(r,s)=>e.mapValue.fields[r]=ix(s)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=ix(t.arrayValue.values[r]);return e}return Object.assign({},t)}function uO(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}const AO={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function IJ(t){return"nullValue"in t?Sb:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?Ff(kf.empty(),nr.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?Y2(t)?AO:{mapValue:{}}:mr()}function kJ(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?Ff(kf.empty(),nr.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?AO:"mapValue"in t?Y2(t)?{mapValue:{}}:mA:mr()}function qk(t,e){const r=zA(t.value,e.value);return r!==0?r:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function Wk(t,e){const r=zA(t.value,e.value);return r!==0?r:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ei{constructor(e){this.value=e}static empty(){return new Ei({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let s=0;s<e.length-1;++s)if(r=(r.mapValue.fields||{})[e.get(s)],!Eb(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=ix(r)}setAll(e){let r=jn.emptyPath(),s={},n=[];e.forEach((o,l)=>{if(!r.isImmediateParentOf(l)){const c=this.getFieldsMap(r);this.applyChanges(c,s,n),s={},n=[],r=l.popLast()}o?s[l.lastSegment()]=ix(o):n.push(l.lastSegment())});const i=this.getFieldsMap(r);this.applyChanges(i,s,n)}delete(e){const r=this.field(e.popLast());Eb(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return td(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let s=0;s<e.length;++s){let n=r.mapValue.fields[e.get(s)];Eb(n)&&n.mapValue.fields||(n={mapValue:{fields:{}}},r.mapValue.fields[e.get(s)]=n),r=n}return r.mapValue.fields}applyChanges(e,r,s){Xf(r,(n,i)=>e[n]=i);for(const n of s)delete e[n]}clone(){return new Ei(ix(this.value))}}function hO(t){const e=[];return Xf(t.fields,(r,s)=>{const n=new jn([r]);if(Eb(s)){const i=hO(s.mapValue).fields;if(i.length===0)e.push(n);else for(const o of i)e.push(n.child(o))}else e.push(n)}),new yo(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ln{constructor(e,r,s,n,i,o,l){this.key=e,this.documentType=r,this.version=s,this.readTime=n,this.createTime=i,this.data=o,this.documentState=l}static newInvalidDocument(e){return new Ln(e,0,Sr.min(),Sr.min(),Sr.min(),Ei.empty(),0)}static newFoundDocument(e,r,s,n){return new Ln(e,1,r,Sr.min(),s,n,0)}static newNoDocument(e,r){return new Ln(e,2,r,Sr.min(),Sr.min(),Ei.empty(),0)}static newUnknownDocument(e,r){return new Ln(e,3,r,Sr.min(),Sr.min(),Ei.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(Sr.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ei.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ei.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Sr.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Ln&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ln(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qA{constructor(e,r){this.position=e,this.inclusive=r}}function Gk(t,e,r){let s=0;for(let n=0;n<t.position.length;n++){const i=e[n],o=t.position[n];if(i.field.isKeyField()?s=nr.comparator(nr.fromName(o.referenceValue),r.key):s=zA(o,r.data.field(i.field)),i.dir==="desc"&&(s*=-1),s!==0)break}return s}function Yk(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!td(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iy{constructor(e,r="asc"){this.field=e,this.dir=r}}function BJ(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let fO=class{};class ds extends fO{constructor(e,r,s){super(),this.field=e,this.op=r,this.value=s}static create(e,r,s){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,s):new FJ(e,r,s):r==="array-contains"?new RJ(e,s):r==="in"?new vO(e,s):r==="not-in"?new LJ(e,s):r==="array-contains-any"?new OJ(e,s):new ds(e,r,s)}static createKeyFieldInFilter(e,r,s){return r==="in"?new PJ(e,s):new DJ(e,s)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&this.matchesComparison(zA(r,this.value)):r!==null&&Bf(this.value)===Bf(r)&&this.matchesComparison(zA(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return mr()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Rs extends fO{constructor(e,r){super(),this.filters=e,this.op=r,this.ae=null}static create(e,r){return new Rs(e,r)}matches(e){return sp(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function sp(t){return t.op==="and"}function hj(t){return t.op==="or"}function o3(t){return mO(t)&&sp(t)}function mO(t){for(const e of t.filters)if(e instanceof Rs)return!1;return!0}function fj(t){if(t instanceof ds)return t.field.canonicalString()+t.op.toString()+rp(t.value);if(o3(t))return t.filters.map(e=>fj(e)).join(",");{const e=t.filters.map(r=>fj(r)).join(",");return`${t.op}(${e})`}}function pO(t,e){return t instanceof ds?function(s,n){return n instanceof ds&&s.op===n.op&&s.field.isEqual(n.field)&&td(s.value,n.value)}(t,e):t instanceof Rs?function(s,n){return n instanceof Rs&&s.op===n.op&&s.filters.length===n.filters.length?s.filters.reduce((i,o,l)=>i&&pO(o,n.filters[l]),!0):!1}(t,e):void mr()}function gO(t,e){const r=t.filters.concat(e);return Rs.create(r,t.op)}function xO(t){return t instanceof ds?function(r){return`${r.field.canonicalString()} ${r.op} ${rp(r.value)}`}(t):t instanceof Rs?function(r){return r.op.toString()+" {"+r.getFilters().map(xO).join(" ,")+"}"}(t):"Filter"}class FJ extends ds{constructor(e,r,s){super(e,r,s),this.key=nr.fromName(s.referenceValue)}matches(e){const r=nr.comparator(e.key,this.key);return this.matchesComparison(r)}}class PJ extends ds{constructor(e,r){super(e,"in",r),this.keys=yO("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class DJ extends ds{constructor(e,r){super(e,"not-in",r),this.keys=yO("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function yO(t,e){var r;return(((r=e.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(s=>nr.fromName(s.referenceValue))}class RJ extends ds{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return ay(r)&&ny(r.arrayValue,this.value)}}class vO extends ds{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&ny(this.value.arrayValue,r)}}class LJ extends ds{constructor(e,r){super(e,"not-in",r)}matches(e){if(ny(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&!ny(this.value.arrayValue,r)}}class OJ extends ds{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!ay(r)||!r.arrayValue.values)&&r.arrayValue.values.some(s=>ny(this.value.arrayValue,s))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UJ{constructor(e,r=null,s=[],n=[],i=null,o=null,l=null){this.path=e,this.collectionGroup=r,this.orderBy=s,this.filters=n,this.limit=i,this.startAt=o,this.endAt=l,this.ue=null}}function mj(t,e=null,r=[],s=[],n=null,i=null,o=null){return new UJ(t,e,r,s,n,i,o)}function Pf(t){const e=pr(t);if(e.ue===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(s=>fj(s)).join(","),r+="|ob:",r+=e.orderBy.map(s=>function(i){return i.field.canonicalString()+i.dir}(s)).join(","),W2(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(s=>rp(s)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(s=>rp(s)).join(",")),e.ue=r}return e.ue}function Qy(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!BJ(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!pO(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Yk(t.startAt,e.startAt)&&Yk(t.endAt,e.endAt)}function Cw(t){return nr.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function jw(t,e){return t.filters.filter(r=>r instanceof ds&&r.field.isEqual(e))}function Xk(t,e,r){let s=Sb,n=!0;for(const i of jw(t,e)){let o=Sb,l=!0;switch(i.op){case"<":case"<=":o=IJ(i.value);break;case"==":case"in":case">=":o=i.value;break;case">":o=i.value,l=!1;break;case"!=":case"not-in":o=Sb}qk({value:s,inclusive:n},{value:o,inclusive:l})<0&&(s=o,n=l)}if(r!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=r.position[i];qk({value:s,inclusive:n},{value:o,inclusive:r.inclusive})<0&&(s=o,n=r.inclusive);break}}return{value:s,inclusive:n}}function Jk(t,e,r){let s=mA,n=!0;for(const i of jw(t,e)){let o=mA,l=!0;switch(i.op){case">=":case">":o=kJ(i.value),l=!1;break;case"==":case"in":case"<=":o=i.value;break;case"<":o=i.value,l=!1;break;case"!=":case"not-in":o=mA}Wk({value:s,inclusive:n},{value:o,inclusive:l})>0&&(s=o,n=l)}if(r!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=r.position[i];Wk({value:s,inclusive:n},{value:o,inclusive:r.inclusive})>0&&(s=o,n=r.inclusive);break}}return{value:s,inclusive:n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jf{constructor(e,r=null,s=[],n=[],i=null,o="F",l=null,c=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=s,this.filters=n,this.limit=i,this.limitType=o,this.startAt=l,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function bO(t,e,r,s,n,i,o,l){return new Jf(t,e,r,s,n,i,o,l)}function Vy(t){return new Jf(t)}function Zk(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function l3(t){return t.collectionGroup!==null}function F0(t){const e=pr(t);if(e.ce===null){e.ce=[];const r=new Set;for(const i of e.explicitOrderBy)e.ce.push(i),r.add(i.field.canonicalString());const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new zs(jn.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(d=>{d.isInequality()&&(l=l.add(d.field))})}),l})(e).forEach(i=>{r.has(i.canonicalString())||i.isKeyField()||e.ce.push(new iy(i,s))}),r.has(jn.keyField().canonicalString())||e.ce.push(new iy(jn.keyField(),s))}return e.ce}function Wo(t){const e=pr(t);return e.le||(e.le=MJ(e,F0(t))),e.le}function MJ(t,e){if(t.limitType==="F")return mj(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(n=>{const i=n.dir==="desc"?"asc":"desc";return new iy(n.field,i)});const r=t.endAt?new qA(t.endAt.position,t.endAt.inclusive):null,s=t.startAt?new qA(t.startAt.position,t.startAt.inclusive):null;return mj(t.path,t.collectionGroup,e,t.filters,t.limit,r,s)}}function pj(t,e){const r=t.filters.concat([e]);return new Jf(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function Sw(t,e,r){return new Jf(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function X2(t,e){return Qy(Wo(t),Wo(e))&&t.limitType===e.limitType}function wO(t){return`${Pf(Wo(t))}|lt:${t.limitType}`}function Gm(t){return`Query(target=${function(r){let s=r.path.canonicalString();return r.collectionGroup!==null&&(s+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(s+=`, filters: [${r.filters.map(n=>xO(n)).join(", ")}]`),W2(r.limit)||(s+=", limit: "+r.limit),r.orderBy.length>0&&(s+=`, orderBy: [${r.orderBy.map(n=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(n)).join(", ")}]`),r.startAt&&(s+=", startAt: ",s+=r.startAt.inclusive?"b:":"a:",s+=r.startAt.position.map(n=>rp(n)).join(",")),r.endAt&&(s+=", endAt: ",s+=r.endAt.inclusive?"a:":"b:",s+=r.endAt.position.map(n=>rp(n)).join(",")),`Target(${s})`}(Wo(t))}; limitType=${t.limitType})`}function Hy(t,e){return e.isFoundDocument()&&function(s,n){const i=n.key.path;return s.collectionGroup!==null?n.key.hasCollectionId(s.collectionGroup)&&s.path.isPrefixOf(i):nr.isDocumentKey(s.path)?s.path.isEqual(i):s.path.isImmediateParentOf(i)}(t,e)&&function(s,n){for(const i of F0(s))if(!i.field.isKeyField()&&n.data.field(i.field)===null)return!1;return!0}(t,e)&&function(s,n){for(const i of s.filters)if(!i.matches(n))return!1;return!0}(t,e)&&function(s,n){return!(s.startAt&&!function(o,l,c){const d=Gk(o,l,c);return o.inclusive?d<=0:d<0}(s.startAt,F0(s),n)||s.endAt&&!function(o,l,c){const d=Gk(o,l,c);return o.inclusive?d>=0:d>0}(s.endAt,F0(s),n))}(t,e)}function NO(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function CO(t){return(e,r)=>{let s=!1;for(const n of F0(t)){const i=QJ(n,e,r);if(i!==0)return i;s=s||n.field.isKeyField()}return 0}}function QJ(t,e,r){const s=t.field.isKeyField()?nr.comparator(e.key,r.key):function(i,o,l){const c=o.data.field(i),d=l.data.field(i);return c!==null&&d!==null?zA(c,d):mr()}(t.field,e,r);switch(t.dir){case"asc":return s;case"desc":return-1*s;default:return mr()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fh{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),s=this.inner[r];if(s!==void 0){for(const[n,i]of s)if(this.equalsFn(n,e))return i}}has(e){return this.get(e)!==void 0}set(e,r){const s=this.mapKeyFn(e),n=this.inner[s];if(n===void 0)return this.inner[s]=[[e,r]],void this.innerSize++;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return void(n[i]=[e,r]);n.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return!1;for(let n=0;n<s.length;n++)if(this.equalsFn(s[n][0],e))return s.length===1?delete this.inner[r]:s.splice(n,1),this.innerSize--,!0;return!1}forEach(e){Xf(this.inner,(r,s)=>{for(const[n,i]of s)e(n,i)})}isEmpty(){return cO(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VJ=new an(nr.comparator);function Ko(){return VJ}const jO=new an(nr.comparator);function Pg(...t){let e=jO;for(const r of t)e=e.insert(r.key,r);return e}function SO(t){let e=jO;return t.forEach((r,s)=>e=e.insert(r,s.overlayedDocument)),e}function Vc(){return ox()}function EO(){return ox()}function ox(){return new fh(t=>t.toString(),(t,e)=>t.isEqual(e))}const HJ=new an(nr.comparator),$J=new zs(nr.comparator);function es(...t){let e=$J;for(const r of t)e=e.add(r);return e}const KJ=new zs($r);function c3(){return KJ}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d3(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ry(e)?"-0":e}}function _O(t){return{integerValue:""+t}}function TO(t,e){return nO(e)?_O(e):d3(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J2{constructor(){this._=void 0}}function zJ(t,e,r){return t instanceof np?function(n,i){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:n.seconds,nanos:n.nanoseconds}}}};return i&&G2(i)&&(i=i3(i)),i&&(o.fields.__previous_value__=i),{mapValue:o}}(r,e):t instanceof ap?kO(t,e):t instanceof ip?BO(t,e):function(n,i){const o=IO(n,i),l=e6(o)+e6(n.Pe);return Aj(o)&&Aj(n.Pe)?_O(l):d3(n.serializer,l)}(t,e)}function qJ(t,e,r){return t instanceof ap?kO(t,e):t instanceof ip?BO(t,e):r}function IO(t,e){return t instanceof op?function(s){return Aj(s)||function(i){return!!i&&"doubleValue"in i}(s)}(e)?e:{integerValue:0}:null}class np extends J2{}class ap extends J2{constructor(e){super(),this.elements=e}}function kO(t,e){const r=FO(e);for(const s of t.elements)r.some(n=>td(n,s))||r.push(s);return{arrayValue:{values:r}}}class ip extends J2{constructor(e){super(),this.elements=e}}function BO(t,e){let r=FO(e);for(const s of t.elements)r=r.filter(n=>!td(n,s));return{arrayValue:{values:r}}}class op extends J2{constructor(e,r){super(),this.serializer=e,this.Pe=r}}function e6(t){return vn(t.integerValue||t.doubleValue)}function FO(t){return ay(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u3{constructor(e,r){this.field=e,this.transform=r}}function WJ(t,e){return t.field.isEqual(e.field)&&function(s,n){return s instanceof ap&&n instanceof ap||s instanceof ip&&n instanceof ip?tp(s.elements,n.elements,td):s instanceof op&&n instanceof op?td(s.Pe,n.Pe):s instanceof np&&n instanceof np}(t.transform,e.transform)}class GJ{constructor(e,r){this.version=e,this.transformResults=r}}class ja{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new ja}static exists(e){return new ja(void 0,e)}static updateTime(e){return new ja(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function _b(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Z2{}function PO(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new $y(t.key,ja.none()):new Bp(t.key,t.data,ja.none());{const r=t.data,s=Ei.empty();let n=new zs(jn.comparator);for(let i of e.fields)if(!n.has(i)){let o=r.field(i);o===null&&i.length>1&&(i=i.popLast(),o=r.field(i)),o===null?s.delete(i):s.set(i,o),n=n.add(i)}return new hu(t.key,s,new yo(n.toArray()),ja.none())}}function YJ(t,e,r){t instanceof Bp?function(n,i,o){const l=n.value.clone(),c=r6(n.fieldTransforms,i,o.transformResults);l.setAll(c),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,r):t instanceof hu?function(n,i,o){if(!_b(n.precondition,i))return void i.convertToUnknownDocument(o.version);const l=r6(n.fieldTransforms,i,o.transformResults),c=i.data;c.setAll(DO(n)),c.setAll(l),i.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,r):function(n,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,r)}function lx(t,e,r,s){return t instanceof Bp?function(i,o,l,c){if(!_b(i.precondition,o))return l;const d=i.value.clone(),u=s6(i.fieldTransforms,c,o);return d.setAll(u),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null}(t,e,r,s):t instanceof hu?function(i,o,l,c){if(!_b(i.precondition,o))return l;const d=s6(i.fieldTransforms,c,o),u=o.data;return u.setAll(DO(i)),u.setAll(d),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),l===null?null:l.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(A=>A.field))}(t,e,r,s):function(i,o,l){return _b(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(t,e,r)}function XJ(t,e){let r=null;for(const s of t.fieldTransforms){const n=e.data.field(s.field),i=IO(s.transform,n||null);i!=null&&(r===null&&(r=Ei.empty()),r.set(s.field,i))}return r||null}function t6(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(s,n){return s===void 0&&n===void 0||!(!s||!n)&&tp(s,n,(i,o)=>WJ(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Bp extends Z2{constructor(e,r,s,n=[]){super(),this.key=e,this.value=r,this.precondition=s,this.fieldTransforms=n,this.type=0}getFieldMask(){return null}}class hu extends Z2{constructor(e,r,s,n,i=[]){super(),this.key=e,this.data=r,this.fieldMask=s,this.precondition=n,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function DO(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const s=t.data.field(r);e.set(r,s)}}),e}function r6(t,e,r){const s=new Map;br(t.length===r.length);for(let n=0;n<r.length;n++){const i=t[n],o=i.transform,l=e.data.field(i.field);s.set(i.field,qJ(o,l,r[n]))}return s}function s6(t,e,r){const s=new Map;for(const n of t){const i=n.transform,o=r.data.field(n.field);s.set(n.field,zJ(i,o,e))}return s}class $y extends Z2{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class RO extends Z2{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A3{constructor(e,r,s,n){this.batchId=e,this.localWriteTime=r,this.baseMutations=s,this.mutations=n}applyToRemoteDocument(e,r){const s=r.mutationResults;for(let n=0;n<this.mutations.length;n++){const i=this.mutations[n];i.key.isEqual(e.key)&&YJ(i,e,s[n])}}applyToLocalView(e,r){for(const s of this.baseMutations)s.key.isEqual(e.key)&&(r=lx(s,e,r,this.localWriteTime));for(const s of this.mutations)s.key.isEqual(e.key)&&(r=lx(s,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const s=EO();return this.mutations.forEach(n=>{const i=e.get(n.key),o=i.overlayedDocument;let l=this.applyToLocalView(o,i.mutatedFields);l=r.has(n.key)?null:l;const c=PO(o,l);c!==null&&s.set(n.key,c),o.isValidDocument()||o.convertToNoDocument(Sr.min())}),s}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),es())}isEqual(e){return this.batchId===e.batchId&&tp(this.mutations,e.mutations,(r,s)=>t6(r,s))&&tp(this.baseMutations,e.baseMutations,(r,s)=>t6(r,s))}}class h3{constructor(e,r,s,n){this.batch=e,this.commitVersion=r,this.mutationResults=s,this.docVersions=n}static from(e,r,s){br(e.mutations.length===s.length);let n=function(){return HJ}();const i=e.mutations;for(let o=0;o<i.length;o++)n=n.insert(i[o].key,s[o].version);return new h3(e,r,s,n)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f3{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JJ{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ua,gs;function ZJ(t){switch(t){default:return mr();case Tt.CANCELLED:case Tt.UNKNOWN:case Tt.DEADLINE_EXCEEDED:case Tt.RESOURCE_EXHAUSTED:case Tt.INTERNAL:case Tt.UNAVAILABLE:case Tt.UNAUTHENTICATED:return!1;case Tt.INVALID_ARGUMENT:case Tt.NOT_FOUND:case Tt.ALREADY_EXISTS:case Tt.PERMISSION_DENIED:case Tt.FAILED_PRECONDITION:case Tt.ABORTED:case Tt.OUT_OF_RANGE:case Tt.UNIMPLEMENTED:case Tt.DATA_LOSS:return!0}}function LO(t){if(t===void 0)return ea("GRPC error has no .code"),Tt.UNKNOWN;switch(t){case ua.OK:return Tt.OK;case ua.CANCELLED:return Tt.CANCELLED;case ua.UNKNOWN:return Tt.UNKNOWN;case ua.DEADLINE_EXCEEDED:return Tt.DEADLINE_EXCEEDED;case ua.RESOURCE_EXHAUSTED:return Tt.RESOURCE_EXHAUSTED;case ua.INTERNAL:return Tt.INTERNAL;case ua.UNAVAILABLE:return Tt.UNAVAILABLE;case ua.UNAUTHENTICATED:return Tt.UNAUTHENTICATED;case ua.INVALID_ARGUMENT:return Tt.INVALID_ARGUMENT;case ua.NOT_FOUND:return Tt.NOT_FOUND;case ua.ALREADY_EXISTS:return Tt.ALREADY_EXISTS;case ua.PERMISSION_DENIED:return Tt.PERMISSION_DENIED;case ua.FAILED_PRECONDITION:return Tt.FAILED_PRECONDITION;case ua.ABORTED:return Tt.ABORTED;case ua.OUT_OF_RANGE:return Tt.OUT_OF_RANGE;case ua.UNIMPLEMENTED:return Tt.UNIMPLEMENTED;case ua.DATA_LOSS:return Tt.DATA_LOSS;default:return mr()}}(gs=ua||(ua={}))[gs.OK=0]="OK",gs[gs.CANCELLED=1]="CANCELLED",gs[gs.UNKNOWN=2]="UNKNOWN",gs[gs.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",gs[gs.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",gs[gs.NOT_FOUND=5]="NOT_FOUND",gs[gs.ALREADY_EXISTS=6]="ALREADY_EXISTS",gs[gs.PERMISSION_DENIED=7]="PERMISSION_DENIED",gs[gs.UNAUTHENTICATED=16]="UNAUTHENTICATED",gs[gs.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",gs[gs.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",gs[gs.ABORTED=10]="ABORTED",gs[gs.OUT_OF_RANGE=11]="OUT_OF_RANGE",gs[gs.UNIMPLEMENTED=12]="UNIMPLEMENTED",gs[gs.INTERNAL=13]="INTERNAL",gs[gs.UNAVAILABLE=14]="UNAVAILABLE",gs[gs.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eZ(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tZ=new uf([4294967295,4294967295],0);function n6(t){const e=eZ().encode(t),r=new $L;return r.update(e),new Uint8Array(r.digest())}function a6(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),s=e.getUint32(4,!0),n=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new uf([r,s],0),new uf([n,i],0)]}class m3{constructor(e,r,s){if(this.bitmap=e,this.padding=r,this.hashCount=s,r<0||r>=8)throw new Dg(`Invalid padding: ${r}`);if(s<0)throw new Dg(`Invalid hash count: ${s}`);if(e.length>0&&this.hashCount===0)throw new Dg(`Invalid hash count: ${s}`);if(e.length===0&&r!==0)throw new Dg(`Invalid padding when bitmap length is 0: ${r}`);this.Ie=8*e.length-r,this.Te=uf.fromNumber(this.Ie)}Ee(e,r,s){let n=e.add(r.multiply(uf.fromNumber(s)));return n.compare(tZ)===1&&(n=new uf([n.getBits(0),n.getBits(1)],0)),n.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const r=n6(e),[s,n]=a6(r);for(let i=0;i<this.hashCount;i++){const o=this.Ee(s,n,i);if(!this.de(o))return!1}return!0}static create(e,r,s){const n=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new m3(i,n,r);return s.forEach(l=>o.insert(l)),o}insert(e){if(this.Ie===0)return;const r=n6(e),[s,n]=a6(r);for(let i=0;i<this.hashCount;i++){const o=this.Ee(s,n,i);this.Ae(o)}}Ae(e){const r=Math.floor(e/8),s=e%8;this.bitmap[r]|=1<<s}}class Dg extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ky{constructor(e,r,s,n,i){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=s,this.documentUpdates=n,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,r,s){const n=new Map;return n.set(e,zy.createSynthesizedTargetChangeForCurrentChange(e,r,s)),new Ky(Sr.min(),n,new an($r),Ko(),es())}}class zy{constructor(e,r,s,n,i){this.resumeToken=e,this.current=r,this.addedDocuments=s,this.modifiedDocuments=n,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,r,s){return new zy(s,r,es(),es(),es())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tb{constructor(e,r,s,n){this.Re=e,this.removedTargetIds=r,this.key=s,this.Ve=n}}class OO{constructor(e,r){this.targetId=e,this.me=r}}class UO{constructor(e,r,s=aa.EMPTY_BYTE_STRING,n=null){this.state=e,this.targetIds=r,this.resumeToken=s,this.cause=n}}class i6{constructor(){this.fe=0,this.ge=l6(),this.pe=aa.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=es(),r=es(),s=es();return this.ge.forEach((n,i)=>{switch(i){case 0:e=e.add(n);break;case 2:r=r.add(n);break;case 1:s=s.add(n);break;default:mr()}}),new zy(this.pe,this.ye,e,r,s)}Ce(){this.we=!1,this.ge=l6()}Fe(e,r){this.we=!0,this.ge=this.ge.insert(e,r)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,br(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class rZ{constructor(e){this.Le=e,this.Be=new Map,this.ke=Ko(),this.qe=o6(),this.Qe=new an($r)}Ke(e){for(const r of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(r,e.Ve):this.Ue(r,e.key,e.Ve);for(const r of e.removedTargetIds)this.Ue(r,e.key,e.Ve)}We(e){this.forEachTarget(e,r=>{const s=this.Ge(r);switch(e.state){case 0:this.ze(r)&&s.De(e.resumeToken);break;case 1:s.Oe(),s.Se||s.Ce(),s.De(e.resumeToken);break;case 2:s.Oe(),s.Se||this.removeTarget(r);break;case 3:this.ze(r)&&(s.Ne(),s.De(e.resumeToken));break;case 4:this.ze(r)&&(this.je(r),s.De(e.resumeToken));break;default:mr()}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.Be.forEach((s,n)=>{this.ze(n)&&r(n)})}He(e){const r=e.targetId,s=e.me.count,n=this.Je(r);if(n){const i=n.target;if(Cw(i))if(s===0){const o=new nr(i.path);this.Ue(r,o,Ln.newNoDocument(o,Sr.min()))}else br(s===1);else{const o=this.Ye(r);if(o!==s){const l=this.Ze(e),c=l?this.Xe(l,e,o):1;if(c!==0){this.je(r);const d=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(r,d)}}}}}Ze(e){const r=e.me.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:s="",padding:n=0},hashCount:i=0}=r;let o,l;try{o=KA(s).toUint8Array()}catch(c){if(c instanceof dO)return If("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{l=new m3(o,n,i)}catch(c){return If(c instanceof Dg?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return l.Ie===0?null:l}Xe(e,r,s){return r.me.count===s-this.nt(e,r.targetId)?0:2}nt(e,r){const s=this.Le.getRemoteKeysForTarget(r);let n=0;return s.forEach(i=>{const o=this.Le.tt(),l=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(l)||(this.Ue(r,i,null),n++)}),n}rt(e){const r=new Map;this.Be.forEach((i,o)=>{const l=this.Je(o);if(l){if(i.current&&Cw(l.target)){const c=new nr(l.target.path);this.ke.get(c)!==null||this.it(o,c)||this.Ue(o,c,Ln.newNoDocument(c,e))}i.be&&(r.set(o,i.ve()),i.Ce())}});let s=es();this.qe.forEach((i,o)=>{let l=!0;o.forEachWhile(c=>{const d=this.Je(c);return!d||d.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(s=s.add(i))}),this.ke.forEach((i,o)=>o.setReadTime(e));const n=new Ky(e,r,this.Qe,this.ke,s);return this.ke=Ko(),this.qe=o6(),this.Qe=new an($r),n}$e(e,r){if(!this.ze(e))return;const s=this.it(e,r.key)?2:0;this.Ge(e).Fe(r.key,s),this.ke=this.ke.insert(r.key,r),this.qe=this.qe.insert(r.key,this.st(r.key).add(e))}Ue(e,r,s){if(!this.ze(e))return;const n=this.Ge(e);this.it(e,r)?n.Fe(r,1):n.Me(r),this.qe=this.qe.insert(r,this.st(r).delete(e)),s&&(this.ke=this.ke.insert(r,s))}removeTarget(e){this.Be.delete(e)}Ye(e){const r=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let r=this.Be.get(e);return r||(r=new i6,this.Be.set(e,r)),r}st(e){let r=this.qe.get(e);return r||(r=new zs($r),this.qe=this.qe.insert(e,r)),r}ze(e){const r=this.Je(e)!==null;return r||qt("WatchChangeAggregator","Detected inactive target",e),r}Je(e){const r=this.Be.get(e);return r&&r.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new i6),this.Le.getRemoteKeysForTarget(e).forEach(r=>{this.Ue(e,r,null)})}it(e,r){return this.Le.getRemoteKeysForTarget(e).has(r)}}function o6(){return new an(nr.comparator)}function l6(){return new an(nr.comparator)}const sZ={asc:"ASCENDING",desc:"DESCENDING"},nZ={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},aZ={and:"AND",or:"OR"};class iZ{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function gj(t,e){return t.useProto3Json||W2(e)?e:{value:e}}function lp(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function MO(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function oZ(t,e){return lp(t,e.toTimestamp())}function Ji(t){return br(!!t),Sr.fromTimestamp(function(r){const s=su(r);return new wt(s.seconds,s.nanos)}(t))}function p3(t,e){return xj(t,e).canonicalString()}function xj(t,e){const r=function(n){return new Cs(["projects",n.projectId,"databases",n.database])}(t).child("documents");return e===void 0?r:r.child(e)}function QO(t){const e=Cs.fromString(t);return br(YO(e)),e}function Ew(t,e){return p3(t.databaseId,e.path)}function Af(t,e){const r=QO(e);if(r.get(1)!==t.databaseId.projectId)throw new Gt(Tt.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new Gt(Tt.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new nr($O(r))}function VO(t,e){return p3(t.databaseId,e)}function HO(t){const e=QO(t);return e.length===4?Cs.emptyPath():$O(e)}function yj(t){return new Cs(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function $O(t){return br(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function c6(t,e,r){return{name:Ew(t,e),fields:r.value.mapValue.fields}}function lZ(t,e,r){const s=Af(t,e.name),n=Ji(e.updateTime),i=e.createTime?Ji(e.createTime):Sr.min(),o=new Ei({mapValue:{fields:e.fields}}),l=Ln.newFoundDocument(s,n,i,o);return r&&l.setHasCommittedMutations(),r?l.setHasCommittedMutations():l}function cZ(t,e){let r;if("targetChange"in e){e.targetChange;const s=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:mr()}(e.targetChange.targetChangeType||"NO_CHANGE"),n=e.targetChange.targetIds||[],i=function(d,u){return d.useProto3Json?(br(u===void 0||typeof u=="string"),aa.fromBase64String(u||"")):(br(u===void 0||u instanceof Buffer||u instanceof Uint8Array),aa.fromUint8Array(u||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(d){const u=d.code===void 0?Tt.UNKNOWN:LO(d.code);return new Gt(u,d.message||"")}(o);r=new UO(s,n,i,l||null)}else if("documentChange"in e){e.documentChange;const s=e.documentChange;s.document,s.document.name,s.document.updateTime;const n=Af(t,s.document.name),i=Ji(s.document.updateTime),o=s.document.createTime?Ji(s.document.createTime):Sr.min(),l=new Ei({mapValue:{fields:s.document.fields}}),c=Ln.newFoundDocument(n,i,o,l),d=s.targetIds||[],u=s.removedTargetIds||[];r=new Tb(d,u,c.key,c)}else if("documentDelete"in e){e.documentDelete;const s=e.documentDelete;s.document;const n=Af(t,s.document),i=s.readTime?Ji(s.readTime):Sr.min(),o=Ln.newNoDocument(n,i),l=s.removedTargetIds||[];r=new Tb([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const s=e.documentRemove;s.document;const n=Af(t,s.document),i=s.removedTargetIds||[];r=new Tb([],i,n,null)}else{if(!("filter"in e))return mr();{e.filter;const s=e.filter;s.targetId;const{count:n=0,unchangedNames:i}=s,o=new JJ(n,i),l=s.targetId;r=new OO(l,o)}}return r}function _w(t,e){let r;if(e instanceof Bp)r={update:c6(t,e.key,e.value)};else if(e instanceof $y)r={delete:Ew(t,e.key)};else if(e instanceof hu)r={update:c6(t,e.key,e.data),updateMask:mZ(e.fieldMask)};else{if(!(e instanceof RO))return mr();r={verify:Ew(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(s=>function(i,o){const l=o.transform;if(l instanceof np)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof ap)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof ip)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof op)return{fieldPath:o.field.canonicalString(),increment:l.Pe};throw mr()}(0,s))),e.precondition.isNone||(r.currentDocument=function(n,i){return i.updateTime!==void 0?{updateTime:oZ(n,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:mr()}(t,e.precondition)),r}function vj(t,e){const r=e.currentDocument?function(i){return i.updateTime!==void 0?ja.updateTime(Ji(i.updateTime)):i.exists!==void 0?ja.exists(i.exists):ja.none()}(e.currentDocument):ja.none(),s=e.updateTransforms?e.updateTransforms.map(n=>function(o,l){let c=null;if("setToServerValue"in l)br(l.setToServerValue==="REQUEST_TIME"),c=new np;else if("appendMissingElements"in l){const u=l.appendMissingElements.values||[];c=new ap(u)}else if("removeAllFromArray"in l){const u=l.removeAllFromArray.values||[];c=new ip(u)}else"increment"in l?c=new op(o,l.increment):mr();const d=jn.fromServerFormat(l.fieldPath);return new u3(d,c)}(t,n)):[];if(e.update){e.update.name;const n=Af(t,e.update.name),i=new Ei({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(c){const d=c.fieldPaths||[];return new yo(d.map(u=>jn.fromServerFormat(u)))}(e.updateMask);return new hu(n,i,o,r,s)}return new Bp(n,i,r,s)}if(e.delete){const n=Af(t,e.delete);return new $y(n,r)}if(e.verify){const n=Af(t,e.verify);return new RO(n,r)}return mr()}function dZ(t,e){return t&&t.length>0?(br(e!==void 0),t.map(r=>function(n,i){let o=n.updateTime?Ji(n.updateTime):Ji(i);return o.isEqual(Sr.min())&&(o=Ji(i)),new GJ(o,n.transformResults||[])}(r,e))):[]}function KO(t,e){return{documents:[VO(t,e.path)]}}function zO(t,e){const r={structuredQuery:{}},s=e.path;let n;e.collectionGroup!==null?(n=s,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n=s.popLast(),r.structuredQuery.from=[{collectionId:s.lastSegment()}]),r.parent=VO(t,n);const i=function(d){if(d.length!==0)return GO(Rs.create(d,"and"))}(e.filters);i&&(r.structuredQuery.where=i);const o=function(d){if(d.length!==0)return d.map(u=>function(h){return{field:Ym(h.field),direction:AZ(h.dir)}}(u))}(e.orderBy);o&&(r.structuredQuery.orderBy=o);const l=gj(t,e.limit);return l!==null&&(r.structuredQuery.limit=l),e.startAt&&(r.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{_t:r,parent:n}}function qO(t){let e=HO(t.parent);const r=t.structuredQuery,s=r.from?r.from.length:0;let n=null;if(s>0){br(s===1);const u=r.from[0];u.allDescendants?n=u.collectionId:e=e.child(u.collectionId)}let i=[];r.where&&(i=function(A){const h=WO(A);return h instanceof Rs&&o3(h)?h.getFilters():[h]}(r.where));let o=[];r.orderBy&&(o=function(A){return A.map(h=>function(p){return new iy(Xm(p.field),function(g){switch(g){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(p.direction))}(h))}(r.orderBy));let l=null;r.limit&&(l=function(A){let h;return h=typeof A=="object"?A.value:A,W2(h)?null:h}(r.limit));let c=null;r.startAt&&(c=function(A){const h=!!A.before,f=A.values||[];return new qA(f,h)}(r.startAt));let d=null;return r.endAt&&(d=function(A){const h=!A.before,f=A.values||[];return new qA(f,h)}(r.endAt)),bO(e,n,o,i,l,"F",c,d)}function uZ(t,e){const r=function(n){switch(n){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return mr()}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function WO(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const s=Xm(r.unaryFilter.field);return ds.create(s,"==",{doubleValue:NaN});case"IS_NULL":const n=Xm(r.unaryFilter.field);return ds.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Xm(r.unaryFilter.field);return ds.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Xm(r.unaryFilter.field);return ds.create(o,"!=",{nullValue:"NULL_VALUE"});default:return mr()}}(t):t.fieldFilter!==void 0?function(r){return ds.create(Xm(r.fieldFilter.field),function(n){switch(n){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return mr()}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return Rs.create(r.compositeFilter.filters.map(s=>WO(s)),function(n){switch(n){case"AND":return"and";case"OR":return"or";default:return mr()}}(r.compositeFilter.op))}(t):mr()}function AZ(t){return sZ[t]}function hZ(t){return nZ[t]}function fZ(t){return aZ[t]}function Ym(t){return{fieldPath:t.canonicalString()}}function Xm(t){return jn.fromServerFormat(t.fieldPath)}function GO(t){return t instanceof ds?function(r){if(r.op==="=="){if(zk(r.value))return{unaryFilter:{field:Ym(r.field),op:"IS_NAN"}};if(Kk(r.value))return{unaryFilter:{field:Ym(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(zk(r.value))return{unaryFilter:{field:Ym(r.field),op:"IS_NOT_NAN"}};if(Kk(r.value))return{unaryFilter:{field:Ym(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ym(r.field),op:hZ(r.op),value:r.value}}}(t):t instanceof Rs?function(r){const s=r.getFilters().map(n=>GO(n));return s.length===1?s[0]:{compositeFilter:{op:fZ(r.op),filters:s}}}(t):mr()}function mZ(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function YO(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Md{constructor(e,r,s,n,i=Sr.min(),o=Sr.min(),l=aa.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=r,this.purpose=s,this.sequenceNumber=n,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=c}withSequenceNumber(e){return new Md(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new Md(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Md(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Md(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XO{constructor(e){this.ct=e}}function pZ(t,e){let r;if(e.document)r=lZ(t.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const s=nr.fromSegments(e.noDocument.path),n=Rf(e.noDocument.readTime);r=Ln.newNoDocument(s,n),e.hasCommittedMutations&&r.setHasCommittedMutations()}else{if(!e.unknownDocument)return mr();{const s=nr.fromSegments(e.unknownDocument.path),n=Rf(e.unknownDocument.version);r=Ln.newUnknownDocument(s,n)}}return e.readTime&&r.setReadTime(function(n){const i=new wt(n[0],n[1]);return Sr.fromTimestamp(i)}(e.readTime)),r}function d6(t,e){const r=e.key,s={prefixPath:r.getCollectionPath().popLast().toArray(),collectionGroup:r.collectionGroup,documentId:r.path.lastSegment(),readTime:Tw(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())s.document=function(i,o){return{name:Ew(i,o.key),fields:o.data.value.mapValue.fields,updateTime:lp(i,o.version.toTimestamp()),createTime:lp(i,o.createTime.toTimestamp())}}(t.ct,e);else if(e.isNoDocument())s.noDocument={path:r.path.toArray(),readTime:Df(e.version)};else{if(!e.isUnknownDocument())return mr();s.unknownDocument={path:r.path.toArray(),version:Df(e.version)}}return s}function Tw(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function Df(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Rf(t){const e=new wt(t.seconds,t.nanoseconds);return Sr.fromTimestamp(e)}function Hh(t,e){const r=(e.baseMutations||[]).map(i=>vj(t.ct,i));for(let i=0;i<e.mutations.length-1;++i){const o=e.mutations[i];if(i+1<e.mutations.length&&e.mutations[i+1].transform!==void 0){const l=e.mutations[i+1];o.updateTransforms=l.transform.fieldTransforms,e.mutations.splice(i+1,1),++i}}const s=e.mutations.map(i=>vj(t.ct,i)),n=wt.fromMillis(e.localWriteTimeMs);return new A3(e.batchId,n,r,s)}function Rg(t){const e=Rf(t.readTime),r=t.lastLimboFreeSnapshotVersion!==void 0?Rf(t.lastLimboFreeSnapshotVersion):Sr.min();let s;return s=function(i){return i.documents!==void 0}(t.query)?function(i){return br(i.documents.length===1),Wo(Vy(HO(i.documents[0])))}(t.query):function(i){return Wo(qO(i))}(t.query),new Md(s,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,r,aa.fromBase64String(t.resumeToken))}function JO(t,e){const r=Df(e.snapshotVersion),s=Df(e.lastLimboFreeSnapshotVersion);let n;n=Cw(e.target)?KO(t.ct,e.target):zO(t.ct,e.target)._t;const i=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Pf(e.target),readTime:r,resumeToken:i,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:s,query:n}}function ZO(t){const e=qO({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Sw(e,e.limit,"L"):e}function Q5(t,e){return new f3(e.largestBatchId,vj(t.ct,e.overlayMutation))}function u6(t,e){const r=e.path.lastSegment();return[t,Xi(e.path.popLast()),r]}function A6(t,e,r,s){return{indexId:t,uid:e,sequenceNumber:r,readTime:Df(s.readTime),documentKey:Xi(s.documentKey.path),largestBatchId:s.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gZ{getBundleMetadata(e,r){return h6(e).get(r).next(s=>{if(s)return function(i){return{id:i.bundleId,createTime:Rf(i.createTime),version:i.version}}(s)})}saveBundleMetadata(e,r){return h6(e).put(function(n){return{bundleId:n.id,createTime:Df(Ji(n.createTime)),version:n.version}}(r))}getNamedQuery(e,r){return f6(e).get(r).next(s=>{if(s)return function(i){return{name:i.name,query:ZO(i.bundledQuery),readTime:Rf(i.readTime)}}(s)})}saveNamedQuery(e,r){return f6(e).put(function(n){return{name:n.name,readTime:Df(Ji(n.readTime)),bundledQuery:n.bundledQuery}}(r))}}function h6(t){return Ta(t,"bundles")}function f6(t){return Ta(t,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eN{constructor(e,r){this.serializer=e,this.userId=r}static lt(e,r){const s=r.uid||"";return new eN(e,s)}getOverlay(e,r){return hg(e).get(u6(this.userId,r)).next(s=>s?Q5(this.serializer,s):null)}getOverlays(e,r){const s=Vc();return bt.forEach(r,n=>this.getOverlay(e,n).next(i=>{i!==null&&s.set(n,i)})).next(()=>s)}saveOverlays(e,r,s){const n=[];return s.forEach((i,o)=>{const l=new f3(r,o);n.push(this.ht(e,l))}),bt.waitFor(n)}removeOverlaysForBatchId(e,r,s){const n=new Set;r.forEach(o=>n.add(Xi(o.getCollectionPath())));const i=[];return n.forEach(o=>{const l=IDBKeyRange.bound([this.userId,o,s],[this.userId,o,s+1],!1,!0);i.push(hg(e).j("collectionPathOverlayIndex",l))}),bt.waitFor(i)}getOverlaysForCollection(e,r,s){const n=Vc(),i=Xi(r),o=IDBKeyRange.bound([this.userId,i,s],[this.userId,i,Number.POSITIVE_INFINITY],!0);return hg(e).U("collectionPathOverlayIndex",o).next(l=>{for(const c of l){const d=Q5(this.serializer,c);n.set(d.getKey(),d)}return n})}getOverlaysForCollectionGroup(e,r,s,n){const i=Vc();let o;const l=IDBKeyRange.bound([this.userId,r,s],[this.userId,r,Number.POSITIVE_INFINITY],!0);return hg(e).J({index:"collectionGroupOverlayIndex",range:l},(c,d,u)=>{const A=Q5(this.serializer,d);i.size()<n||A.largestBatchId===o?(i.set(A.getKey(),A),o=A.largestBatchId):u.done()}).next(()=>i)}ht(e,r){return hg(e).put(function(n,i,o){const[l,c,d]=u6(i,o.mutation.key);return{userId:i,collectionPath:c,documentId:d,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:_w(n.ct,o.mutation)}}(this.serializer,this.userId,r))}}function hg(t){return Ta(t,"documentOverlays")}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xZ{Pt(e){return Ta(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next(r=>{const s=r==null?void 0:r.value;return s?aa.fromUint8Array(s):aa.EMPTY_BYTE_STRING})}setSessionToken(e,r){return this.Pt(e).put({name:"sessionToken",value:r.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $h{constructor(){}It(e,r){this.Tt(e,r),r.Et()}Tt(e,r){if("nullValue"in e)this.dt(r,5);else if("booleanValue"in e)this.dt(r,10),r.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(r,15),r.At(vn(e.integerValue));else if("doubleValue"in e){const s=vn(e.doubleValue);isNaN(s)?this.dt(r,13):(this.dt(r,15),ry(s)?r.At(0):r.At(s))}else if("timestampValue"in e){let s=e.timestampValue;this.dt(r,20),typeof s=="string"&&(s=su(s)),r.Rt(`${s.seconds||""}`),r.At(s.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,r),this.ft(r);else if("bytesValue"in e)this.dt(r,30),r.gt(KA(e.bytesValue)),this.ft(r);else if("referenceValue"in e)this.yt(e.referenceValue,r);else if("geoPointValue"in e){const s=e.geoPointValue;this.dt(r,45),r.At(s.latitude||0),r.At(s.longitude||0)}else"mapValue"in e?uO(e)?this.dt(r,Number.MAX_SAFE_INTEGER):Y2(e)?this.wt(e.mapValue,r):(this.St(e.mapValue,r),this.ft(r)):"arrayValue"in e?(this.bt(e.arrayValue,r),this.ft(r)):mr()}Vt(e,r){this.dt(r,25),this.Dt(e,r)}Dt(e,r){r.Rt(e)}St(e,r){const s=e.fields||{};this.dt(r,55);for(const n of Object.keys(s))this.Vt(n,r),this.Tt(s[n],r)}wt(e,r){var s,n;const i=e.fields||{};this.dt(r,53);const o="value",l=((n=(s=i[o].arrayValue)===null||s===void 0?void 0:s.values)===null||n===void 0?void 0:n.length)||0;this.dt(r,15),r.At(vn(l)),this.Vt(o,r),this.Tt(i[o],r)}bt(e,r){const s=e.values||[];this.dt(r,50);for(const n of s)this.Tt(n,r)}yt(e,r){this.dt(r,37),nr.fromName(e).path.forEach(s=>{this.dt(r,60),this.Dt(s,r)})}dt(e,r){e.At(r)}ft(e){e.At(2)}}$h.vt=new $h;function yZ(t){if(t===0)return 8;let e=0;return!(t>>4)&&(e+=4,t<<=4),!(t>>6)&&(e+=2,t<<=2),!(t>>7)&&(e+=1),e}function m6(t){const e=64-function(s){let n=0;for(let i=0;i<8;++i){const o=yZ(255&s[i]);if(n+=o,o!==8)break}return n}(t);return Math.ceil(e/8)}class vZ{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){const r=e[Symbol.iterator]();let s=r.next();for(;!s.done;)this.Ft(s.value),s=r.next();this.Mt()}xt(e){const r=e[Symbol.iterator]();let s=r.next();for(;!s.done;)this.Ot(s.value),s=r.next();this.Nt()}Lt(e){for(const r of e){const s=r.charCodeAt(0);if(s<128)this.Ft(s);else if(s<2048)this.Ft(960|s>>>6),this.Ft(128|63&s);else if(r<"\uD800"||"\uDBFF"<r)this.Ft(480|s>>>12),this.Ft(128|63&s>>>6),this.Ft(128|63&s);else{const n=r.codePointAt(0);this.Ft(240|n>>>18),this.Ft(128|63&n>>>12),this.Ft(128|63&n>>>6),this.Ft(128|63&n)}}this.Mt()}Bt(e){for(const r of e){const s=r.charCodeAt(0);if(s<128)this.Ot(s);else if(s<2048)this.Ot(960|s>>>6),this.Ot(128|63&s);else if(r<"\uD800"||"\uDBFF"<r)this.Ot(480|s>>>12),this.Ot(128|63&s>>>6),this.Ot(128|63&s);else{const n=r.codePointAt(0);this.Ot(240|n>>>18),this.Ot(128|63&n>>>12),this.Ot(128|63&n>>>6),this.Ot(128|63&n)}}this.Nt()}kt(e){const r=this.qt(e),s=m6(r);this.Qt(1+s),this.buffer[this.position++]=255&s;for(let n=r.length-s;n<r.length;++n)this.buffer[this.position++]=255&r[n]}Kt(e){const r=this.qt(e),s=m6(r);this.Qt(1+s),this.buffer[this.position++]=~(255&s);for(let n=r.length-s;n<r.length;++n)this.buffer[this.position++]=~(255&r[n])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){const r=function(i){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,i,!1),new Uint8Array(o.buffer)}(e),s=(128&r[0])!=0;r[0]^=s?255:128;for(let n=1;n<r.length;++n)r[n]^=s?255:0;return r}Ft(e){const r=255&e;r===0?(this.Ut(0),this.Ut(255)):r===255?(this.Ut(255),this.Ut(0)):this.Ut(r)}Ot(e){const r=255&e;r===0?(this.Gt(0),this.Gt(255)):r===255?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){const r=e+this.position;if(r<=this.buffer.length)return;let s=2*this.buffer.length;s<r&&(s=r);const n=new Uint8Array(s);n.set(this.buffer),this.buffer=n}}class bZ{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}}class wZ{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}}class fg{constructor(){this.jt=new vZ,this.Ht=new bZ(this.jt),this.Jt=new wZ(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return e===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kh{constructor(e,r,s,n){this.indexId=e,this.documentKey=r,this.arrayValue=s,this.directionalValue=n}Zt(){const e=this.directionalValue.length,r=e===0||this.directionalValue[e-1]===255?e+1:e,s=new Uint8Array(r);return s.set(this.directionalValue,0),r!==e?s.set([0],this.directionalValue.length):++s[s.length-1],new Kh(this.indexId,this.documentKey,this.arrayValue,s)}}function $u(t,e){let r=t.indexId-e.indexId;return r!==0?r:(r=p6(t.arrayValue,e.arrayValue),r!==0?r:(r=p6(t.directionalValue,e.directionalValue),r!==0?r:nr.comparator(t.documentKey,e.documentKey)))}function p6(t,e){for(let r=0;r<t.length&&r<e.length;++r){const s=t[r]-e[r];if(s!==0)return s}return t.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g6{constructor(e){this.Xt=new zs((r,s)=>jn.comparator(r.field,s.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(const r of e.filters){const s=r;s.isInequality()?this.Xt=this.Xt.add(s):this.tn.push(s)}}get nn(){return this.Xt.size>1}rn(e){if(br(e.collectionGroup===this.collectionId),this.nn)return!1;const r=cj(e);if(r!==void 0&&!this.sn(r))return!1;const s=Mh(e);let n=new Set,i=0,o=0;for(;i<s.length&&this.sn(s[i]);++i)n=n.add(s[i].fieldPath.canonicalString());if(i===s.length)return!0;if(this.Xt.size>0){const l=this.Xt.getIterator().getNext();if(!n.has(l.field.canonicalString())){const c=s[i];if(!this.on(l,c)||!this._n(this.en[o++],c))return!1}++i}for(;i<s.length;++i){const l=s[i];if(o>=this.en.length||!this._n(this.en[o++],l))return!1}return!0}an(){if(this.nn)return null;let e=new zs(jn.comparator);const r=[];for(const s of this.tn)if(!s.field.isKeyField())if(s.op==="array-contains"||s.op==="array-contains-any")r.push(new Cb(s.field,2));else{if(e.has(s.field))continue;e=e.add(s.field),r.push(new Cb(s.field,0))}for(const s of this.en)s.field.isKeyField()||e.has(s.field)||(e=e.add(s.field),r.push(new Cb(s.field,s.dir==="asc"?0:1)));return new Nw(Nw.UNKNOWN_ID,this.collectionId,r,ty.empty())}sn(e){for(const r of this.tn)if(this.on(r,e))return!0;return!1}on(e,r){if(e===void 0||!e.field.isEqual(r.fieldPath))return!1;const s=e.op==="array-contains"||e.op==="array-contains-any";return r.kind===2===s}_n(e,r){return!!e.field.isEqual(r.fieldPath)&&(r.kind===0&&e.dir==="asc"||r.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eU(t){var e,r;if(br(t instanceof ds||t instanceof Rs),t instanceof ds){if(t instanceof vO){const n=((r=(e=t.value.arrayValue)===null||e===void 0?void 0:e.values)===null||r===void 0?void 0:r.map(i=>ds.create(t.field,"==",i)))||[];return Rs.create(n,"or")}return t}const s=t.filters.map(n=>eU(n));return Rs.create(s,t.op)}function NZ(t){if(t.getFilters().length===0)return[];const e=Nj(eU(t));return br(tU(e)),bj(e)||wj(e)?[e]:e.getFilters()}function bj(t){return t instanceof ds}function wj(t){return t instanceof Rs&&o3(t)}function tU(t){return bj(t)||wj(t)||function(r){if(r instanceof Rs&&hj(r)){for(const s of r.getFilters())if(!bj(s)&&!wj(s))return!1;return!0}return!1}(t)}function Nj(t){if(br(t instanceof ds||t instanceof Rs),t instanceof ds)return t;if(t.filters.length===1)return Nj(t.filters[0]);const e=t.filters.map(s=>Nj(s));let r=Rs.create(e,t.op);return r=Iw(r),tU(r)?r:(br(r instanceof Rs),br(sp(r)),br(r.filters.length>1),r.filters.reduce((s,n)=>g3(s,n)))}function g3(t,e){let r;return br(t instanceof ds||t instanceof Rs),br(e instanceof ds||e instanceof Rs),r=t instanceof ds?e instanceof ds?function(n,i){return Rs.create([n,i],"and")}(t,e):x6(t,e):e instanceof ds?x6(e,t):function(n,i){if(br(n.filters.length>0&&i.filters.length>0),sp(n)&&sp(i))return gO(n,i.getFilters());const o=hj(n)?n:i,l=hj(n)?i:n,c=o.filters.map(d=>g3(d,l));return Rs.create(c,"or")}(t,e),Iw(r)}function x6(t,e){if(sp(e))return gO(e,t.getFilters());{const r=e.filters.map(s=>g3(t,s));return Rs.create(r,"or")}}function Iw(t){if(br(t instanceof ds||t instanceof Rs),t instanceof ds)return t;const e=t.getFilters();if(e.length===1)return Iw(e[0]);if(mO(t))return t;const r=e.map(n=>Iw(n)),s=[];return r.forEach(n=>{n instanceof ds?s.push(n):n instanceof Rs&&(n.op===t.op?s.push(...n.filters):s.push(n))}),s.length===1?s[0]:Rs.create(s,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CZ{constructor(){this.un=new x3}addToCollectionParentIndex(e,r){return this.un.add(r),bt.resolve()}getCollectionParents(e,r){return bt.resolve(this.un.getEntries(r))}addFieldIndex(e,r){return bt.resolve()}deleteFieldIndex(e,r){return bt.resolve()}deleteAllFieldIndexes(e){return bt.resolve()}createTargetIndexes(e,r){return bt.resolve()}getDocumentsMatchingTarget(e,r){return bt.resolve(null)}getIndexType(e,r){return bt.resolve(0)}getFieldIndexes(e,r){return bt.resolve([])}getNextCollectionGroupToUpdate(e){return bt.resolve(null)}getMinOffset(e,r){return bt.resolve(Xo.min())}getMinOffsetFromCollectionGroup(e,r){return bt.resolve(Xo.min())}updateCollectionGroup(e,r,s){return bt.resolve()}updateIndexEntries(e,r){return bt.resolve()}}class x3{constructor(){this.index={}}add(e){const r=e.lastSegment(),s=e.popLast(),n=this.index[r]||new zs(Cs.comparator),i=!n.has(s);return this.index[r]=n.add(s),i}has(e){const r=e.lastSegment(),s=e.popLast(),n=this.index[r];return n&&n.has(s)}getEntries(e){return(this.index[e]||new zs(Cs.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a1=new Uint8Array(0);class jZ{constructor(e,r){this.databaseId=r,this.cn=new x3,this.ln=new fh(s=>Pf(s),(s,n)=>Qy(s,n)),this.uid=e.uid||""}addToCollectionParentIndex(e,r){if(!this.cn.has(r)){const s=r.lastSegment(),n=r.popLast();e.addOnCommittedListener(()=>{this.cn.add(r)});const i={collectionId:s,parent:Xi(n)};return y6(e).put(i)}return bt.resolve()}getCollectionParents(e,r){const s=[],n=IDBKeyRange.bound([r,""],[JL(r),""],!1,!0);return y6(e).U(n).next(i=>{for(const o of i){if(o.collectionId!==r)break;s.push(Qc(o.parent))}return s})}addFieldIndex(e,r){const s=mg(e),n=function(l){return{indexId:l.indexId,collectionGroup:l.collectionGroup,fields:l.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}}(r);delete n.indexId;const i=s.add(n);if(r.indexState){const o=Im(e);return i.next(l=>{o.put(A6(l,this.uid,r.indexState.sequenceNumber,r.indexState.offset))})}return i.next()}deleteFieldIndex(e,r){const s=mg(e),n=Im(e),i=Tm(e);return s.delete(r.indexId).next(()=>n.delete(IDBKeyRange.bound([r.indexId],[r.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([r.indexId],[r.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const r=mg(e),s=Tm(e),n=Im(e);return r.j().next(()=>s.j()).next(()=>n.j())}createTargetIndexes(e,r){return bt.forEach(this.hn(r),s=>this.getIndexType(e,s).next(n=>{if(n===0||n===1){const i=new g6(s).an();if(i!=null)return this.addFieldIndex(e,i)}}))}getDocumentsMatchingTarget(e,r){const s=Tm(e);let n=!0;const i=new Map;return bt.forEach(this.hn(r),o=>this.Pn(e,o).next(l=>{n&&(n=!!l),i.set(o,l)})).next(()=>{if(n){let o=es();const l=[];return bt.forEach(i,(c,d)=>{qt("IndexedDbIndexManager",`Using index ${function(x){return`id=${x.indexId}|cg=${x.collectionGroup}|f=${x.fields.map(E=>`${E.fieldPath}:${E.kind}`).join(",")}`}(c)} to execute ${Pf(r)}`);const u=function(x,E){const T=cj(E);if(T===void 0)return null;for(const j of jw(x,T.fieldPath))switch(j.op){case"array-contains-any":return j.value.arrayValue.values||[];case"array-contains":return[j.value]}return null}(d,c),A=function(x,E){const T=new Map;for(const j of Mh(E))for(const C of jw(x,j.fieldPath))switch(C.op){case"==":case"in":T.set(j.fieldPath.canonicalString(),C.value);break;case"not-in":case"!=":return T.set(j.fieldPath.canonicalString(),C.value),Array.from(T.values())}return null}(d,c),h=function(x,E){const T=[];let j=!0;for(const C of Mh(E)){const w=C.kind===0?Xk(x,C.fieldPath,x.startAt):Jk(x,C.fieldPath,x.startAt);T.push(w.value),j&&(j=w.inclusive)}return new qA(T,j)}(d,c),f=function(x,E){const T=[];let j=!0;for(const C of Mh(E)){const w=C.kind===0?Jk(x,C.fieldPath,x.endAt):Xk(x,C.fieldPath,x.endAt);T.push(w.value),j&&(j=w.inclusive)}return new qA(T,j)}(d,c),p=this.In(c,d,h),m=this.In(c,d,f),g=this.Tn(c,d,A),y=this.En(c.indexId,u,p,h.inclusive,m,f.inclusive,g);return bt.forEach(y,v=>s.G(v,r.limit).next(x=>{x.forEach(E=>{const T=nr.fromSegments(E.documentKey);o.has(T)||(o=o.add(T),l.push(T))})}))}).next(()=>l)}return bt.resolve(null)})}hn(e){let r=this.ln.get(e);return r||(e.filters.length===0?r=[e]:r=NZ(Rs.create(e.filters,"and")).map(s=>mj(e.path,e.collectionGroup,e.orderBy,s.getFilters(),e.limit,e.startAt,e.endAt)),this.ln.set(e,r),r)}En(e,r,s,n,i,o,l){const c=(r!=null?r.length:1)*Math.max(s.length,i.length),d=c/(r!=null?r.length:1),u=[];for(let A=0;A<c;++A){const h=r?this.dn(r[A/d]):a1,f=this.An(e,h,s[A%d],n),p=this.Rn(e,h,i[A%d],o),m=l.map(g=>this.An(e,h,g,!0));u.push(...this.createRange(f,p,m))}return u}An(e,r,s,n){const i=new Kh(e,nr.empty(),r,s);return n?i:i.Zt()}Rn(e,r,s,n){const i=new Kh(e,nr.empty(),r,s);return n?i.Zt():i}Pn(e,r){const s=new g6(r),n=r.collectionGroup!=null?r.collectionGroup:r.path.lastSegment();return this.getFieldIndexes(e,n).next(i=>{let o=null;for(const l of i)s.rn(l)&&(!o||l.fields.length>o.fields.length)&&(o=l);return o})}getIndexType(e,r){let s=2;const n=this.hn(r);return bt.forEach(n,i=>this.Pn(e,i).next(o=>{o?s!==0&&o.fields.length<function(c){let d=new zs(jn.comparator),u=!1;for(const A of c.filters)for(const h of A.getFlattenedFilters())h.field.isKeyField()||(h.op==="array-contains"||h.op==="array-contains-any"?u=!0:d=d.add(h.field));for(const A of c.orderBy)A.field.isKeyField()||(d=d.add(A.field));return d.size+(u?1:0)}(i)&&(s=1):s=0})).next(()=>function(o){return o.limit!==null}(r)&&n.length>1&&s===2?1:s)}Vn(e,r){const s=new fg;for(const n of Mh(e)){const i=r.data.field(n.fieldPath);if(i==null)return null;const o=s.Yt(n.kind);$h.vt.It(i,o)}return s.zt()}dn(e){const r=new fg;return $h.vt.It(e,r.Yt(0)),r.zt()}mn(e,r){const s=new fg;return $h.vt.It(Ff(this.databaseId,r),s.Yt(function(i){const o=Mh(i);return o.length===0?0:o[o.length-1].kind}(e))),s.zt()}Tn(e,r,s){if(s===null)return[];let n=[];n.push(new fg);let i=0;for(const o of Mh(e)){const l=s[i++];for(const c of n)if(this.fn(r,o.fieldPath)&&ay(l))n=this.gn(n,o,l);else{const d=c.Yt(o.kind);$h.vt.It(l,d)}}return this.pn(n)}In(e,r,s){return this.Tn(e,r,s.position)}pn(e){const r=[];for(let s=0;s<e.length;++s)r[s]=e[s].zt();return r}gn(e,r,s){const n=[...e],i=[];for(const o of s.arrayValue.values||[])for(const l of n){const c=new fg;c.seed(l.zt()),$h.vt.It(o,c.Yt(r.kind)),i.push(c)}return i}fn(e,r){return!!e.filters.find(s=>s instanceof ds&&s.field.isEqual(r)&&(s.op==="in"||s.op==="not-in"))}getFieldIndexes(e,r){const s=mg(e),n=Im(e);return(r?s.U("collectionGroupIndex",IDBKeyRange.bound(r,r)):s.U()).next(i=>{const o=[];return bt.forEach(i,l=>n.get([l.indexId,this.uid]).next(c=>{o.push(function(u,A){const h=A?new ty(A.sequenceNumber,new Xo(Rf(A.readTime),new nr(Qc(A.documentKey)),A.largestBatchId)):ty.empty(),f=u.fields.map(([p,m])=>new Cb(jn.fromServerFormat(p),m));return new Nw(u.indexId,u.collectionGroup,f,h)}(l,c))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(r=>r.length===0?null:(r.sort((s,n)=>{const i=s.indexState.sequenceNumber-n.indexState.sequenceNumber;return i!==0?i:$r(s.collectionGroup,n.collectionGroup)}),r[0].collectionGroup))}updateCollectionGroup(e,r,s){const n=mg(e),i=Im(e);return this.yn(e).next(o=>n.U("collectionGroupIndex",IDBKeyRange.bound(r,r)).next(l=>bt.forEach(l,c=>i.put(A6(c.indexId,this.uid,o,s)))))}updateIndexEntries(e,r){const s=new Map;return bt.forEach(r,(n,i)=>{const o=s.get(n.collectionGroup);return(o?bt.resolve(o):this.getFieldIndexes(e,n.collectionGroup)).next(l=>(s.set(n.collectionGroup,l),bt.forEach(l,c=>this.wn(e,n,c).next(d=>{const u=this.Sn(i,c);return d.isEqual(u)?bt.resolve():this.bn(e,i,c,d,u)}))))})}Dn(e,r,s,n){return Tm(e).put({indexId:n.indexId,uid:this.uid,arrayValue:n.arrayValue,directionalValue:n.directionalValue,orderedDocumentKey:this.mn(s,r.key),documentKey:r.key.path.toArray()})}vn(e,r,s,n){return Tm(e).delete([n.indexId,this.uid,n.arrayValue,n.directionalValue,this.mn(s,r.key),r.key.path.toArray()])}wn(e,r,s){const n=Tm(e);let i=new zs($u);return n.J({index:"documentKeyIndex",range:IDBKeyRange.only([s.indexId,this.uid,this.mn(s,r)])},(o,l)=>{i=i.add(new Kh(s.indexId,r,l.arrayValue,l.directionalValue))}).next(()=>i)}Sn(e,r){let s=new zs($u);const n=this.Vn(r,e);if(n==null)return s;const i=cj(r);if(i!=null){const o=e.data.field(i.fieldPath);if(ay(o))for(const l of o.arrayValue.values||[])s=s.add(new Kh(r.indexId,e.key,this.dn(l),n))}else s=s.add(new Kh(r.indexId,e.key,a1,n));return s}bn(e,r,s,n,i){qt("IndexedDbIndexManager","Updating index entries for document '%s'",r.key);const o=[];return function(c,d,u,A,h){const f=c.getIterator(),p=d.getIterator();let m=_m(f),g=_m(p);for(;m||g;){let y=!1,v=!1;if(m&&g){const x=u(m,g);x<0?v=!0:x>0&&(y=!0)}else m!=null?v=!0:y=!0;y?(A(g),g=_m(p)):v?(h(m),m=_m(f)):(m=_m(f),g=_m(p))}}(n,i,$u,l=>{o.push(this.Dn(e,r,s,l))},l=>{o.push(this.vn(e,r,s,l))}),bt.waitFor(o)}yn(e){let r=1;return Im(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(s,n,i)=>{i.done(),r=n.sequenceNumber+1}).next(()=>r)}createRange(e,r,s){s=s.sort((o,l)=>$u(o,l)).filter((o,l,c)=>!l||$u(o,c[l-1])!==0);const n=[];n.push(e);for(const o of s){const l=$u(o,e),c=$u(o,r);if(l===0)n[0]=e.Zt();else if(l>0&&c<0)n.push(o),n.push(o.Zt());else if(c>0)break}n.push(r);const i=[];for(let o=0;o<n.length;o+=2){if(this.Cn(n[o],n[o+1]))return[];const l=[n[o].indexId,this.uid,n[o].arrayValue,n[o].directionalValue,a1,[]],c=[n[o+1].indexId,this.uid,n[o+1].arrayValue,n[o+1].directionalValue,a1,[]];i.push(IDBKeyRange.bound(l,c))}return i}Cn(e,r){return $u(e,r)>0}getMinOffsetFromCollectionGroup(e,r){return this.getFieldIndexes(e,r).next(v6)}getMinOffset(e,r){return bt.mapArray(this.hn(r),s=>this.Pn(e,s).next(n=>n||mr())).next(v6)}}function y6(t){return Ta(t,"collectionParents")}function Tm(t){return Ta(t,"indexEntries")}function mg(t){return Ta(t,"indexConfiguration")}function Im(t){return Ta(t,"indexState")}function v6(t){br(t.length!==0);let e=t[0].indexState.offset,r=e.largestBatchId;for(let s=1;s<t.length;s++){const n=t[s].indexState.offset;s3(n,e)<0&&(e=n),r<n.largestBatchId&&(r=n.largestBatchId)}return new Xo(e.readTime,e.documentKey,r)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b6={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class ho{constructor(e,r,s){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=s}static withCacheSize(e){return new ho(e,ho.DEFAULT_COLLECTION_PERCENTILE,ho.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rU(t,e,r){const s=t.store("mutations"),n=t.store("documentMutations"),i=[],o=IDBKeyRange.only(r.batchId);let l=0;const c=s.J({range:o},(u,A,h)=>(l++,h.delete()));i.push(c.next(()=>{br(l===1)}));const d=[];for(const u of r.mutations){const A=aO(e,u.key.path,r.batchId);i.push(n.delete(A)),d.push(u.key)}return bt.waitFor(i).next(()=>d)}function kw(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw mr();e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ho.DEFAULT_COLLECTION_PERCENTILE=10,ho.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ho.DEFAULT=new ho(41943040,ho.DEFAULT_COLLECTION_PERCENTILE,ho.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ho.DISABLED=new ho(-1,0,0);class tN{constructor(e,r,s,n){this.userId=e,this.serializer=r,this.indexManager=s,this.referenceDelegate=n,this.Fn={}}static lt(e,r,s,n){br(e.uid!=="");const i=e.isAuthenticated()?e.uid:"";return new tN(i,r,s,n)}checkEmpty(e){let r=!0;const s=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Ku(e).J({index:"userMutationsIndex",range:s},(n,i,o)=>{r=!1,o.done()}).next(()=>r)}addMutationBatch(e,r,s,n){const i=Jm(e),o=Ku(e);return o.add({}).next(l=>{br(typeof l=="number");const c=new A3(l,r,s,n),d=function(f,p,m){const g=m.baseMutations.map(v=>_w(f.ct,v)),y=m.mutations.map(v=>_w(f.ct,v));return{userId:p,batchId:m.batchId,localWriteTimeMs:m.localWriteTime.toMillis(),baseMutations:g,mutations:y}}(this.serializer,this.userId,c),u=[];let A=new zs((h,f)=>$r(h.canonicalString(),f.canonicalString()));for(const h of n){const f=aO(this.userId,h.key.path,l);A=A.add(h.key.path.popLast()),u.push(o.put(d)),u.push(i.put(f,dJ))}return A.forEach(h=>{u.push(this.indexManager.addToCollectionParentIndex(e,h))}),e.addOnCommittedListener(()=>{this.Fn[l]=c.keys()}),bt.waitFor(u).next(()=>c)})}lookupMutationBatch(e,r){return Ku(e).get(r).next(s=>s?(br(s.userId===this.userId),Hh(this.serializer,s)):null)}Mn(e,r){return this.Fn[r]?bt.resolve(this.Fn[r]):this.lookupMutationBatch(e,r).next(s=>{if(s){const n=s.keys();return this.Fn[r]=n,n}return null})}getNextMutationBatchAfterBatchId(e,r){const s=r+1,n=IDBKeyRange.lowerBound([this.userId,s]);let i=null;return Ku(e).J({index:"userMutationsIndex",range:n},(o,l,c)=>{l.userId===this.userId&&(br(l.batchId>=s),i=Hh(this.serializer,l)),c.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){const r=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let s=-1;return Ku(e).J({index:"userMutationsIndex",range:r,reverse:!0},(n,i,o)=>{s=i.batchId,o.done()}).next(()=>s)}getAllMutationBatches(e){const r=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Ku(e).U("userMutationsIndex",r).next(s=>s.map(n=>Hh(this.serializer,n)))}getAllMutationBatchesAffectingDocumentKey(e,r){const s=jb(this.userId,r.path),n=IDBKeyRange.lowerBound(s),i=[];return Jm(e).J({range:n},(o,l,c)=>{const[d,u,A]=o,h=Qc(u);if(d===this.userId&&r.path.isEqual(h))return Ku(e).get(A).next(f=>{if(!f)throw mr();br(f.userId===this.userId),i.push(Hh(this.serializer,f))});c.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,r){let s=new zs($r);const n=[];return r.forEach(i=>{const o=jb(this.userId,i.path),l=IDBKeyRange.lowerBound(o),c=Jm(e).J({range:l},(d,u,A)=>{const[h,f,p]=d,m=Qc(f);h===this.userId&&i.path.isEqual(m)?s=s.add(p):A.done()});n.push(c)}),bt.waitFor(n).next(()=>this.xn(e,s))}getAllMutationBatchesAffectingQuery(e,r){const s=r.path,n=s.length+1,i=jb(this.userId,s),o=IDBKeyRange.lowerBound(i);let l=new zs($r);return Jm(e).J({range:o},(c,d,u)=>{const[A,h,f]=c,p=Qc(h);A===this.userId&&s.isPrefixOf(p)?p.length===n&&(l=l.add(f)):u.done()}).next(()=>this.xn(e,l))}xn(e,r){const s=[],n=[];return r.forEach(i=>{n.push(Ku(e).get(i).next(o=>{if(o===null)throw mr();br(o.userId===this.userId),s.push(Hh(this.serializer,o))}))}),bt.waitFor(n).next(()=>s)}removeMutationBatch(e,r){return rU(e._e,this.userId,r).next(s=>(e.addOnCommittedListener(()=>{this.On(r.batchId)}),bt.forEach(s,n=>this.referenceDelegate.markPotentiallyOrphaned(e,n))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(r=>{if(!r)return bt.resolve();const s=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),n=[];return Jm(e).J({range:s},(i,o,l)=>{if(i[0]===this.userId){const c=Qc(i[1]);n.push(c)}else l.done()}).next(()=>{br(n.length===0)})})}containsKey(e,r){return sU(e,this.userId,r)}Nn(e){return nU(e).get(this.userId).next(r=>r||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function sU(t,e,r){const s=jb(e,r.path),n=s[1],i=IDBKeyRange.lowerBound(s);let o=!1;return Jm(t).J({range:i,H:!0},(l,c,d)=>{const[u,A,h]=l;u===e&&A===n&&(o=!0),d.done()}).next(()=>o)}function Ku(t){return Ta(t,"mutations")}function Jm(t){return Ta(t,"documentMutations")}function nU(t){return Ta(t,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lf{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new Lf(0)}static kn(){return new Lf(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SZ{constructor(e,r){this.referenceDelegate=e,this.serializer=r}allocateTargetId(e){return this.qn(e).next(r=>{const s=new Lf(r.highestTargetId);return r.highestTargetId=s.next(),this.Qn(e,r).next(()=>r.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.qn(e).next(r=>Sr.fromTimestamp(new wt(r.lastRemoteSnapshotVersion.seconds,r.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.qn(e).next(r=>r.highestListenSequenceNumber)}setTargetsMetadata(e,r,s){return this.qn(e).next(n=>(n.highestListenSequenceNumber=r,s&&(n.lastRemoteSnapshotVersion=s.toTimestamp()),r>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=r),this.Qn(e,n)))}addTargetData(e,r){return this.Kn(e,r).next(()=>this.qn(e).next(s=>(s.targetCount+=1,this.$n(r,s),this.Qn(e,s))))}updateTargetData(e,r){return this.Kn(e,r)}removeTargetData(e,r){return this.removeMatchingKeysForTargetId(e,r.targetId).next(()=>km(e).delete(r.targetId)).next(()=>this.qn(e)).next(s=>(br(s.targetCount>0),s.targetCount-=1,this.Qn(e,s)))}removeTargets(e,r,s){let n=0;const i=[];return km(e).J((o,l)=>{const c=Rg(l);c.sequenceNumber<=r&&s.get(c.targetId)===null&&(n++,i.push(this.removeTargetData(e,c)))}).next(()=>bt.waitFor(i)).next(()=>n)}forEachTarget(e,r){return km(e).J((s,n)=>{const i=Rg(n);r(i)})}qn(e){return w6(e).get("targetGlobalKey").next(r=>(br(r!==null),r))}Qn(e,r){return w6(e).put("targetGlobalKey",r)}Kn(e,r){return km(e).put(JO(this.serializer,r))}$n(e,r){let s=!1;return e.targetId>r.highestTargetId&&(r.highestTargetId=e.targetId,s=!0),e.sequenceNumber>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=e.sequenceNumber,s=!0),s}getTargetCount(e){return this.qn(e).next(r=>r.targetCount)}getTargetData(e,r){const s=Pf(r),n=IDBKeyRange.bound([s,Number.NEGATIVE_INFINITY],[s,Number.POSITIVE_INFINITY]);let i=null;return km(e).J({range:n,index:"queryTargetsIndex"},(o,l,c)=>{const d=Rg(l);Qy(r,d.target)&&(i=d,c.done())}).next(()=>i)}addMatchingKeys(e,r,s){const n=[],i=cA(e);return r.forEach(o=>{const l=Xi(o.path);n.push(i.put({targetId:s,path:l})),n.push(this.referenceDelegate.addReference(e,s,o))}),bt.waitFor(n)}removeMatchingKeys(e,r,s){const n=cA(e);return bt.forEach(r,i=>{const o=Xi(i.path);return bt.waitFor([n.delete([s,o]),this.referenceDelegate.removeReference(e,s,i)])})}removeMatchingKeysForTargetId(e,r){const s=cA(e),n=IDBKeyRange.bound([r],[r+1],!1,!0);return s.delete(n)}getMatchingKeysForTargetId(e,r){const s=IDBKeyRange.bound([r],[r+1],!1,!0),n=cA(e);let i=es();return n.J({range:s,H:!0},(o,l,c)=>{const d=Qc(o[1]),u=new nr(d);i=i.add(u)}).next(()=>i)}containsKey(e,r){const s=Xi(r.path),n=IDBKeyRange.bound([s],[JL(s)],!1,!0);let i=0;return cA(e).J({index:"documentTargetsIndex",H:!0,range:n},([o,l],c,d)=>{o!==0&&(i++,d.done())}).next(()=>i>0)}ot(e,r){return km(e).get(r).next(s=>s?Rg(s):null)}}function km(t){return Ta(t,"targets")}function w6(t){return Ta(t,"targetGlobal")}function cA(t){return Ta(t,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N6([t,e],[r,s]){const n=$r(t,r);return n===0?$r(e,s):n}class EZ{constructor(e){this.Un=e,this.buffer=new zs(N6),this.Wn=0}Gn(){return++this.Wn}zn(e){const r=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(r);else{const s=this.buffer.last();N6(r,s)<0&&(this.buffer=this.buffer.delete(s).add(r))}}get maxValue(){return this.buffer.last()[0]}}class _Z{constructor(e,r,s){this.garbageCollector=e,this.asyncQueue=r,this.localStore=s,this.jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return this.jn!==null}Hn(e){qt("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){hh(r)?qt("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",r):await Ah(r)}await this.Hn(3e5)})}}class TZ{constructor(e,r){this.Jn=e,this.params=r}calculateTargetCount(e,r){return this.Jn.Yn(e).next(s=>Math.floor(r/100*s))}nthSequenceNumber(e,r){if(r===0)return bt.resolve(xo.oe);const s=new EZ(r);return this.Jn.forEachTarget(e,n=>s.zn(n.sequenceNumber)).next(()=>this.Jn.Zn(e,n=>s.zn(n))).next(()=>s.maxValue)}removeTargets(e,r,s){return this.Jn.removeTargets(e,r,s)}removeOrphanedDocuments(e,r){return this.Jn.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(qt("LruGarbageCollector","Garbage collection skipped; disabled"),bt.resolve(b6)):this.getCacheSize(e).next(s=>s<this.params.cacheSizeCollectionThreshold?(qt("LruGarbageCollector",`Garbage collection skipped; Cache size ${s} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),b6):this.Xn(e,r))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,r){let s,n,i,o,l,c,d;const u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(A=>(A>this.params.maximumSequenceNumbersToCollect?(qt("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${A}`),n=this.params.maximumSequenceNumbersToCollect):n=A,o=Date.now(),this.nthSequenceNumber(e,n))).next(A=>(s=A,l=Date.now(),this.removeTargets(e,s,r))).next(A=>(i=A,c=Date.now(),this.removeOrphanedDocuments(e,s))).next(A=>(d=Date.now(),Wm()<=cs.DEBUG&&qt("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-u}ms
	Determined least recently used ${n} in `+(l-o)+`ms
	Removed ${i} targets in `+(c-l)+`ms
	Removed ${A} documents in `+(d-c)+`ms
Total Duration: ${d-u}ms`),bt.resolve({didRun:!0,sequenceNumbersCollected:n,targetsRemoved:i,documentsRemoved:A})))}}function IZ(t,e){return new TZ(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kZ{constructor(e,r){this.db=e,this.garbageCollector=IZ(this,r)}Yn(e){const r=this.er(e);return this.db.getTargetCache().getTargetCount(e).next(s=>r.next(n=>s+n))}er(e){let r=0;return this.Zn(e,s=>{r++}).next(()=>r)}forEachTarget(e,r){return this.db.getTargetCache().forEachTarget(e,r)}Zn(e,r){return this.tr(e,(s,n)=>r(n))}addReference(e,r,s){return i1(e,s)}removeReference(e,r,s){return i1(e,s)}removeTargets(e,r,s){return this.db.getTargetCache().removeTargets(e,r,s)}markPotentiallyOrphaned(e,r){return i1(e,r)}nr(e,r){return function(n,i){let o=!1;return nU(n).Y(l=>sU(n,l,i).next(c=>(c&&(o=!0),bt.resolve(!c)))).next(()=>o)}(e,r)}removeOrphanedDocuments(e,r){const s=this.db.getRemoteDocumentCache().newChangeBuffer(),n=[];let i=0;return this.tr(e,(o,l)=>{if(l<=r){const c=this.nr(e,o).next(d=>{if(!d)return i++,s.getEntry(e,o).next(()=>(s.removeEntry(o,Sr.min()),cA(e).delete(function(A){return[0,Xi(A.path)]}(o))))});n.push(c)}}).next(()=>bt.waitFor(n)).next(()=>s.apply(e)).next(()=>i)}removeTarget(e,r){const s=r.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,s)}updateLimboDocument(e,r){return i1(e,r)}tr(e,r){const s=cA(e);let n,i=xo.oe;return s.J({index:"documentTargetsIndex"},([o,l],{path:c,sequenceNumber:d})=>{o===0?(i!==xo.oe&&r(new nr(Qc(n)),i),i=d,n=c):i=xo.oe}).next(()=>{i!==xo.oe&&r(new nr(Qc(n)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function i1(t,e){return cA(t).put(function(s,n){return{targetId:0,path:Xi(s.path),sequenceNumber:n}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aU{constructor(){this.changes=new fh(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,Ln.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const s=this.changes.get(r);return s!==void 0?bt.resolve(s):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BZ{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,r,s){return Dh(e).put(s)}removeEntry(e,r,s){return Dh(e).delete(function(i,o){const l=i.path.toArray();return[l.slice(0,l.length-2),l[l.length-2],Tw(o),l[l.length-1]]}(r,s))}updateMetadata(e,r){return this.getMetadata(e).next(s=>(s.byteSize+=r,this.rr(e,s)))}getEntry(e,r){let s=Ln.newInvalidDocument(r);return Dh(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(pg(r))},(n,i)=>{s=this.ir(r,i)}).next(()=>s)}sr(e,r){let s={size:0,document:Ln.newInvalidDocument(r)};return Dh(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(pg(r))},(n,i)=>{s={document:this.ir(r,i),size:kw(i)}}).next(()=>s)}getEntries(e,r){let s=Ko();return this._r(e,r,(n,i)=>{const o=this.ir(n,i);s=s.insert(n,o)}).next(()=>s)}ar(e,r){let s=Ko(),n=new an(nr.comparator);return this._r(e,r,(i,o)=>{const l=this.ir(i,o);s=s.insert(i,l),n=n.insert(i,kw(o))}).next(()=>({documents:s,ur:n}))}_r(e,r,s){if(r.isEmpty())return bt.resolve();let n=new zs(S6);r.forEach(c=>n=n.add(c));const i=IDBKeyRange.bound(pg(n.first()),pg(n.last())),o=n.getIterator();let l=o.getNext();return Dh(e).J({index:"documentKeyIndex",range:i},(c,d,u)=>{const A=nr.fromSegments([...d.prefixPath,d.collectionGroup,d.documentId]);for(;l&&S6(l,A)<0;)s(l,null),l=o.getNext();l&&l.isEqual(A)&&(s(l,d),l=o.hasNext()?o.getNext():null),l?u.$(pg(l)):u.done()}).next(()=>{for(;l;)s(l,null),l=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,r,s,n,i){const o=r.path,l=[o.popLast().toArray(),o.lastSegment(),Tw(s.readTime),s.documentKey.path.isEmpty()?"":s.documentKey.path.lastSegment()],c=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Dh(e).U(IDBKeyRange.bound(l,c,!0)).next(d=>{i==null||i.incrementDocumentReadCount(d.length);let u=Ko();for(const A of d){const h=this.ir(nr.fromSegments(A.prefixPath.concat(A.collectionGroup,A.documentId)),A);h.isFoundDocument()&&(Hy(r,h)||n.has(h.key))&&(u=u.insert(h.key,h))}return u})}getAllFromCollectionGroup(e,r,s,n){let i=Ko();const o=j6(r,s),l=j6(r,Xo.max());return Dh(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,l,!0)},(c,d,u)=>{const A=this.ir(nr.fromSegments(d.prefixPath.concat(d.collectionGroup,d.documentId)),d);i=i.insert(A.key,A),i.size===n&&u.done()}).next(()=>i)}newChangeBuffer(e){return new FZ(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(r=>r.byteSize)}getMetadata(e){return C6(e).get("remoteDocumentGlobalKey").next(r=>(br(!!r),r))}rr(e,r){return C6(e).put("remoteDocumentGlobalKey",r)}ir(e,r){if(r){const s=pZ(this.serializer,r);if(!(s.isNoDocument()&&s.version.isEqual(Sr.min())))return s}return Ln.newInvalidDocument(e)}}function iU(t){return new BZ(t)}class FZ extends aU{constructor(e,r){super(),this.cr=e,this.trackRemovals=r,this.lr=new fh(s=>s.toString(),(s,n)=>s.isEqual(n))}applyChanges(e){const r=[];let s=0,n=new zs((i,o)=>$r(i.canonicalString(),o.canonicalString()));return this.changes.forEach((i,o)=>{const l=this.lr.get(i);if(r.push(this.cr.removeEntry(e,i,l.readTime)),o.isValidDocument()){const c=d6(this.cr.serializer,o);n=n.add(i.path.popLast());const d=kw(c);s+=d-l.size,r.push(this.cr.addEntry(e,i,c))}else if(s-=l.size,this.trackRemovals){const c=d6(this.cr.serializer,o.convertToNoDocument(Sr.min()));r.push(this.cr.addEntry(e,i,c))}}),n.forEach(i=>{r.push(this.cr.indexManager.addToCollectionParentIndex(e,i))}),r.push(this.cr.updateMetadata(e,s)),bt.waitFor(r)}getFromCache(e,r){return this.cr.sr(e,r).next(s=>(this.lr.set(r,{size:s.size,readTime:s.document.readTime}),s.document))}getAllFromCache(e,r){return this.cr.ar(e,r).next(({documents:s,ur:n})=>(n.forEach((i,o)=>{this.lr.set(i,{size:o,readTime:s.get(i).readTime})}),s))}}function C6(t){return Ta(t,"remoteDocumentGlobal")}function Dh(t){return Ta(t,"remoteDocumentsV14")}function pg(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function j6(t,e){const r=e.documentKey.path.toArray();return[t,Tw(e.readTime),r.slice(0,r.length-2),r.length>0?r[r.length-1]:""]}function S6(t,e){const r=t.path.toArray(),s=e.path.toArray();let n=0;for(let i=0;i<r.length-2&&i<s.length-2;++i)if(n=$r(r[i],s[i]),n)return n;return n=$r(r.length,s.length),n||(n=$r(r[r.length-2],s[s.length-2]),n||$r(r[r.length-1],s[s.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PZ{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oU{constructor(e,r,s,n){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=s,this.indexManager=n}getDocument(e,r){let s=null;return this.documentOverlayCache.getOverlay(e,r).next(n=>(s=n,this.remoteDocumentCache.getEntry(e,r))).next(n=>(s!==null&&lx(s.mutation,n,yo.empty(),wt.now()),n))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(s=>this.getLocalViewOfDocuments(e,s,es()).next(()=>s))}getLocalViewOfDocuments(e,r,s=es()){const n=Vc();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,s).next(i=>{let o=Pg();return i.forEach((l,c)=>{o=o.insert(l,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,r){const s=Vc();return this.populateOverlays(e,s,r).next(()=>this.computeViews(e,r,s,es()))}populateOverlays(e,r,s){const n=[];return s.forEach(i=>{r.has(i)||n.push(i)}),this.documentOverlayCache.getOverlays(e,n).next(i=>{i.forEach((o,l)=>{r.set(o,l)})})}computeViews(e,r,s,n){let i=Ko();const o=ox(),l=function(){return ox()}();return r.forEach((c,d)=>{const u=s.get(d.key);n.has(d.key)&&(u===void 0||u.mutation instanceof hu)?i=i.insert(d.key,d):u!==void 0?(o.set(d.key,u.mutation.getFieldMask()),lx(u.mutation,d,u.mutation.getFieldMask(),wt.now())):o.set(d.key,yo.empty())}),this.recalculateAndSaveOverlays(e,i).next(c=>(c.forEach((d,u)=>o.set(d,u)),r.forEach((d,u)=>{var A;return l.set(d,new PZ(u,(A=o.get(d))!==null&&A!==void 0?A:null))}),l))}recalculateAndSaveOverlays(e,r){const s=ox();let n=new an((o,l)=>o-l),i=es();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(o=>{for(const l of o)l.keys().forEach(c=>{const d=r.get(c);if(d===null)return;let u=s.get(c)||yo.empty();u=l.applyToLocalView(d,u),s.set(c,u);const A=(n.get(l.batchId)||es()).add(c);n=n.insert(l.batchId,A)})}).next(()=>{const o=[],l=n.getReverseIterator();for(;l.hasNext();){const c=l.getNext(),d=c.key,u=c.value,A=EO();u.forEach(h=>{if(!i.has(h)){const f=PO(r.get(h),s.get(h));f!==null&&A.set(h,f),i=i.add(h)}}),o.push(this.documentOverlayCache.saveOverlays(e,d,A))}return bt.waitFor(o)}).next(()=>s)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(s=>this.recalculateAndSaveOverlays(e,s))}getDocumentsMatchingQuery(e,r,s,n){return function(o){return nr.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):l3(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,s,n):this.getDocumentsMatchingCollectionQuery(e,r,s,n)}getNextDocuments(e,r,s,n){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,s,n).next(i=>{const o=n-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,s.largestBatchId,n-i.size):bt.resolve(Vc());let l=-1,c=i;return o.next(d=>bt.forEach(d,(u,A)=>(l<A.largestBatchId&&(l=A.largestBatchId),i.get(u)?bt.resolve():this.remoteDocumentCache.getEntry(e,u).next(h=>{c=c.insert(u,h)}))).next(()=>this.populateOverlays(e,d,i)).next(()=>this.computeViews(e,c,d,es())).next(u=>({batchId:l,changes:SO(u)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new nr(r)).next(s=>{let n=Pg();return s.isFoundDocument()&&(n=n.insert(s.key,s)),n})}getDocumentsMatchingCollectionGroupQuery(e,r,s,n){const i=r.collectionGroup;let o=Pg();return this.indexManager.getCollectionParents(e,i).next(l=>bt.forEach(l,c=>{const d=function(A,h){return new Jf(h,null,A.explicitOrderBy.slice(),A.filters.slice(),A.limit,A.limitType,A.startAt,A.endAt)}(r,c.child(i));return this.getDocumentsMatchingCollectionQuery(e,d,s,n).next(u=>{u.forEach((A,h)=>{o=o.insert(A,h)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,r,s,n){let i;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,s.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,s,i,n))).next(o=>{i.forEach((c,d)=>{const u=d.getKey();o.get(u)===null&&(o=o.insert(u,Ln.newInvalidDocument(u)))});let l=Pg();return o.forEach((c,d)=>{const u=i.get(c);u!==void 0&&lx(u.mutation,d,yo.empty(),wt.now()),Hy(r,d)&&(l=l.insert(c,d))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DZ{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,r){return bt.resolve(this.hr.get(r))}saveBundleMetadata(e,r){return this.hr.set(r.id,function(n){return{id:n.id,version:n.version,createTime:Ji(n.createTime)}}(r)),bt.resolve()}getNamedQuery(e,r){return bt.resolve(this.Pr.get(r))}saveNamedQuery(e,r){return this.Pr.set(r.name,function(n){return{name:n.name,query:ZO(n.bundledQuery),readTime:Ji(n.readTime)}}(r)),bt.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RZ{constructor(){this.overlays=new an(nr.comparator),this.Ir=new Map}getOverlay(e,r){return bt.resolve(this.overlays.get(r))}getOverlays(e,r){const s=Vc();return bt.forEach(r,n=>this.getOverlay(e,n).next(i=>{i!==null&&s.set(n,i)})).next(()=>s)}saveOverlays(e,r,s){return s.forEach((n,i)=>{this.ht(e,r,i)}),bt.resolve()}removeOverlaysForBatchId(e,r,s){const n=this.Ir.get(s);return n!==void 0&&(n.forEach(i=>this.overlays=this.overlays.remove(i)),this.Ir.delete(s)),bt.resolve()}getOverlaysForCollection(e,r,s){const n=Vc(),i=r.length+1,o=new nr(r.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const c=l.getNext().value,d=c.getKey();if(!r.isPrefixOf(d.path))break;d.path.length===i&&c.largestBatchId>s&&n.set(c.getKey(),c)}return bt.resolve(n)}getOverlaysForCollectionGroup(e,r,s,n){let i=new an((d,u)=>d-u);const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===r&&d.largestBatchId>s){let u=i.get(d.largestBatchId);u===null&&(u=Vc(),i=i.insert(d.largestBatchId,u)),u.set(d.getKey(),d)}}const l=Vc(),c=i.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((d,u)=>l.set(d,u)),!(l.size()>=n)););return bt.resolve(l)}ht(e,r,s){const n=this.overlays.get(s.key);if(n!==null){const o=this.Ir.get(n.largestBatchId).delete(s.key);this.Ir.set(n.largestBatchId,o)}this.overlays=this.overlays.insert(s.key,new f3(r,s));let i=this.Ir.get(r);i===void 0&&(i=es(),this.Ir.set(r,i)),this.Ir.set(r,i.add(s.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LZ{constructor(){this.sessionToken=aa.EMPTY_BYTE_STRING}getSessionToken(e){return bt.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,bt.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y3{constructor(){this.Tr=new zs(La.Er),this.dr=new zs(La.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,r){const s=new La(e,r);this.Tr=this.Tr.add(s),this.dr=this.dr.add(s)}Rr(e,r){e.forEach(s=>this.addReference(s,r))}removeReference(e,r){this.Vr(new La(e,r))}mr(e,r){e.forEach(s=>this.removeReference(s,r))}gr(e){const r=new nr(new Cs([])),s=new La(r,e),n=new La(r,e+1),i=[];return this.dr.forEachInRange([s,n],o=>{this.Vr(o),i.push(o.key)}),i}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const r=new nr(new Cs([])),s=new La(r,e),n=new La(r,e+1);let i=es();return this.dr.forEachInRange([s,n],o=>{i=i.add(o.key)}),i}containsKey(e){const r=new La(e,0),s=this.Tr.firstAfterOrEqual(r);return s!==null&&e.isEqual(s.key)}}class La{constructor(e,r){this.key=e,this.wr=r}static Er(e,r){return nr.comparator(e.key,r.key)||$r(e.wr,r.wr)}static Ar(e,r){return $r(e.wr,r.wr)||nr.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OZ{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.Sr=1,this.br=new zs(La.Er)}checkEmpty(e){return bt.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,s,n){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new A3(i,r,s,n);this.mutationQueue.push(o);for(const l of n)this.br=this.br.add(new La(l.key,i)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return bt.resolve(o)}lookupMutationBatch(e,r){return bt.resolve(this.Dr(r))}getNextMutationBatchAfterBatchId(e,r){const s=r+1,n=this.vr(s),i=n<0?0:n;return bt.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return bt.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return bt.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const s=new La(r,0),n=new La(r,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([s,n],o=>{const l=this.Dr(o.wr);i.push(l)}),bt.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,r){let s=new zs($r);return r.forEach(n=>{const i=new La(n,0),o=new La(n,Number.POSITIVE_INFINITY);this.br.forEachInRange([i,o],l=>{s=s.add(l.wr)})}),bt.resolve(this.Cr(s))}getAllMutationBatchesAffectingQuery(e,r){const s=r.path,n=s.length+1;let i=s;nr.isDocumentKey(i)||(i=i.child(""));const o=new La(new nr(i),0);let l=new zs($r);return this.br.forEachWhile(c=>{const d=c.key.path;return!!s.isPrefixOf(d)&&(d.length===n&&(l=l.add(c.wr)),!0)},o),bt.resolve(this.Cr(l))}Cr(e){const r=[];return e.forEach(s=>{const n=this.Dr(s);n!==null&&r.push(n)}),r}removeMutationBatch(e,r){br(this.Fr(r.batchId,"removed")===0),this.mutationQueue.shift();let s=this.br;return bt.forEach(r.mutations,n=>{const i=new La(n.key,r.batchId);return s=s.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,n.key)}).next(()=>{this.br=s})}On(e){}containsKey(e,r){const s=new La(r,0),n=this.br.firstAfterOrEqual(s);return bt.resolve(r.isEqual(n&&n.key))}performConsistencyCheck(e){return this.mutationQueue.length,bt.resolve()}Fr(e,r){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const r=this.vr(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UZ{constructor(e){this.Mr=e,this.docs=function(){return new an(nr.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const s=r.key,n=this.docs.get(s),i=n?n.size:0,o=this.Mr(r);return this.docs=this.docs.insert(s,{document:r.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,s.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const s=this.docs.get(r);return bt.resolve(s?s.document.mutableCopy():Ln.newInvalidDocument(r))}getEntries(e,r){let s=Ko();return r.forEach(n=>{const i=this.docs.get(n);s=s.insert(n,i?i.document.mutableCopy():Ln.newInvalidDocument(n))}),bt.resolve(s)}getDocumentsMatchingQuery(e,r,s,n){let i=Ko();const o=r.path,l=new nr(o.child("")),c=this.docs.getIteratorFrom(l);for(;c.hasNext();){const{key:d,value:{document:u}}=c.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||s3(eO(u),s)<=0||(n.has(u.key)||Hy(r,u))&&(i=i.insert(u.key,u.mutableCopy()))}return bt.resolve(i)}getAllFromCollectionGroup(e,r,s,n){mr()}Or(e,r){return bt.forEach(this.docs,s=>r(s))}newChangeBuffer(e){return new MZ(this)}getSize(e){return bt.resolve(this.size)}}class MZ extends aU{constructor(e){super(),this.cr=e}applyChanges(e){const r=[];return this.changes.forEach((s,n)=>{n.isValidDocument()?r.push(this.cr.addEntry(e,n)):this.cr.removeEntry(s)}),bt.waitFor(r)}getFromCache(e,r){return this.cr.getEntry(e,r)}getAllFromCache(e,r){return this.cr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QZ{constructor(e){this.persistence=e,this.Nr=new fh(r=>Pf(r),Qy),this.lastRemoteSnapshotVersion=Sr.min(),this.highestTargetId=0,this.Lr=0,this.Br=new y3,this.targetCount=0,this.kr=Lf.Bn()}forEachTarget(e,r){return this.Nr.forEach((s,n)=>r(n)),bt.resolve()}getLastRemoteSnapshotVersion(e){return bt.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return bt.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),bt.resolve(this.highestTargetId)}setTargetsMetadata(e,r,s){return s&&(this.lastRemoteSnapshotVersion=s),r>this.Lr&&(this.Lr=r),bt.resolve()}Kn(e){this.Nr.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.kr=new Lf(r),this.highestTargetId=r),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,r){return this.Kn(r),this.targetCount+=1,bt.resolve()}updateTargetData(e,r){return this.Kn(r),bt.resolve()}removeTargetData(e,r){return this.Nr.delete(r.target),this.Br.gr(r.targetId),this.targetCount-=1,bt.resolve()}removeTargets(e,r,s){let n=0;const i=[];return this.Nr.forEach((o,l)=>{l.sequenceNumber<=r&&s.get(l.targetId)===null&&(this.Nr.delete(o),i.push(this.removeMatchingKeysForTargetId(e,l.targetId)),n++)}),bt.waitFor(i).next(()=>n)}getTargetCount(e){return bt.resolve(this.targetCount)}getTargetData(e,r){const s=this.Nr.get(r)||null;return bt.resolve(s)}addMatchingKeys(e,r,s){return this.Br.Rr(r,s),bt.resolve()}removeMatchingKeys(e,r,s){this.Br.mr(r,s);const n=this.persistence.referenceDelegate,i=[];return n&&r.forEach(o=>{i.push(n.markPotentiallyOrphaned(e,o))}),bt.waitFor(i)}removeMatchingKeysForTargetId(e,r){return this.Br.gr(r),bt.resolve()}getMatchingKeysForTargetId(e,r){const s=this.Br.yr(r);return bt.resolve(s)}containsKey(e,r){return bt.resolve(this.Br.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lU{constructor(e,r){this.qr={},this.overlays={},this.Qr=new xo(0),this.Kr=!1,this.Kr=!0,this.$r=new LZ,this.referenceDelegate=e(this),this.Ur=new QZ(this),this.indexManager=new CZ,this.remoteDocumentCache=function(n){return new UZ(n)}(s=>this.referenceDelegate.Wr(s)),this.serializer=new XO(r),this.Gr=new DZ(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new RZ,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let s=this.qr[e.toKey()];return s||(s=new OZ(r,this.referenceDelegate),this.qr[e.toKey()]=s),s}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,r,s){qt("MemoryPersistence","Starting transaction:",e);const n=new VZ(this.Qr.next());return this.referenceDelegate.zr(),s(n).next(i=>this.referenceDelegate.jr(n).next(()=>i)).toPromise().then(i=>(n.raiseOnCommittedEvent(),i))}Hr(e,r){return bt.or(Object.values(this.qr).map(s=>()=>s.containsKey(e,r)))}}class VZ extends rO{constructor(e){super(),this.currentSequenceNumber=e}}class rN{constructor(e){this.persistence=e,this.Jr=new y3,this.Yr=null}static Zr(e){return new rN(e)}get Xr(){if(this.Yr)return this.Yr;throw mr()}addReference(e,r,s){return this.Jr.addReference(s,r),this.Xr.delete(s.toString()),bt.resolve()}removeReference(e,r,s){return this.Jr.removeReference(s,r),this.Xr.add(s.toString()),bt.resolve()}markPotentiallyOrphaned(e,r){return this.Xr.add(r.toString()),bt.resolve()}removeTarget(e,r){this.Jr.gr(r.targetId).forEach(n=>this.Xr.add(n.toString()));const s=this.persistence.getTargetCache();return s.getMatchingKeysForTargetId(e,r.targetId).next(n=>{n.forEach(i=>this.Xr.add(i.toString()))}).next(()=>s.removeTargetData(e,r))}zr(){this.Yr=new Set}jr(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return bt.forEach(this.Xr,s=>{const n=nr.fromPath(s);return this.ei(e,n).next(i=>{i||r.removeEntry(n,Sr.min())})}).next(()=>(this.Yr=null,r.apply(e)))}updateLimboDocument(e,r){return this.ei(e,r).next(s=>{s?this.Xr.delete(r.toString()):this.Xr.add(r.toString())})}Wr(e){return 0}ei(e,r){return bt.or([()=>bt.resolve(this.Jr.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Hr(e,r)])}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HZ{constructor(e){this.serializer=e}O(e,r,s,n){const i=new q2("createOrUpgrade",r);s<1&&n>=1&&(function(c){c.createObjectStore("owner")}(e),function(c){c.createObjectStore("mutationQueues",{keyPath:"userId"}),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Mk,{unique:!0}),c.createObjectStore("documentMutations")}(e),E6(e),function(c){c.createObjectStore("remoteDocuments")}(e));let o=bt.resolve();return s<3&&n>=3&&(s!==0&&(function(c){c.deleteObjectStore("targetDocuments"),c.deleteObjectStore("targets"),c.deleteObjectStore("targetGlobal")}(e),E6(e)),o=o.next(()=>function(c){const d=c.store("targetGlobal"),u={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Sr.min().toTimestamp(),targetCount:0};return d.put("targetGlobalKey",u)}(i))),s<4&&n>=4&&(s!==0&&(o=o.next(()=>function(c,d){return d.store("mutations").U().next(u=>{c.deleteObjectStore("mutations"),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Mk,{unique:!0});const A=d.store("mutations"),h=u.map(f=>A.put(f));return bt.waitFor(h)})}(e,i))),o=o.next(()=>{(function(c){c.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),s<5&&n>=5&&(o=o.next(()=>this.ni(i))),s<6&&n>=6&&(o=o.next(()=>(function(c){c.createObjectStore("remoteDocumentGlobal")}(e),this.ri(i)))),s<7&&n>=7&&(o=o.next(()=>this.ii(i))),s<8&&n>=8&&(o=o.next(()=>this.si(e,i))),s<9&&n>=9&&(o=o.next(()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)})),s<10&&n>=10&&(o=o.next(()=>this.oi(i))),s<11&&n>=11&&(o=o.next(()=>{(function(c){c.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(c){c.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),s<12&&n>=12&&(o=o.next(()=>{(function(c){const d=c.createObjectStore("documentOverlays",{keyPath:wJ});d.createIndex("collectionPathOverlayIndex",NJ,{unique:!1}),d.createIndex("collectionGroupOverlayIndex",CJ,{unique:!1})})(e)})),s<13&&n>=13&&(o=o.next(()=>function(c){const d=c.createObjectStore("remoteDocumentsV14",{keyPath:uJ});d.createIndex("documentKeyIndex",AJ),d.createIndex("collectionGroupIndex",hJ)}(e)).next(()=>this._i(e,i)).next(()=>e.deleteObjectStore("remoteDocuments"))),s<14&&n>=14&&(o=o.next(()=>this.ai(e,i))),s<15&&n>=15&&(o=o.next(()=>function(c){c.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),c.createObjectStore("indexState",{keyPath:xJ}).createIndex("sequenceNumberIndex",yJ,{unique:!1}),c.createObjectStore("indexEntries",{keyPath:vJ}).createIndex("documentKeyIndex",bJ,{unique:!1})}(e))),s<16&&n>=16&&(o=o.next(()=>{r.objectStore("indexState").clear()}).next(()=>{r.objectStore("indexEntries").clear()})),s<17&&n>=17&&(o=o.next(()=>{(function(c){c.createObjectStore("globals",{keyPath:"name"})})(e)})),o}ri(e){let r=0;return e.store("remoteDocuments").J((s,n)=>{r+=kw(n)}).next(()=>{const s={byteSize:r};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",s)})}ni(e){const r=e.store("mutationQueues"),s=e.store("mutations");return r.U().next(n=>bt.forEach(n,i=>{const o=IDBKeyRange.bound([i.userId,-1],[i.userId,i.lastAcknowledgedBatchId]);return s.U("userMutationsIndex",o).next(l=>bt.forEach(l,c=>{br(c.userId===i.userId);const d=Hh(this.serializer,c);return rU(e,i.userId,d).next(()=>{})}))}))}ii(e){const r=e.store("targetDocuments"),s=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(n=>{const i=[];return s.J((o,l)=>{const c=new Cs(o),d=function(A){return[0,Xi(A)]}(c);i.push(r.get(d).next(u=>u?bt.resolve():(A=>r.put({targetId:0,path:Xi(A),sequenceNumber:n.highestListenSequenceNumber}))(c)))}).next(()=>bt.waitFor(i))})}si(e,r){e.createObjectStore("collectionParents",{keyPath:gJ});const s=r.store("collectionParents"),n=new x3,i=o=>{if(n.add(o)){const l=o.lastSegment(),c=o.popLast();return s.put({collectionId:l,parent:Xi(c)})}};return r.store("remoteDocuments").J({H:!0},(o,l)=>{const c=new Cs(o);return i(c.popLast())}).next(()=>r.store("documentMutations").J({H:!0},([o,l,c],d)=>{const u=Qc(l);return i(u.popLast())}))}oi(e){const r=e.store("targets");return r.J((s,n)=>{const i=Rg(n),o=JO(this.serializer,i);return r.put(o)})}_i(e,r){const s=r.store("remoteDocuments"),n=[];return s.J((i,o)=>{const l=r.store("remoteDocumentsV14"),c=function(A){return A.document?new nr(Cs.fromString(A.document.name).popFirst(5)):A.noDocument?nr.fromSegments(A.noDocument.path):A.unknownDocument?nr.fromSegments(A.unknownDocument.path):mr()}(o).path.toArray(),d={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};n.push(l.put(d))}).next(()=>bt.waitFor(n))}ai(e,r){const s=r.store("mutations"),n=iU(this.serializer),i=new lU(rN.Zr,this.serializer.ct);return s.U().next(o=>{const l=new Map;return o.forEach(c=>{var d;let u=(d=l.get(c.userId))!==null&&d!==void 0?d:es();Hh(this.serializer,c).keys().forEach(A=>u=u.add(A)),l.set(c.userId,u)}),bt.forEach(l,(c,d)=>{const u=new Ma(d),A=eN.lt(this.serializer,u),h=i.getIndexManager(u),f=tN.lt(u,this.serializer,h,i.referenceDelegate);return new oU(n,f,A,h).recalculateAndSaveOverlaysForDocumentKeys(new dj(r,xo.oe),c).next()})})}}function E6(t){t.createObjectStore("targetDocuments",{keyPath:mJ}).createIndex("documentTargetsIndex",pJ,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",fJ,{unique:!0}),t.createObjectStore("targetGlobal")}const V5="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class v3{constructor(e,r,s,n,i,o,l,c,d,u,A=17){if(this.allowTabSynchronization=e,this.persistenceKey=r,this.clientId=s,this.ui=i,this.window=o,this.document=l,this.ci=d,this.li=u,this.hi=A,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=h=>Promise.resolve(),!v3.D())throw new Gt(Tt.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new kZ(this,n),this.Ai=r+"main",this.serializer=new XO(c),this.Ri=new DA(this.Ai,this.hi,new HZ(this.serializer)),this.$r=new xZ,this.Ur=new SZ(this.referenceDelegate,this.serializer),this.remoteDocumentCache=iU(this.serializer),this.Gr=new gZ,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,u===!1&&ea("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Gt(Tt.FAILED_PRECONDITION,V5);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ur.getHighestSequenceNumber(e))}).then(e=>{this.Qr=new xo(e,this.ci)}).then(()=>{this.Kr=!0}).catch(e=>(this.Ri&&this.Ri.close(),Promise.reject(e)))}yi(e){return this.di=async r=>{if(this.started)return e(r)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L(async r=>{r.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget(async()=>{this.started&&await this.mi()}))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>o1(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.wi(e).next(r=>{r||(this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)))})}).next(()=>this.Si(e)).next(r=>this.isPrimary&&!r?this.bi(e).next(()=>!1):!!r&&this.Di(e).next(()=>!0))).catch(e=>{if(hh(e))return qt("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return qt("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ui.enqueueRetryable(()=>this.di(e)),this.isPrimary=e})}wi(e){return gg(e).get("owner").next(r=>bt.resolve(this.vi(r)))}Ci(e){return o1(e).delete(this.clientId)}async Fi(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",r=>{const s=Ta(r,"clientMetadata");return s.U().next(n=>{const i=this.xi(n,18e5),o=n.filter(l=>i.indexOf(l)===-1);return bt.forEach(o,l=>s.delete(l.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Vi)for(const r of e)this.Vi.removeItem(this.Oi(r.clientId))}}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.Fi()).then(()=>this.pi()))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?bt.resolve(!0):gg(e).get("owner").next(r=>{if(r!==null&&this.Mi(r.leaseTimestampMs,5e3)&&!this.Ni(r.ownerId)){if(this.vi(r)&&this.networkEnabled)return!0;if(!this.vi(r)){if(!r.allowTabSynchronization)throw new Gt(Tt.FAILED_PRECONDITION,V5);return!1}}return!(!this.networkEnabled||!this.inForeground)||o1(e).U().next(s=>this.xi(s,5e3).find(n=>{if(this.clientId!==n.clientId){const i=!this.networkEnabled&&n.networkEnabled,o=!this.inForeground&&n.inForeground,l=this.networkEnabled===n.networkEnabled;if(i||o&&l)return!0}return!1})===void 0)}).next(r=>(this.isPrimary!==r&&qt("IndexedDbPersistence",`Client ${r?"is":"is not"} eligible for a primary lease.`),r))}async shutdown(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),await this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const r=new dj(e,xo.oe);return this.bi(r).next(()=>this.Ci(r))}),this.Ri.close(),this.qi()}xi(e,r){return e.filter(s=>this.Mi(s.updateTimeMs,r)&&!this.Ni(s.clientId))}Qi(){return this.runTransaction("getActiveClients","readonly",e=>o1(e).U().next(r=>this.xi(r,18e5).map(s=>s.clientId)))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,r){return tN.lt(e,this.serializer,r,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new jZ(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return eN.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,r,s){qt("IndexedDbPersistence","Starting transaction:",e);const n=r==="readonly"?"readonly":"readwrite",i=function(c){return c===17?EJ:c===16?SJ:c===15?a3:c===14?lO:c===13?oO:c===12?jJ:c===11?iO:void mr()}(this.hi);let o;return this.Ri.runTransaction(e,n,i,l=>(o=new dj(l,this.Qr?this.Qr.next():xo.oe),r==="readwrite-primary"?this.wi(o).next(c=>!!c||this.Si(o)).next(c=>{if(!c)throw ea(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)),new Gt(Tt.FAILED_PRECONDITION,tO);return s(o)}).next(c=>this.Di(o).next(()=>c)):this.Ki(o).next(()=>s(o)))).then(l=>(o.raiseOnCommittedEvent(),l))}Ki(e){return gg(e).get("owner").next(r=>{if(r!==null&&this.Mi(r.leaseTimestampMs,5e3)&&!this.Ni(r.ownerId)&&!this.vi(r)&&!(this.li||this.allowTabSynchronization&&r.allowTabSynchronization))throw new Gt(Tt.FAILED_PRECONDITION,V5)})}Di(e){const r={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return gg(e).put("owner",r)}static D(){return DA.D()}bi(e){const r=gg(e);return r.get("owner").next(s=>this.vi(s)?(qt("IndexedDbPersistence","Releasing primary lease."),r.delete("owner")):bt.resolve())}Mi(e,r){const s=Date.now();return!(e<s-r)&&(!(e>s)||(ea(`Detected an update time that is in the future: ${e} > ${s}`),!1))}fi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ii=()=>{this.ui.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.mi()))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground=this.document.visibilityState==="visible")}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Pi=()=>{this.Li();const r=/(?:Version|Mobile)\/1[456]/;rL()&&(navigator.appVersion.match(r)||navigator.userAgent.match(r))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var r;try{const s=((r=this.Vi)===null||r===void 0?void 0:r.getItem(this.Oi(e)))!==null;return qt("IndexedDbPersistence",`Client '${e}' ${s?"is":"is not"} zombied in LocalStorage`),s}catch(s){return ea("IndexedDbPersistence","Failed to get zombied client id.",s),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){ea("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function gg(t){return Ta(t,"owner")}function o1(t){return Ta(t,"clientMetadata")}function cU(t,e){let r=t.projectId;return t.isDefaultDatabase||(r+="."+t.database),"firestore/"+e+"/"+r+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b3{constructor(e,r,s,n){this.targetId=e,this.fromCache=r,this.$i=s,this.Ui=n}static Wi(e,r){let s=es(),n=es();for(const i of r.docChanges)switch(i.type){case 0:s=s.add(i.doc.key);break;case 1:n=n.add(i.doc.key)}return new b3(e,r.fromCache,s,n)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $Z{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dU{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return rL()?8:sO(Ea())>0?6:4}()}initialize(e,r){this.Ji=e,this.indexManager=r,this.Gi=!0}getDocumentsMatchingQuery(e,r,s,n){const i={result:null};return this.Yi(e,r).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.Zi(e,r,n,s).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new $Z;return this.Xi(e,r,o).next(l=>{if(i.result=l,this.zi)return this.es(e,r,o,l.size)})}).next(()=>i.result)}es(e,r,s,n){return s.documentReadCount<this.ji?(Wm()<=cs.DEBUG&&qt("QueryEngine","SDK will not create cache indexes for query:",Gm(r),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),bt.resolve()):(Wm()<=cs.DEBUG&&qt("QueryEngine","Query:",Gm(r),"scans",s.documentReadCount,"local documents and returns",n,"documents as results."),s.documentReadCount>this.Hi*n?(Wm()<=cs.DEBUG&&qt("QueryEngine","The SDK decides to create cache indexes for query:",Gm(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Wo(r))):bt.resolve())}Yi(e,r){if(Zk(r))return bt.resolve(null);let s=Wo(r);return this.indexManager.getIndexType(e,s).next(n=>n===0?null:(r.limit!==null&&n===1&&(r=Sw(r,null,"F"),s=Wo(r)),this.indexManager.getDocumentsMatchingTarget(e,s).next(i=>{const o=es(...i);return this.Ji.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,s).next(c=>{const d=this.ts(r,l);return this.ns(r,d,o,c.readTime)?this.Yi(e,Sw(r,null,"F")):this.rs(e,d,r,c)}))})))}Zi(e,r,s,n){return Zk(r)||n.isEqual(Sr.min())?bt.resolve(null):this.Ji.getDocuments(e,s).next(i=>{const o=this.ts(r,i);return this.ns(r,o,s,n)?bt.resolve(null):(Wm()<=cs.DEBUG&&qt("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),Gm(r)),this.rs(e,o,r,ZL(n,-1)).next(l=>l))})}ts(e,r){let s=new zs(CO(e));return r.forEach((n,i)=>{Hy(e,i)&&(s=s.add(i))}),s}ns(e,r,s,n){if(e.limit===null)return!1;if(s.size!==r.size)return!0;const i=e.limitType==="F"?r.last():r.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(n)>0)}Xi(e,r,s){return Wm()<=cs.DEBUG&&qt("QueryEngine","Using full collection scan to execute query:",Gm(r)),this.Ji.getDocumentsMatchingQuery(e,r,Xo.min(),s)}rs(e,r,s,n){return this.Ji.getDocumentsMatchingQuery(e,s,n).next(i=>(r.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KZ{constructor(e,r,s,n){this.persistence=e,this.ss=r,this.serializer=n,this.os=new an($r),this._s=new fh(i=>Pf(i),Qy),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(s)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new oU(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.os))}}function uU(t,e,r,s){return new KZ(t,e,r,s)}async function AU(t,e){const r=pr(t);return await r.persistence.runTransaction("Handle user change","readonly",s=>{let n;return r.mutationQueue.getAllMutationBatches(s).next(i=>(n=i,r.ls(e),r.mutationQueue.getAllMutationBatches(s))).next(i=>{const o=[],l=[];let c=es();for(const d of n){o.push(d.batchId);for(const u of d.mutations)c=c.add(u.key)}for(const d of i){l.push(d.batchId);for(const u of d.mutations)c=c.add(u.key)}return r.localDocuments.getDocuments(s,c).next(d=>({hs:d,removedBatchIds:o,addedBatchIds:l}))})})}function zZ(t,e){const r=pr(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",s=>{const n=e.batch.keys(),i=r.cs.newChangeBuffer({trackRemovals:!0});return function(l,c,d,u){const A=d.batch,h=A.keys();let f=bt.resolve();return h.forEach(p=>{f=f.next(()=>u.getEntry(c,p)).next(m=>{const g=d.docVersions.get(p);br(g!==null),m.version.compareTo(g)<0&&(A.applyToRemoteDocument(m,d),m.isValidDocument()&&(m.setReadTime(d.commitVersion),u.addEntry(m)))})}),f.next(()=>l.mutationQueue.removeMutationBatch(c,A))}(r,s,e,i).next(()=>i.apply(s)).next(()=>r.mutationQueue.performConsistencyCheck(s)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(s,n,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(s,function(l){let c=es();for(let d=0;d<l.mutationResults.length;++d)l.mutationResults[d].transformResults.length>0&&(c=c.add(l.batch.mutations[d].key));return c}(e))).next(()=>r.localDocuments.getDocuments(s,n))})}function hU(t){const e=pr(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Ur.getLastRemoteSnapshotVersion(r))}function qZ(t,e){const r=pr(t),s=e.snapshotVersion;let n=r.os;return r.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=r.cs.newChangeBuffer({trackRemovals:!0});n=r.os;const l=[];e.targetChanges.forEach((u,A)=>{const h=n.get(A);if(!h)return;l.push(r.Ur.removeMatchingKeys(i,u.removedDocuments,A).next(()=>r.Ur.addMatchingKeys(i,u.addedDocuments,A)));let f=h.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(A)!==null?f=f.withResumeToken(aa.EMPTY_BYTE_STRING,Sr.min()).withLastLimboFreeSnapshotVersion(Sr.min()):u.resumeToken.approximateByteSize()>0&&(f=f.withResumeToken(u.resumeToken,s)),n=n.insert(A,f),function(m,g,y){return m.resumeToken.approximateByteSize()===0||g.snapshotVersion.toMicroseconds()-m.snapshotVersion.toMicroseconds()>=3e8?!0:y.addedDocuments.size+y.modifiedDocuments.size+y.removedDocuments.size>0}(h,f,u)&&l.push(r.Ur.updateTargetData(i,f))});let c=Ko(),d=es();if(e.documentUpdates.forEach(u=>{e.resolvedLimboDocuments.has(u)&&l.push(r.persistence.referenceDelegate.updateLimboDocument(i,u))}),l.push(WZ(i,o,e.documentUpdates).next(u=>{c=u.Ps,d=u.Is})),!s.isEqual(Sr.min())){const u=r.Ur.getLastRemoteSnapshotVersion(i).next(A=>r.Ur.setTargetsMetadata(i,i.currentSequenceNumber,s));l.push(u)}return bt.waitFor(l).next(()=>o.apply(i)).next(()=>r.localDocuments.getLocalViewOfDocuments(i,c,d)).next(()=>c)}).then(i=>(r.os=n,i))}function WZ(t,e,r){let s=es(),n=es();return r.forEach(i=>s=s.add(i)),e.getEntries(t,s).next(i=>{let o=Ko();return r.forEach((l,c)=>{const d=i.get(l);c.isFoundDocument()!==d.isFoundDocument()&&(n=n.add(l)),c.isNoDocument()&&c.version.isEqual(Sr.min())?(e.removeEntry(l,c.readTime),o=o.insert(l,c)):!d.isValidDocument()||c.version.compareTo(d.version)>0||c.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(c),o=o.insert(l,c)):qt("LocalStore","Ignoring outdated watch update for ",l,". Current version:",d.version," Watch version:",c.version)}),{Ps:o,Is:n}})}function GZ(t,e){const r=pr(t);return r.persistence.runTransaction("Get next mutation batch","readonly",s=>(e===void 0&&(e=-1),r.mutationQueue.getNextMutationBatchAfterBatchId(s,e)))}function Bw(t,e){const r=pr(t);return r.persistence.runTransaction("Allocate target","readwrite",s=>{let n;return r.Ur.getTargetData(s,e).next(i=>i?(n=i,bt.resolve(n)):r.Ur.allocateTargetId(s).next(o=>(n=new Md(e,o,"TargetPurposeListen",s.currentSequenceNumber),r.Ur.addTargetData(s,n).next(()=>n))))}).then(s=>{const n=r.os.get(s.targetId);return(n===null||s.snapshotVersion.compareTo(n.snapshotVersion)>0)&&(r.os=r.os.insert(s.targetId,s),r._s.set(e,s.targetId)),s})}async function cp(t,e,r){const s=pr(t),n=s.os.get(e),i=r?"readwrite":"readwrite-primary";try{r||await s.persistence.runTransaction("Release target",i,o=>s.persistence.referenceDelegate.removeTarget(o,n))}catch(o){if(!hh(o))throw o;qt("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}s.os=s.os.remove(e),s._s.delete(n.target)}function Cj(t,e,r){const s=pr(t);let n=Sr.min(),i=es();return s.persistence.runTransaction("Execute query","readwrite",o=>function(c,d,u){const A=pr(c),h=A._s.get(u);return h!==void 0?bt.resolve(A.os.get(h)):A.Ur.getTargetData(d,u)}(s,o,Wo(e)).next(l=>{if(l)return n=l.lastLimboFreeSnapshotVersion,s.Ur.getMatchingKeysForTargetId(o,l.targetId).next(c=>{i=c})}).next(()=>s.ss.getDocumentsMatchingQuery(o,e,r?n:Sr.min(),r?i:es())).next(l=>(pU(s,NO(e),l),{documents:l,Ts:i})))}function fU(t,e){const r=pr(t),s=pr(r.Ur),n=r.os.get(e);return n?Promise.resolve(n.target):r.persistence.runTransaction("Get target data","readonly",i=>s.ot(i,e).next(o=>o?o.target:null))}function mU(t,e){const r=pr(t),s=r.us.get(e)||Sr.min();return r.persistence.runTransaction("Get new document changes","readonly",n=>r.cs.getAllFromCollectionGroup(n,e,ZL(s,-1),Number.MAX_SAFE_INTEGER)).then(n=>(pU(r,e,n),n))}function pU(t,e,r){let s=t.us.get(e)||Sr.min();r.forEach((n,i)=>{i.readTime.compareTo(s)>0&&(s=i.readTime)}),t.us.set(e,s)}function _6(t,e){return`firestore_clients_${t}_${e}`}function T6(t,e,r){let s=`firestore_mutations_${t}_${r}`;return e.isAuthenticated()&&(s+=`_${e.uid}`),s}function H5(t,e){return`firestore_targets_${t}_${e}`}class Fw{constructor(e,r,s,n){this.user=e,this.batchId=r,this.state=s,this.error=n}static Rs(e,r,s){const n=JSON.parse(s);let i,o=typeof n=="object"&&["pending","acknowledged","rejected"].indexOf(n.state)!==-1&&(n.error===void 0||typeof n.error=="object");return o&&n.error&&(o=typeof n.error.message=="string"&&typeof n.error.code=="string",o&&(i=new Gt(n.error.code,n.error.message))),o?new Fw(e,r,n.state,i):(ea("SharedClientState",`Failed to parse mutation state for ID '${r}': ${s}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class cx{constructor(e,r,s){this.targetId=e,this.state=r,this.error=s}static Rs(e,r){const s=JSON.parse(r);let n,i=typeof s=="object"&&["not-current","current","rejected"].indexOf(s.state)!==-1&&(s.error===void 0||typeof s.error=="object");return i&&s.error&&(i=typeof s.error.message=="string"&&typeof s.error.code=="string",i&&(n=new Gt(s.error.code,s.error.message))),i?new cx(e,s.state,n):(ea("SharedClientState",`Failed to parse target state for ID '${e}': ${r}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Pw{constructor(e,r){this.clientId=e,this.activeTargetIds=r}static Rs(e,r){const s=JSON.parse(r);let n=typeof s=="object"&&s.activeTargetIds instanceof Array,i=c3();for(let o=0;n&&o<s.activeTargetIds.length;++o)n=nO(s.activeTargetIds[o]),i=i.add(s.activeTargetIds[o]);return n?new Pw(e,i):(ea("SharedClientState",`Failed to parse client data for instance '${e}': ${r}`),null)}}class w3{constructor(e,r){this.clientId=e,this.onlineState=r}static Rs(e){const r=JSON.parse(e);return typeof r=="object"&&["Unknown","Online","Offline"].indexOf(r.onlineState)!==-1&&typeof r.clientId=="string"?new w3(r.clientId,r.onlineState):(ea("SharedClientState",`Failed to parse online state: ${e}`),null)}}class jj{constructor(){this.activeTargetIds=c3()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class $5{constructor(e,r,s,n,i){this.window=e,this.ui=r,this.persistenceKey=s,this.ps=n,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ys=this.ws.bind(this),this.Ss=new an($r),this.started=!1,this.bs=[];const o=s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Ds=_6(this.persistenceKey,this.ps),this.vs=function(c){return`firestore_sequence_number_${c}`}(this.persistenceKey),this.Ss=this.Ss.insert(this.ps,new jj),this.Cs=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.Fs=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Ms=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.xs=function(c){return`firestore_online_state_${c}`}(this.persistenceKey),this.Os=function(c){return`firestore_bundle_loaded_v2_${c}`}(this.persistenceKey),this.window.addEventListener("storage",this.ys)}static D(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Qi();for(const s of e){if(s===this.ps)continue;const n=this.getItem(_6(this.persistenceKey,s));if(n){const i=Pw.Rs(s,n);i&&(this.Ss=this.Ss.insert(i.clientId,i))}}this.Ns();const r=this.storage.getItem(this.xs);if(r){const s=this.Ls(r);s&&this.Bs(s)}for(const s of this.bs)this.ws(s);this.bs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.vs,JSON.stringify(e))}getAllActiveQueryTargets(){return this.ks(this.Ss)}isActiveQueryTarget(e){let r=!1;return this.Ss.forEach((s,n)=>{n.activeTargetIds.has(e)&&(r=!0)}),r}addPendingMutation(e){this.qs(e,"pending")}updateMutationState(e,r,s){this.qs(e,r,s),this.Qs(e)}addLocalQueryTarget(e,r=!0){let s="not-current";if(this.isActiveQueryTarget(e)){const n=this.storage.getItem(H5(this.persistenceKey,e));if(n){const i=cx.Rs(e,n);i&&(s=i.state)}}return r&&this.Ks.fs(e),this.Ns(),s}removeLocalQueryTarget(e){this.Ks.gs(e),this.Ns()}isLocalQueryTarget(e){return this.Ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(H5(this.persistenceKey,e))}updateQueryState(e,r,s){this.$s(e,r,s)}handleUserChange(e,r,s){r.forEach(n=>{this.Qs(n)}),this.currentUser=e,s.forEach(n=>{this.addPendingMutation(n)})}setOnlineState(e){this.Us(e)}notifyBundleLoaded(e){this.Ws(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ys),this.removeItem(this.Ds),this.started=!1)}getItem(e){const r=this.storage.getItem(e);return qt("SharedClientState","READ",e,r),r}setItem(e,r){qt("SharedClientState","SET",e,r),this.storage.setItem(e,r)}removeItem(e){qt("SharedClientState","REMOVE",e),this.storage.removeItem(e)}ws(e){const r=e;if(r.storageArea===this.storage){if(qt("SharedClientState","EVENT",r.key,r.newValue),r.key===this.Ds)return void ea("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ui.enqueueRetryable(async()=>{if(this.started){if(r.key!==null){if(this.Cs.test(r.key)){if(r.newValue==null){const s=this.Gs(r.key);return this.zs(s,null)}{const s=this.js(r.key,r.newValue);if(s)return this.zs(s.clientId,s)}}else if(this.Fs.test(r.key)){if(r.newValue!==null){const s=this.Hs(r.key,r.newValue);if(s)return this.Js(s)}}else if(this.Ms.test(r.key)){if(r.newValue!==null){const s=this.Ys(r.key,r.newValue);if(s)return this.Zs(s)}}else if(r.key===this.xs){if(r.newValue!==null){const s=this.Ls(r.newValue);if(s)return this.Bs(s)}}else if(r.key===this.vs){const s=function(i){let o=xo.oe;if(i!=null)try{const l=JSON.parse(i);br(typeof l=="number"),o=l}catch(l){ea("SharedClientState","Failed to read sequence number from WebStorage",l)}return o}(r.newValue);s!==xo.oe&&this.sequenceNumberHandler(s)}else if(r.key===this.Os){const s=this.Xs(r.newValue);await Promise.all(s.map(n=>this.syncEngine.eo(n)))}}}else this.bs.push(r)})}}get Ks(){return this.Ss.get(this.ps)}Ns(){this.setItem(this.Ds,this.Ks.Vs())}qs(e,r,s){const n=new Fw(this.currentUser,e,r,s),i=T6(this.persistenceKey,this.currentUser,e);this.setItem(i,n.Vs())}Qs(e){const r=T6(this.persistenceKey,this.currentUser,e);this.removeItem(r)}Us(e){const r={clientId:this.ps,onlineState:e};this.storage.setItem(this.xs,JSON.stringify(r))}$s(e,r,s){const n=H5(this.persistenceKey,e),i=new cx(e,r,s);this.setItem(n,i.Vs())}Ws(e){const r=JSON.stringify(Array.from(e));this.setItem(this.Os,r)}Gs(e){const r=this.Cs.exec(e);return r?r[1]:null}js(e,r){const s=this.Gs(e);return Pw.Rs(s,r)}Hs(e,r){const s=this.Fs.exec(e),n=Number(s[1]),i=s[2]!==void 0?s[2]:null;return Fw.Rs(new Ma(i),n,r)}Ys(e,r){const s=this.Ms.exec(e),n=Number(s[1]);return cx.Rs(n,r)}Ls(e){return w3.Rs(e)}Xs(e){return JSON.parse(e)}async Js(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.no(e.batchId,e.state,e.error);qt("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}Zs(e){return this.syncEngine.ro(e.targetId,e.state,e.error)}zs(e,r){const s=r?this.Ss.insert(e,r):this.Ss.remove(e),n=this.ks(this.Ss),i=this.ks(s),o=[],l=[];return i.forEach(c=>{n.has(c)||o.push(c)}),n.forEach(c=>{i.has(c)||l.push(c)}),this.syncEngine.io(o,l).then(()=>{this.Ss=s})}Bs(e){this.Ss.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}ks(e){let r=c3();return e.forEach((s,n)=>{r=r.unionWith(n.activeTargetIds)}),r}}class gU{constructor(){this.so=new jj,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,s){}addLocalQueryTarget(e,r=!0){return r&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,r,s){this.oo[e]=r}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new jj,Promise.resolve()}handleUserChange(e,r,s){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YZ{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I6{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){qt("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){qt("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let l1=null;function K5(){return l1===null?l1=function(){return 268435456+Math.round(2147483648*Math.random())}():l1++,"0x"+l1.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XZ={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JZ{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hi="WebChannelConnection";class ZZ extends class{constructor(r){this.databaseInfo=r,this.databaseId=r.databaseId;const s=r.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Do=s+"://"+r.host,this.vo=`projects/${n}/databases/${i}`,this.Co=this.databaseId.database==="(default)"?`project_id=${n}`:`project_id=${n}&database_id=${i}`}get Fo(){return!1}Mo(r,s,n,i,o){const l=K5(),c=this.xo(r,s.toUriEncodedString());qt("RestConnection",`Sending RPC '${r}' ${l}:`,c,n);const d={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(d,i,o),this.No(r,c,d,n).then(u=>(qt("RestConnection",`Received RPC '${r}' ${l}: `,u),u),u=>{throw If("RestConnection",`RPC '${r}' ${l} failed with error: `,u,"url: ",c,"request:",n),u})}Lo(r,s,n,i,o,l){return this.Mo(r,s,n,i,o)}Oo(r,s,n){r["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+kp}(),r["Content-Type"]="text/plain",this.databaseInfo.appId&&(r["X-Firebase-GMPID"]=this.databaseInfo.appId),s&&s.headers.forEach((i,o)=>r[o]=i),n&&n.headers.forEach((i,o)=>r[o]=i)}xo(r,s){const n=XZ[r];return`${this.Do}/v1/${s}:${n}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,r,s,n){const i=K5();return new Promise((o,l)=>{const c=new KL;c.setWithCredentials(!0),c.listenOnce(zL.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case Nb.NO_ERROR:const u=c.getResponseJson();qt(hi,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(u)),o(u);break;case Nb.TIMEOUT:qt(hi,`RPC '${e}' ${i} timed out`),l(new Gt(Tt.DEADLINE_EXCEEDED,"Request time out"));break;case Nb.HTTP_ERROR:const A=c.getStatus();if(qt(hi,`RPC '${e}' ${i} failed with status:`,A,"response text:",c.getResponseText()),A>0){let h=c.getResponseJson();Array.isArray(h)&&(h=h[0]);const f=h==null?void 0:h.error;if(f&&f.status&&f.message){const p=function(g){const y=g.toLowerCase().replace(/_/g,"-");return Object.values(Tt).indexOf(y)>=0?y:Tt.UNKNOWN}(f.status);l(new Gt(p,f.message))}else l(new Gt(Tt.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new Gt(Tt.UNAVAILABLE,"Connection failed."));break;default:mr()}}finally{qt(hi,`RPC '${e}' ${i} completed.`)}});const d=JSON.stringify(n);qt(hi,`RPC '${e}' ${i} sending request:`,n),c.send(r,"POST",d,s,15)})}Bo(e,r,s){const n=K5(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=GL(),l=WL(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(c.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Oo(c.initMessageHeaders,r,s),c.encodeInitMessageHeaders=!0;const u=i.join("");qt(hi,`Creating RPC '${e}' stream ${n}: ${u}`,c);const A=o.createWebChannel(u,c);let h=!1,f=!1;const p=new JZ({Io:g=>{f?qt(hi,`Not sending because RPC '${e}' stream ${n} is closed:`,g):(h||(qt(hi,`Opening RPC '${e}' stream ${n} transport.`),A.open(),h=!0),qt(hi,`RPC '${e}' stream ${n} sending:`,g),A.send(g))},To:()=>A.close()}),m=(g,y,v)=>{g.listen(y,x=>{try{v(x)}catch(E){setTimeout(()=>{throw E},0)}})};return m(A,Fg.EventType.OPEN,()=>{f||(qt(hi,`RPC '${e}' stream ${n} transport opened.`),p.yo())}),m(A,Fg.EventType.CLOSE,()=>{f||(f=!0,qt(hi,`RPC '${e}' stream ${n} transport closed`),p.So())}),m(A,Fg.EventType.ERROR,g=>{f||(f=!0,If(hi,`RPC '${e}' stream ${n} transport errored:`,g),p.So(new Gt(Tt.UNAVAILABLE,"The operation could not be completed")))}),m(A,Fg.EventType.MESSAGE,g=>{var y;if(!f){const v=g.data[0];br(!!v);const x=v,E=x.error||((y=x[0])===null||y===void 0?void 0:y.error);if(E){qt(hi,`RPC '${e}' stream ${n} received error:`,E);const T=E.status;let j=function(S){const F=ua[S];if(F!==void 0)return LO(F)}(T),C=E.message;j===void 0&&(j=Tt.INTERNAL,C="Unknown error status: "+T+" with message "+E.message),f=!0,p.So(new Gt(j,C)),A.close()}else qt(hi,`RPC '${e}' stream ${n} received:`,v),p.bo(v)}}),m(l,qL.STAT_EVENT,g=>{g.stat===lj.PROXY?qt(hi,`RPC '${e}' stream ${n} detected buffering proxy`):g.stat===lj.NOPROXY&&qt(hi,`RPC '${e}' stream ${n} detected no buffering proxy`)}),setTimeout(()=>{p.wo()},0),p}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xU(){return typeof window<"u"?window:null}function Ib(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sN(t){return new iZ(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yU{constructor(e,r,s=1e3,n=1.5,i=6e4){this.ui=e,this.timerId=r,this.ko=s,this.qo=n,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const r=Math.floor(this.Ko+this.zo()),s=Math.max(0,Date.now()-this.Uo),n=Math.max(0,r-s);n>0&&qt("ExponentialBackoff",`Backing off for ${n} ms (base delay: ${this.Ko} ms, delay with jitter: ${r} ms, last attempt: ${s} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,n,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vU{constructor(e,r,s,n,i,o,l,c){this.ui=e,this.Ho=s,this.Jo=n,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=c,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new yU(e,r)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,r){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():r&&r.code===Tt.RESOURCE_EXHAUSTED?(ea(r.toString()),ea("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):r&&r.code===Tt.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(r)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),r=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([s,n])=>{this.Yo===r&&this.P_(s,n)},s=>{e(()=>{const n=new Gt(Tt.UNKNOWN,"Fetching auth token failed: "+s.message);return this.I_(n)})})}P_(e,r){const s=this.h_(this.Yo);this.stream=this.T_(e,r),this.stream.Eo(()=>{s(()=>this.listener.Eo())}),this.stream.Ro(()=>{s(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(n=>{s(()=>this.I_(n))}),this.stream.onMessage(n=>{s(()=>++this.e_==1?this.E_(n):this.onNext(n))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return qt("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return r=>{this.ui.enqueueAndForget(()=>this.Yo===e?r():(qt("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class eee extends vU{constructor(e,r,s,n,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,s,n,o),this.serializer=i}T_(e,r){return this.connection.Bo("Listen",e,r)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const r=cZ(this.serializer,e),s=function(i){if(!("targetChange"in i))return Sr.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?Sr.min():o.readTime?Ji(o.readTime):Sr.min()}(e);return this.listener.d_(r,s)}A_(e){const r={};r.database=yj(this.serializer),r.addTarget=function(i,o){let l;const c=o.target;if(l=Cw(c)?{documents:KO(i,c)}:{query:zO(i,c)._t},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=MO(i,o.resumeToken);const d=gj(i,o.expectedCount);d!==null&&(l.expectedCount=d)}else if(o.snapshotVersion.compareTo(Sr.min())>0){l.readTime=lp(i,o.snapshotVersion.toTimestamp());const d=gj(i,o.expectedCount);d!==null&&(l.expectedCount=d)}return l}(this.serializer,e);const s=uZ(this.serializer,e);s&&(r.labels=s),this.a_(r)}R_(e){const r={};r.database=yj(this.serializer),r.removeTarget=e,this.a_(r)}}class tee extends vU{constructor(e,r,s,n,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,s,n,o),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,r){return this.connection.Bo("Write",e,r)}E_(e){return br(!!e.streamToken),this.lastStreamToken=e.streamToken,br(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){br(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const r=dZ(e.writeResults,e.commitTime),s=Ji(e.commitTime);return this.listener.g_(s,r)}p_(){const e={};e.database=yj(this.serializer),this.a_(e)}m_(e){const r={streamToken:this.lastStreamToken,writes:e.map(s=>_w(this.serializer,s))};this.a_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ree extends class{}{constructor(e,r,s,n){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=s,this.serializer=n,this.y_=!1}w_(){if(this.y_)throw new Gt(Tt.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,r,s,n){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Mo(e,xj(r,s),n,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===Tt.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Gt(Tt.UNKNOWN,i.toString())})}Lo(e,r,s,n,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Lo(e,xj(r,s),n,o,l,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===Tt.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Gt(Tt.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class see{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(ea(r),this.D_=!1):qt("OnlineStateTracker",r)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nee{constructor(e,r,s,n,i){this.localStore=e,this.datastore=r,this.asyncQueue=s,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o(o=>{s.enqueueAndForget(async()=>{Zf(this)&&(qt("RemoteStore","Restarting streams for network reachability change."),await async function(c){const d=pr(c);d.L_.add(4),await qy(d),d.q_.set("Unknown"),d.L_.delete(4),await nN(d)}(this))})}),this.q_=new see(s,n)}}async function nN(t){if(Zf(t))for(const e of t.B_)await e(!0)}async function qy(t){for(const e of t.B_)await e(!1)}function aN(t,e){const r=pr(t);r.N_.has(e.targetId)||(r.N_.set(e.targetId,e),j3(r)?C3(r):Pp(r).r_()&&N3(r,e))}function dp(t,e){const r=pr(t),s=Pp(r);r.N_.delete(e),s.r_()&&bU(r,e),r.N_.size===0&&(s.r_()?s.o_():Zf(r)&&r.q_.set("Unknown"))}function N3(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Sr.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}Pp(t).A_(e)}function bU(t,e){t.Q_.xe(e),Pp(t).R_(e)}function C3(t){t.Q_=new rZ({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),Pp(t).start(),t.q_.v_()}function j3(t){return Zf(t)&&!Pp(t).n_()&&t.N_.size>0}function Zf(t){return pr(t).L_.size===0}function wU(t){t.Q_=void 0}async function aee(t){t.q_.set("Online")}async function iee(t){t.N_.forEach((e,r)=>{N3(t,e)})}async function oee(t,e){wU(t),j3(t)?(t.q_.M_(e),C3(t)):t.q_.set("Unknown")}async function lee(t,e,r){if(t.q_.set("Online"),e instanceof UO&&e.state===2&&e.cause)try{await async function(n,i){const o=i.cause;for(const l of i.targetIds)n.N_.has(l)&&(await n.remoteSyncer.rejectListen(l,o),n.N_.delete(l),n.Q_.removeTarget(l))}(t,e)}catch(s){qt("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),s),await Dw(t,s)}else if(e instanceof Tb?t.Q_.Ke(e):e instanceof OO?t.Q_.He(e):t.Q_.We(e),!r.isEqual(Sr.min()))try{const s=await hU(t.localStore);r.compareTo(s)>=0&&await function(i,o){const l=i.Q_.rt(o);return l.targetChanges.forEach((c,d)=>{if(c.resumeToken.approximateByteSize()>0){const u=i.N_.get(d);u&&i.N_.set(d,u.withResumeToken(c.resumeToken,o))}}),l.targetMismatches.forEach((c,d)=>{const u=i.N_.get(c);if(!u)return;i.N_.set(c,u.withResumeToken(aa.EMPTY_BYTE_STRING,u.snapshotVersion)),bU(i,c);const A=new Md(u.target,c,d,u.sequenceNumber);N3(i,A)}),i.remoteSyncer.applyRemoteEvent(l)}(t,r)}catch(s){qt("RemoteStore","Failed to raise snapshot:",s),await Dw(t,s)}}async function Dw(t,e,r){if(!hh(e))throw e;t.L_.add(1),await qy(t),t.q_.set("Offline"),r||(r=()=>hU(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{qt("RemoteStore","Retrying IndexedDB access"),await r(),t.L_.delete(1),await nN(t)})}function NU(t,e){return e().catch(r=>Dw(t,r,e))}async function Fp(t){const e=pr(t),r=WA(e);let s=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;cee(e);)try{const n=await GZ(e.localStore,s);if(n===null){e.O_.length===0&&r.o_();break}s=n.batchId,dee(e,n)}catch(n){await Dw(e,n)}CU(e)&&jU(e)}function cee(t){return Zf(t)&&t.O_.length<10}function dee(t,e){t.O_.push(e);const r=WA(t);r.r_()&&r.V_&&r.m_(e.mutations)}function CU(t){return Zf(t)&&!WA(t).n_()&&t.O_.length>0}function jU(t){WA(t).start()}async function uee(t){WA(t).p_()}async function Aee(t){const e=WA(t);for(const r of t.O_)e.m_(r.mutations)}async function hee(t,e,r){const s=t.O_.shift(),n=h3.from(s,e,r);await NU(t,()=>t.remoteSyncer.applySuccessfulWrite(n)),await Fp(t)}async function fee(t,e){e&&WA(t).V_&&await async function(s,n){if(function(o){return ZJ(o)&&o!==Tt.ABORTED}(n.code)){const i=s.O_.shift();WA(s).s_(),await NU(s,()=>s.remoteSyncer.rejectFailedWrite(i.batchId,n)),await Fp(s)}}(t,e),CU(t)&&jU(t)}async function k6(t,e){const r=pr(t);r.asyncQueue.verifyOperationInProgress(),qt("RemoteStore","RemoteStore received new credentials");const s=Zf(r);r.L_.add(3),await qy(r),s&&r.q_.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.L_.delete(3),await nN(r)}async function Sj(t,e){const r=pr(t);e?(r.L_.delete(2),await nN(r)):e||(r.L_.add(2),await qy(r),r.q_.set("Unknown"))}function Pp(t){return t.K_||(t.K_=function(r,s,n){const i=pr(r);return i.w_(),new eee(s,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,n)}(t.datastore,t.asyncQueue,{Eo:aee.bind(null,t),Ro:iee.bind(null,t),mo:oee.bind(null,t),d_:lee.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),j3(t)?C3(t):t.q_.set("Unknown")):(await t.K_.stop(),wU(t))})),t.K_}function WA(t){return t.U_||(t.U_=function(r,s,n){const i=pr(r);return i.w_(),new tee(s,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,n)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:uee.bind(null,t),mo:fee.bind(null,t),f_:Aee.bind(null,t),g_:hee.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await Fp(t)):(await t.U_.stop(),t.O_.length>0&&(qt("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S3{constructor(e,r,s,n,i){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=s,this.op=n,this.removalCallback=i,this.deferred=new Xc,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,s,n,i){const o=Date.now()+s,l=new S3(e,r,o,n,i);return l.start(s),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Gt(Tt.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function E3(t,e){if(ea("AsyncQueue",`${e}: ${t}`),hh(t))return new Gt(Tt.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P0{constructor(e){this.comparator=e?(r,s)=>e(r,s)||nr.comparator(r.key,s.key):(r,s)=>nr.comparator(r.key,s.key),this.keyedMap=Pg(),this.sortedSet=new an(this.comparator)}static emptySet(e){return new P0(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,s)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof P0)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),s=e.sortedSet.getIterator();for(;r.hasNext();){const n=r.getNext().key,i=s.getNext().key;if(!n.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const s=new P0;return s.comparator=this.comparator,s.keyedMap=e,s.sortedSet=r,s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B6{constructor(){this.W_=new an(nr.comparator)}track(e){const r=e.doc.key,s=this.W_.get(r);s?e.type!==0&&s.type===3?this.W_=this.W_.insert(r,e):e.type===3&&s.type!==1?this.W_=this.W_.insert(r,{type:s.type,doc:e.doc}):e.type===2&&s.type===2?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):e.type===2&&s.type===0?this.W_=this.W_.insert(r,{type:0,doc:e.doc}):e.type===1&&s.type===0?this.W_=this.W_.remove(r):e.type===1&&s.type===2?this.W_=this.W_.insert(r,{type:1,doc:s.doc}):e.type===0&&s.type===1?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):mr():this.W_=this.W_.insert(r,e)}G_(){const e=[];return this.W_.inorderTraversal((r,s)=>{e.push(s)}),e}}class up{constructor(e,r,s,n,i,o,l,c,d){this.query=e,this.docs=r,this.oldDocs=s,this.docChanges=n,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=c,this.hasCachedResults=d}static fromInitialDocuments(e,r,s,n,i){const o=[];return r.forEach(l=>{o.push({type:0,doc:l})}),new up(e,r,P0.emptySet(r),o,s,n,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&X2(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,s=e.docChanges;if(r.length!==s.length)return!1;for(let n=0;n<r.length;n++)if(r[n].type!==s[n].type||!r[n].doc.isEqual(s[n].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mee{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class pee{constructor(){this.queries=F6(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(r,s){const n=pr(r),i=n.queries;n.queries=F6(),i.forEach((o,l)=>{for(const c of l.j_)c.onError(s)})})(this,new Gt(Tt.ABORTED,"Firestore shutting down"))}}function F6(){return new fh(t=>wO(t),X2)}async function _3(t,e){const r=pr(t);let s=3;const n=e.query;let i=r.queries.get(n);i?!i.H_()&&e.J_()&&(s=2):(i=new mee,s=e.J_()?0:1);try{switch(s){case 0:i.z_=await r.onListen(n,!0);break;case 1:i.z_=await r.onListen(n,!1);break;case 2:await r.onFirstRemoteStoreListen(n)}}catch(o){const l=E3(o,`Initialization of query '${Gm(e.query)}' failed`);return void e.onError(l)}r.queries.set(n,i),i.j_.push(e),e.Z_(r.onlineState),i.z_&&e.X_(i.z_)&&I3(r)}async function T3(t,e){const r=pr(t),s=e.query;let n=3;const i=r.queries.get(s);if(i){const o=i.j_.indexOf(e);o>=0&&(i.j_.splice(o,1),i.j_.length===0?n=e.J_()?0:1:!i.H_()&&e.J_()&&(n=2))}switch(n){case 0:return r.queries.delete(s),r.onUnlisten(s,!0);case 1:return r.queries.delete(s),r.onUnlisten(s,!1);case 2:return r.onLastRemoteStoreUnlisten(s);default:return}}function gee(t,e){const r=pr(t);let s=!1;for(const n of e){const i=n.query,o=r.queries.get(i);if(o){for(const l of o.j_)l.X_(n)&&(s=!0);o.z_=n}}s&&I3(r)}function xee(t,e,r){const s=pr(t),n=s.queries.get(e);if(n)for(const i of n.j_)i.onError(r);s.queries.delete(e)}function I3(t){t.Y_.forEach(e=>{e.next()})}var Ej,P6;(P6=Ej||(Ej={})).ea="default",P6.Cache="cache";class k3{constructor(e,r,s){this.query=e,this.ta=r,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=s||{}}X_(e){if(!this.options.includeMetadataChanges){const s=[];for(const n of e.docChanges)n.type!==3&&s.push(n);e=new up(e.query,e.docs,e.oldDocs,s,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.na?this.ia(e)&&(this.ta.next(e),r=!0):this.sa(e,this.onlineState)&&(this.oa(e),r=!0),this.ra=e,r}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let r=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),r=!0),r}sa(e,r){if(!e.fromCache||!this.J_())return!0;const s=r!=="Offline";return(!this.options._a||!s)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const r=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}oa(e){e=up.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Ej.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SU{constructor(e){this.key=e}}class EU{constructor(e){this.key=e}}class yee{constructor(e,r){this.query=e,this.Ta=r,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=es(),this.mutatedKeys=es(),this.Aa=CO(e),this.Ra=new P0(this.Aa)}get Va(){return this.Ta}ma(e,r){const s=r?r.fa:new B6,n=r?r.Ra:this.Ra;let i=r?r.mutatedKeys:this.mutatedKeys,o=n,l=!1;const c=this.query.limitType==="F"&&n.size===this.query.limit?n.last():null,d=this.query.limitType==="L"&&n.size===this.query.limit?n.first():null;if(e.inorderTraversal((u,A)=>{const h=n.get(u),f=Hy(this.query,A)?A:null,p=!!h&&this.mutatedKeys.has(h.key),m=!!f&&(f.hasLocalMutations||this.mutatedKeys.has(f.key)&&f.hasCommittedMutations);let g=!1;h&&f?h.data.isEqual(f.data)?p!==m&&(s.track({type:3,doc:f}),g=!0):this.ga(h,f)||(s.track({type:2,doc:f}),g=!0,(c&&this.Aa(f,c)>0||d&&this.Aa(f,d)<0)&&(l=!0)):!h&&f?(s.track({type:0,doc:f}),g=!0):h&&!f&&(s.track({type:1,doc:h}),g=!0,(c||d)&&(l=!0)),g&&(f?(o=o.add(f),i=m?i.add(u):i.delete(u)):(o=o.delete(u),i=i.delete(u)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const u=this.query.limitType==="F"?o.last():o.first();o=o.delete(u.key),i=i.delete(u.key),s.track({type:1,doc:u})}return{Ra:o,fa:s,ns:l,mutatedKeys:i}}ga(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,s,n){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((u,A)=>function(f,p){const m=g=>{switch(g){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return mr()}};return m(f)-m(p)}(u.type,A.type)||this.Aa(u.doc,A.doc)),this.pa(s),n=n!=null&&n;const l=r&&!n?this.ya():[],c=this.da.size===0&&this.current&&!n?1:0,d=c!==this.Ea;return this.Ea=c,o.length!==0||d?{snapshot:new up(this.query,e.Ra,i,o,e.mutatedKeys,c===0,d,!1,!!s&&s.resumeToken.approximateByteSize()>0),wa:l}:{wa:l}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new B6,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(r=>this.Ta=this.Ta.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ta=this.Ta.delete(r)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=es(),this.Ra.forEach(s=>{this.Sa(s.key)&&(this.da=this.da.add(s.key))});const r=[];return e.forEach(s=>{this.da.has(s)||r.push(new EU(s))}),this.da.forEach(s=>{e.has(s)||r.push(new SU(s))}),r}ba(e){this.Ta=e.Ts,this.da=es();const r=this.ma(e.documents);return this.applyChanges(r,!0)}Da(){return up.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class vee{constructor(e,r,s){this.query=e,this.targetId=r,this.view=s}}class bee{constructor(e){this.key=e,this.va=!1}}class wee{constructor(e,r,s,n,i,o){this.localStore=e,this.remoteStore=r,this.eventManager=s,this.sharedClientState=n,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new fh(l=>wO(l),X2),this.Ma=new Map,this.xa=new Set,this.Oa=new an(nr.comparator),this.Na=new Map,this.La=new y3,this.Ba={},this.ka=new Map,this.qa=Lf.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function Nee(t,e,r=!0){const s=iN(t);let n;const i=s.Fa.get(e);return i?(s.sharedClientState.addLocalQueryTarget(i.targetId),n=i.view.Da()):n=await _U(s,e,r,!0),n}async function Cee(t,e){const r=iN(t);await _U(r,e,!0,!1)}async function _U(t,e,r,s){const n=await Bw(t.localStore,Wo(e)),i=n.targetId,o=t.sharedClientState.addLocalQueryTarget(i,r);let l;return s&&(l=await B3(t,e,i,o==="current",n.resumeToken)),t.isPrimaryClient&&r&&aN(t.remoteStore,n),l}async function B3(t,e,r,s,n){t.Ka=(A,h,f)=>async function(m,g,y,v){let x=g.view.ma(y);x.ns&&(x=await Cj(m.localStore,g.query,!1).then(({documents:C})=>g.view.ma(C,x)));const E=v&&v.targetChanges.get(g.targetId),T=v&&v.targetMismatches.get(g.targetId)!=null,j=g.view.applyChanges(x,m.isPrimaryClient,E,T);return _j(m,g.targetId,j.wa),j.snapshot}(t,A,h,f);const i=await Cj(t.localStore,e,!0),o=new yee(e,i.Ts),l=o.ma(i.documents),c=zy.createSynthesizedTargetChangeForCurrentChange(r,s&&t.onlineState!=="Offline",n),d=o.applyChanges(l,t.isPrimaryClient,c);_j(t,r,d.wa);const u=new vee(e,r,o);return t.Fa.set(e,u),t.Ma.has(r)?t.Ma.get(r).push(e):t.Ma.set(r,[e]),d.snapshot}async function jee(t,e,r){const s=pr(t),n=s.Fa.get(e),i=s.Ma.get(n.targetId);if(i.length>1)return s.Ma.set(n.targetId,i.filter(o=>!X2(o,e))),void s.Fa.delete(e);s.isPrimaryClient?(s.sharedClientState.removeLocalQueryTarget(n.targetId),s.sharedClientState.isActiveQueryTarget(n.targetId)||await cp(s.localStore,n.targetId,!1).then(()=>{s.sharedClientState.clearQueryState(n.targetId),r&&dp(s.remoteStore,n.targetId),Ap(s,n.targetId)}).catch(Ah)):(Ap(s,n.targetId),await cp(s.localStore,n.targetId,!0))}async function See(t,e){const r=pr(t),s=r.Fa.get(e),n=r.Ma.get(s.targetId);r.isPrimaryClient&&n.length===1&&(r.sharedClientState.removeLocalQueryTarget(s.targetId),dp(r.remoteStore,s.targetId))}async function Eee(t,e,r){const s=R3(t);try{const n=await function(o,l){const c=pr(o),d=wt.now(),u=l.reduce((f,p)=>f.add(p.key),es());let A,h;return c.persistence.runTransaction("Locally write mutations","readwrite",f=>{let p=Ko(),m=es();return c.cs.getEntries(f,u).next(g=>{p=g,p.forEach((y,v)=>{v.isValidDocument()||(m=m.add(y))})}).next(()=>c.localDocuments.getOverlayedDocuments(f,p)).next(g=>{A=g;const y=[];for(const v of l){const x=XJ(v,A.get(v.key).overlayedDocument);x!=null&&y.push(new hu(v.key,x,hO(x.value.mapValue),ja.exists(!0)))}return c.mutationQueue.addMutationBatch(f,d,y,l)}).next(g=>{h=g;const y=g.applyToLocalDocumentSet(A,m);return c.documentOverlayCache.saveOverlays(f,g.batchId,y)})}).then(()=>({batchId:h.batchId,changes:SO(A)}))}(s.localStore,e);s.sharedClientState.addPendingMutation(n.batchId),function(o,l,c){let d=o.Ba[o.currentUser.toKey()];d||(d=new an($r)),d=d.insert(l,c),o.Ba[o.currentUser.toKey()]=d}(s,n.batchId,r),await mh(s,n.changes),await Fp(s.remoteStore)}catch(n){const i=E3(n,"Failed to persist write");r.reject(i)}}async function TU(t,e){const r=pr(t);try{const s=await qZ(r.localStore,e);e.targetChanges.forEach((n,i)=>{const o=r.Na.get(i);o&&(br(n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size<=1),n.addedDocuments.size>0?o.va=!0:n.modifiedDocuments.size>0?br(o.va):n.removedDocuments.size>0&&(br(o.va),o.va=!1))}),await mh(r,s,e)}catch(s){await Ah(s)}}function D6(t,e,r){const s=pr(t);if(s.isPrimaryClient&&r===0||!s.isPrimaryClient&&r===1){const n=[];s.Fa.forEach((i,o)=>{const l=o.view.Z_(e);l.snapshot&&n.push(l.snapshot)}),function(o,l){const c=pr(o);c.onlineState=l;let d=!1;c.queries.forEach((u,A)=>{for(const h of A.j_)h.Z_(l)&&(d=!0)}),d&&I3(c)}(s.eventManager,e),n.length&&s.Ca.d_(n),s.onlineState=e,s.isPrimaryClient&&s.sharedClientState.setOnlineState(e)}}async function _ee(t,e,r){const s=pr(t);s.sharedClientState.updateQueryState(e,"rejected",r);const n=s.Na.get(e),i=n&&n.key;if(i){let o=new an(nr.comparator);o=o.insert(i,Ln.newNoDocument(i,Sr.min()));const l=es().add(i),c=new Ky(Sr.min(),new Map,new an($r),o,l);await TU(s,c),s.Oa=s.Oa.remove(i),s.Na.delete(e),D3(s)}else await cp(s.localStore,e,!1).then(()=>Ap(s,e,r)).catch(Ah)}async function Tee(t,e){const r=pr(t),s=e.batch.batchId;try{const n=await zZ(r.localStore,e);P3(r,s,null),F3(r,s),r.sharedClientState.updateMutationState(s,"acknowledged"),await mh(r,n)}catch(n){await Ah(n)}}async function Iee(t,e,r){const s=pr(t);try{const n=await function(o,l){const c=pr(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let u;return c.mutationQueue.lookupMutationBatch(d,l).next(A=>(br(A!==null),u=A.keys(),c.mutationQueue.removeMutationBatch(d,A))).next(()=>c.mutationQueue.performConsistencyCheck(d)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(d,u,l)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,u)).next(()=>c.localDocuments.getDocuments(d,u))})}(s.localStore,e);P3(s,e,r),F3(s,e),s.sharedClientState.updateMutationState(e,"rejected",r),await mh(s,n)}catch(n){await Ah(n)}}function F3(t,e){(t.ka.get(e)||[]).forEach(r=>{r.resolve()}),t.ka.delete(e)}function P3(t,e,r){const s=pr(t);let n=s.Ba[s.currentUser.toKey()];if(n){const i=n.get(e);i&&(r?i.reject(r):i.resolve(),n=n.remove(e)),s.Ba[s.currentUser.toKey()]=n}}function Ap(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const s of t.Ma.get(e))t.Fa.delete(s),r&&t.Ca.$a(s,r);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(s=>{t.La.containsKey(s)||IU(t,s)})}function IU(t,e){t.xa.delete(e.path.canonicalString());const r=t.Oa.get(e);r!==null&&(dp(t.remoteStore,r),t.Oa=t.Oa.remove(e),t.Na.delete(r),D3(t))}function _j(t,e,r){for(const s of r)s instanceof SU?(t.La.addReference(s.key,e),kee(t,s)):s instanceof EU?(qt("SyncEngine","Document no longer in limbo: "+s.key),t.La.removeReference(s.key,e),t.La.containsKey(s.key)||IU(t,s.key)):mr()}function kee(t,e){const r=e.key,s=r.path.canonicalString();t.Oa.get(r)||t.xa.has(s)||(qt("SyncEngine","New document in limbo: "+r),t.xa.add(s),D3(t))}function D3(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const r=new nr(Cs.fromString(e)),s=t.qa.next();t.Na.set(s,new bee(r)),t.Oa=t.Oa.insert(r,s),aN(t.remoteStore,new Md(Wo(Vy(r.path)),s,"TargetPurposeLimboResolution",xo.oe))}}async function mh(t,e,r){const s=pr(t),n=[],i=[],o=[];s.Fa.isEmpty()||(s.Fa.forEach((l,c)=>{o.push(s.Ka(c,e,r).then(d=>{var u;if((d||r)&&s.isPrimaryClient){const A=d?!d.fromCache:(u=r==null?void 0:r.targetChanges.get(c.targetId))===null||u===void 0?void 0:u.current;s.sharedClientState.updateQueryState(c.targetId,A?"current":"not-current")}if(d){n.push(d);const A=b3.Wi(c.targetId,d);i.push(A)}}))}),await Promise.all(o),s.Ca.d_(n),await async function(c,d){const u=pr(c);try{await u.persistence.runTransaction("notifyLocalViewChanges","readwrite",A=>bt.forEach(d,h=>bt.forEach(h.$i,f=>u.persistence.referenceDelegate.addReference(A,h.targetId,f)).next(()=>bt.forEach(h.Ui,f=>u.persistence.referenceDelegate.removeReference(A,h.targetId,f)))))}catch(A){if(!hh(A))throw A;qt("LocalStore","Failed to update sequence numbers: "+A)}for(const A of d){const h=A.targetId;if(!A.fromCache){const f=u.os.get(h),p=f.snapshotVersion,m=f.withLastLimboFreeSnapshotVersion(p);u.os=u.os.insert(h,m)}}}(s.localStore,i))}async function Bee(t,e){const r=pr(t);if(!r.currentUser.isEqual(e)){qt("SyncEngine","User change. New user:",e.toKey());const s=await AU(r.localStore,e);r.currentUser=e,function(i,o){i.ka.forEach(l=>{l.forEach(c=>{c.reject(new Gt(Tt.CANCELLED,o))})}),i.ka.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,s.removedBatchIds,s.addedBatchIds),await mh(r,s.hs)}}function Fee(t,e){const r=pr(t),s=r.Na.get(e);if(s&&s.va)return es().add(s.key);{let n=es();const i=r.Ma.get(e);if(!i)return n;for(const o of i){const l=r.Fa.get(o);n=n.unionWith(l.view.Va)}return n}}async function Pee(t,e){const r=pr(t),s=await Cj(r.localStore,e.query,!0),n=e.view.ba(s);return r.isPrimaryClient&&_j(r,e.targetId,n.wa),n}async function Dee(t,e){const r=pr(t);return mU(r.localStore,e).then(s=>mh(r,s))}async function Ree(t,e,r,s){const n=pr(t),i=await function(l,c){const d=pr(l),u=pr(d.mutationQueue);return d.persistence.runTransaction("Lookup mutation documents","readonly",A=>u.Mn(A,c).next(h=>h?d.localDocuments.getDocuments(A,h):bt.resolve(null)))}(n.localStore,e);i!==null?(r==="pending"?await Fp(n.remoteStore):r==="acknowledged"||r==="rejected"?(P3(n,e,s||null),F3(n,e),function(l,c){pr(pr(l).mutationQueue).On(c)}(n.localStore,e)):mr(),await mh(n,i)):qt("SyncEngine","Cannot apply mutation batch with id: "+e)}async function Lee(t,e){const r=pr(t);if(iN(r),R3(r),e===!0&&r.Qa!==!0){const s=r.sharedClientState.getAllActiveQueryTargets(),n=await R6(r,s.toArray());r.Qa=!0,await Sj(r.remoteStore,!0);for(const i of n)aN(r.remoteStore,i)}else if(e===!1&&r.Qa!==!1){const s=[];let n=Promise.resolve();r.Ma.forEach((i,o)=>{r.sharedClientState.isLocalQueryTarget(o)?s.push(o):n=n.then(()=>(Ap(r,o),cp(r.localStore,o,!0))),dp(r.remoteStore,o)}),await n,await R6(r,s),function(o){const l=pr(o);l.Na.forEach((c,d)=>{dp(l.remoteStore,d)}),l.La.pr(),l.Na=new Map,l.Oa=new an(nr.comparator)}(r),r.Qa=!1,await Sj(r.remoteStore,!1)}}async function R6(t,e,r){const s=pr(t),n=[],i=[];for(const o of e){let l;const c=s.Ma.get(o);if(c&&c.length!==0){l=await Bw(s.localStore,Wo(c[0]));for(const d of c){const u=s.Fa.get(d),A=await Pee(s,u);A.snapshot&&i.push(A.snapshot)}}else{const d=await fU(s.localStore,o);l=await Bw(s.localStore,d),await B3(s,kU(d),o,!1,l.resumeToken)}n.push(l)}return s.Ca.d_(i),n}function kU(t){return bO(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function Oee(t){return function(r){return pr(pr(r).persistence).Qi()}(pr(t).localStore)}async function Uee(t,e,r,s){const n=pr(t);if(n.Qa)return void qt("SyncEngine","Ignoring unexpected query state notification.");const i=n.Ma.get(e);if(i&&i.length>0)switch(r){case"current":case"not-current":{const o=await mU(n.localStore,NO(i[0])),l=Ky.createSynthesizedRemoteEventForCurrentChange(e,r==="current",aa.EMPTY_BYTE_STRING);await mh(n,o,l);break}case"rejected":await cp(n.localStore,e,!0),Ap(n,e,s);break;default:mr()}}async function Mee(t,e,r){const s=iN(t);if(s.Qa){for(const n of e){if(s.Ma.has(n)&&s.sharedClientState.isActiveQueryTarget(n)){qt("SyncEngine","Adding an already active target "+n);continue}const i=await fU(s.localStore,n),o=await Bw(s.localStore,i);await B3(s,kU(i),o.targetId,!1,o.resumeToken),aN(s.remoteStore,o)}for(const n of r)s.Ma.has(n)&&await cp(s.localStore,n,!1).then(()=>{dp(s.remoteStore,n),Ap(s,n)}).catch(Ah)}}function iN(t){const e=pr(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=TU.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Fee.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=_ee.bind(null,e),e.Ca.d_=gee.bind(null,e.eventManager),e.Ca.$a=xee.bind(null,e.eventManager),e}function R3(t){const e=pr(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Tee.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Iee.bind(null,e),e}class oy{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=sN(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,r){return null}Ha(e,r){return null}za(e){return uU(this.persistence,new dU,e.initialUser,this.serializer)}Ga(e){return new lU(rN.Zr,this.serializer)}Wa(e){return new gU}async terminate(){var e,r;(e=this.gcScheduler)===null||e===void 0||e.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}oy.provider={build:()=>new oy};class Qee extends oy{constructor(e,r,s){super(),this.Ja=e,this.cacheSizeBytes=r,this.forceOwnership=s,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Ja.initialize(this,e),await R3(this.Ja.syncEngine),await Fp(this.Ja.remoteStore),await this.persistence.yi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}za(e){return uU(this.persistence,new dU,e.initialUser,this.serializer)}ja(e,r){const s=this.persistence.referenceDelegate.garbageCollector;return new _Z(s,e.asyncQueue,r)}Ha(e,r){const s=new lJ(r,this.persistence);return new oJ(e.asyncQueue,s)}Ga(e){const r=cU(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),s=this.cacheSizeBytes!==void 0?ho.withCacheSize(this.cacheSizeBytes):ho.DEFAULT;return new v3(this.synchronizeTabs,r,e.clientId,s,e.asyncQueue,xU(),Ib(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Wa(e){return new gU}}class Vee extends Qee{constructor(e,r){super(e,r,!1),this.Ja=e,this.cacheSizeBytes=r,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const r=this.Ja.syncEngine;this.sharedClientState instanceof $5&&(this.sharedClientState.syncEngine={no:Ree.bind(null,r),ro:Uee.bind(null,r),io:Mee.bind(null,r),Qi:Oee.bind(null,r),eo:Dee.bind(null,r)},await this.sharedClientState.start()),await this.persistence.yi(async s=>{await Lee(this.Ja.syncEngine,s),this.gcScheduler&&(s&&!this.gcScheduler.started?this.gcScheduler.start():s||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(s&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():s||this.indexBackfillerScheduler.stop())})}Wa(e){const r=xU();if(!$5.D(r))throw new Gt(Tt.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const s=cU(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new $5(r,e.asyncQueue,s,e.clientId,e.initialUser)}}class Rw{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=s=>D6(this.syncEngine,s,1),this.remoteStore.remoteSyncer.handleCredentialChange=Bee.bind(null,this.syncEngine),await Sj(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new pee}()}createDatastore(e){const r=sN(e.databaseInfo.databaseId),s=function(i){return new ZZ(i)}(e.databaseInfo);return function(i,o,l,c){return new ree(i,o,l,c)}(e.authCredentials,e.appCheckCredentials,s,r)}createRemoteStore(e){return function(s,n,i,o,l){return new nee(s,n,i,o,l)}(this.localStore,this.datastore,e.asyncQueue,r=>D6(this.syncEngine,r,0),function(){return I6.D()?new I6:new YZ}())}createSyncEngine(e,r){return function(n,i,o,l,c,d,u){const A=new wee(n,i,o,l,c,d);return u&&(A.Qa=!0),A}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await async function(n){const i=pr(n);qt("RemoteStore","RemoteStore shutting down."),i.L_.add(5),await qy(i),i.k_.shutdown(),i.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}Rw.provider={build:()=>new Rw};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L3{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):ea("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hee{constructor(e,r,s,n,i){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=s,this.databaseInfo=n,this.user=Ma.UNAUTHENTICATED,this.clientId=XL.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(s,async o=>{qt("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(s,o=>(qt("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Xc;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const s=E3(r,"Failed to shutdown persistence");e.reject(s)}}),e.promise}}async function z5(t,e){t.asyncQueue.verifyOperationInProgress(),qt("FirestoreClient","Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let s=r.initialUser;t.setCredentialChangeListener(async n=>{s.isEqual(n)||(await AU(e.localStore,n),s=n)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function L6(t,e){t.asyncQueue.verifyOperationInProgress();const r=await $ee(t);qt("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(s=>k6(e.remoteStore,s)),t.setAppCheckTokenChangeListener((s,n)=>k6(e.remoteStore,n)),t._onlineComponents=e}async function $ee(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){qt("FirestoreClient","Using user provided OfflineComponentProvider");try{await z5(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(n){return n.name==="FirebaseError"?n.code===Tt.FAILED_PRECONDITION||n.code===Tt.UNIMPLEMENTED:!(typeof DOMException<"u"&&n instanceof DOMException)||n.code===22||n.code===20||n.code===11}(r))throw r;If("Error using user provided cache. Falling back to memory cache: "+r),await z5(t,new oy)}}else qt("FirestoreClient","Using default OfflineComponentProvider"),await z5(t,new oy);return t._offlineComponents}async function BU(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(qt("FirestoreClient","Using user provided OnlineComponentProvider"),await L6(t,t._uninitializedComponentsProvider._online)):(qt("FirestoreClient","Using default OnlineComponentProvider"),await L6(t,new Rw))),t._onlineComponents}function Kee(t){return BU(t).then(e=>e.syncEngine)}async function Lw(t){const e=await BU(t),r=e.eventManager;return r.onListen=Nee.bind(null,e.syncEngine),r.onUnlisten=jee.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=Cee.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=See.bind(null,e.syncEngine),r}function zee(t,e,r={}){const s=new Xc;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,l,c,d){const u=new L3({next:h=>{u.Za(),o.enqueueAndForget(()=>T3(i,A));const f=h.docs.has(l);!f&&h.fromCache?d.reject(new Gt(Tt.UNAVAILABLE,"Failed to get document because the client is offline.")):f&&h.fromCache&&c&&c.source==="server"?d.reject(new Gt(Tt.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(h)},error:h=>d.reject(h)}),A=new k3(Vy(l.path),u,{includeMetadataChanges:!0,_a:!0});return _3(i,A)}(await Lw(t),t.asyncQueue,e,r,s)),s.promise}function qee(t,e,r={}){const s=new Xc;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,l,c,d){const u=new L3({next:h=>{u.Za(),o.enqueueAndForget(()=>T3(i,A)),h.fromCache&&c.source==="server"?d.reject(new Gt(Tt.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(h)},error:h=>d.reject(h)}),A=new k3(l,u,{includeMetadataChanges:!0,_a:!0});return _3(i,A)}(await Lw(t),t.asyncQueue,e,r,s)),s.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FU(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O6=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PU(t,e,r){if(!r)throw new Gt(Tt.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function Wee(t,e,r,s){if(e===!0&&s===!0)throw new Gt(Tt.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function U6(t){if(!nr.isDocumentKey(t))throw new Gt(Tt.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function M6(t){if(nr.isDocumentKey(t))throw new Gt(Tt.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function oN(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(s){return s.constructor?s.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":mr()}function Ii(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Gt(Tt.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=oN(t);throw new Gt(Tt.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}function Gee(t,e){if(e<=0)throw new Gt(Tt.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q6{constructor(e){var r,s;if(e.host===void 0){if(e.ssl!==void 0)throw new Gt(Tt.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(r=e.ssl)===null||r===void 0||r;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new Gt(Tt.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Wee("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=FU((s=e.experimentalLongPollingOptions)!==null&&s!==void 0?s:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new Gt(Tt.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new Gt(Tt.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new Gt(Tt.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(s,n){return s.timeoutSeconds===n.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class lN{constructor(e,r,s,n){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=s,this._app=n,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Q6({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Gt(Tt.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Gt(Tt.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Q6(e),e.credentials!==void 0&&(this._authCredentials=function(s){if(!s)return new YX;switch(s.type){case"firstParty":return new eJ(s.sessionIndex||"0",s.iamToken||null,s.authTokenFactory||null);case"provider":return s.client;default:throw new Gt(Tt.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const s=O6.get(r);s&&(qt("ComponentProvider","Removing Datastore"),O6.delete(r),s.terminate())}(this),Promise.resolve()}}function Yee(t,e,r,s={}){var n;const i=(t=Ii(t,lN))._getSettings(),o=`${e}:${r}`;if(i.host!=="firestore.googleapis.com"&&i.host!==o&&If("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},i),{host:o,ssl:!1})),s.mockUserToken){let l,c;if(typeof s.mockUserToken=="string")l=s.mockUserToken,c=Ma.MOCK_USER;else{l=gW(s.mockUserToken,(n=t._app)===null||n===void 0?void 0:n.options.projectId);const d=s.mockUserToken.sub||s.mockUserToken.user_id;if(!d)throw new Gt(Tt.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new Ma(d)}t._authCredentials=new XX(new YL(l,c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nd{constructor(e,r,s){this.converter=r,this._query=s,this.type="query",this.firestore=e}withConverter(e){return new nd(this.firestore,e,this._query)}}class ki{constructor(e,r,s){this.converter=r,this._key=s,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new RA(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new ki(this.firestore,e,this._key)}}class RA extends nd{constructor(e,r,s){super(e,r,Vy(s)),this._path=s,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new ki(this.firestore,null,new nr(e))}withConverter(e){return new RA(this.firestore,e,this._path)}}function Jt(t,e,...r){if(t=In(t),PU("collection","path",e),t instanceof lN){const s=Cs.fromString(e,...r);return M6(s),new RA(t,null,s)}{if(!(t instanceof ki||t instanceof RA))throw new Gt(Tt.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=t._path.child(Cs.fromString(e,...r));return M6(s),new RA(t.firestore,null,s)}}function Rt(t,e,...r){if(t=In(t),arguments.length===1&&(e=XL.newId()),PU("doc","path",e),t instanceof lN){const s=Cs.fromString(e,...r);return U6(s),new ki(t,null,new nr(s))}{if(!(t instanceof ki||t instanceof RA))throw new Gt(Tt.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=t._path.child(Cs.fromString(e,...r));return U6(s),new ki(t.firestore,t instanceof RA?t.converter:null,new nr(s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V6{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new yU(this,"async_queue_retry"),this.Vu=()=>{const s=Ib();s&&qt("AsyncQueue","Visibility state changed to "+s.visibilityState),this.t_.jo()},this.mu=e;const r=Ib();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const r=Ib();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const r=new Xc;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!hh(e))throw e;qt("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const r=this.mu.then(()=>(this.du=!0,e().catch(s=>{this.Eu=s,this.du=!1;const n=function(o){let l=o.message||"";return o.stack&&(l=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),l}(s);throw ea("INTERNAL UNHANDLED ERROR: ",n),s}).then(s=>(this.du=!1,s))));return this.mu=r,r}enqueueAfterDelay(e,r,s){this.fu(),this.Ru.indexOf(e)>-1&&(r=0);const n=S3.createAndSchedule(this,e,r,s,i=>this.yu(i));return this.Tu.push(n),n}fu(){this.Eu&&mr()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const r of this.Tu)if(r.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((r,s)=>r.targetTimeMs-s.targetTimeMs);for(const r of this.Tu)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const r=this.Tu.indexOf(e);this.Tu.splice(r,1)}}function H6(t){return function(r,s){if(typeof r!="object"||r===null)return!1;const n=r;for(const i of s)if(i in n&&typeof n[i]=="function")return!0;return!1}(t,["next","error","complete"])}class pc extends lN{constructor(e,r,s,n){super(e,r,s,n),this.type="firestore",this._queue=new V6,this._persistenceKey=(n==null?void 0:n.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new V6(e),this._firestoreClient=void 0,await e}}}function Xee(t,e){const r=typeof t=="object"?t:zE(),s=typeof t=="string"?t:"(default)",n=H2(r,"firestore").getImmediate({identifier:s});if(!n._initialized){const i=Z8("firestore");i&&Yee(n,...i)}return n}function Wy(t){if(t._terminated)throw new Gt(Tt.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||DU(t),t._firestoreClient}function DU(t){var e,r,s;const n=t._freezeSettings(),i=function(l,c,d,u){return new TJ(l,c,d,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,FU(u.experimentalLongPollingOptions),u.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,n);t._componentsProvider||!((r=n.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((s=n.localCache)===null||s===void 0)&&s._onlineComponentProvider)&&(t._componentsProvider={_offline:n.localCache._offlineComponentProvider,_online:n.localCache._onlineComponentProvider}),t._firestoreClient=new Hee(t._authCredentials,t._appCheckCredentials,t._queue,i,t._componentsProvider&&function(l){const c=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(c),_online:c}}(t._componentsProvider))}async function Jee(t){If("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const e=t._freezeSettings();Zee(t,Rw.provider,{build:r=>new Vee(r,e.cacheSizeBytes)})}function Zee(t,e,r){if((t=Ii(t,pc))._firestoreClient||t._terminated)throw new Gt(Tt.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(t._componentsProvider||t._getSettings().localCache)throw new Gt(Tt.FAILED_PRECONDITION,"SDK cache is already specified.");t._componentsProvider={_online:e,_offline:r},DU(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hp{constructor(e){this._byteString=e}static fromBase64String(e){try{return new hp(aa.fromBase64String(e))}catch(r){throw new Gt(Tt.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new hp(aa.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gy{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new Gt(Tt.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new jn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yy{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O3{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new Gt(Tt.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new Gt(Tt.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return $r(this._lat,e._lat)||$r(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U3{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(s,n){if(s.length!==n.length)return!1;for(let i=0;i<s.length;++i)if(s[i]!==n[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ete=/^__.*__$/;class tte{constructor(e,r,s){this.data=e,this.fieldMask=r,this.fieldTransforms=s}toMutation(e,r){return this.fieldMask!==null?new hu(e,this.data,this.fieldMask,r,this.fieldTransforms):new Bp(e,this.data,r,this.fieldTransforms)}}class RU{constructor(e,r,s){this.data=e,this.fieldMask=r,this.fieldTransforms=s}toMutation(e,r){return new hu(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function LU(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw mr()}}class M3{constructor(e,r,s,n,i,o){this.settings=e,this.databaseId=r,this.serializer=s,this.ignoreUndefinedProperties=n,i===void 0&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new M3(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var r;const s=(r=this.path)===null||r===void 0?void 0:r.child(e),n=this.Fu({path:s,xu:!1});return n.Ou(e),n}Nu(e){var r;const s=(r=this.path)===null||r===void 0?void 0:r.child(e),n=this.Fu({path:s,xu:!1});return n.vu(),n}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Ow(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(LU(this.Cu)&&ete.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class rte{constructor(e,r,s){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=s||sN(e)}Qu(e,r,s,n=!1){return new M3({Cu:e,methodName:r,qu:s,path:jn.emptyPath(),xu:!1,ku:n},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Dp(t){const e=t._freezeSettings(),r=sN(t._databaseId);return new rte(t._databaseId,!!e.ignoreUndefinedProperties,r)}function Q3(t,e,r,s,n,i={}){const o=t.Qu(i.merge||i.mergeFields?2:0,e,r,n);$3("Data must be an object, but it was:",o,s);const l=QU(s,o);let c,d;if(i.merge)c=new yo(o.fieldMask),d=o.fieldTransforms;else if(i.mergeFields){const u=[];for(const A of i.mergeFields){const h=Tj(e,A,r);if(!o.contains(h))throw new Gt(Tt.INVALID_ARGUMENT,`Field '${h}' is specified in your field mask but missing from your input data.`);HU(u,h)||u.push(h)}c=new yo(u),d=o.fieldTransforms.filter(A=>c.covers(A.field))}else c=null,d=o.fieldTransforms;return new tte(new Ei(l),c,d)}class cN extends Yy{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof cN}}class V3 extends Yy{_toFieldTransform(e){return new u3(e.path,new np)}isEqual(e){return e instanceof V3}}class H3 extends Yy{constructor(e,r){super(e),this.$u=r}_toFieldTransform(e){const r=new op(e.serializer,TO(e.serializer,this.$u));return new u3(e.path,r)}isEqual(e){return e instanceof H3&&this.$u===e.$u}}function OU(t,e,r,s){const n=t.Qu(1,e,r);$3("Data must be an object, but it was:",n,s);const i=[],o=Ei.empty();Xf(s,(c,d)=>{const u=K3(e,c,r);d=In(d);const A=n.Nu(u);if(d instanceof cN)i.push(u);else{const h=Xy(d,A);h!=null&&(i.push(u),o.set(u,h))}});const l=new yo(i);return new RU(o,l,n.fieldTransforms)}function UU(t,e,r,s,n,i){const o=t.Qu(1,e,r),l=[Tj(e,s,r)],c=[n];if(i.length%2!=0)throw new Gt(Tt.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let h=0;h<i.length;h+=2)l.push(Tj(e,i[h])),c.push(i[h+1]);const d=[],u=Ei.empty();for(let h=l.length-1;h>=0;--h)if(!HU(d,l[h])){const f=l[h];let p=c[h];p=In(p);const m=o.Nu(f);if(p instanceof cN)d.push(f);else{const g=Xy(p,m);g!=null&&(d.push(f),u.set(f,g))}}const A=new yo(d);return new RU(u,A,o.fieldTransforms)}function MU(t,e,r,s=!1){return Xy(r,t.Qu(s?4:3,e))}function Xy(t,e){if(VU(t=In(t)))return $3("Unsupported field value:",e,t),QU(t,e);if(t instanceof Yy)return function(s,n){if(!LU(n.Cu))throw n.Bu(`${s._methodName}() can only be used with update() and set()`);if(!n.path)throw n.Bu(`${s._methodName}() is not currently supported inside arrays`);const i=s._toFieldTransform(n);i&&n.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(s,n){const i=[];let o=0;for(const l of s){let c=Xy(l,n.Lu(o));c==null&&(c={nullValue:"NULL_VALUE"}),i.push(c),o++}return{arrayValue:{values:i}}}(t,e)}return function(s,n){if((s=In(s))===null)return{nullValue:"NULL_VALUE"};if(typeof s=="number")return TO(n.serializer,s);if(typeof s=="boolean")return{booleanValue:s};if(typeof s=="string")return{stringValue:s};if(s instanceof Date){const i=wt.fromDate(s);return{timestampValue:lp(n.serializer,i)}}if(s instanceof wt){const i=new wt(s.seconds,1e3*Math.floor(s.nanoseconds/1e3));return{timestampValue:lp(n.serializer,i)}}if(s instanceof O3)return{geoPointValue:{latitude:s.latitude,longitude:s.longitude}};if(s instanceof hp)return{bytesValue:MO(n.serializer,s._byteString)};if(s instanceof ki){const i=n.databaseId,o=s.firestore._databaseId;if(!o.isEqual(i))throw n.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:p3(s.firestore._databaseId||n.databaseId,s._key.path)}}if(s instanceof U3)return function(o,l){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(c=>{if(typeof c!="number")throw l.Bu("VectorValues must only contain numeric values.");return d3(l.serializer,c)})}}}}}}(s,n);throw n.Bu(`Unsupported field value: ${oN(s)}`)}(t,e)}function QU(t,e){const r={};return cO(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Xf(t,(s,n)=>{const i=Xy(n,e.Mu(s));i!=null&&(r[s]=i)}),{mapValue:{fields:r}}}function VU(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof wt||t instanceof O3||t instanceof hp||t instanceof ki||t instanceof Yy||t instanceof U3)}function $3(t,e,r){if(!VU(r)||!function(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}(r)){const s=oN(r);throw s==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+s)}}function Tj(t,e,r){if((e=In(e))instanceof Gy)return e._internalPath;if(typeof e=="string")return K3(t,e);throw Ow("Field path arguments must be of type string or ",t,!1,void 0,r)}const ste=new RegExp("[~\\*/\\[\\]]");function K3(t,e,r){if(e.search(ste)>=0)throw Ow(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new Gy(...e.split("."))._internalPath}catch{throw Ow(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function Ow(t,e,r,s,n){const i=s&&!s.isEmpty(),o=n!==void 0;let l=`Function ${e}() called with invalid data`;r&&(l+=" (via `toFirestore()`)"),l+=". ";let c="";return(i||o)&&(c+=" (found",i&&(c+=` in field ${s}`),o&&(c+=` in document ${n}`),c+=")"),new Gt(Tt.INVALID_ARGUMENT,l+t+c)}function HU(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z3{constructor(e,r,s,n,i){this._firestore=e,this._userDataWriter=r,this._key=s,this._document=n,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new ki(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new nte(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(dN("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class nte extends z3{data(){return super.data()}}function dN(t,e){return typeof e=="string"?K3(t,e):e instanceof Gy?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $U(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Gt(Tt.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class q3{}class uN extends q3{}function Zt(t,e,...r){let s=[];e instanceof q3&&s.push(e),s=s.concat(r),function(i){const o=i.filter(c=>c instanceof W3).length,l=i.filter(c=>c instanceof AN).length;if(o>1||o>0&&l>0)throw new Gt(Tt.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(s);for(const n of s)t=n._apply(t);return t}class AN extends uN{constructor(e,r,s){super(),this._field=e,this._op=r,this._value=s,this.type="where"}static _create(e,r,s){return new AN(e,r,s)}_apply(e){const r=this._parse(e);return KU(e._query,r),new nd(e.firestore,e.converter,pj(e._query,r))}_parse(e){const r=Dp(e.firestore);return function(i,o,l,c,d,u,A){let h;if(d.isKeyField()){if(u==="array-contains"||u==="array-contains-any")throw new Gt(Tt.INVALID_ARGUMENT,`Invalid Query. You can't perform '${u}' queries on documentId().`);if(u==="in"||u==="not-in"){K6(A,u);const f=[];for(const p of A)f.push($6(c,i,p));h={arrayValue:{values:f}}}else h=$6(c,i,A)}else u!=="in"&&u!=="not-in"&&u!=="array-contains-any"||K6(A,u),h=MU(l,o,A,u==="in"||u==="not-in");return ds.create(d,u,h)}(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}function Yt(t,e,r){const s=e,n=dN("where",t);return AN._create(n,s,r)}class W3 extends q3{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new W3(e,r)}_parse(e){const r=this._queryConstraints.map(s=>s._parse(e)).filter(s=>s.getFilters().length>0);return r.length===1?r[0]:Rs.create(r,this._getOperator())}_apply(e){const r=this._parse(e);return r.getFilters().length===0?e:(function(n,i){let o=n;const l=i.getFlattenedFilters();for(const c of l)KU(o,c),o=pj(o,c)}(e._query,r),new nd(e.firestore,e.converter,pj(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class G3 extends uN{constructor(e,r){super(),this._field=e,this._direction=r,this.type="orderBy"}static _create(e,r){return new G3(e,r)}_apply(e){const r=function(n,i,o){if(n.startAt!==null)throw new Gt(Tt.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(n.endAt!==null)throw new Gt(Tt.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new iy(i,o)}(e._query,this._field,this._direction);return new nd(e.firestore,e.converter,function(n,i){const o=n.explicitOrderBy.concat([i]);return new Jf(n.path,n.collectionGroup,o,n.filters.slice(),n.limit,n.limitType,n.startAt,n.endAt)}(e._query,r))}}function On(t,e="asc"){const r=e,s=dN("orderBy",t);return G3._create(s,r)}class Y3 extends uN{constructor(e,r,s){super(),this.type=e,this._limit=r,this._limitType=s}static _create(e,r,s){return new Y3(e,r,s)}_apply(e){return new nd(e.firestore,e.converter,Sw(e._query,this._limit,this._limitType))}}function Wi(t){return Gee("limit",t),Y3._create("limit",t,"F")}class X3 extends uN{constructor(e,r,s){super(),this.type=e,this._docOrFields=r,this._inclusive=s}static _create(e,r,s){return new X3(e,r,s)}_apply(e){const r=ite(e,this.type,this._docOrFields,this._inclusive);return new nd(e.firestore,e.converter,function(n,i){return new Jf(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),n.limit,n.limitType,i,n.endAt)}(e._query,r))}}function ate(...t){return X3._create("startAfter",t,!1)}function ite(t,e,r,s){if(r[0]=In(r[0]),r[0]instanceof z3)return function(i,o,l,c,d){if(!c)throw new Gt(Tt.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${l}().`);const u=[];for(const A of F0(i))if(A.field.isKeyField())u.push(Ff(o,c.key));else{const h=c.data.field(A.field);if(G2(h))throw new Gt(Tt.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+A.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(h===null){const f=A.field.canonicalString();throw new Gt(Tt.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${f}' (used as the orderBy) does not exist.`)}u.push(h)}return new qA(u,d)}(t._query,t.firestore._databaseId,e,r[0]._document,s);{const n=Dp(t.firestore);return function(o,l,c,d,u,A){const h=o.explicitOrderBy;if(u.length>h.length)throw new Gt(Tt.INVALID_ARGUMENT,`Too many arguments provided to ${d}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const f=[];for(let p=0;p<u.length;p++){const m=u[p];if(h[p].field.isKeyField()){if(typeof m!="string")throw new Gt(Tt.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${d}(), but got a ${typeof m}`);if(!l3(o)&&m.indexOf("/")!==-1)throw new Gt(Tt.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${d}() must be a plain document ID, but '${m}' contains a slash.`);const g=o.path.child(Cs.fromString(m));if(!nr.isDocumentKey(g))throw new Gt(Tt.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${d}() must result in a valid document path, but '${g}' is not because it contains an odd number of segments.`);const y=new nr(g);f.push(Ff(l,y))}else{const g=MU(c,d,m);f.push(g)}}return new qA(f,A)}(t._query,t.firestore._databaseId,n,e,r,s)}}function $6(t,e,r){if(typeof(r=In(r))=="string"){if(r==="")throw new Gt(Tt.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!l3(e)&&r.indexOf("/")!==-1)throw new Gt(Tt.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const s=e.path.child(Cs.fromString(r));if(!nr.isDocumentKey(s))throw new Gt(Tt.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${s}' is not because it has an odd number of segments (${s.length}).`);return Ff(t,new nr(s))}if(r instanceof ki)return Ff(t,r._key);throw new Gt(Tt.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${oN(r)}.`)}function K6(t,e){if(!Array.isArray(t)||t.length===0)throw new Gt(Tt.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function KU(t,e){const r=function(n,i){for(const o of n)for(const l of o.getFlattenedFilters())if(i.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(n){switch(n){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(r!==null)throw r===e.op?new Gt(Tt.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Gt(Tt.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${r.toString()}' filters.`)}class ote{convertValue(e,r="none"){switch(Bf(e)){case 0:return null;case 1:return e.booleanValue;case 2:return vn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(KA(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw mr()}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const s={};return Xf(e,(n,i)=>{s[n]=this.convertValue(i,r)}),s}convertVectorValue(e){var r,s,n;const i=(n=(s=(r=e.fields)===null||r===void 0?void 0:r.value.arrayValue)===null||s===void 0?void 0:s.values)===null||n===void 0?void 0:n.map(o=>vn(o.doubleValue));return new U3(i)}convertGeoPoint(e){return new O3(vn(e.latitude),vn(e.longitude))}convertArray(e,r){return(e.values||[]).map(s=>this.convertValue(s,r))}convertServerTimestamp(e,r){switch(r){case"previous":const s=i3(e);return s==null?null:this.convertValue(s,r);case"estimate":return this.convertTimestamp(sy(e));default:return null}}convertTimestamp(e){const r=su(e);return new wt(r.seconds,r.nanos)}convertDocumentKey(e,r){const s=Cs.fromString(e);br(YO(s));const n=new kf(s.get(1),s.get(3)),i=new nr(s.popFirst(5));return n.isEqual(r)||ea(`Document ${i} contains a document reference within a different database (${n.projectId}/${n.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J3(t,e,r){let s;return s=t?r&&(r.merge||r.mergeFields)?t.toFirestore(e,r):t.toFirestore(e):e,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lg{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class zU extends z3{constructor(e,r,s,n,i,o){super(e,r,s,n,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new kb(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const s=this._document.data.field(dN("DocumentSnapshot.get",e));if(s!==null)return this._userDataWriter.convertValue(s,r.serverTimestamps)}}}class kb extends zU{data(e={}){return super.data(e)}}class qU{constructor(e,r,s,n){this._firestore=e,this._userDataWriter=r,this._snapshot=n,this.metadata=new Lg(n.hasPendingWrites,n.fromCache),this.query=s}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(s=>{e.call(r,new kb(this._firestore,this._userDataWriter,s.key,s,new Lg(this._snapshot.mutatedKeys.has(s.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new Gt(Tt.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(n,i){if(n._snapshot.oldDocs.isEmpty()){let o=0;return n._snapshot.docChanges.map(l=>{const c=new kb(n._firestore,n._userDataWriter,l.doc.key,l.doc,new Lg(n._snapshot.mutatedKeys.has(l.doc.key),n._snapshot.fromCache),n.query.converter);return l.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=n._snapshot.oldDocs;return n._snapshot.docChanges.filter(l=>i||l.type!==3).map(l=>{const c=new kb(n._firestore,n._userDataWriter,l.doc.key,l.doc,new Lg(n._snapshot.mutatedKeys.has(l.doc.key),n._snapshot.fromCache),n.query.converter);let d=-1,u=-1;return l.type!==0&&(d=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),u=o.indexOf(l.doc.key)),{type:lte(l.type),doc:c,oldIndex:d,newIndex:u}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}}function lte(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return mr()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kr(t){t=Ii(t,ki);const e=Ii(t.firestore,pc);return zee(Wy(e),t._key).then(r=>WU(e,t,r))}class Z3 extends ote{constructor(e){super(),this.firestore=e}convertBytes(e){return new hp(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new ki(this.firestore,null,r)}}function ur(t){t=Ii(t,nd);const e=Ii(t.firestore,pc),r=Wy(e),s=new Z3(e);return $U(t._query),qee(r,t._query).then(n=>new qU(e,s,t,n))}function LA(t,e,r){t=Ii(t,ki);const s=Ii(t.firestore,pc),n=J3(t.converter,e,r);return Jy(s,[Q3(Dp(s),"setDoc",t._key,n,t.converter!==null,r).toMutation(t._key,ja.none())])}function Xr(t,e,r,...s){t=Ii(t,ki);const n=Ii(t.firestore,pc),i=Dp(n);let o;return o=typeof(e=In(e))=="string"||e instanceof Gy?UU(i,"updateDoc",t._key,e,r,s):OU(i,"updateDoc",t._key,e),Jy(n,[o.toMutation(t._key,ja.exists(!0))])}function Pl(t){return Jy(Ii(t.firestore,pc),[new $y(t._key,ja.none())])}function Bi(t,e){const r=Ii(t.firestore,pc),s=Rt(t),n=J3(t.converter,e);return Jy(r,[Q3(Dp(t.firestore),"addDoc",s._key,n,t.converter!==null,{}).toMutation(s._key,ja.exists(!1))]).then(()=>s)}function Of(t,...e){var r,s,n;t=In(t);let i={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||H6(e[o])||(i=e[o],o++);const l={includeMetadataChanges:i.includeMetadataChanges,source:i.source};if(H6(e[o])){const A=e[o];e[o]=(r=A.next)===null||r===void 0?void 0:r.bind(A),e[o+1]=(s=A.error)===null||s===void 0?void 0:s.bind(A),e[o+2]=(n=A.complete)===null||n===void 0?void 0:n.bind(A)}let c,d,u;if(t instanceof ki)d=Ii(t.firestore,pc),u=Vy(t._key.path),c={next:A=>{e[o]&&e[o](WU(d,t,A))},error:e[o+1],complete:e[o+2]};else{const A=Ii(t,nd);d=Ii(A.firestore,pc),u=A._query;const h=new Z3(d);c={next:f=>{e[o]&&e[o](new qU(d,h,A,f))},error:e[o+1],complete:e[o+2]},$U(t._query)}return function(h,f,p,m){const g=new L3(m),y=new k3(f,g,p);return h.asyncQueue.enqueueAndForget(async()=>_3(await Lw(h),y)),()=>{g.Za(),h.asyncQueue.enqueueAndForget(async()=>T3(await Lw(h),y))}}(Wy(d),u,l,c)}function Jy(t,e){return function(s,n){const i=new Xc;return s.asyncQueue.enqueueAndForget(async()=>Eee(await Kee(s),n,i)),i.promise}(Wy(t),e)}function WU(t,e,r){const s=r.docs.get(e._key),n=new Z3(t);return new zU(t,n,e._key,s,new Lg(r.hasPendingWrites,r.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cte{constructor(e,r){this._firestore=e,this._commitHandler=r,this._mutations=[],this._committed=!1,this._dataReader=Dp(e)}set(e,r,s){this._verifyNotCommitted();const n=q5(e,this._firestore),i=J3(n.converter,r,s),o=Q3(this._dataReader,"WriteBatch.set",n._key,i,n.converter!==null,s);return this._mutations.push(o.toMutation(n._key,ja.none())),this}update(e,r,s,...n){this._verifyNotCommitted();const i=q5(e,this._firestore);let o;return o=typeof(r=In(r))=="string"||r instanceof Gy?UU(this._dataReader,"WriteBatch.update",i._key,r,s,n):OU(this._dataReader,"WriteBatch.update",i._key,r),this._mutations.push(o.toMutation(i._key,ja.exists(!0))),this}delete(e){this._verifyNotCommitted();const r=q5(e,this._firestore);return this._mutations=this._mutations.concat(new $y(r._key,ja.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Gt(Tt.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function q5(t,e){if((t=In(t)).firestore!==e)throw new Gt(Tt.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}function Ro(){return new V3("serverTimestamp")}function dte(t){return new H3("increment",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jl(t){return Wy(t=Ii(t,pc)),new cte(t,e=>Jy(t,e))}(function(e,r=!0){(function(n){kp=n})(Tp),Sf(new $A("firestore",(s,{instanceIdentifier:n,options:i})=>{const o=s.getProvider("app").getImmediate(),l=new pc(new JX(s.getProvider("auth-internal")),new rJ(s.getProvider("app-check-internal")),function(d,u){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new Gt(Tt.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new kf(d.options.projectId,u)}(o,n),o);return i=Object.assign({useFetchStreams:r},i),l._setSettings(i),l},"PUBLIC").setMultipleInstances(!0)),Wc(Lk,"4.7.3",e),Wc(Lk,"4.7.3","esm2017")})();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GU="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ute{constructor(e,r,s){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=e.getImmediate({optional:!0}),this.messaging=r.getImmediate({optional:!0}),this.auth||e.get().then(n=>this.auth=n,()=>{}),this.messaging||r.get().then(n=>this.messaging=n,()=>{}),this.appCheck||s.get().then(n=>this.appCheck=n,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.appCheck){const r=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return r.error?null:r.token}return null}async getContext(e){const r=await this.getAuthToken(),s=await this.getMessagingToken(),n=await this.getAppCheckToken(e);return{authToken:r,messagingToken:s,appCheckToken:n}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ij="us-central1";class Ate{constructor(e,r,s,n,i=Ij,o){this.app=e,this.fetchImpl=o,this.emulatorOrigin=null,this.contextProvider=new ute(r,s,n),this.cancelAllRequests=new Promise(l=>{this.deleteService=()=>Promise.resolve(l())});try{const l=new URL(i);this.customDomain=l.origin+(l.pathname==="/"?"":l.pathname),this.region=Ij}catch{this.customDomain=null,this.region=i}}_delete(){return this.deleteService()}_url(e){const r=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${r}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${r}.cloudfunctions.net/${e}`}}function hte(t,e,r){t.emulatorOrigin=`http://${e}:${r}`}const z6="@firebase/functions",q6="0.11.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fte="auth-internal",mte="app-check-internal",pte="messaging-internal";function gte(t,e){const r=(s,{instanceIdentifier:n})=>{const i=s.getProvider("app").getImmediate(),o=s.getProvider(fte),l=s.getProvider(pte),c=s.getProvider(mte);return new Ate(i,o,l,c,n,t)};Sf(new $A(GU,r,"PUBLIC").setMultipleInstances(!0)),Wc(z6,q6,e),Wc(z6,q6,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xte(t=zE(),e=Ij){const s=H2(In(t),GU).getImmediate({identifier:e}),n=Z8("functions");return n&&yte(s,...n),s}function yte(t,e,r){hte(In(t),e,r)}gte(fetch.bind(self));const vte={apiKey:"AIzaSyAtFFd51DNOAZBPhGTu-TDN4QqwFHEJroU",authDomain:"testapployalty.firebaseapp.com",projectId:"testapployalty",storageBucket:"testapployalty.firebasestorage.app",appId:"1:858235839380:web:dae988cb225beed1c72581"},e_=iL(vte),yn=WX(e_),st=Xee(e_);xte(e_);let kj=!0,YU=0;const bte=async()=>{try{return await Jee(st),console.log(" Firebase offline persistence enabled"),!0}catch(t){return t.code==="failed-precondition"?console.log(" Multiple tabs detected - offline persistence disabled for this tab (this is normal)"):t.code==="unimplemented"?console.log(" Browser does not support offline persistence"):console.log(" Offline persistence not available:",t.message),!0}},wte=async()=>{try{return console.log(" Firestore connection assumed healthy (checks disabled)"),kj=!0,YU=0,!0}catch(t){return console.warn(" Firestore connection issue:",t.message),kj=!1,!1}},Nte=()=>({connected:kj,retryCount:YU}),Xt=t=>{const e={"auth/user-not-found":"No account found with this email address.","auth/wrong-password":"Incorrect password. Please try again.","auth/email-already-in-use":"An account with this email already exists.","auth/weak-password":"Password should be at least 6 characters long.","auth/invalid-email":"Please enter a valid email address.","auth/too-many-requests":"Too many attempts. Please try again later.","permission-denied":"You do not have permission to perform this action.","not-found":"The requested resource was not found.","already-exists":"The resource you are trying to create already exists.","failed-precondition":"The operation was rejected due to system state.","out-of-range":"The operation was attempted past the valid range.",unauthenticated:"You must be logged in to perform this action.",unavailable:"The service is currently unavailable. Please try again.","data-loss":"Unrecoverable data loss or corruption occurred.","deadline-exceeded":"The operation took too long to complete. Please try again.","resource-exhausted":"Service quota exceeded. Please try again later.",internal:"An internal error occurred. Please try again."},r=(t==null?void 0:t.code)||(t==null?void 0:t.message)||"unknown";return r.includes("network")||r.includes("fetch")||r.includes("connection")?"Network connection issue. Please check your internet connection and try again.":e[r]||"An unexpected error occurred. Please try again."},XU=async()=>{try{bte().catch(t=>{console.log("Offline support initialization failed (non-blocking):",t.message)}),console.log(" Firebase services initialized successfully")}catch(t){console.error("Failed to initialize Firebase services (non-blocking):",t)}};try{XU()}catch(t){console.error("Firebase initialization error (ignored):",t)}function W6(t){return t.toLowerCase().trim().replace(/[^\w\s-]/g,"").replace(/[\s_-]+/g,"-").replace(/^-+|-+$/g,"")}function Bj(t){return{restaurant:{businessType:"restaurant",colors:{primary:"#16a34a",secondary:"#22c55e",accent:"#4ade80",background:"#f0fdf4",surface:"#ffffff",text:"#14532d"},gradients:{primary:"linear-gradient(135deg, #16a34a 0%, #22c55e 100%)",secondary:"linear-gradient(135deg, #22c55e 0%, #4ade80 100%)"}},cafe:{businessType:"cafe",colors:{primary:"#ca8a04",secondary:"#eab308",accent:"#fde047",background:"#fefdf8",surface:"#ffffff",text:"#713f12"},gradients:{primary:"linear-gradient(135deg, #ca8a04 0%, #eab308 100%)",secondary:"linear-gradient(135deg, #eab308 0%, #fde047 100%)"}},bar:{businessType:"bar",colors:{primary:"#9333ea",secondary:"#a855f7",accent:"#c084fc",background:"#faf5ff",surface:"#ffffff",text:"#581c87"},gradients:{primary:"linear-gradient(135deg, #9333ea 0%, #a855f7 100%)",secondary:"linear-gradient(135deg, #a855f7 0%, #c084fc 100%)"}}}[t]}function Ue(t,e="INR"){const r=Number(t)||0;return new Intl.NumberFormat("en-IN",{style:"currency",currency:e}).format(r)}function hs(t,e="Asia/Kolkata"){return new Intl.DateTimeFormat("en-IN",{timeZone:e,year:"numeric",month:"short",day:"numeric"}).format(t)}function Wn(t,e="Asia/Kolkata"){return new Intl.DateTimeFormat("en-IN",{timeZone:e,hour:"2-digit",minute:"2-digit",hour12:!0}).format(t)}function Cte(){return Math.floor(1e3+Math.random()*9e3).toString()}function jte(t){const e=Date.now().toString().slice(-6),r=Math.floor(Math.random()*100).toString().padStart(2,"0");return`${t.slice(0,3).toUpperCase()}-${e}-${r}`}function An(){return Math.random().toString(36).substring(2)+Date.now().toString(36)}function Fj(t){return{restaurant:"Restaurant",cafe:"Caf",bar:"Bar & Lounge"}[t]||t}const Fa={get:(t,e)=>{try{const r=localStorage.getItem(t);return r?JSON.parse(r):e}catch{return e}},set:(t,e)=>{try{localStorage.setItem(t,JSON.stringify(e))}catch(r){console.error("Failed to save to localStorage:",r)}},remove:t=>{try{localStorage.removeItem(t)}catch(e){console.error("Failed to remove from localStorage:",e)}},clear:()=>{try{localStorage.clear()}catch(t){console.error("Failed to clear localStorage:",t)}}},lo="restaurants",Ste="users",Ic=new Map,Ete=5*60*1e3,Al=new Map,jd=new Map,G6=50;class si{static async createRestaurantByAdmin(e){var r,s,n,i;try{const o=yn.currentUser;if(!o)return{success:!1,error:"Authentication required"};console.log(" Creating restaurant with admin:",{uid:o.uid,email:o.email});const l=jl(st),c=W6(e.name),d=await this.generateUniqueSlug(c),u=e.ownerPassword,A=e.ownerPin,h=An(),f=An(),p=Bj(e.businessType),m={id:h,name:e.name,slug:d,businessType:e.businessType,ownerId:f,isActive:!0,createdBy:o.uid,settings:{address:e.address||"",phone:e.phone||"",email:e.ownerEmail,taxRate:((r=e.settings)==null?void 0:r.taxRate)||18,currency:((s=e.settings)==null?void 0:s.currency)||"INR",timezone:((n=e.settings)==null?void 0:n.timezone)||"Asia/Kolkata",allowOnlineOrdering:!0,allowTableReservation:!0,autoAcceptOrders:!1,requireCustomerPhone:!1,enableLoyaltyProgram:!1,defaultTax:((i=e.settings)==null?void 0:i.taxRate)||18,defaultDiscount:0,businessInfo:{gstin:"",fssaiNumber:"",businessAddress:e.address||"",city:"",state:"",pincode:"",country:"India",website:""},theme:{primaryColor:p.colors.primary,secondaryColor:p.colors.secondary},features:{tableManagement:!0,inventoryTracking:!0,kitchenDisplay:!0,customerManagement:!0,reporting:!0},upiSettings:{upiId:"",enableQRCode:!1}},createdAt:new Date,updatedAt:new Date},g={id:f,email:e.ownerEmail,name:e.ownerName,role:"owner",restaurantId:h,pin:A,tempPassword:u,isActive:!0,isPending:!0,createdBy:o.uid,createdAt:wt.fromDate(new Date),updatedAt:wt.fromDate(new Date)},y=Rt(st,lo,h),v=Rt(st,"pendingUsers",f);return l.set(y,{...m,createdAt:wt.fromDate(m.createdAt),updatedAt:wt.fromDate(m.updatedAt)}),l.set(v,g),await l.commit(),this.cacheRestaurant(m),console.log(" Restaurant created by admin:",m.slug),{success:!0,data:{restaurantUrl:`${window.location.origin}/${d}`,ownerEmail:e.ownerEmail,ownerPassword:u,ownerPin:A,loginInstructions:`Login at: ${window.location.origin}/${d}/login
Email: ${e.ownerEmail}
Password: ${u}
PIN: ${A}

Note: You'll be asked to create your account on first login.`},message:"Restaurant created successfully"}}catch(o){return console.error(" Failed to create restaurant:",o),{success:!1,error:Xt(o)}}}static async getAllRestaurantsForAdmin(){try{const e=yn.currentUser;if(!e)return{success:!1,error:"Authentication required"};console.log(" Super admin verified, fetching restaurants:",e.email),console.log(" Current user UID:",e.uid),console.log(" Expected UID:","XWA9XWUZ19a8EFHvteyzjpkgRYG2");const r=Zt(Jt(st,lo),On("createdAt","desc")),n=(await ur(r)).docs.map(i=>this.convertFirestoreDoc(i.data(),i.id));return console.log(" Loaded all restaurants for admin:",n.length),console.log(" Restaurant details:",n.map(i=>({id:i.id,name:i.name,slug:i.slug,isActive:i.isActive,businessType:i.businessType}))),{success:!0,data:n}}catch(e){return console.error(" Failed to get restaurants for admin:",e),{success:!1,error:Xt(e)}}}static async toggleRestaurantStatus(e,r){try{const s=Rt(st,lo,e);return await Xr(s,{isActive:r,updatedAt:wt.now()}),this.clearCacheForRestaurant(e),console.log(` Restaurant ${r?"activated":"deactivated"}:`,e),{success:!0,message:`Restaurant ${r?"activated":"deactivated"} successfully`}}catch(s){return console.error(" Failed to toggle restaurant status:",s),{success:!1,error:Xt(s)}}}static async createRestaurant(e){try{const r=jl(st),s=W6(e.name),n=await this.generateUniqueSlug(s),i=An(),l=(await FL(yn,e.ownerEmail,e.ownerPassword)).user.uid,c=Bj(e.businessType),d={id:i,name:e.name,slug:n,businessType:e.businessType,ownerId:l,createdBy:l,isActive:!0,settings:{address:e.address||"",phone:e.phone||"",email:e.ownerEmail,taxRate:18,currency:"INR",timezone:"Asia/Kolkata",allowOnlineOrdering:!0,allowTableReservation:!0,autoAcceptOrders:!1,requireCustomerPhone:!1,enableLoyaltyProgram:!1,defaultTax:18,defaultDiscount:0,businessInfo:{gstin:"",fssaiNumber:"",businessAddress:e.address||"",city:"",state:"",pincode:"",country:"India",website:""},theme:{primaryColor:c.colors.primary,secondaryColor:c.colors.secondary},features:{tableManagement:!0,inventoryTracking:!0,kitchenDisplay:!0,customerManagement:!0,reporting:!0},upiSettings:{upiId:"",enableQRCode:!1}},createdAt:new Date,updatedAt:new Date},u={id:l,email:e.ownerEmail,name:e.ownerName,role:"owner",restaurantId:i,pin:Cte(),permissions:[{id:"1",name:"manage_all",description:"Full access",category:"settings"}],isActive:!0,createdAt:new Date,updatedAt:new Date},A=Rt(st,lo,i),h=Rt(st,Ste,l);return r.set(A,{...d,createdAt:wt.fromDate(d.createdAt),updatedAt:wt.fromDate(d.updatedAt)}),r.set(h,{...u,createdAt:wt.fromDate(u.createdAt),updatedAt:wt.fromDate(u.updatedAt)}),await r.commit(),this.cacheRestaurant(d),console.log(" Restaurant created successfully:",d.slug),{success:!0,data:{restaurant:d,user:u},message:"Restaurant created successfully"}}catch(r){return console.error(" Failed to create restaurant:",r),{success:!1,error:Xt(r)}}}static async getRestaurantBySlug(e){var r;try{const s=Ic.get(e);if(s&&Date.now()<s.expiresAt)return console.log(" Cache hit for restaurant slug:",e),{success:!0,data:s.restaurant};const n=`getRestaurantBySlug_${e}`,i=Date.now();for(const[l,c]of jd.entries())i-c.timestamp>G6*10&&jd.delete(l);if(jd.has(n)){const l=jd.get(n);return console.log(" Reusing existing query for restaurant:",e),await l.promise}console.log(" Fetching restaurant from Firebase:",e),console.log(" Query params:",{slug:e,isActive:!0});const o=this.executeRestaurantQuery(e);jd.set(n,{promise:o,timestamp:i});try{return await o}finally{setTimeout(()=>{jd.delete(n)},G6)}}catch(s){console.error(" Failed to get restaurant by slug:",s);let n="Failed to load restaurant";return s.code==="unavailable"||(r=s.message)!=null&&r.includes("network")?n="Network connection issue. Please check your internet connection and try again.":s.code==="permission-denied"?n="Access denied. Please check your permissions.":s.code==="quota-exceeded"&&(n="Service temporarily unavailable. Please try again later."),{success:!1,error:n}}}static async executeRestaurantQuery(e){var n,i;let s;for(let o=1;o<=3;o++)try{console.log(` Attempt ${o}/3 to fetch restaurant:`,e);const l=`${Date.now()}_${Math.random().toString(36).substr(2,9)}`;console.log(` Query ID: ${l}`),await new Promise(h=>setTimeout(h,Math.random()*20));const c=Zt(Jt(st,lo),Yt("slug","==",e),Yt("isActive","==",!0),Wi(1)),d=await ur(c);if(console.log(" Query result:",{empty:d.empty,size:d.size,docs:d.docs.map(h=>({id:h.id,slug:h.data().slug,name:h.data().name,isActive:h.data().isActive}))}),d.empty){console.log(" Restaurant not found with active filter, checking all restaurants with this slug..."),await new Promise(p=>setTimeout(p,10));const h=Zt(Jt(st,lo),Yt("slug","==",e),Wi(1)),f=await ur(h);return console.log(" Broad query result:",{empty:f.empty,size:f.size,docs:f.docs.map(p=>({id:p.id,slug:p.data().slug,name:p.data().name,isActive:p.data().isActive}))}),{success:!1,error:"Restaurant not found"}}const u=d.docs[0],A=this.convertFirestoreDoc(u.data(),u.id);return this.cacheRestaurant(A),console.log(" Restaurant loaded successfully:",e),{success:!0,data:A}}catch(l){if(s=l,console.warn(` Attempt ${o} failed for restaurant ${e}:`,l.message),(n=l.message)!=null&&n.includes("Target ID already exists")&&(console.log(" Target ID conflict detected, waiting longer before retry..."),await new Promise(c=>setTimeout(c,100+o*50))),o<3&&this.isRetryableError(l)){const c=(i=l.message)!=null&&i.includes("Target ID already exists")?200+o*100:Math.min(1e3*Math.pow(2,o-1),5e3);console.log(` Waiting ${c}ms before retry...`),await new Promise(d=>setTimeout(d,c));continue}break}throw s}static async getRestaurantById(e){try{const r=Array.from(Ic.values()).find(o=>o.restaurant.id===e&&Date.now()<o.expiresAt);if(r)return console.log(" Cache hit for restaurant ID:",e),{success:!0,data:r.restaurant};console.log(" Fetching restaurant by ID from Firebase:",e);const s=Rt(st,lo,e),n=await Kr(s);if(!n.exists())return{success:!1,error:"Restaurant not found"};const i=this.convertFirestoreDoc(n.data(),n.id);return this.cacheRestaurant(i),console.log(" Restaurant loaded by ID successfully:",e),{success:!0,data:i}}catch(r){return console.error(" Failed to get restaurant by ID:",r),{success:!1,error:Xt(r)}}}static async updateRestaurant(e,r){try{const s=Rt(st,lo,e),n={...r,updatedAt:wt.now()};await Xr(s,n);const i=await this.getRestaurantById(e);return i.success&&i.data&&this.cacheRestaurant(i.data),i}catch(s){return{success:!1,error:Xt(s)}}}static async getAllRestaurants(){try{const e=Zt(Jt(st,lo),On("createdAt","desc"));return{success:!0,data:(await ur(e)).docs.map(n=>this.convertFirestoreDoc(n.data(),n.id))}}catch(e){return{success:!1,error:Xt(e)}}}static async getAllActiveRestaurants(){try{const e=Zt(Jt(st,lo),Yt("isActive","==",!0),On("name"));return{success:!0,data:(await ur(e)).docs.map(n=>this.convertFirestoreDoc(n.data(),n.id))}}catch(e){return{success:!1,error:Xt(e)}}}static async getRestaurantsByType(e){try{const r=Zt(Jt(st,lo),Yt("businessType","==",e),Yt("isActive","==",!0),On("name"));return{success:!0,data:(await ur(r)).docs.map(i=>this.convertFirestoreDoc(i.data(),i.id))}}catch(r){return{success:!1,error:Xt(r)}}}static subscribeToRestaurant(e,r){const s=`restaurant_${e}`;if(Al.has(s)){console.log(" Adding callback to existing subscription for restaurant:",e);const c=Al.get(s);return c.callbacks.add(r),()=>{console.log(" Removing callback from restaurant subscription:",e),c.callbacks.delete(r),c.callbacks.size===0&&(console.log(" No more callbacks, cleaning up subscription for:",e),c.unsubscribe(),Al.delete(s))}}console.log(" Creating new subscription for restaurant:",e);const n=Zt(Jt(st,lo),Yt("slug","==",e),Yt("isActive","==",!0),Wi(1)),i=new Set([r]),o=Of(n,c=>{let d=null;if(!c.empty){const u=c.docs[0];d=this.convertFirestoreDoc(u.data(),u.id),this.cacheRestaurant(d)}i.forEach(u=>u(d))},c=>{console.error("Restaurant subscription error:",c),i.forEach(d=>d(null)),Al.delete(s)}),l={unsubscribe:()=>{console.log(" Cleaning up Firestore subscription for restaurant:",e),o()},callbacks:i};return Al.set(s,l),()=>{console.log(" Removing callback from restaurant subscription:",e),i.delete(r),i.size===0&&(console.log(" No more callbacks, cleaning up subscription for:",e),l.unsubscribe(),Al.delete(s))}}static async deactivateRestaurant(e){try{const r=Rt(st,lo,e);return await Xr(r,{isActive:!1,updatedAt:wt.now()}),Ic.forEach((s,n)=>{s.restaurant.id===e&&Ic.delete(n)}),{success:!0,message:"Restaurant deactivated successfully"}}catch(r){return{success:!1,error:Xt(r)}}}static async isSlugAvailable(e){try{const r=Zt(Jt(st,lo),Yt("slug","==",e),Wi(1));return(await ur(r)).empty}catch(r){return console.error("Error checking slug availability:",r),!1}}static async generateUniqueSlug(e){let r=e,s=1;for(;!await this.isSlugAvailable(r);)r=`${e}-${s}`,s++;return r}static convertFirestoreDoc(e,r){var s,n;return{id:r,name:e.name,slug:e.slug,businessType:e.businessType,ownerId:e.ownerId,isActive:e.isActive,settings:e.settings,createdBy:e.createdBy||"system",createdAt:((s=e.createdAt)==null?void 0:s.toDate())||new Date,updatedAt:((n=e.updatedAt)==null?void 0:n.toDate())||new Date}}static cacheRestaurant(e){Ic.set(e.slug,{restaurant:e,timestamp:Date.now(),expiresAt:Date.now()+Ete})}static clearCache(){Ic.clear()}static clearAllSubscriptions(){console.log(" Clearing all active restaurant subscriptions"),Al.forEach((e,r)=>{console.log(" Cleaning up subscription:",r),e.unsubscribe()}),Al.clear()}static clearAllQueries(){console.log(" Clearing all active restaurant queries"),jd.clear()}static getCacheStats(){return{size:Ic.size,entries:Array.from(Ic.keys())}}static getSubscriptionStats(){return{count:Al.size,subscriptions:Array.from(Al.keys())}}static getQueryStats(){return{count:jd.size,queries:Array.from(jd.keys())}}static debugSubscriptions(){console.log(" Debug: Current subscription status:"),console.log(` Active subscriptions: ${Al.size}`),Al.forEach((e,r)=>{console.log(`   ${r}: ${e.callbacks.size} callbacks`)})}static clearCacheForRestaurant(e){Ic.forEach((r,s)=>{r.restaurant.id===e&&Ic.delete(s)})}static isRetryableError(e){const r=["unavailable","deadline-exceeded","internal","resource-exhausted"],s=["network","connection","timeout","fetch","channel","target id already exists"];return r.includes(e.code)||s.some(n=>{var i;return(i=e.message)==null?void 0:i.toLowerCase().includes(n)})}}const JU=R.createContext(void 0);function _te({children:t}){const[e,r]=R.useState(null),[s,n]=R.useState(!0),[i,o]=R.useState(null),[l,c]=R.useState(!1),[d,u]=R.useState(!1),A=R.useRef(null),h=R.useRef(null),f=Li(),p=du();R.useEffect(()=>{const T=setTimeout(()=>{u(!0)},150);return()=>clearTimeout(T)},[]);const m=R.useCallback(()=>{const T=p.pathname.split("/").filter(Boolean);return T.length>0&&!["admin","auth","create-restaurant"].includes(T[0])?T[0]:null},[p.pathname]),g=R.useCallback(T=>{const j=Bj(T),C=document.documentElement;C.style.setProperty("--color-primary",j.colors.primary),C.style.setProperty("--color-secondary",j.colors.secondary),C.style.setProperty("--color-accent",j.colors.accent),C.style.setProperty("--color-background",j.colors.background),C.style.setProperty("--color-surface",j.colors.surface),C.style.setProperty("--color-text",j.colors.text),C.style.setProperty("--gradient-primary",j.gradients.primary),C.style.setProperty("--gradient-secondary",j.gradients.secondary);const w=document.querySelector('meta[name="theme-color"]');w&&w.setAttribute("content",j.colors.primary)},[]),y=R.useCallback(async T=>{try{n(!0),o(null),c(!1),h.current&&(clearTimeout(h.current),h.current=null),h.current=setTimeout(()=>{console.log(" Restaurant loading timeout reached - setting loading to false"),n(!1),o("Restaurant loading timed out. Please try refreshing the page."),h.current=null},8e3);const j=await si.getRestaurantBySlug(T);j.success&&j.data?(r(j.data),g(j.data.businessType),(!p.pathname.startsWith(`/${T}`)||p.pathname===`/${T}/spin-wheel`)&&!p.pathname.startsWith(`/${T}/login`)&&p.pathname!==`/${T}/spin-wheel`&&f(`/${T}`)):(o(j.error||"Restaurant not found"),r(null),console.error("Restaurant not found:",T,j.error))}catch(j){o(j.message||"Failed to load restaurant"),r(null),console.error("Error loading restaurant:",j)}finally{h.current&&(clearTimeout(h.current),h.current=null),n(!1)}},[f,p.pathname,g]),v=R.useCallback(async T=>{if(!e)throw new Error("No restaurant loaded");try{const j=await si.updateRestaurant(e.id,T);if(j.success&&j.data)r(j.data),T.businessType&&g(T.businessType),Z.success("Restaurant updated successfully");else throw new Error(j.error||"Failed to update restaurant")}catch(j){throw o(j.message),Z.error(j.message),j}},[e,g]),x=R.useCallback(async()=>{if(e)try{const T=await si.getRestaurantBySlug(e.slug);T.success&&T.data&&r(T.data)}catch(T){console.error("Failed to refresh restaurant:",T)}},[e]);R.useEffect(()=>{if(!d)return;const T=m();if(T)(!e||e.slug!==T)&&y(T);else{r(null),n(!1),o(null),c(!1);const j=document.documentElement;j.style.removeProperty("--color-primary"),j.style.removeProperty("--color-secondary"),j.style.removeProperty("--color-accent"),j.style.removeProperty("--color-background"),j.style.removeProperty("--color-surface"),j.style.removeProperty("--color-text"),j.style.removeProperty("--gradient-primary"),j.style.removeProperty("--gradient-secondary")}},[p.pathname,e,y,d]),R.useEffect(()=>{if(!e||l)return;A.current&&clearTimeout(A.current);let T=null;return A.current=setTimeout(()=>{console.log(" Setting up restaurant subscription for:",e.slug),c(!0),T=si.subscribeToRestaurant(e.slug,j=>{j?(r(j),g(j.businessType)):(r(null),o("Restaurant not found or has been deactivated"),console.error("Restaurant subscription lost:",e.slug),c(!1))}),A.current=null},100),()=>{A.current&&(clearTimeout(A.current),A.current=null),T&&(console.log(" Cleaning up restaurant subscription for:",e.slug),T(),c(!1))}},[e==null?void 0:e.slug]),R.useEffect(()=>()=>{h.current&&(clearTimeout(h.current),h.current=null)},[]);const E={restaurant:e,loading:s,error:i,switchRestaurant:y,updateRestaurant:v,refreshRestaurant:x};return a.jsx(JU.Provider,{value:E,children:t})}function js(){const t=R.useContext(JU);if(t===void 0)throw new Error("useRestaurant must be used within a RestaurantProvider");return t}const nc=[{id:"orders",name:"Orders Management",description:"View and manage customer orders",category:"core",icon:"ShoppingBag",defaultAccess:!0},{id:"take_order",name:"Take Orders",description:"Create new orders and process payments",category:"core",icon:"Plus",defaultAccess:!0},{id:"order_edit",name:"Edit Orders",description:"Modify existing orders and items",category:"core",icon:"Edit",defaultAccess:!1},{id:"order_cancel",name:"Cancel Orders",description:"Cancel orders and process refunds",category:"core",icon:"X",defaultAccess:!1},{id:"order_status",name:"Order Status Management",description:"Update order status (confirmed, preparing, ready)",category:"core",icon:"Clock",defaultAccess:!0},{id:"billing",name:"Billing & Payments",description:"Process payments and generate bills",category:"core",icon:"Receipt",defaultAccess:!0},{id:"discounts",name:"Apply Discounts",description:"Apply percentage or fixed amount discounts",category:"core",icon:"Percent",defaultAccess:!1},{id:"refunds",name:"Process Refunds",description:"Issue refunds and handle returns",category:"core",icon:"RotateCcw",defaultAccess:!1},{id:"kot_print",name:"KOT Printing",description:"Print Kitchen Order Tickets",category:"core",icon:"Printer",defaultAccess:!0},{id:"tables",name:"Table Management",description:"Manage table status and reservations",category:"core",icon:"Grid3X3",defaultAccess:!0},{id:"table_merge",name:"Table Merge/Transfer",description:"Merge tables and transfer orders between tables",category:"core",icon:"ArrowRightLeft",defaultAccess:!1},{id:"table_areas",name:"Table Areas Management",description:"Create and manage table areas/floors",category:"management",icon:"Map",defaultAccess:!1},{id:"kitchen",name:"Kitchen Display",description:"Access kitchen display system",category:"core",icon:"ChefHat",defaultAccess:!0},{id:"kitchen_manage",name:"Kitchen Order Management",description:"Update order status from kitchen",category:"core",icon:"Timer",defaultAccess:!1},{id:"menu",name:"Menu Management",description:"Add, edit, and manage menu items",category:"management",icon:"ChefHat",defaultAccess:!1},{id:"menu_categories",name:"Category Management",description:"Create and manage menu categories",category:"management",icon:"Folder",defaultAccess:!1},{id:"menu_pricing",name:"Menu Pricing",description:"Update menu item prices",category:"management",icon:"DollarSign",defaultAccess:!1},{id:"menu_availability",name:"Menu Availability",description:"Enable/disable menu items",category:"management",icon:"ToggleLeft",defaultAccess:!1},{id:"menu_variants",name:"Menu Variants",description:"Manage item variants and customizations",category:"management",icon:"Settings",defaultAccess:!1},{id:"bulk_menu_import",name:"Bulk Menu Import",description:"Import menu items in bulk",category:"management",icon:"Upload",defaultAccess:!1},{id:"inventory",name:"Inventory Management",description:"Track and manage inventory levels",category:"management",icon:"Package",defaultAccess:!1},{id:"inventory_restock",name:"Inventory Restocking",description:"Restock inventory items",category:"management",icon:"RefreshCw",defaultAccess:!1},{id:"expenses",name:"Expense Tracker",description:"View and manage business expenses",category:"management",icon:"Receipt",defaultAccess:!1},{id:"reports",name:"Business Reports",description:"Generate and download comprehensive business reports",category:"reports",icon:"FileText",defaultAccess:!1},{id:"inventory_adjustments",name:"Inventory Adjustments",description:"Make manual inventory adjustments",category:"management",icon:"Edit",defaultAccess:!1},{id:"inventory_alerts",name:"Inventory Alerts",description:"View and manage low stock alerts",category:"management",icon:"AlertTriangle",defaultAccess:!1},{id:"suppliers",name:"Supplier Management",description:"Manage suppliers and vendor information",category:"management",icon:"Truck",defaultAccess:!1},{id:"customers",name:"Customer Management",description:"Manage customer information and loyalty",category:"management",icon:"Users",defaultAccess:!1},{id:"customer_create",name:"Create Customers",description:"Add new customers to database",category:"management",icon:"UserPlus",defaultAccess:!0},{id:"customer_edit",name:"Edit Customer Info",description:"Modify customer information",category:"management",icon:"UserCheck",defaultAccess:!1},{id:"customer_history",name:"Customer Order History",description:"View customer order history and analytics",category:"management",icon:"History",defaultAccess:!1},{id:"loyalty_points",name:"Loyalty Points Management",description:"Manage customer loyalty points",category:"management",icon:"Star",defaultAccess:!1},{id:"customer_export",name:"Customer Data Export",description:"Export customer data to CSV",category:"management",icon:"Download",defaultAccess:!1},{id:"credits",name:"Credit Management",description:"Manage customer credits and payments",category:"management",icon:"CreditCard",defaultAccess:!1},{id:"credit_add",name:"Add Customer Credit",description:"Add credit to customer accounts",category:"management",icon:"Plus",defaultAccess:!1},{id:"credit_collect",name:"Collect Credit Payments",description:"Collect payments for outstanding credits",category:"management",icon:"DollarSign",defaultAccess:!1},{id:"credit_history",name:"Credit Transaction History",description:"View customer credit transaction history",category:"management",icon:"FileText",defaultAccess:!1},{id:"coupons",name:"Coupon Management",description:"Create and manage discount coupons",category:"management",icon:"Gift",defaultAccess:!1},{id:"coupon_create",name:"Create Coupons",description:"Create new promotional coupons",category:"management",icon:"PlusCircle",defaultAccess:!1},{id:"coupon_apply",name:"Apply Coupons",description:"Apply coupons to customer orders",category:"management",icon:"Tag",defaultAccess:!0},{id:"coupon_analytics",name:"Coupon Analytics",description:"View coupon usage and effectiveness",category:"reports",icon:"BarChart",defaultAccess:!1},{id:"gamification",name:"Gamification Dashboard",description:"Manage spin wheel and customer games",category:"management",icon:"Gamepad2",defaultAccess:!1},{id:"spin_wheel_config",name:"Spin Wheel Configuration",description:"Configure spin wheel settings and rewards",category:"management",icon:"Target",defaultAccess:!1},{id:"spin_wheel_analytics",name:"Spin Wheel Analytics",description:"View spin wheel performance and engagement",category:"reports",icon:"TrendingUp",defaultAccess:!1},{id:"customer_spins",name:"Customer Spin Management",description:"View and manage customer spins",category:"management",icon:"RotateCcw",defaultAccess:!1},{id:"rewards_management",name:"Rewards Management",description:"Manage customer rewards and redemptions",category:"management",icon:"Award",defaultAccess:!1},{id:"customer_portal",name:"Customer Portal Management",description:"Configure customer menu portal",category:"management",icon:"Smartphone",defaultAccess:!1},{id:"qr_codes",name:"QR Code Management",description:"Generate and manage QR codes",category:"management",icon:"QrCode",defaultAccess:!1},{id:"table_portals",name:"Table-Specific Portals",description:"Create table-specific menu links",category:"management",icon:"Link",defaultAccess:!1},{id:"portal_analytics",name:"Portal Analytics",description:"View customer portal usage analytics",category:"reports",icon:"Globe",defaultAccess:!1},{id:"voice_commands",name:"Voice Commands",description:"Use AI voice commands for operations",category:"core",icon:"Mic",defaultAccess:!1},{id:"voice_orders",name:"Voice Order Taking",description:"Take orders using voice commands",category:"core",icon:"MessageSquare",defaultAccess:!1},{id:"voice_customers",name:"Voice Customer Management",description:"Add customers using voice commands",category:"management",icon:"UserVoice",defaultAccess:!1},{id:"marketplace",name:"Marketplace Access",description:"Access B2B marketplace for bulk ordering",category:"management",icon:"ShoppingCart",defaultAccess:!1},{id:"marketplace_orders",name:"Marketplace Orders",description:"Place and manage marketplace orders",category:"management",icon:"Package2",defaultAccess:!1},{id:"marketplace_analytics",name:"Marketplace Analytics",description:"View marketplace spending and supplier analytics",category:"reports",icon:"TrendingDown",defaultAccess:!1},{id:"supplier_reviews",name:"Supplier Reviews",description:"Review and rate suppliers",category:"management",icon:"Star",defaultAccess:!1},{id:"dashboard",name:"Dashboard Analytics",description:"View dashboard statistics and insights",category:"reports",icon:"TrendingUp",defaultAccess:!0},{id:"reports",name:"Sales Reports",description:"View detailed sales reports and analytics",category:"reports",icon:"BarChart3",defaultAccess:!1},{id:"financial_reports",name:"Financial Reports",description:"View revenue, profit, and financial analytics",category:"reports",icon:"DollarSign",defaultAccess:!1},{id:"operational_reports",name:"Operational Reports",description:"View operational efficiency and performance reports",category:"reports",icon:"Activity",defaultAccess:!1},{id:"staff_analytics",name:"Staff Performance Analytics",description:"View staff performance and productivity reports",category:"reports",icon:"Users",defaultAccess:!1},{id:"customer_analytics",name:"Customer Analytics",description:"View customer behavior and preference analytics",category:"reports",icon:"UserCheck",defaultAccess:!1},{id:"export_reports",name:"Export Reports",description:"Export reports to PDF/Excel",category:"reports",icon:"Download",defaultAccess:!1},{id:"settings",name:"Restaurant Settings",description:"Manage restaurant configuration and preferences",category:"settings",icon:"Settings",defaultAccess:!1},{id:"business_info",name:"Business Information",description:"Update restaurant business information",category:"settings",icon:"Building",defaultAccess:!1},{id:"payment_settings",name:"Payment Settings",description:"Configure payment methods and UPI settings",category:"settings",icon:"CreditCard",defaultAccess:!1},{id:"tax_settings",name:"Tax Configuration",description:"Configure tax rates and billing settings",category:"settings",icon:"Calculator",defaultAccess:!1},{id:"theme_settings",name:"Theme & Branding",description:"Customize restaurant theme and branding",category:"settings",icon:"Palette",defaultAccess:!1},{id:"operating_hours",name:"Operating Hours",description:"Set restaurant operating hours",category:"settings",icon:"Clock",defaultAccess:!1},{id:"employees",name:"Employee Management",description:"Manage staff and their permissions (Owner only)",category:"settings",icon:"UserPlus",defaultAccess:!1},{id:"employee_create",name:"Create Employees",description:"Add new employees to the system",category:"settings",icon:"UserPlus",defaultAccess:!1},{id:"employee_permissions",name:"Employee Permissions",description:"Assign and modify employee permissions",category:"settings",icon:"Shield",defaultAccess:!1},{id:"employee_analytics",name:"Employee Analytics",description:"View employee performance and activity",category:"reports",icon:"BarChart",defaultAccess:!1},{id:"multi_location",name:"Multi-Location Support",description:"Manage multiple restaurant locations",category:"settings",icon:"MapPin",defaultAccess:!1},{id:"api_access",name:"API Access",description:"Access to restaurant APIs and integrations",category:"settings",icon:"Code",defaultAccess:!1},{id:"data_export",name:"Data Export/Backup",description:"Export restaurant data and create backups",category:"settings",icon:"Database",defaultAccess:!1},{id:"system_logs",name:"System Logs",description:"View system activity and audit logs",category:"settings",icon:"FileText",defaultAccess:!1}],Pj=async t=>{const r=new TextEncoder().encode(t),s=await crypto.subtle.digest("SHA-256",r);return Array.from(new Uint8Array(s)).map(n=>n.toString(16).padStart(2,"0")).join("")},Tte=async(t,e)=>await Pj(t)===e;class qn{static getDefaultPermissions(){return nc.map(e=>({module:e.id,access:e.defaultAccess}))}static async createEmployee(e,r,s){try{const n=Zt(Jt(st,"employees"),Yt("restaurantId","==",e),Yt("email","==",s.email));if(!(await ur(n)).empty)return{success:!1,error:"An employee with this email already exists"};const o=Zt(Jt(st,"employees"),Yt("restaurantId","==",e),Yt("pin","==",s.pin));if(!(await ur(o)).empty)return{success:!1,error:"An employee with this PIN already exists"};const c=await Pj(s.password),d={restaurantId:e,name:s.name,email:s.email,passwordHash:c,pin:s.pin,role:s.role,permissions:s.permissions,isActive:!0,createdAt:wt.now(),updatedAt:wt.now(),createdBy:r};return{success:!0,data:{id:(await Bi(Jt(st,"employees"),d)).id,restaurantId:e,name:s.name,email:s.email,pin:s.pin,role:s.role,permissions:s.permissions,isActive:!0,createdAt:d.createdAt.toDate(),updatedAt:d.updatedAt.toDate(),createdBy:r},message:"Employee created successfully"}}catch(n){return console.error("Error creating employee:",n),{success:!1,error:n instanceof Error?n.message:"Failed to create employee"}}}static async getEmployees(e){try{const r=Zt(Jt(st,"employees"),Yt("restaurantId","==",e)),s=await ur(r),n=[];return s.forEach(i=>{var l;const o=i.data();n.push({id:i.id,restaurantId:o.restaurantId,name:o.name,email:o.email,pin:o.pin,role:o.role,permissions:o.permissions||[],isActive:o.isActive,lastLoginAt:(l=o.lastLoginAt)==null?void 0:l.toDate(),createdAt:o.createdAt.toDate(),updatedAt:o.updatedAt.toDate(),createdBy:o.createdBy})}),n.sort((i,o)=>o.createdAt.getTime()-i.createdAt.getTime()),{success:!0,data:n}}catch(r){return console.error("Error fetching employees:",r),{success:!1,error:r instanceof Error?r.message:"Failed to fetch employees"}}}static async getEmployee(e){var r;try{const s=Rt(st,"employees",e),n=await Kr(s);if(!n.exists())return{success:!1,error:"Employee not found"};const i=n.data();return{success:!0,data:{id:n.id,restaurantId:i.restaurantId,name:i.name,email:i.email,pin:i.pin,role:i.role,permissions:i.permissions||[],isActive:i.isActive,lastLoginAt:(r=i.lastLoginAt)==null?void 0:r.toDate(),createdAt:i.createdAt.toDate(),updatedAt:i.updatedAt.toDate(),createdBy:i.createdBy}}}catch(s){return console.error("Error fetching employee:",s),{success:!1,error:s instanceof Error?s.message:"Failed to fetch employee"}}}static async updateEmployee(e,r){try{const s=Rt(st,"employees",e),n={updatedAt:wt.now()};return r.name&&(n.name=r.name),r.email&&(n.email=r.email),r.pin&&(n.pin=r.pin),r.role&&(n.role=r.role),r.permissions&&(n.permissions=r.permissions),r.isActive!==void 0&&(n.isActive=r.isActive),r.password&&(n.passwordHash=await Pj(r.password)),await Xr(s,n),await this.getEmployee(e)}catch(s){return console.error("Error updating employee:",s),{success:!1,error:s instanceof Error?s.message:"Failed to update employee"}}}static async deleteEmployee(e){try{const r=Rt(st,"employees",e);return await Pl(r),{success:!0,message:"Employee deleted successfully"}}catch(r){return console.error("Error deleting employee:",r),{success:!1,error:r instanceof Error?r.message:"Failed to delete employee"}}}static async loginEmployee(e,r,s){try{const n=Zt(Jt(st,"employees"),Yt("restaurantId","==",s),Yt("email","==",e)),i=await ur(n);if(i.empty)return{success:!1,error:"Invalid email or password"};const o=i.docs[0],l=o.data();return l.isActive?await Tte(r,l.passwordHash)?(await Xr(Rt(st,"employees",o.id),{lastLoginAt:wt.now()}),{success:!0,data:{id:o.id,restaurantId:l.restaurantId,name:l.name,email:l.email,pin:l.pin,role:l.role,permissions:l.permissions||[],isActive:l.isActive,lastLoginAt:new Date,createdAt:l.createdAt.toDate(),updatedAt:l.updatedAt.toDate(),createdBy:l.createdBy},message:"Login successful"}):{success:!1,error:"Invalid email or password"}:{success:!1,error:"Your account has been deactivated. Contact your manager."}}catch(n){return console.error("Error during employee login:",n),{success:!1,error:n instanceof Error?n.message:"Login failed"}}}static async loginEmployeeWithPin(e,r){try{const s=Zt(Jt(st,"employees"),Yt("restaurantId","==",r),Yt("pin","==",e)),n=await ur(s);if(n.empty)return{success:!1,error:"Invalid PIN"};const i=n.docs[0],o=i.data();return o.isActive?(await Xr(Rt(st,"employees",i.id),{lastLoginAt:wt.now()}),{success:!0,data:{id:i.id,restaurantId:o.restaurantId,name:o.name,email:o.email,pin:o.pin,role:o.role,permissions:o.permissions||[],isActive:o.isActive,lastLoginAt:new Date,createdAt:o.createdAt.toDate(),updatedAt:o.updatedAt.toDate(),createdBy:o.createdBy},message:"Login successful"}):{success:!1,error:"Your account has been deactivated. Contact your manager."}}catch(s){return console.error("Error during employee PIN login:",s),{success:!1,error:s instanceof Error?s.message:"Login failed"}}}static hasPermission(e,r){if(!e||!e.permissions)return!1;const s=e.permissions.find(n=>n.module===r);return s?s.access:!1}static getAccessibleModules(e){return!e||!e.permissions?[]:nc.filter(r=>{const s=e.permissions.find(n=>n.module===r.id);return s?s.access:!1})}static async logEmployeeActivity(e,r,s,n){try{return await Bi(Jt(st,"employee_activity"),{employeeId:e,restaurantId:r,action:s,details:n||{},timestamp:wt.now(),createdAt:wt.now()}),{success:!0}}catch(i){return console.error("Error logging employee activity:",i),{success:!1,error:"Failed to log employee activity"}}}static async getEmployeeActivity(e,r,s=50){try{const n=Zt(Jt(st,"employee_activity"),Yt("employeeId","==",e),Yt("restaurantId","==",r));return{success:!0,data:(await ur(n)).docs.map(c=>{var d,u;return{id:c.id,...c.data(),timestamp:(d=c.data().timestamp)==null?void 0:d.toDate(),createdAt:(u=c.data().createdAt)==null?void 0:u.toDate()}}).sort((c,d)=>d.timestamp.getTime()-c.timestamp.getTime()).slice(0,s)}}catch(n){return console.error("Error fetching employee activity:",n),{success:!1,error:"Failed to fetch employee activity"}}}static async clockIn(e,r){try{const s=Zt(Jt(st,"employee_shifts"),Yt("employeeId","==",e),Yt("restaurantId","==",r),Yt("clockOutTime","==",null));if(!(await ur(s)).empty)return{success:!1,error:"Employee is already clocked in"};const i={employeeId:e,restaurantId:r,clockInTime:wt.now(),clockOutTime:null,breakTime:0,totalHours:0,date:new Date().toISOString().split("T")[0],createdAt:wt.now()},o=await Bi(Jt(st,"employee_shifts"),i);return await this.logEmployeeActivity(e,r,"clock_in",{shiftId:o.id,timestamp:new Date}),{success:!0,data:{id:o.id,...i}}}catch(s){return console.error("Error clocking in employee:",s),{success:!1,error:"Failed to clock in"}}}static async clockOut(e,r){try{const s=Zt(Jt(st,"employee_shifts"),Yt("employeeId","==",e),Yt("restaurantId","==",r),Yt("clockOutTime","==",null)),n=await ur(s);if(n.empty)return{success:!1,error:"No active shift found"};const i=n.docs[0],o=i.data(),l=wt.now(),c=o.clockInTime.toDate(),d=(l.toDate().getTime()-c.getTime())/(1e3*60*60);return await Xr(Rt(st,"employee_shifts",i.id),{clockOutTime:l,totalHours:Math.round(d*100)/100,updatedAt:wt.now()}),await this.logEmployeeActivity(e,r,"clock_out",{shiftId:i.id,totalHours:d,timestamp:new Date}),{success:!0,data:{shiftId:i.id,totalHours:d,clockInTime:c,clockOutTime:l.toDate()}}}catch(s){return console.error("Error clocking out employee:",s),{success:!1,error:"Failed to clock out"}}}static async getCurrentShiftStatus(e,r){var s;try{const n=Zt(Jt(st,"employee_shifts"),Yt("employeeId","==",e),Yt("restaurantId","==",r),Yt("clockOutTime","==",null)),i=await ur(n);if(i.empty)return{success:!0,data:{isClocked:!1,shift:null}};const o=i.docs[0],l=o.data();return{success:!0,data:{isClocked:!0,shift:{id:o.id,clockInTime:(s=l.clockInTime)==null?void 0:s.toDate(),currentHours:(new Date().getTime()-l.clockInTime.toDate().getTime())/(1e3*60*60)}}}}catch(n){return console.error("Error fetching current shift status:",n),{success:!1,error:"Failed to fetch shift status"}}}static async getEmployeePerformance(e,r,s){try{let n=Zt(Jt(st,"orders"),Yt("staffId","==",e),Yt("restaurantId","==",r));const o=(await ur(n)).docs.map(m=>{var g;return{id:m.id,...m.data(),createdAt:(g=m.data().createdAt)==null?void 0:g.toDate()}}),l=s?o.filter(m=>m.createdAt>=s.start&&m.createdAt<=s.end):o,c=l.length,d=l.reduce((m,g)=>m+(g.total||0),0),u=c>0?d/c:0,A=l.filter(m=>m.status==="completed"),h=l.filter(m=>m.status==="cancelled"),f=c>0?A.length/c*100:0,p=c>0?h.length/c*100:0;return{success:!0,data:{totalOrders:c,totalRevenue:d,averageOrderValue:u,completionRate:f,cancellationRate:p,completedOrders:A.length,cancelledOrders:h.length,period:s||{start:null,end:null}}}}catch(n){return console.error("Error fetching employee performance:",n),{success:!1,error:"Failed to fetch employee performance"}}}static async getAllEmployeesPerformance(e,r){try{const s=await this.getEmployees(e);if(!s.success||!s.data)return{success:!1,error:"Failed to fetch employees"};const n=s.data.map(async o=>{const l=await this.getEmployeePerformance(o.id,e,r);return{employee:{id:o.id,name:o.name,email:o.email,role:o.role,isActive:o.isActive},performance:l.success?l.data:null}});return{success:!0,data:await Promise.all(n)}}catch(s){return console.error("Error fetching all employees performance:",s),{success:!1,error:"Failed to fetch employees performance"}}}}class c1{static async loginWithEmail(e,r,s){var n,i,o,l;try{console.log(" Starting email login:",{email:e,restaurantSlug:s});const c=Zt(Jt(st,"pendingUsers"),Yt("email","==",e)),d=await ur(c);if(console.log(" Pending users check:",{empty:d.empty,size:d.size}),!d.empty)return console.log(" Found pending user, handling first-time signup"),await this.handleFirstTimeSignup(e,r,s,d.docs[0]);console.log(" No pending user found, checking for employee login...");const u=Zt(Jt(st,"restaurants"),Yt("slug","==",s)),A=await ur(u);if(!A.empty){const f=A.docs[0].id;console.log(" Attempting employee login for restaurant:",f);const p=await qn.loginEmployee(e,r,f);if(p.success&&p.data)return console.log(" Employee login successful:",p.data.name),{success:!0,user:{id:p.data.id,email:p.data.email,name:p.data.name,role:p.data.role,restaurantId:p.data.restaurantId,pin:p.data.pin,permissions:[],isActive:p.data.isActive,lastLoginAt:p.data.lastLoginAt,createdAt:p.data.createdAt,updatedAt:p.data.updatedAt,createdBy:p.data.createdBy}}}console.log(" Employee login failed, attempting owner login");try{console.log(" Attempting Firebase Auth login...");const f=(await ij(yn,e,r)).user;if(console.log(" Firebase Auth successful:",f.uid),!(f!=null&&f.email))return console.log(" No Firebase user email"),{success:!1,error:"Authentication failed"};console.log(" Looking for user document in Firestore...");const p=await Kr(Rt(st,"users",f.uid));if(console.log(" User document exists:",p.exists()),!p.exists())return console.log(" User document not found in Firestore"),await Em(yn),{success:!1,error:"User account not found. Please contact your administrator."};const m=p.data(),g={id:p.id,email:m.email,name:m.name,role:m.role,restaurantId:m.restaurantId,pin:m.pin,permissions:m.permissions||[],isActive:m.isActive,lastLoginAt:(n=m.lastLoginAt)==null?void 0:n.toDate(),createdAt:((i=m.createdAt)==null?void 0:i.toDate())||new Date,updatedAt:((o=m.updatedAt)==null?void 0:o.toDate())||new Date,createdBy:m.createdBy};if(!g.restaurantId)return await Em(yn),{success:!1,error:"User not associated with any restaurant"};const y=await Kr(Rt(st,"restaurants",g.restaurantId));if(!y)throw new Error("Failed to retrieve restaurant data");if(y.exists()){const v=y.data();console.log(" Restaurant data:",{name:v==null?void 0:v.name,id:m.restaurantId})}else return console.log(" Restaurant document not found:",m.restaurantId),await Em(yn),{success:!1,error:"Restaurant not found"};return g.isActive?(l=y.data())!=null&&l.isActive?(await Xr(Rt(st,"users",g.id),{lastLoginAt:Ro(),updatedAt:Ro()}),{success:!0,user:{...g,lastLoginAt:new Date}}):(await Em(yn),{success:!1,error:"This restaurant is currently inactive"}):(await Em(yn),{success:!1,error:"Your account has been deactivated. Contact your manager."})}catch(h){if(h.code==="auth/user-not-found"||h.code==="auth/wrong-password")return{success:!1,error:"Invalid email or password"};throw h}}catch(c){return{success:!1,error:Xt(c)}}}static async handleFirstTimeSignup(e,r,s,n){var i,o,l,c,d,u;try{const A=n.data();console.log(" First-time signup data:",{email:A.email,restaurantId:A.restaurantId,tempPassword:((i=A.tempPassword)==null?void 0:i.substring(0,3))+"***"});const h=r.trim(),f=(o=A.tempPassword)==null?void 0:o.trim();if(console.log(" Password comparison:",{providedLength:h.length,expectedLength:f==null?void 0:f.length,match:h===f}),h!==f)return console.log(" Password mismatch:",{provided:h.substring(0,3)+"***",expected:(f==null?void 0:f.substring(0,3))+"***"}),{success:!1,error:"Invalid password. Please use the password provided by your admin."};console.log(" Password verified, checking restaurant...");const p=await Kr(Rt(st,"restaurants",A.restaurantId));if(!p.exists())return console.log(" Restaurant not found"),{success:!1,error:"Restaurant not found"};const m=p.data();if(console.log(" Restaurant data:",{slug:m.slug,expectedSlug:s,isActive:m.isActive}),m.slug!==s)return console.log(" Restaurant slug mismatch"),{success:!1,error:"User does not belong to this restaurant"};console.log(" Restaurant verified, creating Firebase Auth account...");let g,y;try{g=await FL(yn,e,r),y=g.user,console.log(" Firebase Auth account created:",y.uid)}catch(w){if(console.log(" Firebase Auth error:",w.code,w.message),w.code==="auth/email-already-in-use"){console.log(" Email already in use, attempting to sign in...");try{g=await ij(yn,e,r),y=g.user,console.log(" Firebase Auth sign in successful:",y.uid)}catch(S){return console.log(" Sign in failed:",S.code,S.message),{success:!1,error:"Account setup error. Please contact your administrator."}}}else return console.log(" Failed to create Firebase Auth account:",w.message),{success:!1,error:`Account creation failed: ${w.message}`}}const v={id:y.uid,email:A.email,name:A.name,role:A.role,restaurantId:A.restaurantId,pin:A.pin,permissions:A.permissions||[{id:"1",name:"manage_all",description:"Full restaurant access",category:"settings"}],isActive:A.isActive,lastLoginAt:new Date,createdAt:((l=A.createdAt)==null?void 0:l.toDate())||new Date,updatedAt:new Date,createdBy:A.createdBy},x=await Kr(Rt(st,"users",y.uid));if(x.exists()){console.log(" User document already exists, proceeding with login..."),await Pl(Rt(st,"pendingUsers",n.id)),console.log(" Deleted pending user document");const w=x.data(),S={id:x.id,email:w.email,name:w.name,role:w.role,restaurantId:w.restaurantId,pin:w.pin,permissions:w.permissions||[],isActive:w.isActive,lastLoginAt:(c=w.lastLoginAt)==null?void 0:c.toDate(),createdAt:((d=w.createdAt)==null?void 0:d.toDate())||new Date,updatedAt:((u=w.updatedAt)==null?void 0:u.toDate())||new Date,createdBy:w.createdBy};return await Xr(Rt(st,"users",y.uid),{lastLoginAt:Ro(),updatedAt:Ro()}),{success:!0,user:{...S,lastLoginAt:new Date}}}const E=jl(st);console.log(" Creating batch write operations...");const T=Rt(st,"users",y.uid);E.set(T,{...v,createdAt:A.createdAt,updatedAt:Ro(),lastLoginAt:Ro()}),console.log(" Added user creation to batch");const j=Rt(st,"restaurants",A.restaurantId);E.update(j,{ownerId:y.uid,updatedAt:Ro()}),console.log(" Added restaurant update to batch");const C=Rt(st,"pendingUsers",n.id);return E.delete(C),console.log(" Added pending user deletion to batch"),console.log(" Committing batch write..."),await E.commit(),console.log(" Batch write completed successfully"),{success:!0,user:{...v,lastLoginAt:new Date}}}catch(A){return{success:!1,error:Xt(A)}}}static async loginWithPin(e,r){var s,n,i,o,l,c,d,u;try{console.log(" Starting PIN login:",{pin:e.substring(0,2)+"**",restaurantSlug:r});const A=Zt(Jt(st,"restaurants"),Yt("slug","==",r)),h=await ur(A);if(h.empty)return{success:!1,error:"Restaurant not found"};const p=h.docs[0].id;console.log(" Attempting employee PIN login...");const m=await qn.loginEmployeeWithPin(e.trim(),p);if(m.success&&m.data)return console.log(" Employee PIN login successful:",m.data.name),{success:!0,user:{id:m.data.id,email:m.data.email,name:m.data.name,role:m.data.role,restaurantId:m.data.restaurantId,pin:m.data.pin,permissions:[],isActive:m.data.isActive,lastLoginAt:m.data.lastLoginAt,createdAt:m.data.createdAt,updatedAt:m.data.updatedAt,createdBy:m.data.createdBy}};console.log(" Employee PIN login failed, attempting owner PIN login");const g=e.trim(),y=Zt(Jt(st,"users"),Yt("pin","==",g));console.log(" Searching for users with PIN..."),console.log(" Searching for PIN:",g.substring(0,2)+"**");let v;try{v=await ur(y)}catch(E){throw(s=E.message)!=null&&s.includes("INTERNAL ASSERTION FAILED")||(n=E.message)!=null&&n.includes("Unexpected state")?(console.error(" Firestore internal assertion failure detected. Please refresh the page."),new Error("Database connection error. Please refresh the page and try again.")):E}if(console.log(" Found users with PIN:",v.size),v.empty){console.log(" No users found with PIN");const E=Zt(Jt(st,"pendingUsers"),Yt("pin","==",g));try{const T=await ur(E);if(!T.empty)for(const j of T.docs){const C=j.data();if(C.restaurantId){const w=await Kr(Rt(st,"restaurants",C.restaurantId));if(w.exists()&&((i=w.data())==null?void 0:i.slug)===r)return{success:!1,error:"Please complete your first-time setup by logging in with your email and password first, then you can use PIN login."}}}}catch(T){console.error("Error checking pending users:",T)}return{success:!1,error:"Invalid PIN"}}let x=null;console.log(" Checking users for restaurant match...");for(const E of v.docs){const T=E.data();if(console.log(" Checking user:",{id:E.id,email:T.email,restaurantId:T.restaurantId}),T.restaurantId){console.log(" Fetching restaurant data for:",T.restaurantId);let j;try{j=await Kr(Rt(st,"restaurants",T.restaurantId))}catch(C){throw((o=C.message)!=null&&o.includes("INTERNAL ASSERTION FAILED")||(l=C.message)!=null&&l.includes("Unexpected state"))&&console.error(" Firestore assertion failure in restaurant fetch"),C}if(j.exists()){const C=j.data();if(console.log(" Restaurant data:",{slug:C.slug,expectedSlug:r,match:C.slug===r}),C.slug===r){console.log(" Found matching user for restaurant"),x={id:E.id,email:T.email,name:T.name,role:T.role,restaurantId:T.restaurantId,pin:T.pin,permissions:T.permissions||[],isActive:T.isActive,lastLoginAt:(c=T.lastLoginAt)==null?void 0:c.toDate(),createdAt:((d=T.createdAt)==null?void 0:d.toDate())||new Date,updatedAt:((u=T.updatedAt)==null?void 0:u.toDate())||new Date,createdBy:T.createdBy};break}}else console.log(" Restaurant document not found:",T.restaurantId)}else console.log(" User has no restaurantId:",E.id)}return x?x.isActive?(console.log(" PIN authentication successful for user:",x.name),console.log(" Updating last login time..."),await Xr(Rt(st,"users",x.id),{lastLoginAt:Ro(),updatedAt:Ro()}),console.log(" PIN login completed successfully"),{success:!0,user:{...x,lastLoginAt:new Date}}):(console.log(" User is not active"),{success:!1,error:"Your account has been deactivated. Contact your manager."}):(console.log(" No valid user found for restaurant"),{success:!1,error:"Invalid PIN for this restaurant"})}catch(A){return console.error(" PIN login error:",A),{success:!1,error:Xt(A)}}}static async logout(){try{await Em(yn)}catch(e){throw new Error(Xt(e))}}static getCurrentFirebaseUser(){return yn.currentUser}static isFirebaseAuthenticated(){return yn.currentUser!==null}}const ZU=R.createContext(void 0),Sd="restaurant_auth_user",Ed="restaurant_auth_pin_mode";function Ite({children:t}){const[e,r]=R.useState(null),[s,n]=R.useState(!0),[i,o]=R.useState(!1),l=R.useRef(null),c=R.useRef(!1),d=R.useRef(!1);R.useEffect(()=>{l.current=e},[e]),R.useEffect(()=>{c.current=i},[i]),R.useEffect(()=>{const p=setTimeout(()=>{d.current||(console.log(" Fallback auth initialization - preventing infinite loading"),n(!1),d.current=!0)},8e3);return()=>clearTimeout(p)},[]),R.useEffect(()=>{console.log(" RestaurantAuthContext: Initializing from localStorage");const p=async()=>{try{const g=Fa.get(Sd,null),y=Fa.get(Ed,!1);g&&y?(console.log(" Restored PIN authenticated user from localStorage:",g.name),r(g),o(!0)):g&&!y&&(console.log(" Found stored user (Firebase auth mode)"),r(g),o(!1))}catch(g){console.error("Failed to restore auth state from localStorage:",g),Fa.remove(Sd),Fa.remove(Ed)}},m=setTimeout(()=>{console.log(" localStorage initialization timeout - proceeding without stored auth")},2e3);return p().finally(()=>{clearTimeout(m)}),()=>{clearTimeout(m)}},[]),R.useEffect(()=>{console.log(" RestaurantAuthContext: Setting up Firebase auth listener");const p=setTimeout(()=>{console.log(" Auth initialization timeout reached - setting loading to false"),n(!1),d.current=!0},5e3),m=yn.onAuthStateChanged(async g=>{var y,v,x,E;try{if(clearTimeout(p),console.log(" Firebase auth state changed:",{hasFirebaseUser:!!g,firebaseUserId:g==null?void 0:g.uid,currentUserId:(y=l.current)==null?void 0:y.id,isPinAuthenticated:c.current}),g){if(l.current&&l.current.id===g.uid&&!c.current){console.log(" Firebase user matches current user, no action needed"),n(!1),d.current=!0;return}if(c.current){console.log(" Ignoring Firebase auth change - user is PIN authenticated"),n(!1),d.current=!0;return}console.log(" Processing Firebase authenticated user..."),await new Promise(j=>setTimeout(j,1e3));const T=await Kr(Rt(st,"users",g.uid));if(T.exists()){console.log(" Found user document for Firebase user");const j=T.data(),C={id:T.id,email:j.email,name:j.name,role:j.role,restaurantId:j.restaurantId,pin:j.pin,permissions:j.permissions||[],isActive:j.isActive,lastLoginAt:(v=j.lastLoginAt)==null?void 0:v.toDate(),createdAt:((x=j.createdAt)==null?void 0:x.toDate())||new Date,updatedAt:((E=j.updatedAt)==null?void 0:E.toDate())||new Date,createdBy:j.createdBy};console.log(" Setting Firebase authenticated user:",{name:C.name,email:C.email}),r(C),o(!1),Fa.set(Sd,C),Fa.set(Ed,!1)}else console.warn("Firebase user exists but no Firestore user document found after waiting"),await c1.logout(),r(null),o(!1),Fa.remove(Sd),Fa.remove(Ed)}else c.current?console.log(" Firebase user signed out but keeping PIN authenticated user"):(console.log(" Firebase user signed out, clearing user state"),r(null),Fa.remove(Sd),Fa.remove(Ed))}catch(T){console.error("Auth state change error:",T),c.current?console.log(" Error handling auth state, keeping PIN authenticated user"):(console.log(" Error handling auth state, clearing user (not PIN authenticated)"),r(null),Fa.remove(Sd),Fa.remove(Ed))}finally{n(!1),d.current=!0}});return()=>{console.log(" RestaurantAuthContext: Cleaning up Firebase auth listener"),clearTimeout(p),m()}},[]);const f={user:e,loading:s,isAuthenticated:!!e,isPinAuthenticated:i,login:async(p,m,g)=>{try{console.log(" Email login attempt:",{email:p,restaurantSlug:g}),n(!0);const y=await c1.loginWithEmail(p,m,g);if(y.success&&y.user)console.log(" Email login successful:",{name:y.user.name}),r(y.user),o(!1),Fa.set(Sd,y.user),Fa.set(Ed,!1),Z.success(`Welcome back, ${y.user.name}!`);else throw new Error(y.error||"Login failed")}catch(y){throw console.error(" Email login failed:",y.message),Z.error(y.message||"Login failed"),y}finally{n(!1),d.current=!0}},loginWithPin:async(p,m)=>{try{console.log(" PIN login attempt:",{pin:p.substring(0,2)+"**",restaurantSlug:m}),n(!0);const g=await c1.loginWithPin(p,m);if(g.success&&g.user)console.log(" PIN login successful:",{name:g.user.name}),r(g.user),o(!0),Fa.set(Sd,g.user),Fa.set(Ed,!0),Z.success(`Welcome back, ${g.user.name}!`);else throw new Error(g.error||"PIN login failed")}catch(g){throw console.error(" PIN login failed:",g.message),Z.error(g.message||"PIN login failed"),g}finally{n(!1),d.current=!0}},logout:async()=>{try{console.log(" Logout attempt:",{isPinAuthenticated:c.current}),c.current?console.log(" PIN authenticated user logout (no Firebase signout)"):(console.log(" Signing out from Firebase Auth"),await c1.logout()),r(null),o(!1),Fa.remove(Sd),Fa.remove(Ed),Z.success("Logged out successfully")}catch(p){throw console.error(" Logout failed:",p),Z.error("Logout failed"),p}}};return a.jsx(ZU.Provider,{value:f,children:t})}function ia(){const t=R.useContext(ZU);if(t===void 0)throw new Error("useRestaurantAuth must be used within a RestaurantAuthProvider");return t}class rc{static storeContext(e,r){try{const s={command:e.command,missingFields:e.missingFields,contextualMessage:e.contextualMessage,transcript:e.transcript,timestamp:Date.now(),restaurantId:r};localStorage.setItem(this.CONTEXT_KEY,JSON.stringify(s)),console.log(" Voice context stored:",s)}catch(s){console.error("Failed to store voice context:",s)}}static getContext(e){try{const r=localStorage.getItem(this.CONTEXT_KEY);if(!r)return null;const s=JSON.parse(r);return Date.now()-s.timestamp>this.CONTEXT_EXPIRY?(this.clearContext(),console.log(" Voice context expired and cleared"),null):s.restaurantId!==e?(console.log(" Voice context for different restaurant, ignoring"),null):(console.log(" Voice context retrieved:",s),{command:s.command,missingFields:s.missingFields,contextualMessage:s.contextualMessage,transcript:s.transcript})}catch(r){return console.error("Failed to get voice context:",r),this.clearContext(),null}}static clearContext(){try{localStorage.removeItem(this.CONTEXT_KEY),console.log(" Voice context cleared")}catch(e){console.error("Failed to clear voice context:",e)}}static hasContext(e){return this.getContext(e)!==null}static mergeContextWithNewInput(e,r){try{const s=r.toLowerCase().trim(),n={...e.command};let i=!1,o="";if(e.missingFields.includes("tableNumber")){const l=s.match(/(?:table\s*)?(\d+)/);if(l)n.tableNumber=parseInt(l[1]),i=!0,o=`Table ${n.tableNumber} selected`;else if(s.includes("table"))return{success:!1,message:'Please specify a table number (e.g., "table 5")'}}if(e.missingFields.includes("targetTableNumber")){const l=s.match(/(?:table\s*)?(\d+)/);l&&(n.targetTableNumber=parseInt(l[1]),i=!0,o=`Target table ${n.targetTableNumber} selected`)}if((!n.type||n.type==="UNKNOWN")&&(s.includes("kot")||s.includes("kitchen")?(n.type="KOT_PRINT",i=!0,o="KOT print command selected"):s.includes("order")||s.includes("place")?(n.type="PLACE_ORDER",i=!0,o="Place order command selected"):(s.includes("payment")||s.includes("bill")||s.includes("pay"))&&(n.type="PAYMENT",i=!0,o="Payment command selected")),e.missingFields.includes("paymentMethod")&&(s.includes("upi")?(n.paymentMethod="UPI",i=!0,o="UPI payment selected"):s.includes("cash")?(n.paymentMethod="CASH",i=!0,o="Cash payment selected"):(s.includes("bank")||s.includes("card"))&&(n.paymentMethod="BANK",i=!0,o="Bank payment selected")),e.missingFields.includes("menuItems")){const l=this.parseMultipleMenuItemsFromInput(s);if(l.length>0)n.menuItems=l,i=!0,o=`Added ${l.map(d=>`${d.quantity}x ${d.name}`).join(", ")} to order`;else{const c=s.replace(/^\d+\s*/,"").replace(/\b(x|times|pieces?|items?)\b/g,"").trim();if(c.length>2){const d={name:c.split(" ").map(u=>u.charAt(0).toUpperCase()+u.slice(1)).join(" "),quantity:1,category:"Unknown"};n.menuItems=[d],i=!0,o=`Added 1x ${d.name} to order`}}}if(e.missingFields.includes("customerName")){const l=["customer","add","create","register","new","name","is","the"],c=s.split(" ").filter(d=>d.length>1&&!l.includes(d)&&!/^\d+$/.test(d));c.length>0&&(n.customerName=c.map(d=>d.charAt(0).toUpperCase()+d.slice(1)).join(" "),i=!0,o=`Customer name set to ${n.customerName}`)}if(i){const l={type:n.type||"UNKNOWN",tableNumber:n.tableNumber,targetTableNumber:n.targetTableNumber,menuItems:n.menuItems,paymentMethod:n.paymentMethod,customerName:n.customerName,customerPhone:n.customerPhone,customerEmail:n.customerEmail,customerAddress:n.customerAddress,confidence:.9,originalText:`${e.transcript} + ${r}`,isIncomplete:!1};return console.log(" Successfully merged voice context:",l),{success:!0,command:l,message:o}}return{success:!1,message:"Could not understand the additional information provided"}}catch(s){return console.error("Error merging voice context:",s),{success:!1,message:"Error processing voice context"}}}static parseMultipleMenuItemsFromInput(e){try{const r=[],s=/\s+(?:and|,|&|\+)\s+/gi;let n=e.split(s);if(n.length===1){const i=/(\d+\s+[a-zA-Z\s]+?)(?=\d+\s+[a-zA-Z]|$)/g,o=e.match(i);o&&o.length>1&&(n=o)}for(let i of n){if(i=i.trim(),i.length<2)continue;const o=this.parseMenuItemFromInput(i);o&&r.push(o)}return r}catch(r){return console.error("Error parsing multiple menu items from input:",r),[]}}static parseMenuItemFromInput(e){try{const r=[/^(\d+)\s*x?\s*(.+)$/i,/^(\w+)\s+(.+)$/i];let s=1,n=e.trim();for(const i of r){const o=e.match(i);if(o){const l=o[1].toLowerCase(),c={one:1,two:2,three:3,four:4,five:5,six:6,seven:7,eight:8,nine:9,ten:10};c[l]?(s=c[l],n=o[2]):/^\d+$/.test(l)&&(s=parseInt(l),n=o[2]);break}}return n=n.replace(/\b(x|times|pieces?|items?|orders?)\b/gi,"").replace(/^\s*[-,]\s*/,"").trim(),n.length>2?{name:n.split(" ").map(o=>o.charAt(0).toUpperCase()+o.slice(1).toLowerCase()).join(" "),quantity:Math.max(1,s),category:"Voice Order"}:null}catch(r){return console.error("Error parsing menu item from input:",r),null}}static generateContextualPrompt(e){const r=e.missingFields,s=e.command;return r.includes("tableNumber")?s.type==="KOT_PRINT"?'Which table do you want to print KOT for? (e.g., "table 5")':s.type==="PLACE_ORDER"?'Which table do you want to place order for? (e.g., "table 3")':s.type==="PAYMENT"?'Which table do you want to process payment for? (e.g., "table 2")':'Which table number? (e.g., "table 4")':r.includes("targetTableNumber")?'Which table do you want to transfer/merge to? (e.g., "table 8")':!s.type||s.type==="UNKNOWN"?s.tableNumber?`What action for table ${s.tableNumber}? Say "KOT", "Order", or "Payment"`:'What do you want to do? Say "KOT", "Order", or "Payment"':r.includes("paymentMethod")?'Which payment method? Say "UPI", "Cash", or "Bank"':r.includes("customerName")?"What is the customer name?":r.includes("menuItems")?s.tableNumber?`What items would you like to order for table ${s.tableNumber}? (e.g., "chicken wings", "2 burgers and 3 pizzas", "chicken, burger, pizza")`:'What items would you like to order? (e.g., "chicken wings", "2 burgers and 3 pizzas", "chicken, burger, pizza")':"Please provide the missing information to complete your command"}}Or(rc,"CONTEXT_KEY","tenverse_voice_context"),Or(rc,"CONTEXT_EXPIRY",5*60*1e3);const W5={},en={success:t=>yr.success(t,{duration:1800,style:{background:"rgba(16, 185, 129, 0.9)",color:"#fff",fontSize:"13px",padding:"8px 12px",borderRadius:"8px",maxWidth:"280px",backdropFilter:"blur(6px)"}}),error:t=>yr.error(t,{duration:2200,style:{background:"rgba(239, 68, 68, 0.9)",color:"#fff",fontSize:"13px",padding:"8px 12px",borderRadius:"8px",maxWidth:"280px",backdropFilter:"blur(6px)"}}),info:(t,e)=>yr(t,{icon:e||"",duration:1500,style:{background:"rgba(99, 102, 241, 0.9)",color:"#fff",fontSize:"13px",padding:"8px 12px",borderRadius:"8px",maxWidth:"280px",backdropFilter:"blur(6px)"}})},Y6=(W5==null?void 0:W5.VITE_GROQ_API_KEY)||"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",X6="https://api.groq.com/openai/v1/chat/completions",Fd=class Fd{constructor(){Or(this,"recognition",null);Or(this,"isListening",!1);Or(this,"hasPermission",!1);Or(this,"isContinuousMode",!1);Or(this,"shouldRestart",!1);Or(this,"isPushToTalkMode",!1);Or(this,"accumulatedTranscript","");Or(this,"restaurantContext");Or(this,"onStateChange");Or(this,"onTranscriptChange");Or(this,"onCommandDetected");Or(this,"onIncompleteCommand");this.initializeRecognition()}initializeRecognition(){if(!("webkitSpeechRecognition"in window)&&!("SpeechRecognition"in window)){console.error("Speech recognition not supported in this browser");return}const e=window.SpeechRecognition||window.webkitSpeechRecognition;this.recognition=new e,this.recognition.continuous=!0,this.recognition.interimResults=!0,this.recognition.lang="en-US",this.recognition.maxAlternatives=1,this.recognition.onstart=()=>{console.log(" Voice recognition started"),this.isListening=!0,this.setState("listening")},this.recognition.onend=()=>{console.log(" Voice recognition ended"),this.isListening=!1,this.isPushToTalkMode?(console.log(" Push-to-talk recording ended, processing accumulated transcript"),this.accumulatedTranscript.trim()&&this.processVoiceCommand(this.accumulatedTranscript.trim(),this.restaurantContext),this.isPushToTalkMode=!1,this.accumulatedTranscript=""):this.isContinuousMode&&this.shouldRestart?(console.log(" Restarting voice recognition for continuous mode"),setTimeout(()=>{this.shouldRestart&&this.isContinuousMode&&this.startListening()},100)):setTimeout(()=>{!this.isListening&&!this.shouldRestart&&this.setState("idle")},100)},this.recognition.onresult=r=>{var i,o;let s="",n=!1;for(let l=0;l<r.results.length;l++){const c=r.results[l];s+=c[0].transcript,c.isFinal&&(n=!0)}if(s=s.trim(),s){if(this.isPushToTalkMode)this.accumulatedTranscript=s,console.log(" Push-to-talk accumulating:",this.accumulatedTranscript),(i=this.onTranscriptChange)==null||i.call(this,this.accumulatedTranscript);else if(console.log(" Transcript:",s,"Final:",n),(o=this.onTranscriptChange)==null||o.call(this,s),n){const l=r.results[r.resultIndex][0].confidence;console.log(" Processing final transcript with confidence:",l),this.processVoiceCommand(s,this.restaurantContext)}}},this.recognition.onerror=r=>{switch(console.error(" Speech recognition error:",r.error),r.error){case"no-speech":!this.isPushToTalkMode&&!this.isContinuousMode&&(en.error("No speech detected. Please try again."),this.setState("error"));break;case"audio-capture":en.error("Microphone not accessible."),this.setState("error"),this.shouldRestart=!1,this.isPushToTalkMode=!1;break;case"not-allowed":en.error("Microphone permission denied."),this.setState("error"),this.shouldRestart=!1,this.isPushToTalkMode=!1;break;case"network":this.isContinuousMode&&this.shouldRestart?console.log(" Network error, will retry..."):this.isPushToTalkMode||(en.error("Network error. Please try again."),this.setState("error"));break;default:console.warn(" Other speech error:",r.error),!this.isContinuousMode&&!this.isPushToTalkMode&&(en.error("Voice recognition error. Please try again."),this.setState("error"))}}}async processVoiceCommand(e,r){var s,n,i,o;try{console.log(" Processing voice command:",e),this.setState("processing");const l=(r==null?void 0:r.id)||"",c=rc.getContext(l);if(c){console.log(" Found stored voice context, attempting to merge:",c);const A=rc.mergeContextWithNewInput(c,e);if(A.success&&A.command){console.log(" Successfully merged voice context into complete command:",A.command),rc.clearContext(),en.success(A.message||"Command completed!"),this.setState("executing"),(s=this.onCommandDetected)==null||s.call(this,A.command),setTimeout(()=>{this.setState("idle")},1e3);return}else console.log(" Failed to merge voice context:",A.message),en.error(A.message||"Could not understand the additional information"),rc.clearContext()}let d;try{d=await this.analyzeWithGroq(e,r),console.log(" AI Command Analysis:",d)}catch(A){console.warn(" AI analysis failed, using fallback parser:",A),sessionStorage.getItem("voice_ai_fallback_notified")||(en.info(" Voice AI temporarily unavailable, using local parsing",""),sessionStorage.setItem("voice_ai_fallback_notified","true")),d=this.parseCommandFallback(e),console.log(" Fallback Command Analysis:",d)}const u=this.checkCommandCompleteness(d);if(!u.isComplete){const A={command:d,missingFields:u.missingFields,contextualMessage:u.contextualMessage,transcript:e};rc.storeContext(A,l);const h=rc.generateContextualPrompt(A);(n=this.onIncompleteCommand)==null||n.call(this,A),this.setState("idle"),en.info(h,""),console.log(" Stored incomplete command context:",A);return}switch(rc.clearContext(),d.type){case"ORDER":const A=((i=d.menuItems)==null?void 0:i.map(f=>`${f.quantity}x ${f.name}`).join(", "))||"items";en.success(` Adding: ${A} ${d.tableNumber?`table ${d.tableNumber}`:""}`);break;case"PLACE_ORDER":en.success(` Placing order ${d.tableNumber?`table ${d.tableNumber}`:""}`);break;case"PAYMENT":en.success(` Payment ${d.tableNumber?`table ${d.tableNumber}`:""}${d.paymentMethod?` via ${d.paymentMethod}`:""}`);break;case"KOT_PRINT":en.success(` Printing KOT${d.tableNumber?` table ${d.tableNumber}`:""}`);break;case"ORDER_CANCEL":en.success(` Canceling order${d.tableNumber?` table ${d.tableNumber}`:""}`);break;case"TABLE_MERGE":en.success(` Merging table ${d.tableNumber}  ${d.targetTableNumber}`);break;case"TABLE_TRANSFER":en.success(` Transfer table ${d.tableNumber}  ${d.targetTableNumber}`);break;case"TABLE_STATUS":en.success(` Table ${d.tableNumber} status updated`);break;case"CUSTOMER":const h=d.customerName?`${d.customerName}`:"customer";en.success(` Adding ${h} to CRM`);break;case"MENU_INQUIRY":en.info(" Menu inquiry","");break;default:en.info(`Processing: ${d.type}`)}this.setState("executing"),(o=this.onCommandDetected)==null||o.call(this,d),setTimeout(()=>{this.setState("idle")},1e3)}catch(l){console.error(" Voice command processing failed:",l),this.setState("error"),en.error("Sorry, I couldn't understand that command"),setTimeout(()=>{this.setState("idle")},2e3)}}checkCommandCompleteness(e){const r=[];let s="";if(e.type==="UNKNOWN"&&e.tableNumber)return s=`Table ${e.tableNumber} selected - what would you like to do? Say "KOT", "Order", or "Payment"`,{isComplete:!1,missingFields:[],contextualMessage:s};const n=e.originalText.toLowerCase();switch(e.tableNumber||(n.includes("kot")||n.includes("kitchen")?(e.type="KOT_PRINT",r.push("tableNumber"),s="KOT print command detected - which table number?"):n.includes("order")||n.includes("place")?(e.type="PLACE_ORDER",r.push("tableNumber"),s="Place order command detected - which table number?"):(n.includes("payment")||n.includes("bill")||n.includes("pay"))&&(e.type="PAYMENT",r.push("tableNumber"),s="Payment command detected - which table number?")),e.type){case"ORDER":case"PLACE_ORDER":e.tableNumber||r.push("tableNumber"),(!e.menuItems||e.menuItems.length===0)&&r.push("menuItems");break;case"PAYMENT":case"KOT_PRINT":case"ORDER_CANCEL":case"TABLE_STATUS":e.tableNumber||r.push("tableNumber");break;case"TABLE_MERGE":case"TABLE_TRANSFER":e.tableNumber||r.push("tableNumber"),e.targetTableNumber||r.push("targetTableNumber");break;case"CUSTOMER":!e.customerName&&!e.customerPhone&&r.push("customerName");break}if(r.length>0&&!s)if(r.includes("tableNumber"))switch(e.type){case"KOT_PRINT":s="Which table do you want to print KOT for?";break;case"PLACE_ORDER":s="Which table do you want to place order for?";break;case"PAYMENT":s="Which table do you want to process payment for?";break;default:s="Please specify the table number."}else r.includes("paymentMethod")?s=`Payment for table ${e.tableNumber} - which method? Say "UPI", "Cash", or "Bank"`:r.includes("customerName")?s="What is the customer name?":r.includes("targetTableNumber")?s=`${e.type} from table ${e.tableNumber} - to which table?`:r.includes("menuItems")&&(s="Which menu items do you want to order?");return{isComplete:r.length===0,missingFields:r,contextualMessage:s}}parseCommandFallback(e){const r=e.toLowerCase(),s=v=>{let x=v;const E={koti:"kot",cot:"kot",cott:"kot","k o t":"kot","kitchen order":"kot","kitchen ticket":"kot",ordr:"order",oder:"order","place order":"order","take order":"order","make order":"order",paymnt:"payment","pay bill":"payment","settle bill":"payment","complete payment":"payment","process payment":"payment","u p i":"upi",tabel:"table",tabl:"table",tabol:"table",custmr:"customer",client:"customer",guest:"customer",numbr:"number",phon:"phone",mobil:"mobile",contct:"contact",cancl:"cancel",delet:"delete",remov:"remove",transferr:"transfer",mov:"move",shft:"shift",swch:"switch",merg:"merge",combin:"combine",joi:"join"};for(const[T,j]of Object.entries(E))x=x.replace(new RegExp(`\\b${T}\\b`,"g"),j);return x=x.replace(/(\d)\s+(\d)/g,"$1$2"),x=x.replace(/number\s*(\d+)/g,"$1"),x},n=v=>{const x={zero:"0",one:"1",two:"2",three:"3",four:"4",five:"5",six:"6",seven:"7",eight:"8",nine:"9",ten:"10",eleven:"11",twelve:"12",thirteen:"13",fourteen:"14",fifteen:"15"};let E=v;for(const[T,j]of Object.entries(x))E=E.replace(new RegExp(`\\b${T}\\b`,"g"),j);return E},i=s(r),o=n(i),l=[/(?:table|tabel|tabl|tabol)\s+(?:number\s+)?(\d+)/,/(\d+)\s+(?:table|tabel|tabl|tabol)/,/(?:number\s+)?(\d+)/];let c=null;for(const v of l){const x=o.match(v);if(x){c=parseInt(x[1]);break}}if(console.log(" Enhanced fallback parsing for:",r),console.log(" Normalized:",i,"| Processed:",o,"| Table:",c),["kot","koti","cot","cott","kitchen order","kitchen ticket","k o t","print kot","print kitchen"].some(v=>o.includes(v)))return console.log(" KOT command detected with variation:",r),{type:"KOT_PRINT",tableNumber:c||void 0,confidence:.85,originalText:e};if(["customer","custmr","client","guest","new customer","add customer","register customer","create customer"].some(v=>o.includes(v))){console.log(" Customer command detected with variation:",r);let v="";const x=[/(?:customer|custmr|client|guest|name)\s+(?:name\s+)?([a-zA-Z]+(?:\s+[a-zA-Z]+)*)/,/(?:add|new|create|register)\s+(?:customer|custmr|client|guest)\s+([a-zA-Z]+(?:\s+[a-zA-Z]+)*)/,/(?:customer|custmr|client|guest)\s+([a-zA-Z]+(?:\s+[a-zA-Z]+)*)\s+(?:phone|number|mobile)/];for(const w of x){const S=o.match(w);if(S&&S[1]){v=S[1].trim().split(" ").map(F=>F.charAt(0).toUpperCase()+F.slice(1)).join(" ");break}}let E="";const T=[/(?:phone|number|mobile|contact)(?:\s+number)?\s*[:\s]*(\d{10})/,/(?:phone|number|mobile|contact)(?:\s+number)?\s*[:\s]*(\d{4}\s*\d{3}\s*\d{3})/,/(?:phone|number|mobile|contact)(?:\s+number)?\s*[:\s]*(\d{3}\s*\d{3}\s*\d{4})/,/(\d{10})/,/(\d{4}\s*\d{3}\s*\d{3})/,/(\d{3}\s*\d{3}\s*\d{4})/];for(const w of T){const S=o.match(w);if(S&&S[1]&&(E=S[1].replace(/\s+/g,""),E.length===10))break}let j="";const C=o.match(/([a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,})/);return C&&(j=C[1]),console.log(" Extracted customer data:",{customerName:v,customerPhone:E,customerEmail:j}),{type:"CUSTOMER",customerName:v||void 0,customerPhone:E||void 0,customerEmail:j||void 0,confidence:.85,originalText:e}}if(["order","ordr","oder","place order","take order","make order"].some(v=>o.includes(v))){console.log(" Place order command detected with variation:",r,"| Table:",c);const v=[],x=["chicken wings","buffalo wings","hot wings","chicken wing","wing","beef burger","chicken burger","cheese burger","burger","margherita pizza","cheese pizza","pepperoni pizza","pizza","caesar salad","garden salad","greek salad","salad","grilled chicken","fried chicken","chicken breast","chicken","grilled fish","fried fish","fish fillet","fish","spaghetti","penne pasta","pasta marinara","pasta","fresh orange juice","orange juice","apple juice","grape juice","juice","french fries","fries","sandwich","rice","dal","curry","bread","naan","roti","biryani","paneer","mutton","beef","pork","prawns","crab","lobster","noodles","momos","samosa","pakora","dosa","idli","vada","uttapam","lassi","water","coke","coffee","tea","soup"],T=(j=>{const C=[];let w=j.replace(/\b(?:table|tabel|tabl|number)\s*\d+\b/gi,"").replace(/\b(?:order|ordr|oder|place|take|make)\b/gi,"").trim();console.log(" Clean text for parsing:",w);const S=/\s+(?:and|,|&|\+)\s+/gi;let F=w.split(S);if(F.length===1){const B=/(\d+\s+[a-zA-Z\s]+?)(?=\d+\s+[a-zA-Z]|$)/g,k=w.match(B);k&&k.length>1&&(F=k)}console.log(" Segments to process:",F);for(let B of F){if(B=B.trim(),B.length<2)continue;let k=1,D=B;const q=[/^(\d+)\s*x?\s*(.+)$/i,/^(one|two|three|four|five|six|seven|eight|nine|ten)\s+(.+)$/i,/(.+?)\s+(\d+)$/i];for(const W of q){const Q=B.match(W);if(Q){const[,re,G]=Q;if(/^\d+$/.test(re))k=parseInt(re),D=G;else if(/^\d+$/.test(G))k=parseInt(G),D=re;else{const Ae={one:1,two:2,three:3,four:4,five:5,six:6,seven:7,eight:8,nine:9,ten:10};Ae[re.toLowerCase()]&&(k=Ae[re.toLowerCase()],D=G)}break}}D=D.replace(/\b(x|times|pieces?|items?|orders?)\b/gi,"").replace(/^\s*[-,]\s*/,"").trim();const te=x.filter(W=>{const Q=D.toLowerCase(),re=W.toLowerCase();return Q===re||Q.includes(re)||re.includes(Q)||W.includes(" ")&&W.split(" ").every(G=>Q.includes(G.toLowerCase()))}).sort((W,Q)=>Q.length-W.length);if(te.length>0){const Q=te[0].split(" ").map(re=>re.charAt(0).toUpperCase()+re.slice(1).toLowerCase()).join(" ");C.push({name:Q,quantity:Math.max(1,k)}),console.log(` Parsed item: ${k}x ${Q} from "${B}"`)}else if(D.length>2){const W=D.split(" ").map(Q=>Q.charAt(0).toUpperCase()+Q.slice(1).toLowerCase()).join(" ");C.push({name:W,quantity:Math.max(1,k)}),console.log(` Added generic item: ${k}x ${W} from "${B}"`)}}return C})(o);return v.push(...T),console.log(" Final parsed menu items:",v),{type:"PLACE_ORDER",tableNumber:c||void 0,menuItems:v.length>0?v:void 0,confidence:.8,originalText:e}}if(["payment","pay","bill","paymnt","pay bill","complete payment","process payment","settle","settle bill"].some(v=>o.includes(v))){console.log(" Payment command detected with variation:",r);let v;return o.includes("upi")||o.includes("u p i")?v="UPI":o.includes("cash")||o.includes("cash payment")?v="CASH":(o.includes("bank")||o.includes("card")||o.includes("debit")||o.includes("credit"))&&(v="BANK"),{type:"PAYMENT",tableNumber:c||void 0,paymentMethod:v,confidence:.8,originalText:e}}if(["cancel","delete","remove","cancel order","delete order","remove order"].some(v=>o.includes(v)))return console.log(" Cancel order command detected:",r),{type:"ORDER_CANCEL",tableNumber:c||void 0,confidence:.8,originalText:e};if(["make table","set table","table ready","table available","table occupied","ready table","available table"].some(v=>o.includes(v)))return console.log(" Table status command detected:",r),{type:"TABLE_STATUS",tableNumber:c||void 0,confidence:.7,originalText:e};if(["merge","combine","join","merge table","combine table","join table"].some(v=>o.includes(v))){console.log(" Table merge command detected:",r);const v=o.match(/(\d+)/g);if(v&&v.length>=2)return{type:"TABLE_MERGE",tableNumber:parseInt(v[0]),targetTableNumber:parseInt(v[1]),confidence:.7,originalText:e}}if(["transfer","move","shift","switch","transfer table","move table"].some(v=>o.includes(v))){console.log(" Table transfer command detected:",r);const v=o.match(/(\d+)/g);if(v&&v.length>=2)return{type:"TABLE_TRANSFER",tableNumber:parseInt(v[0]),targetTableNumber:parseInt(v[1]),confidence:.7,originalText:e}}return["menu","what's available","show menu","food items","what do you have","available items"].some(v=>o.includes(v))?(console.log(" Menu inquiry command detected:",r),{type:"MENU_INQUIRY",confidence:.7,originalText:e}):(console.log(" Unknown command, could not parse:",r),{type:"UNKNOWN",confidence:.3,originalText:e})}static getInstance(){return Fd.instance||(Fd.instance=new Fd),Fd.instance}static isSupported(){return"webkitSpeechRecognition"in window||"SpeechRecognition"in window}async requestPermission(){try{return(await navigator.mediaDevices.getUserMedia({audio:!0})).getTracks().forEach(r=>r.stop()),this.hasPermission=!0,!0}catch(e){return console.error(" Microphone permission denied:",e),this.hasPermission=!1,!1}}startListening(){if(!this.recognition){en.error("Voice recognition not initialized");return}if(this.isListening){console.warn(" Already listening");return}try{this.shouldRestart=!1,this.isPushToTalkMode=!1,this.accumulatedTranscript="",this.recognition.start()}catch(e){console.error(" Failed to start voice recognition:",e),this.setState("error")}}startPushToTalkRecording(){if(!this.recognition){en.error("Voice recognition not initialized");return}if(this.isListening){console.warn(" Already listening");return}try{console.log(" Starting push-to-talk recording mode"),this.isPushToTalkMode=!0,this.accumulatedTranscript="",this.shouldRestart=!1,this.isContinuousMode=!1,this.recognition.start()}catch(e){console.error(" Failed to start push-to-talk recording:",e),this.setState("error"),this.isPushToTalkMode=!1}}stopPushToTalkRecording(){if(!this.isListening||!this.recognition){console.warn(" Not currently recording"),this.isPushToTalkMode=!1,this.accumulatedTranscript="",this.setState("idle");return}if(!this.isPushToTalkMode){console.warn(" Not in push-to-talk mode");return}console.log(" Stopping push-to-talk recording");try{this.recognition.stop()}catch(e){console.error(" Failed to stop push-to-talk recording:",e),this.isPushToTalkMode=!1,this.accumulatedTranscript="",this.setState("error")}}startContinuousListening(){if(!this.recognition){en.error("Voice recognition not initialized");return}if(console.log(" Starting continuous listening mode"),this.isContinuousMode=!0,this.shouldRestart=!0,this.isPushToTalkMode=!1,this.accumulatedTranscript="",en.info(" Continuous listening enabled. Press again to stop.",""),this.isListening){console.log(" Already listening, switching to continuous mode");return}try{this.recognition.start()}catch(e){console.error(" Failed to start continuous voice recognition:",e),this.setState("error"),this.isContinuousMode=!1,this.shouldRestart=!1}}stopListening(){if(!this.isListening||!this.recognition){this.isContinuousMode=!1,this.shouldRestart=!1,this.isPushToTalkMode=!1,this.accumulatedTranscript="",this.setState("idle");return}console.log(" Stopping voice recognition");const e=this.isContinuousMode,r=this.isPushToTalkMode;this.isContinuousMode=!1,this.shouldRestart=!1,r||(this.isPushToTalkMode=!1,this.accumulatedTranscript=""),e&&en.info(" Continuous listening stopped","");try{this.recognition.stop()}catch(s){console.error(" Failed to stop voice recognition:",s)}}getIsListening(){return this.isListening}getIsContinuousMode(){return this.isContinuousMode}getHasPermission(){return this.hasPermission}setRestaurantContext(e){this.restaurantContext=e,console.log(" Restaurant context set:",e)}clearRestaurantContext(){this.restaurantContext=void 0,console.log(" Restaurant context cleared")}setOnStateChange(e){this.onStateChange=e}setOnTranscriptChange(e){this.onTranscriptChange=e}setOnCommandDetected(e){this.onCommandDetected=e}setOnIncompleteCommand(e){this.onIncompleteCommand=e}isVoiceSupported(){return Fd.isSupported()}testVoiceCommand(e){console.log(" Testing voice command:",e);const r=this.parseCommandFallback(e);return console.log(" Test result:",r),r}setState(e){var r;(r=this.onStateChange)==null||r.call(this,e)}async mergeIncompleteCommand(e,r){try{if(e.missingFields.includes("tableNumber")&&r.toLowerCase().includes("table")){const o=r.match(/table\s+(\d+)/i);if(o){const l=parseInt(o[1]),c={...e.command,tableNumber:l,originalText:`${e.transcript} ${r}`,confidence:Math.min(e.command.confidence,.9),isIncomplete:!1};if(this.checkCommandCompleteness(c).isComplete)return console.log(" Successfully merged incomplete command with table number:",c),c}}const s=`${e.transcript} ${r}`;console.log(" Attempting to merge commands:",{original:e.transcript,new:r,merged:s});const n=await this.analyzeWithGroq(s,this.restaurantContext);return this.checkCommandCompleteness(n).isComplete?(console.log(" Successfully merged incomplete command:",n),n):null}catch(s){return console.error(" Failed to merge commands:",s),null}}async analyzeWithGroq(e,r){var i,o,l;const n=`${r?`Restaurant: ${r.name} (${r.slug}). `:""} Extract info from voice commands and respond with JSON ONLY.

SPEECH FLEXIBILITY RULES:
1. PHONETIC VARIATIONS - Accept common pronunciation mistakes and variations:
   - KOT: "koti", "kot", "cot", "cott", "kitchen order", "kitchen ticket", "k o t"
   - ORDER: "order", "ordr", "oder", "place order", "take order", "make order"
   - PAYMENT: "payment", "pay", "bill", "paymnt", "pay bill", "complete payment", "process payment"
   - TABLE: "table", "tabel", "tabl", "table number", "tabol"
   - CUSTOMER: "customer", "custmr", "client", "guest", "new customer", "add customer"

2. CASUAL SPEECH PATTERNS - Handle informal language:
   - "koti table 2"  KOT_PRINT for table 2
   - "pay table 5"  PAYMENT for table 5  
   - "order pizza table 3"  PLACE_ORDER
   - "customer john 9123456789"  CUSTOMER registration
   - "cancel table 4"  ORDER_CANCEL for table 4

3. FLEXIBLE WORD ORDER - Commands can be in any order:
   - "table 2 koti" = "koti table 2" = "print kot table number 2"
   - "pizza order table 1" = "table 1 order pizza" = "order table 1 pizza"

COMMAND TYPES:
- PLACE_ORDER: ANY mention of "order" + food items + table (e.g., "order chicken table 1", "pizza order table 2", "table 3 burger order")
- PAYMENT: "payment", "pay", "bill", "settle", "complete" + table number + optional method (UPI/CASH/BANK)
- KOT_PRINT: "kot", "koti", "cot", "kitchen order", "print kot", "kitchen ticket" + table number
- ORDER_CANCEL: "cancel", "delete", "remove", "cancel order" + table number
- TABLE_MERGE: "merge", "combine", "join" + two table numbers
- TABLE_TRANSFER: "transfer", "move", "shift", "switch" + source table + target table  
- TABLE_STATUS: "make table", "set table", "table ready", "table available", "table occupied" + table number
- CUSTOMER: "customer", "add customer", "new customer", "register" + name + phone (required) + optional email/address
- MENU_INQUIRY: "menu", "what's available", "show menu", "food items", "what do you have"

IMPORTANT RULES:
1. ALWAYS prioritize PLACE_ORDER if the word "order" appears anywhere in the command
2. For KOT commands, any variation of "kot"/"koti"/"cot" should be KOT_PRINT
3. Handle numbers written as words: "one", "two", "three", etc.
4. Extract table numbers from anywhere in the sentence: "table 5", "table number 5", "5 table", "number 5"
5. For CUSTOMER commands, extract name and phone carefully. Phone can have spaces: "9135036 551"
6. Be very lenient with pronunciation - focus on intent rather than exact words
7. MULTIPLE ITEMS: Detect multiple menu items with individual quantities in a single order command

MULTIPLE ITEM PARSING RULES:
- Handle lists: "order 2 chicken wings and 3 burgers table 5"
- Handle comma separation: "order chicken wings, 2 burgers, pizza table 3"
- Handle "and" separation: "order chicken and fish and rice table 2"
- Individual quantities: "order 2 chicken wings 3 burgers 1 pizza table 4"
- Mixed patterns: "order 2 chicken wings and burger and 3 pizzas table 1"
- Default quantity: If no quantity specified, assume 1

CASUAL SPEECH EXAMPLES:
"koti table two"  {"type":"KOT_PRINT","tableNumber":2,"confidence":0.9}
"pay table five upi"  {"type":"PAYMENT","tableNumber":5,"paymentMethod":"UPI","confidence":0.9}  
"order chicken wings table one"  {"type":"PLACE_ORDER","tableNumber":1,"menuItems":[{"name":"chicken wings","quantity":1}],"confidence":0.9}
"order 2 chicken wings and 3 burgers table 5"  {"type":"PLACE_ORDER","tableNumber":5,"menuItems":[{"name":"chicken wings","quantity":2},{"name":"burgers","quantity":3}],"confidence":0.9}
"order chicken wings, 2 burgers, pizza table 3"  {"type":"PLACE_ORDER","tableNumber":3,"menuItems":[{"name":"chicken wings","quantity":1},{"name":"burgers","quantity":2},{"name":"pizza","quantity":1}],"confidence":0.9}
"customer rahul nine one three five zero three six five five one"  {"type":"CUSTOMER","customerName":"Rahul","customerPhone":"9135036551","confidence":0.9}
"cancel table three"  {"type":"ORDER_CANCEL","tableNumber":3,"confidence":0.9}

Example JSON responses:
{"type":"KOT_PRINT","tableNumber":2,"confidence":0.9,"originalText":"koti table number 2"}
{"type":"PLACE_ORDER","tableNumber":1,"menuItems":[{"name":"pizza","quantity":2}],"confidence":0.9,"originalText":"two pizza table one order"}
{"type":"PAYMENT","tableNumber":4,"paymentMethod":"CASH","confidence":0.8,"originalText":"pay table 4 cash"}
{"type":"CUSTOMER","customerName":"John Smith","customerPhone":"9876543210","confidence":0.9,"originalText":"customer john smith nine eight seven six five four three two one zero"}`;try{const c=await fetch(X6,{method:"POST",headers:{Authorization:`Bearer ${Y6}`,"Content-Type":"application/json"},body:JSON.stringify({model:"llama-3.3-70b-versatile",messages:[{role:"system",content:n},{role:"user",content:e}],temperature:.1,max_tokens:500})});if(!c.ok)throw new Error(`Groq API error: ${c.status}`);const u=(l=(o=(i=(await c.json()).choices[0])==null?void 0:i.message)==null?void 0:o.content)==null?void 0:l.trim();if(!u)throw new Error("No response from Groq");console.log(" Groq response:",u);try{const A=JSON.parse(u);return A.originalText=e,A}catch{throw console.warn(" Failed to parse Groq JSON response:",u),new Error("Invalid JSON response from AI")}}catch(c){throw console.error(" Groq AI analysis failed:",c),c}}static async matchMenuItemsIntelligently(e,r){return Fd.getInstance().matchMenuItemsWithAI(e,r)}async matchMenuItemsWithAI(e,r){const s=[];for(const n of e)try{const i=this.findBasicMenuMatch(n.name,r);if(i){s.push({...n,matchedItem:i});continue}const o=await this.findAIMenuMatch(n.name,r);o?s.push({...n,matchedItem:o}):s.push(n)}catch(i){console.error("Error matching menu item:",n.name,i);const o=this.findBasicMenuMatch(n.name,r);s.push({...n,matchedItem:o})}return s}findBasicMenuMatch(e,r){const s=e.toLowerCase().trim();let n=r.find(o=>o.name.toLowerCase()===s);if(n||(n=r.find(o=>o.name.toLowerCase().includes(s)||s.includes(o.name.toLowerCase())),n))return n;const i=s.split(" ").filter(o=>o.length>2);return i.length>0&&(n=r.find(o=>{const l=o.name.toLowerCase().split(" ");return i.some(c=>l.some(d=>d.includes(c)||c.includes(d)))}),n)?n:null}async findAIMenuMatch(e,r){var s,n,i;try{const o=r.map(d=>d.name),l=`Find the best menu item match for the voice command: "${e}"

Available menu items:
${o.map((d,u)=>`${u+1}. ${d}`).join(`
`)}

Instructions:
1. Find the menu item that best matches the voice command
2. Consider phonetic similarities, abbreviations, and common variations
3. Look for items with similar ingredients or characteristics
4. If no close match exists, return "NO_MATCH"
5. Return ONLY the exact menu item name from the list above

Examples:
- "chilly pork" might match "Chilli Pork" or "Spicy Pork"
- "all time favorite chilly pork" might match "Chilli Pork" or "Special Pork Dish"
- "wings" might match "Chicken Wings" or "Buffalo Wings"
- "burger" might match "Beef Burger" or "Chicken Burger"

Voice command: "${e}"
Best match:`,c=await fetch(X6,{method:"POST",headers:{Authorization:`Bearer ${Y6}`,"Content-Type":"application/json"},body:JSON.stringify({model:"llama-3.3-70b-versatile",messages:[{role:"user",content:l}],temperature:.1,max_tokens:100})});if(c.ok){const u=(i=(n=(s=(await c.json()).choices[0])==null?void 0:s.message)==null?void 0:n.content)==null?void 0:i.trim();if(u&&u!=="NO_MATCH"){const A=r.find(h=>h.name.toLowerCase()===u.toLowerCase()||h.name.toLowerCase().includes(u.toLowerCase())||u.toLowerCase().includes(h.name.toLowerCase()));if(A)return console.log(` AI matched "${e}"  "${A.name}"`),A}}}catch(o){console.warn("AI menu matching failed, using fallback:",o)}return null}toggleListening(){this.isListening?this.stopListening():this.startContinuousListening()}getIsPushToTalkMode(){return this.isPushToTalkMode}getAccumulatedTranscript(){return this.accumulatedTranscript}};Or(Fd,"instance",null);let OA=Fd;const Pa=OA.getInstance(),eM=Object.freeze(Object.defineProperty({__proto__:null,VoiceService:OA,voiceService:Pa},Symbol.toStringTag,{value:"Module"}));/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var kte={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bte=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Bt=(t,e)=>{const r=R.forwardRef(({color:s="currentColor",size:n=24,strokeWidth:i=2,absoluteStrokeWidth:o,className:l="",children:c,...d},u)=>R.createElement("svg",{ref:u,...kte,width:n,height:n,stroke:s,strokeWidth:o?Number(i)*24/Number(n):i,className:["lucide",`lucide-${Bte(t)}`,l].join(" "),...d},[...e.map(([A,h])=>R.createElement(A,h)),...Array.isArray(c)?c:[c]]));return r.displayName=`${t}`,r};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zh=Bt("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oi=Bt("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Go=Bt("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fte=Bt("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jo=Bt("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dx=Bt("ArrowRightLeft",[["path",{d:"m16 3 4 4-4 4",key:"1x1c3m"}],["path",{d:"M20 7H4",key:"zbl0bi"}],["path",{d:"m8 21-4-4 4-4",key:"h9nckh"}],["path",{d:"M4 17h16",key:"g4d7ey"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J6=Bt("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pte=Bt("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pA=Bt("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sa=Bt("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fp=Bt("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dte=Bt("Brain",[["path",{d:"M9.5 2A2.5 2.5 0 0 1 12 4.5v15a2.5 2.5 0 0 1-4.96.44 2.5 2.5 0 0 1-2.96-3.08 3 3 0 0 1-.34-5.58 2.5 2.5 0 0 1 1.32-4.24 2.5 2.5 0 0 1 1.98-3A2.5 2.5 0 0 1 9.5 2Z",key:"1mhkh5"}],["path",{d:"M14.5 2A2.5 2.5 0 0 0 12 4.5v15a2.5 2.5 0 0 0 4.96.44 2.5 2.5 0 0 0 2.96-3.08 3 3 0 0 0 .34-5.58 2.5 2.5 0 0 0-1.32-4.24 2.5 2.5 0 0 0-1.98-3A2.5 2.5 0 0 0 14.5 2Z",key:"1d6s00"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rte=Bt("Briefcase",[["rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2",key:"eto64e"}],["path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"zwj3tp"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uw=Bt("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tM=Bt("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jc=Bt("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z6=Bt("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nr=Bt("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rf=Bt("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hf=Bt("ChefHat",[["path",{d:"M6 13.87A4 4 0 0 1 7.41 6a5.11 5.11 0 0 1 1.05-1.54 5 5 0 0 1 7.08 0A5.11 5.11 0 0 1 16.59 6 4 4 0 0 1 18 13.87V21H6Z",key:"z3ra2g"}],["line",{x1:"6",x2:"18",y1:"17",y2:"17",key:"12q60k"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rM=Bt("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sM=Bt("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nM=Bt("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lte=Bt("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ote=Bt("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ys=Bt("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ute=Bt("Coffee",[["path",{d:"M17 8h1a4 4 0 1 1 0 8h-1",key:"jx4kbh"}],["path",{d:"M3 8h14v9a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4Z",key:"1bxrl0"}],["line",{x1:"6",x2:"6",y1:"2",y2:"4",key:"1cr9l3"}],["line",{x1:"10",x2:"10",y1:"2",y2:"4",key:"170wym"}],["line",{x1:"14",x2:"14",y1:"2",y2:"4",key:"1c5f70"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eB=Bt("Coins",[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const po=Bt("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const No=Bt("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mte=Bt("Crown",[["path",{d:"m2 4 3 12h14l3-12-6 7-4-7-4 7-6-7zm3 16h14",key:"zkxr6b"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aM=Bt("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hn=Bt("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yn=Bt("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D0=Bt("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dl=Bt("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xs=Bt("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qte=Bt("FileSpreadsheet",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rl=Bt("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nu=Bt("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vte=Bt("Gamepad2",[["line",{x1:"6",x2:"10",y1:"11",y2:"11",key:"1gktln"}],["line",{x1:"8",x2:"8",y1:"9",y2:"13",key:"qnk9ow"}],["line",{x1:"15",x2:"15.01",y1:"12",y2:"12",key:"krot7o"}],["line",{x1:"18",x2:"18.01",y1:"10",y2:"10",key:"1lcuu1"}],["path",{d:"M17.32 5H6.68a4 4 0 0 0-3.978 3.59c-.006.052-.01.101-.017.152C2.604 9.416 2 14.456 2 16a3 3 0 0 0 3 3c1 0 1.5-.5 2-1l1.414-1.414A2 2 0 0 1 9.828 16h4.344a2 2 0 0 1 1.414.586L17 18c.5.5 1 1 2 1a3 3 0 0 0 3-3c0-1.545-.604-6.584-.685-7.258-.007-.05-.011-.1-.017-.151A4 4 0 0 0 17.32 5z",key:"mfqc10"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cn=Bt("Gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tB=Bt("GitMerge",[["circle",{cx:"18",cy:"18",r:"3",key:"1xkwt0"}],["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M6 21V9a9 9 0 0 0 9 9",key:"7kw0sc"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hte=Bt("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GA=Bt("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dj=Bt("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mw=Bt("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $te=Bt("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zy=Bt("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iM=Bt("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kte=Bt("Laptop",[["path",{d:"M20 16V7a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v9m16 0H4m16 0 1.28 2.55a1 1 0 0 1-.9 1.45H3.62a1 1 0 0 1-.9-1.45L4 16",key:"tarvll"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qw=Bt("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oM=Bt("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gi=Bt("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qh=Bt("Loader",[["line",{x1:"12",x2:"12",y1:"2",y2:"6",key:"gza1u7"}],["line",{x1:"12",x2:"12",y1:"18",y2:"22",key:"1qhbu9"}],["line",{x1:"4.93",x2:"7.76",y1:"4.93",y2:"7.76",key:"xae44r"}],["line",{x1:"16.24",x2:"19.07",y1:"16.24",y2:"19.07",key:"bxnmvf"}],["line",{x1:"2",x2:"6",y1:"12",y2:"12",key:"89khin"}],["line",{x1:"18",x2:"22",y1:"12",y2:"12",key:"pb8tfm"}],["line",{x1:"4.93",x2:"7.76",y1:"19.07",y2:"16.24",key:"1uxjnu"}],["line",{x1:"16.24",x2:"19.07",y1:"7.76",y2:"4.93",key:"6duxfx"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lM=Bt("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zte=Bt("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rj=Bt("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hN=Bt("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ta=Bt("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qte=Bt("Megaphone",[["path",{d:"m3 11 18-5v12L3 14v-3z",key:"n962bs"}],["path",{d:"M11.6 16.8a3 3 0 1 1-5.8-1.6",key:"1yl0tm"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wte=Bt("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gte=Bt("MicOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M18.89 13.23A7.12 7.12 0 0 0 19 12v-2",key:"80xlxr"}],["path",{d:"M5 10v2a7 7 0 0 0 12 5",key:"p2k8kg"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ux=Bt("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uf=Bt("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yte=Bt("MoreHorizontal",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cM=Bt("MoreVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rs=Bt("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xte=Bt("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",key:"1xcu5"}],["circle",{cx:"17.5",cy:"10.5",r:".5",key:"736e4u"}],["circle",{cx:"8.5",cy:"7.5",r:".5",key:"clrty"}],["circle",{cx:"6.5",cy:"12.5",r:".5",key:"1s4xz9"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ly=Bt("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gc=Bt("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ax=Bt("Percent",[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UA=Bt("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jte=Bt("PieChart",[["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}],["path",{d:"M22 12A10 10 0 0 0 12 2v10z",key:"1rfc4y"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y0=Bt("PlayCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"10 8 16 12 10 16 10 8",key:"1cimsy"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zte=Bt("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zr=Bt("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ere=Bt("PowerOff",[["path",{d:"M18.36 6.64A9 9 0 0 1 20.77 15",key:"dxknvb"}],["path",{d:"M6.16 6.16a9 9 0 1 0 12.68 12.68",key:"1x7qb5"}],["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tre=Bt("Power",[["path",{d:"M12 2v10",key:"mnfbl"}],["path",{d:"M18.4 6.6a9 9 0 1 1-12.77.04",key:"obofu9"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R0=Bt("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dM=Bt("QrCode",[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uo=Bt("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1-2-1Z",key:"wqdwcb"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17V7",key:"pyj7ub"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Di=Bt("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hx=Bt("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const au=Bt("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sn=Bt("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rB=Bt("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sl=Bt("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rre=Bt("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sre=Bt("ShieldCheck",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Co=Bt("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kd=Bt("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zi=Bt("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uM=Bt("SlidersHorizontal",[["line",{x1:"21",x2:"14",y1:"4",y2:"4",key:"obuewd"}],["line",{x1:"10",x2:"3",y1:"4",y2:"4",key:"1q6298"}],["line",{x1:"21",x2:"12",y1:"12",y2:"12",key:"1iu8h1"}],["line",{x1:"8",x2:"3",y1:"12",y2:"12",key:"ntss68"}],["line",{x1:"21",x2:"16",y1:"20",y2:"20",key:"14d8ph"}],["line",{x1:"12",x2:"3",y1:"20",y2:"20",key:"m0wm8r"}],["line",{x1:"14",x2:"14",y1:"2",y2:"6",key:"14e1ph"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"16",x2:"16",y1:"18",y2:"22",key:"1lctlv"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rd=Bt("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sB=Bt("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YA=Bt("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lj=Bt("StopCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["rect",{width:"6",height:"6",x:"9",y:"9",key:"1wrtvo"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zc=Bt("Store",[["path",{d:"m2 7 4.41-4.41A2 2 0 0 1 7.83 2h8.34a2 2 0 0 1 1.42.59L22 7",key:"ztvudi"}],["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["path",{d:"M15 22v-4a2 2 0 0 0-2-2h-2a2 2 0 0 0-2 2v4",key:"2ebpfo"}],["path",{d:"M2 7h20",key:"1fcdvo"}],["path",{d:"M22 7v3a2 2 0 0 1-2 2v0a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 16 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 12 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 8 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 4 12v0a2 2 0 0 1-2-2V7",key:"jon5kx"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vw=Bt("Tag",[["path",{d:"M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2Z",key:"14b2ls"}],["path",{d:"M7 7h.01",key:"7u93v4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qi=Bt("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v0=Bt("Ticket",[["path",{d:"M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"qn84l0"}],["path",{d:"M13 5v2",key:"dyzc3o"}],["path",{d:"M13 17v2",key:"1ont0d"}],["path",{d:"M13 11v2",key:"1wjjxi"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sf=Bt("Timer",[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nre=Bt("ToggleLeft",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"8",cy:"12",r:"2",key:"1nvbw3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const are=Bt("ToggleRight",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"16",cy:"12",r:"2",key:"4ma0v8"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Un=Bt("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mp=Bt("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Is=Bt("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bb=Bt("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t_=Bt("Truck",[["path",{d:"M5 18H3c-.6 0-1-.4-1-1V7c0-.6.4-1 1-1h10c.6 0 1 .4 1 1v11",key:"hs4xqm"}],["path",{d:"M14 9h4l4 4v4c0 .6-.4 1-1 1h-2",key:"11fp61"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oj=Bt("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AM=Bt("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L0=Bt("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hs=Bt("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ls=Bt("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XA=Bt("Utensils",[["path",{d:"M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2",key:"cjf0a3"}],["path",{d:"M7 2v20",key:"1473qp"}],["path",{d:"M21 15V2v0a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7",key:"1ogz0v"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ire=Bt("WifiOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M8.5 16.5a5 5 0 0 1 7 0",key:"sej527"}],["path",{d:"M2 8.82a15 15 0 0 1 4.17-2.65",key:"11utq1"}],["path",{d:"M10.66 5c4.01-.36 8.14.9 11.34 3.76",key:"hxefdu"}],["path",{d:"M16.85 11.25a10 10 0 0 1 2.22 1.68",key:"q734kn"}],["path",{d:"M5 13a10 10 0 0 1 5.24-2.76",key:"piq4yl"}],["line",{x1:"12",x2:"12.01",y1:"20",y2:"20",key:"of4bc4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ore=Bt("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const El=Bt("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qr=Bt("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ev=Bt("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]),lre=({isVisible:t,context:e,onClose:r,onRetryVoice:s})=>{if(!t||!e)return null;const i=(()=>{const o=e.command,l=e.missingFields;return l.includes("tableNumber")?o.type==="KOT_PRINT"?['"Table 5"','"5"','"Table number 3"']:o.type==="PLACE_ORDER"?['"Table 2"','"2"','"Table number 7"']:o.type==="PAYMENT"?['"Table 4"','"4"','"Table number 1"']:['"Table 3"','"3"','"Table number 6"']:!o.type||o.type==="UNKNOWN"?o.tableNumber?['"KOT"','"Order"','"Payment"']:['"KOT"','"Order"','"Payment"']:l.includes("paymentMethod")?['"UPI"','"Cash"','"Bank"']:l.includes("customerName")?['"John Smith"','"Sarah Wilson"','"Customer name"']:l.includes("targetTableNumber")?['"Table 8"','"8"','"Table number 10"']:l.includes("menuItems")?['"Chicken wings"','"2 burgers"','"Pizza margherita"']:['"Continue"','"Complete"','"Finish"']})();return a.jsx("div",{className:"fixed bottom-36 right-4 z-50 max-w-sm sm:right-6",children:a.jsxs("div",{className:"bg-white border-2 border-orange-200 rounded-lg shadow-xl p-4 animate-in slide-in-from-bottom-4 fade-in duration-300 mx-2 sm:mx-0 relative backdrop-blur-sm",children:[a.jsx("div",{className:"absolute -bottom-2 right-6 w-4 h-4 bg-white border-r-2 border-b-2 border-orange-200 transform rotate-45 sm:right-8"}),a.jsxs("div",{className:"flex items-start justify-between gap-3",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[a.jsx("div",{className:"w-3 h-3 bg-orange-500 rounded-full animate-pulse"}),a.jsx("span",{className:"text-sm font-semibold text-orange-700",children:"Voice Command Incomplete"})]}),a.jsx("p",{className:"text-sm text-gray-700 leading-relaxed mb-3",children:e.contextualMessage}),a.jsxs("div",{className:"bg-gray-50 rounded-md p-3 mb-3",children:[a.jsx("p",{className:"text-xs font-medium text-gray-600 mb-2",children:"Examples:"}),a.jsx("div",{className:"space-y-1",children:i.map((o,l)=>a.jsx("div",{className:"text-xs text-gray-600 font-mono bg-white px-2 py-1 rounded border",children:o},l))})]}),s&&a.jsxs("button",{onClick:s,className:"w-full flex items-center justify-center gap-2 bg-orange-500 hover:bg-orange-600 text-white text-sm font-medium py-2.5 px-3 rounded-md transition-all duration-200 hover:shadow-md active:scale-95",children:[a.jsx(ux,{className:"w-4 h-4 animate-pulse"}),"Press to continue"]})]}),a.jsx("button",{onClick:r,className:"flex-shrink-0 p-1 hover:bg-gray-100 rounded-md transition-colors","aria-label":"Close dialog",children:a.jsx(qr,{className:"w-4 h-4 text-gray-400"})})]})]})})},hM=R.createContext(void 0),cre=({children:t})=>{const[e]=R.useState(OA.isSupported()),[r,s]=R.useState(!1),[n,i]=R.useState(!1),[o,l]=R.useState(!1),[c,d]=R.useState(!1),[u,A]=R.useState("idle"),[h,f]=R.useState(""),[p,m]=R.useState(null),[g,y]=R.useState(null),[v,x]=R.useState(null),{user:E}=ia(),{restaurant:T}=js(),j=Li(),C=du();R.useEffect(()=>{if(!e){yr.error("Voice commands are not supported in this browser.");return}Pa.setOnStateChange(ue=>{A(ue),i(Pa.getIsListening()),l(Pa.getIsContinuousMode()),d(Pa.getIsPushToTalkMode())}),Pa.setOnTranscriptChange(ue=>{f(ue)}),Pa.setOnCommandDetected(async ue=>{m(ue),re(ue)}),Pa.setOnIncompleteCommand(ue=>{y(ue)}),S()},[]),R.useEffect(()=>{if(T!=null&&T.id){const ue=rc.getContext(T.id);ue&&(console.log(" VoiceContext: Found stored context on restaurant load:",ue),y(ue))}},[T==null?void 0:T.id]),R.useEffect(()=>{console.log(" VoiceContext: Restaurant changed, updating voice service context:",T==null?void 0:T.slug),T?Pa.setRestaurantContext({name:T.name,slug:T.slug,id:T.id}):Pa.clearRestaurantContext()},[T]),R.useEffect(()=>{if(v&&T){const ue=v.tableNumber,Ie=C.pathname;let Y=!1,H="";if(v.type==="ORDER"||v.type==="PLACE_ORDER"){const je=`/${T.slug}/tables/${ue}/order`;Y=Ie===je,H=v.type==="PLACE_ORDER"?"voicePlaceOrderCommand":"voiceOrderCommand"}else switch(Y=Ie.includes("/tables"),v.type){case"PAYMENT":H="voicePaymentCommand";break;case"KOT_PRINT":H="voiceKotPrintCommand";break;case"ORDER_CANCEL":H="voiceOrderCancelCommand";break;default:H="voiceOrderCommand"}console.log(" Checking navigation completion:",{currentPath:Ie,commandType:v.type,tableNumber:ue,isOnCorrectPage:Y,eventType:H}),Y&&(console.log(" Navigation completed, executing pending voice command"),setTimeout(()=>{const je=new CustomEvent(H,{detail:{command:v}});window.dispatchEvent(je),console.log(" Re-dispatched voice command after navigation:",H),x(null)},500))}},[C.pathname,v,T]);const w=ue=>{if(["ORDER","PLACE_ORDER"].includes(ue.type)&&ue.tableNumber&&T){const H=`/${T.slug}/tables/${ue.tableNumber}/order`,je=C.pathname;if(console.log(" Global voice command received:",{commandType:ue.type,tableNumber:ue.tableNumber,currentPath:je,expectedPath:H,needsNavigation:je!==H}),je!==H){console.log(" Not on table page, navigating first..."),x(ue);const Ce=ue.type==="ORDER"?"process order":"place order";yr(` Navigating to Table ${ue.tableNumber} to ${Ce}...`,{icon:"",duration:2e3}),j(H);return}else{console.log(" Already on correct table page, processing command immediately");const Ce=ue.type==="PLACE_ORDER"?"voicePlaceOrderCommand":"voiceOrderCommand",oe=new CustomEvent(Ce,{detail:{command:ue}});window.dispatchEvent(oe);return}}if(T)switch(ue.type){case"PAYMENT":if(!C.pathname.includes("/tables")){console.log(" Not on tables page, navigating to tables for payment..."),yr(` Navigating to Tables page to process payment for Table ${ue.tableNumber}...`,{icon:"",duration:2e3}),x(ue),j(`/${T.slug}/tables`);return}const Ce=new CustomEvent("voicePaymentCommand",{detail:{command:ue}});window.dispatchEvent(Ce);break;case"KOT_PRINT":if(!C.pathname.includes("/tables")){console.log(" Not on tables page, navigating to tables for KOT print..."),yr(` Navigating to Tables page to print KOT for Table ${ue.tableNumber}...`,{icon:"",duration:2e3}),x(ue),j(`/${T.slug}/tables`);return}const ie=new CustomEvent("voiceKotPrintCommand",{detail:{command:ue}});window.dispatchEvent(ie);break;case"ORDER_CANCEL":if(!C.pathname.includes("/tables")){console.log(" Not on tables page, navigating to tables for order cancel..."),yr(` Navigating to Tables page to cancel order for Table ${ue.tableNumber}...`,{icon:"",duration:2e3}),x(ue),j(`/${T.slug}/tables`);return}const ve=new CustomEvent("voiceOrderCancelCommand",{detail:{command:ue}});window.dispatchEvent(ve);break;default:const we=new CustomEvent("voiceOrderCommand",{detail:{command:ue}});window.dispatchEvent(we);break}else switch(console.log(" No restaurant context for navigation, dispatching command normally"),ue.type){case"PAYMENT":const H=new CustomEvent("voicePaymentCommand",{detail:{command:ue}});window.dispatchEvent(H);break;case"KOT_PRINT":const je=new CustomEvent("voiceKotPrintCommand",{detail:{command:ue}});window.dispatchEvent(je);break;case"ORDER_CANCEL":const Ce=new CustomEvent("voiceOrderCancelCommand",{detail:{command:ue}});window.dispatchEvent(Ce);break;case"PLACE_ORDER":const oe=new CustomEvent("voicePlaceOrderCommand",{detail:{command:ue}});window.dispatchEvent(oe);break;default:const He=new CustomEvent("voiceOrderCommand",{detail:{command:ue}});window.dispatchEvent(He);break}},S=async()=>{try{const ue=await navigator.permissions.query({name:"microphone"});s(ue.state==="granted")}catch{console.log("Could not check microphone permission")}},F=async()=>{const ue=await Pa.requestPermission();return s(ue),ue},B=()=>{if(!r){yr.error("Please grant microphone permission first.");return}Pa.startListening()},k=()=>{if(!r){yr.error("Please grant microphone permission first.");return}Pa.startContinuousListening()},D=()=>{if(!r){yr.error("Please grant microphone permission first.");return}Pa.startPushToTalkRecording()},q=()=>{Pa.stopPushToTalkRecording()},te=()=>{Pa.stopListening()},W=()=>{Pa.toggleListening()},Q=()=>{y(null),T!=null&&T.id&&rc.clearContext()},re=async ue=>{try{if(g&&!ue.isIncomplete){const Ie=await Pa.mergeIncompleteCommand(g,ue.originalText);if(Ie){y(null),A("executing"),console.log(" VoiceContext: Executing merged command:",Ie),await G(Ie);return}y(null)}A("executing"),console.log(" VoiceContext: Executing command:",ue),await G(ue)}catch(Ie){console.error("Error executing voice command:",Ie),yr.error("Failed to execute command."),A("error"),setTimeout(()=>A("idle"),2e3)}},G=async ue=>{switch(ue.type){case"ORDER":await Ae(ue);break;case"PLACE_ORDER":await he(ue);break;case"PAYMENT":await I(ue);break;case"KOT_PRINT":await U(ue);break;case"ORDER_CANCEL":await V(ue);break;case"TABLE_MERGE":await L(ue);break;case"TABLE_TRANSFER":await K(ue);break;case"TABLE_STATUS":await fe(ue);break;case"CUSTOMER":await ee(ue);break;case"MENU_INQUIRY":await de(ue);break;default:yr.error("Command not recognized. Please try again.")}A("idle")},Ae=async ue=>{const{tableNumber:Ie,menuItems:Y}=ue;if(console.log(" VoiceContext: Executing order command:",{tableNumber:Ie,menuItems:Y,hasUser:!!E}),!Ie||!Y||Y.length===0){yr.error("Please specify table number and menu items.");return}w(ue)},he=async ue=>{const{tableNumber:Ie,menuItems:Y}=ue;if(console.log(" VoiceContext: Executing place order command:",{tableNumber:Ie,menuItems:Y,hasUser:!!E}),!Ie){yr.error("Please specify table number for placing order.");return}if(Y&&Y.length>0)console.log(" VoiceContext: Place order has menu items, executing as order command"),w({...ue,type:"ORDER"});else{const H=new CustomEvent("voicePlaceOrderCommand",{detail:{command:ue}});window.dispatchEvent(H),console.log(" VoiceContext: Dispatched voicePlaceOrderCommand event")}},I=async ue=>{const{tableNumber:Ie,paymentMethod:Y}=ue;if(console.log(" VoiceContext: Executing payment command:",{tableNumber:Ie,paymentMethod:Y,hasUser:!!E}),!Ie){yr.error("Please specify table number for payment.");return}const H=new CustomEvent("voicePaymentCommand",{detail:{command:ue}});window.dispatchEvent(H),console.log(" VoiceContext: Dispatched voicePaymentCommand event")},U=async ue=>{const{tableNumber:Ie}=ue;if(console.log(" VoiceContext: Executing KOT print command:",{tableNumber:Ie,hasUser:!!E}),!Ie){yr.error("Please specify table number for KOT printing.");return}const Y=new CustomEvent("voiceKotPrintCommand",{detail:{command:ue}});window.dispatchEvent(Y),console.log(" VoiceContext: Dispatched voiceKotPrintCommand event")},V=async ue=>{const{tableNumber:Ie}=ue;if(console.log(" VoiceContext: Executing order cancel command:",{tableNumber:Ie,hasUser:!!E}),!Ie){yr.error("Please specify table number for order cancellation.");return}const Y=new CustomEvent("voiceOrderCancelCommand",{detail:{command:ue}});window.dispatchEvent(Y),console.log(" VoiceContext: Dispatched voiceOrderCancelCommand event")},L=async ue=>{const{tableNumber:Ie,targetTableNumber:Y}=ue;if(console.log(" VoiceContext: Executing table merge command:",{tableNumber:Ie,targetTableNumber:Y,hasUser:!!E}),!Ie||!Y){yr.error("Please specify both source and target table numbers for merging.");return}const H=new CustomEvent("voiceTableMergeCommand",{detail:{command:ue}});window.dispatchEvent(H),console.log(" VoiceContext: Dispatched voiceTableMergeCommand event")},K=async ue=>{const{tableNumber:Ie,targetTableNumber:Y}=ue;if(console.log(" VoiceContext: Executing table transfer command:",{tableNumber:Ie,targetTableNumber:Y,hasUser:!!E}),!Ie||!Y){yr.error("Please specify both source and target table numbers for transfer.");return}const H=new CustomEvent("voiceTableTransferCommand",{detail:{command:ue}});window.dispatchEvent(H),console.log(" VoiceContext: Dispatched voiceTableTransferCommand event")},fe=async ue=>{const{tableNumber:Ie}=ue;if(console.log(" VoiceContext: Executing table status command:",{tableNumber:Ie,hasUser:!!E}),!Ie){yr.error("Please specify table number for status update.");return}const Y=new CustomEvent("voiceTableStatusCommand",{detail:{command:ue}});window.dispatchEvent(Y),console.log(" VoiceContext: Dispatched voiceTableStatusCommand event")},ee=async ue=>{const{customerName:Ie,customerPhone:Y}=ue;if(console.log(" VoiceContext: Executing customer command:",{customerName:Ie,customerPhone:Y,hasUser:!!E}),!Ie&&!Y){yr.error("Please specify customer name or phone number.");return}const H=new CustomEvent("voiceCustomerCommand",{detail:{command:ue}});window.dispatchEvent(H),console.log(" VoiceContext: Dispatched voiceCustomerCommand event")},de=async ue=>{console.log(" VoiceContext: Executing menu inquiry command:",{hasUser:!!E});const Ie=new CustomEvent("voiceMenuInquiryCommand",{detail:{command:ue}});window.dispatchEvent(Ie),console.log(" VoiceContext: Dispatched voiceMenuInquiryCommand event")};return a.jsxs(hM.Provider,{value:{isSupported:e,hasPermission:r,isListening:n,isContinuousMode:o,isPushToTalkMode:c,state:u,transcript:h,lastCommand:p,incompleteCommandContext:g,requestPermission:F,startListening:B,startContinuousListening:k,startPushToTalkRecording:D,stopPushToTalkRecording:q,stopListening:te,toggleListening:W,executeCommand:re,clearIncompleteCommand:Q},children:[t,a.jsx(lre,{isVisible:!!g,context:g||void 0,onClose:Q,onRetryVoice:B})]})},dre=()=>{const t=R.useContext(hM);if(t===void 0)throw new Error("useVoice must be used within a VoiceProvider");return t};var tv=t=>t.type==="checkbox",nf=t=>t instanceof Date,$i=t=>t==null;const fM=t=>typeof t=="object";var sa=t=>!$i(t)&&!Array.isArray(t)&&fM(t)&&!nf(t),ure=t=>sa(t)&&t.target?tv(t.target)?t.target.checked:t.target.value:t,Are=t=>t.substring(0,t.search(/\.\d+(\.|$)/))||t,hre=(t,e)=>t.has(Are(e)),fre=t=>{const e=t.constructor&&t.constructor.prototype;return sa(e)&&e.hasOwnProperty("isPrototypeOf")},r_=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function yi(t){let e;const r=Array.isArray(t),s=typeof FileList<"u"?t instanceof FileList:!1;if(t instanceof Date)e=new Date(t);else if(t instanceof Set)e=new Set(t);else if(!(r_&&(t instanceof Blob||s))&&(r||sa(t)))if(e=r?[]:{},!r&&!fre(t))e=t;else for(const n in t)t.hasOwnProperty(n)&&(e[n]=yi(t[n]));else return t;return e}var fN=t=>Array.isArray(t)?t.filter(Boolean):[],ma=t=>t===void 0,gr=(t,e,r)=>{if(!e||!sa(t))return r;const s=fN(e.split(/[,[\].]+?/)).reduce((n,i)=>$i(n)?n:n[i],t);return ma(s)||s===t?ma(t[e])?r:t[e]:s},Lc=t=>typeof t=="boolean",s_=t=>/^\w*$/.test(t),mM=t=>fN(t.replace(/["|']|\]/g,"").split(/\.|\[/)),cn=(t,e,r)=>{let s=-1;const n=s_(e)?[e]:mM(e),i=n.length,o=i-1;for(;++s<i;){const l=n[s];let c=r;if(s!==o){const d=t[l];c=sa(d)||Array.isArray(d)?d:isNaN(+n[s+1])?{}:[]}if(l==="__proto__"||l==="constructor"||l==="prototype")return;t[l]=c,t=t[l]}};const nB={BLUR:"blur",FOCUS_OUT:"focusout"},ac={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},_d={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"};bi.createContext(null);var mre=(t,e,r,s=!0)=>{const n={defaultValues:e._defaultValues};for(const i in t)Object.defineProperty(n,i,{get:()=>{const o=i;return e._proxyFormState[o]!==ac.all&&(e._proxyFormState[o]=!s||ac.all),t[o]}});return n};const pre=typeof window<"u"?R.useLayoutEffect:R.useEffect;var Hc=t=>typeof t=="string",gre=(t,e,r,s,n)=>Hc(t)?(s&&e.watch.add(t),gr(r,t,n)):Array.isArray(t)?t.map(i=>(s&&e.watch.add(i),gr(r,i))):(s&&(e.watchAll=!0),r),xre=(t,e,r,s,n)=>e?{...r[t],types:{...r[t]&&r[t].types?r[t].types:{},[s]:n||!0}}:{},fx=t=>Array.isArray(t)?t:[t],aB=()=>{let t=[];return{get observers(){return t},next:n=>{for(const i of t)i.next&&i.next(n)},subscribe:n=>(t.push(n),{unsubscribe:()=>{t=t.filter(i=>i!==n)}}),unsubscribe:()=>{t=[]}}},Uj=t=>$i(t)||!fM(t);function dA(t,e){if(Uj(t)||Uj(e))return t===e;if(nf(t)&&nf(e))return t.getTime()===e.getTime();const r=Object.keys(t),s=Object.keys(e);if(r.length!==s.length)return!1;for(const n of r){const i=t[n];if(!s.includes(n))return!1;if(n!=="ref"){const o=e[n];if(nf(i)&&nf(o)||sa(i)&&sa(o)||Array.isArray(i)&&Array.isArray(o)?!dA(i,o):i!==o)return!1}}return!0}var uo=t=>sa(t)&&!Object.keys(t).length,n_=t=>t.type==="file",ic=t=>typeof t=="function",Hw=t=>{if(!r_)return!1;const e=t?t.ownerDocument:0;return t instanceof(e&&e.defaultView?e.defaultView.HTMLElement:HTMLElement)},pM=t=>t.type==="select-multiple",a_=t=>t.type==="radio",yre=t=>a_(t)||tv(t),G5=t=>Hw(t)&&t.isConnected;function vre(t,e){const r=e.slice(0,-1).length;let s=0;for(;s<r;)t=ma(t)?s++:t[e[s++]];return t}function bre(t){for(const e in t)if(t.hasOwnProperty(e)&&!ma(t[e]))return!1;return!0}function va(t,e){const r=Array.isArray(e)?e:s_(e)?[e]:mM(e),s=r.length===1?t:vre(t,r),n=r.length-1,i=r[n];return s&&delete s[i],n!==0&&(sa(s)&&uo(s)||Array.isArray(s)&&bre(s))&&va(t,r.slice(0,-1)),t}var gM=t=>{for(const e in t)if(ic(t[e]))return!0;return!1};function $w(t,e={}){const r=Array.isArray(t);if(sa(t)||r)for(const s in t)Array.isArray(t[s])||sa(t[s])&&!gM(t[s])?(e[s]=Array.isArray(t[s])?[]:{},$w(t[s],e[s])):$i(t[s])||(e[s]=!0);return e}function xM(t,e,r){const s=Array.isArray(t);if(sa(t)||s)for(const n in t)Array.isArray(t[n])||sa(t[n])&&!gM(t[n])?ma(e)||Uj(r[n])?r[n]=Array.isArray(t[n])?$w(t[n],[]):{...$w(t[n])}:xM(t[n],$i(e)?{}:e[n],r[n]):r[n]=!dA(t[n],e[n]);return r}var xg=(t,e)=>xM(t,e,$w(e));const iB={value:!1,isValid:!1},oB={value:!0,isValid:!0};var yM=t=>{if(Array.isArray(t)){if(t.length>1){const e=t.filter(r=>r&&r.checked&&!r.disabled).map(r=>r.value);return{value:e,isValid:!!e.length}}return t[0].checked&&!t[0].disabled?t[0].attributes&&!ma(t[0].attributes.value)?ma(t[0].value)||t[0].value===""?oB:{value:t[0].value,isValid:!0}:oB:iB}return iB},vM=(t,{valueAsNumber:e,valueAsDate:r,setValueAs:s})=>ma(t)?t:e?t===""?NaN:t&&+t:r&&Hc(t)?new Date(t):s?s(t):t;const lB={isValid:!1,value:null};var bM=t=>Array.isArray(t)?t.reduce((e,r)=>r&&r.checked&&!r.disabled?{isValid:!0,value:r.value}:e,lB):lB;function cB(t){const e=t.ref;return n_(e)?e.files:a_(e)?bM(t.refs).value:pM(e)?[...e.selectedOptions].map(({value:r})=>r):tv(e)?yM(t.refs).value:vM(ma(e.value)?t.ref.value:e.value,t)}var wre=(t,e,r,s)=>{const n={};for(const i of t){const o=gr(e,i);o&&cn(n,i,o._f)}return{criteriaMode:r,names:[...t],fields:n,shouldUseNativeValidation:s}},Kw=t=>t instanceof RegExp,yg=t=>ma(t)?t:Kw(t)?t.source:sa(t)?Kw(t.value)?t.value.source:t.value:t,dB=t=>({isOnSubmit:!t||t===ac.onSubmit,isOnBlur:t===ac.onBlur,isOnChange:t===ac.onChange,isOnAll:t===ac.all,isOnTouch:t===ac.onTouched});const uB="AsyncFunction";var Nre=t=>!!t&&!!t.validate&&!!(ic(t.validate)&&t.validate.constructor.name===uB||sa(t.validate)&&Object.values(t.validate).find(e=>e.constructor.name===uB)),Cre=t=>t.mount&&(t.required||t.min||t.max||t.maxLength||t.minLength||t.pattern||t.validate),AB=(t,e,r)=>!r&&(e.watchAll||e.watch.has(t)||[...e.watch].some(s=>t.startsWith(s)&&/^\.\w+/.test(t.slice(s.length))));const mx=(t,e,r,s)=>{for(const n of r||Object.keys(t)){const i=gr(t,n);if(i){const{_f:o,...l}=i;if(o){if(o.refs&&o.refs[0]&&e(o.refs[0],n)&&!s)return!0;if(o.ref&&e(o.ref,o.name)&&!s)return!0;if(mx(l,e))break}else if(sa(l)&&mx(l,e))break}}};function hB(t,e,r){const s=gr(t,r);if(s||s_(r))return{error:s,name:r};const n=r.split(".");for(;n.length;){const i=n.join("."),o=gr(e,i),l=gr(t,i);if(o&&!Array.isArray(o)&&r!==i)return{name:r};if(l&&l.type)return{name:i,error:l};if(l&&l.root&&l.root.type)return{name:`${i}.root`,error:l.root};n.pop()}return{name:r}}var jre=(t,e,r,s)=>{r(t);const{name:n,...i}=t;return uo(i)||Object.keys(i).length>=Object.keys(e).length||Object.keys(i).find(o=>e[o]===(!s||ac.all))},Sre=(t,e,r)=>!t||!e||t===e||fx(t).some(s=>s&&(r?s===e:s.startsWith(e)||e.startsWith(s))),Ere=(t,e,r,s,n)=>n.isOnAll?!1:!r&&n.isOnTouch?!(e||t):(r?s.isOnBlur:n.isOnBlur)?!t:(r?s.isOnChange:n.isOnChange)?t:!0,_re=(t,e)=>!fN(gr(t,e)).length&&va(t,e),Tre=(t,e,r)=>{const s=fx(gr(t,r));return cn(s,"root",e[r]),cn(t,r,s),t},Fb=t=>Hc(t);function fB(t,e,r="validate"){if(Fb(t)||Array.isArray(t)&&t.every(Fb)||Lc(t)&&!t)return{type:r,message:Fb(t)?t:"",ref:e}}var Bm=t=>sa(t)&&!Kw(t)?t:{value:t,message:""},mB=async(t,e,r,s,n,i)=>{const{ref:o,refs:l,required:c,maxLength:d,minLength:u,min:A,max:h,pattern:f,validate:p,name:m,valueAsNumber:g,mount:y}=t._f,v=gr(r,m);if(!y||e.has(m))return{};const x=l?l[0]:o,E=k=>{n&&x.reportValidity&&(x.setCustomValidity(Lc(k)?"":k||""),x.reportValidity())},T={},j=a_(o),C=tv(o),w=j||C,S=(g||n_(o))&&ma(o.value)&&ma(v)||Hw(o)&&o.value===""||v===""||Array.isArray(v)&&!v.length,F=xre.bind(null,m,s,T),B=(k,D,q,te=_d.maxLength,W=_d.minLength)=>{const Q=k?D:q;T[m]={type:k?te:W,message:Q,ref:o,...F(k?te:W,Q)}};if(i?!Array.isArray(v)||!v.length:c&&(!w&&(S||$i(v))||Lc(v)&&!v||C&&!yM(l).isValid||j&&!bM(l).isValid)){const{value:k,message:D}=Fb(c)?{value:!!c,message:c}:Bm(c);if(k&&(T[m]={type:_d.required,message:D,ref:x,...F(_d.required,D)},!s))return E(D),T}if(!S&&(!$i(A)||!$i(h))){let k,D;const q=Bm(h),te=Bm(A);if(!$i(v)&&!isNaN(v)){const W=o.valueAsNumber||v&&+v;$i(q.value)||(k=W>q.value),$i(te.value)||(D=W<te.value)}else{const W=o.valueAsDate||new Date(v),Q=Ae=>new Date(new Date().toDateString()+" "+Ae),re=o.type=="time",G=o.type=="week";Hc(q.value)&&v&&(k=re?Q(v)>Q(q.value):G?v>q.value:W>new Date(q.value)),Hc(te.value)&&v&&(D=re?Q(v)<Q(te.value):G?v<te.value:W<new Date(te.value))}if((k||D)&&(B(!!k,q.message,te.message,_d.max,_d.min),!s))return E(T[m].message),T}if((d||u)&&!S&&(Hc(v)||i&&Array.isArray(v))){const k=Bm(d),D=Bm(u),q=!$i(k.value)&&v.length>+k.value,te=!$i(D.value)&&v.length<+D.value;if((q||te)&&(B(q,k.message,D.message),!s))return E(T[m].message),T}if(f&&!S&&Hc(v)){const{value:k,message:D}=Bm(f);if(Kw(k)&&!v.match(k)&&(T[m]={type:_d.pattern,message:D,ref:o,...F(_d.pattern,D)},!s))return E(D),T}if(p){if(ic(p)){const k=await p(v,r),D=fB(k,x);if(D&&(T[m]={...D,...F(_d.validate,D.message)},!s))return E(D.message),T}else if(sa(p)){let k={};for(const D in p){if(!uo(k)&&!s)break;const q=fB(await p[D](v,r),x,D);q&&(k={...q,...F(D,q.message)},E(q.message),s&&(T[m]=k))}if(!uo(k)&&(T[m]={ref:x,...k},!s))return T}}return E(!0),T};const Ire={mode:ac.onSubmit,reValidateMode:ac.onChange,shouldFocusError:!0};function kre(t={}){let e={...Ire,...t},r={submitCount:0,isDirty:!1,isReady:!1,isLoading:ic(e.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1};const s={};let n=sa(e.defaultValues)||sa(e.values)?yi(e.defaultValues||e.values)||{}:{},i=e.shouldUnregister?{}:yi(n),o={action:!1,mount:!1,watch:!1},l={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},c,d=0;const u={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let A={...u};const h={array:aB(),state:aB()},f=e.criteriaMode===ac.all,p=ae=>ve=>{clearTimeout(d),d=setTimeout(ae,ve)},m=async ae=>{if(!e.disabled&&(u.isValid||A.isValid||ae)){const ve=e.resolver?uo((await C()).errors):await S(s,!0);ve!==r.isValid&&h.state.next({isValid:ve})}},g=(ae,ve)=>{!e.disabled&&(u.isValidating||u.validatingFields||A.isValidating||A.validatingFields)&&((ae||Array.from(l.mount)).forEach(we=>{we&&(ve?cn(r.validatingFields,we,ve):va(r.validatingFields,we))}),h.state.next({validatingFields:r.validatingFields,isValidating:!uo(r.validatingFields)}))},y=(ae,ve=[],we,De,Ve=!0,me=!0)=>{if(De&&we&&!e.disabled){if(o.action=!0,me&&Array.isArray(gr(s,ae))){const Fe=we(gr(s,ae),De.argA,De.argB);Ve&&cn(s,ae,Fe)}if(me&&Array.isArray(gr(r.errors,ae))){const Fe=we(gr(r.errors,ae),De.argA,De.argB);Ve&&cn(r.errors,ae,Fe),_re(r.errors,ae)}if((u.touchedFields||A.touchedFields)&&me&&Array.isArray(gr(r.touchedFields,ae))){const Fe=we(gr(r.touchedFields,ae),De.argA,De.argB);Ve&&cn(r.touchedFields,ae,Fe)}(u.dirtyFields||A.dirtyFields)&&(r.dirtyFields=xg(n,i)),h.state.next({name:ae,isDirty:B(ae,ve),dirtyFields:r.dirtyFields,errors:r.errors,isValid:r.isValid})}else cn(i,ae,ve)},v=(ae,ve)=>{cn(r.errors,ae,ve),h.state.next({errors:r.errors})},x=ae=>{r.errors=ae,h.state.next({errors:r.errors,isValid:!1})},E=(ae,ve,we,De)=>{const Ve=gr(s,ae);if(Ve){const me=gr(i,ae,ma(we)?gr(n,ae):we);ma(me)||De&&De.defaultChecked||ve?cn(i,ae,ve?me:cB(Ve._f)):q(ae,me),o.mount&&m()}},T=(ae,ve,we,De,Ve)=>{let me=!1,Fe=!1;const Re={name:ae};if(!e.disabled){if(!we||De){(u.isDirty||A.isDirty)&&(Fe=r.isDirty,r.isDirty=Re.isDirty=B(),me=Fe!==Re.isDirty);const Be=dA(gr(n,ae),ve);Fe=!!gr(r.dirtyFields,ae),Be?va(r.dirtyFields,ae):cn(r.dirtyFields,ae,!0),Re.dirtyFields=r.dirtyFields,me=me||(u.dirtyFields||A.dirtyFields)&&Fe!==!Be}if(we){const Be=gr(r.touchedFields,ae);Be||(cn(r.touchedFields,ae,we),Re.touchedFields=r.touchedFields,me=me||(u.touchedFields||A.touchedFields)&&Be!==we)}me&&Ve&&h.state.next(Re)}return me?Re:{}},j=(ae,ve,we,De)=>{const Ve=gr(r.errors,ae),me=(u.isValid||A.isValid)&&Lc(ve)&&r.isValid!==ve;if(e.delayError&&we?(c=p(()=>v(ae,we)),c(e.delayError)):(clearTimeout(d),c=null,we?cn(r.errors,ae,we):va(r.errors,ae)),(we?!dA(Ve,we):Ve)||!uo(De)||me){const Fe={...De,...me&&Lc(ve)?{isValid:ve}:{},errors:r.errors,name:ae};r={...r,...Fe},h.state.next(Fe)}},C=async ae=>{g(ae,!0);const ve=await e.resolver(i,e.context,wre(ae||l.mount,s,e.criteriaMode,e.shouldUseNativeValidation));return g(ae),ve},w=async ae=>{const{errors:ve}=await C(ae);if(ae)for(const we of ae){const De=gr(ve,we);De?cn(r.errors,we,De):va(r.errors,we)}else r.errors=ve;return ve},S=async(ae,ve,we={valid:!0})=>{for(const De in ae){const Ve=ae[De];if(Ve){const{_f:me,...Fe}=Ve;if(me){const Re=l.array.has(me.name),Be=Ve._f&&Nre(Ve._f);Be&&u.validatingFields&&g([De],!0);const X=await mB(Ve,l.disabled,i,f,e.shouldUseNativeValidation&&!ve,Re);if(Be&&u.validatingFields&&g([De]),X[me.name]&&(we.valid=!1,ve))break;!ve&&(gr(X,me.name)?Re?Tre(r.errors,X,me.name):cn(r.errors,me.name,X[me.name]):va(r.errors,me.name))}!uo(Fe)&&await S(Fe,ve,we)}}return we.valid},F=()=>{for(const ae of l.unMount){const ve=gr(s,ae);ve&&(ve._f.refs?ve._f.refs.every(we=>!G5(we)):!G5(ve._f.ref))&&fe(ae)}l.unMount=new Set},B=(ae,ve)=>!e.disabled&&(ae&&ve&&cn(i,ae,ve),!dA(Ae(),n)),k=(ae,ve,we)=>gre(ae,l,{...o.mount?i:ma(ve)?n:Hc(ae)?{[ae]:ve}:ve},we,ve),D=ae=>fN(gr(o.mount?i:n,ae,e.shouldUnregister?gr(n,ae,[]):[])),q=(ae,ve,we={})=>{const De=gr(s,ae);let Ve=ve;if(De){const me=De._f;me&&(!me.disabled&&cn(i,ae,vM(ve,me)),Ve=Hw(me.ref)&&$i(ve)?"":ve,pM(me.ref)?[...me.ref.options].forEach(Fe=>Fe.selected=Ve.includes(Fe.value)):me.refs?tv(me.ref)?me.refs.forEach(Fe=>{(!Fe.defaultChecked||!Fe.disabled)&&(Array.isArray(Ve)?Fe.checked=!!Ve.find(Re=>Re===Fe.value):Fe.checked=Ve===Fe.value||!!Ve)}):me.refs.forEach(Fe=>Fe.checked=Fe.value===Ve):n_(me.ref)?me.ref.value="":(me.ref.value=Ve,me.ref.type||h.state.next({name:ae,values:yi(i)})))}(we.shouldDirty||we.shouldTouch)&&T(ae,Ve,we.shouldTouch,we.shouldDirty,!0),we.shouldValidate&&G(ae)},te=(ae,ve,we)=>{for(const De in ve){if(!ve.hasOwnProperty(De))return;const Ve=ve[De],me=ae+"."+De,Fe=gr(s,me);(l.array.has(ae)||sa(Ve)||Fe&&!Fe._f)&&!nf(Ve)?te(me,Ve,we):q(me,Ve,we)}},W=(ae,ve,we={})=>{const De=gr(s,ae),Ve=l.array.has(ae),me=yi(ve);cn(i,ae,me),Ve?(h.array.next({name:ae,values:yi(i)}),(u.isDirty||u.dirtyFields||A.isDirty||A.dirtyFields)&&we.shouldDirty&&h.state.next({name:ae,dirtyFields:xg(n,i),isDirty:B(ae,me)})):De&&!De._f&&!$i(me)?te(ae,me,we):q(ae,me,we),AB(ae,l)&&h.state.next({...r}),h.state.next({name:o.mount?ae:void 0,values:yi(i)})},Q=async ae=>{o.mount=!0;const ve=ae.target;let we=ve.name,De=!0;const Ve=gr(s,we),me=Be=>{De=Number.isNaN(Be)||nf(Be)&&isNaN(Be.getTime())||dA(Be,gr(i,we,Be))},Fe=dB(e.mode),Re=dB(e.reValidateMode);if(Ve){let Be,X;const _e=ve.type?cB(Ve._f):ure(ae),ke=ae.type===nB.BLUR||ae.type===nB.FOCUS_OUT,lt=!Cre(Ve._f)&&!e.resolver&&!gr(r.errors,we)&&!Ve._f.deps||Ere(ke,gr(r.touchedFields,we),r.isSubmitted,Re,Fe),mt=AB(we,l,ke);cn(i,we,_e),ke?(Ve._f.onBlur&&Ve._f.onBlur(ae),c&&c(0)):Ve._f.onChange&&Ve._f.onChange(ae);const pt=T(we,_e,ke),ze=!uo(pt)||mt;if(!ke&&h.state.next({name:we,type:ae.type,values:yi(i)}),lt)return(u.isValid||A.isValid)&&(e.mode==="onBlur"?ke&&m():ke||m()),ze&&h.state.next({name:we,...mt?{}:pt});if(!ke&&mt&&h.state.next({...r}),e.resolver){const{errors:Me}=await C([we]);if(me(_e),De){const rt=hB(r.errors,s,we),ht=hB(Me,s,rt.name||we);Be=ht.error,we=ht.name,X=uo(Me)}}else g([we],!0),Be=(await mB(Ve,l.disabled,i,f,e.shouldUseNativeValidation))[we],g([we]),me(_e),De&&(Be?X=!1:(u.isValid||A.isValid)&&(X=await S(s,!0)));De&&(Ve._f.deps&&G(Ve._f.deps),j(we,X,Be,pt))}},re=(ae,ve)=>{if(gr(r.errors,ve)&&ae.focus)return ae.focus(),1},G=async(ae,ve={})=>{let we,De;const Ve=fx(ae);if(e.resolver){const me=await w(ma(ae)?ae:Ve);we=uo(me),De=ae?!Ve.some(Fe=>gr(me,Fe)):we}else ae?(De=(await Promise.all(Ve.map(async me=>{const Fe=gr(s,me);return await S(Fe&&Fe._f?{[me]:Fe}:Fe)}))).every(Boolean),!(!De&&!r.isValid)&&m()):De=we=await S(s);return h.state.next({...!Hc(ae)||(u.isValid||A.isValid)&&we!==r.isValid?{}:{name:ae},...e.resolver||!ae?{isValid:we}:{},errors:r.errors}),ve.shouldFocus&&!De&&mx(s,re,ae?Ve:l.mount),De},Ae=ae=>{const ve={...o.mount?i:n};return ma(ae)?ve:Hc(ae)?gr(ve,ae):ae.map(we=>gr(ve,we))},he=(ae,ve)=>({invalid:!!gr((ve||r).errors,ae),isDirty:!!gr((ve||r).dirtyFields,ae),error:gr((ve||r).errors,ae),isValidating:!!gr(r.validatingFields,ae),isTouched:!!gr((ve||r).touchedFields,ae)}),I=ae=>{ae&&fx(ae).forEach(ve=>va(r.errors,ve)),h.state.next({errors:ae?r.errors:{}})},U=(ae,ve,we)=>{const De=(gr(s,ae,{_f:{}})._f||{}).ref,Ve=gr(r.errors,ae)||{},{ref:me,message:Fe,type:Re,...Be}=Ve;cn(r.errors,ae,{...Be,...ve,ref:De}),h.state.next({name:ae,errors:r.errors,isValid:!1}),we&&we.shouldFocus&&De&&De.focus&&De.focus()},V=(ae,ve)=>ic(ae)?h.state.subscribe({next:we=>ae(k(void 0,ve),we)}):k(ae,ve,!0),L=ae=>h.state.subscribe({next:ve=>{Sre(ae.name,ve.name,ae.exact)&&jre(ve,ae.formState||u,He,ae.reRenderRoot)&&ae.callback({values:{...i},...r,...ve})}}).unsubscribe,K=ae=>(o.mount=!0,A={...A,...ae.formState},L({...ae,formState:A})),fe=(ae,ve={})=>{for(const we of ae?fx(ae):l.mount)l.mount.delete(we),l.array.delete(we),ve.keepValue||(va(s,we),va(i,we)),!ve.keepError&&va(r.errors,we),!ve.keepDirty&&va(r.dirtyFields,we),!ve.keepTouched&&va(r.touchedFields,we),!ve.keepIsValidating&&va(r.validatingFields,we),!e.shouldUnregister&&!ve.keepDefaultValue&&va(n,we);h.state.next({values:yi(i)}),h.state.next({...r,...ve.keepDirty?{isDirty:B()}:{}}),!ve.keepIsValid&&m()},ee=({disabled:ae,name:ve})=>{(Lc(ae)&&o.mount||ae||l.disabled.has(ve))&&(ae?l.disabled.add(ve):l.disabled.delete(ve))},de=(ae,ve={})=>{let we=gr(s,ae);const De=Lc(ve.disabled)||Lc(e.disabled);return cn(s,ae,{...we||{},_f:{...we&&we._f?we._f:{ref:{name:ae}},name:ae,mount:!0,...ve}}),l.mount.add(ae),we?ee({disabled:Lc(ve.disabled)?ve.disabled:e.disabled,name:ae}):E(ae,!0,ve.value),{...De?{disabled:ve.disabled||e.disabled}:{},...e.progressive?{required:!!ve.required,min:yg(ve.min),max:yg(ve.max),minLength:yg(ve.minLength),maxLength:yg(ve.maxLength),pattern:yg(ve.pattern)}:{},name:ae,onChange:Q,onBlur:Q,ref:Ve=>{if(Ve){de(ae,ve),we=gr(s,ae);const me=ma(Ve.value)&&Ve.querySelectorAll&&Ve.querySelectorAll("input,select,textarea")[0]||Ve,Fe=yre(me),Re=we._f.refs||[];if(Fe?Re.find(Be=>Be===me):me===we._f.ref)return;cn(s,ae,{_f:{...we._f,...Fe?{refs:[...Re.filter(G5),me,...Array.isArray(gr(n,ae))?[{}]:[]],ref:{type:me.type,name:ae}}:{ref:me}}}),E(ae,!1,void 0,me)}else we=gr(s,ae,{}),we._f&&(we._f.mount=!1),(e.shouldUnregister||ve.shouldUnregister)&&!(hre(l.array,ae)&&o.action)&&l.unMount.add(ae)}}},ue=()=>e.shouldFocusError&&mx(s,re,l.mount),Ie=ae=>{Lc(ae)&&(h.state.next({disabled:ae}),mx(s,(ve,we)=>{const De=gr(s,we);De&&(ve.disabled=De._f.disabled||ae,Array.isArray(De._f.refs)&&De._f.refs.forEach(Ve=>{Ve.disabled=De._f.disabled||ae}))},0,!1))},Y=(ae,ve)=>async we=>{let De;we&&(we.preventDefault&&we.preventDefault(),we.persist&&we.persist());let Ve=yi(i);if(h.state.next({isSubmitting:!0}),e.resolver){const{errors:me,values:Fe}=await C();r.errors=me,Ve=Fe}else await S(s);if(l.disabled.size)for(const me of l.disabled)cn(Ve,me,void 0);if(va(r.errors,"root"),uo(r.errors)){h.state.next({errors:{}});try{await ae(Ve,we)}catch(me){De=me}}else ve&&await ve({...r.errors},we),ue(),setTimeout(ue);if(h.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:uo(r.errors)&&!De,submitCount:r.submitCount+1,errors:r.errors}),De)throw De},H=(ae,ve={})=>{gr(s,ae)&&(ma(ve.defaultValue)?W(ae,yi(gr(n,ae))):(W(ae,ve.defaultValue),cn(n,ae,yi(ve.defaultValue))),ve.keepTouched||va(r.touchedFields,ae),ve.keepDirty||(va(r.dirtyFields,ae),r.isDirty=ve.defaultValue?B(ae,yi(gr(n,ae))):B()),ve.keepError||(va(r.errors,ae),u.isValid&&m()),h.state.next({...r}))},je=(ae,ve={})=>{const we=ae?yi(ae):n,De=yi(we),Ve=uo(ae),me=Ve?n:De;if(ve.keepDefaultValues||(n=we),!ve.keepValues){if(ve.keepDirtyValues){const Fe=new Set([...l.mount,...Object.keys(xg(n,i))]);for(const Re of Array.from(Fe))gr(r.dirtyFields,Re)?cn(me,Re,gr(i,Re)):W(Re,gr(me,Re))}else{if(r_&&ma(ae))for(const Fe of l.mount){const Re=gr(s,Fe);if(Re&&Re._f){const Be=Array.isArray(Re._f.refs)?Re._f.refs[0]:Re._f.ref;if(Hw(Be)){const X=Be.closest("form");if(X){X.reset();break}}}}for(const Fe of l.mount)W(Fe,gr(me,Fe))}i=yi(me),h.array.next({values:{...me}}),h.state.next({values:{...me}})}l={mount:ve.keepDirtyValues?l.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},o.mount=!u.isValid||!!ve.keepIsValid||!!ve.keepDirtyValues,o.watch=!!e.shouldUnregister,h.state.next({submitCount:ve.keepSubmitCount?r.submitCount:0,isDirty:Ve?!1:ve.keepDirty?r.isDirty:!!(ve.keepDefaultValues&&!dA(ae,n)),isSubmitted:ve.keepIsSubmitted?r.isSubmitted:!1,dirtyFields:Ve?{}:ve.keepDirtyValues?ve.keepDefaultValues&&i?xg(n,i):r.dirtyFields:ve.keepDefaultValues&&ae?xg(n,ae):ve.keepDirty?r.dirtyFields:{},touchedFields:ve.keepTouched?r.touchedFields:{},errors:ve.keepErrors?r.errors:{},isSubmitSuccessful:ve.keepIsSubmitSuccessful?r.isSubmitSuccessful:!1,isSubmitting:!1})},Ce=(ae,ve)=>je(ic(ae)?ae(i):ae,ve),oe=(ae,ve={})=>{const we=gr(s,ae),De=we&&we._f;if(De){const Ve=De.refs?De.refs[0]:De.ref;Ve.focus&&(Ve.focus(),ve.shouldSelect&&ic(Ve.select)&&Ve.select())}},He=ae=>{r={...r,...ae}},le={control:{register:de,unregister:fe,getFieldState:he,handleSubmit:Y,setError:U,_subscribe:L,_runSchema:C,_focusError:ue,_getWatch:k,_getDirty:B,_setValid:m,_setFieldArray:y,_setDisabledField:ee,_setErrors:x,_getFieldArray:D,_reset:je,_resetDefaultValues:()=>ic(e.defaultValues)&&e.defaultValues().then(ae=>{Ce(ae,e.resetOptions),h.state.next({isLoading:!1})}),_removeUnmounted:F,_disableForm:Ie,_subjects:h,_proxyFormState:u,get _fields(){return s},get _formValues(){return i},get _state(){return o},set _state(ae){o=ae},get _defaultValues(){return n},get _names(){return l},set _names(ae){l=ae},get _formState(){return r},get _options(){return e},set _options(ae){e={...e,...ae}}},subscribe:K,trigger:G,register:de,handleSubmit:Y,watch:V,setValue:W,getValues:Ae,reset:Ce,resetField:H,clearErrors:I,unregister:fe,setError:U,setFocus:oe,getFieldState:he};return{...le,formControl:le}}function nn(t={}){const e=bi.useRef(void 0),r=bi.useRef(void 0),[s,n]=bi.useState({isDirty:!1,isValidating:!1,isLoading:ic(t.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:t.errors||{},disabled:t.disabled||!1,isReady:!1,defaultValues:ic(t.defaultValues)?void 0:t.defaultValues});e.current||(e.current={...t.formControl?t.formControl:kre(t),formState:s},t.formControl&&t.defaultValues&&!ic(t.defaultValues)&&t.formControl.reset(t.defaultValues,t.resetOptions));const i=e.current.control;return i._options=t,pre(()=>{const o=i._subscribe({formState:i._proxyFormState,callback:()=>n({...i._formState}),reRenderRoot:!0});return n(l=>({...l,isReady:!0})),i._formState.isReady=!0,o},[i]),bi.useEffect(()=>i._disableForm(t.disabled),[i,t.disabled]),bi.useEffect(()=>{t.mode&&(i._options.mode=t.mode),t.reValidateMode&&(i._options.reValidateMode=t.reValidateMode)},[i,t.mode,t.reValidateMode]),bi.useEffect(()=>{t.errors&&(i._setErrors(t.errors),i._focusError())},[i,t.errors]),bi.useEffect(()=>{t.shouldUnregister&&i._subjects.state.next({values:i._getWatch()})},[i,t.shouldUnregister]),bi.useEffect(()=>{if(i._proxyFormState.isDirty){const o=i._getDirty();o!==s.isDirty&&i._subjects.state.next({isDirty:o})}},[i,s.isDirty]),bi.useEffect(()=>{t.values&&!dA(t.values,r.current)?(i._reset(t.values,i._options.resetOptions),r.current=t.values,n(o=>({...o}))):i._resetDefaultValues()},[i,t.values]),bi.useEffect(()=>{i._state.mount||(i._setValid(),i._state.mount=!0),i._state.watch&&(i._state.watch=!1,i._subjects.state.next({...i._formState})),i._removeUnmounted()}),e.current.formState=mre(s,i),e.current}class wM{static async loginAdmin(e,r){try{const n=(await ij(yn,e,r)).user;return n!=null&&n.email?await this.verifySuperAdmin(n.email)?(await this.logAdminActivity(n.uid,"login",{email:n.email,timestamp:new Date().toISOString()}),{success:!0,user:{uid:n.uid,email:n.email,role:"super_admin"}}):(await yn.signOut(),{success:!1,error:"Insufficient privileges"}):{success:!1,error:"Authentication failed"}}catch(s){return{success:!1,error:Xt(s)}}}static async verifySuperAdmin(e){var r;try{const s=await Kr(Rt(st,"superAdmins",e));return s.exists()&&((r=s.data())==null?void 0:r.active)===!0}catch{return!1}}static async getAllRestaurants(){var e,r;try{const s=Jt(st,"restaurants"),n=await ur(s),i=[];for(const o of n.docs){const l=o.data();let c="Unknown";if(l.ownerId)try{const d=await Kr(Rt(st,"users",l.ownerId));if(d.exists()){const u=d.data();c=u.name||u.email||"Unknown"}}catch{}i.push({id:o.id,name:l.name||"Unnamed Restaurant",slug:l.slug||"",businessType:l.businessType||"restaurant",status:l.status||"inactive",ownerId:l.ownerId||"",ownerName:c,createdAt:((e=l.createdAt)==null?void 0:e.toDate())||new Date,lastActivity:((r=l.lastActivity)==null?void 0:r.toDate())||new Date,settings:l.settings||{},stats:{totalOrders:0,totalRevenue:0,activeUsers:0}})}return i.sort((o,l)=>l.createdAt.getTime()-o.createdAt.getTime()),i}catch(s){throw new Error(Xt(s))}}static async updateRestaurantStatus(e,r){try{const s=Rt(st,"restaurants",e);await Xr(s,{status:r,lastActivity:Ro()}),yn.currentUser&&await this.logAdminActivity(yn.currentUser.uid,"restaurant_status_update",{restaurantId:e,newStatus:r,timestamp:new Date().toISOString()})}catch(s){throw new Error(Xt(s))}}static async deleteRestaurant(e){try{const r=Rt(st,"restaurants",e);await Xr(r,{status:"deleted",deletedAt:Ro(),lastActivity:Ro()}),yn.currentUser&&await this.logAdminActivity(yn.currentUser.uid,"restaurant_delete",{restaurantId:e,timestamp:new Date().toISOString()})}catch(r){throw new Error(Xt(r))}}static async getDashboardStats(){try{const e=await this.getAllRestaurants();return{totalRestaurants:e.length,activeRestaurants:e.filter(s=>s.status==="active").length,inactiveRestaurants:e.filter(s=>s.status==="inactive").length,businessTypes:{restaurants:e.filter(s=>s.businessType==="restaurant").length,cafes:e.filter(s=>s.businessType==="cafe").length,bars:e.filter(s=>s.businessType==="bar").length},totalRevenue:e.reduce((s,n)=>{var i;return s+(((i=n.stats)==null?void 0:i.totalRevenue)||0)},0),totalOrders:e.reduce((s,n)=>{var i;return s+(((i=n.stats)==null?void 0:i.totalOrders)||0)},0)}}catch(e){throw new Error(Xt(e))}}static async logAdminActivity(e,r,s){try{await Bi(Jt(st,"adminLogs"),{adminId:e,action:r,details:s,timestamp:Ro(),ipAddress:"unknown"})}catch{}}static async logoutAdmin(){try{yn.currentUser&&await this.logAdminActivity(yn.currentUser.uid,"logout",{timestamp:new Date().toISOString()}),await yn.signOut()}catch(e){throw new Error(Xt(e))}}}function Bre(){const t=Li(),[e,r]=R.useState(!1),[s,n]=R.useState(!1),{register:i,handleSubmit:o,formState:{errors:l,isValid:c}}=nn({mode:"onChange"}),d=async u=>{try{n(!0);const A=await wM.loginAdmin(u.email,u.password);A.success?(Z.success("Welcome back, Super Admin!"),t("/admin/dashboard")):Z.error(A.error||"Invalid admin credentials")}catch(A){console.error("Admin login error:",A),Z.error("Login failed. Please try again.")}finally{n(!1)}};return a.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 flex items-center justify-center p-4",children:[a.jsx("div",{className:"absolute inset-0 bg-grid-white/[0.02] bg-[size:60px_60px]"}),a.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-500/10 via-purple-500/10 to-cyan-500/10"}),a.jsxs("div",{className:"relative w-full max-w-md",children:[a.jsxs("div",{className:"text-center mb-8",children:[a.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-r from-blue-600 to-purple-600 rounded-2xl mb-6 shadow-lg",children:a.jsx(Co,{className:"w-8 h-8 text-white"})}),a.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Admin Portal"}),a.jsx("p",{className:"text-slate-400",children:"TenVerse POS Management System"})]}),a.jsxs("div",{className:"bg-white/10 backdrop-blur-md rounded-2xl border border-white/20 p-8 shadow-2xl",children:[a.jsxs("form",{onSubmit:o(d),className:"space-y-6",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"block text-sm font-medium text-white",children:"Admin Email"}),a.jsxs("div",{className:"relative",children:[a.jsx(Hs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-slate-400"}),a.jsx("input",{...i("email",{required:"Email is required",pattern:{value:/^[^\s@]+@[^\s@]+\.[^\s@]+$/,message:"Please enter a valid email address"}}),type:"email",className:`w-full pl-10 pr-4 py-3 bg-white/10 border border-white/20 rounded-xl text-white placeholder-slate-400 focus:border-blue-400 focus:ring-2 focus:ring-blue-400/20 transition-all ${l.email?"border-red-400":""}`,placeholder:"admin@tenversepos.com"})]}),l.email&&a.jsx("p",{className:"text-red-400 text-sm",children:l.email.message})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"block text-sm font-medium text-white",children:"Password"}),a.jsxs("div",{className:"relative",children:[a.jsx(lM,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-slate-400"}),a.jsx("input",{...i("password",{required:"Password is required"}),type:e?"text":"password",className:`w-full pl-10 pr-12 py-3 bg-white/10 border border-white/20 rounded-xl text-white placeholder-slate-400 focus:border-blue-400 focus:ring-2 focus:ring-blue-400/20 transition-all ${l.password?"border-red-400":""}`,placeholder:"Enter admin password"}),a.jsx("button",{type:"button",onClick:()=>r(!e),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-slate-400 hover:text-white transition-colors",children:e?a.jsx(Dl,{className:"w-5 h-5"}):a.jsx(Xs,{className:"w-5 h-5"})})]}),l.password&&a.jsx("p",{className:"text-red-400 text-sm",children:l.password.message})]}),a.jsx("button",{type:"submit",disabled:!c||s,className:"w-full bg-gradient-to-r from-blue-600 to-purple-600 text-white py-3 px-4 rounded-xl font-semibold hover:from-blue-700 hover:to-purple-700 focus:ring-2 focus:ring-blue-400/20 disabled:opacity-50 disabled:cursor-not-allowed transition-all transform hover:scale-105 shadow-lg",children:s?a.jsxs(a.Fragment,{children:[a.jsx(Gi,{className:"w-5 h-5 mr-2 animate-spin inline"}),"Signing In..."]}):a.jsxs(a.Fragment,{children:[a.jsx(Co,{className:"w-5 h-5 mr-2 inline"}),"Sign In as Admin"]})})]}),a.jsx("div",{className:"mt-6 p-4 bg-blue-500/10 border border-blue-400/20 rounded-xl",children:a.jsxs("div",{className:"flex items-start space-x-3",children:[a.jsx(Uw,{className:"w-5 h-5 text-blue-400 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-blue-400 font-medium text-sm",children:"Admin Access"}),a.jsx("p",{className:"text-slate-300 text-xs mt-1",children:"Only authorized administrators can access this portal to manage restaurant POS systems."})]})]})})]}),a.jsx("div",{className:"text-center mt-8",children:a.jsx("p",{className:"text-slate-500 text-sm",children:" 2024 TenVerse POS - Enterprise Management System"})})]})]})}function Fre(){const[t,e]=R.useState([]),[r,s]=R.useState(!0),[n,i]=R.useState(!1),[o,l]=R.useState(""),[c,d]=R.useState("all"),[u,A]=R.useState(null),{register:h,handleSubmit:f,reset:p,formState:{errors:m,isValid:g}}=nn({mode:"onChange"});R.useEffect(()=>{y()},[]);const y=async()=>{try{console.log(" Loading restaurants for admin dashboard...");const w=await si.getAllRestaurantsForAdmin();console.log(" Load restaurants result:",w),w.success&&w.data?(console.log(" Successfully loaded restaurants:",w.data.length),e(w.data)):(console.error(" Failed to load restaurants:",w.error),Z.error(w.error||"Failed to load restaurants"))}catch(w){console.error(" Exception loading restaurants:",w),Z.error("Failed to load restaurants")}finally{s(!1)}},v=async w=>{try{const S=await si.createRestaurantByAdmin(w);S.success&&S.data?(Z.success("Restaurant created successfully!"),A(S.data),i(!1),p(),y()):Z.error(S.error||"Failed to create restaurant")}catch{Z.error("Failed to create restaurant")}},x=async w=>{try{const S=await si.toggleRestaurantStatus(w.id,!w.isActive);S.success?(Z.success(`Restaurant ${w.isActive?"deactivated":"activated"}`),y()):Z.error(S.error||"Failed to update restaurant")}catch{Z.error("Failed to update restaurant")}},E=async()=>{try{await wM.logoutAdmin(),window.location.href="/admin/login"}catch{Z.error("Logout failed")}},T=w=>{navigator.clipboard.writeText(w),Z.success("Copied to clipboard!")},j=t.filter(w=>{const S=w.name.toLowerCase().includes(o.toLowerCase())||w.slug.toLowerCase().includes(o.toLowerCase()),F=c==="all"||w.businessType===c;return S&&F}),C={total:t.length,active:t.filter(w=>w.isActive).length,inactive:t.filter(w=>!w.isActive).length,restaurants:t.filter(w=>w.businessType==="restaurant").length,cafes:t.filter(w=>w.businessType==="cafe").length,bars:t.filter(w=>w.businessType==="bar").length};return a.jsxs("div",{className:"min-h-screen bg-gray-50",children:[a.jsx("header",{className:"bg-white border-b border-gray-200 shadow-sm",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"flex items-center justify-between h-16",children:[a.jsx("div",{className:"flex items-center space-x-4",children:a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-600 to-purple-600 rounded-xl flex items-center justify-center",children:a.jsx(Co,{className:"w-6 h-6 text-white"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Admin Dashboard"}),a.jsx("p",{className:"text-sm text-gray-500",children:"TenVerse POS Management"})]})]})}),a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsxs("button",{onClick:()=>i(!0),className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white px-4 py-2 rounded-lg font-medium hover:from-blue-700 hover:to-purple-700 transition-all transform hover:scale-105 shadow-lg",children:[a.jsx(zr,{className:"w-4 h-4 mr-2 inline"}),"New Restaurant"]}),a.jsx("button",{onClick:E,className:"text-gray-600 hover:text-gray-900 p-2 rounded-lg hover:bg-gray-100 transition-colors",children:a.jsx(Rj,{className:"w-5 h-5"})})]})]})})}),a.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[a.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Restaurants"}),a.jsx("p",{className:"text-3xl font-bold text-gray-900",children:C.total})]}),a.jsx(Uw,{className:"w-8 h-8 text-blue-600"})]})}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Active"}),a.jsx("p",{className:"text-3xl font-bold text-green-600",children:C.active})]}),a.jsx(Nr,{className:"w-8 h-8 text-green-600"})]})}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Inactive"}),a.jsx("p",{className:"text-3xl font-bold text-red-600",children:C.inactive})]}),a.jsx(oi,{className:"w-8 h-8 text-red-600"})]})}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Business Types"}),a.jsxs("p",{className:"text-xl font-bold text-gray-900",children:[C.restaurants,"R  ",C.cafes,"C  ",C.bars,"B"]})]}),a.jsx(Is,{className:"w-8 h-8 text-purple-600"})]})})]}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6",children:a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[a.jsxs("div",{className:"relative flex-1",children:[a.jsx(sn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),a.jsx("input",{type:"text",placeholder:"Search restaurants...",value:o,onChange:w=>l(w.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("select",{value:c,onChange:w=>d(w.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"all",children:"All Types"}),a.jsx("option",{value:"restaurant",children:"Restaurants"}),a.jsx("option",{value:"cafe",children:"Cafs"}),a.jsx("option",{value:"bar",children:"Bars"})]})]})}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:r?a.jsxs("div",{className:"p-8 text-center",children:[a.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),a.jsx("p",{className:"mt-2 text-gray-600",children:"Loading restaurants..."})]}):j.length===0?a.jsxs("div",{className:"p-8 text-center",children:[a.jsx(Uw,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No restaurants found"}),a.jsx("p",{className:"text-gray-600",children:o||c!=="all"?"Try adjusting your search or filter criteria.":"Create your first restaurant to get started."})]}):a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Restaurant"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:j.map(w=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-6 py-4",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center mr-3 ${w.businessType==="restaurant"?"bg-green-100":w.businessType==="cafe"?"bg-yellow-100":"bg-purple-100"}`,children:a.jsx(Zc,{className:`w-5 h-5 ${w.businessType==="restaurant"?"text-green-600":w.businessType==="cafe"?"text-yellow-600":"text-purple-600"}`})}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-medium text-gray-900",children:w.name}),a.jsxs("div",{className:"text-sm text-gray-500",children:["/",w.slug]})]})]})}),a.jsx("td",{className:"px-6 py-4",children:a.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${w.businessType==="restaurant"?"bg-green-100 text-green-800":w.businessType==="cafe"?"bg-yellow-100 text-yellow-800":"bg-purple-100 text-purple-800"}`,children:Fj(w.businessType)})}),a.jsx("td",{className:"px-6 py-4",children:a.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${w.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:w.isActive?"Active":"Inactive"})}),a.jsx("td",{className:"px-6 py-4 text-sm text-gray-500",children:hs(w.createdAt)}),a.jsx("td",{className:"px-6 py-4",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("button",{onClick:()=>window.open(`/${w.slug}`,"_blank"),className:"text-blue-600 hover:text-blue-900 p-1 rounded hover:bg-blue-50",title:"View Restaurant",children:a.jsx(D0,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>T(`${window.location.origin}/${w.slug}`),className:"text-gray-600 hover:text-gray-900 p-1 rounded hover:bg-gray-50",title:"Copy URL",children:a.jsx(po,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>x(w),className:`p-1 rounded hover:bg-gray-50 ${w.isActive?"text-red-600 hover:text-red-900":"text-green-600 hover:text-green-900"}`,title:w.isActive?"Deactivate":"Activate",children:w.isActive?a.jsx(ere,{className:"w-4 h-4"}):a.jsx(tre,{className:"w-4 h-4"})})]})})]},w.id))})]})})})]}),n&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"p-6 border-b border-gray-200",children:[a.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Create New Restaurant"}),a.jsx("p",{className:"text-gray-600",children:"Set up a new POS system for a restaurant"})]}),a.jsxs("form",{onSubmit:f(v),className:"p-6 space-y-6",children:[a.jsxs("div",{className:"space-y-3",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Business Type"}),a.jsx("div",{className:"grid grid-cols-3 gap-3",children:["restaurant","cafe","bar"].map(w=>a.jsxs("label",{className:"relative",children:[a.jsx("input",{...h("businessType",{required:!0}),type:"radio",value:w,className:"sr-only"}),a.jsx("div",{className:"border-2 border-gray-200 rounded-lg p-3 text-center cursor-pointer hover:border-blue-300 peer-checked:border-blue-500 peer-checked:bg-blue-50",children:a.jsx("div",{className:"text-sm font-medium",children:Fj(w)})})]},w))})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Restaurant Name"}),a.jsx("input",{...h("name",{required:"Name is required"}),type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Pizza Palace"}),m.name&&a.jsx("p",{className:"text-red-500 text-sm mt-1",children:m.name.message})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Owner Name"}),a.jsx("input",{...h("ownerName",{required:"Owner name is required"}),type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"John Doe"}),m.ownerName&&a.jsx("p",{className:"text-red-500 text-sm mt-1",children:m.ownerName.message})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Owner Email"}),a.jsx("input",{...h("ownerEmail",{required:"Email is required",pattern:{value:/^\S+@\S+$/i,message:"Invalid email"}}),type:"email",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"owner@restaurant.com"}),m.ownerEmail&&a.jsx("p",{className:"text-red-500 text-sm mt-1",children:m.ownerEmail.message})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),a.jsx("input",{...h("phone"),type:"tel",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"+1 (555) 123-4567"})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900 border-b border-gray-200 pb-2",children:"Login Credentials"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Owner Password"}),a.jsx("input",{...h("ownerPassword",{required:"Password is required",minLength:{value:6,message:"Password must be at least 6 characters"}}),type:"password",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter secure password"}),m.ownerPassword&&a.jsx("p",{className:"text-red-500 text-sm mt-1",children:m.ownerPassword.message})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"4-Digit PIN"}),a.jsx("input",{...h("ownerPin",{required:"PIN is required",pattern:{value:/^\d{4}$/,message:"PIN must be exactly 4 digits"}}),type:"text",inputMode:"numeric",maxLength:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-center text-lg tracking-widest",placeholder:"1234"}),m.ownerPin&&a.jsx("p",{className:"text-red-500 text-sm mt-1",children:m.ownerPin.message})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address"}),a.jsx("input",{...h("address"),type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"123 Main St, City, State 12345"})]}),a.jsxs("div",{className:"flex justify-end space-x-3 pt-6 border-t border-gray-200",children:[a.jsx("button",{type:"button",onClick:()=>{i(!1),p()},className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Cancel"}),a.jsx("button",{type:"submit",disabled:!g,className:"px-6 py-2 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg hover:from-blue-700 hover:to-purple-700 disabled:opacity-50 transition-all",children:"Create Restaurant"})]})]})]})}),u&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsx("div",{className:"bg-white rounded-2xl max-w-md w-full",children:a.jsxs("div",{className:"p-6",children:[a.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Restaurant Created Successfully! "}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[a.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Login Credentials"}),a.jsxs("div",{className:"space-y-2 text-sm",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"URL:"}),a.jsxs("button",{onClick:()=>T(u.restaurantUrl),className:"text-blue-600 hover:text-blue-800 flex items-center",children:[a.jsx(po,{className:"w-3 h-3 mr-1"}),"Copy"]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Email:"}),a.jsxs("button",{onClick:()=>T(u.ownerEmail),className:"text-blue-600 hover:text-blue-800 flex items-center",children:[a.jsx(po,{className:"w-3 h-3 mr-1"}),"Copy"]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Password:"}),a.jsxs("button",{onClick:()=>T(u.ownerPassword),className:"text-blue-600 hover:text-blue-800 flex items-center",children:[a.jsx(po,{className:"w-3 h-3 mr-1"}),"Copy"]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"PIN:"}),a.jsxs("button",{onClick:()=>T(u.ownerPin),className:"text-blue-600 hover:text-blue-800 flex items-center",children:[a.jsx(po,{className:"w-3 h-3 mr-1"}),"Copy"]})]})]})]}),a.jsx("button",{onClick:()=>T(u.loginInstructions),className:"w-full bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Copy All Instructions"})]}),a.jsx("button",{onClick:()=>A(null),className:"w-full mt-4 px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Close"})]})})})]})}function NM(){const{user:t}=ia(),{restaurant:e}=js(),[r,s]=R.useState(null),[n,i]=R.useState(!1);return R.useEffect(()=>{(async()=>{var l;if(!(!t||!e||t.role==="owner")&&(t.role==="manager"||t.role==="staff")){i(!0);try{console.log(" Fetching employee permissions for user:",t.email);const c=await qn.getEmployees(e.id);if(c.success&&c.data){const d=c.data.find(u=>u.email===t.email);d?(console.log(" Found employee data with permissions:",((l=d.permissions)==null?void 0:l.length)||0,"permissions"),s(d)):console.warn(" Employee not found in restaurant employee list:",t.email)}}catch(c){console.error(" Failed to fetch employee data:",c)}finally{i(!1)}}})()},[t,e]),R.useMemo(()=>{if(!t)return{hasPermission:()=>!1,canAccess:()=>!1,isOwner:!1,isManager:!1,isStaff:!1,isEmployee:!1,accessibleModules:[]};const o=t.role==="owner",l=t.role==="manager",c=t.role==="staff",d=l||c;if(o)return{hasPermission:()=>!0,canAccess:()=>!0,isOwner:!0,isManager:!1,isStaff:!1,isEmployee:!1,accessibleModules:(nc==null?void 0:nc.map(f=>f.id))||[]};const u=f=>{if(o)return!0;if(r&&r.permissions){const p=r.permissions.find(g=>g.module===f),m=p?p.access:!1;return m?console.log(` Permission granted for ${f}:`,m):console.log(` Permission denied for ${f}`),m}return n?(console.log(` Still loading employee data, denying access to ${f}`),!1):(console.warn(` No employee data found, using basic role permissions for ${f}`),l?["orders","take_order","tables","billing","dashboard","menu","inventory","customers","reports"].includes(f):c?["orders","take_order","tables","billing","dashboard"].includes(f):!1)};return{hasPermission:u,canAccess:f=>u(f),isOwner:o,isManager:l,isStaff:c,isEmployee:d,accessibleModules:(()=>{if(o)return(nc==null?void 0:nc.map(f=>f.id))||[];if(r&&r.permissions){const f=r.permissions.filter(p=>p.access).map(p=>p.module);return console.log(" Employee accessible modules:",f),f}return l?["orders","take_order","tables","billing","dashboard","menu","inventory","customers","reports"]:c?["orders","take_order","tables","billing","dashboard"]:[]})()}},[t,r,n])}function Pre(){const{user:t}=ia();if(!t)return"Guest";switch(t.role){case"owner":return"Owner";case"manager":return"Manager";case"staff":return"Staff";default:return"User"}}const Dre="modulepreload",Rre=function(t){return"/"+t},pB={},Pn=function(e,r,s){let n=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));n=Promise.allSettled(r.map(c=>{if(c=Rre(c),c in pB)return;pB[c]=!0;const d=c.endsWith(".css"),u=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${u}`))return;const A=document.createElement("link");if(A.rel=d?"stylesheet":Dre,d||(A.as="script"),A.crossOrigin="",A.href=c,l&&A.setAttribute("nonce",l),document.head.appendChild(A),d)return new Promise((h,f)=>{A.addEventListener("load",h),A.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return n.then(o=>{for(const l of o||[])l.status==="rejected"&&i(l.reason);return e().catch(i)})};class co{static getOrders(e){try{const r=`${this.ORDERS_CACHE_KEY}_${e}`,s=`${this.CACHE_EXPIRY_KEY}_${e}`,n=localStorage.getItem(r),i=localStorage.getItem(s);return n&&i&&Date.now()<parseInt(i)?(console.log(" Orders cache hit for restaurant:",e),JSON.parse(n).map(this.parseOrderDates)):[]}catch(r){return console.error("Failed to get orders from cache:",r),[]}}static setOrders(e,r){try{const s=`${this.ORDERS_CACHE_KEY}_${e}`,n=`${this.CACHE_EXPIRY_KEY}_${e}`;localStorage.setItem(s,JSON.stringify(r)),localStorage.setItem(n,(Date.now()+this.CACHE_DURATION).toString()),console.log(" Orders cached for restaurant:",e,"Count:",r.length)}catch(s){console.error("Failed to cache orders:",s)}}static addOrder(e,r){const s=this.getOrders(e);s.unshift(r),this.setOrders(e,s)}static updateOrder(e,r){const s=this.getOrders(e),n=s.findIndex(i=>i.id===r.id);n!==-1&&(s[n]=r,this.setOrders(e,s))}static clearCache(e){const r=`${this.ORDERS_CACHE_KEY}_${e}`,s=`${this.CACHE_EXPIRY_KEY}_${e}`;localStorage.removeItem(r),localStorage.removeItem(s)}static isCacheFresh(e){const r=`${this.CACHE_EXPIRY_KEY}_${e}`,s=localStorage.getItem(r);return s?Date.now()<parseInt(s):!1}static parseOrderDates(e){return{...e,createdAt:new Date(e.createdAt),updatedAt:new Date(e.updatedAt)}}}Or(co,"ORDERS_CACHE_KEY","tenverse_pos_orders"),Or(co,"CACHE_EXPIRY_KEY","tenverse_pos_orders_expiry"),Or(co,"CACHE_DURATION",30*60*1e3);class As{static getCartItems(e,r){try{const s=`${this.CART_KEY}_${e}_${r||"general"}`,n=localStorage.getItem(s);return n?JSON.parse(n):[]}catch(s){return console.error("Failed to get cart items:",s),[]}}static addToCart(e,r,s){const n=`${this.CART_KEY}_${e}_${s||"general"}`,i=this.getCartItems(e,s),o=i.findIndex(l=>l.menuItemId===r.menuItemId&&JSON.stringify(l.customizations)===JSON.stringify(r.customizations)&&JSON.stringify(l.variants)===JSON.stringify(r.variants));return o!==-1?(i[o].quantity+=r.quantity,i[o].total=i[o].quantity*i[o].price):i.push(r),localStorage.setItem(n,JSON.stringify(i)),i}static updateCartItemQuantity(e,r,s,n){const i=`${this.CART_KEY}_${e}_${n||"general"}`,o=this.getCartItems(e,n),l=o.findIndex(c=>c.menuItemId===r);return l!==-1&&(s<=0?o.splice(l,1):(o[l].quantity=s,o[l].total=s*o[l].price)),localStorage.setItem(i,JSON.stringify(o)),o}static removeFromCart(e,r,s){return this.updateCartItemQuantity(e,r,0,s)}static clearCart(e,r){const s=`${this.CART_KEY}_${e}_${r||"general"}`;localStorage.removeItem(s)}static getCartTotal(e,r){const s=this.getCartItems(e,r),n=s.reduce((o,l)=>o+l.total,0),i=s.reduce((o,l)=>o+l.quantity,0);return{subtotal:n,items:i}}static convertCartToOrderItems(e){return e.map(r=>{const s={id:An(),menuItemId:r.menuItemId,name:r.name,price:r.price,quantity:r.quantity,total:r.total};return r.customizations&&r.customizations.length>0&&(s.customizations=r.customizations),r.variants&&r.variants.length>0&&(s.variants=r.variants),r.notes&&r.notes.trim()!==""&&(s.notes=r.notes.trim()),s})}}Or(As,"CART_KEY","tenverse_pos_cart");class Ur{static async getOrdersForRestaurant(e,r=50){try{const s=co.getOrders(e);if(s.length>0&&co.isCacheFresh(e))return{success:!0,data:s.slice(0,r)};console.log(" Fetching orders from Firebase for restaurant:",e);const n=Zt(Jt(st,"restaurants",e,this.ORDERS_COLLECTION),On("createdAt","desc"),Wi(r)),o=(await ur(n)).docs.map(l=>this.convertFirestoreOrder(l.data(),l.id));return co.setOrders(e,o),console.log(" Orders loaded and cached:",o.length),{success:!0,data:o}}catch(s){return console.error(" Failed to get orders:",s),{success:!1,error:Xt(s)}}}static async createOrder(e,r,s,n,i=8.5,o){try{if(n.length===0)return{success:!1,error:"Cart is empty"};const l=An(),c=jte(e),d=As.convertCartToOrderItems(n),u=d.reduce((v,x)=>v+x.total,0),A=u*i/100,h=u+A,f=r==="takeaway-order"?"takeaway":r==="delivery-order"?"delivery":"dine_in",p={id:l,restaurantId:e,orderNumber:c,tableId:f==="takeaway"?void 0:r,type:f,status:"placed",items:d,subtotal:u,tax:A,discount:0,total:h,paymentStatus:"pending",notes:o,staffId:s,createdAt:new Date,updatedAt:new Date},m=Rt(st,"restaurants",e,this.ORDERS_COLLECTION,l),g={id:l,restaurantId:e,orderNumber:c,type:f,status:"placed",items:d,subtotal:u,tax:A,discount:0,total:h,paymentStatus:"pending",staffId:s,createdAt:wt.fromDate(p.createdAt),updatedAt:wt.fromDate(p.updatedAt)};f==="dine_in"&&(g.tableId=r),o&&o.trim()!==""&&(g.notes=o.trim()),await LA(m,g),co.addOrder(e,p);const y=f==="takeaway"?"takeaway":r;return As.clearCart(e,y),console.log(" Order created and cached:",p.orderNumber),{success:!0,data:p,message:`Order ${p.orderNumber} placed successfully`}}catch(l){return console.error(" Failed to create order:",l),{success:!1,error:Xt(l)}}}static async updateOrderStatus(e,r,s,n){try{const i=Rt(st,"restaurants",r,this.ORDERS_COLLECTION,e),o={status:s,updatedAt:wt.now(),...n};if(s==="completed"){o.paymentStatus="paid";const u=await Kr(i);if(u.exists()){const A=this.convertFirestoreOrder(u.data(),u.id);try{const h=A.items.map(m=>({menuItemId:m.menuItemId,quantity:m.quantity})),{InventoryService:f}=await Pn(async()=>{const{InventoryService:m}=await Promise.resolve().then(()=>Mme);return{InventoryService:m}},void 0),p=await f.deductInventoryForOrder(e,h,r,"system");p.success||console.warn(" ORDER COMPLETION - Failed to deduct inventory for completed order:",p.error)}catch(h){console.warn(" ORDER COMPLETION - Inventory deduction error for completed order:",h)}}}await Xr(i,o);const l=co.getOrders(r),c=l.findIndex(u=>u.id===e);if(c!==-1){const u={...l[c],status:s,updatedAt:new Date,...n};return s==="completed"&&(u.paymentStatus="paid"),s==="cancelled"?(console.log(` OrderService: Clearing cache after cancelling order ${e}`),co.clearCache(r)):co.updateOrder(r,u),{success:!0,data:u,message:"Order status updated successfully"}}return await this.getOrderById(e,r)}catch(i){return console.error(" Failed to update order status:",i),{success:!1,error:Xt(i)}}}static async getOrderById(e,r){try{const n=co.getOrders(r).find(c=>c.id===e);if(n)return{success:!0,data:n};const i=Rt(st,"restaurants",r,this.ORDERS_COLLECTION,e),o=await Kr(i);return o.exists()?{success:!0,data:this.convertFirestoreOrder(o.data(),o.id)}:{success:!1,error:"Order not found"}}catch(s){return console.error(" Failed to get order by ID:",s),{success:!1,error:Xt(s)}}}static async getOrdersByIds(e,r){try{if(!e||e.length===0)return{success:!0,data:[]};const s=co.getOrders(r),n=[],i=[];e.forEach(o=>{const l=s.find(c=>c.id===o);l?n.push(l):i.push(o)});for(const o of i)try{const l=Rt(st,"restaurants",r,this.ORDERS_COLLECTION,o),c=await Kr(l);if(c.exists()){const d=this.convertFirestoreOrder(c.data(),c.id);n.push(d)}}catch(l){console.warn(`Failed to fetch order ${o}:`,l)}return n.sort((o,l)=>l.createdAt.getTime()-o.createdAt.getTime()),{success:!0,data:n}}catch(s){return console.error(" Failed to get orders by IDs:",s),{success:!1,error:Xt(s)}}}static async getOrdersByTable(e,r){try{const s=Zt(Jt(st,"restaurants",e,this.ORDERS_COLLECTION),Yt("tableId","==",r)),i=(await ur(s)).docs.map(o=>this.convertFirestoreOrder(o.data(),o.id));return i.sort((o,l)=>l.createdAt.getTime()-o.createdAt.getTime()),{success:!0,data:i}}catch(s){return console.error(" Failed to get orders by table:",s),{success:!1,error:Xt(s)}}}static async getActiveOrders(e){try{const r=Zt(Jt(st,"restaurants",e,this.ORDERS_COLLECTION),Yt("status","in",["placed","confirmed","preparing","ready"])),n=(await ur(r)).docs.map(i=>this.convertFirestoreOrder(i.data(),i.id));return n.sort((i,o)=>i.createdAt.getTime()-o.createdAt.getTime()),{success:!0,data:n}}catch(r){return console.error(" Failed to get active orders:",r),{success:!1,error:Xt(r)}}}static subscribeToOrders(e,r,s=50){const n=Zt(Jt(st,"restaurants",e,this.ORDERS_COLLECTION),On("createdAt","desc"),Wi(s));return Of(n,i=>{const o=i.docs.map(l=>this.convertFirestoreOrder(l.data(),l.id));co.setOrders(e,o),r(o)},i=>{console.error("Orders subscription error:",i)})}static subscribeToActiveOrders(e,r){const s=Zt(Jt(st,"restaurants",e,this.ORDERS_COLLECTION),Yt("status","in",["placed","confirmed","preparing","ready"]));return Of(s,n=>{const i=n.docs.map(o=>this.convertFirestoreOrder(o.data(),o.id));i.sort((o,l)=>o.createdAt.getTime()-l.createdAt.getTime()),r(i)},n=>{console.error("Active orders subscription error:",n)})}static async transferOrders(e,r,s){try{const n=await this.getOrdersByTable(s,e);if(!n.success||!n.data)return{success:!1,error:"Failed to get source table orders"};const i=n.data.filter(o=>["placed","confirmed","preparing","ready"].includes(o.status));for(const o of i)await Xr(Rt(st,"restaurants",s,this.ORDERS_COLLECTION,o.id),{tableId:r,updatedAt:wt.now()});return this.clearCache(s),{success:!0,message:`${i.length} orders transferred successfully`}}catch(n){return console.error(" Failed to transfer orders:",n),{success:!1,error:Xt(n)}}}static async getMergedOrders(e,r){try{const s=[];for(const n of e){const i=await this.getOrdersByTable(r,n);if(i.success&&i.data){const o=i.data.filter(l=>["placed","confirmed","preparing","ready"].includes(l.status));s.push(...o)}}return s.sort((n,i)=>n.createdAt.getTime()-i.createdAt.getTime()),{success:!0,data:s}}catch(s){return console.error(" Failed to get merged orders:",s),{success:!1,error:Xt(s)}}}static async updateOrderForMerge(e,r,s){try{const n=Rt(st,"restaurants",r,this.ORDERS_COLLECTION,e),i=`Merged tables: ${s.join(", ")}`;return await Xr(n,{notes:i,updatedAt:wt.now()}),await this.getOrderById(e,r)}catch(n){return console.error(" Failed to update order for merge:",n),{success:!1,error:Xt(n)}}}static clearCache(e){co.clearCache(e)}static convertFirestoreOrder(e,r){var s,n;return{id:r,restaurantId:e.restaurantId,orderNumber:e.orderNumber,tableId:e.tableId,customerId:e.customerId,customerName:e.customerName,type:e.type,status:e.status,items:e.items||[],subtotal:e.subtotal,tax:e.tax,discount:e.discount,total:e.total,paymentStatus:e.paymentStatus,paymentMethod:e.paymentMethod,notes:e.notes,staffId:e.staffId,createdAt:((s=e.createdAt)==null?void 0:s.toDate())||new Date,updatedAt:((n=e.updatedAt)==null?void 0:n.toDate())||new Date}}}Or(Ur,"ORDERS_COLLECTION","orders");const d1=Object.freeze(Object.defineProperty({__proto__:null,CartManager:As,OrderService:Ur},Symbol.toStringTag,{value:"Module"}));class uA{static async getTableAreasForRestaurant(e){try{const r=Zt(Jt(st,"restaurants",e,this.COLLECTION),On("sortOrder","asc"));return{success:!0,data:(await ur(r)).docs.map(i=>this.convertFirestoreTableArea(i.data(),i.id))}}catch(r){return console.error(" Failed to get table areas:",r),{success:!1,error:Xt(r)}}}static async createTableArea(e,r){try{const s=An(),n=new Date,i={id:s,restaurantId:e,...r,createdAt:n,updatedAt:n},o=Rt(st,"restaurants",e,this.COLLECTION,s);return await LA(o,{...i,createdAt:wt.fromDate(i.createdAt),updatedAt:wt.fromDate(i.updatedAt)}),console.log(" Table area created:",i.name),{success:!0,data:i,message:"Table area created successfully"}}catch(s){return console.error(" Failed to create table area:",s),{success:!1,error:Xt(s)}}}static async updateTableArea(e,r,s){try{const n=Rt(st,"restaurants",e,this.COLLECTION,r),i={...s,updatedAt:wt.now()};await Xr(n,i);const o=await Kr(n);if(!o.exists())return{success:!1,error:"Table area not found after update"};const l=this.convertFirestoreTableArea(o.data(),o.id);return console.log(" Table area updated:",l.name),{success:!0,data:l,message:"Table area updated successfully"}}catch(n){return console.error(" Failed to update table area:",n),{success:!1,error:Xt(n)}}}static async deleteTableArea(e,r){try{const s=Rt(st,"restaurants",e,this.COLLECTION,r);return await Pl(s),console.log(" Table area deleted:",r),{success:!0,message:"Table area deleted successfully"}}catch(s){return console.error(" Failed to delete table area:",s),{success:!1,error:Xt(s)}}}static async getTableAreaById(e,r){try{const s=Rt(st,"restaurants",e,this.COLLECTION,r),n=await Kr(s);return n.exists()?{success:!0,data:this.convertFirestoreTableArea(n.data(),n.id)}:{success:!1,error:"Table area not found"}}catch(s){return console.error(" Failed to get table area:",s),{success:!1,error:Xt(s)}}}static async createDefaultAreas(e){try{const r=[{name:"Main Dining",description:"Main dining area",isActive:!0,sortOrder:1},{name:"Bar Area",description:"Bar and lounge area",isActive:!0,sortOrder:2},{name:"Patio",description:"Outdoor seating area",isActive:!0,sortOrder:3},{name:"VIP Room",description:"Private dining area",isActive:!0,sortOrder:4}],s=[];for(const n of r){const i=await this.createTableArea(e,n);i.success&&i.data&&s.push(i.data)}return{success:!0,data:s,message:"Default table areas created successfully"}}catch(r){return console.error(" Failed to create default areas:",r),{success:!1,error:Xt(r)}}}static convertFirestoreTableArea(e,r){var s,n;return{id:r,restaurantId:e.restaurantId,name:e.name,description:e.description,isActive:e.isActive,sortOrder:e.sortOrder,createdAt:((s=e.createdAt)==null?void 0:s.toDate())||new Date,updatedAt:((n=e.updatedAt)==null?void 0:n.toDate())||new Date}}}Or(uA,"COLLECTION","tableAreas");class Aa{static getTables(e){try{const r=`${this.CACHE_KEY}_${e}`,s=`${this.CACHE_EXPIRY_KEY}_${e}`,n=localStorage.getItem(r),i=localStorage.getItem(s);if(n&&i){const o=JSON.parse(n).map(this.parseTableDates),l=Date.now()>=parseInt(i);return l?console.log(" Table cache hit for restaurant:",e,"- Stale data, will refresh"):console.log(" Table cache hit for restaurant:",e,"- Fresh data"),{tables:o,isStale:l}}return{tables:[],isStale:!0}}catch(r){return console.error("Failed to get tables from cache:",r),{tables:[],isStale:!0}}}static setTables(e,r,s){try{const n=`${this.CACHE_KEY}_${e}`,i=`${this.CACHE_EXPIRY_KEY}_${e}`,o=`${this.CACHE_VERSION_KEY}_${e}`;localStorage.setItem(n,JSON.stringify(r)),localStorage.setItem(i,(Date.now()+this.CACHE_DURATION).toString()),s&&localStorage.setItem(o,s),console.log(" Tables cached for restaurant:",e,"Count:",r.length)}catch(n){console.error("Failed to cache tables:",n)}}static addTable(e,r){const{tables:s}=this.getTables(e),n=[...s,r];return this.setTables(e,n),console.log(" Table added to cache:",r.number),n}static updateTable(e,r){const{tables:s}=this.getTables(e),n=s.map(i=>i.id===r.id?r:i);return this.setTables(e,n),console.log(" Table updated in cache:",r.number),n}static removeTable(e,r){const{tables:s}=this.getTables(e),n=s.filter(i=>i.id!==r);return this.setTables(e,n),console.log(" Table removed from cache:",r),n}static bulkUpdateTables(e,r){const{tables:s}=this.getTables(e),n=s.map(i=>{const o=r.find(l=>l.id===i.id);return o?{...i,...o}:i});return this.setTables(e,n),console.log(" Bulk table updates applied to cache:",r.length,"updates"),n}static getAreas(e){const{tables:r}=this.getTables(e);return[...new Set(r.map(s=>s.area))].sort()}static clearCache(e){const r=`${this.CACHE_KEY}_${e}`,s=`${this.CACHE_EXPIRY_KEY}_${e}`,n=`${this.CACHE_VERSION_KEY}_${e}`;localStorage.removeItem(r),localStorage.removeItem(s),localStorage.removeItem(n),console.log(" Table cache cleared for restaurant:",e)}static needsRefresh(e){const{isStale:r}=this.getTables(e);return r}static parseTableDates(e){return{...e,createdAt:new Date(e.createdAt),updatedAt:new Date(e.updatedAt),reservedAt:e.reservedAt?new Date(e.reservedAt):void 0,areaId:e.areaId||e.area||"default-area",isActive:e.isActive!==void 0?e.isActive:!0}}static getCacheStats(e){const{tables:r,isStale:s}=this.getTables(e);return{cached:r.length>0,count:r.length,isStale:s,areas:this.getAreas(e)}}}Or(Aa,"CACHE_KEY","tenverse_pos_tables"),Or(Aa,"CACHE_EXPIRY_KEY","tenverse_pos_tables_expiry"),Or(Aa,"CACHE_VERSION_KEY","tenverse_pos_tables_version"),Or(Aa,"CACHE_DURATION",24*60*60*1e3);class fs{static async getTablesForRestaurant(e){try{const{tables:r,isStale:s}=Aa.getTables(e);if(r.length>0&&!s)return{success:!0,data:r};console.log(" Fetching tables from Firebase for restaurant:",e);const n=Zt(Jt(st,"restaurants",e,this.TABLES_COLLECTION)),o=(await ur(n)).docs.map(l=>this.convertFirestoreDoc(l.data(),l.id));return o.sort((l,c)=>{if(l.area!==c.area)return l.area.localeCompare(c.area);const d=parseInt(l.number),u=parseInt(c.number);return!isNaN(d)&&!isNaN(u)?d-u:l.number.localeCompare(c.number)}),Aa.setTables(e,o),console.log(" Tables loaded, sorted, and cached:",o.length),{success:!0,data:o}}catch(r){return console.error(" Failed to get tables:",r),{success:!1,error:Xt(r)}}}static async initializeDefaultTables(e){try{const r=await this.getTablesForRestaurant(e);if(r.success&&r.data&&r.data.length>0)return r;console.log(" Creating default tables and areas for restaurant:",e);const s=await uA.createTableArea(e,{name:"Main Dining",description:"Main dining area",isActive:!0,sortOrder:1});if(!s.success||!s.data)throw new Error("Failed to create default table area");const n=s.data,i=jl(st),o=[{restaurantId:e,number:"1",area:n.name,areaId:n.id,capacity:4,status:"available",isActive:!0,createdAt:new Date,updatedAt:new Date},{restaurantId:e,number:"2",area:n.name,areaId:n.id,capacity:4,status:"available",isActive:!0,createdAt:new Date,updatedAt:new Date},{restaurantId:e,number:"3",area:n.name,areaId:n.id,capacity:6,status:"available",isActive:!0,createdAt:new Date,updatedAt:new Date},{restaurantId:e,number:"4",area:n.name,areaId:n.id,capacity:2,status:"available",isActive:!0,createdAt:new Date,updatedAt:new Date}],l=[];for(const c of o){const d=An(),u={id:d,...c},A=Rt(st,"restaurants",e,this.TABLES_COLLECTION,d);i.set(A,{...u,createdAt:wt.fromDate(u.createdAt),updatedAt:wt.fromDate(u.updatedAt)}),l.push(u)}return await i.commit(),Aa.setTables(e,l),console.log(" Default tables and areas created and cached"),{success:!0,data:l,message:"Default tables and areas created successfully"}}catch(r){return console.error(" Failed to create default tables:",r),{success:!1,error:Xt(r)}}}static async createTable(e){try{const r=An(),s={id:r,...e,createdAt:new Date,updatedAt:new Date},n=Rt(st,"restaurants",e.restaurantId,this.TABLES_COLLECTION,r);return await LA(n,{...s,createdAt:wt.fromDate(s.createdAt),updatedAt:wt.fromDate(s.updatedAt)}),Aa.addTable(e.restaurantId,s),console.log(" Table created and cached:",s.number),{success:!0,data:s,message:"Table created successfully"}}catch(r){return console.error(" Failed to create table:",r),{success:!1,error:Xt(r)}}}static async updateTable(e,r,s){try{const n=Rt(st,"restaurants",r,this.TABLES_COLLECTION,e),i={...s,updatedAt:wt.now()};await Xr(n,i);const{tables:o}=Aa.getTables(r),l=o.findIndex(d=>d.id===e);if(l!==-1){const d={...o[l],...s,updatedAt:new Date};return Aa.updateTable(r,d),{success:!0,data:d,message:"Table updated successfully"}}return await this.getTableById(e,r)}catch(n){return console.error(" Failed to update table:",n),{success:!1,error:Xt(n)}}}static async deleteTable(e,r){try{const s=Rt(st,"restaurants",r,this.TABLES_COLLECTION,e);return await Pl(s),Aa.removeTable(r,e),console.log(" Table deleted and removed from cache"),{success:!0,message:"Table deleted successfully"}}catch(s){return console.error(" Failed to delete table:",s),{success:!1,error:Xt(s)}}}static async getTableById(e,r){try{const{tables:s}=Aa.getTables(r),n=s.find(c=>c.id===e);if(n)return{success:!0,data:n};const i=Rt(st,"restaurants",r,this.TABLES_COLLECTION,e),o=await Kr(i);return o.exists()?{success:!0,data:this.convertFirestoreDoc(o.data(),o.id)}:{success:!1,error:"Table not found"}}catch(s){return console.error(" Failed to get table by ID:",s),{success:!1,error:Xt(s)}}}static async getAvailableTables(e){const r=await this.getTablesForRestaurant(e);return r.success&&r.data?{success:!0,data:r.data.filter(n=>n.status==="available")}:r}static async getTableAreas(e){const r=await this.getTablesForRestaurant(e);return r.success&&r.data?{success:!0,data:[...new Set(r.data.map(n=>n.area))]}:{success:!1,error:r.error}}static subscribeToTables(e,r){const s=Zt(Jt(st,"restaurants",e,this.TABLES_COLLECTION));return Of(s,n=>{const i=n.docs.map(o=>this.convertFirestoreDoc(o.data(),o.id));i.sort((o,l)=>{if(o.area!==l.area)return o.area.localeCompare(l.area);const c=parseInt(o.number),d=parseInt(l.number);return!isNaN(c)&&!isNaN(d)?c-d:o.number.localeCompare(l.number)}),Aa.setTables(e,i),r(i)},n=>{console.error("Table subscription error:",n)})}static async transferTable(e,r,s){try{const n=jl(st),i=Rt(st,"restaurants",s,this.TABLES_COLLECTION,e),o=Rt(st,"restaurants",s,this.TABLES_COLLECTION,r);n.update(i,{status:"available",currentOrderId:null,updatedAt:wt.now()}),n.update(o,{status:"occupied",updatedAt:wt.now()}),await n.commit();const{tables:l}=Aa.getTables(s),c=l.map(d=>d.id===e?{...d,status:"available",currentOrderId:void 0}:d.id===r?{...d,status:"occupied"}:d);return Aa.setTables(s,c),{success:!0,message:"Table transfer completed successfully"}}catch(n){return console.error(" Failed to transfer table:",n),{success:!1,error:Xt(n)}}}static async mergeTables(e,r){try{const s=jl(st);e.forEach(o=>{const l=Rt(st,"restaurants",r,this.TABLES_COLLECTION,o);s.update(l,{status:"occupied",updatedAt:wt.now()})}),await s.commit();const{tables:n}=Aa.getTables(r),i=n.map(o=>e.includes(o.id)?{...o,status:"occupied"}:o);return Aa.setTables(r,i),{success:!0,data:{mergedTableId:e[0]},message:"Tables merged successfully"}}catch(s){return console.error(" Failed to merge tables:",s),{success:!1,error:Xt(s)}}}static async unmergeTables(e,r){try{const s=jl(st);e.forEach(o=>{const l=Rt(st,"restaurants",r,this.TABLES_COLLECTION,o);s.update(l,{status:"available",currentOrderId:null,updatedAt:wt.now()})}),await s.commit();const{tables:n}=Aa.getTables(r),i=n.map(o=>e.includes(o.id)?{...o,status:"available",currentOrderId:void 0}:o);return Aa.setTables(r,i),{success:!0,message:"Tables unmerged and made available"}}catch(s){return console.error(" Failed to unmerge tables:",s),{success:!1,error:Xt(s)}}}static clearCache(e){Aa.clearCache(e)}static convertFirestoreDoc(e,r){var s,n,i;return{id:r,restaurantId:e.restaurantId,number:e.number,area:e.area,areaId:e.areaId||e.area||"default-area",capacity:e.capacity,status:e.status,currentOrderId:e.currentOrderId,reservedAt:(s=e.reservedAt)==null?void 0:s.toDate(),reservedFor:e.reservedFor,description:e.description,isActive:e.isActive!==void 0?e.isActive:!0,createdAt:((n=e.createdAt)==null?void 0:n.toDate())||new Date,updatedAt:((i=e.updatedAt)==null?void 0:i.toDate())||new Date}}}Or(fs,"TABLES_COLLECTION","tables");const gB=Object.freeze(Object.defineProperty({__proto__:null,TableService:fs},Symbol.toStringTag,{value:"Module"}));class Mf{static async createCreditTransaction(e){try{const r=e.totalAmount-e.amountReceived,s={restaurantId:e.restaurantId,customerId:e.customerId,customerName:e.customerName,customerPhone:e.customerPhone,orderId:e.orderId,tableNumber:e.tableNumber,totalAmount:e.totalAmount,amountReceived:e.amountReceived,creditAmount:r,paymentMethod:e.paymentMethod,status:"pending",createdAt:wt.now(),notes:e.notes,paymentHistory:[]};return{success:!0,creditId:(await Bi(Jt(st,"creditTransactions"),s)).id}}catch(r){return console.error("Error creating credit transaction:",r),{success:!1,error:"Failed to create credit transaction"}}}static async getCreditTransactions(e){try{const r=Zt(Jt(st,"creditTransactions"),Yt("restaurantId","==",e)),s=await ur(r),n=[];return s.forEach(i=>{n.push({id:i.id,...i.data()})}),n.sort((i,o)=>{try{const l=i.createdAt instanceof Date?i.createdAt.getTime():i.createdAt.toMillis();return(o.createdAt instanceof Date?o.createdAt.getTime():o.createdAt.toMillis())-l}catch(l){return console.warn("Error sorting credit transactions by date:",l),0}}),{success:!0,data:n}}catch(r){return console.error("Error fetching credit transactions:",r),{success:!1,error:"Failed to fetch credit transactions"}}}static async makePayment(e,r,s,n){try{const i=Rt(st,"creditTransactions",e),o=await Kr(i);if(!o.exists())return{success:!1,error:"Credit transaction not found"};const l=o.data(),c={id:Date.now().toString(),amount:r,paymentMethod:s,paidAt:wt.now(),notes:n},d=[...l.paymentHistory||[],c],u=l.amountReceived+d.reduce((p,m)=>p+m.amount,0),A=l.totalAmount-u;let h="pending";A<=0?h="paid":u>l.amountReceived&&(h="partially_paid");const f={paymentHistory:d,status:h};return h==="paid"&&(f.paidAt=wt.now()),await Xr(i,f),{success:!0}}catch(i){return console.error("Error making credit payment:",i),{success:!1,error:"Failed to process payment"}}}static async getCreditSummary(e){try{const r=await this.getCreditTransactions(e);if(!r.success||!r.data)return{success:!1,error:r.error};const s=r.data,n=s.filter(l=>l.status==="pending"||l.status==="partially_paid"),i=n.length,o=n.reduce((l,c)=>{const d=c.amountReceived+(c.paymentHistory||[]).reduce((u,A)=>u+A.amount,0);return l+(c.totalAmount-d)},0);return{success:!0,data:{totalPendingCredits:i,totalCreditAmount:o,totalTransactions:s.length,recentTransactions:s.slice(0,10)}}}catch(r){return console.error("Error getting credit summary:",r),{success:!1,error:"Failed to get credit summary"}}}}class zw{static async calculateOrderRevenue(e,r){try{const s=await Mf.getCreditTransactions(r);if(!s.success||!s.data)return{totalOrderValue:e.total,actualRevenue:e.total,creditAmount:0,pendingCreditAmount:0};const n=s.data.find(c=>c.orderId===e.id);if(!n)return{totalOrderValue:e.total,actualRevenue:e.total,creditAmount:0,pendingCreditAmount:0};const i=n.amountReceived+(n.paymentHistory||[]).reduce((c,d)=>c+d.amount,0),o=n.totalAmount-i,l=n.totalAmount-n.amountReceived;return{totalOrderValue:e.total,actualRevenue:i,creditAmount:l,pendingCreditAmount:o}}catch(s){return console.error("Error calculating order revenue:",s),{totalOrderValue:e.total,actualRevenue:e.total,creditAmount:0,pendingCreditAmount:0}}}static async calculateOrdersRevenue(e,r){try{const s=await Mf.getCreditTransactions(r);if(!s.success||!s.data){const u=e.reduce((A,h)=>A+h.total,0);return{totalOrderValue:u,actualRevenue:u,totalCreditAmount:0,pendingCreditAmount:0,ordersWithCredits:0}}const n=s.data;let i=0,o=0,l=0,c=0,d=0;return e.forEach(u=>{i+=u.total;const A=n.find(h=>h.orderId===u.id);if(A){d++;const h=A.amountReceived+(A.paymentHistory||[]).reduce((m,g)=>m+g.amount,0),f=A.totalAmount-h,p=A.totalAmount-A.amountReceived;o+=h,l+=p,c+=f}else o+=u.total}),{totalOrderValue:i,actualRevenue:o,totalCreditAmount:l,pendingCreditAmount:c,ordersWithCredits:d}}catch(s){console.error("Error calculating orders revenue:",s);const n=e.reduce((i,o)=>i+o.total,0);return{totalOrderValue:n,actualRevenue:n,totalCreditAmount:0,pendingCreditAmount:0,ordersWithCredits:0}}}static async getRevenueSummary(e,r){const s=await this.calculateOrdersRevenue(e,r),n=s.totalOrderValue>0?s.actualRevenue/s.totalOrderValue*100:100;return{totalOrders:e.length,...s,revenueCollectionRate:n}}}function xB(){const{restaurant:t}=js(),{user:e}=ia(),{canAccess:r}=NM(),[s,n]=R.useState({totalOrdersToday:0,revenueToday:0,actualRevenueToday:0,creditAmountToday:0,activeTables:0,totalTables:0,ordersYesterday:0,revenueYesterday:0,actualRevenueYesterday:0,growth:0,actualGrowth:0}),[i,o]=R.useState(!0),[l,c]=R.useState(!1);if(R.useEffect(()=>{if(!t)return;(async()=>{try{o(!0);const g=new Date,y=new Date(g.getFullYear(),g.getMonth(),g.getDate()),v=new Date(y.getTime()+24*60*60*1e3),x=new Date(g.getTime()-24*60*60*1e3),E=new Date(x.getFullYear(),x.getMonth(),x.getDate()),T=new Date(E.getTime()+24*60*60*1e3),[j,C]=await Promise.all([Ur.getOrdersForRestaurant(t.id),fs.getTablesForRestaurant(t.id)]),w=j.success?j.data||[]:[],S=C.success?C.data||[]:[],F=w.filter(he=>{const I=he.createdAt,U=I instanceof Date?I:new Date(I);return U>=y&&U<v}),B=w.filter(he=>{const I=he.createdAt,U=I instanceof Date?I:new Date(I);return U>=E&&U<T}),k=F.filter(he=>he.status==="completed"),D=B.filter(he=>he.status==="completed"),q=k.reduce((he,I)=>he+(I.total||0),0),te=D.reduce((he,I)=>he+(I.total||0),0);let W={actualRevenue:0,totalCreditAmount:0},Q={actualRevenue:0,totalCreditAmount:0};try{W=await zw.calculateOrdersRevenue(k,t.id),Q=await zw.calculateOrdersRevenue(D,t.id)}catch(he){console.error("Error calculating revenue data:",he),W={actualRevenue:q,totalCreditAmount:0},Q={actualRevenue:te,totalCreditAmount:0}}const re=S.filter(he=>he.status==="occupied").length,G=te>0?(q-te)/te*100:q>0?100:0,Ae=Q.actualRevenue>0?(W.actualRevenue-Q.actualRevenue)/Q.actualRevenue*100:W.actualRevenue>0?100:0;n({totalOrdersToday:F.length,revenueToday:q,actualRevenueToday:W.actualRevenue,creditAmountToday:W.totalCreditAmount,activeTables:re,totalTables:S.length,ordersYesterday:B.length,revenueYesterday:te,actualRevenueYesterday:Q.actualRevenue,growth:G,actualGrowth:Ae})}catch(g){console.error("Error fetching dashboard data:",g)}finally{o(!1)}})()},[t]),!t)return null;const d=()=>{if(!s||(s.ordersYesterday??0)===0)return"+0%";const m=((s.totalOrdersToday??0)-(s.ordersYesterday??0))/(s.ordersYesterday??1)*100;return`${m>=0?"+":""}${m.toFixed(1)}%`},u=()=>{if(!s||(s.actualRevenueYesterday??0)===0)return"+0%";const m=((s.actualRevenueToday??0)-(s.actualRevenueYesterday??0))/(s.actualRevenueYesterday??1)*100;return`${m>=0?"+":""}${m.toFixed(1)}%`},A=()=>!s||(s.totalTables??0)===0?"0%":`${Math.round((s.activeTables??0)/(s.totalTables??1)*100)}%`,h=[{title:"Total Orders Today",value:i?"...":((s==null?void 0:s.totalOrdersToday)??0).toString(),change:i?"...":d(),icon:Kd,color:"text-blue-600",bgColor:"bg-blue-50",isPositive:!i&&s?(s.totalOrdersToday??0)>=(s.ordersYesterday??0):!0},{title:"Actual Revenue Today",value:i?"...":Ue((s==null?void 0:s.actualRevenueToday)??0),change:i?"...":u(),icon:hn,color:"text-green-600",bgColor:"bg-green-50",isPositive:!i&&s?(s.actualRevenueToday??0)>=(s.actualRevenueYesterday??0):!0},{title:"Pending Credits",value:i?"...":Ue((s==null?void 0:s.creditAmountToday)??0),change:i?"...":"to collect",icon:Uo,color:"text-orange-600",bgColor:"bg-orange-50",isPositive:!1},{title:"Active Tables",value:i?"...":`${(s==null?void 0:s.activeTables)??0}/${(s==null?void 0:s.totalTables)??0}`,change:i?"...":A(),icon:Ls,color:"text-purple-600",bgColor:"bg-purple-50",isPositive:!0},{title:"Revenue Growth",value:i?"...":`${((s==null?void 0:s.growth)??0).toFixed(1)}%`,change:i?"...":"vs yesterday",icon:Is,color:"text-orange-600",bgColor:"bg-orange-50",isPositive:!i&&s?(s.growth??0)>=0:!0}],p=[{title:"Manage Tables",description:"View and manage tables",icon:Ls,href:`/${t.slug}/tables`,color:"from-blue-500 to-blue-600",moduleId:"tables"},{title:"Orders Dashboard",description:"View and analyze orders",icon:Kd,href:`/${t.slug}/orders`,color:"from-indigo-500 to-indigo-600",moduleId:"orders"},{title:"Takeaway Orders",description:"Manage takeaway orders",icon:rs,href:`/${t.slug}/takeaway`,color:"from-orange-500 to-red-600",moduleId:"orders"},{title:"Menu Management",description:"Manage menu items & categories",icon:hf,href:`/${t.slug}/menu`,color:"from-orange-500 to-orange-600",moduleId:"menu"},{title:"Inventory Management",description:"Track stock & inventory",icon:rs,href:`/${t.slug}/inventory`,color:"from-green-500 to-green-600",moduleId:"inventory"},{title:"Kitchen Display",description:"View kitchen orders",icon:Zc,href:`/${t.slug}/kitchen`,color:"from-purple-500 to-purple-600",moduleId:"kitchen"},{title:"Customer Portal",description:"Configure menu portal & QR codes",icon:rd,href:`/${t.slug}/customer-portal`,color:"from-blue-500 to-indigo-600",moduleId:"customer-portal"},{title:"Customer Management",description:"Manage customer database",icon:Ls,href:`/${t.slug}/customers`,color:"from-teal-500 to-teal-600",moduleId:"customers"},{title:"Credit Management",description:"Manage customer credits & payments",icon:Uo,href:`/${t.slug}/credits`,color:"from-red-500 to-red-600",moduleId:"credits"},{title:"Coupon Dashboard",description:"Manage coupons & promotions",icon:Cn,href:`/${t.slug}/coupons`,color:"from-pink-500 to-pink-600",moduleId:"coupons"},{title:"Gamification Tools",description:"Spin wheel & customer engagement",icon:GA,href:`/${t.slug}/gamification`,color:"from-indigo-500 to-purple-600",moduleId:"gamification"},{title:"Employee Management",description:"Manage staff & permissions",icon:Ls,href:`/${t.slug}/employees`,color:"from-blue-500 to-purple-600",moduleId:"employees"},{title:"Marketplace",description:"Order bulk supplies & wholesale",icon:Zi,href:`/${t.slug}/marketplace`,color:"from-emerald-500 to-emerald-600",moduleId:"marketplace"},{title:"Expense Tracker",description:"Track business expenses & budgets",icon:Uo,href:`/${t.slug}/expenses`,color:"from-violet-500 to-violet-600",moduleId:"expenses"},{title:"Business Reports",description:"Generate comprehensive reports",icon:Sa,href:`/${t.slug}/reports`,color:"from-rose-500 to-rose-600",moduleId:"reports"},{title:"Settings",description:"Restaurant settings",icon:Sl,href:`/${t.slug}/settings`,color:"from-gray-500 to-gray-600",moduleId:"settings"}].filter(m=>r(m.moduleId));return a.jsx("div",{className:"min-h-screen",style:{background:"var(--color-background)"},children:a.jsxs("main",{className:"max-w-7xl mx-auto px-3 sm:px-4 lg:px-6 xl:px-8 py-4 sm:py-6 lg:py-8",children:[a.jsx("div",{className:"mb-6 sm:mb-8",children:a.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"Dashboard"}),a.jsx("p",{className:"text-gray-600 mt-1 text-sm sm:text-base",children:"Welcome back! Here's an overview of your restaurant operations."})]}),a.jsxs("div",{className:"text-left lg:text-right",children:[a.jsx("div",{className:"text-xs sm:text-sm text-gray-500",children:"Your Restaurant URL"}),a.jsxs("code",{className:"text-xs sm:text-sm font-mono bg-gray-100 px-2 py-1 rounded break-all",children:[window.location.origin,"/",t.slug]})]})]})}),a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-4 sm:gap-6 mb-6 sm:mb-8",children:h.map((m,g)=>{const y=m.icon;return a.jsx("div",{className:"card p-4 sm:p-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"min-w-0 flex-1",children:[a.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-600 truncate",children:m.title}),a.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[a.jsx("p",{className:"text-lg sm:text-2xl font-bold text-gray-900 truncate",children:m.value}),i&&a.jsx(Gi,{className:"w-3 h-3 sm:w-4 sm:h-4 animate-spin text-gray-400 flex-shrink-0"})]}),a.jsxs("p",{className:`text-xs sm:text-sm mt-1 ${m.isPositive?"text-green-600":"text-red-600"}`,children:[m.change," ",m.title!=="Active Tables"&&m.title!=="Revenue Growth"?"from yesterday":""]})]}),a.jsx("div",{className:`w-10 h-10 sm:w-12 sm:h-12 ${m.bgColor} rounded-lg flex items-center justify-center flex-shrink-0`,children:a.jsx(y,{className:`w-5 h-5 sm:w-6 sm:h-6 ${m.color}`})})]})},g)})}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-base sm:text-lg font-semibold text-gray-900 mb-4 sm:mb-6",children:"Quick Actions"}),a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-3 sm:gap-4",children:p.map((m,g)=>{const y=m.icon;return a.jsx("div",{className:"card card-hover p-4 sm:p-6 cursor-pointer group",onClick:()=>window.location.href=m.href,children:a.jsxs("div",{className:"flex items-center space-x-3 sm:space-x-4",children:[a.jsx("div",{className:`w-10 h-10 sm:w-12 sm:h-12 bg-gradient-to-r ${m.color} rounded-xl flex items-center justify-center group-hover:scale-110 transition-transform flex-shrink-0`,children:a.jsx(y,{className:"w-5 h-5 sm:w-6 sm:h-6 text-white"})}),a.jsxs("div",{className:"min-w-0 flex-1",children:[a.jsx("h3",{className:"font-semibold text-gray-900 text-sm sm:text-base truncate",children:m.title}),a.jsx("p",{className:"text-xs sm:text-sm text-gray-600 line-clamp-2",children:m.description})]})]})},g)})})]})]})})}function i_({message:t="Loading...",fullScreen:e=!0}){const r=e?"fixed inset-0 z-50 bg-gradient-to-br from-blue-50 to-blue-100":"w-full h-32";return a.jsx("div",{className:`${r} flex items-center justify-center`,children:a.jsxs("div",{className:"text-center space-y-4 animate-fade-in",children:[a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"w-16 h-16 mx-auto bg-gradient-primary rounded-2xl flex items-center justify-center shadow-lg",children:a.jsx(Gi,{className:"w-8 h-8 text-white animate-spin"})}),a.jsx("div",{className:"absolute inset-0 w-16 h-16 mx-auto border-4 border-blue-200 rounded-2xl animate-ping opacity-20"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:e?"TenVerse POS":""}),a.jsx("p",{className:"text-sm text-gray-600 font-medium",children:t})]}),a.jsx("div",{className:"w-48 h-1 bg-gray-200 rounded-full overflow-hidden mx-auto",children:a.jsx("div",{className:"h-full bg-gradient-primary rounded-full animate-pulse"})})]})})}function Lre(){const{restaurant:t,loading:e}=js(),{login:r,loginWithPin:s,loading:n}=ia(),i=Li(),{slug:o}=uu(),[l,c]=R.useState("email"),[d,u]=R.useState(!1),{register:A,handleSubmit:h,formState:{errors:f,isValid:p}}=nn({mode:"onChange"}),{register:m,handleSubmit:g,formState:{errors:y,isValid:v}}=nn({mode:"onChange"});if(e)return a.jsx(i_,{});if(!t||!o)return a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:a.jsxs("div",{className:"text-center",children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Restaurant Not Found"}),a.jsx("p",{className:"text-gray-600",children:"Please check the URL and try again."})]})});const x=async T=>{try{await r(T.email,T.password,o),i(`/${o}`)}catch{}},E=async T=>{try{await s(T.pin,o),i(`/${o}`)}catch{}};return a.jsx("div",{className:"min-h-screen flex items-center justify-center",style:{background:"var(--color-background)"},children:a.jsxs("div",{className:"max-w-md w-full space-y-8 p-8",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-16 h-16 mx-auto rounded-2xl flex items-center justify-center text-white mb-6",style:{background:"var(--gradient-primary)"},children:a.jsx(Zc,{className:"w-8 h-8"})}),a.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:t.name}),a.jsxs("p",{className:"text-gray-600 mb-8",children:[Fj(t.businessType)," Staff Login"]})]}),a.jsxs("div",{className:"flex rounded-lg bg-gray-100 p-1 mb-6",children:[a.jsxs("button",{type:"button",onClick:()=>c("email"),className:`flex-1 flex items-center justify-center px-4 py-2 rounded-md text-sm font-medium transition-colors ${l==="email"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:[a.jsx(hN,{className:"w-4 h-4 mr-2"}),"Email"]}),a.jsxs("button",{type:"button",onClick:()=>c("pin"),className:`flex-1 flex items-center justify-center px-4 py-2 rounded-md text-sm font-medium transition-colors ${l==="pin"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:[a.jsx(Dj,{className:"w-4 h-4 mr-2"}),"PIN"]})]}),l==="email"&&a.jsxs("form",{onSubmit:h(x),className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"form-label",children:"Email Address"}),a.jsx("input",{...A("email",{required:"Email is required",pattern:{value:/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i,message:"Please enter a valid email address"}}),type:"email",className:`input ${f.email?"border-red-300":""}`,placeholder:"Enter your email address",disabled:n}),f.email&&a.jsx("p",{className:"mt-1 text-sm text-red-600",children:f.email.message})]}),a.jsxs("div",{children:[a.jsx("label",{className:"form-label",children:"Password"}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{...A("password",{required:"Password is required",minLength:{value:6,message:"Password must be at least 6 characters"}}),type:d?"text":"password",className:`input pr-10 ${f.password?"border-red-300":""}`,placeholder:"Enter your password",disabled:n}),a.jsx("button",{type:"button",onClick:()=>u(!d),className:"absolute inset-y-0 right-0 pr-3 flex items-center",disabled:n,children:d?a.jsx(Dl,{className:"h-4 w-4 text-gray-400"}):a.jsx(Xs,{className:"h-4 w-4 text-gray-400"})})]}),f.password&&a.jsx("p",{className:"mt-1 text-sm text-red-600",children:f.password.message})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"checkbox",className:"rounded border-gray-300"}),a.jsx("span",{className:"ml-2 text-sm text-gray-600",children:"Remember me"})]}),a.jsx("a",{href:"#",className:"text-sm font-medium",style:{color:"var(--color-primary)"},children:"Forgot password?"})]}),a.jsxs("button",{type:"submit",disabled:!p||n,className:"w-full btn btn-theme-primary disabled:opacity-50 disabled:cursor-not-allowed",children:[n?a.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}):a.jsx(zte,{className:"w-4 h-4 mr-2"}),n?"Signing In...":"Sign In"]})]}),l==="pin"&&a.jsxs("form",{onSubmit:g(E),className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"form-label",children:"4-Digit PIN"}),a.jsx("input",{...m("pin",{required:"PIN is required",pattern:{value:/^\d{4}$/,message:"PIN must be exactly 4 digits"}}),type:"text",inputMode:"numeric",maxLength:4,className:`input text-center text-2xl tracking-widest ${y.pin?"border-red-300":""}`,placeholder:"",disabled:n}),y.pin&&a.jsx("p",{className:"mt-1 text-sm text-red-600",children:y.pin.message})]}),a.jsxs("button",{type:"submit",disabled:!v||n,className:"w-full btn btn-theme-primary disabled:opacity-50 disabled:cursor-not-allowed",children:[n?a.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}):a.jsx(Dj,{className:"w-4 h-4 mr-2"}),n?"Signing In...":"Sign In with PIN"]})]}),a.jsx("div",{className:"mt-6 pt-6 border-t border-gray-200 text-center",children:a.jsx("p",{className:"text-sm text-gray-600",children:"Need access? Contact your manager or restaurant owner."})})]})})}class u1{static async checkAndFixTableStatuses(e){try{console.log(" TableStatusService: Starting table status audit for restaurant:",e);const r=await fs.getTablesForRestaurant(e);if(!r.success||!r.data)return{success:!1,fixed:[],errors:["Failed to fetch tables"]};const s=r.data,n=[],i=[];for(const o of s)if(o.status==="occupied")try{const l=await Ur.getOrdersByTable(e,o.id);if(l.success&&l.data){const c=l.data.filter(d=>["placed","confirmed","preparing","ready"].includes(d.status)||d.status==="completed"&&d.paymentStatus!=="paid");if(c.length===0){console.log(` Fixing table ${o.number}: occupied -> available (no active orders)`);const d=await fs.updateTable(o.id,e,{status:"available"});d.success?n.push({tableId:o.id,tableNumber:o.number,currentStatus:"occupied",correctStatus:"available",reason:"No active orders found"}):i.push(`Failed to update table ${o.number}: ${d.error}`)}else console.log(` Table ${o.number} correctly shows occupied (${c.length} active orders)`)}else{console.log(` Fixing table ${o.number}: occupied -> available (failed to fetch orders)`);const c=await fs.updateTable(o.id,e,{status:"available"});c.success?n.push({tableId:o.id,tableNumber:o.number,currentStatus:"occupied",correctStatus:"available",reason:"Could not verify orders"}):i.push(`Failed to update table ${o.number}: ${c.error}`)}}catch(l){console.error(`Error checking table ${o.number}:`,l),i.push(`Error checking table ${o.number}: ${l}`)}return console.log(" TableStatusService: Audit complete",{tablesChecked:s.length,fixesApplied:n.length,errors:i.length}),{success:!0,fixed:n,errors:i}}catch(r){return console.error(" TableStatusService: Audit failed:",r),{success:!1,fixed:[],errors:[String(r)]}}}static async autoFixWithNotification(e){try{Z(" Checking table statuses...",{icon:"",duration:1500,style:{fontSize:"12px",padding:"6px 10px",maxWidth:"200px",background:"rgba(59, 130, 246, 0.85)",color:"#fff",borderRadius:"6px"}});const r=await this.checkAndFixTableStatuses(e);if(r.success){if(r.fixed.length>0){const s=r.fixed.map(n=>n.tableNumber).join(", ");Z.success(` Fixed ${r.fixed.length} table status(es): Tables ${s}`),r.fixed.forEach(n=>{console.log(` Fixed Table ${n.tableNumber}: ${n.currentStatus}  ${n.correctStatus} (${n.reason})`)})}else Z.success(" All table statuses are correct");r.errors.length>0&&(console.warn(" Some tables had errors:",r.errors),Z(` ${r.errors.length} table(s) had errors - check console`,{icon:""}))}else Z.error(" Failed to check table statuses"),console.error(" Table status check failed:",r.errors)}catch(r){console.error(" Auto-fix error:",r),Z.error(" Error checking table statuses")}}}const CM=({isVisible:t,stage:e,message:r})=>{if(!t)return null;const n=(()=>{switch(e){case"processing":return{icon:a.jsx(ux,{className:"w-8 h-8 text-blue-500 animate-pulse"}),title:"Processing Voice Command",description:r||"Analyzing your order...",bgColor:"from-blue-50 to-blue-100",borderColor:"border-blue-200"};case"placing":return{icon:a.jsx(Ys,{className:"w-8 h-8 text-orange-500 animate-spin"}),title:"Placing Order",description:r||"Adding items and creating order...",bgColor:"from-orange-50 to-orange-100",borderColor:"border-orange-200"};case"completed":return{icon:a.jsx(Nr,{className:"w-8 h-8 text-green-500"}),title:"Order Placed Successfully",description:r||"Preparing KOT...",bgColor:"from-green-50 to-green-100",borderColor:"border-green-200"}}})();return a.jsxs("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-[60] flex items-center justify-center",children:[a.jsx("div",{className:`bg-gradient-to-br ${n.bgColor} ${n.borderColor} border-2 rounded-2xl p-8 max-w-md w-full mx-4 shadow-2xl`,children:a.jsxs("div",{className:"text-center space-y-6",children:[a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"w-20 h-20 mx-auto bg-white rounded-full flex items-center justify-center shadow-lg",children:n.icon}),(e==="processing"||e==="placing")&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"absolute inset-0 w-20 h-20 mx-auto border-4 border-blue-200 rounded-full animate-ping opacity-20"}),a.jsx("div",{className:"absolute inset-0 w-20 h-20 mx-auto border-4 border-blue-300 rounded-full animate-ping opacity-30 animation-delay-300"})]})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsx("h3",{className:"text-xl font-bold text-gray-800",children:n.title}),a.jsx("p",{className:"text-gray-600 font-medium",children:n.description})]}),a.jsx("div",{className:"w-full h-2 bg-gray-200 rounded-full overflow-hidden",children:a.jsx("div",{className:`h-full rounded-full transition-all duration-1000 ${e==="processing"?"w-1/3 bg-blue-500":e==="placing"?"w-2/3 bg-orange-500":"w-full bg-green-500"}`})}),e==="processing"&&a.jsxs("div",{className:"flex justify-center space-x-2",children:[a.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full animate-bounce"}),a.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full animate-bounce animation-delay-150"}),a.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full animate-bounce animation-delay-300"})]})]})}),a.jsx("style",{children:`
        .animation-delay-150 { animation-delay: 150ms; }
        .animation-delay-300 { animation-delay: 300ms; }
      `})]})},Mj=({isVisible:t,onClose:e,onPrintKOT:r,orderDetails:s})=>{if(R.useEffect(()=>{if(t&&s){const i=setTimeout(()=>{r(),setTimeout(()=>{e()},100)},300);return()=>clearTimeout(i)}},[t,s,r,e]),!t)return null;const n=()=>{r(),e()};return a.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-[70] flex items-center justify-center",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full mx-4 overflow-hidden",children:[a.jsx("div",{className:"bg-gradient-to-r from-green-500 to-green-600 text-white p-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-10 h-10 bg-white/20 rounded-full flex items-center justify-center",children:a.jsx(Nr,{className:"w-6 h-6"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-bold",children:"Order Placed!"}),a.jsx("p",{className:"text-sm text-green-100",children:"Voice command completed"})]})]}),a.jsx("button",{onClick:e,className:"w-8 h-8 bg-white/20 rounded-full flex items-center justify-center hover:bg-white/30 transition-colors",children:a.jsx(qr,{className:"w-5 h-5"})})]})}),a.jsxs("div",{className:"p-6",children:[s&&a.jsx("div",{className:"mb-6",children:a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-3",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Order Number"}),a.jsx("span",{className:"font-bold text-gray-900",children:s.orderNumber})]}),a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Table"}),a.jsx("span",{className:"font-bold text-gray-900",children:s.tableNumber})]}),a.jsxs("div",{className:"border-t pt-3",children:[a.jsx("span",{className:"text-sm font-medium text-gray-600 block mb-2",children:"Items Ordered"}),a.jsx("div",{className:"space-y-1",children:s.items.map((i,o)=>a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{className:"text-gray-700",children:i.name}),a.jsxs("span",{className:"text-gray-900 font-medium",children:["x",i.quantity]})]},o))})]})]})}),a.jsxs("div",{className:"text-center mb-6",children:[a.jsx("p",{className:"text-gray-700 mb-2",children:"Your order has been placed successfully via voice command."}),a.jsx("p",{className:"text-sm text-green-600 font-medium",children:" KOT is being sent to kitchen automatically..."})]}),a.jsxs("div",{className:"flex space-x-3",children:[a.jsx("button",{onClick:e,className:"flex-1 px-4 py-3 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors font-medium",children:"Skip"}),a.jsxs("button",{onClick:n,className:"flex-1 px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium flex items-center justify-center space-x-2",autoFocus:!0,children:[a.jsx(R0,{className:"w-4 h-4"}),a.jsx("span",{children:"Print KOT"})]})]})]})]})})};function Ore(){const{restaurant:t}=js(),{user:e}=ia(),r=Li(),[s,n]=R.useState([]),[i,o]=R.useState([]),[l,c]=R.useState("all"),[d,u]=R.useState("all"),[A,h]=R.useState(null),[f,p]=R.useState(!0),[m,g]=R.useState(!1),[y,v]=R.useState(!1),[x,E]=R.useState(!1),[T,j]=R.useState(!1),[C,w]=R.useState(null),[S,F]=R.useState(!1),[B,k]=R.useState("processing"),[D,q]=R.useState(""),[te,W]=R.useState(null),[Q,re]=R.useState(!1),G=R.useRef(!0),{register:Ae,handleSubmit:he,reset:I,setValue:U,formState:{errors:V,isValid:L}}=nn({mode:"onChange"}),{register:K,handleSubmit:fe,reset:ee,formState:{errors:de,isValid:ue}}=nn({mode:"onChange"}),Ie=(ze,Me,rt)=>`
      <!DOCTYPE html>
      <html>
      <head>
        <title>KOT - ${ze.orderNumber}</title>
        <style>
          body { 
            font-family: 'Courier New', monospace; 
            margin: 0; 
            padding: 0 10px; 
            width: 100%;
            background: #fff;
          }
          .kot-container {
            width: 100%;
            padding: 15px 5px;
            min-height: auto;
          }
          .header { 
            text-align: center; 
            border-bottom: 2px solid #000; 
            padding-bottom: 10px; 
            margin-bottom: 15px; 
          }
          .restaurant-name { 
            font-size: 18px; 
            font-weight: bold; 
            margin-bottom: 5px;
          }
          .order-info { 
            margin-bottom: 15px; 
            line-height: 1.4;
          }
          .items { 
            border-collapse: collapse; 
            width: 100%; 
            margin: 15px 0;
          }
          .items th, .items td { 
            border: 1px solid #000; 
            padding: 8px; 
            text-align: left; 
            font-size: 13px;
          }
          .items th { 
            background-color: #f0f0f0; 
            font-weight: bold;
          }
          .footer { 
            margin-top: 20px; 
            text-align: center; 
            font-size: 12px; 
            border-top: 1px dashed #000;
            padding-top: 15px;
          }
          .order-notes {
            margin-top: 15px; 
            padding: 10px; 
            border: 1px solid #000;
            background: #f9f9f9;
          }
          @media print {
            body { 
              margin: 0; 
              padding: 0 8px;
              width: 100%;
            }
            .kot-container {
              padding: 10px 0;
              width: 100%;
              min-height: auto;
            }
            .no-print { display: none; }
            .header, .order-info, .items, .order-notes, .footer {
              page-break-inside: avoid;
            }
          }
        </style>
      </head>
      <body>
        <div class="kot-container">
        <div class="header">
          <div class="restaurant-name">${Me.name}</div>
          <div>KITCHEN ORDER TICKET</div>
        </div>
        
        <div class="order-info">
          <p><strong>Order #:</strong> ${ze.orderNumber}</p>
          <p><strong>Table:</strong> ${rt.number} (${rt.area})</p>
          <p><strong>Date/Time:</strong> ${ze.createdAt.toLocaleString()}</p>
          <p><strong>Staff:</strong> ${ze.staffId}</p>
        </div>
        
        <table class="items">
          <thead>
            <tr>
              <th>Qty</th>
              <th>Item</th>
              <th>Notes</th>
            </tr>
          </thead>
          <tbody>
            ${ze.items.map(ht=>`
              <tr>
                <td>${ht.quantity}</td>
                <td>${ht.name}</td>
                <td>${ht.notes||""}</td>
              </tr>
            `).join("")}
          </tbody>
        </table>
        
        ${ze.notes?`
            <div class="order-notes">
            <strong>Order Notes:</strong><br>
            ${ze.notes}
          </div>
        `:""}
        
        <div class="footer">
          <p>*** KITCHEN COPY ***</p>
          <p>Printed at: ${new Date().toLocaleString()}</p>
          </div>
        </div>
      </body>
      </html>
    `,Y=()=>{if(te&&t){const ze=s.find(Me=>Me.number===te.tableNumber);if(ze){const Me={orderNumber:te.orderNumber,items:te.items,createdAt:new Date,staffId:(e==null?void 0:e.name)||"Voice Order",notes:`Voice order placed at ${new Date().toLocaleTimeString()}`},rt=Ie(Me,t,ze),ht=window.open("","_blank");ht&&(ht.document.write(rt),ht.document.close(),ht.focus(),ht.print(),ht.close()),Z.success("KOT sent to kitchen")}}},H=R.useCallback(async(ze=!1)=>{var Me;if(t)try{p(!0),ze&&(fs.clearCache(t.id),g(!0));const[rt,ht]=await Promise.all([fs.getTablesForRestaurant(t.id),uA.getTableAreasForRestaurant(t.id)]);if(rt.success&&rt.data){n(rt.data);const Qe=[...new Set(rt.data.map(Ge=>Ge.area))].sort();o(Qe),h(new Date),console.log(`Debug: tables.length = ${rt.data.length}, tableAreas.length = ${((Me=ht.data)==null?void 0:Me.length)||0}, isLoading = false`),ze&&Z.success("Tables synchronized successfully")}else Z.error(rt.error||"Failed to load tables")}catch{Z.error("Failed to load tables")}finally{p(!1),g(!1)}},[t]);R.useEffect(()=>{if(!t)return;console.log(" Tables: Setting up real-time table subscription"),p(!0);const ze=fs.subscribeToTables(t.id,Me=>{console.log(" Tables: Real-time table update received:",{count:Me.length,tables:Me.map(ht=>({number:ht.number,status:ht.status}))}),n(Me);const rt=[...new Set(Me.map(ht=>ht.area))].sort();o(rt),h(new Date),p(!1),g(!1),G.current?G.current=!1:console.log(" Tables: Table status updated in real-time")});return()=>{console.log(" Tables: Cleaning up real-time table subscription"),ze()}},[t]);const je=R.useCallback(async()=>{if(t)try{if(s.length===0){console.log(" No tables found, initializing default tables...");const ze=await fs.initializeDefaultTables(t.id);if(ze.success&&ze.data){n(ze.data);const Me=[...new Set(ze.data.map(rt=>rt.area))].sort();o(Me),h(new Date),Z.success("Welcome! Default tables have been created for you.")}}}catch(ze){console.error("Failed to initialize default tables:",ze)}},[t]);R.useEffect(()=>{t&&(H(),setTimeout(()=>{u1.autoFixWithNotification(t.id)},3e3))},[t]),R.useEffect(()=>{t&&s.length===0&&!f&&je()},[t,s.length,f,je]),R.useEffect(()=>{t&&s.length>0&&!G.current&&setTimeout(()=>{u1.autoFixWithNotification(t.id)},3e3)},[t,s.length]);const Ce=async()=>{if(t)try{g(!0),fs.clearCache(t.id),setTimeout(()=>{Z.success("Tables synchronized successfully"),g(!1)},1e3)}catch{Z.error("Failed to sync tables"),g(!1)}},oe=ze=>{ze.status==="available"&&r(`/${t==null?void 0:t.slug}/order/${ze.id}`)};R.useEffect(()=>{const ze=Me=>{const{tableId:rt,newStatus:ht}=Me.detail;console.log(" Tables: Received table status update event:",{tableId:rt,newStatus:ht})};return window.addEventListener("tableStatusUpdated",ze),()=>{window.removeEventListener("tableStatusUpdated",ze)}},[]);const He=async ze=>{if(t)try{const Me=await fs.createTable({restaurantId:t.id,number:ze.number,area:ze.area,areaId:ze.area.toLowerCase().replace(/\s+/g,"-"),capacity:ze.capacity,status:"available",isActive:!0});Me.success&&Me.data?(n(rt=>[...rt,Me.data]),i.includes(ze.area)||o(rt=>[...rt,ze.area].sort()),Z.success(`Table ${ze.number} created successfully!`),v(!1),I()):Z.error(Me.error||"Failed to create table")}catch{Z.error("Failed to create table")}},ie=async ze=>{i.includes(ze.areaName)?Z.error("Area already exists"):(o(Me=>[...Me,ze.areaName].sort()),Z.success(`Area "${ze.areaName}" added successfully!`),E(!1),ee())},le=async(ze,Me)=>{if(t)try{if(Me==="available"){if(!confirm(`Marking Table ${ze.number} as available will cancel all active orders for this table. Are you sure you want to proceed?`))return;const{OrderService:Qe}=await Pn(async()=>{const{OrderService:gt}=await Promise.resolve().then(()=>d1);return{OrderService:gt}},void 0);Qe.clearCache(t.id);const Ge=await Qe.getOrdersByTable(t.id,ze.id);if(Ge.success&&Ge.data){const gt=Ge.data.filter(St=>["placed","confirmed","preparing","ready"].includes(St.status)||St.status==="completed"&&St.paymentStatus!=="paid");if(gt.length>0){console.log(` Tables: Cancelling ${gt.length} active orders for table ${ze.number}`);const St=gt.map(async qe=>Qe.updateOrderStatus(qe.id,t.id,"cancelled",{notes:`Table manually marked as available - orders cancelled automatically at ${new Date().toLocaleString()}`}));if(!(await Promise.all(St)).every(qe=>qe.success)){Z.error("Failed to cancel some orders. Please try again.");return}Z.success(`${gt.length} order(s) cancelled for Table ${ze.number}`)}Qe.clearCache(t.id)}}const rt=await fs.updateTable(ze.id,t.id,{status:Me});if(rt.success&&rt.data)if(n(ht=>ht.map(Qe=>Qe.id===ze.id?rt.data:Qe)),Me==="available"){console.log(` Tables: Forcing data refresh after marking table ${ze.number} as available`);const{OrderService:ht}=await Pn(async()=>{const{OrderService:Qe}=await Promise.resolve().then(()=>d1);return{OrderService:Qe}},void 0);ht.clearCache(t.id),setTimeout(()=>{H()},500),Z.success(`Table ${ze.number} marked as available and all orders cancelled`)}else Z.success(`Table ${ze.number} ${Me}`);else Z.error(rt.error||"Failed to update table")}catch(rt){console.error("Error updating table status:",rt),Z.error("Failed to update table")}},ae=ze=>{w(ze),U("number",ze.number),U("area",ze.area),U("capacity",ze.capacity),j(!0)},ve=async ze=>{if(!(!t||!C))try{const Me=await fs.updateTable(C.id,t.id,{number:ze.number,area:ze.area,areaId:ze.area.toLowerCase().replace(/\s+/g,"-"),capacity:ze.capacity});Me.success&&Me.data?(n(rt=>rt.map(ht=>ht.id===C.id?Me.data:ht)),i.includes(ze.area)||o(rt=>[...rt,ze.area].sort()),Z.success(`Table ${ze.number} updated successfully!`),j(!1),w(null),I()):Z.error(Me.error||"Failed to update table")}catch{Z.error("Failed to update table")}},we=async ze=>{if(!(!t||!confirm(`Delete Table ${ze.number}?`)))try{const Me=await fs.deleteTable(ze.id,t.id);Me.success?(n(rt=>rt.filter(ht=>ht.id!==ze.id)),Z.success("Table deleted successfully")):Z.error(Me.error||"Failed to delete table")}catch{Z.error("Failed to delete table")}},De=R.useCallback(ze=>{const{command:Me}=ze.detail;if(console.log(" Tables: Voice table status command received:",Me),!Me.tableNumber){Z.error(" Please specify table number for status update");return}const rt=s.find(gt=>parseInt(gt.number)===Me.tableNumber);if(!rt){Z.error(` Table ${Me.tableNumber} not found`);return}const ht={occupied:"occupied",available:"available",reserved:"reserved",cleaning:"cleaning",busy:"occupied",free:"available",empty:"available",clean:"cleaning"},Qe=Me.originalText.toLowerCase();let Ge=null;for(const[gt,St]of Object.entries(ht))if(Qe.includes(gt)){Ge=St,console.log(` Detected status keyword: ${gt} -> ${St}`);break}Ge?(console.log(` Updating table ${rt.number} from ${rt.status} to ${Ge}`),le(rt,Ge),Z.success(` Table ${rt.number} status changed to ${Ge}`)):(console.log(` No status keyword found in: "${Qe}"`),Z.error(` Please specify status for table ${rt.number}: available, occupied, reserved, or cleaning`))},[s,le]),Ve=R.useCallback(async ze=>{const{command:Me}=ze.detail;if(console.log(" Tables: Voice order command received:",Me),!t||!e){Z.error(" Unable to process order at this time");return}if(!Me.tableNumber){Z.error(" Please specify table number for placing order");return}const rt=s.find(ht=>parseInt(ht.number)===Me.tableNumber);if(!rt){Z.error(` Table ${Me.tableNumber} not found`);return}if(rt)if(console.log(" Tables: Found table:",{id:rt.id,number:rt.number,status:rt.status}),Me.menuItems&&Me.menuItems.length>0){console.log(" Tables: Processing voice order on current page"),Z.dismiss(),F(!0),k("processing"),q("Processing voice command...");try{k("placing"),q("Creating your order..."),setTimeout(async()=>{var ht;try{if(!t||!e)throw new Error("Restaurant or user not available");const{MenuService:Qe}=await Pn(async()=>{const{MenuService:We}=await Promise.resolve().then(()=>yB);return{MenuService:We}},void 0),{OrderService:Ge}=await Pn(async()=>{const{OrderService:We}=await Promise.resolve().then(()=>d1);return{OrderService:We}},void 0),{TableService:gt}=await Pn(async()=>{const{TableService:We}=await Promise.resolve().then(()=>gB);return{TableService:We}},void 0),{VoiceService:St}=await Pn(async()=>{const{VoiceService:We}=await Promise.resolve().then(()=>eM);return{VoiceService:We}},void 0),Vt=await Qe.getMenuItemsForRestaurant(t.id);if(!Vt.success||!Vt.data)throw new Error("Failed to load menu items");const Kt=Vt.data;console.log(" Tables: Using AI to match voice items to menu items...");const qe=await St.matchMenuItemsIntelligently(Me.menuItems,Kt),Xe=[];for(const We of qe)if(We.matchedItem){console.log(` Tables: AI matched "${We.name}"  "${We.matchedItem.name}"`);const Ft={id:We.matchedItem.id,menuItemId:We.matchedItem.id,name:We.matchedItem.name,price:We.matchedItem.price,quantity:We.quantity,total:We.matchedItem.price*We.quantity,variants:[],notes:`Voice order: "${We.name}" matched to "${We.matchedItem.name}" at ${new Date().toLocaleTimeString()}`};Xe.push(Ft)}else console.warn(` Tables: No match found for voice item: ${We.name}`);if(Xe.length===0)throw new Error("No valid menu items found");await gt.updateTable(rt.id,t.id,{status:"occupied"});const Ke=await Ge.createOrder(t.id,rt.id,e.id,Xe,((ht=t.settings)==null?void 0:ht.taxRate)||8.5,`Voice order: ${Me.menuItems.map(We=>`${We.quantity}x ${We.name}`).join(", ")} - placed at ${new Date().toLocaleTimeString()}`);if(Ke.success&&Ke.data){const We=Ke.data;console.log(" Tables: Voice order created successfully:",{orderId:We.id,orderNumber:We.orderNumber}),k("completed"),q("Order placed successfully!"),W({orderNumber:We.orderNumber,tableNumber:rt.number,items:qe.filter(Ft=>Ft.matchedItem).map(Ft=>{var Ct;return{name:((Ct=Ft.matchedItem)==null?void 0:Ct.name)||Ft.name,quantity:Ft.quantity}})}),setTimeout(()=>{F(!1);const Ft=qe.filter(xr=>xr.matchedItem),Ct=qe.filter(xr=>!xr.matchedItem);if(Ft.length>0){const xr=Ft.map(vr=>{var Pr;return`${vr.quantity}x ${(Pr=vr.matchedItem)==null?void 0:Pr.name}`}).join(", ");Z.success(` Voice order completed: ${xr} placed for table ${rt.number}!`,{duration:4e3})}if(Ct.length>0){const xr=Ct.map(vr=>vr.name).join(", ");Z.error(` Items not found: ${xr}`)}setTimeout(()=>{console.log(" Tables: Generating KOT for ghost order...");const xr=`
                      <!DOCTYPE html>
                      <html>
                      <head>
                        <title>KOT - ${We.orderNumber}</title>
                        <style>
                          body { 
                            font-family: 'Courier New', monospace; 
                            margin: 0; 
                            padding: 0 10px; 
                            width: 100%;
                            background: #fff;
                          }
                          .kot-container {
                            width: 100%;
                            padding: 15px 5px;
                            min-height: auto;
                          }
                          .header { 
                            text-align: center; 
                            border-bottom: 2px solid #000; 
                            padding-bottom: 10px; 
                            margin-bottom: 15px; 
                          }
                          .restaurant-name { 
                            font-size: 18px; 
                            font-weight: bold; 
                            margin-bottom: 5px;
                          }
                          .order-info { 
                            margin-bottom: 15px; 
                            line-height: 1.4;
                          }
                          .items { 
                            border-collapse: collapse; 
                            width: 100%; 
                            margin: 15px 0;
                          }
                          .items th, .items td { 
                            border: 1px solid #000; 
                            padding: 8px; 
                            text-align: left; 
                            font-size: 13px;
                          }
                          .items th { 
                            background-color: #f0f0f0; 
                            font-weight: bold;
                          }
                          .footer { 
                            margin-top: 20px; 
                            text-align: center; 
                            font-size: 12px; 
                            border-top: 1px dashed #000;
                            padding-top: 15px;
                          }
                          .order-notes {
                            margin-top: 15px; 
                            padding: 10px; 
                            border: 1px solid #000;
                            background: #f9f9f9;
                          }
                          @media print {
                            body { 
                              margin: 0; 
                              padding: 0 8px;
                              width: 100%;
                            }
                            .kot-container {
                              padding: 10px 0;
                              width: 100%;
                              min-height: auto;
                            }
                            .no-print { display: none; }
                            .header, .order-info, .items, .order-notes, .footer {
                              page-break-inside: avoid;
                            }
                          }
                        </style>
                      </head>
                      <body>
                        <div class="kot-container">
                        <div class="header">
                          <div class="restaurant-name">${t.name}</div>
                          <div>KITCHEN ORDER TICKET</div>
                        </div>
                        
                        <div class="order-info">
                          <p><strong>Order #:</strong> ${We.orderNumber}</p>
                          <p><strong>Table:</strong> ${rt.number} (${rt.area})</p>
                          <p><strong>Date/Time:</strong> ${We.createdAt.toLocaleString()}</p>
                          <p><strong>Staff:</strong> ${We.staffId}</p>
                        </div>
                        
                        <table class="items">
                          <thead>
                            <tr>
                              <th>Qty</th>
                              <th>Item</th>
                              <th>Notes</th>
                            </tr>
                          </thead>
                          <tbody>
                            ${We.items.map(Pr=>`
                              <tr>
                                <td>${Pr.quantity}</td>
                                <td>${Pr.name}</td>
                                <td>${Pr.notes||""}</td>
                              </tr>
                            `).join("")}
                          </tbody>
                        </table>
                        
                        ${We.notes?`
                            <div class="order-notes">
                            <strong>Order Notes:</strong><br>
                            ${We.notes}
                          </div>
                        `:""}
                        
                        <div class="footer">
                          <p>*** KITCHEN COPY ***</p>
                          <p>Printed at: ${new Date().toLocaleString()}</p>
                          </div>
                        </div>
                      </body>
                      </html>
                    `,vr=window.open("","_blank");vr&&(vr.document.write(xr),vr.document.close(),vr.focus(),vr.print(),vr.close(),Z.success(" KOT sent to kitchen!"),console.log(" Tables: KOT generated and sent to kitchen"))},500)},1e3)}else throw new Error(Ke.error||"Failed to create order")}catch(Qe){console.error(" Tables: Voice order failed:",Qe),F(!1),Z.error(` Voice order failed: ${Qe instanceof Error?Qe.message:"Unknown error"}`)}},500)}catch(ht){console.error(" Tables: Voice order processing failed:",ht),F(!1),Z.error(" Failed to process voice order")}}else console.log(" Tables: No menu items in command, navigating to order page"),r(`/${t.slug}/order/${rt.id}`);else Z.error(`Table ${Me.tableNumber} not found.`)},[t,e,s,r,H]),me=R.useCallback(async ze=>{const{command:Me}=ze.detail;if(console.log(" Tables: Voice payment command received:",Me),!Me.tableNumber){Z.error(" Please specify table number for payment");return}const rt=s.find(ht=>parseInt(ht.number)===Me.tableNumber);if(!rt){Z.error(` Table ${Me.tableNumber} not found`);return}if(rt.status!=="occupied"){Z.error(` Table ${Me.tableNumber} is ${rt.status}, no orders to pay for`);return}console.log(" Tables: Navigating to order page for payment processing"),r(`/${t==null?void 0:t.slug}/order/${rt.id}`),setTimeout(()=>{console.log(" Tables: Re-dispatching payment command for TakeOrder component");const ht=new CustomEvent("voicePaymentCommand",{detail:{command:Me}});window.dispatchEvent(ht)},1500),Z.success(` Opening payment for table ${rt.number}...`)},[s,r,t]),Fe=R.useCallback(async ze=>{const{command:Me}=ze.detail;if(console.log(" Tables: Voice KOT print command received:",Me),!Me.tableNumber){Z.error(" Please specify table number for KOT printing");return}const rt=s.find(ht=>parseInt(ht.number)===Me.tableNumber);if(!rt){Z.error(` Table ${Me.tableNumber} not found`);return}if(rt.status!=="occupied"){Z.error(` Table ${Me.tableNumber} is ${rt.status}, no orders to print KOT for`);return}console.log(" Tables: Navigating to order page for KOT printing"),r(`/${t==null?void 0:t.slug}/order/${rt.id}`),setTimeout(()=>{console.log(" Tables: Re-dispatching KOT print command for TakeOrder component");const ht=new CustomEvent("voiceKotPrintCommand",{detail:{command:Me}});window.dispatchEvent(ht)},1500),Z.success(` Opening KOT printing for table ${rt.number}...`)},[s,r,t]),Re=R.useCallback(async ze=>{const{command:Me}=ze.detail;if(console.log(" Tables: Voice order cancel command received:",Me),!Me.tableNumber){Z.error(" Please specify table number for order cancellation");return}const rt=s.find(ht=>parseInt(ht.number)===Me.tableNumber);if(!rt){Z.error(` Table ${Me.tableNumber} not found`);return}if(rt.status!=="occupied"){Z.error(` Table ${Me.tableNumber} is ${rt.status}, no orders to cancel`);return}console.log(" Tables: Navigating to order page for order cancellation"),r(`/${t==null?void 0:t.slug}/order/${rt.id}`),setTimeout(()=>{console.log(" Tables: Re-dispatching order cancel command for TakeOrder component");const ht=new CustomEvent("voiceOrderCancelCommand",{detail:{command:Me}});window.dispatchEvent(ht)},1500),Z.success(` Opening order cancellation for table ${rt.number}...`)},[s,r,t]),Be=R.useCallback(async ze=>{const{command:Me}=ze.detail;if(console.log(" Tables: Voice table merge command received:",Me),!Me.tableNumber||!Me.targetTableNumber){Z.error(" Please specify both source and target table numbers for merging");return}const rt=s.find(Ge=>parseInt(Ge.number)===Me.tableNumber),ht=s.find(Ge=>parseInt(Ge.number)===Me.targetTableNumber);if(!rt){Z.error(` Source table ${Me.tableNumber} not found`);return}if(!ht){Z.error(` Target table ${Me.targetTableNumber} not found`);return}if(rt.status!=="occupied"){Z.error(` Source table ${Me.tableNumber} has no orders to merge`);return}confirm(`Merge all orders from Table ${rt.number} to Table ${ht.number}?`)&&(await le(rt,"available"),await le(ht,"occupied"),Z.success(` Orders merged from table ${rt.number} to table ${ht.number}`))},[s,le]),X=R.useCallback(async ze=>{const{command:Me}=ze.detail;if(console.log(" Tables: Voice table transfer command received:",Me),!Me.tableNumber||!Me.targetTableNumber){Z.error(" Please specify both source and target table numbers for transfer");return}const rt=s.find(Ge=>parseInt(Ge.number)===Me.tableNumber),ht=s.find(Ge=>parseInt(Ge.number)===Me.targetTableNumber);if(!rt){Z.error(` Source table ${Me.tableNumber} not found`);return}if(!ht){Z.error(` Target table ${Me.targetTableNumber} not found`);return}if(rt.status!=="occupied"){Z.error(` Source table ${Me.tableNumber} has no orders to transfer`);return}if(ht.status!=="available"){Z.error(` Target table ${Me.targetTableNumber} is not available`);return}confirm(`Transfer all orders from Table ${rt.number} to Table ${ht.number}?`)&&(await le(rt,"available"),await le(ht,"occupied"),Z.success(` Orders transferred from table ${rt.number} to table ${ht.number}`))},[s,le]),_e=R.useCallback(async ze=>{var Ge,gt;const{command:Me}=ze.detail;if(console.log(" Tables: Voice customer command received:",Me),!t){Z.error(" Restaurant context not available");return}const{customerName:rt,customerPhone:ht,customerEmail:Qe}=Me;if(!rt&&!ht){Z.error(" Please specify customer name or phone number");return}try{const St={name:rt||"",phone:ht||"",email:Qe||"",address:"",preferences:["voice_added"]};console.log(" Creating customer via voice:",St);const{CustomerService:Vt}=await Pn(async()=>{const{CustomerService:qe}=await Promise.resolve().then(()=>jM);return{CustomerService:qe}},void 0),Kt=await Vt.createCustomer(t.id,St);if(Kt.success){const qe=rt||`Customer with phone ${ht}`;Z.success(` Successfully added ${qe} to CRM!`),Qe&&Z.success(` Email ${Qe} saved for ${qe}`),console.log(" Customer created successfully:",Kt.data)}else console.error(" Customer creation failed:",Kt.error),(Ge=Kt.error)!=null&&Ge.includes("already exists")||(gt=Kt.error)!=null&&gt.includes("duplicate")?Z.error(" Customer with this information already exists in CRM"):Z.error(` Failed to add customer: ${Kt.error||"Unknown error"}`)}catch(St){console.error(" Error creating customer:",St),Z.error(" Failed to add customer to CRM")}},[t]),ke=R.useCallback(async ze=>{var ht;const{command:Me}=ze.detail;if(console.log(" Tables: Voice place order command received (ghost ordering):",Me),!t||!e){Z.error(" Unable to place order at this time");return}if(!Me.tableNumber){Z.error(" Please specify table number for placing order");return}const rt=s.find(Qe=>parseInt(Qe.number)===Me.tableNumber);if(!rt){Z.error(` Table ${Me.tableNumber} not found`);return}if(!Me.menuItems||Me.menuItems.length===0){console.log(" Tables: No menu items, navigating to order page instead"),r(`/${t.slug}/order/${rt.id}`);return}try{console.log(" Tables: Starting ghost ordering process...");const{MenuService:Qe}=await Pn(async()=>{const{MenuService:Xe}=await Promise.resolve().then(()=>yB);return{MenuService:Xe}},void 0),{OrderService:Ge}=await Pn(async()=>{const{OrderService:Xe}=await Promise.resolve().then(()=>d1);return{OrderService:Xe}},void 0),{TableService:gt}=await Pn(async()=>{const{TableService:Xe}=await Promise.resolve().then(()=>gB);return{TableService:Xe}},void 0),St=await Qe.getMenuItemsForRestaurant(t.id);if(!St.success||!St.data)throw new Error("Failed to load menu items");const Vt=St.data;console.log(" Tables: Loaded menu items for matching");const Kt=[];for(const Xe of Me.menuItems){const We=(Ft=>{const Ct=vr=>vr.toLowerCase().replace(/s$/,"").replace(/ies$/,"y").replace(/es$/,"").trim(),xr=Ft.toLowerCase().split(" ").map(Ct);return Vt.find(vr=>{const Pr=vr.name.toLowerCase().split(" ").map(Ct);return xr.every(Mr=>Pr.some(Jr=>Jr.includes(Mr)||Mr.includes(Jr)))})})(Xe.name);if(We){console.log(` Tables: Found menu item: ${We.name} for voice item: ${Xe.name}`);const Ft={id:We.id,menuItemId:We.id,name:We.name,price:We.price,quantity:Xe.quantity,total:We.price*Xe.quantity,variants:[],notes:`Voice order placed from Tables page at ${new Date().toLocaleTimeString()}`};Kt.push(Ft)}else console.warn(` Tables: Menu item not found: ${Xe.name}`),Z.error(`Menu item "${Xe.name}" not found`)}if(Kt.length===0){Z.error(" No valid menu items found to place order");return}console.log(" Tables: Creating order directly in background...",{cartItems:Kt}),await gt.updateTable(rt.id,t.id,{status:"occupied"});const qe=await Ge.createOrder(t.id,rt.id,e.id,Kt,((ht=t.settings)==null?void 0:ht.taxRate)||8.5,`Voice order: ${Me.menuItems.map(Xe=>`${Xe.quantity}x ${Xe.name}`).join(", ")} - placed at ${new Date().toLocaleTimeString()}`);if(qe.success&&qe.data){const Xe=qe.data;console.log(" Tables: Ghost order created successfully:",{orderId:Xe.id,orderNumber:Xe.orderNumber});const Ke=Me.menuItems.map(We=>`${We.quantity}x ${We.name}`).join(", ");Z.success(` Order placed successfully: ${Ke} for table ${rt.number}!`),setTimeout(()=>{console.log(" Tables: Generating KOT for ghost order...");const We=`
            <!DOCTYPE html>
            <html>
            <head>
              <title>KOT - ${Xe.orderNumber}</title>
              <style>
                body { 
                  font-family: 'Courier New', monospace; 
                  margin: 0; 
                  padding: 0 10px; 
                  width: 100%;
                  background: #fff;
                }
                .kot-container {
                  width: 100%;
                  padding: 15px 5px;
                  min-height: auto;
                }
                .header { 
                  text-align: center; 
                  border-bottom: 2px solid #000; 
                  padding-bottom: 10px; 
                  margin-bottom: 15px; 
                }
                .restaurant-name { 
                  font-size: 18px; 
                  font-weight: bold; 
                  margin-bottom: 5px;
                }
                .order-info { 
                  margin-bottom: 15px; 
                  line-height: 1.4;
                }
                .items { 
                  border-collapse: collapse; 
                  width: 100%; 
                  margin: 15px 0;
                }
                .items th, .items td { 
                  border: 1px solid #000; 
                  padding: 8px; 
                  text-align: left; 
                  font-size: 13px;
                }
                .items th { 
                  background-color: #f0f0f0; 
                  font-weight: bold;
                }
                .footer { 
                  margin-top: 20px; 
                  text-align: center; 
                  font-size: 12px; 
                  border-top: 1px dashed #000;
                  padding-top: 15px;
                }
                .order-notes {
                  margin-top: 15px; 
                  padding: 10px; 
                  border: 1px solid #000;
                  background: #f9f9f9;
                }
                @media print {
                  body { 
                    margin: 0; 
                    padding: 0 8px;
                    width: 100%;
                  }
                  .kot-container {
                    padding: 10px 0;
                    width: 100%;
                    min-height: auto;
                  }
                  .no-print { display: none; }
                  .header, .order-info, .items, .order-notes, .footer {
                    page-break-inside: avoid;
                  }
                }
              </style>
            </head>
            <body>
              <div class="kot-container">
              <div class="header">
                <div class="restaurant-name">${t.name}</div>
                <div>KITCHEN ORDER TICKET</div>
              </div>
              
              <div class="order-info">
                <p><strong>Order #:</strong> ${Xe.orderNumber}</p>
                <p><strong>Table:</strong> ${rt.number} (${rt.area})</p>
                <p><strong>Date/Time:</strong> ${Xe.createdAt.toLocaleString()}</p>
                <p><strong>Staff:</strong> ${Xe.staffId}</p>
              </div>
              
              <table class="items">
                <thead>
                  <tr>
                    <th>Qty</th>
                    <th>Item</th>
                    <th>Notes</th>
                  </tr>
                </thead>
                <tbody>
                  ${Xe.items.map(Ct=>`
                    <tr>
                      <td>${Ct.quantity}</td>
                      <td>${Ct.name}</td>
                      <td>${Ct.notes||""}</td>
                    </tr>
                  `).join("")}
                </tbody>
              </table>
              
              ${Xe.notes?`
                  <div class="order-notes">
                  <strong>Order Notes:</strong><br>
                  ${Xe.notes}
                </div>
              `:""}
              
              <div class="footer">
                <p>*** KITCHEN COPY ***</p>
                <p>Printed at: ${new Date().toLocaleString()}</p>
                </div>
              </div>
            </body>
            </html>
          `,Ft=window.open("","_blank");Ft&&(Ft.document.write(We),Ft.document.close(),Ft.focus(),Ft.print(),Ft.close(),Z.success(" KOT sent to kitchen!"),console.log(" Tables: KOT generated and sent to kitchen"))},500)}else throw new Error(qe.error||"Failed to create order")}catch(Qe){console.error(" Tables: Ghost ordering failed:",Qe),Z.error(" Failed to place order. Please try manually.")}},[t,e,s,r,H]);R.useEffect(()=>(window.addEventListener("voiceTableStatusCommand",De),window.addEventListener("voiceOrderCommand",Ve),window.addEventListener("voicePlaceOrderCommand",ke),window.addEventListener("voicePaymentCommand",me),window.addEventListener("voiceKotPrintCommand",Fe),window.addEventListener("voiceOrderCancelCommand",Re),window.addEventListener("voiceTableMergeCommand",Be),window.addEventListener("voiceTableTransferCommand",X),window.addEventListener("voiceCustomerCommand",_e),()=>{window.removeEventListener("voiceTableStatusCommand",De),window.removeEventListener("voiceOrderCommand",Ve),window.removeEventListener("voicePlaceOrderCommand",ke),window.removeEventListener("voicePaymentCommand",me),window.removeEventListener("voiceKotPrintCommand",Fe),window.removeEventListener("voiceOrderCancelCommand",Re),window.removeEventListener("voiceTableMergeCommand",Be),window.removeEventListener("voiceTableTransferCommand",X),window.removeEventListener("voiceCustomerCommand",_e)}),[De,Ve,ke,me,Fe,Re,Be,X,_e]);const lt=s.filter(ze=>{const Me=l==="all"||ze.area===l,rt=d==="all"||ze.status===d;return Me&&rt}),pt={total:s.length,available:s.filter(ze=>ze.status==="available").length,occupied:s.filter(ze=>ze.status==="occupied").length,reserved:s.filter(ze=>ze.status==="reserved").length,cleaning:s.filter(ze=>ze.status==="cleaning").length};return t?a.jsxs("div",{className:"min-h-screen",style:{background:"var(--color-background)"},children:[a.jsxs("main",{className:"max-w-7xl mx-auto px-3 sm:px-4 lg:px-6 xl:px-8 py-4 sm:py-6 lg:py-8",children:[a.jsx("div",{className:"mb-8",children:a.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[a.jsxs("div",{className:"min-w-0 flex-1",children:[a.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"Table Management"}),a.jsxs("div",{className:"flex flex-wrap items-center gap-x-4 gap-y-1 text-sm text-gray-600 mt-2",children:[a.jsxs("span",{children:[pt.total," total tables"]}),a.jsxs("span",{className:"text-green-600",children:[pt.available," available"]}),a.jsxs("span",{className:"text-red-600",children:[pt.occupied," occupied"]}),A&&a.jsxs("span",{className:"text-gray-500",children:["Last sync: ",A.toLocaleTimeString()]})]})]}),a.jsxs("div",{className:"hidden lg:flex items-center space-x-3",children:[a.jsx("button",{onClick:Ce,disabled:m,className:"p-2 text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",title:"Sync with server and fix areas",children:a.jsx(Di,{className:`w-5 h-5 ${m?"animate-spin":""}`})}),a.jsx("button",{onClick:async()=>{t&&await u1.autoFixWithNotification(t.id)},className:"p-2 text-blue-600 hover:bg-blue-100 rounded-lg transition-colors",title:"Fix table statuses (occupied tables without orders)",children:a.jsx(Sl,{className:"w-5 h-5"})}),a.jsxs("button",{onClick:()=>r(`/${t==null?void 0:t.slug}/takeaway`),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-orange-600 hover:bg-orange-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500",title:"Manage takeaway orders",children:[a.jsx(Hs,{className:"w-4 h-4 mr-2"}),"Takeaway Orders"]}),a.jsxs("button",{onClick:()=>r("settings"),className:"btn btn-secondary",title:"Manage table areas and settings",children:[a.jsx(Sl,{className:"w-4 h-4 mr-2"}),"Settings"]}),a.jsxs("button",{onClick:()=>E(!0),className:"btn btn-secondary",children:[a.jsx(ta,{className:"w-4 h-4 mr-2"}),"Add Area"]}),a.jsxs("button",{onClick:()=>v(!0),className:"btn btn-theme-primary",children:[a.jsx(zr,{className:"w-4 h-4 mr-2"}),"Add Table"]})]}),a.jsx("div",{className:"lg:hidden",children:a.jsxs("div",{className:"flex flex-wrap gap-2",children:[a.jsx("button",{onClick:Ce,disabled:m,className:"p-2 text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",title:"Sync with server and fix areas",children:a.jsx(Di,{className:`w-5 h-5 ${m?"animate-spin":""}`})}),a.jsx("button",{onClick:async()=>{t&&await u1.autoFixWithNotification(t.id)},className:"p-2 text-blue-600 hover:bg-blue-100 rounded-lg transition-colors",title:"Fix table statuses (occupied tables without orders)",children:a.jsx(Sl,{className:"w-5 h-5"})}),a.jsxs("button",{onClick:()=>r(`/${t==null?void 0:t.slug}/takeaway`),className:"btn btn-secondary text-sm px-3 py-2 bg-orange-600 hover:bg-orange-700 text-white border-orange-600",title:"Manage takeaway orders",children:[a.jsx(Hs,{className:"w-4 h-4 sm:mr-2"}),a.jsx("span",{className:"hidden sm:inline",children:"Takeaway"})]}),a.jsxs("button",{onClick:()=>r("settings"),className:"btn btn-secondary text-sm px-3 py-2",title:"Manage table areas and settings",children:[a.jsx(Sl,{className:"w-4 h-4 sm:mr-2"}),a.jsx("span",{className:"hidden sm:inline",children:"Settings"})]}),a.jsxs("button",{onClick:()=>E(!0),className:"btn btn-secondary text-sm px-3 py-2",children:[a.jsx(ta,{className:"w-4 h-4 sm:mr-2"}),a.jsx("span",{className:"hidden sm:inline",children:"Add Area"})]}),a.jsxs("button",{onClick:()=>v(!0),className:"btn btn-theme-primary text-sm px-3 py-2",children:[a.jsx(zr,{className:"w-4 h-4 sm:mr-2"}),a.jsx("span",{className:"hidden sm:inline",children:"Add Table"})]})]})})]})}),a.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-5 gap-3 sm:gap-4 mb-8",children:[a.jsxs("div",{className:"card p-3 sm:p-4 text-center",children:[a.jsx("div",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:pt.total}),a.jsx("div",{className:"text-xs sm:text-sm text-gray-600",children:"Total Tables"})]}),a.jsxs("div",{className:"card p-3 sm:p-4 text-center",children:[a.jsx("div",{className:"text-xl sm:text-2xl font-bold text-green-600",children:pt.available}),a.jsx("div",{className:"text-xs sm:text-sm text-gray-600",children:"Available"})]}),a.jsxs("div",{className:"card p-3 sm:p-4 text-center",children:[a.jsx("div",{className:"text-xl sm:text-2xl font-bold text-red-600",children:pt.occupied}),a.jsx("div",{className:"text-xs sm:text-sm text-gray-600",children:"Occupied"})]}),a.jsxs("div",{className:"card p-3 sm:p-4 text-center",children:[a.jsx("div",{className:"text-xl sm:text-2xl font-bold text-yellow-600",children:pt.reserved}),a.jsx("div",{className:"text-xs sm:text-sm text-gray-600",children:"Reserved"})]}),a.jsxs("div",{className:"card p-3 sm:p-4 text-center col-span-2 sm:col-span-1",children:[a.jsx("div",{className:"text-xl sm:text-2xl font-bold text-blue-600",children:pt.cleaning}),a.jsx("div",{className:"text-xs sm:text-sm text-gray-600",children:"Cleaning"})]})]}),a.jsx("div",{className:"card p-4 mb-6",children:a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Filter by Area"}),a.jsxs("select",{value:l,onChange:ze=>c(ze.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsxs("option",{value:"all",children:["All Areas (",s.length,")"]}),i.map(ze=>a.jsxs("option",{value:ze,children:[ze," (",s.filter(Me=>Me.area===ze).length,")"]},ze))]})]}),a.jsxs("div",{className:"flex-1",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Filter by Status"}),a.jsxs("select",{value:d,onChange:ze=>u(ze.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"all",children:"All Status"}),a.jsx("option",{value:"available",children:"Available"}),a.jsx("option",{value:"occupied",children:"Occupied"}),a.jsx("option",{value:"reserved",children:"Reserved"}),a.jsx("option",{value:"cleaning",children:"Cleaning"}),a.jsx("option",{value:"out_of_service",children:"Out of Service"})]})]})]})}),f?a.jsxs("div",{className:"text-center py-12",children:[a.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Loading tables..."})]}):s.length===0?a.jsxs("div",{className:"text-center py-12",children:[a.jsx(GA,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No tables yet"}),a.jsx("p",{className:"text-gray-600 mb-6",children:"Get started by creating your first table or area."}),a.jsxs("div",{className:"flex justify-center space-x-3",children:[a.jsxs("button",{onClick:()=>E(!0),className:"btn btn-secondary",children:[a.jsx(ta,{className:"w-4 h-4 mr-2"}),"Create Area"]}),a.jsxs("button",{onClick:()=>v(!0),className:"btn btn-theme-primary",children:[a.jsx(zr,{className:"w-4 h-4 mr-2"}),"Create Table"]})]})]}):a.jsx("div",{className:"space-y-8",children:i.map(ze=>{const Me=lt.filter(rt=>rt.area===ze);return Me.length===0?null:a.jsxs("div",{children:[a.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[a.jsx(ta,{className:"w-5 h-5 mr-2"}),ze," (",Me.length,")"]}),a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 2xl:grid-cols-6 gap-3 sm:gap-4",children:Me.map(rt=>a.jsx(Ure,{table:rt,onUpdateStatus:le,onEdit:ae,onDelete:we,onClick:oe},rt.id))})]},ze)})}),x&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-2xl max-w-md w-full",children:[a.jsxs("div",{className:"p-6 border-b border-gray-200",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Create New Area"}),a.jsx("p",{className:"text-gray-600 mt-1",children:"Add a new dining area to organize your tables"})]}),a.jsxs("form",{onSubmit:fe(ie),className:"p-6 space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Area Name"}),a.jsx("input",{...K("areaName",{required:"Area name is required"}),type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., Main Dining, Patio, VIP Section"}),de.areaName&&a.jsx("p",{className:"text-red-500 text-sm mt-1",children:de.areaName.message})]}),a.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[a.jsx("button",{type:"button",onClick:()=>{E(!1),ee()},className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Cancel"}),a.jsx("button",{type:"submit",disabled:!ue,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-colors",children:"Create Area"})]})]})]})}),y&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-2xl max-w-md w-full",children:[a.jsxs("div",{className:"p-6 border-b border-gray-200",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Create New Table"}),a.jsx("p",{className:"text-gray-600 mt-1",children:"Add a new table to your restaurant"})]}),a.jsxs("form",{onSubmit:he(He),className:"p-6 space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Table Number"}),a.jsx("input",{...Ae("number",{required:"Table number is required"}),type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., 1, A1, T01"}),V.number&&a.jsx("p",{className:"text-red-500 text-sm mt-1",children:V.number.message})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Area"}),a.jsxs("select",{...Ae("area",{required:"Area is required"}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"",children:"Select an area"}),i.map(ze=>a.jsx("option",{value:ze,children:ze},ze))]}),V.area&&a.jsx("p",{className:"text-red-500 text-sm mt-1",children:V.area.message})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Capacity"}),a.jsx("input",{...Ae("capacity",{required:"Capacity is required",min:{value:1,message:"Capacity must be at least 1"},max:{value:20,message:"Capacity cannot exceed 20"}}),type:"number",min:"1",max:"20",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Number of seats"}),V.capacity&&a.jsx("p",{className:"text-red-500 text-sm mt-1",children:V.capacity.message})]}),a.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[a.jsx("button",{type:"button",onClick:()=>{v(!1),I()},className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Cancel"}),a.jsx("button",{type:"submit",disabled:!L,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-colors",children:"Create Table"})]})]})]})}),T&&C&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-2xl max-w-md w-full",children:[a.jsxs("div",{className:"p-6 border-b border-gray-200",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Edit Table"}),a.jsx("p",{className:"text-gray-600 mt-1",children:"Update table information"})]}),a.jsxs("form",{onSubmit:he(ve),className:"p-6 space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Table Number"}),a.jsx("input",{...Ae("number",{required:"Table number is required"}),type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., 1, A1, T01"}),V.number&&a.jsx("p",{className:"text-red-500 text-sm mt-1",children:V.number.message})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Area"}),a.jsxs("select",{...Ae("area",{required:"Area is required"}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"",children:"Select an area"}),i.map(ze=>a.jsx("option",{value:ze,children:ze},ze))]}),V.area&&a.jsx("p",{className:"text-red-500 text-sm mt-1",children:V.area.message})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Capacity"}),a.jsx("input",{...Ae("capacity",{required:"Capacity is required",min:{value:1,message:"Capacity must be at least 1"},max:{value:20,message:"Capacity cannot exceed 20"}}),type:"number",min:"1",max:"20",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Number of seats"}),V.capacity&&a.jsx("p",{className:"text-red-500 text-sm mt-1",children:V.capacity.message})]}),a.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[a.jsx("button",{type:"button",onClick:()=>{j(!1),w(null),I()},className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Cancel"}),a.jsx("button",{type:"submit",disabled:!L,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-colors",children:"Update Table"})]})]})]})})]}),a.jsx(CM,{isVisible:S,stage:B,message:D}),a.jsx(Mj,{isVisible:Q,onClose:()=>re(!1),onPrintKOT:Y,orderDetails:te})]}):null}function Ure({table:t,onUpdateStatus:e,onEdit:r,onDelete:s}){const[n,i]=R.useState(!1),{restaurant:o}=js(),l=A=>{switch(A){case"available":return a.jsx(Nr,{className:"w-4 h-4 text-green-500"});case"occupied":return a.jsx(Hs,{className:"w-4 h-4 text-red-500"});case"reserved":return a.jsx(Ys,{className:"w-4 h-4 text-yellow-500"});case"cleaning":return a.jsx(Sl,{className:"w-4 h-4 text-blue-500"});case"out_of_service":return a.jsx(oi,{className:"w-4 h-4 text-gray-500"});default:return null}},c=A=>{switch(A){case"available":return"bg-green-50 border-green-200";case"occupied":return"bg-red-50 border-red-200";case"reserved":return"bg-yellow-50 border-yellow-200";case"cleaning":return"bg-blue-50 border-blue-200";case"out_of_service":return"bg-gray-50 border-gray-200";default:return"bg-gray-50 border-gray-200"}},d=()=>{o&&(t.status==="available"||t.status==="occupied")&&(window.location.href=`/${o.slug}/order/${t.id}`)},u=t.status==="available"||t.status==="occupied";return a.jsx("div",{className:`card border-2 ${c(t.status)} relative ${u?"cursor-pointer hover:shadow-lg transition-all duration-200 hover:-translate-y-1":""}`,onClick:u?d:void 0,children:a.jsxs("div",{className:"p-3 sm:p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("h3",{className:"font-semibold text-gray-900 text-sm sm:text-base",children:["Table ",t.number]}),a.jsxs("div",{className:"relative",children:[a.jsx("button",{onClick:A=>{A.stopPropagation(),i(!n)},className:"p-1 hover:bg-gray-100 rounded",children:a.jsx(cM,{className:"w-4 h-4 text-gray-500"})}),n&&a.jsxs("div",{className:"absolute right-0 top-8 bg-white border border-gray-200 rounded-lg shadow-lg z-10 min-w-[140px] sm:min-w-[160px]",children:[a.jsxs("button",{onClick:A=>{A.stopPropagation(),e(t,"available"),i(!1)},className:"w-full px-3 py-2 text-left text-sm hover:bg-gray-50 flex items-center space-x-2",children:[a.jsx(Nr,{className:"w-4 h-4 text-green-500"}),a.jsx("span",{children:"Available"})]}),a.jsxs("button",{onClick:A=>{A.stopPropagation(),e(t,"occupied"),i(!1)},className:"w-full px-3 py-2 text-left text-sm hover:bg-gray-50 flex items-center space-x-2",children:[a.jsx(Hs,{className:"w-4 h-4 text-red-500"}),a.jsx("span",{children:"Occupied"})]}),a.jsxs("button",{onClick:A=>{A.stopPropagation(),e(t,"reserved"),i(!1)},className:"w-full px-3 py-2 text-left text-sm hover:bg-gray-50 flex items-center space-x-2",children:[a.jsx(Ys,{className:"w-4 h-4 text-yellow-500"}),a.jsx("span",{children:"Reserved"})]}),a.jsxs("button",{onClick:A=>{A.stopPropagation(),e(t,"cleaning"),i(!1)},className:"w-full px-3 py-2 text-left text-sm hover:bg-gray-50 flex items-center space-x-2",children:[a.jsx(Sl,{className:"w-4 h-4 text-blue-500"}),a.jsx("span",{children:"Cleaning"})]}),a.jsxs("button",{onClick:A=>{A.stopPropagation(),e(t,"out_of_service"),i(!1)},className:"w-full px-3 py-2 text-left text-sm hover:bg-gray-50 flex items-center space-x-2",children:[a.jsx(oi,{className:"w-4 h-4 text-gray-500"}),a.jsx("span",{children:"Out of Service"})]}),a.jsxs("div",{className:"border-t border-gray-200",children:[a.jsxs("button",{onClick:A=>{A.stopPropagation(),r(t),i(!1)},className:"w-full px-3 py-2 text-left text-sm hover:bg-gray-50 flex items-center space-x-2",children:[a.jsx(ly,{className:"w-4 h-4 text-blue-500"}),a.jsx("span",{children:"Edit Table"})]}),a.jsxs("button",{onClick:A=>{A.stopPropagation(),s(t),i(!1)},className:"w-full px-3 py-2 text-left text-sm text-red-600 hover:bg-red-50 flex items-center space-x-2",children:[a.jsx(Un,{className:"w-4 h-4"}),a.jsx("span",{children:"Delete"})]})]})]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between text-xs sm:text-sm",children:[a.jsx("span",{className:"text-gray-600",children:"Status:"}),a.jsxs("div",{className:"flex items-center space-x-1",children:[l(t.status),a.jsx("span",{className:"capitalize text-gray-700 text-xs sm:text-sm",children:t.status.replace("_"," ")})]})]}),a.jsxs("div",{className:"flex items-center justify-between text-xs sm:text-sm",children:[a.jsx("span",{className:"text-gray-600",children:"Capacity:"}),a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx(Ls,{className:"w-3 h-3 text-gray-500"}),a.jsx("span",{className:"text-gray-700",children:t.capacity})]})]}),a.jsxs("div",{className:"flex items-center justify-between text-xs sm:text-sm",children:[a.jsx("span",{className:"text-gray-600",children:"Area:"}),a.jsx("span",{className:"text-gray-700 truncate ml-2",children:t.area})]}),u&&a.jsx("div",{className:"mt-3 pt-3 border-t border-gray-200",children:a.jsx("p",{className:"text-xs text-center font-medium",style:{color:"var(--color-primary)"},children:" Click to take order"})})]})]})})}class dn{static getMenuItems(e){try{const r=`${this.MENU_CACHE_KEY}_${e}`,s=`${this.CACHE_EXPIRY_KEY}_${e}`,n=localStorage.getItem(r),i=localStorage.getItem(s);return n&&i&&Date.now()<parseInt(i)?(console.log(" Menu cache hit for restaurant:",e),JSON.parse(n).map(this.parseItemDates)):[]}catch(r){return console.error("Failed to get menu from cache:",r),[]}}static setMenuItems(e,r){try{const s=`${this.MENU_CACHE_KEY}_${e}`,n=`${this.CACHE_EXPIRY_KEY}_${e}`;localStorage.setItem(s,JSON.stringify(r)),localStorage.setItem(n,(Date.now()+this.CACHE_DURATION).toString()),console.log(" Menu items cached for restaurant:",e,"Count:",r.length)}catch(s){console.error("Failed to cache menu items:",s)}}static getCategories(e){try{const r=`${this.CATEGORIES_CACHE_KEY}_${e}`,s=`${this.CACHE_EXPIRY_KEY}_${e}`,n=localStorage.getItem(r),i=localStorage.getItem(s);return n&&i&&Date.now()<parseInt(i)?(console.log(" Categories cache hit for restaurant:",e),JSON.parse(n).map(this.parseCategoryDates)):[]}catch(r){return console.error("Failed to get categories from cache:",r),[]}}static setCategories(e,r){try{const s=`${this.CATEGORIES_CACHE_KEY}_${e}`,n=`${this.CACHE_EXPIRY_KEY}_${e}`;localStorage.setItem(s,JSON.stringify(r)),localStorage.setItem(n,(Date.now()+this.CACHE_DURATION).toString()),console.log(" Categories cached for restaurant:",e,"Count:",r.length)}catch(s){console.error("Failed to cache categories:",s)}}static addMenuItem(e,r){const s=this.getMenuItems(e);s.push(r),this.setMenuItems(e,s)}static updateMenuItem(e,r){const s=this.getMenuItems(e),n=s.findIndex(i=>i.id===r.id);n!==-1&&(s[n]=r,this.setMenuItems(e,s))}static removeMenuItem(e,r){const n=this.getMenuItems(e).filter(i=>i.id!==r);this.setMenuItems(e,n)}static clearCache(e){const r=`${this.MENU_CACHE_KEY}_${e}`,s=`${this.CATEGORIES_CACHE_KEY}_${e}`,n=`${this.CACHE_EXPIRY_KEY}_${e}`;localStorage.removeItem(r),localStorage.removeItem(s),localStorage.removeItem(n)}static isCacheFresh(e){const r=`${this.CACHE_EXPIRY_KEY}_${e}`,s=localStorage.getItem(r);return s?Date.now()<parseInt(s):!1}static parseItemDates(e){return{...e,createdAt:new Date(e.createdAt),updatedAt:new Date(e.updatedAt)}}static parseCategoryDates(e){return{...e,createdAt:new Date(e.createdAt),updatedAt:new Date(e.updatedAt)}}}Or(dn,"MENU_CACHE_KEY","tenverse_pos_menu"),Or(dn,"CATEGORIES_CACHE_KEY","tenverse_pos_categories"),Or(dn,"CACHE_EXPIRY_KEY","tenverse_pos_menu_expiry"),Or(dn,"CACHE_DURATION",30*60*1e3);class Ts{static async getMenuItemsForRestaurant(e){try{const r=dn.getMenuItems(e);if(r.length>0&&dn.isCacheFresh(e))return{success:!0,data:r};console.log(" Fetching menu items from Firebase for restaurant:",e);let s=[];try{const n=Zt(Jt(st,"restaurants",e,this.MENU_ITEMS_COLLECTION),On("category"),On("name"));s=(await ur(n)).docs.map(o=>this.convertFirestoreMenuItem(o.data(),o.id))}catch(n){if(n.code==="failed-precondition"&&n.message.includes("index")){console.log(" Index building, using fallback query with client-side sorting");const i=Zt(Jt(st,"restaurants",e,this.MENU_ITEMS_COLLECTION));s=(await ur(i)).docs.map(l=>this.convertFirestoreMenuItem(l.data(),l.id)),s.sort((l,c)=>l.category!==c.category?l.category.localeCompare(c.category):l.name.localeCompare(c.name))}else throw n}return dn.setMenuItems(e,s),console.log(" Menu items loaded and cached:",s.length),{success:!0,data:s}}catch(r){return console.error(" Failed to get menu items:",r),{success:!1,error:Xt(r)}}}static async getCategoriesForRestaurant(e){try{const r=dn.getCategories(e);if(r.length>0&&dn.isCacheFresh(e))return{success:!0,data:r};console.log(" Fetching categories from Firebase for restaurant:",e);let s=[];try{const n=Zt(Jt(st,"restaurants",e,this.CATEGORIES_COLLECTION),Yt("isActive","==",!0));s=(await ur(n)).docs.map(o=>this.convertFirestoreCategory(o.data(),o.id)).sort((o,l)=>(o.sortOrder||0)-(l.sortOrder||0))}catch(n){console.warn(" Optimized query failed, trying fallback approach:",n.message);try{const i=Jt(st,"restaurants",e,this.CATEGORIES_COLLECTION);s=(await ur(i)).docs.map(l=>this.convertFirestoreCategory(l.data(),l.id)).filter(l=>l.isActive).sort((l,c)=>(l.sortOrder||0)-(c.sortOrder||0)),console.log(" Fallback query succeeded")}catch(i){throw console.error(" Fallback query also failed:",i),i}}return dn.setCategories(e,s),console.log(" Categories loaded and cached:",s.length),{success:!0,data:s}}catch(r){return console.error(" Failed to get categories:",r),{success:!0,data:[]}}}static async initializeDefaultMenu(e){try{const r=await this.getMenuItemsForRestaurant(e);if(r.success&&r.data&&r.data.length>0){const h=await this.getCategoriesForRestaurant(e);return{success:!0,data:{items:r.data,categories:h.data||[]}}}console.log(" Creating default menu for restaurant:",e);const s=jl(st),n=[{restaurantId:e,name:"Appetizers",description:"Start your meal with these delicious options",sortOrder:1,isActive:!0,createdAt:new Date,updatedAt:new Date},{restaurantId:e,name:"Main Courses",description:"Our signature dishes and hearty meals",sortOrder:2,isActive:!0,createdAt:new Date,updatedAt:new Date},{restaurantId:e,name:"Beverages",description:"Refreshing drinks and specialty beverages",sortOrder:3,isActive:!0,createdAt:new Date,updatedAt:new Date},{restaurantId:e,name:"Desserts",description:"Sweet endings to your perfect meal",sortOrder:4,isActive:!0,createdAt:new Date,updatedAt:new Date}],i=[];for(const h of n){const f=An(),p={id:f,...h},m=Rt(st,"restaurants",e,this.CATEGORIES_COLLECTION,f);s.set(m,{...p,createdAt:wt.fromDate(p.createdAt),updatedAt:wt.fromDate(p.updatedAt)}),i.push(p)}const o=i.find(h=>h.name==="Appetizers"),l=i.find(h=>h.name==="Main Courses"),c=i.find(h=>h.name==="Beverages"),d=i.find(h=>h.name==="Desserts"),u=[{restaurantId:e,name:"Caesar Salad",description:"Fresh romaine lettuce with parmesan cheese and croutons",price:12.99,category:"Appetizers",categoryId:o.id,categoryName:o.name,isAvailable:!0,ingredients:["romaine lettuce","parmesan cheese","croutons","caesar dressing"],createdAt:new Date,updatedAt:new Date},{restaurantId:e,name:"Chicken Wings",description:"Crispy wings with your choice of sauce",price:14.99,category:"Appetizers",categoryId:o.id,categoryName:o.name,isAvailable:!0,ingredients:["chicken wings","buffalo sauce","celery","blue cheese"],createdAt:new Date,updatedAt:new Date},{restaurantId:e,name:"Grilled Chicken",description:"Tender grilled chicken breast with seasonal vegetables",price:18.99,category:"Main Courses",categoryId:l.id,categoryName:l.name,isAvailable:!0,ingredients:["chicken breast","seasonal vegetables","herbs","olive oil"],createdAt:new Date,updatedAt:new Date},{restaurantId:e,name:"Beef Burger",description:"Juicy beef patty with lettuce, tomato, and fries",price:16.99,category:"Main Courses",categoryId:l.id,categoryName:l.name,isAvailable:!0,ingredients:["beef patty","lettuce","tomato","onion","pickles","fries"],createdAt:new Date,updatedAt:new Date},{restaurantId:e,name:"Fresh Orange Juice",description:"Freshly squeezed orange juice",price:4.99,category:"Beverages",categoryId:c.id,categoryName:c.name,isAvailable:!0,ingredients:["fresh oranges"],createdAt:new Date,updatedAt:new Date},{restaurantId:e,name:"Coffee",description:"Premium roasted coffee",price:3.99,category:"Beverages",categoryId:c.id,categoryName:c.name,isAvailable:!0,ingredients:["coffee beans","water"],createdAt:new Date,updatedAt:new Date},{restaurantId:e,name:"Chocolate Cake",description:"Rich chocolate cake with chocolate frosting",price:7.99,category:"Desserts",categoryId:d.id,categoryName:d.name,isAvailable:!0,ingredients:["chocolate","flour","eggs","butter","sugar"],createdAt:new Date,updatedAt:new Date}],A=[];for(const h of u){const f=An(),p={id:f,...h},m=Rt(st,"restaurants",e,this.MENU_ITEMS_COLLECTION,f);s.set(m,{...p,createdAt:wt.fromDate(p.createdAt),updatedAt:wt.fromDate(p.updatedAt)}),A.push(p)}return await s.commit(),dn.setMenuItems(e,A),dn.setCategories(e,i),console.log(" Default menu created and cached"),{success:!0,data:{items:A,categories:i},message:"Default menu created successfully"}}catch(r){return console.error(" Failed to create default menu:",r),{success:!1,error:Xt(r)}}}static async getAvailableItemsByCategory(e,r){const s=await this.getMenuItemsForRestaurant(e);if(s.success&&s.data){let n=s.data.filter(i=>i.isAvailable);return r&&(n=n.filter(i=>i.category===r)),{success:!0,data:n}}return s}static async searchMenuItems(e,r){const s=await this.getMenuItemsForRestaurant(e);return s.success&&s.data?{success:!0,data:s.data.filter(i=>{var o,l;return i.isAvailable&&(i.name.toLowerCase().includes(r.toLowerCase())||((o=i.description)==null?void 0:o.toLowerCase().includes(r.toLowerCase()))||((l=i.ingredients)==null?void 0:l.some(c=>c.toLowerCase().includes(r.toLowerCase()))))})}:s}static async createMenuItem(e){try{const r=An(),s={id:r,...e,createdAt:new Date,updatedAt:new Date},n=Rt(st,"restaurants",e.restaurantId,this.MENU_ITEMS_COLLECTION,r);return await LA(n,{...s,createdAt:wt.fromDate(s.createdAt),updatedAt:wt.fromDate(s.updatedAt)}),dn.addMenuItem(e.restaurantId,s),console.log(" Menu item created and cached:",s.name),{success:!0,data:s,message:"Menu item created successfully"}}catch(r){return console.error(" Failed to create menu item:",r),{success:!1,error:Xt(r)}}}static async updateMenuItem(e,r,s){try{const n=Rt(st,"restaurants",r,this.MENU_ITEMS_COLLECTION,e),i={...s,updatedAt:wt.now()};await Xr(n,i);const o=dn.getMenuItems(r),l=o.findIndex(d=>d.id===e);if(l!==-1){const d={...o[l],...s,updatedAt:new Date};return dn.updateMenuItem(r,d),{success:!0,data:d,message:"Menu item updated successfully"}}return await this.getMenuItemById(e,r)}catch(n){return console.error(" Failed to update menu item:",n),{success:!1,error:Xt(n)}}}static async deleteMenuItem(e,r){try{const s=Rt(st,"restaurants",r,this.MENU_ITEMS_COLLECTION,e);return await Pl(s),dn.removeMenuItem(r,e),console.log(" Menu item deleted and removed from cache:",e),{success:!0,message:"Menu item deleted successfully"}}catch(s){return console.error(" Failed to delete menu item:",s),{success:!1,error:Xt(s)}}}static async getMenuItemById(e,r){try{const n=dn.getMenuItems(r).find(c=>c.id===e);if(n)return{success:!0,data:n};const i=Rt(st,"restaurants",r,this.MENU_ITEMS_COLLECTION,e),o=await Kr(i);return o.exists()?{success:!0,data:this.convertFirestoreMenuItem(o.data(),o.id)}:{success:!1,error:"Menu item not found"}}catch(s){return console.error(" Failed to get menu item by ID:",s),{success:!1,error:Xt(s)}}}static clearCache(e){dn.clearCache(e)}static subscribeToMenuItems(e,r){const s=Zt(Jt(st,"restaurants",e,this.MENU_ITEMS_COLLECTION),On("category"),On("name"));return Of(s,n=>{const i=n.docs.map(o=>this.convertFirestoreMenuItem(o.data(),o.id));dn.setMenuItems(e,i),r(i)},n=>{console.error("Menu subscription error:",n)})}static convertFirestoreMenuItem(e,r){var s,n;return{id:r,restaurantId:e.restaurantId,name:e.name,description:e.description,price:e.price,category:e.category,categoryId:e.categoryId,categoryName:e.categoryName,image:e.image,isAvailable:e.isAvailable,ingredients:e.ingredients||[],allergens:e.allergens||[],nutritionInfo:e.nutritionInfo,customizations:e.customizations||[],variants:e.variants||[],preparationTime:e.preparationTime,spiceLevel:e.spiceLevel,isVeg:e.isVeg,isVegetarian:e.isVegetarian,isVegan:e.isVegan,isGlutenFree:e.isGlutenFree,tags:e.tags||[],createdAt:((s=e.createdAt)==null?void 0:s.toDate())||new Date,updatedAt:((n=e.updatedAt)==null?void 0:n.toDate())||new Date}}static convertFirestoreCategory(e,r){var s,n;return{id:r,restaurantId:e.restaurantId,name:e.name,description:e.description,sortOrder:e.sortOrder,isActive:e.isActive,createdAt:((s=e.createdAt)==null?void 0:s.toDate())||new Date,updatedAt:((n=e.updatedAt)==null?void 0:n.toDate())||new Date}}static async createCategory(e){try{const r=An(),s={id:r,...e,createdAt:new Date,updatedAt:new Date},n=Rt(st,"restaurants",e.restaurantId,this.CATEGORIES_COLLECTION,r);await LA(n,{...s,createdAt:wt.fromDate(s.createdAt),updatedAt:wt.fromDate(s.updatedAt)});const i=dn.getCategories(e.restaurantId);return i.push(s),dn.setCategories(e.restaurantId,i),console.log(" Category created and cached:",s.name),{success:!0,data:s,message:"Category created successfully"}}catch(r){return console.error(" Failed to create category:",r),{success:!1,error:Xt(r)}}}static async updateCategory(e,r,s){try{const n=Rt(st,"restaurants",r,this.CATEGORIES_COLLECTION,e),i={...s,updatedAt:wt.now()};await Xr(n,i);const o=dn.getCategories(r),l=o.findIndex(d=>d.id===e);if(l!==-1){const d={...o[l],...s,updatedAt:new Date};return o[l]=d,dn.setCategories(r,o),{success:!0,data:d,message:"Category updated successfully"}}const c=await this.getCategoriesForRestaurant(r);if(c.success&&c.data){const d=c.data.find(u=>u.id===e);if(d)return{success:!0,data:d,message:"Category updated successfully"}}return{success:!1,error:"Failed to find updated category"}}catch(n){return console.error(" Failed to update category:",n),{success:!1,error:Xt(n)}}}static async deleteCategory(e,r){try{const s=Rt(st,"restaurants",r,this.CATEGORIES_COLLECTION,e);await Pl(s);const i=dn.getCategories(r).filter(o=>o.id!==e);return dn.setCategories(r,i),console.log(" Category deleted and removed from cache:",e),{success:!0,message:"Category deleted successfully"}}catch(s){return console.error(" Failed to delete category:",s),{success:!1,error:Xt(s)}}}}Or(Ts,"MENU_ITEMS_COLLECTION","menuItems"),Or(Ts,"CATEGORIES_COLLECTION","categories");const yB=Object.freeze(Object.defineProperty({__proto__:null,MenuService:Ts},Symbol.toStringTag,{value:"Module"}));class wn{static getCollection(e){return Jt(st,`restaurants/${e}/customers`)}static async createCustomer(e,r){try{if(r.phone){const o=await this.searchCustomers(e,r.phone);if(o.success&&o.data&&o.data.length>0){const l=o.data[0];return{success:!1,error:`Customer with phone ${r.phone} already exists as "${l.name||"Unnamed Customer"}"`,data:l}}}const s={restaurantId:e,name:r.name||"",email:r.email||"",phone:r.phone||"",address:r.address||"",orderHistory:[],totalSpent:0,visitCount:0,lastVisit:void 0,preferences:r.preferences||[],createdAt:new Date,updatedAt:new Date},n=await Bi(this.getCollection(e),{...s,createdAt:wt.fromDate(s.createdAt),updatedAt:wt.fromDate(s.updatedAt),lastVisit:s.lastVisit?wt.fromDate(s.lastVisit):null});return{success:!0,data:{...s,id:n.id},message:"Customer created successfully"}}catch(s){return console.error("Error creating customer:",s),{success:!1,error:"Failed to create customer"}}}static async updateCustomer(e,r,s){var n,i,o;try{const l=Rt(st,`restaurants/${r}/customers`,e);if(!(await Kr(l)).exists())return{success:!1,error:"Customer not found"};const d={...s,updatedAt:wt.fromDate(new Date)};s.lastVisit&&s.lastVisit instanceof Date&&(d.lastVisit=wt.fromDate(s.lastVisit)),await Xr(l,d);const u=await Kr(l),A=u.data();return A?{success:!0,data:{id:u.id,restaurantId:A.restaurantId,name:A.name||"",email:A.email||"",phone:A.phone||"",address:A.address||"",orderHistory:A.orderHistory||[],totalSpent:A.totalSpent||0,visitCount:A.visitCount||0,lastVisit:(n=A.lastVisit)==null?void 0:n.toDate(),preferences:A.preferences||[],createdAt:((i=A.createdAt)==null?void 0:i.toDate())||new Date,updatedAt:((o=A.updatedAt)==null?void 0:o.toDate())||new Date},message:"Customer updated successfully"}:{success:!1,error:"Customer data not found"}}catch(l){return console.error("Error updating customer:",l),{success:!1,error:"Failed to update customer"}}}static async deleteCustomer(e,r){try{const s=Rt(st,`restaurants/${r}/customers`,e);return(await Kr(s)).exists()?(await Pl(s),{success:!0,message:"Customer deleted successfully"}):{success:!1,error:"Customer not found"}}catch(s){return console.error("Error deleting customer:",s),{success:!1,error:"Failed to delete customer"}}}static async getCustomerById(e,r){var s,n,i;try{const o=Rt(st,`restaurants/${r}/customers`,e),l=await Kr(o);if(!l.exists())return{success:!1,error:"Customer not found"};const c=l.data();return{success:!0,data:{id:l.id,restaurantId:c.restaurantId,name:c.name||"",email:c.email||"",phone:c.phone||"",address:c.address||"",orderHistory:c.orderHistory||[],totalSpent:c.totalSpent||0,visitCount:c.visitCount||0,lastVisit:(s=c.lastVisit)==null?void 0:s.toDate(),preferences:c.preferences||[],createdAt:((n=c.createdAt)==null?void 0:n.toDate())||new Date,updatedAt:((i=c.updatedAt)==null?void 0:i.toDate())||new Date}}}catch(o){return console.error("Error fetching customer:",o),{success:!1,error:"Failed to fetch customer"}}}static async getCustomersForRestaurant(e,r={page:1,limit:50}){try{const s=Zt(this.getCollection(e),Wi(r.limit)),n=await ur(s),i=[];return n.forEach(o=>{var c,d,u;const l=o.data();i.push({id:o.id,restaurantId:l.restaurantId,name:l.name||"",email:l.email||"",phone:l.phone||"",address:l.address||"",orderHistory:l.orderHistory||[],totalSpent:l.totalSpent||0,visitCount:l.visitCount||0,lastVisit:(c=l.lastVisit)==null?void 0:c.toDate(),preferences:l.preferences||[],createdAt:((d=l.createdAt)==null?void 0:d.toDate())||new Date,updatedAt:((u=l.updatedAt)==null?void 0:u.toDate())||new Date})}),{success:!0,data:i}}catch(s){return console.error("Error fetching customers:",s),{success:!1,error:"Failed to fetch customers"}}}static async searchCustomers(e,r){try{const s=await this.getCustomersForRestaurant(e);return!s.success||!s.data?s:{success:!0,data:s.data.filter(i=>{var o,l,c;return((o=i.name)==null?void 0:o.toLowerCase().includes(r.toLowerCase()))||((l=i.email)==null?void 0:l.toLowerCase().includes(r.toLowerCase()))||((c=i.phone)==null?void 0:c.includes(r))})}}catch(s){return console.error("Error searching customers:",s),{success:!1,error:"Failed to search customers"}}}static async addOrderToCustomer(e,r,s,n){try{const i=Rt(st,`restaurants/${r}/customers`,e),o=await Kr(i);if(!o.exists())return{success:!1,error:"Customer not found"};const l=o.data(),c=l.orderHistory||[],d=l.totalSpent||0,u=l.visitCount||0;return await Xr(i,{orderHistory:[...c,s],totalSpent:d+n,visitCount:u+1,lastVisit:wt.fromDate(new Date),updatedAt:wt.fromDate(new Date)}),{success:!0,message:"Customer order updated successfully"}}catch(i){return console.error("Error adding order to customer:",i),{success:!1,error:"Failed to add order to customer"}}}static async getCustomerOrderHistory(e,r){try{const s=Rt(st,`restaurants/${r}/customers`,e),n=await Kr(s);return n.exists()?{success:!0,data:n.data().orderHistory||[]}:{success:!1,error:"Customer not found"}}catch(s){return console.error("Error fetching customer order history:",s),{success:!1,error:"Failed to fetch customer order history"}}}}const jM=Object.freeze(Object.defineProperty({__proto__:null,CustomerService:wn},Symbol.toStringTag,{value:"Module"}));class Oo{static getCouponsCollection(e){return Jt(st,`restaurants/${e}/coupons`)}static async createCoupon(e,r){try{const s={...r,restaurantId:e,usageCount:0,createdAt:new Date,updatedAt:new Date},n=await Bi(this.getCouponsCollection(e),{...s,createdAt:wt.fromDate(s.createdAt),updatedAt:wt.fromDate(s.updatedAt),validity:{...s.validity,startDate:wt.fromDate(s.validity.startDate),endDate:wt.fromDate(s.validity.endDate)}});return{success:!0,data:{...s,id:n.id},message:"Coupon created successfully"}}catch(s){return console.error("Error creating coupon:",s),{success:!1,error:"Failed to create coupon"}}}static async getCouponsForRestaurant(e){try{const r=await ur(this.getCouponsCollection(e)),s=[];return r.forEach(n=>{var o,l,c,d;const i=n.data();s.push({id:n.id,...i,createdAt:((o=i.createdAt)==null?void 0:o.toDate())||new Date,updatedAt:((l=i.updatedAt)==null?void 0:l.toDate())||new Date,validity:{...i.validity,startDate:((c=i.validity.startDate)==null?void 0:c.toDate())||new Date,endDate:((d=i.validity.endDate)==null?void 0:d.toDate())||new Date}})}),{success:!0,data:s}}catch(r){return console.error("Error fetching coupons:",r),{success:!1,error:"Failed to fetch coupons"}}}static async updateCoupon(e,r,s){try{const n=Rt(st,`restaurants/${r}/coupons`,e),i={...s,updatedAt:wt.fromDate(new Date)};return s.validity&&(i.validity={...s.validity,startDate:s.validity.startDate?wt.fromDate(s.validity.startDate):void 0,endDate:s.validity.endDate?wt.fromDate(s.validity.endDate):void 0}),await Xr(n,i),{success:!0,message:"Coupon updated successfully"}}catch(n){return console.error("Error updating coupon:",n),{success:!1,error:"Failed to update coupon"}}}static async deleteCoupon(e,r){try{return await Pl(Rt(st,`restaurants/${r}/coupons`,e)),{success:!0,message:"Coupon deleted successfully"}}catch(s){return console.error("Error deleting coupon:",s),{success:!1,error:"Failed to delete coupon"}}}static async validateCoupon(e,r,s,n,i,o){var l,c,d,u;try{const A=Zt(this.getCouponsCollection(r),Yt("code","==",e.toUpperCase())),h=await ur(A);if(h.empty)return{isValid:!1,error:"Invalid coupon code"};const f=h.docs[0],p=f.data(),m={id:f.id,...p,createdAt:((l=p.createdAt)==null?void 0:l.toDate())||new Date,updatedAt:((c=p.updatedAt)==null?void 0:c.toDate())||new Date,validity:{...p.validity,startDate:((d=p.validity.startDate)==null?void 0:d.toDate())||new Date,endDate:((u=p.validity.endDate)==null?void 0:u.toDate())||new Date}};return await this.performCouponValidation(m,s,n,i,o)}catch(A){return console.error("Error validating coupon:",A),{isValid:!1,error:"Failed to validate coupon"}}}static async performCouponValidation(e,r,s,n,i){if(e.status!=="active")return{isValid:!1,error:"This coupon is not active"};const o=new Date;if(o<e.validity.startDate)return{isValid:!1,error:"This coupon is not yet valid"};if(o>e.validity.endDate)return{isValid:!1,error:"This coupon has expired"};if(e.validity.startTime&&e.validity.endTime){const u=o.getHours()*100+o.getMinutes(),A=parseInt(e.validity.startTime.replace(":","")),h=parseInt(e.validity.endTime.replace(":",""));if(u<A||u>h)return{isValid:!1,error:`This coupon is only valid between ${e.validity.startTime} and ${e.validity.endTime}`}}if(e.validity.validDays.length>0){const A=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"][o.getDay()];if(!e.validity.validDays.includes(A))return{isValid:!1,error:"This coupon is not valid today"}}if(e.validity.usageLimit&&e.usageCount>=e.validity.usageLimit)return{isValid:!1,error:"This coupon has reached its usage limit"};if(e.validity.perCustomerLimit&&n&&await this.getCustomerCouponUsage(e.id,n)>=e.validity.perCustomerLimit)return{isValid:!1,error:"You have already used this coupon the maximum number of times"};if(i&&e.targeting.paymentMethodRestriction!=="all"&&!this.isPaymentMethodAllowed(i,e.targeting.paymentMethodRestriction))return{isValid:!1,error:`This coupon is not valid for ${i} payments`};const l=r.reduce((u,A)=>u+A.total,0);if(e.targeting.minOrderValue&&l<e.targeting.minOrderValue)return{isValid:!1,error:`Minimum order value of ${e.targeting.minOrderValue} required`};const c=await this.validateCouponType(e,r,s);if(!c.isValid)return c;const d=this.calculateCouponApplication(e,r,s);return{isValid:!0,coupon:e,applicableItems:d.applicableItems,discountAmount:d.discountAmount,freeItems:d.freeItems}}static async validateCouponType(e,r,s){switch(e.type){case"buy_x_get_y":return this.validateBuyXGetY(e,r,s);case"free_item":return this.validateFreeItem(e,r,s);case"category_specific":return this.validateCategorySpecific(e,r,s);case"minimum_order":return r.reduce((i,o)=>i+o.total,0)<(e.config.minimumOrderValue||0)?{isValid:!1,error:`Minimum order of ${e.config.minimumOrderValue} required`}:{isValid:!0};default:return{isValid:!0}}}static validateBuyXGetY(e,r,s){const n=e.config.buyXGetY;if(!n)return{isValid:!1,error:"Invalid coupon configuration"};let i=0;if(n.buyItemId){const o=r.find(l=>l.menuItemId===n.buyItemId);i=(o==null?void 0:o.quantity)||0}else n.buyCategoryId?i=r.filter(o=>{const l=s.find(c=>c.id===o.menuItemId);return(l==null?void 0:l.categoryId)===n.buyCategoryId}).reduce((o,l)=>o+l.quantity,0):i=r.reduce((o,l)=>o+l.quantity,0);return i<n.buyQuantity?{isValid:!1,error:`You need to buy ${n.buyQuantity} eligible items to use this coupon`}:{isValid:!0}}static validateFreeItem(e,r,s){const n=e.config.freeItemId;if(n){const i=s.find(o=>o.id===n);if(!i||!i.isAvailable)return{isValid:!1,error:"The free item is currently not available"}}return{isValid:!0}}static validateCategorySpecific(e,r,s){const n=e.config.targetCategoryId;return n?r.some(o=>{const l=s.find(c=>c.id===o.menuItemId);return(l==null?void 0:l.categoryId)===n})?{isValid:!0}:{isValid:!1,error:"No eligible items in cart for this coupon"}:{isValid:!1,error:"Invalid coupon configuration"}}static calculateCouponApplication(e,r,s){let n=0;const i=[];let o=[];switch(e.type){case"percentage_discount":n=r.reduce((h,f)=>h+f.total,0)*(e.config.percentage||0)/100,o=r.map(h=>h.menuItemId);break;case"fixed_amount":n=e.config.discountAmount||0,o=r.map(h=>h.menuItemId);break;case"minimum_order":n=e.config.discountAmount||0,o=r.map(h=>h.menuItemId);break;case"category_specific":const c=r.filter(h=>{const f=s.find(p=>p.id===h.menuItemId);return(f==null?void 0:f.categoryId)===e.config.targetCategoryId});n=c.reduce((h,f)=>h+f.total,0)*(e.config.categoryDiscountPercentage||0)/100,o=c.map(h=>h.menuItemId);break;case"buy_x_get_y":const u=this.calculateBuyXGetY(e,r,s);n=u.discountAmount,i.push(...u.freeItems),o=u.applicableItems;break;case"free_item":const A=this.calculateFreeItem(e,s);A&&i.push(A);break}return{coupon:e,discountAmount:n,freeItems:i,applicableItems:o}}static calculateBuyXGetY(e,r,s){const n=e.config.buyXGetY;let i=0;const o=[],l=[];let c=0;if(n.buyItemId){const u=r.find(A=>A.menuItemId===n.buyItemId);c=(u==null?void 0:u.quantity)||0,u&&l.push(u.menuItemId)}else if(n.buyCategoryId){const u=r.filter(A=>{const h=s.find(f=>f.id===A.menuItemId);return(h==null?void 0:h.categoryId)===n.buyCategoryId});c=u.reduce((A,h)=>A+h.quantity,0),l.push(...u.map(A=>A.menuItemId))}const d=Math.floor(c/n.buyQuantity)*n.getQuantity;if(d>0){const u=n.getItemId||n.buyItemId;if(u){const A=s.find(h=>h.id===u);A&&(n.getDiscountPercentage&&n.getDiscountPercentage<100?i=A.price*d*n.getDiscountPercentage/100:o.push({menuItemId:u,quantity:d,name:A.name,price:A.price}))}}return{discountAmount:i,freeItems:o,applicableItems:l}}static calculateFreeItem(e,r){const s=e.config.freeItemId;if(s){const n=r.find(i=>i.id===s);if(n&&n.isAvailable)return{menuItemId:s,quantity:1,name:n.name,price:n.price}}return null}static isPaymentMethodAllowed(e,r){switch(r){case"all":return!0;case"cash_only":return e==="cash";case"upi_only":return e==="upi";case"bank_only":return e==="bank";case"exclude_cash":return e!=="cash";default:return!0}}static async getCustomerCouponUsage(e,r){try{const s=Zt(Jt(st,this.usageCollection),Yt("couponId","==",e),Yt("customerId","==",r));return(await ur(s)).size}catch(s){return console.error("Error fetching customer coupon usage:",s),0}}static async recordCouponUsage(e,r,s,n,i,o,l){try{const c=jl(st),d=Rt(st,`restaurants/${r}/coupons`,e),u=await Kr(d);if(u.exists()){const f=u.data().usageCount||0;c.update(d,{usageCount:f+1,updatedAt:wt.fromDate(new Date)})}const A={couponId:e,restaurantId:r,orderId:s,customerId:l,discountAmount:n,originalAmount:i,finalAmount:o,usedAt:new Date},h=Rt(Jt(st,this.usageCollection));return c.set(h,{...A,usedAt:wt.fromDate(A.usedAt)}),await c.commit(),{success:!0,message:"Coupon usage recorded successfully"}}catch(c){return console.error("Error recording coupon usage:",c),{success:!1,error:"Failed to record coupon usage"}}}static generateCouponCode(e=""){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let s=e;for(let n=0;n<8-e.length;n++)s+=r.charAt(Math.floor(Math.random()*r.length));return s}static async getCouponAnalytics(e,r=30){try{const s=new Date;s.setDate(s.getDate()-r);const n=await this.getCouponsForRestaurant(e);if(!n.success||!n.data)return{success:!1,error:"Failed to fetch coupons"};const i=n.data,o=Zt(Jt(st,this.usageCollection),Yt("restaurantId","==",e),Yt("usedAt",">=",wt.fromDate(s))),c=(await ur(o)).docs.map(p=>{var m;return{id:p.id,...p.data(),usedAt:((m=p.data().usedAt)==null?void 0:m.toDate())||new Date}}),d=i.length,u=c.length,A=c.reduce((p,m)=>p+m.discountAmount,0),h=u>0?A/u:0,f=this.getTopCoupons(c);return{success:!0,data:{totalCouponsCreated:d,totalCouponsUsed:u,totalDiscountGiven:A,averageDiscountPerUsage:h,redemptionRate:d>0?u/d*100:0,topCoupons:f,usageHistory:c}}}catch(s){return console.error("Error fetching coupon analytics:",s),{success:!1,error:"Failed to fetch coupon analytics"}}}static getTopCoupons(e){const r={};return e.forEach(s=>{r[s.couponId]||(r[s.couponId]={count:0,totalDiscount:0}),r[s.couponId].count++,r[s.couponId].totalDiscount+=s.discountAmount}),Object.entries(r).map(([s,n])=>({couponId:s,...n})).sort((s,n)=>n.count-s.count).slice(0,5)}static async markCouponAsUsed(e,r){try{const s=Rt(st,`restaurants/${r}/coupons`,e),n=await Kr(s);if(!n.exists())return{success:!1,error:"Coupon not found"};const i=n.data().usageCount||0;return await Xr(s,{usageCount:i+1,updatedAt:wt.fromDate(new Date)}),{success:!0,message:"Coupon marked as used"}}catch(s){return console.error("Error marking coupon as used:",s),{success:!1,error:"Failed to mark coupon as used"}}}}Or(Oo,"usageCollection","coupon_usage");var rv={},Mre=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then},SM={},rl={};let o_;const Qre=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];rl.getSymbolSize=function(e){if(!e)throw new Error('"version" cannot be null or undefined');if(e<1||e>40)throw new Error('"version" should be in range from 1 to 40');return e*4+17};rl.getSymbolTotalCodewords=function(e){return Qre[e]};rl.getBCHDigit=function(t){let e=0;for(;t!==0;)e++,t>>>=1;return e};rl.setToSJISFunction=function(e){if(typeof e!="function")throw new Error('"toSJISFunc" is not a valid function.');o_=e};rl.isKanjiModeEnabled=function(){return typeof o_<"u"};rl.toSJIS=function(e){return o_(e)};var mN={};(function(t){t.L={bit:1},t.M={bit:0},t.Q={bit:3},t.H={bit:2};function e(r){if(typeof r!="string")throw new Error("Param is not a string");switch(r.toLowerCase()){case"l":case"low":return t.L;case"m":case"medium":return t.M;case"q":case"quartile":return t.Q;case"h":case"high":return t.H;default:throw new Error("Unknown EC Level: "+r)}}t.isValid=function(s){return s&&typeof s.bit<"u"&&s.bit>=0&&s.bit<4},t.from=function(s,n){if(t.isValid(s))return s;try{return e(s)}catch{return n}}})(mN);function EM(){this.buffer=[],this.length=0}EM.prototype={get:function(t){const e=Math.floor(t/8);return(this.buffer[e]>>>7-t%8&1)===1},put:function(t,e){for(let r=0;r<e;r++)this.putBit((t>>>e-r-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(t){const e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),t&&(this.buffer[e]|=128>>>this.length%8),this.length++}};var Vre=EM;function sv(t){if(!t||t<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=t,this.data=new Uint8Array(t*t),this.reservedBit=new Uint8Array(t*t)}sv.prototype.set=function(t,e,r,s){const n=t*this.size+e;this.data[n]=r,s&&(this.reservedBit[n]=!0)};sv.prototype.get=function(t,e){return this.data[t*this.size+e]};sv.prototype.xor=function(t,e,r){this.data[t*this.size+e]^=r};sv.prototype.isReserved=function(t,e){return this.reservedBit[t*this.size+e]};var Hre=sv,_M={};(function(t){const e=rl.getSymbolSize;t.getRowColCoords=function(s){if(s===1)return[];const n=Math.floor(s/7)+2,i=e(s),o=i===145?26:Math.ceil((i-13)/(2*n-2))*2,l=[i-7];for(let c=1;c<n-1;c++)l[c]=l[c-1]-o;return l.push(6),l.reverse()},t.getPositions=function(s){const n=[],i=t.getRowColCoords(s),o=i.length;for(let l=0;l<o;l++)for(let c=0;c<o;c++)l===0&&c===0||l===0&&c===o-1||l===o-1&&c===0||n.push([i[l],i[c]]);return n}})(_M);var TM={};const $re=rl.getSymbolSize,vB=7;TM.getPositions=function(e){const r=$re(e);return[[0,0],[r-vB,0],[0,r-vB]]};var IM={};(function(t){t.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const e={N1:3,N2:3,N3:40,N4:10};t.isValid=function(n){return n!=null&&n!==""&&!isNaN(n)&&n>=0&&n<=7},t.from=function(n){return t.isValid(n)?parseInt(n,10):void 0},t.getPenaltyN1=function(n){const i=n.size;let o=0,l=0,c=0,d=null,u=null;for(let A=0;A<i;A++){l=c=0,d=u=null;for(let h=0;h<i;h++){let f=n.get(A,h);f===d?l++:(l>=5&&(o+=e.N1+(l-5)),d=f,l=1),f=n.get(h,A),f===u?c++:(c>=5&&(o+=e.N1+(c-5)),u=f,c=1)}l>=5&&(o+=e.N1+(l-5)),c>=5&&(o+=e.N1+(c-5))}return o},t.getPenaltyN2=function(n){const i=n.size;let o=0;for(let l=0;l<i-1;l++)for(let c=0;c<i-1;c++){const d=n.get(l,c)+n.get(l,c+1)+n.get(l+1,c)+n.get(l+1,c+1);(d===4||d===0)&&o++}return o*e.N2},t.getPenaltyN3=function(n){const i=n.size;let o=0,l=0,c=0;for(let d=0;d<i;d++){l=c=0;for(let u=0;u<i;u++)l=l<<1&2047|n.get(d,u),u>=10&&(l===1488||l===93)&&o++,c=c<<1&2047|n.get(u,d),u>=10&&(c===1488||c===93)&&o++}return o*e.N3},t.getPenaltyN4=function(n){let i=0;const o=n.data.length;for(let c=0;c<o;c++)i+=n.data[c];return Math.abs(Math.ceil(i*100/o/5)-10)*e.N4};function r(s,n,i){switch(s){case t.Patterns.PATTERN000:return(n+i)%2===0;case t.Patterns.PATTERN001:return n%2===0;case t.Patterns.PATTERN010:return i%3===0;case t.Patterns.PATTERN011:return(n+i)%3===0;case t.Patterns.PATTERN100:return(Math.floor(n/2)+Math.floor(i/3))%2===0;case t.Patterns.PATTERN101:return n*i%2+n*i%3===0;case t.Patterns.PATTERN110:return(n*i%2+n*i%3)%2===0;case t.Patterns.PATTERN111:return(n*i%3+(n+i)%2)%2===0;default:throw new Error("bad maskPattern:"+s)}}t.applyMask=function(n,i){const o=i.size;for(let l=0;l<o;l++)for(let c=0;c<o;c++)i.isReserved(c,l)||i.xor(c,l,r(n,c,l))},t.getBestMask=function(n,i){const o=Object.keys(t.Patterns).length;let l=0,c=1/0;for(let d=0;d<o;d++){i(d),t.applyMask(d,n);const u=t.getPenaltyN1(n)+t.getPenaltyN2(n)+t.getPenaltyN3(n)+t.getPenaltyN4(n);t.applyMask(d,n),u<c&&(c=u,l=d)}return l}})(IM);var pN={};const gA=mN,A1=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],h1=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];pN.getBlocksCount=function(e,r){switch(r){case gA.L:return A1[(e-1)*4+0];case gA.M:return A1[(e-1)*4+1];case gA.Q:return A1[(e-1)*4+2];case gA.H:return A1[(e-1)*4+3];default:return}};pN.getTotalCodewordsCount=function(e,r){switch(r){case gA.L:return h1[(e-1)*4+0];case gA.M:return h1[(e-1)*4+1];case gA.Q:return h1[(e-1)*4+2];case gA.H:return h1[(e-1)*4+3];default:return}};var kM={},gN={};const px=new Uint8Array(512),qw=new Uint8Array(256);(function(){let e=1;for(let r=0;r<255;r++)px[r]=e,qw[e]=r,e<<=1,e&256&&(e^=285);for(let r=255;r<512;r++)px[r]=px[r-255]})();gN.log=function(e){if(e<1)throw new Error("log("+e+")");return qw[e]};gN.exp=function(e){return px[e]};gN.mul=function(e,r){return e===0||r===0?0:px[qw[e]+qw[r]]};(function(t){const e=gN;t.mul=function(s,n){const i=new Uint8Array(s.length+n.length-1);for(let o=0;o<s.length;o++)for(let l=0;l<n.length;l++)i[o+l]^=e.mul(s[o],n[l]);return i},t.mod=function(s,n){let i=new Uint8Array(s);for(;i.length-n.length>=0;){const o=i[0];for(let c=0;c<n.length;c++)i[c]^=e.mul(n[c],o);let l=0;for(;l<i.length&&i[l]===0;)l++;i=i.slice(l)}return i},t.generateECPolynomial=function(s){let n=new Uint8Array([1]);for(let i=0;i<s;i++)n=t.mul(n,new Uint8Array([1,e.exp(i)]));return n}})(kM);const BM=kM;function l_(t){this.genPoly=void 0,this.degree=t,this.degree&&this.initialize(this.degree)}l_.prototype.initialize=function(e){this.degree=e,this.genPoly=BM.generateECPolynomial(this.degree)};l_.prototype.encode=function(e){if(!this.genPoly)throw new Error("Encoder not initialized");const r=new Uint8Array(e.length+this.degree);r.set(e);const s=BM.mod(r,this.genPoly),n=this.degree-s.length;if(n>0){const i=new Uint8Array(this.degree);return i.set(s,n),i}return s};var Kre=l_,FM={},ph={},c_={};c_.isValid=function(e){return!isNaN(e)&&e>=1&&e<=40};var ad={};const PM="[0-9]+",zre="[A-Z $%*+\\-./:]+";let cy="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";cy=cy.replace(/u/g,"\\u");const qre="(?:(?![A-Z0-9 $%*+\\-./:]|"+cy+`)(?:.|[\r
]))+`;ad.KANJI=new RegExp(cy,"g");ad.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g");ad.BYTE=new RegExp(qre,"g");ad.NUMERIC=new RegExp(PM,"g");ad.ALPHANUMERIC=new RegExp(zre,"g");const Wre=new RegExp("^"+cy+"$"),Gre=new RegExp("^"+PM+"$"),Yre=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");ad.testKanji=function(e){return Wre.test(e)};ad.testNumeric=function(e){return Gre.test(e)};ad.testAlphanumeric=function(e){return Yre.test(e)};(function(t){const e=c_,r=ad;t.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},t.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},t.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},t.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},t.MIXED={bit:-1},t.getCharCountIndicator=function(i,o){if(!i.ccBits)throw new Error("Invalid mode: "+i);if(!e.isValid(o))throw new Error("Invalid version: "+o);return o>=1&&o<10?i.ccBits[0]:o<27?i.ccBits[1]:i.ccBits[2]},t.getBestModeForData=function(i){return r.testNumeric(i)?t.NUMERIC:r.testAlphanumeric(i)?t.ALPHANUMERIC:r.testKanji(i)?t.KANJI:t.BYTE},t.toString=function(i){if(i&&i.id)return i.id;throw new Error("Invalid mode")},t.isValid=function(i){return i&&i.bit&&i.ccBits};function s(n){if(typeof n!="string")throw new Error("Param is not a string");switch(n.toLowerCase()){case"numeric":return t.NUMERIC;case"alphanumeric":return t.ALPHANUMERIC;case"kanji":return t.KANJI;case"byte":return t.BYTE;default:throw new Error("Unknown mode: "+n)}}t.from=function(i,o){if(t.isValid(i))return i;try{return s(i)}catch{return o}}})(ph);(function(t){const e=rl,r=pN,s=mN,n=ph,i=c_,o=7973,l=e.getBCHDigit(o);function c(h,f,p){for(let m=1;m<=40;m++)if(f<=t.getCapacity(m,p,h))return m}function d(h,f){return n.getCharCountIndicator(h,f)+4}function u(h,f){let p=0;return h.forEach(function(m){const g=d(m.mode,f);p+=g+m.getBitsLength()}),p}function A(h,f){for(let p=1;p<=40;p++)if(u(h,p)<=t.getCapacity(p,f,n.MIXED))return p}t.from=function(f,p){return i.isValid(f)?parseInt(f,10):p},t.getCapacity=function(f,p,m){if(!i.isValid(f))throw new Error("Invalid QR Code version");typeof m>"u"&&(m=n.BYTE);const g=e.getSymbolTotalCodewords(f),y=r.getTotalCodewordsCount(f,p),v=(g-y)*8;if(m===n.MIXED)return v;const x=v-d(m,f);switch(m){case n.NUMERIC:return Math.floor(x/10*3);case n.ALPHANUMERIC:return Math.floor(x/11*2);case n.KANJI:return Math.floor(x/13);case n.BYTE:default:return Math.floor(x/8)}},t.getBestVersionForData=function(f,p){let m;const g=s.from(p,s.M);if(Array.isArray(f)){if(f.length>1)return A(f,g);if(f.length===0)return 1;m=f[0]}else m=f;return c(m.mode,m.getLength(),g)},t.getEncodedBits=function(f){if(!i.isValid(f)||f<7)throw new Error("Invalid QR Code version");let p=f<<12;for(;e.getBCHDigit(p)-l>=0;)p^=o<<e.getBCHDigit(p)-l;return f<<12|p}})(FM);var DM={};const Qj=rl,RM=1335,Xre=21522,bB=Qj.getBCHDigit(RM);DM.getEncodedBits=function(e,r){const s=e.bit<<3|r;let n=s<<10;for(;Qj.getBCHDigit(n)-bB>=0;)n^=RM<<Qj.getBCHDigit(n)-bB;return(s<<10|n)^Xre};var LM={};const Jre=ph;function pp(t){this.mode=Jre.NUMERIC,this.data=t.toString()}pp.getBitsLength=function(e){return 10*Math.floor(e/3)+(e%3?e%3*3+1:0)};pp.prototype.getLength=function(){return this.data.length};pp.prototype.getBitsLength=function(){return pp.getBitsLength(this.data.length)};pp.prototype.write=function(e){let r,s,n;for(r=0;r+3<=this.data.length;r+=3)s=this.data.substr(r,3),n=parseInt(s,10),e.put(n,10);const i=this.data.length-r;i>0&&(s=this.data.substr(r),n=parseInt(s,10),e.put(n,i*3+1))};var Zre=pp;const ese=ph,Y5=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function gp(t){this.mode=ese.ALPHANUMERIC,this.data=t}gp.getBitsLength=function(e){return 11*Math.floor(e/2)+6*(e%2)};gp.prototype.getLength=function(){return this.data.length};gp.prototype.getBitsLength=function(){return gp.getBitsLength(this.data.length)};gp.prototype.write=function(e){let r;for(r=0;r+2<=this.data.length;r+=2){let s=Y5.indexOf(this.data[r])*45;s+=Y5.indexOf(this.data[r+1]),e.put(s,11)}this.data.length%2&&e.put(Y5.indexOf(this.data[r]),6)};var tse=gp;const rse=ph;function xp(t){this.mode=rse.BYTE,typeof t=="string"?this.data=new TextEncoder().encode(t):this.data=new Uint8Array(t)}xp.getBitsLength=function(e){return e*8};xp.prototype.getLength=function(){return this.data.length};xp.prototype.getBitsLength=function(){return xp.getBitsLength(this.data.length)};xp.prototype.write=function(t){for(let e=0,r=this.data.length;e<r;e++)t.put(this.data[e],8)};var sse=xp;const nse=ph,ase=rl;function yp(t){this.mode=nse.KANJI,this.data=t}yp.getBitsLength=function(e){return e*13};yp.prototype.getLength=function(){return this.data.length};yp.prototype.getBitsLength=function(){return yp.getBitsLength(this.data.length)};yp.prototype.write=function(t){let e;for(e=0;e<this.data.length;e++){let r=ase.toSJIS(this.data[e]);if(r>=33088&&r<=40956)r-=33088;else if(r>=57408&&r<=60351)r-=49472;else throw new Error("Invalid SJIS character: "+this.data[e]+`
Make sure your charset is UTF-8`);r=(r>>>8&255)*192+(r&255),t.put(r,13)}};var ise=yp,OM={exports:{}};(function(t){var e={single_source_shortest_paths:function(r,s,n){var i={},o={};o[s]=0;var l=e.PriorityQueue.make();l.push(s,0);for(var c,d,u,A,h,f,p,m,g;!l.empty();){c=l.pop(),d=c.value,A=c.cost,h=r[d]||{};for(u in h)h.hasOwnProperty(u)&&(f=h[u],p=A+f,m=o[u],g=typeof o[u]>"u",(g||m>p)&&(o[u]=p,l.push(u,p),i[u]=d))}if(typeof n<"u"&&typeof o[n]>"u"){var y=["Could not find a path from ",s," to ",n,"."].join("");throw new Error(y)}return i},extract_shortest_path_from_predecessor_list:function(r,s){for(var n=[],i=s;i;)n.push(i),r[i],i=r[i];return n.reverse(),n},find_path:function(r,s,n){var i=e.single_source_shortest_paths(r,s,n);return e.extract_shortest_path_from_predecessor_list(i,n)},PriorityQueue:{make:function(r){var s=e.PriorityQueue,n={},i;r=r||{};for(i in s)s.hasOwnProperty(i)&&(n[i]=s[i]);return n.queue=[],n.sorter=r.sorter||s.default_sorter,n},default_sorter:function(r,s){return r.cost-s.cost},push:function(r,s){var n={value:r,cost:s};this.queue.push(n),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};t.exports=e})(OM);var ose=OM.exports;(function(t){const e=ph,r=Zre,s=tse,n=sse,i=ise,o=ad,l=rl,c=ose;function d(y){return unescape(encodeURIComponent(y)).length}function u(y,v,x){const E=[];let T;for(;(T=y.exec(x))!==null;)E.push({data:T[0],index:T.index,mode:v,length:T[0].length});return E}function A(y){const v=u(o.NUMERIC,e.NUMERIC,y),x=u(o.ALPHANUMERIC,e.ALPHANUMERIC,y);let E,T;return l.isKanjiModeEnabled()?(E=u(o.BYTE,e.BYTE,y),T=u(o.KANJI,e.KANJI,y)):(E=u(o.BYTE_KANJI,e.BYTE,y),T=[]),v.concat(x,E,T).sort(function(C,w){return C.index-w.index}).map(function(C){return{data:C.data,mode:C.mode,length:C.length}})}function h(y,v){switch(v){case e.NUMERIC:return r.getBitsLength(y);case e.ALPHANUMERIC:return s.getBitsLength(y);case e.KANJI:return i.getBitsLength(y);case e.BYTE:return n.getBitsLength(y)}}function f(y){return y.reduce(function(v,x){const E=v.length-1>=0?v[v.length-1]:null;return E&&E.mode===x.mode?(v[v.length-1].data+=x.data,v):(v.push(x),v)},[])}function p(y){const v=[];for(let x=0;x<y.length;x++){const E=y[x];switch(E.mode){case e.NUMERIC:v.push([E,{data:E.data,mode:e.ALPHANUMERIC,length:E.length},{data:E.data,mode:e.BYTE,length:E.length}]);break;case e.ALPHANUMERIC:v.push([E,{data:E.data,mode:e.BYTE,length:E.length}]);break;case e.KANJI:v.push([E,{data:E.data,mode:e.BYTE,length:d(E.data)}]);break;case e.BYTE:v.push([{data:E.data,mode:e.BYTE,length:d(E.data)}])}}return v}function m(y,v){const x={},E={start:{}};let T=["start"];for(let j=0;j<y.length;j++){const C=y[j],w=[];for(let S=0;S<C.length;S++){const F=C[S],B=""+j+S;w.push(B),x[B]={node:F,lastCount:0},E[B]={};for(let k=0;k<T.length;k++){const D=T[k];x[D]&&x[D].node.mode===F.mode?(E[D][B]=h(x[D].lastCount+F.length,F.mode)-h(x[D].lastCount,F.mode),x[D].lastCount+=F.length):(x[D]&&(x[D].lastCount=F.length),E[D][B]=h(F.length,F.mode)+4+e.getCharCountIndicator(F.mode,v))}}T=w}for(let j=0;j<T.length;j++)E[T[j]].end=0;return{map:E,table:x}}function g(y,v){let x;const E=e.getBestModeForData(y);if(x=e.from(v,E),x!==e.BYTE&&x.bit<E.bit)throw new Error('"'+y+'" cannot be encoded with mode '+e.toString(x)+`.
 Suggested mode is: `+e.toString(E));switch(x===e.KANJI&&!l.isKanjiModeEnabled()&&(x=e.BYTE),x){case e.NUMERIC:return new r(y);case e.ALPHANUMERIC:return new s(y);case e.KANJI:return new i(y);case e.BYTE:return new n(y)}}t.fromArray=function(v){return v.reduce(function(x,E){return typeof E=="string"?x.push(g(E,null)):E.data&&x.push(g(E.data,E.mode)),x},[])},t.fromString=function(v,x){const E=A(v,l.isKanjiModeEnabled()),T=p(E),j=m(T,x),C=c.find_path(j.map,"start","end"),w=[];for(let S=1;S<C.length-1;S++)w.push(j.table[C[S]].node);return t.fromArray(f(w))},t.rawSplit=function(v){return t.fromArray(A(v,l.isKanjiModeEnabled()))}})(LM);const xN=rl,X5=mN,lse=Vre,cse=Hre,dse=_M,use=TM,Vj=IM,Hj=pN,Ase=Kre,Ww=FM,hse=DM,fse=ph,J5=LM;function mse(t,e){const r=t.size,s=use.getPositions(e);for(let n=0;n<s.length;n++){const i=s[n][0],o=s[n][1];for(let l=-1;l<=7;l++)if(!(i+l<=-1||r<=i+l))for(let c=-1;c<=7;c++)o+c<=-1||r<=o+c||(l>=0&&l<=6&&(c===0||c===6)||c>=0&&c<=6&&(l===0||l===6)||l>=2&&l<=4&&c>=2&&c<=4?t.set(i+l,o+c,!0,!0):t.set(i+l,o+c,!1,!0))}}function pse(t){const e=t.size;for(let r=8;r<e-8;r++){const s=r%2===0;t.set(r,6,s,!0),t.set(6,r,s,!0)}}function gse(t,e){const r=dse.getPositions(e);for(let s=0;s<r.length;s++){const n=r[s][0],i=r[s][1];for(let o=-2;o<=2;o++)for(let l=-2;l<=2;l++)o===-2||o===2||l===-2||l===2||o===0&&l===0?t.set(n+o,i+l,!0,!0):t.set(n+o,i+l,!1,!0)}}function xse(t,e){const r=t.size,s=Ww.getEncodedBits(e);let n,i,o;for(let l=0;l<18;l++)n=Math.floor(l/3),i=l%3+r-8-3,o=(s>>l&1)===1,t.set(n,i,o,!0),t.set(i,n,o,!0)}function Z5(t,e,r){const s=t.size,n=hse.getEncodedBits(e,r);let i,o;for(i=0;i<15;i++)o=(n>>i&1)===1,i<6?t.set(i,8,o,!0):i<8?t.set(i+1,8,o,!0):t.set(s-15+i,8,o,!0),i<8?t.set(8,s-i-1,o,!0):i<9?t.set(8,15-i-1+1,o,!0):t.set(8,15-i-1,o,!0);t.set(s-8,8,1,!0)}function yse(t,e){const r=t.size;let s=-1,n=r-1,i=7,o=0;for(let l=r-1;l>0;l-=2)for(l===6&&l--;;){for(let c=0;c<2;c++)if(!t.isReserved(n,l-c)){let d=!1;o<e.length&&(d=(e[o]>>>i&1)===1),t.set(n,l-c,d),i--,i===-1&&(o++,i=7)}if(n+=s,n<0||r<=n){n-=s,s=-s;break}}}function vse(t,e,r){const s=new lse;r.forEach(function(c){s.put(c.mode.bit,4),s.put(c.getLength(),fse.getCharCountIndicator(c.mode,t)),c.write(s)});const n=xN.getSymbolTotalCodewords(t),i=Hj.getTotalCodewordsCount(t,e),o=(n-i)*8;for(s.getLengthInBits()+4<=o&&s.put(0,4);s.getLengthInBits()%8!==0;)s.putBit(0);const l=(o-s.getLengthInBits())/8;for(let c=0;c<l;c++)s.put(c%2?17:236,8);return bse(s,t,e)}function bse(t,e,r){const s=xN.getSymbolTotalCodewords(e),n=Hj.getTotalCodewordsCount(e,r),i=s-n,o=Hj.getBlocksCount(e,r),l=s%o,c=o-l,d=Math.floor(s/o),u=Math.floor(i/o),A=u+1,h=d-u,f=new Ase(h);let p=0;const m=new Array(o),g=new Array(o);let y=0;const v=new Uint8Array(t.buffer);for(let C=0;C<o;C++){const w=C<c?u:A;m[C]=v.slice(p,p+w),g[C]=f.encode(m[C]),p+=w,y=Math.max(y,w)}const x=new Uint8Array(s);let E=0,T,j;for(T=0;T<y;T++)for(j=0;j<o;j++)T<m[j].length&&(x[E++]=m[j][T]);for(T=0;T<h;T++)for(j=0;j<o;j++)x[E++]=g[j][T];return x}function wse(t,e,r,s){let n;if(Array.isArray(t))n=J5.fromArray(t);else if(typeof t=="string"){let d=e;if(!d){const u=J5.rawSplit(t);d=Ww.getBestVersionForData(u,r)}n=J5.fromString(t,d||40)}else throw new Error("Invalid data");const i=Ww.getBestVersionForData(n,r);if(!i)throw new Error("The amount of data is too big to be stored in a QR Code");if(!e)e=i;else if(e<i)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+i+`.
`);const o=vse(e,r,n),l=xN.getSymbolSize(e),c=new cse(l);return mse(c,e),pse(c),gse(c,e),Z5(c,r,0),e>=7&&xse(c,e),yse(c,o),isNaN(s)&&(s=Vj.getBestMask(c,Z5.bind(null,c,r))),Vj.applyMask(s,c),Z5(c,r,s),{modules:c,version:e,errorCorrectionLevel:r,maskPattern:s,segments:n}}SM.create=function(e,r){if(typeof e>"u"||e==="")throw new Error("No input text");let s=X5.M,n,i;return typeof r<"u"&&(s=X5.from(r.errorCorrectionLevel,X5.M),n=Ww.from(r.version),i=Vj.from(r.maskPattern),r.toSJISFunc&&xN.setToSJISFunction(r.toSJISFunc)),wse(e,n,s,i)};var UM={},d_={};(function(t){function e(r){if(typeof r=="number"&&(r=r.toString()),typeof r!="string")throw new Error("Color should be defined as hex string");let s=r.slice().replace("#","").split("");if(s.length<3||s.length===5||s.length>8)throw new Error("Invalid hex color: "+r);(s.length===3||s.length===4)&&(s=Array.prototype.concat.apply([],s.map(function(i){return[i,i]}))),s.length===6&&s.push("F","F");const n=parseInt(s.join(""),16);return{r:n>>24&255,g:n>>16&255,b:n>>8&255,a:n&255,hex:"#"+s.slice(0,6).join("")}}t.getOptions=function(s){s||(s={}),s.color||(s.color={});const n=typeof s.margin>"u"||s.margin===null||s.margin<0?4:s.margin,i=s.width&&s.width>=21?s.width:void 0,o=s.scale||4;return{width:i,scale:i?4:o,margin:n,color:{dark:e(s.color.dark||"#000000ff"),light:e(s.color.light||"#ffffffff")},type:s.type,rendererOpts:s.rendererOpts||{}}},t.getScale=function(s,n){return n.width&&n.width>=s+n.margin*2?n.width/(s+n.margin*2):n.scale},t.getImageWidth=function(s,n){const i=t.getScale(s,n);return Math.floor((s+n.margin*2)*i)},t.qrToImageData=function(s,n,i){const o=n.modules.size,l=n.modules.data,c=t.getScale(o,i),d=Math.floor((o+i.margin*2)*c),u=i.margin*c,A=[i.color.light,i.color.dark];for(let h=0;h<d;h++)for(let f=0;f<d;f++){let p=(h*d+f)*4,m=i.color.light;if(h>=u&&f>=u&&h<d-u&&f<d-u){const g=Math.floor((h-u)/c),y=Math.floor((f-u)/c);m=A[l[g*o+y]?1:0]}s[p++]=m.r,s[p++]=m.g,s[p++]=m.b,s[p]=m.a}}})(d_);(function(t){const e=d_;function r(n,i,o){n.clearRect(0,0,i.width,i.height),i.style||(i.style={}),i.height=o,i.width=o,i.style.height=o+"px",i.style.width=o+"px"}function s(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}t.render=function(i,o,l){let c=l,d=o;typeof c>"u"&&(!o||!o.getContext)&&(c=o,o=void 0),o||(d=s()),c=e.getOptions(c);const u=e.getImageWidth(i.modules.size,c),A=d.getContext("2d"),h=A.createImageData(u,u);return e.qrToImageData(h.data,i,c),r(A,d,u),A.putImageData(h,0,0),d},t.renderToDataURL=function(i,o,l){let c=l;typeof c>"u"&&(!o||!o.getContext)&&(c=o,o=void 0),c||(c={});const d=t.render(i,o,c),u=c.type||"image/png",A=c.rendererOpts||{};return d.toDataURL(u,A.quality)}})(UM);var MM={};const Nse=d_;function wB(t,e){const r=t.a/255,s=e+'="'+t.hex+'"';return r<1?s+" "+e+'-opacity="'+r.toFixed(2).slice(1)+'"':s}function eC(t,e,r){let s=t+e;return typeof r<"u"&&(s+=" "+r),s}function Cse(t,e,r){let s="",n=0,i=!1,o=0;for(let l=0;l<t.length;l++){const c=Math.floor(l%e),d=Math.floor(l/e);!c&&!i&&(i=!0),t[l]?(o++,l>0&&c>0&&t[l-1]||(s+=i?eC("M",c+r,.5+d+r):eC("m",n,0),n=0,i=!1),c+1<e&&t[l+1]||(s+=eC("h",o),o=0)):n++}return s}MM.render=function(e,r,s){const n=Nse.getOptions(r),i=e.modules.size,o=e.modules.data,l=i+n.margin*2,c=n.color.light.a?"<path "+wB(n.color.light,"fill")+' d="M0 0h'+l+"v"+l+'H0z"/>':"",d="<path "+wB(n.color.dark,"stroke")+' d="'+Cse(o,i,n.margin)+'"/>',u='viewBox="0 0 '+l+" "+l+'"',h='<svg xmlns="http://www.w3.org/2000/svg" '+(n.width?'width="'+n.width+'" height="'+n.width+'" ':"")+u+' shape-rendering="crispEdges">'+c+d+`</svg>
`;return typeof s=="function"&&s(null,h),h};const jse=Mre,$j=SM,QM=UM,Sse=MM;function u_(t,e,r,s,n){const i=[].slice.call(arguments,1),o=i.length,l=typeof i[o-1]=="function";if(!l&&!jse())throw new Error("Callback required as last argument");if(l){if(o<2)throw new Error("Too few arguments provided");o===2?(n=r,r=e,e=s=void 0):o===3&&(e.getContext&&typeof n>"u"?(n=s,s=void 0):(n=s,s=r,r=e,e=void 0))}else{if(o<1)throw new Error("Too few arguments provided");return o===1?(r=e,e=s=void 0):o===2&&!e.getContext&&(s=r,r=e,e=void 0),new Promise(function(c,d){try{const u=$j.create(r,s);c(t(u,e,s))}catch(u){d(u)}})}try{const c=$j.create(r,s);n(null,t(c,e,s))}catch(c){n(c)}}rv.create=$j.create;rv.toCanvas=u_.bind(null,QM.render);rv.toDataURL=u_.bind(null,QM.renderToDataURL);rv.toString=u_.bind(null,function(t,e,r){return Sse.render(t,r)});function VM(t,e,r,s){const i=`upi://pay?${new URLSearchParams({pa:t,pn:r,tn:s,am:e.toString(),cu:"INR"}).toString()}`;return console.log(" Generated UPI Payment String:",i),i}async function HM(t){try{console.log(" Generating QR Code for text:",t);const e=await rv.toDataURL(t,{width:120,margin:2,color:{dark:"#000000",light:"#FFFFFF"},errorCorrectionLevel:"H",type:"image/png"});return e&&e.startsWith("data:image/png;base64,")?(console.log(" QR Code generated successfully!"),e):(console.error(" Failed to generate valid QR Code data URL"),"")}catch(e){return console.error(" Error generating QR Code:",e),""}}function $M({isOpen:t,onClose:e,menuItem:r,onConfirm:s}){const[n,i]=R.useState([]),[o,l]=R.useState([]);if(!t)return null;const c=r.variants||[],d=()=>{let y=Number(r.price)||0;return n.forEach(v=>{const x=Number(v.priceModifier)||0;(v.pricingType||"additive")==="standalone"?y=x:y+=x}),y},u=(g,y)=>{const v=g.options.find(x=>x.id===y);if(v)if(g.type==="single"){const x=n.filter(E=>E.variantId!==g.id);x.push({variantId:g.id,variantName:g.name,optionId:v.id,optionName:v.name,priceModifier:Number(v.priceModifier)||0,pricingType:v.pricingType||"additive"}),i(x)}else{const x=n.findIndex(E=>E.variantId===g.id&&E.optionId===y);if(x>=0){const E=[...n];E.splice(x,1),i(E)}else{const E=n.filter(T=>T.variantId===g.id).length;(!g.maxSelections||E<g.maxSelections)&&i([...n,{variantId:g.id,variantName:g.name,optionId:v.id,optionName:v.name,priceModifier:Number(v.priceModifier)||0,pricingType:v.pricingType||"additive"}])}}},A=(g,y)=>n.some(v=>v.variantId===g&&v.optionId===y),h=()=>{const g=[];return c.forEach(y=>{y.required&&(n.some(x=>x.variantId===y.id)||g.push(`Please select an option for ${y.name}`))}),l(g),g.length===0},f=()=>{if(h()){const g=d();s(n,g),e()}},p=()=>{i([]),l([]),e()};bi.useEffect(()=>{if(c.length>0&&n.length===0){const g=[];c.forEach(y=>{if(y.type==="single"){const v=y.options.find(x=>x.isDefault)||y.options[0];v&&g.push({variantId:y.id,variantName:y.name,optionId:v.id,optionName:v.name,priceModifier:v.priceModifier,pricingType:v.pricingType||"additive"})}}),i(g)}},[c,n.length]);const m=d();return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-2xl max-w-lg w-full max-h-[90vh] overflow-y-auto",children:[a.jsx("div",{className:"p-6 border-b border-gray-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("h2",{className:"text-xl font-semibold text-gray-900",children:["Customize ",r.name]}),a.jsx("button",{onClick:p,className:"p-1 text-gray-400 hover:text-gray-600",children:a.jsx(qr,{className:"w-5 h-5"})})]})}),a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"mb-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("span",{className:"text-lg font-medium text-gray-900",children:r.name}),a.jsx("span",{className:"text-lg font-bold text-blue-600",children:Ue(m)})]}),r.description&&a.jsx("p",{className:"text-gray-600 text-sm",children:r.description})]}),c.map(g=>a.jsxs("div",{className:"mb-6",children:[a.jsxs("div",{className:"flex items-center mb-3",children:[a.jsx("h3",{className:"text-md font-medium text-gray-900",children:g.name}),g.required&&a.jsx("span",{className:"ml-2 text-red-500 text-sm",children:"*"}),g.type==="multiple"&&g.maxSelections&&a.jsxs("span",{className:"ml-2 text-gray-500 text-sm",children:["(Max ",g.maxSelections,")"]})]}),a.jsx("div",{className:"space-y-2",children:g.options.map(y=>{const v=A(g.id,y.id),x=n.filter(T=>T.variantId===g.id).length,E=g.maxSelections&&x>=g.maxSelections&&!v;return a.jsx("div",{onClick:()=>!E&&u(g,y.id),className:`
                        p-3 border rounded-lg cursor-pointer transition-colors
                        ${v?"border-blue-500 bg-blue-50":E?"border-gray-200 bg-gray-50 cursor-not-allowed opacity-50":"border-gray-200 hover:border-gray-300"}
                      `,children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[g.type==="single"?a.jsx("input",{type:"radio",checked:v,onChange:()=>{},className:"text-blue-600 focus:ring-blue-500"}):a.jsx("input",{type:"checkbox",checked:v,onChange:()=>{},disabled:!!E,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{className:"text-gray-900",children:y.name})]}),a.jsxs("div",{className:"flex flex-col items-end",children:[a.jsxs("span",{className:"text-gray-600",children:[y.pricingType==="standalone"?"":y.priceModifier>0&&"+",y.priceModifier!==0&&Ue(y.priceModifier)]}),y.pricingType==="standalone"&&a.jsx("span",{className:"text-xs text-blue-600",children:"Standalone"})]})]})},y.id)})})]},g.id)),o.length>0&&a.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:a.jsx("ul",{className:"text-red-600 text-sm space-y-1",children:o.map((g,y)=>a.jsx("li",{children:g},y))})}),n.length>0&&a.jsxs("div",{className:"mb-6 p-3 bg-gray-50 rounded-lg",children:[a.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Selected Options:"}),a.jsx("div",{className:"space-y-1",children:n.map((g,y)=>a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsxs("span",{className:"text-gray-700",children:[g.variantName,": ",g.optionName]}),a.jsxs("div",{className:"flex flex-col items-end",children:[a.jsxs("span",{className:"text-gray-600",children:[g.pricingType==="standalone"?"":g.priceModifier>0&&"+",g.priceModifier!==0&&Ue(g.priceModifier)]}),g.pricingType==="standalone"&&a.jsx("span",{className:"text-xs text-blue-600",children:"Standalone"})]})]},y))})]}),a.jsxs("div",{className:"flex space-x-3",children:[a.jsx("button",{onClick:p,className:"flex-1 px-4 py-3 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Cancel"}),a.jsxs("button",{onClick:f,className:"flex-1 px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium",children:["Add to Order - ",Ue(m)]})]})]})]})})}function yN({isOpen:t,onClose:e,restaurant:r,table:s,onPayment:n,isProcessing:i,cartItems:o,orders:l=[],menuItems:c}){var Kt,qe,Xe;const[d,u]=R.useState("cash"),[A,h]=R.useState(""),[f,p]=R.useState(""),[m,g]=R.useState(null),[y,v]=R.useState(!1),[x,E]=R.useState(""),[T,j]=R.useState(""),[C,w]=R.useState(""),[S,F]=R.useState(!1),[B,k]=R.useState(!1),[D,q]=R.useState({method1:"cash",amount1:"",method2:"upi",amount2:""}),[te,W]=R.useState([]),[Q,re]=R.useState(""),[G,Ae]=R.useState(""),[he,I]=R.useState(!1),[U,V]=R.useState(!1),[L,K]=R.useState({type:"percentage",value:0,reason:""}),[fe,ee]=R.useState(0),[de,ue]=R.useState("");R.useEffect(()=>{r!=null&&r.id&&Ie()},[r==null?void 0:r.id]);const Ie=async()=>{if(r!=null&&r.id)try{const Ke=await wn.getCustomersForRestaurant(r.id);Ke.success&&Ke.data&&W(Ke.data)}catch(Ke){console.error("Failed to load customers:",Ke)}};if(!t)return null;const Y=o.reduce((Ke,We)=>Ke+We.total,0),H=Y*(((Kt=r==null?void 0:r.settings)==null?void 0:Kt.taxRate)||8.5)/100,je=Y+H;let Ce=0,oe=0,He=[];m&&(Ce=m.discountAmount||0,He=m.freeItems||[],oe=He.reduce((Ke,We)=>Ke+We.price*We.quantity,0));let ie=0;L.value>0&&(L.type==="percentage"?ie=Y*L.value/100:ie=L.value,ie=Math.min(ie,Y));const le=Ce+ie,ae=Math.max(0,Y-le),ve=ae*(((qe=r==null?void 0:r.settings)==null?void 0:qe.taxRate)||8.5)/100,we=ae+ve,De=we+fe,Ve=le+oe;R.useEffect(()=>{De&&!A&&!B&&h(De.toString())},[De,B]);const me=parseFloat(D.amount1)||0,Fe=parseFloat(D.amount2)||0,Re=me+Fe,Be=Math.abs(Re-De)<.01,X=De-Re,_e=S?0:B?Re:parseFloat(A)||De,ke=_e<De&&_e>=0||S,lt=ke?De-_e:0,mt=async()=>{if(f.trim()){v(!0),E("");try{const Ke=await Oo.validateCoupon(f,r.id,o,c,d);Ke.isValid?(g(Ke),Z.success(`Coupon applied! You saved ${Ue(Ke.discountAmount||0)}`),p(""),Ke.freeItems&&Ke.freeItems.length>0&&Z.success(`Free items added: ${Ke.freeItems.map(We=>`${We.quantity}x ${We.name}`).join(", ")}`)):(E(Ke.error||"Invalid coupon"),Z.error(Ke.error||"Invalid coupon"))}catch{E("Failed to validate coupon"),Z.error("Failed to validate coupon")}finally{v(!1)}}},pt=()=>{g(null),E(""),Z.success("Coupon removed")},ze=Ke=>{Ae(Ke),I(Ke.length>0),Ke.length===0&&re("")},Me=Ke=>{re(Ke.id),Ae(Ke.name||Ke.phone||""),I(!1)},rt=()=>{re(""),Ae(""),I(!1)},ht=async(Ke,We)=>{if(r!=null&&r.id)try{const Ft=await wn.createCustomer(r.id,{name:Ke.trim(),phone:We.trim()});Ft.success&&Ft.data?(W(Ct=>[Ft.data,...Ct]),re(Ft.data.id),Ae(Ft.data.name||Ft.data.phone||""),I(!1),(ke||S)&&(j(Ft.data.name||""),w(Ft.data.phone||"")),Z.success("Customer created and added to CRM successfully!")):Z.error(Ft.error||"Failed to create customer")}catch(Ft){console.error("Error creating customer:",Ft),Z.error("Failed to create customer")}},Qe=Ke=>{ee(Ke),ue("")},Ge=Ke=>{ue(Ke);const We=parseFloat(Ke)||0;ee(We)},gt=te.filter(Ke=>{var We,Ft,Ct;return((We=Ke.name)==null?void 0:We.toLowerCase().includes(G.toLowerCase()))||((Ft=Ke.phone)==null?void 0:Ft.includes(G))||((Ct=Ke.email)==null?void 0:Ct.toLowerCase().includes(G.toLowerCase()))}),St=te.find(Ke=>Ke.id===Q),Vt=async()=>{const Ke=S?0:B?Re:parseFloat(A)||De;let We=Q;if(ke&&!Q&&T.trim()&&C.trim())try{const Ct=await wn.createCustomer(r.id,{name:T.trim(),phone:C.trim()});if(Ct.success&&Ct.data)We=Ct.data.id,W(xr=>[Ct.data,...xr]),re(Ct.data.id),Z.success(`Customer "${T}" created and linked to credit!`);else{Z.error(Ct.error||"Failed to create customer");return}}catch(Ct){console.error("Error creating customer for credit:",Ct),Z.error("Failed to create customer. Please try again.");return}const Ft={method:B?"split":ke?S?"credit":"partial_credit":d,amountReceived:Ke,appliedCoupon:m,manualDiscount:L.value>0?L:null,customerId:We||null,tip:fe>0?fe:null,finalTotal:De,originalTotal:je,subtotalWithTax:we,totalSavings:Ve,freeItems:He,couponDiscountAmount:Ce,manualDiscountAmount:ie,totalDiscountAmount:le,discountedSubtotal:ae,isSplitPayment:B,splitPayment:B?{method1:D.method1,amount1:me,method2:D.method2,amount2:Fe,totalSplitAmount:Re}:null,isCredit:ke,creditAmount:lt,creditCustomerName:ke?T:null,creditCustomerPhone:ke?C:null,addWholeAmountAsCredit:S,creditCustomerId:We};n(Ft)};return a.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:a.jsxs("div",{className:"flex items-center justify-center min-h-screen px-1 sm:px-4 pt-2 pb-4 sm:pt-4 sm:pb-20 text-center sm:block sm:p-0",children:[a.jsx("div",{className:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75",onClick:()=>{I(!1),V(!1),e()}}),a.jsxs("div",{className:"inline-block w-full max-w-2xl my-2 sm:my-8 overflow-hidden text-left align-middle transition-all transform bg-white shadow-xl rounded-lg sm:rounded-2xl max-h-[98vh] sm:max-h-[95vh] overflow-y-auto",children:[a.jsxs("div",{className:"px-3 sm:px-6 py-3 sm:py-4 border-b border-gray-200",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h3",{className:"text-lg sm:text-xl font-semibold text-gray-900",children:"Process Payment"}),a.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 p-1",children:a.jsx(qr,{className:"w-5 h-5 sm:w-6 sm:h-6"})})]}),a.jsxs("p",{className:"text-xs sm:text-sm text-gray-600 mt-1",children:["Table ",s.number," - Enhanced with Coupon Support"]})]}),a.jsxs("div",{className:"px-3 sm:px-6 py-3 sm:py-4 space-y-4 sm:space-y-6",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-gray-900 mb-3 text-sm sm:text-base",children:"Order Summary"}),a.jsx("div",{className:"bg-gray-50 rounded-lg p-3 sm:p-4 space-y-3",children:l.length>0?l.map(Ke=>a.jsxs("div",{className:"border-b border-gray-200 last:border-b-0 pb-2 last:pb-0",children:[a.jsxs("div",{className:"flex justify-between items-center mb-1",children:[a.jsxs("span",{className:"text-xs font-medium text-gray-600",children:["Order #",Ke.orderNumber]}),a.jsx("span",{className:"text-xs text-gray-500",children:new Date(Ke.createdAt).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})})]}),Ke.items.map((We,Ft)=>a.jsxs("div",{className:"flex justify-between text-xs sm:text-sm ml-2",children:[a.jsxs("span",{className:"truncate mr-2",children:[We.quantity,"x ",We.name]}),a.jsx("span",{className:"whitespace-nowrap",children:Ue(We.total)})]},Ft))]},Ke.id)):o.map((Ke,We)=>a.jsxs("div",{className:"flex justify-between text-xs sm:text-sm",children:[a.jsxs("span",{className:"truncate mr-2",children:[Ke.quantity,"x ",Ke.name]}),a.jsx("span",{className:"whitespace-nowrap",children:Ue(Ke.total)})]},We))})]}),a.jsxs("div",{className:"border-t pt-4",children:[a.jsxs("h4",{className:"font-medium text-gray-900 mb-3 flex items-center text-sm sm:text-base",children:[a.jsx(Hs,{className:"w-4 h-4 mr-2 text-purple-600"}),"Customer"]}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"text",value:G,onChange:Ke=>ze(Ke.target.value),onFocus:()=>I(!0),placeholder:"Search customer by name, phone, or email...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 text-sm"}),St&&a.jsxs("div",{className:"mt-2 p-3 bg-purple-50 border border-purple-200 rounded-lg flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2",children:[a.jsxs("div",{className:"min-w-0 flex-1",children:[a.jsx("div",{className:"font-medium text-purple-900 text-sm sm:text-base",children:St.name}),a.jsxs("div",{className:"text-xs sm:text-sm text-purple-600",children:[St.phone,"  ",St.visitCount," visits  Total spent: ",Ue(St.totalSpent)]})]}),a.jsx("button",{onClick:rt,className:"text-purple-600 hover:text-purple-800 p-1 rounded self-start sm:self-center",title:"Remove customer",children:a.jsx(qr,{className:"w-4 h-4"})})]}),he&&G&&a.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-48 overflow-y-auto",children:gt.length>0?gt.slice(0,10).map(Ke=>a.jsxs("button",{onClick:()=>Me(Ke),className:"w-full text-left px-3 py-2 hover:bg-gray-50 border-b border-gray-100 last:border-b-0",children:[a.jsx("div",{className:"font-medium text-sm",children:Ke.name||"Unknown"}),a.jsxs("div",{className:"text-xs text-gray-600",children:[Ke.phone,"  ",Ke.visitCount," visits"]})]},Ke.id)):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"px-3 py-2 text-gray-500 text-xs sm:text-sm border-b border-gray-100",children:['No customers found for "',G,'"']}),G.length>=2&&a.jsxs("button",{onClick:()=>{/^\d+$/.test(G)?ht("",G):ht(G,"")},className:"w-full text-left px-3 py-2 hover:bg-blue-50 text-blue-600 border-b border-gray-100 last:border-b-0",children:[a.jsx("div",{className:"font-medium text-sm",children:"+ Create New Customer"}),a.jsx("div",{className:"text-xs",children:/^\d+$/.test(G)?`Phone: ${G}`:`Name: ${G}`})]})]})})]})]}),a.jsxs("div",{className:"border-t pt-4",children:[a.jsxs("h4",{className:"font-medium text-gray-900 mb-3 flex items-center text-sm sm:text-base",children:[a.jsx(Ax,{className:"w-4 h-4 mr-2 text-orange-600"}),"Manual Discount"]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-2",children:[a.jsxs("select",{value:L.type,onChange:Ke=>K(We=>({...We,type:Ke.target.value})),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 text-sm",children:[a.jsx("option",{value:"percentage",children:"Percentage (%)"}),a.jsx("option",{value:"fixed",children:"Fixed Amount ()"})]}),a.jsx("input",{type:"number",value:L.value||"",onChange:Ke=>K(We=>({...We,value:parseFloat(Ke.target.value)||0})),placeholder:L.type==="percentage"?"Enter %":"Enter amount",min:"0",max:L.type==="percentage"?100:Y,step:L.type==="percentage"?1:.01,className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 text-sm"})]}),a.jsx("input",{type:"text",value:L.reason,onChange:Ke=>K(We=>({...We,reason:Ke.target.value})),placeholder:"Discount reason (optional)",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 text-sm"}),ie>0&&a.jsx("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-3",children:a.jsxs("div",{className:"text-xs sm:text-sm text-orange-700",children:["Manual discount: ",Ue(ie),L.reason&&a.jsxs("span",{className:"block text-orange-600",children:["Reason: ",L.reason]})]})})]})]}),a.jsxs("div",{className:"border-t pt-4",children:[a.jsxs("h4",{className:"font-medium text-gray-900 mb-3 flex items-center text-sm sm:text-base",children:[a.jsx(Vw,{className:"w-4 h-4 mr-2 text-blue-600"}),"Apply Coupon"]}),m?a.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3 sm:p-4",children:a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[a.jsxs("div",{className:"flex items-start space-x-3 min-w-0 flex-1",children:[a.jsx(Cn,{className:"w-4 h-4 sm:w-5 sm:h-5 text-green-600 flex-shrink-0 mt-0.5"}),a.jsxs("div",{className:"min-w-0 flex-1",children:[a.jsx("div",{className:"font-medium text-green-800 text-sm sm:text-base",children:m.coupon.name}),a.jsxs("div",{className:"text-xs sm:text-sm text-green-600",children:["Code: ",m.coupon.code]}),Ce>0&&a.jsxs("div",{className:"text-xs sm:text-sm text-green-600",children:["Discount: ",Ue(Ce)]}),He.length>0&&a.jsxs("div",{className:"text-xs sm:text-sm text-green-600",children:["Free: ",He.map(Ke=>`${Ke.quantity}x ${Ke.name}`).join(", ")]})]})]}),a.jsx("button",{onClick:pt,className:"text-green-600 hover:text-green-800 p-1 rounded self-start sm:self-center flex-shrink-0",title:"Remove coupon",children:a.jsx(qr,{className:"w-4 h-4"})})]})}):a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-2",children:[a.jsx("input",{type:"text",value:f,onChange:Ke=>p(Ke.target.value.toUpperCase()),placeholder:"Enter coupon code (e.g., SAVE20)",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm"}),a.jsx("button",{type:"button",onClick:mt,disabled:!f.trim()||y,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed text-sm whitespace-nowrap",children:y?"Validating...":"Apply"})]}),x&&a.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 flex items-start space-x-2",children:[a.jsx(oi,{className:"w-4 h-4 text-red-600 flex-shrink-0 mt-0.5"}),a.jsx("span",{className:"text-xs sm:text-sm text-red-700",children:x})]})]})]}),a.jsx("div",{className:"border-t pt-4",children:a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex justify-between text-xs sm:text-sm",children:[a.jsx("span",{children:"Subtotal:"}),a.jsx("span",{className:m?"line-through text-gray-500":"",children:Ue(Y)})]}),Ce>0&&a.jsxs("div",{className:"flex justify-between text-xs sm:text-sm text-green-600",children:[a.jsx("span",{children:"Coupon Discount:"}),a.jsxs("span",{children:["-",Ue(Ce)]})]}),ie>0&&a.jsxs("div",{className:"flex justify-between text-xs sm:text-sm text-orange-600",children:[a.jsxs("span",{children:["Manual Discount (",L.type==="percentage"?`${L.value}%`:"Fixed","):"]}),a.jsxs("span",{children:["-",Ue(ie)]})]}),le>0&&a.jsxs("div",{className:"flex justify-between text-xs sm:text-sm",children:[a.jsx("span",{children:"Discounted Subtotal:"}),a.jsx("span",{children:Ue(ae)})]}),a.jsxs("div",{className:"flex justify-between text-xs sm:text-sm",children:[a.jsxs("span",{children:["Tax (",((Xe=r==null?void 0:r.settings)==null?void 0:Xe.taxRate)||8.5,"%):"]}),a.jsx("span",{children:Ue(ve)})]}),He.length>0&&a.jsxs("div",{className:"flex justify-between text-xs sm:text-sm text-green-600",children:[a.jsx("span",{children:"Free Items Value:"}),a.jsxs("span",{children:[Ue(oe)," (FREE)"]})]}),fe>0&&a.jsxs("div",{className:"flex justify-between text-xs sm:text-sm text-blue-600",children:[a.jsx("span",{children:"Tip/Gratuity:"}),a.jsxs("span",{children:["+",Ue(fe)]})]}),a.jsxs("div",{className:"flex justify-between text-base sm:text-lg font-bold border-t pt-2",children:[a.jsx("span",{children:"Final Total:"}),a.jsx("span",{children:Ue(De)})]}),Ve>0&&a.jsxs("div",{className:"flex justify-between text-xs sm:text-sm text-green-600 font-medium",children:[a.jsx("span",{children:"Total Savings:"}),a.jsx("span",{children:Ue(Ve)})]})]})}),a.jsxs("div",{className:"border-t pt-4",children:[a.jsxs("h4",{className:"font-medium text-gray-900 mb-3 flex items-center text-sm sm:text-base",children:[a.jsx(hn,{className:"w-4 h-4 mr-2 text-green-600"}),"Tip / Gratuity"]}),a.jsxs("div",{className:"space-y-3",children:[a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2 sm:gap-2",children:[10,15,20,25].map(Ke=>{const We=we*Ke/100;return a.jsxs("button",{onClick:()=>Qe(We),className:`p-2 border rounded-lg text-center text-xs sm:text-sm ${Math.abs(fe-We)<.01?"border-green-500 bg-green-50 text-green-700":"border-gray-300 hover:border-gray-400"}`,children:[Ke,"%",a.jsx("br",{}),a.jsx("span",{className:"text-xs",children:Ue(We)})]},Ke)})}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-2",children:[a.jsx("input",{type:"number",value:de,onChange:Ke=>Ge(Ke.target.value),placeholder:"Custom tip amount",min:"0",step:"0.01",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 text-sm"}),a.jsx("button",{onClick:()=>Qe(0),className:`px-4 py-2 border rounded-lg text-xs sm:text-sm whitespace-nowrap ${fe===0?"border-gray-500 bg-gray-50 text-gray-700":"border-gray-300 hover:border-gray-400"}`,children:"No Tip"})]})]})]}),a.jsxs("div",{className:"border-t pt-4",children:[a.jsx("h4",{className:"font-medium text-gray-900 text-sm sm:text-base mb-4",children:"Payment Method"}),a.jsxs("div",{className:"space-y-3 mb-4",children:[a.jsxs("label",{className:"flex items-start space-x-3 p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer transition-colors",children:[a.jsx("input",{type:"checkbox",checked:B,onChange:Ke=>k(Ke.target.checked),className:"w-5 h-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500 mt-0.5 flex-shrink-0"}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"text-sm font-medium text-gray-900",children:"Split Payment"}),a.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Pay using multiple payment methods"})]})]}),a.jsxs("label",{className:`flex items-start space-x-3 p-3 border rounded-lg cursor-pointer transition-colors ${S?"border-orange-300 bg-orange-50 hover:bg-orange-100":"border-gray-200 hover:bg-gray-50"}`,children:[a.jsx("input",{type:"checkbox",checked:S,onChange:Ke=>{F(Ke.target.checked),Ke.target.checked?(h("0"),k(!1)):h(De.toString())},className:"w-5 h-5 text-orange-600 border-gray-300 rounded focus:ring-orange-500 mt-0.5 flex-shrink-0"}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"text-sm font-medium text-orange-900",children:"Add Whole Amount as Credit"}),a.jsxs("div",{className:"text-xs text-orange-600 mt-1",children:["Add ",Ue(De)," to customer's credit balance"]}),S&&a.jsxs("div",{className:"text-xs font-medium text-orange-700 mt-2 flex items-center",children:[a.jsx(No,{className:"w-3 h-3 mr-1"})," Credit mode activated"]})]})]})]}),B?a.jsx("div",{className:"space-y-4",children:a.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[a.jsx("h5",{className:"font-medium text-blue-900 mb-3 text-sm",children:"Split Payment Configuration"}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Payment Method 1"}),a.jsx("div",{className:"grid grid-cols-3 gap-2 mb-2",children:["cash","upi","bank"].map(Ke=>a.jsx("button",{onClick:()=>q(We=>({...We,method1:Ke})),className:`p-2 border rounded-lg text-center capitalize text-sm ${D.method1===Ke?"border-blue-500 bg-blue-100 text-blue-700":"border-gray-300 hover:border-gray-400"}`,children:Ke},Ke))}),a.jsx("input",{type:"number",placeholder:"Amount for method 1",value:D.amount1,onChange:Ke=>q(We=>({...We,amount1:Ke.target.value})),min:"0",step:"0.01",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm"})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Payment Method 2"}),a.jsx("div",{className:"grid grid-cols-3 gap-2 mb-2",children:["cash","upi","bank"].map(Ke=>a.jsx("button",{onClick:()=>q(We=>({...We,method2:Ke})),className:`p-2 border rounded-lg text-center capitalize text-sm ${D.method2===Ke?"border-blue-500 bg-blue-100 text-blue-700":"border-gray-300 hover:border-gray-400"}`,children:Ke},Ke))}),a.jsx("input",{type:"number",placeholder:"Amount for method 2",value:D.amount2,onChange:Ke=>q(We=>({...We,amount2:Ke.target.value})),min:"0",step:"0.01",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm"})]}),a.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-3",children:a.jsxs("div",{className:"text-sm space-y-1",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Total Bill:"}),a.jsx("span",{className:"font-medium",children:Ue(De)})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsxs("span",{children:[D.method1.toUpperCase(),":"]}),a.jsx("span",{children:Ue(me)})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsxs("span",{children:[D.method2.toUpperCase(),":"]}),a.jsx("span",{children:Ue(Fe)})]}),a.jsxs("div",{className:"flex justify-between border-t pt-1",children:[a.jsx("span",{children:"Total Received:"}),a.jsx("span",{className:"font-medium",children:Ue(Re)})]}),!Be&&a.jsxs("div",{className:`flex justify-between ${X>0?"text-red-600":"text-green-600"}`,children:[a.jsx("span",{children:X>0?"Shortfall:":"Overpayment:"}),a.jsx("span",{className:"font-medium",children:Ue(Math.abs(X))})]})]})})]})}):a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2 sm:gap-3",children:["cash","upi","bank"].map(Ke=>a.jsx("button",{onClick:()=>{u(Ke),A===""&&h(De.toString())},className:`p-3 border rounded-lg text-center capitalize text-sm ${d===Ke?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-300 hover:border-gray-400"}`,children:Ke},Ke))})]}),!B&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs sm:text-sm font-medium text-gray-700 mb-2",children:"Amount Received"}),a.jsx("input",{type:"number",value:A,onChange:Ke=>h(Ke.target.value),min:"0",step:"0.01",disabled:S,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm disabled:bg-gray-100 disabled:cursor-not-allowed",placeholder:De.toString()}),S&&a.jsx("div",{className:"mt-2 text-xs sm:text-sm text-orange-600 font-medium",children:" Whole amount will be added as credit"}),parseFloat(A)>De&&!S&&a.jsxs("div",{className:"mt-2 text-xs sm:text-sm text-gray-600",children:["Change: ",Ue(parseFloat(A)-De)]}),ke&&!S&&a.jsxs("div",{className:"mt-2 text-xs sm:text-sm text-orange-600 font-medium",children:["Credit Amount: ",Ue(lt)]})]}),ke&&a.jsxs("div",{className:"border border-orange-200 rounded-lg p-3 sm:p-4 bg-orange-50",children:[a.jsxs("h4",{className:"font-medium text-orange-900 mb-3 flex items-center text-sm sm:text-base",children:[a.jsx(No,{className:"w-4 h-4 mr-2"}),"Credit Customer Details"]}),St?a.jsxs("div",{className:"space-y-3",children:[a.jsx("div",{className:"bg-white border border-orange-200 rounded-lg p-3",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("div",{className:"font-medium text-orange-900",children:St.name}),a.jsx("div",{className:"text-sm text-orange-700",children:St.phone})]}),a.jsx("button",{onClick:()=>{rt(),j(""),w("")},className:"text-orange-600 hover:text-orange-800 p-1 rounded",title:"Change customer",children:a.jsx(qr,{className:"w-4 h-4"})})]})}),a.jsx("div",{className:"bg-orange-100 border border-orange-200 rounded p-3",children:a.jsxs("p",{className:"text-xs sm:text-sm text-orange-800",children:[a.jsx("strong",{children:"Credit Summary:"}),a.jsx("br",{}),"Total Bill: ",Ue(De),a.jsx("br",{}),"Amount Received: ",Ue(_e),a.jsx("br",{}),"Credit Amount: ",Ue(lt)]})})]}):a.jsxs("div",{className:"space-y-3",children:[a.jsx("div",{className:"text-sm text-orange-700 bg-orange-100 border border-orange-200 rounded p-2",children:" Tip: Search for a customer above or enter details manually below"}),a.jsxs("div",{className:"relative",children:[a.jsx("label",{className:"block text-xs sm:text-sm font-medium text-orange-700 mb-1",children:"Customer Name *"}),a.jsx("input",{type:"text",value:T,onChange:Ke=>{j(Ke.target.value),V(Ke.target.value.length>0)},onFocus:()=>V(T.length>0),onBlur:Ke=>{setTimeout(()=>{var We;(We=Ke.relatedTarget)!=null&&We.closest('[data-dropdown="credit-customer"]')||V(!1)},150)},placeholder:"Enter customer name",className:"w-full px-3 py-2 border border-orange-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 text-sm",required:!0}),U&&T&&a.jsx("div",{"data-dropdown":"credit-customer",className:"absolute z-20 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-40 overflow-y-auto",children:te.filter(Ke=>{var We,Ft,Ct;return((We=Ke.name)==null?void 0:We.toLowerCase().includes(T.toLowerCase()))||((Ft=Ke.phone)==null?void 0:Ft.includes(T))||((Ct=Ke.email)==null?void 0:Ct.toLowerCase().includes(T.toLowerCase()))}).length>0?te.filter(Ke=>{var We,Ft,Ct;return((We=Ke.name)==null?void 0:We.toLowerCase().includes(T.toLowerCase()))||((Ft=Ke.phone)==null?void 0:Ft.includes(T))||((Ct=Ke.email)==null?void 0:Ct.toLowerCase().includes(T.toLowerCase()))}).slice(0,5).map(Ke=>a.jsxs("button",{onMouseDown:()=>{re(Ke.id),Ae(Ke.name||Ke.phone||""),j(Ke.name||""),w(Ke.phone||""),V(!1),Z.success(`Customer "${Ke.name}" linked to credit!`)},className:"w-full text-left px-3 py-2 hover:bg-gray-50 border-b border-gray-100 last:border-b-0",children:[a.jsx("div",{className:"font-medium text-sm",children:Ke.name||"Unknown"}),a.jsxs("div",{className:"text-xs text-gray-600",children:[Ke.phone,"  ",Ke.visitCount," visits"]})]},Ke.id)):a.jsxs("div",{className:"px-3 py-2",children:[a.jsxs("div",{className:"text-gray-500 text-xs sm:text-sm mb-2",children:['No customers found for "',T,'"']}),a.jsx("div",{className:"text-blue-600 text-xs bg-blue-50 border border-blue-200 rounded p-2",children:" Please enter both name and phone number below to create customer"})]})})]}),a.jsxs("div",{className:"pt-3",children:[a.jsx("label",{className:"block text-xs sm:text-sm font-medium text-orange-700 mb-1",children:"Phone Number *"}),a.jsx("input",{type:"tel",value:C,onChange:Ke=>w(Ke.target.value),placeholder:"Enter phone number",className:"w-full px-3 py-2 border border-orange-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 text-sm",required:!0})]}),T.trim()&&C.trim()&&!Q&&a.jsxs("button",{onClick:()=>{ht(T,C),V(!1)},className:"w-full px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm",children:[' Add "',T,'" to CRM & Link Credit']}),T.trim()&&!C.trim()&&!Q&&a.jsx("div",{className:"text-xs text-orange-600 bg-orange-100 border border-orange-200 rounded p-2",children:" Please enter phone number to create customer in CRM"}),a.jsx("div",{className:"bg-orange-100 border border-orange-200 rounded p-3",children:a.jsxs("p",{className:"text-xs sm:text-sm text-orange-800",children:[a.jsx("strong",{children:"Credit Summary:"}),a.jsx("br",{}),"Total Bill: ",Ue(De),a.jsx("br",{}),"Amount Received: ",Ue(_e),a.jsx("br",{}),"Credit Amount: ",Ue(lt)]})})]})]})]}),a.jsx("div",{className:"px-3 sm:px-6 py-3 sm:py-4 border-t border-gray-200",children:a.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-3",children:[a.jsx("div",{className:"text-xs sm:text-sm text-gray-600",children:m&&a.jsxs("span",{className:"text-green-600 font-medium",children:[" Coupon applied! You saved ",Ue(Ve)]})}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-3",children:[a.jsx("button",{onClick:e,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 text-sm sm:text-base",children:"Cancel"}),a.jsxs("button",{onClick:Vt,disabled:i||ke&&!St&&(!T.trim()||!C.trim())||B&&(me<=0||Fe<=0)||S&&!St&&(!T.trim()||!C.trim()),className:"px-4 sm:px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed text-sm sm:text-base",children:[a.jsx("span",{className:"block sm:hidden",children:i?"Processing...":S?`Add ${Ue(De)} as Credit`:B?`Pay ${Ue(Re)}${Be?"":` (${X>0?"Short":"Over"})`}`:ke?`Pay ${Ue(_e)}`:`Pay ${Ue(De)}`}),a.jsx("span",{className:"hidden sm:block",children:i?"Processing...":S?`Add ${Ue(De)} as Credit`:B?`Pay ${Ue(Re)}${Be?"":` (${X>0?"Shortfall":"Overpayment"}: ${Ue(Math.abs(X))})`}`:ke?`Pay ${Ue(_e)} (Credit: ${Ue(lt)})`:`Pay ${Ue(De)}`})]})]})]})})]})]})})}function Ese({isOpen:t,onClose:e,currentTable:r,restaurantId:s,currentOrders:n,onOperationComplete:i}){const[o,l]=R.useState([]),[c,d]=R.useState([]),[u,A]=R.useState("transfer"),[h,f]=R.useState(!1),[p,m]=R.useState(!0);R.useEffect(()=>{t&&g()},[t,s]);const g=async()=>{m(!0);try{const C=await fs.getTablesForRestaurant(s);if(C.success&&C.data){const w=C.data.filter(S=>S.id===r.id?!1:u==="transfer"?S.status==="available":S.status==="available"||S.status==="occupied");l(w)}}catch(C){console.error("Failed to load tables:",C),Z.error("Failed to load available tables")}finally{m(!1)}},y=C=>{A(C),d([]),g()},v=C=>{d(u==="transfer"?[C]:w=>w.includes(C)?w.filter(S=>S!==C):[...w,C])},x=async()=>{if(c.length!==1){Z.error("Please select one table to transfer to");return}f(!0);try{const C=await Ur.transferOrders(r.id,c[0],s);if(!C.success)throw new Error(C.error||"Failed to transfer orders");const w=await fs.transferTable(r.id,c[0],s);if(!w.success)throw new Error(w.error||"Failed to update table status");const S=o.find(F=>F.id===c[0]);Z.success(`Orders transferred to Table ${S==null?void 0:S.number}`),i(),e()}catch(C){console.error("Transfer failed:",C),Z.error(C instanceof Error?C.message:"Transfer failed")}finally{f(!1)}},E=async()=>{if(c.length===0){Z.error("Please select at least one table to merge");return}f(!0);try{const C=[r.id,...c],w=await fs.mergeTables(C,s);if(!w.success)throw new Error(w.error||"Failed to merge tables");const S=[r.number,...c.map(F=>{const B=o.find(k=>k.id===F);return(B==null?void 0:B.number)||"Unknown"})];for(const F of n)await Ur.updateOrderForMerge(F.id,s,S);Z.success(`Tables ${S.join(", ")} merged successfully`),i(),e()}catch(C){console.error("Merge failed:",C),Z.error(C instanceof Error?C.message:"Merge failed")}finally{f(!1)}},T=()=>n.reduce((C,w)=>C+w.total,0),j=()=>c.map(C=>{const w=o.find(S=>S.id===C);return w?`Table ${w.number}`:"Unknown"}).join(", ");return t?a.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:a.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[a.jsx("div",{className:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75",onClick:e}),a.jsxs("div",{className:"inline-block w-full max-w-2xl my-8 overflow-hidden text-left align-middle transition-all transform bg-white shadow-xl rounded-2xl",children:[a.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Table Management"}),a.jsxs("p",{className:"text-sm text-gray-600",children:["Current Table: ",r.number," | ",n.length," orders | ",Ue(T())]})]}),a.jsx("button",{onClick:e,className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100",children:a.jsx(qr,{className:"w-5 h-5"})})]})}),a.jsxs("div",{className:"px-6 py-4",children:[a.jsxs("div",{className:"mb-6",children:[a.jsxs("div",{className:"flex space-x-4",children:[a.jsxs("button",{onClick:()=>y("transfer"),className:`flex items-center px-4 py-2 rounded-lg transition-colors ${u==="transfer"?"bg-blue-100 text-blue-800 border-2 border-blue-300":"bg-gray-100 text-gray-600 border-2 border-gray-200 hover:bg-gray-200"}`,children:[a.jsx(dx,{className:"w-4 h-4 mr-2"}),"Transfer Table"]}),a.jsxs("button",{onClick:()=>y("merge"),className:`flex items-center px-4 py-2 rounded-lg transition-colors ${u==="merge"?"bg-purple-100 text-purple-800 border-2 border-purple-300":"bg-gray-100 text-gray-600 border-2 border-gray-200 hover:bg-gray-200"}`,children:[a.jsx(tB,{className:"w-4 h-4 mr-2"}),"Merge Tables"]})]}),a.jsxs("div",{className:"mt-2",children:[u==="transfer"&&a.jsx("p",{className:"text-sm text-gray-600",children:"Move all orders from this table to another available table"}),u==="merge"&&a.jsx("p",{className:"text-sm text-gray-600",children:"Combine orders from multiple tables into one bill"})]})]}),a.jsxs("div",{className:"mb-6",children:[a.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:u==="transfer"?"Select Target Table":"Select Tables to Merge"}),p?a.jsxs("div",{className:"text-center py-4",children:[a.jsx("div",{className:"inline-block animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),a.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"Loading tables..."})]}):a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3 max-h-48 overflow-y-auto",children:o.map(C=>a.jsxs("button",{onClick:()=>v(C.id),className:`p-3 border-2 rounded-lg text-center transition-colors ${c.includes(C.id)?"border-blue-500 bg-blue-50 text-blue-800":"border-gray-200 hover:border-gray-300 text-gray-700"}`,children:[a.jsxs("div",{className:"font-medium",children:["Table ",C.number]}),a.jsx("div",{className:"text-xs text-gray-500",children:C.area}),a.jsx("div",{className:`text-xs mt-1 px-2 py-1 rounded-full ${C.status==="available"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:C.status})]},C.id))}),o.length===0&&!p&&a.jsxs("div",{className:"text-center py-8",children:[a.jsx(oi,{className:"w-8 h-8 text-gray-400 mx-auto mb-2"}),a.jsx("p",{className:"text-gray-600",children:u==="transfer"?"No available tables for transfer":"No tables available for merging"})]})]}),c.length>0&&a.jsxs("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[a.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Operation Summary"}),u==="transfer"&&a.jsxs("p",{className:"text-sm text-gray-600",children:["Transfer ",n.length," orders from Table ",r.number," to ",j()]}),u==="merge"&&a.jsxs("p",{className:"text-sm text-gray-600",children:["Merge Table ",r.number," with ",j()]}),a.jsxs("p",{className:"text-sm font-medium text-gray-900 mt-1",children:["Total Amount: ",Ue(T())]})]})]}),a.jsx("div",{className:"px-6 py-4 border-t border-gray-200 bg-gray-50",children:a.jsxs("div",{className:"flex items-center justify-end space-x-3",children:[a.jsx("button",{onClick:e,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",disabled:h,children:"Cancel"}),a.jsx("button",{onClick:u==="transfer"?x:E,disabled:c.length===0||h,className:`px-4 py-2 text-sm font-medium text-white rounded-lg transition-colors ${c.length===0||h?"bg-gray-400 cursor-not-allowed":u==="transfer"?"bg-blue-600 hover:bg-blue-700":"bg-purple-600 hover:bg-purple-700"}`,children:h?a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Processing..."]}):a.jsx("div",{className:"flex items-center",children:u==="transfer"?a.jsxs(a.Fragment,{children:[a.jsx(dx,{className:"w-4 h-4 mr-1"}),"Transfer"]}):a.jsxs(a.Fragment,{children:[a.jsx(tB,{className:"w-4 h-4 mr-1"}),"Merge"]})})})]})})]})]})}):null}function _se(){const{tableId:t}=uu(),e=Li(),{restaurant:r}=js(),{user:s}=ia(),[n,i]=R.useState(null),[o,l]=R.useState([]),[c,d]=R.useState([]),[u,A]=R.useState([]),[,h]=R.useState(null),[f,p]=R.useState([]),[m,g]=R.useState("cart"),[y,v]=R.useState("all"),[x,E]=R.useState(""),[T,j]=R.useState(!0),[C,w]=R.useState(!1),[S,F]=R.useState(!1),[B,k]=R.useState(!1),[D,q]=R.useState(!1),[te,W]=R.useState(!1),[Q,re]=R.useState(null),[G,Ae]=R.useState(!1),[he,I]=R.useState(!1),[U,V]=R.useState(!1),[L,K]=R.useState("processing"),[fe,ee]=R.useState(""),[de,ue]=R.useState(!1),[Ie,Y]=R.useState(null),[H,je]=R.useState(!1),[Ce,oe]=R.useState(null),[He,ie]=R.useState(null),[le,ae]=R.useState(""),[ve,we]=R.useState(!1),[De,Ve]=R.useState(!1),[me,Fe]=R.useState(!0),{register:Re,handleSubmit:Be,reset:X}=nn(),{setValue:_e}=nn({defaultValues:{method:"cash"}});R.useEffect(()=>{console.log(" TakeOrder: Auth state changed:",{hasUser:!!s,userId:s==null?void 0:s.id,userName:s==null?void 0:s.name,userRole:s==null?void 0:s.role,loading:!1})},[s]),R.useEffect(()=>{const se=z=>{he&&(z.target.closest(".mobile-actions-menu")||I(!1))};if(he)return document.addEventListener("click",se),()=>document.removeEventListener("click",se)},[he]);const ke=async()=>{if(!(!r||!t))try{j(!0);const se=await fs.getTableById(t,r.id);se.success&&se.data&&i(se.data),console.log(" Initializing default menu for restaurant:",r.id);const z=await Ts.initializeDefaultMenu(r.id);z.success?console.log(" Default menu initialization successful"):console.error(" Default menu initialization failed:",z.error);const[ce,xe]=await Promise.all([Ts.getMenuItemsForRestaurant(r.id),Ts.getCategoriesForRestaurant(r.id)]);ce.success&&ce.data&&l(ce.data.filter(Pe=>Pe.isAvailable)),xe.success&&xe.data&&d(xe.data)}catch{Z.error("Failed to load menu data")}finally{j(!1)}},lt=()=>{if(r&&t){const se=As.getCartItems(r.id,t);A(se)}},mt=async(se=0)=>{if(!(!r||!t))try{Ur.clearCache(r.id),se>0&&(console.log(` TakeOrder: Retry attempt ${se} for table ${t}`),await new Promise(ce=>setTimeout(ce,1e3)));const z=await Ur.getOrdersByTable(r.id,t);if(z.success&&z.data){const ce=z.data.filter(Pe=>["placed","confirmed","preparing","ready"].includes(Pe.status)||Pe.status==="completed"&&Pe.paymentStatus!=="paid");if(console.log(` TakeOrder: Found ${ce.length} active orders for table ${t}`,{orders:ce.map(Pe=>({id:Pe.id,status:Pe.status,paymentStatus:Pe.paymentStatus}))}),n&&n.status==="available"&&ce.length>0){console.warn(` TakeOrder: Inconsistent state detected - Table ${n.number} shows as available but has ${ce.length} active orders`),console.log(` TakeOrder: Auto-cancelling ${ce.length} stale orders for available table ${n.number}`);const Pe=ce.map(async Ze=>Ur.updateOrderStatus(Ze.id,r.id,"cancelled",{notes:`Auto-cancelled: Table marked as available but order was still active - ${new Date().toLocaleString()}`}));await Promise.all(Pe),Ur.clearCache(r.id),p([]),h(null),ie(null),g("cart"),As.clearCart(r.id,t),A([]),Z.success(` Cleaned up ${ce.length} stale order(s) for Table ${n.number}`);return}const xe=ce.filter((Pe,Ze,Ye)=>Ze===Ye.findIndex(Je=>Je.id===Pe.id));if(p(xe),ce.length>0){const Pe=ce.sort((Ze,Ye)=>new Date(Ye.createdAt).getTime()-new Date(Ze.createdAt).getTime())[0];h(Pe),console.log(` TakeOrder: Found ${ce.length} active orders, forcing state to 'placed'`),g("placed"),As.clearCart(r.id,t),A([])}else{if(console.log(` TakeOrder: No active orders found for table ${t}`),se===0){console.log(` TakeOrder: No orders found, retrying once for table ${t}`),setTimeout(()=>mt(1),500);return}m!=="completed"&&(console.log(" TakeOrder: Resetting to cart state"),g("cart"),h(null),ie(null))}}}catch(z){console.error("Failed to check existing order:",z),se===0&&(console.log(` TakeOrder: Error occurred, retrying for table ${t}`),setTimeout(()=>mt(1),1e3))}},pt=(se,z=1,ce=!1)=>{if(console.log(" addToCart called:",{itemName:se.name,quantity:z,forceAdd:ce,orderState:m,hasRestaurant:!!r,hasTableId:!!t}),!r||!t){console.error(` Missing required data: restaurant=${!!r}, tableId=${!!t}`);return}if(!ce&&!["cart","adding_more"].includes(m)){console.log(` Order state ${m} not allowed for manual add, skipping`);return}if(se.variants&&se.variants.length>0&&!ce){re(se),W(!0);return}const xe={menuItemId:se.id,name:se.name,price:se.price,quantity:z,total:se.price*z};console.log(" Adding cart item:",xe);const Pe=As.addToCart(r.id,xe,t);console.log(` Cart updated, new length: ${Pe.length}`),A(Pe),Z.success(`${se.name} added to order`)},ze=(se,z)=>{if(!r||!t||!Q)return;const ce=Number(z)||Number(Q.price)||0,xe=se.map(Je=>`${Je.variantName}: ${Je.optionName}`),Pe=xe.length>0?`${Q.name} (${xe.join(", ")})`:Q.name,Ze={menuItemId:Q.id,name:Pe,price:ce,quantity:1,total:ce,variants:se},Ye=As.addToCart(r.id,Ze,t);A(Ye),Z.success(`${Q.name} added to order`),re(null),W(!1)},Me=(se,z)=>{if(!r||!t||!["cart","adding_more"].includes(m))return;const ce=As.updateCartItemQuantity(r.id,se,z,t);A(ce)},rt=se=>{if(!r||!t||!["cart","adding_more"].includes(m))return;const z=As.removeFromCart(r.id,se,t);A(z)},ht=()=>{g("adding_more"),q(!0),r&&As.clearCart(r.id,t),A([]),X()},Qe=async(se,z)=>{var ce;if(console.log(" handlePlaceOrderWithCart called with:",{restaurant:r==null?void 0:r.name,tableId:t,cartItemsCount:se.length,user:s==null?void 0:s.name,userId:s==null?void 0:s.id,orderNotes:z.orderNotes,isVoiceProcessing:U}),!r||!t||se.length===0||!s){const xe=[];r||xe.push("restaurant"),t||xe.push("tableId"),se.length===0&&xe.push("cartItems"),s||xe.push("user");const Pe=`Unable to place order. Missing: ${xe.join(", ")}`;return console.error(" Order placement failed:",Pe),U||Z.error(Pe),null}try{w(!0);const xe=se.reduce((et,ft)=>et+ft.total,0),Pe=((ce=r.settings)==null?void 0:ce.taxRate)||8.5,Ze=xe*Pe/100,Ye=xe+Ze;console.log(" Order totals:",{subtotal:xe,taxRate:Pe,tax:Ze,total:Ye});const Je=await Ur.createOrder(r.id,t,s.id,se,Pe,z.orderNotes);if(Je.success&&Je.data){const et=Je.data;if(console.log(" Order created successfully:",{orderId:et.id,orderNumber:et.orderNumber,total:et.total,itemCount:et.items.length}),h(et),ie(et),m==="adding_more"?(p(ft=>ft.find(Nt=>Nt.id===et.id)?ft:[...ft,et]),g("placed"),q(!1)):(p([et]),g("placed")),As.clearCart(r.id,t),A([]),X(),!U){const ft=m==="adding_more"?"Additional order placed successfully!":"Order placed successfully!";Z.success(ft)}return console.log(" Order placement completed successfully"),n&&(oe({orderNumber:et.orderNumber,tableNumber:n.number,items:et.items.map(ft=>({name:ft.name,quantity:ft.quantity}))}),je(!0)),et}else return console.error(" Order creation failed:",Je.error),U||Z.error(Je.error||"Failed to place order"),null}catch(xe){return console.error(" Order placement exception:",xe),U||Z.error("Failed to place order"),null}finally{w(!1)}},Ge=async se=>{if(console.log(" handlePlaceOrder called with:",{restaurant:r==null?void 0:r.name,tableId:t,cartItemsCount:u.length,user:s==null?void 0:s.name,userId:s==null?void 0:s.id,orderNotes:se.orderNotes}),!r||!t||u.length===0||!s){const z=[];r||z.push("restaurant"),t||z.push("tableId"),u.length===0&&z.push("cartItems"),s||z.push("user");const ce=`Unable to place order. Missing: ${z.join(", ")}`;console.error(" Order placement failed:",ce),Z.error(ce);return}try{w(!0),console.log(" Starting order placement process..."),m==="cart"&&(console.log(" Updating table status to occupied..."),await fs.updateTable(t,r.id,{status:"occupied"})),console.log(" Creating order in Firebase...",{restaurantId:r.id,tableId:t,staffId:s.id,itemCount:u.length,taxRate:r.settings.taxRate});const z=await Ur.createOrder(r.id,t,s.id,u,r.settings.taxRate,se.orderNotes||void 0);if(z.success&&z.data){const ce=z.data;console.log(" Order created successfully:",{orderId:ce.id,orderNumber:ce.orderNumber,total:ce.total,itemCount:ce.items.length}),h(ce),ie(ce),m==="adding_more"?(p(Pe=>Pe.find(Ye=>Ye.id===ce.id)?Pe:[...Pe,ce]),g("placed"),q(!1)):(p([ce]),g("placed"),q(!1)),As.clearCart(r.id,t),A([]),X();const xe=m==="adding_more"?"Additional order placed successfully!":"Order placed successfully!";Z.success(xe),console.log(" Order placement completed successfully"),n&&(oe({orderNumber:ce.orderNumber,tableNumber:n.number,items:ce.items.map(Pe=>({name:Pe.name,quantity:Pe.quantity}))}),je(!0))}else console.error(" Order creation failed:",z.error),Z.error(z.error||"Failed to place order")}catch(z){console.error(" Order placement exception:",z),Z.error("Failed to place order")}finally{w(!1)}},gt=()=>{if(!r||!n||!He)return;const se=He;let z;f.length===1?z=SB(se,r,n):z=jB(se,r,n,f.length);const ce=window.open("","_blank");ce&&(ce.document.write(z),ce.document.close(),ce.focus(),ce.print(),ce.close()),Z.success("KOT sent to printer")},St=async se=>{if(!(!r||!t||!n||f.length===0))try{if(F(!0),se.appliedCoupon)try{await Oo.markCouponAsUsed(se.appliedCoupon.coupon.id,r.id),Z.success(`Coupon "${se.appliedCoupon.coupon.code}" has been redeemed!`)}catch(Ze){console.error("Failed to mark coupon as used:",Ze)}let z=null;if(se.isCredit&&se.creditCustomerName){const Ze=await Mf.createCreditTransaction({restaurantId:r.id,customerId:se.customerId,customerName:se.creditCustomerName,customerPhone:se.creditCustomerPhone,orderId:f.map(Ye=>Ye.id).join(","),tableNumber:n.number,totalAmount:se.finalTotal,amountReceived:se.amountReceived,paymentMethod:se.method,notes:`Credit payment for Table ${n.number}`});if(Ze.success)z=Ze.creditId,Z.success(`Credit transaction created for ${Ue(se.creditAmount)}`);else{Z.error("Failed to create credit transaction");return}}const ce=f.map(async Ze=>{const Ye={status:"completed",paymentMethod:se.isCredit?se.addWholeAmountAsCredit?"credit":"partial_credit":se.method,amountReceived:se.amountReceived,finalTotal:se.finalTotal,originalTotal:se.originalTotal,total:se.finalTotal};return(se.manualDiscountAmount>0||se.couponDiscountAmount>0)&&(Ye.discountApplied=!0,Ye.totalDiscountAmount=(se.manualDiscountAmount||0)+(se.couponDiscountAmount||0),Ye.originalTotalBeforeDiscount=se.originalTotal,se.manualDiscount&&(Ye.manualDiscount={type:se.manualDiscount.type,value:se.manualDiscount.value,amount:se.manualDiscountAmount,reason:se.manualDiscount.reason||""}),se.couponDiscountAmount>0&&(Ye.couponDiscountAmount=se.couponDiscountAmount),Ye.discount=(se.manualDiscountAmount||0)+(se.couponDiscountAmount||0)),se.tip>0&&(Ye.tip=se.tip),se.totalSavings>0&&(Ye.totalSavings=se.totalSavings),se.isCredit&&(Ye.isCredit=!0,Ye.creditAmount=se.creditAmount,Ye.creditCustomerName=se.creditCustomerName,Ye.creditCustomerPhone=se.creditCustomerPhone,Ye.creditTransactionId=z),se.appliedCoupon&&(Ye.appliedCoupon={code:se.appliedCoupon.coupon.code,name:se.appliedCoupon.coupon.name,discountAmount:se.appliedCoupon.discountAmount||0,freeItems:se.appliedCoupon.freeItems||[],totalSavings:se.totalSavings||0}),se.customerId&&(Ye.customerId=se.customerId),Ur.updateOrderStatus(Ze.id,r.id,"completed",Ye)});if((await Promise.all(ce)).every(Ze=>Ze.success)){se.customerId&&await wn.addOrderToCustomer(se.customerId,r.id,f.map(Ye=>Ye.id).join(","),se.finalTotal),await fs.updateTable(t,r.id,{status:"available"}),g("completed"),k(!1);let Ze="Payment processed successfully!";se.isCredit?Ze=`Payment processed! Credit of ${Ue(se.creditAmount)} recorded for ${se.creditCustomerName}`:se.totalSavings>0&&(Ze=`Payment processed! Customer saved ${Ue(se.totalSavings)} with coupon!`),Z.success(Ze),setTimeout(async()=>{await qe(f,se)},500)}else Z.error("Failed to complete payment for some orders")}catch(z){Z.error("Failed to process payment"),console.error("Payment error:",z)}finally{F(!1)}},Vt=()=>{!r||!t||!["cart","adding_more"].includes(m)||(As.clearCart(r.id,t),A([]),m==="adding_more"&&(g("placed"),q(!1)),Z.success("Order cleared"))},Kt=async()=>{if(!(!r||!t||!n||f.length===0||!confirm(`Are you sure you want to cancel all ${f.length} order(s) for Table ${n.number}? This action cannot be undone.`)))try{w(!0);const z=f.map(async Pe=>Ur.updateOrderStatus(Pe.id,r.id,"cancelled",{notes:"Order cancelled manually - "+new Date().toLocaleString()}));(await Promise.all(z)).every(Pe=>Pe.success)?(await fs.updateTable(t,r.id,{status:"available"}),p([]),h(null),ie(null),g("cart"),As.clearCart(r.id,t),A([]),Z.success(`All orders for Table ${n.number} have been cancelled successfully`),setTimeout(()=>{e(`/${r.slug}/tables`)},1500)):Z.error("Failed to cancel some orders. Please try again.")}catch(z){console.error("Error canceling orders:",z),Z.error("Failed to cancel orders")}finally{w(!1)}},qe=async(se,z)=>{if(!(!se.length||!r||!n))try{const ce=Z.loading("Generating bill with QR code...");console.log(" Starting bill generation with QR code...");const xe=await tC(se,r,n,z);Z.dismiss(ce),await new Promise(Ze=>setTimeout(Ze,500));const Pe=window.open("","_blank");Pe&&(Pe.document.write(xe),Pe.document.close(),Pe.addEventListener("load",()=>{setTimeout(()=>{Pe.focus(),Pe.print()},1e3)}),setTimeout(()=>{Pe.focus(),Pe.print(),Pe.close()},2e3)),Z.success("Combined bill sent to printer")}catch(ce){console.error(" Error generating bill:",ce),Z.error("Failed to generate bill")}},Xe=async()=>{if(!le.trim()){Z.error("Please enter a WhatsApp number");return}if(!r||!n){Z.error("Restaurant or table data not available");return}we(!0);try{const{WhatsAppUtils:se}=await Pn(async()=>{const{WhatsAppUtils:et}=await import("./whatsappUtils-BkNmI_rv.js");return{WhatsAppUtils:et}},[]);let z=f;if(z.length===0){console.log(" WhatsApp: No orders in state, fetching recent completed orders...");const et=await Ur.getOrdersByTable(r.id,t||"");if(et.success&&et.data){const ft=new Date;ft.setHours(0,0,0,0);const At=et.data.filter(Nt=>Nt.status==="completed"&&new Date(Nt.createdAt)>=ft).sort((Nt,kt)=>new Date(kt.createdAt).getTime()-new Date(Nt.createdAt).getTime());At.length>0&&(z=At,console.log(` WhatsApp: Found ${z.length} recent completed orders`))}}if(z.length===0){Z.error("No recent orders found for this table");return}const ce={method:"cash",amountReceived:z.reduce((et,ft)=>et+ft.total,0),finalTotal:z.reduce((et,ft)=>et+ft.total,0),originalTotal:z.reduce((et,ft)=>et+ft.total,0)},xe=await tC(z,r,n,ce),Pe={restaurantName:r.name||"Restaurant",tableNumber:n.number,orderNumbers:z.map(et=>et.orderNumber),totalAmount:z.reduce((et,ft)=>et+ft.total,0),billContent:xe},Ze=se.generateBillMessage(Pe),Ye=se.createWhatsAppUrl(le,Ze,me);window.open(Ye,"_blank");const Je=me?"WhatsApp Web opened! Send the bill to complete sharing.":"WhatsApp opened! Send the bill to complete sharing.";Z.success(Je),ae("")}catch(se){console.error("Error preparing WhatsApp bill:",se),se instanceof Error&&se.message.includes("Invalid phone number")?Z.error("Please enter a valid phone number"):Z.error("Failed to prepare WhatsApp bill")}finally{we(!1)}},Ke=async()=>{if(!le.trim()){Z.error("Please enter a WhatsApp number");return}if(!r||!n){Z.error("Restaurant or table data not available");return}Ve(!0);try{const{WhatsAppUtils:se}=await Pn(async()=>{const{WhatsAppUtils:At}=await import("./whatsappUtils-BkNmI_rv.js");return{WhatsAppUtils:At}},[]);let z=f;if(z.length===0){console.log(" PDF: No orders in state, fetching recent completed orders...");const At=await Ur.getOrdersByTable(r.id,t||"");if(At.success&&At.data){const Nt=new Date;Nt.setHours(0,0,0,0);const kt=At.data.filter(Ht=>Ht.status==="completed"&&new Date(Ht.createdAt)>=Nt).sort((Ht,ir)=>new Date(ir.createdAt).getTime()-new Date(Ht.createdAt).getTime());kt.length>0&&(z=kt,console.log(` PDF: Found ${z.length} recent completed orders`))}}if(z.length===0){Z.error("No recent orders found for this table");return}const ce={method:"cash",amountReceived:z.reduce((At,Nt)=>At+Nt.total,0),finalTotal:z.reduce((At,Nt)=>At+Nt.total,0),originalTotal:z.reduce((At,Nt)=>At+Nt.total,0)},xe=await tC(z,r,n,ce),Pe=new Date().toISOString().split("T")[0],Ze=`${r.name.replace(/\s+/g,"_")}_Table_${n.number}_${Pe}.pdf`;await se.generateBillPDF(xe,Ze);const Ye={restaurantName:r.name||"Restaurant",tableNumber:n.number,orderNumbers:z.map(At=>At.orderNumber),totalAmount:z.reduce((At,Nt)=>At+Nt.total,0)},Je=se.generatePDFSharingMessage(Ye),et=se.createWhatsAppUrl(le,Je,me);window.open(et,"_blank");const ft=me?"PDF downloaded! WhatsApp Web opened - please attach the downloaded PDF file.":"PDF downloaded! WhatsApp opened - please attach the downloaded PDF file.";Z.success(ft,{duration:5e3}),ae("")}catch(se){console.error("Error generating PDF or preparing WhatsApp:",se),se instanceof Error&&se.message.includes("Invalid phone number")?Z.error("Please enter a valid phone number"):se instanceof Error&&se.message.includes("Failed to generate PDF")?Z.error("Failed to generate PDF. Please try the text version instead."):Z.error("Failed to generate PDF bill")}finally{Ve(!1)}},We=R.useCallback(async se=>{const{command:z}=se.detail;if(console.log(" TakeOrder: Voice order command received:",z),!r||!t){Z.error(" Unable to process order at this time");return}if(!z.tableNumber||parseInt((n==null?void 0:n.number)||"")!==z.tableNumber){const Pe=n==null?void 0:n.number;console.warn(` Table mismatch: current=${Pe}, requested=${z.tableNumber}`),Z.error(` This is table ${Pe}, but order was requested for table ${z.tableNumber}`);return}Z.dismiss(),V(!0),K("processing"),ee("Processing voice command...");const ce=f.length>0,xe=ce&&(m==="placed"||m==="completed");if(console.log(" Voice Order Context:",{tableNumber:n==null?void 0:n.number,hasExistingOrders:ce,existingOrdersCount:f.length,currentOrderState:m,isAddingToExistingOrder:xe}),z.menuItems&&z.menuItems.length>0){let Pe=0;try{console.log(" TakeOrder: Using AI to match voice items to menu items...");const{VoiceService:Ze}=await Pn(async()=>{const{VoiceService:Je}=await Promise.resolve().then(()=>eM);return{VoiceService:Je}},void 0),Ye=await Ze.matchMenuItemsIntelligently(z.menuItems,o);K("placing"),xe?(ee(`Adding items to existing order for table ${n==null?void 0:n.number}...`),console.log(" Adding items to existing order (add-more functionality)")):(ee("Adding items to new order..."),console.log(" Creating new order for table"));for(const Je of Ye)if(Je.matchedItem){console.log(` TakeOrder: AI matched "${Je.name}"  "${Je.matchedItem.name}"`);const et=r&&t?As.getCartItems(r.id,t):[];ee(`Adding ${Je.matchedItem.name} to order...`),xe?(console.log(" Setting orderState to 'adding_more' for voice command on table with existing orders"),g("adding_more"),q(!0),r&&t&&(As.clearCart(r.id,t),A([]))):(m==="placed"||m==="completed")&&(console.log(" Setting orderState to 'cart' for voice command on empty table"),g("cart")),pt(Je.matchedItem,Je.quantity,!0),await new Promise(At=>setTimeout(At,200));const ft=r&&t?As.getCartItems(r.id,t):[];if(ft.length>et.length)Pe++,console.log(` Verified: Added ${Je.quantity}x ${Je.matchedItem.name} to cart (${et.length}  ${ft.length})`);else if(console.error(` Failed to add ${Je.matchedItem.name} to cart - orderState: ${m}`),r&&t){console.log(" Attempting direct cart addition as fallback");const At={menuItemId:Je.matchedItem.id,name:Je.matchedItem.name,price:Je.matchedItem.price,quantity:Je.quantity,total:Je.matchedItem.price*Je.quantity},Nt=As.addToCart(r.id,At,t);A(Nt);const kt=As.getCartItems(r.id,t);kt.length>et.length?(Pe++,console.log(` Direct addition successful: ${et.length}  ${kt.length}`)):console.error(" Direct addition also failed")}}else console.warn(` TakeOrder: No match found for voice item: ${Je.name}`);if(Pe>0){if(console.log(` Voice cart update complete. Added ${Pe} items.`),K("placing"),ee(xe?"Creating additional order...":"Creating your order..."),r&&t){const Je=As.getCartItems(r.id,t);A(Je),console.log(` Cart updated: ${Je.length} items total`),Je.length>0?setTimeout(async()=>{console.log(" Auto-placing order after voice command");const et=As.getCartItems(r.id,t);if(console.log(` Final cart check before placing: ${et.length} items`),et.length>0)try{const ft=xe?`Voice add-more order: ${Ye.filter(Nt=>Nt.matchedItem).map(Nt=>`${Nt.quantity}x ${Nt.name}`).join(", ")} - placed at ${new Date().toLocaleTimeString()}`:`Voice order: ${Ye.filter(Nt=>Nt.matchedItem).map(Nt=>`${Nt.quantity}x ${Nt.name}`).join(", ")} - placed at ${new Date().toLocaleTimeString()}`,At=await Qe(et,{orderNotes:ft});if(At)K("completed"),ee(xe?"Additional order placed successfully!":"Order placed successfully!"),n&&z.menuItems&&Y({orderNumber:At.orderNumber,tableNumber:n.number,items:Ye.filter(Nt=>Nt.matchedItem).map(Nt=>{var kt;return{name:((kt=Nt.matchedItem)==null?void 0:kt.name)||Nt.name,quantity:Nt.quantity}})}),setTimeout(()=>{V(!1),q(!1);const kt=Ye.filter(Ht=>Ht.matchedItem).map(Ht=>{var ir;return`${Ht.quantity}x ${(ir=Ht.matchedItem)==null?void 0:ir.name}`}).join(", ");xe?Z.success(` Additional items added: ${kt} - KOT printed for new items only!`,{duration:4e3}):Z.success(` Voice order completed: ${kt} placed for table ${n==null?void 0:n.number}!`,{duration:4e3}),console.log(` KOT will be printed automatically for the new order: ${At.orderNumber}`)},1e3);else throw new Error("Failed to create order")}catch(ft){console.error(" Voice order placement failed:",ft),V(!1),q(!1),Z.error(" Failed to place order. Please try manually.")}else console.error(" Cart is empty during auto-place, cannot proceed"),V(!1),q(!1),Z.error(" Failed to place order - cart appears to be empty")},500):(console.error(" No items in cart after voice command processing"),V(!1),q(!1),Z.error(" Failed to add items to cart"))}}else{V(!1),q(!1);const Je=Ye.filter(et=>!et.matchedItem);if(Je.length>0){const et=Je.map(ft=>ft.name).join(", ");Z.error(` Menu items not found: ${et}`)}else Z.error(" No valid menu items found to add to the order")}}catch(Ze){console.error(" Voice order processing failed:",Ze),V(!1),q(!1),Z.error(" Failed to process voice order")}}else V(!1),Z.error(" Please specify menu items to add to the order")},[o,pt,Qe,n,r,t,m,f]),Ft=R.useCallback(async se=>{const{command:z}=se.detail;if(console.log(" Voice payment command received:",{command:z,currentTable:n==null?void 0:n.number,ordersCount:f.length,cartItemsCount:u.length}),z.tableNumber&&n&&parseInt(n.number)!==z.tableNumber){Z.error(` This is table ${n.number}, but payment was requested for table ${z.tableNumber}`);return}if(f.length===0&&u.length===0){Z.error(` No orders found for payment on table ${n==null?void 0:n.number}`);return}if(u.length>0){Z.error(" Please place the current order first before making payment"),console.log(" Cart has items, cannot process payment yet");return}const ce={UPI:"upi",CASH:"cash",BANK:"bank",CARD:"bank",CREDIT:"bank",DEBIT:"bank",MONEY:"cash",GPAY:"upi",PAYTM:"upi",PHONEPE:"upi"},xe=z.paymentMethod?ce[z.paymentMethod]:"cash";if(console.log(" Payment method mapping:",{originalMethod:z.paymentMethod,mappedMethod:xe}),!xe){Z.error(` Invalid payment method: ${z.paymentMethod}`);return}const Pe=f.reduce((Ze,Ye)=>Ze+Ye.total,0);console.log(" Processing voice payment:",{method:xe,combinedTotal:Pe,ordersCount:f.length,tableNumber:n==null?void 0:n.number});try{Z.success(` Processing ${xe.toUpperCase()} payment for table ${n==null?void 0:n.number}...`),Z(` Total amount: ${Pe.toFixed(2)}`);const Ze={method:xe,amountReceived:Pe,originalTotal:Pe,finalTotal:Pe,tip:0,reference:`Voice payment - ${new Date().toLocaleTimeString()}`,customerId:void 0,appliedCoupon:void 0,totalSavings:0,printBill:!0};console.log(" Payment data prepared:",Ze),Z(" Finalizing payment and updating order status..."),await St(Ze),Z.success(` Payment of ${Pe.toFixed(2)} completed via ${xe.toUpperCase()}!`),Z.success(` Table ${n==null?void 0:n.number} is now available for new customers`),console.log(" Voice payment completed successfully"),setTimeout(()=>{e(`/${r==null?void 0:r.slug}/tables`)},3e3)}catch(Ze){console.error(" Voice payment failed:",Ze),Z.error(" Voice payment failed. Please process manually."),k(!0),Z(" Opening payment window for manual processing...")}},[n,f,u,St,r,e]),Ct=R.useCallback(async se=>{const{command:z}=se.detail;if(console.log(" TakeOrder: Voice KOT print command received:",z),!r||!n||f.length===0){console.log(" Missing requirements for KOT printing:",{hasRestaurant:!!r,hasTable:!!n,orderCount:f.length}),f.length===0?Z.error(" No orders to print KOT for"):Z.error(" Unable to print KOT at this time");return}console.log(" Triggering KOT print for table:",n.number),gt(),Z.success(` KOT printed for table ${n.number}`)},[r,n,f,gt]),xr=R.useCallback(async se=>{const{command:z}=se.detail;if(console.log(" TakeOrder: Voice order cancel command received:",z),!r||!n||f.length===0){console.log(" Missing requirements for order cancellation:",{hasRestaurant:!!r,hasTable:!!n,orderCount:f.length}),f.length===0?Z.error(" No orders to cancel"):Z.error(" Unable to cancel orders at this time");return}try{console.log(" Canceling orders for table:",n.number);const ce=f.map(async Ze=>Ur.updateOrderStatus(Ze.id,r.id,"cancelled",{notes:"Voice command cancellation - "+new Date().toLocaleString()}));(await Promise.all(ce)).every(Ze=>Ze.success)?(await fs.updateTable(n.id,r.id,{status:"available"}),p([]),h(null),g("cart"),As.clearCart(r.id,n.id),A([]),Z.success(" All orders cancelled successfully"),setTimeout(()=>{e(`/${r.slug}/tables`)},1500)):Z.error(" Failed to cancel some orders")}catch(ce){console.error(" Error canceling orders:",ce),Z.error(" Failed to cancel orders")}},[r,n,f,e,Ur,fs,As]),vr=R.useCallback(async se=>{var Ze,Ye;const{command:z}=se.detail;if(console.log(" TakeOrder: Voice customer command received:",z),!r){Z.error(" Restaurant context not available");return}const{customerName:ce,customerPhone:xe,customerEmail:Pe}=z;if(!ce&&!xe){Z.error(" Please specify customer name or phone number");return}try{const Je={name:ce||"",phone:xe||"",email:Pe||"",address:"",preferences:["voice_added"]};console.log(" Creating customer via voice:",Je);const{CustomerService:et}=await Pn(async()=>{const{CustomerService:At}=await Promise.resolve().then(()=>jM);return{CustomerService:At}},void 0),ft=await et.createCustomer(r.id,Je);if(ft.success){const At=ce||`Customer with phone ${xe}`;Z.success(` Successfully added ${At} to CRM!`),Pe&&Z.success(` Email ${Pe} saved for ${At}`),console.log(" Customer created successfully:",ft.data)}else console.error(" Customer creation failed:",ft.error),(Ze=ft.error)!=null&&Ze.includes("already exists")||(Ye=ft.error)!=null&&Ye.includes("duplicate")?Z.error(" Customer with this information already exists in CRM"):Z.error(` Failed to add customer: ${ft.error||"Unknown error"}`)}catch(Je){console.error(" Error creating customer:",Je),Z.error(" Failed to add customer to CRM")}},[r]),Pr=R.useCallback(async se=>{const{command:z}=se.detail;if(console.log(" TakeOrder: Voice place order command received:",{command:z,currentTable:n==null?void 0:n.number,commandTableNumber:z.tableNumber,commandMenuItems:z.menuItems,cartItemsLength:u.length,restaurantExists:!!r}),!r||!n){console.error(" Missing restaurant or table:",{restaurant:!!r,table:!!n}),Z.error(" Unable to place order at this time");return}if(z.tableNumber&&parseInt(n.number)!==z.tableNumber){console.warn(` Table mismatch: current=${n.number}, requested=${z.tableNumber}`),Z.error(` This is table ${n.number}, but order was requested for table ${z.tableNumber}`);return}try{if(z.menuItems&&z.menuItems.length>0){console.log(" Processing voice menu items directly:",z.menuItems);for(const ce of z.menuItems){const Pe=(Ze=>{const Ye=et=>et.toLowerCase().replace(/s$/,"").replace(/ies$/,"y").replace(/es$/,"").trim(),Je=Ze.toLowerCase().split(" ").map(Ye);return o.find(et=>{const ft=et.name.toLowerCase().split(" ").map(Ye);return Je.every(At=>ft.some(Nt=>Nt.includes(At)||At.includes(Nt)))})})(ce.name);Pe?(console.log(` Found menu item: ${Pe.name} for voice item: ${ce.name}`),pt(Pe,ce.quantity,!0)):(console.warn(` Menu item not found: ${ce.name}`),Z.error(`Menu item "${ce.name}" not found`))}setTimeout(async()=>{var ce;console.log(" Placing order after adding voice items to cart"),await Ge({orderNotes:`Voice order: ${(ce=z.menuItems)==null?void 0:ce.map(xe=>`${xe.quantity}x ${xe.name}`).join(", ")} - placed at ${new Date().toLocaleTimeString()}`}),Z.success(` Order placed successfully for table ${n.number}!`)},100)}else{if(u.length===0){console.warn(" No items in cart and no voice menu items"),Z.error(` No items to place order for table ${n.number}`);return}await Ge({orderNotes:`Voice order placed at ${new Date().toLocaleTimeString()}`}),Z.success(` Order placed successfully for table ${n.number}!`)}console.log(" Voice place order completed successfully")}catch(ce){console.error(" Voice place order failed:",ce),Z.error(" Failed to place order. Please try manually.")}},[r,n,u,Ge,m,o,pt]);R.useEffect(()=>(console.log(" TakeOrder: Setting up voice command event listeners"),window.addEventListener("voiceOrderCommand",We),window.addEventListener("voicePlaceOrderCommand",Pr),window.addEventListener("voicePaymentCommand",Ft),window.addEventListener("voiceKotPrintCommand",Ct),window.addEventListener("voiceOrderCancelCommand",xr),window.addEventListener("voiceCustomerCommand",vr),()=>{console.log(" TakeOrder: Cleaning up voice command event listeners"),window.removeEventListener("voiceOrderCommand",We),window.removeEventListener("voicePlaceOrderCommand",Pr),window.removeEventListener("voicePaymentCommand",Ft),window.removeEventListener("voiceKotPrintCommand",Ct),window.removeEventListener("voiceOrderCancelCommand",xr),window.removeEventListener("voiceCustomerCommand",vr)}),[We,Pr,Ft,Ct,xr,vr]),R.useEffect(()=>{console.log(" TakeOrder: Component mounting/loading data...",{tableId:t,restaurantSlug:r==null?void 0:r.slug,hasUser:!!s}),r&&t&&(ke(),lt())},[r,t]),R.useEffect(()=>{if(f.length>0&&B){const se=f.reduce((z,ce)=>z+ce.total,0);_e("amountReceived",se)}},[f,B,_e]),R.useEffect(()=>{if(!r||!t)return;console.log(` TakeOrder: Setting up real-time subscription for table ${t}`);const se=Ur.subscribeToOrders(r.id,z=>{const ce=z.filter(Pe=>Pe.tableId===t),xe=ce.filter(Pe=>["placed","confirmed","preparing","ready"].includes(Pe.status)||Pe.status==="completed"&&Pe.paymentStatus!=="paid");if(console.log(` TakeOrder: Real-time update for table ${t}:`,{totalTableOrders:ce.length,activeOrders:xe.length,orderDetails:xe.map(Pe=>({id:Pe.id,orderNumber:Pe.orderNumber,status:Pe.status,paymentStatus:Pe.paymentStatus}))}),n&&n.status==="available"&&xe.length>0){console.warn(` TakeOrder: Real-time inconsistency - Table ${n.number} is available but has ${xe.length} active orders`),(async()=>{const Ze=xe.map(async Ye=>Ur.updateOrderStatus(Ye.id,r.id,"cancelled",{notes:`Auto-cancelled via real-time sync: Table marked as available - ${new Date().toLocaleString()}`}));await Promise.all(Ze),console.log(` TakeOrder: Real-time cleaned up ${xe.length} stale orders`)})(),p([]),h(null),g("cart"),As.clearCart(r.id,t),A([]);return}if(p(xe),xe.length>0){const Pe=xe.sort((Ze,Ye)=>new Date(Ye.createdAt).getTime()-new Date(Ze.createdAt).getTime())[0];h(Pe),console.log(` TakeOrder: Real-time update forcing state to 'placed' for table ${t}`),g("placed"),As.clearCart(r.id,t),A([])}else m==="placed"&&xe.length===0&&(console.log(" TakeOrder: Real-time update - no active orders, resetting to cart"),g("cart"),h(null))},100);return()=>{console.log(` TakeOrder: Cleaning up real-time subscription for table ${t}`),se()}},[r==null?void 0:r.id,t]);const Mr=R.useMemo(()=>{const se=o.filter(z=>{var Ht;const ce=y==="all"||z.category===y;if(x==="")return ce;const xe=x.toLowerCase().trim(),Pe=z.name.toLowerCase(),Ze=((Ht=z.description)==null?void 0:Ht.toLowerCase())||"",Ye=Pe.includes(xe),Je=Ze.includes(xe),et=Pe.split(" ").some(ir=>ir.startsWith(xe)),ft=Ze.split(" ").some(ir=>ir.startsWith(xe)),At=Pe.split(" ").some(ir=>ir.includes(xe)),Nt=Ze.split(" ").some(ir=>ir.includes(xe));return ce&&(Ye||Je||et||ft||At||Nt)});return x&&se.length>0&&console.log(` Found ${se.length} items for "${x}"`),se},[o,y,x]),Jr=u.reduce((se,z)=>se+z.total,0),ye=Jr*((r==null?void 0:r.settings.taxRate)||8.5)/100,Le=Jr+ye;return!r||!n?a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Loading..."})]})}):a.jsxs("div",{className:"min-h-screen",style:{background:"var(--color-background)"},children:[a.jsx("header",{className:"bg-white/80 backdrop-blur-md border-b border-gray-200 sticky top-0 z-40",children:a.jsx("div",{className:"max-w-full mx-auto px-4 sm:px-6 lg:px-8 py-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx("button",{onClick:()=>e(`/${r.slug}/tables`),className:"p-2 text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsx(Jo,{className:"w-5 h-5"})}),a.jsxs("div",{className:"min-w-0 flex-1",children:[a.jsxs("h1",{className:"text-lg sm:text-xl font-bold text-gray-900 truncate",children:["Table ",n.number," - ",n.area]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-x-4 gap-y-1 text-xs sm:text-sm text-gray-600",children:[a.jsxs("span",{className:"whitespace-nowrap",children:["Capacity: ",n.capacity," guests"]}),a.jsxs("span",{className:"capitalize whitespace-nowrap",children:["Status: ",n.status.replace("_"," ")]}),m==="placed"&&f.length>0&&a.jsxs("span",{className:"text-blue-600 font-medium whitespace-nowrap",children:[f.length," Active Order",f.length>1?"s":""]})]})]})]}),a.jsxs("div",{className:"flex items-center space-x-3",children:[m==="placed"&&f.length>0&&u.length===0&&a.jsxs("div",{className:"hidden sm:flex items-center space-x-2",children:[a.jsxs("button",{onClick:ht,className:"btn btn-theme-primary text-sm px-3 py-1.5",children:[a.jsx(zr,{className:"w-4 h-4 mr-1"}),"Add More"]}),a.jsxs("button",{onClick:gt,className:"btn btn-secondary text-sm px-3 py-1.5",children:[a.jsx(R0,{className:"w-4 h-4 mr-1"}),"KOT"]}),a.jsxs("button",{onClick:()=>k(!0),className:"btn bg-green-600 text-white hover:bg-green-700 text-sm px-3 py-1.5",children:[a.jsx(No,{className:"w-4 h-4 mr-1"}),"Payment"]}),a.jsxs("button",{onClick:()=>Ae(!0),className:"btn bg-blue-600 text-white hover:bg-blue-700 text-sm px-3 py-1.5",children:[a.jsx(dx,{className:"w-4 h-4 mr-1"}),"Manage"]}),a.jsxs("button",{onClick:Kt,disabled:C,className:"btn bg-red-600 text-white hover:bg-red-700 text-sm px-3 py-1.5",children:[a.jsx(qr,{className:"w-4 h-4 mr-1"}),C?"Cancelling...":"Cancel Order"]})]}),m==="placed"&&f.length>0&&u.length===0&&a.jsx("div",{className:"sm:hidden",children:a.jsxs("div",{className:"relative mobile-actions-menu",children:[a.jsx("button",{onClick:()=>I(!he),className:"btn bg-blue-600 text-white hover:bg-blue-700 text-sm px-3 py-1.5 relative",children:a.jsx(cM,{className:"w-4 h-4"})}),he&&a.jsxs("div",{className:"absolute right-0 top-full mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 py-2 z-50",children:[a.jsxs("button",{onClick:()=>{ht(),I(!1)},className:"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-50",children:[a.jsx(zr,{className:"w-4 h-4 mr-3"}),"Add More Items"]}),a.jsxs("button",{onClick:()=>{gt(),I(!1)},className:"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-50",children:[a.jsx(R0,{className:"w-4 h-4 mr-3"}),"Print KOT"]}),a.jsxs("button",{onClick:()=>{k(!0),I(!1)},className:"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-50",children:[a.jsx(No,{className:"w-4 h-4 mr-3"}),"Payment"]}),a.jsxs("button",{onClick:()=>{Ae(!0),I(!1)},className:"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-50",children:[a.jsx(dx,{className:"w-4 h-4 mr-3"}),"Manage Table"]}),a.jsx("div",{className:"border-t border-gray-200"}),a.jsxs("button",{onClick:()=>{Kt(),I(!1)},disabled:C,className:"flex items-center w-full px-4 py-2 text-sm text-red-600 hover:bg-red-50",children:[a.jsx(qr,{className:"w-4 h-4 mr-3"}),C?"Cancelling...":"Cancel Order"]})]})]})}),["cart","adding_more"].includes(m)&&u.length>0&&a.jsxs("button",{onClick:Vt,className:"btn btn-secondary text-sm px-3 py-1.5",children:[a.jsx(Un,{className:"w-4 h-4 mr-1"}),"Clear"]}),m==="completed"&&a.jsxs("div",{className:"flex items-center space-x-2 text-green-600",children:[a.jsx(rf,{className:"w-5 h-5"}),a.jsx("span",{className:"font-medium",children:"Order Completed"})]})]})]})})}),a.jsx("div",{className:"h-[calc(100vh-80px)]",children:a.jsx("div",{className:"h-full overflow-hidden",children:a.jsxs("main",{className:"h-full px-4 sm:px-6 lg:px-8 py-6",children:[(m==="cart"||m==="adding_more")&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"hidden lg:flex gap-6 h-[calc(100vh-200px)]",children:[a.jsxs("div",{className:"flex-1 overflow-hidden",children:[a.jsx("div",{className:"card p-4 mb-6",children:a.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[a.jsxs("div",{className:"flex-1 relative",children:[a.jsx(sn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),a.jsx("input",{type:"text",placeholder:"Search menu items...",value:x,onChange:se=>E(se.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx(nu,{className:"w-4 h-4 text-gray-600"}),a.jsxs("select",{value:y,onChange:se=>v(se.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"all",children:"All Categories"}),c.map(se=>a.jsx("option",{value:se.name,children:se.name},se.id))]})]})]})}),a.jsx("div",{className:"overflow-y-auto h-full",children:T?a.jsxs("div",{className:"text-center py-12",children:[a.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Loading menu..."})]}):Mr.length===0?a.jsxs("div",{className:"text-center py-12",children:[a.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx(sn,{className:"w-8 h-8 text-gray-400"})}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No items found"}),a.jsx("p",{className:"text-gray-600 mb-4",children:x?`No menu items match "${x}"`:`No items in "${y}" category`}),x&&a.jsx("button",{onClick:()=>E(""),className:"btn btn-secondary",children:"Clear search"})]}):a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 2xl:grid-cols-5 gap-4 pb-6",children:Mr.map((se,z)=>{const ce=u.find(xe=>xe.menuItemId===se.id);return a.jsx(NB,{item:se,onAddToCart:pt,cartQuantity:(ce==null?void 0:ce.quantity)||0},`desktop-${se.id}-${z}-${se.name.replace(/\s+/g,"-").toLowerCase()}`)})},`desktop-grid-${x}-${Mr.length}`)})]}),a.jsx("div",{className:"w-80 lg:w-96 flex flex-col",children:a.jsxs("div",{className:"card h-full flex flex-col",children:[a.jsxs("div",{className:"p-4 border-b border-gray-200",children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Current Order"}),a.jsxs("p",{className:"text-sm text-gray-600",children:["Table ",n.number]})]}),a.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:u.length===0?a.jsxs("div",{className:"text-center py-8",children:[a.jsx(XA,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:"No items added yet"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Select items from the menu to start building the order"})]}):a.jsx("div",{className:"space-y-3",children:u.map((se,z)=>{var ce;return a.jsx(CB,{item:se,onUpdateQuantity:Me,onRemove:rt},`${se.menuItemId}-${z}-${((ce=se.variants)==null?void 0:ce.map(xe=>`${xe.variantName}-${xe.optionName}`).join("-"))||"no-variants"}`)})})}),u.length>0&&a.jsxs("div",{className:"border-t border-gray-200 p-4",children:[a.jsxs("div",{className:"space-y-2 mb-4",children:[a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{children:"Subtotal:"}),a.jsx("span",{children:Ue(Jr)})]}),a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsxs("span",{children:["Tax (",(r==null?void 0:r.settings.taxRate)||8.5,"%):"]}),a.jsx("span",{children:Ue(ye)})]}),a.jsxs("div",{className:"flex justify-between text-lg font-bold border-t pt-2",children:[a.jsx("span",{children:"Total:"}),a.jsx("span",{children:Ue(Le)})]})]}),a.jsxs("form",{onSubmit:Be(Ge),className:"space-y-3",children:[a.jsx("textarea",{...Re("orderNotes"),rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",placeholder:"Order notes (optional)"}),a.jsxs("div",{className:"flex space-x-2",children:[a.jsxs("button",{type:"button",onClick:Vt,className:"flex-1 btn btn-secondary",children:[a.jsx(Un,{className:"w-4 h-4 mr-2"}),"Clear"]}),a.jsx("button",{type:"submit",disabled:C,className:"flex-2 btn btn-theme-primary",children:C?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Placing..."]}):a.jsxs(a.Fragment,{children:[a.jsx(rf,{className:"w-4 h-4 mr-2"}),"Place Order"]})})]})]})]})]})})]}),a.jsxs("div",{className:"lg:hidden",children:[a.jsx("div",{className:"card p-4 mb-4",children:a.jsxs("div",{className:"flex flex-col gap-3",children:[a.jsxs("div",{className:"relative",children:[a.jsx(sn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),a.jsx("input",{type:"text",placeholder:"Search menu items...",value:x,onChange:se=>E(se.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx(nu,{className:"w-4 h-4 text-gray-600"}),a.jsxs("select",{value:y,onChange:se=>v(se.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"all",children:"All Categories"}),c.map(se=>a.jsx("option",{value:se.name,children:se.name},se.id))]})]})]})}),u.length>0&&a.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 p-4 z-40",children:a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"text-sm text-gray-600",children:[u.length," items"]}),a.jsx("div",{className:"font-bold text-lg",children:Ue(Le)})]}),a.jsx("button",{onClick:()=>q(!0),className:"btn btn-theme-primary",children:"View Cart"})]})}),a.jsx("div",{className:`${u.length>0?"pb-24":"pb-6"}`,children:T?a.jsxs("div",{className:"text-center py-12",children:[a.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Loading menu..."})]}):Mr.length===0?a.jsxs("div",{className:"text-center py-12",children:[a.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx(sn,{className:"w-8 h-8 text-gray-400"})}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No items found"}),a.jsx("p",{className:"text-gray-600 mb-4",children:x?`No menu items match "${x}"`:`No items in "${y}" category`}),x&&a.jsx("button",{onClick:()=>E(""),className:"btn btn-secondary",children:"Clear search"})]}):a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-2 gap-4",children:Mr.map((se,z)=>{const ce=u.find(xe=>xe.menuItemId===se.id);return a.jsx(NB,{item:se,onAddToCart:pt,cartQuantity:(ce==null?void 0:ce.quantity)||0},`mobile-${se.id}-${z}-${se.name.replace(/\s+/g,"-").toLowerCase()}`)})},`mobile-grid-${x}-${Mr.length}`)}),D&&a.jsxs("div",{className:"fixed inset-0 z-50 lg:hidden",children:[a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50",onClick:()=>q(!1)}),a.jsx("div",{className:"fixed right-0 top-0 h-full w-full max-w-sm bg-white shadow-xl",children:a.jsxs("div",{className:"flex flex-col h-full",children:[a.jsx("div",{className:"p-4 border-b border-gray-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Current Order"}),a.jsxs("p",{className:"text-sm text-gray-600",children:["Table ",n.number]})]}),a.jsx("button",{onClick:()=>q(!1),className:"p-2 hover:bg-gray-100 rounded-lg",children:a.jsx(qr,{className:"w-5 h-5"})})]})}),a.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:u.length===0?a.jsxs("div",{className:"text-center py-8",children:[a.jsx(XA,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:"No items added yet"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Select items from the menu to start building the order"})]}):a.jsx("div",{className:"space-y-3",children:u.map((se,z)=>{var ce;return a.jsx(CB,{item:se,onUpdateQuantity:Me,onRemove:rt},`mobile-${se.menuItemId}-${z}-${((ce=se.variants)==null?void 0:ce.map(xe=>`${xe.variantName}-${xe.optionName}`).join("-"))||"no-variants"}`)})})}),u.length>0&&a.jsxs("div",{className:"border-t border-gray-200 p-4",children:[a.jsxs("div",{className:"space-y-2 mb-4",children:[a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{children:"Subtotal:"}),a.jsx("span",{children:Ue(Jr)})]}),a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsxs("span",{children:["Tax (",(r==null?void 0:r.settings.taxRate)||8.5,"%):"]}),a.jsx("span",{children:Ue(ye)})]}),a.jsxs("div",{className:"flex justify-between text-lg font-bold border-t pt-2",children:[a.jsx("span",{children:"Total:"}),a.jsx("span",{children:Ue(Le)})]})]}),a.jsxs("form",{onSubmit:Be(Ge),className:"space-y-3",children:[a.jsx("textarea",{...Re("orderNotes"),rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",placeholder:"Order notes (optional)"}),a.jsxs("div",{className:"flex space-x-2",children:[a.jsxs("button",{type:"button",onClick:Vt,className:"flex-1 btn btn-secondary",children:[a.jsx(Un,{className:"w-4 h-4 mr-2"}),"Clear"]}),a.jsx("button",{type:"submit",disabled:C,className:"flex-2 btn btn-theme-primary",children:C?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Placing..."]}):a.jsxs(a.Fragment,{children:[a.jsx(rf,{className:"w-4 h-4 mr-2"}),"Place Order"]})})]})]})]})]})})]})]})]}),m==="placed"&&f.length>0&&a.jsxs("div",{className:"max-w-4xl mx-auto px-3 sm:px-4",children:[a.jsxs("div",{className:"text-center mb-4 sm:mb-6",children:[a.jsx("div",{className:"w-14 h-14 sm:w-16 sm:h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-3 sm:mb-4",children:a.jsx(Uo,{className:"w-7 h-7 sm:w-8 sm:h-8 text-blue-600"})}),a.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-gray-900 mb-2",children:"Orders Placed!"}),a.jsxs("p",{className:"text-gray-600 text-sm sm:text-base",children:[f.length," active order",f.length>1?"s":""," for Table ",n.number]}),f.length>5&&a.jsx("p",{className:"text-blue-600 text-xs mt-1 font-medium",children:" Scroll down to see all orders"})]}),a.jsx("div",{className:"grid gap-3 sm:gap-4 md:gap-6 max-h-[70vh] overflow-y-auto",children:f.map((se,z)=>a.jsxs("div",{className:"card p-4 sm:p-6 relative",children:[a.jsxs("div",{className:"absolute top-2 right-2 bg-blue-100 text-blue-800 text-xs font-bold px-2 py-1 rounded-full",children:[z+1," of ",f.length]}),a.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center mb-4 gap-2",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Order #",se.orderNumber]}),a.jsx("span",{className:"text-gray-600 text-sm",children:new Date(se.createdAt).toLocaleTimeString()})]}),a.jsx("div",{className:"space-y-2 sm:space-y-3 mb-4",children:se.items.map(ce=>a.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center p-3 bg-gray-50 rounded-lg gap-2",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("h4",{className:"font-medium text-gray-900",children:ce.name}),a.jsxs("p",{className:"text-sm text-gray-600",children:[ce.quantity,"  ",Ue(ce.price)]})]}),a.jsx("div",{className:"font-medium text-gray-900 sm:text-right",children:Ue(ce.total)})]},ce.id))}),a.jsx("div",{className:"border-t border-gray-200 pt-3",children:a.jsxs("div",{className:"flex justify-between text-lg font-bold",children:[a.jsx("span",{children:"Order Total:"}),a.jsx("span",{children:Ue(se.total)})]})})]},se.id))}),a.jsxs("div",{className:"sm:hidden fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 p-4 z-40",children:[a.jsxs("div",{className:"flex space-x-2",children:[a.jsxs("button",{onClick:ht,className:"flex-1 btn btn-theme-primary text-sm py-3",children:[a.jsx(zr,{className:"w-4 h-4 mr-2"}),"Add More"]}),a.jsxs("button",{onClick:()=>k(!0),className:"flex-1 btn bg-green-600 text-white hover:bg-green-700 text-sm py-3",children:[a.jsx(No,{className:"w-4 h-4 mr-2"}),"Payment"]})]}),a.jsxs("div",{className:"flex space-x-2 mt-2",children:[a.jsxs("button",{onClick:gt,className:"flex-1 btn btn-secondary text-sm py-2",children:[a.jsx(R0,{className:"w-4 h-4 mr-2"}),"Print KOT"]}),a.jsxs("button",{onClick:()=>Ae(!0),className:"flex-1 btn bg-blue-600 text-white hover:bg-blue-700 text-sm py-2",children:[a.jsx(dx,{className:"w-4 h-4 mr-2"}),"Manage"]})]})]}),a.jsx("div",{className:"sm:hidden h-32"})]}),m==="completed"&&a.jsx("div",{className:"max-w-2xl mx-auto text-center",children:a.jsxs("div",{className:"card p-8",children:[a.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx(rf,{className:"w-8 h-8 text-green-600"})}),a.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Payment Completed!"}),a.jsxs("p",{className:"text-gray-600 mb-6",children:["All orders for Table ",n.number," have been paid and completed."]}),a.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-6 mb-6",children:[a.jsxs("div",{className:"flex items-center justify-center mb-4",children:[a.jsx("div",{className:"w-8 h-8 bg-green-500 rounded-full flex items-center justify-center mr-2",children:a.jsx("svg",{className:"w-5 h-5 text-white",fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0020.885 3.787"})})}),a.jsx("h3",{className:"text-lg font-semibold text-green-800",children:"Share Bill on WhatsApp"})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"whatsappNumber",className:"block text-sm font-medium text-gray-700 mb-2",children:"WhatsApp Number"}),a.jsx("input",{type:"tel",id:"whatsappNumber",value:le,onChange:se=>{const z=se.target.value.replace(/[^0-9]/g,"").slice(0,10);ae(z)},placeholder:"Enter WhatsApp number (e.g., 9876543210)",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",disabled:ve,maxLength:10}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Enter 10-digit mobile number without country code"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Choose WhatsApp Platform"}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"radio",name:"whatsappPlatform",checked:me,onChange:()=>Fe(!0),className:"h-4 w-4 text-green-600 focus:ring-green-500 border-gray-300",disabled:ve}),a.jsxs("span",{className:"ml-2 text-sm text-gray-700",children:[a.jsx("strong",{children:"WhatsApp Web"})," - Open in browser (recommended if you have WhatsApp Web open)"]})]}),a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"radio",name:"whatsappPlatform",checked:!me,onChange:()=>Fe(!1),className:"h-4 w-4 text-green-600 focus:ring-green-500 border-gray-300",disabled:ve}),a.jsxs("span",{className:"ml-2 text-sm text-gray-700",children:[a.jsx("strong",{children:"WhatsApp App"})," - Open mobile/desktop app"]})]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[a.jsx("button",{onClick:Xe,disabled:ve||De||!le.trim()||le.length!==10,className:"bg-green-600 hover:bg-green-700 disabled:bg-gray-400 disabled:cursor-not-allowed text-white font-semibold py-3 px-4 rounded-lg transition-colors flex items-center justify-center",children:ve?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"}),"Preparing..."]}):a.jsxs(a.Fragment,{children:[a.jsx("svg",{className:"w-5 h-5 mr-2",fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0020.885 3.787"})}),"Send Text Bill"]})}),a.jsx("button",{onClick:Ke,disabled:ve||De||!le.trim()||le.length!==10,className:"bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed text-white font-semibold py-3 px-4 rounded-lg transition-colors flex items-center justify-center",children:De?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"}),"Creating PDF..."]}):a.jsxs(a.Fragment,{children:[a.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Download PDF & Share"]})})]}),a.jsx("div",{className:"text-center",children:a.jsxs("p",{className:"text-xs text-gray-600",children:[a.jsx("span",{className:"font-medium",children:"Text Bill:"})," Send formatted bill text directly in WhatsApp",a.jsx("br",{}),a.jsx("span",{className:"font-medium",children:"PDF Bill:"})," Download PDF and manually attach to WhatsApp"]})})]})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[a.jsxs("button",{onClick:()=>{g("cart"),p([]),h(null),A([]),As.clearCart(r.id,t)},className:"btn btn-theme-primary",children:[a.jsx(zr,{className:"w-4 h-4 mr-2"}),"Start New Order"]}),a.jsxs("button",{onClick:()=>e(`/${r.slug}/tables`),className:"btn btn-secondary",children:[a.jsx(Jo,{className:"w-4 h-4 mr-2"}),"Back to Tables"]})]})]})})]})})}),B&&f.length>0&&a.jsx(yN,{isOpen:B,onClose:()=>k(!1),restaurant:r,table:n,onPayment:St,isProcessing:S,cartItems:f.flatMap(se=>se.items.map(z=>({menuItemId:z.id,name:z.name,price:z.price,quantity:z.quantity,total:z.total,variants:z.variants}))),orders:f,menuItems:o}),Q&&a.jsx($M,{isOpen:te,onClose:()=>{W(!1),re(null)},menuItem:Q,onConfirm:ze}),G&&n&&r&&a.jsx(Ese,{isOpen:G,onClose:()=>Ae(!1),currentTable:n,restaurantId:r.id,currentOrders:f,onOperationComplete:()=>{mt(),e(`/${r.slug}/tables`)}}),a.jsx(CM,{isVisible:U,stage:L,message:fe}),a.jsx(Mj,{isVisible:de,onClose:()=>ue(!1),onPrintKOT:gt,orderDetails:Ie}),a.jsx(Mj,{isVisible:H,onClose:()=>je(!1),onPrintKOT:()=>{if(Ce&&r&&n&&He){const se=He;let z;f.length===1?z=SB(se,r,n):z=jB(se,r,n,f.length);const ce=window.open("","_blank");ce&&(ce.document.write(z),ce.document.close(),ce.focus(),ce.print(),ce.close()),Z.success("KOT sent to kitchen")}},orderDetails:Ce})]})}function NB({item:t,onAddToCart:e,cartQuantity:r}){return a.jsxs("div",{className:"card hover:shadow-lg transition-all duration-200 cursor-pointer",onClick:()=>e(t,1),children:[t.image&&a.jsx("div",{className:"h-32 bg-gray-200 rounded-t-xl overflow-hidden",children:a.jsx("img",{src:t.image,alt:t.name,className:"w-full h-full object-cover"})}),a.jsxs("div",{className:"p-3",children:[a.jsxs("div",{className:"flex items-start justify-between mb-2",children:[a.jsx("h3",{className:"font-semibold text-gray-900 text-sm",children:t.name}),a.jsxs("div",{className:"text-right",children:[a.jsx("div",{className:"text-sm font-bold",style:{color:"var(--color-primary)"},children:Ue(t.price)}),r>0&&a.jsxs("div",{className:"text-xs text-green-600 font-medium",children:[r," in order"]})]})]}),t.description&&a.jsx("p",{className:"text-gray-600 text-xs mb-2 line-clamp-2",children:t.description}),a.jsx("div",{className:"flex items-center justify-center",children:a.jsxs("button",{onClick:s=>{s.stopPropagation(),e(t,1)},className:"btn btn-theme-primary btn-sm w-full",children:[a.jsx(zr,{className:"w-3 h-3 mr-1"}),"Add to Order"]})})]})]})}function CB({item:t,onUpdateQuantity:e,onRemove:r}){return a.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("h4",{className:"font-medium text-gray-900 text-sm",children:t.name}),a.jsxs("p",{className:"text-xs text-gray-600",children:[Ue(t.price)," each"]}),t.variants&&t.variants.length>0&&a.jsx("div",{className:"text-xs text-gray-500 mt-1",children:t.variants.map((s,n)=>a.jsxs("span",{children:[s.variantName,": ",s.optionName,n<t.variants.length-1&&", "]},`${s.variantName}-${s.optionName}-${n}`))})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx("button",{onClick:()=>e(t.menuItemId,t.quantity-1),className:"w-6 h-6 rounded-full border border-gray-300 flex items-center justify-center hover:bg-gray-100",children:a.jsx(Uf,{className:"w-3 h-3"})}),a.jsx("span",{className:"w-6 text-center text-sm font-medium",children:t.quantity}),a.jsx("button",{onClick:()=>e(t.menuItemId,t.quantity+1),className:"w-6 h-6 rounded-full border border-gray-300 flex items-center justify-center hover:bg-gray-100",children:a.jsx(zr,{className:"w-3 h-3"})})]}),a.jsx("div",{className:"text-right min-w-[60px]",children:a.jsx("div",{className:"font-medium text-gray-900 text-sm",children:Ue(t.total)})}),a.jsx("button",{onClick:()=>r(t.menuItemId),className:"p-1 text-gray-400 hover:text-red-600",children:a.jsx(Un,{className:"w-3 h-3"})})]})]})}function jB(t,e,r,s){return`
    <!DOCTYPE html>
    <html>
    <head>
      <title>Additional KOT - ${t.orderNumber}</title>
      <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
          font-family: 'Courier New', monospace; 
          font-weight: bold;
          font-size: 12px;
          line-height: 1.1;
          width: 100%;
          background: #fff;
          color: #000;
          padding: 0 5px;
        }
        .kot-container {
          width: 100%;
          padding: 5px 0;
        }
        .header { 
          text-align: center; 
          border-bottom: 2px solid #000; 
          padding-bottom: 3px; 
          margin-bottom: 5px; 
        }
        .restaurant-name { 
          font-size: 14px; 
          font-weight: bold; 
          margin-bottom: 2px;
        }
        .kot-title {
          font-size: 12px;
          font-weight: bold;
        }
        .additional-notice {
          background-color: #000;
          color: #fff;
          text-align: center;
          padding: 2px;
          margin: 3px 0;
          font-weight: bold;
          font-size: 11px;
        }
        .order-info { 
          margin-bottom: 5px; 
          line-height: 1.1;
        }
        .order-info p {
          margin: 1px 0;
          font-weight: bold;
        }
        .items { 
          border-collapse: collapse; 
          width: 100%; 
          margin: 5px 0;
        }
        .items th, .items td { 
          border: 1px solid #000; 
          padding: 3px 4px; 
          text-align: left; 
          font-size: 11px;
          font-weight: bold;
          line-height: 1.1;
        }
        .items th { 
          background-color: #000; 
          color: #fff;
          font-weight: bold;
        }
        .footer { 
          margin-top: 5px; 
          text-align: center; 
          font-size: 10px; 
          border-top: 1px dashed #000;
          padding-top: 3px;
          font-weight: bold;
        }
        .order-notes {
          margin-top: 5px; 
          padding: 3px; 
          border: 1px solid #000;
          background: #f0f0f0;
          font-weight: bold;
          font-size: 11px;
          line-height: 1.1;
        }
        @media print {
          body { 
            margin: 0; 
            padding: 0 3px;
            width: 100%;
            font-size: 11px;
          }
          .kot-container {
            padding: 3px 0;
            width: 100%;
          }
          .no-print { display: none; }
        }
      </style>
    </head>
    <body>
      <div class="kot-container">
      <div class="header">
        <div class="restaurant-name">${e.name}</div>
          <div class="kot-title">KITCHEN ORDER TICKET</div>
      </div>
      
      <div class="additional-notice">
        *** ADDITIONAL ORDER - NEW ITEMS ONLY ***
      </div>
      
      <div class="order-info">
        <p><strong>Order #:</strong> ${t.orderNumber}</p>
        <p><strong>Table:</strong> ${r.number} (${r.area})</p>
        <p><strong>Date/Time:</strong> ${t.createdAt.toLocaleString()}</p>
        <p><strong>Staff:</strong> ${t.staffId}</p>
        <p><strong>Order ${s} of ${s} for this table</strong></p>
      </div>
      
      <table class="items">
        <thead>
          <tr>
            <th>Qty</th>
            <th>Item</th>
            <th>Notes</th>
          </tr>
        </thead>
        <tbody>
          ${t.items.map(n=>`
            <tr>
              <td>${n.quantity}</td>
              <td>${n.name}</td>
              <td>${n.notes||""}</td>
            </tr>
          `).join("")}
        </tbody>
      </table>
      
      ${t.notes?`
          <div class="order-notes">
          <strong>Order Notes:</strong><br>
          ${t.notes}
        </div>
      `:""}
      
      <div class="footer">
        <p>*** KITCHEN COPY - ADDITIONAL ITEMS ***</p>
          <p>Printed: ${new Date().toLocaleString()}</p>
        </div>
      </div>
    </body>
    </html>
  `}function SB(t,e,r){return`
    <!DOCTYPE html>
    <html>
    <head>
      <title>KOT - ${t.orderNumber}</title>
      <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
          font-family: 'Courier New', monospace; 
          font-weight: bold;
          font-size: 12px;
          line-height: 1.1;
          width: 100%;
          background: #fff;
          color: #000;
          padding: 0 5px;
        }
        .kot-container {
          width: 100%;
          padding: 5px 0;
        }
        .header { 
          text-align: center; 
          border-bottom: 2px solid #000; 
          padding-bottom: 3px; 
          margin-bottom: 5px; 
        }
        .restaurant-name { 
          font-size: 14px; 
          font-weight: bold; 
          margin-bottom: 2px;
        }
        .kot-title {
          font-size: 12px;
          font-weight: bold;
        }
        .order-info { 
          margin-bottom: 5px; 
          line-height: 1.1;
        }
        .order-info p {
          margin: 1px 0;
          font-weight: bold;
        }
        .items { 
          border-collapse: collapse; 
          width: 100%; 
          margin: 5px 0;
        }
        .items th, .items td { 
          border: 1px solid #000; 
          padding: 3px 4px; 
          text-align: left; 
          font-size: 11px;
          font-weight: bold;
          line-height: 1.1;
        }
        .items th { 
          background-color: #000; 
          color: #fff;
          font-weight: bold;
        }
        .footer { 
          margin-top: 5px; 
          text-align: center; 
          font-size: 10px; 
          border-top: 1px dashed #000;
          padding-top: 3px;
          font-weight: bold;
        }
        .order-notes {
          margin-top: 5px; 
          padding: 3px; 
          border: 1px solid #000;
          background: #f0f0f0;
          font-weight: bold;
          font-size: 11px;
          line-height: 1.1;
        }
        @media print {
          body { 
            margin: 0; 
            padding: 0 3px;
            width: 100%;
            font-size: 11px;
          }
          .kot-container {
            padding: 3px 0;
            width: 100%;
          }
          .no-print { display: none; }
        }
      </style>
    </head>
    <body>
      <div class="kot-container">
      <div class="header">
        <div class="restaurant-name">${e.name}</div>
          <div class="kot-title">KITCHEN ORDER TICKET</div>
      </div>
      
      <div class="order-info">
        <p><strong>Order #:</strong> ${t.orderNumber}</p>
        <p><strong>Table:</strong> ${r.number} (${r.area})</p>
        <p><strong>Date/Time:</strong> ${t.createdAt.toLocaleString()}</p>
        <p><strong>Staff:</strong> ${t.staffId}</p>
      </div>
      
      <table class="items">
        <thead>
          <tr>
            <th>Qty</th>
            <th>Item</th>
            <th>Notes</th>
          </tr>
        </thead>
        <tbody>
          ${t.items.map(s=>`
            <tr>
              <td>${s.quantity}</td>
              <td>${s.name}</td>
              <td>${s.notes||""}</td>
            </tr>
          `).join("")}
        </tbody>
      </table>
      
      ${t.notes?`
          <div class="order-notes">
          <strong>Order Notes:</strong><br>
          ${t.notes}
        </div>
      `:""}
      
      <div class="footer">
        <p>*** KITCHEN COPY ***</p>
          <p>Printed: ${new Date().toLocaleString()}</p>
        </div>
      </div>
    </body>
    </html>
  `}async function tC(t,e,r,s){var T,j,C,w,S,F,B,k,D,q,te,W,Q,re,G,Ae,he,I,U,V,L,K,fe,ee,de,ue,Ie;const n=t.reduce((Y,H)=>Y+H.subtotal,0);let i=0,o=0,l=0,c=null;const d=t.find(Y=>{var H;return(H=Y.notes)==null?void 0:H.includes("Merged tables:")}),u=d!==void 0,A=u?d.notes:null;s.appliedCoupon&&(i=s.appliedCoupon.discountAmount||0,c=s.appliedCoupon),s.manualDiscountAmount>0?o=s.manualDiscountAmount:s.discount&&!s.appliedCoupon&&(s.discount.type==="percentage"?o=n*s.discount.value/100:o=s.discount.value),l=i+o;const h=n-l,f=h*(((T=e==null?void 0:e.settings)==null?void 0:T.taxRate)||8.5)/100,p=h+f,m=s.tip||0,g=s.finalTotal||p+m,y={};t.forEach(Y=>{Y.items.forEach(H=>{const je=`${H.name}-${H.price}`;y[je]?(y[je].quantity+=H.quantity,y[je].total+=H.total):y[je]={name:H.name,price:H.price,quantity:H.quantity,total:H.total}})});const v=Object.values(y);let x="";const E=(j=e==null?void 0:e.settings)==null?void 0:j.upiSettings;if(E!=null&&E.enableQRCode&&(E!=null&&E.upiId))try{console.log(" Generating UPI QR code for bill:",{upiId:E.upiId,amount:g,restaurant:e.name});const Y=VM(E.upiId,g,e.name,`Payment for Table ${r.number} - ${e.name}`);console.log(" UPI Payment String:",Y),x=await HM(Y),x?console.log(" UPI QR Code generated successfully"):console.error(" Failed to generate UPI QR Code")}catch(Y){console.error(" Error generating UPI QR Code:",Y)}else console.log(" UPI QR Code not enabled or UPI ID not configured:",{enableQRCode:E==null?void 0:E.enableQRCode,hasUpiId:!!(E!=null&&E.upiId)});return`
    <!DOCTYPE html>
    <html>
    <head>
      <title>Bill - Table ${r.number}</title>
      <meta charset="UTF-8">
      <style>
        * {
          margin: 0;
          padding: 0;
          box-sizing: border-box;
        }
        
        body {
          font-family: 'Courier New', monospace;
          font-size: 11px;
          font-weight: bold;
          line-height: 1.1;
          width: 100%;
          margin: 0;
          padding: 0 5px;
          background: #fff;
          color: #000;
        }
        
        .receipt {
          width: 100%;
          padding: 5px 0;
          background: #fff;
        }
        
        .header {
          text-align: center;
          margin-bottom: 5px;
          border-bottom: 2px solid #000;
          padding-bottom: 3px;
        }
        
        .restaurant-name {
          font-size: 14px;
          font-weight: bold;
          letter-spacing: 0.5px;
          margin-bottom: 2px;
          text-transform: uppercase;
        }
        
        .contact-info {
          font-size: 9px;
          line-height: 1.1;
          font-weight: bold;
          margin-bottom: 2px;
        }
        
        .separator {
          text-align: center;
          margin: 3px 0;
          font-size: 10px;
          font-weight: bold;
          letter-spacing: 1px;
        }
        
        .bill-header {
          text-align: center;
          margin: 5px 0;
          padding: 3px 0;
          border-top: 1px dashed #000;
          border-bottom: 1px dashed #000;
        }
        
        .bill-title {
          font-size: 12px;
          font-weight: bold;
          margin-bottom: 2px;
          letter-spacing: 0.5px;
        }
        
        .bill-info {
          font-size: 10px;
          line-height: 1.1;
          font-weight: bold;
        }
        
        .order-details {
          margin: 5px 0;
          padding: 3px 0;
          border-bottom: 1px dashed #000;
        }
        
        .section-title {
          font-weight: bold;
          margin-bottom: 2px;
          text-transform: uppercase;
          letter-spacing: 0.3px;
          font-size: 10px;
        }
        
        .order-line {
          margin: 1px 0;
          font-size: 9px;
          font-weight: bold;
        }
        
        .items-section {
          margin: 5px 0;
        }
        
        .items-header {
          display: flex;
          justify-content: space-between;
          border-bottom: 1px solid #000;
          padding-bottom: 2px;
          margin-bottom: 3px;
          font-weight: bold;
          font-size: 10px;
        }
        
        .item-row {
          display: flex;
          justify-content: space-between;
          margin: 2px 0;
          padding: 1px 0;
        }
        
        .item-details {
          flex: 1;
          padding-right: 5px;
        }
        
        .item-name {
          font-weight: bold;
          margin-bottom: 1px;
          font-size: 10px;
        }
        
        .item-qty-price {
          font-size: 9px;
          font-weight: bold;
        }
        
        .item-total {
          font-weight: bold;
          min-width: 50px;
          text-align: right;
          font-size: 10px;
        }
        
        .totals-section {
          margin-top: 5px;
          border-top: 1px solid #000;
          padding-top: 3px;
        }
        
        .total-row {
          display: flex;
          justify-content: space-between;
          margin: 1px 0;
          padding: 1px 0;
          font-weight: bold;
          font-size: 10px;
        }
        
        .total-row.subtotal {
          border-bottom: 1px dotted #000;
          padding-bottom: 2px;
          margin-bottom: 2px;
        }
        
        .total-row.discount {
          font-weight: bold;
        }
        
        .total-row.savings {
          font-weight: bold;
          background: #f0f0f0;
          padding: 2px;
          margin: 1px -2px;
        }
        
        .total-row.final {
          border-top: 2px solid #000;
          border-bottom: 2px solid #000;
          padding: 3px 0;
          margin-top: 3px;
          font-size: 12px;
          font-weight: bold;
        }
        
        .coupon-section {
          background: #f0f0f0;
          margin: 3px -2px;
          padding: 3px;
          border: 1px dashed #000;
        }
        
        .coupon-title {
          font-weight: bold;
          margin-bottom: 1px;
          font-size: 9px;
        }
        
        .coupon-code {
          font-size: 8px;
          font-weight: bold;
        }
        
        .free-items {
          font-weight: bold;
          font-size: 8px;
        }
        
        .payment-section {
          margin: 5px 0;
          padding: 3px 0;
          border-top: 1px dashed #000;
          border-bottom: 1px dashed #000;
        }
        
        .payment-title {
          font-weight: bold;
          margin-bottom: 2px;
          text-transform: uppercase;
          letter-spacing: 0.3px;
          font-size: 10px;
        }
        
        .payment-details {
          font-size: 9px;
          line-height: 1.1;
          font-weight: bold;
        }
        
        .payment-method {
          background: #f0f0f0;
          padding: 1px 2px;
          display: inline-block;
          font-weight: bold;
        }
        
        .upi-section {
          margin: 5px 0;
          padding: 8px;
          border: 2px solid #000;
          text-align: center;
          background: #f9f9f9;
        }
        
        .upi-title {
          font-size: 12px;
          font-weight: bold;
          margin-bottom: 3px;
          letter-spacing: 0.5px;
          text-transform: uppercase;
        }
        
        .upi-id {
          font-size: 10px;
          font-weight: bold;
          margin-bottom: 5px;
          color: #333;
        }
        
        .qr-code {
          display: block;
          margin: 5px auto;
          border: 2px solid #000;
          border-radius: 4px;
          background: #fff;
          padding: 5px;
        }
        
        .upi-instructions {
          font-size: 8px;
          line-height: 1.2;
          margin-top: 3px;
          color: #666;
        }
        
        .footer {
          text-align: center;
          margin-top: 5px;
          padding-top: 3px;
          border-top: 2px solid #000;
        }
        
        .thank-you {
          font-size: 11px;
          font-weight: bold;
          margin-bottom: 2px;
          letter-spacing: 0.5px;
        }
        
        .footer-info {
          font-size: 8px;
          font-weight: bold;
          line-height: 1.1;
        }
        
        .timestamp {
          text-align: center;
          margin-top: 3px;
          font-size: 8px;
          font-weight: bold;
        }
        
        @media print {
          body {
            padding: 0 3px;
            font-size: 10px;
            width: 100%;
            margin: 0;
          }
          .receipt {
            padding: 3px 0;
            width: 100%;
          }
        }
      </style>
    </head>
    <body>
      <div class="receipt">
        <!-- Header Section -->
      <div class="header">
        <div class="restaurant-name">${e.name}</div>
        <div class="contact-info">
            ${((w=(C=e.settings)==null?void 0:C.businessInfo)==null?void 0:w.businessAddress)||((S=e.settings)==null?void 0:S.address)||"Restaurant Address"}
          ${(B=(F=e.settings)==null?void 0:F.businessInfo)!=null&&B.city?`, ${e.settings.businessInfo.city}`:""}
          ${(D=(k=e.settings)==null?void 0:k.businessInfo)!=null&&D.state?`, ${e.settings.businessInfo.state}`:""}
          ${(te=(q=e.settings)==null?void 0:q.businessInfo)!=null&&te.pincode?` - ${e.settings.businessInfo.pincode}`:""}
          <br>
            ${(W=e.settings)!=null&&W.phone?` ${e.settings.phone}`:""}
          ${(re=(Q=e.settings)==null?void 0:Q.businessInfo)!=null&&re.gstin?`<br>GSTIN: ${e.settings.businessInfo.gstin}`:""}
          ${(Ae=(G=e.settings)==null?void 0:G.businessInfo)!=null&&Ae.fssaiNumber?`<br>FSSAI: ${e.settings.businessInfo.fssaiNumber}`:""}
        </div>
      </div>

        <!-- Bill Header -->
        <div class="bill-header">
          <div class="bill-title">BILL RECEIPT</div>
      <div class="bill-info">
            <strong>Table:</strong> ${u?A:`${r.number} (${r.area})`}<br>
            <strong>Date:</strong> ${new Date().toLocaleDateString("en-IN")}<br>
            <strong>Time:</strong> ${new Date().toLocaleTimeString("en-IN")}<br>
            ${t.length>1?`<strong>Combined Bill:</strong> ${t.length} Orders<br>`:""}
            ${u?"<strong>Billing Type:</strong> Merged Tables<br>":""}
            ${s.customerId?`<strong>Customer:</strong> ${s.customerId}<br>`:""}
          </div>
      </div>

        <!-- Order Details -->
        ${t.length>1?`
        <div class="order-details">
          <div class="section-title">Order Numbers</div>
          ${t.map(Y=>`
            <div class="order-line"># ${Y.orderNumber} - ${Ue(Y.total)}</div>
          `).join("")}
      </div>
        `:""}

        <!-- Items Section -->
        <div class="items-section">
          <div class="items-header">
            <span>ITEM</span>
            <span>TOTAL</span>
          </div>
          
        ${v.map(Y=>`
            <div class="item-row">
              <div class="item-details">
                <div class="item-name">${Y.name}</div>
                <div class="item-qty-price">${Y.quantity}  ${Ue(Y.price)}</div>
              </div>
              <div class="item-total">${Ue(Y.total)}</div>
          </div>
        `).join("")}
      </div>

        <!-- Totals Section -->
        <div class="totals-section">
          <div class="total-row subtotal">
            <span>Subtotal</span>
          <span>${Ue(n)}</span>
        </div>
          
          ${c?`
          <div class="coupon-section">
            <div class="coupon-title"> COUPON APPLIED</div>
            <div class="total-row discount">
              <span>${c.coupon.name}</span>
              <span>-${Ue(i)}</span>
            </div>
            <div class="coupon-code">Code: ${c.coupon.code}</div>
            ${c.freeItems&&c.freeItems.length>0?`
            <div class="free-items">
               Free: ${c.freeItems.map(Y=>`${Y.quantity} ${Y.name}`).join(", ")}
            </div>
            `:""}
          </div>
          `:""}
          
          ${o>0?`
          <div class="total-row discount">
            <span>Discount ${((he=s.manualDiscount)==null?void 0:he.type)==="percentage"?`(${s.manualDiscount.value}%)`:((I=s.discount)==null?void 0:I.type)==="percentage"?`(${s.discount.value}%)`:""}</span>
            <span>-${Ue(o)}</span>
          </div>
          ${(U=s.manualDiscount)!=null&&U.reason||(V=s.discount)!=null&&V.reason?`
          <div class="total-row">
            <span style="font-size: 9px; color: #666;">${((L=s.manualDiscount)==null?void 0:L.reason)||((K=s.discount)==null?void 0:K.reason)}</span>
            <span></span>
          </div>
          `:""}
          `:""}
          
          ${s.totalSavings>0?`
          <div class="total-row savings">
            <span> Total Savings</span>
            <span>-${Ue(s.totalSavings)}</span>
          </div>
          `:""}
          
          <div class="total-row">
            <span>Tax (${((fe=e==null?void 0:e.settings)==null?void 0:fe.taxRate)||8.5}%)</span>
          <span>${Ue(f)}</span>
        </div>
          
        ${m>0?`
          <div class="total-row">
            <span>Tip</span>
          <span>${Ue(m)}</span>
        </div>
        `:""}
          
          <div class="total-row final">
            <span>TOTAL AMOUNT</span>
          <span>${Ue(g)}</span>
        </div>
      </div>

        <!-- Payment Section -->
        <div class="payment-section">
          <div class="payment-title">Payment Details</div>
          <div class="payment-details">
            ${s.isCredit?`
              <strong>Method:</strong> <span class="payment-method">${s.addWholeAmountAsCredit?"FULL CREDIT":"PARTIAL CREDIT"}</span><br>
              ${s.addWholeAmountAsCredit?`
                <strong>Full Amount Added as Credit:</strong> ${Ue(g)}<br>
              `:`
                <strong>Amount Received:</strong> ${Ue(s.amountReceived||0)}<br>
                <strong>Credit Amount:</strong> ${Ue(s.creditAmount||0)}<br>
              `}
              <strong>Credit Customer:</strong> ${s.creditCustomerName}<br>
              ${s.creditCustomerPhone?`<strong>Phone:</strong> ${s.creditCustomerPhone}<br>`:""}
            `:`
              <strong>Method:</strong> <span class="payment-method">${s.method.toUpperCase()}</span><br>
              ${s.method==="cash"?`
                <strong>Amount Received:</strong> ${Ue(s.amountReceived||g)}<br>
                <strong>Change Given:</strong> ${Ue(Math.max(0,(s.amountReceived||g)-g))}
              `:""}
              ${s.reference?`<strong>Reference:</strong> ${s.reference}`:""}
            `}
          </div>
      </div>

        ${E!=null&&E.enableQRCode&&(E!=null&&E.upiId)&&x?`
        <!-- UPI QR Code Section - Only QR Code -->
        <div style="margin: 5px 0; text-align: center; background: #fff; padding: 5px; border: 1px solid #000;">
          <img src="${x}" 
               alt="UPI QR Code" 
               style="width: 80px; height: 80px; display: block; margin: 0 auto; background: white;" />
        </div>
        `:""}

        <!-- Footer -->
      <div class="footer">
          <div class="thank-you"> THANK YOU! </div>
          <div class="footer-info">
            Please visit us again!<br>
            ${(de=(ee=e.settings)==null?void 0:ee.businessInfo)!=null&&de.website?` ${e.settings.businessInfo.website}<br>`:""}
            ${(Ie=(ue=e.settings)==null?void 0:ue.businessInfo)!=null&&Ie.email?` ${e.settings.businessInfo.email}`:""}
          </div>
          
          <div class="timestamp">
            Generated on ${new Date().toLocaleString("en-IN")}
          </div>
        </div>

        <div class="separator"></div>
      </div>
    </body>
    </html>
  `}function Tse({categories:t,onCategoriesUpdated:e}){const{restaurant:r}=js(),[s,n]=R.useState(!1),[i,o]=R.useState(null),[l,c]=R.useState(!1),{register:d,handleSubmit:u,reset:A,setValue:h}=nn(),f=()=>{o(null),A({name:"",description:"",isActive:!0}),n(!0)},p=x=>{o(x),h("name",x.name),h("description",x.description||""),h("isActive",x.isActive),n(!0)},m=async x=>{if(r)try{if(c(!0),i){const E=await Ts.updateCategory(i.id,r.id,{name:x.name,description:x.description,isActive:x.isActive});E.success?(Z.success("Category updated successfully"),e()):Z.error(E.error||"Failed to update category")}else{const E=await Ts.createCategory({restaurantId:r.id,name:x.name,description:x.description,sortOrder:t.length,isActive:x.isActive});E.success?(Z.success("Category created successfully"),e()):Z.error(E.error||"Failed to create category")}n(!1),o(null)}catch{Z.error("Failed to save category")}finally{c(!1)}},g=async x=>{if(!(!r||!confirm(`Are you sure you want to delete "${x.name}"?`)))try{const E=await Ts.deleteCategory(x.id,r.id);E.success?(Z.success("Category deleted successfully"),e()):Z.error(E.error||"Failed to delete category")}catch{Z.error("Failed to delete category")}},y=async x=>{if(r)try{const E=await Ts.updateCategory(x.id,r.id,{isActive:!x.isActive});E.success?(Z.success(`Category ${x.isActive?"disabled":"enabled"}`),e()):Z.error(E.error||"Failed to update category")}catch{Z.error("Failed to update category")}},v=async(x,E)=>{if(!r)return;const T=t.findIndex(C=>C.id===x.id),j=E==="up"?T-1:T+1;if(!(j<0||j>=t.length))try{const C=[Ts.updateCategory(x.id,r.id,{sortOrder:j}),Ts.updateCategory(t[j].id,r.id,{sortOrder:T})];await Promise.all(C),Z.success("Category order updated"),e()}catch{Z.error("Failed to reorder categories")}};return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Categories"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Organize your menu into categories"})]}),a.jsxs("button",{onClick:f,className:"btn btn-theme-primary",children:[a.jsx(zr,{className:"w-4 h-4 mr-2"}),"Add Category"]})]}),a.jsx("div",{className:"space-y-3",children:t.length===0?a.jsxs("div",{className:"text-center py-8 border-2 border-dashed border-gray-300 rounded-lg",children:[a.jsx(Vw,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No categories yet"}),a.jsx("p",{className:"text-gray-600 mb-4",children:"Create your first category to organize your menu"}),a.jsxs("button",{onClick:f,className:"btn btn-theme-primary",children:[a.jsx(zr,{className:"w-4 h-4 mr-2"}),"Create First Category"]})]}):t.map((x,E)=>a.jsx("div",{className:`card p-4 ${x.isActive?"":"opacity-60"}`,children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsxs("div",{className:"flex flex-col space-y-1",children:[a.jsx("button",{onClick:()=>v(x,"up"),disabled:E===0,className:"p-1 text-gray-400 hover:text-gray-600 disabled:opacity-30",children:a.jsx(Pte,{className:"w-3 h-3"})}),a.jsx("button",{onClick:()=>v(x,"down"),disabled:E===t.length-1,className:"p-1 text-gray-400 hover:text-gray-600 disabled:opacity-30",children:a.jsx(Fte,{className:"w-3 h-3"})})]}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h4",{className:"font-medium text-gray-900",children:x.name}),x.description&&a.jsx("p",{className:"text-sm text-gray-600",children:x.description}),a.jsxs("div",{className:"flex items-center space-x-3 mt-1",children:[a.jsxs("span",{className:"text-xs text-gray-500",children:["Order: ",x.sortOrder]}),a.jsx("span",{className:`text-xs ${x.isActive?"text-green-600":"text-red-600"}`,children:x.isActive?"Active":"Inactive"})]})]})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("button",{onClick:()=>y(x),className:`p-2 rounded-lg ${x.isActive?"bg-green-100 text-green-600 hover:bg-green-200":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:x.isActive?a.jsx(Xs,{className:"w-4 h-4"}):a.jsx(Dl,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>p(x),className:"p-2 bg-blue-100 text-blue-600 hover:bg-blue-200 rounded-lg",children:a.jsx(gc,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>g(x),className:"p-2 bg-red-100 text-red-600 hover:bg-red-200 rounded-lg",children:a.jsx(Un,{className:"w-4 h-4"})})]})]})},x.id))}),s&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-2xl max-w-md w-full",children:[a.jsx("div",{className:"p-6 border-b border-gray-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:i?"Edit Category":"Add Category"}),a.jsx("button",{onClick:()=>n(!1),className:"p-1 text-gray-400 hover:text-gray-600",children:a.jsx(qr,{className:"w-5 h-5"})})]})}),a.jsxs("form",{onSubmit:u(m),className:"p-6 space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category Name *"}),a.jsx("input",{...d("name",{required:"Category name is required"}),type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter category name"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),a.jsx("textarea",{...d("description"),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Describe this category (optional)"})]}),a.jsxs("div",{className:"flex items-center",children:[a.jsx("input",{...d("isActive"),type:"checkbox",className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("label",{className:"ml-2 text-sm text-gray-700",children:"Active (visible in menu)"})]}),a.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[a.jsx("button",{type:"button",onClick:()=>n(!1),className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Cancel"}),a.jsx("button",{type:"submit",disabled:l,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-colors",children:l?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2 inline-block"}),"Saving..."]}):a.jsxs(a.Fragment,{children:[a.jsx(au,{className:"w-4 h-4 mr-2 inline"}),i?"Update Category":"Create Category"]})})]})]})]})})]})}function Ise({variants:t,onChange:e}){const[r,s]=R.useState(null),[n,i]=R.useState(null),o=()=>{const f={id:An(),name:"",type:"single",required:!1,options:[]};e([...t,f]),s(f.id)},l=(f,p)=>{const m=t.map(g=>g.id===f?{...g,...p}:g);e(m)},c=f=>{e(t.filter(p=>p.id!==f))},d=f=>{var m;const p={id:An(),name:"",priceModifier:0,isDefault:!1};l(f,{options:[...((m=t.find(g=>g.id===f))==null?void 0:m.options)||[],p]}),i(p.id)},u=(f,p,m)=>{const g=t.find(v=>v.id===f);if(!g)return;const y=g.options.map(v=>v.id===p?{...v,...m}:v);l(f,{options:y})},A=(f,p)=>{const m=t.find(g=>g.id===f);m&&l(f,{options:m.options.filter(g=>g.id!==p)})},h=(f,p)=>{const m=t.find(y=>y.id===f);if(!m||m.type!=="single")return;const g=m.options.map(y=>({...y,isDefault:y.id===p}));l(f,{options:g})};return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Menu Item Variants"}),a.jsxs("button",{type:"button",onClick:o,className:"flex items-center px-3 py-2 text-sm bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[a.jsx(zr,{className:"w-4 h-4 mr-2"}),"Add Variant"]})]}),t.length===0?a.jsx("div",{className:"text-center py-8 text-gray-500",children:a.jsx("p",{children:"No variants configured. Add variants like size, spice level, or toppings to give customers more options."})}):a.jsx("div",{className:"space-y-4",children:t.map(f=>a.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[a.jsxs("div",{className:"flex items-start justify-between mb-4",children:[a.jsx("div",{className:"flex-1 grid grid-cols-1 md:grid-cols-3 gap-4",children:r===f.id?a.jsxs(a.Fragment,{children:[a.jsx("input",{type:"text",value:f.name,onChange:p=>l(f.id,{name:p.target.value}),placeholder:"Variant name (e.g., Size, Spice Level)",className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",autoFocus:!0}),a.jsxs("select",{value:f.type,onChange:p=>l(f.id,{type:p.target.value}),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[a.jsx("option",{value:"single",children:"Single Choice"}),a.jsx("option",{value:"multiple",children:"Multiple Choice"})]}),a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsxs("label",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"checkbox",checked:f.required,onChange:p=>l(f.id,{required:p.target.checked}),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{className:"text-sm text-gray-700",children:"Required"})]}),f.type==="multiple"&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Max selections"}),a.jsx("input",{type:"number",min:"1",value:f.maxSelections||"",onChange:p=>l(f.id,{maxSelections:parseInt(p.target.value)||void 0}),className:"w-20 px-2 py-1 border border-gray-300 rounded text-sm",placeholder:""})]})]})]}):a.jsx(a.Fragment,{children:a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-gray-900",children:f.name||"Unnamed Variant"}),a.jsxs("p",{className:"text-sm text-gray-600",children:[f.type==="single"?"Single Choice":"Multiple Choice",f.required?"  Required":"  Optional",f.type==="multiple"&&f.maxSelections&&`  Max ${f.maxSelections}`]})]})})}),a.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[r===f.id?a.jsx("button",{type:"button",onClick:()=>s(null),className:"p-1 text-green-600 hover:text-green-700",children:a.jsx(au,{className:"w-4 h-4"})}):a.jsx("button",{type:"button",onClick:()=>s(f.id),className:"p-1 text-gray-400 hover:text-gray-600",children:a.jsx(gc,{className:"w-4 h-4"})}),a.jsx("button",{type:"button",onClick:()=>c(f.id),className:"p-1 text-red-400 hover:text-red-600",children:a.jsx(Un,{className:"w-4 h-4"})})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h5",{className:"text-sm font-medium text-gray-700",children:"Options"}),a.jsxs("button",{type:"button",onClick:()=>d(f.id),className:"flex items-center px-2 py-1 text-xs bg-gray-100 text-gray-700 rounded hover:bg-gray-200 transition-colors",children:[a.jsx(zr,{className:"w-3 h-3 mr-1"}),"Add Option"]})]}),f.options.length===0?a.jsx("p",{className:"text-sm text-gray-500 italic",children:"No options configured"}):a.jsx("div",{className:"space-y-2",children:f.options.map(p=>a.jsx("div",{className:"flex items-center space-x-3 p-2 bg-gray-50 rounded-lg",children:n===p.id?a.jsxs(a.Fragment,{children:[a.jsx("input",{type:"text",value:p.name,onChange:m=>u(f.id,p.id,{name:m.target.value}),placeholder:"Option name",className:"flex-1 px-2 py-1 border border-gray-300 rounded text-sm",autoFocus:!0}),a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx("span",{className:"text-xs text-gray-600",children:""}),a.jsx("input",{type:"number",step:"0.01",value:p.priceModifier,onChange:m=>u(f.id,p.id,{priceModifier:parseFloat(m.target.value)||0}),className:"w-20 px-2 py-1 border border-gray-300 rounded text-sm",placeholder:"0.00"})]}),a.jsxs("select",{value:p.pricingType||"additive",onChange:m=>u(f.id,p.id,{pricingType:m.target.value}),className:"px-2 py-1 border border-gray-300 rounded text-xs",children:[a.jsx("option",{value:"additive",children:"Add to base"}),a.jsx("option",{value:"standalone",children:"Replace base"})]}),f.type==="single"&&a.jsxs("label",{className:"flex items-center space-x-1",children:[a.jsx("input",{type:"radio",name:`default-${f.id}`,checked:p.isDefault,onChange:()=>h(f.id,p.id),className:"text-blue-600 focus:ring-blue-500"}),a.jsx("span",{className:"text-xs text-gray-600",children:"Default"})]}),a.jsx("button",{type:"button",onClick:()=>i(null),className:"p-1 text-green-600 hover:text-green-700",children:a.jsx(au,{className:"w-3 h-3"})})]}):a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"flex-1 text-sm text-gray-900",children:p.name||"Unnamed Option"}),a.jsxs("div",{className:"flex flex-col items-end",children:[a.jsxs("span",{className:"text-sm text-gray-600",children:[p.pricingType==="standalone"?"":p.priceModifier>0&&"+","",p.priceModifier.toFixed(2)]}),a.jsx("span",{className:"text-xs text-gray-500",children:p.pricingType==="standalone"?"Standalone":"Additive"})]}),p.isDefault&&f.type==="single"&&a.jsx("span",{className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded",children:"Default"}),a.jsx("button",{type:"button",onClick:()=>i(p.id),className:"p-1 text-gray-400 hover:text-gray-600",children:a.jsx(gc,{className:"w-3 h-3"})}),a.jsx("button",{type:"button",onClick:()=>A(f.id,p.id),className:"p-1 text-red-400 hover:text-red-600",children:a.jsx(Un,{className:"w-3 h-3"})})]})},p.id))})]})]},f.id))})]})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Gw={};Gw.version="0.18.5";var KM=1252,kse=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],A_={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},h_=function(t){kse.indexOf(t)!=-1&&(KM=A_[0]=t)};function Bse(){h_(1252)}var oc=function(t){h_(t)};function f_(){oc(1200),Bse()}function EB(t){for(var e=[],r=0,s=t.length;r<s;++r)e[r]=t.charCodeAt(r);return e}function Fse(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function zM(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var Og=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?Fse(t.slice(2)):e==254&&r==255?zM(t.slice(2)):e==65279?t.slice(1):t},f1=function(e){return String.fromCharCode(e)},_B=function(e){return String.fromCharCode(e)},Kj,xA="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function dy(t){for(var e="",r=0,s=0,n=0,i=0,o=0,l=0,c=0,d=0;d<t.length;)r=t.charCodeAt(d++),i=r>>2,s=t.charCodeAt(d++),o=(r&3)<<4|s>>4,n=t.charCodeAt(d++),l=(s&15)<<2|n>>6,c=n&63,isNaN(s)?l=c=64:isNaN(n)&&(c=64),e+=xA.charAt(i)+xA.charAt(o)+xA.charAt(l)+xA.charAt(c);return e}function Zo(t){var e="",r=0,s=0,n=0,i=0,o=0,l=0,c=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<t.length;)i=xA.indexOf(t.charAt(d++)),o=xA.indexOf(t.charAt(d++)),r=i<<2|o>>4,e+=String.fromCharCode(r),l=xA.indexOf(t.charAt(d++)),s=(o&15)<<4|l>>2,l!==64&&(e+=String.fromCharCode(s)),c=xA.indexOf(t.charAt(d++)),n=(l&3)<<6|c,c!==64&&(e+=String.fromCharCode(n));return e}var Zr=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),fu=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function JA(t){return Zr?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function TB(t){return Zr?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var Vo=function(e){return Zr?fu(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function vN(t){if(typeof ArrayBuffer>"u")return Vo(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),s=0;s!=t.length;++s)r[s]=t.charCodeAt(s)&255;return e}function gh(t){if(Array.isArray(t))return t.map(function(s){return String.fromCharCode(s)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function Pse(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}function m_(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return m_(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var Va=Zr?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:fu(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var s=new Uint8Array(r),n=0;for(e=0,r=0;e<t.length;r+=n,++e)if(n=t[e].length,t[e]instanceof Uint8Array)s.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";s.set(new Uint8Array(t[e]),r)}return s}return[].concat.apply([],t.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function Dse(t){for(var e=[],r=0,s=t.length+250,n=JA(t.length+255),i=0;i<t.length;++i){var o=t.charCodeAt(i);if(o<128)n[r++]=o;else if(o<2048)n[r++]=192|o>>6&31,n[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var l=t.charCodeAt(++i)&1023;n[r++]=240|o>>8&7,n[r++]=128|o>>2&63,n[r++]=128|l>>6&15|(o&3)<<4,n[r++]=128|l&63}else n[r++]=224|o>>12&15,n[r++]=128|o>>6&63,n[r++]=128|o&63;r>s&&(e.push(n.slice(0,r)),r=0,n=JA(65535),s=65530)}return e.push(n.slice(0,r)),Va(e)}var eo=/\u0000/g,Ug=/[\u0001-\u0006]/g;function O0(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function lc(t,e){var r=""+t;return r.length>=e?r:Rn("0",e-r.length)+r}function p_(t,e){var r=""+t;return r.length>=e?r:Rn(" ",e-r.length)+r}function Yw(t,e){var r=""+t;return r.length>=e?r:r+Rn(" ",e-r.length)}function Rse(t,e){var r=""+Math.round(t);return r.length>=e?r:Rn("0",e-r.length)+r}function Lse(t,e){var r=""+t;return r.length>=e?r:Rn("0",e-r.length)+r}var IB=Math.pow(2,32);function Fm(t,e){if(t>IB||t<-IB)return Rse(t,e);var r=Math.round(t);return Lse(r,e)}function Xw(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var kB=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],rC=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Ose(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var Ir={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},BB={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Use={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Jw(t,e,r){for(var s=t<0?-1:1,n=t*s,i=0,o=1,l=0,c=1,d=0,u=0,A=Math.floor(n);d<e&&(A=Math.floor(n),l=A*o+i,u=A*d+c,!(n-A<5e-8));)n=1/(n-A),i=o,o=l,c=d,d=u;if(u>e&&(d>e?(u=c,l=i):(u=d,l=o)),!r)return[0,s*l,u];var h=Math.floor(s*l/u);return[h,s*l-h*u,u]}function af(t,e,r){if(t>2958465||t<0)return null;var s=t|0,n=Math.floor(86400*(t-s)),i=0,o=[],l={D:s,T:n,u:86400*(t-s)-n,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),e&&e.date1904&&(s+=1462),l.u>.9999&&(l.u=0,++n==86400&&(l.T=n=0,++s,++l.D)),s===60)o=r?[1317,10,29]:[1900,2,29],i=3;else if(s===0)o=r?[1317,8,29]:[1900,1,0],i=6;else{s>60&&--s;var c=new Date(1900,0,1);c.setDate(c.getDate()+s-1),o=[c.getFullYear(),c.getMonth()+1,c.getDate()],i=c.getDay(),s<60&&(i=(i+6)%7),r&&(i=Kse(c,o))}return l.y=o[0],l.m=o[1],l.d=o[2],l.S=n%60,n=Math.floor(n/60),l.M=n%60,n=Math.floor(n/60),l.H=n,l.q=i,l}var qM=new Date(1899,11,31,0,0,0),Mse=qM.getTime(),Qse=new Date(1900,2,1,0,0,0);function WM(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=Qse&&(r+=24*60*60*1e3),(r-(Mse+(t.getTimezoneOffset()-qM.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function g_(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Vse(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Hse(t){var e=t<0?12:11,r=g_(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function $se(t){var e=g_(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function uy(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=Hse(t):e===10?r=t.toFixed(10).substr(0,12):r=$se(t),g_(Vse(r.toUpperCase()))}function Qf(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):uy(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return Ll(14,WM(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function Kse(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function zse(t,e,r,s){var n="",i=0,o=0,l=r.y,c,d=0;switch(t){case 98:l=r.y+543;case 121:switch(e.length){case 1:case 2:c=l%100,d=2;break;default:c=l%1e4,d=4;break}break;case 109:switch(e.length){case 1:case 2:c=r.m,d=e.length;break;case 3:return rC[r.m-1][1];case 5:return rC[r.m-1][0];default:return rC[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:c=r.d,d=e.length;break;case 3:return kB[r.q][0];default:return kB[r.q][1]}break;case 104:switch(e.length){case 1:case 2:c=1+(r.H+11)%12,d=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:c=r.H,d=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:c=r.M,d=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?lc(r.S,e.length):(s>=2?o=s===3?1e3:100:o=s===1?10:1,i=Math.round(o*(r.S+r.u)),i>=60*o&&(i=0),e==="s"?i===0?"0":""+i/o:(n=lc(i,2+s),e==="ss"?n.substr(0,2):"."+n.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}d=e.length===3?1:2;break;case 101:c=l,d=1;break}var u=d>0?lc(c,d):"";return u}function yA(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,s=t.substr(0,r);r!=t.length;r+=e)s+=(s.length>0?",":"")+t.substr(r,e);return s}var GM=/%/g;function qse(t,e,r){var s=e.replace(GM,""),n=e.length-s.length;return zd(t,s,r*Math.pow(10,2*n))+Rn("%",n)}function Wse(t,e,r){for(var s=e.length-1;e.charCodeAt(s-1)===44;)--s;return zd(t,e.substr(0,s),r/Math.pow(10,3*(e.length-s)))}function YM(t,e){var r,s=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+YM(t,-e);var n=t.indexOf(".");n===-1&&(n=t.indexOf("E"));var i=Math.floor(Math.log(e)*Math.LOG10E)%n;if(i<0&&(i+=n),r=(e/Math.pow(10,i)).toPrecision(s+1+(n+i)%n),r.indexOf("e")===-1){var o=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,n)+"."+r.substr(2+n),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,d,u){return c+d+u.substr(0,(n+i)%n)+"."+u.substr(i)+"E"})}else r=e.toExponential(s);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var XM=/# (\?+)( ?)\/( ?)(\d+)/;function Gse(t,e,r){var s=parseInt(t[4],10),n=Math.round(e*s),i=Math.floor(n/s),o=n-i*s,l=s;return r+(i===0?"":""+i)+" "+(o===0?Rn(" ",t[1].length+1+t[4].length):p_(o,t[1].length)+t[2]+"/"+t[3]+lc(l,t[4].length))}function Yse(t,e,r){return r+(e===0?"":""+e)+Rn(" ",t[1].length+2+t[4].length)}var JM=/^#*0*\.([0#]+)/,ZM=/\).*[0#]/,e7=/\(###\) ###\\?-####/;function Ki(t){for(var e="",r,s=0;s!=t.length;++s)switch(r=t.charCodeAt(s)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function FB(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function PB(t,e){var r=t-Math.floor(t),s=Math.pow(10,e);return e<(""+Math.round(r*s)).length?0:Math.round(r*s)}function Xse(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function Jse(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function fl(t,e,r){if(t.charCodeAt(0)===40&&!e.match(ZM)){var s=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?fl("n",s,r):"("+fl("n",s,-r)+")"}if(e.charCodeAt(e.length-1)===44)return Wse(t,e,r);if(e.indexOf("%")!==-1)return qse(t,e,r);if(e.indexOf("E")!==-1)return YM(e,r);if(e.charCodeAt(0)===36)return"$"+fl(t,e.substr(e.charAt(1)==" "?2:1),r);var n,i,o,l,c=Math.abs(r),d=r<0?"-":"";if(e.match(/^00+$/))return d+Fm(c,e.length);if(e.match(/^[#?]+$/))return n=Fm(r,0),n==="0"&&(n=""),n.length>e.length?n:Ki(e.substr(0,e.length-n.length))+n;if(i=e.match(XM))return Gse(i,c,d);if(e.match(/^#+0+$/))return d+Fm(c,e.length-e.indexOf("0"));if(i=e.match(JM))return n=FB(r,i[1].length).replace(/^([^\.]+)$/,"$1."+Ki(i[1])).replace(/\.$/,"."+Ki(i[1])).replace(/\.(\d*)$/,function(p,m){return"."+m+Rn("0",Ki(i[1]).length-m.length)}),e.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),i=e.match(/^(0*)\.(#*)$/))return d+FB(c,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=e.match(/^#{1,3},##0(\.?)$/))return d+yA(Fm(c,0));if(i=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+fl(t,e,-r):yA(""+(Math.floor(r)+Xse(r,i[1].length)))+"."+lc(PB(r,i[1].length),i[1].length);if(i=e.match(/^#,#*,#0/))return fl(t,e.replace(/^#,#*,/,""),r);if(i=e.match(/^([0#]+)(\\?-([0#]+))+$/))return n=O0(fl(t,e.replace(/[\\-]/g,""),r)),o=0,O0(O0(e.replace(/\\/g,"")).replace(/[0#]/g,function(p){return o<n.length?n.charAt(o++):p==="0"?"0":""}));if(e.match(e7))return n=fl(t,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var u="";if(i=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),l=Jw(c,Math.pow(10,o)-1,!1),n=""+d,u=zd("n",i[1],l[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),n+=u+i[2]+"/"+i[3],u=Yw(l[2],o),u.length<i[4].length&&(u=Ki(i[4].substr(i[4].length-u.length))+u),n+=u,n;if(i=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),l=Jw(c,Math.pow(10,o)-1,!0),d+(l[0]||(l[1]?"":"0"))+" "+(l[1]?p_(l[1],o)+i[2]+"/"+i[3]+Yw(l[2],o):Rn(" ",2*o+1+i[2].length+i[3].length));if(i=e.match(/^[#0?]+$/))return n=Fm(r,0),e.length<=n.length?n:Ki(e.substr(0,e.length-n.length))+n;if(i=e.match(/^([#0?]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=n.indexOf(".");var A=e.indexOf(".")-o,h=e.length-n.length-A;return Ki(e.substr(0,A)+n+e.substr(e.length-h))}if(i=e.match(/^00,000\.([#0]*0)$/))return o=PB(r,i[1].length),r<0?"-"+fl(t,e,-r):yA(Jse(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?lc(0,3-p.length):"")+p})+"."+lc(o,i[1].length);switch(e){case"###,##0.00":return fl(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var f=yA(Fm(c,0));return f!=="0"?d+f:"";case"###,###.00":return fl(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return fl(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function Zse(t,e,r){for(var s=e.length-1;e.charCodeAt(s-1)===44;)--s;return zd(t,e.substr(0,s),r/Math.pow(10,3*(e.length-s)))}function ene(t,e,r){var s=e.replace(GM,""),n=e.length-s.length;return zd(t,s,r*Math.pow(10,2*n))+Rn("%",n)}function t7(t,e){var r,s=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+t7(t,-e);var n=t.indexOf(".");n===-1&&(n=t.indexOf("E"));var i=Math.floor(Math.log(e)*Math.LOG10E)%n;if(i<0&&(i+=n),r=(e/Math.pow(10,i)).toPrecision(s+1+(n+i)%n),!r.match(/[Ee]/)){var o=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,d,u){return c+d+u.substr(0,(n+i)%n)+"."+u.substr(i)+"E"})}else r=e.toExponential(s);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Fc(t,e,r){if(t.charCodeAt(0)===40&&!e.match(ZM)){var s=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Fc("n",s,r):"("+Fc("n",s,-r)+")"}if(e.charCodeAt(e.length-1)===44)return Zse(t,e,r);if(e.indexOf("%")!==-1)return ene(t,e,r);if(e.indexOf("E")!==-1)return t7(e,r);if(e.charCodeAt(0)===36)return"$"+Fc(t,e.substr(e.charAt(1)==" "?2:1),r);var n,i,o,l,c=Math.abs(r),d=r<0?"-":"";if(e.match(/^00+$/))return d+lc(c,e.length);if(e.match(/^[#?]+$/))return n=""+r,r===0&&(n=""),n.length>e.length?n:Ki(e.substr(0,e.length-n.length))+n;if(i=e.match(XM))return Yse(i,c,d);if(e.match(/^#+0+$/))return d+lc(c,e.length-e.indexOf("0"));if(i=e.match(JM))return n=(""+r).replace(/^([^\.]+)$/,"$1."+Ki(i[1])).replace(/\.$/,"."+Ki(i[1])),n=n.replace(/\.(\d*)$/,function(p,m){return"."+m+Rn("0",Ki(i[1]).length-m.length)}),e.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),i=e.match(/^(0*)\.(#*)$/))return d+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=e.match(/^#{1,3},##0(\.?)$/))return d+yA(""+c);if(i=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Fc(t,e,-r):yA(""+r)+"."+Rn("0",i[1].length);if(i=e.match(/^#,#*,#0/))return Fc(t,e.replace(/^#,#*,/,""),r);if(i=e.match(/^([0#]+)(\\?-([0#]+))+$/))return n=O0(Fc(t,e.replace(/[\\-]/g,""),r)),o=0,O0(O0(e.replace(/\\/g,"")).replace(/[0#]/g,function(p){return o<n.length?n.charAt(o++):p==="0"?"0":""}));if(e.match(e7))return n=Fc(t,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var u="";if(i=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),l=Jw(c,Math.pow(10,o)-1,!1),n=""+d,u=zd("n",i[1],l[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),n+=u+i[2]+"/"+i[3],u=Yw(l[2],o),u.length<i[4].length&&(u=Ki(i[4].substr(i[4].length-u.length))+u),n+=u,n;if(i=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),l=Jw(c,Math.pow(10,o)-1,!0),d+(l[0]||(l[1]?"":"0"))+" "+(l[1]?p_(l[1],o)+i[2]+"/"+i[3]+Yw(l[2],o):Rn(" ",2*o+1+i[2].length+i[3].length));if(i=e.match(/^[#0?]+$/))return n=""+r,e.length<=n.length?n:Ki(e.substr(0,e.length-n.length))+n;if(i=e.match(/^([#0]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=n.indexOf(".");var A=e.indexOf(".")-o,h=e.length-n.length-A;return Ki(e.substr(0,A)+n+e.substr(e.length-h))}if(i=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Fc(t,e,-r):yA(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?lc(0,3-p.length):"")+p})+"."+lc(0,i[1].length);switch(e){case"###,###":case"##,###":case"#,###":var f=yA(""+c);return f!=="0"?d+f:"";default:if(e.match(/\.[0#?]*$/))return Fc(t,e.slice(0,e.lastIndexOf(".")),r)+Ki(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function zd(t,e,r){return(r|0)===r?Fc(t,e,r):fl(t,e,r)}function tne(t){for(var e=[],r=!1,s=0,n=0;s<t.length;++s)switch(t.charCodeAt(s)){case 34:r=!r;break;case 95:case 42:case 92:++s;break;case 59:e[e.length]=t.substr(n,s-n),n=s+1}if(e[e.length]=t.substr(n),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var r7=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Rp(t){for(var e=0,r="",s="";e<t.length;)switch(r=t.charAt(e)){case"G":Xw(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(s=r;t.charAt(e++)!=="]"&&e<t.length;)s+=t.charAt(e);if(s.match(r7))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function rne(t,e,r,s){for(var n=[],i="",o=0,l="",c="t",d,u,A,h="H";o<t.length;)switch(l=t.charAt(o)){case"G":if(!Xw(t,o))throw new Error("unrecognized character "+l+" in "+t);n[n.length]={t:"G",v:"General"},o+=7;break;case'"':for(i="";(A=t.charCodeAt(++o))!==34&&o<t.length;)i+=String.fromCharCode(A);n[n.length]={t:"t",v:i},++o;break;case"\\":var f=t.charAt(++o),p=f==="("||f===")"?f:"t";n[n.length]={t:p,v:f},++o;break;case"_":n[n.length]={t:"t",v:" "},o+=2;break;case"@":n[n.length]={t:"T",v:e},++o;break;case"B":case"b":if(t.charAt(o+1)==="1"||t.charAt(o+1)==="2"){if(d==null&&(d=af(e,r,t.charAt(o+1)==="2"),d==null))return"";n[n.length]={t:"X",v:t.substr(o,2)},c=l,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||d==null&&(d=af(e,r),d==null))return"";for(i=l;++o<t.length&&t.charAt(o).toLowerCase()===l;)i+=l;l==="m"&&c.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=h),n[n.length]={t:l,v:i},c=l;break;case"A":case"a":case"":var m={t:l,v:l};if(d==null&&(d=af(e,r)),t.substr(o,3).toUpperCase()==="A/P"?(d!=null&&(m.v=d.H>=12?"P":"A"),m.t="T",h="h",o+=3):t.substr(o,5).toUpperCase()==="AM/PM"?(d!=null&&(m.v=d.H>=12?"PM":"AM"),m.t="T",o+=5,h="h"):t.substr(o,5).toUpperCase()==="/"?(d!=null&&(m.v=d.H>=12?"":""),m.t="T",o+=5,h="h"):(m.t="t",++o),d==null&&m.t==="T")return"";n[n.length]=m,c=l;break;case"[":for(i=l;t.charAt(o++)!=="]"&&o<t.length;)i+=t.charAt(o);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(r7)){if(d==null&&(d=af(e,r),d==null))return"";n[n.length]={t:"Z",v:i.toLowerCase()},c=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",Rp(t)||(n[n.length]={t:"t",v:i}));break;case".":if(d!=null){for(i=l;++o<t.length&&(l=t.charAt(o))==="0";)i+=l;n[n.length]={t:"s",v:i};break}case"0":case"#":for(i=l;++o<t.length&&"0#?.,E+-%".indexOf(l=t.charAt(o))>-1;)i+=l;n[n.length]={t:"n",v:i};break;case"?":for(i=l;t.charAt(++o)===l;)i+=l;n[n.length]={t:l,v:i},c=l;break;case"*":++o,(t.charAt(o)==" "||t.charAt(o)=="*")&&++o;break;case"(":case")":n[n.length]={t:s===1?"t":l,v:l},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=l;o<t.length&&"0123456789".indexOf(t.charAt(++o))>-1;)i+=t.charAt(o);n[n.length]={t:"D",v:i};break;case" ":n[n.length]={t:l,v:l},++o;break;case"$":n[n.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+t);n[n.length]={t:"t",v:l},++o;break}var g=0,y=0,v;for(o=n.length-1,c="t";o>=0;--o)switch(n[o].t){case"h":case"H":n[o].t=h,c="h",g<1&&(g=1);break;case"s":(v=n[o].v.match(/\.0+$/))&&(y=Math.max(y,v[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":c=n[o].t;break;case"m":c==="s"&&(n[o].t="M",g<2&&(g=2));break;case"X":break;case"Z":g<1&&n[o].v.match(/[Hh]/)&&(g=1),g<2&&n[o].v.match(/[Mm]/)&&(g=2),g<3&&n[o].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var x="",E;for(o=0;o<n.length;++o)switch(n[o].t){case"t":case"T":case" ":case"D":break;case"X":n[o].v="",n[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":n[o].v=zse(n[o].t.charCodeAt(0),n[o].v,d,y),n[o].t="t";break;case"n":case"?":for(E=o+1;n[E]!=null&&((l=n[E].t)==="?"||l==="D"||(l===" "||l==="t")&&n[E+1]!=null&&(n[E+1].t==="?"||n[E+1].t==="t"&&n[E+1].v==="/")||n[o].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(n[E].v==="/"||n[E].v===" "&&n[E+1]!=null&&n[E+1].t=="?"));)n[o].v+=n[E].v,n[E]={v:"",t:";"},++E;x+=n[o].v,o=E-1;break;case"G":n[o].t="t",n[o].v=Qf(e,r);break}var T="",j,C;if(x.length>0){x.charCodeAt(0)==40?(j=e<0&&x.charCodeAt(0)===45?-e:e,C=zd("n",x,j)):(j=e<0&&s>1?-e:e,C=zd("n",x,j),j<0&&n[0]&&n[0].t=="t"&&(C=C.substr(1),n[0].v="-"+n[0].v)),E=C.length-1;var w=n.length;for(o=0;o<n.length;++o)if(n[o]!=null&&n[o].t!="t"&&n[o].v.indexOf(".")>-1){w=o;break}var S=n.length;if(w===n.length&&C.indexOf("E")===-1){for(o=n.length-1;o>=0;--o)n[o]==null||"n?".indexOf(n[o].t)===-1||(E>=n[o].v.length-1?(E-=n[o].v.length,n[o].v=C.substr(E+1,n[o].v.length)):E<0?n[o].v="":(n[o].v=C.substr(0,E+1),E=-1),n[o].t="t",S=o);E>=0&&S<n.length&&(n[S].v=C.substr(0,E+1)+n[S].v)}else if(w!==n.length&&C.indexOf("E")===-1){for(E=C.indexOf(".")-1,o=w;o>=0;--o)if(!(n[o]==null||"n?".indexOf(n[o].t)===-1)){for(u=n[o].v.indexOf(".")>-1&&o===w?n[o].v.indexOf(".")-1:n[o].v.length-1,T=n[o].v.substr(u+1);u>=0;--u)E>=0&&(n[o].v.charAt(u)==="0"||n[o].v.charAt(u)==="#")&&(T=C.charAt(E--)+T);n[o].v=T,n[o].t="t",S=o}for(E>=0&&S<n.length&&(n[S].v=C.substr(0,E+1)+n[S].v),E=C.indexOf(".")+1,o=w;o<n.length;++o)if(!(n[o]==null||"n?(".indexOf(n[o].t)===-1&&o!==w)){for(u=n[o].v.indexOf(".")>-1&&o===w?n[o].v.indexOf(".")+1:0,T=n[o].v.substr(0,u);u<n[o].v.length;++u)E<C.length&&(T+=C.charAt(E++));n[o].v=T,n[o].t="t",S=o}}}for(o=0;o<n.length;++o)n[o]!=null&&"n?".indexOf(n[o].t)>-1&&(j=s>1&&e<0&&o>0&&n[o-1].v==="-"?-e:e,n[o].v=zd(n[o].t,n[o].v,j),n[o].t="t");var F="";for(o=0;o!==n.length;++o)n[o]!=null&&(F+=n[o].v);return F}var DB=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function RB(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function sne(t,e){var r=tne(t),s=r.length,n=r[s-1].indexOf("@");if(s<4&&n>-1&&--s,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||n>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=n>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=n>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=n>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[s,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(DB),l=r[1].match(DB);return RB(e,o)?[s,r[0]]:RB(e,l)?[s,r[1]]:[s,r[o!=null&&l!=null?2:1]]}return[s,i]}function Ll(t,e,r){r==null&&(r={});var s="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?s=r.dateNF:s=t;break;case"number":t==14&&r.dateNF?s=r.dateNF:s=(r.table!=null?r.table:Ir)[t],s==null&&(s=r.table&&r.table[BB[t]]||Ir[BB[t]]),s==null&&(s=Use[t]||"General");break}if(Xw(s,0))return Qf(e,r);e instanceof Date&&(e=WM(e,r.date1904));var n=sne(s,e);if(Xw(n[1]))return Qf(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return rne(n[1],e,r,n[0])}function qd(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(Ir[r]==null){e<0&&(e=r);continue}if(Ir[r]==t){e=r;break}}e<0&&(e=391)}return Ir[e]=t,e}function bN(t){for(var e=0;e!=392;++e)t[e]!==void 0&&qd(t[e],e)}function Lp(){Ir=Ose()}var nne={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},s7=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function ane(t){var e=typeof t=="number"?Ir[t]:t;return e=e.replace(s7,"(\\d+)"),new RegExp("^"+e+"$")}function ine(t,e,r){var s=-1,n=-1,i=-1,o=-1,l=-1,c=-1;(e.match(s7)||[]).forEach(function(A,h){var f=parseInt(r[h+1],10);switch(A.toLowerCase().charAt(0)){case"y":s=f;break;case"d":i=f;break;case"h":o=f;break;case"s":c=f;break;case"m":o>=0?l=f:n=f;break}}),c>=0&&l==-1&&n>=0&&(l=n,n=-1);var d=(""+(s>=0?s:new Date().getFullYear())).slice(-4)+"-"+("00"+(n>=1?n:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var u=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return o==-1&&l==-1&&c==-1?d:s==-1&&n==-1&&i==-1?u:d+"T"+u}var one=function(){var t={};t.version="1.2.0";function e(){for(var C=0,w=new Array(256),S=0;S!=256;++S)C=S,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,w[S]=C;return typeof Int32Array<"u"?new Int32Array(w):w}var r=e();function s(C){var w=0,S=0,F=0,B=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(F=0;F!=256;++F)B[F]=C[F];for(F=0;F!=256;++F)for(S=C[F],w=256+F;w<4096;w+=256)S=B[w]=S>>>8^C[S&255];var k=[];for(F=1;F!=16;++F)k[F-1]=typeof Int32Array<"u"?B.subarray(F*256,F*256+256):B.slice(F*256,F*256+256);return k}var n=s(r),i=n[0],o=n[1],l=n[2],c=n[3],d=n[4],u=n[5],A=n[6],h=n[7],f=n[8],p=n[9],m=n[10],g=n[11],y=n[12],v=n[13],x=n[14];function E(C,w){for(var S=w^-1,F=0,B=C.length;F<B;)S=S>>>8^r[(S^C.charCodeAt(F++))&255];return~S}function T(C,w){for(var S=w^-1,F=C.length-15,B=0;B<F;)S=x[C[B++]^S&255]^v[C[B++]^S>>8&255]^y[C[B++]^S>>16&255]^g[C[B++]^S>>>24]^m[C[B++]]^p[C[B++]]^f[C[B++]]^h[C[B++]]^A[C[B++]]^u[C[B++]]^d[C[B++]]^c[C[B++]]^l[C[B++]]^o[C[B++]]^i[C[B++]]^r[C[B++]];for(F+=15;B<F;)S=S>>>8^r[(S^C[B++])&255];return~S}function j(C,w){for(var S=w^-1,F=0,B=C.length,k=0,D=0;F<B;)k=C.charCodeAt(F++),k<128?S=S>>>8^r[(S^k)&255]:k<2048?(S=S>>>8^r[(S^(192|k>>6&31))&255],S=S>>>8^r[(S^(128|k&63))&255]):k>=55296&&k<57344?(k=(k&1023)+64,D=C.charCodeAt(F++)&1023,S=S>>>8^r[(S^(240|k>>8&7))&255],S=S>>>8^r[(S^(128|k>>2&63))&255],S=S>>>8^r[(S^(128|D>>6&15|(k&3)<<4))&255],S=S>>>8^r[(S^(128|D&63))&255]):(S=S>>>8^r[(S^(224|k>>12&15))&255],S=S>>>8^r[(S^(128|k>>6&63))&255],S=S>>>8^r[(S^(128|k&63))&255]);return~S}return t.table=r,t.bstr=E,t.buf=T,t.str=j,t}(),Cr=function(){var e={};e.version="1.2.1";function r(ye,Le){for(var se=ye.split("/"),z=Le.split("/"),ce=0,xe=0,Pe=Math.min(se.length,z.length);ce<Pe;++ce){if(xe=se[ce].length-z[ce].length)return xe;if(se[ce]!=z[ce])return se[ce]<z[ce]?-1:1}return se.length-z.length}function s(ye){if(ye.charAt(ye.length-1)=="/")return ye.slice(0,-1).indexOf("/")===-1?ye:s(ye.slice(0,-1));var Le=ye.lastIndexOf("/");return Le===-1?ye:ye.slice(0,Le+1)}function n(ye){if(ye.charAt(ye.length-1)=="/")return n(ye.slice(0,-1));var Le=ye.lastIndexOf("/");return Le===-1?ye:ye.slice(Le+1)}function i(ye,Le){typeof Le=="string"&&(Le=new Date(Le));var se=Le.getHours();se=se<<6|Le.getMinutes(),se=se<<5|Le.getSeconds()>>>1,ye.write_shift(2,se);var z=Le.getFullYear()-1980;z=z<<4|Le.getMonth()+1,z=z<<5|Le.getDate(),ye.write_shift(2,z)}function o(ye){var Le=ye.read_shift(2)&65535,se=ye.read_shift(2)&65535,z=new Date,ce=se&31;se>>>=5;var xe=se&15;se>>>=4,z.setMilliseconds(0),z.setFullYear(se+1980),z.setMonth(xe-1),z.setDate(ce);var Pe=Le&31;Le>>>=5;var Ze=Le&63;return Le>>>=6,z.setHours(Le),z.setMinutes(Ze),z.setSeconds(Pe<<1),z}function l(ye){ti(ye,0);for(var Le={},se=0;ye.l<=ye.length-4;){var z=ye.read_shift(2),ce=ye.read_shift(2),xe=ye.l+ce,Pe={};switch(z){case 21589:se=ye.read_shift(1),se&1&&(Pe.mtime=ye.read_shift(4)),ce>5&&(se&2&&(Pe.atime=ye.read_shift(4)),se&4&&(Pe.ctime=ye.read_shift(4))),Pe.mtime&&(Pe.mt=new Date(Pe.mtime*1e3));break}ye.l=xe,Le[z]=Pe}return Le}var c;function d(){return c||(c={})}function u(ye,Le){if(ye[0]==80&&ye[1]==75)return Ge(ye,Le);if((ye[0]|32)==109&&(ye[1]|32)==105)return Ft(ye,Le);if(ye.length<512)throw new Error("CFB file size "+ye.length+" < 512");var se=3,z=512,ce=0,xe=0,Pe=0,Ze=0,Ye=0,Je=[],et=ye.slice(0,512);ti(et,0);var ft=A(et);switch(se=ft[0],se){case 3:z=512;break;case 4:z=4096;break;case 0:if(ft[1]==0)return Ge(ye,Le);default:throw new Error("Major Version: Expected 3 or 4 saw "+se)}z!==512&&(et=ye.slice(0,z),ti(et,28));var At=ye.slice(0,z);h(et,se);var Nt=et.read_shift(4,"i");if(se===3&&Nt!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Nt);et.l+=4,Pe=et.read_shift(4,"i"),et.l+=4,et.chk("00100000","Mini Stream Cutoff Size: "),Ze=et.read_shift(4,"i"),ce=et.read_shift(4,"i"),Ye=et.read_shift(4,"i"),xe=et.read_shift(4,"i");for(var kt=-1,Ht=0;Ht<109&&(kt=et.read_shift(4,"i"),!(kt<0));++Ht)Je[Ht]=kt;var ir=f(ye,z);g(Ye,xe,ir,z,Je);var Ar=v(ir,Pe,Je,z);Ar[Pe].name="!Directory",ce>0&&Ze!==D&&(Ar[Ze].name="!MiniFAT"),Ar[Je[0]].name="!FAT",Ar.fat_addrs=Je,Ar.ssz=z;var or={},ns=[],Ia=[],so=[];x(Pe,Ar,ir,ns,ce,or,Ia,Ze),p(Ia,so,ns),ns.shift();var li={FileIndex:Ia,FullPaths:so};return Le&&Le.raw&&(li.raw={header:At,sectors:ir}),li}function A(ye){if(ye[ye.l]==80&&ye[ye.l+1]==75)return[0,0];ye.chk(q,"Header Signature: "),ye.l+=16;var Le=ye.read_shift(2,"u");return[ye.read_shift(2,"u"),Le]}function h(ye,Le){var se=9;switch(ye.l+=2,se=ye.read_shift(2)){case 9:if(Le!=3)throw new Error("Sector Shift: Expected 9 saw "+se);break;case 12:if(Le!=4)throw new Error("Sector Shift: Expected 12 saw "+se);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+se)}ye.chk("0600","Mini Sector Shift: "),ye.chk("000000000000","Reserved: ")}function f(ye,Le){for(var se=Math.ceil(ye.length/Le)-1,z=[],ce=1;ce<se;++ce)z[ce-1]=ye.slice(ce*Le,(ce+1)*Le);return z[se-1]=ye.slice(se*Le),z}function p(ye,Le,se){for(var z=0,ce=0,xe=0,Pe=0,Ze=0,Ye=se.length,Je=[],et=[];z<Ye;++z)Je[z]=et[z]=z,Le[z]=se[z];for(;Ze<et.length;++Ze)z=et[Ze],ce=ye[z].L,xe=ye[z].R,Pe=ye[z].C,Je[z]===z&&(ce!==-1&&Je[ce]!==ce&&(Je[z]=Je[ce]),xe!==-1&&Je[xe]!==xe&&(Je[z]=Je[xe])),Pe!==-1&&(Je[Pe]=z),ce!==-1&&z!=Je[z]&&(Je[ce]=Je[z],et.lastIndexOf(ce)<Ze&&et.push(ce)),xe!==-1&&z!=Je[z]&&(Je[xe]=Je[z],et.lastIndexOf(xe)<Ze&&et.push(xe));for(z=1;z<Ye;++z)Je[z]===z&&(xe!==-1&&Je[xe]!==xe?Je[z]=Je[xe]:ce!==-1&&Je[ce]!==ce&&(Je[z]=Je[ce]));for(z=1;z<Ye;++z)if(ye[z].type!==0){if(Ze=z,Ze!=Je[Ze])do Ze=Je[Ze],Le[z]=Le[Ze]+"/"+Le[z];while(Ze!==0&&Je[Ze]!==-1&&Ze!=Je[Ze]);Je[z]=-1}for(Le[0]+="/",z=1;z<Ye;++z)ye[z].type!==2&&(Le[z]+="/")}function m(ye,Le,se){for(var z=ye.start,ce=ye.size,xe=[],Pe=z;se&&ce>0&&Pe>=0;)xe.push(Le.slice(Pe*k,Pe*k+k)),ce-=k,Pe=Wh(se,Pe*4);return xe.length===0?It(0):Va(xe).slice(0,ye.size)}function g(ye,Le,se,z,ce){var xe=D;if(ye===D){if(Le!==0)throw new Error("DIFAT chain shorter than expected")}else if(ye!==-1){var Pe=se[ye],Ze=(z>>>2)-1;if(!Pe)return;for(var Ye=0;Ye<Ze&&(xe=Wh(Pe,Ye*4))!==D;++Ye)ce.push(xe);g(Wh(Pe,z-4),Le-1,se,z,ce)}}function y(ye,Le,se,z,ce){var xe=[],Pe=[];ce||(ce=[]);var Ze=z-1,Ye=0,Je=0;for(Ye=Le;Ye>=0;){ce[Ye]=!0,xe[xe.length]=Ye,Pe.push(ye[Ye]);var et=se[Math.floor(Ye*4/z)];if(Je=Ye*4&Ze,z<4+Je)throw new Error("FAT boundary crossed: "+Ye+" 4 "+z);if(!ye[et])break;Ye=Wh(ye[et],Je)}return{nodes:xe,data:WB([Pe])}}function v(ye,Le,se,z){var ce=ye.length,xe=[],Pe=[],Ze=[],Ye=[],Je=z-1,et=0,ft=0,At=0,Nt=0;for(et=0;et<ce;++et)if(Ze=[],At=et+Le,At>=ce&&(At-=ce),!Pe[At]){Ye=[];var kt=[];for(ft=At;ft>=0;){kt[ft]=!0,Pe[ft]=!0,Ze[Ze.length]=ft,Ye.push(ye[ft]);var Ht=se[Math.floor(ft*4/z)];if(Nt=ft*4&Je,z<4+Nt)throw new Error("FAT boundary crossed: "+ft+" 4 "+z);if(!ye[Ht]||(ft=Wh(ye[Ht],Nt),kt[ft]))break}xe[At]={nodes:Ze,data:WB([Ye])}}return xe}function x(ye,Le,se,z,ce,xe,Pe,Ze){for(var Ye=0,Je=z.length?2:0,et=Le[ye].data,ft=0,At=0,Nt;ft<et.length;ft+=128){var kt=et.slice(ft,ft+128);ti(kt,64),At=kt.read_shift(2),Nt=C_(kt,0,At-Je),z.push(Nt);var Ht={name:Nt,type:kt.read_shift(1),color:kt.read_shift(1),L:kt.read_shift(4,"i"),R:kt.read_shift(4,"i"),C:kt.read_shift(4,"i"),clsid:kt.read_shift(16),state:kt.read_shift(4,"i"),start:0,size:0},ir=kt.read_shift(2)+kt.read_shift(2)+kt.read_shift(2)+kt.read_shift(2);ir!==0&&(Ht.ct=E(kt,kt.l-8));var Ar=kt.read_shift(2)+kt.read_shift(2)+kt.read_shift(2)+kt.read_shift(2);Ar!==0&&(Ht.mt=E(kt,kt.l-8)),Ht.start=kt.read_shift(4,"i"),Ht.size=kt.read_shift(4,"i"),Ht.size<0&&Ht.start<0&&(Ht.size=Ht.type=0,Ht.start=D,Ht.name=""),Ht.type===5?(Ye=Ht.start,ce>0&&Ye!==D&&(Le[Ye].name="!StreamData")):Ht.size>=4096?(Ht.storage="fat",Le[Ht.start]===void 0&&(Le[Ht.start]=y(se,Ht.start,Le.fat_addrs,Le.ssz)),Le[Ht.start].name=Ht.name,Ht.content=Le[Ht.start].data.slice(0,Ht.size)):(Ht.storage="minifat",Ht.size<0?Ht.size=0:Ye!==D&&Ht.start!==D&&Le[Ye]&&(Ht.content=m(Ht,Le[Ye].data,(Le[Ze]||{}).data))),Ht.content&&ti(Ht.content,0),xe[Nt]=Ht,Pe.push(Ht)}}function E(ye,Le){return new Date((Qo(ye,Le+4)/1e7*Math.pow(2,32)+Qo(ye,Le)/1e7-11644473600)*1e3)}function T(ye,Le){return d(),u(c.readFileSync(ye),Le)}function j(ye,Le){var se=Le&&Le.type;switch(se||Zr&&Buffer.isBuffer(ye)&&(se="buffer"),se||"base64"){case"file":return T(ye,Le);case"base64":return u(Vo(Zo(ye)),Le);case"binary":return u(Vo(ye),Le)}return u(ye,Le)}function C(ye,Le){var se=Le||{},z=se.root||"Root Entry";if(ye.FullPaths||(ye.FullPaths=[]),ye.FileIndex||(ye.FileIndex=[]),ye.FullPaths.length!==ye.FileIndex.length)throw new Error("inconsistent CFB structure");ye.FullPaths.length===0&&(ye.FullPaths[0]=z+"/",ye.FileIndex[0]={name:z,type:5}),se.CLSID&&(ye.FileIndex[0].clsid=se.CLSID),w(ye)}function w(ye){var Le="Sh33tJ5";if(!Cr.find(ye,"/"+Le)){var se=It(4);se[0]=55,se[1]=se[3]=50,se[2]=54,ye.FileIndex.push({name:Le,type:2,content:se,size:4,L:69,R:69,C:69}),ye.FullPaths.push(ye.FullPaths[0]+Le),S(ye)}}function S(ye,Le){C(ye);for(var se=!1,z=!1,ce=ye.FullPaths.length-1;ce>=0;--ce){var xe=ye.FileIndex[ce];switch(xe.type){case 0:z?se=!0:(ye.FileIndex.pop(),ye.FullPaths.pop());break;case 1:case 2:case 5:z=!0,isNaN(xe.R*xe.L*xe.C)&&(se=!0),xe.R>-1&&xe.L>-1&&xe.R==xe.L&&(se=!0);break;default:se=!0;break}}if(!(!se&&!Le)){var Pe=new Date(1987,1,19),Ze=0,Ye=Object.create?Object.create(null):{},Je=[];for(ce=0;ce<ye.FullPaths.length;++ce)Ye[ye.FullPaths[ce]]=!0,ye.FileIndex[ce].type!==0&&Je.push([ye.FullPaths[ce],ye.FileIndex[ce]]);for(ce=0;ce<Je.length;++ce){var et=s(Je[ce][0]);z=Ye[et],z||(Je.push([et,{name:n(et).replace("/",""),type:1,clsid:W,ct:Pe,mt:Pe,content:null}]),Ye[et]=!0)}for(Je.sort(function(Nt,kt){return r(Nt[0],kt[0])}),ye.FullPaths=[],ye.FileIndex=[],ce=0;ce<Je.length;++ce)ye.FullPaths[ce]=Je[ce][0],ye.FileIndex[ce]=Je[ce][1];for(ce=0;ce<Je.length;++ce){var ft=ye.FileIndex[ce],At=ye.FullPaths[ce];if(ft.name=n(At).replace("/",""),ft.L=ft.R=ft.C=-(ft.color=1),ft.size=ft.content?ft.content.length:0,ft.start=0,ft.clsid=ft.clsid||W,ce===0)ft.C=Je.length>1?1:-1,ft.size=0,ft.type=5;else if(At.slice(-1)=="/"){for(Ze=ce+1;Ze<Je.length&&s(ye.FullPaths[Ze])!=At;++Ze);for(ft.C=Ze>=Je.length?-1:Ze,Ze=ce+1;Ze<Je.length&&s(ye.FullPaths[Ze])!=s(At);++Ze);ft.R=Ze>=Je.length?-1:Ze,ft.type=1}else s(ye.FullPaths[ce+1]||"")==s(At)&&(ft.R=ce+1),ft.type=2}}}function F(ye,Le){var se=Le||{};if(se.fileType=="mad")return Ct(ye,se);switch(S(ye),se.fileType){case"zip":return St(ye,se)}var z=function(Nt){for(var kt=0,Ht=0,ir=0;ir<Nt.FileIndex.length;++ir){var Ar=Nt.FileIndex[ir];if(Ar.content){var or=Ar.content.length;or>0&&(or<4096?kt+=or+63>>6:Ht+=or+511>>9)}}for(var ns=Nt.FullPaths.length+3>>2,Ia=kt+7>>3,so=kt+127>>7,li=Ia+Ht+ns+so,Ka=li+127>>7,ot=Ka<=109?0:Math.ceil((Ka-109)/127);li+Ka+ot+127>>7>Ka;)ot=++Ka<=109?0:Math.ceil((Ka-109)/127);var Pt=[1,ot,Ka,so,ns,Ht,kt,0];return Nt.FileIndex[0].size=kt<<6,Pt[7]=(Nt.FileIndex[0].start=Pt[0]+Pt[1]+Pt[2]+Pt[3]+Pt[4]+Pt[5])+(Pt[6]+7>>3),Pt}(ye),ce=It(z[7]<<9),xe=0,Pe=0;{for(xe=0;xe<8;++xe)ce.write_shift(1,te[xe]);for(xe=0;xe<8;++xe)ce.write_shift(2,0);for(ce.write_shift(2,62),ce.write_shift(2,3),ce.write_shift(2,65534),ce.write_shift(2,9),ce.write_shift(2,6),xe=0;xe<3;++xe)ce.write_shift(2,0);for(ce.write_shift(4,0),ce.write_shift(4,z[2]),ce.write_shift(4,z[0]+z[1]+z[2]+z[3]-1),ce.write_shift(4,0),ce.write_shift(4,4096),ce.write_shift(4,z[3]?z[0]+z[1]+z[2]-1:D),ce.write_shift(4,z[3]),ce.write_shift(-4,z[1]?z[0]-1:D),ce.write_shift(4,z[1]),xe=0;xe<109;++xe)ce.write_shift(-4,xe<z[2]?z[1]+xe:-1)}if(z[1])for(Pe=0;Pe<z[1];++Pe){for(;xe<236+Pe*127;++xe)ce.write_shift(-4,xe<z[2]?z[1]+xe:-1);ce.write_shift(-4,Pe===z[1]-1?D:Pe+1)}var Ze=function(Nt){for(Pe+=Nt;xe<Pe-1;++xe)ce.write_shift(-4,xe+1);Nt&&(++xe,ce.write_shift(-4,D))};for(Pe=xe=0,Pe+=z[1];xe<Pe;++xe)ce.write_shift(-4,Q.DIFSECT);for(Pe+=z[2];xe<Pe;++xe)ce.write_shift(-4,Q.FATSECT);Ze(z[3]),Ze(z[4]);for(var Ye=0,Je=0,et=ye.FileIndex[0];Ye<ye.FileIndex.length;++Ye)et=ye.FileIndex[Ye],et.content&&(Je=et.content.length,!(Je<4096)&&(et.start=Pe,Ze(Je+511>>9)));for(Ze(z[6]+7>>3);ce.l&511;)ce.write_shift(-4,Q.ENDOFCHAIN);for(Pe=xe=0,Ye=0;Ye<ye.FileIndex.length;++Ye)et=ye.FileIndex[Ye],et.content&&(Je=et.content.length,!(!Je||Je>=4096)&&(et.start=Pe,Ze(Je+63>>6)));for(;ce.l&511;)ce.write_shift(-4,Q.ENDOFCHAIN);for(xe=0;xe<z[4]<<2;++xe){var ft=ye.FullPaths[xe];if(!ft||ft.length===0){for(Ye=0;Ye<17;++Ye)ce.write_shift(4,0);for(Ye=0;Ye<3;++Ye)ce.write_shift(4,-1);for(Ye=0;Ye<12;++Ye)ce.write_shift(4,0);continue}et=ye.FileIndex[xe],xe===0&&(et.start=et.size?et.start-1:D);var At=xe===0&&se.root||et.name;if(Je=2*(At.length+1),ce.write_shift(64,At,"utf16le"),ce.write_shift(2,Je),ce.write_shift(1,et.type),ce.write_shift(1,et.color),ce.write_shift(-4,et.L),ce.write_shift(-4,et.R),ce.write_shift(-4,et.C),et.clsid)ce.write_shift(16,et.clsid,"hex");else for(Ye=0;Ye<4;++Ye)ce.write_shift(4,0);ce.write_shift(4,et.state||0),ce.write_shift(4,0),ce.write_shift(4,0),ce.write_shift(4,0),ce.write_shift(4,0),ce.write_shift(4,et.start),ce.write_shift(4,et.size),ce.write_shift(4,0)}for(xe=1;xe<ye.FileIndex.length;++xe)if(et=ye.FileIndex[xe],et.size>=4096)if(ce.l=et.start+1<<9,Zr&&Buffer.isBuffer(et.content))et.content.copy(ce,ce.l,0,et.size),ce.l+=et.size+511&-512;else{for(Ye=0;Ye<et.size;++Ye)ce.write_shift(1,et.content[Ye]);for(;Ye&511;++Ye)ce.write_shift(1,0)}for(xe=1;xe<ye.FileIndex.length;++xe)if(et=ye.FileIndex[xe],et.size>0&&et.size<4096)if(Zr&&Buffer.isBuffer(et.content))et.content.copy(ce,ce.l,0,et.size),ce.l+=et.size+63&-64;else{for(Ye=0;Ye<et.size;++Ye)ce.write_shift(1,et.content[Ye]);for(;Ye&63;++Ye)ce.write_shift(1,0)}if(Zr)ce.l=ce.length;else for(;ce.l<ce.length;)ce.write_shift(1,0);return ce}function B(ye,Le){var se=ye.FullPaths.map(function(Ye){return Ye.toUpperCase()}),z=se.map(function(Ye){var Je=Ye.split("/");return Je[Je.length-(Ye.slice(-1)=="/"?2:1)]}),ce=!1;Le.charCodeAt(0)===47?(ce=!0,Le=se[0].slice(0,-1)+Le):ce=Le.indexOf("/")!==-1;var xe=Le.toUpperCase(),Pe=ce===!0?se.indexOf(xe):z.indexOf(xe);if(Pe!==-1)return ye.FileIndex[Pe];var Ze=!xe.match(Ug);for(xe=xe.replace(eo,""),Ze&&(xe=xe.replace(Ug,"!")),Pe=0;Pe<se.length;++Pe)if((Ze?se[Pe].replace(Ug,"!"):se[Pe]).replace(eo,"")==xe||(Ze?z[Pe].replace(Ug,"!"):z[Pe]).replace(eo,"")==xe)return ye.FileIndex[Pe];return null}var k=64,D=-2,q="d0cf11e0a1b11ae1",te=[208,207,17,224,161,177,26,225],W="00000000000000000000000000000000",Q={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:D,FREESECT:-1,HEADER_SIGNATURE:q,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:W,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function re(ye,Le,se){d();var z=F(ye,se);c.writeFileSync(Le,z)}function G(ye){for(var Le=new Array(ye.length),se=0;se<ye.length;++se)Le[se]=String.fromCharCode(ye[se]);return Le.join("")}function Ae(ye,Le){var se=F(ye,Le);switch(Le&&Le.type||"buffer"){case"file":return d(),c.writeFileSync(Le.filename,se),se;case"binary":return typeof se=="string"?se:G(se);case"base64":return dy(typeof se=="string"?se:G(se));case"buffer":if(Zr)return Buffer.isBuffer(se)?se:fu(se);case"array":return typeof se=="string"?Vo(se):se}return se}var he;function I(ye){try{var Le=ye.InflateRaw,se=new Le;if(se._processChunk(new Uint8Array([3,0]),se._finishFlushFlag),se.bytesRead)he=ye;else throw new Error("zlib does not expose bytesRead")}catch(z){console.error("cannot use native zlib: "+(z.message||z))}}function U(ye,Le){if(!he)return ht(ye,Le);var se=he.InflateRaw,z=new se,ce=z._processChunk(ye.slice(ye.l),z._finishFlushFlag);return ye.l+=z.bytesRead,ce}function V(ye){return he?he.deflateRawSync(ye):_e(ye)}var L=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],K=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],fe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ee(ye){var Le=(ye<<1|ye<<11)&139536|(ye<<5|ye<<15)&558144;return(Le>>16|Le>>8|Le)&255}for(var de=typeof Uint8Array<"u",ue=de?new Uint8Array(256):[],Ie=0;Ie<256;++Ie)ue[Ie]=ee(Ie);function Y(ye,Le){var se=ue[ye&255];return Le<=8?se>>>8-Le:(se=se<<8|ue[ye>>8&255],Le<=16?se>>>16-Le:(se=se<<8|ue[ye>>16&255],se>>>24-Le))}function H(ye,Le){var se=Le&7,z=Le>>>3;return(ye[z]|(se<=6?0:ye[z+1]<<8))>>>se&3}function je(ye,Le){var se=Le&7,z=Le>>>3;return(ye[z]|(se<=5?0:ye[z+1]<<8))>>>se&7}function Ce(ye,Le){var se=Le&7,z=Le>>>3;return(ye[z]|(se<=4?0:ye[z+1]<<8))>>>se&15}function oe(ye,Le){var se=Le&7,z=Le>>>3;return(ye[z]|(se<=3?0:ye[z+1]<<8))>>>se&31}function He(ye,Le){var se=Le&7,z=Le>>>3;return(ye[z]|(se<=1?0:ye[z+1]<<8))>>>se&127}function ie(ye,Le,se){var z=Le&7,ce=Le>>>3,xe=(1<<se)-1,Pe=ye[ce]>>>z;return se<8-z||(Pe|=ye[ce+1]<<8-z,se<16-z)||(Pe|=ye[ce+2]<<16-z,se<24-z)||(Pe|=ye[ce+3]<<24-z),Pe&xe}function le(ye,Le,se){var z=Le&7,ce=Le>>>3;return z<=5?ye[ce]|=(se&7)<<z:(ye[ce]|=se<<z&255,ye[ce+1]=(se&7)>>8-z),Le+3}function ae(ye,Le,se){var z=Le&7,ce=Le>>>3;return se=(se&1)<<z,ye[ce]|=se,Le+1}function ve(ye,Le,se){var z=Le&7,ce=Le>>>3;return se<<=z,ye[ce]|=se&255,se>>>=8,ye[ce+1]=se,Le+8}function we(ye,Le,se){var z=Le&7,ce=Le>>>3;return se<<=z,ye[ce]|=se&255,se>>>=8,ye[ce+1]=se&255,ye[ce+2]=se>>>8,Le+16}function De(ye,Le){var se=ye.length,z=2*se>Le?2*se:Le+5,ce=0;if(se>=Le)return ye;if(Zr){var xe=TB(z);if(ye.copy)ye.copy(xe);else for(;ce<ye.length;++ce)xe[ce]=ye[ce];return xe}else if(de){var Pe=new Uint8Array(z);if(Pe.set)Pe.set(ye);else for(;ce<se;++ce)Pe[ce]=ye[ce];return Pe}return ye.length=z,ye}function Ve(ye){for(var Le=new Array(ye),se=0;se<ye;++se)Le[se]=0;return Le}function me(ye,Le,se){var z=1,ce=0,xe=0,Pe=0,Ze=0,Ye=ye.length,Je=de?new Uint16Array(32):Ve(32);for(xe=0;xe<32;++xe)Je[xe]=0;for(xe=Ye;xe<se;++xe)ye[xe]=0;Ye=ye.length;var et=de?new Uint16Array(Ye):Ve(Ye);for(xe=0;xe<Ye;++xe)Je[ce=ye[xe]]++,z<ce&&(z=ce),et[xe]=0;for(Je[0]=0,xe=1;xe<=z;++xe)Je[xe+16]=Ze=Ze+Je[xe-1]<<1;for(xe=0;xe<Ye;++xe)Ze=ye[xe],Ze!=0&&(et[xe]=Je[Ze+16]++);var ft=0;for(xe=0;xe<Ye;++xe)if(ft=ye[xe],ft!=0)for(Ze=Y(et[xe],z)>>z-ft,Pe=(1<<z+4-ft)-1;Pe>=0;--Pe)Le[Ze|Pe<<ft]=ft&15|xe<<4;return z}var Fe=de?new Uint16Array(512):Ve(512),Re=de?new Uint16Array(32):Ve(32);if(!de){for(var Be=0;Be<512;++Be)Fe[Be]=0;for(Be=0;Be<32;++Be)Re[Be]=0}(function(){for(var ye=[],Le=0;Le<32;Le++)ye.push(5);me(ye,Re,32);var se=[];for(Le=0;Le<=143;Le++)se.push(8);for(;Le<=255;Le++)se.push(9);for(;Le<=279;Le++)se.push(7);for(;Le<=287;Le++)se.push(8);me(se,Fe,288)})();var X=function(){for(var Le=de?new Uint8Array(32768):[],se=0,z=0;se<fe.length-1;++se)for(;z<fe[se+1];++z)Le[z]=se;for(;z<32768;++z)Le[z]=29;var ce=de?new Uint8Array(259):[];for(se=0,z=0;se<K.length-1;++se)for(;z<K[se+1];++z)ce[z]=se;function xe(Ze,Ye){for(var Je=0;Je<Ze.length;){var et=Math.min(65535,Ze.length-Je),ft=Je+et==Ze.length;for(Ye.write_shift(1,+ft),Ye.write_shift(2,et),Ye.write_shift(2,~et&65535);et-- >0;)Ye[Ye.l++]=Ze[Je++]}return Ye.l}function Pe(Ze,Ye){for(var Je=0,et=0,ft=de?new Uint16Array(32768):[];et<Ze.length;){var At=Math.min(65535,Ze.length-et);if(At<10){for(Je=le(Ye,Je,+(et+At==Ze.length)),Je&7&&(Je+=8-(Je&7)),Ye.l=Je/8|0,Ye.write_shift(2,At),Ye.write_shift(2,~At&65535);At-- >0;)Ye[Ye.l++]=Ze[et++];Je=Ye.l*8;continue}Je=le(Ye,Je,+(et+At==Ze.length)+2);for(var Nt=0;At-- >0;){var kt=Ze[et];Nt=(Nt<<5^kt)&32767;var Ht=-1,ir=0;if((Ht=ft[Nt])&&(Ht|=et&-32768,Ht>et&&(Ht-=32768),Ht<et))for(;Ze[Ht+ir]==Ze[et+ir]&&ir<250;)++ir;if(ir>2){kt=ce[ir],kt<=22?Je=ve(Ye,Je,ue[kt+1]>>1)-1:(ve(Ye,Je,3),Je+=5,ve(Ye,Je,ue[kt-23]>>5),Je+=3);var Ar=kt<8?0:kt-4>>2;Ar>0&&(we(Ye,Je,ir-K[kt]),Je+=Ar),kt=Le[et-Ht],Je=ve(Ye,Je,ue[kt]>>3),Je-=3;var or=kt<4?0:kt-2>>1;or>0&&(we(Ye,Je,et-Ht-fe[kt]),Je+=or);for(var ns=0;ns<ir;++ns)ft[Nt]=et&32767,Nt=(Nt<<5^Ze[et])&32767,++et;At-=ir-1}else kt<=143?kt=kt+48:Je=ae(Ye,Je,1),Je=ve(Ye,Je,ue[kt]),ft[Nt]=et&32767,++et}Je=ve(Ye,Je,0)-1}return Ye.l=(Je+7)/8|0,Ye.l}return function(Ye,Je){return Ye.length<8?xe(Ye,Je):Pe(Ye,Je)}}();function _e(ye){var Le=It(50+Math.floor(ye.length*1.1)),se=X(ye,Le);return Le.slice(0,se)}var ke=de?new Uint16Array(32768):Ve(32768),lt=de?new Uint16Array(32768):Ve(32768),mt=de?new Uint16Array(128):Ve(128),pt=1,ze=1;function Me(ye,Le){var se=oe(ye,Le)+257;Le+=5;var z=oe(ye,Le)+1;Le+=5;var ce=Ce(ye,Le)+4;Le+=4;for(var xe=0,Pe=de?new Uint8Array(19):Ve(19),Ze=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Ye=1,Je=de?new Uint8Array(8):Ve(8),et=de?new Uint8Array(8):Ve(8),ft=Pe.length,At=0;At<ce;++At)Pe[L[At]]=xe=je(ye,Le),Ye<xe&&(Ye=xe),Je[xe]++,Le+=3;var Nt=0;for(Je[0]=0,At=1;At<=Ye;++At)et[At]=Nt=Nt+Je[At-1]<<1;for(At=0;At<ft;++At)(Nt=Pe[At])!=0&&(Ze[At]=et[Nt]++);var kt=0;for(At=0;At<ft;++At)if(kt=Pe[At],kt!=0){Nt=ue[Ze[At]]>>8-kt;for(var Ht=(1<<7-kt)-1;Ht>=0;--Ht)mt[Nt|Ht<<kt]=kt&7|At<<3}var ir=[];for(Ye=1;ir.length<se+z;)switch(Nt=mt[He(ye,Le)],Le+=Nt&7,Nt>>>=3){case 16:for(xe=3+H(ye,Le),Le+=2,Nt=ir[ir.length-1];xe-- >0;)ir.push(Nt);break;case 17:for(xe=3+je(ye,Le),Le+=3;xe-- >0;)ir.push(0);break;case 18:for(xe=11+He(ye,Le),Le+=7;xe-- >0;)ir.push(0);break;default:ir.push(Nt),Ye<Nt&&(Ye=Nt);break}var Ar=ir.slice(0,se),or=ir.slice(se);for(At=se;At<286;++At)Ar[At]=0;for(At=z;At<30;++At)or[At]=0;return pt=me(Ar,ke,286),ze=me(or,lt,30),Le}function rt(ye,Le){if(ye[0]==3&&!(ye[1]&3))return[JA(Le),2];for(var se=0,z=0,ce=TB(Le||1<<18),xe=0,Pe=ce.length>>>0,Ze=0,Ye=0;!(z&1);){if(z=je(ye,se),se+=3,z>>>1)z>>1==1?(Ze=9,Ye=5):(se=Me(ye,se),Ze=pt,Ye=ze);else{se&7&&(se+=8-(se&7));var Je=ye[se>>>3]|ye[(se>>>3)+1]<<8;if(se+=32,Je>0)for(!Le&&Pe<xe+Je&&(ce=De(ce,xe+Je),Pe=ce.length);Je-- >0;)ce[xe++]=ye[se>>>3],se+=8;continue}for(;;){!Le&&Pe<xe+32767&&(ce=De(ce,xe+32767),Pe=ce.length);var et=ie(ye,se,Ze),ft=z>>>1==1?Fe[et]:ke[et];if(se+=ft&15,ft>>>=4,!(ft>>>8&255))ce[xe++]=ft;else{if(ft==256)break;ft-=257;var At=ft<8?0:ft-4>>2;At>5&&(At=0);var Nt=xe+K[ft];At>0&&(Nt+=ie(ye,se,At),se+=At),et=ie(ye,se,Ye),ft=z>>>1==1?Re[et]:lt[et],se+=ft&15,ft>>>=4;var kt=ft<4?0:ft-2>>1,Ht=fe[ft];for(kt>0&&(Ht+=ie(ye,se,kt),se+=kt),!Le&&Pe<Nt&&(ce=De(ce,Nt+100),Pe=ce.length);xe<Nt;)ce[xe]=ce[xe-Ht],++xe}}}return Le?[ce,se+7>>>3]:[ce.slice(0,xe),se+7>>>3]}function ht(ye,Le){var se=ye.slice(ye.l||0),z=rt(se,Le);return ye.l+=z[1],z[0]}function Qe(ye,Le){if(ye)typeof console<"u"&&console.error(Le);else throw new Error(Le)}function Ge(ye,Le){var se=ye;ti(se,0);var z=[],ce=[],xe={FileIndex:z,FullPaths:ce};C(xe,{root:Le.root});for(var Pe=se.length-4;(se[Pe]!=80||se[Pe+1]!=75||se[Pe+2]!=5||se[Pe+3]!=6)&&Pe>=0;)--Pe;se.l=Pe+4,se.l+=4;var Ze=se.read_shift(2);se.l+=6;var Ye=se.read_shift(4);for(se.l=Ye,Pe=0;Pe<Ze;++Pe){se.l+=20;var Je=se.read_shift(4),et=se.read_shift(4),ft=se.read_shift(2),At=se.read_shift(2),Nt=se.read_shift(2);se.l+=8;var kt=se.read_shift(4),Ht=l(se.slice(se.l+ft,se.l+ft+At));se.l+=ft+At+Nt;var ir=se.l;se.l=kt+4,gt(se,Je,et,xe,Ht),se.l=ir}return xe}function gt(ye,Le,se,z,ce){ye.l+=2;var xe=ye.read_shift(2),Pe=ye.read_shift(2),Ze=o(ye);if(xe&8257)throw new Error("Unsupported ZIP encryption");for(var Ye=ye.read_shift(4),Je=ye.read_shift(4),et=ye.read_shift(4),ft=ye.read_shift(2),At=ye.read_shift(2),Nt="",kt=0;kt<ft;++kt)Nt+=String.fromCharCode(ye[ye.l++]);if(At){var Ht=l(ye.slice(ye.l,ye.l+At));(Ht[21589]||{}).mt&&(Ze=Ht[21589].mt),((ce||{})[21589]||{}).mt&&(Ze=ce[21589].mt)}ye.l+=At;var ir=ye.slice(ye.l,ye.l+Je);switch(Pe){case 8:ir=U(ye,et);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Pe)}var Ar=!1;xe&8&&(Ye=ye.read_shift(4),Ye==134695760&&(Ye=ye.read_shift(4),Ar=!0),Je=ye.read_shift(4),et=ye.read_shift(4)),Je!=Le&&Qe(Ar,"Bad compressed size: "+Le+" != "+Je),et!=se&&Qe(Ar,"Bad uncompressed size: "+se+" != "+et),vr(z,Nt,ir,{unsafe:!0,mt:Ze})}function St(ye,Le){var se=Le||{},z=[],ce=[],xe=It(1),Pe=se.compression?8:0,Ze=0,Ye=0,Je=0,et=0,ft=0,At=ye.FullPaths[0],Nt=At,kt=ye.FileIndex[0],Ht=[],ir=0;for(Ye=1;Ye<ye.FullPaths.length;++Ye)if(Nt=ye.FullPaths[Ye].slice(At.length),kt=ye.FileIndex[Ye],!(!kt.size||!kt.content||Nt=="Sh33tJ5")){var Ar=et,or=It(Nt.length);for(Je=0;Je<Nt.length;++Je)or.write_shift(1,Nt.charCodeAt(Je)&127);or=or.slice(0,or.l),Ht[ft]=one.buf(kt.content,0);var ns=kt.content;Pe==8&&(ns=V(ns)),xe=It(30),xe.write_shift(4,67324752),xe.write_shift(2,20),xe.write_shift(2,Ze),xe.write_shift(2,Pe),kt.mt?i(xe,kt.mt):xe.write_shift(4,0),xe.write_shift(-4,Ht[ft]),xe.write_shift(4,ns.length),xe.write_shift(4,kt.content.length),xe.write_shift(2,or.length),xe.write_shift(2,0),et+=xe.length,z.push(xe),et+=or.length,z.push(or),et+=ns.length,z.push(ns),xe=It(46),xe.write_shift(4,33639248),xe.write_shift(2,0),xe.write_shift(2,20),xe.write_shift(2,Ze),xe.write_shift(2,Pe),xe.write_shift(4,0),xe.write_shift(-4,Ht[ft]),xe.write_shift(4,ns.length),xe.write_shift(4,kt.content.length),xe.write_shift(2,or.length),xe.write_shift(2,0),xe.write_shift(2,0),xe.write_shift(2,0),xe.write_shift(2,0),xe.write_shift(4,0),xe.write_shift(4,Ar),ir+=xe.l,ce.push(xe),ir+=or.length,ce.push(or),++ft}return xe=It(22),xe.write_shift(4,101010256),xe.write_shift(2,0),xe.write_shift(2,0),xe.write_shift(2,ft),xe.write_shift(2,ft),xe.write_shift(4,ir),xe.write_shift(4,et),xe.write_shift(2,0),Va([Va(z),Va(ce),xe])}var Vt={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Kt(ye,Le){if(ye.ctype)return ye.ctype;var se=ye.name||"",z=se.match(/\.([^\.]+)$/);return z&&Vt[z[1]]||Le&&(z=(se=Le).match(/[\.\\]([^\.\\])+$/),z&&Vt[z[1]])?Vt[z[1]]:"application/octet-stream"}function qe(ye){for(var Le=dy(ye),se=[],z=0;z<Le.length;z+=76)se.push(Le.slice(z,z+76));return se.join(`\r
`)+`\r
`}function Xe(ye){var Le=ye.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Je){var et=Je.charCodeAt(0).toString(16).toUpperCase();return"="+(et.length==1?"0"+et:et)});Le=Le.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),Le.charAt(0)==`
`&&(Le="=0D"+Le.slice(1)),Le=Le.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var se=[],z=Le.split(`\r
`),ce=0;ce<z.length;++ce){var xe=z[ce];if(xe.length==0){se.push("");continue}for(var Pe=0;Pe<xe.length;){var Ze=76,Ye=xe.slice(Pe,Pe+Ze);Ye.charAt(Ze-1)=="="?Ze--:Ye.charAt(Ze-2)=="="?Ze-=2:Ye.charAt(Ze-3)=="="&&(Ze-=3),Ye=xe.slice(Pe,Pe+Ze),Pe+=Ze,Pe<xe.length&&(Ye+="="),se.push(Ye)}}return se.join(`\r
`)}function Ke(ye){for(var Le=[],se=0;se<ye.length;++se){for(var z=ye[se];se<=ye.length&&z.charAt(z.length-1)=="=";)z=z.slice(0,z.length-1)+ye[++se];Le.push(z)}for(var ce=0;ce<Le.length;++ce)Le[ce]=Le[ce].replace(/[=][0-9A-Fa-f]{2}/g,function(xe){return String.fromCharCode(parseInt(xe.slice(1),16))});return Vo(Le.join(`\r
`))}function We(ye,Le,se){for(var z="",ce="",xe="",Pe,Ze=0;Ze<10;++Ze){var Ye=Le[Ze];if(!Ye||Ye.match(/^\s*$/))break;var Je=Ye.match(/^(.*?):\s*([^\s].*)$/);if(Je)switch(Je[1].toLowerCase()){case"content-location":z=Je[2].trim();break;case"content-type":xe=Je[2].trim();break;case"content-transfer-encoding":ce=Je[2].trim();break}}switch(++Ze,ce.toLowerCase()){case"base64":Pe=Vo(Zo(Le.slice(Ze).join("")));break;case"quoted-printable":Pe=Ke(Le.slice(Ze));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+ce)}var et=vr(ye,z.slice(se.length),Pe,{unsafe:!0});xe&&(et.ctype=xe)}function Ft(ye,Le){if(G(ye.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var se=Le&&Le.root||"",z=(Zr&&Buffer.isBuffer(ye)?ye.toString("binary"):G(ye)).split(`\r
`),ce=0,xe="";for(ce=0;ce<z.length;++ce)if(xe=z[ce],!!/^Content-Location:/i.test(xe)&&(xe=xe.slice(xe.indexOf("file")),se||(se=xe.slice(0,xe.lastIndexOf("/")+1)),xe.slice(0,se.length)!=se))for(;se.length>0&&(se=se.slice(0,se.length-1),se=se.slice(0,se.lastIndexOf("/")+1),xe.slice(0,se.length)!=se););var Pe=(z[1]||"").match(/boundary="(.*?)"/);if(!Pe)throw new Error("MAD cannot find boundary");var Ze="--"+(Pe[1]||""),Ye=[],Je=[],et={FileIndex:Ye,FullPaths:Je};C(et);var ft,At=0;for(ce=0;ce<z.length;++ce){var Nt=z[ce];Nt!==Ze&&Nt!==Ze+"--"||(At++&&We(et,z.slice(ft,ce),se),ft=ce)}return et}function Ct(ye,Le){var se=Le||{},z=se.boundary||"SheetJS";z="------="+z;for(var ce=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+z.slice(2)+'"',"","",""],xe=ye.FullPaths[0],Pe=xe,Ze=ye.FileIndex[0],Ye=1;Ye<ye.FullPaths.length;++Ye)if(Pe=ye.FullPaths[Ye].slice(xe.length),Ze=ye.FileIndex[Ye],!(!Ze.size||!Ze.content||Pe=="Sh33tJ5")){Pe=Pe.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(ir){return"_x"+ir.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(ir){return"_u"+ir.charCodeAt(0).toString(16)+"_"});for(var Je=Ze.content,et=Zr&&Buffer.isBuffer(Je)?Je.toString("binary"):G(Je),ft=0,At=Math.min(1024,et.length),Nt=0,kt=0;kt<=At;++kt)(Nt=et.charCodeAt(kt))>=32&&Nt<128&&++ft;var Ht=ft>=At*4/5;ce.push(z),ce.push("Content-Location: "+(se.root||"file:///C:/SheetJS/")+Pe),ce.push("Content-Transfer-Encoding: "+(Ht?"quoted-printable":"base64")),ce.push("Content-Type: "+Kt(Ze,Pe)),ce.push(""),ce.push(Ht?Xe(et):qe(et))}return ce.push(z+`--\r
`),ce.join(`\r
`)}function xr(ye){var Le={};return C(Le,ye),Le}function vr(ye,Le,se,z){var ce=z&&z.unsafe;ce||C(ye);var xe=!ce&&Cr.find(ye,Le);if(!xe){var Pe=ye.FullPaths[0];Le.slice(0,Pe.length)==Pe?Pe=Le:(Pe.slice(-1)!="/"&&(Pe+="/"),Pe=(Pe+Le).replace("//","/")),xe={name:n(Le),type:2},ye.FileIndex.push(xe),ye.FullPaths.push(Pe),ce||Cr.utils.cfb_gc(ye)}return xe.content=se,xe.size=se?se.length:0,z&&(z.CLSID&&(xe.clsid=z.CLSID),z.mt&&(xe.mt=z.mt),z.ct&&(xe.ct=z.ct)),xe}function Pr(ye,Le){C(ye);var se=Cr.find(ye,Le);if(se){for(var z=0;z<ye.FileIndex.length;++z)if(ye.FileIndex[z]==se)return ye.FileIndex.splice(z,1),ye.FullPaths.splice(z,1),!0}return!1}function Mr(ye,Le,se){C(ye);var z=Cr.find(ye,Le);if(z){for(var ce=0;ce<ye.FileIndex.length;++ce)if(ye.FileIndex[ce]==z)return ye.FileIndex[ce].name=n(se),ye.FullPaths[ce]=se,!0}return!1}function Jr(ye){S(ye,!0)}return e.find=B,e.read=j,e.parse=u,e.write=Ae,e.writeFile=re,e.utils={cfb_new:xr,cfb_add:vr,cfb_del:Pr,cfb_mov:Mr,cfb_gc:Jr,ReadShift:gx,CheckField:j7,prep_blob:ti,bconcat:Va,use_zlib:I,_deflateRaw:_e,_inflateRaw:ht,consts:Q},e}();function lne(t){return typeof t=="string"?vN(t):Array.isArray(t)?Pse(t):t}function nv(t,e,r){if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=vN(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var s=r=="utf8"?$c(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(s,t);if(typeof Blob<"u"){var n=new Blob([lne(s)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(n,t);if(typeof saveAs<"u")return saveAs(n,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(n);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:t,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=t,o.href=i,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var l=File(t);return l.open("w"),l.encoding="binary",Array.isArray(e)&&(e=gh(e)),l.write(e),l.close(),e}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+t)}function cne(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(s){if(!s.message||!s.message.match(/onstruct/))throw s}throw new Error("Cannot access file "+t)}function Qn(t){for(var e=Object.keys(t),r=[],s=0;s<e.length;++s)Object.prototype.hasOwnProperty.call(t,e[s])&&r.push(e[s]);return r}function LB(t,e){for(var r=[],s=Qn(t),n=0;n!==s.length;++n)r[t[s[n]][e]]==null&&(r[t[s[n]][e]]=s[n]);return r}function wN(t){for(var e=[],r=Qn(t),s=0;s!==r.length;++s)e[t[r[s]]]=r[s];return e}function NN(t){for(var e=[],r=Qn(t),s=0;s!==r.length;++s)e[t[r[s]]]=parseInt(r[s],10);return e}function dne(t){for(var e=[],r=Qn(t),s=0;s!==r.length;++s)e[t[r[s]]]==null&&(e[t[r[s]]]=[]),e[t[r[s]]].push(r[s]);return e}var Zw=new Date(1899,11,30,0,0,0);function _a(t,e){var r=t.getTime(),s=Zw.getTime()+(t.getTimezoneOffset()-Zw.getTimezoneOffset())*6e4;return(r-s)/(24*60*60*1e3)}var n7=new Date,une=Zw.getTime()+(n7.getTimezoneOffset()-Zw.getTimezoneOffset())*6e4,OB=n7.getTimezoneOffset();function CN(t){var e=new Date;return e.setTime(t*24*60*60*1e3+une),e.getTimezoneOffset()!==OB&&e.setTime(e.getTime()+(e.getTimezoneOffset()-OB)*6e4),e}function Ane(t){var e=0,r=0,s=!1,n=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!n)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var i=1;i!=n.length;++i)if(n[i]){switch(r=1,i>3&&(s=!0),n[i].slice(n[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+n[i].slice(n[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(s)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(n[i],10)}return e}var UB=new Date("2017-02-19T19:06:09.000Z"),a7=isNaN(UB.getFullYear())?new Date("2/19/17"):UB,hne=a7.getFullYear()==2017;function pn(t,e){var r=new Date(t);if(hne)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(a7.getFullYear()==1917&&!isNaN(r.getFullYear())){var s=r.getFullYear();return t.indexOf(""+s)>-1||r.setFullYear(r.getFullYear()+100),r}var n=t.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+n[0],+n[1]-1,+n[2],+n[3]||0,+n[4]||0,+n[5]||0);return t.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function Vf(t,e){if(Zr&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return $c(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return $c(zM(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return $c(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return $c(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(i){return r[i]||i})}catch{}for(var s=[],n=0;n!=t.length;++n)s.push(String.fromCharCode(t[n]));return s.join("")}function gn(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=gn(t[r]));return e}function Rn(t,e){for(var r="";r.length<e;)r+=t;return r}function Ac(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,s=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(s))||(s=s.replace(/[(](.*)[)]/,function(n,i){return r=-r,i}),!isNaN(e=Number(s)))?e/r:e}var fne=["january","february","march","april","may","june","july","august","september","october","november","december"];function vp(t){var e=new Date(t),r=new Date(NaN),s=e.getYear(),n=e.getMonth(),i=e.getDate();if(isNaN(i))return r;var o=t.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&fne.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return s<0||s>8099?r:(n>0||i>1)&&s!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var mne=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,s,n){if(t||typeof s=="string")return r.split(s);for(var i=r.split(s),o=[i[0]],l=1;l<i.length;++l)o.push(n),o.push(i[l]);return o}}();function i7(t){return t?t.content&&t.type?Vf(t.content,!0):t.data?Og(t.data):t.asNodeBuffer&&Zr?Og(t.asNodeBuffer().toString("binary")):t.asBinary?Og(t.asBinary()):t._data&&t._data.getContent?Og(Vf(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function o7(t){if(!t)return null;if(t.data)return EB(t.data);if(t.asNodeBuffer&&Zr)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?EB(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function pne(t){return t&&t.name.slice(-4)===".bin"?o7(t):i7(t)}function gl(t,e){for(var r=t.FullPaths||Qn(t.files),s=e.toLowerCase().replace(/[\/]/g,"\\"),n=s.replace(/\\/g,"/"),i=0;i<r.length;++i){var o=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(s==o||n==o)return t.files?t.files[r[i]]:t.FileIndex[i]}return null}function x_(t,e){var r=gl(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function ha(t,e,r){if(!r)return pne(x_(t,e));if(!e)return null;try{return ha(t,e)}catch{return null}}function Ho(t,e,r){if(!r)return i7(x_(t,e));if(!e)return null;try{return Ho(t,e)}catch{return null}}function gne(t,e,r){return o7(x_(t,e))}function MB(t){for(var e=t.FullPaths||Qn(t.files),r=[],s=0;s<e.length;++s)e[s].slice(-1)!="/"&&r.push(e[s].replace(/^Root Entry[\/]/,""));return r.sort()}function Yr(t,e,r){if(t.FullPaths){if(typeof r=="string"){var s;return Zr?s=fu(r):s=Dse(r),Cr.utils.cfb_add(t,e,s)}Cr.utils.cfb_add(t,e,r)}else t.file(e,r)}function y_(){return Cr.utils.cfb_new()}function l7(t,e){switch(e.type){case"base64":return Cr.read(t,{type:"base64"});case"binary":return Cr.read(t,{type:"binary"});case"buffer":case"array":return Cr.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function Mg(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var s=t.split("/");s.length!==0;){var n=s.shift();n===".."?r.pop():n!=="."&&r.push(n)}return r.join("/")}var oa=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,xne=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,QB=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,yne=/<[^>]*>/g,Oi=oa.match(QB)?QB:yne,vne=/<\w*:/,bne=/<(\/?)\w+:/;function Rr(t,e,r){for(var s={},n=0,i=0;n!==t.length&&!((i=t.charCodeAt(n))===32||i===10||i===13);++n);if(e||(s[0]=t.slice(0,n)),n===t.length)return s;var o=t.match(xne),l=0,c="",d=0,u="",A="",h=1;if(o)for(d=0;d!=o.length;++d){for(A=o[d],i=0;i!=A.length&&A.charCodeAt(i)!==61;++i);for(u=A.slice(0,i).trim();A.charCodeAt(i+1)==32;)++i;for(h=(n=A.charCodeAt(i+1))==34||n==39?1:0,c=A.slice(i+1+h,A.length-h),l=0;l!=u.length&&u.charCodeAt(l)!==58;++l);if(l===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),s[u]=c,s[u.toLowerCase()]=c;else{var f=(l===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(l+1);if(s[f]&&u.slice(l-3,l)=="ext")continue;s[f]=c,s[f.toLowerCase()]=c}}return s}function id(t){return t.replace(bne,"<$1")}var c7={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},v_=wN(c7),vs=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(s){var n=s+"",i=n.indexOf("<![CDATA[");if(i==-1)return n.replace(t,function(l,c){return c7[l]||String.fromCharCode(parseInt(c,l.indexOf("x")>-1?16:10))||l}).replace(e,function(l,c){return String.fromCharCode(parseInt(c,16))});var o=n.indexOf("]]>");return r(n.slice(0,i))+n.slice(i+9,o)+r(n.slice(o+3))}}(),b_=/[&<>'"]/g,wne=/[\u0000-\u0008\u000b-\u001f]/g;function Os(t){var e=t+"";return e.replace(b_,function(r){return v_[r]}).replace(wne,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function VB(t){return Os(t).replace(/ /g,"_x0020_")}var d7=/[\u0000-\u001f]/g;function w_(t){var e=t+"";return e.replace(b_,function(r){return v_[r]}).replace(/\n/g,"<br/>").replace(d7,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function Nne(t){var e=t+"";return e.replace(b_,function(r){return v_[r]}).replace(d7,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var HB=function(){var t=/&#(\d+);/g;function e(r,s){return String.fromCharCode(parseInt(s,10))}return function(s){return s.replace(t,e)}}();function Cne(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function un(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function sC(t){for(var e="",r=0,s=0,n=0,i=0,o=0,l=0;r<t.length;){if(s=t.charCodeAt(r++),s<128){e+=String.fromCharCode(s);continue}if(n=t.charCodeAt(r++),s>191&&s<224){o=(s&31)<<6,o|=n&63,e+=String.fromCharCode(o);continue}if(i=t.charCodeAt(r++),s<240){e+=String.fromCharCode((s&15)<<12|(n&63)<<6|i&63);continue}o=t.charCodeAt(r++),l=((s&7)<<18|(n&63)<<12|(i&63)<<6|o&63)-65536,e+=String.fromCharCode(55296+(l>>>10&1023)),e+=String.fromCharCode(56320+(l&1023))}return e}function $B(t){var e=JA(2*t.length),r,s,n=1,i=0,o=0,l;for(s=0;s<t.length;s+=n)n=1,(l=t.charCodeAt(s))<128?r=l:l<224?(r=(l&31)*64+(t.charCodeAt(s+1)&63),n=2):l<240?(r=(l&15)*4096+(t.charCodeAt(s+1)&63)*64+(t.charCodeAt(s+2)&63),n=3):(n=4,r=(l&7)*262144+(t.charCodeAt(s+1)&63)*4096+(t.charCodeAt(s+2)&63)*64+(t.charCodeAt(s+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(e[i++]=o&255,e[i++]=o>>>8,o=0),e[i++]=r%256,e[i++]=r>>>8;return e.slice(0,i).toString("ucs2")}function KB(t){return fu(t,"binary").toString("utf8")}var m1="foo bar baz",Ks=Zr&&(KB(m1)==sC(m1)&&KB||$B(m1)==sC(m1)&&$B)||sC,$c=Zr?function(t){return fu(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,s=0,n=0;r<t.length;)switch(s=t.charCodeAt(r++),!0){case s<128:e.push(String.fromCharCode(s));break;case s<2048:e.push(String.fromCharCode(192+(s>>6))),e.push(String.fromCharCode(128+(s&63)));break;case(s>=55296&&s<57344):s-=55296,n=t.charCodeAt(r++)-56320+(s<<10),e.push(String.fromCharCode(240+(n>>18&7))),e.push(String.fromCharCode(144+(n>>12&63))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)));break;default:e.push(String.fromCharCode(224+(s>>12))),e.push(String.fromCharCode(128+(s>>6&63))),e.push(String.fromCharCode(128+(s&63)))}return e.join("")},Ay=function(){var t={};return function(r,s){var n=r+"|"+(s||"");return t[n]?t[n]:t[n]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",s||"")}}(),u7=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var s=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),n=0;n<t.length;++n)s=s.replace(t[n][0],t[n][1]);return s}}(),jne=function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),Sne=/<\/?(?:vt:)?variant>/g,Ene=/<(?:vt:)([^>]*)>([\s\S]*)</;function zB(t,e){var r=Rr(t),s=t.match(jne(r.baseType))||[],n=[];if(s.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+s.length+" != "+r.size);return n}return s.forEach(function(i){var o=i.replace(Sne,"").match(Ene);o&&n.push({v:Ks(o[2]),t:o[1]})}),n}var A7=/(^\s|\s$|\n)/;function ri(t,e){return"<"+t+(e.match(A7)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function hy(t){return Qn(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function er(t,e,r){return"<"+t+(r!=null?hy(r):"")+(e!=null?(e.match(A7)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function zj(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function _ne(t,e){switch(typeof t){case"string":var r=er("vt:lpwstr",Os(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return er((t|0)==t?"vt:i4":"vt:r8",Os(String(t)));case"boolean":return er("vt:bool",t?"true":"false")}if(t instanceof Date)return er("vt:filetime",zj(t));throw new Error("Unable to serialize "+t)}function N_(t){if(Zr&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return Ks(gh(m_(t)));throw new Error("Bad input format: expected Buffer or string")}var fy=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Na={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},em=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Mo={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function Tne(t,e){for(var r=1-2*(t[e+7]>>>7),s=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),n=t[e+6]&15,i=5;i>=0;--i)n=n*256+t[e+i];return s==2047?n==0?r*(1/0):NaN:(s==0?s=-1022:(s-=1023,n+=Math.pow(2,52)),r*Math.pow(2,s-52)*n)}function Ine(t,e,r){var s=(e<0||1/e==-1/0?1:0)<<7,n=0,i=0,o=s?-e:e;isFinite(o)?o==0?n=i=0:(n=Math.floor(Math.log(o)/Math.LN2),i=o*Math.pow(2,52-n),n<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?n=-1022:(i-=Math.pow(2,52),n+=1023)):(n=2047,i=isNaN(e)?26985:0);for(var l=0;l<=5;++l,i/=256)t[r+l]=i&255;t[r+6]=(n&15)<<4|i&15,t[r+7]=n>>4|s}var qB=function(t){for(var e=[],r=10240,s=0;s<t[0].length;++s)if(t[0][s])for(var n=0,i=t[0][s].length;n<i;n+=r)e.push.apply(e,t[0][s].slice(n,n+r));return e},WB=Zr?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:fu(e)})):qB(t)}:qB,GB=function(t,e,r){for(var s=[],n=e;n<r;n+=2)s.push(String.fromCharCode(Qd(t,n)));return s.join("").replace(eo,"")},C_=Zr?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(eo,""):GB(t,e,r)}:GB,YB=function(t,e,r){for(var s=[],n=e;n<e+r;++n)s.push(("0"+t[n].toString(16)).slice(-2));return s.join("")},h7=Zr?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):YB(t,e,r)}:YB,XB=function(t,e,r){for(var s=[],n=e;n<r;n++)s.push(String.fromCharCode(Zm(t,n)));return s.join("")},av=Zr?function(e,r,s){return Buffer.isBuffer(e)?e.toString("utf8",r,s):XB(e,r,s)}:XB,f7=function(t,e){var r=Qo(t,e);return r>0?av(t,e+4,e+4+r-1):""},m7=f7,p7=function(t,e){var r=Qo(t,e);return r>0?av(t,e+4,e+4+r-1):""},g7=p7,x7=function(t,e){var r=2*Qo(t,e);return r>0?av(t,e+4,e+4+r-1):""},y7=x7,v7=function(e,r){var s=Qo(e,r);return s>0?C_(e,r+4,r+4+s):""},b7=v7,w7=function(t,e){var r=Qo(t,e);return r>0?av(t,e+4,e+4+r):""},N7=w7,C7=function(t,e){return Tne(t,e)},e2=C7,j_=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Zr&&(m7=function(e,r){if(!Buffer.isBuffer(e))return f7(e,r);var s=e.readUInt32LE(r);return s>0?e.toString("utf8",r+4,r+4+s-1):""},g7=function(e,r){if(!Buffer.isBuffer(e))return p7(e,r);var s=e.readUInt32LE(r);return s>0?e.toString("utf8",r+4,r+4+s-1):""},y7=function(e,r){if(!Buffer.isBuffer(e))return x7(e,r);var s=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+s-1)},b7=function(e,r){if(!Buffer.isBuffer(e))return v7(e,r);var s=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+s)},N7=function(e,r){if(!Buffer.isBuffer(e))return w7(e,r);var s=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+s)},e2=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):C7(e,r)},j_=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Zm=function(t,e){return t[e]},Qd=function(t,e){return t[e+1]*256+t[e]},kne=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},Qo=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},Wh=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},Bne=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function gx(t,e){var r="",s,n,i=[],o,l,c,d;switch(e){case"dbcs":if(d=this.l,Zr&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(c=0;c<t;++c)r+=String.fromCharCode(Qd(this,d)),d+=2;t*=2;break;case"utf8":r=av(this,this.l,this.l+t);break;case"utf16le":t*=2,r=C_(this,this.l,this.l+t);break;case"wstr":return gx.call(this,t,"dbcs");case"lpstr-ansi":r=m7(this,this.l),t=4+Qo(this,this.l);break;case"lpstr-cp":r=g7(this,this.l),t=4+Qo(this,this.l);break;case"lpwstr":r=y7(this,this.l),t=4+2*Qo(this,this.l);break;case"lpp4":t=4+Qo(this,this.l),r=b7(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+Qo(this,this.l),r=N7(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(o=Zm(this,this.l+t++))!==0;)i.push(f1(o));r=i.join("");break;case"_wstr":for(t=0,r="";(o=Qd(this,this.l+t))!==0;)i.push(f1(o)),t+=2;t+=2,r=i.join("");break;case"dbcs-cont":for(r="",d=this.l,c=0;c<t;++c){if(this.lens&&this.lens.indexOf(d)!==-1)return o=Zm(this,d),this.l=d+1,l=gx.call(this,t-c,o?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(f1(Qd(this,d))),d+=2}r=i.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",d=this.l,c=0;c!=t;++c){if(this.lens&&this.lens.indexOf(d)!==-1)return o=Zm(this,d),this.l=d+1,l=gx.call(this,t-c,o?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(f1(Zm(this,d))),d+=1}r=i.join("");break;default:switch(t){case 1:return s=Zm(this,this.l),this.l++,s;case 2:return s=(e==="i"?kne:Qd)(this,this.l),this.l+=2,s;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(s=(t>0?Wh:Bne)(this,this.l),this.l+=4,s):(n=Qo(this,this.l),this.l+=4,n);case 8:case-8:if(e==="f")return t==8?n=e2(this,this.l):n=e2([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,n;t=8;case 16:r=h7(this,this.l,t);break}}return this.l+=t,r}var Fne=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},Pne=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},Dne=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function Rne(t,e,r){var s=0,n=0;if(r==="dbcs"){for(n=0;n!=e.length;++n)Dne(this,e.charCodeAt(n),this.l+2*n);s=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),n=0;n!=e.length;++n)this[this.l+n]=e.charCodeAt(n)&255;s=e.length}else if(r==="hex"){for(;n<t;++n)this[this.l++]=parseInt(e.slice(2*n,2*n+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+t,this.length);for(n=0;n<Math.min(e.length,t);++n){var o=e.charCodeAt(n);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(t){case 1:s=1,this[this.l]=e&255;break;case 2:s=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:s=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:s=4,Fne(this,e,this.l);break;case 8:if(s=8,r==="f"){Ine(this,e,this.l);break}case 16:break;case-4:s=4,Pne(this,e,this.l);break}return this.l+=s,this}function j7(t,e){var r=h7(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function ti(t,e){t.l=e,t.read_shift=gx,t.chk=j7,t.write_shift=Rne}function Ri(t,e){t.l+=e}function It(t){var e=JA(t);return ti(e,0),e}function mu(t,e,r){if(t){var s,n,i;ti(t,t.l||0);for(var o=t.length,l=0,c=0;t.l<o;){l=t.read_shift(1),l&128&&(l=(l&127)+((t.read_shift(1)&127)<<7));var d=vy[l]||vy[65535];for(s=t.read_shift(1),i=s&127,n=1;n<4&&s&128;++n)i+=((s=t.read_shift(1))&127)<<7*n;c=t.l+i;var u=d.f&&d.f(t,i,r);if(t.l=c,e(u,d,l))return}}}function jo(){var t=[],e=Zr?256:2048,r=function(d){var u=It(d);return ti(u,0),u},s=r(e),n=function(){s&&(s.length>s.l&&(s=s.slice(0,s.l),s.l=s.length),s.length>0&&t.push(s),s=null)},i=function(d){return s&&d<s.length-s.l?s:(n(),s=r(Math.max(d+1,e)))},o=function(){return n(),Va(t)},l=function(d){n(),s=d,s.l==null&&(s.l=s.length),i(e)};return{next:i,push:l,end:o,_bufs:t}}function Mt(t,e,r,s){var n=+e,i;if(!isNaN(n)){s||(s=vy[n].p||(r||[]).length||0),i=1+(n>=128?1:0)+1,s>=128&&++i,s>=16384&&++i,s>=2097152&&++i;var o=t.next(i);n<=127?o.write_shift(1,n):(o.write_shift(1,(n&127)+128),o.write_shift(1,n>>7));for(var l=0;l!=4;++l)if(s>=128)o.write_shift(1,(s&127)+128),s>>=7;else{o.write_shift(1,s);break}s>0&&j_(r)&&t.push(r)}}function xx(t,e,r){var s=gn(t);if(e.s?(s.cRel&&(s.c+=e.s.c),s.rRel&&(s.r+=e.s.r)):(s.cRel&&(s.c+=e.c),s.rRel&&(s.r+=e.r)),!r||r.biff<12){for(;s.c>=256;)s.c-=256;for(;s.r>=65536;)s.r-=65536}return s}function JB(t,e,r){var s=gn(t);return s.s=xx(s.s,e.s,r),s.e=xx(s.e,e.s,r),s}function yx(t,e){if(t.cRel&&t.c<0)for(t=gn(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=gn(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=Fr(t);return!t.cRel&&t.cRel!=null&&(r=Une(r)),!t.rRel&&t.rRel!=null&&(r=Lne(r)),r}function nC(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+Sn(t.s.c)+":"+(t.e.cRel?"":"$")+Sn(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+na(t.s.r)+":"+(t.e.rRel?"":"$")+na(t.e.r):yx(t.s,e.biff)+":"+yx(t.e,e.biff)}function S_(t){return parseInt(One(t),10)-1}function na(t){return""+(t+1)}function Lne(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function One(t){return t.replace(/\$(\d+)$/,"$1")}function E_(t){for(var e=Mne(t),r=0,s=0;s!==e.length;++s)r=26*r+e.charCodeAt(s)-64;return r-1}function Sn(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function Une(t){return t.replace(/^([A-Z])/,"$$$1")}function Mne(t){return t.replace(/^\$([A-Z])/,"$1")}function Qne(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function En(t){for(var e=0,r=0,s=0;s<t.length;++s){var n=t.charCodeAt(s);n>=48&&n<=57?e=10*e+(n-48):n>=65&&n<=90&&(r=26*r+(n-64))}return{c:r-1,r:e-1}}function Fr(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function So(t){var e=t.indexOf(":");return e==-1?{s:En(t),e:En(t)}:{s:En(t.slice(0,e)),e:En(t.slice(e+1))}}function Gr(t,e){return typeof e>"u"||typeof e=="number"?Gr(t.s,t.e):(typeof t!="string"&&(t=Fr(t)),typeof e!="string"&&(e=Fr(e)),t==e?t:t+":"+e)}function bs(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,s=0,n=0,i=t.length;for(r=0;s<i&&!((n=t.charCodeAt(s)-64)<1||n>26);++s)r=26*r+n;for(e.s.c=--r,r=0;s<i&&!((n=t.charCodeAt(s)-48)<0||n>9);++s)r=10*r+n;if(e.s.r=--r,s===i||n!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++s,r=0;s!=i&&!((n=t.charCodeAt(s)-64)<1||n>26);++s)r=26*r+n;for(e.e.c=--r,r=0;s!=i&&!((n=t.charCodeAt(s)-48)<0||n>9);++s)r=10*r+n;return e.e.r=--r,e}function ZB(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=Ll(t.z,r?_a(e):e)}catch{}try{return t.w=Ll((t.XF||{}).numFmtId||(r?14:0),r?_a(e):e)}catch{return""+e}}function iu(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?pu[t.v]||t.v:e==null?ZB(t,t.v):ZB(t,e))}function xh(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",s={};return s[r]=t,{SheetNames:[r],Sheets:s}}function S7(t,e,r){var s=r||{},n=t?Array.isArray(t):s.dense,i=t||(n?[]:{}),o=0,l=0;if(i&&s.origin!=null){if(typeof s.origin=="number")o=s.origin;else{var c=typeof s.origin=="string"?En(s.origin):s.origin;o=c.r,l=c.c}i["!ref"]||(i["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var u=bs(i["!ref"]);d.s.c=u.s.c,d.s.r=u.s.r,d.e.c=Math.max(d.e.c,u.e.c),d.e.r=Math.max(d.e.r,u.e.r),o==-1&&(d.e.r=o=u.e.r+1)}for(var A=0;A!=e.length;++A)if(e[A]){if(!Array.isArray(e[A]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=e[A].length;++h)if(!(typeof e[A][h]>"u")){var f={v:e[A][h]},p=o+A,m=l+h;if(d.s.r>p&&(d.s.r=p),d.s.c>m&&(d.s.c=m),d.e.r<p&&(d.e.r=p),d.e.c<m&&(d.e.c=m),e[A][h]&&typeof e[A][h]=="object"&&!Array.isArray(e[A][h])&&!(e[A][h]instanceof Date))f=e[A][h];else if(Array.isArray(f.v)&&(f.f=e[A][h][1],f.v=f.v[0]),f.v===null)if(f.f)f.t="n";else if(s.nullError)f.t="e",f.v=0;else if(s.sheetStubs)f.t="z";else continue;else typeof f.v=="number"?f.t="n":typeof f.v=="boolean"?f.t="b":f.v instanceof Date?(f.z=s.dateNF||Ir[14],s.cellDates?(f.t="d",f.w=Ll(f.z,_a(f.v))):(f.t="n",f.v=_a(f.v),f.w=Ll(f.z,f.v))):f.t="s";if(n)i[p]||(i[p]=[]),i[p][m]&&i[p][m].z&&(f.z=i[p][m].z),i[p][m]=f;else{var g=Fr({c:m,r:p});i[g]&&i[g].z&&(f.z=i[g].z),i[g]=f}}}return d.s.c<1e7&&(i["!ref"]=Gr(d)),i}function Op(t,e){return S7(null,t,e)}function Vne(t){return t.read_shift(4,"i")}function hc(t,e){return e||(e=It(4)),e.write_shift(4,t),e}function Fi(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function Ha(t,e){var r=!1;return e==null&&(r=!0,e=It(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function Hne(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function $ne(t,e){return e||(e=It(4)),e.write_shift(2,0),e.write_shift(2,0),e}function __(t,e){var r=t.l,s=t.read_shift(1),n=Fi(t),i=[],o={t:n,h:n};if(s&1){for(var l=t.read_shift(4),c=0;c!=l;++c)i.push(Hne(t));o.r=i}else o.r=[{ich:0,ifnt:0}];return t.l=r+e,o}function Kne(t,e){var r=!1;return e==null&&(r=!0,e=It(15+4*t.t.length)),e.write_shift(1,0),Ha(t.t,e),r?e.slice(0,e.l):e}var zne=__;function qne(t,e){var r=!1;return e==null&&(r=!0,e=It(23+4*t.t.length)),e.write_shift(1,1),Ha(t.t,e),e.write_shift(4,1),$ne({},e),r?e.slice(0,e.l):e}function Ol(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function tm(t,e){return e==null&&(e=It(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function rm(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function sm(t,e){return e==null&&(e=It(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var Wne=Fi,E7=Ha;function T_(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function t2(t,e){var r=!1;return e==null&&(r=!0,e=It(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var Gne=Fi,qj=T_,I_=t2;function k_(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,s=e[0]&2;t.l+=4;var n=s===0?e2([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):Wh(e,0)>>2;return r?n/100:n}function _7(t,e){e==null&&(e=It(4));var r=0,s=0,n=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?s=1:n==(n|0)&&n>=-536870912&&n<1<<29&&(s=1,r=1),s)e.write_shift(-4,((r?n:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function T7(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function Yne(t,e){return e||(e=It(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var nm=T7,Up=Yne;function _i(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function Hf(t,e){return(e||It(8)).write_shift(8,t,"f")}function Xne(t){var e={},r=t.read_shift(1),s=r>>>1,n=t.read_shift(1),i=t.read_shift(2,"i"),o=t.read_shift(1),l=t.read_shift(1),c=t.read_shift(1);switch(t.l++,s){case 0:e.auto=1;break;case 1:e.index=n;var d=ff[n];d&&(e.rgb=py(d));break;case 2:e.rgb=py([o,l,c]);break;case 3:e.theme=n;break}return i!=0&&(e.tint=i>0?i/32767:i/32768),e}function r2(t,e){if(e||(e=It(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var s=t.rgb||"FFFFFF";typeof s=="number"&&(s=("000000"+s.toString(16)).slice(-6)),e.write_shift(1,parseInt(s.slice(0,2),16)),e.write_shift(1,parseInt(s.slice(2,4),16)),e.write_shift(1,parseInt(s.slice(4,6),16)),e.write_shift(1,255)}return e}function Jne(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function Zne(t,e){e||(e=It(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}function I7(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},s=t.read_shift(4);switch(s){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(s>400)throw new Error("Unsupported Clipboard: "+s.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function eae(t){return I7(t,1)}function tae(t){return I7(t,2)}var B_=2,Ao=3,p1=11,eF=12,s2=19,g1=64,rae=65,sae=71,nae=4108,aae=4126,Oa=80,k7=81,iae=[Oa,k7],Wj={1:{n:"CodePage",t:B_},2:{n:"Category",t:Oa},3:{n:"PresentationFormat",t:Oa},4:{n:"ByteCount",t:Ao},5:{n:"LineCount",t:Ao},6:{n:"ParagraphCount",t:Ao},7:{n:"SlideCount",t:Ao},8:{n:"NoteCount",t:Ao},9:{n:"HiddenCount",t:Ao},10:{n:"MultimediaClipCount",t:Ao},11:{n:"ScaleCrop",t:p1},12:{n:"HeadingPairs",t:nae},13:{n:"TitlesOfParts",t:aae},14:{n:"Manager",t:Oa},15:{n:"Company",t:Oa},16:{n:"LinksUpToDate",t:p1},17:{n:"CharacterCount",t:Ao},19:{n:"SharedDoc",t:p1},22:{n:"HyperlinksChanged",t:p1},23:{n:"AppVersion",t:Ao,p:"version"},24:{n:"DigSig",t:rae},26:{n:"ContentType",t:Oa},27:{n:"ContentStatus",t:Oa},28:{n:"Language",t:Oa},29:{n:"Version",t:Oa},255:{},2147483648:{n:"Locale",t:s2},2147483651:{n:"Behavior",t:s2},1919054434:{}},Gj={1:{n:"CodePage",t:B_},2:{n:"Title",t:Oa},3:{n:"Subject",t:Oa},4:{n:"Author",t:Oa},5:{n:"Keywords",t:Oa},6:{n:"Comments",t:Oa},7:{n:"Template",t:Oa},8:{n:"LastAuthor",t:Oa},9:{n:"RevNumber",t:Oa},10:{n:"EditTime",t:g1},11:{n:"LastPrinted",t:g1},12:{n:"CreatedDate",t:g1},13:{n:"ModifiedDate",t:g1},14:{n:"PageCount",t:Ao},15:{n:"WordCount",t:Ao},16:{n:"CharCount",t:Ao},17:{n:"Thumbnail",t:sae},18:{n:"Application",t:Oa},19:{n:"DocSecurity",t:Ao},255:{},2147483648:{n:"Locale",t:s2},2147483651:{n:"Behavior",t:s2},1919054434:{}},tF={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},oae=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function lae(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var cae=lae([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),ff=gn(cae),pu={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},B7={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Yj={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},x1={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function F_(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function dae(t){var e=F_();if(!t||!t.match)return e;var r={};if((t.match(Oi)||[]).forEach(function(s){var n=Rr(s);switch(n[0].replace(vne,"<")){case"<?xml":break;case"<Types":e.xmlns=n["xmlns"+(n[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[n.Extension]=n.ContentType;break;case"<Override":e[Yj[n.ContentType]]!==void 0&&e[Yj[n.ContentType]].push(n.PartName);break}}),e.xmlns!==Na.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}function F7(t,e){var r=dne(Yj),s=[],n;s[s.length]=oa,s[s.length]=er("Types",null,{xmlns:Na.CT,"xmlns:xsd":Na.xsd,"xmlns:xsi":Na.xsi}),s=s.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return er("Default",null,{Extension:c[0],ContentType:c[1]})}));var i=function(c){t[c]&&t[c].length>0&&(n=t[c][0],s[s.length]=er("Override",null,{PartName:(n[0]=="/"?"":"/")+n,ContentType:x1[c][e.bookType]||x1[c].xlsx}))},o=function(c){(t[c]||[]).forEach(function(d){s[s.length]=er("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:x1[c][e.bookType]||x1[c].xlsx})})},l=function(c){(t[c]||[]).forEach(function(d){s[s.length]=er("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:r[c][0]})})};return i("workbooks"),o("sheets"),o("charts"),l("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),o("metadata"),l("people"),s.length>2&&(s[s.length]="</Types>",s[1]=s[1].replace("/>",">")),s.join("")}var ts={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function my(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function vx(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var s={};return(t.match(Oi)||[]).forEach(function(n){var i=Rr(n);if(i[0]==="<Relationship"){var o={};o.Type=i.Type,o.Target=i.Target,o.Id=i.Id,i.TargetMode&&(o.TargetMode=i.TargetMode);var l=i.TargetMode==="External"?i.Target:Mg(i.Target,e);r[l]=o,s[i.Id]=o}}),r["!id"]=s,r}function U0(t){var e=[oa,er("Relationships",null,{xmlns:Na.RELS})];return Qn(t["!id"]).forEach(function(r){e[e.length]=er("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function Ds(t,e,r,s,n,i){if(n||(n={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,n.Id="rId"+e,n.Type=s,n.Target=r,[ts.HLINK,ts.XPATH,ts.XMISS].indexOf(n.Type)>-1&&(n.TargetMode="External"),t["!id"][n.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][n.Id]=n,t[("/"+n.Target).replace("//","/")]=n,e}var uae="application/vnd.oasis.opendocument.spreadsheet";function Aae(t,e){for(var r=N_(t),s,n;s=fy.exec(r);)switch(s[3]){case"manifest":break;case"file-entry":if(n=Rr(s[0],!1),n.path=="/"&&n.type!==uae)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw s}}function hae(t){var e=[oa];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function rF(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function fae(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function mae(t){var e=[oa];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(rF(t[r][0],t[r][1])),e.push(fae("",t[r][0]));return e.push(rF("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function P7(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Gw.version+"</meta:generator></office:meta></office:document-meta>"}var kl=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],pae=function(){for(var t=new Array(kl.length),e=0;e<kl.length;++e){var r=kl[e],s="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+s+"[^>]*>([\\s\\S]*?)</"+s+">")}return t}();function D7(t){var e={};t=Ks(t);for(var r=0;r<kl.length;++r){var s=kl[r],n=t.match(pae[r]);n!=null&&n.length>0&&(e[s[1]]=vs(n[1])),s[2]==="date"&&e[s[1]]&&(e[s[1]]=pn(e[s[1]]))}return e}function aC(t,e,r,s,n){n[t]!=null||e==null||e===""||(n[t]=e,e=Os(e),s[s.length]=r?er(t,e,r):ri(t,e))}function R7(t,e){var r=e||{},s=[oa,er("cp:coreProperties",null,{"xmlns:cp":Na.CORE_PROPS,"xmlns:dc":Na.dc,"xmlns:dcterms":Na.dcterms,"xmlns:dcmitype":Na.dcmitype,"xmlns:xsi":Na.xsi})],n={};if(!t&&!r.Props)return s.join("");t&&(t.CreatedDate!=null&&aC("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:zj(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},s,n),t.ModifiedDate!=null&&aC("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:zj(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},s,n));for(var i=0;i!=kl.length;++i){var o=kl[i],l=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:t?t[o[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&aC(o[0],l,null,s,n)}return s.length>2&&(s[s.length]="</cp:coreProperties>",s[1]=s[1].replace("/>",">")),s.join("")}var mf=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],L7=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function O7(t,e,r,s){var n=[];if(typeof t=="string")n=zB(t,s);else for(var i=0;i<t.length;++i)n=n.concat(t[i].map(function(u){return{v:u}}));var o=typeof e=="string"?zB(e,s).map(function(u){return u.v}):e,l=0,c=0;if(o.length>0)for(var d=0;d!==n.length;d+=2){switch(c=+n[d+1].v,n[d].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=o.slice(l,l+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=c,r.DefinedNames=o.slice(l,l+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=o.slice(l,l+c);break}l+=c}}function gae(t,e,r){var s={};return e||(e={}),t=Ks(t),mf.forEach(function(n){var i=(t.match(Ay(n[0]))||[])[1];switch(n[2]){case"string":i&&(e[n[1]]=vs(i));break;case"bool":e[n[1]]=i==="true";break;case"raw":var o=t.match(new RegExp("<"+n[0]+"[^>]*>([\\s\\S]*?)</"+n[0]+">"));o&&o.length>0&&(s[n[1]]=o[1]);break}}),s.HeadingPairs&&s.TitlesOfParts&&O7(s.HeadingPairs,s.TitlesOfParts,e,r),e}function U7(t){var e=[],r=er;return t||(t={}),t.Application="SheetJS",e[e.length]=oa,e[e.length]=er("Properties",null,{xmlns:Na.EXT_PROPS,"xmlns:vt":Na.vt}),mf.forEach(function(s){if(t[s[1]]!==void 0){var n;switch(s[2]){case"string":n=Os(String(t[s[1]]));break;case"bool":n=t[s[1]]?"true":"false";break}n!==void 0&&(e[e.length]=r(s[0],n))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(s){return"<vt:lpstr>"+Os(s)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var xae=/<[^>]+>[^<]*/g;function yae(t,e){var r={},s="",n=t.match(xae);if(n)for(var i=0;i!=n.length;++i){var o=n[i],l=Rr(o);switch(l[0]){case"<?xml":break;case"<Properties":break;case"<property":s=vs(l.name);break;case"</property>":s=null;break;default:if(o.indexOf("<vt:")===0){var c=o.split(">"),d=c[0].slice(4),u=c[1];switch(d){case"lpstr":case"bstr":case"lpwstr":r[s]=vs(u);break;case"bool":r[s]=un(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[s]=parseInt(u,10);break;case"r4":case"r8":case"decimal":r[s]=parseFloat(u);break;case"filetime":case"date":r[s]=pn(u);break;case"cy":case"error":r[s]=vs(u);break;default:if(d.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",o,d,c)}}else if(o.slice(0,2)!=="</"){if(e.WTF)throw new Error(o)}}}return r}function M7(t){var e=[oa,er("Properties",null,{xmlns:Na.CUST_PROPS,"xmlns:vt":Na.vt})];if(!t)return e.join("");var r=1;return Qn(t).forEach(function(n){++r,e[e.length]=er("property",_ne(t[n]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Os(n)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var Xj={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},iC;function vae(t,e,r){iC||(iC=wN(Xj)),e=iC[e]||e,t[e]=r}function bae(t,e){var r=[];return Qn(Xj).map(function(s){for(var n=0;n<kl.length;++n)if(kl[n][1]==s)return kl[n];for(n=0;n<mf.length;++n)if(mf[n][1]==s)return mf[n];throw s}).forEach(function(s){if(t[s[1]]!=null){var n=e&&e.Props&&e.Props[s[1]]!=null?e.Props[s[1]]:t[s[1]];switch(s[2]){case"date":n=new Date(n).toISOString().replace(/\.\d*Z/,"Z");break}typeof n=="number"?n=String(n):n===!0||n===!1?n=n?"1":"0":n instanceof Date&&(n=new Date(n).toISOString().replace(/\.\d*Z/,"")),r.push(ri(Xj[s[1]]||s[1],n))}}),er("DocumentProperties",r.join(""),{xmlns:Mo.o})}function wae(t,e){var r=["Worksheets","SheetNames"],s="CustomDocumentProperties",n=[];return t&&Qn(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)){for(var o=0;o<kl.length;++o)if(i==kl[o][1])return;for(o=0;o<mf.length;++o)if(i==mf[o][1])return;for(o=0;o<r.length;++o)if(i==r[o])return;var l=t[i],c="string";typeof l=="number"?(c="float",l=String(l)):l===!0||l===!1?(c="boolean",l=l?"1":"0"):l=String(l),n.push(er(VB(i),l,{"dt:dt":c}))}}),e&&Qn(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)&&!(t&&Object.prototype.hasOwnProperty.call(t,i))){var o=e[i],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o instanceof Date?(l="dateTime.tz",o=o.toISOString()):o=String(o),n.push(er(VB(i),o,{"dt:dt":l}))}}),"<"+s+' xmlns="'+Mo.o+'">'+n.join("")+"</"+s+">"}function P_(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function Nae(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,s=r%Math.pow(2,32),n=(r-s)/Math.pow(2,32);s*=1e7,n*=1e7;var i=s/Math.pow(2,32)|0;i>0&&(s=s%Math.pow(2,32),n+=i);var o=It(8);return o.write_shift(4,s),o.write_shift(4,n),o}function Q7(t,e,r){var s=t.l,n=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-s&3;)++t.l;return n}function V7(t,e,r){var s=t.read_shift(0,"lpwstr");return s}function H7(t,e,r){return e===31?V7(t):Q7(t,e,r)}function Jj(t,e,r){return H7(t,e,r===!1?0:4)}function Cae(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return H7(t,e,0)}function jae(t){for(var e=t.read_shift(4),r=[],s=0;s!=e;++s){var n=t.l;r[s]=t.read_shift(0,"lpwstr").replace(eo,""),t.l-n&2&&(t.l+=2)}return r}function Sae(t){for(var e=t.read_shift(4),r=[],s=0;s!=e;++s)r[s]=t.read_shift(0,"lpstr-cp").replace(eo,"");return r}function Eae(t){var e=t.l,r=n2(t,k7);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var s=n2(t,Ao);return[r,s]}function _ae(t){for(var e=t.read_shift(4),r=[],s=0;s<e/2;++s)r.push(Eae(t));return r}function sF(t,e){for(var r=t.read_shift(4),s={},n=0;n!=r;++n){var i=t.read_shift(4),o=t.read_shift(4);s[i]=t.read_shift(o,e===1200?"utf16le":"utf8").replace(eo,"").replace(Ug,"!"),e===1200&&o%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),s}function $7(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function Tae(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function n2(t,e,r){var s=t.read_shift(2),n,i=r||{};if(t.l+=2,e!==eF&&s!==e&&iae.indexOf(e)===-1&&!((e&65534)==4126&&(s&65534)==4126))throw new Error("Expected type "+e+" saw "+s);switch(e===eF?s:e){case 2:return n=t.read_shift(2,"i"),i.raw||(t.l+=2),n;case 3:return n=t.read_shift(4,"i"),n;case 11:return t.read_shift(4)!==0;case 19:return n=t.read_shift(4),n;case 30:return Q7(t,s,4).replace(eo,"");case 31:return V7(t);case 64:return P_(t);case 65:return $7(t);case 71:return Tae(t);case 80:return Jj(t,s,!i.raw).replace(eo,"");case 81:return Cae(t,s).replace(eo,"");case 4108:return _ae(t);case 4126:case 4127:return s==4127?jae(t):Sae(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+s)}}function nF(t,e){var r=It(4),s=It(4);switch(r.write_shift(4,t==80?31:t),t){case 3:s.write_shift(-4,e);break;case 5:s=It(8),s.write_shift(8,e,"f");break;case 11:s.write_shift(4,e?1:0);break;case 64:s=Nae(e);break;case 31:case 80:for(s=It(4+2*(e.length+1)+(e.length%2?0:2)),s.write_shift(4,e.length+1),s.write_shift(0,e,"dbcs");s.l!=s.length;)s.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return Va([r,s])}function aF(t,e){var r=t.l,s=t.read_shift(4),n=t.read_shift(4),i=[],o=0,l=0,c=-1,d={};for(o=0;o!=n;++o){var u=t.read_shift(4),A=t.read_shift(4);i[o]=[u,A+r]}i.sort(function(v,x){return v[1]-x[1]});var h={};for(o=0;o!=n;++o){if(t.l!==i[o][1]){var f=!0;if(o>0&&e)switch(e[i[o-1][0]].t){case 2:t.l+2===i[o][1]&&(t.l+=2,f=!1);break;case 80:t.l<=i[o][1]&&(t.l=i[o][1],f=!1);break;case 4108:t.l<=i[o][1]&&(t.l=i[o][1],f=!1);break}if((!e||o==0)&&t.l<=i[o][1]&&(f=!1,t.l=i[o][1]),f)throw new Error("Read Error: Expected address "+i[o][1]+" at "+t.l+" :"+o)}if(e){var p=e[i[o][0]];if(h[p.n]=n2(t,p.t,{raw:!0}),p.p==="version"&&(h[p.n]=String(h[p.n]>>16)+"."+("0000"+String(h[p.n]&65535)).slice(-4)),p.n=="CodePage")switch(h[p.n]){case 0:h[p.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:oc(l=h[p.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[p.n])}}else if(i[o][0]===1){if(l=h.CodePage=n2(t,B_),oc(l),c!==-1){var m=t.l;t.l=i[c][1],d=sF(t,l),t.l=m}}else if(i[o][0]===0){if(l===0){c=o,t.l=i[o+1][1];continue}d=sF(t,l)}else{var g=d[i[o][0]],y;switch(t[t.l]){case 65:t.l+=4,y=$7(t);break;case 30:t.l+=4,y=Jj(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,y=Jj(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,y=t.read_shift(4,"i");break;case 19:t.l+=4,y=t.read_shift(4);break;case 5:t.l+=4,y=t.read_shift(8,"f");break;case 11:t.l+=4,y=Kn(t,4);break;case 64:t.l+=4,y=pn(P_(t));break;default:throw new Error("unparsed value: "+t[t.l])}h[g]=y}}return t.l=r+s,h}var K7=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function Iae(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function iF(t,e,r){var s=It(8),n=[],i=[],o=8,l=0,c=It(8),d=It(8);if(c.write_shift(4,2),c.write_shift(4,1200),d.write_shift(4,1),i.push(c),n.push(d),o+=8+c.length,!e){d=It(8),d.write_shift(4,0),n.unshift(d);var u=[It(4)];for(u[0].write_shift(4,t.length),l=0;l<t.length;++l){var A=t[l][0];for(c=It(8+2*(A.length+1)+(A.length%2?0:2)),c.write_shift(4,l+2),c.write_shift(4,A.length+1),c.write_shift(0,A,"dbcs");c.l!=c.length;)c.write_shift(1,0);u.push(c)}c=Va(u),i.unshift(c),o+=8+c.length}for(l=0;l<t.length;++l)if(!(e&&!e[t[l][0]])&&!(K7.indexOf(t[l][0])>-1||L7.indexOf(t[l][0])>-1)&&t[l][1]!=null){var h=t[l][1],f=0;if(e){f=+e[t[l][0]];var p=r[f];if(p.p=="version"&&typeof h=="string"){var m=h.split(".");h=(+m[0]<<16)+(+m[1]||0)}c=nF(p.t,h)}else{var g=Iae(h);g==-1&&(g=31,h=String(h)),c=nF(g,h)}i.push(c),d=It(8),d.write_shift(4,e?f:2+l),n.push(d),o+=8+c.length}var y=8*(i.length+1);for(l=0;l<i.length;++l)n[l].write_shift(4,y),y+=i[l].length;return s.write_shift(4,o),s.write_shift(4,i.length),Va([s].concat(n).concat(i))}function oF(t,e,r){var s=t.content;if(!s)return{};ti(s,0);var n,i,o,l,c=0;s.chk("feff","Byte Order: "),s.read_shift(2);var d=s.read_shift(4),u=s.read_shift(16);if(u!==Cr.utils.consts.HEADER_CLSID&&u!==r)throw new Error("Bad PropertySet CLSID "+u);if(n=s.read_shift(4),n!==1&&n!==2)throw new Error("Unrecognized #Sets: "+n);if(i=s.read_shift(16),l=s.read_shift(4),n===1&&l!==s.l)throw new Error("Length mismatch: "+l+" !== "+s.l);n===2&&(o=s.read_shift(16),c=s.read_shift(4));var A=aF(s,e),h={SystemIdentifier:d};for(var f in A)h[f]=A[f];if(h.FMTID=i,n===1)return h;if(c-s.l==2&&(s.l+=2),s.l!==c)throw new Error("Length mismatch 2: "+s.l+" !== "+c);var p;try{p=aF(s,null)}catch{}for(f in p)h[f]=p[f];return h.FMTID=[i,o],h}function lF(t,e,r,s,n,i){var o=It(n?68:48),l=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,Cr.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,n?2:1),o.write_shift(16,e,"hex"),o.write_shift(4,n?68:48);var c=iF(t,r,s);if(l.push(c),n){var d=iF(n,null,null);o.write_shift(16,i,"hex"),o.write_shift(4,68+c.length),l.push(d)}return Va(l)}function zu(t,e){return t.read_shift(e),null}function kae(t,e){e||(e=It(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function Bae(t,e,r){for(var s=[],n=t.l+e;t.l<n;)s.push(r(t,n-t.l));if(n!==t.l)throw new Error("Slurp error");return s}function Kn(t,e){return t.read_shift(e)===1}function zi(t,e){return e||(e=It(2)),e.write_shift(2,+!!t),e}function fa(t){return t.read_shift(2,"u")}function vl(t,e){return e||(e=It(2)),e.write_shift(2,t),e}function z7(t,e){return Bae(t,e,fa)}function Fae(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function q7(t,e,r){return r||(r=It(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function iv(t,e,r){var s=t.read_shift(r&&r.biff>=12?2:1),n="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=t.read_shift(1);i&&(n="dbcs-cont")}else r.biff==12&&(n="wstr");r.biff>=2&&r.biff<=5&&(n="cpstr");var o=s?t.read_shift(s,n):"";return o}function Pae(t){var e=t.read_shift(2),r=t.read_shift(1),s=r&4,n=r&8,i=1+(r&1),o=0,l,c={};n&&(o=t.read_shift(2)),s&&(l=t.read_shift(4));var d=i==2?"dbcs-cont":"sbcs-cont",u=e===0?"":t.read_shift(e,d);return n&&(t.l+=4*o),s&&(t.l+=l),c.t=u,n||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function Dae(t){var e=t.t||"",r=It(3);r.write_shift(2,e.length),r.write_shift(1,1);var s=It(2*e.length);s.write_shift(2*e.length,e,"utf16le");var n=[r,s];return Va(n)}function $f(t,e,r){var s;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var n=t.read_shift(1);return n===0?s=t.read_shift(e,"sbcs-cont"):s=t.read_shift(e,"dbcs-cont"),s}function ov(t,e,r){var s=t.read_shift(r&&r.biff==2?1:2);return s===0?(t.l++,""):$f(t,s,r)}function am(t,e,r){if(r.biff>5)return ov(t,e,r);var s=t.read_shift(1);return s===0?(t.l++,""):t.read_shift(s,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function W7(t,e,r){return r||(r=It(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function Rae(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function Lae(t){var e=t.read_shift(4),r=t.l,s=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(s=!0),t.l=r);var n=t.read_shift((s?e-24:e)>>1,"utf16le").replace(eo,"");return s&&(t.l+=24),n}function Oae(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var s=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var n=t.read_shift(4);if(n===0)return r+s.replace(/\\/g,"/");var i=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=t.read_shift(i>>1,"utf16le").replace(eo,"");return r+o}function Uae(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return Lae(t);case"0303000000000000c000000000000046":return Oae(t);default:throw new Error("Unsupported Moniker "+r)}}function y1(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(eo,""):"";return r}function cF(t,e){e||(e=It(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function Mae(t,e){var r=t.l+e,s=t.read_shift(4);if(s!==2)throw new Error("Unrecognized streamVersion: "+s);var n=t.read_shift(2);t.l+=2;var i,o,l,c,d="",u,A;n&16&&(i=y1(t,r-t.l)),n&128&&(o=y1(t,r-t.l)),(n&257)===257&&(l=y1(t,r-t.l)),(n&257)===1&&(c=Uae(t,r-t.l)),n&8&&(d=y1(t,r-t.l)),n&32&&(u=t.read_shift(16)),n&64&&(A=P_(t)),t.l=r;var h=o||l||c||"";h&&d&&(h+="#"+d),h||(h="#"+d),n&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var f={Target:h};return u&&(f.guid=u),A&&(f.time=A),i&&(f.Tooltip=i),f}function Qae(t){var e=It(512),r=0,s=t.Target;s.slice(0,7)=="file://"&&(s=s.slice(7));var n=s.indexOf("#"),i=n>-1?31:23;switch(s.charAt(0)){case"#":i=28;break;case".":i&=-3;break}e.write_shift(4,2),e.write_shift(4,i);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)e.write_shift(4,o[r]);if(i==28)s=s.slice(1),cF(s,e);else if(i&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)e.write_shift(1,parseInt(o[r],16));var l=n>-1?s.slice(0,n):s;for(e.write_shift(4,2*(l.length+1)),r=0;r<l.length;++r)e.write_shift(2,l.charCodeAt(r));e.write_shift(2,0),i&8&&cF(n>-1?s.slice(n+1):"",e)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)e.write_shift(1,parseInt(o[r],16));for(var c=0;s.slice(c*3,c*3+3)=="../"||s.slice(c*3,c*3+3)=="..\\";)++c;for(e.write_shift(2,c),e.write_shift(4,s.length-3*c+1),r=0;r<s.length-3*c;++r)e.write_shift(1,s.charCodeAt(r+3*c)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function G7(t){var e=t.read_shift(1),r=t.read_shift(1),s=t.read_shift(1),n=t.read_shift(1);return[e,r,s,n]}function Y7(t,e){var r=G7(t);return r[3]=0,r}function od(t){var e=t.read_shift(2),r=t.read_shift(2),s=t.read_shift(2);return{r:e,c:r,ixfe:s}}function Kf(t,e,r,s){return s||(s=It(6)),s.write_shift(2,t),s.write_shift(2,e),s.write_shift(2,r||0),s}function Vae(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function Hae(t,e,r){return e===0?"":am(t,e,r)}function $ae(t,e,r){var s=r.biff>8?4:2,n=t.read_shift(s),i=t.read_shift(s,"i"),o=t.read_shift(s,"i");return[n,i,o]}function X7(t){var e=t.read_shift(2),r=k_(t);return[e,r]}function Kae(t,e,r){t.l+=4,e-=4;var s=t.l+e,n=iv(t,e,r),i=t.read_shift(2);if(s-=t.l,i!==s)throw new Error("Malformed AddinUdf: padding = "+s+" != "+i);return t.l+=i,n}function jN(t){var e=t.read_shift(2),r=t.read_shift(2),s=t.read_shift(2),n=t.read_shift(2);return{s:{c:s,r:e},e:{c:n,r}}}function J7(t,e){return e||(e=It(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function Z7(t){var e=t.read_shift(2),r=t.read_shift(2),s=t.read_shift(1),n=t.read_shift(1);return{s:{c:s,r:e},e:{c:n,r}}}var zae=Z7;function e9(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),s=t.read_shift(2);return t.l+=12,[r,e,s]}function qae(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function Wae(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function fi(t){t.l+=2,t.l+=t.read_shift(2)}var Gae={0:fi,4:fi,5:fi,6:fi,7:Wae,8:fi,9:fi,10:fi,11:fi,12:fi,13:qae,14:fi,15:fi,16:fi,17:fi,18:fi,19:fi,20:fi,21:e9};function Yae(t,e){for(var r=t.l+e,s=[];t.l<r;){var n=t.read_shift(2);t.l-=2;try{s.push(Gae[n](t,r-t.l))}catch{return t.l=r,s}}return t.l!=r&&(t.l=r),s}function v1(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function D_(t,e,r){var s=1536,n=16;switch(r.bookType){case"biff8":break;case"biff5":s=1280,n=8;break;case"biff4":s=4,n=6;break;case"biff3":s=3,n=6;break;case"biff2":s=2,n=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=It(n);return i.write_shift(2,s),i.write_shift(2,e),n>4&&i.write_shift(2,29282),n>6&&i.write_shift(2,1997),n>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function Xae(t,e){return e===0||t.read_shift(2),1200}function Jae(t,e,r){if(r.enc)return t.l+=e,"";var s=t.l,n=am(t,0,r);return t.read_shift(e+s-t.l),n}function Zae(t,e){var r=!e||e.biff==8,s=It(r?112:54);for(s.write_shift(e.biff==8?2:1,7),r&&s.write_shift(1,0),s.write_shift(4,859007059),s.write_shift(4,5458548|(r?0:536870912));s.l<s.length;)s.write_shift(1,r?0:32);return s}function eie(t,e,r){var s=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:s&16,fBelow:s&64,fRight:s&128}}function tie(t,e,r){var s=t.read_shift(4),n=t.read_shift(1)&3,i=t.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var o=iv(t,0,r);return o.length===0&&(o="Sheet1"),{pos:s,hs:n,dt:i,name:o}}function rie(t,e){var r=!e||e.biff>=8?2:1,s=It(8+r*t.name.length);s.write_shift(4,t.pos),s.write_shift(1,t.hs||0),s.write_shift(1,t.dt),s.write_shift(1,t.name.length),e.biff>=8&&s.write_shift(1,1),s.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var n=s.slice(0,s.l);return n.l=s.l,n}function sie(t,e){for(var r=t.l+e,s=t.read_shift(4),n=t.read_shift(4),i=[],o=0;o!=n&&t.l<r;++o)i.push(Pae(t));return i.Count=s,i.Unique=n,i}function nie(t,e){var r=It(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var s=[],n=0;n<t.length;++n)s[n]=Dae(t[n]);var i=Va([r].concat(s));return i.parts=[r.length].concat(s.map(function(o){return o.length})),i}function aie(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function iie(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var s=t.read_shift(1);return t.l+=3,s&7&&(e.level=s&7),s&32&&(e.hidden=!0),s&64&&(e.hpt=r/20),e}function oie(t){var e=Vae(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function lie(t){return t.read_shift(2),t.read_shift(4)}function dF(t,e,r){var s=0;r&&r.biff==2||(s=t.read_shift(2));var n=t.read_shift(2);r&&r.biff==2&&(s=1-(n>>15),n&=32767);var i={Unsynced:s&1,DyZero:(s&2)>>1,ExAsc:(s&4)>>2,ExDsc:(s&8)>>3};return[i,n]}function cie(t){var e=t.read_shift(2),r=t.read_shift(2),s=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2),o=t.read_shift(2),l=t.read_shift(2),c=t.read_shift(2),d=t.read_shift(2);return{Pos:[e,r],Dim:[s,n],Flags:i,CurTab:o,FirstTab:l,Selected:c,TabRatio:d}}function die(){var t=It(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function uie(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var s=t.read_shift(2);return{RTL:s&64}}function Aie(t){var e=It(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function hie(){}function fie(t,e,r){var s={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return s.name=iv(t,0,r),s}function mie(t,e){var r=t.name||"Arial",s=e&&e.biff==5,n=s?15+r.length:16+2*r.length,i=It(n);return i.write_shift(2,t.sz*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),s||i.write_shift(1,1),i.write_shift((s?1:2)*r.length,r,s?"sbcs":"utf16le"),i}function pie(t){var e=od(t);return e.isst=t.read_shift(4),e}function gie(t,e,r,s){var n=It(10);return Kf(t,e,s,n),n.write_shift(4,r),n}function xie(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var s=t.l+e,n=od(t);r.biff==2&&t.l++;var i=ov(t,s-t.l,r);return n.val=i,n}function yie(t,e,r,s,n){var i=!n||n.biff==8,o=It(8+ +i+(1+i)*r.length);return Kf(t,e,s,o),o.write_shift(2,r.length),i&&o.write_shift(1,1),o.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),o}function vie(t,e,r){var s=t.read_shift(2),n=am(t,0,r);return[s,n]}function bie(t,e,r,s){var n=r&&r.biff==5;s||(s=It(n?3+e.length:5+2*e.length)),s.write_shift(2,t),s.write_shift(n?1:2,e.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*e.length,e,n?"sbcs":"utf16le");var i=s.length>s.l?s.slice(0,s.l):s;return i.l==null&&(i.l=i.length),i}var wie=am;function uF(t,e,r){var s=t.l+e,n=r.biff==8||!r.biff?4:2,i=t.read_shift(n),o=t.read_shift(n),l=t.read_shift(2),c=t.read_shift(2);return t.l=s,{s:{r:i,c:l},e:{r:o,c}}}function Nie(t,e){var r=e.biff==8||!e.biff?4:2,s=It(2*r+6);return s.write_shift(r,t.s.r),s.write_shift(r,t.e.r+1),s.write_shift(2,t.s.c),s.write_shift(2,t.e.c+1),s.write_shift(2,0),s}function Cie(t){var e=t.read_shift(2),r=t.read_shift(2),s=X7(t);return{r:e,c:r,ixfe:s[0],rknum:s[1]}}function jie(t,e){for(var r=t.l+e-2,s=t.read_shift(2),n=t.read_shift(2),i=[];t.l<r;)i.push(X7(t));if(t.l!==r)throw new Error("MulRK read error");var o=t.read_shift(2);if(i.length!=o-n+1)throw new Error("MulRK length mismatch");return{r:s,c:n,C:o,rkrec:i}}function Sie(t,e){for(var r=t.l+e-2,s=t.read_shift(2),n=t.read_shift(2),i=[];t.l<r;)i.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var o=t.read_shift(2);if(i.length!=o-n+1)throw new Error("MulBlank length mismatch");return{r:s,c:n,C:o,ixfe:i}}function Eie(t,e,r,s){var n={},i=t.read_shift(4),o=t.read_shift(4),l=t.read_shift(4),c=t.read_shift(2);return n.patternType=oae[l>>26],s.cellStyles&&(n.alc=i&7,n.fWrap=i>>3&1,n.alcV=i>>4&7,n.fJustLast=i>>7&1,n.trot=i>>8&255,n.cIndent=i>>16&15,n.fShrinkToFit=i>>20&1,n.iReadOrder=i>>22&2,n.fAtrNum=i>>26&1,n.fAtrFnt=i>>27&1,n.fAtrAlc=i>>28&1,n.fAtrBdr=i>>29&1,n.fAtrPat=i>>30&1,n.fAtrProt=i>>31&1,n.dgLeft=o&15,n.dgRight=o>>4&15,n.dgTop=o>>8&15,n.dgBottom=o>>12&15,n.icvLeft=o>>16&127,n.icvRight=o>>23&127,n.grbitDiag=o>>30&3,n.icvTop=l&127,n.icvBottom=l>>7&127,n.icvDiag=l>>14&127,n.dgDiag=l>>21&15,n.icvFore=c&127,n.icvBack=c>>7&127,n.fsxButton=c>>14&1),n}function _ie(t,e,r){var s={};return s.ifnt=t.read_shift(2),s.numFmtId=t.read_shift(2),s.flags=t.read_shift(2),s.fStyle=s.flags>>2&1,e-=6,s.data=Eie(t,e,s.fStyle,r),s}function AF(t,e,r,s){var n=r&&r.biff==5;s||(s=It(n?16:20)),s.write_shift(2,0),t.style?(s.write_shift(2,t.numFmtId||0),s.write_shift(2,65524)):(s.write_shift(2,t.numFmtId||0),s.write_shift(2,e<<4));var i=0;return t.numFmtId>0&&n&&(i|=1024),s.write_shift(4,i),s.write_shift(4,0),n||s.write_shift(4,0),s.write_shift(2,0),s}function Tie(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function Iie(t){var e=It(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function hF(t,e,r){var s=od(t);(r.biff==2||e==9)&&++t.l;var n=Fae(t);return s.val=n,s.t=n===!0||n===!1?"b":"e",s}function kie(t,e,r,s,n,i){var o=It(8);return Kf(t,e,s,o),q7(r,i,o),o}function Bie(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var s=od(t),n=_i(t);return s.val=n,s}function Fie(t,e,r,s){var n=It(14);return Kf(t,e,s,n),Hf(r,n),n}var fF=Hae;function Pie(t,e,r){var s=t.l+e,n=t.read_shift(2),i=t.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,n];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var o=$f(t,i),l=[];s>t.l;)l.push(ov(t));return[i,n,o,l]}function mF(t,e,r){var s=t.read_shift(2),n,i={fBuiltIn:s&1,fWantAdvise:s>>>1&1,fWantPict:s>>>2&1,fOle:s>>>3&1,fOleLink:s>>>4&1,cf:s>>>5&1023,fIcon:s>>>15&1};return r.sbcch===14849&&(n=Kae(t,e-2,r)),i.body=n||t.read_shift(e-2),typeof n=="string"&&(i.Name=n),i}var Die=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function pF(t,e,r){var s=t.l+e,n=t.read_shift(2),i=t.read_shift(1),o=t.read_shift(1),l=t.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),c=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var d=$f(t,o,r);n&32&&(d=Die[d.charCodeAt(0)]);var u=s-t.l;r&&r.biff==2&&--u;var A=s==t.l||l===0||!(u>0)?[]:Yde(t,u,r,l);return{chKey:i,Name:d,itab:c,rgce:A}}function t9(t,e,r){if(r.biff<8)return Rie(t,e,r);for(var s=[],n=t.l+e,i=t.read_shift(r.biff>8?4:2);i--!==0;)s.push($ae(t,r.biff>8?12:6,r));if(t.l!=n)throw new Error("Bad ExternSheet: "+t.l+" != "+n);return s}function Rie(t,e,r){t[t.l+1]==3&&t[t.l]++;var s=iv(t,e,r);return s.charCodeAt(0)==3?s.slice(1):s}function Lie(t,e,r){if(r.biff<8){t.l+=e;return}var s=t.read_shift(2),n=t.read_shift(2),i=$f(t,s,r),o=$f(t,n,r);return[i,o]}function Oie(t,e,r){var s=Z7(t);t.l++;var n=t.read_shift(1);return e-=8,[Xde(t,e,r),n,s]}function gF(t,e,r){var s=zae(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[s,Wde(t,e,r)]}function Uie(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,s=t.read_shift(4);return[e,r,s]}function Mie(t,e,r){if(!(r.biff<8)){var s=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2),o=t.read_shift(2),l=am(t,0,r);return r.biff<8&&t.read_shift(1),[{r:s,c:n},l,o,i]}}function Qie(t,e,r){return Mie(t,e,r)}function Vie(t,e){for(var r=[],s=t.read_shift(2);s--;)r.push(jN(t));return r}function Hie(t){var e=It(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)J7(t[r],e);return e}function $ie(t,e,r){if(r&&r.biff<8)return zie(t,e,r);var s=e9(t),n=Yae(t,e-22,s[1]);return{cmo:s,ft:n}}var Kie={8:function(t,e){var r=t.l+e;t.l+=10;var s=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var n=t.read_shift(1);return t.l+=n,t.l=r,{fmt:s}}};function zie(t,e,r){t.l+=4;var s=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var o=[];return o.push((Kie[s]||Ri)(t,e,r)),{cmo:[n,s,i],ft:o}}function qie(t,e,r){var s=t.l,n="";try{t.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(i)==-1?t.l+=6:o=Rae(t,6,r);var l=t.read_shift(2);t.read_shift(2),fa(t,2);var c=t.read_shift(2);t.l+=c;for(var d=1;d<t.lens.length-1;++d){if(t.l-s!=t.lens[d])throw new Error("TxO: bad continue record");var u=t[t.l],A=$f(t,t.lens[d+1]-t.lens[d]-1);if(n+=A,n.length>=(u?l:2*l))break}if(n.length!==l&&n.length!==l*2)throw new Error("cchText: "+l+" != "+n.length);return t.l=s+e,{t:n}}catch{return t.l=s+e,{t:n}}}function Wie(t,e){var r=jN(t);t.l+=16;var s=Mae(t,e-24);return[r,s]}function Gie(t){var e=It(24),r=En(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var s="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<16;++n)e.write_shift(1,parseInt(s[n],16));return Va([e,Qae(t[1])])}function Yie(t,e){t.read_shift(2);var r=jN(t),s=t.read_shift((e-10)/2,"dbcs-cont");return s=s.replace(eo,""),[r,s]}function Xie(t){var e=t[1].Tooltip,r=It(10+2*(e.length+1));r.write_shift(2,2048);var s=En(t[0]);r.write_shift(2,s.r),r.write_shift(2,s.r),r.write_shift(2,s.c),r.write_shift(2,s.c);for(var n=0;n<e.length;++n)r.write_shift(2,e.charCodeAt(n));return r.write_shift(2,0),r}function Jie(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=tF[r]||r,r=t.read_shift(2),e[1]=tF[r]||r,e}function Zie(t){return t||(t=It(4)),t.write_shift(2,1),t.write_shift(2,1),t}function eoe(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(Y7(t));return r}function toe(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(Y7(t));return r}function roe(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function r9(t,e,r){if(!r.cellStyles)return Ri(t,e);var s=r&&r.biff>=12?4:2,n=t.read_shift(s),i=t.read_shift(s),o=t.read_shift(s),l=t.read_shift(s),c=t.read_shift(2);s==2&&(t.l+=2);var d={s:n,e:i,w:o,ixfe:l,flags:c};return(r.biff>=5||!r.biff)&&(d.level=c>>8&7),d}function soe(t,e){var r=It(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var s=0;return t.hidden&&(s|=1),r.write_shift(1,s),s=t.level||0,r.write_shift(1,s),r.write_shift(2,0),r}function noe(t,e){var r={};return e<32||(t.l+=16,r.header=_i(t),r.footer=_i(t),t.l+=2),r}function aoe(t,e,r){var s={area:!1};if(r.biff!=5)return t.l+=e,s;var n=t.read_shift(1);return t.l+=3,n&16&&(s.area=!0),s}function ioe(t){for(var e=It(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}var ooe=od,loe=z7,coe=ov;function doe(t){var e=t.read_shift(2),r=t.read_shift(2),s=t.read_shift(4),n={fmt:e,env:r,len:s,data:t.slice(t.l,t.l+s)};return t.l+=s,n}function uoe(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var s=od(t);++t.l;var n=am(t,e-7,r);return s.t="str",s.val=n,s}function Aoe(t){var e=od(t);++t.l;var r=_i(t);return e.t="n",e.val=r,e}function hoe(t,e,r){var s=It(15);return uv(s,t,e),s.write_shift(8,r,"f"),s}function foe(t){var e=od(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function moe(t,e,r){var s=It(9);return uv(s,t,e),s.write_shift(2,r),s}function poe(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function goe(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function xoe(t,e,r){var s=t.l+e,n=od(t),i=t.read_shift(2),o=$f(t,i,r);return t.l=s,n.t="str",n.val=o,n}var yoe=[2,3,48,49,131,139,140,245],Zj=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=wN({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,c){var d=[],u=JA(1);switch(c.type){case"base64":u=Vo(Zo(l));break;case"binary":u=Vo(l);break;case"buffer":case"array":u=l;break}ti(u,0);var A=u.read_shift(1),h=!!(A&136),f=!1,p=!1;switch(A){case 2:break;case 3:break;case 48:f=!0,h=!0;break;case 49:f=!0,h=!0;break;case 131:break;case 139:break;case 140:p=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+A.toString(16))}var m=0,g=521;A==2&&(m=u.read_shift(2)),u.l+=3,A!=2&&(m=u.read_shift(4)),m>1048576&&(m=1e6),A!=2&&(g=u.read_shift(2));var y=u.read_shift(2),v=c.codepage||1252;A!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(v=t[u[u.l]]),u.l+=1,u.l+=2),p&&(u.l+=36);for(var x=[],E={},T=Math.min(u.length,A==2?521:g-10-(f?264:0)),j=p?32:11;u.l<T&&u[u.l]!=13;)switch(E={},E.name=Kj.utils.decode(v,u.slice(u.l,u.l+j)).replace(/[\u0000\r\n].*$/g,""),u.l+=j,E.type=String.fromCharCode(u.read_shift(1)),A!=2&&!p&&(E.offset=u.read_shift(4)),E.len=u.read_shift(1),A==2&&(E.offset=u.read_shift(2)),E.dec=u.read_shift(1),E.name.length&&x.push(E),A!=2&&(u.l+=p?13:14),E.type){case"B":(!f||E.len!=8)&&c.WTF&&console.log("Skipping "+E.name+":"+E.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+E.name+":"+E.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+E.type)}if(u[u.l]!==13&&(u.l=g-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=g;var C=0,w=0;for(d[0]=[],w=0;w!=x.length;++w)d[0][w]=x[w].name;for(;m-- >0;){if(u[u.l]===42){u.l+=y;continue}for(++u.l,d[++C]=[],w=0,w=0;w!=x.length;++w){var S=u.slice(u.l,u.l+x[w].len);u.l+=x[w].len,ti(S,0);var F=Kj.utils.decode(v,S);switch(x[w].type){case"C":F.trim().length&&(d[C][w]=F.replace(/\s+$/,""));break;case"D":F.length===8?d[C][w]=new Date(+F.slice(0,4),+F.slice(4,6)-1,+F.slice(6,8)):d[C][w]=F;break;case"F":d[C][w]=parseFloat(F.trim());break;case"+":case"I":d[C][w]=p?S.read_shift(-4,"i")^2147483648:S.read_shift(4,"i");break;case"L":switch(F.trim().toUpperCase()){case"Y":case"T":d[C][w]=!0;break;case"N":case"F":d[C][w]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+F+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+A.toString(16));d[C][w]="##MEMO##"+(p?parseInt(F.trim(),10):S.read_shift(4));break;case"N":F=F.replace(/\u0000/g,"").trim(),F&&F!="."&&(d[C][w]=+F||0);break;case"@":d[C][w]=new Date(S.read_shift(-8,"f")-621356832e5);break;case"T":d[C][w]=new Date((S.read_shift(4)-2440588)*864e5+S.read_shift(4));break;case"Y":d[C][w]=S.read_shift(4,"i")/1e4+S.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[C][w]=-S.read_shift(-8,"f");break;case"B":if(f&&x[w].len==8){d[C][w]=S.read_shift(8,"f");break}case"G":case"P":S.l+=x[w].len;break;case"0":if(x[w].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+x[w].type)}}}if(A!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return c&&c.sheetRows&&(d=d.slice(0,c.sheetRows)),c.DBF=x,d}function s(l,c){var d=c||{};d.dateNF||(d.dateNF="yyyymmdd");var u=Op(r(l,d),d);return u["!cols"]=d.DBF.map(function(A){return{wch:A.len,DBF:A}}),delete d.DBF,u}function n(l,c){try{return xh(s(l,c),c)}catch(d){if(c&&c.WTF)throw d}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function o(l,c){var d=c||{};if(+d.codepage>=0&&oc(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var u=jo(),A=o2(l,{header:1,raw:!0,cellDates:!0}),h=A[0],f=A.slice(1),p=l["!cols"]||[],m=0,g=0,y=0,v=1;for(m=0;m<h.length;++m){if(((p[m]||{}).DBF||{}).name){h[m]=p[m].DBF.name,++y;continue}if(h[m]!=null){if(++y,typeof h[m]=="number"&&(h[m]=h[m].toString(10)),typeof h[m]!="string")throw new Error("DBF Invalid column name "+h[m]+" |"+typeof h[m]+"|");if(h.indexOf(h[m])!==m){for(g=0;g<1024;++g)if(h.indexOf(h[m]+"_"+g)==-1){h[m]+="_"+g;break}}}}var x=bs(l["!ref"]),E=[],T=[],j=[];for(m=0;m<=x.e.c-x.s.c;++m){var C="",w="",S=0,F=[];for(g=0;g<f.length;++g)f[g][m]!=null&&F.push(f[g][m]);if(F.length==0||h[m]==null){E[m]="?";continue}for(g=0;g<F.length;++g){switch(typeof F[g]){case"number":w="B";break;case"string":w="C";break;case"boolean":w="L";break;case"object":w=F[g]instanceof Date?"D":"C";break;default:w="C"}S=Math.max(S,String(F[g]).length),C=C&&C!=w?"C":w}S>250&&(S=250),w=((p[m]||{}).DBF||{}).type,w=="C"&&p[m].DBF.len>S&&(S=p[m].DBF.len),C=="B"&&w=="N"&&(C="N",j[m]=p[m].DBF.dec,S=p[m].DBF.len),T[m]=C=="C"||w=="N"?S:i[C]||0,v+=T[m],E[m]=C}var B=u.next(32);for(B.write_shift(4,318902576),B.write_shift(4,f.length),B.write_shift(2,296+32*y),B.write_shift(2,v),m=0;m<4;++m)B.write_shift(4,0);for(B.write_shift(4,0|(+e[KM]||3)<<8),m=0,g=0;m<h.length;++m)if(h[m]!=null){var k=u.next(32),D=(h[m].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);k.write_shift(1,D,"sbcs"),k.write_shift(1,E[m]=="?"?"C":E[m],"sbcs"),k.write_shift(4,g),k.write_shift(1,T[m]||i[E[m]]||0),k.write_shift(1,j[m]||0),k.write_shift(1,2),k.write_shift(4,0),k.write_shift(1,0),k.write_shift(4,0),k.write_shift(4,0),g+=T[m]||i[E[m]]||0}var q=u.next(264);for(q.write_shift(4,13),m=0;m<65;++m)q.write_shift(4,0);for(m=0;m<f.length;++m){var te=u.next(v);for(te.write_shift(1,0),g=0;g<h.length;++g)if(h[g]!=null)switch(E[g]){case"L":te.write_shift(1,f[m][g]==null?63:f[m][g]?84:70);break;case"B":te.write_shift(8,f[m][g]||0,"f");break;case"N":var W="0";for(typeof f[m][g]=="number"&&(W=f[m][g].toFixed(j[g]||0)),y=0;y<T[g]-W.length;++y)te.write_shift(1,32);te.write_shift(1,W,"sbcs");break;case"D":f[m][g]?(te.write_shift(4,("0000"+f[m][g].getFullYear()).slice(-4),"sbcs"),te.write_shift(2,("00"+(f[m][g].getMonth()+1)).slice(-2),"sbcs"),te.write_shift(2,("00"+f[m][g].getDate()).slice(-2),"sbcs")):te.write_shift(8,"00000000","sbcs");break;case"C":var Q=String(f[m][g]!=null?f[m][g]:"").slice(0,T[g]);for(te.write_shift(1,Q,"sbcs"),y=0;y<T[g]-Q.length;++y)te.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:n,to_sheet:s,from_sheet:o}}(),s9=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Qn(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,f){var p=t[f];return typeof p=="number"?_B(p):p},s=function(h,f,p){var m=f.charCodeAt(0)-32<<4|p.charCodeAt(0)-48;return m==59?h:_B(m)};t["|"]=254;function n(h,f){switch(f.type){case"base64":return i(Zo(h),f);case"binary":return i(h,f);case"buffer":return i(Zr&&Buffer.isBuffer(h)?h.toString("binary"):gh(h),f);case"array":return i(Vf(h),f)}throw new Error("Unrecognized type "+f.type)}function i(h,f){var p=h.split(/[\n\r]+/),m=-1,g=-1,y=0,v=0,x=[],E=[],T=null,j={},C=[],w=[],S=[],F=0,B;for(+f.codepage>=0&&oc(+f.codepage);y!==p.length;++y){F=0;var k=p[y].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,s).replace(e,r),D=k.replace(/;;/g,"\0").split(";").map(function(L){return L.replace(/\u0000/g,";")}),q=D[0],te;if(k.length>0)switch(q){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":D[1].charAt(0)=="P"&&E.push(k.slice(3).replace(/;;/g,";"));break;case"C":var W=!1,Q=!1,re=!1,G=!1,Ae=-1,he=-1;for(v=1;v<D.length;++v)switch(D[v].charAt(0)){case"A":break;case"X":g=parseInt(D[v].slice(1))-1,Q=!0;break;case"Y":for(m=parseInt(D[v].slice(1))-1,Q||(g=0),B=x.length;B<=m;++B)x[B]=[];break;case"K":te=D[v].slice(1),te.charAt(0)==='"'?te=te.slice(1,te.length-1):te==="TRUE"?te=!0:te==="FALSE"?te=!1:isNaN(Ac(te))?isNaN(vp(te).getDate())||(te=pn(te)):(te=Ac(te),T!==null&&Rp(T)&&(te=CN(te))),W=!0;break;case"E":G=!0;var I=M0(D[v].slice(1),{r:m,c:g});x[m][g]=[x[m][g],I];break;case"S":re=!0,x[m][g]=[x[m][g],"S5S"];break;case"G":break;case"R":Ae=parseInt(D[v].slice(1))-1;break;case"C":he=parseInt(D[v].slice(1))-1;break;default:if(f&&f.WTF)throw new Error("SYLK bad record "+k)}if(W&&(x[m][g]&&x[m][g].length==2?x[m][g][0]=te:x[m][g]=te,T=null),re){if(G)throw new Error("SYLK shared formula cannot have own formula");var U=Ae>-1&&x[Ae][he];if(!U||!U[1])throw new Error("SYLK shared formula cannot find base");x[m][g][1]=b9(U[1],{r:m-Ae,c:g-he})}break;case"F":var V=0;for(v=1;v<D.length;++v)switch(D[v].charAt(0)){case"X":g=parseInt(D[v].slice(1))-1,++V;break;case"Y":for(m=parseInt(D[v].slice(1))-1,B=x.length;B<=m;++B)x[B]=[];break;case"M":F=parseInt(D[v].slice(1))/20;break;case"F":break;case"G":break;case"P":T=E[parseInt(D[v].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(S=D[v].slice(1).split(" "),B=parseInt(S[0],10);B<=parseInt(S[1],10);++B)F=parseInt(S[2],10),w[B-1]=F===0?{hidden:!0}:{wch:F},ZA(w[B-1]);break;case"C":g=parseInt(D[v].slice(1))-1,w[g]||(w[g]={});break;case"R":m=parseInt(D[v].slice(1))-1,C[m]||(C[m]={}),F>0?(C[m].hpt=F,C[m].hpx=wp(F)):F===0&&(C[m].hidden=!0);break;default:if(f&&f.WTF)throw new Error("SYLK bad record "+k)}V<1&&(T=null);break;default:if(f&&f.WTF)throw new Error("SYLK bad record "+k)}}return C.length>0&&(j["!rows"]=C),w.length>0&&(j["!cols"]=w),f&&f.sheetRows&&(x=x.slice(0,f.sheetRows)),[x,j]}function o(h,f){var p=n(h,f),m=p[0],g=p[1],y=Op(m,f);return Qn(g).forEach(function(v){y[v]=g[v]}),y}function l(h,f){return xh(o(h,f),f)}function c(h,f,p,m){var g="C;Y"+(p+1)+";X"+(m+1)+";K";switch(h.t){case"n":g+=h.v||0,h.f&&!h.F&&(g+=";E"+Q_(h.f,{r:p,c:m}));break;case"b":g+=h.v?"TRUE":"FALSE";break;case"e":g+=h.w||h.v;break;case"d":g+='"'+(h.w||h.v)+'"';break;case"s":g+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return g}function d(h,f){f.forEach(function(p,m){var g="F;W"+(m+1)+" "+(m+1)+" ";p.hidden?g+="0":(typeof p.width=="number"&&!p.wpx&&(p.wpx=gy(p.width)),typeof p.wpx=="number"&&!p.wch&&(p.wch=xy(p.wpx)),typeof p.wch=="number"&&(g+=Math.round(p.wch))),g.charAt(g.length-1)!=" "&&h.push(g)})}function u(h,f){f.forEach(function(p,m){var g="F;";p.hidden?g+="M0;":p.hpt?g+="M"+20*p.hpt+";":p.hpx&&(g+="M"+20*yy(p.hpx)+";"),g.length>2&&h.push(g+"R"+(m+1))})}function A(h,f){var p=["ID;PWXL;N;E"],m=[],g=bs(h["!ref"]),y,v=Array.isArray(h),x=`\r
`;p.push("P;PGeneral"),p.push("F;P0;DG0G8;M255"),h["!cols"]&&d(p,h["!cols"]),h["!rows"]&&u(p,h["!rows"]),p.push("B;Y"+(g.e.r-g.s.r+1)+";X"+(g.e.c-g.s.c+1)+";D"+[g.s.c,g.s.r,g.e.c,g.e.r].join(" "));for(var E=g.s.r;E<=g.e.r;++E)for(var T=g.s.c;T<=g.e.c;++T){var j=Fr({r:E,c:T});y=v?(h[E]||[])[T]:h[j],!(!y||y.v==null&&(!y.f||y.F))&&m.push(c(y,h,E,T))}return p.join(x)+x+m.join(x)+x+"E"+x}return{to_workbook:l,to_sheet:o,from_sheet:A}}(),n9=function(){function t(i,o){switch(o.type){case"base64":return e(Zo(i),o);case"binary":return e(i,o);case"buffer":return e(Zr&&Buffer.isBuffer(i)?i.toString("binary"):gh(i),o);case"array":return e(Vf(i),o)}throw new Error("Unrecognized type "+o.type)}function e(i,o){for(var l=i.split(`
`),c=-1,d=-1,u=0,A=[];u!==l.length;++u){if(l[u].trim()==="BOT"){A[++c]=[],d=0;continue}if(!(c<0)){var h=l[u].trim().split(","),f=h[0],p=h[1];++u;for(var m=l[u]||"";(m.match(/["]/g)||[]).length&1&&u<l.length-1;)m+=`
`+l[++u];switch(m=m.trim(),+f){case-1:if(m==="BOT"){A[++c]=[],d=0;continue}else if(m!=="EOD")throw new Error("Unrecognized DIF special command "+m);break;case 0:m==="TRUE"?A[c][d]=!0:m==="FALSE"?A[c][d]=!1:isNaN(Ac(p))?isNaN(vp(p).getDate())?A[c][d]=p:A[c][d]=pn(p):A[c][d]=Ac(p),++d;break;case 1:m=m.slice(1,m.length-1),m=m.replace(/""/g,'"'),m&&m.match(/^=".*"$/)&&(m=m.slice(2,-1)),A[c][d++]=m!==""?m:null;break}if(m==="EOD")break}}return o&&o.sheetRows&&(A=A.slice(0,o.sheetRows)),A}function r(i,o){return Op(t(i,o),o)}function s(i,o){return xh(r(i,o),o)}var n=function(){var i=function(c,d,u,A,h){c.push(d),c.push(u+","+A),c.push('"'+h.replace(/"/g,'""')+'"')},o=function(c,d,u,A){c.push(d+","+u),c.push(d==1?'"'+A.replace(/"/g,'""')+'"':A)};return function(c){var d=[],u=bs(c["!ref"]),A,h=Array.isArray(c);i(d,"TABLE",0,1,"sheetjs"),i(d,"VECTORS",0,u.e.r-u.s.r+1,""),i(d,"TUPLES",0,u.e.c-u.s.c+1,""),i(d,"DATA",0,0,"");for(var f=u.s.r;f<=u.e.r;++f){o(d,-1,0,"BOT");for(var p=u.s.c;p<=u.e.c;++p){var m=Fr({r:f,c:p});if(A=h?(c[f]||[])[p]:c[m],!A){o(d,1,0,"");continue}switch(A.t){case"n":var g=A.w;!g&&A.v!=null&&(g=A.v),g==null?A.f&&!A.F?o(d,1,0,"="+A.f):o(d,1,0,""):o(d,0,g,"V");break;case"b":o(d,0,A.v?1:0,A.v?"TRUE":"FALSE");break;case"s":o(d,1,0,isNaN(A.v)?A.v:'="'+A.v+'"');break;case"d":A.w||(A.w=Ll(A.z||Ir[14],_a(pn(A.v)))),o(d,0,A.w,"V");break;default:o(d,1,0,"")}}}o(d,-1,0,"EOD");var y=`\r
`,v=d.join(y);return v}}();return{to_workbook:s,to_sheet:r,from_sheet:n}}(),a9=function(){function t(A){return A.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(A){return A.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(A,h){for(var f=A.split(`
`),p=-1,m=-1,g=0,y=[];g!==f.length;++g){var v=f[g].trim().split(":");if(v[0]==="cell"){var x=En(v[1]);if(y.length<=x.r)for(p=y.length;p<=x.r;++p)y[p]||(y[p]=[]);switch(p=x.r,m=x.c,v[2]){case"t":y[p][m]=t(v[3]);break;case"v":y[p][m]=+v[3];break;case"vtf":var E=v[v.length-1];case"vtc":switch(v[3]){case"nl":y[p][m]=!!+v[4];break;default:y[p][m]=+v[4];break}v[2]=="vtf"&&(y[p][m]=[y[p][m],E])}}}return h&&h.sheetRows&&(y=y.slice(0,h.sheetRows)),y}function s(A,h){return Op(r(A,h),h)}function n(A,h){return xh(s(A,h),h)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function d(A){if(!A||!A["!ref"])return"";for(var h=[],f=[],p,m="",g=So(A["!ref"]),y=Array.isArray(A),v=g.s.r;v<=g.e.r;++v)for(var x=g.s.c;x<=g.e.c;++x)if(m=Fr({r:v,c:x}),p=y?(A[v]||[])[x]:A[m],!(!p||p.v==null||p.t==="z")){switch(f=["cell",m,"t"],p.t){case"s":case"str":f.push(e(p.v));break;case"n":p.f?(f[2]="vtf",f[3]="n",f[4]=p.v,f[5]=e(p.f)):(f[2]="v",f[3]=p.v);break;case"b":f[2]="vt"+(p.f?"f":"c"),f[3]="nl",f[4]=p.v?"1":"0",f[5]=e(p.f||(p.v?"TRUE":"FALSE"));break;case"d":var E=_a(pn(p.v));f[2]="vtc",f[3]="nd",f[4]=""+E,f[5]=p.w||Ll(p.z||Ir[14],E);break;case"e":continue}h.push(f.join(":"))}return h.push("sheet:c:"+(g.e.c-g.s.c+1)+":r:"+(g.e.r-g.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function u(A){return[i,o,l,o,d(A),c].join(`
`)}return{to_workbook:n,to_sheet:s,from_sheet:u}}(),bp=function(){function t(u,A,h,f,p){p.raw?A[h][f]=u:u===""||(u==="TRUE"?A[h][f]=!0:u==="FALSE"?A[h][f]=!1:isNaN(Ac(u))?isNaN(vp(u).getDate())?A[h][f]=u:A[h][f]=pn(u):A[h][f]=Ac(u))}function e(u,A){var h=A||{},f=[];if(!u||u.length===0)return f;for(var p=u.split(/[\r\n]/),m=p.length-1;m>=0&&p[m].length===0;)--m;for(var g=10,y=0,v=0;v<=m;++v)y=p[v].indexOf(" "),y==-1?y=p[v].length:y++,g=Math.max(g,y);for(v=0;v<=m;++v){f[v]=[];var x=0;for(t(p[v].slice(0,g).trim(),f,v,x,h),x=1;x<=(p[v].length-g)/10+1;++x)t(p[v].slice(g+(x-1)*10,g+x*10).trim(),f,v,x,h)}return h.sheetRows&&(f=f.slice(0,h.sheetRows)),f}var r={44:",",9:"	",59:";",124:"|"},s={44:3,9:2,59:1,124:0};function n(u){for(var A={},h=!1,f=0,p=0;f<u.length;++f)(p=u.charCodeAt(f))==34?h=!h:!h&&p in r&&(A[p]=(A[p]||0)+1);p=[];for(f in A)Object.prototype.hasOwnProperty.call(A,f)&&p.push([A[f],f]);if(!p.length){A=s;for(f in A)Object.prototype.hasOwnProperty.call(A,f)&&p.push([A[f],f])}return p.sort(function(m,g){return m[0]-g[0]||s[m[1]]-s[g[1]]}),r[p.pop()[1]]||44}function i(u,A){var h=A||{},f="",p=h.dense?[]:{},m={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(f=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(f=u.charAt(4),u=u.slice(6)):f=n(u.slice(0,1024)):h&&h.FS?f=h.FS:f=n(u.slice(0,1024));var g=0,y=0,v=0,x=0,E=0,T=f.charCodeAt(0),j=!1,C=0,w=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var S=h.dateNF!=null?ane(h.dateNF):null;function F(){var B=u.slice(x,E),k={};if(B.charAt(0)=='"'&&B.charAt(B.length-1)=='"'&&(B=B.slice(1,-1).replace(/""/g,'"')),B.length===0)k.t="z";else if(h.raw)k.t="s",k.v=B;else if(B.trim().length===0)k.t="s",k.v=B;else if(B.charCodeAt(0)==61)B.charCodeAt(1)==34&&B.charCodeAt(B.length-1)==34?(k.t="s",k.v=B.slice(2,-1).replace(/""/g,'"')):Pce(B)?(k.t="n",k.f=B.slice(1)):(k.t="s",k.v=B);else if(B=="TRUE")k.t="b",k.v=!0;else if(B=="FALSE")k.t="b",k.v=!1;else if(!isNaN(v=Ac(B)))k.t="n",h.cellText!==!1&&(k.w=B),k.v=v;else if(!isNaN(vp(B).getDate())||S&&B.match(S)){k.z=h.dateNF||Ir[14];var D=0;S&&B.match(S)&&(B=ine(B,h.dateNF,B.match(S)||[]),D=1),h.cellDates?(k.t="d",k.v=pn(B,D)):(k.t="n",k.v=_a(pn(B,D))),h.cellText!==!1&&(k.w=Ll(k.z,k.v instanceof Date?_a(k.v):k.v)),h.cellNF||delete k.z}else k.t="s",k.v=B;if(k.t=="z"||(h.dense?(p[g]||(p[g]=[]),p[g][y]=k):p[Fr({c:y,r:g})]=k),x=E+1,w=u.charCodeAt(x),m.e.c<y&&(m.e.c=y),m.e.r<g&&(m.e.r=g),C==T)++y;else if(y=0,++g,h.sheetRows&&h.sheetRows<=g)return!0}e:for(;E<u.length;++E)switch(C=u.charCodeAt(E)){case 34:w===34&&(j=!j);break;case T:case 10:case 13:if(!j&&F())break e;break}return E-x>0&&F(),p["!ref"]=Gr(m),p}function o(u,A){return!(A&&A.PRN)||A.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?i(u,A):Op(e(u,A),A)}function l(u,A){var h="",f=A.type=="string"?[0,0,0,0]:G_(u,A);switch(A.type){case"base64":h=Zo(u);break;case"binary":h=u;break;case"buffer":A.codepage==65001?h=u.toString("utf8"):(A.codepage,h=Zr&&Buffer.isBuffer(u)?u.toString("binary"):gh(u));break;case"array":h=Vf(u);break;case"string":h=u;break;default:throw new Error("Unrecognized type "+A.type)}return f[0]==239&&f[1]==187&&f[2]==191?h=Ks(h.slice(3)):A.type!="string"&&A.type!="buffer"&&A.codepage==65001?h=Ks(h):A.type=="binary",h.slice(0,19)=="socialcalc:version:"?a9.to_sheet(A.type=="string"?h:Ks(h),A):o(h,A)}function c(u,A){return xh(l(u,A),A)}function d(u){for(var A=[],h=bs(u["!ref"]),f,p=Array.isArray(u),m=h.s.r;m<=h.e.r;++m){for(var g=[],y=h.s.c;y<=h.e.c;++y){var v=Fr({r:m,c:y});if(f=p?(u[m]||[])[y]:u[v],!f||f.v==null){g.push("          ");continue}for(var x=(f.w||(iu(f),f.w)||"").slice(0,10);x.length<10;)x+=" ";g.push(x+(y===0?" ":""))}A.push(g.join(""))}return A.join(`
`)}return{to_workbook:c,to_sheet:l,from_sheet:d}}();function voe(t,e){var r=e||{},s=!!r.WTF;r.WTF=!0;try{var n=s9.to_workbook(t,r);return r.WTF=s,n}catch(i){if(r.WTF=s,!i.message.match(/SYLK bad record ID/)&&s)throw i;return bp.to_workbook(t,e)}}var pf=function(){function t(I,U,V){if(I){ti(I,I.l||0);for(var L=V.Enum||Ae;I.l<I.length;){var K=I.read_shift(2),fe=L[K]||L[65535],ee=I.read_shift(2),de=I.l+ee,ue=fe.f&&fe.f(I,ee,V);if(I.l=de,U(ue,fe,K))return}}}function e(I,U){switch(U.type){case"base64":return r(Vo(Zo(I)),U);case"binary":return r(Vo(I),U);case"buffer":case"array":return r(I,U)}throw"Unsupported type "+U.type}function r(I,U){if(!I)return I;var V=U||{},L=V.dense?[]:{},K="Sheet1",fe="",ee=0,de={},ue=[],Ie=[],Y={s:{r:0,c:0},e:{r:0,c:0}},H=V.sheetRows||0;if(I[2]==0&&(I[3]==8||I[3]==9)&&I.length>=16&&I[14]==5&&I[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(I[2]==2)V.Enum=Ae,t(I,function(He,ie,le){switch(le){case 0:V.vers=He,He>=4096&&(V.qpro=!0);break;case 6:Y=He;break;case 204:He&&(fe=He);break;case 222:fe=He;break;case 15:case 51:V.qpro||(He[1].v=He[1].v.slice(1));case 13:case 14:case 16:le==14&&(He[2]&112)==112&&(He[2]&15)>1&&(He[2]&15)<15&&(He[1].z=V.dateNF||Ir[14],V.cellDates&&(He[1].t="d",He[1].v=CN(He[1].v))),V.qpro&&He[3]>ee&&(L["!ref"]=Gr(Y),de[K]=L,ue.push(K),L=V.dense?[]:{},Y={s:{r:0,c:0},e:{r:0,c:0}},ee=He[3],K=fe||"Sheet"+(ee+1),fe="");var ae=V.dense?(L[He[0].r]||[])[He[0].c]:L[Fr(He[0])];if(ae){ae.t=He[1].t,ae.v=He[1].v,He[1].z!=null&&(ae.z=He[1].z),He[1].f!=null&&(ae.f=He[1].f);break}V.dense?(L[He[0].r]||(L[He[0].r]=[]),L[He[0].r][He[0].c]=He[1]):L[Fr(He[0])]=He[1];break}},V);else if(I[2]==26||I[2]==14)V.Enum=he,I[2]==14&&(V.qpro=!0,I.l=0),t(I,function(He,ie,le){switch(le){case 204:K=He;break;case 22:He[1].v=He[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(He[3]>ee&&(L["!ref"]=Gr(Y),de[K]=L,ue.push(K),L=V.dense?[]:{},Y={s:{r:0,c:0},e:{r:0,c:0}},ee=He[3],K="Sheet"+(ee+1)),H>0&&He[0].r>=H)break;V.dense?(L[He[0].r]||(L[He[0].r]=[]),L[He[0].r][He[0].c]=He[1]):L[Fr(He[0])]=He[1],Y.e.c<He[0].c&&(Y.e.c=He[0].c),Y.e.r<He[0].r&&(Y.e.r=He[0].r);break;case 27:He[14e3]&&(Ie[He[14e3][0]]=He[14e3][1]);break;case 1537:Ie[He[0]]=He[1],He[0]==ee&&(K=He[1]);break}},V);else throw new Error("Unrecognized LOTUS BOF "+I[2]);if(L["!ref"]=Gr(Y),de[fe||K]=L,ue.push(fe||K),!Ie.length)return{SheetNames:ue,Sheets:de};for(var je={},Ce=[],oe=0;oe<Ie.length;++oe)de[ue[oe]]?(Ce.push(Ie[oe]||ue[oe]),je[Ie[oe]]=de[Ie[oe]]||de[ue[oe]]):(Ce.push(Ie[oe]),je[Ie[oe]]={"!ref":"A1"});return{SheetNames:Ce,Sheets:je}}function s(I,U){var V=U||{};if(+V.codepage>=0&&oc(+V.codepage),V.type=="string")throw new Error("Cannot write WK1 to JS string");var L=jo(),K=bs(I["!ref"]),fe=Array.isArray(I),ee=[];tr(L,0,i(1030)),tr(L,6,c(K));for(var de=Math.min(K.e.r,8191),ue=K.s.r;ue<=de;++ue)for(var Ie=na(ue),Y=K.s.c;Y<=K.e.c;++Y){ue===K.s.r&&(ee[Y]=Sn(Y));var H=ee[Y]+Ie,je=fe?(I[ue]||[])[Y]:I[H];if(!(!je||je.t=="z"))if(je.t=="n")(je.v|0)==je.v&&je.v>=-32768&&je.v<=32767?tr(L,13,f(ue,Y,je.v)):tr(L,14,m(ue,Y,je.v));else{var Ce=iu(je);tr(L,15,A(ue,Y,Ce.slice(0,239)))}}return tr(L,1),L.end()}function n(I,U){var V=U||{};if(+V.codepage>=0&&oc(+V.codepage),V.type=="string")throw new Error("Cannot write WK3 to JS string");var L=jo();tr(L,0,o(I));for(var K=0,fe=0;K<I.SheetNames.length;++K)(I.Sheets[I.SheetNames[K]]||{})["!ref"]&&tr(L,27,G(I.SheetNames[K],fe++));var ee=0;for(K=0;K<I.SheetNames.length;++K){var de=I.Sheets[I.SheetNames[K]];if(!(!de||!de["!ref"])){for(var ue=bs(de["!ref"]),Ie=Array.isArray(de),Y=[],H=Math.min(ue.e.r,8191),je=ue.s.r;je<=H;++je)for(var Ce=na(je),oe=ue.s.c;oe<=ue.e.c;++oe){je===ue.s.r&&(Y[oe]=Sn(oe));var He=Y[oe]+Ce,ie=Ie?(de[je]||[])[oe]:de[He];if(!(!ie||ie.t=="z"))if(ie.t=="n")tr(L,23,F(je,oe,ee,ie.v));else{var le=iu(ie);tr(L,22,C(je,oe,ee,le.slice(0,239)))}}++ee}}return tr(L,1),L.end()}function i(I){var U=It(2);return U.write_shift(2,I),U}function o(I){var U=It(26);U.write_shift(2,4096),U.write_shift(2,4),U.write_shift(4,0);for(var V=0,L=0,K=0,fe=0;fe<I.SheetNames.length;++fe){var ee=I.SheetNames[fe],de=I.Sheets[ee];if(!(!de||!de["!ref"])){++K;var ue=So(de["!ref"]);V<ue.e.r&&(V=ue.e.r),L<ue.e.c&&(L=ue.e.c)}}return V>8191&&(V=8191),U.write_shift(2,V),U.write_shift(1,K),U.write_shift(1,L),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(1,1),U.write_shift(1,2),U.write_shift(4,0),U.write_shift(4,0),U}function l(I,U,V){var L={s:{c:0,r:0},e:{c:0,r:0}};return U==8&&V.qpro?(L.s.c=I.read_shift(1),I.l++,L.s.r=I.read_shift(2),L.e.c=I.read_shift(1),I.l++,L.e.r=I.read_shift(2),L):(L.s.c=I.read_shift(2),L.s.r=I.read_shift(2),U==12&&V.qpro&&(I.l+=2),L.e.c=I.read_shift(2),L.e.r=I.read_shift(2),U==12&&V.qpro&&(I.l+=2),L.s.c==65535&&(L.s.c=L.e.c=L.s.r=L.e.r=0),L)}function c(I){var U=It(8);return U.write_shift(2,I.s.c),U.write_shift(2,I.s.r),U.write_shift(2,I.e.c),U.write_shift(2,I.e.r),U}function d(I,U,V){var L=[{c:0,r:0},{t:"n",v:0},0,0];return V.qpro&&V.vers!=20768?(L[0].c=I.read_shift(1),L[3]=I.read_shift(1),L[0].r=I.read_shift(2),I.l+=2):(L[2]=I.read_shift(1),L[0].c=I.read_shift(2),L[0].r=I.read_shift(2)),L}function u(I,U,V){var L=I.l+U,K=d(I,U,V);if(K[1].t="s",V.vers==20768){I.l++;var fe=I.read_shift(1);return K[1].v=I.read_shift(fe,"utf8"),K}return V.qpro&&I.l++,K[1].v=I.read_shift(L-I.l,"cstr"),K}function A(I,U,V){var L=It(7+V.length);L.write_shift(1,255),L.write_shift(2,U),L.write_shift(2,I),L.write_shift(1,39);for(var K=0;K<L.length;++K){var fe=V.charCodeAt(K);L.write_shift(1,fe>=128?95:fe)}return L.write_shift(1,0),L}function h(I,U,V){var L=d(I,U,V);return L[1].v=I.read_shift(2,"i"),L}function f(I,U,V){var L=It(7);return L.write_shift(1,255),L.write_shift(2,U),L.write_shift(2,I),L.write_shift(2,V,"i"),L}function p(I,U,V){var L=d(I,U,V);return L[1].v=I.read_shift(8,"f"),L}function m(I,U,V){var L=It(13);return L.write_shift(1,255),L.write_shift(2,U),L.write_shift(2,I),L.write_shift(8,V,"f"),L}function g(I,U,V){var L=I.l+U,K=d(I,U,V);if(K[1].v=I.read_shift(8,"f"),V.qpro)I.l=L;else{var fe=I.read_shift(2);E(I.slice(I.l,I.l+fe),K),I.l+=fe}return K}function y(I,U,V){var L=U&32768;return U&=-32769,U=(L?I:0)+(U>=8192?U-16384:U),(L?"":"$")+(V?Sn(U):na(U))}var v={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},x=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function E(I,U){ti(I,0);for(var V=[],L=0,K="",fe="",ee="",de="";I.l<I.length;){var ue=I[I.l++];switch(ue){case 0:V.push(I.read_shift(8,"f"));break;case 1:fe=y(U[0].c,I.read_shift(2),!0),K=y(U[0].r,I.read_shift(2),!1),V.push(fe+K);break;case 2:{var Ie=y(U[0].c,I.read_shift(2),!0),Y=y(U[0].r,I.read_shift(2),!1);fe=y(U[0].c,I.read_shift(2),!0),K=y(U[0].r,I.read_shift(2),!1),V.push(Ie+Y+":"+fe+K)}break;case 3:if(I.l<I.length){console.error("WK1 premature formula end");return}break;case 4:V.push("("+V.pop()+")");break;case 5:V.push(I.read_shift(2));break;case 6:{for(var H="";ue=I[I.l++];)H+=String.fromCharCode(ue);V.push('"'+H.replace(/"/g,'""')+'"')}break;case 8:V.push("-"+V.pop());break;case 23:V.push("+"+V.pop());break;case 22:V.push("NOT("+V.pop()+")");break;case 20:case 21:de=V.pop(),ee=V.pop(),V.push(["AND","OR"][ue-20]+"("+ee+","+de+")");break;default:if(ue<32&&x[ue])de=V.pop(),ee=V.pop(),V.push(ee+x[ue]+de);else if(v[ue]){if(L=v[ue][1],L==69&&(L=I[I.l++]),L>V.length){console.error("WK1 bad formula parse 0x"+ue.toString(16)+":|"+V.join("|")+"|");return}var je=V.slice(-L);V.length-=L,V.push(v[ue][0]+"("+je.join(",")+")")}else return ue<=7?console.error("WK1 invalid opcode "+ue.toString(16)):ue<=24?console.error("WK1 unsupported op "+ue.toString(16)):ue<=30?console.error("WK1 invalid opcode "+ue.toString(16)):ue<=115?console.error("WK1 unsupported function opcode "+ue.toString(16)):console.error("WK1 unrecognized opcode "+ue.toString(16))}}V.length==1?U[1].f=""+V[0]:console.error("WK1 bad formula parse |"+V.join("|")+"|")}function T(I){var U=[{c:0,r:0},{t:"n",v:0},0];return U[0].r=I.read_shift(2),U[3]=I[I.l++],U[0].c=I[I.l++],U}function j(I,U){var V=T(I);return V[1].t="s",V[1].v=I.read_shift(U-4,"cstr"),V}function C(I,U,V,L){var K=It(6+L.length);K.write_shift(2,I),K.write_shift(1,V),K.write_shift(1,U),K.write_shift(1,39);for(var fe=0;fe<L.length;++fe){var ee=L.charCodeAt(fe);K.write_shift(1,ee>=128?95:ee)}return K.write_shift(1,0),K}function w(I,U){var V=T(I);V[1].v=I.read_shift(2);var L=V[1].v>>1;if(V[1].v&1)switch(L&7){case 0:L=(L>>3)*5e3;break;case 1:L=(L>>3)*500;break;case 2:L=(L>>3)/20;break;case 3:L=(L>>3)/200;break;case 4:L=(L>>3)/2e3;break;case 5:L=(L>>3)/2e4;break;case 6:L=(L>>3)/16;break;case 7:L=(L>>3)/64;break}return V[1].v=L,V}function S(I,U){var V=T(I),L=I.read_shift(4),K=I.read_shift(4),fe=I.read_shift(2);if(fe==65535)return L===0&&K===3221225472?(V[1].t="e",V[1].v=15):L===0&&K===3489660928?(V[1].t="e",V[1].v=42):V[1].v=0,V;var ee=fe&32768;return fe=(fe&32767)-16446,V[1].v=(1-ee*2)*(K*Math.pow(2,fe+32)+L*Math.pow(2,fe)),V}function F(I,U,V,L){var K=It(14);if(K.write_shift(2,I),K.write_shift(1,V),K.write_shift(1,U),L==0)return K.write_shift(4,0),K.write_shift(4,0),K.write_shift(2,65535),K;var fe=0,ee=0,de=0,ue=0;return L<0&&(fe=1,L=-L),ee=Math.log2(L)|0,L/=Math.pow(2,ee-31),ue=L>>>0,ue&2147483648||(L/=2,++ee,ue=L>>>0),L-=ue,ue|=2147483648,ue>>>=0,L*=Math.pow(2,32),de=L>>>0,K.write_shift(4,de),K.write_shift(4,ue),ee+=16383+(fe?32768:0),K.write_shift(2,ee),K}function B(I,U){var V=S(I);return I.l+=U-14,V}function k(I,U){var V=T(I),L=I.read_shift(4);return V[1].v=L>>6,V}function D(I,U){var V=T(I),L=I.read_shift(8,"f");return V[1].v=L,V}function q(I,U){var V=D(I);return I.l+=U-10,V}function te(I,U){return I[I.l+U-1]==0?I.read_shift(U,"cstr"):""}function W(I,U){var V=I[I.l++];V>U-1&&(V=U-1);for(var L="";L.length<V;)L+=String.fromCharCode(I[I.l++]);return L}function Q(I,U,V){if(!(!V.qpro||U<21)){var L=I.read_shift(1);I.l+=17,I.l+=1,I.l+=2;var K=I.read_shift(U-21,"cstr");return[L,K]}}function re(I,U){for(var V={},L=I.l+U;I.l<L;){var K=I.read_shift(2);if(K==14e3){for(V[K]=[0,""],V[K][0]=I.read_shift(2);I[I.l];)V[K][1]+=String.fromCharCode(I[I.l]),I.l++;I.l++}}return V}function G(I,U){var V=It(5+I.length);V.write_shift(2,14e3),V.write_shift(2,U);for(var L=0;L<I.length;++L){var K=I.charCodeAt(L);V[V.l++]=K>127?95:K}return V[V.l++]=0,V}var Ae={0:{n:"BOF",f:fa},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:p},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:g},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:te},222:{n:"SHEETNAMELP",f:W},65535:{n:""}},he={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:j},23:{n:"NUMBER17",f:S},24:{n:"NUMBER18",f:w},25:{n:"FORMULA19",f:B},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:re},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:k},38:{n:"??"},39:{n:"NUMBER27",f:D},40:{n:"FORMULA28",f:q},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:te},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Q},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:s,book_to_wk3:n,to_workbook:e}}();function boe(t){var e={},r=t.match(Oi),s=0,n=!1;if(r)for(;s!=r.length;++s){var i=Rr(r[s]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;e.cp=A_[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=i.val;break;case"<sz":e.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":i.rgb&&(e.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(i[0].charCodeAt(1)!==47&&!n)throw new Error("Unrecognized rich format "+i[0])}}return e}var woe=function(){var t=Ay("t"),e=Ay("rPr");function r(i){var o=i.match(t);if(!o)return{t:"s",v:""};var l={t:"s",v:vs(o[1])},c=i.match(e);return c&&(l.s=boe(c[1])),l}var s=/<(?:\w+:)?r>/g,n=/<\/(?:\w+:)?r>/;return function(o){return o.replace(s,"").split(n).map(r).filter(function(l){return l.v})}}(),Noe=function(){var e=/(\r\n|\n)/g;function r(n,i,o){var l=[];n.u&&l.push("text-decoration: underline;"),n.uval&&l.push("text-underline-style:"+n.uval+";"),n.sz&&l.push("font-size:"+n.sz+"pt;"),n.outline&&l.push("text-effect: outline;"),n.shadow&&l.push("text-shadow: auto;"),i.push('<span style="'+l.join("")+'">'),n.b&&(i.push("<b>"),o.push("</b>")),n.i&&(i.push("<i>"),o.push("</i>")),n.strike&&(i.push("<s>"),o.push("</s>"));var c=n.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(i.push("<"+c+">"),o.push("</"+c+">")),o.push("</span>"),n}function s(n){var i=[[],n.v,[]];return n.v?(n.s&&r(n.s,i[0],i[2]),i[0].join("")+i[1].replace(e,"<br/>")+i[2].join("")):""}return function(i){return i.map(s).join("")}}(),Coe=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,joe=/<(?:\w+:)?r>/,Soe=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function R_(t,e){var r=e?e.cellHTML:!0,s={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(s.t=vs(Ks(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),s.r=Ks(t),r&&(s.h=w_(s.t))):t.match(joe)&&(s.r=Ks(t),s.t=vs(Ks((t.replace(Soe,"").match(Coe)||[]).join("").replace(Oi,""))),r&&(s.h=Noe(woe(s.r)))),s):{t:""}}var Eoe=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,_oe=/<(?:\w+:)?(?:si|sstItem)>/g,Toe=/<\/(?:\w+:)?(?:si|sstItem)>/;function Ioe(t,e){var r=[],s="";if(!t)return r;var n=t.match(Eoe);if(n){s=n[2].replace(_oe,"").split(Toe);for(var i=0;i!=s.length;++i){var o=R_(s[i].trim(),e);o!=null&&(r[r.length]=o)}n=Rr(n[1]),r.Count=n.count,r.Unique=n.uniqueCount}return r}var koe=/^\s|\s$|[\t\n\r]/;function i9(t,e){if(!e.bookSST)return"";var r=[oa];r[r.length]=er("sst",null,{xmlns:em[0],count:t.Count,uniqueCount:t.Unique});for(var s=0;s!=t.length;++s)if(t[s]!=null){var n=t[s],i="<si>";n.r?i+=n.r:(i+="<t",n.t||(n.t=""),n.t.match(koe)&&(i+=' xml:space="preserve"'),i+=">"+Os(n.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function Boe(t){return[t.read_shift(4),t.read_shift(4)]}function Foe(t,e){var r=[],s=!1;return mu(t,function(i,o,l){switch(l){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:s=!0;break;case 36:s=!1;break;default:if(o.T,!s||e.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),r}function Poe(t,e){return e||(e=It(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var Doe=Kne;function Roe(t){var e=jo();Mt(e,159,Poe(t));for(var r=0;r<t.length;++r)Mt(e,19,Doe(t[r]));return Mt(e,160),e.end()}function o9(t){for(var e=[],r=t.split(""),s=0;s<r.length;++s)e[s]=r[s].charCodeAt(0);return e}function Wd(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function Loe(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=Wd(t,4),e.U=Wd(t,4),e.W=Wd(t,4),e}function Ooe(t){for(var e=t.read_shift(4),r=t.l+e-4,s={},n=t.read_shift(4),i=[];n-- >0;)i.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(s.name=t.read_shift(0,"lpp4"),s.comps=i,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return s}function Uoe(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(Ooe(t));return e}function Moe(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function Qoe(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=Wd(t,4),e.U=Wd(t,4),e.W=Wd(t,4),e}function Voe(t){var e=Qoe(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function l9(t,e){var r=t.l+e,s={};s.Flags=t.read_shift(4)&63,t.l+=4,s.AlgID=t.read_shift(4);var n=!1;switch(s.AlgID){case 26126:case 26127:case 26128:n=s.Flags==36;break;case 26625:n=s.Flags==4;break;case 0:n=s.Flags==16||s.Flags==4||s.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+s.AlgID}if(!n)throw new Error("Encryption Flags/AlgID mismatch");return s.AlgIDHash=t.read_shift(4),s.KeySize=t.read_shift(4),s.ProviderType=t.read_shift(4),t.l+=8,s.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,s}function c9(t,e){var r={},s=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,s),t.l=s,r}function Hoe(t){var e=Wd(t);switch(e.Minor){case 2:return[e.Minor,$oe(t)];case 3:return[e.Minor,Koe()];case 4:return[e.Minor,zoe(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function $oe(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),s=l9(t,r),n=c9(t,t.length-t.l);return{t:"Std",h:s,v:n}}function Koe(){throw new Error("File is password-protected: ECMA-376 Extensible")}function zoe(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),s={};return r.replace(Oi,function(i){var o=Rr(i);switch(id(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(l){s[l]=o[l]});break;case"<dataIntegrity":s.encryptedHmacKey=o.encryptedHmacKey,s.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":s.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":s.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":s.encs.push(o);break;default:throw o[0]}}),s}function qoe(t,e){var r={},s=r.EncryptionVersionInfo=Wd(t,4);if(e-=4,s.Minor!=2)throw new Error("unrecognized minor version code: "+s.Minor);if(s.Major>4||s.Major<2)throw new Error("unrecognized major version code: "+s.Major);r.Flags=t.read_shift(4),e-=4;var n=t.read_shift(4);return e-=4,r.EncryptionHeader=l9(t,n),e-=n,r.EncryptionVerifier=c9(t,e),r}function Woe(t){var e={},r=e.EncryptionVersionInfo=Wd(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function L_(t){var e=0,r,s=o9(t),n=s.length+1,i,o,l,c,d;for(r=JA(n),r[0]=s.length,i=1;i!=n;++i)r[i]=s[i-1];for(i=n-1;i>=0;--i)o=r[i],l=e&16384?1:0,c=e<<1&32767,d=l|c,e=d^o;return e^52811}var d9=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],s=function(o){return(o/2|o*128)&255},n=function(o,l){return s(o^l)},i=function(o){for(var l=e[o.length-1],c=104,d=o.length-1;d>=0;--d)for(var u=o[d],A=0;A!=7;++A)u&64&&(l^=r[c]),u*=2,--c;return l};return function(o){for(var l=o9(o),c=i(l),d=l.length,u=JA(16),A=0;A!=16;++A)u[A]=0;var h,f,p;for((d&1)===1&&(h=c>>8,u[d]=n(t[0],h),--d,h=c&255,f=l[l.length-1],u[d]=n(f,h));d>0;)--d,h=c>>8,u[d]=n(l[d],h),--d,h=c&255,u[d]=n(l[d],h);for(d=15,p=15-l.length;p>0;)h=c>>8,u[d]=n(t[p],h),--d,--p,h=c&255,u[d]=n(l[d],h),--d,--p;return u}}(),Goe=function(t,e,r,s,n){n||(n=e),s||(s=d9(t));var i,o;for(i=0;i!=e.length;++i)o=e[i],o^=s[r],o=(o>>5|o<<3)&255,n[i]=o,++r;return[n,r,s]},Yoe=function(t){var e=0,r=d9(t);return function(s){var n=Goe("",s,e,r);return e=n[1],n[0]}};function Xoe(t,e,r,s){var n={key:fa(t),verificationBytes:fa(t)};return r.password&&(n.verifier=L_(r.password)),s.valid=n.verificationBytes===n.verifier,s.valid&&(s.insitu=Yoe(r.password)),n}function Joe(t,e,r){var s=r||{};return s.Info=t.read_shift(2),t.l-=2,s.Info===1?s.Data=Woe(t):s.Data=qoe(t,e),s}function Zoe(t,e,r){var s={Type:r.biff>=8?t.read_shift(2):0};return s.Type?Joe(t,e-2,s):Xoe(t,r.biff>=8?e:e-2,r,s),s}var u9=function(){function t(n,i){switch(i.type){case"base64":return e(Zo(n),i);case"binary":return e(n,i);case"buffer":return e(Zr&&Buffer.isBuffer(n)?n.toString("binary"):gh(n),i);case"array":return e(Vf(n),i)}throw new Error("Unrecognized type "+i.type)}function e(n,i){var o=i||{},l=o.dense?[]:{},c=n.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(u,A){Array.isArray(l)&&(l[A]=[]);for(var h=/\\\w+\b/g,f=0,p,m=-1;p=h.exec(u);){switch(p[0]){case"\\cell":var g=u.slice(f,h.lastIndex-p[0].length);if(g[0]==" "&&(g=g.slice(1)),++m,g.length){var y={v:g,t:"s"};Array.isArray(l)?l[A][m]=y:l[Fr({r:A,c:m})]=y}break}f=h.lastIndex}m>d.e.c&&(d.e.c=m)}),l["!ref"]=Gr(d),l}function r(n,i){return xh(t(n,i),i)}function s(n){for(var i=["{\\rtf1\\ansi"],o=bs(n["!ref"]),l,c=Array.isArray(n),d=o.s.r;d<=o.e.r;++d){i.push("\\trowd\\trautofit1");for(var u=o.s.c;u<=o.e.c;++u)i.push("\\cellx"+(u+1));for(i.push("\\pard\\intbl"),u=o.s.c;u<=o.e.c;++u){var A=Fr({r:d,c:u});l=c?(n[d]||[])[u]:n[A],!(!l||l.v==null&&(!l.f||l.F))&&(i.push(" "+(l.w||(iu(l),l.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:s}}();function ele(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function py(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function tle(t){var e=t[0]/255,r=t[1]/255,s=t[2]/255,n=Math.max(e,r,s),i=Math.min(e,r,s),o=n-i;if(o===0)return[0,0,e];var l=0,c=0,d=n+i;switch(c=o/(d>1?2-d:d),n){case e:l=((r-s)/o+6)%6;break;case r:l=(s-e)/o+2;break;case s:l=(e-r)/o+4;break}return[l/6,c,d/2]}function rle(t){var e=t[0],r=t[1],s=t[2],n=r*2*(s<.5?s:1-s),i=s-n/2,o=[i,i,i],l=6*e,c;if(r!==0)switch(l|0){case 0:case 6:c=n*l,o[0]+=n,o[1]+=c;break;case 1:c=n*(2-l),o[0]+=c,o[1]+=n;break;case 2:c=n*(l-2),o[1]+=n,o[2]+=c;break;case 3:c=n*(4-l),o[1]+=c,o[2]+=n;break;case 4:c=n*(l-4),o[2]+=n,o[0]+=c;break;case 5:c=n*(6-l),o[2]+=c,o[0]+=n;break}for(var d=0;d!=3;++d)o[d]=Math.round(o[d]*255);return o}function a2(t,e){if(e===0)return t;var r=tle(ele(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),py(rle(r))}var A9=6,sle=15,nle=1,Si=A9;function gy(t){return Math.floor((t+Math.round(128/Si)/256)*Si)}function xy(t){return Math.floor((t-5)/Si*100+.5)/100}function i2(t){return Math.round((t*Si+5)/Si*256)/256}function oC(t){return i2(xy(gy(t)))}function O_(t){var e=Math.abs(t-oC(t)),r=Si;if(e>.005)for(Si=nle;Si<sle;++Si)Math.abs(t-oC(t))<=e&&(e=Math.abs(t-oC(t)),r=Si);Si=r}function ZA(t){t.width?(t.wpx=gy(t.width),t.wch=xy(t.wpx),t.MDW=Si):t.wpx?(t.wch=xy(t.wpx),t.width=i2(t.wch),t.MDW=Si):typeof t.wch=="number"&&(t.width=i2(t.wch),t.wpx=gy(t.width),t.MDW=Si),t.customWidth&&delete t.customWidth}var ale=96,h9=ale;function yy(t){return t*96/h9}function wp(t){return t*h9/96}var ile={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function ole(t,e,r,s){e.Borders=[];var n={},i=!1;(t[0].match(Oi)||[]).forEach(function(o){var l=Rr(o);switch(id(l[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":n={},l.diagonalUp&&(n.diagonalUp=un(l.diagonalUp)),l.diagonalDown&&(n.diagonalDown=un(l.diagonalDown)),e.Borders.push(n);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s&&s.WTF&&!i)throw new Error("unrecognized "+l[0]+" in borders")}})}function lle(t,e,r,s){e.Fills=[];var n={},i=!1;(t[0].match(Oi)||[]).forEach(function(o){var l=Rr(o);switch(id(l[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":n={},e.Fills.push(n);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(n),n={};break;case"<patternFill":case"<patternFill>":l.patternType&&(n.patternType=l.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":n.bgColor||(n.bgColor={}),l.indexed&&(n.bgColor.indexed=parseInt(l.indexed,10)),l.theme&&(n.bgColor.theme=parseInt(l.theme,10)),l.tint&&(n.bgColor.tint=parseFloat(l.tint)),l.rgb&&(n.bgColor.rgb=l.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":n.fgColor||(n.fgColor={}),l.theme&&(n.fgColor.theme=parseInt(l.theme,10)),l.tint&&(n.fgColor.tint=parseFloat(l.tint)),l.rgb!=null&&(n.fgColor.rgb=l.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s&&s.WTF&&!i)throw new Error("unrecognized "+l[0]+" in fills")}})}function cle(t,e,r,s){e.Fonts=[];var n={},i=!1;(t[0].match(Oi)||[]).forEach(function(o){var l=Rr(o);switch(id(l[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(n),n={};break;case"<name":l.val&&(n.name=Ks(l.val));break;case"<name/>":case"</name>":break;case"<b":n.bold=l.val?un(l.val):1;break;case"<b/>":n.bold=1;break;case"<i":n.italic=l.val?un(l.val):1;break;case"<i/>":n.italic=1;break;case"<u":switch(l.val){case"none":n.underline=0;break;case"single":n.underline=1;break;case"double":n.underline=2;break;case"singleAccounting":n.underline=33;break;case"doubleAccounting":n.underline=34;break}break;case"<u/>":n.underline=1;break;case"<strike":n.strike=l.val?un(l.val):1;break;case"<strike/>":n.strike=1;break;case"<outline":n.outline=l.val?un(l.val):1;break;case"<outline/>":n.outline=1;break;case"<shadow":n.shadow=l.val?un(l.val):1;break;case"<shadow/>":n.shadow=1;break;case"<condense":n.condense=l.val?un(l.val):1;break;case"<condense/>":n.condense=1;break;case"<extend":n.extend=l.val?un(l.val):1;break;case"<extend/>":n.extend=1;break;case"<sz":l.val&&(n.sz=+l.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":l.val&&(n.vertAlign=l.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":l.val&&(n.family=parseInt(l.val,10));break;case"<family/>":case"</family>":break;case"<scheme":l.val&&(n.scheme=l.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(l.val=="1")break;l.codepage=A_[parseInt(l.val,10)];break;case"<color":if(n.color||(n.color={}),l.auto&&(n.color.auto=un(l.auto)),l.rgb)n.color.rgb=l.rgb.slice(-6);else if(l.indexed){n.color.index=parseInt(l.indexed,10);var c=ff[n.color.index];n.color.index==81&&(c=ff[1]),c||(c=ff[1]),n.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else l.theme&&(n.color.theme=parseInt(l.theme,10),l.tint&&(n.color.tint=parseFloat(l.tint)),l.theme&&r.themeElements&&r.themeElements.clrScheme&&(n.color.rgb=a2(r.themeElements.clrScheme[n.color.theme].rgb,n.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s&&s.WTF&&!i)throw new Error("unrecognized "+l[0]+" in fonts")}})}function dle(t,e,r){e.NumberFmt=[];for(var s=Qn(Ir),n=0;n<s.length;++n)e.NumberFmt[s[n]]=Ir[s[n]];var i=t[0].match(Oi);if(i)for(n=0;n<i.length;++n){var o=Rr(i[n]);switch(id(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var l=vs(Ks(o.formatCode)),c=parseInt(o.numFmtId,10);if(e.NumberFmt[c]=l,c>0){if(c>392){for(c=392;c>60&&e.NumberFmt[c]!=null;--c);e.NumberFmt[c]=l}qd(l,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function ule(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var s=r[0];s<=r[1];++s)t[s]!=null&&(e[e.length]=er("numFmt",null,{numFmtId:s,formatCode:Os(t[s])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=er("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var b1=["numFmtId","fillId","fontId","borderId","xfId"],w1=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function Ale(t,e,r){e.CellXf=[];var s,n=!1;(t[0].match(Oi)||[]).forEach(function(i){var o=Rr(i),l=0;switch(id(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(s=o,delete s[0],l=0;l<b1.length;++l)s[b1[l]]&&(s[b1[l]]=parseInt(s[b1[l]],10));for(l=0;l<w1.length;++l)s[w1[l]]&&(s[w1[l]]=un(s[w1[l]]));if(e.NumberFmt&&s.numFmtId>392){for(l=392;l>60;--l)if(e.NumberFmt[s.numFmtId]==e.NumberFmt[l]){s.numFmtId=l;break}}e.CellXf.push(s);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};o.vertical&&(c.vertical=o.vertical),o.horizontal&&(c.horizontal=o.horizontal),o.textRotation!=null&&(c.textRotation=o.textRotation),o.indent&&(c.indent=o.indent),o.wrapText&&(c.wrapText=un(o.wrapText)),s.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":n=!0;break;case"</AlternateContent>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(r&&r.WTF&&!n)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function hle(t){var e=[];return e[e.length]=er("cellXfs",null),t.forEach(function(r){e[e.length]=er("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=er("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var fle=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,s=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,n=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(l,c,d){var u={};if(!l)return u;l=l.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var A;return(A=l.match(e))&&dle(A,u,d),(A=l.match(n))&&cle(A,u,c,d),(A=l.match(s))&&lle(A,u,c,d),(A=l.match(i))&&ole(A,u,c,d),(A=l.match(r))&&Ale(A,u,d),u}}();function f9(t,e){var r=[oa,er("styleSheet",null,{xmlns:em[0],"xmlns:vt":Na.vt})],s;return t.SSF&&(s=ule(t.SSF))!=null&&(r[r.length]=s),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(s=hle(e.cellXfs))&&(r[r.length]=s),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function mle(t,e){var r=t.read_shift(2),s=Fi(t);return[r,s]}function ple(t,e,r){r||(r=It(6+4*e.length)),r.write_shift(2,t),Ha(e,r);var s=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),s}function gle(t,e,r){var s={};s.sz=t.read_shift(2)/20;var n=Jne(t);n.fItalic&&(s.italic=1),n.fCondense&&(s.condense=1),n.fExtend&&(s.extend=1),n.fShadow&&(s.shadow=1),n.fOutline&&(s.outline=1),n.fStrikeout&&(s.strike=1);var i=t.read_shift(2);switch(i===700&&(s.bold=1),t.read_shift(2)){case 1:s.vertAlign="superscript";break;case 2:s.vertAlign="subscript";break}var o=t.read_shift(1);o!=0&&(s.underline=o);var l=t.read_shift(1);l>0&&(s.family=l);var c=t.read_shift(1);switch(c>0&&(s.charset=c),t.l++,s.color=Xne(t),t.read_shift(1)){case 1:s.scheme="major";break;case 2:s.scheme="minor";break}return s.name=Fi(t),s}function xle(t,e){e||(e=It(25+4*32)),e.write_shift(2,t.sz*20),Zne(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),r2(t.color,e);var s=0;return s=2,e.write_shift(1,s),Ha(t.name,e),e.length>e.l?e.slice(0,e.l):e}var yle=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],lC,vle=Ri;function xF(t,e){e||(e=It(4*3+8*7+16*1)),lC||(lC=wN(yle));var r=lC[t.patternType];r==null&&(r=40),e.write_shift(4,r);var s=0;if(r!=40)for(r2({auto:1},e),r2({auto:1},e);s<12;++s)e.write_shift(4,0);else{for(;s<4;++s)e.write_shift(4,0);for(;s<12;++s)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function ble(t,e){var r=t.l+e,s=t.read_shift(2),n=t.read_shift(2);return t.l=r,{ixfe:s,numFmtId:n}}function m9(t,e,r){r||(r=It(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var s=0;return r.write_shift(1,s),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function vg(t,e){return e||(e=It(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var wle=Ri;function Nle(t,e){return e||(e=It(51)),e.write_shift(1,0),vg(null,e),vg(null,e),vg(null,e),vg(null,e),vg(null,e),e.length>e.l?e.slice(0,e.l):e}function Cle(t,e){return e||(e=It(12+4*10)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),t2(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function jle(t,e,r){var s=It(2052);return s.write_shift(4,t),t2(e,s),t2(r,s),s.length>s.l?s.slice(0,s.l):s}function Sle(t,e,r){var s={};s.NumberFmt=[];for(var n in Ir)s.NumberFmt[n]=Ir[n];s.CellXf=[],s.Fonts=[];var i=[],o=!1;return mu(t,function(c,d,u){switch(u){case 44:s.NumberFmt[c[0]]=c[1],qd(c[1],c[0]);break;case 43:s.Fonts.push(c),c.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(c.color.rgb=a2(e.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&s.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:i.push(u),o=!0;break;case 38:i.pop(),o=!1;break;default:if(d.T>0)i.push(u);else if(d.T<0)i.pop();else if(!o||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),s}function Ele(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var n=s[0];n<=s[1];++n)e[n]!=null&&++r}),r!=0&&(Mt(t,615,hc(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var n=s[0];n<=s[1];++n)e[n]!=null&&Mt(t,44,ple(n,e[n]))}),Mt(t,616))}}function _le(t){var e=1;Mt(t,611,hc(e)),Mt(t,43,xle({sz:12,color:{theme:1},name:"Calibri",family:2})),Mt(t,612)}function Tle(t){var e=2;Mt(t,603,hc(e)),Mt(t,45,xF({patternType:"none"})),Mt(t,45,xF({patternType:"gray125"})),Mt(t,604)}function Ile(t){var e=1;Mt(t,613,hc(e)),Mt(t,46,Nle()),Mt(t,614)}function kle(t){var e=1;Mt(t,626,hc(e)),Mt(t,47,m9({numFmtId:0},65535)),Mt(t,627)}function Ble(t,e){Mt(t,617,hc(e.length)),e.forEach(function(r){Mt(t,47,m9(r,0))}),Mt(t,618)}function Fle(t){var e=1;Mt(t,619,hc(e)),Mt(t,48,Cle({xfId:0,name:"Normal"})),Mt(t,620)}function Ple(t){var e=0;Mt(t,505,hc(e)),Mt(t,506)}function Dle(t){var e=0;Mt(t,508,jle(e,"TableStyleMedium9","PivotStyleMedium4")),Mt(t,509)}function Rle(t,e){var r=jo();return Mt(r,278),Ele(r,t.SSF),_le(r),Tle(r),Ile(r),kle(r),Ble(r,e.cellXfs),Fle(r),Ple(r),Dle(r),Mt(r,279),r.end()}var Lle=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function Ole(t,e,r){e.themeElements.clrScheme=[];var s={};(t[0].match(Oi)||[]).forEach(function(n){var i=Rr(n);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":s.rgb=i.val;break;case"<a:sysClr":s.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(e.themeElements.clrScheme[Lle.indexOf(i[0])]=s,s={}):s.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function Ule(){}function Mle(){}var Qle=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,Vle=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,Hle=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function $le(t,e,r){e.themeElements={};var s;[["clrScheme",Qle,Ole],["fontScheme",Vle,Ule],["fmtScheme",Hle,Mle]].forEach(function(n){if(!(s=t.match(n[1])))throw new Error(n[0]+" not found in themeElements");n[2](s,e,r)})}var Kle=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function p9(t,e){(!t||t.length===0)&&(t=U_());var r,s={};if(!(r=t.match(Kle)))throw new Error("themeElements not found in theme");return $le(r[0],s,e),s.raw=t,s}function U_(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[oa];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function zle(t,e,r){var s=t.l+e,n=t.read_shift(4);if(n!==124226){if(!r.cellStyles){t.l=s;return}var i=t.slice(t.l);t.l=s;var o;try{o=l7(i,{type:"array"})}catch{return}var l=Ho(o,"theme/theme/theme1.xml",!0);if(l)return p9(l,r)}}function qle(t){return t.read_shift(4)}function Wle(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=Gle(t,4);break;case 2:e.xclrValue=G7(t);break;case 3:e.xclrValue=qle(t);break;case 4:t.l+=4;break}return t.l+=8,e}function Gle(t,e){return Ri(t,e)}function Yle(t,e){return Ri(t,e)}function Xle(t){var e=t.read_shift(2),r=t.read_shift(2)-4,s=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:s[1]=Wle(t);break;case 6:s[1]=Yle(t,r);break;case 14:case 15:s[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return s}function Jle(t,e){var r=t.l+e;t.l+=2;var s=t.read_shift(2);t.l+=2;for(var n=t.read_shift(2),i=[];n-- >0;)i.push(Xle(t,r-t.l));return{ixfe:s,ext:i}}function Zle(t,e){e.forEach(function(r){switch(r[0]){}})}function ece(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:Fi(t)}}function tce(t){var e=It(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),Ha(t.name,e),e.slice(0,e.l)}function rce(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function sce(t){var e=It(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function nce(t,e){var r=It(8+2*e.length);return r.write_shift(4,t),Ha(e,r),r.slice(0,r.l)}function ace(t){return t.l+=4,t.read_shift(4)!=0}function ice(t,e){var r=It(8);return r.write_shift(4,t),r.write_shift(4,1),r}function oce(t,e,r){var s={Types:[],Cell:[],Value:[]},n=r||{},i=[],o=!1,l=2;return mu(t,function(c,d,u){switch(u){case 335:s.Types.push({name:c.name});break;case 51:c.forEach(function(A){l==1?s.Cell.push({type:s.Types[A[0]-1].name,index:A[1]}):l==0&&s.Value.push({type:s.Types[A[0]-1].name,index:A[1]})});break;case 337:l=c?1:0;break;case 338:l=2;break;case 35:i.push(u),o=!0;break;case 36:i.pop(),o=!1;break;default:if(!d.T){if(!o||n.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),s}function lce(){var t=jo();return Mt(t,332),Mt(t,334,hc(1)),Mt(t,335,tce({name:"XLDAPR",version:12e4,flags:3496657072})),Mt(t,336),Mt(t,339,nce(1,"XLDAPR")),Mt(t,52),Mt(t,35,hc(514)),Mt(t,4096,hc(0)),Mt(t,4097,vl(1)),Mt(t,36),Mt(t,53),Mt(t,340),Mt(t,337,ice(1)),Mt(t,51,sce([[1,0]])),Mt(t,338),Mt(t,333),t.end()}function cce(t,e,r){var s={Types:[],Cell:[],Value:[]};if(!t)return s;var n=!1,i=2,o;return t.replace(Oi,function(l){var c=Rr(l);switch(id(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":s.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var d=0;d<s.Types.length;++d)s.Types[d].name==c.name&&(o=s.Types[d]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?s.Cell.push({type:s.Types[c.t-1].name,index:+c.v}):i==0&&s.Value.push({type:s.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+c.i);break;default:if(!n&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return l}),s}function g9(){var t=[oa];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function dce(t){var e=[];if(!t)return e;var r=1;return(t.match(Oi)||[]).forEach(function(s){var n=Rr(s);switch(n[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete n[0],n.i?r=n.i:n.i=r,e.push(n);break}}),e}function uce(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=Fr(r);var s=t.read_shift(1);return s&2&&(e.l="1"),s&8&&(e.a="1"),e}function Ace(t,e,r){var s=[];return mu(t,function(i,o,l){switch(l){case 63:s.push(i);break;default:if(!o.T)throw new Error("Unexpected record 0x"+l.toString(16))}}),s}function hce(t,e,r,s){if(!t)return t;var n=s||{},i=!1;mu(t,function(l,c,d){switch(d){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!c.T){if(!i||n.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}},n)}function fce(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}var b0=1024;function x9(t,e){for(var r=[21600,21600],s=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),n=[er("xml",null,{"xmlns:v":Mo.v,"xmlns:o":Mo.o,"xmlns:x":Mo.x,"xmlns:mv":Mo.mv}).replace(/\/>/,">"),er("o:shapelayout",er("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),er("v:shapetype",[er("v:stroke",null,{joinstyle:"miter"}),er("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:s})];b0<t*1e3;)b0+=1e3;return e.forEach(function(i){var o=En(i[0]),l={color2:"#BEFF82",type:"gradient"};l.type=="gradient"&&(l.angle="-180");var c=l.type=="gradient"?er("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,d=er("v:fill",c,l),u={on:"t",obscured:"t"};++b0,n=n.concat(["<v:shape"+hy({id:"_x0000_s"+b0,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",d,er("v:shadow",null,u),er("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",ri("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),ri("x:AutoFill","False"),ri("x:Row",String(o.r)),ri("x:Column",String(o.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),n.push("</xml>"),n.join("")}function yF(t,e,r,s){var n=Array.isArray(t),i;e.forEach(function(o){var l=En(o.ref);if(n?(t[l.r]||(t[l.r]=[]),i=t[l.r][l.c]):i=t[o.ref],!i){i={t:"z"},n?t[l.r][l.c]=i:t[o.ref]=i;var c=bs(t["!ref"]||"BDWGO1000001:A1");c.s.r>l.r&&(c.s.r=l.r),c.e.r<l.r&&(c.e.r=l.r),c.s.c>l.c&&(c.s.c=l.c),c.e.c<l.c&&(c.e.c=l.c);var d=Gr(c);d!==t["!ref"]&&(t["!ref"]=d)}i.c||(i.c=[]);var u={a:o.author,t:o.t,r:o.r,T:r};o.h&&(u.h=o.h);for(var A=i.c.length-1;A>=0;--A){if(!r&&i.c[A].T)return;r&&!i.c[A].T&&i.c.splice(A,1)}if(r&&s){for(A=0;A<s.length;++A)if(u.a==s[A].id){u.a=s[A].name||u.a;break}}i.c.push(u)})}function mce(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],s=[],n=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);n&&n[1]&&n[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?author[^>]*>(.*)/);l&&r.push(l[1])}});var i=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?comment[^>]*>/);if(l){var c=Rr(l[0]),d={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},u=En(c.ref);if(!(e.sheetRows&&e.sheetRows<=u.r)){var A=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!A&&!!A[1]&&R_(A[1])||{r:"",t:"",h:""};d.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),d.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(d.h=h.h),s.push(d)}}}}),s}function y9(t){var e=[oa,er("comments",null,{xmlns:em[0]})],r=[];return e.push("<authors>"),t.forEach(function(s){s[1].forEach(function(n){var i=Os(n.a);r.indexOf(i)==-1&&(r.push(i),e.push("<author>"+i+"</author>")),n.T&&n.ID&&r.indexOf("tc="+n.ID)==-1&&(r.push("tc="+n.ID),e.push("<author>tc="+n.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(s){var n=0,i=[];if(s[1][0]&&s[1][0].T&&s[1][0].ID?n=r.indexOf("tc="+s[1][0].ID):s[1].forEach(function(c){c.a&&(n=r.indexOf(Os(c.a))),i.push(c.t||"")}),e.push('<comment ref="'+s[0]+'" authorId="'+n+'"><text>'),i.length<=1)e.push(ri("t",Os(i[0]||"")));else{for(var o=`Comment:
    `+i[0]+`
`,l=1;l<i.length;++l)o+=`Reply:
    `+i[l]+`
`;e.push(ri("t",Os(o)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function pce(t,e){var r=[],s=!1,n={},i=0;return t.replace(Oi,function(l,c){var d=Rr(l);switch(id(d[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":n={author:d.personId,guid:d.id,ref:d.ref,T:1};break;case"</threadedComment>":n.t!=null&&r.push(n);break;case"<text>":case"<text":i=c+l.length;break;case"</text>":n.t=t.slice(i,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":s=!0;break;case"</mentions>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(!s&&e.WTF)throw new Error("unrecognized "+d[0]+" in threaded comments")}return l}),r}function gce(t,e,r){var s=[oa,er("ThreadedComments",null,{xmlns:Na.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(n){var i="";(n[1]||[]).forEach(function(o,l){if(!o.T){delete o.ID;return}o.a&&e.indexOf(o.a)==-1&&e.push(o.a);var c={ref:n[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};l==0?i=c.id:c.parentId=i,o.ID=c.id,o.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(o.a)).slice(-12)+"}"),s.push(er("threadedComment",ri("text",o.t||""),c))})}),s.push("</ThreadedComments>"),s.join("")}function xce(t,e){var r=[],s=!1;return t.replace(Oi,function(i){var o=Rr(i);switch(id(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(!s&&e.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return i}),r}function yce(t){var e=[oa,er("personList",null,{xmlns:Na.TCMNT,"xmlns:x":em[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,s){e.push(er("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+s).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function vce(t){var e={};e.iauthor=t.read_shift(4);var r=nm(t);return e.rfx=r.s,e.ref=Fr(r.s),t.l+=16,e}function bce(t,e){return e==null&&(e=It(36)),e.write_shift(4,t[1].iauthor),Up(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var wce=Fi;function Nce(t){return Ha(t.slice(0,54))}function Cce(t,e){var r=[],s=[],n={},i=!1;return mu(t,function(l,c,d){switch(d){case 632:s.push(l);break;case 635:n=l;break;case 637:n.t=l.t,n.h=l.h,n.r=l.r;break;case 636:if(n.author=s[n.iauthor],delete n.iauthor,e.sheetRows&&n.rfx&&e.sheetRows<=n.rfx.r)break;n.t||(n.t=""),delete n.rfx,r.push(n);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!i||e.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}),r}function jce(t){var e=jo(),r=[];return Mt(e,628),Mt(e,630),t.forEach(function(s){s[1].forEach(function(n){r.indexOf(n.a)>-1||(r.push(n.a.slice(0,54)),Mt(e,632,Nce(n.a)))})}),Mt(e,631),Mt(e,633),t.forEach(function(s){s[1].forEach(function(n){n.iauthor=r.indexOf(n.a);var i={s:En(s[0]),e:En(s[0])};Mt(e,635,bce([i,n])),n.t&&n.t.length>0&&Mt(e,637,qne(n)),Mt(e,636),delete n.iauthor})}),Mt(e,634),Mt(e,629),e.end()}var Sce="application/vnd.ms-office.vbaProject";function Ece(t){var e=Cr.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,s){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var n=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Cr.utils.cfb_add(e,n,t.FileIndex[s].content)}}),Cr.write(e)}function _ce(t,e){e.FullPaths.forEach(function(r,s){if(s!=0){var n=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");n.slice(-1)!=="/"&&Cr.utils.cfb_add(t,n,e.FileIndex[s].content)}})}var v9=["xlsb","xlsm","xlam","biff8","xla"];function Tce(){return{"!type":"dialog"}}function Ice(){return{"!type":"dialog"}}function kce(){return{"!type":"macro"}}function Bce(){return{"!type":"macro"}}var M0=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(s,n,i,o){var l=!1,c=!1;i.length==0?c=!0:i.charAt(0)=="["&&(c=!0,i=i.slice(1,-1)),o.length==0?l=!0:o.charAt(0)=="["&&(l=!0,o=o.slice(1,-1));var d=i.length>0?parseInt(i,10)|0:0,u=o.length>0?parseInt(o,10)|0:0;return l?u+=e.c:--u,c?d+=e.r:--d,n+(l?"":"$")+Sn(u)+(c?"":"$")+na(d)}return function(n,i){return e=i,n.replace(t,r)}}(),M_=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Q_=function(){return function(e,r){return e.replace(M_,function(s,n,i,o,l,c){var d=E_(o)-(i?0:r.c),u=S_(c)-(l?0:r.r),A=u==0?"":l?u+1:"["+u+"]",h=d==0?"":i?d+1:"["+d+"]";return n+"R"+A+"C"+h})}}();function b9(t,e){return t.replace(M_,function(r,s,n,i,o,l){return s+(n=="$"?n+i:Sn(E_(i)+e.c))+(o=="$"?o+l:na(S_(l)+e.r))})}function Fce(t,e,r){var s=So(e),n=s.s,i=En(r),o={r:i.r-n.r,c:i.c-n.c};return b9(t,o)}function Pce(t){return t.length!=1}function vF(t){return t.replace(/_xlfn\./g,"")}function da(t){t.l+=1}function eh(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function w9(t,e,r){var s=2;if(r){if(r.biff>=2&&r.biff<=5)return N9(t);r.biff==12&&(s=4)}var n=t.read_shift(s),i=t.read_shift(s),o=eh(t),l=eh(t);return{s:{r:n,c:o[0],cRel:o[1],rRel:o[2]},e:{r:i,c:l[0],cRel:l[1],rRel:l[2]}}}function N9(t){var e=eh(t),r=eh(t),s=t.read_shift(1),n=t.read_shift(1);return{s:{r:e[0],c:s,cRel:e[1],rRel:e[2]},e:{r:r[0],c:n,cRel:r[1],rRel:r[2]}}}function Dce(t,e,r){if(r.biff<8)return N9(t);var s=t.read_shift(r.biff==12?4:2),n=t.read_shift(r.biff==12?4:2),i=eh(t),o=eh(t);return{s:{r:s,c:i[0],cRel:i[1],rRel:i[2]},e:{r:n,c:o[0],cRel:o[1],rRel:o[2]}}}function C9(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return Rce(t);var s=t.read_shift(r&&r.biff==12?4:2),n=eh(t);return{r:s,c:n[0],cRel:n[1],rRel:n[2]}}function Rce(t){var e=eh(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function Lce(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function Oce(t,e,r){var s=r&&r.biff?r.biff:8;if(s>=2&&s<=5)return Uce(t);var n=t.read_shift(s>=12?4:2),i=t.read_shift(2),o=(i&16384)>>14,l=(i&32768)>>15;if(i&=16383,l==1)for(;n>524287;)n-=1048576;if(o==1)for(;i>8191;)i=i-16384;return{r:n,c:i,cRel:o,rRel:l}}function Uce(t){var e=t.read_shift(2),r=t.read_shift(1),s=(e&32768)>>15,n=(e&16384)>>14;return e&=16383,s==1&&e>=8192&&(e=e-16384),n==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:n,rRel:s}}function Mce(t,e,r){var s=(t[t.l++]&96)>>5,n=w9(t,r.biff>=2&&r.biff<=5?6:8,r);return[s,n]}function Qce(t,e,r){var s=(t[t.l++]&96)>>5,n=t.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:t.l+=12,i=6;break;case 12:i=12;break}var o=w9(t,i,r);return[s,n,o]}function Vce(t,e,r){var s=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[s]}function Hce(t,e,r){var s=(t[t.l++]&96)>>5,n=t.read_shift(2),i=8;if(r)switch(r.biff){case 5:t.l+=12,i=6;break;case 12:i=12;break}return t.l+=i,[s,n]}function $ce(t,e,r){var s=(t[t.l++]&96)>>5,n=Dce(t,e-1,r);return[s,n]}function Kce(t,e,r){var s=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[s]}function bF(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function zce(t,e,r){t.l+=2;for(var s=t.read_shift(r&&r.biff==2?1:2),n=[],i=0;i<=s;++i)n.push(t.read_shift(r&&r.biff==2?1:2));return n}function qce(t,e,r){var s=t[t.l+1]&255?1:0;return t.l+=2,[s,t.read_shift(r&&r.biff==2?1:2)]}function Wce(t,e,r){var s=t[t.l+1]&255?1:0;return t.l+=2,[s,t.read_shift(r&&r.biff==2?1:2)]}function Gce(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function Yce(t,e,r){var s=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[s]}function j9(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function Xce(t){return t.read_shift(2),j9(t)}function Jce(t){return t.read_shift(2),j9(t)}function Zce(t,e,r){var s=(t[t.l]&96)>>5;t.l+=1;var n=C9(t,0,r);return[s,n]}function ede(t,e,r){var s=(t[t.l]&96)>>5;t.l+=1;var n=Oce(t,0,r);return[s,n]}function tde(t,e,r){var s=(t[t.l]&96)>>5;t.l+=1;var n=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var i=C9(t,0,r);return[s,n,i]}function rde(t,e,r){var s=(t[t.l]&96)>>5;t.l+=1;var n=t.read_shift(r&&r.biff<=3?1:2);return[aue[n],_9[n],s]}function sde(t,e,r){var s=t[t.l++],n=t.read_shift(1),i=r&&r.biff<=3?[s==88?-1:0,t.read_shift(1)]:nde(t);return[n,(i[0]===0?_9:nue)[i[1]]]}function nde(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function ade(t,e,r){t.l+=r&&r.biff==2?3:4}function ide(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var s=t.read_shift(2),n=t.read_shift(r&&r.biff==2?1:2);return[s,n]}function ode(t){return t.l++,pu[t.read_shift(1)]}function lde(t){return t.l++,t.read_shift(2)}function cde(t){return t.l++,t.read_shift(1)!==0}function dde(t){return t.l++,_i(t)}function ude(t,e,r){return t.l++,iv(t,e-1,r)}function Ade(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Kn(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=pu[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=_i(t);break;case 2:r[1]=am(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function hde(t,e,r){for(var s=t.read_shift(r.biff==12?4:2),n=[],i=0;i!=s;++i)n.push((r.biff==12?nm:jN)(t));return n}function fde(t,e,r){var s=0,n=0;r.biff==12?(s=t.read_shift(4),n=t.read_shift(4)):(n=1+t.read_shift(1),s=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--s,--n==0&&(n=256));for(var i=0,o=[];i!=s&&(o[i]=[]);++i)for(var l=0;l!=n;++l)o[i][l]=Ade(t,r.biff);return o}function mde(t,e,r){var s=t.read_shift(1)>>>5&3,n=!r||r.biff>=8?4:2,i=t.read_shift(n);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[s,0,i]}function pde(t,e,r){if(r.biff==5)return gde(t);var s=t.read_shift(1)>>>5&3,n=t.read_shift(2),i=t.read_shift(4);return[s,n,i]}function gde(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var s=t.read_shift(2);return t.l+=12,[e,r,s]}function xde(t,e,r){var s=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var n=t.read_shift(r&&r.biff==2?1:2);return[s,n]}function yde(t,e,r){var s=t.read_shift(1)>>>5&3,n=t.read_shift(r&&r.biff==2?1:2);return[s,n]}function vde(t,e,r){var s=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[s]}function bde(t,e,r){var s=(t[t.l++]&96)>>5,n=t.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return t.l+=i,[s,n]}var wde=Ri,Nde=Ri,Cde=Ri;function lv(t,e,r){return t.l+=2,[Lce(t)]}function V_(t){return t.l+=6,[]}var jde=lv,Sde=V_,Ede=V_,_de=lv;function S9(t){return t.l+=2,[fa(t),t.read_shift(2)&1]}var Tde=lv,Ide=S9,kde=V_,Bde=lv,Fde=lv,Pde=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function Dde(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),s=t.read_shift(4),n=t.read_shift(2),i=t.read_shift(2),o=Pde[r>>2&31];return{ixti:e,coltype:r&3,rt:o,idx:s,c:n,C:i}}function Rde(t){return t.l+=2,[t.read_shift(4)]}function Lde(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function Ode(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function Ude(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function Mde(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function Qde(t){return t.l+=4,[0,0]}var wF={1:{n:"PtgExp",f:ide},2:{n:"PtgTbl",f:Cde},3:{n:"PtgAdd",f:da},4:{n:"PtgSub",f:da},5:{n:"PtgMul",f:da},6:{n:"PtgDiv",f:da},7:{n:"PtgPower",f:da},8:{n:"PtgConcat",f:da},9:{n:"PtgLt",f:da},10:{n:"PtgLe",f:da},11:{n:"PtgEq",f:da},12:{n:"PtgGe",f:da},13:{n:"PtgGt",f:da},14:{n:"PtgNe",f:da},15:{n:"PtgIsect",f:da},16:{n:"PtgUnion",f:da},17:{n:"PtgRange",f:da},18:{n:"PtgUplus",f:da},19:{n:"PtgUminus",f:da},20:{n:"PtgPercent",f:da},21:{n:"PtgParen",f:da},22:{n:"PtgMissArg",f:da},23:{n:"PtgStr",f:ude},26:{n:"PtgSheet",f:Lde},27:{n:"PtgEndSheet",f:Ode},28:{n:"PtgErr",f:ode},29:{n:"PtgBool",f:cde},30:{n:"PtgInt",f:lde},31:{n:"PtgNum",f:dde},32:{n:"PtgArray",f:Kce},33:{n:"PtgFunc",f:rde},34:{n:"PtgFuncVar",f:sde},35:{n:"PtgName",f:mde},36:{n:"PtgRef",f:Zce},37:{n:"PtgArea",f:Mce},38:{n:"PtgMemArea",f:xde},39:{n:"PtgMemErr",f:wde},40:{n:"PtgMemNoMem",f:Nde},41:{n:"PtgMemFunc",f:yde},42:{n:"PtgRefErr",f:vde},43:{n:"PtgAreaErr",f:Vce},44:{n:"PtgRefN",f:ede},45:{n:"PtgAreaN",f:$ce},46:{n:"PtgMemAreaN",f:Ude},47:{n:"PtgMemNoMemN",f:Mde},57:{n:"PtgNameX",f:pde},58:{n:"PtgRef3d",f:tde},59:{n:"PtgArea3d",f:Qce},60:{n:"PtgRefErr3d",f:bde},61:{n:"PtgAreaErr3d",f:Hce},255:{}},Vde={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Hde={1:{n:"PtgElfLel",f:S9},2:{n:"PtgElfRw",f:Bde},3:{n:"PtgElfCol",f:jde},6:{n:"PtgElfRwV",f:Fde},7:{n:"PtgElfColV",f:_de},10:{n:"PtgElfRadical",f:Tde},11:{n:"PtgElfRadicalS",f:kde},13:{n:"PtgElfColS",f:Sde},15:{n:"PtgElfColSV",f:Ede},16:{n:"PtgElfRadicalLel",f:Ide},25:{n:"PtgList",f:Dde},29:{n:"PtgSxName",f:Rde},255:{}},$de={0:{n:"PtgAttrNoop",f:Qde},1:{n:"PtgAttrSemi",f:Yce},2:{n:"PtgAttrIf",f:Wce},4:{n:"PtgAttrChoose",f:zce},8:{n:"PtgAttrGoto",f:qce},16:{n:"PtgAttrSum",f:ade},32:{n:"PtgAttrBaxcel",f:bF},33:{n:"PtgAttrBaxcel",f:bF},64:{n:"PtgAttrSpace",f:Xce},65:{n:"PtgAttrSpaceSemi",f:Jce},128:{n:"PtgAttrIfError",f:Gce},255:{}};function cv(t,e,r,s){if(s.biff<8)return Ri(t,e);for(var n=t.l+e,i=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=fde(t,0,s),i.push(r[o][1]);break;case"PtgMemArea":r[o][2]=hde(t,r[o][1],s),i.push(r[o][2]);break;case"PtgExp":s&&s.biff==12&&(r[o][1][1]=t.read_shift(4),i.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return e=n-t.l,e!==0&&i.push(Ri(t,e)),i}function dv(t,e,r){for(var s=t.l+e,n,i,o=[];s!=t.l;)e=s-t.l,i=t[t.l],n=wF[i]||wF[Vde[i]],(i===24||i===25)&&(n=(i===24?Hde:$de)[t[t.l+1]]),!n||!n.f?Ri(t,e):o.push([n.n,n.f(t,e,r)]);return o}function Kde(t){for(var e=[],r=0;r<t.length;++r){for(var s=t[r],n=[],i=0;i<s.length;++i){var o=s[i];if(o)switch(o[0]){case 2:n.push('"'+o[1].replace(/"/g,'""')+'"');break;default:n.push(o[1])}else n.push("")}e.push(n.join(","))}return e.join(";")}var zde={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function qde(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function E9(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var s=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!s)return"SH33TJSERR1";var n="";if(r.biff>8)switch(t[s[0]][0]){case 357:return n=s[1]==-1?"#REF":t.SheetNames[s[1]],s[1]==s[2]?n:n+":"+t.SheetNames[s[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[s[0]][0];case 355:default:return"SH33TJSSRC"+t[s[0]][0]}switch(t[s[0]][0][0]){case 1025:return n=s[1]==-1?"#REF":t.SheetNames[s[1]]||"SH33TJSERR3",s[1]==s[2]?n:n+":"+t.SheetNames[s[2]];case 14849:return t[s[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return t[s[0]][0][3]?(n=s[1]==-1?"#REF":t[s[0]][0][3][s[1]]||"SH33TJSERR4",s[1]==s[2]?n:n+":"+t[s[0]][0][3][s[2]]):"SH33TJSERR2"}}function NF(t,e,r){var s=E9(t,e,r);return s=="#REF"?s:qde(s,r)}function Ni(t,e,r,s,n){var i=n&&n.biff||8,o={s:{c:0,r:0}},l=[],c,d,u,A=0,h=0,f,p="";if(!t[0]||!t[0][0])return"";for(var m=-1,g="",y=0,v=t[0].length;y<v;++y){var x=t[0][y];switch(x[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=l.pop(),d=l.pop(),m>=0){switch(t[0][m][1][0]){case 0:g=Rn(" ",t[0][m][1][1]);break;case 1:g=Rn("\r",t[0][m][1][1]);break;default:if(g="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][m][1][0])}d=d+g,m=-1}l.push(d+zde[x[0]]+c);break;case"PtgIsect":c=l.pop(),d=l.pop(),l.push(d+" "+c);break;case"PtgUnion":c=l.pop(),d=l.pop(),l.push(d+","+c);break;case"PtgRange":c=l.pop(),d=l.pop(),l.push(d+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=xx(x[1][1],o,n),l.push(yx(u,i));break;case"PtgRefN":u=r?xx(x[1][1],r,n):x[1][1],l.push(yx(u,i));break;case"PtgRef3d":A=x[1][1],u=xx(x[1][2],o,n),p=NF(s,A,n),l.push(p+"!"+yx(u,i));break;case"PtgFunc":case"PtgFuncVar":var E=x[1][0],T=x[1][1];E||(E=0),E&=127;var j=E==0?[]:l.slice(-E);l.length-=E,T==="User"&&(T=j.shift()),l.push(T+"("+j.join(",")+")");break;case"PtgBool":l.push(x[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(x[1]);break;case"PtgNum":l.push(String(x[1]));break;case"PtgStr":l.push('"'+x[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(x[1]);break;case"PtgAreaN":f=JB(x[1][1],r?{s:r}:o,n),l.push(nC(f,n));break;case"PtgArea":f=JB(x[1][1],o,n),l.push(nC(f,n));break;case"PtgArea3d":A=x[1][1],f=x[1][2],p=NF(s,A,n),l.push(p+"!"+nC(f,n));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=x[1][2];var C=(s.names||[])[h-1]||(s[0]||[])[h],w=C?C.Name:"SH33TJSNAME"+String(h);w&&w.slice(0,6)=="_xlfn."&&!n.xlfn&&(w=w.slice(6)),l.push(w);break;case"PtgNameX":var S=x[1][1];h=x[1][2];var F;if(n.biff<=5)S<0&&(S=-S),s[S]&&(F=s[S][h]);else{var B="";if(((s[S]||[])[0]||[])[0]==14849||(((s[S]||[])[0]||[])[0]==1025?s[S][h]&&s[S][h].itab>0&&(B=s.SheetNames[s[S][h].itab-1]+"!"):B=s.SheetNames[h-1]+"!"),s[S]&&s[S][h])B+=s[S][h].Name;else if(s[0]&&s[0][h])B+=s[0][h].Name;else{var k=(E9(s,S,n)||"").split(";;");k[h-1]?B=k[h-1]:B+="SH33TJSERRX"}l.push(B);break}F||(F={Name:"SH33TJSERRY"}),l.push(F.Name);break;case"PtgParen":var D="(",q=")";if(m>=0){switch(g="",t[0][m][1][0]){case 2:D=Rn(" ",t[0][m][1][1])+D;break;case 3:D=Rn("\r",t[0][m][1][1])+D;break;case 4:q=Rn(" ",t[0][m][1][1])+q;break;case 5:q=Rn("\r",t[0][m][1][1])+q;break;default:if(n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][m][1][0])}m=-1}l.push(D+l.pop()+q);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":u={c:x[1][1],r:x[1][0]};var te={c:r.c,r:r.r};if(s.sharedf[Fr(u)]){var W=s.sharedf[Fr(u)];l.push(Ni(W,o,te,s,n))}else{var Q=!1;for(c=0;c!=s.arrayf.length;++c)if(d=s.arrayf[c],!(u.c<d[0].s.c||u.c>d[0].e.c)&&!(u.r<d[0].s.r||u.r>d[0].e.r)){l.push(Ni(d[1],o,te,s,n)),Q=!0;break}Q||l.push(x[1])}break;case"PtgArray":l.push("{"+Kde(x[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=y;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+x[1].idx+"[#"+x[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(x));default:throw new Error("Unrecognized Formula Token: "+String(x))}var re=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(n.biff!=3&&m>=0&&re.indexOf(t[0][y][0])==-1){x=t[0][m];var G=!0;switch(x[1][0]){case 4:G=!1;case 0:g=Rn(" ",x[1][1]);break;case 5:G=!1;case 1:g=Rn("\r",x[1][1]);break;default:if(g="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+x[1][0])}l.push((G?g:"")+l.pop()+(G?"":g)),m=-1}}if(l.length>1&&n.WTF)throw new Error("bad formula stack");return l[0]}function Wde(t,e,r){var s=t.l+e,n=r.biff==2?1:2,i,o=t.read_shift(n);if(o==65535)return[[],Ri(t,e-2)];var l=dv(t,o,r);return e!==o+n&&(i=cv(t,e-o-n,l,r)),t.l=s,[l,i]}function Gde(t,e,r){var s=t.l+e,n=r.biff==2?1:2,i,o=t.read_shift(n);if(o==65535)return[[],Ri(t,e-2)];var l=dv(t,o,r);return e!==o+n&&(i=cv(t,e-o-n,l,r)),t.l=s,[l,i]}function Yde(t,e,r,s){var n=t.l+e,i=dv(t,s,r),o;return n!==t.l&&(o=cv(t,n-t.l,i,r)),[i,o]}function Xde(t,e,r){var s=t.l+e,n,i=t.read_shift(2),o=dv(t,i,r);return i==65535?[[],Ri(t,e-2)]:(e!==i+2&&(n=cv(t,s-i-2,o,r)),[o,n])}function Jde(t){var e;if(Qd(t,t.l+6)!==65535)return[_i(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function Zde(t){if(t==null){var e=It(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return Hf(t);return Hf(0)}function cC(t,e,r){var s=t.l+e,n=od(t);r.biff==2&&++t.l;var i=Jde(t),o=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var l=Gde(t,s-t.l,r);return{cell:n,val:i[0],formula:l,shared:o>>3&1,tt:i[1]}}function eue(t,e,r,s,n){var i=Kf(e,r,n),o=Zde(t.v),l=It(6),c=33;l.write_shift(2,c),l.write_shift(4,0);for(var d=It(t.bf.length),u=0;u<t.bf.length;++u)d[u]=t.bf[u];var A=Va([i,o,l,d]);return A}function SN(t,e,r){var s=t.read_shift(4),n=dv(t,s,r),i=t.read_shift(4),o=i>0?cv(t,i,n,r):null;return[n,o]}var tue=SN,EN=SN,rue=SN,sue=SN,nue={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},_9={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},aue={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function CF(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function iue(t){var e="of:="+t.replace(M_,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function dC(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function oue(t){return t.replace(/\./,"!")}var bx={},Q0={},wx=typeof Map<"u";function H_(t,e,r){var s=0,n=t.length;if(r){if(wx?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var i=wx?r.get(e):r[e];s<i.length;++s)if(t[i[s]].t===e)return t.Count++,i[s]}}else for(;s<n;++s)if(t[s].t===e)return t.Count++,s;return t[n]={t:e},t.Count++,t.Unique++,r&&(wx?(r.has(e)||r.set(e,[]),r.get(e).push(n)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(n))),n}function _N(t,e){var r={min:t+1,max:t+1},s=-1;return e.MDW&&(Si=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?s=xy(e.wpx):e.wch!=null&&(s=e.wch),s>-1?(r.width=i2(s),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function gf(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function yh(t,e,r){var s=r.revssf[e.z!=null?e.z:"General"],n=60,i=t.length;if(s==null&&r.ssf){for(;n<392;++n)if(r.ssf[n]==null){qd(e.z,n),r.ssf[n]=e.z,r.revssf[e.z]=s=n;break}}for(n=0;n!=i;++n)if(t[n].numFmtId===s)return n;return t[i]={numFmtId:s,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function T9(t,e,r,s,n,i){try{s.cellNF&&(t.z=Ir[e])}catch(l){if(s.WTF)throw l}if(!(t.t==="z"&&!s.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=pn(t.v)),(!s||s.cellText!==!1)&&t.t!=="z")try{if(Ir[e]==null&&qd(nne[e]||"General",e),t.t==="e")t.w=t.w||pu[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=uy(t.v);else if(t.t==="d"){var o=_a(t.v);(o|0)===o?t.w=o.toString(10):t.w=uy(o)}else{if(t.v===void 0)return"";t.w=Qf(t.v,Q0)}else t.t==="d"?t.w=Ll(e,_a(t.v),Q0):t.w=Ll(e,t.v,Q0)}catch(l){if(s.WTF)throw l}if(s.cellStyles&&r!=null)try{t.s=i.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=a2(n.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),s.WTF&&(t.s.fgColor.raw_rgb=n.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=a2(n.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),s.WTF&&(t.s.bgColor.raw_rgb=n.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(l){if(s.WTF&&i.Fills)throw l}}}function lue(t,e,r){if(t&&t["!ref"]){var s=bs(t["!ref"]);if(s.e.c<s.s.c||s.e.r<s.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function cue(t,e){var r=bs(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=Gr(r))}var due=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,uue=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,Aue=/<(?:\w:)?hyperlink [^>]*>/mg,hue=/"(\w*:\w*)"/,fue=/<(?:\w:)?col\b[^>]*[\/]?>/g,mue=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,pue=/<(?:\w:)?pageMargins[^>]*\/>/g,I9=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,gue=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,xue=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function yue(t,e,r,s,n,i,o){if(!t)return t;s||(s={"!id":{}});var l=e.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},d="",u="",A=t.match(uue);A?(d=t.slice(0,A.index),u=t.slice(A.index+A[0].length)):d=u=t;var h=d.match(I9);h?$_(h[0],l,n,r):(h=d.match(gue))&&bue(h[0],h[1]||"",l,n,r);var f=(d.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(f>0){var p=d.slice(f,f+50).match(hue);p&&cue(l,p[1])}var m=d.match(xue);m&&m[1]&&Pue(m[1],n);var g=[];if(e.cellStyles){var y=d.match(fue);y&&Tue(g,y)}A&&Lue(A[1],l,e,c,i,o);var v=u.match(mue);v&&(l["!autofilter"]=kue(v[0]));var x=[],E=u.match(due);if(E)for(f=0;f!=E.length;++f)x[f]=bs(E[f].slice(E[f].indexOf('"')+1));var T=u.match(Aue);T&&Sue(l,T,s);var j=u.match(pue);if(j&&(l["!margins"]=Eue(Rr(j[0]))),!l["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(l["!ref"]=Gr(c)),e.sheetRows>0&&l["!ref"]){var C=bs(l["!ref"]);e.sheetRows<=+C.e.r&&(C.e.r=e.sheetRows-1,C.e.r>c.e.r&&(C.e.r=c.e.r),C.e.r<C.s.r&&(C.s.r=C.e.r),C.e.c>c.e.c&&(C.e.c=c.e.c),C.e.c<C.s.c&&(C.s.c=C.e.c),l["!fullref"]=l["!ref"],l["!ref"]=Gr(C))}return g.length>0&&(l["!cols"]=g),x.length>0&&(l["!merges"]=x),l}function vue(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+Gr(t[r])+'"/>';return e+"</mergeCells>"}function $_(t,e,r,s){var n=Rr(t);r.Sheets[s]||(r.Sheets[s]={}),n.codeName&&(r.Sheets[s].CodeName=vs(Ks(n.codeName)))}function bue(t,e,r,s,n){$_(t.slice(0,t.indexOf(">")),r,s,n)}function wue(t,e,r,s,n){var i=!1,o={},l=null;if(s.bookType!=="xlsx"&&e.vbaraw){var c=e.SheetNames[r];try{e.Workbook&&(c=e.Workbook.Sheets[r].CodeName||c)}catch{}i=!0,o.codeName=$c(Os(c))}if(t&&t["!outline"]){var d={summaryBelow:1,summaryRight:1};t["!outline"].above&&(d.summaryBelow=0),t["!outline"].left&&(d.summaryRight=0),l=(l||"")+er("outlinePr",null,d)}!i&&!l||(n[n.length]=er("sheetPr",l,o))}var Nue=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Cue=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function jue(t){var e={sheet:1};return Nue.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),Cue.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=L_(t.password).toString(16).toUpperCase()),er("sheetProtection",null,e)}function Sue(t,e,r){for(var s=Array.isArray(t),n=0;n!=e.length;++n){var i=Rr(Ks(e[n]),!0);if(!i.ref)return;var o=((r||{})["!id"]||[])[i.id];o?(i.Target=o.Target,i.location&&(i.Target+="#"+vs(i.location))):(i.Target="#"+vs(i.location),o={Target:i.Target,TargetMode:"Internal"}),i.Rel=o,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var l=bs(i.ref),c=l.s.r;c<=l.e.r;++c)for(var d=l.s.c;d<=l.e.c;++d){var u=Fr({c:d,r:c});s?(t[c]||(t[c]=[]),t[c][d]||(t[c][d]={t:"z",v:void 0}),t[c][d].l=i):(t[u]||(t[u]={t:"z",v:void 0}),t[u].l=i)}}}function Eue(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function _ue(t){return gf(t),er("pageMargins",null,t)}function Tue(t,e){for(var r=!1,s=0;s!=e.length;++s){var n=Rr(e[s],!0);n.hidden&&(n.hidden=un(n.hidden));var i=parseInt(n.min,10)-1,o=parseInt(n.max,10)-1;for(n.outlineLevel&&(n.level=+n.outlineLevel||0),delete n.min,delete n.max,n.width=+n.width,!r&&n.width&&(r=!0,O_(n.width)),ZA(n);i<=o;)t[i++]=gn(n)}}function Iue(t,e){for(var r=["<cols>"],s,n=0;n!=e.length;++n)(s=e[n])&&(r[r.length]=er("col",null,_N(n,s)));return r[r.length]="</cols>",r.join("")}function kue(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}function Bue(t,e,r,s){var n=typeof t.ref=="string"?t.ref:Gr(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,o=So(n);o.s.r==o.e.r&&(o.e.r=So(e["!ref"]).e.r,n=Gr(o));for(var l=0;l<i.length;++l){var c=i[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==s){c.Ref="'"+r.SheetNames[s]+"'!"+n;break}}return l==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:s,Ref:"'"+r.SheetNames[s]+"'!"+n}),er("autoFilter",null,{ref:n})}var Fue=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function Pue(t,e){e.Views||(e.Views=[{}]),(t.match(Fue)||[]).forEach(function(r,s){var n=Rr(r);e.Views[s]||(e.Views[s]={}),+n.zoomScale&&(e.Views[s].zoom=+n.zoomScale),un(n.rightToLeft)&&(e.Views[s].RTL=!0)})}function Due(t,e,r,s){var n={workbookViewId:"0"};return(((s||{}).Workbook||{}).Views||[])[0]&&(n.rightToLeft=s.Workbook.Views[0].RTL?"1":"0"),er("sheetViews",er("sheetView",null,n),{})}function Rue(t,e,r,s){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var n="",i=t.t,o=t.v;if(t.t!=="z")switch(t.t){case"b":n=t.v?"1":"0";break;case"n":n=""+t.v;break;case"e":n=pu[t.v];break;case"d":s&&s.cellDates?n=pn(t.v,-1).toISOString():(t=gn(t),t.t="n",n=""+(t.v=_a(pn(t.v)))),typeof t.z>"u"&&(t.z=Ir[14]);break;default:n=t.v;break}var l=ri("v",Os(n)),c={r:e},d=yh(s.cellXfs,t,s);switch(d!==0&&(c.s=d),t.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(s&&s.bookSST){l=ri("v",""+H_(s.Strings,t.v,s.revStrings)),c.t="s";break}c.t="str";break}if(t.t!=i&&(t.t=i,t.v=o),typeof t.f=="string"&&t.f){var u=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;l=er("f",Os(t.f),u)+(t.v!=null?l:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(c.cm=1),er("c",l,c)}var Lue=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,s=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,n=/ref=["']([^"']*)["']/,i=Ay("v"),o=Ay("f");return function(c,d,u,A,h,f){for(var p=0,m="",g=[],y=[],v=0,x=0,E=0,T="",j,C,w=0,S=0,F,B,k=0,D=0,q=Array.isArray(f.CellXf),te,W=[],Q=[],re=Array.isArray(d),G=[],Ae={},he=!1,I=!!u.sheetStubs,U=c.split(e),V=0,L=U.length;V!=L;++V){m=U[V].trim();var K=m.length;if(K!==0){var fe=0;e:for(p=0;p<K;++p)switch(m[p]){case">":if(m[p-1]!="/"){++p;break e}if(u&&u.cellStyles){if(C=Rr(m.slice(fe,p),!0),w=C.r!=null?parseInt(C.r,10):w+1,S=-1,u.sheetRows&&u.sheetRows<w)continue;Ae={},he=!1,C.ht&&(he=!0,Ae.hpt=parseFloat(C.ht),Ae.hpx=wp(Ae.hpt)),C.hidden=="1"&&(he=!0,Ae.hidden=!0),C.outlineLevel!=null&&(he=!0,Ae.level=+C.outlineLevel),he&&(G[w-1]=Ae)}break;case"<":fe=p;break}if(fe>=p)break;if(C=Rr(m.slice(fe,p),!0),w=C.r!=null?parseInt(C.r,10):w+1,S=-1,!(u.sheetRows&&u.sheetRows<w)){A.s.r>w-1&&(A.s.r=w-1),A.e.r<w-1&&(A.e.r=w-1),u&&u.cellStyles&&(Ae={},he=!1,C.ht&&(he=!0,Ae.hpt=parseFloat(C.ht),Ae.hpx=wp(Ae.hpt)),C.hidden=="1"&&(he=!0,Ae.hidden=!0),C.outlineLevel!=null&&(he=!0,Ae.level=+C.outlineLevel),he&&(G[w-1]=Ae)),g=m.slice(p).split(t);for(var ee=0;ee!=g.length&&g[ee].trim().charAt(0)=="<";++ee);for(g=g.slice(ee),p=0;p!=g.length;++p)if(m=g[p].trim(),m.length!==0){if(y=m.match(r),v=p,x=0,E=0,m="<c "+(m.slice(0,1)=="<"?">":"")+m,y!=null&&y.length===2){for(v=0,T=y[1],x=0;x!=T.length&&!((E=T.charCodeAt(x)-64)<1||E>26);++x)v=26*v+E;--v,S=v}else++S;for(x=0;x!=m.length&&m.charCodeAt(x)!==62;++x);if(++x,C=Rr(m.slice(0,x),!0),C.r||(C.r=Fr({r:w-1,c:S})),T=m.slice(x),j={t:""},(y=T.match(i))!=null&&y[1]!==""&&(j.v=vs(y[1])),u.cellFormula){if((y=T.match(o))!=null&&y[1]!==""){if(j.f=vs(Ks(y[1])).replace(/\r\n/g,`
`),u.xlfn||(j.f=vF(j.f)),y[0].indexOf('t="array"')>-1)j.F=(T.match(n)||[])[1],j.F.indexOf(":")>-1&&W.push([bs(j.F),j.F]);else if(y[0].indexOf('t="shared"')>-1){B=Rr(y[0]);var de=vs(Ks(y[1]));u.xlfn||(de=vF(de)),Q[parseInt(B.si,10)]=[B,de,C.r]}}else(y=T.match(/<f[^>]*\/>/))&&(B=Rr(y[0]),Q[B.si]&&(j.f=Fce(Q[B.si][1],Q[B.si][2],C.r)));var ue=En(C.r);for(x=0;x<W.length;++x)ue.r>=W[x][0].s.r&&ue.r<=W[x][0].e.r&&ue.c>=W[x][0].s.c&&ue.c<=W[x][0].e.c&&(j.F=W[x][1])}if(C.t==null&&j.v===void 0)if(j.f||j.F)j.v=0,j.t="n";else if(I)j.t="z";else continue;else j.t=C.t||"n";switch(A.s.c>S&&(A.s.c=S),A.e.c<S&&(A.e.c=S),j.t){case"n":if(j.v==""||j.v==null){if(!I)continue;j.t="z"}else j.v=parseFloat(j.v);break;case"s":if(typeof j.v>"u"){if(!I)continue;j.t="z"}else F=bx[parseInt(j.v,10)],j.v=F.t,j.r=F.r,u.cellHTML&&(j.h=F.h);break;case"str":j.t="s",j.v=j.v!=null?Ks(j.v):"",u.cellHTML&&(j.h=w_(j.v));break;case"inlineStr":y=T.match(s),j.t="s",y!=null&&(F=R_(y[1]))?(j.v=F.t,u.cellHTML&&(j.h=F.h)):j.v="";break;case"b":j.v=un(j.v);break;case"d":u.cellDates?j.v=pn(j.v,1):(j.v=_a(pn(j.v,1)),j.t="n");break;case"e":(!u||u.cellText!==!1)&&(j.w=j.v),j.v=B7[j.v];break}if(k=D=0,te=null,q&&C.s!==void 0&&(te=f.CellXf[C.s],te!=null&&(te.numFmtId!=null&&(k=te.numFmtId),u.cellStyles&&te.fillId!=null&&(D=te.fillId))),T9(j,k,D,u,h,f),u.cellDates&&q&&j.t=="n"&&Rp(Ir[k])&&(j.t="d",j.v=CN(j.v)),C.cm&&u.xlmeta){var Ie=(u.xlmeta.Cell||[])[+C.cm-1];Ie&&Ie.type=="XLDAPR"&&(j.D=!0)}if(re){var Y=En(C.r);d[Y.r]||(d[Y.r]=[]),d[Y.r][Y.c]=j}else d[C.r]=j}}}}G.length>0&&(d["!rows"]=G)}}();function Oue(t,e,r,s){var n=[],i=[],o=bs(t["!ref"]),l="",c,d="",u=[],A=0,h=0,f=t["!rows"],p=Array.isArray(t),m={r:d},g,y=-1;for(h=o.s.c;h<=o.e.c;++h)u[h]=Sn(h);for(A=o.s.r;A<=o.e.r;++A){for(i=[],d=na(A),h=o.s.c;h<=o.e.c;++h){c=u[h]+d;var v=p?(t[A]||[])[h]:t[c];v!==void 0&&(l=Rue(v,c,t,e))!=null&&i.push(l)}(i.length>0||f&&f[A])&&(m={r:d},f&&f[A]&&(g=f[A],g.hidden&&(m.hidden=1),y=-1,g.hpx?y=yy(g.hpx):g.hpt&&(y=g.hpt),y>-1&&(m.ht=y,m.customHeight=1),g.level&&(m.outlineLevel=g.level)),n[n.length]=er("row",i.join(""),m))}if(f)for(;A<f.length;++A)f&&f[A]&&(m={r:A+1},g=f[A],g.hidden&&(m.hidden=1),y=-1,g.hpx?y=yy(g.hpx):g.hpt&&(y=g.hpt),y>-1&&(m.ht=y,m.customHeight=1),g.level&&(m.outlineLevel=g.level),n[n.length]=er("row","",m));return n.join("")}function k9(t,e,r,s){var n=[oa,er("worksheet",null,{xmlns:em[0],"xmlns:r":Na.r})],i=r.SheetNames[t],o=0,l="",c=r.Sheets[i];c==null&&(c={});var d=c["!ref"]||"A1",u=bs(d);if(u.e.c>16383||u.e.r>1048575){if(e.WTF)throw new Error("Range "+d+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),d=Gr(u)}s||(s={}),c["!comments"]=[];var A=[];wue(c,r,t,e,n),n[n.length]=er("dimension",null,{ref:d}),n[n.length]=Due(c,e,t,r),e.sheetFormat&&(n[n.length]=er("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(n[n.length]=Iue(c,c["!cols"])),n[o=n.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(l=Oue(c,e),l.length>0&&(n[n.length]=l)),n.length>o+1&&(n[n.length]="</sheetData>",n[o]=n[o].replace("/>",">")),c["!protect"]&&(n[n.length]=jue(c["!protect"])),c["!autofilter"]!=null&&(n[n.length]=Bue(c["!autofilter"],c,r,t)),c["!merges"]!=null&&c["!merges"].length>0&&(n[n.length]=vue(c["!merges"]));var h=-1,f,p=-1;return c["!links"].length>0&&(n[n.length]="<hyperlinks>",c["!links"].forEach(function(m){m[1].Target&&(f={ref:m[0]},m[1].Target.charAt(0)!="#"&&(p=Ds(s,-1,Os(m[1].Target).replace(/#.*$/,""),ts.HLINK),f["r:id"]="rId"+p),(h=m[1].Target.indexOf("#"))>-1&&(f.location=Os(m[1].Target.slice(h+1))),m[1].Tooltip&&(f.tooltip=Os(m[1].Tooltip)),n[n.length]=er("hyperlink",null,f))}),n[n.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(n[n.length]=_ue(c["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(n[n.length]=ri("ignoredErrors",er("ignoredError",null,{numberStoredAsText:1,sqref:d}))),A.length>0&&(p=Ds(s,-1,"../drawings/drawing"+(t+1)+".xml",ts.DRAW),n[n.length]=er("drawing",null,{"r:id":"rId"+p}),c["!drawing"]=A),c["!comments"].length>0&&(p=Ds(s,-1,"../drawings/vmlDrawing"+(t+1)+".vml",ts.VML),n[n.length]=er("legacyDrawing",null,{"r:id":"rId"+p}),c["!legacy"]=p),n.length>1&&(n[n.length]="</worksheet>",n[1]=n[1].replace("/>",">")),n.join("")}function Uue(t,e){var r={},s=t.l+e;r.r=t.read_shift(4),t.l+=4;var n=t.read_shift(2);t.l+=1;var i=t.read_shift(1);return t.l=s,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=n/20),r}function Mue(t,e,r){var s=It(145),n=(r["!rows"]||[])[t]||{};s.write_shift(4,t),s.write_shift(4,0);var i=320;n.hpx?i=yy(n.hpx)*20:n.hpt&&(i=n.hpt*20),s.write_shift(2,i),s.write_shift(1,0);var o=0;n.level&&(o|=n.level),n.hidden&&(o|=16),(n.hpx||n.hpt)&&(o|=32),s.write_shift(1,o),s.write_shift(1,0);var l=0,c=s.l;s.l+=4;for(var d={r:t,c:0},u=0;u<16;++u)if(!(e.s.c>u+1<<10||e.e.c<u<<10)){for(var A=-1,h=-1,f=u<<10;f<u+1<<10;++f){d.c=f;var p=Array.isArray(r)?(r[d.r]||[])[d.c]:r[Fr(d)];p&&(A<0&&(A=f),h=f)}A<0||(++l,s.write_shift(4,A),s.write_shift(4,h))}var m=s.l;return s.l=c,s.write_shift(4,l),s.l=m,s.length>s.l?s.slice(0,s.l):s}function Que(t,e,r,s){var n=Mue(s,r,e);(n.length>17||(e["!rows"]||[])[s])&&Mt(t,0,n)}var Vue=nm,Hue=Up;function $ue(){}function Kue(t,e){var r={},s=t[t.l];return++t.l,r.above=!(s&64),r.left=!(s&128),t.l+=18,r.name=Wne(t),r}function zue(t,e,r){r==null&&(r=It(84+4*t.length));var s=192;e&&(e.above&&(s&=-65),e.left&&(s&=-129)),r.write_shift(1,s);for(var n=1;n<3;++n)r.write_shift(1,0);return r2({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),E7(t,r),r.slice(0,r.l)}function que(t){var e=Ol(t);return[e]}function Wue(t,e,r){return r==null&&(r=It(8)),tm(e,r)}function Gue(t){var e=rm(t);return[e]}function Yue(t,e,r){return r==null&&(r=It(4)),sm(e,r)}function Xue(t){var e=Ol(t),r=t.read_shift(1);return[e,r,"b"]}function Jue(t,e,r){return r==null&&(r=It(9)),tm(e,r),r.write_shift(1,t.v?1:0),r}function Zue(t){var e=rm(t),r=t.read_shift(1);return[e,r,"b"]}function eAe(t,e,r){return r==null&&(r=It(5)),sm(e,r),r.write_shift(1,t.v?1:0),r}function tAe(t){var e=Ol(t),r=t.read_shift(1);return[e,r,"e"]}function rAe(t,e,r){return r==null&&(r=It(9)),tm(e,r),r.write_shift(1,t.v),r}function sAe(t){var e=rm(t),r=t.read_shift(1);return[e,r,"e"]}function nAe(t,e,r){return r==null&&(r=It(8)),sm(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function aAe(t){var e=Ol(t),r=t.read_shift(4);return[e,r,"s"]}function iAe(t,e,r){return r==null&&(r=It(12)),tm(e,r),r.write_shift(4,e.v),r}function oAe(t){var e=rm(t),r=t.read_shift(4);return[e,r,"s"]}function lAe(t,e,r){return r==null&&(r=It(8)),sm(e,r),r.write_shift(4,e.v),r}function cAe(t){var e=Ol(t),r=_i(t);return[e,r,"n"]}function dAe(t,e,r){return r==null&&(r=It(16)),tm(e,r),Hf(t.v,r),r}function B9(t){var e=rm(t),r=_i(t);return[e,r,"n"]}function uAe(t,e,r){return r==null&&(r=It(12)),sm(e,r),Hf(t.v,r),r}function AAe(t){var e=Ol(t),r=k_(t);return[e,r,"n"]}function hAe(t,e,r){return r==null&&(r=It(12)),tm(e,r),_7(t.v,r),r}function fAe(t){var e=rm(t),r=k_(t);return[e,r,"n"]}function mAe(t,e,r){return r==null&&(r=It(8)),sm(e,r),_7(t.v,r),r}function pAe(t){var e=Ol(t),r=__(t);return[e,r,"is"]}function gAe(t){var e=Ol(t),r=Fi(t);return[e,r,"str"]}function xAe(t,e,r){return r==null&&(r=It(12+4*t.v.length)),tm(e,r),Ha(t.v,r),r.length>r.l?r.slice(0,r.l):r}function yAe(t){var e=rm(t),r=Fi(t);return[e,r,"str"]}function vAe(t,e,r){return r==null&&(r=It(8+4*t.v.length)),sm(e,r),Ha(t.v,r),r.length>r.l?r.slice(0,r.l):r}function bAe(t,e,r){var s=t.l+e,n=Ol(t);n.r=r["!row"];var i=t.read_shift(1),o=[n,i,"b"];if(r.cellFormula){t.l+=2;var l=EN(t,s-t.l,r);o[3]=Ni(l,null,n,r.supbooks,r)}else t.l=s;return o}function wAe(t,e,r){var s=t.l+e,n=Ol(t);n.r=r["!row"];var i=t.read_shift(1),o=[n,i,"e"];if(r.cellFormula){t.l+=2;var l=EN(t,s-t.l,r);o[3]=Ni(l,null,n,r.supbooks,r)}else t.l=s;return o}function NAe(t,e,r){var s=t.l+e,n=Ol(t);n.r=r["!row"];var i=_i(t),o=[n,i,"n"];if(r.cellFormula){t.l+=2;var l=EN(t,s-t.l,r);o[3]=Ni(l,null,n,r.supbooks,r)}else t.l=s;return o}function CAe(t,e,r){var s=t.l+e,n=Ol(t);n.r=r["!row"];var i=Fi(t),o=[n,i,"str"];if(r.cellFormula){t.l+=2;var l=EN(t,s-t.l,r);o[3]=Ni(l,null,n,r.supbooks,r)}else t.l=s;return o}var jAe=nm,SAe=Up;function EAe(t,e){return e==null&&(e=It(4)),e.write_shift(4,t),e}function _Ae(t,e){var r=t.l+e,s=nm(t),n=T_(t),i=Fi(t),o=Fi(t),l=Fi(t);t.l=r;var c={rfx:s,relId:n,loc:i,display:l};return o&&(c.Tooltip=o),c}function TAe(t,e){var r=It(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));Up({s:En(t[0]),e:En(t[0])},r),I_("rId"+e,r);var s=t[1].Target.indexOf("#"),n=s==-1?"":t[1].Target.slice(s+1);return Ha(n||"",r),Ha(t[1].Tooltip||"",r),Ha("",r),r.slice(0,r.l)}function IAe(){}function kAe(t,e,r){var s=t.l+e,n=T7(t),i=t.read_shift(1),o=[n];if(o[2]=i,r.cellFormula){var l=tue(t,s-t.l,r);o[1]=l}else t.l=s;return o}function BAe(t,e,r){var s=t.l+e,n=nm(t),i=[n];if(r.cellFormula){var o=sue(t,s-t.l,r);i[1]=o,t.l=s}else t.l=s;return i}function FAe(t,e,r){r==null&&(r=It(18));var s=_N(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(s.width||10)*256),r.write_shift(4,0);var n=0;return e.hidden&&(n|=1),typeof s.width=="number"&&(n|=2),e.level&&(n|=e.level<<8),r.write_shift(2,n),r}var F9=["left","right","top","bottom","header","footer"];function PAe(t){var e={};return F9.forEach(function(r){e[r]=_i(t)}),e}function DAe(t,e){return e==null&&(e=It(6*8)),gf(t),F9.forEach(function(r){Hf(t[r],e)}),e}function RAe(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function LAe(t,e,r){r==null&&(r=It(30));var s=924;return(((e||{}).Views||[])[0]||{}).RTL&&(s|=32),r.write_shift(2,s),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function OAe(t){var e=It(24);return e.write_shift(4,4),e.write_shift(4,1),Up(t,e),e}function UAe(t,e){return e==null&&(e=It(16*4+2)),e.write_shift(2,t.password?L_(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function MAe(){}function QAe(){}function VAe(t,e,r,s,n,i,o){if(!t)return t;var l=e||{};s||(s={"!id":{}});var c=l.dense?[]:{},d,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},A=!1,h=!1,f,p,m,g,y,v,x,E,T,j=[];l.biff=12,l["!row"]=0;var C=0,w=!1,S=[],F={},B=l.supbooks||n.supbooks||[[]];if(B.sharedf=F,B.arrayf=S,B.SheetNames=n.SheetNames||n.Sheets.map(function(re){return re.name}),!l.supbooks&&(l.supbooks=B,n.Names))for(var k=0;k<n.Names.length;++k)B[0][k+1]=n.Names[k];var D=[],q=[],te=!1;vy[16]={n:"BrtShortReal",f:B9};var W;if(mu(t,function(G,Ae,he){if(!h)switch(he){case 148:d=G;break;case 0:f=G,l.sheetRows&&l.sheetRows<=f.r&&(h=!0),E=na(g=f.r),l["!row"]=f.r,(G.hidden||G.hpt||G.level!=null)&&(G.hpt&&(G.hpx=wp(G.hpt)),q[G.r]=G);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(p={t:G[2]},G[2]){case"n":p.v=G[1];break;case"s":x=bx[G[1]],p.v=x.t,p.r=x.r;break;case"b":p.v=!!G[1];break;case"e":p.v=G[1],l.cellText!==!1&&(p.w=pu[p.v]);break;case"str":p.t="s",p.v=G[1];break;case"is":p.t="s",p.v=G[1].t;break}if((m=o.CellXf[G[0].iStyleRef])&&T9(p,m.numFmtId,null,l,i,o),y=G[0].c==-1?y+1:G[0].c,l.dense?(c[g]||(c[g]=[]),c[g][y]=p):c[Sn(y)+E]=p,l.cellFormula){for(w=!1,C=0;C<S.length;++C){var I=S[C];f.r>=I[0].s.r&&f.r<=I[0].e.r&&y>=I[0].s.c&&y<=I[0].e.c&&(p.F=Gr(I[0]),w=!0)}!w&&G.length>3&&(p.f=G[3])}if(u.s.r>f.r&&(u.s.r=f.r),u.s.c>y&&(u.s.c=y),u.e.r<f.r&&(u.e.r=f.r),u.e.c<y&&(u.e.c=y),l.cellDates&&m&&p.t=="n"&&Rp(Ir[m.numFmtId])){var U=af(p.v);U&&(p.t="d",p.v=new Date(U.y,U.m-1,U.d,U.H,U.M,U.S,U.u))}W&&(W.type=="XLDAPR"&&(p.D=!0),W=void 0);break;case 1:case 12:if(!l.sheetStubs||A)break;p={t:"z",v:void 0},y=G[0].c==-1?y+1:G[0].c,l.dense?(c[g]||(c[g]=[]),c[g][y]=p):c[Sn(y)+E]=p,u.s.r>f.r&&(u.s.r=f.r),u.s.c>y&&(u.s.c=y),u.e.r<f.r&&(u.e.r=f.r),u.e.c<y&&(u.e.c=y),W&&(W.type=="XLDAPR"&&(p.D=!0),W=void 0);break;case 176:j.push(G);break;case 49:W=((l.xlmeta||{}).Cell||[])[G-1];break;case 494:var V=s["!id"][G.relId];for(V?(G.Target=V.Target,G.loc&&(G.Target+="#"+G.loc),G.Rel=V):G.relId==""&&(G.Target="#"+G.loc),g=G.rfx.s.r;g<=G.rfx.e.r;++g)for(y=G.rfx.s.c;y<=G.rfx.e.c;++y)l.dense?(c[g]||(c[g]=[]),c[g][y]||(c[g][y]={t:"z",v:void 0}),c[g][y].l=G):(v=Fr({c:y,r:g}),c[v]||(c[v]={t:"z",v:void 0}),c[v].l=G);break;case 426:if(!l.cellFormula)break;S.push(G),T=l.dense?c[g][y]:c[Sn(y)+E],T.f=Ni(G[1],u,{r:f.r,c:y},B,l),T.F=Gr(G[0]);break;case 427:if(!l.cellFormula)break;F[Fr(G[0].s)]=G[1],T=l.dense?c[g][y]:c[Sn(y)+E],T.f=Ni(G[1],u,{r:f.r,c:y},B,l);break;case 60:if(!l.cellStyles)break;for(;G.e>=G.s;)D[G.e--]={width:G.w/256,hidden:!!(G.flags&1),level:G.level},te||(te=!0,O_(G.w/256)),ZA(D[G.e+1]);break;case 161:c["!autofilter"]={ref:Gr(G)};break;case 476:c["!margins"]=G;break;case 147:n.Sheets[r]||(n.Sheets[r]={}),G.name&&(n.Sheets[r].CodeName=G.name),(G.above||G.left)&&(c["!outline"]={above:G.above,left:G.left});break;case 137:n.Views||(n.Views=[{}]),n.Views[0]||(n.Views[0]={}),G.RTL&&(n.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:A=!0;break;case 36:A=!1;break;case 37:A=!0;break;case 38:A=!1;break;default:if(!Ae.T){if(!A||l.WTF)throw new Error("Unexpected record 0x"+he.toString(16))}}},l),delete l.supbooks,delete l["!row"],!c["!ref"]&&(u.s.r<2e6||d&&(d.e.r>0||d.e.c>0||d.s.r>0||d.s.c>0))&&(c["!ref"]=Gr(d||u)),l.sheetRows&&c["!ref"]){var Q=bs(c["!ref"]);l.sheetRows<=+Q.e.r&&(Q.e.r=l.sheetRows-1,Q.e.r>u.e.r&&(Q.e.r=u.e.r),Q.e.r<Q.s.r&&(Q.s.r=Q.e.r),Q.e.c>u.e.c&&(Q.e.c=u.e.c),Q.e.c<Q.s.c&&(Q.s.c=Q.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Gr(Q))}return j.length>0&&(c["!merges"]=j),D.length>0&&(c["!cols"]=D),q.length>0&&(c["!rows"]=q),c}function HAe(t,e,r,s,n,i,o){if(e.v===void 0)return!1;var l="";switch(e.t){case"b":l=e.v?"1":"0";break;case"d":e=gn(e),e.z=e.z||Ir[14],e.v=_a(pn(e.v)),e.t="n";break;case"n":case"e":l=""+e.v;break;default:l=e.v;break}var c={r,c:s};switch(c.s=yh(n.cellXfs,e,n),e.l&&i["!links"].push([Fr(c),e.l]),e.c&&i["!comments"].push([Fr(c),e.c]),e.t){case"s":case"str":return n.bookSST?(l=H_(n.Strings,e.v,n.revStrings),c.t="s",c.v=l,o?Mt(t,18,lAe(e,c)):Mt(t,7,iAe(e,c))):(c.t="str",o?Mt(t,17,vAe(e,c)):Mt(t,6,xAe(e,c))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?o?Mt(t,13,mAe(e,c)):Mt(t,2,hAe(e,c)):o?Mt(t,16,uAe(e,c)):Mt(t,5,dAe(e,c)),!0;case"b":return c.t="b",o?Mt(t,15,eAe(e,c)):Mt(t,4,Jue(e,c)),!0;case"e":return c.t="e",o?Mt(t,14,nAe(e,c)):Mt(t,3,rAe(e,c)),!0}return o?Mt(t,12,Yue(e,c)):Mt(t,1,Wue(e,c)),!0}function $Ae(t,e,r,s){var n=bs(e["!ref"]||"A1"),i,o="",l=[];Mt(t,145);var c=Array.isArray(e),d=n.e.r;e["!rows"]&&(d=Math.max(n.e.r,e["!rows"].length-1));for(var u=n.s.r;u<=d;++u){o=na(u),Que(t,e,n,u);var A=!1;if(u<=n.e.r)for(var h=n.s.c;h<=n.e.c;++h){u===n.s.r&&(l[h]=Sn(h)),i=l[h]+o;var f=c?(e[u]||[])[h]:e[i];if(!f){A=!1;continue}A=HAe(t,f,u,h,s,e,A)}}Mt(t,146)}function KAe(t,e){!e||!e["!merges"]||(Mt(t,177,EAe(e["!merges"].length)),e["!merges"].forEach(function(r){Mt(t,176,SAe(r))}),Mt(t,178))}function zAe(t,e){!e||!e["!cols"]||(Mt(t,390),e["!cols"].forEach(function(r,s){r&&Mt(t,60,FAe(s,r))}),Mt(t,391))}function qAe(t,e){!e||!e["!ref"]||(Mt(t,648),Mt(t,649,OAe(bs(e["!ref"]))),Mt(t,650))}function WAe(t,e,r){e["!links"].forEach(function(s){if(s[1].Target){var n=Ds(r,-1,s[1].Target.replace(/#.*$/,""),ts.HLINK);Mt(t,494,TAe(s,n))}}),delete e["!links"]}function GAe(t,e,r,s){if(e["!comments"].length>0){var n=Ds(s,-1,"../drawings/vmlDrawing"+(r+1)+".vml",ts.VML);Mt(t,551,I_("rId"+n)),e["!legacy"]=n}}function YAe(t,e,r,s){if(e["!autofilter"]){var n=e["!autofilter"],i=typeof n.ref=="string"?n.ref:Gr(n.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,l=So(i);l.s.r==l.e.r&&(l.e.r=So(e["!ref"]).e.r,i=Gr(l));for(var c=0;c<o.length;++c){var d=o[c];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==s){d.Ref="'"+r.SheetNames[s]+"'!"+i;break}}c==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:s,Ref:"'"+r.SheetNames[s]+"'!"+i}),Mt(t,161,Up(bs(i))),Mt(t,162)}}function XAe(t,e,r){Mt(t,133),Mt(t,137,LAe(e,r)),Mt(t,138),Mt(t,134)}function JAe(t,e){e["!protect"]&&Mt(t,535,UAe(e["!protect"]))}function ZAe(t,e,r,s){var n=jo(),i=r.SheetNames[t],o=r.Sheets[i]||{},l=i;try{r&&r.Workbook&&(l=r.Workbook.Sheets[t].CodeName||l)}catch{}var c=bs(o["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(e.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],Mt(n,129),(r.vbaraw||o["!outline"])&&Mt(n,147,zue(l,o["!outline"])),Mt(n,148,Hue(c)),XAe(n,o,r.Workbook),zAe(n,o),$Ae(n,o,t,e),JAe(n,o),YAe(n,o,r,t),KAe(n,o),WAe(n,o,s),o["!margins"]&&Mt(n,476,DAe(o["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&qAe(n,o),GAe(n,o,t,s),Mt(n,130),n.end()}function ehe(t){var e=[],r=t.match(/^<c:numCache>/),s;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var o=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(e[+o[1]]=r?+o[2]:o[2])});var n=vs((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){s=i.replace(/<.*?>/g,"")}),[e,n,s]}function the(t,e,r,s,n,i){var o=i||{"!type":"chart"};if(!t)return i;var l=0,c=0,d="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(A){var h=ehe(A);u.s.r=u.s.c=0,u.e.c=l,d=Sn(l),h[0].forEach(function(f,p){o[d+na(p)]={t:"n",v:f,z:h[1]},c=p}),u.e.r<c&&(u.e.r=c),++l}),l>0&&(o["!ref"]=Gr(u)),o}function rhe(t,e,r,s,n){if(!t)return t;s||(s={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},o,l=t.match(I9);return l&&$_(l[0],i,n,r),(o=t.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=o[1]),s["!id"][i["!rel"]]&&(i["!drawel"]=s["!id"][i["!rel"]]),i}function she(t,e){t.l+=10;var r=Fi(t);return{name:r}}function nhe(t,e,r,s,n){if(!t)return t;s||(s={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},o=!1;return mu(t,function(c,d,u){switch(u){case 550:i["!rel"]=c;break;case 651:n.Sheets[r]||(n.Sheets[r]={}),c.name&&(n.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(d.T>0)){if(!(d.T<0)){if(!o||e.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}},e),s["!id"][i["!rel"]]&&(i["!drawel"]=s["!id"][i["!rel"]]),i}var K_=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],ahe=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],ihe=[],ohe=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function jF(t,e){for(var r=0;r!=t.length;++r)for(var s=t[r],n=0;n!=e.length;++n){var i=e[n];if(s[i[0]]==null)s[i[0]]=i[1];else switch(i[2]){case"bool":typeof s[i[0]]=="string"&&(s[i[0]]=un(s[i[0]]));break;case"int":typeof s[i[0]]=="string"&&(s[i[0]]=parseInt(s[i[0]],10));break}}}function SF(t,e){for(var r=0;r!=e.length;++r){var s=e[r];if(t[s[0]]==null)t[s[0]]=s[1];else switch(s[2]){case"bool":typeof t[s[0]]=="string"&&(t[s[0]]=un(t[s[0]]));break;case"int":typeof t[s[0]]=="string"&&(t[s[0]]=parseInt(t[s[0]],10));break}}}function P9(t){SF(t.WBProps,K_),SF(t.CalcPr,ohe),jF(t.WBView,ahe),jF(t.Sheets,ihe),Q0.date1904=un(t.WBProps.date1904)}function lhe(t){return!t.Workbook||!t.Workbook.WBProps?"false":un(t.Workbook.WBProps.date1904)?"true":"false"}var che="][*?/\\".split("");function D9(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return che.forEach(function(s){if(t.indexOf(s)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function dhe(t,e,r){t.forEach(function(s,n){D9(s);for(var i=0;i<n;++i)if(s==t[i])throw new Error("Duplicate Sheet Name: "+s);if(r){var o=e&&e[n]&&e[n].CodeName||s;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function uhe(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];dhe(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)lue(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}var Ahe=/<\w+:workbook/;function hhe(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},s=!1,n="xmlns",i={},o=0;if(t.replace(Oi,function(c,d){var u=Rr(c);switch(id(u[0])){case"<?xml":break;case"<workbook":c.match(Ahe)&&(n="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=u[n];break;case"</workbook>":break;case"<fileVersion":delete u[0],r.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":K_.forEach(function(A){if(u[A[0]]!=null)switch(A[2]){case"bool":r.WBProps[A[0]]=un(u[A[0]]);break;case"int":r.WBProps[A[0]]=parseInt(u[A[0]],10);break;default:r.WBProps[A[0]]=u[A[0]]}}),u.codeName&&(r.WBProps.CodeName=Ks(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],r.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=vs(Ks(u.name)),delete u[0],r.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":s=!0;break;case"</definedNames>":s=!1;break;case"<definedName":i={},i.Name=Ks(u.name),u.comment&&(i.Comment=u.comment),u.localSheetId&&(i.Sheet=+u.localSheetId),un(u.hidden||"0")&&(i.Hidden=!0),o=d+c.length;break;case"</definedName>":i.Ref=vs(Ks(t.slice(o,d))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete u[0],r.CalcPr=u;break;case"<calcPr/>":delete u[0],r.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":s=!0;break;case"</AlternateContent>":s=!1;break;case"<revisionPtr":break;default:if(!s&&e.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return c}),em.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return P9(r),r}function R9(t){var e=[oa];e[e.length]=er("workbook",null,{xmlns:em[0],"xmlns:r":Na.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,s={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(K_.forEach(function(l){t.Workbook.WBProps[l[0]]!=null&&t.Workbook.WBProps[l[0]]!=l[1]&&(s[l[0]]=t.Workbook.WBProps[l[0]])}),t.Workbook.WBProps.CodeName&&(s.codeName=t.Workbook.WBProps.CodeName,delete s.CodeName)),e[e.length]=er("workbookPr",null,s);var n=t.Workbook&&t.Workbook.Sheets||[],i=0;if(n&&n[0]&&n[0].Hidden){for(e[e.length]="<bookViews>",i=0;i!=t.SheetNames.length&&!(!n[i]||!n[i].Hidden);++i);i==t.SheetNames.length&&(i=0),e[e.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",i=0;i!=t.SheetNames.length;++i){var o={name:Os(t.SheetNames[i].slice(0,31))};if(o.sheetId=""+(i+1),o["r:id"]="rId"+(i+1),n[i])switch(n[i].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}e[e.length]=er("sheet",null,o)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(l){var c={name:l.Name};l.Comment&&(c.comment=l.Comment),l.Sheet!=null&&(c.localSheetId=""+l.Sheet),l.Hidden&&(c.hidden="1"),l.Ref&&(e[e.length]=er("definedName",Os(l.Ref),c))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function fhe(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=qj(t),r.name=Fi(t),r}function mhe(t,e){return e||(e=It(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),I_(t.strRelID,e),Ha(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function phe(t,e){var r={},s=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var n=e>8?Fi(t):"";return n.length>0&&(r.CodeName=n),r.autoCompressPictures=!!(s&65536),r.backupFile=!!(s&64),r.checkCompatibility=!!(s&4096),r.date1904=!!(s&1),r.filterPrivacy=!!(s&8),r.hidePivotFieldList=!!(s&1024),r.promptedSolutions=!!(s&16),r.publishItems=!!(s&2048),r.refreshAllConnections=!!(s&262144),r.saveExternalLinkValues=!!(s&128),r.showBorderUnselectedTables=!!(s&4),r.showInkAnnotation=!!(s&32),r.showObjects=["all","placeholders","none"][s>>13&3],r.showPivotChartFilter=!!(s&32768),r.updateLinks=["userSet","never","always"][s>>8&3],r}function ghe(t,e){e||(e=It(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),E7(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function xhe(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function yhe(t,e,r){var s=t.l+e;t.l+=4,t.l+=1;var n=t.read_shift(4),i=Gne(t),o=rue(t,0,r),l=T_(t);t.l=s;var c={Name:i,Ptg:o};return n<268435455&&(c.Sheet=n),l&&(c.Comment=l),c}function vhe(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},s=[],n=!1;e||(e={}),e.biff=12;var i=[],o=[[]];return o.SheetNames=[],o.XTI=[],vy[16]={n:"BrtFRTArchID$",f:xhe},mu(t,function(c,d,u){switch(u){case 156:o.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(e.SID=c.Sheet),c.Ref=Ni(c.Ptg,null,null,o,e),delete e.SID,delete c.Ptg,i.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([u,c]):o[0]=[u,c],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(c),o.XTI=o.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:s.push(u),n=!0;break;case 36:s.pop(),n=!1;break;case 37:s.push(u),n=!0;break;case 38:s.pop(),n=!1;break;case 16:break;default:if(!d.T){if(!n||e.WTF&&s[s.length-1]!=37&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},e),P9(r),r.Names=i,r.supbooks=o,r}function bhe(t,e){Mt(t,143);for(var r=0;r!=e.SheetNames.length;++r){var s=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,n={Hidden:s,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};Mt(t,156,mhe(n))}Mt(t,144)}function whe(t,e){e||(e=It(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return Ha("SheetJS",e),Ha(Gw.version,e),Ha(Gw.version,e),Ha("7262",e),e.length>e.l?e.slice(0,e.l):e}function Nhe(t,e){e||(e=It(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function Che(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,s=0,n=-1,i=-1;s<r.length;++s)!r[s]||!r[s].Hidden&&n==-1?n=s:r[s].Hidden==1&&i==-1&&(i=s);i>n||(Mt(t,135),Mt(t,158,Nhe(n)),Mt(t,136))}}function jhe(t,e){var r=jo();return Mt(r,131),Mt(r,128,whe()),Mt(r,153,ghe(t.Workbook&&t.Workbook.WBProps||null)),Che(r,t),bhe(r,t),Mt(r,132),r.end()}function She(t,e,r){return e.slice(-4)===".bin"?vhe(t,r):hhe(t,r)}function Ehe(t,e,r,s,n,i,o,l){return e.slice(-4)===".bin"?VAe(t,s,r,n,i,o,l):yue(t,s,r,n,i,o,l)}function _he(t,e,r,s,n,i,o,l){return e.slice(-4)===".bin"?nhe(t,s,r,n,i):rhe(t,s,r,n,i)}function The(t,e,r,s,n,i,o,l){return e.slice(-4)===".bin"?kce():Bce()}function Ihe(t,e,r,s,n,i,o,l){return e.slice(-4)===".bin"?Tce():Ice()}function khe(t,e,r,s){return e.slice(-4)===".bin"?Sle(t,r,s):fle(t,r,s)}function Bhe(t,e,r){return p9(t,r)}function Fhe(t,e,r){return e.slice(-4)===".bin"?Foe(t,r):Ioe(t,r)}function Phe(t,e,r){return e.slice(-4)===".bin"?Cce(t,r):mce(t,r)}function Dhe(t,e,r){return e.slice(-4)===".bin"?Ace(t):dce(t)}function Rhe(t,e,r,s){return r.slice(-4)===".bin"?hce(t,e,r,s):void 0}function Lhe(t,e,r){return e.slice(-4)===".bin"?oce(t,e,r):cce(t,e,r)}function Ohe(t,e,r){return(e.slice(-4)===".bin"?jhe:R9)(t)}function Uhe(t,e,r,s,n){return(e.slice(-4)===".bin"?ZAe:k9)(t,r,s,n)}function Mhe(t,e,r){return(e.slice(-4)===".bin"?Rle:f9)(t,r)}function Qhe(t,e,r){return(e.slice(-4)===".bin"?Roe:i9)(t,r)}function Vhe(t,e,r){return(e.slice(-4)===".bin"?jce:y9)(t)}function Hhe(t){return(t.slice(-4)===".bin"?lce:g9)()}var L9=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,O9=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Gl(t,e){var r=t.split(/\s+/),s=[];if(s[0]=r[0],r.length===1)return s;var n=t.match(L9),i,o,l,c;if(n)for(c=0;c!=n.length;++c)i=n[c].match(O9),(o=i[1].indexOf(":"))===-1?s[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?l="xmlns"+i[1].slice(6):l=i[1].slice(o+1),s[l]=i[2].slice(1,i[2].length-1));return s}function $he(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var s=t.match(L9),n,i,o,l;if(s)for(l=0;l!=s.length;++l)n=s[l].match(O9),(i=n[1].indexOf(":"))===-1?r[n[1]]=n[2].slice(1,n[2].length-1):(n[1].slice(0,6)==="xmlns:"?o="xmlns"+n[1].slice(6):o=n[1].slice(i+1),r[o]=n[2].slice(1,n[2].length-1));return r}var Nx;function Khe(t,e){var r=Nx[t]||vs(t);return r==="General"?Qf(e):Ll(r,e)}function zhe(t,e,r,s){var n=s;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":n=un(s);break;case"i2":case"int":n=parseInt(s,10);break;case"r4":case"float":n=parseFloat(s);break;case"date":case"dateTime.tz":n=pn(s);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[vs(e)]=n}function qhe(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||pu[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=uy(t.v):t.w=Qf(t.v):t.w=Khe(e||"General",t.v)}catch(i){if(r.WTF)throw i}try{var s=Nx[e]||e||"General";if(r.cellNF&&(t.z=s),r.cellDates&&t.t=="n"&&Rp(s)){var n=af(t.v);n&&(t.t="d",t.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}catch(i){if(r.WTF)throw i}}}function Whe(t,e,r){if(r.cellStyles&&e.Interior){var s=e.Interior;s.Pattern&&(s.patternType=ile[s.Pattern]||s.Pattern)}t[e.ID]=e}function Ghe(t,e,r,s,n,i,o,l,c,d){var u="General",A=s.StyleID,h={};d=d||{};var f=[],p=0;for(A===void 0&&l&&(A=l.StyleID),A===void 0&&o&&(A=o.StyleID);i[A]!==void 0&&(i[A].nf&&(u=i[A].nf),i[A].Interior&&f.push(i[A].Interior),!!i[A].Parent);)A=i[A].Parent;switch(r.Type){case"Boolean":s.t="b",s.v=un(t);break;case"String":s.t="s",s.r=HB(vs(t)),s.v=t.indexOf("<")>-1?vs(e||t).replace(/<.*?>/g,""):s.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),s.v=(pn(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),s.v!==s.v?s.v=vs(t):s.v<60&&(s.v=s.v-1),(!u||u=="General")&&(u="yyyy-mm-dd");case"Number":s.v===void 0&&(s.v=+t),s.t||(s.t="n");break;case"Error":s.t="e",s.v=B7[t],d.cellText!==!1&&(s.w=t);break;default:t==""&&e==""?s.t="z":(s.t="s",s.v=HB(e||t));break}if(qhe(s,u,d),d.cellFormula!==!1)if(s.Formula){var m=vs(s.Formula);m.charCodeAt(0)==61&&(m=m.slice(1)),s.f=M0(m,n),delete s.Formula,s.ArrayRange=="RC"?s.F=M0("RC:RC",n):s.ArrayRange&&(s.F=M0(s.ArrayRange,n),c.push([bs(s.F),s.F]))}else for(p=0;p<c.length;++p)n.r>=c[p][0].s.r&&n.r<=c[p][0].e.r&&n.c>=c[p][0].s.c&&n.c<=c[p][0].e.c&&(s.F=c[p][1]);d.cellStyles&&(f.forEach(function(g){!h.patternType&&g.patternType&&(h.patternType=g.patternType)}),s.s=h),s.StyleID!==void 0&&(s.ixfe=s.StyleID)}function Yhe(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function uC(t,e){var r=e||{};Lp();var s=Og(N_(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(s=Ks(s));var n=s.slice(0,1024).toLowerCase(),i=!1;if(n=n.replace(/".*?"/g,""),(n.indexOf(">")&1023)>Math.min(n.indexOf(",")&1023,n.indexOf(";")&1023)){var o=gn(r);return o.type="string",bp.to_workbook(s,o)}if(n.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(ie){n.indexOf("<"+ie)>=0&&(i=!0)}),i)return Dfe(s,r);Nx={"General Number":"General","General Date":Ir[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Ir[15],"Short Date":Ir[14],"Long Time":Ir[19],"Medium Time":Ir[18],"Short Time":Ir[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Ir[2],Standard:Ir[4],Percent:Ir[10],Scientific:Ir[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,c=[],d,u={},A=[],h=r.dense?[]:{},f="",p={},m={},g=Gl('<Data ss:Type="String">'),y=0,v=0,x=0,E={s:{r:2e6,c:2e6},e:{r:0,c:0}},T={},j={},C="",w=0,S=[],F={},B={},k=0,D=[],q=[],te={},W=[],Q,re=!1,G=[],Ae=[],he={},I=0,U=0,V={Sheets:[],WBProps:{date1904:!1}},L={};fy.lastIndex=0,s=s.replace(/<!--([\s\S]*?)-->/mg,"");for(var K="";l=fy.exec(s);)switch(l[3]=(K=l[3]).toLowerCase()){case"data":if(K=="data"){if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break}if(c[c.length-1][1])break;l[1]==="/"?Ghe(s.slice(y,l.index),C,g,c[c.length-1][0]=="comment"?te:p,{c:v,r:x},T,W[v],m,G,r):(C="",g=Gl(l[0]),y=l.index+l[0].length);break;case"cell":if(l[1]==="/")if(q.length>0&&(p.c=q),(!r.sheetRows||r.sheetRows>x)&&p.v!==void 0&&(r.dense?(h[x]||(h[x]=[]),h[x][v]=p):h[Sn(v)+na(x)]=p),p.HRef&&(p.l={Target:vs(p.HRef)},p.HRefScreenTip&&(p.l.Tooltip=p.HRefScreenTip),delete p.HRef,delete p.HRefScreenTip),(p.MergeAcross||p.MergeDown)&&(I=v+(parseInt(p.MergeAcross,10)|0),U=x+(parseInt(p.MergeDown,10)|0),S.push({s:{c:v,r:x},e:{c:I,r:U}})),!r.sheetStubs)p.MergeAcross?v=I+1:++v;else if(p.MergeAcross||p.MergeDown){for(var fe=v;fe<=I;++fe)for(var ee=x;ee<=U;++ee)(fe>v||ee>x)&&(r.dense?(h[ee]||(h[ee]=[]),h[ee][fe]={t:"z"}):h[Sn(fe)+na(ee)]={t:"z"});v=I+1}else++v;else p=$he(l[0]),p.Index&&(v=+p.Index-1),v<E.s.c&&(E.s.c=v),v>E.e.c&&(E.e.c=v),l[0].slice(-2)==="/>"&&++v,q=[];break;case"row":l[1]==="/"||l[0].slice(-2)==="/>"?(x<E.s.r&&(E.s.r=x),x>E.e.r&&(E.e.r=x),l[0].slice(-2)==="/>"&&(m=Gl(l[0]),m.Index&&(x=+m.Index-1)),v=0,++x):(m=Gl(l[0]),m.Index&&(x=+m.Index-1),he={},(m.AutoFitHeight=="0"||m.Height)&&(he.hpx=parseInt(m.Height,10),he.hpt=yy(he.hpx),Ae[x]=he),m.Hidden=="1"&&(he.hidden=!0,Ae[x]=he));break;case"worksheet":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"));A.push(f),E.s.r<=E.e.r&&E.s.c<=E.e.c&&(h["!ref"]=Gr(E),r.sheetRows&&r.sheetRows<=E.e.r&&(h["!fullref"]=h["!ref"],E.e.r=r.sheetRows-1,h["!ref"]=Gr(E))),S.length&&(h["!merges"]=S),W.length>0&&(h["!cols"]=W),Ae.length>0&&(h["!rows"]=Ae),u[f]=h}else E={s:{r:2e6,c:2e6},e:{r:0,c:0}},x=v=0,c.push([l[3],!1]),d=Gl(l[0]),f=vs(d.Name),h=r.dense?[]:{},S=[],G=[],Ae=[],L={name:f,Hidden:0},V.Sheets.push(L);break;case"table":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else{if(l[0].slice(-2)=="/>")break;c.push([l[3],!1]),W=[],re=!1}break;case"style":l[1]==="/"?Whe(T,j,r):j=Gl(l[0]);break;case"numberformat":j.nf=vs(Gl(l[0]).Format||"General"),Nx[j.nf]&&(j.nf=Nx[j.nf]);for(var de=0;de!=392&&Ir[de]!=j.nf;++de);if(de==392){for(de=57;de!=392;++de)if(Ir[de]==null){qd(j.nf,de);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(Q=Gl(l[0]),Q.Hidden&&(Q.hidden=!0,delete Q.Hidden),Q.Width&&(Q.wpx=parseInt(Q.Width,10)),!re&&Q.wpx>10){re=!0,Si=A9;for(var ue=0;ue<W.length;++ue)W[ue]&&ZA(W[ue])}re&&ZA(Q),W[Q.Index-1||W.length]=Q;for(var Ie=0;Ie<+Q.Span;++Ie)W[W.length]=gn(Q);break;case"namedrange":if(l[1]==="/")break;V.Names||(V.Names=[]);var Y=Rr(l[0]),H={Name:Y.Name,Ref:M0(Y.RefersTo.slice(1),{r:0,c:0})};V.Sheets.length>0&&(H.Sheet=V.Sheets.length-1),V.Names.push(H);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(l[0].slice(-2)==="/>")break;l[1]==="/"?C+=s.slice(w,l.index):w=l.index+l[0].length;break;case"interior":if(!r.cellStyles)break;j.Interior=Gl(l[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(l[0].slice(-2)==="/>")break;l[1]==="/"?vae(F,K,s.slice(k,l.index)):k=l.index+l[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else c.push([l[3],!1]);break;case"comment":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"));Yhe(te),q.push(te)}else c.push([l[3],!1]),d=Gl(l[0]),te={a:d.Author};break;case"autofilter":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else if(l[0].charAt(l[0].length-2)!=="/"){var je=Gl(l[0]);h["!autofilter"]={ref:M0(je.Range).replace(/\$/g,"")},c.push([l[3],!0])}break;case"name":break;case"datavalidation":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"null":break;default:if(c.length==0&&l[3]=="document"||c.length==0&&l[3]=="uof")return kF(s,r);var Ce=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(l[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Ce=!1}break;case"componentoptions":switch(l[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Ce=!1}break;case"excelworkbook":switch(l[3]){case"date1904":V.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Ce=!1}break;case"workbookoptions":switch(l[3]){case"owcversion":break;case"height":break;case"width":break;default:Ce=!1}break;case"worksheetoptions":switch(l[3]){case"visible":if(l[0].slice(-2)!=="/>")if(l[1]==="/")switch(s.slice(k,l.index)){case"SheetHidden":L.Hidden=1;break;case"SheetVeryHidden":L.Hidden=2;break}else k=l.index+l[0].length;break;case"header":h["!margins"]||gf(h["!margins"]={},"xlml"),isNaN(+Rr(l[0]).Margin)||(h["!margins"].header=+Rr(l[0]).Margin);break;case"footer":h["!margins"]||gf(h["!margins"]={},"xlml"),isNaN(+Rr(l[0]).Margin)||(h["!margins"].footer=+Rr(l[0]).Margin);break;case"pagemargins":var oe=Rr(l[0]);h["!margins"]||gf(h["!margins"]={},"xlml"),isNaN(+oe.Top)||(h["!margins"].top=+oe.Top),isNaN(+oe.Left)||(h["!margins"].left=+oe.Left),isNaN(+oe.Right)||(h["!margins"].right=+oe.Right),isNaN(+oe.Bottom)||(h["!margins"].bottom=+oe.Bottom);break;case"displayrighttoleft":V.Views||(V.Views=[]),V.Views[0]||(V.Views[0]={}),V.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Ce=!1}break;case"pivottable":case"pivotcache":switch(l[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Ce=!1}break;case"pagebreaks":switch(l[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Ce=!1}break;case"autofilter":switch(l[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Ce=!1}break;case"querytable":switch(l[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Ce=!1}break;case"datavalidation":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Ce=!1}break;case"sorting":case"conditionalformatting":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Ce=!1}break;case"mapinfo":case"schema":case"data":switch(l[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Ce=!1}break;case"smarttags":break;default:Ce=!1;break}if(Ce||l[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+l[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(l[0].slice(-2)==="/>")break;l[1]==="/"?zhe(B,K,D,s.slice(k,l.index)):(D=l,k=l.index+l[0].length);break}if(r.WTF)throw"Unrecognized tag: "+l[3]+"|"+c.join("|")}var He={};return!r.bookSheets&&!r.bookProps&&(He.Sheets=u),He.SheetNames=A,He.Workbook=V,He.SSF=gn(Ir),He.Props=F,He.Custprops=B,He}function eS(t,e){switch(q_(e=e||{}),e.type||"base64"){case"base64":return uC(Zo(t),e);case"binary":case"buffer":case"file":return uC(t,e);case"array":return uC(gh(t),e)}}function Xhe(t,e){var r=[];return t.Props&&r.push(bae(t.Props,e)),t.Custprops&&r.push(wae(t.Props,t.Custprops)),r.join("")}function Jhe(){return""}function Zhe(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(s,n){var i=[];i.push(er("NumberFormat",null,{"ss:Format":Os(Ir[s.numFmtId])}));var o={"ss:ID":"s"+(21+n)};r.push(er("Style",i.join(""),o))}),er("Styles",r.join(""))}function U9(t){return er("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+Q_(t.Ref,{r:0,c:0})})}function efe(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],s=0;s<e.length;++s){var n=e[s];n.Sheet==null&&(n.Name.match(/^_xlfn\./)||r.push(U9(n)))}return er("Names",r.join(""))}function tfe(t,e,r,s){if(!t||!((s||{}).Workbook||{}).Names)return"";for(var n=s.Workbook.Names,i=[],o=0;o<n.length;++o){var l=n[o];l.Sheet==r&&(l.Name.match(/^_xlfn\./)||i.push(U9(l)))}return i.join("")}function rfe(t,e,r,s){if(!t)return"";var n=[];if(t["!margins"]&&(n.push("<PageSetup>"),t["!margins"].header&&n.push(er("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&n.push(er("Footer",null,{"x:Margin":t["!margins"].footer})),n.push(er("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),n.push("</PageSetup>")),s&&s.Workbook&&s.Workbook.Sheets&&s.Workbook.Sheets[r])if(s.Workbook.Sheets[r].Hidden)n.push(er("Visible",s.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(s.Workbook.Sheets[i]&&!s.Workbook.Sheets[i].Hidden);++i);i==r&&n.push("<Selected/>")}return((((s||{}).Workbook||{}).Views||[])[0]||{}).RTL&&n.push("<DisplayRightToLeft/>"),t["!protect"]&&(n.push(ri("ProtectContents","True")),t["!protect"].objects&&n.push(ri("ProtectObjects","True")),t["!protect"].scenarios&&n.push(ri("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?n.push(ri("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&n.push(ri("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){t["!protect"][o[0]]&&n.push("<"+o[1]+"/>")})),n.length==0?"":er("WorksheetOptions",n.join(""),{xmlns:Mo.x})}function sfe(t){return t.map(function(e){var r=Cne(e.t||""),s=er("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return er("Comment",s,{"ss:Author":e.a})}).join("")}function nfe(t,e,r,s,n,i,o){if(!t||t.v==null&&t.f==null)return"";var l={};if(t.f&&(l["ss:Formula"]="="+Os(Q_(t.f,o))),t.F&&t.F.slice(0,e.length)==e){var c=En(t.F.slice(e.length+1));l["ss:ArrayRange"]="RC:R"+(c.r==o.r?"":"["+(c.r-o.r)+"]")+"C"+(c.c==o.c?"":"["+(c.c-o.c)+"]")}if(t.l&&t.l.Target&&(l["ss:HRef"]=Os(t.l.Target),t.l.Tooltip&&(l["x:HRefScreenTip"]=Os(t.l.Tooltip))),r["!merges"])for(var d=r["!merges"],u=0;u!=d.length;++u)d[u].s.c!=o.c||d[u].s.r!=o.r||(d[u].e.c>d[u].s.c&&(l["ss:MergeAcross"]=d[u].e.c-d[u].s.c),d[u].e.r>d[u].s.r&&(l["ss:MergeDown"]=d[u].e.r-d[u].s.r));var A="",h="";switch(t.t){case"z":if(!s.sheetStubs)return"";break;case"n":A="Number",h=String(t.v);break;case"b":A="Boolean",h=t.v?"1":"0";break;case"e":A="Error",h=pu[t.v];break;case"d":A="DateTime",h=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||Ir[14]);break;case"s":A="String",h=Nne(t.v||"");break}var f=yh(s.cellXfs,t,s);l["ss:StyleID"]="s"+(21+f),l["ss:Index"]=o.c+1;var p=t.v!=null?h:"",m=t.t=="z"?"":'<Data ss:Type="'+A+'">'+p+"</Data>";return(t.c||[]).length>0&&(m+=sfe(t.c)),er("Cell",m,l)}function afe(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=wp(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function ife(t,e,r,s){if(!t["!ref"])return"";var n=bs(t["!ref"]),i=t["!merges"]||[],o=0,l=[];t["!cols"]&&t["!cols"].forEach(function(g,y){ZA(g);var v=!!g.width,x=_N(y,g),E={"ss:Index":y+1};v&&(E["ss:Width"]=gy(x.width)),g.hidden&&(E["ss:Hidden"]="1"),l.push(er("Column",null,E))});for(var c=Array.isArray(t),d=n.s.r;d<=n.e.r;++d){for(var u=[afe(d,(t["!rows"]||[])[d])],A=n.s.c;A<=n.e.c;++A){var h=!1;for(o=0;o!=i.length;++o)if(!(i[o].s.c>A)&&!(i[o].s.r>d)&&!(i[o].e.c<A)&&!(i[o].e.r<d)){(i[o].s.c!=A||i[o].s.r!=d)&&(h=!0);break}if(!h){var f={r:d,c:A},p=Fr(f),m=c?(t[d]||[])[A]:t[p];u.push(nfe(m,p,t,e,r,s,f))}}u.push("</Row>"),u.length>2&&l.push(u.join(""))}return l.join("")}function ofe(t,e,r){var s=[],n=r.SheetNames[t],i=r.Sheets[n],o=i?tfe(i,e,t,r):"";return o.length>0&&s.push("<Names>"+o+"</Names>"),o=i?ife(i,e,t,r):"",o.length>0&&s.push("<Table>"+o+"</Table>"),s.push(rfe(i,e,t,r)),s.join("")}function lfe(t,e){e||(e={}),t.SSF||(t.SSF=gn(Ir)),t.SSF&&(Lp(),bN(t.SSF),e.revssf=NN(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],yh(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(Xhe(t,e)),r.push(Jhe()),r.push(""),r.push("");for(var s=0;s<t.SheetNames.length;++s)r.push(er("Worksheet",ofe(s,e,t),{"ss:Name":Os(t.SheetNames[s])}));return r[2]=Zhe(t,e),r[3]=efe(t),oa+er("Workbook",r.join(""),{xmlns:Mo.ss,"xmlns:o":Mo.o,"xmlns:x":Mo.x,"xmlns:ss":Mo.ss,"xmlns:dt":Mo.dt,"xmlns:html":Mo.html})}function cfe(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=eae(r),r.length-r.l<=4)return e;var s=r.read_shift(4);if(s==0||s>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(s=r.read_shift(4),s!==1907505652)||(e.UnicodeClipboardFormat=tae(r),s=r.read_shift(4),s==0||s>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var dfe=[60,1084,2066,2165,2175];function ufe(t,e,r,s,n){var i=s,o=[],l=r.slice(r.l,r.l+i);if(n&&n.enc&&n.enc.insitu&&l.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:n.enc.insitu(l)}o.push(l),r.l+=i;for(var c=Qd(r,r.l),d=tS[c],u=0;d!=null&&dfe.indexOf(c)>-1;)i=Qd(r,r.l+2),u=r.l+4,c==2066?u+=4:(c==2165||c==2175)&&(u+=12),l=r.slice(u,r.l+4+i),o.push(l),r.l+=4+i,d=tS[c=Qd(r,r.l)];var A=Va(o);ti(A,0);var h=0;A.lens=[];for(var f=0;f<o.length;++f)A.lens.push(h),h+=o[f].length;if(A.length<s)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+A.length+" < "+s;return e.f(A,A.length,n)}function kc(t,e,r){if(t.t!=="z"&&t.XF){var s=0;try{s=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=Ir[s])}catch(i){if(e.WTF)throw i}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||pu[t.v]:s===0||s=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=uy(t.v):t.w=Qf(t.v):t.w=Ll(s,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(i){if(e.WTF)throw i}if(e.cellDates&&s&&t.t=="n"&&Rp(Ir[s]||String(s))){var n=af(t.v);n&&(t.t="d",t.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}}function N1(t,e,r){return{v:t,ixfe:e,t:r}}function Afe(t,e){var r={opts:{}},s={},n=e.dense?[]:{},i={},o={},l=null,c=[],d="",u={},A,h="",f,p,m,g,y={},v=[],x,E,T=[],j=[],C={Sheets:[],WBProps:{date1904:!1},Views:[{}]},w={},S=function(_e){return _e<8?ff[_e]:_e<64&&j[_e-8]||ff[_e]},F=function(_e,ke,lt){var mt=ke.XF.data;if(!(!mt||!mt.patternType||!lt||!lt.cellStyles)){ke.s={},ke.s.patternType=mt.patternType;var pt;(pt=py(S(mt.icvFore)))&&(ke.s.fgColor={rgb:pt}),(pt=py(S(mt.icvBack)))&&(ke.s.bgColor={rgb:pt})}},B=function(_e,ke,lt){if(!(he>1)&&!(lt.sheetRows&&_e.r>=lt.sheetRows)){if(lt.cellStyles&&ke.XF&&ke.XF.data&&F(_e,ke,lt),delete ke.ixfe,delete ke.XF,A=_e,h=Fr(_e),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),_e.r<o.s.r&&(o.s.r=_e.r),_e.c<o.s.c&&(o.s.c=_e.c),_e.r+1>o.e.r&&(o.e.r=_e.r+1),_e.c+1>o.e.c&&(o.e.c=_e.c+1),lt.cellFormula&&ke.f){for(var mt=0;mt<v.length;++mt)if(!(v[mt][0].s.c>_e.c||v[mt][0].s.r>_e.r)&&!(v[mt][0].e.c<_e.c||v[mt][0].e.r<_e.r)){ke.F=Gr(v[mt][0]),(v[mt][0].s.c!=_e.c||v[mt][0].s.r!=_e.r)&&delete ke.f,ke.f&&(ke.f=""+Ni(v[mt][1],o,_e,G,k));break}}lt.dense?(n[_e.r]||(n[_e.r]=[]),n[_e.r][_e.c]=ke):n[h]=ke}},k={enc:!1,sbcch:0,snames:[],sharedf:y,arrayf:v,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(k.password=e.password);var D,q=[],te=[],W=[],Q=[],re=!1,G=[];G.SheetNames=k.snames,G.sharedf=k.sharedf,G.arrayf=k.arrayf,G.names=[],G.XTI=[];var Ae=0,he=0,I=0,U=[],V=[],L;k.codepage=1200,oc(1200);for(var K=!1;t.l<t.length-1;){var fe=t.l,ee=t.read_shift(2);if(ee===0&&Ae===10)break;var de=t.l===t.length?0:t.read_shift(2),ue=tS[ee];if(ue&&ue.f){if(e.bookSheets&&Ae===133&&ee!==133)break;if(Ae=ee,ue.r===2||ue.r==12){var Ie=t.read_shift(2);if(de-=2,!k.enc&&Ie!==ee&&((Ie&255)<<8|Ie>>8)!==ee)throw new Error("rt mismatch: "+Ie+"!="+ee);ue.r==12&&(t.l+=10,de-=10)}var Y={};if(ee===10?Y=ue.f(t,de,k):Y=ufe(ee,ue,t,de,k),he==0&&[9,521,1033,2057].indexOf(Ae)===-1)continue;switch(ee){case 34:r.opts.Date1904=C.WBProps.date1904=Y;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(k.enc||(t.l=0),k.enc=Y,!e.password)throw new Error("File is password-protected");if(Y.valid==null)throw new Error("Encryption scheme unsupported");if(!Y.valid)throw new Error("Password is incorrect");break;case 92:k.lastuser=Y;break;case 66:var H=Number(Y);switch(H){case 21010:H=1200;break;case 32768:H=1e4;break;case 32769:H=1252;break}oc(k.codepage=H),K=!0;break;case 317:k.rrtabid=Y;break;case 25:k.winlocked=Y;break;case 439:r.opts.RefreshAll=Y;break;case 12:r.opts.CalcCount=Y;break;case 16:r.opts.CalcDelta=Y;break;case 17:r.opts.CalcIter=Y;break;case 13:r.opts.CalcMode=Y;break;case 14:r.opts.CalcPrecision=Y;break;case 95:r.opts.CalcSaveRecalc=Y;break;case 15:k.CalcRefMode=Y;break;case 2211:r.opts.FullCalc=Y;break;case 129:Y.fDialog&&(n["!type"]="dialog"),Y.fBelow||((n["!outline"]||(n["!outline"]={})).above=!0),Y.fRight||((n["!outline"]||(n["!outline"]={})).left=!0);break;case 224:T.push(Y);break;case 430:G.push([Y]),G[G.length-1].XTI=[];break;case 35:case 547:G[G.length-1].push(Y);break;case 24:case 536:L={Name:Y.Name,Ref:Ni(Y.rgce,o,null,G,k)},Y.itab>0&&(L.Sheet=Y.itab-1),G.names.push(L),G[0]||(G[0]=[],G[0].XTI=[]),G[G.length-1].push(Y),Y.Name=="_xlnm._FilterDatabase"&&Y.itab>0&&Y.rgce&&Y.rgce[0]&&Y.rgce[0][0]&&Y.rgce[0][0][0]=="PtgArea3d"&&(V[Y.itab-1]={ref:Gr(Y.rgce[0][0][1][2])});break;case 22:k.ExternCount=Y;break;case 23:G.length==0&&(G[0]=[],G[0].XTI=[]),G[G.length-1].XTI=G[G.length-1].XTI.concat(Y),G.XTI=G.XTI.concat(Y);break;case 2196:if(k.biff<8)break;L!=null&&(L.Comment=Y[1]);break;case 18:n["!protect"]=Y;break;case 19:Y!==0&&k.WTF&&console.error("Password verifier: "+Y);break;case 133:i[Y.pos]=Y,k.snames.push(Y.name);break;case 10:{if(--he)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,n["!ref"]=Gr(o),e.sheetRows&&e.sheetRows<=o.e.r){var je=o.e.r;o.e.r=e.sheetRows-1,n["!fullref"]=n["!ref"],n["!ref"]=Gr(o),o.e.r=je}o.e.r++,o.e.c++}q.length>0&&(n["!merges"]=q),te.length>0&&(n["!objects"]=te),W.length>0&&(n["!cols"]=W),Q.length>0&&(n["!rows"]=Q),C.Sheets.push(w)}d===""?u=n:s[d]=n,n=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(k.biff===8&&(k.biff={9:2,521:3,1033:4}[ee]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[Y.BIFFVer]||8),k.biffguess=Y.BIFFVer==0,Y.BIFFVer==0&&Y.dt==4096&&(k.biff=5,K=!0,oc(k.codepage=28591)),k.biff==8&&Y.BIFFVer==0&&Y.dt==16&&(k.biff=2),he++)break;if(n=e.dense?[]:{},k.biff<8&&!K&&(K=!0,oc(k.codepage=e.codepage||1252)),k.biff<5||Y.BIFFVer==0&&Y.dt==4096){d===""&&(d="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var Ce={pos:t.l-de,name:d};i[Ce.pos]=Ce,k.snames.push(d)}else d=(i[fe]||{name:""}).name;Y.dt==32&&(n["!type"]="chart"),Y.dt==64&&(n["!type"]="macro"),q=[],te=[],k.arrayf=v=[],W=[],Q=[],re=!1,w={Hidden:(i[fe]||{hs:0}).hs,name:d}}break;case 515:case 3:case 2:n["!type"]=="chart"&&(e.dense?(n[Y.r]||[])[Y.c]:n[Fr({c:Y.c,r:Y.r})])&&++Y.c,x={ixfe:Y.ixfe,XF:T[Y.ixfe]||{},v:Y.val,t:"n"},I>0&&(x.z=U[x.ixfe>>8&63]),kc(x,e,r.opts.Date1904),B({c:Y.c,r:Y.r},x,e);break;case 5:case 517:x={ixfe:Y.ixfe,XF:T[Y.ixfe],v:Y.val,t:Y.t},I>0&&(x.z=U[x.ixfe>>8&63]),kc(x,e,r.opts.Date1904),B({c:Y.c,r:Y.r},x,e);break;case 638:x={ixfe:Y.ixfe,XF:T[Y.ixfe],v:Y.rknum,t:"n"},I>0&&(x.z=U[x.ixfe>>8&63]),kc(x,e,r.opts.Date1904),B({c:Y.c,r:Y.r},x,e);break;case 189:for(var oe=Y.c;oe<=Y.C;++oe){var He=Y.rkrec[oe-Y.c][0];x={ixfe:He,XF:T[He],v:Y.rkrec[oe-Y.c][1],t:"n"},I>0&&(x.z=U[x.ixfe>>8&63]),kc(x,e,r.opts.Date1904),B({c:oe,r:Y.r},x,e)}break;case 6:case 518:case 1030:{if(Y.val=="String"){l=Y;break}if(x=N1(Y.val,Y.cell.ixfe,Y.tt),x.XF=T[x.ixfe],e.cellFormula){var ie=Y.formula;if(ie&&ie[0]&&ie[0][0]&&ie[0][0][0]=="PtgExp"){var le=ie[0][0][1][0],ae=ie[0][0][1][1],ve=Fr({r:le,c:ae});y[ve]?x.f=""+Ni(Y.formula,o,Y.cell,G,k):x.F=((e.dense?(n[le]||[])[ae]:n[ve])||{}).F}else x.f=""+Ni(Y.formula,o,Y.cell,G,k)}I>0&&(x.z=U[x.ixfe>>8&63]),kc(x,e,r.opts.Date1904),B(Y.cell,x,e),l=Y}break;case 7:case 519:if(l)l.val=Y,x=N1(Y,l.cell.ixfe,"s"),x.XF=T[x.ixfe],e.cellFormula&&(x.f=""+Ni(l.formula,o,l.cell,G,k)),I>0&&(x.z=U[x.ixfe>>8&63]),kc(x,e,r.opts.Date1904),B(l.cell,x,e),l=null;else throw new Error("String record expects Formula");break;case 33:case 545:{v.push(Y);var we=Fr(Y[0].s);if(f=e.dense?(n[Y[0].s.r]||[])[Y[0].s.c]:n[we],e.cellFormula&&f){if(!l||!we||!f)break;f.f=""+Ni(Y[1],o,Y[0],G,k),f.F=Gr(Y[0])}}break;case 1212:{if(!e.cellFormula)break;if(h){if(!l)break;y[Fr(l.cell)]=Y[0],f=e.dense?(n[l.cell.r]||[])[l.cell.c]:n[Fr(l.cell)],(f||{}).f=""+Ni(Y[0],o,A,G,k)}}break;case 253:x=N1(c[Y.isst].t,Y.ixfe,"s"),c[Y.isst].h&&(x.h=c[Y.isst].h),x.XF=T[x.ixfe],I>0&&(x.z=U[x.ixfe>>8&63]),kc(x,e,r.opts.Date1904),B({c:Y.c,r:Y.r},x,e);break;case 513:e.sheetStubs&&(x={ixfe:Y.ixfe,XF:T[Y.ixfe],t:"z"},I>0&&(x.z=U[x.ixfe>>8&63]),kc(x,e,r.opts.Date1904),B({c:Y.c,r:Y.r},x,e));break;case 190:if(e.sheetStubs)for(var De=Y.c;De<=Y.C;++De){var Ve=Y.ixfe[De-Y.c];x={ixfe:Ve,XF:T[Ve],t:"z"},I>0&&(x.z=U[x.ixfe>>8&63]),kc(x,e,r.opts.Date1904),B({c:De,r:Y.r},x,e)}break;case 214:case 516:case 4:x=N1(Y.val,Y.ixfe,"s"),x.XF=T[x.ixfe],I>0&&(x.z=U[x.ixfe>>8&63]),kc(x,e,r.opts.Date1904),B({c:Y.c,r:Y.r},x,e);break;case 0:case 512:he===1&&(o=Y);break;case 252:c=Y;break;case 1054:if(k.biff==4){U[I++]=Y[1];for(var me=0;me<I+163&&Ir[me]!=Y[1];++me);me>=163&&qd(Y[1],I+163)}else qd(Y[1],Y[0]);break;case 30:{U[I++]=Y;for(var Fe=0;Fe<I+163&&Ir[Fe]!=Y;++Fe);Fe>=163&&qd(Y,I+163)}break;case 229:q=q.concat(Y);break;case 93:te[Y.cmo[0]]=k.lastobj=Y;break;case 438:k.lastobj.TxO=Y;break;case 127:k.lastobj.ImData=Y;break;case 440:for(g=Y[0].s.r;g<=Y[0].e.r;++g)for(m=Y[0].s.c;m<=Y[0].e.c;++m)f=e.dense?(n[g]||[])[m]:n[Fr({c:m,r:g})],f&&(f.l=Y[1]);break;case 2048:for(g=Y[0].s.r;g<=Y[0].e.r;++g)for(m=Y[0].s.c;m<=Y[0].e.c;++m)f=e.dense?(n[g]||[])[m]:n[Fr({c:m,r:g})],f&&f.l&&(f.l.Tooltip=Y[1]);break;case 28:{if(k.biff<=5&&k.biff>=2)break;f=e.dense?(n[Y[0].r]||[])[Y[0].c]:n[Fr(Y[0])];var Re=te[Y[2]];f||(e.dense?(n[Y[0].r]||(n[Y[0].r]=[]),f=n[Y[0].r][Y[0].c]={t:"z"}):f=n[Fr(Y[0])]={t:"z"},o.e.r=Math.max(o.e.r,Y[0].r),o.s.r=Math.min(o.s.r,Y[0].r),o.e.c=Math.max(o.e.c,Y[0].c),o.s.c=Math.min(o.s.c,Y[0].c)),f.c||(f.c=[]),p={a:Y[1],t:Re.TxO.t},f.c.push(p)}break;case 2173:Zle(T[Y.ixfe],Y.ext);break;case 125:{if(!k.cellStyles)break;for(;Y.e>=Y.s;)W[Y.e--]={width:Y.w/256,level:Y.level||0,hidden:!!(Y.flags&1)},re||(re=!0,O_(Y.w/256)),ZA(W[Y.e+1])}break;case 520:{var Be={};Y.level!=null&&(Q[Y.r]=Be,Be.level=Y.level),Y.hidden&&(Q[Y.r]=Be,Be.hidden=!0),Y.hpt&&(Q[Y.r]=Be,Be.hpt=Y.hpt,Be.hpx=wp(Y.hpt))}break;case 38:case 39:case 40:case 41:n["!margins"]||gf(n["!margins"]={}),n["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ee]]=Y;break;case 161:n["!margins"]||gf(n["!margins"]={}),n["!margins"].header=Y.header,n["!margins"].footer=Y.footer;break;case 574:Y.RTL&&(C.Views[0].RTL=!0);break;case 146:j=Y;break;case 2198:D=Y;break;case 140:E=Y;break;case 442:d?w.CodeName=Y||w.name:C.WBProps.CodeName=Y||"ThisWorkbook";break}}else ue||console.error("Missing Info for XLS Record 0x"+ee.toString(16)),t.l+=de}return r.SheetNames=Qn(i).sort(function(X,_e){return Number(X)-Number(_e)}).map(function(X){return i[X].name}),e.bookSheets||(r.Sheets=s),!r.SheetNames.length&&u["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=u)):r.Preamble=u,r.Sheets&&V.forEach(function(X,_e){r.Sheets[r.SheetNames[_e]]["!autofilter"]=X}),r.Strings=c,r.SSF=gn(Ir),k.enc&&(r.Encryption=k.enc),D&&(r.Themes=D),r.Metadata={},E!==void 0&&(r.Metadata.Country=E),G.names.length>0&&(C.Names=G.names),r.Workbook=C,r}var Cx={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function hfe(t,e,r){var s=Cr.find(t,"/!DocumentSummaryInformation");if(s&&s.size>0)try{var n=oF(s,Wj,Cx.DSI);for(var i in n)e[i]=n[i]}catch(d){if(r.WTF)throw d}var o=Cr.find(t,"/!SummaryInformation");if(o&&o.size>0)try{var l=oF(o,Gj,Cx.SI);for(var c in l)e[c]==null&&(e[c]=l[c])}catch(d){if(r.WTF)throw d}e.HeadingPairs&&e.TitlesOfParts&&(O7(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function ffe(t,e){var r=[],s=[],n=[],i=0,o,l=LB(Wj,"n"),c=LB(Gj,"n");if(t.Props)for(o=Qn(t.Props),i=0;i<o.length;++i)(Object.prototype.hasOwnProperty.call(l,o[i])?r:Object.prototype.hasOwnProperty.call(c,o[i])?s:n).push([o[i],t.Props[o[i]]]);if(t.Custprops)for(o=Qn(t.Custprops),i=0;i<o.length;++i)Object.prototype.hasOwnProperty.call(t.Props||{},o[i])||(Object.prototype.hasOwnProperty.call(l,o[i])?r:Object.prototype.hasOwnProperty.call(c,o[i])?s:n).push([o[i],t.Custprops[o[i]]]);var d=[];for(i=0;i<n.length;++i)K7.indexOf(n[i][0])>-1||L7.indexOf(n[i][0])>-1||n[i][1]!=null&&d.push(n[i]);s.length&&Cr.utils.cfb_add(e,"/SummaryInformation",lF(s,Cx.SI,c,Gj)),(r.length||d.length)&&Cr.utils.cfb_add(e,"/DocumentSummaryInformation",lF(r,Cx.DSI,l,Wj,d.length?d:null,Cx.UDI))}function M9(t,e){e||(e={}),q_(e),f_(),e.codepage&&h_(e.codepage);var r,s;if(t.FullPaths){if(Cr.find(t,"/encryption"))throw new Error("File is password-protected");r=Cr.find(t,"!CompObj"),s=Cr.find(t,"/Workbook")||Cr.find(t,"/Book")}else{switch(e.type){case"base64":t=Vo(Zo(t));break;case"binary":t=Vo(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}ti(t,0),s={content:t}}var n,i;if(r&&cfe(r),e.bookProps&&!e.bookSheets)n={};else{var o=Zr?"buffer":"array";if(s&&s.content)n=Afe(s.content,e);else if((i=Cr.find(t,"PerfectOffice_MAIN"))&&i.content)n=pf.to_workbook(i.content,(e.type=o,e));else if((i=Cr.find(t,"NativeContent_MAIN"))&&i.content)n=pf.to_workbook(i.content,(e.type=o,e));else throw(i=Cr.find(t,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&Cr.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(n.vbaraw=Ece(t))}var l={};return t.FullPaths&&hfe(t,l,e),n.Props=n.Custprops=l,e.bookFiles&&(n.cfb=t),n}function mfe(t,e){var r=e||{},s=Cr.utils.cfb_new({root:"R"}),n="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":n="/Workbook",r.biff=8;break;case"biff5":n="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Cr.utils.cfb_add(s,n,Q9(t,r)),r.biff==8&&(t.Props||t.Custprops)&&ffe(t,s),r.biff==8&&t.vbaraw&&_ce(s,Cr.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),s}var vy={0:{f:Uue},1:{f:que},2:{f:AAe},3:{f:tAe},4:{f:Xue},5:{f:cAe},6:{f:gAe},7:{f:aAe},8:{f:CAe},9:{f:NAe},10:{f:bAe},11:{f:wAe},12:{f:Gue},13:{f:fAe},14:{f:sAe},15:{f:Zue},16:{f:B9},17:{f:yAe},18:{f:oAe},19:{f:__},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:yhe},40:{},42:{},43:{f:gle},44:{f:mle},45:{f:vle},46:{f:wle},47:{f:ble},48:{},49:{f:Vne},50:{},51:{f:rce},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:r9},62:{f:pAe},63:{f:uce},64:{f:MAe},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Ri,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:RAe},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:Kue},148:{f:Vue,p:16},151:{f:IAe},152:{},153:{f:phe},154:{},155:{},156:{f:fhe},157:{},158:{},159:{T:1,f:Boe},160:{T:-1},161:{T:1,f:nm},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:jAe},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:ece},336:{T:-1},337:{f:ace,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:qj},357:{},358:{},359:{},360:{T:1},361:{},362:{f:t9},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:kAe},427:{f:BAe},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:PAe},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:$ue},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:_Ae},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:qj},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:wce},633:{T:1},634:{T:-1},635:{T:1,f:vce},636:{T:-1},637:{f:zne},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:she},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:QAe},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},tS={6:{f:cC},10:{f:zu},12:{f:fa},13:{f:fa},14:{f:Kn},15:{f:Kn},16:{f:_i},17:{f:Kn},18:{f:Kn},19:{f:fa},20:{f:fF},21:{f:fF},23:{f:t9},24:{f:pF},25:{f:Kn},26:{},27:{},28:{f:Qie},29:{},34:{f:Kn},35:{f:mF},38:{f:_i},39:{f:_i},40:{f:_i},41:{f:_i},42:{f:Kn},43:{f:Kn},47:{f:Zoe},49:{f:fie},51:{f:fa},60:{},61:{f:cie},64:{f:Kn},65:{f:hie},66:{f:fa},77:{},80:{},81:{},82:{},85:{f:fa},89:{},90:{},91:{},92:{f:Jae},93:{f:$ie},94:{},95:{f:Kn},96:{},97:{},99:{f:Kn},125:{f:r9},128:{f:Tie},129:{f:eie},130:{f:fa},131:{f:Kn},132:{f:Kn},133:{f:tie},134:{},140:{f:Jie},141:{f:fa},144:{},146:{f:toe},151:{},152:{},153:{},154:{},155:{},156:{f:fa},157:{},158:{},160:{f:loe},161:{f:noe},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:jie},190:{f:Sie},193:{f:zu},197:{},198:{},199:{},200:{},201:{},202:{f:Kn},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:fa},220:{},221:{f:Kn},222:{},224:{f:_ie},225:{f:Xae},226:{f:zu},227:{},229:{f:Vie},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:sie},253:{f:pie},255:{f:aie},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:z7},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Kn},353:{f:zu},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:Pie},431:{f:Kn},432:{},433:{},434:{},437:{},438:{f:qie},439:{f:Kn},440:{f:Wie},441:{},442:{f:ov},443:{},444:{f:fa},445:{},446:{},448:{f:zu},449:{f:lie,r:2},450:{f:zu},512:{f:uF},513:{f:ooe},515:{f:Bie},516:{f:xie},517:{f:hF},519:{f:coe},520:{f:iie},523:{},545:{f:gF},549:{f:dF},566:{},574:{f:uie},638:{f:Cie},659:{},1048:{},1054:{f:vie},1084:{},1212:{f:Oie},2048:{f:Yie},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:v1},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:zu},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:roe,r:12},2173:{f:Jle,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Kn,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:Lie,r:12},2197:{},2198:{f:zle,r:12},2199:{},2200:{},2201:{},2202:{f:Uie,r:12},2203:{f:zu},2204:{},2205:{},2206:{},2207:{},2211:{f:oie},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:fa},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:aoe},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:eoe},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:uF},1:{},2:{f:foe},3:{f:Aoe},4:{f:uoe},5:{f:hF},7:{f:poe},8:{},9:{f:v1},11:{},22:{f:fa},30:{f:wie},31:{},32:{},33:{f:gF},36:{},37:{f:dF},50:{f:goe},62:{},52:{},67:{},68:{f:fa},69:{},86:{},126:{},127:{f:doe},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:xoe},223:{},234:{},354:{},421:{},518:{f:cC},521:{f:v1},536:{f:pF},547:{f:mF},561:{},579:{},1030:{f:cC},1033:{f:v1},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function tr(t,e,r,s){var n=e;if(!isNaN(n)){var i=s||(r||[]).length||0,o=t.next(4);o.write_shift(2,n),o.write_shift(2,i),i>0&&j_(r)&&t.push(r)}}function pfe(t,e,r,s){var n=(r||[]).length||0;if(n<=8224)return tr(t,e,r,n);var i=e;if(!isNaN(i)){for(var o=r.parts||[],l=0,c=0,d=0;d+(o[l]||8224)<=8224;)d+=o[l]||8224,l++;var u=t.next(4);for(u.write_shift(2,i),u.write_shift(2,d),t.push(r.slice(c,c+d)),c+=d;c<n;){for(u=t.next(4),u.write_shift(2,60),d=0;d+(o[l]||8224)<=8224;)d+=o[l]||8224,l++;u.write_shift(2,d),t.push(r.slice(c,c+d)),c+=d}}}function uv(t,e,r){return t||(t=It(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function gfe(t,e,r,s){var n=It(9);return uv(n,t,e),q7(r,s||"b",n),n}function xfe(t,e,r){var s=It(8+2*r.length);return uv(s,t,e),s.write_shift(1,r.length),s.write_shift(r.length,r,"sbcs"),s.l<s.length?s.slice(0,s.l):s}function yfe(t,e,r,s){if(e.v!=null)switch(e.t){case"d":case"n":var n=e.t=="d"?_a(pn(e.v)):e.v;n==(n|0)&&n>=0&&n<65536?tr(t,2,moe(r,s,n)):tr(t,3,hoe(r,s,n));return;case"b":case"e":tr(t,5,gfe(r,s,e.v,e.t));return;case"s":case"str":tr(t,4,xfe(r,s,(e.v||"").slice(0,255)));return}tr(t,1,uv(null,r,s))}function vfe(t,e,r,s){var n=Array.isArray(e),i=bs(e["!ref"]||"A1"),o,l="",c=[];if(i.e.c>255||i.e.r>16383){if(s.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),o=Gr(i)}for(var d=i.s.r;d<=i.e.r;++d){l=na(d);for(var u=i.s.c;u<=i.e.c;++u){d===i.s.r&&(c[u]=Sn(u)),o=c[u]+l;var A=n?(e[d]||[])[u]:e[o];A&&yfe(t,A,d,u)}}}function bfe(t,e){for(var r=e||{},s=jo(),n=0,i=0;i<t.SheetNames.length;++i)t.SheetNames[i]==r.sheet&&(n=i);if(n==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return tr(s,r.biff==4?1033:r.biff==3?521:9,D_(t,16,r)),vfe(s,t.Sheets[t.SheetNames[n]],n,r),tr(s,10),s.end()}function wfe(t,e,r){tr(t,49,mie({sz:12,name:"Arial"},r))}function Nfe(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var n=s[0];n<=s[1];++n)e[n]!=null&&tr(t,1054,bie(n,e[n],r))})}function Cfe(t,e){var r=It(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),tr(t,2151,r),r=It(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),J7(bs(e["!ref"]||"A1"),r),r.write_shift(4,4),tr(t,2152,r)}function jfe(t,e){for(var r=0;r<16;++r)tr(t,224,AF({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(s){tr(t,224,AF(s,0,e))})}function Sfe(t,e){for(var r=0;r<e["!links"].length;++r){var s=e["!links"][r];tr(t,440,Gie(s)),s[1].Tooltip&&tr(t,2048,Xie(s))}delete e["!links"]}function Efe(t,e){if(e){var r=0;e.forEach(function(s,n){++r<=256&&s&&tr(t,125,soe(_N(n,s),n))})}}function _fe(t,e,r,s,n){var i=16+yh(n.cellXfs,e,n);if(e.v==null&&!e.bf){tr(t,513,Kf(r,s,i));return}if(e.bf)tr(t,6,eue(e,r,s,n,i));else switch(e.t){case"d":case"n":var o=e.t=="d"?_a(pn(e.v)):e.v;tr(t,515,Fie(r,s,o,i));break;case"b":case"e":tr(t,517,kie(r,s,e.v,i,n,e.t));break;case"s":case"str":if(n.bookSST){var l=H_(n.Strings,e.v,n.revStrings);tr(t,253,gie(r,s,l,i))}else tr(t,516,yie(r,s,(e.v||"").slice(0,255),i,n));break;default:tr(t,513,Kf(r,s,i))}}function Tfe(t,e,r){var s=jo(),n=r.SheetNames[t],i=r.Sheets[n]||{},o=(r||{}).Workbook||{},l=(o.Sheets||[])[t]||{},c=Array.isArray(i),d=e.biff==8,u,A="",h=[],f=bs(i["!ref"]||"A1"),p=d?65536:16384;if(f.e.c>255||f.e.r>=p){if(e.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");f.e.c=Math.min(f.e.c,255),f.e.r=Math.min(f.e.c,p-1)}tr(s,2057,D_(r,16,e)),tr(s,13,vl(1)),tr(s,12,vl(100)),tr(s,15,zi(!0)),tr(s,17,zi(!1)),tr(s,16,Hf(.001)),tr(s,95,zi(!0)),tr(s,42,zi(!1)),tr(s,43,zi(!1)),tr(s,130,vl(1)),tr(s,128,Iie()),tr(s,131,zi(!1)),tr(s,132,zi(!1)),d&&Efe(s,i["!cols"]),tr(s,512,Nie(f,e)),d&&(i["!links"]=[]);for(var m=f.s.r;m<=f.e.r;++m){A=na(m);for(var g=f.s.c;g<=f.e.c;++g){m===f.s.r&&(h[g]=Sn(g)),u=h[g]+A;var y=c?(i[m]||[])[g]:i[u];y&&(_fe(s,y,m,g,e),d&&y.l&&i["!links"].push([u,y.l]))}}var v=l.CodeName||l.name||n;return d&&tr(s,574,Aie((o.Views||[])[0])),d&&(i["!merges"]||[]).length&&tr(s,229,Hie(i["!merges"])),d&&Sfe(s,i),tr(s,442,W7(v)),d&&Cfe(s,i),tr(s,10),s.end()}function Ife(t,e,r){var s=jo(),n=(t||{}).Workbook||{},i=n.Sheets||[],o=n.WBProps||{},l=r.biff==8,c=r.biff==5;if(tr(s,2057,D_(t,5,r)),r.bookType=="xla"&&tr(s,135),tr(s,225,l?vl(1200):null),tr(s,193,kae(2)),c&&tr(s,191),c&&tr(s,192),tr(s,226),tr(s,92,Zae("SheetJS",r)),tr(s,66,vl(l?1200:1252)),l&&tr(s,353,vl(0)),l&&tr(s,448),tr(s,317,ioe(t.SheetNames.length)),l&&t.vbaraw&&tr(s,211),l&&t.vbaraw){var d=o.CodeName||"ThisWorkbook";tr(s,442,W7(d))}tr(s,156,vl(17)),tr(s,25,zi(!1)),tr(s,18,zi(!1)),tr(s,19,vl(0)),l&&tr(s,431,zi(!1)),l&&tr(s,444,vl(0)),tr(s,61,die()),tr(s,64,zi(!1)),tr(s,141,vl(0)),tr(s,34,zi(lhe(t)=="true")),tr(s,14,zi(!0)),l&&tr(s,439,zi(!1)),tr(s,218,vl(0)),wfe(s,t,r),Nfe(s,t.SSF,r),jfe(s,r),l&&tr(s,352,zi(!1));var u=s.end(),A=jo();l&&tr(A,140,Zie()),l&&r.Strings&&pfe(A,252,nie(r.Strings)),tr(A,10);var h=A.end(),f=jo(),p=0,m=0;for(m=0;m<t.SheetNames.length;++m)p+=(l?12:11)+(l?2:1)*t.SheetNames[m].length;var g=u.length+p+h.length;for(m=0;m<t.SheetNames.length;++m){var y=i[m]||{};tr(f,133,rie({pos:g,hs:y.Hidden||0,dt:0,name:t.SheetNames[m]},r)),g+=e[m].length}var v=f.end();if(p!=v.length)throw new Error("BS8 "+p+" != "+v.length);var x=[];return u.length&&x.push(u),v.length&&x.push(v),h.length&&x.push(h),Va(x)}function kfe(t,e){var r=e||{},s=[];t&&!t.SSF&&(t.SSF=gn(Ir)),t&&t.SSF&&(Lp(),bN(t.SSF),r.revssf=NN(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,W_(r),r.cellXfs=[],yh(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var n=0;n<t.SheetNames.length;++n)s[s.length]=Tfe(n,r,t);return s.unshift(Ife(t,s,r)),Va(s)}function Q9(t,e){for(var r=0;r<=t.SheetNames.length;++r){var s=t.Sheets[t.SheetNames[r]];if(!(!s||!s["!ref"])){var n=So(s["!ref"]);n.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var i=e||{};switch(i.biff||2){case 8:case 5:return kfe(t,e);case 4:case 3:case 2:return bfe(t,e)}throw new Error("invalid type "+i.bookType+" for BIFF")}function EF(t,e){var r=e||{},s=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var n=t.match(/<table/i);if(!n)throw new Error("Invalid HTML: could not find <table>");var i=t.match(/<\/table/i),o=n.index,l=i&&i.index||t.length,c=mne(t.slice(o,l),/(:?<tr[^>]*>)/i,"<tr>"),d=-1,u=0,A=0,h=0,f={s:{r:1e7,c:1e7},e:{r:0,c:0}},p=[];for(o=0;o<c.length;++o){var m=c[o].trim(),g=m.slice(0,3).toLowerCase();if(g=="<tr"){if(++d,r.sheetRows&&r.sheetRows<=d){--d;break}u=0;continue}if(!(g!="<td"&&g!="<th")){var y=m.split(/<\/t[dh]>/i);for(l=0;l<y.length;++l){var v=y[l].trim();if(v.match(/<t[dh]/i)){for(var x=v,E=0;x.charAt(0)=="<"&&(E=x.indexOf(">"))>-1;)x=x.slice(E+1);for(var T=0;T<p.length;++T){var j=p[T];j.s.c==u&&j.s.r<d&&d<=j.e.r&&(u=j.e.c+1,T=-1)}var C=Rr(v.slice(0,v.indexOf(">")));h=C.colspan?+C.colspan:1,((A=+C.rowspan)>1||h>1)&&p.push({s:{r:d,c:u},e:{r:d+(A||1)-1,c:u+h-1}});var w=C.t||C["data-t"]||"";if(!x.length){u+=h;continue}if(x=u7(x),f.s.r>d&&(f.s.r=d),f.e.r<d&&(f.e.r=d),f.s.c>u&&(f.s.c=u),f.e.c<u&&(f.e.c=u),!x.length){u+=h;continue}var S={t:"s",v:x};r.raw||!x.trim().length||w=="s"||(x==="TRUE"?S={t:"b",v:!0}:x==="FALSE"?S={t:"b",v:!1}:isNaN(Ac(x))?isNaN(vp(x).getDate())||(S={t:"d",v:pn(x)},r.cellDates||(S={t:"n",v:_a(S.v)}),S.z=r.dateNF||Ir[14]):S={t:"n",v:Ac(x)}),r.dense?(s[d]||(s[d]=[]),s[d][u]=S):s[Fr({r:d,c:u})]=S,u+=h}}}}return s["!ref"]=Gr(f),p.length&&(s["!merges"]=p),s}function Bfe(t,e,r,s){for(var n=t["!merges"]||[],i=[],o=e.s.c;o<=e.e.c;++o){for(var l=0,c=0,d=0;d<n.length;++d)if(!(n[d].s.r>r||n[d].s.c>o)&&!(n[d].e.r<r||n[d].e.c<o)){if(n[d].s.r<r||n[d].s.c<o){l=-1;break}l=n[d].e.r-n[d].s.r+1,c=n[d].e.c-n[d].s.c+1;break}if(!(l<0)){var u=Fr({r,c:o}),A=s.dense?(t[r]||[])[o]:t[u],h=A&&A.v!=null&&(A.h||w_(A.w||(iu(A),A.w)||""))||"",f={};l>1&&(f.rowspan=l),c>1&&(f.colspan=c),s.editable?h='<span contenteditable="true">'+h+"</span>":A&&(f["data-t"]=A&&A.t||"z",A.v!=null&&(f["data-v"]=A.v),A.z!=null&&(f["data-z"]=A.z),A.l&&(A.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+A.l.Target+'">'+h+"</a>")),f.id=(s.id||"sjs")+"-"+u,i.push(er("td",h,f))}}var p="<tr>";return p+i.join("")+"</tr>"}var Ffe='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',Pfe="</body></html>";function Dfe(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return xh(EF(r[0],e),e);var s=X_();return r.forEach(function(n,i){J_(s,EF(n,e),"Sheet"+(i+1))}),s}function Rfe(t,e,r){var s=[];return s.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function V9(t,e){var r=e||{},s=r.header!=null?r.header:Ffe,n=r.footer!=null?r.footer:Pfe,i=[s],o=So(t["!ref"]);r.dense=Array.isArray(t),i.push(Rfe(t,o,r));for(var l=o.s.r;l<=o.e.r;++l)i.push(Bfe(t,o,l,r));return i.push("</table>"+n),i.join("")}function H9(t,e,r){var s=r||{},n=0,i=0;if(s.origin!=null)if(typeof s.origin=="number")n=s.origin;else{var o=typeof s.origin=="string"?En(s.origin):s.origin;n=o.r,i=o.c}var l=e.getElementsByTagName("tr"),c=Math.min(s.sheetRows||1e7,l.length),d={s:{r:0,c:0},e:{r:n,c:i}};if(t["!ref"]){var u=So(t["!ref"]);d.s.r=Math.min(d.s.r,u.s.r),d.s.c=Math.min(d.s.c,u.s.c),d.e.r=Math.max(d.e.r,u.e.r),d.e.c=Math.max(d.e.c,u.e.c),n==-1&&(d.e.r=n=u.e.r+1)}var A=[],h=0,f=t["!rows"]||(t["!rows"]=[]),p=0,m=0,g=0,y=0,v=0,x=0;for(t["!cols"]||(t["!cols"]=[]);p<l.length&&m<c;++p){var E=l[p];if(_F(E)){if(s.display)continue;f[m]={hidden:!0}}var T=E.children;for(g=y=0;g<T.length;++g){var j=T[g];if(!(s.display&&_F(j))){var C=j.hasAttribute("data-v")?j.getAttribute("data-v"):j.hasAttribute("v")?j.getAttribute("v"):u7(j.innerHTML),w=j.getAttribute("data-z")||j.getAttribute("z");for(h=0;h<A.length;++h){var S=A[h];S.s.c==y+i&&S.s.r<m+n&&m+n<=S.e.r&&(y=S.e.c+1-i,h=-1)}x=+j.getAttribute("colspan")||1,((v=+j.getAttribute("rowspan")||1)>1||x>1)&&A.push({s:{r:m+n,c:y+i},e:{r:m+n+(v||1)-1,c:y+i+(x||1)-1}});var F={t:"s",v:C},B=j.getAttribute("data-t")||j.getAttribute("t")||"";C!=null&&(C.length==0?F.t=B||"z":s.raw||C.trim().length==0||B=="s"||(C==="TRUE"?F={t:"b",v:!0}:C==="FALSE"?F={t:"b",v:!1}:isNaN(Ac(C))?isNaN(vp(C).getDate())||(F={t:"d",v:pn(C)},s.cellDates||(F={t:"n",v:_a(F.v)}),F.z=s.dateNF||Ir[14]):F={t:"n",v:Ac(C)})),F.z===void 0&&w!=null&&(F.z=w);var k="",D=j.getElementsByTagName("A");if(D&&D.length)for(var q=0;q<D.length&&!(D[q].hasAttribute("href")&&(k=D[q].getAttribute("href"),k.charAt(0)!="#"));++q);k&&k.charAt(0)!="#"&&(F.l={Target:k}),s.dense?(t[m+n]||(t[m+n]=[]),t[m+n][y+i]=F):t[Fr({c:y+i,r:m+n})]=F,d.e.c<y+i&&(d.e.c=y+i),y+=x}}++m}return A.length&&(t["!merges"]=(t["!merges"]||[]).concat(A)),d.e.r=Math.max(d.e.r,m-1+n),t["!ref"]=Gr(d),m>=c&&(t["!fullref"]=Gr((d.e.r=l.length-p+m-1+n,d))),t}function $9(t,e){var r=e||{},s=r.dense?[]:{};return H9(s,t,e)}function Lfe(t,e){return xh($9(t,e),e)}function _F(t){var e="",r=Ofe(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function Ofe(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function Ufe(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(s,n){return Array(parseInt(n,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=vs(e.replace(/<[^>]*>/g,""));return[r]}var TF={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function K9(t,e){var r=e||{},s=N_(t),n=[],i,o,l={name:""},c="",d=0,u,A,h={},f=[],p=r.dense?[]:{},m,g,y={value:""},v="",x=0,E=[],T=-1,j=-1,C={s:{r:1e6,c:1e7},e:{r:0,c:0}},w=0,S={},F=[],B={},k=0,D=0,q=[],te=1,W=1,Q=[],re={Names:[]},G={},Ae=["",""],he=[],I={},U="",V=0,L=!1,K=!1,fe=0;for(fy.lastIndex=0,s=s.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");m=fy.exec(s);)switch(m[3]=m[3].replace(/_.*$/,"")){case"table":case"":m[1]==="/"?(C.e.c>=C.s.c&&C.e.r>=C.s.r?p["!ref"]=Gr(C):p["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=C.e.r&&(p["!fullref"]=p["!ref"],C.e.r=r.sheetRows-1,p["!ref"]=Gr(C)),F.length&&(p["!merges"]=F),q.length&&(p["!rows"]=q),u.name=u.||u.name,typeof JSON<"u"&&JSON.stringify(u),f.push(u.name),h[u.name]=p,K=!1):m[0].charAt(m[0].length-2)!=="/"&&(u=Rr(m[0],!1),T=j=-1,C.s.r=C.s.c=1e7,C.e.r=C.e.c=0,p=r.dense?[]:{},F=[],q=[],K=!0);break;case"table-row-group":m[1]==="/"?--w:++w;break;case"table-row":case"":if(m[1]==="/"){T+=te,te=1;break}if(A=Rr(m[0],!1),A.?T=A.-1:T==-1&&(T=0),te=+A["number-rows-repeated"]||1,te<10)for(fe=0;fe<te;++fe)w>0&&(q[T+fe]={level:w});j=-1;break;case"covered-table-cell":m[1]!=="/"&&++j,r.sheetStubs&&(r.dense?(p[T]||(p[T]=[]),p[T][j]={t:"z"}):p[Fr({r:T,c:j})]={t:"z"}),v="",E=[];break;case"table-cell":case"":if(m[0].charAt(m[0].length-2)==="/")++j,y=Rr(m[0],!1),W=parseInt(y["number-columns-repeated"]||"1",10),g={t:"z",v:null},y.formula&&r.cellFormula!=!1&&(g.f=CF(vs(y.formula))),(y.||y["value-type"])=="string"&&(g.t="s",g.v=vs(y["string-value"]||""),r.dense?(p[T]||(p[T]=[]),p[T][j]=g):p[Fr({r:T,c:j})]=g),j+=W-1;else if(m[1]!=="/"){++j,v="",x=0,E=[],W=1;var ee=te?T+te-1:T;if(j>C.e.c&&(C.e.c=j),j<C.s.c&&(C.s.c=j),T<C.s.r&&(C.s.r=T),ee>C.e.r&&(C.e.r=ee),y=Rr(m[0],!1),he=[],I={},g={t:y.||y["value-type"],v:null},r.cellFormula)if(y.formula&&(y.formula=vs(y.formula)),y["number-matrix-columns-spanned"]&&y["number-matrix-rows-spanned"]&&(k=parseInt(y["number-matrix-rows-spanned"],10)||0,D=parseInt(y["number-matrix-columns-spanned"],10)||0,B={s:{r:T,c:j},e:{r:T+k-1,c:j+D-1}},g.F=Gr(B),Q.push([B,g.F])),y.formula)g.f=CF(y.formula);else for(fe=0;fe<Q.length;++fe)T>=Q[fe][0].s.r&&T<=Q[fe][0].e.r&&j>=Q[fe][0].s.c&&j<=Q[fe][0].e.c&&(g.F=Q[fe][1]);switch((y["number-columns-spanned"]||y["number-rows-spanned"])&&(k=parseInt(y["number-rows-spanned"],10)||0,D=parseInt(y["number-columns-spanned"],10)||0,B={s:{r:T,c:j},e:{r:T+k-1,c:j+D-1}},F.push(B)),y["number-columns-repeated"]&&(W=parseInt(y["number-columns-repeated"],10)),g.t){case"boolean":g.t="b",g.v=un(y["boolean-value"]);break;case"float":g.t="n",g.v=parseFloat(y.value);break;case"percentage":g.t="n",g.v=parseFloat(y.value);break;case"currency":g.t="n",g.v=parseFloat(y.value);break;case"date":g.t="d",g.v=pn(y["date-value"]),r.cellDates||(g.t="n",g.v=_a(g.v)),g.z="m/d/yy";break;case"time":g.t="n",g.v=Ane(y["time-value"])/86400,r.cellDates&&(g.t="d",g.v=CN(g.v)),g.z="HH:MM:SS";break;case"number":g.t="n",g.v=parseFloat(y.);break;default:if(g.t==="string"||g.t==="text"||!g.t)g.t="s",y["string-value"]!=null&&(v=vs(y["string-value"]),E=[]);else throw new Error("Unsupported value type "+g.t)}}else{if(L=!1,g.t==="s"&&(g.v=v||"",E.length&&(g.R=E),L=x==0),G.Target&&(g.l=G),he.length>0&&(g.c=he,he=[]),v&&r.cellText!==!1&&(g.w=v),L&&(g.t="z",delete g.v),(!L||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=T))for(var de=0;de<te;++de){if(W=parseInt(y["number-columns-repeated"]||"1",10),r.dense)for(p[T+de]||(p[T+de]=[]),p[T+de][j]=de==0?g:gn(g);--W>0;)p[T+de][j+W]=gn(g);else for(p[Fr({r:T+de,c:j})]=g;--W>0;)p[Fr({r:T+de,c:j+W})]=gn(g);C.e.c<=j&&(C.e.c=j)}W=parseInt(y["number-columns-repeated"]||"1",10),j+=W-1,W=0,g={},v="",E=[]}G={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(m[1]==="/"){if((i=n.pop())[0]!==m[3])throw"Bad state: "+i}else m[0].charAt(m[0].length-2)!=="/"&&n.push([m[3],!0]);break;case"annotation":if(m[1]==="/"){if((i=n.pop())[0]!==m[3])throw"Bad state: "+i;I.t=v,E.length&&(I.R=E),I.a=U,he.push(I)}else m[0].charAt(m[0].length-2)!=="/"&&n.push([m[3],!1]);U="",V=0,v="",x=0,E=[];break;case"creator":m[1]==="/"?U=s.slice(V,m.index):V=m.index+m[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(m[1]==="/"){if((i=n.pop())[0]!==m[3])throw"Bad state: "+i}else m[0].charAt(m[0].length-2)!=="/"&&n.push([m[3],!1]);v="",x=0,E=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(m[1]==="/"){if(S[l.name]=c,(i=n.pop())[0]!==m[3])throw"Bad state: "+i}else m[0].charAt(m[0].length-2)!=="/"&&(c="",l=Rr(m[0],!1),n.push([m[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(n[n.length-1][0]){case"time-style":case"date-style":o=Rr(m[0],!1),c+=TF[m[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(n[n.length-1][0]){case"time-style":case"date-style":o=Rr(m[0],!1),c+=TF[m[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(m[0].slice(-2)==="/>")break;if(m[1]==="/")switch(n[n.length-1][0]){case"number-style":case"date-style":case"time-style":c+=s.slice(d,m.index);break}else d=m.index+m[0].length;break;case"named-range":o=Rr(m[0],!1),Ae=dC(o["cell-range-address"]);var ue={Name:o.name,Ref:Ae[0]+"!"+Ae[1]};K&&(ue.Sheet=f.length),re.Names.push(ue);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(n[n.length-1][0])>-1)break;if(m[1]==="/"&&(!y||!y["string-value"])){var Ie=Ufe(s.slice(x,m.index));v=(v.length>0?v+`
`:"")+Ie[0]}else Rr(m[0],!1),x=m.index+m[0].length;break;case"s":break;case"database-range":if(m[1]==="/")break;try{Ae=dC(Rr(m[0])["target-range-address"]),h[Ae[0]]["!autofilter"]={ref:Ae[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(m[1]!=="/"){if(G=Rr(m[0],!1),!G.href)break;G.Target=vs(G.href),delete G.href,G.Target.charAt(0)=="#"&&G.Target.indexOf(".")>-1?(Ae=dC(G.Target.slice(1)),G.Target="#"+Ae[0]+"!"+Ae[1]):G.Target.match(/^\.\.[\\\/]/)&&(G.Target=G.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(m[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(m)}}var Y={Sheets:h,SheetNames:f,Workbook:re};return r.bookSheets&&delete Y.Sheets,Y}function IF(t,e){e=e||{},gl(t,"META-INF/manifest.xml")&&Aae(ha(t,"META-INF/manifest.xml"),e);var r=Ho(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var s=K9(Ks(r),e);return gl(t,"meta.xml")&&(s.Props=D7(ha(t,"meta.xml"))),s}function kF(t,e){return K9(t,e)}var Mfe=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+hy({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return oa+e}}(),BF=function(){var t=function(i){return Os(i).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,s=function(i,o,l){var c=[];c.push('      <table:table table:name="'+Os(o.SheetNames[l])+`" table:style-name="ta1">
`);var d=0,u=0,A=So(i["!ref"]||"A1"),h=i["!merges"]||[],f=0,p=Array.isArray(i);if(i["!cols"])for(u=0;u<=A.e.c;++u)c.push("        <table:table-column"+(i["!cols"][u]?' table:style-name="co'+i["!cols"][u].ods+'"':"")+`></table:table-column>
`);var m="",g=i["!rows"]||[];for(d=0;d<A.s.r;++d)m=g[d]?' table:style-name="ro'+g[d].ods+'"':"",c.push("        <table:table-row"+m+`></table:table-row>
`);for(;d<=A.e.r;++d){for(m=g[d]?' table:style-name="ro'+g[d].ods+'"':"",c.push("        <table:table-row"+m+`>
`),u=0;u<A.s.c;++u)c.push(e);for(;u<=A.e.c;++u){var y=!1,v={},x="";for(f=0;f!=h.length;++f)if(!(h[f].s.c>u)&&!(h[f].s.r>d)&&!(h[f].e.c<u)&&!(h[f].e.r<d)){(h[f].s.c!=u||h[f].s.r!=d)&&(y=!0),v["table:number-columns-spanned"]=h[f].e.c-h[f].s.c+1,v["table:number-rows-spanned"]=h[f].e.r-h[f].s.r+1;break}if(y){c.push(r);continue}var E=Fr({r:d,c:u}),T=p?(i[d]||[])[u]:i[E];if(T&&T.f&&(v["table:formula"]=Os(iue(T.f)),T.F&&T.F.slice(0,E.length)==E)){var j=So(T.F);v["table:number-matrix-columns-spanned"]=j.e.c-j.s.c+1,v["table:number-matrix-rows-spanned"]=j.e.r-j.s.r+1}if(!T){c.push(e);continue}switch(T.t){case"b":x=T.v?"TRUE":"FALSE",v["office:value-type"]="boolean",v["office:boolean-value"]=T.v?"true":"false";break;case"n":x=T.w||String(T.v||0),v["office:value-type"]="float",v["office:value"]=T.v||0;break;case"s":case"str":x=T.v==null?"":T.v,v["office:value-type"]="string";break;case"d":x=T.w||pn(T.v).toISOString(),v["office:value-type"]="date",v["office:date-value"]=pn(T.v).toISOString(),v["table:style-name"]="ce1";break;default:c.push(e);continue}var C=t(x);if(T.l&&T.l.Target){var w=T.l.Target;w=w.charAt(0)=="#"?"#"+oue(w.slice(1)):w,w.charAt(0)!="#"&&!w.match(/^\w+:/)&&(w="../"+w),C=er("text:a",C,{"xlink:href":w.replace(/&/g,"&amp;")})}c.push("          "+er("table:table-cell",er("text:p",C,{}),v)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},n=function(i,o){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var l=0;o.SheetNames.map(function(d){return o.Sheets[d]}).forEach(function(d){if(d&&d["!cols"]){for(var u=0;u<d["!cols"].length;++u)if(d["!cols"][u]){var A=d["!cols"][u];if(A.width==null&&A.wpx==null&&A.wch==null)continue;ZA(A),A.ods=l;var h=d["!cols"][u].wpx+"px";i.push('  <style:style style:name="co'+l+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+h+`"/>
`),i.push(`  </style:style>
`),++l}}});var c=0;o.SheetNames.map(function(d){return o.Sheets[d]}).forEach(function(d){if(d&&d["!rows"]){for(var u=0;u<d["!rows"].length;++u)if(d["!rows"][u]){d["!rows"][u].ods=c;var A=d["!rows"][u].hpx+"px";i.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+A+`"/>
`),i.push(`  </style:style>
`),++c}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(o,l){var c=[oa],d=hy({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),u=hy({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});l.bookType=="fods"?(c.push("<office:document"+d+u+`>
`),c.push(P7().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+d+`>
`),n(c,o),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var A=0;A!=o.SheetNames.length;++A)c.push(s(o.Sheets[o.SheetNames[A]],o,A));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),l.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function z9(t,e){if(e.bookType=="fods")return BF(t,e);var r=y_(),s="",n=[],i=[];return s="mimetype",Yr(r,s,"application/vnd.oasis.opendocument.spreadsheet"),s="content.xml",Yr(r,s,BF(t,e)),n.push([s,"text/xml"]),i.push([s,"ContentFile"]),s="styles.xml",Yr(r,s,Mfe(t,e)),n.push([s,"text/xml"]),i.push([s,"StylesFile"]),s="meta.xml",Yr(r,s,oa+P7()),n.push([s,"text/xml"]),i.push([s,"MetadataFile"]),s="manifest.rdf",Yr(r,s,mae(i)),n.push([s,"application/rdf+xml"]),s="META-INF/manifest.xml",Yr(r,s,hae(n)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function zf(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function rS(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):Ks(gh(t))}function Qfe(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):Vo($c(t))}function Vfe(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var s=0;s<e.length;++s)if(t[r+s]!=e[s])continue e;return!0}return!1}function th(t){var e=t.reduce(function(n,i){return n+i.length},0),r=new Uint8Array(e),s=0;return t.forEach(function(n){r.set(n,s),s+=n.length}),r}function FF(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function Hfe(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,s=t[e+14]&1,n=e+13;n>=e;--n)s=s*256+t[n];return(t[e+15]&128?-s:s)*Math.pow(10,r-6176)}function $fe(t,e,r){var s=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,n=r/Math.pow(10,s-6176);t[e+15]|=s>>7,t[e+14]|=(s&127)<<1;for(var i=0;n>=1;++i,n/=256)t[e+i]=n&255;t[e+15]|=r>=0?0:128}function by(t,e){var r=e?e[0]:0,s=t[r]&127;e:if(t[r++]>=128&&(s|=(t[r]&127)<<7,t[r++]<128||(s|=(t[r]&127)<<14,t[r++]<128)||(s|=(t[r]&127)<<21,t[r++]<128)||(s+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(s+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(s+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),s}function Ps(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function Mn(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function ws(t){for(var e=[],r=[0];r[0]<t.length;){var s=r[0],n=by(t,r),i=n&7;n=Math.floor(n/8);var o=0,l;if(n==0)break;switch(i){case 0:{for(var c=r[0];t[r[0]++]>=128;);l=t.slice(c,r[0])}break;case 5:o=4,l=t.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,l=t.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=by(t,r),l=t.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(n," at offset ").concat(s))}var d={data:l,type:i};e[n]==null?e[n]=[d]:e[n].push(d)}return e}function Ya(t){var e=[];return t.forEach(function(r,s){r.forEach(function(n){n.data&&(e.push(Ps(s*8+n.type)),n.type==2&&e.push(Ps(n.data.length)),e.push(n.data))})}),th(e)}function z_(t,e){return(t==null?void 0:t.map(function(r){return e(r.data)}))||[]}function ml(t){for(var e,r=[],s=[0];s[0]<t.length;){var n=by(t,s),i=ws(t.slice(s[0],s[0]+n));s[0]+=n;var o={id:Mn(i[1][0].data),messages:[]};i[2].forEach(function(l){var c=ws(l.data),d=Mn(c[3][0].data);o.messages.push({meta:c,data:t.slice(s[0],s[0]+d)}),s[0]+=d}),(e=i[3])!=null&&e[0]&&(o.merge=Mn(i[3][0].data)>>>0>0),r.push(o)}return r}function Pm(t){var e=[];return t.forEach(function(r){var s=[];s[1]=[{data:Ps(r.id),type:0}],s[2]=[],r.merge!=null&&(s[3]=[{data:Ps(+!!r.merge),type:0}]);var n=[];r.messages.forEach(function(o){n.push(o.data),o.meta[3]=[{type:0,data:Ps(o.data.length)}],s[2].push({data:Ya(o.meta),type:2})});var i=Ya(s);e.push(Ps(i.length)),e.push(i),n.forEach(function(o){return e.push(o)})}),th(e)}function Kfe(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],s=by(e,r),n=[];r[0]<e.length;){var i=e[r[0]]&3;if(i==0){var o=e[r[0]++]>>2;if(o<60)++o;else{var l=o-59;o=e[r[0]],l>1&&(o|=e[r[0]+1]<<8),l>2&&(o|=e[r[0]+2]<<16),l>3&&(o|=e[r[0]+3]<<24),o>>>=0,o++,r[0]+=l}n.push(e.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var c=0,d=0;if(i==1?(d=(e[r[0]]>>2&7)+4,c=(e[r[0]++]&224)<<3,c|=e[r[0]++]):(d=(e[r[0]++]>>2)+1,i==2?(c=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(c=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),n=[th(n)],c==0)throw new Error("Invalid offset 0");if(c>n[0].length)throw new Error("Invalid offset beyond length");if(d>=c)for(n.push(n[0].slice(-c)),d-=c;d>=n[n.length-1].length;)n.push(n[n.length-1]),d-=n[n.length-1].length;n.push(n[0].slice(-c,-c+d))}}var u=th(n);if(u.length!=s)throw new Error("Unexpected length: ".concat(u.length," != ").concat(s));return u}function pl(t){for(var e=[],r=0;r<t.length;){var s=t[r++],n=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(Kfe(s,t.slice(r,r+n))),r+=n}if(r!==t.length)throw new Error("data is not a valid framed stream!");return th(e)}function Dm(t){for(var e=[],r=0;r<t.length;){var s=Math.min(t.length-r,268435455),n=new Uint8Array(4);e.push(n);var i=Ps(s),o=i.length;e.push(i),s<=60?(o++,e.push(new Uint8Array([s-1<<2]))):s<=256?(o+=2,e.push(new Uint8Array([240,s-1&255]))):s<=65536?(o+=3,e.push(new Uint8Array([244,s-1&255,s-1>>8&255]))):s<=16777216?(o+=4,e.push(new Uint8Array([248,s-1&255,s-1>>8&255,s-1>>16&255]))):s<=4294967296&&(o+=5,e.push(new Uint8Array([252,s-1&255,s-1>>8&255,s-1>>16&255,s-1>>>24&255]))),e.push(t.slice(r,r+s)),o+=s,n[0]=0,n[1]=o&255,n[2]=o>>8&255,n[3]=o>>16&255,r+=s}return th(e)}function zfe(t,e,r,s){var n=zf(t),i=n.getUint32(4,!0),o=(s>1?12:8)+FF(i&(s>1?3470:398))*4,l=-1,c=-1,d=NaN,u=new Date(2001,0,1);i&512&&(l=n.getUint32(o,!0),o+=4),o+=FF(i&(s>1?12288:4096))*4,i&16&&(c=n.getUint32(o,!0),o+=4),i&32&&(d=n.getFloat64(o,!0),o+=8),i&64&&(u.setTime(u.getTime()+n.getFloat64(o,!0)*1e3),o+=8);var A;switch(t[2]){case 0:break;case 2:A={t:"n",v:d};break;case 3:A={t:"s",v:e[c]};break;case 5:A={t:"d",v:u};break;case 6:A={t:"b",v:d>0};break;case 7:A={t:"n",v:d/86400};break;case 8:A={t:"e",v:0};break;case 9:if(l>-1)A={t:"s",v:r[l]};else if(c>-1)A={t:"s",v:e[c]};else if(!isNaN(d))A={t:"n",v:d};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return A}function qfe(t,e,r){var s=zf(t),n=s.getUint32(8,!0),i=12,o=-1,l=-1,c=NaN,d=NaN,u=new Date(2001,0,1);n&1&&(c=Hfe(t,i),i+=16),n&2&&(d=s.getFloat64(i,!0),i+=8),n&4&&(u.setTime(u.getTime()+s.getFloat64(i,!0)*1e3),i+=8),n&8&&(l=s.getUint32(i,!0),i+=4),n&16&&(o=s.getUint32(i,!0),i+=4);var A;switch(t[1]){case 0:break;case 2:A={t:"n",v:c};break;case 3:A={t:"s",v:e[l]};break;case 5:A={t:"d",v:u};break;case 6:A={t:"b",v:d>0};break;case 7:A={t:"n",v:d/86400};break;case 8:A={t:"e",v:0};break;case 9:if(o>-1)A={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(n&31," : ").concat(t.slice(0,4)));break;case 10:A={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(n&31," : ").concat(t.slice(0,4)))}return A}function AC(t,e){var r=new Uint8Array(32),s=zf(r),n=12,i=0;switch(r[0]=5,t.t){case"n":r[1]=2,$fe(r,n,t.v),i|=1,n+=16;break;case"b":r[1]=6,s.setFloat64(n,t.v?1:0,!0),i|=2,n+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,s.setUint32(n,e.indexOf(t.v),!0),i|=8,n+=4;break;default:throw"unsupported cell type "+t.t}return s.setUint32(8,i,!0),r.slice(0,n)}function hC(t,e){var r=new Uint8Array(32),s=zf(r),n=12,i=0;switch(r[0]=3,t.t){case"n":r[2]=2,s.setFloat64(n,t.v,!0),i|=32,n+=8;break;case"b":r[2]=6,s.setFloat64(n,t.v?1:0,!0),i|=32,n+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,s.setUint32(n,e.indexOf(t.v),!0),i|=16,n+=4;break;default:throw"unsupported cell type "+t.t}return s.setUint32(4,i,!0),r.slice(0,n)}function Wfe(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return zfe(t,e,r,t[0]);case 5:return qfe(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function wi(t){var e=ws(t);return by(e[1][0].data)}function PF(t,e){var r=ws(e.data),s=Mn(r[1][0].data),n=r[3],i=[];return(n||[]).forEach(function(o){var l=ws(o.data),c=Mn(l[1][0].data)>>>0;switch(s){case 1:i[c]=rS(l[3][0].data);break;case 8:{var d=t[wi(l[9][0].data)][0],u=ws(d.data),A=t[wi(u[1][0].data)][0],h=Mn(A.meta[1][0].data);if(h!=2001)throw new Error("2000 unexpected reference to ".concat(h));var f=ws(A.data);i[c]=f[3].map(function(p){return rS(p.data)}).join("")}break}}),i}function Gfe(t,e){var r,s,n,i,o,l,c,d,u,A,h,f,p,m,g=ws(t),y=Mn(g[1][0].data)>>>0,v=Mn(g[2][0].data)>>>0,x=((s=(r=g[8])==null?void 0:r[0])==null?void 0:s.data)&&Mn(g[8][0].data)>0||!1,E,T;if((i=(n=g[7])==null?void 0:n[0])!=null&&i.data&&e!=0)E=(l=(o=g[7])==null?void 0:o[0])==null?void 0:l.data,T=(d=(c=g[6])==null?void 0:c[0])==null?void 0:d.data;else if((A=(u=g[4])==null?void 0:u[0])!=null&&A.data&&e!=1)E=(f=(h=g[4])==null?void 0:h[0])==null?void 0:f.data,T=(m=(p=g[3])==null?void 0:p[0])==null?void 0:m.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var j=x?4:1,C=zf(E),w=[],S=0;S<E.length/2;++S){var F=C.getUint16(S*2,!0);F<65535&&w.push([S,F])}if(w.length!=v)throw"Expected ".concat(v," cells, found ").concat(w.length);var B=[];for(S=0;S<w.length-1;++S)B[w[S][0]]=T.subarray(w[S][1]*j,w[S+1][1]*j);return w.length>=1&&(B[w[w.length-1][0]]=T.subarray(w[w.length-1][1]*j)),{R:y,cells:B}}function Yfe(t,e){var r,s=ws(e.data),n=(r=s==null?void 0:s[7])!=null&&r[0]?Mn(s[7][0].data)>>>0>0?1:0:-1,i=z_(s[5],function(o){return Gfe(o,n)});return{nrows:Mn(s[4][0].data)>>>0,data:i.reduce(function(o,l){return o[l.R]||(o[l.R]=[]),l.cells.forEach(function(c,d){if(o[l.R][d])throw new Error("Duplicate cell r=".concat(l.R," c=").concat(d));o[l.R][d]=c}),o},[])}}function Xfe(t,e,r){var s,n=ws(e.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(Mn(n[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(n[6][0].data));if(i.e.c=(Mn(n[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(n[7][0].data));r["!ref"]=Gr(i);var o=ws(n[4][0].data),l=PF(t,t[wi(o[4][0].data)][0]),c=(s=o[17])!=null&&s[0]?PF(t,t[wi(o[17][0].data)][0]):[],d=ws(o[3][0].data),u=0;d[1].forEach(function(A){var h=ws(A.data),f=t[wi(h[2][0].data)][0],p=Mn(f.meta[1][0].data);if(p!=6002)throw new Error("6001 unexpected reference to ".concat(p));var m=Yfe(t,f);m.data.forEach(function(g,y){g.forEach(function(v,x){var E=Fr({r:u+y,c:x}),T=Wfe(v,l,c);T&&(r[E]=T)})}),u+=m.nrows})}function Jfe(t,e){var r=ws(e.data),s={"!ref":"A1"},n=t[wi(r[2][0].data)],i=Mn(n[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return Xfe(t,n[0],s),s}function Zfe(t,e){var r,s=ws(e.data),n={name:(r=s[1])!=null&&r[0]?rS(s[1][0].data):"",sheets:[]},i=z_(s[2],wi);return i.forEach(function(o){t[o].forEach(function(l){var c=Mn(l.meta[1][0].data);c==6e3&&n.sheets.push(Jfe(t,l))})}),n}function eme(t,e){var r=X_(),s=ws(e.data),n=z_(s[1],wi);if(n.forEach(function(i){t[i].forEach(function(o){var l=Mn(o.meta[1][0].data);if(l==2){var c=Zfe(t,o);c.sheets.forEach(function(d,u){J_(r,d,u==0?c.name:c.name+"_"+u,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function fC(t){var e,r,s,n,i={},o=[];if(t.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var d;try{d=pl(c.content)}catch(A){return console.log("?? "+c.content.length+" "+(A.message||A))}var u;try{u=ml(d)}catch(A){return console.log("## "+(A.message||A))}u.forEach(function(A){i[A.id]=A.messages,o.push(A.id)})}}),!o.length)throw new Error("File has no messages");var l=((n=(s=(r=(e=i==null?void 0:i[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:s[1])==null?void 0:n[0].data)&&Mn(i[1][0].meta[1][0].data)==1&&i[1][0];if(l||o.forEach(function(c){i[c].forEach(function(d){var u=Mn(d.meta[1][0].data)>>>0;if(u==1)if(!l)l=d;else throw new Error("Document has multiple roots")})}),!l)throw new Error("Cannot find Document root");return eme(i,l)}function tme(t,e,r){var s,n,i,o;if(!((s=t[6])!=null&&s[0])||!((n=t[7])!=null&&n[0]))throw"Mutation only works on post-BNC storages!";var l=((o=(i=t[8])==null?void 0:i[0])==null?void 0:o.data)&&Mn(t[8][0].data)>0||!1;if(l)throw"Math only works with normal offsets";for(var c=0,d=zf(t[7][0].data),u=0,A=[],h=zf(t[4][0].data),f=0,p=[],m=0;m<e.length;++m){if(e[m]==null){d.setUint16(m*2,65535,!0),h.setUint16(m*2,65535);continue}d.setUint16(m*2,u,!0),h.setUint16(m*2,f,!0);var g,y;switch(typeof e[m]){case"string":g=AC({t:"s",v:e[m]},r),y=hC({t:"s",v:e[m]},r);break;case"number":g=AC({t:"n",v:e[m]},r),y=hC({t:"n",v:e[m]},r);break;case"boolean":g=AC({t:"b",v:e[m]},r),y=hC({t:"b",v:e[m]},r);break;default:throw new Error("Unsupported value "+e[m])}A.push(g),u+=g.length,p.push(y),f+=y.length,++c}for(t[2][0].data=Ps(c);m<t[7][0].data.length/2;++m)d.setUint16(m*2,65535,!0),h.setUint16(m*2,65535,!0);return t[6][0].data=th(A),t[3][0].data=th(p),c}function rme(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var s=So(r["!ref"]);s.s.r=s.s.c=0;var n=!1;s.e.c>9&&(n=!0,s.e.c=9),s.e.r>49&&(n=!0,s.e.r=49),n&&console.error("The Numbers writer is currently limited to ".concat(Gr(s)));var i=o2(r,{range:s,header:1}),o=["~Sh33tJ5~"];i.forEach(function(U){return U.forEach(function(V){typeof V=="string"&&o.push(V)})});var l={},c=[],d=Cr.read(e.numbers,{type:"base64"});d.FileIndex.map(function(U,V){return[U,d.FullPaths[V]]}).forEach(function(U){var V=U[0],L=U[1];if(V.type==2&&V.name.match(/\.iwa/)){var K=V.content,fe=pl(K),ee=ml(fe);ee.forEach(function(de){c.push(de.id),l[de.id]={deps:[],location:L,type:Mn(de.messages[0].meta[1][0].data)}})}}),c.sort(function(U,V){return U-V});var u=c.filter(function(U){return U>1}).map(function(U){return[U,Ps(U)]});d.FileIndex.map(function(U,V){return[U,d.FullPaths[V]]}).forEach(function(U){var V=U[0];if(U[1],!!V.name.match(/\.iwa/)){var L=ml(pl(V.content));L.forEach(function(K){K.messages.forEach(function(fe){u.forEach(function(ee){K.messages.some(function(de){return Mn(de.meta[1][0].data)!=11006&&Vfe(de.data,ee[1])})&&l[ee[0]].deps.push(K.id)})})})}});for(var A=Cr.find(d,l[1].location),h=ml(pl(A.content)),f,p=0;p<h.length;++p){var m=h[p];m.id==1&&(f=m)}var g=wi(ws(f.messages[0].data)[1][0].data);for(A=Cr.find(d,l[g].location),h=ml(pl(A.content)),p=0;p<h.length;++p)m=h[p],m.id==g&&(f=m);for(g=wi(ws(f.messages[0].data)[2][0].data),A=Cr.find(d,l[g].location),h=ml(pl(A.content)),p=0;p<h.length;++p)m=h[p],m.id==g&&(f=m);for(g=wi(ws(f.messages[0].data)[2][0].data),A=Cr.find(d,l[g].location),h=ml(pl(A.content)),p=0;p<h.length;++p)m=h[p],m.id==g&&(f=m);var y=ws(f.messages[0].data);{y[6][0].data=Ps(s.e.r+1),y[7][0].data=Ps(s.e.c+1);var v=wi(y[46][0].data),x=Cr.find(d,l[v].location),E=ml(pl(x.content));{for(var T=0;T<E.length&&E[T].id!=v;++T);if(E[T].id!=v)throw"Bad ColumnRowUIDMapArchive";var j=ws(E[T].messages[0].data);j[1]=[],j[2]=[],j[3]=[];for(var C=0;C<=s.e.c;++C){var w=[];w[1]=w[2]=[{type:0,data:Ps(C+420690)}],j[1].push({type:2,data:Ya(w)}),j[2].push({type:0,data:Ps(C)}),j[3].push({type:0,data:Ps(C)})}j[4]=[],j[5]=[],j[6]=[];for(var S=0;S<=s.e.r;++S)w=[],w[1]=w[2]=[{type:0,data:Ps(S+726270)}],j[4].push({type:2,data:Ya(w)}),j[5].push({type:0,data:Ps(S)}),j[6].push({type:0,data:Ps(S)});E[T].messages[0].data=Ya(j)}x.content=Dm(Pm(E)),x.size=x.content.length,delete y[46];var F=ws(y[4][0].data);{F[7][0].data=Ps(s.e.r+1);var B=ws(F[1][0].data),k=wi(B[2][0].data);x=Cr.find(d,l[k].location),E=ml(pl(x.content));{if(E[0].id!=k)throw"Bad HeaderStorageBucket";var D=ws(E[0].messages[0].data);for(S=0;S<i.length;++S){var q=ws(D[2][0].data);q[1][0].data=Ps(S),q[4][0].data=Ps(i[S].length),D[2][S]={type:D[2][0].type,data:Ya(q)}}E[0].messages[0].data=Ya(D)}x.content=Dm(Pm(E)),x.size=x.content.length;var te=wi(F[2][0].data);x=Cr.find(d,l[te].location),E=ml(pl(x.content));{if(E[0].id!=te)throw"Bad HeaderStorageBucket";for(D=ws(E[0].messages[0].data),C=0;C<=s.e.c;++C)q=ws(D[2][0].data),q[1][0].data=Ps(C),q[4][0].data=Ps(s.e.r+1),D[2][C]={type:D[2][0].type,data:Ya(q)};E[0].messages[0].data=Ya(D)}x.content=Dm(Pm(E)),x.size=x.content.length;var W=wi(F[4][0].data);(function(){for(var U=Cr.find(d,l[W].location),V=ml(pl(U.content)),L,K=0;K<V.length;++K){var fe=V[K];fe.id==W&&(L=fe)}var ee=ws(L.messages[0].data);{ee[3]=[];var de=[];o.forEach(function(Y,H){de[1]=[{type:0,data:Ps(H)}],de[2]=[{type:0,data:Ps(1)}],de[3]=[{type:2,data:Qfe(Y)}],ee[3].push({type:2,data:Ya(de)})})}L.messages[0].data=Ya(ee);var ue=Pm(V),Ie=Dm(ue);U.content=Ie,U.size=U.content.length})();var Q=ws(F[3][0].data);{var re=Q[1][0];delete Q[2];var G=ws(re.data);{var Ae=wi(G[2][0].data);(function(){for(var U=Cr.find(d,l[Ae].location),V=ml(pl(U.content)),L,K=0;K<V.length;++K){var fe=V[K];fe.id==Ae&&(L=fe)}var ee=ws(L.messages[0].data);{delete ee[6],delete Q[7];var de=new Uint8Array(ee[5][0].data);ee[5]=[];for(var ue=0,Ie=0;Ie<=s.e.r;++Ie){var Y=ws(de);ue+=tme(Y,i[Ie],o),Y[1][0].data=Ps(Ie),ee[5].push({data:Ya(Y),type:2})}ee[1]=[{type:0,data:Ps(s.e.c+1)}],ee[2]=[{type:0,data:Ps(s.e.r+1)}],ee[3]=[{type:0,data:Ps(ue)}],ee[4]=[{type:0,data:Ps(s.e.r+1)}]}L.messages[0].data=Ya(ee);var H=Pm(V),je=Dm(H);U.content=je,U.size=U.content.length})()}re.data=Ya(G)}F[3][0].data=Ya(Q)}y[4][0].data=Ya(F)}f.messages[0].data=Ya(y);var he=Pm(h),I=Dm(he);return A.content=I,A.size=A.content.length,d}function q9(t){return function(r){for(var s=0;s!=t.length;++s){var n=t[s];r[n[0]]===void 0&&(r[n[0]]=n[1]),n[2]==="n"&&(r[n[0]]=Number(r[n[0]]))}}}function q_(t){q9([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function W_(t){q9([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function sme(t){return ts.WS.indexOf(t)>-1?"sheet":t==ts.CS?"chart":t==ts.DS?"dialog":t==ts.MS?"macro":t&&t.length?t:"sheet"}function nme(t,e){if(!t)return 0;try{t=e.map(function(s){return s.id||(s.id=s.strRelID),[s.name,t["!id"][s.id].Target,sme(t["!id"][s.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function ame(t,e,r,s,n,i,o,l,c,d,u,A){try{i[s]=vx(Ho(t,r,!0),e);var h=ha(t,e),f;switch(l){case"sheet":f=Ehe(h,e,n,c,i[s],d,u,A);break;case"chart":if(f=_he(h,e,n,c,i[s],d,u,A),!f||!f["!drawel"])break;var p=Mg(f["!drawel"].Target,e),m=my(p),g=fce(Ho(t,p,!0),vx(Ho(t,m,!0),p)),y=Mg(g,p),v=my(y);f=the(Ho(t,y,!0),y,c,vx(Ho(t,v,!0),y),d,f);break;case"macro":f=The(h,e,n,c,i[s],d,u,A);break;case"dialog":f=Ihe(h,e,n,c,i[s],d,u,A);break;default:throw new Error("Unrecognized sheet type "+l)}o[s]=f;var x=[];i&&i[s]&&Qn(i[s]).forEach(function(E){var T="";if(i[s][E].Type==ts.CMNT){T=Mg(i[s][E].Target,e);var j=Phe(ha(t,T,!0),T,c);if(!j||!j.length)return;yF(f,j,!1)}i[s][E].Type==ts.TCMNT&&(T=Mg(i[s][E].Target,e),x=x.concat(pce(ha(t,T,!0),c)))}),x&&x.length&&yF(f,x,!0,c.people||[])}catch(E){if(c.WTF)throw E}}function hl(t){return t.charAt(0)=="/"?t.slice(1):t}function ime(t,e){if(Lp(),e=e||{},q_(e),gl(t,"META-INF/manifest.xml")||gl(t,"objectdata.xml"))return IF(t,e);if(gl(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof fC<"u"){if(t.FileIndex)return fC(t);var r=Cr.utils.cfb_new();return MB(t).forEach(function(q){Yr(r,q,gne(t,q))}),fC(r)}throw new Error("Unsupported NUMBERS file")}if(!gl(t,"[Content_Types].xml"))throw gl(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):gl(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var s=MB(t),n=dae(Ho(t,"[Content_Types].xml")),i=!1,o,l;if(n.workbooks.length===0&&(l="xl/workbook.xml",ha(t,l,!0)&&n.workbooks.push(l)),n.workbooks.length===0){if(l="xl/workbook.bin",!ha(t,l,!0))throw new Error("Could not find workbook");n.workbooks.push(l),i=!0}n.workbooks[0].slice(-3)=="bin"&&(i=!0);var c={},d={};if(!e.bookSheets&&!e.bookProps){if(bx=[],n.sst)try{bx=Fhe(ha(t,hl(n.sst)),n.sst,e)}catch(q){if(e.WTF)throw q}e.cellStyles&&n.themes.length&&(c=Bhe(Ho(t,n.themes[0].replace(/^\//,""),!0)||"",n.themes[0],e)),n.style&&(d=khe(ha(t,hl(n.style)),n.style,c,e))}n.links.map(function(q){try{var te=vx(Ho(t,my(hl(q))),q);return Rhe(ha(t,hl(q)),te,q,e)}catch{}});var u=She(ha(t,hl(n.workbooks[0])),n.workbooks[0],e),A={},h="";n.coreprops.length&&(h=ha(t,hl(n.coreprops[0]),!0),h&&(A=D7(h)),n.extprops.length!==0&&(h=ha(t,hl(n.extprops[0]),!0),h&&gae(h,A,e)));var f={};(!e.bookSheets||e.bookProps)&&n.custprops.length!==0&&(h=Ho(t,hl(n.custprops[0]),!0),h&&(f=yae(h,e)));var p={};if((e.bookSheets||e.bookProps)&&(u.Sheets?o=u.Sheets.map(function(te){return te.name}):A.Worksheets&&A.SheetNames.length>0&&(o=A.SheetNames),e.bookProps&&(p.Props=A,p.Custprops=f),e.bookSheets&&typeof o<"u"&&(p.SheetNames=o),e.bookSheets?p.SheetNames:e.bookProps))return p;o={};var m={};e.bookDeps&&n.calcchain&&(m=Dhe(ha(t,hl(n.calcchain)),n.calcchain));var g=0,y={},v,x;{var E=u.Sheets;A.Worksheets=E.length,A.SheetNames=[];for(var T=0;T!=E.length;++T)A.SheetNames[T]=E[T].name}var j=i?"bin":"xml",C=n.workbooks[0].lastIndexOf("/"),w=(n.workbooks[0].slice(0,C+1)+"_rels/"+n.workbooks[0].slice(C+1)+".rels").replace(/^\//,"");gl(t,w)||(w="xl/_rels/workbook."+j+".rels");var S=vx(Ho(t,w,!0),w.replace(/_rels.*/,"s5s"));(n.metadata||[]).length>=1&&(e.xlmeta=Lhe(ha(t,hl(n.metadata[0])),n.metadata[0],e)),(n.people||[]).length>=1&&(e.people=xce(ha(t,hl(n.people[0])),e)),S&&(S=nme(S,u.Sheets));var F=ha(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(g=0;g!=A.Worksheets;++g){var B="sheet";if(S&&S[g]?(v="xl/"+S[g][1].replace(/[\/]?xl\//,""),gl(t,v)||(v=S[g][1]),gl(t,v)||(v=w.replace(/_rels\/.*$/,"")+S[g][1]),B=S[g][2]):(v="xl/worksheets/sheet"+(g+1-F)+"."+j,v=v.replace(/sheet0\./,"sheet.")),x=v.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(g!=e.sheets)continue e;break;case"string":if(A.SheetNames[g].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var k=!1,D=0;D!=e.sheets.length;++D)typeof e.sheets[D]=="number"&&e.sheets[D]==g&&(k=1),typeof e.sheets[D]=="string"&&e.sheets[D].toLowerCase()==A.SheetNames[g].toLowerCase()&&(k=1);if(!k)continue e}}ame(t,v,x,A.SheetNames[g],g,y,o,B,e,u,c,d)}return p={Directory:n,Workbook:u,Props:A,Custprops:f,Deps:m,Sheets:o,SheetNames:A.SheetNames,Strings:bx,Styles:d,Themes:c,SSF:gn(Ir)},e&&e.bookFiles&&(t.files?(p.keys=s,p.files=t.files):(p.keys=[],p.files={},t.FullPaths.forEach(function(q,te){q=q.replace(/^Root Entry[\/]/,""),p.keys.push(q),p.files[q]=t.FileIndex[te]}))),e&&e.bookVBA&&(n.vba.length>0?p.vbaraw=ha(t,hl(n.vba[0]),!0):n.defaults&&n.defaults.bin===Sce&&(p.vbaraw=ha(t,"xl/vbaProject.bin",!0))),p}function ome(t,e){var r=e||{},s="Workbook",n=Cr.find(t,s);try{if(s="/!DataSpaces/Version",n=Cr.find(t,s),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+s);if(Loe(n.content),s="/!DataSpaces/DataSpaceMap",n=Cr.find(t,s),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+s);var i=Uoe(n.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+s);if(s="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",n=Cr.find(t,s),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+s);var o=Moe(n.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+s);if(s="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",n=Cr.find(t,s),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+s);Voe(n.content)}catch{}if(s="/EncryptionInfo",n=Cr.find(t,s),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+s);var l=Hoe(n.content);if(s="/EncryptedPackage",n=Cr.find(t,s),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+s);if(l[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(l[1],n.content,r.password||"",r);if(l[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(l[1],n.content,r.password||"",r);throw new Error("File is password-protected")}function lme(t,e){return e.bookType=="ods"?z9(t,e):e.bookType=="numbers"?rme(t,e):e.bookType=="xlsb"?cme(t,e):dme(t,e)}function cme(t,e){b0=1024,t&&!t.SSF&&(t.SSF=gn(Ir)),t&&t.SSF&&(Lp(),bN(t.SSF),e.revssf=NN(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,wx?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",s=v9.indexOf(e.bookType)>-1,n=F_();W_(e=e||{});var i=y_(),o="",l=0;if(e.cellXfs=[],yh(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),o="docProps/core.xml",Yr(i,o,R7(t.Props,e)),n.coreprops.push(o),Ds(e.rels,2,o,ts.CORE_PROPS),o="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var c=[],d=0;d<t.SheetNames.length;++d)(t.Workbook.Sheets[d]||{}).Hidden!=2&&c.push(t.SheetNames[d]);t.Props.SheetNames=c}for(t.Props.Worksheets=t.Props.SheetNames.length,Yr(i,o,U7(t.Props)),n.extprops.push(o),Ds(e.rels,3,o,ts.EXT_PROPS),t.Custprops!==t.Props&&Qn(t.Custprops||{}).length>0&&(o="docProps/custom.xml",Yr(i,o,M7(t.Custprops)),n.custprops.push(o),Ds(e.rels,4,o,ts.CUST_PROPS)),l=1;l<=t.SheetNames.length;++l){var u={"!id":{}},A=t.Sheets[t.SheetNames[l-1]],h=(A||{})["!type"]||"sheet";switch(h){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,Yr(i,o,Uhe(l-1,o,e,t,u)),n.sheets.push(o),Ds(e.wbrels,-1,"worksheets/sheet"+l+"."+r,ts.WS[0])}if(A){var f=A["!comments"],p=!1,m="";f&&f.length>0&&(m="xl/comments"+l+"."+r,Yr(i,m,Vhe(f,m)),n.comments.push(m),Ds(u,-1,"../comments"+l+"."+r,ts.CMNT),p=!0),A["!legacy"]&&p&&Yr(i,"xl/drawings/vmlDrawing"+l+".vml",x9(l,A["!comments"])),delete A["!comments"],delete A["!legacy"]}u["!id"].rId1&&Yr(i,my(o),U0(u))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+r,Yr(i,o,Qhe(e.Strings,o,e)),n.strs.push(o),Ds(e.wbrels,-1,"sharedStrings."+r,ts.SST)),o="xl/workbook."+r,Yr(i,o,Ohe(t,o)),n.workbooks.push(o),Ds(e.rels,1,o,ts.WB),o="xl/theme/theme1.xml",Yr(i,o,U_(t.Themes,e)),n.themes.push(o),Ds(e.wbrels,-1,"theme/theme1.xml",ts.THEME),o="xl/styles."+r,Yr(i,o,Mhe(t,o,e)),n.styles.push(o),Ds(e.wbrels,-1,"styles."+r,ts.STY),t.vbaraw&&s&&(o="xl/vbaProject.bin",Yr(i,o,t.vbaraw),n.vba.push(o),Ds(e.wbrels,-1,"vbaProject.bin",ts.VBA)),o="xl/metadata."+r,Yr(i,o,Hhe(o)),n.metadata.push(o),Ds(e.wbrels,-1,"metadata."+r,ts.XLMETA),Yr(i,"[Content_Types].xml",F7(n,e)),Yr(i,"_rels/.rels",U0(e.rels)),Yr(i,"xl/_rels/workbook."+r+".rels",U0(e.wbrels)),delete e.revssf,delete e.ssf,i}function dme(t,e){b0=1024,t&&!t.SSF&&(t.SSF=gn(Ir)),t&&t.SSF&&(Lp(),bN(t.SSF),e.revssf=NN(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,wx?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",s=v9.indexOf(e.bookType)>-1,n=F_();W_(e=e||{});var i=y_(),o="",l=0;if(e.cellXfs=[],yh(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),o="docProps/core.xml",Yr(i,o,R7(t.Props,e)),n.coreprops.push(o),Ds(e.rels,2,o,ts.CORE_PROPS),o="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var c=[],d=0;d<t.SheetNames.length;++d)(t.Workbook.Sheets[d]||{}).Hidden!=2&&c.push(t.SheetNames[d]);t.Props.SheetNames=c}t.Props.Worksheets=t.Props.SheetNames.length,Yr(i,o,U7(t.Props)),n.extprops.push(o),Ds(e.rels,3,o,ts.EXT_PROPS),t.Custprops!==t.Props&&Qn(t.Custprops||{}).length>0&&(o="docProps/custom.xml",Yr(i,o,M7(t.Custprops)),n.custprops.push(o),Ds(e.rels,4,o,ts.CUST_PROPS));var u=["SheetJ5"];for(e.tcid=0,l=1;l<=t.SheetNames.length;++l){var A={"!id":{}},h=t.Sheets[t.SheetNames[l-1]],f=(h||{})["!type"]||"sheet";switch(f){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,Yr(i,o,k9(l-1,e,t,A)),n.sheets.push(o),Ds(e.wbrels,-1,"worksheets/sheet"+l+"."+r,ts.WS[0])}if(h){var p=h["!comments"],m=!1,g="";if(p&&p.length>0){var y=!1;p.forEach(function(v){v[1].forEach(function(x){x.T==!0&&(y=!0)})}),y&&(g="xl/threadedComments/threadedComment"+l+"."+r,Yr(i,g,gce(p,u,e)),n.threadedcomments.push(g),Ds(A,-1,"../threadedComments/threadedComment"+l+"."+r,ts.TCMNT)),g="xl/comments"+l+"."+r,Yr(i,g,y9(p)),n.comments.push(g),Ds(A,-1,"../comments"+l+"."+r,ts.CMNT),m=!0}h["!legacy"]&&m&&Yr(i,"xl/drawings/vmlDrawing"+l+".vml",x9(l,h["!comments"])),delete h["!comments"],delete h["!legacy"]}A["!id"].rId1&&Yr(i,my(o),U0(A))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+r,Yr(i,o,i9(e.Strings,e)),n.strs.push(o),Ds(e.wbrels,-1,"sharedStrings."+r,ts.SST)),o="xl/workbook."+r,Yr(i,o,R9(t)),n.workbooks.push(o),Ds(e.rels,1,o,ts.WB),o="xl/theme/theme1.xml",Yr(i,o,U_(t.Themes,e)),n.themes.push(o),Ds(e.wbrels,-1,"theme/theme1.xml",ts.THEME),o="xl/styles."+r,Yr(i,o,f9(t,e)),n.styles.push(o),Ds(e.wbrels,-1,"styles."+r,ts.STY),t.vbaraw&&s&&(o="xl/vbaProject.bin",Yr(i,o,t.vbaraw),n.vba.push(o),Ds(e.wbrels,-1,"vbaProject.bin",ts.VBA)),o="xl/metadata."+r,Yr(i,o,g9()),n.metadata.push(o),Ds(e.wbrels,-1,"metadata."+r,ts.XLMETA),u.length>1&&(o="xl/persons/person.xml",Yr(i,o,yce(u)),n.people.push(o),Ds(e.wbrels,-1,"persons/person.xml",ts.PEOPLE)),Yr(i,"[Content_Types].xml",F7(n,e)),Yr(i,"_rels/.rels",U0(e.rels)),Yr(i,"xl/_rels/workbook."+r+".rels",U0(e.wbrels)),delete e.revssf,delete e.ssf,i}function G_(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=Zo(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function ume(t,e){return Cr.find(t,"EncryptedPackage")?ome(t,e):M9(t,e)}function Ame(t,e){var r,s=t,n=e||{};return n.type||(n.type=Zr&&Buffer.isBuffer(t)?"buffer":"base64"),r=l7(s,n),ime(r,n)}function W9(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return eS(t.slice(r),e);default:break e}return bp.to_workbook(t,e)}function hme(t,e){var r="",s=G_(t,e);switch(e.type){case"base64":r=Zo(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=Vf(t);break;default:throw new Error("Unrecognized type "+e.type)}return s[0]==239&&s[1]==187&&s[2]==191&&(r=Ks(r)),e.type="binary",W9(r,e)}function fme(t,e){var r=t;return e.type=="base64"&&(r=Zo(r)),r=Kj.utils.decode(1200,r.slice(2),"str"),e.type="binary",W9(r,e)}function mme(t){return t.match(/[^\x00-\x7F]/)?$c(t):t}function mC(t,e,r,s){return s?(r.type="string",bp.to_workbook(t,r)):bp.to_workbook(e,r)}function sS(t,e){f_();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return sS(new Uint8Array(t),(r=gn(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var s=t,n=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Q0={},r.dateNF&&(Q0.dateNF=r.dateNF),r.type||(r.type=Zr&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=Zr?"buffer":"binary",s=cne(t),typeof Uint8Array<"u"&&!Zr&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,s=mme(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),l=new Uint8Array(o);if(l.foo="bar",!l.foo)return r=gn(r),r.type="array",sS(m_(s),r)}switch((n=G_(s,r))[0]){case 208:if(n[1]===207&&n[2]===17&&n[3]===224&&n[4]===161&&n[5]===177&&n[6]===26&&n[7]===225)return ume(Cr.read(s,r),r);break;case 9:if(n[1]<=8)return M9(s,r);break;case 60:return eS(s,r);case 73:if(n[1]===73&&n[2]===42&&n[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(n[1]===68)return voe(s,r);break;case 84:if(n[1]===65&&n[2]===66&&n[3]===76)return n9.to_workbook(s,r);break;case 80:return n[1]===75&&n[2]<9&&n[3]<9?Ame(s,r):mC(t,s,r,i);case 239:return n[3]===60?eS(s,r):mC(t,s,r,i);case 255:if(n[1]===254)return fme(s,r);if(n[1]===0&&n[2]===2&&n[3]===0)return pf.to_workbook(s,r);break;case 0:if(n[1]===0&&(n[2]>=2&&n[3]===0||n[2]===0&&(n[3]===8||n[3]===9)))return pf.to_workbook(s,r);break;case 3:case 131:case 139:case 140:return Zj.to_workbook(s,r);case 123:if(n[1]===92&&n[2]===114&&n[3]===116)return u9.to_workbook(s,r);break;case 10:case 13:case 32:return hme(s,r);case 137:if(n[1]===80&&n[2]===78&&n[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return yoe.indexOf(n[0])>-1&&n[2]<=12&&n[3]<=31?Zj.to_workbook(s,r):mC(t,s,r,i)}function G9(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return nv(e.file,Cr.write(t,{type:Zr?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return Cr.write(t,e)}function pme(t,e){var r=gn(e||{}),s=lme(t,r);return gme(s,r)}function gme(t,e){var r={},s=Zr?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=s;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=s;break;default:throw new Error("Unrecognized type "+e.type)}var n=t.FullPaths?Cr.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof n=="string"){if(e.type=="binary"||e.type=="base64")return n;n=new Uint8Array(vN(n))}return e.password&&typeof encrypt_agile<"u"?G9(encrypt_agile(n,e.password),e):e.type==="file"?nv(e.file,n):e.type=="string"?Ks(n):n}function xme(t,e){var r=e||{},s=mfe(t,r);return G9(s,r)}function Pc(t,e,r){r||(r="");var s=r+t;switch(e.type){case"base64":return dy($c(s));case"binary":return $c(s);case"string":return t;case"file":return nv(e.file,s,"utf8");case"buffer":return Zr?fu(s,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(s):Pc(s,{type:"binary"}).split("").map(function(n){return n.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function yme(t,e){switch(e.type){case"base64":return dy(t);case"binary":return t;case"string":return t;case"file":return nv(e.file,t,"binary");case"buffer":return Zr?fu(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function C1(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",s=0;s<t.length;++s)r+=String.fromCharCode(t[s]);return e.type=="base64"?dy(r):e.type=="string"?Ks(r):r;case"file":return nv(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function Y9(t,e){f_(),uhe(t);var r=gn(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var s=Y9(t,r);return r.type="array",vN(s)}var n=0;if(r.sheet&&(typeof r.sheet=="number"?n=r.sheet:n=t.SheetNames.indexOf(r.sheet),!t.SheetNames[n]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Pc(lfe(t,r),r);case"slk":case"sylk":return Pc(s9.from_sheet(t.Sheets[t.SheetNames[n]],r),r);case"htm":case"html":return Pc(V9(t.Sheets[t.SheetNames[n]],r),r);case"txt":return yme(X9(t.Sheets[t.SheetNames[n]],r),r);case"csv":return Pc(Y_(t.Sheets[t.SheetNames[n]],r),r,"\uFEFF");case"dif":return Pc(n9.from_sheet(t.Sheets[t.SheetNames[n]],r),r);case"dbf":return C1(Zj.from_sheet(t.Sheets[t.SheetNames[n]],r),r);case"prn":return Pc(bp.from_sheet(t.Sheets[t.SheetNames[n]],r),r);case"rtf":return Pc(u9.from_sheet(t.Sheets[t.SheetNames[n]],r),r);case"eth":return Pc(a9.from_sheet(t.Sheets[t.SheetNames[n]],r),r);case"fods":return Pc(z9(t,r),r);case"wk1":return C1(pf.sheet_to_wk1(t.Sheets[t.SheetNames[n]],r),r);case"wk3":return C1(pf.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),C1(Q9(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),xme(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return pme(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function vme(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(t.bookType=r.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function bme(t,e,r){var s={};return s.type="file",s.file=e,vme(s),Y9(t,s)}function wme(t,e,r,s,n,i,o,l){var c=na(r),d=l.defval,u=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),A=!0,h=n===1?[]:{};if(n!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!o||t[r])for(var f=e.s.c;f<=e.e.c;++f){var p=o?t[r][f]:t[s[f]+c];if(p===void 0||p.t===void 0){if(d===void 0)continue;i[f]!=null&&(h[i[f]]=d);continue}var m=p.v;switch(p.t){case"z":if(m==null)break;continue;case"e":m=m==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+p.t)}if(i[f]!=null){if(m==null)if(p.t=="e"&&m===null)h[i[f]]=null;else if(d!==void 0)h[i[f]]=d;else if(u&&m===null)h[i[f]]=null;else continue;else h[i[f]]=u&&(p.t!=="n"||p.t==="n"&&l.rawNumbers!==!1)?m:iu(p,m,l);m!=null&&(A=!1)}}return{row:h,isempty:A}}function o2(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},s=0,n=1,i=[],o=0,l="",c={s:{r:0,c:0},e:{r:0,c:0}},d=e||{},u=d.range!=null?d.range:t["!ref"];switch(d.header===1?s=1:d.header==="A"?s=2:Array.isArray(d.header)?s=3:d.header==null&&(s=0),typeof u){case"string":c=bs(u);break;case"number":c=bs(t["!ref"]),c.s.r=u;break;default:c=u}s>0&&(n=0);var A=na(c.s.r),h=[],f=[],p=0,m=0,g=Array.isArray(t),y=c.s.r,v=0,x={};g&&!t[y]&&(t[y]=[]);var E=d.skipHidden&&t["!cols"]||[],T=d.skipHidden&&t["!rows"]||[];for(v=c.s.c;v<=c.e.c;++v)if(!(E[v]||{}).hidden)switch(h[v]=Sn(v),r=g?t[y][v]:t[h[v]+A],s){case 1:i[v]=v-c.s.c;break;case 2:i[v]=h[v];break;case 3:i[v]=d.header[v-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=o=iu(r,null,d),m=x[o]||0,!m)x[o]=1;else{do l=o+"_"+m++;while(x[l]);x[o]=m,x[l]=1}i[v]=l}for(y=c.s.r+n;y<=c.e.r;++y)if(!(T[y]||{}).hidden){var j=wme(t,c,y,h,s,i,g,d);(j.isempty===!1||(s===1?d.blankrows!==!1:d.blankrows))&&(f[p++]=j.row)}return f.length=p,f}var DF=/"/g;function Nme(t,e,r,s,n,i,o,l){for(var c=!0,d=[],u="",A=na(r),h=e.s.c;h<=e.e.c;++h)if(s[h]){var f=l.dense?(t[r]||[])[h]:t[s[h]+A];if(f==null)u="";else if(f.v!=null){c=!1,u=""+(l.rawNumbers&&f.t=="n"?f.v:iu(f,null,l));for(var p=0,m=0;p!==u.length;++p)if((m=u.charCodeAt(p))===n||m===i||m===34||l.forceQuotes){u='"'+u.replace(DF,'""')+'"';break}u=="ID"&&(u='"ID"')}else f.f!=null&&!f.F?(c=!1,u="="+f.f,u.indexOf(",")>=0&&(u='"'+u.replace(DF,'""')+'"')):u="";d.push(u)}return l.blankrows===!1&&c?null:d.join(o)}function Y_(t,e){var r=[],s=e??{};if(t==null||t["!ref"]==null)return"";var n=bs(t["!ref"]),i=s.FS!==void 0?s.FS:",",o=i.charCodeAt(0),l=s.RS!==void 0?s.RS:`
`,c=l.charCodeAt(0),d=new RegExp((i=="|"?"\\|":i)+"+$"),u="",A=[];s.dense=Array.isArray(t);for(var h=s.skipHidden&&t["!cols"]||[],f=s.skipHidden&&t["!rows"]||[],p=n.s.c;p<=n.e.c;++p)(h[p]||{}).hidden||(A[p]=Sn(p));for(var m=0,g=n.s.r;g<=n.e.r;++g)(f[g]||{}).hidden||(u=Nme(t,n,g,A,o,c,i,s),u!=null&&(s.strip&&(u=u.replace(d,"")),(u||s.blankrows!==!1)&&r.push((m++?l:"")+u)));return delete s.dense,r.join("")}function X9(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=Y_(t,e);return r}function Cme(t){var e="",r,s="";if(t==null||t["!ref"]==null)return[];var n=bs(t["!ref"]),i="",o=[],l,c=[],d=Array.isArray(t);for(l=n.s.c;l<=n.e.c;++l)o[l]=Sn(l);for(var u=n.s.r;u<=n.e.r;++u)for(i=na(u),l=n.s.c;l<=n.e.c;++l)if(e=o[l]+i,r=d?(t[u]||[])[l]:t[e],s="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;s=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)s=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)s=""+r.v;else if(r.t=="b")s=r.v?"TRUE":"FALSE";else if(r.w!==void 0)s="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?s="'"+r.v:s=""+r.v}}c[c.length]=e+"="+s}return c}function J9(t,e,r){var s=r||{},n=+!s.skipHeader,i=t||{},o=0,l=0;if(i&&s.origin!=null)if(typeof s.origin=="number")o=s.origin;else{var c=typeof s.origin=="string"?En(s.origin):s.origin;o=c.r,l=c.c}var d,u={s:{c:0,r:0},e:{c:l,r:o+e.length-1+n}};if(i["!ref"]){var A=bs(i["!ref"]);u.e.c=Math.max(u.e.c,A.e.c),u.e.r=Math.max(u.e.r,A.e.r),o==-1&&(o=A.e.r+1,u.e.r=o+e.length-1+n)}else o==-1&&(o=0,u.e.r=e.length-1+n);var h=s.header||[],f=0;e.forEach(function(m,g){Qn(m).forEach(function(y){(f=h.indexOf(y))==-1&&(h[f=h.length]=y);var v=m[y],x="z",E="",T=Fr({c:l+f,r:o+g+n});d=wy(i,T),v&&typeof v=="object"&&!(v instanceof Date)?i[T]=v:(typeof v=="number"?x="n":typeof v=="boolean"?x="b":typeof v=="string"?x="s":v instanceof Date?(x="d",s.cellDates||(x="n",v=_a(v)),E=s.dateNF||Ir[14]):v===null&&s.nullError&&(x="e",v=0),d?(d.t=x,d.v=v,delete d.w,delete d.R,E&&(d.z=E)):i[T]=d={t:x,v},E&&(d.z=E))})}),u.e.c=Math.max(u.e.c,l+h.length-1);var p=na(o);if(n)for(f=0;f<h.length;++f)i[Sn(f+l)+p]={t:"s",v:h[f]};return i["!ref"]=Gr(u),i}function jme(t,e){return J9(null,t,e)}function wy(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var s=En(e);return t[s.r]||(t[s.r]=[]),t[s.r][s.c]||(t[s.r][s.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?wy(t,Fr(e)):wy(t,Fr({r:e,c:r||0}))}function Sme(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function X_(){return{SheetNames:[],Sheets:{}}}function J_(t,e,r,s){var n=1;if(!r)for(;n<=65535&&t.SheetNames.indexOf(r="Sheet"+n)!=-1;++n,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(s&&t.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);n=i&&+i[2]||0;var o=i&&i[1]||r;for(++n;n<=65535&&t.SheetNames.indexOf(r=o+n)!=-1;++n);}if(D9(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function Eme(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var s=Sme(t,e);switch(t.Workbook.Sheets[s]||(t.Workbook.Sheets[s]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[s].Hidden=r}function _me(t,e){return t.z=e,t}function Z9(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function Tme(t,e,r){return Z9(t,"#"+e,r)}function Ime(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function kme(t,e,r,s){for(var n=typeof e!="string"?e:bs(e),i=typeof e=="string"?e:Gr(e),o=n.s.r;o<=n.e.r;++o)for(var l=n.s.c;l<=n.e.c;++l){var c=wy(t,o,l);c.t="n",c.F=i,delete c.v,o==n.s.r&&l==n.s.c&&(c.f=r,s&&(c.D=!0))}return t}var j1={encode_col:Sn,encode_row:na,encode_cell:Fr,encode_range:Gr,decode_col:E_,decode_row:S_,split_cell:Qne,decode_cell:En,decode_range:So,format_cell:iu,sheet_add_aoa:S7,sheet_add_json:J9,sheet_add_dom:H9,aoa_to_sheet:Op,json_to_sheet:jme,table_to_sheet:$9,table_to_book:Lfe,sheet_to_csv:Y_,sheet_to_txt:X9,sheet_to_json:o2,sheet_to_html:V9,sheet_to_formulae:Cme,sheet_to_row_object_array:o2,sheet_get_cell:wy,book_new:X_,book_append_sheet:J_,book_set_sheet_visibility:Eme,cell_set_number_format:_me,cell_set_hyperlink:Z9,cell_set_internal_link:Tme,cell_add_comment:Ime,sheet_set_array_formula:kme,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const RF=[{name:"Margherita Pizza",description:"Classic pizza with fresh mozzarella, tomatoes, and basil",category:"Main Course",price:299,image:"",isAvailable:!0,preparationTime:20,allergens:"Gluten, Dairy",spiceLevel:"none",isVegetarian:!0,isVegan:!1,isGlutenFree:!1,tags:"Pizza, Italian, Popular",variantName1:"Size",variantOptions1:"Small:249:standalone,Medium:299:standalone,Large:349:standalone",variantName2:"Crust",variantOptions2:"Thin:0:additive,Thick:25:additive,Stuffed:50:additive",variantName3:"",variantOptions3:""},{name:"Chicken Biryani",description:"Aromatic basmati rice with tender chicken and spices",category:"Main Course",price:249,image:"",isAvailable:!0,preparationTime:30,allergens:"",spiceLevel:"medium",isVegetarian:!1,isVegan:!1,isGlutenFree:!0,tags:"Biryani, Chicken, Spicy",variantName1:"Portion",variantOptions1:"Half:199:standalone,Full:249:standalone,Jumbo:299:standalone",variantName2:"",variantOptions2:"",variantName3:"",variantOptions3:""},{name:"Caesar Salad",description:"Fresh romaine lettuce with Caesar dressing and croutons",category:"Appetizers",price:149,image:"",isAvailable:!0,preparationTime:10,allergens:"Dairy",spiceLevel:"none",isVegetarian:!0,isVegan:!1,isGlutenFree:!1,tags:"Salad, Healthy, Light",variantName1:"",variantOptions1:"",variantName2:"",variantOptions2:"",variantName3:"",variantOptions3:""}];function Bme({isOpen:t,onClose:e,onSuccess:r,restaurantId:s,categories:n}){const[i,o]=R.useState(!1),[l,c]=R.useState([]),[d,u]=R.useState(null),[A,h]=R.useState("upload"),[f,p]=R.useState(!1),m=R.useRef(null);if(!t)return null;const g=te=>{var Q,re;const W=(Q=te.target.files)==null?void 0:Q[0];if(W){const G=(re=W.name.split(".").pop())==null?void 0:re.toLowerCase();if(!["csv","xlsx","xls"].includes(G||"")){Z.error("Please select a CSV or Excel file");return}E(W)}},y=te=>{te.preventDefault(),te.stopPropagation(),p(!0)},v=te=>{te.preventDefault(),te.stopPropagation(),p(!1)},x=te=>{var Q;te.preventDefault(),te.stopPropagation(),p(!1);const W=te.dataTransfer.files;if(W.length>0){const re=W[0],G=(Q=re.name.split(".").pop())==null?void 0:Q.toLowerCase();if(!["csv","xlsx","xls"].includes(G||"")){Z.error("Please drop a CSV or Excel file");return}E(re)}},E=async te=>{var W;o(!0);try{const Q=(W=te.name.split(".").pop())==null?void 0:W.toLowerCase();let re=[];Q==="csv"?re=await T(te):(Q==="xlsx"||Q==="xls")&&(re=await C(te)),c(re),h("preview")}catch(Q){Z.error("Failed to process file. Please check the format."),console.error("File processing error:",Q)}finally{o(!1)}},T=async te=>new Promise((W,Q)=>{const re=new FileReader;re.onload=G=>{var Ae;try{const I=((Ae=G.target)==null?void 0:Ae.result).split(`
`),U=I[0].split(",").map(L=>L.trim().replace(/"/g,"")),V=[];for(let L=1;L<I.length;L++)if(I[L].trim()){const K=j(I[L]),fe={};U.forEach((ee,de)=>{fe[ee]=K[de]||""}),V.push(fe)}W(V)}catch(he){Q(he)}},re.readAsText(te)}),j=te=>{const W=[];let Q="",re=!1;for(let G=0;G<te.length;G++){const Ae=te[G];Ae==='"'?re=!re:Ae===","&&!re?(W.push(Q.trim()),Q=""):Q+=Ae}return W.push(Q.trim()),W},C=async te=>new Promise((W,Q)=>{const re=new FileReader;re.onload=G=>{var Ae;try{const he=new Uint8Array((Ae=G.target)==null?void 0:Ae.result),I=sS(he,{type:"array"}),U=I.SheetNames[0],V=I.Sheets[U],L=j1.sheet_to_json(V,{header:1}),K=L[0],fe=[];for(let ee=1;ee<L.length;ee++){const de=L[ee];if(de&&de.some(ue=>ue!==void 0&&ue!=="")){const ue={};K.forEach((Ie,Y)=>{ue[Ie]=de[Y]||""}),fe.push(ue)}}W(fe)}catch(he){Q(he)}},re.readAsArrayBuffer(te)}),w=te=>{const W=[],Q=[];return te.forEach((re,G)=>{var I,U;const Ae=G+2;if(!((I=re.name)!=null&&I.trim())){Q.push(`Row ${Ae}: Name is required`);return}if(!((U=re.category)!=null&&U.trim())){Q.push(`Row ${Ae}: Category is required`);return}if(!re.price||isNaN(Number(re.price))||Number(re.price)<=0){Q.push(`Row ${Ae}: Valid price is required`);return}if(!n.some(V=>V.name.toLowerCase()===re.category.toLowerCase())){Q.push(`Row ${Ae}: Category "${re.category}" does not exist`);return}W.push(re)}),{valid:W,errors:Q}},S=te=>te.map(W=>{var G,Ae;const Q=[];for(let he=1;he<=3;he++){const I=`variantName${he}`,U=`variantOptions${he}`,V=(G=W[I])==null?void 0:G.toString().trim(),L=(Ae=W[U])==null?void 0:Ae.toString().trim();if(V&&L){const K=L.split(",").map(fe=>{var H,je,Ce,oe;const ee=fe.split(":"),de=(H=ee[0])==null?void 0:H.trim(),ue=(je=ee[1])==null?void 0:je.trim(),Ie=(oe=(Ce=ee[2])==null?void 0:Ce.trim())==null?void 0:oe.toLowerCase();let Y="additive";return Ie==="standalone"||Ie==="s"?Y="standalone":(Ie==="additive"||Ie==="a")&&(Y="additive"),{id:`${V}-${de}`.toLowerCase().replace(/\s+/g,"-"),name:de,priceModifier:Number(ue)||0,pricingType:Y}}).filter(fe=>fe.name);K.length>0&&Q.push({id:V.toLowerCase().replace(/\s+/g,"-"),name:V,type:"single",required:!0,options:K})}}const re=n.find(he=>he.name.toLowerCase()===W.category.toLowerCase());return{id:"",restaurantId:s,name:W.name,description:W.description||"",category:W.category,categoryId:(re==null?void 0:re.id)||"",categoryName:(re==null?void 0:re.name)||W.category,price:Number(W.price),image:W.image||"",isAvailable:W.isAvailable!==!1&&String(W.isAvailable)!=="false",preparationTime:Number(W.preparationTime)||0,allergens:W.allergens?W.allergens.split(",").map(he=>he.trim()):[],spiceLevel:W.spiceLevel||"none",isVegetarian:W.isVegetarian===!0||String(W.isVegetarian)==="true",isVegan:W.isVegan===!0||String(W.isVegan)==="true",isGlutenFree:W.isGlutenFree===!0||String(W.isGlutenFree)==="true",tags:W.tags?W.tags.split(",").map(he=>he.trim()):[],variants:Q.length>0?Q:[],createdAt:new Date,updatedAt:new Date}}),F=async()=>{o(!0);try{const{valid:te,errors:W}=w(l);if(W.length>0){u({success:!1,errors:W}),h("result");return}const Q=S(te),re=[],G=[];for(const Ae of Q)try{const he=await Ts.createMenuItem(Ae);he.success&&he.data?re.push(he.data):G.push(`Failed to create "${Ae.name}": ${he.error}`)}catch(he){G.push(`Failed to create "${Ae.name}": ${he}`)}u({success:G.length===0,data:re,errors:G,warnings:[]}),h("result"),G.length===0?(Z.success(`Successfully imported ${re.length} menu items!`),r()):re.length>0?Z.success(`Imported ${re.length} items with ${G.length} errors`):Z.error("Import failed. Please check the errors.")}catch{u({success:!1,errors:["Import failed due to an unexpected error"]}),h("result"),Z.error("Import failed")}finally{o(!1)}},B=te=>{te==="csv"?k():D()},k=()=>{const te=["name","description","category","price","image","isAvailable","preparationTime","allergens","spiceLevel","isVegetarian","isVegan","isGlutenFree","tags","variantName1","variantOptions1","variantName2","variantOptions2","variantName3","variantOptions3"],W=[te.join(","),...RF.map(Ae=>te.map(he=>{const I=Ae[he]||"";return typeof I=="string"&&I.includes(",")?`"${I}"`:I}).join(","))].join(`
`),Q=new Blob([W],{type:"text/csv"}),re=URL.createObjectURL(Q),G=document.createElement("a");G.href=re,G.download="menu_import_sample.csv",G.click(),URL.revokeObjectURL(re)},D=()=>{const te=j1.json_to_sheet(RF),W=j1.book_new();j1.book_append_sheet(W,te,"Menu Items"),bme(W,"menu_import_sample.xlsx")},q=()=>{c([]),u(null),h("upload"),m.current&&(m.current.value="")};return a.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:a.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[a.jsx("div",{className:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75",onClick:e}),a.jsxs("div",{className:"inline-block w-full max-w-4xl my-8 overflow-hidden text-left align-middle transition-all transform bg-white shadow-xl rounded-2xl",children:[a.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Bulk Menu Import"}),a.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600",children:a.jsx(qr,{className:"w-6 h-6"})})]}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Import multiple menu items from CSV or Excel files"})]}),a.jsxs("div",{className:"p-6",children:[A==="upload"&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[a.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:" Download Sample File"}),a.jsx("p",{className:"text-sm text-blue-700 mb-3",children:"Download a sample file to see the required format and columns"}),a.jsxs("div",{className:"flex space-x-3",children:[a.jsxs("button",{onClick:()=>B("csv"),className:"btn btn-sm bg-blue-600 text-white hover:bg-blue-700",children:[a.jsx(Yn,{className:"w-4 h-4 mr-2"}),"Sample CSV"]}),a.jsxs("button",{onClick:()=>B("excel"),className:"btn btn-sm bg-green-600 text-white hover:bg-green-700",children:[a.jsx(Yn,{className:"w-4 h-4 mr-2"}),"Sample Excel"]})]})]}),a.jsxs("div",{className:`border-2 border-dashed rounded-lg p-8 text-center transition-colors ${f?"border-blue-400 bg-blue-50":"border-gray-300 hover:border-gray-400"}`,onDragOver:y,onDragLeave:v,onDrop:x,children:[a.jsx(Oj,{className:`w-12 h-12 mx-auto mb-4 ${f?"text-blue-500":"text-gray-400"}`}),a.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"Upload Your Menu File"}),a.jsx("p",{className:"text-gray-600 mb-4",children:f?"Drop your CSV or Excel file here":"Drag and drop a CSV or Excel file here, or click to select"}),a.jsx("input",{ref:m,type:"file",accept:".csv,.xlsx,.xls",onChange:g,className:"hidden"}),a.jsx("button",{onClick:()=>{var te;return(te=m.current)==null?void 0:te.click()},disabled:i,className:"btn btn-theme-primary",children:i?a.jsxs(a.Fragment,{children:[a.jsx(qh,{className:"w-4 h-4 mr-2 animate-spin"}),"Processing..."]}):a.jsxs(a.Fragment,{children:[a.jsx(Rl,{className:"w-4 h-4 mr-2"}),"Choose File"]})})]}),a.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[a.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:" File Format Guidelines"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-gray-700",children:[a.jsxs("div",{children:[a.jsx("h5",{className:"font-medium mb-2",children:"Required Columns:"}),a.jsxs("ul",{className:"space-y-1",children:[a.jsxs("li",{children:[" ",a.jsx("strong",{children:"name"})," - Item name"]}),a.jsxs("li",{children:[" ",a.jsx("strong",{children:"category"})," - Menu category"]}),a.jsxs("li",{children:[" ",a.jsx("strong",{children:"price"})," - Base price (number)"]})]})]}),a.jsxs("div",{children:[a.jsx("h5",{className:"font-medium mb-2",children:"Optional Columns:"}),a.jsxs("ul",{className:"space-y-1",children:[a.jsxs("li",{children:[" ",a.jsx("strong",{children:"description"})," - Item description"]}),a.jsxs("li",{children:[" ",a.jsx("strong",{children:"image"})," - Image URL"]}),a.jsxs("li",{children:[" ",a.jsx("strong",{children:"isAvailable"})," - true/false"]}),a.jsxs("li",{children:[" ",a.jsx("strong",{children:"preparationTime"})," - Minutes"]}),a.jsxs("li",{children:[" ",a.jsx("strong",{children:"allergens"})," - Comma separated"]}),a.jsxs("li",{children:[" ",a.jsx("strong",{children:"spiceLevel"})," - none/mild/medium/hot/very_hot"]}),a.jsxs("li",{children:[" ",a.jsx("strong",{children:"isVegetarian/isVegan/isGlutenFree"})," - true/false"]}),a.jsxs("li",{children:[" ",a.jsx("strong",{children:"tags"})," - Comma separated"]})]})]})]}),a.jsxs("div",{className:"mt-4 pt-3 border-t border-gray-200",children:[a.jsx("h5",{className:"font-medium mb-2",children:"Variant Columns (Optional):"}),a.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Add up to 3 variants per item using these column pairs:"}),a.jsxs("ul",{className:"text-sm text-gray-700 space-y-1",children:[a.jsxs("li",{children:[" ",a.jsx("strong",{children:"variantName1, variantOptions1"}),' - e.g., "Size", "Small:249:standalone,Medium:299:standalone,Large:349:standalone"']}),a.jsxs("li",{children:[" ",a.jsx("strong",{children:"variantName2, variantOptions2"}),' - e.g., "Crust", "Thin:0:additive,Thick:25:additive"']}),a.jsxs("li",{children:[" ",a.jsx("strong",{children:"variantName3, variantOptions3"})," - Additional variant if needed"]})]}),a.jsx("p",{className:"text-xs text-gray-500 mt-2",children:'Format: "OptionName:Price:PricingType" where PricingType is "additive" (adds to base price) or "standalone" (replaces base price). You can use "s" for standalone and "a" for additive as shortcuts.'})]})]})]}),A==="preview"&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h4",{className:"text-lg font-medium text-gray-900",children:"Preview Import Data"}),a.jsxs("div",{className:"text-sm text-gray-600",children:[l.length," items found"]})]}),a.jsx("div",{className:"max-h-96 overflow-y-auto border border-gray-200 rounded-lg",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-50 sticky top-0",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-900",children:"Name"}),a.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-900",children:"Category"}),a.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-900",children:"Price"}),a.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-900",children:"Available"}),a.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-900",children:"Variants"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:l.slice(0,100).map((te,W)=>a.jsxs("tr",{className:W%2===0?"bg-white":"bg-gray-50",children:[a.jsx("td",{className:"px-4 py-2 font-medium",children:te.name}),a.jsx("td",{className:"px-4 py-2",children:te.category}),a.jsx("td",{className:"px-4 py-2",children:Ue(Number(te.price)||0)}),a.jsx("td",{className:"px-4 py-2",children:a.jsx("span",{className:`inline-flex px-2 py-1 text-xs rounded-full ${te.isAvailable!==!1&&String(te.isAvailable)!=="false"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:te.isAvailable!==!1&&String(te.isAvailable)!=="false"?"Yes":"No"})}),a.jsx("td",{className:"px-4 py-2",children:[1,2,3].map(Q=>{const re=te[`variantName${Q}`];return re?a.jsx("div",{className:"text-xs text-gray-600",children:re},Q):null})})]},W))})]})}),l.length>100&&a.jsxs("p",{className:"text-sm text-gray-600 text-center",children:["Showing first 100 items. Total: ",l.length," items"]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("button",{onClick:q,className:"btn btn-secondary",children:"Back"}),a.jsx("button",{onClick:F,disabled:i||l.length===0,className:"btn btn-theme-primary",children:i?a.jsxs(a.Fragment,{children:[a.jsx(qh,{className:"w-4 h-4 mr-2 animate-spin"}),"Importing..."]}):a.jsxs(a.Fragment,{children:[a.jsx(Oj,{className:"w-4 h-4 mr-2"}),"Import ",l.length," Items"]})})]})]}),A==="result"&&d&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"text-center",children:[d.success?a.jsx(Nr,{className:"w-16 h-16 text-green-500 mx-auto mb-4"}):a.jsx(oi,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),a.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:d.success?"Import Successful!":"Import Completed with Issues"}),d.data&&a.jsxs("p",{className:"text-gray-600",children:["Successfully imported ",d.data.length," menu items"]})]}),d.errors&&d.errors.length>0&&a.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[a.jsx("h5",{className:"font-medium text-red-900 mb-2",children:"Errors:"}),a.jsx("ul",{className:"text-sm text-red-700 space-y-1",children:d.errors.slice(0,10).map((te,W)=>a.jsxs("li",{children:[" ",te]},W))}),d.errors.length>10&&a.jsxs("p",{className:"text-sm text-red-600 mt-2",children:["...and ",d.errors.length-10," more errors"]})]}),d.warnings&&d.warnings.length>0&&a.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[a.jsx("h5",{className:"font-medium text-yellow-900 mb-2",children:"Warnings:"}),a.jsx("ul",{className:"text-sm text-yellow-700 space-y-1",children:d.warnings.map((te,W)=>a.jsxs("li",{children:[" ",te]},W))})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("button",{onClick:q,className:"btn btn-secondary",children:"Import More"}),a.jsx("button",{onClick:e,className:"btn btn-theme-primary",children:"Done"})]})]})]})]})]})})}var eQ={exports:{}};/* @license
Papa Parse
v5.5.3
https://github.com/mholt/PapaParse
License: MIT
*/(function(t,e){((r,s)=>{t.exports=s()})(QH,function r(){var s=typeof self<"u"?self:typeof window<"u"?window:s!==void 0?s:{},n,i=!s.document&&!!s.postMessage,o=s.IS_PAPA_WORKER||!1,l={},c=0,d={};function u(w){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(S){var F=T(S);F.chunkSize=parseInt(F.chunkSize),S.step||S.chunk||(F.chunkSize=null),this._handle=new m(F),(this._handle.streamer=this)._config=F}).call(this,w),this.parseChunk=function(S,F){var B=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<B){let D=this._config.newline;D||(k=this._config.quoteChar||'"',D=this._handle.guessLineEndings(S,k)),S=[...S.split(D).slice(B)].join(D)}this.isFirstChunk&&C(this._config.beforeFirstChunk)&&(k=this._config.beforeFirstChunk(S))!==void 0&&(S=k),this.isFirstChunk=!1,this._halted=!1;var B=this._partialLine+S,k=(this._partialLine="",this._handle.parse(B,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(S=k.meta.cursor,B=(this._finished||(this._partialLine=B.substring(S-this._baseIndex),this._baseIndex=S),k&&k.data&&(this._rowCount+=k.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),o)s.postMessage({results:k,workerId:d.WORKER_ID,finished:B});else if(C(this._config.chunk)&&!F){if(this._config.chunk(k,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=k=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(k.data),this._completeResults.errors=this._completeResults.errors.concat(k.errors),this._completeResults.meta=k.meta),this._completed||!B||!C(this._config.complete)||k&&k.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),B||k&&k.meta.paused||this._nextChunk(),k}this._halted=!0},this._sendError=function(S){C(this._config.error)?this._config.error(S):o&&this._config.error&&s.postMessage({workerId:d.WORKER_ID,error:S,finished:!1})}}function A(w){var S;(w=w||{}).chunkSize||(w.chunkSize=d.RemoteChunkSize),u.call(this,w),this._nextChunk=i?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(F){this._input=F,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(S=new XMLHttpRequest,this._config.withCredentials&&(S.withCredentials=this._config.withCredentials),i||(S.onload=j(this._chunkLoaded,this),S.onerror=j(this._chunkError,this)),S.open(this._config.downloadRequestBody?"POST":"GET",this._input,!i),this._config.downloadRequestHeaders){var F,B=this._config.downloadRequestHeaders;for(F in B)S.setRequestHeader(F,B[F])}var k;this._config.chunkSize&&(k=this._start+this._config.chunkSize-1,S.setRequestHeader("Range","bytes="+this._start+"-"+k));try{S.send(this._config.downloadRequestBody)}catch(D){this._chunkError(D.message)}i&&S.status===0&&this._chunkError()}},this._chunkLoaded=function(){S.readyState===4&&(S.status<200||400<=S.status?this._chunkError():(this._start+=this._config.chunkSize||S.responseText.length,this._finished=!this._config.chunkSize||this._start>=(F=>(F=F.getResponseHeader("Content-Range"))!==null?parseInt(F.substring(F.lastIndexOf("/")+1)):-1)(S),this.parseChunk(S.responseText)))},this._chunkError=function(F){F=S.statusText||F,this._sendError(new Error(F))}}function h(w){(w=w||{}).chunkSize||(w.chunkSize=d.LocalChunkSize),u.call(this,w);var S,F,B=typeof FileReader<"u";this.stream=function(k){this._input=k,F=k.slice||k.webkitSlice||k.mozSlice,B?((S=new FileReader).onload=j(this._chunkLoaded,this),S.onerror=j(this._chunkError,this)):S=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var k=this._input,D=(this._config.chunkSize&&(D=Math.min(this._start+this._config.chunkSize,this._input.size),k=F.call(k,this._start,D)),S.readAsText(k,this._config.encoding));B||this._chunkLoaded({target:{result:D}})},this._chunkLoaded=function(k){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(k.target.result)},this._chunkError=function(){this._sendError(S.error)}}function f(w){var S;u.call(this,w=w||{}),this.stream=function(F){return S=F,this._nextChunk()},this._nextChunk=function(){var F,B;if(!this._finished)return F=this._config.chunkSize,S=F?(B=S.substring(0,F),S.substring(F)):(B=S,""),this._finished=!S,this.parseChunk(B)}}function p(w){u.call(this,w=w||{});var S=[],F=!0,B=!1;this.pause=function(){u.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){u.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(k){this._input=k,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){B&&S.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),S.length?this.parseChunk(S.shift()):F=!0},this._streamData=j(function(k){try{S.push(typeof k=="string"?k:k.toString(this._config.encoding)),F&&(F=!1,this._checkIsFinished(),this.parseChunk(S.shift()))}catch(D){this._streamError(D)}},this),this._streamError=j(function(k){this._streamCleanUp(),this._sendError(k)},this),this._streamEnd=j(function(){this._streamCleanUp(),B=!0,this._streamData("")},this),this._streamCleanUp=j(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function m(w){var S,F,B,k,D=Math.pow(2,53),q=-D,te=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,W=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,Q=this,re=0,G=0,Ae=!1,he=!1,I=[],U={data:[],errors:[],meta:{}};function V(ee){return w.skipEmptyLines==="greedy"?ee.join("").trim()==="":ee.length===1&&ee[0].length===0}function L(){if(U&&B&&(fe("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+d.DefaultDelimiter+"'"),B=!1),w.skipEmptyLines&&(U.data=U.data.filter(function(Ie){return!V(Ie)})),K()){let Ie=function(Y,H){C(w.transformHeader)&&(Y=w.transformHeader(Y,H)),I.push(Y)};if(U)if(Array.isArray(U.data[0])){for(var ee=0;K()&&ee<U.data.length;ee++)U.data[ee].forEach(Ie);U.data.splice(0,1)}else U.data.forEach(Ie)}function de(Ie,Y){for(var H=w.header?{}:[],je=0;je<Ie.length;je++){var Ce=je,oe=Ie[je],oe=((He,ie)=>(le=>(w.dynamicTypingFunction&&w.dynamicTyping[le]===void 0&&(w.dynamicTyping[le]=w.dynamicTypingFunction(le)),(w.dynamicTyping[le]||w.dynamicTyping)===!0))(He)?ie==="true"||ie==="TRUE"||ie!=="false"&&ie!=="FALSE"&&((le=>{if(te.test(le)&&(le=parseFloat(le),q<le&&le<D))return 1})(ie)?parseFloat(ie):W.test(ie)?new Date(ie):ie===""?null:ie):ie)(Ce=w.header?je>=I.length?"__parsed_extra":I[je]:Ce,oe=w.transform?w.transform(oe,Ce):oe);Ce==="__parsed_extra"?(H[Ce]=H[Ce]||[],H[Ce].push(oe)):H[Ce]=oe}return w.header&&(je>I.length?fe("FieldMismatch","TooManyFields","Too many fields: expected "+I.length+" fields but parsed "+je,G+Y):je<I.length&&fe("FieldMismatch","TooFewFields","Too few fields: expected "+I.length+" fields but parsed "+je,G+Y)),H}var ue;U&&(w.header||w.dynamicTyping||w.transform)&&(ue=1,!U.data.length||Array.isArray(U.data[0])?(U.data=U.data.map(de),ue=U.data.length):U.data=de(U.data,0),w.header&&U.meta&&(U.meta.fields=I),G+=ue)}function K(){return w.header&&I.length===0}function fe(ee,de,ue,Ie){ee={type:ee,code:de,message:ue},Ie!==void 0&&(ee.row=Ie),U.errors.push(ee)}C(w.step)&&(k=w.step,w.step=function(ee){U=ee,K()?L():(L(),U.data.length!==0&&(re+=ee.data.length,w.preview&&re>w.preview?F.abort():(U.data=U.data[0],k(U,Q))))}),this.parse=function(ee,de,ue){var Ie=w.quoteChar||'"',Ie=(w.newline||(w.newline=this.guessLineEndings(ee,Ie)),B=!1,w.delimiter?C(w.delimiter)&&(w.delimiter=w.delimiter(ee),U.meta.delimiter=w.delimiter):((Ie=((Y,H,je,Ce,oe)=>{var He,ie,le,ae;oe=oe||[",","	","|",";",d.RECORD_SEP,d.UNIT_SEP];for(var ve=0;ve<oe.length;ve++){for(var we,De=oe[ve],Ve=0,me=0,Fe=0,Re=(le=void 0,new y({comments:Ce,delimiter:De,newline:H,preview:10}).parse(Y)),Be=0;Be<Re.data.length;Be++)je&&V(Re.data[Be])?Fe++:(we=Re.data[Be].length,me+=we,le===void 0?le=we:0<we&&(Ve+=Math.abs(we-le),le=we));0<Re.data.length&&(me/=Re.data.length-Fe),(ie===void 0||Ve<=ie)&&(ae===void 0||ae<me)&&1.99<me&&(ie=Ve,He=De,ae=me)}return{successful:!!(w.delimiter=He),bestDelimiter:He}})(ee,w.newline,w.skipEmptyLines,w.comments,w.delimitersToGuess)).successful?w.delimiter=Ie.bestDelimiter:(B=!0,w.delimiter=d.DefaultDelimiter),U.meta.delimiter=w.delimiter),T(w));return w.preview&&w.header&&Ie.preview++,S=ee,F=new y(Ie),U=F.parse(S,de,ue),L(),Ae?{meta:{paused:!0}}:U||{meta:{paused:!1}}},this.paused=function(){return Ae},this.pause=function(){Ae=!0,F.abort(),S=C(w.chunk)?"":S.substring(F.getCharIndex())},this.resume=function(){Q.streamer._halted?(Ae=!1,Q.streamer.parseChunk(S,!0)):setTimeout(Q.resume,3)},this.aborted=function(){return he},this.abort=function(){he=!0,F.abort(),U.meta.aborted=!0,C(w.complete)&&w.complete(U),S=""},this.guessLineEndings=function(Y,Ie){Y=Y.substring(0,1048576);var Ie=new RegExp(g(Ie)+"([^]*?)"+g(Ie),"gm"),ue=(Y=Y.replace(Ie,"")).split("\r"),Ie=Y.split(`
`),Y=1<Ie.length&&Ie[0].length<ue[0].length;if(ue.length===1||Y)return`
`;for(var H=0,je=0;je<ue.length;je++)ue[je][0]===`
`&&H++;return H>=ue.length/2?`\r
`:"\r"}}function g(w){return w.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function y(w){var S=(w=w||{}).delimiter,F=w.newline,B=w.comments,k=w.step,D=w.preview,q=w.fastMode,te=null,W=!1,Q=w.quoteChar==null?'"':w.quoteChar,re=Q;if(w.escapeChar!==void 0&&(re=w.escapeChar),(typeof S!="string"||-1<d.BAD_DELIMITERS.indexOf(S))&&(S=","),B===S)throw new Error("Comment character same as delimiter");B===!0?B="#":(typeof B!="string"||-1<d.BAD_DELIMITERS.indexOf(B))&&(B=!1),F!==`
`&&F!=="\r"&&F!==`\r
`&&(F=`
`);var G=0,Ae=!1;this.parse=function(he,I,U){if(typeof he!="string")throw new Error("Input must be a string");var V=he.length,L=S.length,K=F.length,fe=B.length,ee=C(k),de=[],ue=[],Ie=[],Y=G=0;if(!he)return Ve();if(q||q!==!1&&he.indexOf(Q)===-1){for(var H=he.split(F),je=0;je<H.length;je++){if(Ie=H[je],G+=Ie.length,je!==H.length-1)G+=F.length;else if(U)return Ve();if(!B||Ie.substring(0,fe)!==B){if(ee){if(de=[],ae(Ie.split(S)),me(),Ae)return Ve()}else ae(Ie.split(S));if(D&&D<=je)return de=de.slice(0,D),Ve(!0)}}return Ve()}for(var Ce=he.indexOf(S,G),oe=he.indexOf(F,G),He=new RegExp(g(re)+g(Q),"g"),ie=he.indexOf(Q,G);;)if(he[G]===Q)for(ie=G,G++;;){if((ie=he.indexOf(Q,ie+1))===-1)return U||ue.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:de.length,index:G}),we();if(ie===V-1)return we(he.substring(G,ie).replace(He,Q));if(Q===re&&he[ie+1]===re)ie++;else if(Q===re||ie===0||he[ie-1]!==re){Ce!==-1&&Ce<ie+1&&(Ce=he.indexOf(S,ie+1));var le=ve((oe=oe!==-1&&oe<ie+1?he.indexOf(F,ie+1):oe)===-1?Ce:Math.min(Ce,oe));if(he.substr(ie+1+le,L)===S){Ie.push(he.substring(G,ie).replace(He,Q)),he[G=ie+1+le+L]!==Q&&(ie=he.indexOf(Q,G)),Ce=he.indexOf(S,G),oe=he.indexOf(F,G);break}if(le=ve(oe),he.substring(ie+1+le,ie+1+le+K)===F){if(Ie.push(he.substring(G,ie).replace(He,Q)),De(ie+1+le+K),Ce=he.indexOf(S,G),ie=he.indexOf(Q,G),ee&&(me(),Ae))return Ve();if(D&&de.length>=D)return Ve(!0);break}ue.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:de.length,index:G}),ie++}}else if(B&&Ie.length===0&&he.substring(G,G+fe)===B){if(oe===-1)return Ve();G=oe+K,oe=he.indexOf(F,G),Ce=he.indexOf(S,G)}else if(Ce!==-1&&(Ce<oe||oe===-1))Ie.push(he.substring(G,Ce)),G=Ce+L,Ce=he.indexOf(S,G);else{if(oe===-1)break;if(Ie.push(he.substring(G,oe)),De(oe+K),ee&&(me(),Ae))return Ve();if(D&&de.length>=D)return Ve(!0)}return we();function ae(Fe){de.push(Fe),Y=G}function ve(Fe){var Re=0;return Re=Fe!==-1&&(Fe=he.substring(ie+1,Fe))&&Fe.trim()===""?Fe.length:Re}function we(Fe){return U||(Fe===void 0&&(Fe=he.substring(G)),Ie.push(Fe),G=V,ae(Ie),ee&&me()),Ve()}function De(Fe){G=Fe,ae(Ie),Ie=[],oe=he.indexOf(F,G)}function Ve(Fe){if(w.header&&!I&&de.length&&!W){var Re=de[0],Be=Object.create(null),X=new Set(Re);let _e=!1;for(let ke=0;ke<Re.length;ke++){let lt=Re[ke];if(Be[lt=C(w.transformHeader)?w.transformHeader(lt,ke):lt]){let mt,pt=Be[lt];for(;mt=lt+"_"+pt,pt++,X.has(mt););X.add(mt),Re[ke]=mt,Be[lt]++,_e=!0,(te=te===null?{}:te)[mt]=lt}else Be[lt]=1,Re[ke]=lt;X.add(lt)}_e&&console.warn("Duplicate headers found and renamed."),W=!0}return{data:de,errors:ue,meta:{delimiter:S,linebreak:F,aborted:Ae,truncated:!!Fe,cursor:Y+(I||0),renamedHeaders:te}}}function me(){k(Ve()),de=[],ue=[]}},this.abort=function(){Ae=!0},this.getCharIndex=function(){return G}}function v(w){var S=w.data,F=l[S.workerId],B=!1;if(S.error)F.userError(S.error,S.file);else if(S.results&&S.results.data){var k={abort:function(){B=!0,x(S.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:E,resume:E};if(C(F.userStep)){for(var D=0;D<S.results.data.length&&(F.userStep({data:S.results.data[D],errors:S.results.errors,meta:S.results.meta},k),!B);D++);delete S.results}else C(F.userChunk)&&(F.userChunk(S.results,k,S.file),delete S.results)}S.finished&&!B&&x(S.workerId,S.results)}function x(w,S){var F=l[w];C(F.userComplete)&&F.userComplete(S),F.terminate(),delete l[w]}function E(){throw new Error("Not implemented.")}function T(w){if(typeof w!="object"||w===null)return w;var S,F=Array.isArray(w)?[]:{};for(S in w)F[S]=T(w[S]);return F}function j(w,S){return function(){w.apply(S,arguments)}}function C(w){return typeof w=="function"}return d.parse=function(w,S){var F=(S=S||{}).dynamicTyping||!1;if(C(F)&&(S.dynamicTypingFunction=F,F={}),S.dynamicTyping=F,S.transform=!!C(S.transform)&&S.transform,!S.worker||!d.WORKERS_SUPPORTED)return F=null,d.NODE_STREAM_INPUT,typeof w=="string"?(w=(B=>B.charCodeAt(0)!==65279?B:B.slice(1))(w),F=new(S.download?A:f)(S)):w.readable===!0&&C(w.read)&&C(w.on)?F=new p(S):(s.File&&w instanceof File||w instanceof Object)&&(F=new h(S)),F.stream(w);(F=(()=>{var B;return!!d.WORKERS_SUPPORTED&&(B=(()=>{var k=s.URL||s.webkitURL||null,D=r.toString();return d.BLOB_URL||(d.BLOB_URL=k.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",D,")();"],{type:"text/javascript"})))})(),(B=new s.Worker(B)).onmessage=v,B.id=c++,l[B.id]=B)})()).userStep=S.step,F.userChunk=S.chunk,F.userComplete=S.complete,F.userError=S.error,S.step=C(S.step),S.chunk=C(S.chunk),S.complete=C(S.complete),S.error=C(S.error),delete S.worker,F.postMessage({input:w,config:S,workerId:F.id})},d.unparse=function(w,S){var F=!1,B=!0,k=",",D=`\r
`,q='"',te=q+q,W=!1,Q=null,re=!1,G=((()=>{if(typeof S=="object"){if(typeof S.delimiter!="string"||d.BAD_DELIMITERS.filter(function(I){return S.delimiter.indexOf(I)!==-1}).length||(k=S.delimiter),typeof S.quotes!="boolean"&&typeof S.quotes!="function"&&!Array.isArray(S.quotes)||(F=S.quotes),typeof S.skipEmptyLines!="boolean"&&typeof S.skipEmptyLines!="string"||(W=S.skipEmptyLines),typeof S.newline=="string"&&(D=S.newline),typeof S.quoteChar=="string"&&(q=S.quoteChar),typeof S.header=="boolean"&&(B=S.header),Array.isArray(S.columns)){if(S.columns.length===0)throw new Error("Option columns is empty");Q=S.columns}S.escapeChar!==void 0&&(te=S.escapeChar+q),S.escapeFormulae instanceof RegExp?re=S.escapeFormulae:typeof S.escapeFormulae=="boolean"&&S.escapeFormulae&&(re=/^[=+\-@\t\r].*$/)}})(),new RegExp(g(q),"g"));if(typeof w=="string"&&(w=JSON.parse(w)),Array.isArray(w)){if(!w.length||Array.isArray(w[0]))return Ae(null,w,W);if(typeof w[0]=="object")return Ae(Q||Object.keys(w[0]),w,W)}else if(typeof w=="object")return typeof w.data=="string"&&(w.data=JSON.parse(w.data)),Array.isArray(w.data)&&(w.fields||(w.fields=w.meta&&w.meta.fields||Q),w.fields||(w.fields=Array.isArray(w.data[0])?w.fields:typeof w.data[0]=="object"?Object.keys(w.data[0]):[]),Array.isArray(w.data[0])||typeof w.data[0]=="object"||(w.data=[w.data])),Ae(w.fields||[],w.data||[],W);throw new Error("Unable to serialize unrecognized input");function Ae(I,U,V){var L="",K=(typeof I=="string"&&(I=JSON.parse(I)),typeof U=="string"&&(U=JSON.parse(U)),Array.isArray(I)&&0<I.length),fe=!Array.isArray(U[0]);if(K&&B){for(var ee=0;ee<I.length;ee++)0<ee&&(L+=k),L+=he(I[ee],ee);0<U.length&&(L+=D)}for(var de=0;de<U.length;de++){var ue=(K?I:U[de]).length,Ie=!1,Y=K?Object.keys(U[de]).length===0:U[de].length===0;if(V&&!K&&(Ie=V==="greedy"?U[de].join("").trim()==="":U[de].length===1&&U[de][0].length===0),V==="greedy"&&K){for(var H=[],je=0;je<ue;je++){var Ce=fe?I[je]:je;H.push(U[de][Ce])}Ie=H.join("").trim()===""}if(!Ie){for(var oe=0;oe<ue;oe++){0<oe&&!Y&&(L+=k);var He=K&&fe?I[oe]:oe;L+=he(U[de][He],oe)}de<U.length-1&&(!V||0<ue&&!Y)&&(L+=D)}}return L}function he(I,U){var V,L;return I==null?"":I.constructor===Date?JSON.stringify(I).slice(1,25):(L=!1,re&&typeof I=="string"&&re.test(I)&&(I="'"+I,L=!0),V=I.toString().replace(G,te),(L=L||F===!0||typeof F=="function"&&F(I,U)||Array.isArray(F)&&F[U]||((K,fe)=>{for(var ee=0;ee<fe.length;ee++)if(-1<K.indexOf(fe[ee]))return!0;return!1})(V,d.BAD_DELIMITERS)||-1<V.indexOf(k)||V.charAt(0)===" "||V.charAt(V.length-1)===" ")?q+V+q:V)}},d.RECORD_SEP="",d.UNIT_SEP="",d.BYTE_ORDER_MARK="\uFEFF",d.BAD_DELIMITERS=["\r",`
`,'"',d.BYTE_ORDER_MARK],d.WORKERS_SUPPORTED=!i&&!!s.Worker,d.NODE_STREAM_INPUT=1,d.LocalChunkSize=10485760,d.RemoteChunkSize=5242880,d.DefaultDelimiter=",",d.Parser=y,d.ParserHandle=m,d.NetworkStreamer=A,d.FileStreamer=h,d.StringStreamer=f,d.ReadableStreamStreamer=p,s.jQuery&&((n=s.jQuery).fn.parse=function(w){var S=w.config||{},F=[];return this.each(function(D){if(!(n(this).prop("tagName").toUpperCase()==="INPUT"&&n(this).attr("type").toLowerCase()==="file"&&s.FileReader)||!this.files||this.files.length===0)return!0;for(var q=0;q<this.files.length;q++)F.push({file:this.files[q],inputElem:this,instanceConfig:n.extend({},S)})}),B(),this;function B(){if(F.length===0)C(w.complete)&&w.complete();else{var D,q,te,W,Q=F[0];if(C(w.before)){var re=w.before(Q.file,Q.inputElem);if(typeof re=="object"){if(re.action==="abort")return D="AbortError",q=Q.file,te=Q.inputElem,W=re.reason,void(C(w.error)&&w.error({name:D},q,te,W));if(re.action==="skip")return void k();typeof re.config=="object"&&(Q.instanceConfig=n.extend(Q.instanceConfig,re.config))}else if(re==="skip")return void k()}var G=Q.instanceConfig.complete;Q.instanceConfig.complete=function(Ae){C(G)&&G(Ae,Q.file,Q.inputElem),k()},d.parse(Q.file,Q.instanceConfig)}}function k(){F.splice(0,1),B()}}),o&&(s.onmessage=function(w){w=w.data,d.WORKER_ID===void 0&&w&&(d.WORKER_ID=w.workerId),typeof w.input=="string"?s.postMessage({workerId:d.WORKER_ID,results:d.parse(w.input,w.config),finished:!0}):(s.File&&w.input instanceof File||w.input instanceof Object)&&(w=d.parse(w.input,w.config))&&s.postMessage({workerId:d.WORKER_ID,results:w,finished:!0})}),(A.prototype=Object.create(u.prototype)).constructor=A,(h.prototype=Object.create(u.prototype)).constructor=h,(f.prototype=Object.create(f.prototype)).constructor=f,(p.prototype=Object.create(u.prototype)).constructor=p,d})})(eQ);var Fme=eQ.exports;const pC=bD(Fme);class S1{static prepareMenuItemsForExport(e){return e.map(r=>({id:r.id,name:r.name,description:r.description||"",category:r.category,price:r.price,isAvailable:r.isAvailable?"Yes":"No",preparationTime:r.preparationTime||0,spiceLevel:r.spiceLevel||"none",isVegetarian:r.isVegetarian?"Yes":"No",isVegan:r.isVegan?"Yes":"No",isGlutenFree:r.isGlutenFree?"Yes":"No",ingredients:(r.ingredients||[]).join(", "),allergens:(r.allergens||[]).join(", "),tags:(r.tags||[]).join(", "),variants:this.formatVariants(r.variants||[]),image:r.image||"",createdAt:r.createdAt.toISOString(),updatedAt:r.updatedAt.toISOString()}))}static formatVariants(e){return!e||e.length===0?"":e.map(r=>{const s=r.options.map(n=>`${n.name}: ${n.priceModifier} (${n.pricingType||"additive"})`).join(", ");return`${r.name} [${r.type}${r.required?", required":""}]: ${s}`}).join(" | ")}static exportToCSV(e,r){try{const s=this.prepareMenuItemsForExport(e),n=pC.unparse(s,{header:!0,columns:["id","name","description","category","price","isAvailable","preparationTime","spiceLevel","isVegetarian","isVegan","isGlutenFree","ingredients","allergens","tags","variants","image","createdAt","updatedAt"]}),i=new Blob([n],{type:"text/csv;charset=utf-8;"}),o=document.createElement("a");if(o.download!==void 0){const l=URL.createObjectURL(i);o.setAttribute("href",l),o.setAttribute("download",r||`menu-export-${new Date().toISOString().split("T")[0]}.csv`),o.style.visibility="hidden",document.body.appendChild(o),o.click(),document.body.removeChild(o)}}catch(s){throw console.error("Error exporting to CSV:",s),new Error("Failed to export menu to CSV")}}static exportToExcel(e,r){try{const s=this.prepareMenuItemsForExport(e),i="\uFEFF"+pC.unparse(s,{header:!0,columns:["id","name","description","category","price","isAvailable","preparationTime","spiceLevel","isVegetarian","isVegan","isGlutenFree","ingredients","allergens","tags","variants","image","createdAt","updatedAt"]}),o=new Blob([i],{type:"text/csv;charset=utf-8;"}),l=document.createElement("a");if(l.download!==void 0){const c=URL.createObjectURL(o);l.setAttribute("href",c),l.setAttribute("download",r||`menu-export-${new Date().toISOString().split("T")[0]}.xlsx`),l.style.visibility="hidden",document.body.appendChild(l),l.click(),document.body.removeChild(l)}}catch(s){throw console.error("Error exporting to Excel:",s),new Error("Failed to export menu to Excel")}}static exportFilteredItems(e,r,s="csv",n){let i=e;if(r.category&&r.category!=="all"&&(i=i.filter(l=>l.category===r.category)),r.searchTerm){const l=r.searchTerm.toLowerCase();i=i.filter(c=>{var d;return c.name.toLowerCase().includes(l)||((d=c.description)==null?void 0:d.toLowerCase().includes(l))||c.category.toLowerCase().includes(l)||(c.ingredients||[]).some(u=>u.toLowerCase().includes(l))})}r.availableOnly&&(i=i.filter(l=>l.isAvailable));let o=n;if(!o){const l=new Date().toISOString().split("T")[0],c=[];r.category&&r.category!=="all"&&c.push(r.category.toLowerCase().replace(/\s+/g,"-")),r.searchTerm&&c.push("search"),r.availableOnly&&c.push("available"),o=`menu-export${c.length>0?`-${c.join("-")}`:""}-${l}.${s==="excel"?"xlsx":"csv"}`}s==="excel"?this.exportToExcel(i,o):this.exportToCSV(i,o)}static getExportSummary(e){const r=[...new Set(e.map(s=>s.category))];return{totalItems:e.length,availableItems:e.filter(s=>s.isAvailable).length,categoriesCount:r.length,categories:r}}static validateMenuImportData(e){const r=[],s=[];try{const n=pC.parse(e,{header:!0});n.errors.length>0&&r.push(...n.errors.map(c=>c.message));const i=["name","category","price"],o=n.meta.fields||[];for(const c of i)o.includes(c)||r.push(`Missing required column: ${c}`);n.data.forEach((c,d)=>{(!c.name||c.name.trim()==="")&&r.push(`Row ${d+1}: Name is required`),(!c.category||c.category.trim()==="")&&r.push(`Row ${d+1}: Category is required`),(!c.price||isNaN(parseFloat(c.price)))&&r.push(`Row ${d+1}: Valid price is required`),c.price&&parseFloat(c.price)<0&&s.push(`Row ${d+1}: Price should not be negative`)})}catch{r.push("Invalid CSV format")}return{isValid:r.length===0,errors:r,warnings:s}}}function Pme({isOpen:t,onClose:e,menuItems:r,categories:s,currentCategory:n,currentSearchTerm:i,showAvailableOnly:o}){const[l,c]=R.useState("csv"),[d,u]=R.useState(n),[A,h]=R.useState(i),[f,p]=R.useState(o),[m,g]=R.useState(!1);if(!t)return null;const v=(()=>{let j=r;if(d!=="all"&&(j=j.filter(C=>C.category===d)),A){const C=A.toLowerCase();j=j.filter(w=>{var S;return w.name.toLowerCase().includes(C)||((S=w.description)==null?void 0:S.toLowerCase().includes(C))||w.category.toLowerCase().includes(C)||(w.ingredients||[]).some(F=>F.toLowerCase().includes(C))})}return f&&(j=j.filter(C=>C.isAvailable)),j})(),x=S1.getExportSummary(v),E=async()=>{try{g(!0);const j={category:d,searchTerm:A,availableOnly:f};S1.exportFilteredItems(r,j,l),Z.success(`Menu exported successfully as ${l.toUpperCase()}!`),e()}catch(j){console.error("Export failed:",j),Z.error("Failed to export menu. Please try again.")}finally{g(!1)}},T=async()=>{try{g(!0),l==="excel"?S1.exportToExcel(r):S1.exportToCSV(r),Z.success(`Complete menu exported as ${l.toUpperCase()}!`),e()}catch(j){console.error("Export failed:",j),Z.error("Failed to export menu. Please try again.")}finally{g(!1)}};return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-hidden",children:[a.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:a.jsx(Yn,{className:"w-5 h-5 text-blue-600"})}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Export Menu"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Download your menu items in CSV or Excel format"})]})]}),a.jsx("button",{onClick:e,className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100",children:a.jsx(qr,{className:"w-5 h-5"})})]}),a.jsxs("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-180px)]",children:[a.jsxs("div",{className:"mb-6",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Export Format"}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsx("button",{onClick:()=>c("csv"),className:`p-4 border-2 rounded-lg transition-all ${l==="csv"?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx(Rl,{className:"w-6 h-6 text-gray-600"}),a.jsxs("div",{className:"text-left",children:[a.jsx("div",{className:"font-medium text-gray-900",children:"CSV Format"}),a.jsx("div",{className:"text-sm text-gray-600",children:"Compatible with spreadsheet apps"})]})]})}),a.jsx("button",{onClick:()=>c("excel"),className:`p-4 border-2 rounded-lg transition-all ${l==="excel"?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx(Qte,{className:"w-6 h-6 text-gray-600"}),a.jsxs("div",{className:"text-left",children:[a.jsx("div",{className:"font-medium text-gray-900",children:"Excel Format"}),a.jsx("div",{className:"text-sm text-gray-600",children:"Optimized for Microsoft Excel"})]})]})})]})]}),a.jsxs("div",{className:"mb-6",children:[a.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[a.jsx(nu,{className:"w-5 h-5 text-gray-600"}),a.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Export Filters"})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),a.jsxs("select",{value:d,onChange:j=>u(j.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"all",children:"All Categories"}),s.map(j=>a.jsx("option",{value:j.name,children:j.name},j.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Search Term"}),a.jsx("input",{type:"text",value:A,onChange:j=>h(j.target.value),placeholder:"Filter by name, description, or ingredients...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{className:"flex items-center",children:[a.jsx("input",{type:"checkbox",id:"availableOnly",checked:f,onChange:j=>p(j.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),a.jsx("label",{htmlFor:"availableOnly",className:"ml-2 block text-sm text-gray-700",children:"Export only available items"})]})]})]}),a.jsxs("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[a.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[a.jsx(Sa,{className:"w-5 h-5 text-gray-600"}),a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Export Preview"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(rs,{className:"w-4 h-4 text-blue-600"}),a.jsxs("span",{className:"text-sm text-gray-600",children:[x.totalItems," items will be exported"]})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Nr,{className:"w-4 h-4 text-green-600"}),a.jsxs("span",{className:"text-sm text-gray-600",children:[x.availableItems," available items"]})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(nu,{className:"w-4 h-4 text-purple-600"}),a.jsxs("span",{className:"text-sm text-gray-600",children:[x.categoriesCount," categories"]})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Rl,{className:"w-4 h-4 text-orange-600"}),a.jsx("span",{className:"text-sm text-gray-600",children:"18 data fields per item"})]})]}),x.totalItems===0&&a.jsxs("div",{className:"mt-3 flex items-center space-x-2 text-amber-600",children:[a.jsx(oi,{className:"w-4 h-4"}),a.jsx("span",{className:"text-sm",children:"No items match the current filters"})]})]}),a.jsxs("div",{className:"mb-6",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Exported Fields"}),a.jsx("div",{className:"text-xs text-gray-600 bg-gray-50 p-3 rounded-lg",children:a.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1",children:[a.jsx("span",{children:" ID & Name"}),a.jsx("span",{children:" Description"}),a.jsx("span",{children:" Category & Price"}),a.jsx("span",{children:" Availability Status"}),a.jsx("span",{children:" Preparation Time"}),a.jsx("span",{children:" Spice Level"}),a.jsx("span",{children:" Dietary Info (Veg/Vegan/Gluten-free)"}),a.jsx("span",{children:" Ingredients & Allergens"}),a.jsx("span",{children:" Tags & Variants"}),a.jsx("span",{children:" Image URL"}),a.jsx("span",{children:" Created & Updated Dates"})]})})]})]}),a.jsxs("div",{className:"flex items-center justify-between p-6 border-t border-gray-200 bg-gray-50",children:[a.jsx("div",{className:"flex space-x-3",children:a.jsxs("button",{onClick:T,disabled:m||r.length===0,className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:["Export All (",r.length," items)"]})}),a.jsxs("div",{className:"flex space-x-3",children:[a.jsx("button",{onClick:e,className:"px-4 py-2 text-gray-600 hover:text-gray-800 transition-colors",children:"Cancel"}),a.jsx("button",{onClick:E,disabled:m||v.length===0,className:"flex items-center space-x-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:m?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),a.jsx("span",{children:"Exporting..."})]}):a.jsxs(a.Fragment,{children:[a.jsx(Yn,{className:"w-4 h-4"}),a.jsxs("span",{children:["Export Filtered (",v.length,")"]})]})})]})]})]})})}function Dme(){const{restaurant:t}=js(),[e,r]=R.useState("items"),[s,n]=R.useState([]),[i,o]=R.useState([]),[l,c]=R.useState([]),[d,u]=R.useState("all"),[A,h]=R.useState(""),[f,p]=R.useState("grid"),[m,g]=R.useState(!1),[y,v]=R.useState(!0),[x,E]=R.useState(null),[T,j]=R.useState(null),[C,w]=R.useState(null),{register:S,handleSubmit:F,reset:B,setValue:k,watch:D}=nn();R.useEffect(()=>{t&&q()},[t]),R.useEffect(()=>{let he=s;d!=="all"&&(he=he.filter(I=>I.category===d)),A&&(he=he.filter(I=>{var U;return I.name.toLowerCase().includes(A.toLowerCase())||((U=I.description)==null?void 0:U.toLowerCase().includes(A.toLowerCase()))||I.category.toLowerCase().includes(A.toLowerCase())})),m&&(he=he.filter(I=>I.isAvailable)),c(he)},[s,d,A,m]);const q=async()=>{if(t)try{v(!0);const[he,I]=await Promise.all([Ts.getMenuItemsForRestaurant(t.id),Ts.getCategoriesForRestaurant(t.id)]);he.success&&he.data&&n(he.data),I.success&&I.data&&o(I.data)}catch{Z.error("Failed to load menu data")}finally{v(!1)}},te=()=>{var he;j(null),B({name:"",description:"",category:((he=i[0])==null?void 0:he.name)||"",price:0,isAvailable:!0,preparationTime:0,allergens:[],spiceLevel:"none",isVegetarian:!1,isVegan:!1,isGlutenFree:!1,tags:[],variants:[]}),E("item")},W=he=>{j(he),k("name",he.name),k("description",he.description||""),k("category",he.category),k("price",he.price),k("image",he.image||""),k("isAvailable",he.isAvailable),k("preparationTime",he.preparationTime||0),k("allergens",he.allergens||[]),k("spiceLevel",he.spiceLevel||"none"),k("isVegetarian",he.isVegetarian||!1),k("isVegan",he.isVegan||!1),k("isGlutenFree",he.isGlutenFree||!1),k("tags",he.tags||[]),k("variants",he.variants||[]),E("item")},Q=he=>{w(he),E("view")},re=async he=>{if(t)try{if(T){const I=await Ts.updateMenuItem(T.id,t.id,{name:he.name,description:he.description,category:he.category,price:he.price,image:he.image,isAvailable:he.isAvailable,preparationTime:he.preparationTime,allergens:he.allergens,spiceLevel:he.spiceLevel,isVegetarian:he.isVegetarian,isVegan:he.isVegan,isGlutenFree:he.isGlutenFree,tags:he.tags,variants:he.variants});I.success?(Z.success("Menu item updated successfully"),await q()):Z.error(I.error||"Failed to update menu item")}else{const I=i.find(V=>V.name===he.category),U=await Ts.createMenuItem({restaurantId:t.id,name:he.name,description:he.description,category:he.category,categoryId:(I==null?void 0:I.id)||"",categoryName:(I==null?void 0:I.name)||he.category,price:he.price,image:he.image,isAvailable:he.isAvailable,preparationTime:he.preparationTime,allergens:he.allergens,spiceLevel:he.spiceLevel,isVegetarian:he.isVegetarian,isVegan:he.isVegan,isGlutenFree:he.isGlutenFree,tags:he.tags,variants:he.variants});U.success?(Z.success("Menu item created successfully"),await q()):Z.error(U.error||"Failed to create menu item")}E(null),j(null)}catch{Z.error("Failed to save menu item")}},G=async he=>{if(!(!t||!confirm(`Are you sure you want to delete "${he.name}"?`)))try{const I=await Ts.deleteMenuItem(he.id,t.id);I.success?(Z.success("Menu item deleted successfully"),await q()):Z.error(I.error||"Failed to delete menu item")}catch{Z.error("Failed to delete menu item")}},Ae=async he=>{if(t)try{const I=await Ts.updateMenuItem(he.id,t.id,{isAvailable:!he.isAvailable});I.success?(Z.success(`${he.name} ${he.isAvailable?"disabled":"enabled"}`),await q()):Z.error(I.error||"Failed to update availability")}catch{Z.error("Failed to update availability")}};return t?a.jsxs("div",{className:"min-h-screen",style:{background:"var(--color-background)"},children:[a.jsx("header",{className:"bg-white/80 backdrop-blur-md border-b border-gray-200 sticky top-0 z-40",children:a.jsx("div",{className:"max-w-7xl mx-auto px-3 sm:px-4 lg:px-6 xl:px-8 py-4 sm:py-6",children:a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{children:[a.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:"Menu Management"}),a.jsx("p",{className:"text-gray-600 text-sm sm:text-base",children:"Manage your restaurant's menu items and categories"})]})})})}),a.jsxs("main",{className:"max-w-7xl mx-auto px-3 sm:px-4 lg:px-6 xl:px-8 py-4 sm:py-6",children:[a.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-6 mb-4 sm:mb-6",children:[a.jsx("div",{className:"card p-3 sm:p-6",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"p-2 sm:p-3 bg-blue-100 rounded-lg",children:a.jsx(rs,{className:"w-4 h-4 sm:w-6 sm:h-6 text-blue-600"})}),a.jsxs("div",{className:"ml-2 sm:ml-4 min-w-0 flex-1",children:[a.jsx("p",{className:"text-xs sm:text-sm text-gray-600 truncate",children:"Total Items"}),a.jsx("p",{className:"text-lg sm:text-2xl font-bold text-gray-900",children:s.length})]})]})}),a.jsx("div",{className:"card p-3 sm:p-6",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"p-2 sm:p-3 bg-green-100 rounded-lg",children:a.jsx(Xs,{className:"w-4 h-4 sm:w-6 sm:h-6 text-green-600"})}),a.jsxs("div",{className:"ml-2 sm:ml-4 min-w-0 flex-1",children:[a.jsx("p",{className:"text-xs sm:text-sm text-gray-600 truncate",children:"Available"}),a.jsx("p",{className:"text-lg sm:text-2xl font-bold text-gray-900",children:s.filter(he=>he.isAvailable).length})]})]})}),a.jsx("div",{className:"card p-3 sm:p-6",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"p-2 sm:p-3 bg-yellow-100 rounded-lg",children:a.jsx(Vw,{className:"w-4 h-4 sm:w-6 sm:h-6 text-yellow-600"})}),a.jsxs("div",{className:"ml-2 sm:ml-4 min-w-0 flex-1",children:[a.jsx("p",{className:"text-xs sm:text-sm text-gray-600 truncate",children:"Categories"}),a.jsx("p",{className:"text-lg sm:text-2xl font-bold text-gray-900",children:i.length})]})]})}),a.jsx("div",{className:"card p-3 sm:p-6",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"p-2 sm:p-3 bg-purple-100 rounded-lg",children:a.jsx(hn,{className:"w-4 h-4 sm:w-6 sm:h-6 text-purple-600"})}),a.jsxs("div",{className:"ml-2 sm:ml-4 min-w-0 flex-1",children:[a.jsx("p",{className:"text-xs sm:text-sm text-gray-600 truncate",children:"Avg. Price"}),a.jsx("p",{className:"text-sm sm:text-2xl font-bold text-gray-900",children:s.length>0?Ue(s.reduce((he,I)=>he+I.price,0)/s.length):Ue(0)})]})]})})]}),a.jsx("div",{className:"card mb-4 sm:mb-6",children:a.jsx("div",{className:"border-b border-gray-200",children:a.jsxs("nav",{className:"-mb-px flex space-x-4 sm:space-x-8 px-3 sm:px-6",children:[a.jsxs("button",{onClick:()=>r("items"),className:`py-3 sm:py-4 px-1 border-b-2 font-medium text-xs sm:text-sm ${e==="items"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[a.jsx(rs,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-1 sm:mr-2 inline"}),"Menu Items (",s.length,")"]}),a.jsxs("button",{onClick:()=>r("categories"),className:`py-3 sm:py-4 px-1 border-b-2 font-medium text-xs sm:text-sm ${e==="categories"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[a.jsx(Vw,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-1 sm:mr-2 inline"}),"Categories (",i.length,")"]})]})})}),e==="items"&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"card p-3 sm:p-6 mb-4 sm:mb-6",children:a.jsxs("div",{className:"flex flex-col gap-4",children:[a.jsxs("div",{className:"flex-1 relative",children:[a.jsx(sn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4 sm:w-5 sm:h-5"}),a.jsx("input",{type:"text",placeholder:"Search menu items...",value:A,onChange:he=>h(he.target.value),className:"w-full pl-8 sm:pl-10 pr-4 py-2 sm:py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm"})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-3 sm:gap-4",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(nu,{className:"w-4 h-4 sm:w-5 sm:h-5 text-gray-600"}),a.jsxs("select",{value:d,onChange:he=>u(he.target.value),className:"px-3 py-2 sm:py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",children:[a.jsx("option",{value:"all",children:"All Categories"}),i.map(he=>a.jsx("option",{value:he.name,children:he.name},he.id))]})]}),a.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:m,onChange:he=>g(he.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{className:"text-xs sm:text-sm text-gray-700",children:"Available only"})]}),a.jsxs("div",{className:"flex items-center bg-white rounded-lg border border-gray-200",children:[a.jsx("button",{onClick:()=>p("grid"),className:`p-2 ${f==="grid"?"bg-blue-50 text-blue-600":"text-gray-600"}`,children:a.jsx(GA,{className:"w-3 h-3 sm:w-4 sm:h-4"})}),a.jsx("button",{onClick:()=>p("list"),className:`p-2 ${f==="list"?"bg-blue-50 text-blue-600":"text-gray-600"}`,children:a.jsx(oM,{className:"w-3 h-3 sm:w-4 sm:h-4"})})]}),a.jsxs("button",{onClick:()=>E("export"),disabled:s.length===0,className:"btn btn-secondary text-xs sm:text-sm disabled:opacity-50 disabled:cursor-not-allowed",children:[a.jsx(Yn,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-1 sm:mr-2"}),a.jsx("span",{className:"hidden sm:inline",children:"Export Menu"}),a.jsx("span",{className:"sm:hidden",children:"Export"})]}),a.jsxs("button",{onClick:()=>E("bulk-import"),className:"btn btn-secondary text-xs sm:text-sm",children:[a.jsx(Oj,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-1 sm:mr-2"}),a.jsx("span",{className:"hidden sm:inline",children:"Bulk Import"}),a.jsx("span",{className:"sm:hidden",children:"Import"})]}),a.jsxs("button",{onClick:te,className:"btn btn-theme-primary text-xs sm:text-sm",children:[a.jsx(zr,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-1 sm:mr-2"}),a.jsx("span",{className:"hidden sm:inline",children:"Add Item"}),a.jsx("span",{className:"sm:hidden",children:"Add"})]})]})]})}),y?a.jsxs("div",{className:"text-center py-12",children:[a.jsx("div",{className:"inline-block animate-spin rounded-full h-6 w-6 sm:h-8 sm:w-8 border-b-2 border-blue-600 mb-4"}),a.jsx("p",{className:"text-gray-600 text-sm sm:text-base",children:"Loading menu items..."})]}):a.jsxs(a.Fragment,{children:[f==="grid"?a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-3 sm:gap-6",children:l.map(he=>a.jsx(Rme,{item:he,onEdit:W,onDelete:G,onView:Q,onToggleAvailability:Ae},he.id))}):a.jsx("div",{className:"space-y-3 sm:space-y-4",children:l.map(he=>a.jsx(Lme,{item:he,onEdit:W,onDelete:G,onView:Q,onToggleAvailability:Ae},he.id))}),l.length===0&&a.jsxs("div",{className:"text-center py-12",children:[a.jsx(rs,{className:"w-12 h-12 sm:w-16 sm:h-16 text-gray-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-base sm:text-lg font-medium text-gray-900 mb-2",children:"No menu items found"}),a.jsx("p",{className:"text-gray-600 mb-4 text-sm sm:text-base",children:A||d!=="all"||m?"Try adjusting your filters or search terms":"Get started by adding your first menu item"}),!A&&d==="all"&&!m&&a.jsxs("button",{onClick:te,className:"btn btn-theme-primary text-sm",children:[a.jsx(zr,{className:"w-4 h-4 mr-2"}),"Add First Menu Item"]})]})]})]}),e==="categories"&&a.jsx(Tse,{categories:i,onCategoriesUpdated:q})]}),x==="item"&&a.jsx(Ome,{isOpen:!0,onClose:()=>E(null),onSave:re,item:T,categories:i,register:S,handleSubmit:F,watch:D,setValue:k}),x==="view"&&C&&a.jsx(Ume,{isOpen:!0,onClose:()=>E(null),item:C,onEdit:()=>{W(C),w(null)}}),x==="bulk-import"&&t&&a.jsx(Bme,{isOpen:!0,onClose:()=>E(null),onSuccess:()=>{E(null),q()},restaurantId:t.id,categories:i.map(he=>({id:he.id,name:he.name}))}),x==="export"&&a.jsx(Pme,{isOpen:!0,onClose:()=>E(null),menuItems:s,categories:i,currentCategory:d,currentSearchTerm:A,showAvailableOnly:m})]}):a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Loading..."})]})})}function Rme({item:t,onEdit:e,onDelete:r,onView:s,onToggleAvailability:n}){const i=t.spiceLevel?Z_(t.spiceLevel):null;return a.jsxs("div",{className:`card hover:shadow-lg transition-all duration-200 ${t.isAvailable?"":"opacity-60"}`,children:[a.jsxs("div",{className:"relative",children:[t.image?a.jsx("img",{src:t.image,alt:t.name,className:"w-full h-32 sm:h-48 object-cover rounded-t-xl"}):a.jsx("div",{className:"w-full h-32 sm:h-48 bg-gray-200 rounded-t-xl flex items-center justify-center",children:a.jsx(iM,{className:"w-8 h-8 sm:w-12 sm:h-12 text-gray-400"})}),a.jsx("div",{className:"absolute top-2 sm:top-3 right-2 sm:right-3",children:a.jsx("button",{onClick:()=>n(t),className:`p-1.5 sm:p-2 rounded-full ${t.isAvailable?"bg-green-600":"bg-gray-600"} text-white`,children:t.isAvailable?a.jsx(Xs,{className:"w-3 h-3 sm:w-4 sm:h-4"}):a.jsx(Dl,{className:"w-3 h-3 sm:w-4 sm:h-4"})})}),!t.isAvailable&&a.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50 rounded-t-xl flex items-center justify-center",children:a.jsx("span",{className:"text-white font-medium text-sm",children:"Unavailable"})})]}),a.jsxs("div",{className:"p-3 sm:p-4",children:[a.jsxs("div",{className:"flex items-start justify-between mb-2",children:[a.jsx("h3",{className:"font-semibold text-gray-900 text-sm sm:text-lg truncate pr-2",children:t.name}),a.jsx("div",{className:"text-sm sm:text-lg font-bold flex-shrink-0",style:{color:"var(--color-primary)"},children:Ue(t.price)})]}),a.jsx("p",{className:"text-gray-600 text-xs sm:text-sm mb-2 sm:mb-3 line-clamp-2",children:t.description||"No description provided"}),a.jsxs("div",{className:"flex items-center justify-between mb-3 sm:mb-4",children:[a.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800 truncate",children:t.category}),i&&a.jsxs("span",{className:"inline-flex items-center text-xs text-gray-600 flex-shrink-0",children:[a.jsx("span",{className:"mr-1",children:i.icon}),a.jsx("span",{className:"hidden sm:inline",children:i.label})]})]}),a.jsxs("div",{className:"flex items-center flex-wrap gap-1 mb-3 sm:mb-4",children:[t.isVegetarian&&a.jsx("span",{className:"px-1.5 sm:px-2 py-0.5 sm:py-1 bg-green-100 text-green-800 text-xs rounded",children:" Veg"}),t.isVegan&&a.jsx("span",{className:"px-1.5 sm:px-2 py-0.5 sm:py-1 bg-green-100 text-green-800 text-xs rounded",children:" Vegan"}),t.isGlutenFree&&a.jsx("span",{className:"px-1.5 sm:px-2 py-0.5 sm:py-1 bg-yellow-100 text-yellow-800 text-xs rounded",children:" GF"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-1.5 sm:gap-2",children:[a.jsxs("button",{onClick:()=>s(t),className:"btn btn-secondary btn-sm text-xs",children:[a.jsx(Xs,{className:"w-3 h-3 mr-1"}),a.jsx("span",{className:"hidden sm:inline",children:"View"}),a.jsx("span",{className:"sm:hidden",children:""})]}),a.jsxs("button",{onClick:()=>window.location.href=`/${window.location.pathname.split("/")[1]}/inventory?item=${t.id}`,className:"btn bg-green-600 text-white hover:bg-green-700 btn-sm text-xs",title:"Manage Inventory",children:[a.jsx(rs,{className:"w-3 h-3 mr-1"}),a.jsx("span",{className:"hidden sm:inline",children:"Stock"}),a.jsx("span",{className:"sm:hidden",children:""})]}),a.jsxs("button",{onClick:()=>e(t),className:"btn btn-theme-primary btn-sm text-xs",children:[a.jsx(gc,{className:"w-3 h-3 mr-1"}),a.jsx("span",{className:"hidden sm:inline",children:"Edit"}),a.jsx("span",{className:"sm:hidden",children:""})]}),a.jsxs("button",{onClick:()=>r(t),className:"btn bg-red-600 text-white hover:bg-red-700 btn-sm text-xs",title:"Delete Item",children:[a.jsx(Un,{className:"w-3 h-3 mr-1"}),a.jsx("span",{className:"hidden sm:inline",children:"Delete"}),a.jsx("span",{className:"sm:hidden",children:""})]})]})]})]})}function Lme({item:t,onEdit:e,onDelete:r,onView:s,onToggleAvailability:n}){const i=t.spiceLevel?Z_(t.spiceLevel):null;return a.jsx("div",{className:`card p-3 sm:p-4 ${t.isAvailable?"":"opacity-60"}`,children:a.jsxs("div",{className:"flex items-center space-x-3 sm:space-x-4",children:[a.jsx("div",{className:"w-12 h-12 sm:w-16 sm:h-16 flex-shrink-0",children:t.image?a.jsx("img",{src:t.image,alt:t.name,className:"w-full h-full object-cover rounded-lg"}):a.jsx("div",{className:"w-full h-full bg-gray-200 rounded-lg flex items-center justify-center",children:a.jsx(iM,{className:"w-4 h-4 sm:w-6 sm:h-6 text-gray-400"})})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:space-x-3 mb-1",children:[a.jsx("h3",{className:"font-semibold text-gray-900 text-sm sm:text-base truncate",children:t.name}),a.jsxs("div",{className:"flex items-center space-x-2 mt-1 sm:mt-0",children:[a.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:t.category}),i&&a.jsxs("span",{className:"inline-flex items-center text-xs text-gray-600",children:[a.jsx("span",{className:"mr-1",children:i.icon}),a.jsx("span",{className:"hidden sm:inline",children:i.label})]})]})]}),a.jsx("p",{className:"text-gray-600 text-xs sm:text-sm mb-2 line-clamp-1 sm:line-clamp-2",children:t.description||"No description provided"}),a.jsxs("div",{className:"flex items-center space-x-1 sm:space-x-2",children:[t.isVegetarian&&a.jsx("span",{className:"px-1.5 sm:px-2 py-0.5 sm:py-1 bg-green-100 text-green-800 text-xs rounded",children:" Veg"}),t.isVegan&&a.jsx("span",{className:"px-1.5 sm:px-2 py-0.5 sm:py-1 bg-green-100 text-green-800 text-xs rounded",children:" Vegan"}),t.isGlutenFree&&a.jsx("span",{className:"px-1.5 sm:px-2 py-0.5 sm:py-1 bg-yellow-100 text-yellow-800 text-xs rounded",children:" GF"})]})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-end sm:items-center space-y-2 sm:space-y-0 sm:space-x-4",children:[a.jsxs("div",{className:"text-right",children:[a.jsx("div",{className:"text-sm sm:text-lg font-bold",style:{color:"var(--color-primary)"},children:Ue(t.price)}),a.jsx("div",{className:`text-xs sm:text-sm ${t.isAvailable?"text-green-600":"text-red-600"}`,children:t.isAvailable?"Available":"Unavailable"})]}),a.jsxs("div",{className:"flex space-x-1 sm:space-x-2",children:[a.jsx("button",{onClick:()=>n(t),className:`p-1.5 sm:p-2 rounded-lg ${t.isAvailable?"bg-green-100 text-green-600 hover:bg-green-200":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:t.isAvailable?a.jsx(Xs,{className:"w-3 h-3 sm:w-4 sm:h-4"}):a.jsx(Dl,{className:"w-3 h-3 sm:w-4 sm:h-4"})}),a.jsx("button",{onClick:()=>s(t),className:"p-1.5 sm:p-2 bg-blue-100 text-blue-600 hover:bg-blue-200 rounded-lg",children:a.jsx(Xs,{className:"w-3 h-3 sm:w-4 sm:h-4"})}),a.jsx("button",{onClick:()=>window.location.href=`/${window.location.pathname.split("/")[1]}/inventory?item=${t.id}`,className:"p-1.5 sm:p-2 bg-green-100 text-green-600 hover:bg-green-200 rounded-lg",title:"Manage Inventory",children:a.jsx(rs,{className:"w-3 h-3 sm:w-4 sm:h-4"})}),a.jsx("button",{onClick:()=>e(t),className:"p-1.5 sm:p-2 bg-yellow-100 text-yellow-600 hover:bg-yellow-200 rounded-lg",children:a.jsx(gc,{className:"w-3 h-3 sm:w-4 sm:h-4"})}),a.jsx("button",{onClick:()=>r(t),className:"p-1.5 sm:p-2 bg-red-100 text-red-600 hover:bg-red-200 rounded-lg",children:a.jsx(Un,{className:"w-3 h-3 sm:w-4 sm:h-4"})})]})]})]})})}function Ome({isOpen:t,onClose:e,onSave:r,item:s,categories:n,register:i,handleSubmit:o,watch:l,setValue:c}){if(!t)return null;const d=l("variants")||[],u=A=>{c("variants",A)};return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsx("div",{className:"p-6 border-b border-gray-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:s?"Edit Menu Item":"Add Menu Item"}),a.jsx("button",{onClick:e,className:"p-1 text-gray-400 hover:text-gray-600",children:a.jsx(qr,{className:"w-5 h-5"})})]})}),a.jsxs("form",{onSubmit:o(r),className:"p-6 space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Item Name *"}),a.jsx("input",{...i("name",{required:"Item name is required"}),type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter item name"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category *"}),a.jsx("select",{...i("category",{required:"Category is required"}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:n.map(A=>a.jsx("option",{value:A.name,children:A.name},A.id))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Price *"}),a.jsx("input",{...i("price",{required:"Price is required",min:{value:0,message:"Price must be positive"}}),type:"number",step:"0.01",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"0.00"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Preparation Time (minutes)"}),a.jsx("input",{...i("preparationTime"),type:"number",min:"0",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"0"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),a.jsx("textarea",{...i("description"),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Describe this menu item..."})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Image URL"}),a.jsx("input",{...i("image"),type:"url",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"https://example.com/image.jpg"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Spice Level"}),a.jsxs("select",{...i("spiceLevel"),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"none",children:" No Spice"}),a.jsx("option",{value:"mild",children:" Mild"}),a.jsx("option",{value:"medium",children:" Medium"}),a.jsx("option",{value:"hot",children:" Hot"}),a.jsx("option",{value:"very_hot",children:" Very Hot"})]})]}),a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[a.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[a.jsx("input",{...i("isAvailable"),type:"checkbox",className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{className:"text-sm text-gray-700",children:"Available"})]}),a.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[a.jsx("input",{...i("isVegetarian"),type:"checkbox",className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{className:"text-sm text-gray-700",children:" Vegetarian"})]}),a.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[a.jsx("input",{...i("isVegan"),type:"checkbox",className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{className:"text-sm text-gray-700",children:" Vegan"})]}),a.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[a.jsx("input",{...i("isGlutenFree"),type:"checkbox",className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{className:"text-sm text-gray-700",children:" Gluten Free"})]})]}),a.jsx("div",{className:"border-t pt-6",children:a.jsx(Ise,{variants:d,onChange:u})}),a.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[a.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Cancel"}),a.jsxs("button",{type:"submit",className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[a.jsx(au,{className:"w-4 h-4 mr-2 inline"}),s?"Update Item":"Create Item"]})]})]})]})})}function Ume({isOpen:t,onClose:e,item:r,onEdit:s}){if(!t)return null;const n=r.spiceLevel?Z_(r.spiceLevel):null;return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsx("div",{className:"p-6 border-b border-gray-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:r.name}),a.jsx("button",{onClick:e,className:"p-1 text-gray-400 hover:text-gray-600",children:a.jsx(qr,{className:"w-5 h-5"})})]})}),a.jsxs("div",{className:"p-6",children:[r.image&&a.jsx("img",{src:r.image,alt:r.name,className:"w-full h-64 object-cover rounded-lg mb-6"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Basic Information"}),a.jsxs("div",{className:"space-y-2 text-sm",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Price:"}),a.jsx("span",{className:"font-medium",children:Ue(r.price)})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Category:"}),a.jsx("span",{className:"font-medium",children:r.category})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Status:"}),a.jsx("span",{className:`font-medium ${r.isAvailable?"text-green-600":"text-red-600"}`,children:r.isAvailable?"Available":"Unavailable"})]}),r.preparationTime&&a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Prep Time:"}),a.jsxs("span",{className:"font-medium",children:[r.preparationTime," min"]})]})]})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Dietary Information"}),a.jsxs("div",{className:"flex flex-wrap gap-2",children:[r.isVegetarian&&a.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-xs rounded",children:" Vegetarian"}),r.isVegan&&a.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-xs rounded",children:" Vegan"}),r.isGlutenFree&&a.jsx("span",{className:"px-2 py-1 bg-yellow-100 text-yellow-800 text-xs rounded",children:" Gluten Free"}),n&&a.jsxs("span",{className:"px-2 py-1 bg-red-100 text-red-800 text-xs rounded",children:[n.icon," ",n.label]})]})]})]}),r.description&&a.jsxs("div",{className:"mb-6",children:[a.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Description"}),a.jsx("p",{className:"text-gray-600",children:r.description})]}),r.allergens&&r.allergens.length>0&&a.jsxs("div",{className:"mb-6",children:[a.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Allergens"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:r.allergens.map((i,o)=>a.jsx("span",{className:"px-2 py-1 bg-orange-100 text-orange-800 text-xs rounded",children:i},o))})]}),r.variants&&r.variants.length>0&&a.jsxs("div",{className:"mb-6",children:[a.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Available Variants"}),a.jsx("div",{className:"space-y-3",children:r.variants.map(i=>a.jsxs("div",{className:"border border-gray-200 rounded-lg p-3",children:[a.jsxs("h4",{className:"font-medium text-gray-900 mb-2",children:[i.name,i.required&&a.jsx("span",{className:"text-red-500 ml-1",children:"*"}),a.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:["(",i.type==="single"?"Single Choice":"Multiple Choice",")"]})]}),a.jsx("div",{className:"grid grid-cols-2 gap-2",children:i.options.map(o=>a.jsxs("div",{className:"flex justify-between items-center text-sm",children:[a.jsxs("span",{className:"text-gray-700",children:[o.name,o.isDefault&&i.type==="single"&&a.jsx("span",{className:"text-blue-600 ml-1",children:"(Default)"})]}),a.jsxs("div",{className:"flex flex-col items-end",children:[a.jsxs("span",{className:"text-gray-600",children:[o.pricingType==="standalone"?"":o.priceModifier>0&&"+",o.priceModifier!==0&&Ue(o.priceModifier)]}),a.jsx("span",{className:"text-xs text-gray-500",children:o.pricingType==="standalone"?"Standalone":"Additive"})]})]},o.id))})]},i.id))})]}),a.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[a.jsx("button",{onClick:e,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Close"}),a.jsxs("button",{onClick:s,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[a.jsx(gc,{className:"w-4 h-4 mr-2 inline"}),"Edit Item"]})]})]})]})})}function Z_(t){const e={none:{label:"No Spice",icon:""},mild:{label:"Mild",icon:""},medium:{label:"Medium",icon:""},hot:{label:"Hot",icon:""},very_hot:{label:"Very Hot",icon:""}};return e[t]||e.none}class Ja{static async createInventoryItem(e,r){try{const s=An(),n={id:s,...e,createdAt:new Date,updatedAt:new Date},i=Rt(st,"restaurants",e.restaurantId,this.INVENTORY_COLLECTION,s),o=this.cleanInventoryData({...n,createdAt:wt.fromDate(n.createdAt),updatedAt:wt.fromDate(n.updatedAt),lastRestockedAt:n.lastRestockedAt?wt.fromDate(n.lastRestockedAt):null});if(await LA(i,o),console.log(" Inventory item created:",n.id),n.currentQuantity>0){const l=r||"system";await this.recordTransaction({inventoryItemId:n.id,menuItemId:n.menuItemId,restaurantId:n.restaurantId,type:"restock",quantityChanged:n.currentQuantity,previousQuantity:0,newQuantity:n.currentQuantity,reason:"Initial stock setup",notes:"Inventory item created with initial stock",staffId:l})}return{success:!0,data:n,message:"Inventory item created successfully"}}catch(s){return console.error(" Failed to create inventory item:",s),{success:!1,error:Xt(s)}}}static async getInventoryByMenuItemId(e,r){try{const s=Zt(Jt(st,"restaurants",r,this.INVENTORY_COLLECTION),Yt("menuItemId","==",e)),n=await ur(s);return n.empty?{success:!0,data:null}:{success:!0,data:this.convertFirestoreInventoryItem(n.docs[0].data(),n.docs[0].id)}}catch(s){return console.error(" Failed to get inventory by menu item ID:",s),{success:!1,error:Xt(s)}}}static async getInventoryForRestaurant(e){try{const r=Zt(Jt(st,"restaurants",e,this.INVENTORY_COLLECTION),On("createdAt","desc"));return{success:!0,data:(await ur(r)).docs.map(i=>this.convertFirestoreInventoryItem(i.data(),i.id))}}catch(r){return console.error(" Failed to get inventory for restaurant:",r),{success:!1,error:Xt(r)}}}static async updateInventoryItem(e,r,s,n,i=!1){try{const o=Rt(st,"restaurants",r,this.INVENTORY_COLLECTION,e);let l=null,c=!1;if((s.currentQuantity!==void 0||n)&&!i){const A=await this.getInventoryById(e,r);A.success&&A.data&&(l=A.data,s.currentQuantity!==void 0&&s.currentQuantity!==l.currentQuantity&&(c=!0))}const d={...s,updatedAt:wt.now()};s.lastRestockedAt&&(d.lastRestockedAt=wt.fromDate(s.lastRestockedAt)),s.linkedItems&&(d.linkedItems=s.linkedItems.map(A=>({...A,createdAt:A.createdAt instanceof Date?wt.fromDate(A.createdAt):A.createdAt,updatedAt:A.updatedAt instanceof Date?wt.fromDate(A.updatedAt):A.updatedAt}))),Object.keys(d).forEach(A=>{d[A]===void 0&&delete d[A]}),await Xr(o,d);const u=await this.getInventoryById(e,r);if(u.success&&u.data){if(console.log(" Inventory item updated:",e),c&&l&&n&&s.currentQuantity!==void 0){const A=s.currentQuantity-l.currentQuantity;let h="manual_adjustment",f="Inventory quantity updated";A>0?(h="restock",f="Inventory restocked"):A<0&&(h="manual_adjustment",f="Inventory adjusted down");const p=await this.recordTransaction({inventoryItemId:e,menuItemId:l.menuItemId,restaurantId:r,type:h,quantityChanged:A,previousQuantity:l.currentQuantity,newQuantity:s.currentQuantity,reason:f,notes:"Updated via inventory edit",staffId:n});p.success?console.log(" Transaction recorded for inventory update:",A):console.error(" Failed to record transaction for inventory update:",p.error)}return u}return{success:!1,error:"Failed to get updated inventory item"}}catch(o){return console.error(" Failed to update inventory item:",o),{success:!1,error:Xt(o)}}}static async getInventoryById(e,r){try{const s=Rt(st,"restaurants",r,this.INVENTORY_COLLECTION,e),n=await Kr(s);return n.exists()?{success:!0,data:this.convertFirestoreInventoryItem(n.data(),n.id)}:{success:!1,error:"Inventory item not found"}}catch(s){return console.error(" Failed to get inventory by ID:",s),{success:!1,error:Xt(s)}}}static async deleteInventoryItem(e,r){try{const s=Rt(st,"restaurants",r,this.INVENTORY_COLLECTION,e);return await Pl(s),console.log(" Inventory item deleted:",e),{success:!0,message:"Inventory item deleted successfully"}}catch(s){return console.error(" Failed to delete inventory item:",s),{success:!1,error:Xt(s)}}}static async recordTransaction(e){try{const r=An(),s={id:r,...e,createdAt:new Date},n=Rt(st,"restaurants",e.restaurantId,this.TRANSACTIONS_COLLECTION,r),i=this.cleanInventoryData({...s,createdAt:wt.fromDate(s.createdAt)});return await LA(n,i),console.log(" Inventory transaction recorded:",s.type,s.quantityChanged),{success:!0,data:s,message:"Transaction recorded successfully"}}catch(r){return console.error(" Failed to record inventory transaction:",r),{success:!1,error:Xt(r)}}}static async adjustInventoryQuantity(e,r,s,n,i,o,l){try{const c=await this.getInventoryById(e,r);if(!c.success||!c.data)return{success:!1,error:c.error||"Inventory item not found"};const d=c.data,u=s-d.currentQuantity,A={currentQuantity:s};n==="restock"&&(A.lastRestockedAt=new Date,A.lastRestockedQuantity=u);const h=await this.updateInventoryItem(e,r,A,void 0,!0);if(!h.success||!h.data)return{success:!1,error:h.error||"Failed to update inventory"};const f=await this.recordTransaction({inventoryItemId:e,menuItemId:d.menuItemId,restaurantId:r,type:n,quantityChanged:u,previousQuantity:d.currentQuantity,newQuantity:s,reason:o,notes:l,staffId:i});if(!f.success||!f.data)return{success:!1,error:f.error||"Failed to record transaction"};if(d.baseInventoryId&&d.baseRatio&&u!==0){const p=await this.getInventoryById(d.baseInventoryId,r);if(p.success&&p.data){const m=p.data,g=u*d.baseRatio,y=Math.max(0,m.currentQuantity+g);console.log(` Reverse link adjustment: ${u}  ${d.baseRatio} = ${g} change to base inventory`),(await this.updateInventoryItem(d.baseInventoryId,r,{currentQuantity:y},void 0,!0)).success&&(await this.recordTransaction({inventoryItemId:d.baseInventoryId,menuItemId:m.menuItemId,restaurantId:r,type:"manual_adjustment",quantityChanged:g,previousQuantity:m.currentQuantity,newQuantity:y,reason:`Reverse link adjustment from ${d.menuItemId} (ratio: ${d.baseRatio})`,notes:`Triggered by adjustment to linked item: ${o||"Manual adjustment"}`,staffId:i}),console.log(` Updated base inventory via reverse link: ${m.currentQuantity}  ${y}`))}}if(d.linkedItems&&d.linkedItems.length>0&&u!==0)for(const p of d.linkedItems){if(!p.isActive)continue;const m=await this.getInventoryByMenuItemId(p.linkedInventoryId,r);if(!m.success||!m.data){console.log(` Linked inventory not found for menuItemId: ${p.linkedInventoryId}`);continue}const g=m.data,y=u*p.ratio,v=Math.max(0,g.currentQuantity+y);console.log(` Forward link adjustment: ${u}  ${p.ratio} = ${y} change to linked item`),(await this.updateInventoryItem(p.linkedInventoryId,r,{currentQuantity:v},void 0,!0)).success&&(await this.recordTransaction({inventoryItemId:p.linkedInventoryId,menuItemId:g.menuItemId,restaurantId:r,type:"manual_adjustment",quantityChanged:y,previousQuantity:g.currentQuantity,newQuantity:v,reason:`Forward link adjustment from ${d.menuItemId} (ratio: ${p.ratio})`,notes:`Triggered by adjustment to base item: ${o||"Manual adjustment"}`,staffId:i}),console.log(` Updated linked inventory via forward link: ${g.currentQuantity}  ${v}`))}return await this.checkAndCreateAlerts(h.data),{success:!0,data:{inventory:h.data,transaction:f.data},message:"Inventory adjusted successfully"}}catch(c){return console.error(" Failed to adjust inventory quantity:",c),{success:!1,error:Xt(c)}}}static async deductInventoryForOrder(e,r,s,n){var i;try{const o=[],l=jl(st);for(const c of r){console.log(` Processing order item: ${c.menuItemId}, quantity: ${c.quantity}`);const d=await this.getInventoryByMenuItemId(c.menuItemId,s);if(!d.success||!d.data){console.log(" No inventory tracking for menu item:",c.menuItemId);continue}const u=d.data;if(!u.autoDeduct||!u.isTracked)continue;const A=u.consumptionPerOrder*c.quantity,h=Math.max(0,u.currentQuantity-A),f=Rt(st,"restaurants",s,this.INVENTORY_COLLECTION,u.id);l.update(f,{currentQuantity:h,updatedAt:wt.now()});const p=An(),m={id:p,inventoryItemId:u.id,menuItemId:c.menuItemId,restaurantId:s,type:"order_deduction",quantityChanged:-A,previousQuantity:u.currentQuantity,newQuantity:h,orderId:e,staffId:n,createdAt:new Date},g=Rt(st,"restaurants",s,this.TRANSACTIONS_COLLECTION,p);if(l.set(g,{...m,createdAt:wt.fromDate(m.createdAt)}),o.push(m),u.linkedItems&&u.linkedItems.length>0){console.log(` Processing ${u.linkedItems.length} linked items for ${c.menuItemId}`),console.log(" Linked items:",u.linkedItems.map(y=>({name:y.linkedMenuItemName,ratio:y.ratio,reverseRatio:y.reverseRatio,enableReverseLink:y.enableReverseLink,isActive:y.isActive})));for(const y of u.linkedItems){if(!y.isActive){console.log(` Skipping inactive linked item: ${y.linkedMenuItemName}`);continue}const v=await this.getInventoryByMenuItemId(y.linkedInventoryId,s);if(!v.success||!v.data){console.log(` Linked inventory not found for menuItemId: ${y.linkedInventoryId}`);continue}const x=v.data,E=A*y.ratio,T=Math.max(0,x.currentQuantity-E),j=Rt(st,"restaurants",s,this.INVENTORY_COLLECTION,x.id);l.update(j,{currentQuantity:T,updatedAt:wt.now()});const C=An(),w={id:C,inventoryItemId:x.id,menuItemId:x.menuItemId,restaurantId:s,type:"order_deduction",quantityChanged:-E,previousQuantity:x.currentQuantity,newQuantity:T,orderId:e,staffId:n,reason:`Linked deduction from ${c.menuItemId} (ratio: ${y.ratio})`,createdAt:new Date},S=Rt(st,"restaurants",s,this.TRANSACTIONS_COLLECTION,C);l.set(S,{...w,createdAt:wt.fromDate(w.createdAt)}),o.push(w)}}if(u.baseInventoryId&&u.baseRatio){console.log(` Processing reverse link for base inventory: ${u.baseInventoryId}`);const y=await this.getInventoryById(u.baseInventoryId,s);if(y.success&&y.data){const v=y.data,x=(i=v.linkedItems)==null?void 0:i.find(E=>E.linkedInventoryId===u.id&&E.enableReverseLink);if(x){const E=A*(x.reverseRatio||1),T=Math.max(0,v.currentQuantity-E),j=Rt(st,"restaurants",s,this.INVENTORY_COLLECTION,v.id);l.update(j,{currentQuantity:T,updatedAt:wt.now()});const C=An(),w={id:C,inventoryItemId:v.id,menuItemId:v.menuItemId,restaurantId:s,type:"order_deduction",quantityChanged:-E,previousQuantity:v.currentQuantity,newQuantity:T,orderId:e,staffId:n,reason:`Reverse linked deduction from ${c.menuItemId} (reverse ratio: ${x.reverseRatio||1})`,createdAt:new Date},S=Rt(st,"restaurants",s,this.TRANSACTIONS_COLLECTION,C);l.set(S,{...w,createdAt:wt.fromDate(w.createdAt)}),o.push(w)}}}}return await l.commit(),{success:!0,data:o,message:"Inventory deducted successfully with linked items"}}catch(o){return console.error(" Failed to deduct inventory for order:",o),{success:!1,error:Xt(o)}}}static async getTransactionHistory(e,r){try{const s=Zt(Jt(st,"restaurants",r,this.TRANSACTIONS_COLLECTION),Yt("inventoryItemId","==",e),On("createdAt","desc"),Wi(50));return{success:!0,data:(await ur(s)).docs.map(o=>this.convertFirestoreTransaction(o.data(),o.id))}}catch(s){return console.error(" Failed to get transaction history:",s),{success:!1,error:Xt(s)}}}static async getLowStockItems(e){try{const r=await this.getInventoryForRestaurant(e);return!r.success||!r.data?r:{success:!0,data:r.data.filter(n=>n.isTracked&&n.currentQuantity<=n.minimumThreshold)}}catch(r){return console.error(" Failed to get low stock items:",r),{success:!1,error:Xt(r)}}}static async checkAndCreateAlerts(e){try{if(!e.isTracked)return;let r=null,s="low",n="";if(e.currentQuantity===0?(r="out_of_stock",s="critical",n=`${e.menuItemId} is out of stock`):e.currentQuantity<=e.minimumThreshold?(r="low_stock",s=e.currentQuantity<=e.minimumThreshold*.5?"high":"medium",n=`${e.menuItemId} is running low (${e.currentQuantity} ${e.unit} remaining)`):e.maxCapacity&&e.currentQuantity>e.maxCapacity&&(r="overstocked",s="low",n=`${e.menuItemId} is overstocked`),r){const i=An(),o={id:i,inventoryItemId:e.id,menuItemId:e.menuItemId,restaurantId:e.restaurantId,type:r,message:n,severity:s,isRead:!1,createdAt:new Date},l=Rt(st,"restaurants",e.restaurantId,this.ALERTS_COLLECTION,i),c=this.cleanInventoryData({...o,createdAt:wt.fromDate(o.createdAt)});await LA(l,c)}}catch(r){console.error("Failed to create inventory alert:",r)}}static convertFirestoreInventoryItem(e,r){var s,n,i;return{id:r,menuItemId:e.menuItemId,restaurantId:e.restaurantId,currentQuantity:e.currentQuantity,unit:e.unit,customUnit:e.customUnit,minimumThreshold:e.minimumThreshold,consumptionPerOrder:e.consumptionPerOrder,maxCapacity:e.maxCapacity,costPerUnit:e.costPerUnit,supplier:e.supplier,lastRestockedAt:(s=e.lastRestockedAt)==null?void 0:s.toDate(),lastRestockedQuantity:e.lastRestockedQuantity,isTracked:e.isTracked,autoDeduct:e.autoDeduct,linkedItems:e.linkedItems?e.linkedItems.map(o=>{var l,c;return{id:o.id,linkedInventoryId:o.linkedInventoryId,linkedMenuItemId:o.linkedMenuItemId,linkedMenuItemName:o.linkedMenuItemName,ratio:o.ratio,reverseRatio:o.reverseRatio,enableReverseLink:o.enableReverseLink,isActive:o.isActive,createdAt:((l=o.createdAt)==null?void 0:l.toDate())||new Date,updatedAt:((c=o.updatedAt)==null?void 0:c.toDate())||new Date}}):void 0,baseInventoryId:e.baseInventoryId,baseRatio:e.baseRatio,isBaseInventory:e.isBaseInventory,reverseLinksEnabled:e.reverseLinksEnabled,isStandaloneItem:e.isStandaloneItem,displayName:e.displayName,standaloneItemName:e.standaloneItemName,createdAt:((n=e.createdAt)==null?void 0:n.toDate())||new Date,updatedAt:((i=e.updatedAt)==null?void 0:i.toDate())||new Date}}static async createInitialTransactionForInventory(e,r,s){try{const n=await this.getInventoryById(e,r);if(!n.success||!n.data)return{success:!1,error:"Inventory item not found"};const i=n.data,o=await this.getTransactionHistory(e,r);return o.success&&o.data&&o.data.length>0?{success:!0,data:null,message:"Transactions already exist for this inventory item"}:i.currentQuantity>0?await this.recordTransaction({inventoryItemId:i.id,menuItemId:i.menuItemId,restaurantId:i.restaurantId,type:"restock",quantityChanged:i.currentQuantity,previousQuantity:0,newQuantity:i.currentQuantity,reason:"Initial stock entry",notes:"Historical stock data - created during transaction system implementation",staffId:s}):{success:!0,data:null,message:"No initial transaction needed - inventory quantity is 0"}}catch(n){return console.error(" Failed to create initial transaction:",n),{success:!1,error:Xt(n)}}}static convertFirestoreTransaction(e,r){var s;return{id:r,inventoryItemId:e.inventoryItemId,menuItemId:e.menuItemId,restaurantId:e.restaurantId,type:e.type,quantityChanged:e.quantityChanged,previousQuantity:e.previousQuantity,newQuantity:e.newQuantity,reason:e.reason,notes:e.notes,orderId:e.orderId,staffId:e.staffId,createdAt:((s=e.createdAt)==null?void 0:s.toDate())||new Date}}static async fixLinkedInventoryIds(e){try{console.log(" Starting to fix linked inventory IDs...");const r=await this.getInventoryForRestaurant(e);if(!r.success||!r.data)return{success:!1,error:"Failed to get inventory items"};const s=r.data;let n=0,i=0;for(const o of s){if(!o.linkedItems||o.linkedItems.length===0)continue;let l=!1;const c=[...o.linkedItems];for(let d=0;d<c.length;d++){const u=c[d];i++;const A=s.find(h=>h.menuItemId===u.linkedMenuItemId);A&&A.id!==u.linkedInventoryId&&(console.log(` Fixing linked inventory ID: ${u.linkedMenuItemName}`),console.log(`   Old ID: ${u.linkedInventoryId}`),console.log(`   New ID: ${A.id}`),c[d]={...u,linkedInventoryId:A.id,updatedAt:new Date},l=!0,n++)}l&&((await this.updateInventoryItem(o.id,e,{linkedItems:c},"system",!0)).success?console.log(` Updated inventory: ${o.menuItemId}`):console.error(` Failed to update inventory: ${o.menuItemId}`))}return console.log(` Finished fixing linked inventory IDs: ${n}/${i} fixed`),{success:!0,data:{fixed:n,total:i},message:`Fixed ${n} out of ${i} linked inventory IDs`}}catch(r){return console.error(" Failed to fix linked inventory IDs:",r),{success:!1,error:Xt(r)}}}static async enableAutoDeductForAll(e){try{const r=await this.getInventoryForRestaurant(e);if(!r.success||!r.data)return{success:!1,error:"Failed to get inventory items"};const s=r.data;let n=0;for(const i of s)if(!i.autoDeduct||!i.isTracked){const o={};i.autoDeduct||(o.autoDeduct=!0),i.isTracked||(o.isTracked=!0),(await this.updateInventoryItem(i.id,e,o,"system",!0)).success&&n++}return{success:!0,data:{updated:n},message:`Enabled auto-deduct for ${n} inventory items`}}catch(r){return console.error(" Failed to enable auto-deduct for all:",r),{success:!1,error:Xt(r)}}}static cleanInventoryData(e){const r={};for(const s in e)e[s]!==void 0&&(r[s]=e[s]);return r}}Or(Ja,"INVENTORY_COLLECTION","inventory"),Or(Ja,"TRANSACTIONS_COLLECTION","inventoryTransactions"),Or(Ja,"ALERTS_COLLECTION","inventoryAlerts");const Mme=Object.freeze(Object.defineProperty({__proto__:null,InventoryService:Ja},Symbol.toStringTag,{value:"Module"}));function tQ({menuItems:t,onSelect:e,onCreateStandalone:r,disabled:s,initialValue:n,placeholder:i,allowStandaloneCreation:o=!1}){const[l,c]=R.useState(""),[d,u]=R.useState(!1),[A,h]=R.useState(n||null),[f,p]=R.useState("");R.useEffect(()=>{n&&h(n)},[n]);const m=t.filter(T=>T.name.toLowerCase().includes(l.toLowerCase())||T.price.toString().includes(l)),g=m.some(T=>T.name.toLowerCase()===l.toLowerCase()),y=T=>{h(T),e(T),c(""),u(!1),p("")},v=()=>{h(null),e(null),c(""),u(!0),p("")},x=()=>{l.trim()&&r&&(p(l.trim()),r(l.trim()),h(null),u(!1))},E=o&&l.trim().length>0&&!g&&m.length===0;return a.jsxs("div",{className:"relative",children:[a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"text",value:A?`${A.name} - ${Ue(A.price)}`:f||l,onChange:T=>{!A&&!f&&(c(T.target.value),u(!0))},onFocus:()=>!A&&!f&&u(!0),placeholder:i||"Search menu items...",disabled:s,className:"w-full px-3 py-2 pr-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100 disabled:text-gray-600",readOnly:!!A||!!f}),a.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3",children:A||f?a.jsx("button",{type:"button",onClick:()=>{v(),p("")},disabled:s,className:"text-gray-400 hover:text-gray-600 disabled:hover:text-gray-400",children:a.jsx(qr,{className:"w-4 h-4"})}):a.jsx(sn,{className:"w-4 h-4 text-gray-400"})})]}),f&&a.jsxs("div",{className:"mt-2 p-2 bg-blue-50 border border-blue-200 rounded-lg",children:[a.jsxs("div",{className:"flex items-center text-sm text-blue-700",children:[a.jsx(rs,{className:"w-4 h-4 mr-2"}),a.jsxs("span",{children:["Creating standalone inventory item: ",a.jsx("strong",{children:f})]})]}),a.jsx("p",{className:"text-xs text-blue-600 mt-1",children:"This item won't be linked to your menu items - it's for inventory tracking only."})]}),d&&!s&&!A&&!f&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:m.length>0?m.map(T=>a.jsxs("button",{type:"button",onClick:()=>y(T),className:"w-full px-3 py-2 text-left hover:bg-gray-100 focus:bg-gray-100 focus:outline-none flex items-center justify-between border-b border-gray-100 last:border-b-0",children:[a.jsx("span",{className:"font-medium",children:T.name}),a.jsx("span",{className:"text-sm text-gray-600 font-semibold",children:Ue(T.price)})]},T.id)):a.jsx("div",{className:"px-3 py-4",children:l?a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"text-center text-gray-500 text-sm",children:['No menu items found matching "',l,'"']}),E&&a.jsxs("button",{type:"button",onClick:x,className:"w-full px-3 py-2 bg-blue-50 hover:bg-blue-100 border border-blue-200 rounded-lg transition-colors group",children:[a.jsxs("div",{className:"flex items-center justify-center text-blue-700",children:[a.jsx(zr,{className:"w-4 h-4 mr-2"}),a.jsxs("span",{className:"font-medium",children:['Create inventory item: "',l,'"']})]}),a.jsx("div",{className:"text-xs text-blue-600 mt-1",children:"Create standalone inventory (not linked to menu)"})]})]}):a.jsx("div",{className:"text-gray-500 text-sm text-center",children:"Start typing to search menu items..."})})}),a.jsx("div",{className:"fixed inset-0 z-0",onClick:()=>u(!1)})]})]})}function Qme({isOpen:t,onClose:e,onSave:r,currentInventory:s,currentMenuItem:n,menuItems:i,existingInventory:o,onCreateNewInventory:l}){const[c,d]=R.useState([]),[u,A]=R.useState(!1),[h,f]=R.useState(null),[p,m]=R.useState(1),[g,y]=R.useState(1),[v,x]=R.useState(!1),[E,T]=R.useState(0),[j,C]=R.useState("pieces"),[w,S]=R.useState("");R.useEffect(()=>{var Q;console.log(" LinkItemModal useEffect triggered:",{isOpen:t,currentInventoryLinkedItems:s.linkedItems,currentInventoryLinkedItemsLength:((Q=s.linkedItems)==null?void 0:Q.length)||0,currentLinkedItemsLength:c.length}),t&&c.length===0&&s.linkedItems&&s.linkedItems.length>0?(console.log(" Setting linkedItems from currentInventory:",s.linkedItems),d([...s.linkedItems])):t&&c.length===0&&(!s.linkedItems||s.linkedItems.length===0)&&(console.log(" Setting empty linkedItems array for first time"),d([]))},[t,s.linkedItems]);const F=i.filter(Q=>Q.id!==s.menuItemId&&!c.some(re=>re.linkedMenuItemId===Q.id)),B=Q=>o.some(re=>re.menuItemId===Q),k=()=>{if(!h){console.log("No menu item selected");return}const Q=o.find(G=>G.menuItemId===h.id);if(!Q&&E<=0){console.log("Validation failed: newItemQuantity:",E),alert("Please specify initial stock quantity greater than 0 for this new item");return}if(p<=0){alert("Consumption ratio must be greater than 0");return}if(v&&g<=0){alert("Reverse ratio must be greater than 0");return}const re={id:An(),linkedInventoryId:"",linkedMenuItemId:h.id,linkedMenuItemName:h.name,ratio:p,reverseRatio:g,enableReverseLink:v,isActive:!0,createdAt:new Date,updatedAt:new Date};if(Q){re.linkedInventoryId=Q.id;const G=[...c,re];console.log(" Setting new linkedItems with existing inventory:",G),d(G),console.log("Added linked item with existing inventory:",re)}else{re.linkedInventoryId="new_"+h.id;const G=[...c,re];console.log(" Setting new linkedItems with new inventory:",G),d(G),l(h,E,j,w),console.log("Added linked item with new inventory:",re)}f(null),m(1),y(1),x(!1),T(0),C("pieces"),S(""),A(!1)},D=Q=>{d(c.filter(re=>re.id!==Q))},q=(Q,re,G)=>{d(c.map(Ae=>Ae.id===Q?{...Ae,[re]:G,updatedAt:new Date}:Ae))},te=()=>{r(c),e()};if(!t)return null;const W=[{value:"pieces",label:"Pieces"},{value:"ml",label:"Milliliters (ml)"},{value:"liters",label:"Liters"},{value:"grams",label:"Grams (g)"},{value:"kg",label:"Kilograms (kg)"},{value:"cups",label:"Cups"},{value:"portions",label:"Portions"},{value:"bottles",label:"Bottles"},{value:"cans",label:"Cans"},{value:"custom",label:"Custom Unit"}];return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-[60]",children:a.jsxs("div",{className:"bg-white rounded-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsx("div",{className:"p-6 border-b border-gray-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs("h2",{className:"text-xl font-semibold text-gray-900 flex items-center",children:[a.jsx(Qw,{className:"w-5 h-5 mr-2 text-blue-600"}),"Link Inventory Items"]}),a.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Link items that share the same base inventory: ",a.jsx("strong",{children:n.name})]})]}),a.jsx("button",{onClick:e,className:"p-1 text-gray-400 hover:text-gray-600",children:a.jsx(qr,{className:"w-5 h-5"})})]})}),a.jsxs("div",{className:"p-6 space-y-6",children:[a.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[a.jsx("h3",{className:"font-medium text-blue-900 mb-2",children:"How Inventory Linking Works"}),a.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[a.jsx("li",{children:" Link items that use the same base ingredient (e.g., 30ml and 60ml drinks from same bottle)"}),a.jsx("li",{children:" Set consumption ratios: when 1x 60ml is ordered, it consumes 2x worth of 30ml equivalent"}),a.jsx("li",{children:" Enable reverse linking to sync both ways"}),a.jsx("li",{children:" Add new items directly from this interface"})]})]}),c.length>0&&a.jsxs("div",{children:[a.jsxs("h3",{className:"font-medium text-gray-900 mb-3",children:["Linked Items (",c.length,")"]}),a.jsx("div",{className:"space-y-3",children:c.map(Q=>a.jsx("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("div",{className:"flex-1",children:a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:a.jsx(rs,{className:"w-5 h-5 text-green-600"})}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-gray-900",children:Q.linkedMenuItemName}),a.jsxs("p",{className:"text-sm text-gray-600",children:["Ratio: 1x ",n.name," = ",Q.ratio,"x ",Q.linkedMenuItemName]})]})]})}),a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("label",{className:"text-sm text-gray-600",children:"Ratio:"}),a.jsx("input",{type:"number",value:Q.ratio,onChange:re=>q(Q.id,"ratio",parseFloat(re.target.value)||0),step:"0.1",min:"0.1",className:"w-20 px-2 py-1 border border-gray-300 rounded text-sm"})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("label",{className:"text-sm text-gray-600",children:"Reverse:"}),a.jsx("button",{onClick:()=>q(Q.id,"enableReverseLink",!Q.enableReverseLink),className:"flex items-center",children:Q.enableReverseLink?a.jsx(are,{className:"w-5 h-5 text-green-600"}):a.jsx(nre,{className:"w-5 h-5 text-gray-400"})})]}),Q.enableReverseLink&&a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("label",{className:"text-sm text-gray-600",children:"Rev Ratio:"}),a.jsx("input",{type:"number",value:Q.reverseRatio||1,onChange:re=>q(Q.id,"reverseRatio",parseFloat(re.target.value)||0),step:"0.1",min:"0.1",className:"w-20 px-2 py-1 border border-gray-300 rounded text-sm"})]}),a.jsx("button",{onClick:()=>D(Q.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",title:"Remove linked item",children:a.jsx(Un,{className:"w-4 h-4"})})]})]})},Q.id))})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("h3",{className:"font-medium text-gray-900",children:"Add Linked Item"}),!u&&a.jsxs("button",{onClick:()=>A(!0),className:"flex items-center space-x-2 px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[a.jsx(zr,{className:"w-4 h-4"}),a.jsx("span",{children:"Add Link"})]})]}),u&&a.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Menu Item *"}),a.jsx(tQ,{menuItems:F,onSelect:f,placeholder:"Search available menu items..."})]}),h&&a.jsxs(a.Fragment,{children:[!B(h.id)&&a.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:[a.jsxs("p",{className:"text-sm text-yellow-800 mb-3",children:[a.jsx("strong",{children:h.name})," doesn't have inventory yet. You can create it now:"]}),a.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Initial Quantity *"}),a.jsx("input",{type:"number",value:E,onChange:Q=>T(parseFloat(Q.target.value)||0),step:"0.1",min:"0.1",className:`w-full px-2 py-1 border rounded text-sm ${E<=0?"border-red-300 bg-red-50 focus:border-red-500 focus:ring-red-500":"border-gray-300 focus:border-blue-500 focus:ring-blue-500"}`,placeholder:"Enter quantity > 0"}),E<=0&&a.jsx("p",{className:"text-xs text-red-600 mt-1",children:"Quantity must be greater than 0"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Unit *"}),a.jsx("select",{value:j,onChange:Q=>C(Q.target.value),className:"w-full px-2 py-1 border border-gray-300 rounded text-sm",children:W.map(Q=>a.jsx("option",{value:Q.value,children:Q.label},Q.value))})]}),j==="custom"&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Custom Unit *"}),a.jsx("input",{type:"text",value:w,onChange:Q=>S(Q.target.value),className:"w-full px-2 py-1 border border-gray-300 rounded text-sm",placeholder:"Unit name"})]})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Consumption Ratio *"}),a.jsx("input",{type:"number",value:p,onChange:Q=>m(parseFloat(Q.target.value)||1),step:"0.1",min:"0.1",className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"1.0"}),a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["When 1x ",n.name," is consumed, how much of ",h.name," equivalent is consumed?"]})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"flex items-center space-x-2 mb-2",children:[a.jsx("input",{type:"checkbox",checked:v,onChange:Q=>x(Q.target.checked),className:"rounded"}),a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Enable Reverse Link"})]}),v&&a.jsx("input",{type:"number",value:g,onChange:Q=>y(parseFloat(Q.target.value)||1),step:"0.1",min:"0.1",className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"1.0"}),v&&a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["When 1x ",h.name," is consumed, how much of ",n.name," equivalent is consumed?"]})]})]}),a.jsxs("div",{className:"flex justify-end space-x-3",children:[a.jsx("button",{onClick:()=>{A(!1),f(null),m(1),y(1),x(!1),T(0),C("pieces"),S("")},className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200",children:"Cancel"}),a.jsx("button",{onClick:k,disabled:!h||p<=0||!B((h==null?void 0:h.id)||"")&&E<=0||v&&g<=0,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",title:h?p<=0?"Consumption ratio must be greater than 0":!B((h==null?void 0:h.id)||"")&&E<=0?"Please specify initial quantity greater than 0":v&&g<=0?"Reverse ratio must be greater than 0":"Add this item as a linked inventory":"Please select a menu item",children:"Add Link"})]})]})]})]})]}),a.jsx("div",{className:"px-6 py-4 border-t border-gray-200 bg-gray-50",children:a.jsxs("div",{className:"flex justify-end space-x-3",children:[a.jsx("button",{onClick:e,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200",children:"Cancel"}),a.jsxs("button",{onClick:te,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[a.jsx(au,{className:"w-4 h-4 mr-2 inline"}),"Save Links"]})]})})]})})}function Vme({isOpen:t,onClose:e,onSave:r,inventory:s,menuItems:n,existingInventory:i,register:o,handleSubmit:l,setValue:c,selectedUnit:d,isSubmitting:u}){const{user:A}=ia(),[h,f]=R.useState(null),[p,m]=R.useState(!1),[g,y]=R.useState([]),[v,x]=R.useState(!1),[E,T]=R.useState("");R.useEffect(()=>{if(s){if(x(!s.menuItemId),!s.menuItemId)T(s.displayName||s.id||"");else{const D=n.find(q=>q.id===s.menuItemId);f(D||null),T("")}y(s.linkedItems||[])}else x(!1),f(null),T(""),y([])},[s,n]);const j=n.filter(D=>!i.some(q=>q.menuItemId===D.id&&q.id!==(s==null?void 0:s.id))),C=D=>{f(D),x(!1),T(""),D?c("menuItemId",D.id):c("menuItemId","")},w=D=>{x(!0),T(D),f(null),c("menuItemId","")},S=D=>{if(console.log(" Form submission:",{data:D,isStandaloneItem:v,standaloneItemName:E,selectedMenuItem:h}),!v&&!h){alert("Please select a menu item or create a standalone inventory item");return}if(v&&!E.trim()){alert("Please provide a name for the standalone inventory item");return}const q={...D,linkedItems:g,isStandaloneItem:v,standaloneItemName:v?E:void 0,menuItemId:v?null:h==null?void 0:h.id};console.log(" Submitting inventory data:",q),r(q)},F=D=>{console.log(" LinkItems received:",D),y(D),m(!1)},B=(D,q,te,W)=>{console.log("Creating new linked inventory:",{menuItem:D,quantity:q,unit:te,customUnit:W}),m(!1)},k=()=>g.length?a.jsxs("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg",children:[a.jsxs("h4",{className:"text-sm font-medium text-gray-900 mb-2 flex items-center",children:[a.jsx(Qw,{className:"w-4 h-4 mr-2"}),"Linked Items (",g.length,")"]}),a.jsxs("div",{className:"space-y-2",children:[g.slice(0,3).map(D=>a.jsxs("div",{className:"flex items-center justify-between text-sm",children:[a.jsx("span",{className:"text-gray-700",children:D.linkedMenuItemName}),a.jsxs("span",{className:"text-gray-500",children:["Ratio: 1:",D.ratio]})]},D.id)),g.length>3&&a.jsxs("div",{className:"text-xs text-gray-500",children:["+",g.length-3," more items"]})]})]}):null;return t?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsx("div",{className:"p-6 border-b border-gray-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:s?"Edit Inventory Item":"Add New Inventory Item"}),a.jsx("button",{type:"button",onClick:e,className:"text-gray-400 hover:text-gray-600",children:a.jsx(qr,{className:"w-6 h-6"})})]})}),a.jsxs("form",{onSubmit:l(S),className:"p-6 space-y-6",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[v?"Inventory Item Name":"Menu Item",a.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),!s&&a.jsx(tQ,{menuItems:j,onSelect:C,onCreateStandalone:w,initialValue:h,allowStandaloneCreation:!0,placeholder:"Search menu items or type to create standalone item..."}),s&&v&&a.jsxs("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[a.jsxs("div",{className:"flex items-center text-sm text-blue-700",children:[a.jsx(rs,{className:"w-4 h-4 mr-2"}),a.jsxs("span",{children:["Standalone inventory item: ",a.jsx("strong",{children:E})]})]}),a.jsx("p",{className:"text-xs text-blue-600 mt-1",children:"This item is not linked to any menu items - it's for inventory tracking only."})]}),s&&!v&&h&&a.jsxs("div",{className:"p-3 bg-green-50 border border-green-200 rounded-lg",children:[a.jsxs("div",{className:"flex items-center text-sm text-green-700",children:[a.jsx(rs,{className:"w-4 h-4 mr-2"}),a.jsxs("span",{children:["Linked to menu item: ",a.jsx("strong",{children:h.name})]})]}),a.jsxs("p",{className:"text-xs text-green-600 mt-1",children:["Price: ",Ue(h.price)]})]}),a.jsx("input",{type:"hidden",...o("menuItemId")})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"form-label",children:["Current Quantity ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"number",step:"0.01",min:"0",...o("currentQuantity",{required:"Current quantity is required",min:{value:0,message:"Quantity cannot be negative"}}),className:"input",placeholder:"Enter current stock quantity"})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"form-label",children:["Unit ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("select",{...o("unit",{required:"Unit is required"}),className:"input",children:[a.jsx("option",{value:"",children:"Select Unit"}),a.jsx("option",{value:"pieces",children:"Pieces"}),a.jsx("option",{value:"kg",children:"Kilograms (kg)"}),a.jsx("option",{value:"grams",children:"Grams (g)"}),a.jsx("option",{value:"liters",children:"Liters (L)"}),a.jsx("option",{value:"ml",children:"Milliliters (ml)"}),a.jsx("option",{value:"cups",children:"Cups"}),a.jsx("option",{value:"portions",children:"Portions"}),a.jsx("option",{value:"bottles",children:"Bottles"}),a.jsx("option",{value:"cans",children:"Cans"}),a.jsx("option",{value:"custom",children:"Custom Unit"})]})]}),d==="custom"&&a.jsxs("div",{className:"md:col-span-2",children:[a.jsxs("label",{className:"form-label",children:["Custom Unit ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",...o("customUnit",{required:d==="custom"?"Custom unit name is required":!1}),className:"input",placeholder:"Enter custom unit (e.g., boxes, packets, trays)"})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"form-label",children:["Minimum Threshold ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"number",step:"0.01",min:"0",...o("minimumThreshold",{required:"Minimum threshold is required",min:{value:0,message:"Threshold cannot be negative"}}),className:"input",placeholder:"Alert when stock falls below this level"})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"form-label",children:["Consumption Per Order ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"number",step:"0.01",min:"0",...o("consumptionPerOrder",{required:"Consumption per order is required",min:{value:0,message:"Consumption cannot be negative"}}),className:"input",placeholder:"How much is used per order"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"form-label",children:"Max Capacity (Optional)"}),a.jsx("input",{type:"number",step:"0.01",min:"0",...o("maxCapacity"),className:"input",placeholder:"Maximum storage capacity"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"form-label",children:"Cost Per Unit (Optional)"}),a.jsx("input",{type:"number",step:"0.01",min:"0",...o("costPerUnit"),className:"input",placeholder:"Cost price per unit"})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"form-label",children:"Supplier (Optional)"}),a.jsx("input",{type:"text",...o("supplier"),className:"input",placeholder:"Enter supplier name"})]})]}),a.jsxs("div",{className:"border-t pt-6",children:[a.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-4",children:"Tracking Settings"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[a.jsxs("div",{children:[a.jsx("h5",{className:"text-sm font-medium text-gray-900",children:"Enable Inventory Tracking"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Track stock levels and receive low stock alerts"})]}),a.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[a.jsx("input",{type:"checkbox",...o("isTracked"),className:"sr-only peer"}),a.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),a.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[a.jsxs("div",{children:[a.jsx("h5",{className:"text-sm font-medium text-gray-900",children:"Auto-Deduct from Orders"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Automatically reduce stock when orders are placed"})]}),a.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[a.jsx("input",{type:"checkbox",...o("autoDeduct"),className:"sr-only peer"}),a.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]})]})]}),h&&!v&&a.jsxs("div",{className:"border-t pt-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"text-lg font-medium text-gray-900",children:"Inventory Linking"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Link this inventory to other menu items for automatic stock management"})]}),a.jsxs("button",{type:"button",onClick:()=>m(!0),className:"btn btn-secondary flex items-center",children:[a.jsx(Qw,{className:"w-4 h-4 mr-2"}),g.length>0?"Manage Links":"Add Links"]})]}),k()]}),a.jsxs("div",{className:"flex items-center justify-end space-x-3 pt-6 border-t",children:[a.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 disabled:opacity-50",disabled:u,children:"Cancel"}),a.jsxs("button",{type:"submit",disabled:u,className:"btn btn-theme-primary flex items-center disabled:opacity-50",children:[u?a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}):a.jsx(au,{className:"w-4 h-4 mr-2"}),u?"Saving...":s?"Update Inventory":"Create Inventory"]})]})]})]})}),p&&h&&a.jsx(Qme,{isOpen:p,onClose:()=>m(!1),onSave:F,currentInventory:s||{},currentMenuItem:h,menuItems:n,existingInventory:i,onCreateNewInventory:B})]}):null}function Hme({isOpen:t,onClose:e,onSave:r,inventory:s,menuItemName:n,register:i,handleSubmit:o,isSubmitting:l}){if(!t)return null;const c=(d,u)=>d==="custom"&&u?u:d;return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-2xl max-w-md w-full",children:[a.jsx("div",{className:"p-6 border-b border-gray-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Adjust Inventory"}),a.jsx("button",{onClick:e,className:"p-1 text-gray-400 hover:text-gray-600",children:a.jsx(qr,{className:"w-5 h-5"})})]})}),a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"mb-6",children:[a.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:n}),a.jsxs("p",{className:"text-sm text-gray-600",children:["Current Stock: ",s.currentQuantity," ",c(s.unit,s.customUnit)]})]}),a.jsxs("form",{onSubmit:o(r),className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"New Quantity *"}),a.jsx("input",{...i("newQuantity",{required:"New quantity is required",min:{value:0,message:"Quantity cannot be negative"}}),type:"number",step:"0.1",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:`Enter quantity in ${c(s.unit,s.customUnit)}`})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Adjustment Type *"}),a.jsxs("select",{...i("type",{required:"Type is required"}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"restock",children:" Restock"}),a.jsx("option",{value:"manual_adjustment",children:" Manual Adjustment"}),a.jsx("option",{value:"waste",children:" Waste/Loss"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Reason"}),a.jsx("input",{...i("reason"),type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Brief reason for adjustment"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes"}),a.jsx("textarea",{...i("notes"),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Additional notes (optional)"})]}),a.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[a.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Cancel"}),a.jsx("button",{type:"submit",disabled:l,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-colors",children:l?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2 inline-block"}),"Adjusting..."]}):a.jsxs(a.Fragment,{children:[a.jsx(au,{className:"w-4 h-4 mr-2 inline"}),"Adjust Inventory"]})})]})]})]})]})})}function $me({isOpen:t,onClose:e,inventory:r,menuItemName:s,transactions:n,onRefreshTransactions:i}){const{user:o}=ia(),[l,c]=R.useState(!1);if(!t)return null;const d=async()=>{if(!(!o||!r))try{c(!0);const f=await Ja.createInitialTransactionForInventory(r.id,r.restaurantId,o.id);f.success?f.data?(Z.success("Initial transaction created successfully"),i&&await i()):Z.success(f.message||"No transaction needed"):Z.error(f.error||"Failed to create initial transaction")}catch(f){console.error("Error creating initial transaction:",f),Z.error("Failed to create initial transaction")}finally{c(!1)}},u=(f,p)=>f==="custom"&&p?p:f,A=f=>{switch(f){case"restock":return a.jsx(Is,{className:"w-4 h-4 text-green-600"});case"order_deduction":return a.jsx(mp,{className:"w-4 h-4 text-red-600"});case"manual_adjustment":return a.jsx(hx,{className:"w-4 h-4 text-blue-600"});case"waste":return a.jsx(Go,{className:"w-4 h-4 text-yellow-600"});default:return a.jsx(rs,{className:"w-4 h-4 text-gray-600"})}},h=f=>{switch(f){case"restock":return"Restock";case"order_deduction":return"Order Deduction";case"manual_adjustment":return"Manual Adjustment";case"waste":return"Waste/Loss";case"return":return"Return";default:return f}};return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsx("div",{className:"p-6 border-b border-gray-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Inventory History"}),a.jsx("p",{className:"text-gray-600",children:s})]}),a.jsx("button",{onClick:e,className:"p-1 text-gray-400 hover:text-gray-600",children:a.jsx(qr,{className:"w-5 h-5"})})]})}),a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[a.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Current Status"}),a.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Current Stock:"}),a.jsxs("p",{className:"font-medium",children:[r.currentQuantity," ",u(r.unit,r.customUnit)]})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Minimum Threshold:"}),a.jsxs("p",{className:"font-medium",children:[r.minimumThreshold," ",u(r.unit,r.customUnit)]})]})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsx("h3",{className:"font-medium text-gray-900",children:"Transaction History"}),n.length===0?a.jsxs("div",{className:"text-center py-12 text-gray-500",children:[a.jsx(Ys,{className:"w-12 h-12 mx-auto mb-4 text-gray-400"}),a.jsx("h4",{className:"text-lg font-medium text-gray-700 mb-2",children:"No transaction history available"}),a.jsxs("div",{className:"text-sm text-gray-600 space-y-2",children:[a.jsx("p",{children:"Transaction history will show when:"}),a.jsx("div",{className:"bg-gray-50 rounded-lg p-4 text-left max-w-md mx-auto",children:a.jsxs("ul",{className:"space-y-2",children:[a.jsxs("li",{className:"flex items-center",children:[a.jsx(Is,{className:"w-4 h-4 text-green-600 mr-2 flex-shrink-0"}),"Inventory is restocked"]}),a.jsxs("li",{className:"flex items-center",children:[a.jsx(mp,{className:"w-4 h-4 text-red-600 mr-2 flex-shrink-0"}),"Items are sold (order deductions)"]}),a.jsxs("li",{className:"flex items-center",children:[a.jsx(hx,{className:"w-4 h-4 text-blue-600 mr-2 flex-shrink-0"}),"Manual adjustments are made"]}),a.jsxs("li",{className:"flex items-center",children:[a.jsx(Go,{className:"w-4 h-4 text-yellow-600 mr-2 flex-shrink-0"}),"Waste or loss is recorded"]})]})}),a.jsx("p",{className:"text-xs text-gray-500 mt-3",children:"Try adjusting the inventory quantity or processing some orders to see transactions appear."})]}),r.currentQuantity>0&&a.jsxs("div",{className:"mt-6",children:[a.jsx("button",{onClick:d,disabled:l,className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:l?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Creating..."]}):a.jsxs(a.Fragment,{children:[a.jsx(Is,{className:"w-4 h-4 mr-2"}),"Create Initial Stock Record"]})}),a.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["This will create a record of your current ",r.currentQuantity," ",u(r.unit,r.customUnit)," stock"]})]})]}):a.jsx("div",{className:"space-y-3",children:n.map(f=>a.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[A(f.type),a.jsx("span",{className:"font-medium text-gray-900",children:h(f.type)})]}),a.jsxs("span",{className:"text-sm text-gray-500",children:[new Date(f.createdAt).toLocaleDateString()," ",new Date(f.createdAt).toLocaleTimeString()]})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Change:"}),a.jsxs("p",{className:`font-medium ${f.quantityChanged>=0?"text-green-600":"text-red-600"}`,children:[f.quantityChanged>=0?"+":"",f.quantityChanged," ",u(r.unit,r.customUnit)]})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Previous:"}),a.jsxs("p",{className:"font-medium",children:[f.previousQuantity," ",u(r.unit,r.customUnit)]})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"New:"}),a.jsxs("p",{className:"font-medium",children:[f.newQuantity," ",u(r.unit,r.customUnit)]})]})]}),f.reason&&a.jsxs("div",{className:"mt-2",children:[a.jsx("span",{className:"text-gray-600 text-sm",children:"Reason:"}),a.jsx("p",{className:"text-sm",children:f.reason})]}),f.notes&&a.jsxs("div",{className:"mt-2",children:[a.jsx("span",{className:"text-gray-600 text-sm",children:"Notes:"}),a.jsx("p",{className:"text-sm",children:f.notes})]}),f.orderId&&a.jsxs("div",{className:"mt-2",children:[a.jsx("span",{className:"text-gray-600 text-sm",children:"Order ID:"}),a.jsx("p",{className:"text-sm font-mono",children:f.orderId})]})]},f.id))})]}),a.jsx("div",{className:"flex justify-end pt-6",children:a.jsx("button",{onClick:e,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Close"})})]})]})})}function Kme(){const{restaurant:t}=js(),{user:e}=ia(),[r]=$8(),[s,n]=R.useState([]),[i,o]=R.useState([]),[l,c]=R.useState([]),[d,u]=R.useState(""),[A,h]=R.useState("all"),[f,p]=R.useState(!1),[m,g]=R.useState("create"),[y,v]=R.useState(null),[x,E]=R.useState([]),[T,j]=R.useState(!0),[C,w]=R.useState(!1),{register:S,handleSubmit:F,reset:B,setValue:k,watch:D}=nn(),{register:q,handleSubmit:te,reset:W}=nn(),Q=D("unit");R.useEffect(()=>{t&&re()},[t]),R.useEffect(()=>{G()},[i,d,A]),R.useEffect(()=>{const H=r.get("item");if(H&&s.length>0&&i.length>=0){const je=i.find(Ce=>Ce.menuItemId===H);je?he(je):s.find(oe=>oe.id===H)&&(v(null),g("create"),B({menuItemId:H,currentQuantity:0,unit:"pieces",minimumThreshold:5,consumptionPerOrder:1,isTracked:!0,autoDeduct:!0}),p(!0))}},[r,s,i]);const re=async()=>{if(t)try{j(!0);const[H,je]=await Promise.all([Ts.getMenuItemsForRestaurant(t.id),Ja.getInventoryForRestaurant(t.id)]);H.success&&H.data&&n(H.data),je.success&&je.data&&o(je.data)}catch{Z.error("Failed to load inventory data")}finally{j(!1)}},G=()=>{let H=i;switch(d&&(H=H.filter(je=>{var He,ie,le;if((He=je.menuItemId)!=null&&He.startsWith("standalone_"))return(je.displayName||je.standaloneItemName||"Standalone Item").toLowerCase().includes(d.toLowerCase())||((ie=je.supplier)==null?void 0:ie.toLowerCase().includes(d.toLowerCase()));const Ce=s.find(ae=>ae.id===je.menuItemId);return((Ce==null?void 0:Ce.name)||"").toLowerCase().includes(d.toLowerCase())||((le=je.supplier)==null?void 0:le.toLowerCase().includes(d.toLowerCase()))})),A){case"tracked":H=H.filter(je=>je.isTracked);break;case"low_stock":H=H.filter(je=>je.isTracked&&je.currentQuantity<=je.minimumThreshold);break;case"out_of_stock":H=H.filter(je=>je.isTracked&&je.currentQuantity===0);break}c(H)},Ae=()=>{var je;const H=s.filter(Ce=>!i.some(oe=>oe.menuItemId===Ce.id));if(H.length===0){Z.error("All menu items already have inventory setup");return}v(null),g("create"),B({menuItemId:((je=H[0])==null?void 0:je.id)||"",currentQuantity:0,unit:"pieces",minimumThreshold:5,consumptionPerOrder:1,isTracked:!0,autoDeduct:!0}),p(!0)},he=H=>{v(H),g("edit"),k("menuItemId",H.menuItemId),k("currentQuantity",H.currentQuantity),k("unit",H.unit),k("customUnit",H.customUnit),k("minimumThreshold",H.minimumThreshold),k("consumptionPerOrder",H.consumptionPerOrder),k("maxCapacity",H.maxCapacity),k("costPerUnit",H.costPerUnit),k("supplier",H.supplier),k("isTracked",H.isTracked),k("autoDeduct",H.autoDeduct),p(!0)},I=H=>{v(H),g("adjust"),W({newQuantity:H.currentQuantity,type:"manual_adjustment"}),p(!0)},U=async H=>{if(t)try{v(H),g("history"),await V(H),p(!0)}catch{Z.error("Failed to load transaction history")}},V=async H=>{if(t)try{const je=await Ja.getTransactionHistory(H.id,t.id);je.success&&je.data?E(je.data):E([])}catch(je){console.error("Failed to load transaction history:",je),E([])}},L=async H=>{var je;if(!(!t||!e))try{if(w(!0),H.isStandaloneItem){console.log("Creating standalone inventory item:",H);const He={menuItemId:`standalone_${An()}`,restaurantId:t.id,currentQuantity:H.currentQuantity,unit:H.unit,customUnit:H.customUnit,minimumThreshold:H.minimumThreshold,consumptionPerOrder:H.consumptionPerOrder,maxCapacity:H.maxCapacity,costPerUnit:H.costPerUnit,supplier:H.supplier,isTracked:H.isTracked,autoDeduct:H.autoDeduct,isStandaloneItem:!0,displayName:H.standaloneItemName,standaloneItemName:H.standaloneItemName};let ie;y?ie=await Ja.updateInventoryItem(y.id,t.id,He,e.id):ie=await Ja.createInventoryItem(He,e.id),ie.success?(Z.success(`Standalone inventory item ${y?"updated":"created"} successfully`),await re(),p(!1),v(null)):Z.error(ie.error||`Failed to ${y?"update":"create"} standalone inventory item`);return}const Ce={menuItemId:H.menuItemId,restaurantId:t.id,currentQuantity:H.currentQuantity,unit:H.unit,customUnit:H.customUnit,minimumThreshold:H.minimumThreshold,consumptionPerOrder:H.consumptionPerOrder,maxCapacity:H.maxCapacity,costPerUnit:H.costPerUnit,supplier:H.supplier,isTracked:H.isTracked,autoDeduct:H.autoDeduct,linkedItems:H.linkedItems||[]};Object.keys(Ce).forEach(He=>{Ce[He]===void 0&&delete Ce[He]});let oe;y?oe=await Ja.updateInventoryItem(y.id,t.id,Ce,e.id):oe=await Ja.createInventoryItem(Ce,e.id),oe.success?(Z.success(`Inventory ${y?"updated":"created"} successfully`),H.linkedItems&&H.linkedItems.length>0&&await K(H.linkedItems,(je=oe.data)==null?void 0:je.id),await re(),p(!1),v(null)):Z.error(oe.error||`Failed to ${y?"update":"create"} inventory`)}catch(Ce){console.error("Error saving inventory:",Ce),Z.error(`Failed to ${y?"update":"create"} inventory`)}finally{w(!1)}},K=async(H,je)=>{if(!t||!e){console.error("Restaurant or user not available for creating linked inventory");return}for(const Ce of H){const oe=i.find(He=>He.menuItemId===Ce.linkedMenuItemId);if(oe){Ce.linkedInventoryId=oe.id;const He={};Ce.enableReverseLink&&!oe.baseInventoryId&&(He.baseInventoryId=je||(y==null?void 0:y.id),He.baseRatio=Ce.reverseRatio||1),oe.autoDeduct||(He.autoDeduct=!0),Object.keys(He).length>0&&await Ja.updateInventoryItem(oe.id,t.id,He,e.id)}else{const He=s.find(ie=>ie.id===Ce.linkedMenuItemId);if(He){const ie={menuItemId:Ce.linkedMenuItemId,currentQuantity:0,unit:"pieces",minimumThreshold:5,consumptionPerOrder:1,isTracked:!0,autoDeduct:!0,restaurantId:t.id,baseInventoryId:je||(y==null?void 0:y.id),baseRatio:Ce.reverseRatio||1},le=await Ja.createInventoryItem(ie,e.id);le.success&&le.data?(Ce.linkedInventoryId=le.data.id,console.log(` Created inventory for linked item: ${He.name}`)):console.error(` Failed to create inventory for linked item: ${He.name}`)}}}},fe=async H=>{if(!(!t||!e||!y))try{w(!0);const je=await Ja.adjustInventoryQuantity(y.id,t.id,H.newQuantity,H.type,e.id,H.reason,H.notes);je.success?(Z.success("Inventory adjusted successfully"),await re(),p(!1),v(null)):Z.error(je.error||"Failed to adjust inventory")}catch{Z.error("Failed to adjust inventory")}finally{w(!1)}},ee=async H=>{if(!(!t||!confirm("Are you sure you want to delete this inventory item?")))try{const je=await Ja.deleteInventoryItem(H.id,t.id);je.success?(Z.success("Inventory deleted successfully"),await re()):Z.error(je.error||"Failed to delete inventory")}catch{Z.error("Failed to delete inventory")}},de=async()=>{var H;if(!t||!e){Z.error("Restaurant or user not available");return}try{const je=Z.loading("Enabling auto-deduct for all items..."),Ce=await Ja.enableAutoDeductForAll(t.id);Z.dismiss(je),Ce.success?(Z.success(`Auto-deduct enabled for ${((H=Ce.data)==null?void 0:H.updated)||0} items!`),await re()):Z.error(Ce.error||"Failed to enable auto-deduct")}catch(je){console.error("Error enabling auto-deduct:",je),Z.error("Failed to enable auto-deduct")}},ue=H=>{if(H!=null&&H.startsWith("standalone_")){const Ce=i.find(oe=>oe.menuItemId===H);return(Ce==null?void 0:Ce.displayName)||(Ce==null?void 0:Ce.standaloneItemName)||"Standalone Item"}const je=s.find(Ce=>Ce.id===H);return(je==null?void 0:je.name)||"Unknown Item"},Ie=H=>H.isTracked?H.currentQuantity===0?{status:"Out of Stock",color:"text-red-600",icon:a.jsx(Go,{className:"w-4 h-4"})}:H.currentQuantity<=H.minimumThreshold?{status:"Low Stock",color:"text-yellow-600",icon:a.jsx(mp,{className:"w-4 h-4"})}:{status:"In Stock",color:"text-green-600",icon:a.jsx(Is,{className:"w-4 h-4"})}:{status:"Not Tracked",color:"text-gray-500",icon:a.jsx(Dl,{className:"w-4 h-4"})},Y={totalItems:i.length,trackedItems:i.filter(H=>H.isTracked).length,lowStockItems:i.filter(H=>H.isTracked&&H.currentQuantity<=H.minimumThreshold).length,outOfStockItems:i.filter(H=>H.isTracked&&H.currentQuantity===0).length};return t?a.jsxs("div",{className:"min-h-screen",style:{background:"var(--color-background)"},children:[a.jsx("header",{className:"bg-white/80 backdrop-blur-md border-b border-gray-200 sticky top-0 z-40",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Inventory Management"}),a.jsx("p",{className:"text-gray-600",children:"Track and manage your restaurant inventory"})]}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsxs("button",{onClick:de,className:"btn bg-green-600 text-white hover:bg-green-700",title:"Enable auto-deduct for all inventory items",children:[a.jsx(Di,{className:"w-4 h-4 mr-2"}),"Enable Auto-Deduct for All"]}),a.jsxs("button",{onClick:Ae,className:"btn btn-theme-primary",disabled:s.filter(H=>!i.some(je=>je.menuItemId===H.id)).length===0,children:[a.jsx(zr,{className:"w-4 h-4 mr-2"}),"Add Inventory"]})]})]})})}),a.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-6",children:[a.jsx("div",{className:"card p-6",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:a.jsx(rs,{className:"w-6 h-6 text-blue-600"})}),a.jsxs("div",{className:"ml-4",children:[a.jsx("p",{className:"text-sm text-gray-600",children:"Total Items"}),a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:Y.totalItems})]})]})}),a.jsx("div",{className:"card p-6",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"p-3 bg-green-100 rounded-lg",children:a.jsx(Xs,{className:"w-6 h-6 text-green-600"})}),a.jsxs("div",{className:"ml-4",children:[a.jsx("p",{className:"text-sm text-gray-600",children:"Tracked"}),a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:Y.trackedItems})]})]})}),a.jsx("div",{className:"card p-6",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"p-3 bg-yellow-100 rounded-lg",children:a.jsx(mp,{className:"w-6 h-6 text-yellow-600"})}),a.jsxs("div",{className:"ml-4",children:[a.jsx("p",{className:"text-sm text-gray-600",children:"Low Stock"}),a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:Y.lowStockItems})]})]})}),a.jsx("div",{className:"card p-6",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"p-3 bg-red-100 rounded-lg",children:a.jsx(Go,{className:"w-6 h-6 text-red-600"})}),a.jsxs("div",{className:"ml-4",children:[a.jsx("p",{className:"text-sm text-gray-600",children:"Out of Stock"}),a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:Y.outOfStockItems})]})]})})]}),a.jsx("div",{className:"card p-6 mb-6",children:a.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[a.jsxs("div",{className:"flex-1 relative",children:[a.jsx(sn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),a.jsx("input",{type:"text",placeholder:"Search inventory items...",value:d,onChange:H=>u(H.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(nu,{className:"w-5 h-5 text-gray-600"}),a.jsxs("select",{value:A,onChange:H=>h(H.target.value),className:"px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"all",children:"All Items"}),a.jsx("option",{value:"tracked",children:"Tracked Only"}),a.jsx("option",{value:"low_stock",children:"Low Stock"}),a.jsx("option",{value:"out_of_stock",children:"Out of Stock"})]})]}),a.jsxs("button",{onClick:re,className:"btn btn-secondary",children:[a.jsx(Di,{className:"w-4 h-4 mr-2"}),"Refresh"]})]})]})}),T?a.jsxs("div",{className:"text-center py-12",children:[a.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Loading inventory..."})]}):a.jsx("div",{className:"space-y-4",children:l.length===0?a.jsxs("div",{className:"text-center py-12",children:[a.jsx(rs,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No inventory items found"}),a.jsx("p",{className:"text-gray-600 mb-4",children:i.length===0?"Start by adding inventory tracking for your menu items":"Try adjusting your search or filter settings"}),i.length===0&&a.jsxs("button",{onClick:Ae,className:"btn btn-theme-primary",children:[a.jsx(zr,{className:"w-4 h-4 mr-2"}),"Add First Inventory Item"]})]}):l.map(H=>{var je;return a.jsx(zme,{inventory:H,menuItemName:ue(H.menuItemId),stockStatus:Ie(H),onEdit:he,onAdjust:I,onHistory:U,onDelete:ee,allInventoryItems:i,allMenuItems:s,isStandaloneItem:((je=H.menuItemId)==null?void 0:je.startsWith("standalone_"))||!1},H.id)})})]}),f&&(m==="create"||m==="edit")&&a.jsx(Vme,{isOpen:!0,onClose:()=>p(!1),onSave:L,inventory:y,menuItems:s,existingInventory:i,register:S,handleSubmit:F,setValue:k,selectedUnit:Q,isSubmitting:C}),f&&m==="adjust"&&y&&a.jsx(Hme,{isOpen:!0,onClose:()=>p(!1),onSave:fe,inventory:y,menuItemName:ue(y.menuItemId),register:q,handleSubmit:te,isSubmitting:C}),f&&m==="history"&&y&&a.jsx($me,{isOpen:!0,onClose:()=>p(!1),inventory:y,menuItemName:ue(y.menuItemId),transactions:x,onRefreshTransactions:()=>V(y)})]}):a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Loading..."})]})})}function zme({inventory:t,menuItemName:e,stockStatus:r,onEdit:s,onAdjust:n,onHistory:i,onDelete:o,allInventoryItems:l,allMenuItems:c,isStandaloneItem:d}){var g,y,v;const u=(x,E)=>x==="custom"&&E?E:x,A=t.linkedItems&&t.linkedItems.length>0,h=!!t.baseInventoryId,f=(l==null?void 0:l.filter(x=>{var E;return x.id!==t.id&&((E=x.linkedItems)==null?void 0:E.some(T=>T.linkedInventoryId===t.id||T.linkedMenuItemId===t.menuItemId))}))||[],p=f.length>0,m=(((g=t.linkedItems)==null?void 0:g.length)||0)+f.length;return a.jsx("div",{className:`card p-6 ${!d&&m>0?"border-l-4 border-l-blue-500":d?"border-l-4 border-l-purple-500":""}`,children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[a.jsxs("h3",{className:"font-semibold text-gray-900 text-lg flex items-center",children:[e,d&&a.jsxs("span",{className:"ml-2 inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-purple-100 text-purple-800",children:[a.jsx(rs,{className:"w-3 h-3 mr-1"}),"Standalone"]})]}),!d&&a.jsxs("div",{className:`flex items-center space-x-1 ${r.color}`,children:[r.icon,a.jsx("span",{className:"text-sm font-medium",children:r.status})]}),d&&a.jsxs("div",{className:"flex items-center space-x-1 text-purple-600",children:[a.jsx(rs,{className:"w-4 h-4"}),a.jsx("span",{className:"text-sm font-medium",children:"Inventory Only"})]}),!d&&m>0&&a.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-blue-100 text-blue-800",children:[a.jsx(Qw,{className:"w-3 h-3 mr-1"}),A&&p?`Bidirectional (${m} links)`:A?`Base Item (${(y=t.linkedItems)==null?void 0:y.length} linked)`:p?`Linked Item (${f.length} sources)`:"Linked"]}),!d&&h&&a.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-green-100 text-green-800",children:[a.jsx(mp,{className:"w-3 h-3 mr-1"}),"Consumes from Base"]})]}),d&&a.jsx("p",{className:"text-sm text-purple-600 mb-3",children:"This item is not linked to any menu items - it's used for inventory tracking only."}),a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Current Stock:"}),a.jsxs("p",{className:"font-medium",children:[t.currentQuantity," ",u(t.unit,t.customUnit)]})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Minimum:"}),a.jsxs("p",{className:"font-medium",children:[t.minimumThreshold," ",u(t.unit,t.customUnit)]})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Per Order:"}),a.jsxs("p",{className:"font-medium",children:[t.consumptionPerOrder," ",u(t.unit,t.customUnit)]})]}),t.supplier&&a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Supplier:"}),a.jsx("p",{className:"font-medium",children:t.supplier})]})]}),!d&&(A||p)&&a.jsxs("div",{className:"mt-3 space-y-3",children:[A&&a.jsxs("div",{className:"p-3 bg-blue-50 rounded-lg",children:[a.jsxs("h4",{className:"text-sm font-medium text-blue-900 mb-2 flex items-center",children:[a.jsx(Is,{className:"w-4 h-4 mr-1"}),"Items linked from this inventory:"]}),a.jsx("div",{className:"space-y-1",children:(v=t.linkedItems)==null?void 0:v.map((x,E)=>a.jsxs("div",{className:"text-xs text-blue-700 flex items-center justify-between",children:[a.jsx("span",{children:x.linkedMenuItemName}),a.jsxs("span",{className:"font-mono",children:["Ratio: 1:",x.ratio,x.enableReverseLink&&x.reverseRatio&&a.jsxs("span",{className:"ml-2",children:["| Reverse: 1:",x.reverseRatio]})]})]},E))})]}),p&&a.jsxs("div",{className:"p-3 bg-purple-50 rounded-lg",children:[a.jsxs("h4",{className:"text-sm font-medium text-purple-900 mb-2 flex items-center",children:[a.jsx(mp,{className:"w-4 h-4 mr-1"}),"Items linked to this inventory:"]}),a.jsx("div",{className:"space-y-1",children:f.map((x,E)=>{var C,w;const T=(C=x.linkedItems)==null?void 0:C.find(S=>S.linkedInventoryId===t.id||S.linkedMenuItemId===t.menuItemId),j=((w=c==null?void 0:c.find(S=>S.id===x.menuItemId))==null?void 0:w.name)||"Unknown Item";return a.jsxs("div",{className:"text-xs text-purple-700 flex items-center justify-between",children:[a.jsx("span",{children:j}),a.jsxs("span",{className:"font-mono",children:["Ratio: 1:",(T==null?void 0:T.ratio)||"?",(T==null?void 0:T.enableReverseLink)&&(T==null?void 0:T.reverseRatio)&&a.jsxs("span",{className:"ml-2",children:["| Reverse: 1:",T.reverseRatio]})]})]},E)})})]})]}),!d&&h&&t.baseRatio&&a.jsx("div",{className:"mt-3 p-3 bg-green-50 rounded-lg",children:a.jsxs("div",{className:"text-xs text-green-700",children:[a.jsx("span",{className:"font-medium",children:"Reverse Linked:"})," Ratio 1:",t.baseRatio]})}),a.jsxs("div",{className:"flex items-center space-x-4 mt-3",children:[t.isTracked?a.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[a.jsx(Xs,{className:"w-3 h-3 mr-1"}),"Tracked"]}):a.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:[a.jsx(Dl,{className:"w-3 h-3 mr-1"}),"Not Tracked"]}),t.autoDeduct&&a.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:"Auto Deduct"}),t.lastRestockedAt&&a.jsxs("span",{className:"text-xs text-gray-500",children:["Last restocked: ",new Date(t.lastRestockedAt).toLocaleDateString()]})]})]}),a.jsxs("div",{className:"flex space-x-2 ml-4",children:[a.jsx("button",{onClick:()=>i(t),className:"p-2 bg-gray-100 text-gray-600 hover:bg-gray-200 rounded-lg",title:"View History",children:a.jsx($te,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>n(t),className:"p-2 bg-blue-100 text-blue-600 hover:bg-blue-200 rounded-lg",title:"Adjust Quantity",children:a.jsx(Sa,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>s(t),className:"p-2 bg-yellow-100 text-yellow-600 hover:bg-yellow-200 rounded-lg",title:"Edit",children:a.jsx(gc,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>o(t),className:"p-2 bg-red-100 text-red-600 hover:bg-red-200 rounded-lg",title:"Delete",children:a.jsx(Un,{className:"w-4 h-4"})})]})]})})}function Us(t){"@babel/helpers - typeof";return Us=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Us(t)}var Ti=Uint8Array,zo=Uint16Array,eT=Int32Array,TN=new Ti([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),IN=new Ti([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),nS=new Ti([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),rQ=function(t,e){for(var r=new zo(31),s=0;s<31;++s)r[s]=e+=1<<t[s-1];for(var n=new eT(r[30]),s=1;s<30;++s)for(var i=r[s];i<r[s+1];++i)n[i]=i-r[s]<<5|s;return{b:r,r:n}},sQ=rQ(TN,2),nQ=sQ.b,aS=sQ.r;nQ[28]=258,aS[258]=28;var aQ=rQ(IN,0),qme=aQ.b,LF=aQ.r,iS=new zo(32768);for(var fn=0;fn<32768;++fn){var qu=(fn&43690)>>1|(fn&21845)<<1;qu=(qu&52428)>>2|(qu&13107)<<2,qu=(qu&61680)>>4|(qu&3855)<<4,iS[fn]=((qu&65280)>>8|(qu&255)<<8)>>1}var ed=function(t,e,r){for(var s=t.length,n=0,i=new zo(e);n<s;++n)t[n]&&++i[t[n]-1];var o=new zo(e);for(n=1;n<e;++n)o[n]=o[n-1]+i[n-1]<<1;var l;if(r){l=new zo(1<<e);var c=15-e;for(n=0;n<s;++n)if(t[n])for(var d=n<<4|t[n],u=e-t[n],A=o[t[n]-1]++<<u,h=A|(1<<u)-1;A<=h;++A)l[iS[A]>>c]=d}else for(l=new zo(s),n=0;n<s;++n)t[n]&&(l[n]=iS[o[t[n]-1]++]>>15-t[n]);return l},rh=new Ti(288);for(var fn=0;fn<144;++fn)rh[fn]=8;for(var fn=144;fn<256;++fn)rh[fn]=9;for(var fn=256;fn<280;++fn)rh[fn]=7;for(var fn=280;fn<288;++fn)rh[fn]=8;var Ny=new Ti(32);for(var fn=0;fn<32;++fn)Ny[fn]=5;var Wme=ed(rh,9,0),Gme=ed(rh,9,1),Yme=ed(Ny,5,0),Xme=ed(Ny,5,1),gC=function(t){for(var e=t[0],r=1;r<t.length;++r)t[r]>e&&(e=t[r]);return e},Yl=function(t,e,r){var s=e/8|0;return(t[s]|t[s+1]<<8)>>(e&7)&r},xC=function(t,e){var r=e/8|0;return(t[r]|t[r+1]<<8|t[r+2]<<16)>>(e&7)},tT=function(t){return(t+7)/8|0},iQ=function(t,e,r){return(r==null||r>t.length)&&(r=t.length),new Ti(t.subarray(e,r))},Jme=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],ec=function(t,e,r){var s=new Error(e||Jme[t]);if(s.code=t,Error.captureStackTrace&&Error.captureStackTrace(s,ec),!r)throw s;return s},Zme=function(t,e,r,s){var n=t.length,i=0;if(!n||e.f&&!e.l)return r||new Ti(0);var o=!r,l=o||e.i!=2,c=e.i;o&&(r=new Ti(n*3));var d=function(Ie){var Y=r.length;if(Ie>Y){var H=new Ti(Math.max(Y*2,Ie));H.set(r),r=H}},u=e.f||0,A=e.p||0,h=e.b||0,f=e.l,p=e.d,m=e.m,g=e.n,y=n*8;do{if(!f){u=Yl(t,A,1);var v=Yl(t,A+1,3);if(A+=3,v)if(v==1)f=Gme,p=Xme,m=9,g=5;else if(v==2){var j=Yl(t,A,31)+257,C=Yl(t,A+10,15)+4,w=j+Yl(t,A+5,31)+1;A+=14;for(var S=new Ti(w),F=new Ti(19),B=0;B<C;++B)F[nS[B]]=Yl(t,A+B*3,7);A+=C*3;for(var k=gC(F),D=(1<<k)-1,q=ed(F,k,1),B=0;B<w;){var te=q[Yl(t,A,D)];A+=te&15;var x=te>>4;if(x<16)S[B++]=x;else{var W=0,Q=0;for(x==16?(Q=3+Yl(t,A,3),A+=2,W=S[B-1]):x==17?(Q=3+Yl(t,A,7),A+=3):x==18&&(Q=11+Yl(t,A,127),A+=7);Q--;)S[B++]=W}}var re=S.subarray(0,j),G=S.subarray(j);m=gC(re),g=gC(G),f=ed(re,m,1),p=ed(G,g,1)}else ec(1);else{var x=tT(A)+4,E=t[x-4]|t[x-3]<<8,T=x+E;if(T>n){c&&ec(0);break}l&&d(h+E),r.set(t.subarray(x,T),h),e.b=h+=E,e.p=A=T*8,e.f=u;continue}if(A>y){c&&ec(0);break}}l&&d(h+131072);for(var Ae=(1<<m)-1,he=(1<<g)-1,I=A;;I=A){var W=f[xC(t,A)&Ae],U=W>>4;if(A+=W&15,A>y){c&&ec(0);break}if(W||ec(2),U<256)r[h++]=U;else if(U==256){I=A,f=null;break}else{var V=U-254;if(U>264){var B=U-257,L=TN[B];V=Yl(t,A,(1<<L)-1)+nQ[B],A+=L}var K=p[xC(t,A)&he],fe=K>>4;K||ec(3),A+=K&15;var G=qme[fe];if(fe>3){var L=IN[fe];G+=xC(t,A)&(1<<L)-1,A+=L}if(A>y){c&&ec(0);break}l&&d(h+131072);var ee=h+V;if(h<G){var de=i-G,ue=Math.min(G,ee);for(de+h<0&&ec(3);h<ue;++h)r[h]=s[de+h]}for(;h<ee;++h)r[h]=r[h-G]}}e.l=f,e.p=I,e.b=h,e.f=u,f&&(u=1,e.m=m,e.d=p,e.n=g)}while(!u);return h!=r.length&&o?iQ(r,0,h):r.subarray(0,h)},Td=function(t,e,r){r<<=e&7;var s=e/8|0;t[s]|=r,t[s+1]|=r>>8},bg=function(t,e,r){r<<=e&7;var s=e/8|0;t[s]|=r,t[s+1]|=r>>8,t[s+2]|=r>>16},yC=function(t,e){for(var r=[],s=0;s<t.length;++s)t[s]&&r.push({s,f:t[s]});var n=r.length,i=r.slice();if(!n)return{t:lQ,l:0};if(n==1){var o=new Ti(r[0].s+1);return o[r[0].s]=1,{t:o,l:1}}r.sort(function(T,j){return T.f-j.f}),r.push({s:-1,f:25001});var l=r[0],c=r[1],d=0,u=1,A=2;for(r[0]={s:-1,f:l.f+c.f,l,r:c};u!=n-1;)l=r[r[d].f<r[A].f?d++:A++],c=r[d!=u&&r[d].f<r[A].f?d++:A++],r[u++]={s:-1,f:l.f+c.f,l,r:c};for(var h=i[0].s,s=1;s<n;++s)i[s].s>h&&(h=i[s].s);var f=new zo(h+1),p=oS(r[u-1],f,0);if(p>e){var s=0,m=0,g=p-e,y=1<<g;for(i.sort(function(j,C){return f[C.s]-f[j.s]||j.f-C.f});s<n;++s){var v=i[s].s;if(f[v]>e)m+=y-(1<<p-f[v]),f[v]=e;else break}for(m>>=g;m>0;){var x=i[s].s;f[x]<e?m-=1<<e-f[x]++-1:++s}for(;s>=0&&m;--s){var E=i[s].s;f[E]==e&&(--f[E],++m)}p=e}return{t:new Ti(f),l:p}},oS=function(t,e,r){return t.s==-1?Math.max(oS(t.l,e,r+1),oS(t.r,e,r+1)):e[t.s]=r},OF=function(t){for(var e=t.length;e&&!t[--e];);for(var r=new zo(++e),s=0,n=t[0],i=1,o=function(c){r[s++]=c},l=1;l<=e;++l)if(t[l]==n&&l!=e)++i;else{if(!n&&i>2){for(;i>138;i-=138)o(32754);i>2&&(o(i>10?i-11<<5|28690:i-3<<5|12305),i=0)}else if(i>3){for(o(n),--i;i>6;i-=6)o(8304);i>2&&(o(i-3<<5|8208),i=0)}for(;i--;)o(n);i=1,n=t[l]}return{c:r.subarray(0,s),n:e}},wg=function(t,e){for(var r=0,s=0;s<e.length;++s)r+=t[s]*e[s];return r},oQ=function(t,e,r){var s=r.length,n=tT(e+2);t[n]=s&255,t[n+1]=s>>8,t[n+2]=t[n]^255,t[n+3]=t[n+1]^255;for(var i=0;i<s;++i)t[n+i+4]=r[i];return(n+4+s)*8},UF=function(t,e,r,s,n,i,o,l,c,d,u){Td(e,u++,r),++n[256];for(var A=yC(n,15),h=A.t,f=A.l,p=yC(i,15),m=p.t,g=p.l,y=OF(h),v=y.c,x=y.n,E=OF(m),T=E.c,j=E.n,C=new zo(19),w=0;w<v.length;++w)++C[v[w]&31];for(var w=0;w<T.length;++w)++C[T[w]&31];for(var S=yC(C,7),F=S.t,B=S.l,k=19;k>4&&!F[nS[k-1]];--k);var D=d+5<<3,q=wg(n,rh)+wg(i,Ny)+o,te=wg(n,h)+wg(i,m)+o+14+3*k+wg(C,F)+2*C[16]+3*C[17]+7*C[18];if(c>=0&&D<=q&&D<=te)return oQ(e,u,t.subarray(c,c+d));var W,Q,re,G;if(Td(e,u,1+(te<q)),u+=2,te<q){W=ed(h,f,0),Q=h,re=ed(m,g,0),G=m;var Ae=ed(F,B,0);Td(e,u,x-257),Td(e,u+5,j-1),Td(e,u+10,k-4),u+=14;for(var w=0;w<k;++w)Td(e,u+3*w,F[nS[w]]);u+=3*k;for(var he=[v,T],I=0;I<2;++I)for(var U=he[I],w=0;w<U.length;++w){var V=U[w]&31;Td(e,u,Ae[V]),u+=F[V],V>15&&(Td(e,u,U[w]>>5&127),u+=U[w]>>12)}}else W=Wme,Q=rh,re=Yme,G=Ny;for(var w=0;w<l;++w){var L=s[w];if(L>255){var V=L>>18&31;bg(e,u,W[V+257]),u+=Q[V+257],V>7&&(Td(e,u,L>>23&31),u+=TN[V]);var K=L&31;bg(e,u,re[K]),u+=G[K],K>3&&(bg(e,u,L>>5&8191),u+=IN[K])}else bg(e,u,W[L]),u+=Q[L]}return bg(e,u,W[256]),u+Q[256]},e0e=new eT([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),lQ=new Ti(0),t0e=function(t,e,r,s,n,i){var o=i.z||t.length,l=new Ti(s+o+5*(1+Math.ceil(o/7e3))+n),c=l.subarray(s,l.length-n),d=i.l,u=(i.r||0)&7;if(e){u&&(c[0]=i.r>>3);for(var A=e0e[e-1],h=A>>13,f=A&8191,p=(1<<r)-1,m=i.p||new zo(32768),g=i.h||new zo(p+1),y=Math.ceil(r/3),v=2*y,x=function(je){return(t[je]^t[je+1]<<y^t[je+2]<<v)&p},E=new eT(25e3),T=new zo(288),j=new zo(32),C=0,w=0,S=i.i||0,F=0,B=i.w||0,k=0;S+2<o;++S){var D=x(S),q=S&32767,te=g[D];if(m[q]=te,g[D]=q,B<=S){var W=o-S;if((C>7e3||F>24576)&&(W>423||!d)){u=UF(t,c,0,E,T,j,w,F,k,S-k,u),F=C=w=0,k=S;for(var Q=0;Q<286;++Q)T[Q]=0;for(var Q=0;Q<30;++Q)j[Q]=0}var re=2,G=0,Ae=f,he=q-te&32767;if(W>2&&D==x(S-he))for(var I=Math.min(h,W)-1,U=Math.min(32767,S),V=Math.min(258,W);he<=U&&--Ae&&q!=te;){if(t[S+re]==t[S+re-he]){for(var L=0;L<V&&t[S+L]==t[S+L-he];++L);if(L>re){if(re=L,G=he,L>I)break;for(var K=Math.min(he,L-2),fe=0,Q=0;Q<K;++Q){var ee=S-he+Q&32767,de=m[ee],ue=ee-de&32767;ue>fe&&(fe=ue,te=ee)}}}q=te,te=m[q],he+=q-te&32767}if(G){E[F++]=268435456|aS[re]<<18|LF[G];var Ie=aS[re]&31,Y=LF[G]&31;w+=TN[Ie]+IN[Y],++T[257+Ie],++j[Y],B=S+re,++C}else E[F++]=t[S],++T[t[S]]}}for(S=Math.max(S,B);S<o;++S)E[F++]=t[S],++T[t[S]];u=UF(t,c,d,E,T,j,w,F,k,S-k,u),d||(i.r=u&7|c[u/8|0]<<3,u-=7,i.h=g,i.p=m,i.i=S,i.w=B)}else{for(var S=i.w||0;S<o+d;S+=65535){var H=S+65535;H>=o&&(c[u/8|0]=d,H=o),u=oQ(c,u+1,t.subarray(S,H))}i.i=o}return iQ(l,0,s+tT(u)+n)},cQ=function(){var t=1,e=0;return{p:function(r){for(var s=t,n=e,i=r.length|0,o=0;o!=i;){for(var l=Math.min(o+2655,i);o<l;++o)n+=s+=r[o];s=(s&65535)+15*(s>>16),n=(n&65535)+15*(n>>16)}t=s,e=n},d:function(){return t%=65521,e%=65521,(t&255)<<24|(t&65280)<<8|(e&255)<<8|e>>8}}},r0e=function(t,e,r,s,n){if(!n&&(n={l:1},e.dictionary)){var i=e.dictionary.subarray(-32768),o=new Ti(i.length+t.length);o.set(i),o.set(t,i.length),t=o,n.w=i.length}return t0e(t,e.level==null?6:e.level,e.mem==null?n.l?Math.ceil(Math.max(8,Math.min(13,Math.log(t.length)))*1.5):20:12+e.mem,r,s,n)},dQ=function(t,e,r){for(;r;++e)t[e]=r,r>>>=8},s0e=function(t,e){var r=e.level,s=r==0?0:r<6?1:r==9?3:2;if(t[0]=120,t[1]=s<<6|(e.dictionary&&32),t[1]|=31-(t[0]<<8|t[1])%31,e.dictionary){var n=cQ();n.p(e.dictionary),dQ(t,2,n.d())}},n0e=function(t,e){return((t[0]&15)!=8||t[0]>>4>7||(t[0]<<8|t[1])%31)&&ec(6,"invalid zlib data"),(t[1]>>5&1)==1&&ec(6,"invalid zlib data: "+(t[1]&32?"need":"unexpected")+" dictionary"),(t[1]>>3&4)+2};function lS(t,e){e||(e={});var r=cQ();r.p(t);var s=r0e(t,e,e.dictionary?6:2,4);return s0e(s,e),dQ(s,s.length-4,r.d()),s}function a0e(t,e){return Zme(t.subarray(n0e(t),-4),{i:2},e,e)}var i0e=typeof TextDecoder<"u"&&new TextDecoder,o0e=0;try{i0e.decode(lQ,{stream:!0}),o0e=1}catch{}var Br=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function vC(){Br.console&&typeof Br.console.log=="function"&&Br.console.log.apply(Br.console,arguments)}var Gs={log:vC,warn:function(t){Br.console&&(typeof Br.console.warn=="function"?Br.console.warn.apply(Br.console,arguments):vC.call(null,arguments))},error:function(t){Br.console&&(typeof Br.console.error=="function"?Br.console.error.apply(Br.console,arguments):vC(t))}};function bC(t,e,r){var s=new XMLHttpRequest;s.open("GET",t),s.responseType="blob",s.onload=function(){Qh(s.response,e,r)},s.onerror=function(){Gs.error("could not download file")},s.send()}function MF(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function E1(t){try{t.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var jx,cS,Qh=Br.saveAs||((typeof window>"u"?"undefined":Us(window))!=="object"||window!==Br?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(t,e,r){var s=Br.URL||Br.webkitURL,n=document.createElement("a");e=e||t.name||"download",n.download=e,n.rel="noopener",typeof t=="string"?(n.href=t,n.origin!==location.origin?MF(n.href)?bC(t,e,r):E1(n,n.target="_blank"):E1(n)):(n.href=s.createObjectURL(t),setTimeout(function(){s.revokeObjectURL(n.href)},4e4),setTimeout(function(){E1(n)},0))}:"msSaveOrOpenBlob"in navigator?function(t,e,r){if(e=e||t.name||"download",typeof t=="string")if(MF(t))bC(t,e,r);else{var s=document.createElement("a");s.href=t,s.target="_blank",setTimeout(function(){E1(s)})}else navigator.msSaveOrOpenBlob(function(n,i){return i===void 0?i={autoBom:!1}:Us(i)!=="object"&&(Gs.warn("Deprecated: Expected third argument to be a object"),i={autoBom:!i}),i.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(n.type)?new Blob(["\uFEFF",n],{type:n.type}):n}(t,r),e)}:function(t,e,r,s){if((s=s||open("","_blank"))&&(s.document.title=s.document.body.innerText="downloading..."),typeof t=="string")return bC(t,e,r);var n=t.type==="application/octet-stream",i=/constructor/i.test(Br.HTMLElement)||Br.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||n&&i)&&(typeof FileReader>"u"?"undefined":Us(FileReader))==="object"){var l=new FileReader;l.onloadend=function(){var u=l.result;u=o?u:u.replace(/^data:[^;]*;/,"data:attachment/file;"),s?s.location.href=u:location=u,s=null},l.readAsDataURL(t)}else{var c=Br.URL||Br.webkitURL,d=c.createObjectURL(t);s?s.location=d:location.href=d,s=null,setTimeout(function(){c.revokeObjectURL(d)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function uQ(t){var e;t=t||"",this.ok=!1,t.charAt(0)=="#"&&(t=t.substr(1,6)),t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[t=(t=t.replace(/ /g,"")).toLowerCase()]||t;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(l){return[parseInt(l[1]),parseInt(l[2]),parseInt(l[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(l){return[parseInt(l[1],16),parseInt(l[2],16),parseInt(l[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(l){return[parseInt(l[1]+l[1],16),parseInt(l[2]+l[2],16),parseInt(l[3]+l[3],16)]}}],s=0;s<r.length;s++){var n=r[s].re,i=r[s].process,o=n.exec(t);o&&(e=i(o),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var l=this.r.toString(16),c=this.g.toString(16),d=this.b.toString(16);return l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),d.length==1&&(d="0"+d),"#"+l+c+d}}/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function wC(t,e){var r=t[0],s=t[1],n=t[2],i=t[3];r=mi(r,s,n,i,e[0],7,-680876936),i=mi(i,r,s,n,e[1],12,-389564586),n=mi(n,i,r,s,e[2],17,606105819),s=mi(s,n,i,r,e[3],22,-1044525330),r=mi(r,s,n,i,e[4],7,-176418897),i=mi(i,r,s,n,e[5],12,1200080426),n=mi(n,i,r,s,e[6],17,-1473231341),s=mi(s,n,i,r,e[7],22,-45705983),r=mi(r,s,n,i,e[8],7,1770035416),i=mi(i,r,s,n,e[9],12,-1958414417),n=mi(n,i,r,s,e[10],17,-42063),s=mi(s,n,i,r,e[11],22,-1990404162),r=mi(r,s,n,i,e[12],7,1804603682),i=mi(i,r,s,n,e[13],12,-40341101),n=mi(n,i,r,s,e[14],17,-1502002290),r=pi(r,s=mi(s,n,i,r,e[15],22,1236535329),n,i,e[1],5,-165796510),i=pi(i,r,s,n,e[6],9,-1069501632),n=pi(n,i,r,s,e[11],14,643717713),s=pi(s,n,i,r,e[0],20,-373897302),r=pi(r,s,n,i,e[5],5,-701558691),i=pi(i,r,s,n,e[10],9,38016083),n=pi(n,i,r,s,e[15],14,-660478335),s=pi(s,n,i,r,e[4],20,-405537848),r=pi(r,s,n,i,e[9],5,568446438),i=pi(i,r,s,n,e[14],9,-1019803690),n=pi(n,i,r,s,e[3],14,-187363961),s=pi(s,n,i,r,e[8],20,1163531501),r=pi(r,s,n,i,e[13],5,-1444681467),i=pi(i,r,s,n,e[2],9,-51403784),n=pi(n,i,r,s,e[7],14,1735328473),r=gi(r,s=pi(s,n,i,r,e[12],20,-1926607734),n,i,e[5],4,-378558),i=gi(i,r,s,n,e[8],11,-2022574463),n=gi(n,i,r,s,e[11],16,1839030562),s=gi(s,n,i,r,e[14],23,-35309556),r=gi(r,s,n,i,e[1],4,-1530992060),i=gi(i,r,s,n,e[4],11,1272893353),n=gi(n,i,r,s,e[7],16,-155497632),s=gi(s,n,i,r,e[10],23,-1094730640),r=gi(r,s,n,i,e[13],4,681279174),i=gi(i,r,s,n,e[0],11,-358537222),n=gi(n,i,r,s,e[3],16,-722521979),s=gi(s,n,i,r,e[6],23,76029189),r=gi(r,s,n,i,e[9],4,-640364487),i=gi(i,r,s,n,e[12],11,-421815835),n=gi(n,i,r,s,e[15],16,530742520),r=xi(r,s=gi(s,n,i,r,e[2],23,-995338651),n,i,e[0],6,-198630844),i=xi(i,r,s,n,e[7],10,1126891415),n=xi(n,i,r,s,e[14],15,-1416354905),s=xi(s,n,i,r,e[5],21,-57434055),r=xi(r,s,n,i,e[12],6,1700485571),i=xi(i,r,s,n,e[3],10,-1894986606),n=xi(n,i,r,s,e[10],15,-1051523),s=xi(s,n,i,r,e[1],21,-2054922799),r=xi(r,s,n,i,e[8],6,1873313359),i=xi(i,r,s,n,e[15],10,-30611744),n=xi(n,i,r,s,e[6],15,-1560198380),s=xi(s,n,i,r,e[13],21,1309151649),r=xi(r,s,n,i,e[4],6,-145523070),i=xi(i,r,s,n,e[11],10,-1120210379),n=xi(n,i,r,s,e[2],15,718787259),s=xi(s,n,i,r,e[9],21,-343485551),t[0]=vA(r,t[0]),t[1]=vA(s,t[1]),t[2]=vA(n,t[2]),t[3]=vA(i,t[3])}function kN(t,e,r,s,n,i){return e=vA(vA(e,t),vA(s,i)),vA(e<<n|e>>>32-n,r)}function mi(t,e,r,s,n,i,o){return kN(e&r|~e&s,t,e,n,i,o)}function pi(t,e,r,s,n,i,o){return kN(e&s|r&~s,t,e,n,i,o)}function gi(t,e,r,s,n,i,o){return kN(e^r^s,t,e,n,i,o)}function xi(t,e,r,s,n,i,o){return kN(r^(e|~s),t,e,n,i,o)}function AQ(t){var e,r=t.length,s=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=t.length;e+=64)wC(s,l0e(t.substring(e-64,e)));t=t.substring(e-64);var n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<t.length;e++)n[e>>2]|=t.charCodeAt(e)<<(e%4<<3);if(n[e>>2]|=128<<(e%4<<3),e>55)for(wC(s,n),e=0;e<16;e++)n[e]=0;return n[14]=8*r,wC(s,n),s}function l0e(t){var e,r=[];for(e=0;e<64;e+=4)r[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return r}jx=Br.atob.bind(Br),cS=Br.btoa.bind(Br);var QF="0123456789abcdef".split("");function c0e(t){for(var e="",r=0;r<4;r++)e+=QF[t>>8*r+4&15]+QF[t>>8*r&15];return e}function d0e(t){return String.fromCharCode((255&t)>>0,(65280&t)>>8,(16711680&t)>>16,(4278190080&t)>>24)}function dS(t){return AQ(t).map(d0e).join("")}var u0e=function(t){for(var e=0;e<t.length;e++)t[e]=c0e(t[e]);return t.join("")}(AQ("hello"))!="5d41402abc4b2a76b9719d911017c592";function vA(t,e){if(u0e){var r=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(r>>16)<<16|65535&r}return t+e&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function uS(t,e){var r,s,n,i;if(t!==r){for(var o=(n=t,i=1+(256/t.length>>0),new Array(i+1).join(n)),l=[],c=0;c<256;c++)l[c]=c;var d=0;for(c=0;c<256;c++){var u=l[c];d=(d+u+o.charCodeAt(c))%256,l[c]=l[d],l[d]=u}r=t,s=l}else l=s;var A=e.length,h=0,f=0,p="";for(c=0;c<A;c++)f=(f+(u=l[h=(h+1)%256]))%256,l[h]=l[f],l[f]=u,o=l[(l[h]+l[f])%256],p+=String.fromCharCode(e.charCodeAt(c)^o);return p}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var VF={print:4,modify:8,copy:16,"annot-forms":32};function e0(t,e,r,s){this.v=1,this.r=2;var n=192;t.forEach(function(l){if(VF.perm!==void 0)throw new Error("Invalid permission: "+l);n+=VF[l]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var i=(e+this.padding).substr(0,32),o=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(i,o),this.P=-(1+(255^n)),this.encryptionKey=dS(i+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(s)).substr(0,5),this.U=uS(this.encryptionKey,this.padding)}function t0(t){if(/[^\u0000-\u00ff]/.test(t))throw new Error("Invalid PDF Name Object: "+t+", Only accept ASCII characters.");for(var e="",r=t.length,s=0;s<r;s++){var n=t.charCodeAt(s);n<33||n===35||n===37||n===40||n===41||n===47||n===60||n===62||n===91||n===93||n===123||n===125||n>126?e+="#"+("0"+n.toString(16)).slice(-2):e+=t[s]}return e}function HF(t){if(Us(t)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(r,s,n){if(n=n||!1,typeof r!="string"||typeof s!="function"||typeof n!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(r)||(e[r]={});var i=Math.random().toString(35);return e[r][i]=[s,!!n],i},this.unsubscribe=function(r){for(var s in e)if(e[s][r])return delete e[s][r],Object.keys(e[s]).length===0&&delete e[s],!0;return!1},this.publish=function(r){if(e.hasOwnProperty(r)){var s=Array.prototype.slice.call(arguments,1),n=[];for(var i in e[r]){var o=e[r][i];try{o[0].apply(t,s)}catch(l){Br.console&&Gs.error("jsPDF PubSub Error",l.message,l)}o[1]&&n.push(i)}n.length&&n.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function l2(t){if(!(this instanceof l2))return new l2(t);var e="opacity,stroke-opacity".split(",");for(var r in t)t.hasOwnProperty(r)&&e.indexOf(r)>=0&&(this[r]=t[r]);this.id="",this.objectNumber=-1}function hQ(t,e){this.gState=t,this.matrix=e,this.id="",this.objectNumber=-1}function Gh(t,e,r,s,n){if(!(this instanceof Gh))return new Gh(t,e,r,s,n);this.type=t==="axial"?2:3,this.coords=e,this.colors=r,hQ.call(this,s,n)}function w0(t,e,r,s,n){if(!(this instanceof w0))return new w0(t,e,r,s,n);this.boundingBox=t,this.xStep=e,this.yStep=r,this.stream="",this.cloneIndex=0,hQ.call(this,s,n)}function wr(t){var e,r=typeof arguments[0]=="string"?arguments[0]:"p",s=arguments[1],n=arguments[2],i=arguments[3],o=[],l=1,c=16,d="S",u=null;Us(t=t||{})==="object"&&(r=t.orientation,s=t.unit||s,n=t.format||n,i=t.compress||t.compressPdf||i,(u=t.encryption||null)!==null&&(u.userPassword=u.userPassword||"",u.ownerPassword=u.ownerPassword||"",u.userPermissions=u.userPermissions||[]),l=typeof t.userUnit=="number"?Math.abs(t.userUnit):1,t.precision!==void 0&&(e=t.precision),t.floatPrecision!==void 0&&(c=t.floatPrecision),d=t.defaultPathOperation||"S"),o=t.filters||(i===!0?["FlateEncode"]:o),s=s||"mm",r=(""+(r||"P")).toLowerCase();var A=t.putOnlyUsedFonts||!1,h={},f={internal:{},__private__:{}};f.__private__.PubSub=HF;var p="1.3",m=f.__private__.getPdfVersion=function(){return p};f.__private__.setPdfVersion=function(P){p=P};var g={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};f.__private__.getPageFormats=function(){return g};var y=f.__private__.getPageFormat=function(P){return g[P]};n=n||"a4";var v={COMPAT:"compat",ADVANCED:"advanced"},x=v.COMPAT;function E(){this.saveGraphicsState(),oe(new Ct(ke,0,0,-ke,0,di()*ke).toString()+" cm"),this.setFontSize(this.getFontSize()/ke),d="n",x=v.ADVANCED}function T(){this.restoreGraphicsState(),d="S",x=v.COMPAT}var j=f.__private__.combineFontStyleAndFontWeight=function(P,pe){if(P=="bold"&&pe=="normal"||P=="bold"&&pe==400||P=="normal"&&pe=="italic"||P=="bold"&&pe=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return pe&&(P=pe==400||pe==="normal"?P==="italic"?"italic":"normal":pe!=700&&pe!=="bold"||P!=="normal"?(pe==700?"bold":pe)+""+P:"bold"),P};f.advancedAPI=function(P){var pe=x===v.COMPAT;return pe&&E.call(this),typeof P!="function"||(P(this),pe&&T.call(this)),this},f.compatAPI=function(P){var pe=x===v.ADVANCED;return pe&&T.call(this),typeof P!="function"||(P(this),pe&&E.call(this)),this},f.isAdvancedAPI=function(){return x===v.ADVANCED};var C,w=function(P){if(x!==v.ADVANCED)throw new Error(P+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},S=f.roundToPrecision=f.__private__.roundToPrecision=function(P,pe){var $e=e||pe;if(isNaN(P)||isNaN($e))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return P.toFixed($e).replace(/0+$/,"")};C=f.hpf=f.__private__.hpf=typeof c=="number"?function(P){if(isNaN(P))throw new Error("Invalid argument passed to jsPDF.hpf");return S(P,c)}:c==="smart"?function(P){if(isNaN(P))throw new Error("Invalid argument passed to jsPDF.hpf");return S(P,P>-1&&P<1?16:5)}:function(P){if(isNaN(P))throw new Error("Invalid argument passed to jsPDF.hpf");return S(P,16)};var F=f.f2=f.__private__.f2=function(P){if(isNaN(P))throw new Error("Invalid argument passed to jsPDF.f2");return S(P,2)},B=f.__private__.f3=function(P){if(isNaN(P))throw new Error("Invalid argument passed to jsPDF.f3");return S(P,3)},k=f.scale=f.__private__.scale=function(P){if(isNaN(P))throw new Error("Invalid argument passed to jsPDF.scale");return x===v.COMPAT?P*ke:x===v.ADVANCED?P:void 0},D=function(P){return x===v.COMPAT?di()-P:x===v.ADVANCED?P:void 0},q=function(P){return k(D(P))};f.__private__.setPrecision=f.setPrecision=function(P){typeof parseInt(P,10)=="number"&&(e=parseInt(P,10))};var te,W="00000000000000000000000000000000",Q=f.__private__.getFileId=function(){return W},re=f.__private__.setFileId=function(P){return W=P!==void 0&&/^[a-fA-F0-9]{32}$/.test(P)?P.toUpperCase():W.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),u!==null&&(on=new e0(u.userPermissions,u.userPassword,u.ownerPassword,W)),W};f.setFileId=function(P){return re(P),this},f.getFileId=function(){return Q()};var G=f.__private__.convertDateToPDFDate=function(P){var pe=P.getTimezoneOffset(),$e=pe<0?"+":"-",tt=Math.floor(Math.abs(pe/60)),dt=Math.abs(pe%60),_t=[$e,V(tt),"'",V(dt),"'"].join("");return["D:",P.getFullYear(),V(P.getMonth()+1),V(P.getDate()),V(P.getHours()),V(P.getMinutes()),V(P.getSeconds()),_t].join("")},Ae=f.__private__.convertPDFDateToDate=function(P){var pe=parseInt(P.substr(2,4),10),$e=parseInt(P.substr(6,2),10)-1,tt=parseInt(P.substr(8,2),10),dt=parseInt(P.substr(10,2),10),_t=parseInt(P.substr(12,2),10),$t=parseInt(P.substr(14,2),10);return new Date(pe,$e,tt,dt,_t,$t,0)},he=f.__private__.setCreationDate=function(P){var pe;if(P===void 0&&(P=new Date),P instanceof Date)pe=G(P);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(P))throw new Error("Invalid argument passed to jsPDF.setCreationDate");pe=P}return te=pe},I=f.__private__.getCreationDate=function(P){var pe=te;return P==="jsDate"&&(pe=Ae(te)),pe};f.setCreationDate=function(P){return he(P),this},f.getCreationDate=function(P){return I(P)};var U,V=f.__private__.padd2=function(P){return("0"+parseInt(P)).slice(-2)},L=f.__private__.padd2Hex=function(P){return("00"+(P=P.toString())).substr(P.length)},K=0,fe=[],ee=[],de=0,ue=[],Ie=[],Y=!1,H=ee,je=function(){K=0,de=0,ee=[],fe=[],ue=[],se=Jr(),z=Jr()};f.__private__.setCustomOutputDestination=function(P){Y=!0,H=P};var Ce=function(P){Y||(H=P)};f.__private__.resetCustomOutputDestination=function(){Y=!1,H=ee};var oe=f.__private__.out=function(P){return P=P.toString(),de+=P.length+1,H.push(P),H},He=f.__private__.write=function(P){return oe(arguments.length===1?P.toString():Array.prototype.join.call(arguments," "))},ie=f.__private__.getArrayBuffer=function(P){for(var pe=P.length,$e=new ArrayBuffer(pe),tt=new Uint8Array($e);pe--;)tt[pe]=P.charCodeAt(pe);return $e},le=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];f.__private__.getStandardFonts=function(){return le};var ae=t.fontSize||16;f.__private__.setFontSize=f.setFontSize=function(P){return ae=x===v.ADVANCED?P/ke:P,this};var ve,we=f.__private__.getFontSize=f.getFontSize=function(){return x===v.COMPAT?ae:ae*ke},De=t.R2L||!1;f.__private__.setR2L=f.setR2L=function(P){return De=P,this},f.__private__.getR2L=f.getR2L=function(){return De};var Ve,me=f.__private__.setZoomMode=function(P){var pe=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(P))ve=P;else if(isNaN(P)){if(pe.indexOf(P)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+P+'" is not recognized.');ve=P}else ve=parseInt(P,10)};f.__private__.getZoomMode=function(){return ve};var Fe,Re=f.__private__.setPageMode=function(P){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(P)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+P+'" is not recognized.');Ve=P};f.__private__.getPageMode=function(){return Ve};var Be=f.__private__.setLayoutMode=function(P){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(P)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+P+'" is not recognized.');Fe=P};f.__private__.getLayoutMode=function(){return Fe},f.__private__.setDisplayMode=f.setDisplayMode=function(P,pe,$e){return me(P),Be(pe),Re($e),this};var X={title:"",subject:"",author:"",keywords:"",creator:""};f.__private__.getDocumentProperty=function(P){if(Object.keys(X).indexOf(P)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return X[P]},f.__private__.getDocumentProperties=function(){return X},f.__private__.setDocumentProperties=f.setProperties=f.setDocumentProperties=function(P){for(var pe in X)X.hasOwnProperty(pe)&&P[pe]&&(X[pe]=P[pe]);return this},f.__private__.setDocumentProperty=function(P,pe){if(Object.keys(X).indexOf(P)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return X[P]=pe};var _e,ke,lt,mt,pt,ze={},Me={},rt=[],ht={},Qe={},Ge={},gt={},St=null,Vt=0,Kt=[],qe=new HF(f),Xe=t.hotfixes||[],Ke={},We={},Ft=[],Ct=function P(pe,$e,tt,dt,_t,$t){if(!(this instanceof P))return new P(pe,$e,tt,dt,_t,$t);isNaN(pe)&&(pe=1),isNaN($e)&&($e=0),isNaN(tt)&&(tt=0),isNaN(dt)&&(dt=1),isNaN(_t)&&(_t=0),isNaN($t)&&($t=0),this._matrix=[pe,$e,tt,dt,_t,$t]};Object.defineProperty(Ct.prototype,"sx",{get:function(){return this._matrix[0]},set:function(P){this._matrix[0]=P}}),Object.defineProperty(Ct.prototype,"shy",{get:function(){return this._matrix[1]},set:function(P){this._matrix[1]=P}}),Object.defineProperty(Ct.prototype,"shx",{get:function(){return this._matrix[2]},set:function(P){this._matrix[2]=P}}),Object.defineProperty(Ct.prototype,"sy",{get:function(){return this._matrix[3]},set:function(P){this._matrix[3]=P}}),Object.defineProperty(Ct.prototype,"tx",{get:function(){return this._matrix[4]},set:function(P){this._matrix[4]=P}}),Object.defineProperty(Ct.prototype,"ty",{get:function(){return this._matrix[5]},set:function(P){this._matrix[5]=P}}),Object.defineProperty(Ct.prototype,"a",{get:function(){return this._matrix[0]},set:function(P){this._matrix[0]=P}}),Object.defineProperty(Ct.prototype,"b",{get:function(){return this._matrix[1]},set:function(P){this._matrix[1]=P}}),Object.defineProperty(Ct.prototype,"c",{get:function(){return this._matrix[2]},set:function(P){this._matrix[2]=P}}),Object.defineProperty(Ct.prototype,"d",{get:function(){return this._matrix[3]},set:function(P){this._matrix[3]=P}}),Object.defineProperty(Ct.prototype,"e",{get:function(){return this._matrix[4]},set:function(P){this._matrix[4]=P}}),Object.defineProperty(Ct.prototype,"f",{get:function(){return this._matrix[5]},set:function(P){this._matrix[5]=P}}),Object.defineProperty(Ct.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Ct.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Ct.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Ct.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Ct.prototype.join=function(P){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(C).join(P)},Ct.prototype.multiply=function(P){var pe=P.sx*this.sx+P.shy*this.shx,$e=P.sx*this.shy+P.shy*this.sy,tt=P.shx*this.sx+P.sy*this.shx,dt=P.shx*this.shy+P.sy*this.sy,_t=P.tx*this.sx+P.ty*this.shx+this.tx,$t=P.tx*this.shy+P.ty*this.sy+this.ty;return new Ct(pe,$e,tt,dt,_t,$t)},Ct.prototype.decompose=function(){var P=this.sx,pe=this.shy,$e=this.shx,tt=this.sy,dt=this.tx,_t=this.ty,$t=Math.sqrt(P*P+pe*pe),sr=(P/=$t)*$e+(pe/=$t)*tt;$e-=P*sr,tt-=pe*sr;var N=Math.sqrt($e*$e+tt*tt);return sr/=N,P*(tt/=N)<pe*($e/=N)&&(P=-P,pe=-pe,sr=-sr,$t=-$t),{scale:new Ct($t,0,0,N,0,0),translate:new Ct(1,0,0,1,dt,_t),rotate:new Ct(P,pe,-pe,P,0,0),skew:new Ct(1,0,sr,1,0,0)}},Ct.prototype.toString=function(P){return this.join(" ")},Ct.prototype.inversed=function(){var P=this.sx,pe=this.shy,$e=this.shx,tt=this.sy,dt=this.tx,_t=this.ty,$t=1/(P*tt-pe*$e),sr=tt*$t,N=-pe*$t,M=-$e*$t,ne=P*$t;return new Ct(sr,N,M,ne,-sr*dt-M*_t,-N*dt-ne*_t)},Ct.prototype.applyToPoint=function(P){var pe=P.x*this.sx+P.y*this.shx+this.tx,$e=P.x*this.shy+P.y*this.sy+this.ty;return new md(pe,$e)},Ct.prototype.applyToRectangle=function(P){var pe=this.applyToPoint(P),$e=this.applyToPoint(new md(P.x+P.w,P.y+P.h));return new Eu(pe.x,pe.y,$e.x-pe.x,$e.y-pe.y)},Ct.prototype.clone=function(){var P=this.sx,pe=this.shy,$e=this.shx,tt=this.sy,dt=this.tx,_t=this.ty;return new Ct(P,pe,$e,tt,dt,_t)},f.Matrix=Ct;var xr=f.matrixMult=function(P,pe){return pe.multiply(P)},vr=new Ct(1,0,0,1,0,0);f.unitMatrix=f.identityMatrix=vr;var Pr=function(P,pe){if(!Qe[P]){var $e=(pe instanceof Gh?"Sh":"P")+(Object.keys(ht).length+1).toString(10);pe.id=$e,Qe[P]=$e,ht[$e]=pe,qe.publish("addPattern",pe)}};f.ShadingPattern=Gh,f.TilingPattern=w0,f.addShadingPattern=function(P,pe){return w("addShadingPattern()"),Pr(P,pe),this},f.beginTilingPattern=function(P){w("beginTilingPattern()"),_u(P.boundingBox[0],P.boundingBox[1],P.boundingBox[2]-P.boundingBox[0],P.boundingBox[3]-P.boundingBox[1],P.matrix)},f.endTilingPattern=function(P,pe){w("endTilingPattern()"),pe.stream=Ie[U].join(`
`),Pr(P,pe),qe.publish("endTilingPattern",pe),Ft.pop().restore()};var Mr=f.__private__.newObject=function(){var P=Jr();return ye(P,!0),P},Jr=f.__private__.newObjectDeferred=function(){return K++,fe[K]=function(){return de},K},ye=function(P,pe){return pe=typeof pe=="boolean"&&pe,fe[P]=de,pe&&oe(P+" 0 obj"),P},Le=f.__private__.newAdditionalObject=function(){var P={objId:Jr(),content:""};return ue.push(P),P},se=Jr(),z=Jr(),ce=f.__private__.decodeColorString=function(P){var pe=P.split(" ");if(pe.length!==2||pe[1]!=="g"&&pe[1]!=="G")pe.length===5&&(pe[4]==="k"||pe[4]==="K")&&(pe=[(1-pe[0])*(1-pe[3]),(1-pe[1])*(1-pe[3]),(1-pe[2])*(1-pe[3]),"r"]);else{var $e=parseFloat(pe[0]);pe=[$e,$e,$e,"r"]}for(var tt="#",dt=0;dt<3;dt++)tt+=("0"+Math.floor(255*parseFloat(pe[dt])).toString(16)).slice(-2);return tt},xe=f.__private__.encodeColorString=function(P){var pe;typeof P=="string"&&(P={ch1:P});var $e=P.ch1,tt=P.ch2,dt=P.ch3,_t=P.ch4,$t=P.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof $e=="string"&&$e.charAt(0)!=="#"){var sr=new uQ($e);if(sr.ok)$e=sr.toHex();else if(!/^\d*\.?\d*$/.test($e))throw new Error('Invalid color "'+$e+'" passed to jsPDF.encodeColorString.')}if(typeof $e=="string"&&/^#[0-9A-Fa-f]{3}$/.test($e)&&($e="#"+$e[1]+$e[1]+$e[2]+$e[2]+$e[3]+$e[3]),typeof $e=="string"&&/^#[0-9A-Fa-f]{6}$/.test($e)){var N=parseInt($e.substr(1),16);$e=N>>16&255,tt=N>>8&255,dt=255&N}if(tt===void 0||_t===void 0&&$e===tt&&tt===dt)if(typeof $e=="string")pe=$e+" "+$t[0];else switch(P.precision){case 2:pe=F($e/255)+" "+$t[0];break;case 3:default:pe=B($e/255)+" "+$t[0]}else if(_t===void 0||Us(_t)==="object"){if(_t&&!isNaN(_t.a)&&_t.a===0)return pe=["1.","1.","1.",$t[1]].join(" ");if(typeof $e=="string")pe=[$e,tt,dt,$t[1]].join(" ");else switch(P.precision){case 2:pe=[F($e/255),F(tt/255),F(dt/255),$t[1]].join(" ");break;default:case 3:pe=[B($e/255),B(tt/255),B(dt/255),$t[1]].join(" ")}}else if(typeof $e=="string")pe=[$e,tt,dt,_t,$t[2]].join(" ");else switch(P.precision){case 2:pe=[F($e),F(tt),F(dt),F(_t),$t[2]].join(" ");break;case 3:default:pe=[B($e),B(tt),B(dt),B(_t),$t[2]].join(" ")}return pe},Pe=f.__private__.getFilters=function(){return o},Ze=f.__private__.putStream=function(P){var pe=(P=P||{}).data||"",$e=P.filters||Pe(),tt=P.alreadyAppliedFilters||[],dt=P.addLength1||!1,_t=pe.length,$t=P.objectId,sr=function(Qr){return Qr};if(u!==null&&$t===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");u!==null&&(sr=on.encryptor($t,0));var N={};$e===!0&&($e=["FlateEncode"]);var M=P.additionalKeyValues||[],ne=(N=wr.API.processDataByFilters!==void 0?wr.API.processDataByFilters(pe,$e):{data:pe,reverseChain:[]}).reverseChain+(Array.isArray(tt)?tt.join(" "):tt.toString());if(N.data.length!==0&&(M.push({key:"Length",value:N.data.length}),dt===!0&&M.push({key:"Length1",value:_t})),ne.length!=0)if(ne.split("/").length-1==1)M.push({key:"Filter",value:ne});else{M.push({key:"Filter",value:"["+ne+"]"});for(var Se=0;Se<M.length;Se+=1)if(M[Se].key==="DecodeParms"){for(var ct=[],vt=0;vt<N.reverseChain.split("/").length-1;vt+=1)ct.push("null");ct.push(M[Se].value),M[Se].value="["+ct.join(" ")+"]"}}oe("<<");for(var zt=0;zt<M.length;zt++)oe("/"+M[zt].key+" "+M[zt].value);oe(">>"),N.data.length!==0&&(oe("stream"),oe(sr(N.data)),oe("endstream"))},Ye=f.__private__.putPage=function(P){var pe=P.number,$e=P.data,tt=P.objId,dt=P.contentsObjId;ye(tt,!0),oe("<</Type /Page"),oe("/Parent "+P.rootDictionaryObjId+" 0 R"),oe("/Resources "+P.resourceDictionaryObjId+" 0 R"),oe("/MediaBox ["+parseFloat(C(P.mediaBox.bottomLeftX))+" "+parseFloat(C(P.mediaBox.bottomLeftY))+" "+C(P.mediaBox.topRightX)+" "+C(P.mediaBox.topRightY)+"]"),P.cropBox!==null&&oe("/CropBox ["+C(P.cropBox.bottomLeftX)+" "+C(P.cropBox.bottomLeftY)+" "+C(P.cropBox.topRightX)+" "+C(P.cropBox.topRightY)+"]"),P.bleedBox!==null&&oe("/BleedBox ["+C(P.bleedBox.bottomLeftX)+" "+C(P.bleedBox.bottomLeftY)+" "+C(P.bleedBox.topRightX)+" "+C(P.bleedBox.topRightY)+"]"),P.trimBox!==null&&oe("/TrimBox ["+C(P.trimBox.bottomLeftX)+" "+C(P.trimBox.bottomLeftY)+" "+C(P.trimBox.topRightX)+" "+C(P.trimBox.topRightY)+"]"),P.artBox!==null&&oe("/ArtBox ["+C(P.artBox.bottomLeftX)+" "+C(P.artBox.bottomLeftY)+" "+C(P.artBox.topRightX)+" "+C(P.artBox.topRightY)+"]"),typeof P.userUnit=="number"&&P.userUnit!==1&&oe("/UserUnit "+P.userUnit),qe.publish("putPage",{objId:tt,pageContext:Kt[pe],pageNumber:pe,page:$e}),oe("/Contents "+dt+" 0 R"),oe(">>"),oe("endobj");var _t=$e.join(`
`);return x===v.ADVANCED&&(_t+=`
Q`),ye(dt,!0),Ze({data:_t,filters:Pe(),objectId:dt}),oe("endobj"),tt},Je=f.__private__.putPages=function(){var P,pe,$e=[];for(P=1;P<=Vt;P++)Kt[P].objId=Jr(),Kt[P].contentsObjId=Jr();for(P=1;P<=Vt;P++)$e.push(Ye({number:P,data:Ie[P],objId:Kt[P].objId,contentsObjId:Kt[P].contentsObjId,mediaBox:Kt[P].mediaBox,cropBox:Kt[P].cropBox,bleedBox:Kt[P].bleedBox,trimBox:Kt[P].trimBox,artBox:Kt[P].artBox,userUnit:Kt[P].userUnit,rootDictionaryObjId:se,resourceDictionaryObjId:z}));ye(se,!0),oe("<</Type /Pages");var tt="/Kids [";for(pe=0;pe<Vt;pe++)tt+=$e[pe]+" 0 R ";oe(tt+"]"),oe("/Count "+Vt),oe(">>"),oe("endobj"),qe.publish("postPutPages")},et=function(P){qe.publish("putFont",{font:P,out:oe,newObject:Mr,putStream:Ze}),P.isAlreadyPutted!==!0&&(P.objectNumber=Mr(),oe("<<"),oe("/Type /Font"),oe("/BaseFont /"+t0(P.postScriptName)),oe("/Subtype /Type1"),typeof P.encoding=="string"&&oe("/Encoding /"+P.encoding),oe("/FirstChar 32"),oe("/LastChar 255"),oe(">>"),oe("endobj"))},ft=function(){for(var P in ze)ze.hasOwnProperty(P)&&(A===!1||A===!0&&h.hasOwnProperty(P))&&et(ze[P])},At=function(P){P.objectNumber=Mr();var pe=[];pe.push({key:"Type",value:"/XObject"}),pe.push({key:"Subtype",value:"/Form"}),pe.push({key:"BBox",value:"["+[C(P.x),C(P.y),C(P.x+P.width),C(P.y+P.height)].join(" ")+"]"}),pe.push({key:"Matrix",value:"["+P.matrix.toString()+"]"});var $e=P.pages[1].join(`
`);Ze({data:$e,additionalKeyValues:pe,objectId:P.objectNumber}),oe("endobj")},Nt=function(){for(var P in Ke)Ke.hasOwnProperty(P)&&At(Ke[P])},kt=function(P,pe){var $e,tt=[],dt=1/(pe-1);for($e=0;$e<1;$e+=dt)tt.push($e);if(tt.push(1),P[0].offset!=0){var _t={offset:0,color:P[0].color};P.unshift(_t)}if(P[P.length-1].offset!=1){var $t={offset:1,color:P[P.length-1].color};P.push($t)}for(var sr="",N=0,M=0;M<tt.length;M++){for($e=tt[M];$e>P[N+1].offset;)N++;var ne=P[N].offset,Se=($e-ne)/(P[N+1].offset-ne),ct=P[N].color,vt=P[N+1].color;sr+=L(Math.round((1-Se)*ct[0]+Se*vt[0]).toString(16))+L(Math.round((1-Se)*ct[1]+Se*vt[1]).toString(16))+L(Math.round((1-Se)*ct[2]+Se*vt[2]).toString(16))}return sr.trim()},Ht=function(P,pe){pe||(pe=21);var $e=Mr(),tt=kt(P.colors,pe),dt=[];dt.push({key:"FunctionType",value:"0"}),dt.push({key:"Domain",value:"[0.0 1.0]"}),dt.push({key:"Size",value:"["+pe+"]"}),dt.push({key:"BitsPerSample",value:"8"}),dt.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),dt.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Ze({data:tt,additionalKeyValues:dt,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:$e}),oe("endobj"),P.objectNumber=Mr(),oe("<< /ShadingType "+P.type),oe("/ColorSpace /DeviceRGB");var _t="/Coords ["+C(parseFloat(P.coords[0]))+" "+C(parseFloat(P.coords[1]))+" ";P.type===2?_t+=C(parseFloat(P.coords[2]))+" "+C(parseFloat(P.coords[3])):_t+=C(parseFloat(P.coords[2]))+" "+C(parseFloat(P.coords[3]))+" "+C(parseFloat(P.coords[4]))+" "+C(parseFloat(P.coords[5])),oe(_t+="]"),P.matrix&&oe("/Matrix ["+P.matrix.toString()+"]"),oe("/Function "+$e+" 0 R"),oe("/Extend [true true]"),oe(">>"),oe("endobj")},ir=function(P,pe){var $e=Jr(),tt=Mr();pe.push({resourcesOid:$e,objectOid:tt}),P.objectNumber=tt;var dt=[];dt.push({key:"Type",value:"/Pattern"}),dt.push({key:"PatternType",value:"1"}),dt.push({key:"PaintType",value:"1"}),dt.push({key:"TilingType",value:"1"}),dt.push({key:"BBox",value:"["+P.boundingBox.map(C).join(" ")+"]"}),dt.push({key:"XStep",value:C(P.xStep)}),dt.push({key:"YStep",value:C(P.yStep)}),dt.push({key:"Resources",value:$e+" 0 R"}),P.matrix&&dt.push({key:"Matrix",value:"["+P.matrix.toString()+"]"}),Ze({data:P.stream,additionalKeyValues:dt,objectId:P.objectNumber}),oe("endobj")},Ar=function(P){var pe;for(pe in ht)ht.hasOwnProperty(pe)&&(ht[pe]instanceof Gh?Ht(ht[pe]):ht[pe]instanceof w0&&ir(ht[pe],P))},or=function(P){for(var pe in P.objectNumber=Mr(),oe("<<"),P)switch(pe){case"opacity":oe("/ca "+F(P[pe]));break;case"stroke-opacity":oe("/CA "+F(P[pe]))}oe(">>"),oe("endobj")},ns=function(){var P;for(P in Ge)Ge.hasOwnProperty(P)&&or(Ge[P])},Ia=function(){for(var P in oe("/XObject <<"),Ke)Ke.hasOwnProperty(P)&&Ke[P].objectNumber>=0&&oe("/"+P+" "+Ke[P].objectNumber+" 0 R");qe.publish("putXobjectDict"),oe(">>")},so=function(){on.oid=Mr(),oe("<<"),oe("/Filter /Standard"),oe("/V "+on.v),oe("/R "+on.r),oe("/U <"+on.toHexString(on.U)+">"),oe("/O <"+on.toHexString(on.O)+">"),oe("/P "+on.P),oe(">>"),oe("endobj")},li=function(){for(var P in oe("/Font <<"),ze)ze.hasOwnProperty(P)&&(A===!1||A===!0&&h.hasOwnProperty(P))&&oe("/"+P+" "+ze[P].objectNumber+" 0 R");oe(">>")},Ka=function(){if(Object.keys(ht).length>0){for(var P in oe("/Shading <<"),ht)ht.hasOwnProperty(P)&&ht[P]instanceof Gh&&ht[P].objectNumber>=0&&oe("/"+P+" "+ht[P].objectNumber+" 0 R");qe.publish("putShadingPatternDict"),oe(">>")}},ot=function(P){if(Object.keys(ht).length>0){for(var pe in oe("/Pattern <<"),ht)ht.hasOwnProperty(pe)&&ht[pe]instanceof f.TilingPattern&&ht[pe].objectNumber>=0&&ht[pe].objectNumber<P&&oe("/"+pe+" "+ht[pe].objectNumber+" 0 R");qe.publish("putTilingPatternDict"),oe(">>")}},Pt=function(){if(Object.keys(Ge).length>0){var P;for(P in oe("/ExtGState <<"),Ge)Ge.hasOwnProperty(P)&&Ge[P].objectNumber>=0&&oe("/"+P+" "+Ge[P].objectNumber+" 0 R");qe.publish("putGStateDict"),oe(">>")}},jt=function(P){ye(P.resourcesOid,!0),oe("<<"),oe("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),li(),Ka(),ot(P.objectOid),Pt(),Ia(),oe(">>"),oe("endobj")},Lt=function(){var P=[];ft(),ns(),Nt(),Ar(P),qe.publish("putResources"),P.forEach(jt),jt({resourcesOid:z,objectOid:Number.MAX_SAFE_INTEGER}),qe.publish("postPutResources")},Er=function(){qe.publish("putAdditionalObjects");for(var P=0;P<ue.length;P++){var pe=ue[P];ye(pe.objId,!0),oe(pe.content),oe("endobj")}qe.publish("postPutAdditionalObjects")},_r=function(P){Me[P.fontName]=Me[P.fontName]||{},Me[P.fontName][P.fontStyle]=P.id},jr=function(P,pe,$e,tt,dt){var _t={id:"F"+(Object.keys(ze).length+1).toString(10),postScriptName:P,fontName:pe,fontStyle:$e,encoding:tt,isStandardFont:dt||!1,metadata:{}};return qe.publish("addFont",{font:_t,instance:this}),ze[_t.id]=_t,_r(_t),_t.id},ms=function(P){for(var pe=0,$e=le.length;pe<$e;pe++){var tt=jr.call(this,P[pe][0],P[pe][1],P[pe][2],le[pe][3],!0);A===!1&&(h[tt]=!0);var dt=P[pe][0].split("-");_r({id:tt,fontName:dt[0],fontStyle:dt[1]||""})}qe.publish("addFonts",{fonts:ze,dictionary:Me})},Qs=function(P){return P.foo=function(){try{return P.apply(this,arguments)}catch(tt){var pe=tt.stack||"";~pe.indexOf(" at ")&&(pe=pe.split(" at ")[1]);var $e="Error in function "+pe.split(`
`)[0].split("<")[0]+": "+tt.message;if(!Br.console)throw new Error($e);Br.console.error($e,tt),Br.alert&&alert($e)}},P.foo.bar=P,P.foo},ci=function(P,pe){var $e,tt,dt,_t,$t,sr,N,M,ne;if(dt=(pe=pe||{}).sourceEncoding||"Unicode",$t=pe.outputEncoding,(pe.autoencode||$t)&&ze[_e].metadata&&ze[_e].metadata[dt]&&ze[_e].metadata[dt].encoding&&(_t=ze[_e].metadata[dt].encoding,!$t&&ze[_e].encoding&&($t=ze[_e].encoding),!$t&&_t.codePages&&($t=_t.codePages[0]),typeof $t=="string"&&($t=_t[$t]),$t)){for(N=!1,sr=[],$e=0,tt=P.length;$e<tt;$e++)(M=$t[P.charCodeAt($e)])?sr.push(String.fromCharCode(M)):sr.push(P[$e]),sr[$e].charCodeAt(0)>>8&&(N=!0);P=sr.join("")}for($e=P.length;N===void 0&&$e!==0;)P.charCodeAt($e-1)>>8&&(N=!0),$e--;if(!N)return P;for(sr=pe.noBOM?[]:[254,255],$e=0,tt=P.length;$e<tt;$e++){if((ne=(M=P.charCodeAt($e))>>8)>>8)throw new Error("Character at position "+$e+" of string '"+P+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");sr.push(ne),sr.push(M-(ne<<8))}return String.fromCharCode.apply(void 0,sr)},ps=f.__private__.pdfEscape=f.pdfEscape=function(P,pe){return ci(P,pe).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},us=f.__private__.beginPage=function(P){Ie[++Vt]=[],Kt[Vt]={objId:0,contentsObjId:0,userUnit:Number(l),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(P[0]),topRightY:Number(P[1])}},vh(Vt),Ce(Ie[U])},kn=function(P,pe){var $e,tt,dt;switch(r=pe||r,typeof P=="string"&&($e=y(P.toLowerCase()),Array.isArray($e)&&(tt=$e[0],dt=$e[1])),Array.isArray(P)&&(tt=P[0]*ke,dt=P[1]*ke),isNaN(tt)&&(tt=n[0],dt=n[1]),(tt>14400||dt>14400)&&(Gs.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),tt=Math.min(14400,tt),dt=Math.min(14400,dt)),n=[tt,dt],r.substr(0,1)){case"l":dt>tt&&(n=[dt,tt]);break;case"p":tt>dt&&(n=[dt,tt])}us(n),jh(Ch),oe(za),_h!==0&&oe(_h+" J"),Su!==0&&oe(Su+" j"),qe.publish("addPage",{pageNumber:Vt})},sl=function(P){P>0&&P<=Vt&&(Ie.splice(P,1),Kt.splice(P,1),Vt--,U>Vt&&(U=Vt),this.setPage(U))},vh=function(P){P>0&&P<=Vt&&(U=P)},ks=f.__private__.getNumberOfPages=f.getNumberOfPages=function(){return Ie.length-1},ud=function(P,pe,$e){var tt,dt=void 0;return $e=$e||{},P=P!==void 0?P:ze[_e].fontName,pe=pe!==void 0?pe:ze[_e].fontStyle,tt=P.toLowerCase(),Me[tt]!==void 0&&Me[tt][pe]!==void 0?dt=Me[tt][pe]:Me[P]!==void 0&&Me[P][pe]!==void 0?dt=Me[P][pe]:$e.disableWarning===!1&&Gs.warn("Unable to look up font label for font '"+P+"', '"+pe+"'. Refer to getFontList() for available fonts."),dt||$e.noFallback||(dt=Me.times[pe])==null&&(dt=Me.times.normal),dt},Ad=f.__private__.putInfo=function(){var P=Mr(),pe=function(tt){return tt};for(var $e in u!==null&&(pe=on.encryptor(P,0)),oe("<<"),oe("/Producer ("+ps(pe("jsPDF "+wr.version))+")"),X)X.hasOwnProperty($e)&&X[$e]&&oe("/"+$e.substr(0,1).toUpperCase()+$e.substr(1)+" ("+ps(pe(X[$e]))+")");oe("/CreationDate ("+ps(pe(te))+")"),oe(">>"),oe("endobj")},Ul=f.__private__.putCatalog=function(P){var pe=(P=P||{}).rootDictionaryObjId||se;switch(Mr(),oe("<<"),oe("/Type /Catalog"),oe("/Pages "+pe+" 0 R"),ve||(ve="fullwidth"),ve){case"fullwidth":oe("/OpenAction [3 0 R /FitH null]");break;case"fullheight":oe("/OpenAction [3 0 R /FitV null]");break;case"fullpage":oe("/OpenAction [3 0 R /Fit]");break;case"original":oe("/OpenAction [3 0 R /XYZ null null 1]");break;default:var $e=""+ve;$e.substr($e.length-1)==="%"&&(ve=parseInt(ve)/100),typeof ve=="number"&&oe("/OpenAction [3 0 R /XYZ null null "+F(ve)+"]")}switch(Fe||(Fe="continuous"),Fe){case"continuous":oe("/PageLayout /OneColumn");break;case"single":oe("/PageLayout /SinglePage");break;case"two":case"twoleft":oe("/PageLayout /TwoColumnLeft");break;case"tworight":oe("/PageLayout /TwoColumnRight")}Ve&&oe("/PageMode /"+Ve),qe.publish("putCatalog"),oe(">>"),oe("endobj")},Vp=f.__private__.putTrailer=function(){oe("trailer"),oe("<<"),oe("/Size "+(K+1)),oe("/Root "+K+" 0 R"),oe("/Info "+(K-1)+" 0 R"),u!==null&&oe("/Encrypt "+on.oid+" 0 R"),oe("/ID [ <"+W+"> <"+W+"> ]"),oe(">>")},om=f.__private__.putHeader=function(){oe("%PDF-"+p),oe("%")},Hp=f.__private__.putXRef=function(){var P="0000000000";oe("xref"),oe("0 "+(K+1)),oe("0000000000 65535 f ");for(var pe=1;pe<=K;pe++)typeof fe[pe]=="function"?oe((P+fe[pe]()).slice(-10)+" 00000 n "):fe[pe]!==void 0?oe((P+fe[pe]).slice(-10)+" 00000 n "):oe("0000000000 00000 n ")},Ml=f.__private__.buildDocument=function(){je(),Ce(ee),qe.publish("buildDocument"),om(),Je(),Er(),Lt(),u!==null&&so(),Ad(),Ul();var P=de;return Hp(),Vp(),oe("startxref"),oe(""+P),oe("%%EOF"),Ce(Ie[U]),ee.join(`
`)},gu=f.__private__.getBlob=function(P){return new Blob([ie(P)],{type:"application/pdf"})},xu=f.output=f.__private__.output=Qs(function(P,pe){switch(typeof(pe=pe||{})=="string"?pe={filename:pe}:pe.filename=pe.filename||"generated.pdf",P){case void 0:return Ml();case"save":f.save(pe.filename);break;case"arraybuffer":return ie(Ml());case"blob":return gu(Ml());case"bloburi":case"bloburl":if(Br.URL!==void 0&&typeof Br.URL.createObjectURL=="function")return Br.URL&&Br.URL.createObjectURL(gu(Ml()))||void 0;Gs.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var $e="",tt=Ml();try{$e=cS(tt)}catch{$e=cS(unescape(encodeURIComponent(tt)))}return"data:application/pdf;filename="+pe.filename+";base64,"+$e;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Br)==="[object Window]"){var dt="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",_t=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';pe.pdfObjectUrl&&(dt=pe.pdfObjectUrl,_t="");var $t='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+dt+'"'+_t+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(pe)+");<\/script></body></html>",sr=Br.open();return sr!==null&&sr.document.write($t),sr}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Br)==="[object Window]"){var N='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(pe.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+pe.filename+'" width="500px" height="400px" /></body></html>',M=Br.open();if(M!==null){M.document.write(N);var ne=this;M.document.documentElement.querySelector("#pdfViewer").onload=function(){M.document.title=pe.filename,M.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(ne.output("bloburl"))}}return M}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Br)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Se='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",pe)+'"></iframe></body></html>',ct=Br.open();if(ct!==null&&(ct.document.write(Se),ct.document.title=pe.filename),ct||typeof safari>"u")return ct;break;case"datauri":case"dataurl":return Br.document.location.href=this.output("datauristring",pe);default:return null}}),bc=function(P){return Array.isArray(Xe)===!0&&Xe.indexOf(P)>-1};switch(s){case"pt":ke=1;break;case"mm":ke=72/25.4;break;case"cm":ke=72/2.54;break;case"in":ke=72;break;case"px":ke=bc("px_scaling")==1?.75:96/72;break;case"pc":case"em":ke=12;break;case"ex":ke=6;break;default:if(typeof s!="number")throw new Error("Invalid unit: "+s);ke=s}var on=null;he(),re();var lm=function(P){return u!==null?on.encryptor(P,0):function(pe){return pe}},bh=f.__private__.getPageInfo=f.getPageInfo=function(P){if(isNaN(P)||P%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Kt[P].objId,pageNumber:P,pageContext:Kt[P]}},Dr=f.__private__.getPageInfoByObjId=function(P){if(isNaN(P)||P%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var pe in Kt)if(Kt[pe].objId===P)break;return bh(pe)},wc=f.__private__.getCurrentPageInfo=f.getCurrentPageInfo=function(){return{objId:Kt[U].objId,pageNumber:U,pageContext:Kt[U]}};f.addPage=function(){return kn.apply(this,arguments),this},f.setPage=function(){return vh.apply(this,arguments),Ce.call(this,Ie[U]),this},f.insertPage=function(P){return this.addPage(),this.movePage(U,P),this},f.movePage=function(P,pe){var $e,tt;if(P>pe){$e=Ie[P],tt=Kt[P];for(var dt=P;dt>pe;dt--)Ie[dt]=Ie[dt-1],Kt[dt]=Kt[dt-1];Ie[pe]=$e,Kt[pe]=tt,this.setPage(pe)}else if(P<pe){$e=Ie[P],tt=Kt[P];for(var _t=P;_t<pe;_t++)Ie[_t]=Ie[_t+1],Kt[_t]=Kt[_t+1];Ie[pe]=$e,Kt[pe]=tt,this.setPage(pe)}return this},f.deletePage=function(){return sl.apply(this,arguments),this},f.__private__.text=f.text=function(P,pe,$e,tt,dt){var _t,$t,sr,N,M,ne,Se,ct,vt,zt=(tt=tt||{}).scope||this;if(typeof P=="number"&&typeof pe=="number"&&(typeof $e=="string"||Array.isArray($e))){var Qr=$e;$e=pe,pe=P,P=Qr}if(arguments[3]instanceof Ct?(w("The transform parameter of text() with a Matrix value"),vt=dt):(sr=arguments[4],N=arguments[5],Us(Se=arguments[3])==="object"&&Se!==null||(typeof sr=="string"&&(N=sr,sr=null),typeof Se=="string"&&(N=Se,Se=null),typeof Se=="number"&&(sr=Se,Se=null),tt={flags:Se,angle:sr,align:N})),isNaN(pe)||isNaN($e)||P==null)throw new Error("Invalid arguments passed to jsPDF.text");if(P.length===0)return zt;var as="",Vr=!1,Es=typeof tt.lineHeightFactor=="number"?tt.lineHeightFactor:Ss,qs=zt.internal.scaleFactor;function Kl(Js){return Js=Js.split("	").join(Array(tt.TabLen||9).join(" ")),ps(Js,Se)}function qa(Js){for(var Zs,Hn=Js.concat(),ya=[],vd=Hn.length;vd--;)typeof(Zs=Hn.shift())=="string"?ya.push(Zs):Array.isArray(Js)&&(Zs.length===1||Zs[1]===void 0&&Zs[2]===void 0)?ya.push(Zs[0]):ya.push([Zs[0],Zs[1],Zs[2]]);return ya}function Sc(Js,Zs){var Hn;if(typeof Js=="string")Hn=Zs(Js)[0];else if(Array.isArray(Js)){for(var ya,vd,Jp=Js.concat(),bm=[],xv=Jp.length;xv--;)typeof(ya=Jp.shift())=="string"?bm.push(Zs(ya)[0]):Array.isArray(ya)&&typeof ya[0]=="string"&&(vd=Zs(ya[0],ya[1],ya[2]),bm.push([vd[0],vd[1],vd[2]]));Hn=bm}return Hn}var Ec=!1,Kp=!0;if(typeof P=="string")Ec=!0;else if(Array.isArray(P)){var zp=P.concat();$t=[];for(var hm,Wa=zp.length;Wa--;)(typeof(hm=zp.shift())!="string"||Array.isArray(hm)&&typeof hm[0]!="string")&&(Kp=!1);Ec=Kp}if(Ec===!1)throw new Error('Type of text must be string or Array. "'+P+'" is not recognized.');typeof P=="string"&&(P=P.match(/[\r?\n]/)?P.split(/\r\n|\r|\n/g):[P]);var fm=ae/zt.internal.scaleFactor,mm=fm*(Es-1);switch(tt.baseline){case"bottom":$e-=mm;break;case"top":$e+=fm-mm;break;case"hanging":$e+=fm-2*mm;break;case"middle":$e+=fm/2-mm}if((ne=tt.maxWidth||0)>0&&(typeof P=="string"?P=zt.splitTextToSize(P,ne):Object.prototype.toString.call(P)==="[object Array]"&&(P=P.reduce(function(Js,Zs){return Js.concat(zt.splitTextToSize(Zs,ne))},[]))),_t={text:P,x:pe,y:$e,options:tt,mutex:{pdfEscape:ps,activeFontKey:_e,fonts:ze,activeFontSize:ae}},qe.publish("preProcessText",_t),P=_t.text,sr=(tt=_t.options).angle,!(vt instanceof Ct)&&sr&&typeof sr=="number"){sr*=Math.PI/180,tt.rotationDirection===0&&(sr=-sr),x===v.ADVANCED&&(sr=-sr);var pm=Math.cos(sr),qp=Math.sin(sr);vt=new Ct(pm,qp,-qp,pm,0,0)}else sr&&sr instanceof Ct&&(vt=sr);x!==v.ADVANCED||vt||(vt=vr),(M=tt.charSpace||fd)!==void 0&&(as+=C(k(M))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(ct=tt.horizontalScale)!==void 0&&(as+=C(100*ct)+` Tz
`),tt.lang;var no=-1,HN=tt.renderingMode!==void 0?tt.renderingMode:tt.stroke,Wp=zt.internal.getCurrentPageInfo().pageContext;switch(HN){case 0:case!1:case"fill":no=0;break;case 1:case!0:case"stroke":no=1;break;case 2:case"fillThenStroke":no=2;break;case 3:case"invisible":no=3;break;case 4:case"fillAndAddForClipping":no=4;break;case 5:case"strokeAndAddPathForClipping":no=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":no=6;break;case 7:case"addToPathForClipping":no=7}var fv=Wp.usedRenderingMode!==void 0?Wp.usedRenderingMode:-1;no!==-1?as+=no+` Tr
`:fv!==-1&&(as+=`0 Tr
`),no!==-1&&(Wp.usedRenderingMode=no),N=tt.align||"left";var al,gm=ae*Es,mv=zt.internal.pageSize.getWidth(),pv=ze[_e];M=tt.charSpace||fd,ne=tt.maxWidth||0,Se=Object.assign({autoencode:!0,noBOM:!0},tt.flags);var ku=[],Th=function(Js){return zt.getStringUnitWidth(Js,{font:pv,charSpace:M,fontSize:ae,doKerning:!1})*ae/qs};if(Object.prototype.toString.call(P)==="[object Array]"){var ao;$t=qa(P),N!=="left"&&(al=$t.map(Th));var Ui,Bu=0;if(N==="right"){pe-=al[0],P=[],Wa=$t.length;for(var gd=0;gd<Wa;gd++)gd===0?(Ui=Io(pe),ao=xa($e)):(Ui=k(Bu-al[gd]),ao=-gm),P.push([$t[gd],Ui,ao]),Bu=al[gd]}else if(N==="center"){pe-=al[0]/2,P=[],Wa=$t.length;for(var xd=0;xd<Wa;xd++)xd===0?(Ui=Io(pe),ao=xa($e)):(Ui=k((Bu-al[xd])/2),ao=-gm),P.push([$t[xd],Ui,ao]),Bu=al[xd]}else if(N==="left"){P=[],Wa=$t.length;for(var xm=0;xm<Wa;xm++)P.push($t[xm])}else if(N==="justify"&&pv.encoding==="Identity-H"){P=[],Wa=$t.length,ne=ne!==0?ne:mv;for(var yd=0,Vn=0;Vn<Wa;Vn++)if(ao=Vn===0?xa($e):-gm,Ui=Vn===0?Io(pe):yd,Vn<Wa-1){var Gp=k((ne-al[Vn])/($t[Vn].split(" ").length-1)),Mi=$t[Vn].split(" ");P.push([Mi[0]+" ",Ui,ao]),yd=0;for(var il=1;il<Mi.length;il++){var ym=(Th(Mi[il-1]+" "+Mi[il])-Th(Mi[il]))*qs+Gp;il==Mi.length-1?P.push([Mi[il],ym,0]):P.push([Mi[il]+" ",ym,0]),yd-=ym}}else P.push([$t[Vn],Ui,ao]);P.push(["",yd,0])}else{if(N!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(P=[],Wa=$t.length,ne=ne!==0?ne:mv,Vn=0;Vn<Wa;Vn++)ao=Vn===0?xa($e):-gm,Ui=Vn===0?Io(pe):0,Vn<Wa-1?ku.push(C(k((ne-al[Vn])/($t[Vn].split(" ").length-1)))):ku.push(0),P.push([$t[Vn],Ui,ao])}}var gv=typeof tt.R2L=="boolean"?tt.R2L:De;gv===!0&&(P=Sc(P,function(Js,Zs,Hn){return[Js.split("").reverse().join(""),Zs,Hn]})),_t={text:P,x:pe,y:$e,options:tt,mutex:{pdfEscape:ps,activeFontKey:_e,fonts:ze,activeFontSize:ae}},qe.publish("postProcessText",_t),P=_t.text,Vr=_t.mutex.isHex||!1;var Yp=ze[_e].encoding;Yp!=="WinAnsiEncoding"&&Yp!=="StandardEncoding"||(P=Sc(P,function(Js,Zs,Hn){return[Kl(Js),Zs,Hn]})),$t=qa(P),P=[];for(var Ih,kh,Fu,Bh=0,vm=1,Fh=Array.isArray($t[0])?vm:Bh,Pu="",Xp=function(Js,Zs,Hn){var ya="";return Hn instanceof Ct?(Hn=typeof tt.angle=="number"?xr(Hn,new Ct(1,0,0,1,Js,Zs)):xr(new Ct(1,0,0,1,Js,Zs),Hn),x===v.ADVANCED&&(Hn=xr(new Ct(1,0,0,-1,0,0),Hn)),ya=Hn.join(" ")+` Tm
`):ya=C(Js)+" "+C(Zs)+` Td
`,ya},ol=0;ol<$t.length;ol++){switch(Pu="",Fh){case vm:Fu=(Vr?"<":"(")+$t[ol][0]+(Vr?">":")"),Ih=parseFloat($t[ol][1]),kh=parseFloat($t[ol][2]);break;case Bh:Fu=(Vr?"<":"(")+$t[ol]+(Vr?">":")"),Ih=Io(pe),kh=xa($e)}ku!==void 0&&ku[ol]!==void 0&&(Pu=ku[ol]+` Tw
`),ol===0?P.push(Pu+Xp(Ih,kh,vt)+Fu):Fh===Bh?P.push(Pu+Fu):Fh===vm&&P.push(Pu+Xp(Ih,kh,vt)+Fu)}P=Fh===Bh?P.join(` Tj
T* `):P.join(` Tj
`),P+=` Tj
`;var ll=`BT
/`;return ll+=_e+" "+ae+` Tf
`,ll+=C(ae*Es)+` TL
`,ll+=Hl+`
`,ll+=as,ll+=P,oe(ll+="ET"),h[_e]=!0,zt};var $p=f.__private__.clip=f.clip=function(P){return oe(P==="evenodd"?"W*":"W"),this};f.clipEvenOdd=function(){return $p("evenodd")},f.__private__.discardPath=f.discardPath=function(){return oe("n"),this};var nl=f.__private__.isValidStyle=function(P){var pe=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(P)!==-1&&(pe=!0),pe};f.__private__.setDefaultPathOperation=f.setDefaultPathOperation=function(P){return nl(P)&&(d=P),this};var cm=f.__private__.getStyle=f.getStyle=function(P){var pe=d;switch(P){case"D":case"S":pe="S";break;case"F":pe="f";break;case"FD":case"DF":pe="B";break;case"f":case"f*":case"B":case"B*":pe=P}return pe},_o=f.close=function(){return oe("h"),this};f.stroke=function(){return oe("S"),this},f.fill=function(P){return yu("f",P),this},f.fillEvenOdd=function(P){return yu("f*",P),this},f.fillStroke=function(P){return yu("B",P),this},f.fillStrokeEvenOdd=function(P){return yu("B*",P),this};var yu=function(P,pe){Us(pe)==="object"?bu(pe,P):oe(P)},wh=function(P){P===null||x===v.ADVANCED&&P===void 0||(P=cm(P),oe(P))};function vu(P,pe,$e,tt,dt){var _t=new w0(pe||this.boundingBox,$e||this.xStep,tt||this.yStep,this.gState,dt||this.matrix);_t.stream=this.stream;var $t=P+"$$"+this.cloneIndex+++"$$";return Pr($t,_t),_t}var bu=function(P,pe){var $e=Qe[P.key],tt=ht[$e];if(tt instanceof Gh)oe("q"),oe(dm(pe)),tt.gState&&f.setGState(tt.gState),oe(P.matrix.toString()+" cm"),oe("/"+$e+" sh"),oe("Q");else if(tt instanceof w0){var dt=new Ct(1,0,0,-1,0,di());P.matrix&&(dt=dt.multiply(P.matrix||vr),$e=vu.call(tt,P.key,P.boundingBox,P.xStep,P.yStep,dt).id),oe("q"),oe("/Pattern cs"),oe("/"+$e+" scn"),tt.gState&&f.setGState(tt.gState),oe(pe),oe("Q")}},dm=function(P){switch(P){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},Ql=f.moveTo=function(P,pe){return oe(C(k(P))+" "+C(q(pe))+" m"),this},To=f.lineTo=function(P,pe){return oe(C(k(P))+" "+C(q(pe))+" l"),this},Vl=f.curveTo=function(P,pe,$e,tt,dt,_t){return oe([C(k(P)),C(q(pe)),C(k($e)),C(q(tt)),C(k(dt)),C(q(_t)),"c"].join(" ")),this};f.__private__.line=f.line=function(P,pe,$e,tt,dt){if(isNaN(P)||isNaN(pe)||isNaN($e)||isNaN(tt)||!nl(dt))throw new Error("Invalid arguments passed to jsPDF.line");return x===v.COMPAT?this.lines([[$e-P,tt-pe]],P,pe,[1,1],dt||"S"):this.lines([[$e-P,tt-pe]],P,pe,[1,1]).stroke()},f.__private__.lines=f.lines=function(P,pe,$e,tt,dt,_t){var $t,sr,N,M,ne,Se,ct,vt,zt,Qr,as,Vr;if(typeof P=="number"&&(Vr=$e,$e=pe,pe=P,P=Vr),tt=tt||[1,1],_t=_t||!1,isNaN(pe)||isNaN($e)||!Array.isArray(P)||!Array.isArray(tt)||!nl(dt)||typeof _t!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Ql(pe,$e),$t=tt[0],sr=tt[1],M=P.length,Qr=pe,as=$e,N=0;N<M;N++)(ne=P[N]).length===2?(Qr=ne[0]*$t+Qr,as=ne[1]*sr+as,To(Qr,as)):(Se=ne[0]*$t+Qr,ct=ne[1]*sr+as,vt=ne[2]*$t+Qr,zt=ne[3]*sr+as,Qr=ne[4]*$t+Qr,as=ne[5]*sr+as,Vl(Se,ct,vt,zt,Qr,as));return _t&&_o(),wh(dt),this},f.path=function(P){for(var pe=0;pe<P.length;pe++){var $e=P[pe],tt=$e.c;switch($e.op){case"m":Ql(tt[0],tt[1]);break;case"l":To(tt[0],tt[1]);break;case"c":Vl.apply(this,tt);break;case"h":_o()}}return this},f.__private__.rect=f.rect=function(P,pe,$e,tt,dt){if(isNaN(P)||isNaN(pe)||isNaN($e)||isNaN(tt)||!nl(dt))throw new Error("Invalid arguments passed to jsPDF.rect");return x===v.COMPAT&&(tt=-tt),oe([C(k(P)),C(q(pe)),C(k($e)),C(k(tt)),"re"].join(" ")),wh(dt),this},f.__private__.triangle=f.triangle=function(P,pe,$e,tt,dt,_t,$t){if(isNaN(P)||isNaN(pe)||isNaN($e)||isNaN(tt)||isNaN(dt)||isNaN(_t)||!nl($t))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[$e-P,tt-pe],[dt-$e,_t-tt],[P-dt,pe-_t]],P,pe,[1,1],$t,!0),this},f.__private__.roundedRect=f.roundedRect=function(P,pe,$e,tt,dt,_t,$t){if(isNaN(P)||isNaN(pe)||isNaN($e)||isNaN(tt)||isNaN(dt)||isNaN(_t)||!nl($t))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var sr=4/3*(Math.SQRT2-1);return dt=Math.min(dt,.5*$e),_t=Math.min(_t,.5*tt),this.lines([[$e-2*dt,0],[dt*sr,0,dt,_t-_t*sr,dt,_t],[0,tt-2*_t],[0,_t*sr,-dt*sr,_t,-dt,_t],[2*dt-$e,0],[-dt*sr,0,-dt,-_t*sr,-dt,-_t],[0,2*_t-tt],[0,-_t*sr,dt*sr,-_t,dt,-_t]],P+dt,pe,[1,1],$t,!0),this},f.__private__.ellipse=f.ellipse=function(P,pe,$e,tt,dt){if(isNaN(P)||isNaN(pe)||isNaN($e)||isNaN(tt)||!nl(dt))throw new Error("Invalid arguments passed to jsPDF.ellipse");var _t=4/3*(Math.SQRT2-1)*$e,$t=4/3*(Math.SQRT2-1)*tt;return Ql(P+$e,pe),Vl(P+$e,pe-$t,P+_t,pe-tt,P,pe-tt),Vl(P-_t,pe-tt,P-$e,pe-$t,P-$e,pe),Vl(P-$e,pe+$t,P-_t,pe+tt,P,pe+tt),Vl(P+_t,pe+tt,P+$e,pe+$t,P+$e,pe),wh(dt),this},f.__private__.circle=f.circle=function(P,pe,$e,tt){if(isNaN(P)||isNaN(pe)||isNaN($e)||!nl(tt))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(P,pe,$e,$e,tt)},f.setFont=function(P,pe,$e){return $e&&(pe=j(pe,$e)),_e=ud(P,pe,{disableWarning:!1}),this};var Nh=f.__private__.getFont=f.getFont=function(){return ze[ud.apply(f,arguments)]};f.__private__.getFontList=f.getFontList=function(){var P,pe,$e={};for(P in Me)if(Me.hasOwnProperty(P))for(pe in $e[P]=[],Me[P])Me[P].hasOwnProperty(pe)&&$e[P].push(pe);return $e},f.addFont=function(P,pe,$e,tt,dt){var _t=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&_t.indexOf(arguments[3])!==-1?dt=arguments[3]:arguments[3]&&_t.indexOf(arguments[3])==-1&&($e=j($e,tt)),dt=dt||"Identity-H",jr.call(this,P,pe,$e,dt)};var Ss,Ch=t.lineWidth||.200025,wu=f.__private__.getLineWidth=f.getLineWidth=function(){return Ch},jh=f.__private__.setLineWidth=f.setLineWidth=function(P){return Ch=P,oe(C(k(P))+" w"),this};f.__private__.setLineDash=wr.API.setLineDash=wr.API.setLineDashPattern=function(P,pe){if(P=P||[],pe=pe||0,isNaN(pe)||!Array.isArray(P))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return P=P.map(function($e){return C(k($e))}).join(" "),pe=C(k(pe)),oe("["+P+"] "+pe+" d"),this};var Sh=f.__private__.getLineHeight=f.getLineHeight=function(){return ae*Ss};f.__private__.getLineHeight=f.getLineHeight=function(){return ae*Ss};var Eh=f.__private__.setLineHeightFactor=f.setLineHeightFactor=function(P){return typeof(P=P||1.15)=="number"&&(Ss=P),this},hd=f.__private__.getLineHeightFactor=f.getLineHeightFactor=function(){return Ss};Eh(t.lineHeight);var Io=f.__private__.getHorizontalCoordinate=function(P){return k(P)},xa=f.__private__.getVerticalCoordinate=function(P){return x===v.ADVANCED?P:Kt[U].mediaBox.topRightY-Kt[U].mediaBox.bottomLeftY-k(P)},um=f.__private__.getHorizontalCoordinateString=f.getHorizontalCoordinateString=function(P){return C(Io(P))},Nc=f.__private__.getVerticalCoordinateString=f.getVerticalCoordinateString=function(P){return C(xa(P))},za=t.strokeColor||"0 G";f.__private__.getStrokeColor=f.getDrawColor=function(){return ce(za)},f.__private__.setStrokeColor=f.setDrawColor=function(P,pe,$e,tt){return za=xe({ch1:P,ch2:pe,ch3:$e,ch4:tt,pdfColorType:"draw",precision:2}),oe(za),this};var Nu=t.fillColor||"0 g";f.__private__.getFillColor=f.getFillColor=function(){return ce(Nu)},f.__private__.setFillColor=f.setFillColor=function(P,pe,$e,tt){return Nu=xe({ch1:P,ch2:pe,ch3:$e,ch4:tt,pdfColorType:"fill",precision:2}),oe(Nu),this};var Hl=t.textColor||"0 g",Cu=f.__private__.getTextColor=f.getTextColor=function(){return ce(Hl)};f.__private__.setTextColor=f.setTextColor=function(P,pe,$e,tt){return Hl=xe({ch1:P,ch2:pe,ch3:$e,ch4:tt,pdfColorType:"text",precision:3}),this};var fd=t.charSpace,ju=f.__private__.getCharSpace=f.getCharSpace=function(){return parseFloat(fd||0)};f.__private__.setCharSpace=f.setCharSpace=function(P){if(isNaN(P))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return fd=P,this};var _h=0;f.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},f.__private__.setLineCap=f.setLineCap=function(P){var pe=f.CapJoinStyles[P];if(pe===void 0)throw new Error("Line cap style of '"+P+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return _h=pe,oe(pe+" J"),this};var Su=0;f.__private__.setLineJoin=f.setLineJoin=function(P){var pe=f.CapJoinStyles[P];if(pe===void 0)throw new Error("Line join style of '"+P+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Su=pe,oe(pe+" j"),this},f.__private__.setLineMiterLimit=f.__private__.setMiterLimit=f.setLineMiterLimit=f.setMiterLimit=function(P){if(P=P||0,isNaN(P))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return oe(C(k(P))+" M"),this},f.GState=l2,f.setGState=function(P){(P=typeof P=="string"?Ge[gt[P]]:Cc(null,P)).equals(St)||(oe("/"+P.id+" gs"),St=P)};var Cc=function(P,pe){if(!P||!gt[P]){var $e=!1;for(var tt in Ge)if(Ge.hasOwnProperty(tt)&&Ge[tt].equals(pe)){$e=!0;break}if($e)pe=Ge[tt];else{var dt="GS"+(Object.keys(Ge).length+1).toString(10);Ge[dt]=pe,pe.id=dt}return P&&(gt[P]=pe.id),qe.publish("addGState",pe),pe}};f.addGState=function(P,pe){return Cc(P,pe),this},f.saveGraphicsState=function(){return oe("q"),rt.push({key:_e,size:ae,color:Hl}),this},f.restoreGraphicsState=function(){oe("Q");var P=rt.pop();return _e=P.key,ae=P.size,Hl=P.color,St=null,this},f.setCurrentTransformationMatrix=function(P){return oe(P.toString()+" cm"),this},f.comment=function(P){return oe("#"+P),this};var md=function(P,pe){var $e=P||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return $e},set:function(_t){isNaN(_t)||($e=parseFloat(_t))}});var tt=pe||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return tt},set:function(_t){isNaN(_t)||(tt=parseFloat(_t))}});var dt="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return dt},set:function(_t){dt=_t.toString()}}),this},Eu=function(P,pe,$e,tt){md.call(this,P,pe),this.type="rect";var dt=$e||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return dt},set:function($t){isNaN($t)||(dt=parseFloat($t))}});var _t=tt||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return _t},set:function($t){isNaN($t)||(_t=parseFloat($t))}}),this},pd=function(){this.page=Vt,this.currentPage=U,this.pages=Ie.slice(0),this.pagesContext=Kt.slice(0),this.x=lt,this.y=mt,this.matrix=pt,this.width=jc(U),this.height=di(U),this.outputDestination=H,this.id="",this.objectNumber=-1};pd.prototype.restore=function(){Vt=this.page,U=this.currentPage,Kt=this.pagesContext,Ie=this.pages,lt=this.x,mt=this.y,pt=this.matrix,Tu(U,this.width),Iu(U,this.height),H=this.outputDestination};var _u=function(P,pe,$e,tt,dt){Ft.push(new pd),Vt=U=0,Ie=[],lt=P,mt=pe,pt=dt,us([$e,tt])},Am=function(P){if(We[P])Ft.pop().restore();else{var pe=new pd,$e="Xo"+(Object.keys(Ke).length+1).toString(10);pe.id=$e,We[P]=$e,Ke[$e]=pe,qe.publish("addFormObject",pe),Ft.pop().restore()}};for(var $l in f.beginFormObject=function(P,pe,$e,tt,dt){return _u(P,pe,$e,tt,dt),this},f.endFormObject=function(P){return Am(P),this},f.doFormObject=function(P,pe){var $e=Ke[We[P]];return oe("q"),oe(pe.toString()+" cm"),oe("/"+$e.id+" Do"),oe("Q"),this},f.getFormObject=function(P){var pe=Ke[We[P]];return{x:pe.x,y:pe.y,width:pe.width,height:pe.height,matrix:pe.matrix}},f.save=function(P,pe){return P=P||"generated.pdf",(pe=pe||{}).returnPromise=pe.returnPromise||!1,pe.returnPromise===!1?(Qh(gu(Ml()),P),typeof Qh.unload=="function"&&Br.setTimeout&&setTimeout(Qh.unload,911),this):new Promise(function($e,tt){try{var dt=Qh(gu(Ml()),P);typeof Qh.unload=="function"&&Br.setTimeout&&setTimeout(Qh.unload,911),$e(dt)}catch(_t){tt(_t.message)}})},wr.API)wr.API.hasOwnProperty($l)&&($l==="events"&&wr.API.events.length?function(P,pe){var $e,tt,dt;for(dt=pe.length-1;dt!==-1;dt--)$e=pe[dt][0],tt=pe[dt][1],P.subscribe.apply(P,[$e].concat(typeof tt=="function"?[tt]:tt))}(qe,wr.API.events):f[$l]=wr.API[$l]);var jc=f.getPageWidth=function(P){return(Kt[P=P||U].mediaBox.topRightX-Kt[P].mediaBox.bottomLeftX)/ke},Tu=f.setPageWidth=function(P,pe){Kt[P].mediaBox.topRightX=pe*ke+Kt[P].mediaBox.bottomLeftX},di=f.getPageHeight=function(P){return(Kt[P=P||U].mediaBox.topRightY-Kt[P].mediaBox.bottomLeftY)/ke},Iu=f.setPageHeight=function(P,pe){Kt[P].mediaBox.topRightY=pe*ke+Kt[P].mediaBox.bottomLeftY};return f.internal={pdfEscape:ps,getStyle:cm,getFont:Nh,getFontSize:we,getCharSpace:ju,getTextColor:Cu,getLineHeight:Sh,getLineHeightFactor:hd,getLineWidth:wu,write:He,getHorizontalCoordinate:Io,getVerticalCoordinate:xa,getCoordinateString:um,getVerticalCoordinateString:Nc,collections:{},newObject:Mr,newAdditionalObject:Le,newObjectDeferred:Jr,newObjectDeferredBegin:ye,getFilters:Pe,putStream:Ze,events:qe,scaleFactor:ke,pageSize:{getWidth:function(){return jc(U)},setWidth:function(P){Tu(U,P)},getHeight:function(){return di(U)},setHeight:function(P){Iu(U,P)}},encryptionOptions:u,encryption:on,getEncryptor:lm,output:xu,getNumberOfPages:ks,pages:Ie,out:oe,f2:F,f3:B,getPageInfo:bh,getPageInfoByObjId:Dr,getCurrentPageInfo:wc,getPDFVersion:m,Point:md,Rectangle:Eu,Matrix:Ct,hasHotfix:bc},Object.defineProperty(f.internal.pageSize,"width",{get:function(){return jc(U)},set:function(P){Tu(U,P)},enumerable:!0,configurable:!0}),Object.defineProperty(f.internal.pageSize,"height",{get:function(){return di(U)},set:function(P){Iu(U,P)},enumerable:!0,configurable:!0}),ms.call(f,le),_e="F1",kn(n,r),qe.publish("initialized"),f}e0.prototype.lsbFirstWord=function(t){return String.fromCharCode(t>>0&255,t>>8&255,t>>16&255,t>>24&255)},e0.prototype.toHexString=function(t){return t.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},e0.prototype.hexToBytes=function(t){for(var e=[],r=0;r<t.length;r+=2)e.push(String.fromCharCode(parseInt(t.substr(r,2),16)));return e.join("")},e0.prototype.processOwnerPassword=function(t,e){return uS(dS(e).substr(0,5),t)},e0.prototype.encryptor=function(t,e){var r=dS(this.encryptionKey+String.fromCharCode(255&t,t>>8&255,t>>16&255,255&e,e>>8&255)).substr(0,10);return function(s){return uS(r,s)}},l2.prototype.equals=function(t){var e,r="id,objectNumber,equals";if(!t||Us(t)!==Us(this))return!1;var s=0;for(e in this)if(!(r.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!t.hasOwnProperty(e)||this[e]!==t[e])return!1;s++}for(e in t)t.hasOwnProperty(e)&&r.indexOf(e)<0&&s--;return s===0},wr.API={events:[]},wr.version="3.0.1";var Fn=wr.API,rT=1,im=function(t){return t.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Rm=function(t){return t.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Hr=function(t){return t.toFixed(2)},Wu=function(t){return t.toFixed(5)};Fn.__acroform__={};var Eo=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t},$F=function(t){return t*rT},Dc=function(t){var e=new mQ,r=fr.internal.getHeight(t)||0,s=fr.internal.getWidth(t)||0;return e.BBox=[0,0,Number(Hr(s)),Number(Hr(r))],e},A0e=Fn.__acroform__.setBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return t|=1<<e},h0e=Fn.__acroform__.clearBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return t&=~(1<<e)},f0e=Fn.__acroform__.getBit=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return t&1<<e?1:0},Xn=Fn.__acroform__.getBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return f0e(t,e-1)},Jn=Fn.__acroform__.setBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return A0e(t,e-1)},Zn=Fn.__acroform__.clearBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return h0e(t,e-1)},m0e=Fn.__acroform__.calculateCoordinates=function(t,e){var r=e.internal.getHorizontalCoordinate,s=e.internal.getVerticalCoordinate,n=t[0],i=t[1],o=t[2],l=t[3],c={};return c.lowerLeft_X=r(n)||0,c.lowerLeft_Y=s(i+l)||0,c.upperRight_X=r(n+o)||0,c.upperRight_Y=s(i)||0,[Number(Hr(c.lowerLeft_X)),Number(Hr(c.lowerLeft_Y)),Number(Hr(c.upperRight_X)),Number(Hr(c.upperRight_Y))]},p0e=function(t){if(t.appearanceStreamContent)return t.appearanceStreamContent;if(t.V||t.DV){var e=[],r=t._V||t.DV,s=AS(t,r),n=t.scope.internal.getFont(t.fontName,t.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(t.scope.__private__.encodeColorString(t.color)),e.push("/"+n+" "+Hr(s.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(s.text),e.push("ET"),e.push("Q"),e.push("EMC");var i=Dc(t);return i.scope=t.scope,i.stream=e.join(`
`),i}},AS=function(t,e){var r=t.fontSize===0?t.maxFontSize:t.fontSize,s={text:"",fontSize:""},n=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");n=t.multiline?n.map(function(B){return B.split(`
`)}):n.map(function(B){return[B]});var i=r,o=fr.internal.getHeight(t)||0;o=o<0?-o:o;var l=fr.internal.getWidth(t)||0;l=l<0?-l:l;var c=function(B,k,D){if(B+1<n.length){var q=k+" "+n[B+1][0];return _1(q,t,D).width<=l-4}return!1};i++;e:for(;i>0;){e="",i--;var d,u,A=_1("3",t,i).height,h=t.multiline?o-i:(o-A)/2,f=h+=2,p=0,m=0,g=0;if(i<=0){e=`(...) Tj
`,e+="% Width of Text: "+_1(e,t,i=12).width+", FieldWidth:"+l+`
`;break}for(var y="",v=0,x=0;x<n.length;x++)if(n.hasOwnProperty(x)){var E=!1;if(n[x].length!==1&&g!==n[x].length-1){if((A+2)*(v+2)+2>o)continue e;y+=n[x][g],E=!0,m=x,x--}else{y=(y+=n[x][g]+" ").substr(y.length-1)==" "?y.substr(0,y.length-1):y;var T=parseInt(x),j=c(T,y,i),C=x>=n.length-1;if(j&&!C){y+=" ",g=0;continue}if(j||C){if(C)m=T;else if(t.multiline&&(A+2)*(v+2)+2>o)continue e}else{if(!t.multiline||(A+2)*(v+2)+2>o)continue e;m=T}}for(var w="",S=p;S<=m;S++){var F=n[S];if(t.multiline){if(S===m){w+=F[g]+" ",g=(g+1)%F.length;continue}if(S===p){w+=F[F.length-1]+" ";continue}}w+=F[0]+" "}switch(w=w.substr(w.length-1)==" "?w.substr(0,w.length-1):w,u=_1(w,t,i).width,t.textAlign){case"right":d=l-u-2;break;case"center":d=(l-u)/2;break;case"left":default:d=2}e+=Hr(d)+" "+Hr(f)+` Td
`,e+="("+im(w)+`) Tj
`,e+=-Hr(d)+` 0 Td
`,f=-(i+2),u=0,p=E?m:m+1,v++,y=""}break}return s.text=e,s.fontSize=i,s},_1=function(t,e,r){var s=e.scope.internal.getFont(e.fontName,e.fontStyle),n=e.scope.getStringUnitWidth(t,{font:s,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:e.scope.getStringUnitWidth("3",{font:s,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:n}},g0e={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},x0e=function(t,e){var r={type:"reference",object:t};e.internal.getPageInfo(t.page).pageContext.annotations.find(function(s){return s.type===r.type&&s.object===r.object})===void 0&&e.internal.getPageInfo(t.page).pageContext.annotations.push(r)},y0e=function(t,e){for(var r in t)if(t.hasOwnProperty(r)){var s=r,n=t[r];e.internal.newObjectDeferredBegin(n.objId,!0),Us(n)==="object"&&typeof n.putStream=="function"&&n.putStream(),delete t[s]}},v0e=function(t,e){if(e.scope=t,t.internal!==void 0&&(t.internal.acroformPlugin===void 0||t.internal.acroformPlugin.isInitialized===!1)){if(xc.FieldNum=0,t.internal.acroformPlugin=JSON.parse(JSON.stringify(g0e)),t.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");rT=t.internal.scaleFactor,t.internal.acroformPlugin.acroFormDictionaryRoot=new pQ,t.internal.acroformPlugin.acroFormDictionaryRoot.scope=t,t.internal.acroformPlugin.acroFormDictionaryRoot._eventID=t.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(t)}),t.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var s=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var n in s)if(s.hasOwnProperty(n)){var i=s[n];i.objId=void 0,i.hasAnnotation&&x0e(i,r)}})(t)}),t.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(t)}),t.internal.events.subscribe("postPutPages",function(r){(function(s,n){var i=!s;for(var o in s||(n.internal.newObjectDeferredBegin(n.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),n.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),s=s||n.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(s.hasOwnProperty(o)){var l=s[o],c=[],d=l.Rect;if(l.Rect&&(l.Rect=m0e(l.Rect,n)),n.internal.newObjectDeferredBegin(l.objId,!0),l.DA=fr.createDefaultAppearanceStream(l),Us(l)==="object"&&typeof l.getKeyValueListForStream=="function"&&(c=l.getKeyValueListForStream()),l.Rect=d,l.hasAppearanceStream&&!l.appearanceStreamContent){var u=p0e(l);c.push({key:"AP",value:"<</N "+u+">>"}),n.internal.acroformPlugin.xForms.push(u)}if(l.appearanceStreamContent){var A="";for(var h in l.appearanceStreamContent)if(l.appearanceStreamContent.hasOwnProperty(h)){var f=l.appearanceStreamContent[h];if(A+="/"+h+" ",A+="<<",Object.keys(f).length>=1||Array.isArray(f)){for(var o in f)if(f.hasOwnProperty(o)){var p=f[o];typeof p=="function"&&(p=p.call(n,l)),A+="/"+o+" "+p+" ",n.internal.acroformPlugin.xForms.indexOf(p)>=0||n.internal.acroformPlugin.xForms.push(p)}}else typeof(p=f)=="function"&&(p=p.call(n,l)),A+="/"+o+" "+p,n.internal.acroformPlugin.xForms.indexOf(p)>=0||n.internal.acroformPlugin.xForms.push(p);A+=">>"}c.push({key:"AP",value:`<<
`+A+">>"})}n.internal.putStream({additionalKeyValues:c,objectId:l.objId}),n.internal.out("endobj")}i&&y0e(n.internal.acroformPlugin.xForms,n)})(r,t)}),t.internal.acroformPlugin.isInitialized=!0}},fQ=Fn.__acroform__.arrayToPdfArray=function(t,e,r){var s=function(o){return o};if(Array.isArray(t)){for(var n="[",i=0;i<t.length;i++)switch(i!==0&&(n+=" "),Us(t[i])){case"boolean":case"number":case"object":n+=t[i].toString();break;case"string":t[i].substr(0,1)!=="/"?(e!==void 0&&r&&(s=r.internal.getEncryptor(e)),n+="("+im(s(t[i].toString()))+")"):n+=t[i].toString()}return n+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},NC=function(t,e,r){var s=function(n){return n};return e!==void 0&&r&&(s=r.internal.getEncryptor(e)),(t=t||"").toString(),t="("+im(s(t))+")"},Kc=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(t){this._objId=t}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Kc.prototype.toString=function(){return this.objId+" 0 R"},Kc.prototype.putStream=function(){var t=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:t,objectId:this.objId}),this.scope.internal.out("endobj")},Kc.prototype.getKeyValueListForStream=function(){var t=[],e=Object.getOwnPropertyNames(this).filter(function(i){return i!="content"&&i!="appearanceStreamContent"&&i!="scope"&&i!="objId"&&i.substring(0,1)!="_"});for(var r in e)if(Object.getOwnPropertyDescriptor(this,e[r]).configurable===!1){var s=e[r],n=this[s];n&&(Array.isArray(n)?t.push({key:s,value:fQ(n,this.objId,this.scope)}):n instanceof Kc?(n.scope=this.scope,t.push({key:s,value:n.objId+" 0 R"})):typeof n!="function"&&t.push({key:s,value:n}))}return t};var mQ=function(){Kc.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var t,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){t=r.trim()},get:function(){return t||null}})};Eo(mQ,Kc);var pQ=function(){Kc.call(this);var t,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(t){var r=function(s){return s};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+im(r(t))+")"}},set:function(r){t=r}})};Eo(pQ,Kc);var xc=function t(){Kc.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(y){if(isNaN(y))throw new Error('Invalid value "'+y+'" for attribute F supplied.');e=y}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Xn(e,3)},set:function(y){y?this.F=Jn(e,3):this.F=Zn(e,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(y){if(isNaN(y))throw new Error('Invalid value "'+y+'" for attribute Ff supplied.');r=y}});var s=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(s.length!==0)return s},set:function(y){s=y!==void 0?y:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!s||isNaN(s[0])?0:s[0]},set:function(y){s[0]=y}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!s||isNaN(s[1])?0:s[1]},set:function(y){s[1]=y}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!s||isNaN(s[2])?0:s[2]},set:function(y){s[2]=y}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!s||isNaN(s[3])?0:s[3]},set:function(y){s[3]=y}});var n="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return n},set:function(y){switch(y){case"/Btn":case"/Tx":case"/Ch":case"/Sig":n=y;break;default:throw new Error('Invalid value "'+y+'" for attribute FT supplied.')}}});var i=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!i||i.length<1){if(this instanceof c2)return;i="FieldObject"+t.FieldNum++}var y=function(v){return v};return this.scope&&(y=this.scope.internal.getEncryptor(this.objId)),"("+im(y(i))+")"},set:function(y){i=y.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return i},set:function(y){i=y}});var o="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return o},set:function(y){o=y}});var l="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return l},set:function(y){l=y}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(y){c=y}});var d=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return d===void 0?50/rT:d},set:function(y){d=y}});var u="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return u},set:function(y){u=y}});var A="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!A||this instanceof c2||this instanceof xf))return NC(A,this.objId,this.scope)},set:function(y){y=y.toString(),A=y}});var h=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(h)return this instanceof Qa?h:NC(h,this.objId,this.scope)},set:function(y){y=y.toString(),h=this instanceof Qa?y:y.substr(0,1)==="("?Rm(y.substr(1,y.length-2)):Rm(y)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Qa?Rm(h.substr(1,h.length-1)):h},set:function(y){y=y.toString(),h=this instanceof Qa?"/"+y:y}});var f=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(f)return f},set:function(y){this.V=y}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(f)return this instanceof Qa?f:NC(f,this.objId,this.scope)},set:function(y){y=y.toString(),f=this instanceof Qa?y:y.substr(0,1)==="("?Rm(y.substr(1,y.length-2)):Rm(y)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Qa?Rm(f.substr(1,f.length-1)):f},set:function(y){y=y.toString(),f=this instanceof Qa?"/"+y:y}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var p,m=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return m},set:function(y){y=!!y,m=y}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(p)return p},set:function(y){p=y}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Xn(this.Ff,1)},set:function(y){y?this.Ff=Jn(this.Ff,1):this.Ff=Zn(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Xn(this.Ff,2)},set:function(y){y?this.Ff=Jn(this.Ff,2):this.Ff=Zn(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Xn(this.Ff,3)},set:function(y){y?this.Ff=Jn(this.Ff,3):this.Ff=Zn(this.Ff,3)}});var g=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(g!==null)return g},set:function(y){if([0,1,2].indexOf(y)===-1)throw new Error('Invalid value "'+y+'" for attribute Q supplied.');g=y}}),Object.defineProperty(this,"textAlign",{get:function(){var y;switch(g){case 0:default:y="left";break;case 1:y="center";break;case 2:y="right"}return y},configurable:!0,enumerable:!0,set:function(y){switch(y){case"right":case 2:g=2;break;case"center":case 1:g=1;break;case"left":case 0:default:g=0}}})};Eo(xc,Kc);var V0=function(){xc.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var t=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return t},set:function(r){t=r}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return fQ(e,this.objId,this.scope)},set:function(r){var s,n;n=[],typeof(s=r)=="string"&&(n=function(i,o,l){l||(l=1);for(var c,d=[];c=o.exec(i);)d.push(c[l]);return d}(s,/\((.*?)\)/g)),e=n}}),this.getOptions=function(){return e},this.setOptions=function(r){e=r,this.sort&&e.sort()},this.addOption=function(r){r=(r=r||"").toString(),e.push(r),this.sort&&e.sort()},this.removeOption=function(r,s){for(s=s||!1,r=(r=r||"").toString();e.indexOf(r)!==-1&&(e.splice(e.indexOf(r),1),s!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Xn(this.Ff,18)},set:function(r){r?this.Ff=Jn(this.Ff,18):this.Ff=Zn(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Xn(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=Jn(this.Ff,19):this.Ff=Zn(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Xn(this.Ff,20)},set:function(r){r?(this.Ff=Jn(this.Ff,20),e.sort()):this.Ff=Zn(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Xn(this.Ff,22)},set:function(r){r?this.Ff=Jn(this.Ff,22):this.Ff=Zn(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Xn(this.Ff,23)},set:function(r){r?this.Ff=Jn(this.Ff,23):this.Ff=Zn(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Xn(this.Ff,27)},set:function(r){r?this.Ff=Jn(this.Ff,27):this.Ff=Zn(this.Ff,27)}}),this.hasAppearanceStream=!1};Eo(V0,xc);var H0=function(){V0.call(this),this.fontName="helvetica",this.combo=!1};Eo(H0,V0);var $0=function(){H0.call(this),this.combo=!0};Eo($0,H0);var Pb=function(){$0.call(this),this.edit=!0};Eo(Pb,$0);var Qa=function(){xc.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Xn(this.Ff,15)},set:function(r){r?this.Ff=Jn(this.Ff,15):this.Ff=Zn(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Xn(this.Ff,16)},set:function(r){r?this.Ff=Jn(this.Ff,16):this.Ff=Zn(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Xn(this.Ff,17)},set:function(r){r?this.Ff=Jn(this.Ff,17):this.Ff=Zn(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Xn(this.Ff,26)},set:function(r){r?this.Ff=Jn(this.Ff,26):this.Ff=Zn(this.Ff,26)}});var t,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(i){return i};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var s,n=[];for(s in n.push("<<"),e)n.push("/"+s+" ("+im(r(e[s]))+")");return n.push(">>"),n.join(`
`)}},set:function(r){Us(r)==="object"&&(e=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(r){typeof r=="string"&&(e.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(r){t="/"+r}})};Eo(Qa,xc);var Db=function(){Qa.call(this),this.pushButton=!0};Eo(Db,Qa);var K0=function(){Qa.call(this),this.radio=!0,this.pushButton=!1;var t=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e!==void 0?e:[]}})};Eo(K0,Qa);var c2=function(){var t,e;xc.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return t},set:function(n){t=n}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(n){e=n}});var r,s={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var n=function(l){return l};this.scope&&(n=this.scope.internal.getEncryptor(this.objId));var i,o=[];for(i in o.push("<<"),s)o.push("/"+i+" ("+im(n(s[i]))+")");return o.push(">>"),o.join(`
`)},set:function(n){Us(n)==="object"&&(s=n)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return s.CA||""},set:function(n){typeof n=="string"&&(s.CA=n)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(n){r=n}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(n){r="/"+n}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=fr.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Eo(c2,xc),K0.prototype.setAppearance=function(t){if(!("createAppearanceStream"in t)||!("getCA"in t))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var r=this.Kids[e];r.appearanceStreamContent=t.createAppearanceStream(r.optionName),r.caption=t.getCA()}},K0.prototype.createOption=function(t){var e=new c2;return e.Parent=this,e.optionName=t,this.Kids.push(e),b0e.call(this.scope,e),e};var Rb=function(){Qa.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=fr.CheckBox.createAppearanceStream()};Eo(Rb,Qa);var xf=function(){xc.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Xn(this.Ff,13)},set:function(e){e?this.Ff=Jn(this.Ff,13):this.Ff=Zn(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Xn(this.Ff,21)},set:function(e){e?this.Ff=Jn(this.Ff,21):this.Ff=Zn(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Xn(this.Ff,23)},set:function(e){e?this.Ff=Jn(this.Ff,23):this.Ff=Zn(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Xn(this.Ff,24)},set:function(e){e?this.Ff=Jn(this.Ff,24):this.Ff=Zn(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Xn(this.Ff,25)},set:function(e){e?this.Ff=Jn(this.Ff,25):this.Ff=Zn(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Xn(this.Ff,26)},set:function(e){e?this.Ff=Jn(this.Ff,26):this.Ff=Zn(this.Ff,26)}});var t=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return t},set:function(e){Number.isInteger(e)&&(t=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Eo(xf,xc);var Lb=function(){xf.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Xn(this.Ff,14)},set:function(t){t?this.Ff=Jn(this.Ff,14):this.Ff=Zn(this.Ff,14)}}),this.password=!0};Eo(Lb,xf);var fr={CheckBox:{createAppearanceStream:function(){return{N:{On:fr.CheckBox.YesNormal},D:{On:fr.CheckBox.YesPushDown,Off:fr.CheckBox.OffPushDown}}},YesPushDown:function(t){var e=Dc(t);e.scope=t.scope;var r=[],s=t.scope.internal.getFont(t.fontName,t.fontStyle).id,n=t.scope.__private__.encodeColorString(t.color),i=AS(t,t.caption);return r.push("0.749023 g"),r.push("0 0 "+Hr(fr.internal.getWidth(t))+" "+Hr(fr.internal.getHeight(t))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+s+" "+Hr(i.fontSize)+" Tf "+n),r.push("BT"),r.push(i.text),r.push("ET"),r.push("Q"),r.push("EMC"),e.stream=r.join(`
`),e},YesNormal:function(t){var e=Dc(t);e.scope=t.scope;var r=t.scope.internal.getFont(t.fontName,t.fontStyle).id,s=t.scope.__private__.encodeColorString(t.color),n=[],i=fr.internal.getHeight(t),o=fr.internal.getWidth(t),l=AS(t,t.caption);return n.push("1 g"),n.push("0 0 "+Hr(o)+" "+Hr(i)+" re"),n.push("f"),n.push("q"),n.push("0 0 1 rg"),n.push("0 0 "+Hr(o-1)+" "+Hr(i-1)+" re"),n.push("W"),n.push("n"),n.push("0 g"),n.push("BT"),n.push("/"+r+" "+Hr(l.fontSize)+" Tf "+s),n.push(l.text),n.push("ET"),n.push("Q"),e.stream=n.join(`
`),e},OffPushDown:function(t){var e=Dc(t);e.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Hr(fr.internal.getWidth(t))+" "+Hr(fr.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(t){var e={D:{Off:fr.RadioButton.Circle.OffPushDown},N:{}};return e.N[t]=fr.RadioButton.Circle.YesNormal,e.D[t]=fr.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(t){var e=Dc(t);e.scope=t.scope;var r=[],s=fr.internal.getWidth(t)<=fr.internal.getHeight(t)?fr.internal.getWidth(t)/4:fr.internal.getHeight(t)/4;s=Number((.9*s).toFixed(5));var n=fr.internal.Bezier_C,i=Number((s*n).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+Wu(fr.internal.getWidth(t)/2)+" "+Wu(fr.internal.getHeight(t)/2)+" cm"),r.push(s+" 0 m"),r.push(s+" "+i+" "+i+" "+s+" 0 "+s+" c"),r.push("-"+i+" "+s+" -"+s+" "+i+" -"+s+" 0 c"),r.push("-"+s+" -"+i+" -"+i+" -"+s+" 0 -"+s+" c"),r.push(i+" -"+s+" "+s+" -"+i+" "+s+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e},YesPushDown:function(t){var e=Dc(t);e.scope=t.scope;var r=[],s=fr.internal.getWidth(t)<=fr.internal.getHeight(t)?fr.internal.getWidth(t)/4:fr.internal.getHeight(t)/4;s=Number((.9*s).toFixed(5));var n=Number((2*s).toFixed(5)),i=Number((n*fr.internal.Bezier_C).toFixed(5)),o=Number((s*fr.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Wu(fr.internal.getWidth(t)/2)+" "+Wu(fr.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+i+" "+i+" "+n+" 0 "+n+" c"),r.push("-"+i+" "+n+" -"+n+" "+i+" -"+n+" 0 c"),r.push("-"+n+" -"+i+" -"+i+" -"+n+" 0 -"+n+" c"),r.push(i+" -"+n+" "+n+" -"+i+" "+n+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+Wu(fr.internal.getWidth(t)/2)+" "+Wu(fr.internal.getHeight(t)/2)+" cm"),r.push(s+" 0 m"),r.push(s+" "+o+" "+o+" "+s+" 0 "+s+" c"),r.push("-"+o+" "+s+" -"+s+" "+o+" -"+s+" 0 c"),r.push("-"+s+" -"+o+" -"+o+" -"+s+" 0 -"+s+" c"),r.push(o+" -"+s+" "+s+" -"+o+" "+s+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e},OffPushDown:function(t){var e=Dc(t);e.scope=t.scope;var r=[],s=fr.internal.getWidth(t)<=fr.internal.getHeight(t)?fr.internal.getWidth(t)/4:fr.internal.getHeight(t)/4;s=Number((.9*s).toFixed(5));var n=Number((2*s).toFixed(5)),i=Number((n*fr.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Wu(fr.internal.getWidth(t)/2)+" "+Wu(fr.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+i+" "+i+" "+n+" 0 "+n+" c"),r.push("-"+i+" "+n+" -"+n+" "+i+" -"+n+" 0 c"),r.push("-"+n+" -"+i+" -"+i+" -"+n+" 0 -"+n+" c"),r.push(i+" -"+n+" "+n+" -"+i+" "+n+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e}},Cross:{createAppearanceStream:function(t){var e={D:{Off:fr.RadioButton.Cross.OffPushDown},N:{}};return e.N[t]=fr.RadioButton.Cross.YesNormal,e.D[t]=fr.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(t){var e=Dc(t);e.scope=t.scope;var r=[],s=fr.internal.calculateCross(t);return r.push("q"),r.push("1 1 "+Hr(fr.internal.getWidth(t)-2)+" "+Hr(fr.internal.getHeight(t)-2)+" re"),r.push("W"),r.push("n"),r.push(Hr(s.x1.x)+" "+Hr(s.x1.y)+" m"),r.push(Hr(s.x2.x)+" "+Hr(s.x2.y)+" l"),r.push(Hr(s.x4.x)+" "+Hr(s.x4.y)+" m"),r.push(Hr(s.x3.x)+" "+Hr(s.x3.y)+" l"),r.push("s"),r.push("Q"),e.stream=r.join(`
`),e},YesPushDown:function(t){var e=Dc(t);e.scope=t.scope;var r=fr.internal.calculateCross(t),s=[];return s.push("0.749023 g"),s.push("0 0 "+Hr(fr.internal.getWidth(t))+" "+Hr(fr.internal.getHeight(t))+" re"),s.push("f"),s.push("q"),s.push("1 1 "+Hr(fr.internal.getWidth(t)-2)+" "+Hr(fr.internal.getHeight(t)-2)+" re"),s.push("W"),s.push("n"),s.push(Hr(r.x1.x)+" "+Hr(r.x1.y)+" m"),s.push(Hr(r.x2.x)+" "+Hr(r.x2.y)+" l"),s.push(Hr(r.x4.x)+" "+Hr(r.x4.y)+" m"),s.push(Hr(r.x3.x)+" "+Hr(r.x3.y)+" l"),s.push("s"),s.push("Q"),e.stream=s.join(`
`),e},OffPushDown:function(t){var e=Dc(t);e.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Hr(fr.internal.getWidth(t))+" "+Hr(fr.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join(`
`),e}}},createDefaultAppearanceStream:function(t){var e=t.scope.internal.getFont(t.fontName,t.fontStyle).id,r=t.scope.__private__.encodeColorString(t.color);return"/"+e+" "+t.fontSize+" Tf "+r}};fr.internal={Bezier_C:.551915024494,calculateCross:function(t){var e=fr.internal.getWidth(t),r=fr.internal.getHeight(t),s=Math.min(e,r);return{x1:{x:(e-s)/2,y:(r-s)/2+s},x2:{x:(e-s)/2+s,y:(r-s)/2},x3:{x:(e-s)/2,y:(r-s)/2},x4:{x:(e-s)/2+s,y:(r-s)/2+s}}}},fr.internal.getWidth=function(t){var e=0;return Us(t)==="object"&&(e=$F(t.Rect[2])),e},fr.internal.getHeight=function(t){var e=0;return Us(t)==="object"&&(e=$F(t.Rect[3])),e};var b0e=Fn.addField=function(t){if(v0e(this,t),!(t instanceof xc))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=t).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),t.page=t.scope.internal.getCurrentPageInfo().pageNumber,this};Fn.AcroFormChoiceField=V0,Fn.AcroFormListBox=H0,Fn.AcroFormComboBox=$0,Fn.AcroFormEditBox=Pb,Fn.AcroFormButton=Qa,Fn.AcroFormPushButton=Db,Fn.AcroFormRadioButton=K0,Fn.AcroFormCheckBox=Rb,Fn.AcroFormTextField=xf,Fn.AcroFormPasswordField=Lb,Fn.AcroFormAppearance=fr,Fn.AcroForm={ChoiceField:V0,ListBox:H0,ComboBox:$0,EditBox:Pb,Button:Qa,PushButton:Db,RadioButton:K0,CheckBox:Rb,TextField:xf,PasswordField:Lb,Appearance:fr},wr.AcroForm={ChoiceField:V0,ListBox:H0,ComboBox:$0,EditBox:Pb,Button:Qa,PushButton:Db,RadioButton:K0,CheckBox:Rb,TextField:xf,PasswordField:Lb,Appearance:fr};wr.AcroForm;function gQ(t){return t.reduce(function(e,r,s){return e[r]=s,e},{})}(function(t){t.__addimage__={};var e="UNKNOWN",r={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},s=t.__addimage__.getImageFileTypeByImageData=function(B,k){var D,q,te,W,Q,re=e;if((k=k||e)==="RGBA"||B.data!==void 0&&B.data instanceof Uint8ClampedArray&&"height"in B&&"width"in B)return"RGBA";if(j(B))for(Q in r)for(te=r[Q],D=0;D<te.length;D+=1){for(W=!0,q=0;q<te[D].length;q+=1)if(te[D][q]!==void 0&&te[D][q]!==B[q]){W=!1;break}if(W===!0){re=Q;break}}else for(Q in r)for(te=r[Q],D=0;D<te.length;D+=1){for(W=!0,q=0;q<te[D].length;q+=1)if(te[D][q]!==void 0&&te[D][q]!==B.charCodeAt(q)){W=!1;break}if(W===!0){re=Q;break}}return re===e&&k!==e&&(re=k),re},n=function B(k){for(var D=this.internal.write,q=this.internal.putStream,te=(0,this.internal.getFilters)();te.indexOf("FlateEncode")!==-1;)te.splice(te.indexOf("FlateEncode"),1);k.objectId=this.internal.newObject();var W=[];if(W.push({key:"Type",value:"/XObject"}),W.push({key:"Subtype",value:"/Image"}),W.push({key:"Width",value:k.width}),W.push({key:"Height",value:k.height}),k.colorSpace===g.INDEXED?W.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(k.palette.length/3-1)+" "+("sMask"in k&&k.sMask!==void 0?k.objectId+2:k.objectId+1)+" 0 R]"}):(W.push({key:"ColorSpace",value:"/"+k.colorSpace}),k.colorSpace===g.DEVICE_CMYK&&W.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),W.push({key:"BitsPerComponent",value:k.bitsPerComponent}),"decodeParameters"in k&&k.decodeParameters!==void 0&&W.push({key:"DecodeParms",value:"<<"+k.decodeParameters+">>"}),"transparency"in k&&Array.isArray(k.transparency)){for(var Q="",re=0,G=k.transparency.length;re<G;re++)Q+=k.transparency[re]+" "+k.transparency[re]+" ";W.push({key:"Mask",value:"["+Q+"]"})}k.sMask!==void 0&&W.push({key:"SMask",value:k.objectId+1+" 0 R"});var Ae=k.filter!==void 0?["/"+k.filter]:void 0;if(q({data:k.data,additionalKeyValues:W,alreadyAppliedFilters:Ae,objectId:k.objectId}),D("endobj"),"sMask"in k&&k.sMask!==void 0){var he="/Predictor "+k.predictor+" /Colors 1 /BitsPerComponent "+k.bitsPerComponent+" /Columns "+k.width,I={width:k.width,height:k.height,colorSpace:"DeviceGray",bitsPerComponent:k.bitsPerComponent,decodeParameters:he,data:k.sMask};"filter"in k&&(I.filter=k.filter),B.call(this,I)}if(k.colorSpace===g.INDEXED){var U=this.internal.newObject();q({data:w(new Uint8Array(k.palette)),objectId:U}),D("endobj")}},i=function(){var B=this.internal.collections.addImage_images;for(var k in B)n.call(this,B[k])},o=function(){var B,k=this.internal.collections.addImage_images,D=this.internal.write;for(var q in k)D("/I"+(B=k[q]).index,B.objectId,"0","R")},l=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",i),this.internal.events.subscribe("putXobjectDict",o))},c=function(){var B=this.internal.collections.addImage_images;return l.call(this),B},d=function(){return Object.keys(this.internal.collections.addImage_images).length},u=function(B){return typeof t["process"+B.toUpperCase()]=="function"},A=function(B){return Us(B)==="object"&&B.nodeType===1},h=function(B,k){if(B.nodeName==="IMG"&&B.hasAttribute("src")){var D=""+B.getAttribute("src");if(D.indexOf("data:image/")===0)return jx(unescape(D).split("base64,").pop());var q=t.loadFile(D,!0);if(q!==void 0)return q}if(B.nodeName==="CANVAS"){if(B.width===0||B.height===0)throw new Error("Given canvas must have data. Canvas width: "+B.width+", height: "+B.height);var te;switch(k){case"PNG":te="image/png";break;case"WEBP":te="image/webp";break;case"JPEG":case"JPG":default:te="image/jpeg"}return jx(B.toDataURL(te,1).split("base64,").pop())}},f=function(B){var k=this.internal.collections.addImage_images;if(k){for(var D in k)if(B===k[D].alias)return k[D]}},p=function(B,k,D){return B||k||(B=-96,k=-96),B<0&&(B=-1*D.width*72/B/this.internal.scaleFactor),k<0&&(k=-1*D.height*72/k/this.internal.scaleFactor),B===0&&(B=k*D.width/D.height),k===0&&(k=B*D.height/D.width),[B,k]},m=function(B,k,D,q,te,W){var Q=p.call(this,D,q,te),re=this.internal.getCoordinateString,G=this.internal.getVerticalCoordinateString,Ae=c.call(this);if(D=Q[0],q=Q[1],Ae[te.index]=te,W){W*=Math.PI/180;var he=Math.cos(W),I=Math.sin(W),U=function(L){return L.toFixed(4)},V=[U(he),U(I),U(-1*I),U(he),0,0,"cm"]}this.internal.write("q"),W?(this.internal.write([1,"0","0",1,re(B),G(k+q),"cm"].join(" ")),this.internal.write(V.join(" ")),this.internal.write([re(D),"0","0",re(q),"0","0","cm"].join(" "))):this.internal.write([re(D),"0","0",re(q),re(B),G(k+q),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+te.index+" Do"),this.internal.write("Q")},g=t.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};t.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var y=t.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},v=t.__addimage__.sHashCode=function(B){var k,D,q=0;if(typeof B=="string")for(D=B.length,k=0;k<D;k++)q=(q<<5)-q+B.charCodeAt(k),q|=0;else if(j(B))for(D=B.byteLength/2,k=0;k<D;k++)q=(q<<5)-q+B[k],q|=0;return q},x=t.__addimage__.validateStringAsBase64=function(B){(B=B||"").toString().trim();var k=!0;return B.length===0&&(k=!1),B.length%4!=0&&(k=!1),/^[A-Za-z0-9+/]+$/.test(B.substr(0,B.length-2))===!1&&(k=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(B.substr(-2))===!1&&(k=!1),k},E=t.__addimage__.extractImageFromDataUrl=function(B){if(B==null||!(B=B.trim()).startsWith("data:"))return null;var k=B.indexOf(",");return k<0?null:B.substring(0,k).trim().endsWith("base64")?B.substring(k+1):null},T=t.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};t.__addimage__.isArrayBuffer=function(B){return T()&&B instanceof ArrayBuffer};var j=t.__addimage__.isArrayBufferView=function(B){return T()&&typeof Uint32Array<"u"&&(B instanceof Int8Array||B instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&B instanceof Uint8ClampedArray||B instanceof Int16Array||B instanceof Uint16Array||B instanceof Int32Array||B instanceof Uint32Array||B instanceof Float32Array||B instanceof Float64Array)},C=t.__addimage__.binaryStringToUint8Array=function(B){for(var k=B.length,D=new Uint8Array(k),q=0;q<k;q++)D[q]=B.charCodeAt(q);return D},w=t.__addimage__.arrayBufferToBinaryString=function(B){for(var k="",D=j(B)?B:new Uint8Array(B),q=0;q<D.length;q+=8192)k+=String.fromCharCode.apply(null,D.subarray(q,q+8192));return k};t.addImage=function(){var B,k,D,q,te,W,Q,re,G;if(typeof arguments[1]=="number"?(k=e,D=arguments[1],q=arguments[2],te=arguments[3],W=arguments[4],Q=arguments[5],re=arguments[6],G=arguments[7]):(k=arguments[1],D=arguments[2],q=arguments[3],te=arguments[4],W=arguments[5],Q=arguments[6],re=arguments[7],G=arguments[8]),Us(B=arguments[0])==="object"&&!A(B)&&"imageData"in B){var Ae=B;B=Ae.imageData,k=Ae.format||k||e,D=Ae.x||D||0,q=Ae.y||q||0,te=Ae.w||Ae.width||te,W=Ae.h||Ae.height||W,Q=Ae.alias||Q,re=Ae.compression||re,G=Ae.rotation||Ae.angle||G}var he=this.internal.getFilters();if(re===void 0&&he.indexOf("FlateEncode")!==-1&&(re="SLOW"),isNaN(D)||isNaN(q))throw new Error("Invalid coordinates passed to jsPDF.addImage");l.call(this);var I=S.call(this,B,k,Q,re);return m.call(this,D,q,te,W,I,G),this};var S=function(B,k,D,q){var te,W,Q;if(typeof B=="string"&&s(B)===e){B=unescape(B);var re=F(B,!1);(re!==""||(re=t.loadFile(B,!0))!==void 0)&&(B=re)}if(A(B)&&(B=h(B,k)),k=s(B,k),!u(k))throw new Error("addImage does not support files of type '"+k+"', please ensure that a plugin for '"+k+"' support is added.");if(((Q=D)==null||Q.length===0)&&(D=function(G){return typeof G=="string"||j(G)?v(G):j(G.data)?v(G.data):null}(B)),(te=f.call(this,D))||(T()&&(B instanceof Uint8Array||k==="RGBA"||(W=B,B=C(B))),te=this["process"+k.toUpperCase()](B,d.call(this),D,function(G){return G&&typeof G=="string"&&(G=G.toUpperCase()),G in t.image_compression?G:y.NONE}(q),W)),!te)throw new Error("An unknown error occurred whilst processing the image.");return te},F=t.__addimage__.convertBase64ToBinaryString=function(B,k){k=typeof k!="boolean"||k;var D,q="";if(typeof B=="string"){var te;D=(te=E(B))!==null&&te!==void 0?te:B;try{q=jx(D)}catch(W){if(k)throw x(D)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+W.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return q};t.getImageProperties=function(B){var k,D,q="";if(A(B)&&(B=h(B)),typeof B=="string"&&s(B)===e&&((q=F(B,!1))===""&&(q=t.loadFile(B)||""),B=q),D=s(B),!u(D))throw new Error("addImage does not support files of type '"+D+"', please ensure that a plugin for '"+D+"' support is added.");if(!T()||B instanceof Uint8Array||(B=C(B)),!(k=this["process"+D.toUpperCase()](B)))throw new Error("An unknown error occurred whilst processing the image");return k.fileType=D,k}})(wr.API),function(t){var e=function(r){if(r!==void 0&&r!="")return!0};wr.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),t.events.push(["putPage",function(r){for(var s,n,i,o=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(r.objId),d=r.pageContext.annotations,u=!1,A=0;A<d.length&&!u;A++)switch((s=d[A]).type){case"link":(e(s.options.url)||e(s.options.pageNumber))&&(u=!0);break;case"reference":case"text":case"freetext":u=!0}if(u!=0){this.internal.write("/Annots [");for(var h=0;h<d.length;h++){s=d[h];var f=this.internal.pdfEscape,p=this.internal.getEncryptor(r.objId);switch(s.type){case"reference":this.internal.write(" "+s.object.objId+" 0 R ");break;case"text":var m=this.internal.newAdditionalObject(),g=this.internal.newAdditionalObject(),y=this.internal.getEncryptor(m.objId),v=s.title||"Note";i="<</Type /Annot /Subtype /Text "+(n="/Rect ["+o(s.bounds.x)+" "+l(s.bounds.y+s.bounds.h)+" "+o(s.bounds.x+s.bounds.w)+" "+l(s.bounds.y)+"] ")+"/Contents ("+f(y(s.contents))+")",i+=" /Popup "+g.objId+" 0 R",i+=" /P "+c.objId+" 0 R",i+=" /T ("+f(y(v))+") >>",m.content=i;var x=m.objId+" 0 R";i="<</Type /Annot /Subtype /Popup "+(n="/Rect ["+o(s.bounds.x+30)+" "+l(s.bounds.y+s.bounds.h)+" "+o(s.bounds.x+s.bounds.w+30)+" "+l(s.bounds.y)+"] ")+" /Parent "+x,s.open&&(i+=" /Open true"),i+=" >>",g.content=i,this.internal.write(m.objId,"0 R",g.objId,"0 R");break;case"freetext":n="/Rect ["+o(s.bounds.x)+" "+l(s.bounds.y)+" "+o(s.bounds.x+s.bounds.w)+" "+l(s.bounds.y+s.bounds.h)+"] ";var E=s.color||"#000000";i="<</Type /Annot /Subtype /FreeText "+n+"/Contents ("+f(p(s.contents))+")",i+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+E+")",i+=" /Border [0 0 0]",i+=" >>",this.internal.write(i);break;case"link":if(s.options.name){var T=this.annotations._nameMap[s.options.name];s.options.pageNumber=T.page,s.options.top=T.y}else s.options.top||(s.options.top=0);if(n="/Rect ["+s.finalBounds.x+" "+s.finalBounds.y+" "+s.finalBounds.w+" "+s.finalBounds.h+"] ",i="",s.options.url)i="<</Type /Annot /Subtype /Link "+n+"/Border [0 0 0] /A <</S /URI /URI ("+f(p(s.options.url))+") >>";else if(s.options.pageNumber)switch(i="<</Type /Annot /Subtype /Link "+n+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(s.options.pageNumber).objId+" 0 R",s.options.magFactor=s.options.magFactor||"XYZ",s.options.magFactor){case"Fit":i+=" /Fit]";break;case"FitH":i+=" /FitH "+s.options.top+"]";break;case"FitV":s.options.left=s.options.left||0,i+=" /FitV "+s.options.left+"]";break;case"XYZ":default:var j=l(s.options.top);s.options.left=s.options.left||0,s.options.zoom===void 0&&(s.options.zoom=0),i+=" /XYZ "+s.options.left+" "+j+" "+s.options.zoom+"]"}i!=""&&(i+=" >>",this.internal.write(i))}}this.internal.write("]")}}]),t.createAnnotation=function(r){var s=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":s.pageContext.annotations.push(r)}},t.link=function(r,s,n,i,o){var l=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,d=this.internal.getVerticalCoordinateString;l.pageContext.annotations.push({finalBounds:{x:c(r),y:d(s),w:c(r+n),h:d(s+i)},options:o,type:"link"})},t.textWithLink=function(r,s,n,i){var o,l,c=this.getTextWidth(r),d=this.internal.getLineHeight()/this.internal.scaleFactor;if(i.maxWidth!==void 0){l=i.maxWidth;var u=this.splitTextToSize(r,l).length;o=Math.ceil(d*u)}else l=c,o=d;return this.text(r,s,n,i),n+=.2*d,i.align==="center"&&(s-=c/2),i.align==="right"&&(s-=c),this.link(s,n-d,l,o,i),c},t.getTextWidth=function(r){var s=this.internal.getFontSize();return this.getStringUnitWidth(r)*s/this.internal.scaleFactor}}(wr.API),function(t){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},s={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},n=[1570,1571,1573,1575];t.__arabicParser__={};var i=t.__arabicParser__.isInArabicSubstitutionA=function(m){return e[m.charCodeAt(0)]!==void 0},o=t.__arabicParser__.isArabicLetter=function(m){return typeof m=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(m)},l=t.__arabicParser__.isArabicEndLetter=function(m){return o(m)&&i(m)&&e[m.charCodeAt(0)].length<=2},c=t.__arabicParser__.isArabicAlfLetter=function(m){return o(m)&&n.indexOf(m.charCodeAt(0))>=0};t.__arabicParser__.arabicLetterHasIsolatedForm=function(m){return o(m)&&i(m)&&e[m.charCodeAt(0)].length>=1};var d=t.__arabicParser__.arabicLetterHasFinalForm=function(m){return o(m)&&i(m)&&e[m.charCodeAt(0)].length>=2};t.__arabicParser__.arabicLetterHasInitialForm=function(m){return o(m)&&i(m)&&e[m.charCodeAt(0)].length>=3};var u=t.__arabicParser__.arabicLetterHasMedialForm=function(m){return o(m)&&i(m)&&e[m.charCodeAt(0)].length==4},A=t.__arabicParser__.resolveLigatures=function(m){var g=0,y=r,v="",x=0;for(g=0;g<m.length;g+=1)y[m.charCodeAt(g)]!==void 0?(x++,typeof(y=y[m.charCodeAt(g)])=="number"&&(v+=String.fromCharCode(y),y=r,x=0),g===m.length-1&&(y=r,v+=m.charAt(g-(x-1)),g-=x-1,x=0)):(y=r,v+=m.charAt(g-x),g-=x,x=0);return v};t.__arabicParser__.isArabicDiacritic=function(m){return m!==void 0&&s[m.charCodeAt(0)]!==void 0};var h=t.__arabicParser__.getCorrectForm=function(m,g,y){return o(m)?i(m)===!1?-1:!d(m)||!o(g)&&!o(y)||!o(y)&&l(g)||l(m)&&!o(g)||l(m)&&c(g)||l(m)&&l(g)?0:u(m)&&o(g)&&!l(g)&&o(y)&&d(y)?3:l(m)||!o(y)?1:2:-1},f=function(m){var g=0,y=0,v=0,x="",E="",T="",j=(m=m||"").split("\\s+"),C=[];for(g=0;g<j.length;g+=1){for(C.push(""),y=0;y<j[g].length;y+=1)x=j[g][y],E=j[g][y-1],T=j[g][y+1],o(x)?(v=h(x,E,T),C[g]+=v!==-1?String.fromCharCode(e[x.charCodeAt(0)][v]):x):C[g]+=x;C[g]=A(C[g])}return C.join(" ")},p=t.__arabicParser__.processArabic=t.processArabic=function(){var m,g=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,y=[];if(Array.isArray(g)){var v=0;for(y=[],v=0;v<g.length;v+=1)Array.isArray(g[v])?y.push([f(g[v][0]),g[v][1],g[v][2]]):y.push([f(g[v])]);m=y}else m=f(g);return typeof arguments[0]=="string"?m:(arguments[0].text=m,arguments[0])};t.events.push(["preProcessText",p])}(wr.API),wr.API.autoPrint=function(t){var e;switch((t=t||{}).variant=t.variant||"non-conform",t.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})}return this},function(t){var e=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(l){r=l}});var s=150;Object.defineProperty(this,"width",{get:function(){return s},set:function(l){s=isNaN(l)||Number.isInteger(l)===!1||l<0?150:l,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=s+1)}});var n=300;Object.defineProperty(this,"height",{get:function(){return n},set:function(l){n=isNaN(l)||Number.isInteger(l)===!1||l<0?300:l,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=n+1)}});var i=[];Object.defineProperty(this,"childNodes",{get:function(){return i},set:function(l){i=l}});var o={};Object.defineProperty(this,"style",{get:function(){return o},set:function(l){o=l}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(r,s){var n;if((r=r||"2d")!=="2d")return null;for(n in s)this.pdf.context2d.hasOwnProperty(n)&&(this.pdf.context2d[n]=s[n]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},t.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])}(wr.API),function(t){var e={left:0,top:0,bottom:0,right:0},r=!1,s=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),n.call(this))},n=function(){this.internal.__cell__.lastCell=new i,this.internal.__cell__.pages=1},i=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(m){c=m}});var d=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return d},set:function(m){d=m}});var u=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return u},set:function(m){u=m}});var A=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return A},set:function(m){A=m}});var h=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return h},set:function(m){h=m}});var f=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return f},set:function(m){f=m}});var p=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return p},set:function(m){p=m}}),this};i.prototype.clone=function(){return new i(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},i.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},t.setHeaderFunction=function(c){return s.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},t.getTextDimensions=function(c,d){s.call(this);var u=(d=d||{}).fontSize||this.getFontSize(),A=d.font||this.getFont(),h=d.scaleFactor||this.internal.scaleFactor,f=0,p=0,m=0,g=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var y=d.maxWidth;y>0?typeof c=="string"?c=this.splitTextToSize(c,y):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce(function(x,E){return x.concat(g.splitTextToSize(E,y))},[])):c=Array.isArray(c)?c:[c];for(var v=0;v<c.length;v++)f<(m=this.getStringUnitWidth(c[v],{font:A})*u)&&(f=m);return f!==0&&(p=c.length),{w:f/=h,h:Math.max((p*u*this.getLineHeightFactor()-u*(this.getLineHeightFactor()-1))/h,0)}},t.cellAddPage=function(){s.call(this),this.addPage();var c=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new i(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var o=t.cell=function(){var c;c=arguments[0]instanceof i?arguments[0]:new i(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),s.call(this);var d=this.internal.__cell__.lastCell,u=this.internal.__cell__.padding,A=this.internal.__cell__.margins||e,h=this.internal.__cell__.tableHeaderRow,f=this.internal.__cell__.printHeaders;return d.lineNumber!==void 0&&(d.lineNumber===c.lineNumber?(c.x=(d.x||0)+(d.width||0),c.y=d.y||0):d.y+d.height+c.height+A.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=A.top,f&&h&&(this.printHeaderRow(c.lineNumber,!0),c.y+=h[0].height)):c.y=d.y+d.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,r===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-u,c.y+u,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+u,{align:"center",baseline:"top",maxWidth:c.width-u-u}):this.text(c.text,c.x+u,c.y+u,{align:"left",baseline:"top",maxWidth:c.width-u-u})),this.internal.__cell__.lastCell=c,this};t.table=function(c,d,u,A,h){if(s.call(this),!u)throw new Error("No data for PDF table.");var f,p,m,g,y=[],v=[],x=[],E={},T={},j=[],C=[],w=(h=h||{}).autoSize||!1,S=h.printHeaders!==!1,F=h.css&&h.css["font-size"]!==void 0?16*h.css["font-size"]:h.fontSize||12,B=h.margins||Object.assign({width:this.getPageWidth()},e),k=typeof h.padding=="number"?h.padding:3,D=h.headerBackgroundColor||"#c8c8c8",q=h.headerTextColor||"#000";if(n.call(this),this.internal.__cell__.printHeaders=S,this.internal.__cell__.margins=B,this.internal.__cell__.table_font_size=F,this.internal.__cell__.padding=k,this.internal.__cell__.headerBackgroundColor=D,this.internal.__cell__.headerTextColor=q,this.setFontSize(F),A==null)v=y=Object.keys(u[0]),x=y.map(function(){return"left"});else if(Array.isArray(A)&&Us(A[0])==="object")for(y=A.map(function(Ae){return Ae.name}),v=A.map(function(Ae){return Ae.prompt||Ae.name||""}),x=A.map(function(Ae){return Ae.align||"left"}),f=0;f<A.length;f+=1)T[A[f].name]=A[f].width*(19.049976/25.4);else Array.isArray(A)&&typeof A[0]=="string"&&(v=y=A,x=y.map(function(){return"left"}));if(w||Array.isArray(A)&&typeof A[0]=="string")for(f=0;f<y.length;f+=1){for(E[g=y[f]]=u.map(function(Ae){return Ae[g]}),this.setFont(void 0,"bold"),j.push(this.getTextDimensions(v[f],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),p=E[g],this.setFont(void 0,"normal"),m=0;m<p.length;m+=1)j.push(this.getTextDimensions(p[m],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);T[g]=Math.max.apply(null,j)+k+k,j=[]}if(S){var te={};for(f=0;f<y.length;f+=1)te[y[f]]={},te[y[f]].text=v[f],te[y[f]].align=x[f];var W=l.call(this,te,T);C=y.map(function(Ae){return new i(c,d,T[Ae],W,te[Ae].text,void 0,te[Ae].align)}),this.setTableHeaderRow(C),this.printHeaderRow(1,!1)}var Q=A.reduce(function(Ae,he){return Ae[he.name]=he.align,Ae},{});for(f=0;f<u.length;f+=1){"rowStart"in h&&h.rowStart instanceof Function&&h.rowStart({row:f,data:u[f]},this);var re=l.call(this,u[f],T);for(m=0;m<y.length;m+=1){var G=u[f][y[m]];"cellStart"in h&&h.cellStart instanceof Function&&h.cellStart({row:f,col:m,data:G},this),o.call(this,new i(c,d,T[y[m]],re,G,f+2,Q[y[m]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=d,this};var l=function(c,d){var u=this.internal.__cell__.padding,A=this.internal.__cell__.table_font_size,h=this.internal.scaleFactor;return Object.keys(c).map(function(f){var p=c[f];return this.splitTextToSize(p.hasOwnProperty("text")?p.text:p,d[f]-u-u)},this).map(function(f){return this.getLineHeightFactor()*f.length*A/h+u+u},this).reduce(function(f,p){return Math.max(f,p)},0)};t.setTableHeaderRow=function(c){s.call(this),this.internal.__cell__.tableHeaderRow=c},t.printHeaderRow=function(c,d){if(s.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var u;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var A=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new i(A[0],A[1],A[2],A[3],void 0,-1)}this.setFont(void 0,"bold");for(var h=[],f=0;f<this.internal.__cell__.tableHeaderRow.length;f+=1){u=this.internal.__cell__.tableHeaderRow[f].clone(),d&&(u.y=this.internal.__cell__.margins.top||0,h.push(u)),u.lineNumber=c;var p=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),o.call(this,u),this.setTextColor(p)}h.length>0&&this.setTableHeaderRow(h),this.setFont(void 0,"normal"),r=!1}}(wr.API);var xQ={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},yQ=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],hS=gQ(yQ),vQ=[100,200,300,400,500,600,700,800,900],w0e=gQ(vQ);function fS(t){var e=t.family.replace(/"|'/g,"").toLowerCase(),r=function(i){return xQ[i=i||"normal"]?i:"normal"}(t.style),s=function(i){if(!i)return 400;if(typeof i=="number")return i>=100&&i<=900&&i%100==0?i:400;if(/^\d00$/.test(i))return parseInt(i);switch(i){case"bold":return 700;case"normal":default:return 400}}(t.weight),n=function(i){return typeof hS[i=i||"normal"]=="number"?i:"normal"}(t.stretch);return{family:e,style:r,weight:s,stretch:n,src:t.src||[],ref:t.ref||{name:e,style:[n,r,s].join(" ")}}}function KF(t,e,r,s){var n;for(n=r;n>=0&&n<e.length;n+=s)if(t[e[n]])return t[e[n]];for(n=r;n>=0&&n<e.length;n-=s)if(t[e[n]])return t[e[n]]}var N0e={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},zF={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function qF(t){return[t.stretch,t.style,t.weight,t.family].join(" ")}function C0e(t,e,r){for(var s=(r=r||{}).defaultFontFamily||"times",n=Object.assign({},N0e,r.genericFontFamilies||{}),i=null,o=null,l=0;l<e.length;++l)if(n[(i=fS(e[l])).family]&&(i.family=n[i.family]),t.hasOwnProperty(i.family)){o=t[i.family];break}if(!(o=o||t[s]))throw new Error("Could not find a font-family for the rule '"+qF(i)+"' and default family '"+s+"'.");if(o=function(c,d){if(d[c])return d[c];var u=hS[c],A=u<=hS.normal?-1:1,h=KF(d,yQ,u,A);if(!h)throw new Error("Could not find a matching font-stretch value for "+c);return h}(i.stretch,o),o=function(c,d){if(d[c])return d[c];for(var u=xQ[c],A=0;A<u.length;++A)if(d[u[A]])return d[u[A]];throw new Error("Could not find a matching font-style for "+c)}(i.style,o),!(o=function(c,d){if(d[c])return d[c];if(c===400&&d[500])return d[500];if(c===500&&d[400])return d[400];var u=w0e[c],A=KF(d,vQ,u,c<400?-1:1);if(!A)throw new Error("Could not find a matching font-weight for value "+c);return A}(i.weight,o)))throw new Error("Failed to resolve a font for the rule '"+qF(i)+"'.");return o}function WF(t){return t.trimLeft()}function j0e(t,e){for(var r=0;r<t.length;){if(t.charAt(r)===e)return[t.substring(0,r),t.substring(r+1)];r+=1}return null}function S0e(t){var e=t.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],t.substring(e[0].length)]}var T1,GF,YF,CC=["times"];(function(t){var e,r,s,n,i,o,l,c,d,u=function(I){return I=I||{},this.isStrokeTransparent=I.isStrokeTransparent||!1,this.strokeOpacity=I.strokeOpacity||1,this.strokeStyle=I.strokeStyle||"#000000",this.fillStyle=I.fillStyle||"#000000",this.isFillTransparent=I.isFillTransparent||!1,this.fillOpacity=I.fillOpacity||1,this.font=I.font||"10px sans-serif",this.textBaseline=I.textBaseline||"alphabetic",this.textAlign=I.textAlign||"left",this.lineWidth=I.lineWidth||1,this.lineJoin=I.lineJoin||"miter",this.lineCap=I.lineCap||"butt",this.path=I.path||[],this.transform=I.transform!==void 0?I.transform.clone():new c,this.globalCompositeOperation=I.globalCompositeOperation||"normal",this.globalAlpha=I.globalAlpha||1,this.clip_path=I.clip_path||[],this.currentPoint=I.currentPoint||new o,this.miterLimit=I.miterLimit||10,this.lastPoint=I.lastPoint||new o,this.lineDashOffset=I.lineDashOffset||0,this.lineDash=I.lineDash||[],this.margin=I.margin||[0,0,0,0],this.prevPageLastElemOffset=I.prevPageLastElemOffset||0,this.ignoreClearRect=typeof I.ignoreClearRect!="boolean"||I.ignoreClearRect,this};t.events.push(["initialized",function(){this.context2d=new A(this),e=this.internal.f2,r=this.internal.getCoordinateString,s=this.internal.getVerticalCoordinateString,n=this.internal.getHorizontalCoordinate,i=this.internal.getVerticalCoordinate,o=this.internal.Point,l=this.internal.Rectangle,c=this.internal.Matrix,d=new u}]);var A=function(I){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var U=I;Object.defineProperty(this,"pdf",{get:function(){return U}});var V=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return V},set:function(Ce){V=!!Ce}});var L=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return L},set:function(Ce){L=!!Ce}});var K=0;Object.defineProperty(this,"posX",{get:function(){return K},set:function(Ce){isNaN(Ce)||(K=Ce)}});var fe=0;Object.defineProperty(this,"posY",{get:function(){return fe},set:function(Ce){isNaN(Ce)||(fe=Ce)}}),Object.defineProperty(this,"margin",{get:function(){return d.margin},set:function(Ce){var oe;typeof Ce=="number"?oe=[Ce,Ce,Ce,Ce]:((oe=new Array(4))[0]=Ce[0],oe[1]=Ce.length>=2?Ce[1]:oe[0],oe[2]=Ce.length>=3?Ce[2]:oe[0],oe[3]=Ce.length>=4?Ce[3]:oe[1]),d.margin=oe}});var ee=!1;Object.defineProperty(this,"autoPaging",{get:function(){return ee},set:function(Ce){ee=Ce}});var de=0;Object.defineProperty(this,"lastBreak",{get:function(){return de},set:function(Ce){de=Ce}});var ue=[];Object.defineProperty(this,"pageBreaks",{get:function(){return ue},set:function(Ce){ue=Ce}}),Object.defineProperty(this,"ctx",{get:function(){return d},set:function(Ce){Ce instanceof u&&(d=Ce)}}),Object.defineProperty(this,"path",{get:function(){return d.path},set:function(Ce){d.path=Ce}});var Ie=[];Object.defineProperty(this,"ctxStack",{get:function(){return Ie},set:function(Ce){Ie=Ce}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(Ce){var oe;oe=h(Ce),this.ctx.fillStyle=oe.style,this.ctx.isFillTransparent=oe.a===0,this.ctx.fillOpacity=oe.a,this.pdf.setFillColor(oe.r,oe.g,oe.b,{a:oe.a}),this.pdf.setTextColor(oe.r,oe.g,oe.b,{a:oe.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(Ce){var oe=h(Ce);this.ctx.strokeStyle=oe.style,this.ctx.isStrokeTransparent=oe.a===0,this.ctx.strokeOpacity=oe.a,oe.a===0?this.pdf.setDrawColor(255,255,255):(oe.a,this.pdf.setDrawColor(oe.r,oe.g,oe.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(Ce){["butt","round","square"].indexOf(Ce)!==-1&&(this.ctx.lineCap=Ce,this.pdf.setLineCap(Ce))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(Ce){isNaN(Ce)||(this.ctx.lineWidth=Ce,this.pdf.setLineWidth(Ce))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(Ce){["bevel","round","miter"].indexOf(Ce)!==-1&&(this.ctx.lineJoin=Ce,this.pdf.setLineJoin(Ce))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(Ce){isNaN(Ce)||(this.ctx.miterLimit=Ce,this.pdf.setMiterLimit(Ce))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(Ce){this.ctx.textBaseline=Ce}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(Ce){["right","end","center","left","start"].indexOf(Ce)!==-1&&(this.ctx.textAlign=Ce)}});var Y=null;function H(Ce,oe){if(Y===null){var He=function(ie){var le=[];return Object.keys(ie).forEach(function(ae){ie[ae].forEach(function(ve){var we=null;switch(ve){case"bold":we={family:ae,weight:"bold"};break;case"italic":we={family:ae,style:"italic"};break;case"bolditalic":we={family:ae,weight:"bold",style:"italic"};break;case"":case"normal":we={family:ae}}we!==null&&(we.ref={name:ae,style:ve},le.push(we))})}),le}(Ce.getFontList());Y=function(ie){for(var le={},ae=0;ae<ie.length;++ae){var ve=fS(ie[ae]),we=ve.family,De=ve.stretch,Ve=ve.style,me=ve.weight;le[we]=le[we]||{},le[we][De]=le[we][De]||{},le[we][De][Ve]=le[we][De][Ve]||{},le[we][De][Ve][me]=ve}return le}(He.concat(oe))}return Y}var je=null;Object.defineProperty(this,"fontFaces",{get:function(){return je},set:function(Ce){Y=null,je=Ce}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(Ce){var oe;if(this.ctx.font=Ce,(oe=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(Ce))!==null){var He=oe[1];oe[2];var ie=oe[3],le=oe[4];oe[5];var ae=oe[6],ve=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(le)[2];le=Math.floor(ve==="px"?parseFloat(le)*this.pdf.internal.scaleFactor:ve==="em"?parseFloat(le)*this.pdf.getFontSize():parseFloat(le)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(le);var we=function(X){var _e,ke,lt=[],mt=X.trim();if(mt==="")return CC;if(mt in zF)return[zF[mt]];for(;mt!=="";){switch(ke=null,_e=(mt=WF(mt)).charAt(0)){case'"':case"'":ke=j0e(mt.substring(1),_e);break;default:ke=S0e(mt)}if(ke===null||(lt.push(ke[0]),(mt=WF(ke[1]))!==""&&mt.charAt(0)!==","))return CC;mt=mt.replace(/^,/,"")}return lt}(ae);if(this.fontFaces){var De=C0e(H(this.pdf,this.fontFaces),we.map(function(X){return{family:X,stretch:"normal",weight:ie,style:He}}));this.pdf.setFont(De.ref.name,De.ref.style)}else{var Ve="";(ie==="bold"||parseInt(ie,10)>=700||He==="bold")&&(Ve="bold"),He==="italic"&&(Ve+="italic"),Ve.length===0&&(Ve="normal");for(var me="",Fe={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},Re=0;Re<we.length;Re++){if(this.pdf.internal.getFont(we[Re],Ve,{noFallback:!0,disableWarning:!0})!==void 0){me=we[Re];break}if(Ve==="bolditalic"&&this.pdf.internal.getFont(we[Re],"bold",{noFallback:!0,disableWarning:!0})!==void 0)me=we[Re],Ve="bold";else if(this.pdf.internal.getFont(we[Re],"normal",{noFallback:!0,disableWarning:!0})!==void 0){me=we[Re],Ve="normal";break}}if(me===""){for(var Be=0;Be<we.length;Be++)if(Fe[we[Be]]){me=Fe[we[Be]];break}}me=me===""?"Times":me,this.pdf.setFont(me,Ve)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(Ce){this.ctx.globalCompositeOperation=Ce}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(Ce){this.ctx.globalAlpha=Ce}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(Ce){this.ctx.lineDashOffset=Ce,he.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(Ce){this.ctx.lineDash=Ce,he.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(Ce){this.ctx.ignoreClearRect=!!Ce}})};A.prototype.setLineDash=function(I){this.lineDash=I},A.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},A.prototype.fill=function(){E.call(this,"fill",!1)},A.prototype.stroke=function(){E.call(this,"stroke",!1)},A.prototype.beginPath=function(){this.path=[{type:"begin"}]},A.prototype.moveTo=function(I,U){if(isNaN(I)||isNaN(U))throw Gs.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var V=this.ctx.transform.applyToPoint(new o(I,U));this.path.push({type:"mt",x:V.x,y:V.y}),this.ctx.lastPoint=new o(I,U)},A.prototype.closePath=function(){var I=new o(0,0),U=0;for(U=this.path.length-1;U!==-1;U--)if(this.path[U].type==="begin"&&Us(this.path[U+1])==="object"&&typeof this.path[U+1].x=="number"){I=new o(this.path[U+1].x,this.path[U+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new o(I.x,I.y)},A.prototype.lineTo=function(I,U){if(isNaN(I)||isNaN(U))throw Gs.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var V=this.ctx.transform.applyToPoint(new o(I,U));this.path.push({type:"lt",x:V.x,y:V.y}),this.ctx.lastPoint=new o(V.x,V.y)},A.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),E.call(this,null,!0)},A.prototype.quadraticCurveTo=function(I,U,V,L){if(isNaN(V)||isNaN(L)||isNaN(I)||isNaN(U))throw Gs.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var K=this.ctx.transform.applyToPoint(new o(V,L)),fe=this.ctx.transform.applyToPoint(new o(I,U));this.path.push({type:"qct",x1:fe.x,y1:fe.y,x:K.x,y:K.y}),this.ctx.lastPoint=new o(K.x,K.y)},A.prototype.bezierCurveTo=function(I,U,V,L,K,fe){if(isNaN(K)||isNaN(fe)||isNaN(I)||isNaN(U)||isNaN(V)||isNaN(L))throw Gs.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var ee=this.ctx.transform.applyToPoint(new o(K,fe)),de=this.ctx.transform.applyToPoint(new o(I,U)),ue=this.ctx.transform.applyToPoint(new o(V,L));this.path.push({type:"bct",x1:de.x,y1:de.y,x2:ue.x,y2:ue.y,x:ee.x,y:ee.y}),this.ctx.lastPoint=new o(ee.x,ee.y)},A.prototype.arc=function(I,U,V,L,K,fe){if(isNaN(I)||isNaN(U)||isNaN(V)||isNaN(L)||isNaN(K))throw Gs.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(fe=!!fe,!this.ctx.transform.isIdentity){var ee=this.ctx.transform.applyToPoint(new o(I,U));I=ee.x,U=ee.y;var de=this.ctx.transform.applyToPoint(new o(0,V)),ue=this.ctx.transform.applyToPoint(new o(0,0));V=Math.sqrt(Math.pow(de.x-ue.x,2)+Math.pow(de.y-ue.y,2))}Math.abs(K-L)>=2*Math.PI&&(L=0,K=2*Math.PI),this.path.push({type:"arc",x:I,y:U,radius:V,startAngle:L,endAngle:K,counterclockwise:fe})},A.prototype.arcTo=function(I,U,V,L,K){throw new Error("arcTo not implemented.")},A.prototype.rect=function(I,U,V,L){if(isNaN(I)||isNaN(U)||isNaN(V)||isNaN(L))throw Gs.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(I,U),this.lineTo(I+V,U),this.lineTo(I+V,U+L),this.lineTo(I,U+L),this.lineTo(I,U),this.lineTo(I+V,U),this.lineTo(I,U)},A.prototype.fillRect=function(I,U,V,L){if(isNaN(I)||isNaN(U)||isNaN(V)||isNaN(L))throw Gs.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!f.call(this)){var K={};this.lineCap!=="butt"&&(K.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(K.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(I,U,V,L),this.fill(),K.hasOwnProperty("lineCap")&&(this.lineCap=K.lineCap),K.hasOwnProperty("lineJoin")&&(this.lineJoin=K.lineJoin)}},A.prototype.strokeRect=function(I,U,V,L){if(isNaN(I)||isNaN(U)||isNaN(V)||isNaN(L))throw Gs.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");p.call(this)||(this.beginPath(),this.rect(I,U,V,L),this.stroke())},A.prototype.clearRect=function(I,U,V,L){if(isNaN(I)||isNaN(U)||isNaN(V)||isNaN(L))throw Gs.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(I,U,V,L))},A.prototype.save=function(I){I=typeof I!="boolean"||I;for(var U=this.pdf.internal.getCurrentPageInfo().pageNumber,V=0;V<this.pdf.internal.getNumberOfPages();V++)this.pdf.setPage(V+1),this.pdf.internal.out("q");if(this.pdf.setPage(U),I){this.ctx.fontSize=this.pdf.internal.getFontSize();var L=new u(this.ctx);this.ctxStack.push(this.ctx),this.ctx=L}},A.prototype.restore=function(I){I=typeof I!="boolean"||I;for(var U=this.pdf.internal.getCurrentPageInfo().pageNumber,V=0;V<this.pdf.internal.getNumberOfPages();V++)this.pdf.setPage(V+1),this.pdf.internal.out("Q");this.pdf.setPage(U),I&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},A.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var h=function(I){var U,V,L,K;if(I.isCanvasGradient===!0&&(I=I.getColor()),!I)return{r:0,g:0,b:0,a:0,style:I};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(I))U=0,V=0,L=0,K=0;else{var fe=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(I);if(fe!==null)U=parseInt(fe[1]),V=parseInt(fe[2]),L=parseInt(fe[3]),K=1;else if((fe=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(I))!==null)U=parseInt(fe[1]),V=parseInt(fe[2]),L=parseInt(fe[3]),K=parseFloat(fe[4]);else{if(K=1,typeof I=="string"&&I.charAt(0)!=="#"){var ee=new uQ(I);I=ee.ok?ee.toHex():"#000000"}I.length===4?(U=I.substring(1,2),U+=U,V=I.substring(2,3),V+=V,L=I.substring(3,4),L+=L):(U=I.substring(1,3),V=I.substring(3,5),L=I.substring(5,7)),U=parseInt(U,16),V=parseInt(V,16),L=parseInt(L,16)}}return{r:U,g:V,b:L,a:K,style:I}},f=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},p=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};A.prototype.fillText=function(I,U,V,L){if(isNaN(U)||isNaN(V)||typeof I!="string")throw Gs.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(L=isNaN(L)?void 0:L,!f.call(this)){var K=re(this.ctx.transform.rotation),fe=this.ctx.transform.scaleX;k.call(this,{text:I,x:U,y:V,scale:fe,angle:K,align:this.textAlign,maxWidth:L})}},A.prototype.strokeText=function(I,U,V,L){if(isNaN(U)||isNaN(V)||typeof I!="string")throw Gs.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!p.call(this)){L=isNaN(L)?void 0:L;var K=re(this.ctx.transform.rotation),fe=this.ctx.transform.scaleX;k.call(this,{text:I,x:U,y:V,scale:fe,renderingMode:"stroke",angle:K,align:this.textAlign,maxWidth:L})}},A.prototype.measureText=function(I){if(typeof I!="string")throw Gs.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var U=this.pdf,V=this.pdf.internal.scaleFactor,L=U.internal.getFontSize(),K=U.getStringUnitWidth(I)*L/U.internal.scaleFactor,fe=function(ee){var de=(ee=ee||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return de}}),this};return new fe({width:K*=Math.round(96*V/72*1e4)/1e4})},A.prototype.scale=function(I,U){if(isNaN(I)||isNaN(U))throw Gs.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var V=new c(I,0,0,U,0,0);this.ctx.transform=this.ctx.transform.multiply(V)},A.prototype.rotate=function(I){if(isNaN(I))throw Gs.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var U=new c(Math.cos(I),Math.sin(I),-Math.sin(I),Math.cos(I),0,0);this.ctx.transform=this.ctx.transform.multiply(U)},A.prototype.translate=function(I,U){if(isNaN(I)||isNaN(U))throw Gs.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var V=new c(1,0,0,1,I,U);this.ctx.transform=this.ctx.transform.multiply(V)},A.prototype.transform=function(I,U,V,L,K,fe){if(isNaN(I)||isNaN(U)||isNaN(V)||isNaN(L)||isNaN(K)||isNaN(fe))throw Gs.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var ee=new c(I,U,V,L,K,fe);this.ctx.transform=this.ctx.transform.multiply(ee)},A.prototype.setTransform=function(I,U,V,L,K,fe){I=isNaN(I)?1:I,U=isNaN(U)?0:U,V=isNaN(V)?0:V,L=isNaN(L)?1:L,K=isNaN(K)?0:K,fe=isNaN(fe)?0:fe,this.ctx.transform=new c(I,U,V,L,K,fe)};var m=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};A.prototype.drawImage=function(I,U,V,L,K,fe,ee,de,ue){var Ie=this.pdf.getImageProperties(I),Y=1,H=1,je=1,Ce=1;L!==void 0&&de!==void 0&&(je=de/L,Ce=ue/K,Y=Ie.width/L*de/L,H=Ie.height/K*ue/K),fe===void 0&&(fe=U,ee=V,U=0,V=0),L!==void 0&&de===void 0&&(de=L,ue=K),L===void 0&&de===void 0&&(de=Ie.width,ue=Ie.height);for(var oe,He=this.ctx.transform.decompose(),ie=re(He.rotate.shx),le=new c,ae=(le=(le=(le=le.multiply(He.translate)).multiply(He.skew)).multiply(He.scale)).applyToRectangle(new l(fe-U*je,ee-V*Ce,L*Y,K*H)),ve=g.call(this,ae),we=[],De=0;De<ve.length;De+=1)we.indexOf(ve[De])===-1&&we.push(ve[De]);if(x(we),this.autoPaging)for(var Ve=we[0],me=we[we.length-1],Fe=Ve;Fe<me+1;Fe++){this.pdf.setPage(Fe);var Re=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Be=Fe===1?this.posY+this.margin[0]:this.margin[0],X=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],_e=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],ke=Fe===1?0:X+(Fe-2)*_e;if(this.ctx.clip_path.length!==0){var lt=this.path;oe=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=v(oe,this.posX+this.margin[3],-ke+Be+this.ctx.prevPageLastElemOffset),T.call(this,"fill",!0),this.path=lt}var mt=JSON.parse(JSON.stringify(ae));mt=v([mt],this.posX+this.margin[3],-ke+Be+this.ctx.prevPageLastElemOffset)[0];var pt=(Fe>Ve||Fe<me)&&m.call(this);pt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Re,_e,null).clip().discardPath()),this.pdf.addImage(I,"JPEG",mt.x,mt.y,mt.w,mt.h,null,null,ie),pt&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(I,"JPEG",ae.x,ae.y,ae.w,ae.h,null,null,ie)};var g=function(I,U,V){var L=[];U=U||this.pdf.internal.pageSize.width,V=V||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var K=this.posY+this.ctx.prevPageLastElemOffset;switch(I.type){default:case"mt":case"lt":L.push(Math.floor((I.y+K)/V)+1);break;case"arc":L.push(Math.floor((I.y+K-I.radius)/V)+1),L.push(Math.floor((I.y+K+I.radius)/V)+1);break;case"qct":var fe=G(this.ctx.lastPoint.x,this.ctx.lastPoint.y,I.x1,I.y1,I.x,I.y);L.push(Math.floor((fe.y+K)/V)+1),L.push(Math.floor((fe.y+fe.h+K)/V)+1);break;case"bct":var ee=Ae(this.ctx.lastPoint.x,this.ctx.lastPoint.y,I.x1,I.y1,I.x2,I.y2,I.x,I.y);L.push(Math.floor((ee.y+K)/V)+1),L.push(Math.floor((ee.y+ee.h+K)/V)+1);break;case"rect":L.push(Math.floor((I.y+K)/V)+1),L.push(Math.floor((I.y+I.h+K)/V)+1)}for(var de=0;de<L.length;de+=1)for(;this.pdf.internal.getNumberOfPages()<L[de];)y.call(this);return L},y=function(){var I=this.fillStyle,U=this.strokeStyle,V=this.font,L=this.lineCap,K=this.lineWidth,fe=this.lineJoin;this.pdf.addPage(),this.fillStyle=I,this.strokeStyle=U,this.font=V,this.lineCap=L,this.lineWidth=K,this.lineJoin=fe},v=function(I,U,V){for(var L=0;L<I.length;L++)switch(I[L].type){case"bct":I[L].x2+=U,I[L].y2+=V;case"qct":I[L].x1+=U,I[L].y1+=V;case"mt":case"lt":case"arc":default:I[L].x+=U,I[L].y+=V}return I},x=function(I){return I.sort(function(U,V){return U-V})},E=function(I,U){for(var V,L,K=this.fillStyle,fe=this.strokeStyle,ee=this.lineCap,de=this.lineWidth,ue=Math.abs(de*this.ctx.transform.scaleX),Ie=this.lineJoin,Y=JSON.parse(JSON.stringify(this.path)),H=JSON.parse(JSON.stringify(this.path)),je=[],Ce=0;Ce<H.length;Ce++)if(H[Ce].x!==void 0)for(var oe=g.call(this,H[Ce]),He=0;He<oe.length;He+=1)je.indexOf(oe[He])===-1&&je.push(oe[He]);for(var ie=0;ie<je.length;ie++)for(;this.pdf.internal.getNumberOfPages()<je[ie];)y.call(this);if(x(je),this.autoPaging)for(var le=je[0],ae=je[je.length-1],ve=le;ve<ae+1;ve++){this.pdf.setPage(ve),this.fillStyle=K,this.strokeStyle=fe,this.lineCap=ee,this.lineWidth=ue,this.lineJoin=Ie;var we=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],De=ve===1?this.posY+this.margin[0]:this.margin[0],Ve=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],me=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Fe=ve===1?0:Ve+(ve-2)*me;if(this.ctx.clip_path.length!==0){var Re=this.path;V=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=v(V,this.posX+this.margin[3],-Fe+De+this.ctx.prevPageLastElemOffset),T.call(this,I,!0),this.path=Re}if(L=JSON.parse(JSON.stringify(Y)),this.path=v(L,this.posX+this.margin[3],-Fe+De+this.ctx.prevPageLastElemOffset),U===!1||ve===0){var Be=(ve>le||ve<ae)&&m.call(this);Be&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],we,me,null).clip().discardPath()),T.call(this,I,U),Be&&this.pdf.restoreGraphicsState()}this.lineWidth=de}else this.lineWidth=ue,T.call(this,I,U),this.lineWidth=de;this.path=Y},T=function(I,U){if((I!=="stroke"||U||!p.call(this))&&(I==="stroke"||U||!f.call(this))){for(var V,L,K=[],fe=this.path,ee=0;ee<fe.length;ee++){var de=fe[ee];switch(de.type){case"begin":K.push({begin:!0});break;case"close":K.push({close:!0});break;case"mt":K.push({start:de,deltas:[],abs:[]});break;case"lt":var ue=K.length;if(fe[ee-1]&&!isNaN(fe[ee-1].x)&&(V=[de.x-fe[ee-1].x,de.y-fe[ee-1].y],ue>0)){for(;ue>=0;ue--)if(K[ue-1].close!==!0&&K[ue-1].begin!==!0){K[ue-1].deltas.push(V),K[ue-1].abs.push(de);break}}break;case"bct":V=[de.x1-fe[ee-1].x,de.y1-fe[ee-1].y,de.x2-fe[ee-1].x,de.y2-fe[ee-1].y,de.x-fe[ee-1].x,de.y-fe[ee-1].y],K[K.length-1].deltas.push(V);break;case"qct":var Ie=fe[ee-1].x+2/3*(de.x1-fe[ee-1].x),Y=fe[ee-1].y+2/3*(de.y1-fe[ee-1].y),H=de.x+2/3*(de.x1-de.x),je=de.y+2/3*(de.y1-de.y),Ce=de.x,oe=de.y;V=[Ie-fe[ee-1].x,Y-fe[ee-1].y,H-fe[ee-1].x,je-fe[ee-1].y,Ce-fe[ee-1].x,oe-fe[ee-1].y],K[K.length-1].deltas.push(V);break;case"arc":K.push({deltas:[],abs:[],arc:!0}),Array.isArray(K[K.length-1].abs)&&K[K.length-1].abs.push(de)}}L=U?null:I==="stroke"?"stroke":"fill";for(var He=!1,ie=0;ie<K.length;ie++)if(K[ie].arc)for(var le=K[ie].abs,ae=0;ae<le.length;ae++){var ve=le[ae];ve.type==="arc"?w.call(this,ve.x,ve.y,ve.radius,ve.startAngle,ve.endAngle,ve.counterclockwise,void 0,U,!He):D.call(this,ve.x,ve.y),He=!0}else if(K[ie].close===!0)this.pdf.internal.out("h"),He=!1;else if(K[ie].begin!==!0){var we=K[ie].start.x,De=K[ie].start.y;q.call(this,K[ie].deltas,we,De),He=!0}L&&S.call(this,L),U&&F.call(this)}},j=function(I){var U=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,V=U*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return I-V;case"top":return I+U-V;case"hanging":return I+U-2*V;case"middle":return I+U/2-V;case"ideographic":return I;case"alphabetic":default:return I}},C=function(I){return I+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};A.prototype.createLinearGradient=function(){var I=function(){};return I.colorStops=[],I.addColorStop=function(U,V){this.colorStops.push([U,V])},I.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},I.isCanvasGradient=!0,I},A.prototype.createPattern=function(){return this.createLinearGradient()},A.prototype.createRadialGradient=function(){return this.createLinearGradient()};var w=function(I,U,V,L,K,fe,ee,de,ue){for(var Ie=W.call(this,V,L,K,fe),Y=0;Y<Ie.length;Y++){var H=Ie[Y];Y===0&&(ue?B.call(this,H.x1+I,H.y1+U):D.call(this,H.x1+I,H.y1+U)),te.call(this,I,U,H.x2,H.y2,H.x3,H.y3,H.x4,H.y4)}de?F.call(this):S.call(this,ee)},S=function(I){switch(I){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},F=function(){this.pdf.clip(),this.pdf.discardPath()},B=function(I,U){this.pdf.internal.out(r(I)+" "+s(U)+" m")},k=function(I){var U;switch(I.align){case"right":case"end":U="right";break;case"center":U="center";break;case"left":case"start":default:U="left"}var V=this.pdf.getTextDimensions(I.text),L=j.call(this,I.y),K=C.call(this,L)-V.h,fe=this.ctx.transform.applyToPoint(new o(I.x,L)),ee=this.ctx.transform.decompose(),de=new c;de=(de=(de=de.multiply(ee.translate)).multiply(ee.skew)).multiply(ee.scale);for(var ue,Ie,Y,H=this.ctx.transform.applyToRectangle(new l(I.x,L,V.w,V.h)),je=de.applyToRectangle(new l(I.x,K,V.w,V.h)),Ce=g.call(this,je),oe=[],He=0;He<Ce.length;He+=1)oe.indexOf(Ce[He])===-1&&oe.push(Ce[He]);if(x(oe),this.autoPaging)for(var ie=oe[0],le=oe[oe.length-1],ae=ie;ae<le+1;ae++){this.pdf.setPage(ae);var ve=ae===1?this.posY+this.margin[0]:this.margin[0],we=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],De=this.pdf.internal.pageSize.height-this.margin[2],Ve=De-this.margin[0],me=this.pdf.internal.pageSize.width-this.margin[1],Fe=me-this.margin[3],Re=ae===1?0:we+(ae-2)*Ve;if(this.ctx.clip_path.length!==0){var Be=this.path;ue=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=v(ue,this.posX+this.margin[3],-1*Re+ve),T.call(this,"fill",!0),this.path=Be}var X=v([JSON.parse(JSON.stringify(je))],this.posX+this.margin[3],-Re+ve+this.ctx.prevPageLastElemOffset)[0];I.scale>=.01&&(Ie=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Ie*I.scale),Y=this.lineWidth,this.lineWidth=Y*I.scale);var _e=this.autoPaging!=="text";if(_e||X.y+X.h<=De){if(_e||X.y>=ve&&X.x<=me){var ke=_e?I.text:this.pdf.splitTextToSize(I.text,I.maxWidth||me-X.x)[0],lt=v([JSON.parse(JSON.stringify(H))],this.posX+this.margin[3],-Re+ve+this.ctx.prevPageLastElemOffset)[0],mt=_e&&(ae>ie||ae<le)&&m.call(this);mt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Fe,Ve,null).clip().discardPath()),this.pdf.text(ke,lt.x,lt.y,{angle:I.angle,align:U,renderingMode:I.renderingMode}),mt&&this.pdf.restoreGraphicsState()}}else X.y<De&&(this.ctx.prevPageLastElemOffset+=De-X.y);I.scale>=.01&&(this.pdf.setFontSize(Ie),this.lineWidth=Y)}else I.scale>=.01&&(Ie=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Ie*I.scale),Y=this.lineWidth,this.lineWidth=Y*I.scale),this.pdf.text(I.text,fe.x+this.posX,fe.y+this.posY,{angle:I.angle,align:U,renderingMode:I.renderingMode,maxWidth:I.maxWidth}),I.scale>=.01&&(this.pdf.setFontSize(Ie),this.lineWidth=Y)},D=function(I,U,V,L){V=V||0,L=L||0,this.pdf.internal.out(r(I+V)+" "+s(U+L)+" l")},q=function(I,U,V){return this.pdf.lines(I,U,V,null,null)},te=function(I,U,V,L,K,fe,ee,de){this.pdf.internal.out([e(n(V+I)),e(i(L+U)),e(n(K+I)),e(i(fe+U)),e(n(ee+I)),e(i(de+U)),"c"].join(" "))},W=function(I,U,V,L){for(var K=2*Math.PI,fe=Math.PI/2;U>V;)U-=K;var ee=Math.abs(V-U);ee<K&&L&&(ee=K-ee);for(var de=[],ue=L?-1:1,Ie=U;ee>1e-5;){var Y=Ie+ue*Math.min(ee,fe);de.push(Q.call(this,I,Ie,Y)),ee-=Math.abs(Y-Ie),Ie=Y}return de},Q=function(I,U,V){var L=(V-U)/2,K=I*Math.cos(L),fe=I*Math.sin(L),ee=K,de=-fe,ue=ee*ee+de*de,Ie=ue+ee*K+de*fe,Y=4/3*(Math.sqrt(2*ue*Ie)-Ie)/(ee*fe-de*K),H=ee-Y*de,je=de+Y*ee,Ce=H,oe=-je,He=L+U,ie=Math.cos(He),le=Math.sin(He);return{x1:I*Math.cos(U),y1:I*Math.sin(U),x2:H*ie-je*le,y2:H*le+je*ie,x3:Ce*ie-oe*le,y3:Ce*le+oe*ie,x4:I*Math.cos(V),y4:I*Math.sin(V)}},re=function(I){return 180*I/Math.PI},G=function(I,U,V,L,K,fe){var ee=I+.5*(V-I),de=U+.5*(L-U),ue=K+.5*(V-K),Ie=fe+.5*(L-fe),Y=Math.min(I,K,ee,ue),H=Math.max(I,K,ee,ue),je=Math.min(U,fe,de,Ie),Ce=Math.max(U,fe,de,Ie);return new l(Y,je,H-Y,Ce-je)},Ae=function(I,U,V,L,K,fe,ee,de){var ue,Ie,Y,H,je,Ce,oe,He,ie,le,ae,ve,we,De,Ve=V-I,me=L-U,Fe=K-V,Re=fe-L,Be=ee-K,X=de-fe;for(Ie=0;Ie<41;Ie++)ie=(oe=(Y=I+(ue=Ie/40)*Ve)+ue*((je=V+ue*Fe)-Y))+ue*(je+ue*(K+ue*Be-je)-oe),le=(He=(H=U+ue*me)+ue*((Ce=L+ue*Re)-H))+ue*(Ce+ue*(fe+ue*X-Ce)-He),Ie==0?(ae=ie,ve=le,we=ie,De=le):(ae=Math.min(ae,ie),ve=Math.min(ve,le),we=Math.max(we,ie),De=Math.max(De,le));return new l(Math.round(ae),Math.round(ve),Math.round(we-ae),Math.round(De-ve))},he=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var I,U,V=(I=this.ctx.lineDash,U=this.ctx.lineDashOffset,JSON.stringify({lineDash:I,lineDashOffset:U}));this.prevLineDash!==V&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=V)}}})(wr.API),function(t){var e=function(i){var o,l,c,d,u,A,h,f,p,m;for(l=[],c=0,d=(i+=o="\0\0\0\0".slice(i.length%4||4)).length;d>c;c+=4)(u=(i.charCodeAt(c)<<24)+(i.charCodeAt(c+1)<<16)+(i.charCodeAt(c+2)<<8)+i.charCodeAt(c+3))!==0?(A=(u=((u=((u=((u=(u-(m=u%85))/85)-(p=u%85))/85)-(f=u%85))/85)-(h=u%85))/85)%85,l.push(A+33,h+33,f+33,p+33,m+33)):l.push(122);return function(g,y){for(var v=y;v>0;v--)g.pop()}(l,o.length),String.fromCharCode.apply(String,l)+"~>"},r=function(i){var o,l,c,d,u,A=String,h="length",f=255,p="charCodeAt",m="slice",g="replace";for(i[m](-2),i=i[m](0,-2)[g](/\s/g,"")[g]("z","!!!!!"),c=[],d=0,u=(i+=o="uuuuu"[m](i[h]%5||5))[h];u>d;d+=5)l=52200625*(i[p](d)-33)+614125*(i[p](d+1)-33)+7225*(i[p](d+2)-33)+85*(i[p](d+3)-33)+(i[p](d+4)-33),c.push(f&l>>24,f&l>>16,f&l>>8,f&l);return function(y,v){for(var x=v;x>0;x--)y.pop()}(c,o[h]),A.fromCharCode.apply(A,c)},s=function(i){var o=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((i=i.replace(/\s/g,"")).indexOf(">")!==-1&&(i=i.substr(0,i.indexOf(">"))),i.length%2&&(i+="0"),o.test(i)===!1)return"";for(var l="",c=0;c<i.length;c+=2)l+=String.fromCharCode("0x"+(i[c]+i[c+1]));return l},n=function(i){for(var o=new Uint8Array(i.length),l=i.length;l--;)o[l]=i.charCodeAt(l);return i=(o=lS(o)).reduce(function(c,d){return c+String.fromCharCode(d)},"")};t.processDataByFilters=function(i,o){var l=0,c=i||"",d=[];for(typeof(o=o||[])=="string"&&(o=[o]),l=0;l<o.length;l+=1)switch(o[l]){case"ASCII85Decode":case"/ASCII85Decode":c=r(c),d.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":c=e(c),d.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":c=s(c),d.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":c=c.split("").map(function(u){return("0"+u.charCodeAt().toString(16)).slice(-2)}).join("")+">",d.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":c=n(c),d.push("/FlateDecode");break;default:throw new Error('The filter: "'+o[l]+'" is not implemented')}return{data:c,reverseChain:d.reverse().join(" ")}}}(wr.API),function(t){t.loadFile=function(e,r,s){return function(n,i,o){i=i!==!1,o=typeof o=="function"?o:function(){};var l=void 0;try{l=function(c,d,u){var A=new XMLHttpRequest,h=0,f=function(p){var m=p.length,g=[],y=String.fromCharCode;for(h=0;h<m;h+=1)g.push(y(255&p.charCodeAt(h)));return g.join("")};if(A.open("GET",c,!d),A.overrideMimeType("text/plain; charset=x-user-defined"),d===!1&&(A.onload=function(){A.status===200?u(f(this.responseText)):u(void 0)}),A.send(null),d&&A.status===200)return f(A.responseText)}(n,i,o)}catch{}return l}(e,r,s)},t.loadImageFile=t.loadFile}(wr.API),function(t){function e(){return(Br.html2canvas?Promise.resolve(Br.html2canvas):Pn(()=>Promise.resolve().then(()=>Ube),void 0)).catch(function(o){return Promise.reject(new Error("Could not load html2canvas: "+o))}).then(function(o){return o.default?o.default:o})}function r(){return(Br.DOMPurify?Promise.resolve(Br.DOMPurify):Pn(()=>import("./purify.es-CQJ0hv7W.js"),[])).catch(function(o){return Promise.reject(new Error("Could not load dompurify: "+o))}).then(function(o){return o.default?o.default:o})}var s=function(o){var l=Us(o);return l==="undefined"?"undefined":l==="string"||o instanceof String?"string":l==="number"||o instanceof Number?"number":l==="function"||o instanceof Function?"function":o&&o.constructor===Array?"array":o&&o.nodeType===1?"element":l==="object"?"object":"unknown"},n=function(o,l){var c=document.createElement(o);for(var d in l.className&&(c.className=l.className),l.innerHTML&&l.dompurify&&(c.innerHTML=l.dompurify.sanitize(l.innerHTML)),l.style)c.style[d]=l.style[d];return c},i=function o(l){var c=Object.assign(o.convert(Promise.resolve()),JSON.parse(JSON.stringify(o.template))),d=o.convert(Promise.resolve(),c);return d=(d=d.setProgress(1,o,1,[o])).set(l)};(i.prototype=Object.create(Promise.prototype)).constructor=i,i.convert=function(o,l){return o.__proto__=l||i.prototype,o},i.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},i.prototype.from=function(o,l){return this.then(function(){switch(l=l||function(c){switch(s(c)){case"string":return"string";case"element":return c.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(o)){case"string":return this.then(r).then(function(c){return this.set({src:n("div",{innerHTML:o,dompurify:c})})});case"element":return this.set({src:o});case"canvas":return this.set({canvas:o});case"img":return this.set({img:o});default:return this.error("Unknown source type.")}})},i.prototype.to=function(o){switch(o){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},i.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var o={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},l=function c(d,u){for(var A=d.nodeType===3?document.createTextNode(d.nodeValue):d.cloneNode(!1),h=d.firstChild;h;h=h.nextSibling)u!==!0&&h.nodeType===1&&h.nodeName==="SCRIPT"||A.appendChild(c(h,u));return d.nodeType===1&&(d.nodeName==="CANVAS"?(A.width=d.width,A.height=d.height,A.getContext("2d").drawImage(d,0,0)):d.nodeName!=="TEXTAREA"&&d.nodeName!=="SELECT"||(A.value=d.value),A.addEventListener("load",function(){A.scrollTop=d.scrollTop,A.scrollLeft=d.scrollLeft},!0)),A}(this.prop.src,this.opt.html2canvas.javascriptEnabled);l.tagName==="BODY"&&(o.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=n("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=n("div",{className:"html2pdf__container",style:o}),this.prop.container.appendChild(l),this.prop.container.firstChild.appendChild(n("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},i.prototype.toCanvas=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(e).then(function(l){var c=Object.assign({},this.opt.html2canvas);return delete c.onrendered,l(this.prop.container,c)}).then(function(l){(this.opt.html2canvas.onrendered||function(){})(l),this.prop.canvas=l,document.body.removeChild(this.prop.overlay)})},i.prototype.toContext2d=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(e).then(function(l){var c=this.opt.jsPDF,d=this.opt.fontFaces,u=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,A=Object.assign({async:!0,allowTaint:!0,scale:u,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete A.onrendered,c.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,c.context2d.posX=this.opt.x,c.context2d.posY=this.opt.y,c.context2d.margin=this.opt.margin,c.context2d.fontFaces=d,d)for(var h=0;h<d.length;++h){var f=d[h],p=f.src.find(function(m){return m.format==="truetype"});p&&c.addFont(p.url,f.ref.name,f.ref.style)}return A.windowHeight=A.windowHeight||0,A.windowHeight=A.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):A.windowHeight,c.context2d.save(!0),l(this.prop.container,A)}).then(function(l){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(l),this.prop.canvas=l,document.body.removeChild(this.prop.overlay)})},i.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var o=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=o})},i.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},i.prototype.output=function(o,l,c){return(c=c||"pdf").toLowerCase()==="img"||c.toLowerCase()==="image"?this.outputImg(o,l):this.outputPdf(o,l)},i.prototype.outputPdf=function(o,l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(o,l)})},i.prototype.outputImg=function(o){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(o){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+o+'" is not supported.'}})},i.prototype.save=function(o){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(o?{filename:o}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},i.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},i.prototype.set=function(o){if(s(o)!=="object")return this;var l=Object.keys(o||{}).map(function(c){if(c in i.template.prop)return function(){this.prop[c]=o[c]};switch(c){case"margin":return this.setMargin.bind(this,o.margin);case"jsPDF":return function(){return this.opt.jsPDF=o.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,o.pageSize);default:return function(){this.opt[c]=o[c]}}},this);return this.then(function(){return this.thenList(l)})},i.prototype.get=function(o,l){return this.then(function(){var c=o in i.template.prop?this.prop[o]:this.opt[o];return l?l(c):c})},i.prototype.setMargin=function(o){return this.then(function(){switch(s(o)){case"number":o=[o,o,o,o];case"array":if(o.length===2&&(o=[o[0],o[1],o[0],o[1]]),o.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=o}).then(this.setPageSize)},i.prototype.setPageSize=function(o){function l(c,d){return Math.floor(c*d/72*96)}return this.then(function(){(o=o||wr.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(o.inner={width:o.width-this.opt.margin[1]-this.opt.margin[3],height:o.height-this.opt.margin[0]-this.opt.margin[2]},o.inner.px={width:l(o.inner.width,o.k),height:l(o.inner.height,o.k)},o.inner.ratio=o.inner.height/o.inner.width),this.prop.pageSize=o})},i.prototype.setProgress=function(o,l,c,d){return o!=null&&(this.progress.val=o),l!=null&&(this.progress.state=l),c!=null&&(this.progress.n=c),d!=null&&(this.progress.stack=d),this.progress.ratio=this.progress.val/this.progress.state,this},i.prototype.updateProgress=function(o,l,c,d){return this.setProgress(o?this.progress.val+o:null,l||null,c?this.progress.n+c:null,d?this.progress.stack.concat(d):null)},i.prototype.then=function(o,l){var c=this;return this.thenCore(o,l,function(d,u){return c.updateProgress(null,null,1,[d]),Promise.prototype.then.call(this,function(A){return c.updateProgress(null,d),A}).then(d,u).then(function(A){return c.updateProgress(1),A})})},i.prototype.thenCore=function(o,l,c){c=c||Promise.prototype.then,o&&(o=o.bind(this)),l&&(l=l.bind(this));var d=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:i.convert(Object.assign({},this),Promise.prototype),u=c.call(d,o,l);return i.convert(u,this.__proto__)},i.prototype.thenExternal=function(o,l){return Promise.prototype.then.call(this,o,l)},i.prototype.thenList=function(o){var l=this;return o.forEach(function(c){l=l.thenCore(c)}),l},i.prototype.catch=function(o){o&&(o=o.bind(this));var l=Promise.prototype.catch.call(this,o);return i.convert(l,this)},i.prototype.catchExternal=function(o){return Promise.prototype.catch.call(this,o)},i.prototype.error=function(o){return this.then(function(){throw new Error(o)})},i.prototype.using=i.prototype.set,i.prototype.saveAs=i.prototype.save,i.prototype.export=i.prototype.output,i.prototype.run=i.prototype.then,wr.getPageSize=function(o,l,c){if(Us(o)==="object"){var d=o;o=d.orientation,l=d.unit||l,c=d.format||c}l=l||"mm",c=c||"a4",o=(""+(o||"P")).toLowerCase();var u,A=(""+c).toLowerCase(),h={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(l){case"pt":u=1;break;case"mm":u=72/25.4;break;case"cm":u=72/2.54;break;case"in":u=72;break;case"px":u=.75;break;case"pc":case"em":u=12;break;case"ex":u=6;break;default:throw"Invalid unit: "+l}var f,p=0,m=0;if(h.hasOwnProperty(A))p=h[A][1]/u,m=h[A][0]/u;else try{p=c[1],m=c[0]}catch{throw new Error("Invalid format: "+c)}if(o==="p"||o==="portrait")o="p",m>p&&(f=m,m=p,p=f);else{if(o!=="l"&&o!=="landscape")throw"Invalid orientation: "+o;o="l",p>m&&(f=m,m=p,p=f)}return{width:m,height:p,unit:l,k:u,orientation:o}},t.html=function(o,l){(l=l||{}).callback=l.callback||function(){},l.html2canvas=l.html2canvas||{},l.html2canvas.canvas=l.html2canvas.canvas||this.canvas,l.jsPDF=l.jsPDF||this,l.fontFaces=l.fontFaces?l.fontFaces.map(fS):null;var c=new i(l);return l.worker?c:c.from(o).doCallback()}}(wr.API),wr.API.addJS=function(t){return YF=t,this.internal.events.subscribe("postPutResources",function(){T1=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(T1+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),GF=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+YF+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){T1!==void 0&&GF!==void 0&&this.internal.out("/Names <</JavaScript "+T1+" 0 R>>")}),this},function(t){var e;t.events.push(["postPutResources",function(){var r=this,s=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var n=r.outline.render().split(/\r\n/),i=0;i<n.length;i++){var o=n[i],l=s.exec(o);if(l!=null){var c=l[1];r.internal.newObjectDeferredBegin(c,!1)}r.internal.write(o)}if(this.outline.createNamedDestinations){var d=this.internal.pages.length,u=[];for(i=0;i<d;i++){var A=r.internal.newObject();u.push(A);var h=r.internal.getPageInfo(i+1);r.internal.write("<< /D["+h.objId+" 0 R /XYZ null null null]>> endobj")}var f=r.internal.newObject();for(r.internal.write("<< /Names [ "),i=0;i<u.length;i++)r.internal.write("(page_"+(i+1)+")"+u[i]+" 0 R");r.internal.write(" ] >>","endobj"),e=r.internal.newObject(),r.internal.write("<< /Dests "+f+" 0 R"),r.internal.write(">>","endobj")}}]),t.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+e+" 0 R"))}]),t.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(s,n,i){var o={title:n,options:i,children:[]};return s==null&&(s=this.root),s.children.push(o),o},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(s){s.id=r.internal.newObjectDeferred();for(var n=0;n<s.children.length;n++)this.genIds_r(s.children[n])},r.outline.renderRoot=function(s){this.objStart(s),this.line("/Type /Outlines"),s.children.length>0&&(this.line("/First "+this.makeRef(s.children[0])),this.line("/Last "+this.makeRef(s.children[s.children.length-1]))),this.line("/Count "+this.count_r({count:0},s)),this.objEnd()},r.outline.renderItems=function(s){for(var n=this.ctx.pdf.internal.getVerticalCoordinateString,i=0;i<s.children.length;i++){var o=s.children[i];this.objStart(o),this.line("/Title "+this.makeString(o.title)),this.line("/Parent "+this.makeRef(s)),i>0&&this.line("/Prev "+this.makeRef(s.children[i-1])),i<s.children.length-1&&this.line("/Next "+this.makeRef(s.children[i+1])),o.children.length>0&&(this.line("/First "+this.makeRef(o.children[0])),this.line("/Last "+this.makeRef(o.children[o.children.length-1])));var l=this.count=this.count_r({count:0},o);if(l>0&&this.line("/Count "+l),o.options&&o.options.pageNumber){var c=r.internal.getPageInfo(o.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+n(0)+" 0]")}this.objEnd()}for(var d=0;d<s.children.length;d++)this.renderItems(s.children[d])},r.outline.line=function(s){this.ctx.val+=s+`\r
`},r.outline.makeRef=function(s){return s.id+" 0 R"},r.outline.makeString=function(s){return"("+r.internal.pdfEscape(s)+")"},r.outline.objStart=function(s){this.ctx.val+=`\r
`+s.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(s,n){for(var i=0;i<n.children.length;i++)s.count++,this.count_r(s,n.children[i]);return s.count}}])}(wr.API),function(t){var e=[192,193,194,195,196,197,198,199];t.processJPEG=function(r,s,n,i,o,l){var c,d=this.decode.DCT_DECODE,u=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=o||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,(c=function(A){for(var h,f=256*A.charCodeAt(4)+A.charCodeAt(5),p=A.length,m={width:0,height:0,numcomponents:1},g=4;g<p;g+=2){if(g+=f,e.indexOf(A.charCodeAt(g+1))!==-1){h=256*A.charCodeAt(g+5)+A.charCodeAt(g+6),m={width:256*A.charCodeAt(g+7)+A.charCodeAt(g+8),height:h,numcomponents:A.charCodeAt(g+9)};break}f=256*A.charCodeAt(g+2)+A.charCodeAt(g+3)}return m}(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r)).numcomponents){case 1:l=this.color_spaces.DEVICE_GRAY;break;case 4:l=this.color_spaces.DEVICE_CMYK;break;case 3:l=this.color_spaces.DEVICE_RGB}u={data:r,width:c.width,height:c.height,colorSpace:l,bitsPerComponent:8,filter:d,index:s,alias:n}}return u}}(wr.API);var Lm,I1,XF,JF,ZF,E0e=function(){var t,e,r;function s(i){var o,l,c,d,u,A,h,f,p,m,g,y,v,x;for(this.data=i,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},A=null;;){switch(o=this.readUInt32(),p=(function(){var E,T;for(T=[],E=0;E<4;++E)T.push(String.fromCharCode(this.data[this.pos++]));return T}).call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(o);break;case"fcTL":A&&this.animation.frames.push(A),this.pos+=4,A={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},u=this.readUInt16(),d=this.readUInt16()||100,A.delay=1e3*u/d,A.disposeOp=this.data[this.pos++],A.blendOp=this.data[this.pos++],A.data=[];break;case"IDAT":case"fdAT":for(p==="fdAT"&&(this.pos+=4,o-=4),i=(A!=null?A.data:void 0)||this.imgData,y=0;0<=o?y<o:y>o;0<=o?++y:--y)i.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(c=this.palette.length/3,this.transparency.indexed=this.read(o),this.transparency.indexed.length>c)throw new Error("More transparent colors than palette size");if((m=c-this.transparency.indexed.length)>0)for(v=0;0<=m?v<m:v>m;0<=m?++v:--v)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(o)[0];break;case 2:this.transparency.rgb=this.read(o)}break;case"tEXt":h=(g=this.read(o)).indexOf(0),f=String.fromCharCode.apply(String,g.slice(0,h)),this.text[f]=String.fromCharCode.apply(String,g.slice(h+1));break;case"IEND":return A&&this.animation.frames.push(A),this.colors=(function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}).call(this),this.hasAlphaChannel=(x=this.colorType)===4||x===6,l=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*l,this.colorSpace=(function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}).call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=o}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}s.prototype.read=function(i){var o,l;for(l=[],o=0;0<=i?o<i:o>i;0<=i?++o:--o)l.push(this.data[this.pos++]);return l},s.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},s.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},s.prototype.decodePixels=function(i){var o=this.pixelBitlength/8,l=new Uint8Array(this.width*this.height*o),c=0,d=this;if(i==null&&(i=this.imgData),i.length===0)return new Uint8Array(0);function u(A,h,f,p){var m,g,y,v,x,E,T,j,C,w,S,F,B,k,D,q,te,W,Q,re,G,Ae=Math.ceil((d.width-A)/f),he=Math.ceil((d.height-h)/p),I=d.width==Ae&&d.height==he;for(k=o*Ae,F=I?l:new Uint8Array(k*he),E=i.length,B=0,g=0;B<he&&c<E;){switch(i[c++]){case 0:for(v=te=0;te<k;v=te+=1)F[g++]=i[c++];break;case 1:for(v=W=0;W<k;v=W+=1)m=i[c++],x=v<o?0:F[g-o],F[g++]=(m+x)%256;break;case 2:for(v=Q=0;Q<k;v=Q+=1)m=i[c++],y=(v-v%o)/o,D=B&&F[(B-1)*k+y*o+v%o],F[g++]=(D+m)%256;break;case 3:for(v=re=0;re<k;v=re+=1)m=i[c++],y=(v-v%o)/o,x=v<o?0:F[g-o],D=B&&F[(B-1)*k+y*o+v%o],F[g++]=(m+Math.floor((x+D)/2))%256;break;case 4:for(v=G=0;G<k;v=G+=1)m=i[c++],y=(v-v%o)/o,x=v<o?0:F[g-o],B===0?D=q=0:(D=F[(B-1)*k+y*o+v%o],q=y&&F[(B-1)*k+(y-1)*o+v%o]),T=x+D-q,j=Math.abs(T-x),w=Math.abs(T-D),S=Math.abs(T-q),C=j<=w&&j<=S?x:w<=S?D:q,F[g++]=(m+C)%256;break;default:throw new Error("Invalid filter algorithm: "+i[c-1])}if(!I){var U=((h+B*p)*d.width+A)*o,V=B*k;for(v=0;v<Ae;v+=1){for(var L=0;L<o;L+=1)l[U++]=F[V++];U+=(f-1)*o}}B++}}return i=a0e(i),d.interlaceMethod==1?(u(0,0,8,8),u(4,0,8,8),u(0,4,4,8),u(2,0,4,4),u(0,2,2,4),u(1,0,2,2),u(0,1,1,2)):u(0,0,1,1),l},s.prototype.decodePalette=function(){var i,o,l,c,d,u,A,h,f;for(l=this.palette,u=this.transparency.indexed||[],d=new Uint8Array((u.length||0)+l.length),c=0,i=0,o=A=0,h=l.length;A<h;o=A+=3)d[c++]=l[o],d[c++]=l[o+1],d[c++]=l[o+2],d[c++]=(f=u[i++])!=null?f:255;return d},s.prototype.copyToImageData=function(i,o){var l,c,d,u,A,h,f,p,m,g,y;if(c=this.colors,m=null,l=this.hasAlphaChannel,this.palette.length&&(m=(y=this._decodedPalette)!=null?y:this._decodedPalette=this.decodePalette(),c=4,l=!0),p=(d=i.data||i).length,A=m||o,u=h=0,c===1)for(;u<p;)f=m?4*o[u/4]:h,g=A[f++],d[u++]=g,d[u++]=g,d[u++]=g,d[u++]=l?A[f++]:255,h=f;else for(;u<p;)f=m?4*o[u/4]:h,d[u++]=A[f++],d[u++]=A[f++],d[u++]=A[f++],d[u++]=l?A[f++]:255,h=f},s.prototype.decode=function(){var i;return i=new Uint8Array(this.width*this.height*4),this.copyToImageData(i,this.decodePixels()),i};var n=function(){if(Object.prototype.toString.call(Br)==="[object Window]"){try{e=Br.document.createElement("canvas"),r=e.getContext("2d")}catch{return!1}return!0}return!1};return n(),t=function(i){var o;if(n()===!0)return r.width=i.width,r.height=i.height,r.clearRect(0,0,i.width,i.height),r.putImageData(i,0,0),(o=new Image).src=e.toDataURL(),o;throw new Error("This method requires a Browser with Canvas-capability.")},s.prototype.decodeFrames=function(i){var o,l,c,d,u,A,h,f;if(this.animation){for(f=[],l=u=0,A=(h=this.animation.frames).length;u<A;l=++u)o=h[l],c=i.createImageData(o.width,o.height),d=this.decodePixels(new Uint8Array(o.data)),this.copyToImageData(c,d),o.imageData=c,f.push(o.image=t(c));return f}},s.prototype.renderFrame=function(i,o){var l,c,d;return l=(c=this.animation.frames)[o],d=c[o-1],o===0&&i.clearRect(0,0,this.width,this.height),(d!=null?d.disposeOp:void 0)===1?i.clearRect(d.xOffset,d.yOffset,d.width,d.height):(d!=null?d.disposeOp:void 0)===2&&i.putImageData(d.imageData,d.xOffset,d.yOffset),l.blendOp===0&&i.clearRect(l.xOffset,l.yOffset,l.width,l.height),i.drawImage(l.image,l.xOffset,l.yOffset)},s.prototype.animate=function(i){var o,l,c,d,u,A,h=this;return l=0,A=this.animation,d=A.numFrames,c=A.frames,u=A.numPlays,(o=function(){var f,p;if(f=l++%d,p=c[f],h.renderFrame(i,f),d>1&&l/d<u)return h.animation._timeout=setTimeout(o,p.delay)})()},s.prototype.stopAnimation=function(){var i;return clearTimeout((i=this.animation)!=null?i._timeout:void 0)},s.prototype.render=function(i){var o,l;return i._png&&i._png.stopAnimation(),i._png=this,i.width=this.width,i.height=this.height,o=i.getContext("2d"),this.animation?(this.decodeFrames(o),this.animate(o)):(l=o.createImageData(this.width,this.height),this.copyToImageData(l,this.decodePixels()),o.putImageData(l,0,0))},s}();/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 *//**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */function _0e(t){var e=0;if(t[e++]!==71||t[e++]!==73||t[e++]!==70||t[e++]!==56||(t[e++]+1&253)!=56||t[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=t[e++]|t[e++]<<8,s=t[e++]|t[e++]<<8,n=t[e++],i=n>>7,o=1<<(7&n)+1;t[e++],t[e++];var l=null,c=null;i&&(l=e,c=o,e+=3*o);var d=!0,u=[],A=0,h=null,f=0,p=null;for(this.width=r,this.height=s;d&&e<t.length;)switch(t[e++]){case 33:switch(t[e++]){case 255:if(t[e]!==11||t[e+1]==78&&t[e+2]==69&&t[e+3]==84&&t[e+4]==83&&t[e+5]==67&&t[e+6]==65&&t[e+7]==80&&t[e+8]==69&&t[e+9]==50&&t[e+10]==46&&t[e+11]==48&&t[e+12]==3&&t[e+13]==1&&t[e+16]==0)e+=14,p=t[e++]|t[e++]<<8,e++;else for(e+=12;;){if(!((B=t[e++])>=0))throw Error("Invalid block size");if(B===0)break;e+=B}break;case 249:if(t[e++]!==4||t[e+4]!==0)throw new Error("Invalid graphics extension block.");var m=t[e++];A=t[e++]|t[e++]<<8,h=t[e++],!(1&m)&&(h=null),f=m>>2&7,e++;break;case 254:for(;;){if(!((B=t[e++])>=0))throw Error("Invalid block size");if(B===0)break;e+=B}break;default:throw new Error("Unknown graphic control label: 0x"+t[e-1].toString(16))}break;case 44:var g=t[e++]|t[e++]<<8,y=t[e++]|t[e++]<<8,v=t[e++]|t[e++]<<8,x=t[e++]|t[e++]<<8,E=t[e++],T=E>>6&1,j=1<<(7&E)+1,C=l,w=c,S=!1;E>>7&&(S=!0,C=e,w=j,e+=3*j);var F=e;for(e++;;){var B;if(!((B=t[e++])>=0))throw Error("Invalid block size");if(B===0)break;e+=B}u.push({x:g,y,width:v,height:x,has_local_palette:S,palette_offset:C,palette_size:w,data_offset:F,data_length:e-F,transparent_index:h,interlaced:!!T,delay:A,disposal:f});break;case 59:d=!1;break;default:throw new Error("Unknown gif block: 0x"+t[e-1].toString(16))}this.numFrames=function(){return u.length},this.loopCount=function(){return p},this.frameInfo=function(k){if(k<0||k>=u.length)throw new Error("Frame index out of range.");return u[k]},this.decodeAndBlitFrameBGRA=function(k,D){var q=this.frameInfo(k),te=q.width*q.height,W=new Uint8Array(te);eP(t,q.data_offset,W,te);var Q=q.palette_offset,re=q.transparent_index;re===null&&(re=256);var G=q.width,Ae=r-G,he=G,I=4*(q.y*r+q.x),U=4*((q.y+q.height)*r+q.x),V=I,L=4*Ae;q.interlaced===!0&&(L+=4*r*7);for(var K=8,fe=0,ee=W.length;fe<ee;++fe){var de=W[fe];if(he===0&&(he=G,(V+=L)>=U&&(L=4*Ae+4*r*(K-1),V=I+(G+Ae)*(K<<1),K>>=1)),de===re)V+=4;else{var ue=t[Q+3*de],Ie=t[Q+3*de+1],Y=t[Q+3*de+2];D[V++]=Y,D[V++]=Ie,D[V++]=ue,D[V++]=255}--he}},this.decodeAndBlitFrameRGBA=function(k,D){var q=this.frameInfo(k),te=q.width*q.height,W=new Uint8Array(te);eP(t,q.data_offset,W,te);var Q=q.palette_offset,re=q.transparent_index;re===null&&(re=256);var G=q.width,Ae=r-G,he=G,I=4*(q.y*r+q.x),U=4*((q.y+q.height)*r+q.x),V=I,L=4*Ae;q.interlaced===!0&&(L+=4*r*7);for(var K=8,fe=0,ee=W.length;fe<ee;++fe){var de=W[fe];if(he===0&&(he=G,(V+=L)>=U&&(L=4*Ae+4*r*(K-1),V=I+(G+Ae)*(K<<1),K>>=1)),de===re)V+=4;else{var ue=t[Q+3*de],Ie=t[Q+3*de+1],Y=t[Q+3*de+2];D[V++]=ue,D[V++]=Ie,D[V++]=Y,D[V++]=255}--he}}}function eP(t,e,r,s){for(var n=t[e++],i=1<<n,o=i+1,l=o+1,c=n+1,d=(1<<c)-1,u=0,A=0,h=0,f=t[e++],p=new Int32Array(4096),m=null;;){for(;u<16&&f!==0;)A|=t[e++]<<u,u+=8,f===1?f=t[e++]:--f;if(u<c)break;var g=A&d;if(A>>=c,u-=c,g!==i){if(g===o)break;for(var y=g<l?g:m,v=0,x=y;x>i;)x=p[x]>>8,++v;var E=x;if(h+v+(y!==g?1:0)>s)return void Gs.log("Warning, gif stream longer than expected.");r[h++]=E;var T=h+=v;for(y!==g&&(r[h++]=E),x=y;v--;)x=p[x],r[--T]=255&x,x>>=8;m!==null&&l<4096&&(p[l++]=m<<8|E,l>=d+1&&c<12&&(++c,d=d<<1|1)),m=g}else l=o+1,d=(1<<(c=n+1))-1,m=null}return h!==s&&Gs.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function jC(t){var e,r,s,n,i,o=Math.floor,l=new Array(64),c=new Array(64),d=new Array(64),u=new Array(64),A=new Array(65535),h=new Array(65535),f=new Array(64),p=new Array(64),m=[],g=0,y=7,v=new Array(64),x=new Array(64),E=new Array(64),T=new Array(256),j=new Array(2048),C=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],w=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],S=[0,1,2,3,4,5,6,7,8,9,10,11],F=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],B=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],k=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],D=[0,1,2,3,4,5,6,7,8,9,10,11],q=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],te=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function W(I,U){for(var V=0,L=0,K=new Array,fe=1;fe<=16;fe++){for(var ee=1;ee<=I[fe];ee++)K[U[L]]=[],K[U[L]][0]=V,K[U[L]][1]=fe,L++,V++;V*=2}return K}function Q(I){for(var U=I[0],V=I[1]-1;V>=0;)U&1<<V&&(g|=1<<y),V--,--y<0&&(g==255?(re(255),re(0)):re(g),y=7,g=0)}function re(I){m.push(I)}function G(I){re(I>>8&255),re(255&I)}function Ae(I,U,V,L,K){for(var fe,ee=K[0],de=K[240],ue=function(le,ae){var ve,we,De,Ve,me,Fe,Re,Be,X,_e,ke=0;for(X=0;X<8;++X){ve=le[ke],we=le[ke+1],De=le[ke+2],Ve=le[ke+3],me=le[ke+4],Fe=le[ke+5],Re=le[ke+6];var lt=ve+(Be=le[ke+7]),mt=ve-Be,pt=we+Re,ze=we-Re,Me=De+Fe,rt=De-Fe,ht=Ve+me,Qe=Ve-me,Ge=lt+ht,gt=lt-ht,St=pt+Me,Vt=pt-Me;le[ke]=Ge+St,le[ke+4]=Ge-St;var Kt=.707106781*(Vt+gt);le[ke+2]=gt+Kt,le[ke+6]=gt-Kt;var qe=.382683433*((Ge=Qe+rt)-(Vt=ze+mt)),Xe=.5411961*Ge+qe,Ke=1.306562965*Vt+qe,We=.707106781*(St=rt+ze),Ft=mt+We,Ct=mt-We;le[ke+5]=Ct+Xe,le[ke+3]=Ct-Xe,le[ke+1]=Ft+Ke,le[ke+7]=Ft-Ke,ke+=8}for(ke=0,X=0;X<8;++X){ve=le[ke],we=le[ke+8],De=le[ke+16],Ve=le[ke+24],me=le[ke+32],Fe=le[ke+40],Re=le[ke+48];var xr=ve+(Be=le[ke+56]),vr=ve-Be,Pr=we+Re,Mr=we-Re,Jr=De+Fe,ye=De-Fe,Le=Ve+me,se=Ve-me,z=xr+Le,ce=xr-Le,xe=Pr+Jr,Pe=Pr-Jr;le[ke]=z+xe,le[ke+32]=z-xe;var Ze=.707106781*(Pe+ce);le[ke+16]=ce+Ze,le[ke+48]=ce-Ze;var Ye=.382683433*((z=se+ye)-(Pe=Mr+vr)),Je=.5411961*z+Ye,et=1.306562965*Pe+Ye,ft=.707106781*(xe=ye+Mr),At=vr+ft,Nt=vr-ft;le[ke+40]=Nt+Je,le[ke+24]=Nt-Je,le[ke+8]=At+et,le[ke+56]=At-et,ke++}for(X=0;X<64;++X)_e=le[X]*ae[X],f[X]=_e>0?_e+.5|0:_e-.5|0;return f}(I,U),Ie=0;Ie<64;++Ie)p[C[Ie]]=ue[Ie];var Y=p[0]-V;V=p[0],Y==0?Q(L[0]):(Q(L[h[fe=32767+Y]]),Q(A[fe]));for(var H=63;H>0&&p[H]==0;)H--;if(H==0)return Q(ee),V;for(var je,Ce=1;Ce<=H;){for(var oe=Ce;p[Ce]==0&&Ce<=H;)++Ce;var He=Ce-oe;if(He>=16){je=He>>4;for(var ie=1;ie<=je;++ie)Q(de);He&=15}fe=32767+p[Ce],Q(K[(He<<4)+h[fe]]),Q(A[fe]),Ce++}return H!=63&&Q(ee),V}function he(I){I=Math.min(Math.max(I,1),100),i!=I&&(function(U){for(var V=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],L=0;L<64;L++){var K=o((V[L]*U+50)/100);K=Math.min(Math.max(K,1),255),l[C[L]]=K}for(var fe=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],ee=0;ee<64;ee++){var de=o((fe[ee]*U+50)/100);de=Math.min(Math.max(de,1),255),c[C[ee]]=de}for(var ue=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Ie=0,Y=0;Y<8;Y++)for(var H=0;H<8;H++)d[Ie]=1/(l[C[Ie]]*ue[Y]*ue[H]*8),u[Ie]=1/(c[C[Ie]]*ue[Y]*ue[H]*8),Ie++}(I<50?Math.floor(5e3/I):Math.floor(200-2*I)),i=I)}this.encode=function(I,U){U&&he(U),m=new Array,g=0,y=7,G(65496),G(65504),G(16),re(74),re(70),re(73),re(70),re(0),re(1),re(1),re(0),G(1),G(1),re(0),re(0),function(){G(65499),G(132),re(0);for(var we=0;we<64;we++)re(l[we]);re(1);for(var De=0;De<64;De++)re(c[De])}(),function(we,De){G(65472),G(17),re(8),G(De),G(we),re(3),re(1),re(17),re(0),re(2),re(17),re(1),re(3),re(17),re(1)}(I.width,I.height),function(){G(65476),G(418),re(0);for(var we=0;we<16;we++)re(w[we+1]);for(var De=0;De<=11;De++)re(S[De]);re(16);for(var Ve=0;Ve<16;Ve++)re(F[Ve+1]);for(var me=0;me<=161;me++)re(B[me]);re(1);for(var Fe=0;Fe<16;Fe++)re(k[Fe+1]);for(var Re=0;Re<=11;Re++)re(D[Re]);re(17);for(var Be=0;Be<16;Be++)re(q[Be+1]);for(var X=0;X<=161;X++)re(te[X])}(),G(65498),G(12),re(3),re(1),re(0),re(2),re(17),re(3),re(17),re(0),re(63),re(0);var V=0,L=0,K=0;g=0,y=7,this.encode.displayName="_encode_";for(var fe,ee,de,ue,Ie,Y,H,je,Ce,oe=I.data,He=I.width,ie=I.height,le=4*He,ae=0;ae<ie;){for(fe=0;fe<le;){for(Ie=le*ae+fe,H=-1,je=0,Ce=0;Ce<64;Ce++)Y=Ie+(je=Ce>>3)*le+(H=4*(7&Ce)),ae+je>=ie&&(Y-=le*(ae+1+je-ie)),fe+H>=le&&(Y-=fe+H-le+4),ee=oe[Y++],de=oe[Y++],ue=oe[Y++],v[Ce]=(j[ee]+j[de+256>>0]+j[ue+512>>0]>>16)-128,x[Ce]=(j[ee+768>>0]+j[de+1024>>0]+j[ue+1280>>0]>>16)-128,E[Ce]=(j[ee+1280>>0]+j[de+1536>>0]+j[ue+1792>>0]>>16)-128;V=Ae(v,d,V,e,s),L=Ae(x,u,L,r,n),K=Ae(E,u,K,r,n),fe+=32}ae+=8}if(y>=0){var ve=[];ve[1]=y+1,ve[0]=(1<<y+1)-1,Q(ve)}return G(65497),new Uint8Array(m)},t=t||50,function(){for(var I=String.fromCharCode,U=0;U<256;U++)T[U]=I(U)}(),e=W(w,S),r=W(k,D),s=W(F,B),n=W(q,te),function(){for(var I=1,U=2,V=1;V<=15;V++){for(var L=I;L<U;L++)h[32767+L]=V,A[32767+L]=[],A[32767+L][1]=V,A[32767+L][0]=L;for(var K=-(U-1);K<=-I;K++)h[32767+K]=V,A[32767+K]=[],A[32767+K][1]=V,A[32767+K][0]=U-1+K;I<<=1,U<<=1}}(),function(){for(var I=0;I<256;I++)j[I]=19595*I,j[I+256>>0]=38470*I,j[I+512>>0]=7471*I+32768,j[I+768>>0]=-11059*I,j[I+1024>>0]=-21709*I,j[I+1280>>0]=32768*I+8421375,j[I+1536>>0]=-27439*I,j[I+1792>>0]=-5329*I}(),he(t)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function Xl(t,e){if(this.pos=0,this.buffer=t,this.datav=new DataView(t.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function tP(t){function e(w){if(!w)throw Error("assert :P")}function r(w,S,F){for(var B=0;4>B;B++)if(w[S+B]!=F.charCodeAt(B))return!0;return!1}function s(w,S,F,B,k){for(var D=0;D<k;D++)w[S+D]=F[B+D]}function n(w,S,F,B){for(var k=0;k<B;k++)w[S+k]=F}function i(w){return new Int32Array(w)}function o(w,S){for(var F=[],B=0;B<w;B++)F.push(new S);return F}function l(w,S){var F=[];return function B(k,D,q){for(var te=q[D],W=0;W<te&&(k.push(q.length>D+1?[]:new S),!(q.length<D+1));W++)B(k[W],D+1,q)}(F,0,w),F}var c=function(){var w=this;function S(b,_){for(var O=1<<_-1>>>0;b&O;)O>>>=1;return O?(b&O-1)+O:b}function F(b,_,O,J,ge){e(!(J%O));do b[_+(J-=O)]=ge;while(0<J)}function B(b,_,O,J,ge){if(e(2328>=ge),512>=ge)var be=i(512);else if((be=i(ge))==null)return 0;return function(Ne,Ee,Te,Oe,nt,xt){var yt,ut,Ut=Ee,Et=1<<Te,at=i(16),it=i(16);for(e(nt!=0),e(Oe!=null),e(Ne!=null),e(0<Te),ut=0;ut<nt;++ut){if(15<Oe[ut])return 0;++at[Oe[ut]]}if(at[0]==nt)return 0;for(it[1]=0,yt=1;15>yt;++yt){if(at[yt]>1<<yt)return 0;it[yt+1]=it[yt]+at[yt]}for(ut=0;ut<nt;++ut)yt=Oe[ut],0<Oe[ut]&&(xt[it[yt]++]=ut);if(it[15]==1)return(Oe=new k).g=0,Oe.value=xt[0],F(Ne,Ut,1,Et,Oe),Et;var Dt,Qt=-1,Ot=Et-1,cr=0,rr=1,Tr=1,ar=1<<Te;for(ut=0,yt=1,nt=2;yt<=Te;++yt,nt<<=1){if(rr+=Tr<<=1,0>(Tr-=at[yt]))return 0;for(;0<at[yt];--at[yt])(Oe=new k).g=yt,Oe.value=xt[ut++],F(Ne,Ut+cr,nt,ar,Oe),cr=S(cr,yt)}for(yt=Te+1,nt=2;15>=yt;++yt,nt<<=1){if(rr+=Tr<<=1,0>(Tr-=at[yt]))return 0;for(;0<at[yt];--at[yt]){if(Oe=new k,(cr&Ot)!=Qt){for(Ut+=ar,Dt=1<<(Qt=yt)-Te;15>Qt&&!(0>=(Dt-=at[Qt]));)++Qt,Dt<<=1;Et+=ar=1<<(Dt=Qt-Te),Ne[Ee+(Qt=cr&Ot)].g=Dt+Te,Ne[Ee+Qt].value=Ut-Ee-Qt}Oe.g=yt-Te,Oe.value=xt[ut++],F(Ne,Ut+(cr>>Te),nt,ar,Oe),cr=S(cr,yt)}}return rr!=2*it[15]-1?0:Et}(b,_,O,J,ge,be)}function k(){this.value=this.g=0}function D(){this.value=this.g=0}function q(){this.G=o(5,k),this.H=i(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=o(Wa,D)}function te(b,_,O,J){e(b!=null),e(_!=null),e(2147483648>J),b.Ca=254,b.I=0,b.b=-8,b.Ka=0,b.oa=_,b.pa=O,b.Jd=_,b.Yc=O+J,b.Zc=4<=J?O+J-4+1:O,fe(b)}function W(b,_){for(var O=0;0<_--;)O|=de(b,128)<<_;return O}function Q(b,_){var O=W(b,_);return ee(b)?-O:O}function re(b,_,O,J){var ge,be=0;for(e(b!=null),e(_!=null),e(4294967288>J),b.Sb=J,b.Ra=0,b.u=0,b.h=0,4<J&&(J=4),ge=0;ge<J;++ge)be+=_[O+ge]<<8*ge;b.Ra=be,b.bb=J,b.oa=_,b.pa=O}function G(b){for(;8<=b.u&&b.bb<b.Sb;)b.Ra>>>=8,b.Ra+=b.oa[b.pa+b.bb]<<pm-8>>>0,++b.bb,b.u-=8;V(b)&&(b.h=1,b.u=0)}function Ae(b,_){if(e(0<=_),!b.h&&_<=mm){var O=U(b)&fm[_];return b.u+=_,G(b),O}return b.h=1,b.u=0}function he(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function I(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function U(b){return b.Ra>>>(b.u&pm-1)>>>0}function V(b){return e(b.bb<=b.Sb),b.h||b.bb==b.Sb&&b.u>pm}function L(b,_){b.u=_,b.h=V(b)}function K(b){b.u>=qp&&(e(b.u>=qp),G(b))}function fe(b){e(b!=null&&b.oa!=null),b.pa<b.Zc?(b.I=(b.oa[b.pa++]|b.I<<8)>>>0,b.b+=8):(e(b!=null&&b.oa!=null),b.pa<b.Yc?(b.b+=8,b.I=b.oa[b.pa++]|b.I<<8):b.Ka?b.b=0:(b.I<<=8,b.b+=8,b.Ka=1))}function ee(b){return W(b,1)}function de(b,_){var O=b.Ca;0>b.b&&fe(b);var J=b.b,ge=O*_>>>8,be=(b.I>>>J>ge)+0;for(be?(O-=ge,b.I-=ge+1<<J>>>0):O=ge+1,J=O,ge=0;256<=J;)ge+=8,J>>=8;return J=7^ge+no[J],b.b-=J,b.Ca=(O<<J)-1,be}function ue(b,_,O){b[_+0]=O>>24&255,b[_+1]=O>>16&255,b[_+2]=O>>8&255,b[_+3]=O>>0&255}function Ie(b,_){return b[_+0]<<0|b[_+1]<<8}function Y(b,_){return Ie(b,_)|b[_+2]<<16}function H(b,_){return Ie(b,_)|Ie(b,_+2)<<16}function je(b,_){var O=1<<_;return e(b!=null),e(0<_),b.X=i(O),b.X==null?0:(b.Mb=32-_,b.Xa=_,1)}function Ce(b,_){e(b!=null),e(_!=null),e(b.Xa==_.Xa),s(_.X,0,b.X,0,1<<_.Xa)}function oe(){this.X=[],this.Xa=this.Mb=0}function He(b,_,O,J){e(O!=null),e(J!=null);var ge=O[0],be=J[0];return ge==0&&(ge=(b*be+_/2)/_),be==0&&(be=(_*ge+b/2)/b),0>=ge||0>=be?0:(O[0]=ge,J[0]=be,1)}function ie(b,_){return b+(1<<_)-1>>>_}function le(b,_){return((4278255360&b)+(4278255360&_)>>>0&4278255360)+((16711935&b)+(16711935&_)>>>0&16711935)>>>0}function ae(b,_){w[_]=function(O,J,ge,be,Ne,Ee,Te){var Oe;for(Oe=0;Oe<Ne;++Oe){var nt=w[b](Ee[Te+Oe-1],ge,be+Oe);Ee[Te+Oe]=le(O[J+Oe],nt)}}}function ve(){this.ud=this.hd=this.jd=0}function we(b,_){return((4278124286&(b^_))>>>1)+(b&_)>>>0}function De(b){return 0<=b&&256>b?b:0>b?0:255<b?255:void 0}function Ve(b,_){return De(b+(b-_+.5>>1))}function me(b,_,O){return Math.abs(_-O)-Math.abs(b-O)}function Fe(b,_,O,J,ge,be,Ne){for(J=be[Ne-1],O=0;O<ge;++O)be[Ne+O]=J=le(b[_+O],J)}function Re(b,_,O,J,ge){var be;for(be=0;be<O;++be){var Ne=b[_+be],Ee=Ne>>8&255,Te=16711935&(Te=(Te=16711935&Ne)+((Ee<<16)+Ee));J[ge+be]=(4278255360&Ne)+Te>>>0}}function Be(b,_){_.jd=b>>0&255,_.hd=b>>8&255,_.ud=b>>16&255}function X(b,_,O,J,ge,be){var Ne;for(Ne=0;Ne<J;++Ne){var Ee=_[O+Ne],Te=Ee>>>8,Oe=Ee,nt=255&(nt=(nt=Ee>>>16)+((b.jd<<24>>24)*(Te<<24>>24)>>>5));Oe=255&(Oe=(Oe=Oe+((b.hd<<24>>24)*(Te<<24>>24)>>>5))+((b.ud<<24>>24)*(nt<<24>>24)>>>5)),ge[be+Ne]=(4278255360&Ee)+(nt<<16)+Oe}}function _e(b,_,O,J,ge){w[_]=function(be,Ne,Ee,Te,Oe,nt,xt,yt,ut){for(Te=xt;Te<yt;++Te)for(xt=0;xt<ut;++xt)Oe[nt++]=ge(Ee[J(be[Ne++])])},w[b]=function(be,Ne,Ee,Te,Oe,nt,xt){var yt=8>>be.b,ut=be.Ea,Ut=be.K[0],Et=be.w;if(8>yt)for(be=(1<<be.b)-1,Et=(1<<yt)-1;Ne<Ee;++Ne){var at,it=0;for(at=0;at<ut;++at)at&be||(it=J(Te[Oe++])),nt[xt++]=ge(Ut[it&Et]),it>>=yt}else w["VP8LMapColor"+O](Te,Oe,Ut,Et,nt,xt,Ne,Ee,ut)}}function ke(b,_,O,J,ge){for(O=_+O;_<O;){var be=b[_++];J[ge++]=be>>16&255,J[ge++]=be>>8&255,J[ge++]=be>>0&255}}function lt(b,_,O,J,ge){for(O=_+O;_<O;){var be=b[_++];J[ge++]=be>>16&255,J[ge++]=be>>8&255,J[ge++]=be>>0&255,J[ge++]=be>>24&255}}function mt(b,_,O,J,ge){for(O=_+O;_<O;){var be=(Ne=b[_++])>>16&240|Ne>>12&15,Ne=Ne>>0&240|Ne>>28&15;J[ge++]=be,J[ge++]=Ne}}function pt(b,_,O,J,ge){for(O=_+O;_<O;){var be=(Ne=b[_++])>>16&248|Ne>>13&7,Ne=Ne>>5&224|Ne>>3&31;J[ge++]=be,J[ge++]=Ne}}function ze(b,_,O,J,ge){for(O=_+O;_<O;){var be=b[_++];J[ge++]=be>>0&255,J[ge++]=be>>8&255,J[ge++]=be>>16&255}}function Me(b,_,O,J,ge,be){if(be==0)for(O=_+O;_<O;)ue(J,((be=b[_++])[0]>>24|be[1]>>8&65280|be[2]<<8&16711680|be[3]<<24)>>>0),ge+=32;else s(J,ge,b,_,O)}function rt(b,_){w[_][0]=w[b+"0"],w[_][1]=w[b+"1"],w[_][2]=w[b+"2"],w[_][3]=w[b+"3"],w[_][4]=w[b+"4"],w[_][5]=w[b+"5"],w[_][6]=w[b+"6"],w[_][7]=w[b+"7"],w[_][8]=w[b+"8"],w[_][9]=w[b+"9"],w[_][10]=w[b+"10"],w[_][11]=w[b+"11"],w[_][12]=w[b+"12"],w[_][13]=w[b+"13"],w[_][14]=w[b+"0"],w[_][15]=w[b+"0"]}function ht(b){return b==zN||b==qN||b==Cv||b==WN}function Qe(){this.eb=[],this.size=this.A=this.fb=0}function Ge(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function gt(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new Qe,this.f.kb=new Ge,this.sd=null}function St(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Vt(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Kt(b){return alert("todo:WebPSamplerProcessPlane"),b.T}function qe(b,_){var O=b.T,J=_.ba.f.RGBA,ge=J.eb,be=J.fb+b.ka*J.A,Ne=dl[_.ba.S],Ee=b.y,Te=b.O,Oe=b.f,nt=b.N,xt=b.ea,yt=b.W,ut=_.cc,Ut=_.dc,Et=_.Mc,at=_.Nc,it=b.ka,Dt=b.ka+b.T,Qt=b.U,Ot=Qt+1>>1;for(it==0?Ne(Ee,Te,null,null,Oe,nt,xt,yt,Oe,nt,xt,yt,ge,be,null,null,Qt):(Ne(_.ec,_.fc,Ee,Te,ut,Ut,Et,at,Oe,nt,xt,yt,ge,be-J.A,ge,be,Qt),++O);it+2<Dt;it+=2)ut=Oe,Ut=nt,Et=xt,at=yt,nt+=b.Rc,yt+=b.Rc,be+=2*J.A,Ne(Ee,(Te+=2*b.fa)-b.fa,Ee,Te,ut,Ut,Et,at,Oe,nt,xt,yt,ge,be-J.A,ge,be,Qt);return Te+=b.fa,b.j+Dt<b.o?(s(_.ec,_.fc,Ee,Te,Qt),s(_.cc,_.dc,Oe,nt,Ot),s(_.Mc,_.Nc,xt,yt,Ot),O--):1&Dt||Ne(Ee,Te,null,null,Oe,nt,xt,yt,Oe,nt,xt,yt,ge,be+J.A,null,null,Qt),O}function Xe(b,_,O){var J=b.F,ge=[b.J];if(J!=null){var be=b.U,Ne=_.ba.S,Ee=Ne==Nv||Ne==Cv;_=_.ba.f.RGBA;var Te=[0],Oe=b.ka;Te[0]=b.T,b.Kb&&(Oe==0?--Te[0]:(--Oe,ge[0]-=b.width),b.j+b.ka+b.T==b.o&&(Te[0]=b.o-b.j-Oe));var nt=_.eb;Oe=_.fb+Oe*_.A,b=Zs(J,ge[0],b.width,be,Te,nt,Oe+(Ee?0:3),_.A),e(O==Te),b&&ht(Ne)&&ll(nt,Oe,Ee,be,Te,_.A)}return 0}function Ke(b){var _=b.ma,O=_.ba.S,J=11>O,ge=O==bv||O==wv||O==Nv||O==KN||O==12||ht(O);if(_.memory=null,_.Ib=null,_.Jb=null,_.Nd=null,!Kp(_.Oa,b,ge?11:12))return 0;if(ge&&ht(O)&&$t(),b.da)alert("todo:use_scaling");else{if(J){if(_.Ib=Kt,b.Kb){if(O=b.U+1>>1,_.memory=i(b.U+2*O),_.memory==null)return 0;_.ec=_.memory,_.fc=0,_.cc=_.ec,_.dc=_.fc+b.U,_.Mc=_.cc,_.Nc=_.dc+O,_.Ib=qe,$t()}}else alert("todo:EmitYUV");ge&&(_.Jb=Xe,J&&dt())}if(J&&!CT){for(b=0;256>b;++b)yH[b]=89858*(b-128)+Sv>>jv,wH[b]=-22014*(b-128)+Sv,bH[b]=-45773*(b-128),vH[b]=113618*(b-128)+Sv>>jv;for(b=eg;b<XN;++b)_=76283*(b-16)+Sv>>jv,NH[b-eg]=Es(_,255),CH[b-eg]=Es(_+8>>4,15);CT=1}return 1}function We(b){var _=b.ma,O=b.U,J=b.T;return e(!(1&b.ka)),0>=O||0>=J?0:(O=_.Ib(b,_),_.Jb!=null&&_.Jb(b,_,O),_.Dc+=O,1)}function Ft(b){b.ma.memory=null}function Ct(b,_,O,J){return Ae(b,8)!=47?0:(_[0]=Ae(b,14)+1,O[0]=Ae(b,14)+1,J[0]=Ae(b,1),Ae(b,3)!=0?0:!b.h)}function xr(b,_){if(4>b)return b+1;var O=b-2>>1;return(2+(1&b)<<O)+Ae(_,O)+1}function vr(b,_){return 120<_?_-120:1<=(O=((O=aH[_-1])>>4)*b+(8-(15&O)))?O:1;var O}function Pr(b,_,O){var J=U(O),ge=b[_+=255&J].g-8;return 0<ge&&(L(O,O.u+8),J=U(O),_+=b[_].value,_+=J&(1<<ge)-1),L(O,O.u+b[_].g),b[_].value}function Mr(b,_,O){return O.g+=b.g,O.value+=b.value<<_>>>0,e(8>=O.g),b.g}function Jr(b,_,O){var J=b.xc;return e((_=J==0?0:b.vc[b.md*(O>>J)+(_>>J)])<b.Wb),b.Ya[_]}function ye(b,_,O,J){var ge=b.ab,be=b.c*_,Ne=b.C;_=Ne+_;var Ee=O,Te=J;for(J=b.Ta,O=b.Ua;0<ge--;){var Oe=b.gc[ge],nt=Ne,xt=_,yt=Ee,ut=Te,Ut=(Te=J,Ee=O,Oe.Ea);switch(e(nt<xt),e(xt<=Oe.nc),Oe.hc){case 2:fv(yt,ut,(xt-nt)*Ut,Te,Ee);break;case 0:var Et=nt,at=xt,it=Te,Dt=Ee,Qt=(ar=Oe).Ea;Et==0&&(HN(yt,ut,null,null,1,it,Dt),Fe(yt,ut+1,0,0,Qt-1,it,Dt+1),ut+=Qt,Dt+=Qt,++Et);for(var Ot=1<<ar.b,cr=Ot-1,rr=ie(Qt,ar.b),Tr=ar.K,ar=ar.w+(Et>>ar.b)*rr;Et<at;){var Ns=Tr,Bs=ar,xs=1;for(Wp(yt,ut,it,Dt-Qt,1,it,Dt);xs<Qt;){var is=(xs&~cr)+Ot;is>Qt&&(is=Qt),(0,ku[Ns[Bs++]>>8&15])(yt,ut+ +xs,it,Dt+xs-Qt,is-xs,it,Dt+xs),xs=is}ut+=Qt,Dt+=Qt,++Et&cr||(ar+=rr)}xt!=Oe.nc&&s(Te,Ee-Ut,Te,Ee+(xt-nt-1)*Ut,Ut);break;case 1:for(Ut=yt,at=ut,Qt=(yt=Oe.Ea)-(Dt=yt&~(it=(ut=1<<Oe.b)-1)),Et=ie(yt,Oe.b),Ot=Oe.K,Oe=Oe.w+(nt>>Oe.b)*Et;nt<xt;){for(cr=Ot,rr=Oe,Tr=new ve,ar=at+Dt,Ns=at+yt;at<ar;)Be(cr[rr++],Tr),Th(Tr,Ut,at,ut,Te,Ee),at+=ut,Ee+=ut;at<Ns&&(Be(cr[rr++],Tr),Th(Tr,Ut,at,Qt,Te,Ee),at+=Qt,Ee+=Qt),++nt&it||(Oe+=Et)}break;case 3:if(yt==Te&&ut==Ee&&0<Oe.b){for(at=Te,yt=Ut=Ee+(xt-nt)*Ut-(Dt=(xt-nt)*ie(Oe.Ea,Oe.b)),ut=Te,it=Ee,Et=[],Dt=(Qt=Dt)-1;0<=Dt;--Dt)Et[Dt]=ut[it+Dt];for(Dt=Qt-1;0<=Dt;--Dt)at[yt+Dt]=Et[Dt];al(Oe,nt,xt,Te,Ut,Te,Ee)}else al(Oe,nt,xt,yt,ut,Te,Ee)}Ee=J,Te=O}Te!=O&&s(J,O,Ee,Te,be)}function Le(b,_){var O=b.V,J=b.Ba+b.c*b.C,ge=_-b.C;if(e(_<=b.l.o),e(16>=ge),0<ge){var be=b.l,Ne=b.Ta,Ee=b.Ua,Te=be.width;if(ye(b,ge,O,J),ge=Ee=[Ee],e((O=b.C)<(J=_)),e(be.v<be.va),J>be.o&&(J=be.o),O<be.j){var Oe=be.j-O;O=be.j,ge[0]+=Oe*Te}if(O>=J?O=0:(ge[0]+=4*be.v,be.ka=O-be.j,be.U=be.va-be.v,be.T=J-O,O=1),O){if(Ee=Ee[0],11>(O=b.ca).S){var nt=O.f.RGBA,xt=(J=O.S,ge=be.U,be=be.T,Oe=nt.eb,nt.A),yt=be;for(nt=nt.fb+b.Ma*nt.A;0<yt--;){var ut=Ne,Ut=Ee,Et=ge,at=Oe,it=nt;switch(J){case vv:ao(ut,Ut,Et,at,it);break;case bv:Ui(ut,Ut,Et,at,it);break;case zN:Ui(ut,Ut,Et,at,it),ll(at,it,0,Et,1,0);break;case mT:xd(ut,Ut,Et,at,it);break;case wv:Me(ut,Ut,Et,at,it,1);break;case qN:Me(ut,Ut,Et,at,it,1),ll(at,it,0,Et,1,0);break;case Nv:Me(ut,Ut,Et,at,it,0);break;case Cv:Me(ut,Ut,Et,at,it,0),ll(at,it,1,Et,1,0);break;case KN:Bu(ut,Ut,Et,at,it);break;case WN:Bu(ut,Ut,Et,at,it),Js(at,it,Et,1,0);break;case pT:gd(ut,Ut,Et,at,it);break;default:e(0)}Ee+=Te,nt+=xt}b.Ma+=be}else alert("todo:EmitRescaledRowsYUVA");e(b.Ma<=O.height)}}b.C=_,e(b.C<=b.i)}function se(b){var _;if(0<b.ua)return 0;for(_=0;_<b.Wb;++_){var O=b.Ya[_].G,J=b.Ya[_].H;if(0<O[1][J[1]+0].g||0<O[2][J[2]+0].g||0<O[3][J[3]+0].g)return 0}return 1}function z(b,_,O,J,ge,be){if(b.Z!=0){var Ne=b.qd,Ee=b.rd;for(e(Ru[b.Z]!=null);_<O;++_)Ru[b.Z](Ne,Ee,J,ge,J,ge,be),Ne=J,Ee=ge,ge+=be;b.qd=Ne,b.rd=Ee}}function ce(b,_){var O=b.l.ma,J=O.Z==0||O.Z==1?b.l.j:b.C;if(J=b.C<J?J:b.C,e(_<=b.l.o),_>J){var ge=b.l.width,be=O.ca,Ne=O.tb+ge*J,Ee=b.V,Te=b.Ba+b.c*J,Oe=b.gc;e(b.ab==1),e(Oe[0].hc==3),mv(Oe[0],J,_,Ee,Te,be,Ne),z(O,J,_,be,Ne,ge)}b.C=b.Ma=_}function xe(b,_,O,J,ge,be,Ne){var Ee=b.$/J,Te=b.$%J,Oe=b.m,nt=b.s,xt=O+b.$,yt=xt;ge=O+J*ge;var ut=O+J*be,Ut=280+nt.ua,Et=b.Pb?Ee:16777216,at=0<nt.ua?nt.Wa:null,it=nt.wc,Dt=xt<ut?Jr(nt,Te,Ee):null;e(b.C<be),e(ut<=ge);var Qt=!1;e:for(;;){for(;Qt||xt<ut;){var Ot=0;if(Ee>=Et){var cr=xt-O;e((Et=b).Pb),Et.wd=Et.m,Et.xd=cr,0<Et.s.ua&&Ce(Et.s.Wa,Et.s.vb),Et=Ee+oH}if(Te&it||(Dt=Jr(nt,Te,Ee)),e(Dt!=null),Dt.Qb&&(_[xt]=Dt.qb,Qt=!0),!Qt)if(K(Oe),Dt.jc){Ot=Oe,cr=_;var rr=xt,Tr=Dt.pd[U(Ot)&Wa-1];e(Dt.jc),256>Tr.g?(L(Ot,Ot.u+Tr.g),cr[rr]=Tr.value,Ot=0):(L(Ot,Ot.u+Tr.g-256),e(256<=Tr.value),Ot=Tr.value),Ot==0&&(Qt=!0)}else Ot=Pr(Dt.G[0],Dt.H[0],Oe);if(Oe.h)break;if(Qt||256>Ot){if(!Qt)if(Dt.nd)_[xt]=(Dt.qb|Ot<<8)>>>0;else{if(K(Oe),Qt=Pr(Dt.G[1],Dt.H[1],Oe),K(Oe),cr=Pr(Dt.G[2],Dt.H[2],Oe),rr=Pr(Dt.G[3],Dt.H[3],Oe),Oe.h)break;_[xt]=(rr<<24|Qt<<16|Ot<<8|cr)>>>0}if(Qt=!1,++xt,++Te>=J&&(Te=0,++Ee,Ne!=null&&Ee<=be&&!(Ee%16)&&Ne(b,Ee),at!=null))for(;yt<xt;)Ot=_[yt++],at.X[(506832829*Ot&4294967295)>>>at.Mb]=Ot}else if(280>Ot){if(Ot=xr(Ot-256,Oe),cr=Pr(Dt.G[4],Dt.H[4],Oe),K(Oe),cr=vr(J,cr=xr(cr,Oe)),Oe.h)break;if(xt-O<cr||ge-xt<Ot)break e;for(rr=0;rr<Ot;++rr)_[xt+rr]=_[xt+rr-cr];for(xt+=Ot,Te+=Ot;Te>=J;)Te-=J,++Ee,Ne!=null&&Ee<=be&&!(Ee%16)&&Ne(b,Ee);if(e(xt<=ge),Te&it&&(Dt=Jr(nt,Te,Ee)),at!=null)for(;yt<xt;)Ot=_[yt++],at.X[(506832829*Ot&4294967295)>>>at.Mb]=Ot}else{if(!(Ot<Ut))break e;for(Qt=Ot-280,e(at!=null);yt<xt;)Ot=_[yt++],at.X[(506832829*Ot&4294967295)>>>at.Mb]=Ot;Ot=xt,e(!(Qt>>>(cr=at).Xa)),_[Ot]=cr.X[Qt],Qt=!0}Qt||e(Oe.h==V(Oe))}if(b.Pb&&Oe.h&&xt<ge)e(b.m.h),b.a=5,b.m=b.wd,b.$=b.xd,0<b.s.ua&&Ce(b.s.vb,b.s.Wa);else{if(Oe.h)break e;Ne!=null&&Ne(b,Ee>be?be:Ee),b.a=0,b.$=xt-O}return 1}return b.a=3,0}function Pe(b){e(b!=null),b.vc=null,b.yc=null,b.Ya=null;var _=b.Wa;_!=null&&(_.X=null),b.vb=null,e(b!=null)}function Ze(){var b=new Am;return b==null?null:(b.a=0,b.xb=yT,rt("Predictor","VP8LPredictors"),rt("Predictor","VP8LPredictors_C"),rt("PredictorAdd","VP8LPredictorsAdd"),rt("PredictorAdd","VP8LPredictorsAdd_C"),fv=Re,Th=X,ao=ke,Ui=lt,Bu=mt,gd=pt,xd=ze,w.VP8LMapColor32b=gm,w.VP8LMapColor8b=pv,b)}function Ye(b,_,O,J,ge){var be=1,Ne=[b],Ee=[_],Te=J.m,Oe=J.s,nt=null,xt=0;e:for(;;){if(O)for(;be&&Ae(Te,1);){var yt=Ne,ut=Ee,Ut=J,Et=1,at=Ut.m,it=Ut.gc[Ut.ab],Dt=Ae(at,2);if(Ut.Oc&1<<Dt)be=0;else{switch(Ut.Oc|=1<<Dt,it.hc=Dt,it.Ea=yt[0],it.nc=ut[0],it.K=[null],++Ut.ab,e(4>=Ut.ab),Dt){case 0:case 1:it.b=Ae(at,3)+2,Et=Ye(ie(it.Ea,it.b),ie(it.nc,it.b),0,Ut,it.K),it.K=it.K[0];break;case 3:var Qt,Ot=Ae(at,8)+1,cr=16<Ot?0:4<Ot?1:2<Ot?2:3;if(yt[0]=ie(it.Ea,cr),it.b=cr,Qt=Et=Ye(Ot,1,0,Ut,it.K)){var rr,Tr=Ot,ar=it,Ns=1<<(8>>ar.b),Bs=i(Ns);if(Bs==null)Qt=0;else{var xs=ar.K[0],is=ar.w;for(Bs[0]=ar.K[0][0],rr=1;rr<1*Tr;++rr)Bs[rr]=le(xs[is+rr],Bs[rr-1]);for(;rr<4*Ns;++rr)Bs[rr]=0;ar.K[0]=null,ar.K[0]=Bs,Qt=1}}Et=Qt;break;case 2:break;default:e(0)}be=Et}}if(Ne=Ne[0],Ee=Ee[0],be&&Ae(Te,1)&&!(be=1<=(xt=Ae(Te,4))&&11>=xt)){J.a=3;break e}var Ws;if(Ws=be)t:{var Vs,Wr,la,io=J,ca=Ne,oo=Ee,Fs=xt,Bo=O,Fo=io.m,ka=io.s,Ga=[null],Qi=1,ul=0,_c=iH[Fs];r:for(;;){if(Bo&&Ae(Fo,1)){var Ba=Ae(Fo,3)+2,wd=ie(ca,Ba),Ph=ie(oo,Ba),wm=wd*Ph;if(!Ye(wd,Ph,0,io,Ga))break r;for(Ga=Ga[0],ka.xc=Ba,Vs=0;Vs<wm;++Vs){var Lu=Ga[Vs]>>8&65535;Ga[Vs]=Lu,Lu>=Qi&&(Qi=Lu+1)}}if(Fo.h)break r;for(Wr=0;5>Wr;++Wr){var Bn=gT[Wr];!Wr&&0<Fs&&(Bn+=1<<Fs),ul<Bn&&(ul=Bn)}var JN=o(Qi*_c,k),ET=Qi,_T=o(ET,q);if(_T==null)var _v=null;else e(65536>=ET),_v=_T;var tg=i(ul);if(_v==null||tg==null||JN==null){io.a=1;break r}var Tv=JN;for(Vs=la=0;Vs<Qi;++Vs){var ql=_v[Vs],Nm=ql.G,Cm=ql.H,TT=0,Iv=1,IT=0;for(Wr=0;5>Wr;++Wr){Bn=gT[Wr],Nm[Wr]=Tv,Cm[Wr]=la,!Wr&&0<Fs&&(Bn+=1<<Fs);n:{var kv,ZN=Bn,Bv=io,rg=tg,EH=Tv,_H=la,e5=0,Ou=Bv.m,TH=Ae(Ou,1);if(n(rg,0,0,ZN),TH){var IH=Ae(Ou,1)+1,kH=Ae(Ou,1),kT=Ae(Ou,kH==0?1:8);rg[kT]=1,IH==2&&(rg[kT=Ae(Ou,8)]=1);var Fv=1}else{var BT=i(19),FT=Ae(Ou,4)+4;if(19<FT){Bv.a=3;var Pv=0;break n}for(kv=0;kv<FT;++kv)BT[nH[kv]]=Ae(Ou,3);var t5=void 0,sg=void 0,PT=Bv,BH=BT,Dv=ZN,DT=rg,r5=0,Uu=PT.m,RT=8,LT=o(128,k);s:for(;B(LT,0,7,BH,19);){if(Ae(Uu,1)){var FH=2+2*Ae(Uu,3);if((t5=2+Ae(Uu,FH))>Dv)break s}else t5=Dv;for(sg=0;sg<Dv&&t5--;){K(Uu);var OT=LT[0+(127&U(Uu))];L(Uu,Uu.u+OT.g);var jm=OT.value;if(16>jm)DT[sg++]=jm,jm!=0&&(RT=jm);else{var PH=jm==16,UT=jm-16,DH=rH[UT],MT=Ae(Uu,tH[UT])+DH;if(sg+MT>Dv)break s;for(var RH=PH?RT:0;0<MT--;)DT[sg++]=RH}}r5=1;break s}r5||(PT.a=3),Fv=r5}(Fv=Fv&&!Ou.h)&&(e5=B(EH,_H,8,rg,ZN)),Fv&&e5!=0?Pv=e5:(Bv.a=3,Pv=0)}if(Pv==0)break r;if(Iv&&sH[Wr]==1&&(Iv=Tv[la].g==0),TT+=Tv[la].g,la+=Pv,3>=Wr){var ng,s5=tg[0];for(ng=1;ng<Bn;++ng)tg[ng]>s5&&(s5=tg[ng]);IT+=s5}}if(ql.nd=Iv,ql.Qb=0,Iv&&(ql.qb=(Nm[3][Cm[3]+0].value<<24|Nm[1][Cm[1]+0].value<<16|Nm[2][Cm[2]+0].value)>>>0,TT==0&&256>Nm[0][Cm[0]+0].value&&(ql.Qb=1,ql.qb+=Nm[0][Cm[0]+0].value<<8)),ql.jc=!ql.Qb&&6>IT,ql.jc){var Rv,Nd=ql;for(Rv=0;Rv<Wa;++Rv){var Mu=Rv,Qu=Nd.pd[Mu],Lv=Nd.G[0][Nd.H[0]+Mu];256<=Lv.value?(Qu.g=Lv.g+256,Qu.value=Lv.value):(Qu.g=0,Qu.value=0,Mu>>=Mr(Lv,8,Qu),Mu>>=Mr(Nd.G[1][Nd.H[1]+Mu],16,Qu),Mu>>=Mr(Nd.G[2][Nd.H[2]+Mu],0,Qu),Mr(Nd.G[3][Nd.H[3]+Mu],24,Qu))}}}ka.vc=Ga,ka.Wb=Qi,ka.Ya=_v,ka.yc=JN,Ws=1;break t}Ws=0}if(!(be=Ws)){J.a=3;break e}if(0<xt){if(Oe.ua=1<<xt,!je(Oe.Wa,xt)){J.a=1,be=0;break e}}else Oe.ua=0;var n5=J,QT=Ne,LH=Ee,a5=n5.s,i5=a5.xc;if(n5.c=QT,n5.i=LH,a5.md=ie(QT,i5),a5.wc=i5==0?-1:(1<<i5)-1,O){J.xb=fH;break e}if((nt=i(Ne*Ee))==null){J.a=1,be=0;break e}be=(be=xe(J,nt,0,Ne,Ee,Ee,null))&&!Te.h;break e}return be?(ge!=null?ge[0]=nt:(e(nt==null),e(O)),J.$=0,O||Pe(Oe)):Pe(Oe),be}function Je(b,_){var O=b.c*b.i,J=O+_+16*_;return e(b.c<=_),b.V=i(J),b.V==null?(b.Ta=null,b.Ua=0,b.a=1,0):(b.Ta=b.V,b.Ua=b.Ba+O+_,1)}function et(b,_){var O=b.C,J=_-O,ge=b.V,be=b.Ba+b.c*O;for(e(_<=b.l.o);0<J;){var Ne=16<J?16:J,Ee=b.l.ma,Te=b.l.width,Oe=Te*Ne,nt=Ee.ca,xt=Ee.tb+Te*O,yt=b.Ta,ut=b.Ua;ye(b,Ne,ge,be),Hn(yt,ut,nt,xt,Oe),z(Ee,O,O+Ne,nt,xt,Te),J-=Ne,ge+=Ne*b.c,O+=Ne}e(O==_),b.C=b.Ma=_}function ft(){this.ub=this.yd=this.td=this.Rb=0}function At(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Nt(){this.Fb=this.Bb=this.Cb=0,this.Zb=i(4),this.Lb=i(4)}function kt(){this.Yb=function(){var b=[];return function _(O,J,ge){for(var be=ge[J],Ne=0;Ne<be&&(O.push(ge.length>J+1?[]:0),!(ge.length<J+1));Ne++)_(O[Ne],J+1,ge)}(b,0,[3,11]),b}()}function Ht(){this.jb=i(3),this.Wc=l([4,8],kt),this.Xc=l([4,17],kt)}function ir(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new i(4),this.od=new i(4)}function Ar(){this.ld=this.La=this.dd=this.tc=0}function or(){this.Na=this.la=0}function ns(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Ia(){this.ad=i(384),this.Za=0,this.Ob=i(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function so(){this.uc=this.M=this.Nb=0,this.wa=Array(new Ar),this.Y=0,this.ya=Array(new Ia),this.aa=0,this.l=new ot}function li(){this.y=i(16),this.f=i(8),this.ea=i(8)}function Ka(){this.cb=this.a=0,this.sc="",this.m=new he,this.Od=new ft,this.Kc=new At,this.ed=new ir,this.Qa=new Nt,this.Ic=this.$c=this.Aa=0,this.D=new so,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=o(8,he),this.ia=0,this.pb=o(4,ns),this.Pa=new Ht,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new li),this.Hd=0,this.rb=Array(new or),this.sb=0,this.wa=Array(new Ar),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Ia),this.L=this.aa=0,this.gd=l([4,2],Ar),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function ot(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Pt(){var b=new Ka;return b!=null&&(b.a=0,b.sc="OK",b.cb=0,b.Xb=0,Zp||(Zp=_r)),b}function jt(b,_,O){return b.a==0&&(b.a=_,b.sc=O,b.cb=0),0}function Lt(b,_,O){return 3<=O&&b[_+0]==157&&b[_+1]==1&&b[_+2]==42}function Er(b,_){if(b==null)return 0;if(b.a=0,b.sc="OK",_==null)return jt(b,2,"null VP8Io passed to VP8GetHeaders()");var O=_.data,J=_.w,ge=_.ha;if(4>ge)return jt(b,7,"Truncated header.");var be=O[J+0]|O[J+1]<<8|O[J+2]<<16,Ne=b.Od;if(Ne.Rb=!(1&be),Ne.td=be>>1&7,Ne.yd=be>>4&1,Ne.ub=be>>5,3<Ne.td)return jt(b,3,"Incorrect keyframe parameters.");if(!Ne.yd)return jt(b,4,"Frame not displayable.");J+=3,ge-=3;var Ee=b.Kc;if(Ne.Rb){if(7>ge)return jt(b,7,"cannot parse picture header");if(!Lt(O,J,ge))return jt(b,3,"Bad code word");Ee.c=16383&(O[J+4]<<8|O[J+3]),Ee.Td=O[J+4]>>6,Ee.i=16383&(O[J+6]<<8|O[J+5]),Ee.Ud=O[J+6]>>6,J+=7,ge-=7,b.za=Ee.c+15>>4,b.Ub=Ee.i+15>>4,_.width=Ee.c,_.height=Ee.i,_.Da=0,_.j=0,_.v=0,_.va=_.width,_.o=_.height,_.da=0,_.ib=_.width,_.hb=_.height,_.U=_.width,_.T=_.height,n((be=b.Pa).jb,0,255,be.jb.length),e((be=b.Qa)!=null),be.Cb=0,be.Bb=0,be.Fb=1,n(be.Zb,0,0,be.Zb.length),n(be.Lb,0,0,be.Lb)}if(Ne.ub>ge)return jt(b,7,"bad partition length");te(be=b.m,O,J,Ne.ub),J+=Ne.ub,ge-=Ne.ub,Ne.Rb&&(Ee.Ld=ee(be),Ee.Kd=ee(be)),Ee=b.Qa;var Te,Oe=b.Pa;if(e(be!=null),e(Ee!=null),Ee.Cb=ee(be),Ee.Cb){if(Ee.Bb=ee(be),ee(be)){for(Ee.Fb=ee(be),Te=0;4>Te;++Te)Ee.Zb[Te]=ee(be)?Q(be,7):0;for(Te=0;4>Te;++Te)Ee.Lb[Te]=ee(be)?Q(be,6):0}if(Ee.Bb)for(Te=0;3>Te;++Te)Oe.jb[Te]=ee(be)?W(be,8):255}else Ee.Bb=0;if(be.Ka)return jt(b,3,"cannot parse segment header");if((Ee=b.ed).zd=ee(be),Ee.Tb=W(be,6),Ee.wb=W(be,3),Ee.Pc=ee(be),Ee.Pc&&ee(be)){for(Oe=0;4>Oe;++Oe)ee(be)&&(Ee.vd[Oe]=Q(be,6));for(Oe=0;4>Oe;++Oe)ee(be)&&(Ee.od[Oe]=Q(be,6))}if(b.L=Ee.Tb==0?0:Ee.zd?1:2,be.Ka)return jt(b,3,"cannot parse filter header");var nt=ge;if(ge=Te=J,J=Te+nt,Ee=nt,b.Xb=(1<<W(b.m,2))-1,nt<3*(Oe=b.Xb))O=7;else{for(Te+=3*Oe,Ee-=3*Oe,nt=0;nt<Oe;++nt){var xt=O[ge+0]|O[ge+1]<<8|O[ge+2]<<16;xt>Ee&&(xt=Ee),te(b.Jc[+nt],O,Te,xt),Te+=xt,Ee-=xt,ge+=3}te(b.Jc[+Oe],O,Te,Ee),O=Te<J?0:5}if(O!=0)return jt(b,O,"cannot parse partitions");for(O=W(Te=b.m,7),ge=ee(Te)?Q(Te,4):0,J=ee(Te)?Q(Te,4):0,Ee=ee(Te)?Q(Te,4):0,Oe=ee(Te)?Q(Te,4):0,Te=ee(Te)?Q(Te,4):0,nt=b.Qa,xt=0;4>xt;++xt){if(nt.Cb){var yt=nt.Zb[xt];nt.Fb||(yt+=O)}else{if(0<xt){b.pb[xt]=b.pb[0];continue}yt=O}var ut=b.pb[xt];ut.Sc[0]=GN[Es(yt+ge,127)],ut.Sc[1]=YN[Es(yt+0,127)],ut.Eb[0]=2*GN[Es(yt+J,127)],ut.Eb[1]=101581*YN[Es(yt+Ee,127)]>>16,8>ut.Eb[1]&&(ut.Eb[1]=8),ut.Qc[0]=GN[Es(yt+Oe,117)],ut.Qc[1]=YN[Es(yt+Te,127)],ut.lc=yt+Te}if(!Ne.Rb)return jt(b,4,"Not a key frame.");for(ee(be),Ne=b.Pa,O=0;4>O;++O){for(ge=0;8>ge;++ge)for(J=0;3>J;++J)for(Ee=0;11>Ee;++Ee)Oe=de(be,AH[O][ge][J][Ee])?W(be,8):dH[O][ge][J][Ee],Ne.Wc[O][ge].Yb[J][Ee]=Oe;for(ge=0;17>ge;++ge)Ne.Xc[O][ge]=Ne.Wc[O][hH[ge]]}return b.kc=ee(be),b.kc&&(b.Bd=W(be,8)),b.cb=1}function _r(b,_,O,J,ge,be,Ne){var Ee=_[ge].Yb[O];for(O=0;16>ge;++ge){if(!de(b,Ee[O+0]))return ge;for(;!de(b,Ee[O+1]);)if(Ee=_[++ge].Yb[0],O=0,ge==16)return 16;var Te=_[ge+1].Yb;if(de(b,Ee[O+2])){var Oe=b,nt=0;if(de(Oe,(yt=Ee)[(xt=O)+3]))if(de(Oe,yt[xt+6])){for(Ee=0,xt=2*(nt=de(Oe,yt[xt+8]))+(yt=de(Oe,yt[xt+9+nt])),nt=0,yt=lH[xt];yt[Ee];++Ee)nt+=nt+de(Oe,yt[Ee]);nt+=3+(8<<xt)}else de(Oe,yt[xt+7])?(nt=7+2*de(Oe,165),nt+=de(Oe,145)):nt=5+de(Oe,159);else nt=de(Oe,yt[xt+4])?3+de(Oe,yt[xt+5]):2;Ee=Te[2]}else nt=1,Ee=Te[1];Te=Ne+cH[ge],0>(Oe=b).b&&fe(Oe);var xt,yt=Oe.b,ut=(xt=Oe.Ca>>1)-(Oe.I>>yt)>>31;--Oe.b,Oe.Ca+=ut,Oe.Ca|=1,Oe.I-=(xt+1&ut)<<yt,be[Te]=((nt^ut)-ut)*J[(0<ge)+0]}return 16}function jr(b){var _=b.rb[b.sb-1];_.la=0,_.Na=0,n(b.zc,0,0,b.zc.length),b.ja=0}function ms(b,_){if(b==null)return 0;if(_==null)return jt(b,2,"NULL VP8Io parameter in VP8Decode().");if(!b.cb&&!Er(b,_))return 0;if(e(b.cb),_.ac==null||_.ac(_)){_.ob&&(b.L=0);var O=Ev[b.L];if(b.L==2?(b.yb=0,b.zb=0):(b.yb=_.v-O>>4,b.zb=_.j-O>>4,0>b.yb&&(b.yb=0),0>b.zb&&(b.zb=0)),b.Va=_.o+15+O>>4,b.Hb=_.va+15+O>>4,b.Hb>b.za&&(b.Hb=b.za),b.Va>b.Ub&&(b.Va=b.Ub),0<b.L){var J=b.ed;for(O=0;4>O;++O){var ge;if(b.Qa.Cb){var be=b.Qa.Lb[O];b.Qa.Fb||(be+=J.Tb)}else be=J.Tb;for(ge=0;1>=ge;++ge){var Ne=b.gd[O][ge],Ee=be;if(J.Pc&&(Ee+=J.vd[0],ge&&(Ee+=J.od[0])),0<(Ee=0>Ee?0:63<Ee?63:Ee)){var Te=Ee;0<J.wb&&(Te=4<J.wb?Te>>2:Te>>1)>9-J.wb&&(Te=9-J.wb),1>Te&&(Te=1),Ne.dd=Te,Ne.tc=2*Ee+Te,Ne.ld=40<=Ee?2:15<=Ee?1:0}else Ne.tc=0;Ne.La=ge}}}O=0}else jt(b,6,"Frame setup failed"),O=b.a;if(O=O==0){if(O){b.$c=0,0<b.Aa||(b.Ic=SH);e:{O=b.Ic,J=4*(Te=b.za);var Oe=32*Te,nt=Te+1,xt=0<b.L?Te*(0<b.Aa?2:1):0,yt=(b.Aa==2?2:1)*Te;if((Ne=J+832+(ge=3*(16*O+Ev[b.L])/2*Oe)+(be=b.Fa!=null&&0<b.Fa.length?b.Kc.c*b.Kc.i:0))!=Ne)O=0;else{if(Ne>b.Vb){if(b.Vb=0,b.Ec=i(Ne),b.Fc=0,b.Ec==null){O=jt(b,1,"no memory during frame initialization.");break e}b.Vb=Ne}Ne=b.Ec,Ee=b.Fc,b.Ac=Ne,b.Bc=Ee,Ee+=J,b.Gd=o(Oe,li),b.Hd=0,b.rb=o(nt+1,or),b.sb=1,b.wa=xt?o(xt,Ar):null,b.Y=0,b.D.Nb=0,b.D.wa=b.wa,b.D.Y=b.Y,0<b.Aa&&(b.D.Y+=Te),e(!0),b.oc=Ne,b.pc=Ee,Ee+=832,b.ya=o(yt,Ia),b.aa=0,b.D.ya=b.ya,b.D.aa=b.aa,b.Aa==2&&(b.D.aa+=Te),b.R=16*Te,b.B=8*Te,Te=(Oe=Ev[b.L])*b.R,Oe=Oe/2*b.B,b.sa=Ne,b.ta=Ee+Te,b.qa=b.sa,b.ra=b.ta+16*O*b.R+Oe,b.Ha=b.qa,b.Ia=b.ra+8*O*b.B+Oe,b.$c=0,Ee+=ge,b.mb=be?Ne:null,b.nb=be?Ee:null,e(Ee+be<=b.Fc+b.Vb),jr(b),n(b.Ac,b.Bc,0,J),O=1}}if(O){if(_.ka=0,_.y=b.sa,_.O=b.ta,_.f=b.qa,_.N=b.ra,_.ea=b.Ha,_.Vd=b.Ia,_.fa=b.R,_.Rc=b.B,_.F=null,_.J=0,!xv){for(O=-255;255>=O;++O)ya[255+O]=0>O?-O:O;for(O=-1020;1020>=O;++O)vd[1020+O]=-128>O?-128:127<O?127:O;for(O=-112;112>=O;++O)Jp[112+O]=-16>O?-16:15<O?15:O;for(O=-255;510>=O;++O)bm[255+O]=0>O?0:255<O?255:O;xv=1}xm=Ad,yd=sl,Gp=vh,Mi=ks,il=ud,Vn=kn,ym=Nu,gv=Hl,Yp=ju,Ih=_h,kh=Cu,Fu=fd,Bh=Su,vm=Cc,Fh=hd,Pu=Io,Xp=xa,ol=um,zl[0]=nl,zl[1]=Vp,zl[2]=wc,zl[3]=$p,zl[4]=cm,zl[5]=yu,zl[6]=_o,zl[7]=wh,zl[8]=bu,zl[9]=vu,Du[0]=bc,Du[1]=Hp,Du[2]=Ml,Du[3]=gu,Du[4]=on,Du[5]=lm,Du[6]=bh,bd[0]=Vl,bd[1]=om,bd[2]=dm,bd[3]=Ql,bd[4]=Ss,bd[5]=Nh,bd[6]=Ch,O=1}else O=0}O&&(O=function(ut,Ut){for(ut.M=0;ut.M<ut.Va;++ut.M){var Et,at=ut.Jc[ut.M&ut.Xb],it=ut.m,Dt=ut;for(Et=0;Et<Dt.za;++Et){var Qt=it,Ot=Dt,cr=Ot.Ac,rr=Ot.Bc+4*Et,Tr=Ot.zc,ar=Ot.ya[Ot.aa+Et];if(Ot.Qa.Bb?ar.$b=de(Qt,Ot.Pa.jb[0])?2+de(Qt,Ot.Pa.jb[2]):de(Qt,Ot.Pa.jb[1]):ar.$b=0,Ot.kc&&(ar.Ad=de(Qt,Ot.Bd)),ar.Za=!de(Qt,145)+0,ar.Za){var Ns=ar.Ob,Bs=0;for(Ot=0;4>Ot;++Ot){var xs,is=Tr[0+Ot];for(xs=0;4>xs;++xs){is=uH[cr[rr+xs]][is];for(var Ws=xT[de(Qt,is[0])];0<Ws;)Ws=xT[2*Ws+de(Qt,is[Ws])];is=-Ws,cr[rr+xs]=is}s(Ns,Bs,cr,rr,4),Bs+=4,Tr[0+Ot]=is}}else is=de(Qt,156)?de(Qt,128)?1:3:de(Qt,163)?2:0,ar.Ob[0]=is,n(cr,rr,is,4),n(Tr,0,is,4);ar.Dd=de(Qt,142)?de(Qt,114)?de(Qt,183)?1:3:2:0}if(Dt.m.Ka)return jt(ut,7,"Premature end-of-partition0 encountered.");for(;ut.ja<ut.za;++ut.ja){if(Dt=at,Qt=(it=ut).rb[it.sb-1],cr=it.rb[it.sb+it.ja],Et=it.ya[it.aa+it.ja],rr=it.kc?Et.Ad:0)Qt.la=cr.la=0,Et.Za||(Qt.Na=cr.Na=0),Et.Hc=0,Et.Gc=0,Et.ia=0;else{var Vs,Wr;if(Qt=cr,cr=Dt,rr=it.Pa.Xc,Tr=it.ya[it.aa+it.ja],ar=it.pb[Tr.$b],Ot=Tr.ad,Ns=0,Bs=it.rb[it.sb-1],is=xs=0,n(Ot,Ns,0,384),Tr.Za)var la=0,io=rr[3];else{Ws=i(16);var ca=Qt.Na+Bs.Na;if(ca=Zp(cr,rr[1],ca,ar.Eb,0,Ws,0),Qt.Na=Bs.Na=(0<ca)+0,1<ca)xm(Ws,0,Ot,Ns);else{var oo=Ws[0]+3>>3;for(Ws=0;256>Ws;Ws+=16)Ot[Ns+Ws]=oo}la=1,io=rr[0]}var Fs=15&Qt.la,Bo=15&Bs.la;for(Ws=0;4>Ws;++Ws){var Fo=1&Bo;for(oo=Wr=0;4>oo;++oo)Fs=Fs>>1|(Fo=(ca=Zp(cr,io,ca=Fo+(1&Fs),ar.Sc,la,Ot,Ns))>la)<<7,Wr=Wr<<2|(3<ca?3:1<ca?2:Ot[Ns+0]!=0),Ns+=16;Fs>>=4,Bo=Bo>>1|Fo<<7,xs=(xs<<8|Wr)>>>0}for(io=Fs,la=Bo>>4,Vs=0;4>Vs;Vs+=2){for(Wr=0,Fs=Qt.la>>4+Vs,Bo=Bs.la>>4+Vs,Ws=0;2>Ws;++Ws){for(Fo=1&Bo,oo=0;2>oo;++oo)ca=Fo+(1&Fs),Fs=Fs>>1|(Fo=0<(ca=Zp(cr,rr[2],ca,ar.Qc,0,Ot,Ns)))<<3,Wr=Wr<<2|(3<ca?3:1<ca?2:Ot[Ns+0]!=0),Ns+=16;Fs>>=2,Bo=Bo>>1|Fo<<5}is|=Wr<<4*Vs,io|=Fs<<4<<Vs,la|=(240&Bo)<<Vs}Qt.la=io,Bs.la=la,Tr.Hc=xs,Tr.Gc=is,Tr.ia=43690&is?0:ar.ia,rr=!(xs|is)}if(0<it.L&&(it.wa[it.Y+it.ja]=it.gd[Et.$b][Et.Za],it.wa[it.Y+it.ja].La|=!rr),Dt.Ka)return jt(ut,7,"Premature end-of-file encountered.")}if(jr(ut),it=Ut,Dt=1,Et=(at=ut).D,Qt=0<at.L&&at.M>=at.zb&&at.M<=at.Va,at.Aa==0)e:{if(Et.M=at.M,Et.uc=Qt,Sc(at,Et),Dt=1,Et=(Wr=at.D).Nb,Qt=(is=Ev[at.L])*at.R,cr=is/2*at.B,Ws=16*Et*at.R,oo=8*Et*at.B,rr=at.sa,Tr=at.ta-Qt+Ws,ar=at.qa,Ot=at.ra-cr+oo,Ns=at.Ha,Bs=at.Ia-cr+oo,Bo=(Fs=Wr.M)==0,xs=Fs>=at.Va-1,at.Aa==2&&Sc(at,Wr),Wr.uc)for(Fo=(ca=at).D.M,e(ca.D.uc),Wr=ca.yb;Wr<ca.Hb;++Wr){la=Wr,io=Fo;var ka=(Ga=(Bn=ca).D).Nb;Vs=Bn.R;var Ga=Ga.wa[Ga.Y+la],Qi=Bn.sa,ul=Bn.ta+16*ka*Vs+16*la,_c=Ga.dd,Ba=Ga.tc;if(Ba!=0)if(e(3<=Ba),Bn.L==1)0<la&&Pu(Qi,ul,Vs,Ba+4),Ga.La&&ol(Qi,ul,Vs,Ba),0<io&&Fh(Qi,ul,Vs,Ba+4),Ga.La&&Xp(Qi,ul,Vs,Ba);else{var wd=Bn.B,Ph=Bn.qa,wm=Bn.ra+8*ka*wd+8*la,Lu=Bn.Ha,Bn=Bn.Ia+8*ka*wd+8*la;ka=Ga.ld,0<la&&(gv(Qi,ul,Vs,Ba+4,_c,ka),Ih(Ph,wm,Lu,Bn,wd,Ba+4,_c,ka)),Ga.La&&(Fu(Qi,ul,Vs,Ba,_c,ka),vm(Ph,wm,Lu,Bn,wd,Ba,_c,ka)),0<io&&(ym(Qi,ul,Vs,Ba+4,_c,ka),Yp(Ph,wm,Lu,Bn,wd,Ba+4,_c,ka)),Ga.La&&(kh(Qi,ul,Vs,Ba,_c,ka),Bh(Ph,wm,Lu,Bn,wd,Ba,_c,ka))}}if(at.ia&&alert("todo:DitherRow"),it.put!=null){if(Wr=16*Fs,Fs=16*(Fs+1),Bo?(it.y=at.sa,it.O=at.ta+Ws,it.f=at.qa,it.N=at.ra+oo,it.ea=at.Ha,it.W=at.Ia+oo):(Wr-=is,it.y=rr,it.O=Tr,it.f=ar,it.N=Ot,it.ea=Ns,it.W=Bs),xs||(Fs-=is),Fs>it.o&&(Fs=it.o),it.F=null,it.J=null,at.Fa!=null&&0<at.Fa.length&&Wr<Fs&&(it.J=Iu(at,it,Wr,Fs-Wr),it.F=at.mb,it.F==null&&it.F.length==0)){Dt=jt(at,3,"Could not decode alpha data.");break e}Wr<it.j&&(is=it.j-Wr,Wr=it.j,e(!(1&is)),it.O+=at.R*is,it.N+=at.B*(is>>1),it.W+=at.B*(is>>1),it.F!=null&&(it.J+=it.width*is)),Wr<Fs&&(it.O+=it.v,it.N+=it.v>>1,it.W+=it.v>>1,it.F!=null&&(it.J+=it.v),it.ka=Wr-it.j,it.U=it.va-it.v,it.T=Fs-Wr,Dt=it.put(it))}Et+1!=at.Ic||xs||(s(at.sa,at.ta-Qt,rr,Tr+16*at.R,Qt),s(at.qa,at.ra-cr,ar,Ot+8*at.B,cr),s(at.Ha,at.Ia-cr,Ns,Bs+8*at.B,cr))}if(!Dt)return jt(ut,6,"Output aborted.")}return 1}(b,_)),_.bc!=null&&_.bc(_),O&=1}return O?(b.cb=0,O):0}function Qs(b,_,O,J,ge){ge=b[_+O+32*J]+(ge>>3),b[_+O+32*J]=-256&ge?0>ge?0:255:ge}function ci(b,_,O,J,ge,be){Qs(b,_,0,O,J+ge),Qs(b,_,1,O,J+be),Qs(b,_,2,O,J-be),Qs(b,_,3,O,J-ge)}function ps(b){return(20091*b>>16)+b}function us(b,_,O,J){var ge,be=0,Ne=i(16);for(ge=0;4>ge;++ge){var Ee=b[_+0]+b[_+8],Te=b[_+0]-b[_+8],Oe=(35468*b[_+4]>>16)-ps(b[_+12]),nt=ps(b[_+4])+(35468*b[_+12]>>16);Ne[be+0]=Ee+nt,Ne[be+1]=Te+Oe,Ne[be+2]=Te-Oe,Ne[be+3]=Ee-nt,be+=4,_++}for(ge=be=0;4>ge;++ge)Ee=(b=Ne[be+0]+4)+Ne[be+8],Te=b-Ne[be+8],Oe=(35468*Ne[be+4]>>16)-ps(Ne[be+12]),Qs(O,J,0,0,Ee+(nt=ps(Ne[be+4])+(35468*Ne[be+12]>>16))),Qs(O,J,1,0,Te+Oe),Qs(O,J,2,0,Te-Oe),Qs(O,J,3,0,Ee-nt),be++,J+=32}function kn(b,_,O,J){var ge=b[_+0]+4,be=35468*b[_+4]>>16,Ne=ps(b[_+4]),Ee=35468*b[_+1]>>16;ci(O,J,0,ge+Ne,b=ps(b[_+1]),Ee),ci(O,J,1,ge+be,b,Ee),ci(O,J,2,ge-be,b,Ee),ci(O,J,3,ge-Ne,b,Ee)}function sl(b,_,O,J,ge){us(b,_,O,J),ge&&us(b,_+16,O,J+4)}function vh(b,_,O,J){yd(b,_+0,O,J,1),yd(b,_+32,O,J+128,1)}function ks(b,_,O,J){var ge;for(b=b[_+0]+4,ge=0;4>ge;++ge)for(_=0;4>_;++_)Qs(O,J,_,ge,b)}function ud(b,_,O,J){b[_+0]&&Mi(b,_+0,O,J),b[_+16]&&Mi(b,_+16,O,J+4),b[_+32]&&Mi(b,_+32,O,J+128),b[_+48]&&Mi(b,_+48,O,J+128+4)}function Ad(b,_,O,J){var ge,be=i(16);for(ge=0;4>ge;++ge){var Ne=b[_+0+ge]+b[_+12+ge],Ee=b[_+4+ge]+b[_+8+ge],Te=b[_+4+ge]-b[_+8+ge],Oe=b[_+0+ge]-b[_+12+ge];be[0+ge]=Ne+Ee,be[8+ge]=Ne-Ee,be[4+ge]=Oe+Te,be[12+ge]=Oe-Te}for(ge=0;4>ge;++ge)Ne=(b=be[0+4*ge]+3)+be[3+4*ge],Ee=be[1+4*ge]+be[2+4*ge],Te=be[1+4*ge]-be[2+4*ge],Oe=b-be[3+4*ge],O[J+0]=Ne+Ee>>3,O[J+16]=Oe+Te>>3,O[J+32]=Ne-Ee>>3,O[J+48]=Oe-Te>>3,J+=64}function Ul(b,_,O){var J,ge=_-32,be=ko,Ne=255-b[ge-1];for(J=0;J<O;++J){var Ee,Te=be,Oe=Ne+b[_-1];for(Ee=0;Ee<O;++Ee)b[_+Ee]=Te[Oe+b[ge+Ee]];_+=32}}function Vp(b,_){Ul(b,_,4)}function om(b,_){Ul(b,_,8)}function Hp(b,_){Ul(b,_,16)}function Ml(b,_){var O;for(O=0;16>O;++O)s(b,_+32*O,b,_-32,16)}function gu(b,_){var O;for(O=16;0<O;--O)n(b,_,b[_-1],16),_+=32}function xu(b,_,O){var J;for(J=0;16>J;++J)n(_,O+32*J,b,16)}function bc(b,_){var O,J=16;for(O=0;16>O;++O)J+=b[_-1+32*O]+b[_+O-32];xu(J>>5,b,_)}function on(b,_){var O,J=8;for(O=0;16>O;++O)J+=b[_-1+32*O];xu(J>>4,b,_)}function lm(b,_){var O,J=8;for(O=0;16>O;++O)J+=b[_+O-32];xu(J>>4,b,_)}function bh(b,_){xu(128,b,_)}function Dr(b,_,O){return b+2*_+O+2>>2}function wc(b,_){var O,J=_-32;for(J=new Uint8Array([Dr(b[J-1],b[J+0],b[J+1]),Dr(b[J+0],b[J+1],b[J+2]),Dr(b[J+1],b[J+2],b[J+3]),Dr(b[J+2],b[J+3],b[J+4])]),O=0;4>O;++O)s(b,_+32*O,J,0,J.length)}function $p(b,_){var O=b[_-1],J=b[_-1+32],ge=b[_-1+64],be=b[_-1+96];ue(b,_+0,16843009*Dr(b[_-1-32],O,J)),ue(b,_+32,16843009*Dr(O,J,ge)),ue(b,_+64,16843009*Dr(J,ge,be)),ue(b,_+96,16843009*Dr(ge,be,be))}function nl(b,_){var O,J=4;for(O=0;4>O;++O)J+=b[_+O-32]+b[_-1+32*O];for(J>>=3,O=0;4>O;++O)n(b,_+32*O,J,4)}function cm(b,_){var O=b[_-1+0],J=b[_-1+32],ge=b[_-1+64],be=b[_-1-32],Ne=b[_+0-32],Ee=b[_+1-32],Te=b[_+2-32],Oe=b[_+3-32];b[_+0+96]=Dr(J,ge,b[_-1+96]),b[_+1+96]=b[_+0+64]=Dr(O,J,ge),b[_+2+96]=b[_+1+64]=b[_+0+32]=Dr(be,O,J),b[_+3+96]=b[_+2+64]=b[_+1+32]=b[_+0+0]=Dr(Ne,be,O),b[_+3+64]=b[_+2+32]=b[_+1+0]=Dr(Ee,Ne,be),b[_+3+32]=b[_+2+0]=Dr(Te,Ee,Ne),b[_+3+0]=Dr(Oe,Te,Ee)}function _o(b,_){var O=b[_+1-32],J=b[_+2-32],ge=b[_+3-32],be=b[_+4-32],Ne=b[_+5-32],Ee=b[_+6-32],Te=b[_+7-32];b[_+0+0]=Dr(b[_+0-32],O,J),b[_+1+0]=b[_+0+32]=Dr(O,J,ge),b[_+2+0]=b[_+1+32]=b[_+0+64]=Dr(J,ge,be),b[_+3+0]=b[_+2+32]=b[_+1+64]=b[_+0+96]=Dr(ge,be,Ne),b[_+3+32]=b[_+2+64]=b[_+1+96]=Dr(be,Ne,Ee),b[_+3+64]=b[_+2+96]=Dr(Ne,Ee,Te),b[_+3+96]=Dr(Ee,Te,Te)}function yu(b,_){var O=b[_-1+0],J=b[_-1+32],ge=b[_-1+64],be=b[_-1-32],Ne=b[_+0-32],Ee=b[_+1-32],Te=b[_+2-32],Oe=b[_+3-32];b[_+0+0]=b[_+1+64]=be+Ne+1>>1,b[_+1+0]=b[_+2+64]=Ne+Ee+1>>1,b[_+2+0]=b[_+3+64]=Ee+Te+1>>1,b[_+3+0]=Te+Oe+1>>1,b[_+0+96]=Dr(ge,J,O),b[_+0+64]=Dr(J,O,be),b[_+0+32]=b[_+1+96]=Dr(O,be,Ne),b[_+1+32]=b[_+2+96]=Dr(be,Ne,Ee),b[_+2+32]=b[_+3+96]=Dr(Ne,Ee,Te),b[_+3+32]=Dr(Ee,Te,Oe)}function wh(b,_){var O=b[_+0-32],J=b[_+1-32],ge=b[_+2-32],be=b[_+3-32],Ne=b[_+4-32],Ee=b[_+5-32],Te=b[_+6-32],Oe=b[_+7-32];b[_+0+0]=O+J+1>>1,b[_+1+0]=b[_+0+64]=J+ge+1>>1,b[_+2+0]=b[_+1+64]=ge+be+1>>1,b[_+3+0]=b[_+2+64]=be+Ne+1>>1,b[_+0+32]=Dr(O,J,ge),b[_+1+32]=b[_+0+96]=Dr(J,ge,be),b[_+2+32]=b[_+1+96]=Dr(ge,be,Ne),b[_+3+32]=b[_+2+96]=Dr(be,Ne,Ee),b[_+3+64]=Dr(Ne,Ee,Te),b[_+3+96]=Dr(Ee,Te,Oe)}function vu(b,_){var O=b[_-1+0],J=b[_-1+32],ge=b[_-1+64],be=b[_-1+96];b[_+0+0]=O+J+1>>1,b[_+2+0]=b[_+0+32]=J+ge+1>>1,b[_+2+32]=b[_+0+64]=ge+be+1>>1,b[_+1+0]=Dr(O,J,ge),b[_+3+0]=b[_+1+32]=Dr(J,ge,be),b[_+3+32]=b[_+1+64]=Dr(ge,be,be),b[_+3+64]=b[_+2+64]=b[_+0+96]=b[_+1+96]=b[_+2+96]=b[_+3+96]=be}function bu(b,_){var O=b[_-1+0],J=b[_-1+32],ge=b[_-1+64],be=b[_-1+96],Ne=b[_-1-32],Ee=b[_+0-32],Te=b[_+1-32],Oe=b[_+2-32];b[_+0+0]=b[_+2+32]=O+Ne+1>>1,b[_+0+32]=b[_+2+64]=J+O+1>>1,b[_+0+64]=b[_+2+96]=ge+J+1>>1,b[_+0+96]=be+ge+1>>1,b[_+3+0]=Dr(Ee,Te,Oe),b[_+2+0]=Dr(Ne,Ee,Te),b[_+1+0]=b[_+3+32]=Dr(O,Ne,Ee),b[_+1+32]=b[_+3+64]=Dr(J,O,Ne),b[_+1+64]=b[_+3+96]=Dr(ge,J,O),b[_+1+96]=Dr(be,ge,J)}function dm(b,_){var O;for(O=0;8>O;++O)s(b,_+32*O,b,_-32,8)}function Ql(b,_){var O;for(O=0;8>O;++O)n(b,_,b[_-1],8),_+=32}function To(b,_,O){var J;for(J=0;8>J;++J)n(_,O+32*J,b,8)}function Vl(b,_){var O,J=8;for(O=0;8>O;++O)J+=b[_+O-32]+b[_-1+32*O];To(J>>4,b,_)}function Nh(b,_){var O,J=4;for(O=0;8>O;++O)J+=b[_+O-32];To(J>>3,b,_)}function Ss(b,_){var O,J=4;for(O=0;8>O;++O)J+=b[_-1+32*O];To(J>>3,b,_)}function Ch(b,_){To(128,b,_)}function wu(b,_,O){var J=b[_-O],ge=b[_+0],be=3*(ge-J)+$N[1020+b[_-2*O]-b[_+O]],Ne=yv[112+(be+4>>3)];b[_-O]=ko[255+J+yv[112+(be+3>>3)]],b[_+0]=ko[255+ge-Ne]}function jh(b,_,O,J){var ge=b[_+0],be=b[_+O];return cl[255+b[_-2*O]-b[_-O]]>J||cl[255+be-ge]>J}function Sh(b,_,O,J){return 4*cl[255+b[_-O]-b[_+0]]+cl[255+b[_-2*O]-b[_+O]]<=J}function Eh(b,_,O,J,ge){var be=b[_-3*O],Ne=b[_-2*O],Ee=b[_-O],Te=b[_+0],Oe=b[_+O],nt=b[_+2*O],xt=b[_+3*O];return 4*cl[255+Ee-Te]+cl[255+Ne-Oe]>J?0:cl[255+b[_-4*O]-be]<=ge&&cl[255+be-Ne]<=ge&&cl[255+Ne-Ee]<=ge&&cl[255+xt-nt]<=ge&&cl[255+nt-Oe]<=ge&&cl[255+Oe-Te]<=ge}function hd(b,_,O,J){var ge=2*J+1;for(J=0;16>J;++J)Sh(b,_+J,O,ge)&&wu(b,_+J,O)}function Io(b,_,O,J){var ge=2*J+1;for(J=0;16>J;++J)Sh(b,_+J*O,1,ge)&&wu(b,_+J*O,1)}function xa(b,_,O,J){var ge;for(ge=3;0<ge;--ge)hd(b,_+=4*O,O,J)}function um(b,_,O,J){var ge;for(ge=3;0<ge;--ge)Io(b,_+=4,O,J)}function Nc(b,_,O,J,ge,be,Ne,Ee){for(be=2*be+1;0<ge--;){if(Eh(b,_,O,be,Ne))if(jh(b,_,O,Ee))wu(b,_,O);else{var Te=b,Oe=_,nt=O,xt=Te[Oe-2*nt],yt=Te[Oe-nt],ut=Te[Oe+0],Ut=Te[Oe+nt],Et=Te[Oe+2*nt],at=27*(Dt=$N[1020+3*(ut-yt)+$N[1020+xt-Ut]])+63>>7,it=18*Dt+63>>7,Dt=9*Dt+63>>7;Te[Oe-3*nt]=ko[255+Te[Oe-3*nt]+Dt],Te[Oe-2*nt]=ko[255+xt+it],Te[Oe-nt]=ko[255+yt+at],Te[Oe+0]=ko[255+ut-at],Te[Oe+nt]=ko[255+Ut-it],Te[Oe+2*nt]=ko[255+Et-Dt]}_+=J}}function za(b,_,O,J,ge,be,Ne,Ee){for(be=2*be+1;0<ge--;){if(Eh(b,_,O,be,Ne))if(jh(b,_,O,Ee))wu(b,_,O);else{var Te=b,Oe=_,nt=O,xt=Te[Oe-nt],yt=Te[Oe+0],ut=Te[Oe+nt],Ut=yv[112+((Et=3*(yt-xt))+4>>3)],Et=yv[112+(Et+3>>3)],at=Ut+1>>1;Te[Oe-2*nt]=ko[255+Te[Oe-2*nt]+at],Te[Oe-nt]=ko[255+xt+Et],Te[Oe+0]=ko[255+yt-Ut],Te[Oe+nt]=ko[255+ut-at]}_+=J}}function Nu(b,_,O,J,ge,be){Nc(b,_,O,1,16,J,ge,be)}function Hl(b,_,O,J,ge,be){Nc(b,_,1,O,16,J,ge,be)}function Cu(b,_,O,J,ge,be){var Ne;for(Ne=3;0<Ne;--Ne)za(b,_+=4*O,O,1,16,J,ge,be)}function fd(b,_,O,J,ge,be){var Ne;for(Ne=3;0<Ne;--Ne)za(b,_+=4,1,O,16,J,ge,be)}function ju(b,_,O,J,ge,be,Ne,Ee){Nc(b,_,ge,1,8,be,Ne,Ee),Nc(O,J,ge,1,8,be,Ne,Ee)}function _h(b,_,O,J,ge,be,Ne,Ee){Nc(b,_,1,ge,8,be,Ne,Ee),Nc(O,J,1,ge,8,be,Ne,Ee)}function Su(b,_,O,J,ge,be,Ne,Ee){za(b,_+4*ge,ge,1,8,be,Ne,Ee),za(O,J+4*ge,ge,1,8,be,Ne,Ee)}function Cc(b,_,O,J,ge,be,Ne,Ee){za(b,_+4,1,ge,8,be,Ne,Ee),za(O,J+4,1,ge,8,be,Ne,Ee)}function md(){this.ba=new gt,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Vt,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Eu(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function pd(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function _u(){this.ua=0,this.Wa=new oe,this.vb=new oe,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new q,this.yc=new k}function Am(){this.xb=this.a=0,this.l=new ot,this.ca=new gt,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new I,this.Pb=0,this.wd=new I,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new _u,this.ab=0,this.gc=o(4,pd),this.Oc=0}function $l(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new ot,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function jc(b,_,O,J,ge,be,Ne){for(b=b==null?0:b[_+0],_=0;_<Ne;++_)ge[be+_]=b+O[J+_]&255,b=ge[be+_]}function Tu(b,_,O,J,ge,be,Ne){var Ee;if(b==null)jc(null,null,O,J,ge,be,Ne);else for(Ee=0;Ee<Ne;++Ee)ge[be+Ee]=b[_+Ee]+O[J+Ee]&255}function di(b,_,O,J,ge,be,Ne){if(b==null)jc(null,null,O,J,ge,be,Ne);else{var Ee,Te=b[_+0],Oe=Te,nt=Te;for(Ee=0;Ee<Ne;++Ee)Oe=nt+(Te=b[_+Ee])-Oe,nt=O[J+Ee]+(-256&Oe?0>Oe?0:255:Oe)&255,Oe=Te,ge[be+Ee]=nt}}function Iu(b,_,O,J){var ge=_.width,be=_.o;if(e(b!=null&&_!=null),0>O||0>=J||O+J>be)return null;if(!b.Cc){if(b.ga==null){var Ne;if(b.ga=new $l,(Ne=b.ga==null)||(Ne=_.width*_.o,e(b.Gb.length==0),b.Gb=i(Ne),b.Uc=0,b.Gb==null?Ne=0:(b.mb=b.Gb,b.nb=b.Uc,b.rc=null,Ne=1),Ne=!Ne),!Ne){Ne=b.ga;var Ee=b.Fa,Te=b.P,Oe=b.qc,nt=b.mb,xt=b.nb,yt=Te+1,ut=Oe-1,Ut=Ne.l;if(e(Ee!=null&&nt!=null&&_!=null),Ru[0]=null,Ru[1]=jc,Ru[2]=Tu,Ru[3]=di,Ne.ca=nt,Ne.tb=xt,Ne.c=_.width,Ne.i=_.height,e(0<Ne.c&&0<Ne.i),1>=Oe)_=0;else if(Ne.$a=Ee[Te+0]>>0&3,Ne.Z=Ee[Te+0]>>2&3,Ne.Lc=Ee[Te+0]>>4&3,Te=Ee[Te+0]>>6&3,0>Ne.$a||1<Ne.$a||4<=Ne.Z||1<Ne.Lc||Te)_=0;else if(Ut.put=We,Ut.ac=Ke,Ut.bc=Ft,Ut.ma=Ne,Ut.width=_.width,Ut.height=_.height,Ut.Da=_.Da,Ut.v=_.v,Ut.va=_.va,Ut.j=_.j,Ut.o=_.o,Ne.$a)e:{e(Ne.$a==1),_=Ze();t:for(;;){if(_==null){_=0;break e}if(e(Ne!=null),Ne.mc=_,_.c=Ne.c,_.i=Ne.i,_.l=Ne.l,_.l.ma=Ne,_.l.width=Ne.c,_.l.height=Ne.i,_.a=0,re(_.m,Ee,yt,ut),!Ye(Ne.c,Ne.i,1,_,null)||(_.ab==1&&_.gc[0].hc==3&&se(_.s)?(Ne.ic=1,Ee=_.c*_.i,_.Ta=null,_.Ua=0,_.V=i(Ee),_.Ba=0,_.V==null?(_.a=1,_=0):_=1):(Ne.ic=0,_=Je(_,Ne.c)),!_))break t;_=1;break e}Ne.mc=null,_=0}else _=ut>=Ne.c*Ne.i;Ne=!_}if(Ne)return null;b.ga.Lc!=1?b.Ga=0:J=be-O}e(b.ga!=null),e(O+J<=be);e:{if(_=(Ee=b.ga).c,be=Ee.l.o,Ee.$a==0){if(yt=b.rc,ut=b.Vc,Ut=b.Fa,Te=b.P+1+O*_,Oe=b.mb,nt=b.nb+O*_,e(Te<=b.P+b.qc),Ee.Z!=0)for(e(Ru[Ee.Z]!=null),Ne=0;Ne<J;++Ne)Ru[Ee.Z](yt,ut,Ut,Te,Oe,nt,_),yt=Oe,ut=nt,nt+=_,Te+=_;else for(Ne=0;Ne<J;++Ne)s(Oe,nt,Ut,Te,_),yt=Oe,ut=nt,nt+=_,Te+=_;b.rc=yt,b.Vc=ut}else{if(e(Ee.mc!=null),_=O+J,e((Ne=Ee.mc)!=null),e(_<=Ne.i),Ne.C>=_)_=1;else if(Ee.ic||dt(),Ee.ic){Ee=Ne.V,yt=Ne.Ba,ut=Ne.c;var Et=Ne.i,at=(Ut=1,Te=Ne.$/ut,Oe=Ne.$%ut,nt=Ne.m,xt=Ne.s,Ne.$),it=ut*Et,Dt=ut*_,Qt=xt.wc,Ot=at<Dt?Jr(xt,Oe,Te):null;e(at<=it),e(_<=Et),e(se(xt));t:for(;;){for(;!nt.h&&at<Dt;){if(Oe&Qt||(Ot=Jr(xt,Oe,Te)),e(Ot!=null),K(nt),256>(Et=Pr(Ot.G[0],Ot.H[0],nt)))Ee[yt+at]=Et,++at,++Oe>=ut&&(Oe=0,++Te<=_&&!(Te%16)&&ce(Ne,Te));else{if(!(280>Et)){Ut=0;break t}Et=xr(Et-256,nt);var cr,rr=Pr(Ot.G[4],Ot.H[4],nt);if(K(nt),!(at>=(rr=vr(ut,rr=xr(rr,nt)))&&it-at>=Et)){Ut=0;break t}for(cr=0;cr<Et;++cr)Ee[yt+at+cr]=Ee[yt+at+cr-rr];for(at+=Et,Oe+=Et;Oe>=ut;)Oe-=ut,++Te<=_&&!(Te%16)&&ce(Ne,Te);at<Dt&&Oe&Qt&&(Ot=Jr(xt,Oe,Te))}e(nt.h==V(nt))}ce(Ne,Te>_?_:Te);break t}!Ut||nt.h&&at<it?(Ut=0,Ne.a=nt.h?5:3):Ne.$=at,_=Ut}else _=xe(Ne,Ne.V,Ne.Ba,Ne.c,Ne.i,_,et);if(!_){J=0;break e}}O+J>=be&&(b.Cc=1),J=1}if(!J)return null;if(b.Cc&&((J=b.ga)!=null&&(J.mc=null),b.ga=null,0<b.Ga))return alert("todo:WebPDequantizeLevels"),null}return b.nb+O*ge}function P(b,_,O,J,ge,be){for(;0<ge--;){var Ne,Ee=b,Te=_+(O?1:0),Oe=b,nt=_+(O?0:3);for(Ne=0;Ne<J;++Ne){var xt=Oe[nt+4*Ne];xt!=255&&(xt*=32897,Ee[Te+4*Ne+0]=Ee[Te+4*Ne+0]*xt>>23,Ee[Te+4*Ne+1]=Ee[Te+4*Ne+1]*xt>>23,Ee[Te+4*Ne+2]=Ee[Te+4*Ne+2]*xt>>23)}_+=be}}function pe(b,_,O,J,ge){for(;0<J--;){var be;for(be=0;be<O;++be){var Ne=b[_+2*be+0],Ee=15&(Oe=b[_+2*be+1]),Te=4369*Ee,Oe=(240&Oe|Oe>>4)*Te>>16;b[_+2*be+0]=(240&Ne|Ne>>4)*Te>>16&240|(15&Ne|Ne<<4)*Te>>16>>4&15,b[_+2*be+1]=240&Oe|Ee}_+=ge}}function $e(b,_,O,J,ge,be,Ne,Ee){var Te,Oe,nt=255;for(Oe=0;Oe<ge;++Oe){for(Te=0;Te<J;++Te){var xt=b[_+Te];be[Ne+4*Te]=xt,nt&=xt}_+=O,Ne+=Ee}return nt!=255}function tt(b,_,O,J,ge){var be;for(be=0;be<ge;++be)O[J+be]=b[_+be]>>8}function dt(){ll=P,Js=pe,Zs=$e,Hn=tt}function _t(b,_,O){w[b]=function(J,ge,be,Ne,Ee,Te,Oe,nt,xt,yt,ut,Ut,Et,at,it,Dt,Qt){var Ot,cr=Qt-1>>1,rr=Ee[Te+0]|Oe[nt+0]<<16,Tr=xt[yt+0]|ut[Ut+0]<<16;e(J!=null);var ar=3*rr+Tr+131074>>2;for(_(J[ge+0],255&ar,ar>>16,Et,at),be!=null&&(ar=3*Tr+rr+131074>>2,_(be[Ne+0],255&ar,ar>>16,it,Dt)),Ot=1;Ot<=cr;++Ot){var Ns=Ee[Te+Ot]|Oe[nt+Ot]<<16,Bs=xt[yt+Ot]|ut[Ut+Ot]<<16,xs=rr+Ns+Tr+Bs+524296,is=xs+2*(Ns+Tr)>>3;ar=is+rr>>1,rr=(xs=xs+2*(rr+Bs)>>3)+Ns>>1,_(J[ge+2*Ot-1],255&ar,ar>>16,Et,at+(2*Ot-1)*O),_(J[ge+2*Ot-0],255&rr,rr>>16,Et,at+(2*Ot-0)*O),be!=null&&(ar=xs+Tr>>1,rr=is+Bs>>1,_(be[Ne+2*Ot-1],255&ar,ar>>16,it,Dt+(2*Ot-1)*O),_(be[Ne+2*Ot+0],255&rr,rr>>16,it,Dt+(2*Ot+0)*O)),rr=Ns,Tr=Bs}1&Qt||(ar=3*rr+Tr+131074>>2,_(J[ge+Qt-1],255&ar,ar>>16,Et,at+(Qt-1)*O),be!=null&&(ar=3*Tr+rr+131074>>2,_(be[Ne+Qt-1],255&ar,ar>>16,it,Dt+(Qt-1)*O)))}}function $t(){dl[vv]=mH,dl[bv]=vT,dl[mT]=pH,dl[wv]=bT,dl[Nv]=wT,dl[KN]=NT,dl[pT]=gH,dl[zN]=vT,dl[qN]=bT,dl[Cv]=wT,dl[WN]=NT}function sr(b){return b&-16384?0>b?0:255:b>>xH}function N(b,_){return sr((19077*b>>8)+(26149*_>>8)-14234)}function M(b,_,O){return sr((19077*b>>8)-(6419*_>>8)-(13320*O>>8)+8708)}function ne(b,_){return sr((19077*b>>8)+(33050*_>>8)-17685)}function Se(b,_,O,J,ge){J[ge+0]=N(b,O),J[ge+1]=M(b,_,O),J[ge+2]=ne(b,_)}function ct(b,_,O,J,ge){J[ge+0]=ne(b,_),J[ge+1]=M(b,_,O),J[ge+2]=N(b,O)}function vt(b,_,O,J,ge){var be=M(b,_,O);_=be<<3&224|ne(b,_)>>3,J[ge+0]=248&N(b,O)|be>>5,J[ge+1]=_}function zt(b,_,O,J,ge){var be=240&ne(b,_)|15;J[ge+0]=240&N(b,O)|M(b,_,O)>>4,J[ge+1]=be}function Qr(b,_,O,J,ge){J[ge+0]=255,Se(b,_,O,J,ge+1)}function as(b,_,O,J,ge){ct(b,_,O,J,ge),J[ge+3]=255}function Vr(b,_,O,J,ge){Se(b,_,O,J,ge),J[ge+3]=255}function Es(b,_){return 0>b?0:b>_?_:b}function qs(b,_,O){w[b]=function(J,ge,be,Ne,Ee,Te,Oe,nt,xt){for(var yt=nt+(-2&xt)*O;nt!=yt;)_(J[ge+0],be[Ne+0],Ee[Te+0],Oe,nt),_(J[ge+1],be[Ne+0],Ee[Te+0],Oe,nt+O),ge+=2,++Ne,++Te,nt+=2*O;1&xt&&_(J[ge+0],be[Ne+0],Ee[Te+0],Oe,nt)}}function Kl(b,_,O){return O==0?b==0?_==0?6:5:_==0?4:0:O}function qa(b,_,O,J,ge){switch(b>>>30){case 3:yd(_,O,J,ge,0);break;case 2:Vn(_,O,J,ge);break;case 1:Mi(_,O,J,ge)}}function Sc(b,_){var O,J,ge=_.M,be=_.Nb,Ne=b.oc,Ee=b.pc+40,Te=b.oc,Oe=b.pc+584,nt=b.oc,xt=b.pc+600;for(O=0;16>O;++O)Ne[Ee+32*O-1]=129;for(O=0;8>O;++O)Te[Oe+32*O-1]=129,nt[xt+32*O-1]=129;for(0<ge?Ne[Ee-1-32]=Te[Oe-1-32]=nt[xt-1-32]=129:(n(Ne,Ee-32-1,127,21),n(Te,Oe-32-1,127,9),n(nt,xt-32-1,127,9)),J=0;J<b.za;++J){var yt=_.ya[_.aa+J];if(0<J){for(O=-1;16>O;++O)s(Ne,Ee+32*O-4,Ne,Ee+32*O+12,4);for(O=-1;8>O;++O)s(Te,Oe+32*O-4,Te,Oe+32*O+4,4),s(nt,xt+32*O-4,nt,xt+32*O+4,4)}var ut=b.Gd,Ut=b.Hd+J,Et=yt.ad,at=yt.Hc;if(0<ge&&(s(Ne,Ee-32,ut[Ut].y,0,16),s(Te,Oe-32,ut[Ut].f,0,8),s(nt,xt-32,ut[Ut].ea,0,8)),yt.Za){var it=Ne,Dt=Ee-32+16;for(0<ge&&(J>=b.za-1?n(it,Dt,ut[Ut].y[15],4):s(it,Dt,ut[Ut+1].y,0,4)),O=0;4>O;O++)it[Dt+128+O]=it[Dt+256+O]=it[Dt+384+O]=it[Dt+0+O];for(O=0;16>O;++O,at<<=2)it=Ne,Dt=Ee+jT[O],zl[yt.Ob[O]](it,Dt),qa(at,Et,16*+O,it,Dt)}else if(it=Kl(J,ge,yt.Ob[0]),Du[it](Ne,Ee),at!=0)for(O=0;16>O;++O,at<<=2)qa(at,Et,16*+O,Ne,Ee+jT[O]);for(O=yt.Gc,it=Kl(J,ge,yt.Dd),bd[it](Te,Oe),bd[it](nt,xt),at=Et,it=Te,Dt=Oe,255&(yt=O>>0)&&(170&yt?Gp(at,256,it,Dt):il(at,256,it,Dt)),yt=nt,at=xt,255&(O>>=8)&&(170&O?Gp(Et,320,yt,at):il(Et,320,yt,at)),ge<b.Ub-1&&(s(ut[Ut].y,0,Ne,Ee+480,16),s(ut[Ut].f,0,Te,Oe+224,8),s(ut[Ut].ea,0,nt,xt+224,8)),O=8*be*b.B,ut=b.sa,Ut=b.ta+16*J+16*be*b.R,Et=b.qa,yt=b.ra+8*J+O,at=b.Ha,it=b.Ia+8*J+O,O=0;16>O;++O)s(ut,Ut+O*b.R,Ne,Ee+32*O,16);for(O=0;8>O;++O)s(Et,yt+O*b.B,Te,Oe+32*O,8),s(at,it+O*b.B,nt,xt+32*O,8)}}function Ec(b,_,O,J,ge,be,Ne,Ee,Te){var Oe=[0],nt=[0],xt=0,yt=Te!=null?Te.kd:0,ut=Te??new Eu;if(b==null||12>O)return 7;ut.data=b,ut.w=_,ut.ha=O,_=[_],O=[O],ut.gb=[ut.gb];e:{var Ut=_,Et=O,at=ut.gb;if(e(b!=null),e(Et!=null),e(at!=null),at[0]=0,12<=Et[0]&&!r(b,Ut[0],"RIFF")){if(r(b,Ut[0]+8,"WEBP")){at=3;break e}var it=H(b,Ut[0]+4);if(12>it||4294967286<it){at=3;break e}if(yt&&it>Et[0]-8){at=7;break e}at[0]=it,Ut[0]+=12,Et[0]-=12}at=0}if(at!=0)return at;for(it=0<ut.gb[0],O=O[0];;){e:{var Dt=b;Et=_,at=O;var Qt=Oe,Ot=nt,cr=Ut=[0];if((ar=xt=[xt])[0]=0,8>at[0])at=7;else{if(!r(Dt,Et[0],"VP8X")){if(H(Dt,Et[0]+4)!=10){at=3;break e}if(18>at[0]){at=7;break e}var rr=H(Dt,Et[0]+8),Tr=1+Y(Dt,Et[0]+12);if(2147483648<=Tr*(Dt=1+Y(Dt,Et[0]+15))){at=3;break e}cr!=null&&(cr[0]=rr),Qt!=null&&(Qt[0]=Tr),Ot!=null&&(Ot[0]=Dt),Et[0]+=18,at[0]-=18,ar[0]=1}at=0}}if(xt=xt[0],Ut=Ut[0],at!=0)return at;if(Et=!!(2&Ut),!it&&xt)return 3;if(be!=null&&(be[0]=!!(16&Ut)),Ne!=null&&(Ne[0]=Et),Ee!=null&&(Ee[0]=0),Ne=Oe[0],Ut=nt[0],xt&&Et&&Te==null){at=0;break}if(4>O){at=7;break}if(it&&xt||!it&&!xt&&!r(b,_[0],"ALPH")){O=[O],ut.na=[ut.na],ut.P=[ut.P],ut.Sa=[ut.Sa];e:{rr=b,at=_,it=O;var ar=ut.gb;Qt=ut.na,Ot=ut.P,cr=ut.Sa,Tr=22,e(rr!=null),e(it!=null),Dt=at[0];var Ns=it[0];for(e(Qt!=null),e(cr!=null),Qt[0]=null,Ot[0]=null,cr[0]=0;;){if(at[0]=Dt,it[0]=Ns,8>Ns){at=7;break e}var Bs=H(rr,Dt+4);if(4294967286<Bs){at=3;break e}var xs=8+Bs+1&-2;if(Tr+=xs,0<ar&&Tr>ar){at=3;break e}if(!r(rr,Dt,"VP8 ")||!r(rr,Dt,"VP8L")){at=0;break e}if(Ns[0]<xs){at=7;break e}r(rr,Dt,"ALPH")||(Qt[0]=rr,Ot[0]=Dt+8,cr[0]=Bs),Dt+=xs,Ns-=xs}}if(O=O[0],ut.na=ut.na[0],ut.P=ut.P[0],ut.Sa=ut.Sa[0],at!=0)break}O=[O],ut.Ja=[ut.Ja],ut.xa=[ut.xa];e:if(ar=b,at=_,it=O,Qt=ut.gb[0],Ot=ut.Ja,cr=ut.xa,rr=at[0],Dt=!r(ar,rr,"VP8 "),Tr=!r(ar,rr,"VP8L"),e(ar!=null),e(it!=null),e(Ot!=null),e(cr!=null),8>it[0])at=7;else{if(Dt||Tr){if(ar=H(ar,rr+4),12<=Qt&&ar>Qt-12){at=3;break e}if(yt&&ar>it[0]-8){at=7;break e}Ot[0]=ar,at[0]+=8,it[0]-=8,cr[0]=Tr}else cr[0]=5<=it[0]&&ar[rr+0]==47&&!(ar[rr+4]>>5),Ot[0]=it[0];at=0}if(O=O[0],ut.Ja=ut.Ja[0],ut.xa=ut.xa[0],_=_[0],at!=0)break;if(4294967286<ut.Ja)return 3;if(Ee==null||Et||(Ee[0]=ut.xa?2:1),Ne=[Ne],Ut=[Ut],ut.xa){if(5>O){at=7;break}Ee=Ne,yt=Ut,Et=be,b==null||5>O?b=0:5<=O&&b[_+0]==47&&!(b[_+4]>>5)?(it=[0],ar=[0],Qt=[0],re(Ot=new I,b,_,O),Ct(Ot,it,ar,Qt)?(Ee!=null&&(Ee[0]=it[0]),yt!=null&&(yt[0]=ar[0]),Et!=null&&(Et[0]=Qt[0]),b=1):b=0):b=0}else{if(10>O){at=7;break}Ee=Ut,b==null||10>O||!Lt(b,_+3,O-3)?b=0:(yt=b[_+0]|b[_+1]<<8|b[_+2]<<16,Et=16383&(b[_+7]<<8|b[_+6]),b=16383&(b[_+9]<<8|b[_+8]),1&yt||3<(yt>>1&7)||!(yt>>4&1)||yt>>5>=ut.Ja||!Et||!b?b=0:(Ne&&(Ne[0]=Et),Ee&&(Ee[0]=b),b=1))}if(!b||(Ne=Ne[0],Ut=Ut[0],xt&&(Oe[0]!=Ne||nt[0]!=Ut)))return 3;Te!=null&&(Te[0]=ut,Te.offset=_-Te.w,e(4294967286>_-Te.w),e(Te.offset==Te.ha-O));break}return at==0||at==7&&xt&&Te==null?(be!=null&&(be[0]|=ut.na!=null&&0<ut.na.length),J!=null&&(J[0]=Ne),ge!=null&&(ge[0]=Ut),0):at}function Kp(b,_,O){var J=_.width,ge=_.height,be=0,Ne=0,Ee=J,Te=ge;if(_.Da=b!=null&&0<b.Da,_.Da&&(Ee=b.cd,Te=b.bd,be=b.v,Ne=b.j,11>O||(be&=-2,Ne&=-2),0>be||0>Ne||0>=Ee||0>=Te||be+Ee>J||Ne+Te>ge))return 0;if(_.v=be,_.j=Ne,_.va=be+Ee,_.o=Ne+Te,_.U=Ee,_.T=Te,_.da=b!=null&&0<b.da,_.da){if(!He(Ee,Te,O=[b.ib],be=[b.hb]))return 0;_.ib=O[0],_.hb=be[0]}return _.ob=b!=null&&b.ob,_.Kb=b==null||!b.Sd,_.da&&(_.ob=_.ib<3*J/4&&_.hb<3*ge/4,_.Kb=0),1}function zp(b){if(b==null)return 2;if(11>b.S){var _=b.f.RGBA;_.fb+=(b.height-1)*_.A,_.A=-_.A}else _=b.f.kb,b=b.height,_.O+=(b-1)*_.fa,_.fa=-_.fa,_.N+=(b-1>>1)*_.Ab,_.Ab=-_.Ab,_.W+=(b-1>>1)*_.Db,_.Db=-_.Db,_.F!=null&&(_.J+=(b-1)*_.lb,_.lb=-_.lb);return 0}function hm(b,_,O,J){if(J==null||0>=b||0>=_)return 2;if(O!=null){if(O.Da){var ge=O.cd,be=O.bd,Ne=-2&O.v,Ee=-2&O.j;if(0>Ne||0>Ee||0>=ge||0>=be||Ne+ge>b||Ee+be>_)return 2;b=ge,_=be}if(O.da){if(!He(b,_,ge=[O.ib],be=[O.hb]))return 2;b=ge[0],_=be[0]}}J.width=b,J.height=_;e:{var Te=J.width,Oe=J.height;if(b=J.S,0>=Te||0>=Oe||!(b>=vv&&13>b))b=2;else{if(0>=J.Rd&&J.sd==null){Ne=be=ge=_=0;var nt=(Ee=Te*ST[b])*Oe;if(11>b||(be=(Oe+1)/2*(_=(Te+1)/2),b==12&&(Ne=(ge=Te)*Oe)),(Oe=i(nt+2*be+Ne))==null){b=1;break e}J.sd=Oe,11>b?((Te=J.f.RGBA).eb=Oe,Te.fb=0,Te.A=Ee,Te.size=nt):((Te=J.f.kb).y=Oe,Te.O=0,Te.fa=Ee,Te.Fd=nt,Te.f=Oe,Te.N=0+nt,Te.Ab=_,Te.Cd=be,Te.ea=Oe,Te.W=0+nt+be,Te.Db=_,Te.Ed=be,b==12&&(Te.F=Oe,Te.J=0+nt+2*be),Te.Tc=Ne,Te.lb=ge)}if(_=1,ge=J.S,be=J.width,Ne=J.height,ge>=vv&&13>ge)if(11>ge)b=J.f.RGBA,_&=(Ee=Math.abs(b.A))*(Ne-1)+be<=b.size,_&=Ee>=be*ST[ge],_&=b.eb!=null;else{b=J.f.kb,Ee=(be+1)/2,nt=(Ne+1)/2,Te=Math.abs(b.fa),Oe=Math.abs(b.Ab);var xt=Math.abs(b.Db),yt=Math.abs(b.lb),ut=yt*(Ne-1)+be;_&=Te*(Ne-1)+be<=b.Fd,_&=Oe*(nt-1)+Ee<=b.Cd,_=(_&=xt*(nt-1)+Ee<=b.Ed)&Te>=be&Oe>=Ee&xt>=Ee,_&=b.y!=null,_&=b.f!=null,_&=b.ea!=null,ge==12&&(_&=yt>=be,_&=ut<=b.Tc,_&=b.F!=null)}else _=0;b=_?0:2}}return b!=0||O!=null&&O.fd&&(b=zp(J)),b}var Wa=64,fm=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],mm=24,pm=32,qp=8,no=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];ae("Predictor0","PredictorAdd0"),w.Predictor0=function(){return 4278190080},w.Predictor1=function(b){return b},w.Predictor2=function(b,_,O){return _[O+0]},w.Predictor3=function(b,_,O){return _[O+1]},w.Predictor4=function(b,_,O){return _[O-1]},w.Predictor5=function(b,_,O){return we(we(b,_[O+1]),_[O+0])},w.Predictor6=function(b,_,O){return we(b,_[O-1])},w.Predictor7=function(b,_,O){return we(b,_[O+0])},w.Predictor8=function(b,_,O){return we(_[O-1],_[O+0])},w.Predictor9=function(b,_,O){return we(_[O+0],_[O+1])},w.Predictor10=function(b,_,O){return we(we(b,_[O-1]),we(_[O+0],_[O+1]))},w.Predictor11=function(b,_,O){var J=_[O+0];return 0>=me(J>>24&255,b>>24&255,(_=_[O-1])>>24&255)+me(J>>16&255,b>>16&255,_>>16&255)+me(J>>8&255,b>>8&255,_>>8&255)+me(255&J,255&b,255&_)?J:b},w.Predictor12=function(b,_,O){var J=_[O+0];return(De((b>>24&255)+(J>>24&255)-((_=_[O-1])>>24&255))<<24|De((b>>16&255)+(J>>16&255)-(_>>16&255))<<16|De((b>>8&255)+(J>>8&255)-(_>>8&255))<<8|De((255&b)+(255&J)-(255&_)))>>>0},w.Predictor13=function(b,_,O){var J=_[O-1];return(Ve((b=we(b,_[O+0]))>>24&255,J>>24&255)<<24|Ve(b>>16&255,J>>16&255)<<16|Ve(b>>8&255,J>>8&255)<<8|Ve(b>>0&255,J>>0&255))>>>0};var HN=w.PredictorAdd0;w.PredictorAdd1=Fe,ae("Predictor2","PredictorAdd2"),ae("Predictor3","PredictorAdd3"),ae("Predictor4","PredictorAdd4"),ae("Predictor5","PredictorAdd5"),ae("Predictor6","PredictorAdd6"),ae("Predictor7","PredictorAdd7"),ae("Predictor8","PredictorAdd8"),ae("Predictor9","PredictorAdd9"),ae("Predictor10","PredictorAdd10"),ae("Predictor11","PredictorAdd11"),ae("Predictor12","PredictorAdd12"),ae("Predictor13","PredictorAdd13");var Wp=w.PredictorAdd2;_e("ColorIndexInverseTransform","MapARGB","32b",function(b){return b>>8&255},function(b){return b}),_e("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(b){return b},function(b){return b>>8&255});var fv,al=w.ColorIndexInverseTransform,gm=w.MapARGB,mv=w.VP8LColorIndexInverseTransformAlpha,pv=w.MapAlpha,ku=w.VP8LPredictorsAdd=[];ku.length=16,(w.VP8LPredictors=[]).length=16,(w.VP8LPredictorsAdd_C=[]).length=16,(w.VP8LPredictors_C=[]).length=16;var Th,ao,Ui,Bu,gd,xd,xm,yd,Vn,Gp,Mi,il,ym,gv,Yp,Ih,kh,Fu,Bh,vm,Fh,Pu,Xp,ol,ll,Js,Zs,Hn,ya=i(511),vd=i(2041),Jp=i(225),bm=i(767),xv=0,$N=vd,yv=Jp,ko=bm,cl=ya,vv=0,bv=1,mT=2,wv=3,Nv=4,KN=5,pT=6,zN=7,qN=8,Cv=9,WN=10,tH=[2,3,7],rH=[3,3,11],gT=[280,256,256,256,40],sH=[0,1,1,1,0],nH=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],aH=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],iH=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],oH=8,GN=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],YN=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Zp=null,lH=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],cH=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],xT=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],dH=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],uH=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],AH=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],hH=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Du=[],zl=[],bd=[],fH=1,yT=2,Ru=[],dl=[];_t("UpsampleRgbLinePair",Se,3),_t("UpsampleBgrLinePair",ct,3),_t("UpsampleRgbaLinePair",Vr,4),_t("UpsampleBgraLinePair",as,4),_t("UpsampleArgbLinePair",Qr,4),_t("UpsampleRgba4444LinePair",zt,2),_t("UpsampleRgb565LinePair",vt,2);var mH=w.UpsampleRgbLinePair,pH=w.UpsampleBgrLinePair,vT=w.UpsampleRgbaLinePair,bT=w.UpsampleBgraLinePair,wT=w.UpsampleArgbLinePair,NT=w.UpsampleRgba4444LinePair,gH=w.UpsampleRgb565LinePair,jv=16,Sv=1<<jv-1,eg=-227,XN=482,xH=6,CT=0,yH=i(256),vH=i(256),bH=i(256),wH=i(256),NH=i(XN-eg),CH=i(XN-eg);qs("YuvToRgbRow",Se,3),qs("YuvToBgrRow",ct,3),qs("YuvToRgbaRow",Vr,4),qs("YuvToBgraRow",as,4),qs("YuvToArgbRow",Qr,4),qs("YuvToRgba4444Row",zt,2),qs("YuvToRgb565Row",vt,2);var jT=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Ev=[0,2,8],jH=[8,7,6,4,4,2,2,2,1,1,1,1],SH=1;this.WebPDecodeRGBA=function(b,_,O,J,ge){var be=bv,Ne=new md,Ee=new gt;Ne.ba=Ee,Ee.S=be,Ee.width=[Ee.width],Ee.height=[Ee.height];var Te=Ee.width,Oe=Ee.height,nt=new St;if(nt==null||b==null)var xt=2;else e(nt!=null),xt=Ec(b,_,O,nt.width,nt.height,nt.Pd,nt.Qd,nt.format,null);if(xt!=0?Te=0:(Te!=null&&(Te[0]=nt.width[0]),Oe!=null&&(Oe[0]=nt.height[0]),Te=1),Te){Ee.width=Ee.width[0],Ee.height=Ee.height[0],J!=null&&(J[0]=Ee.width),ge!=null&&(ge[0]=Ee.height);e:{if(J=new ot,(ge=new Eu).data=b,ge.w=_,ge.ha=O,ge.kd=1,_=[0],e(ge!=null),((b=Ec(ge.data,ge.w,ge.ha,null,null,null,_,null,ge))==0||b==7)&&_[0]&&(b=4),(_=b)==0){if(e(Ne!=null),J.data=ge.data,J.w=ge.w+ge.offset,J.ha=ge.ha-ge.offset,J.put=We,J.ac=Ke,J.bc=Ft,J.ma=Ne,ge.xa){if((b=Ze())==null){Ne=1;break e}if(function(yt,ut){var Ut=[0],Et=[0],at=[0];t:for(;;){if(yt==null)return 0;if(ut==null)return yt.a=2,0;if(yt.l=ut,yt.a=0,re(yt.m,ut.data,ut.w,ut.ha),!Ct(yt.m,Ut,Et,at)){yt.a=3;break t}if(yt.xb=yT,ut.width=Ut[0],ut.height=Et[0],!Ye(Ut[0],Et[0],1,yt,null))break t;return 1}return e(yt.a!=0),0}(b,J)){if(J=(_=hm(J.width,J.height,Ne.Oa,Ne.ba))==0){t:{J=b;r:for(;;){if(J==null){J=0;break t}if(e(J.s.yc!=null),e(J.s.Ya!=null),e(0<J.s.Wb),e((O=J.l)!=null),e((ge=O.ma)!=null),J.xb!=0){if(J.ca=ge.ba,J.tb=ge.tb,e(J.ca!=null),!Kp(ge.Oa,O,wv)){J.a=2;break r}if(!Je(J,O.width)||O.da)break r;if((O.da||ht(J.ca.S))&&dt(),11>J.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),J.ca.f.kb.F!=null&&dt()),J.Pb&&0<J.s.ua&&J.s.vb.X==null&&!je(J.s.vb,J.s.Wa.Xa)){J.a=1;break r}J.xb=0}if(!xe(J,J.V,J.Ba,J.c,J.i,O.o,Le))break r;ge.Dc=J.Ma,J=1;break t}e(J.a!=0),J=0}J=!J}J&&(_=b.a)}else _=b.a}else{if((b=new Pt)==null){Ne=1;break e}if(b.Fa=ge.na,b.P=ge.P,b.qc=ge.Sa,Er(b,J)){if((_=hm(J.width,J.height,Ne.Oa,Ne.ba))==0){if(b.Aa=0,O=Ne.Oa,e((ge=b)!=null),O!=null){if(0<(Te=0>(Te=O.Md)?0:100<Te?255:255*Te/100)){for(Oe=nt=0;4>Oe;++Oe)12>(xt=ge.pb[Oe]).lc&&(xt.ia=Te*jH[0>xt.lc?0:xt.lc]>>3),nt|=xt.ia;nt&&(alert("todo:VP8InitRandom"),ge.ia=1)}ge.Ga=O.Id,100<ge.Ga?ge.Ga=100:0>ge.Ga&&(ge.Ga=0)}ms(b,J)||(_=b.a)}}else _=b.a}_==0&&Ne.Oa!=null&&Ne.Oa.fd&&(_=zp(Ne.ba))}Ne=_}be=Ne!=0?null:11>be?Ee.f.RGBA.eb:Ee.f.kb.y}else be=null;return be};var ST=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function d(w,S){for(var F="",B=0;B<4;B++)F+=String.fromCharCode(w[S++]);return F}function u(w,S){return(w[S+0]<<0|w[S+1]<<8|w[S+2]<<16)>>>0}function A(w,S){return(w[S+0]<<0|w[S+1]<<8|w[S+2]<<16|w[S+3]<<24)>>>0}new c;var h=[0],f=[0],p=[],m=new c,g=t,y=function(w,S){var F={},B=0,k=!1,D=0,q=0;if(F.frames=[],!function(U,V,L,K){for(var fe=0;fe<K;fe++)if(U[V+fe]!=L.charCodeAt(fe))return!0;return!1}(w,S,"RIFF",4)){for(A(w,S+=4),S+=8;S<w.length;){var te=d(w,S),W=A(w,S+=4);S+=4;var Q=W+(1&W);switch(te){case"VP8 ":case"VP8L":F.frames[B]===void 0&&(F.frames[B]={}),(Ae=F.frames[B]).src_off=k?q:S-8,Ae.src_size=D+W+8,B++,k&&(k=!1,D=0,q=0);break;case"VP8X":(Ae=F.header={}).feature_flags=w[S];var re=S+4;Ae.canvas_width=1+u(w,re),re+=3,Ae.canvas_height=1+u(w,re),re+=3;break;case"ALPH":k=!0,D=Q+8,q=S-8;break;case"ANIM":(Ae=F.header).bgcolor=A(w,S),re=S+4,Ae.loop_count=(he=w)[(I=re)+0]<<0|he[I+1]<<8,re+=2;break;case"ANMF":var G,Ae;(Ae=F.frames[B]={}).offset_x=2*u(w,S),S+=3,Ae.offset_y=2*u(w,S),S+=3,Ae.width=1+u(w,S),S+=3,Ae.height=1+u(w,S),S+=3,Ae.duration=u(w,S),S+=3,G=w[S++],Ae.dispose=1&G,Ae.blend=G>>1&1}te!="ANMF"&&(S+=Q)}var he,I;return F}}(g,0);y.response=g,y.rgbaoutput=!0,y.dataurl=!1;var v=y.header?y.header:null,x=y.frames?y.frames:null;if(v){v.loop_counter=v.loop_count,h=[v.canvas_height],f=[v.canvas_width];for(var E=0;E<x.length&&x[E].blend!=0;E++);}var T=x[0],j=m.WebPDecodeRGBA(g,T.src_off,T.src_size,f,h);T.rgba=j,T.imgwidth=f[0],T.imgheight=h[0];for(var C=0;C<f[0]*h[0]*4;C++)p[C]=j[C];return this.width=f,this.height=h,this.data=p,this}(function(t){var e=function(){return typeof lS=="function"},r=function(h,f,p,m){var g=4,y=o;switch(m){case t.image_compression.FAST:g=1,y=i;break;case t.image_compression.MEDIUM:g=6,y=l;break;case t.image_compression.SLOW:g=9,y=c}h=s(h,f,p,y);var v=lS(h,{level:g});return t.__addimage__.arrayBufferToBinaryString(v)},s=function(h,f,p,m){for(var g,y,v,x=h.length/f,E=new Uint8Array(h.length+x),T=u(),j=0;j<x;j+=1){if(v=j*f,g=h.subarray(v,v+f),m)E.set(m(g,p,y),v+j);else{for(var C,w=T.length,S=[];C<w;C+=1)S[C]=T[C](g,p,y);var F=A(S.concat());E.set(S[F],v+j)}y=g}return E},n=function(h){var f=Array.apply([],h);return f.unshift(0),f},i=function(h,f){var p,m=[],g=h.length;m[0]=1;for(var y=0;y<g;y+=1)p=h[y-f]||0,m[y+1]=h[y]-p+256&255;return m},o=function(h,f,p){var m,g=[],y=h.length;g[0]=2;for(var v=0;v<y;v+=1)m=p&&p[v]||0,g[v+1]=h[v]-m+256&255;return g},l=function(h,f,p){var m,g,y=[],v=h.length;y[0]=3;for(var x=0;x<v;x+=1)m=h[x-f]||0,g=p&&p[x]||0,y[x+1]=h[x]+256-(m+g>>>1)&255;return y},c=function(h,f,p){var m,g,y,v,x=[],E=h.length;x[0]=4;for(var T=0;T<E;T+=1)m=h[T-f]||0,g=p&&p[T]||0,y=p&&p[T-f]||0,v=d(m,g,y),x[T+1]=h[T]-v+256&255;return x},d=function(h,f,p){if(h===f&&f===p)return h;var m=Math.abs(f-p),g=Math.abs(h-p),y=Math.abs(h+f-p-p);return m<=g&&m<=y?h:g<=y?f:p},u=function(){return[n,i,o,l,c]},A=function(h){var f=h.map(function(p){return p.reduce(function(m,g){return m+Math.abs(g)},0)});return f.indexOf(Math.min.apply(null,f))};t.processPNG=function(h,f,p,m){var g,y,v,x,E,T,j,C,w,S,F,B,k,D,q,te=this.decode.FLATE_DECODE,W="";if(this.__addimage__.isArrayBuffer(h)&&(h=new Uint8Array(h)),this.__addimage__.isArrayBufferView(h)){if(h=(v=new E0e(h)).imgData,y=v.bits,g=v.colorSpace,E=v.colors,[4,6].indexOf(v.colorType)!==-1){if(v.bits===8){w=(C=v.pixelBitlength==32?new Uint32Array(v.decodePixels().buffer):v.pixelBitlength==16?new Uint16Array(v.decodePixels().buffer):new Uint8Array(v.decodePixels().buffer)).length,F=new Uint8Array(w*v.colors),S=new Uint8Array(w);var Q,re=v.pixelBitlength-v.bits;for(D=0,q=0;D<w;D++){for(k=C[D],Q=0;Q<re;)F[q++]=k>>>Q&255,Q+=v.bits;S[D]=k>>>Q&255}}if(v.bits===16){w=(C=new Uint32Array(v.decodePixels().buffer)).length,F=new Uint8Array(w*(32/v.pixelBitlength)*v.colors),S=new Uint8Array(w*(32/v.pixelBitlength)),B=v.colors>1,D=0,q=0;for(var G=0;D<w;)k=C[D++],F[q++]=k>>>0&255,B&&(F[q++]=k>>>16&255,k=C[D++],F[q++]=k>>>0&255),S[G++]=k>>>16&255;y=8}m!==t.image_compression.NONE&&e()?(h=r(F,v.width*v.colors,v.colors,m),j=r(S,v.width,1,m)):(h=F,j=S,te=void 0)}if(v.colorType===3&&(g=this.color_spaces.INDEXED,T=v.palette,v.transparency.indexed)){var Ae=v.transparency.indexed,he=0;for(D=0,w=Ae.length;D<w;++D)he+=Ae[D];if((he/=255)===w-1&&Ae.indexOf(0)!==-1)x=[Ae.indexOf(0)];else if(he!==w){for(C=v.decodePixels(),S=new Uint8Array(C.length),D=0,w=C.length;D<w;D++)S[D]=Ae[C[D]];j=r(S,v.width,1)}}var I=function(U){var V;switch(U){case t.image_compression.FAST:V=11;break;case t.image_compression.MEDIUM:V=13;break;case t.image_compression.SLOW:V=14;break;default:V=12}return V}(m);return te===this.decode.FLATE_DECODE&&(W="/Predictor "+I+" "),W+="/Colors "+E+" /BitsPerComponent "+y+" /Columns "+v.width,(this.__addimage__.isArrayBuffer(h)||this.__addimage__.isArrayBufferView(h))&&(h=this.__addimage__.arrayBufferToBinaryString(h)),(j&&this.__addimage__.isArrayBuffer(j)||this.__addimage__.isArrayBufferView(j))&&(j=this.__addimage__.arrayBufferToBinaryString(j)),{alias:p,data:h,index:f,filter:te,decodeParameters:W,transparency:x,palette:T,sMask:j,predictor:I,width:v.width,height:v.height,bitsPerComponent:y,colorSpace:g}}}})(wr.API),function(t){t.processGIF89A=function(e,r,s,n){var i=new _0e(e),o=i.width,l=i.height,c=[];i.decodeAndBlitFrameRGBA(0,c);var d={data:c,width:o,height:l},u=new jC(100).encode(d,100);return t.processJPEG.call(this,u,r,s,n)},t.processGIF87A=t.processGIF89A}(wr.API),Xl.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var t=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(t);for(var e=0;e<t;e++){var r=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:n,green:s,blue:r,quad:i}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Xl.prototype.parseBGR=function(){this.pos=this.offset;try{var t="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[t]()}catch(r){Gs.log("bit decode error:"+r)}},Xl.prototype.bit1=function(){var t,e=Math.ceil(this.width/8),r=e%4;for(t=this.height-1;t>=0;t--){for(var s=this.bottom_up?t:this.height-1-t,n=0;n<e;n++)for(var i=this.datav.getUint8(this.pos++,!0),o=s*this.width*4+8*n*4,l=0;l<8&&8*n+l<this.width;l++){var c=this.palette[i>>7-l&1];this.data[o+4*l]=c.blue,this.data[o+4*l+1]=c.green,this.data[o+4*l+2]=c.red,this.data[o+4*l+3]=255}r!==0&&(this.pos+=4-r)}},Xl.prototype.bit4=function(){for(var t=Math.ceil(this.width/2),e=t%4,r=this.height-1;r>=0;r--){for(var s=this.bottom_up?r:this.height-1-r,n=0;n<t;n++){var i=this.datav.getUint8(this.pos++,!0),o=s*this.width*4+2*n*4,l=i>>4,c=15&i,d=this.palette[l];if(this.data[o]=d.blue,this.data[o+1]=d.green,this.data[o+2]=d.red,this.data[o+3]=255,2*n+1>=this.width)break;d=this.palette[c],this.data[o+4]=d.blue,this.data[o+4+1]=d.green,this.data[o+4+2]=d.red,this.data[o+4+3]=255}e!==0&&(this.pos+=4-e)}},Xl.prototype.bit8=function(){for(var t=this.width%4,e=this.height-1;e>=0;e--){for(var r=this.bottom_up?e:this.height-1-e,s=0;s<this.width;s++){var n=this.datav.getUint8(this.pos++,!0),i=r*this.width*4+4*s;if(n<this.palette.length){var o=this.palette[n];this.data[i]=o.red,this.data[i+1]=o.green,this.data[i+2]=o.blue,this.data[i+3]=255}else this.data[i]=255,this.data[i+1]=255,this.data[i+2]=255,this.data[i+3]=255}t!==0&&(this.pos+=4-t)}},Xl.prototype.bit15=function(){for(var t=this.width%3,e=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var s=this.bottom_up?r:this.height-1-r,n=0;n<this.width;n++){var i=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(i&e)/e*255|0,l=(i>>5&e)/e*255|0,c=(i>>10&e)/e*255|0,d=i>>15?255:0,u=s*this.width*4+4*n;this.data[u]=c,this.data[u+1]=l,this.data[u+2]=o,this.data[u+3]=d}this.pos+=t}},Xl.prototype.bit16=function(){for(var t=this.width%3,e=parseInt("11111",2),r=parseInt("111111",2),s=this.height-1;s>=0;s--){for(var n=this.bottom_up?s:this.height-1-s,i=0;i<this.width;i++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(o&e)/e*255|0,c=(o>>5&r)/r*255|0,d=(o>>11)/e*255|0,u=n*this.width*4+4*i;this.data[u]=d,this.data[u+1]=c,this.data[u+2]=l,this.data[u+3]=255}this.pos+=t}},Xl.prototype.bit24=function(){for(var t=this.height-1;t>=0;t--){for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var s=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=e*this.width*4+4*r;this.data[o]=i,this.data[o+1]=n,this.data[o+2]=s,this.data[o+3]=255}this.pos+=this.width%4}},Xl.prototype.bit32=function(){for(var t=this.height-1;t>=0;t--)for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var s=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),l=e*this.width*4+4*r;this.data[l]=i,this.data[l+1]=n,this.data[l+2]=s,this.data[l+3]=o}},Xl.prototype.getData=function(){return this.data},function(t){t.processBMP=function(e,r,s,n){var i=new Xl(e,!1),o=i.width,l=i.height,c={data:i.getData(),width:o,height:l},d=new jC(100).encode(c,100);return t.processJPEG.call(this,d,r,s,n)}}(wr.API),tP.prototype.getData=function(){return this.data},function(t){t.processWEBP=function(e,r,s,n){var i=new tP(e),o=i.width,l=i.height,c={data:i.getData(),width:o,height:l},d=new jC(100).encode(c,100);return t.processJPEG.call(this,d,r,s,n)}}(wr.API),wr.API.processRGBA=function(t,e,r){for(var s=t.data,n=s.length,i=new Uint8Array(n/4*3),o=new Uint8Array(n/4),l=0,c=0,d=0;d<n;d+=4){var u=s[d],A=s[d+1],h=s[d+2],f=s[d+3];i[l++]=u,i[l++]=A,i[l++]=h,o[c++]=f}var p=this.__addimage__.arrayBufferToBinaryString(i);return{alpha:this.__addimage__.arrayBufferToBinaryString(o),data:p,index:e,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:t.width,height:t.height}},wr.API.setLanguage=function(t){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[t]!==void 0&&(this.internal.languageSettings.languageCode=t,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Lm=wr.API,I1=Lm.getCharWidthsArray=function(t,e){var r,s,n=(e=e||{}).font||this.internal.getFont(),i=e.fontSize||this.internal.getFontSize(),o=e.charSpace||this.internal.getCharSpace(),l=e.widths?e.widths:n.metadata.Unicode.widths,c=l.fof?l.fof:1,d=e.kerning?e.kerning:n.metadata.Unicode.kerning,u=d.fof?d.fof:1,A=e.doKerning!==!1,h=0,f=t.length,p=0,m=l[0]||c,g=[];for(r=0;r<f;r++)s=t.charCodeAt(r),typeof n.metadata.widthOfString=="function"?g.push((n.metadata.widthOfGlyph(n.metadata.characterToGlyph(s))+o*(1e3/i)||0)/1e3):(h=A&&Us(d[s])==="object"&&!isNaN(parseInt(d[s][p],10))?d[s][p]/u:0,g.push((l[s]||m)/c+h)),p=s;return g},XF=Lm.getStringUnitWidth=function(t,e){var r=(e=e||{}).fontSize||this.internal.getFontSize(),s=e.font||this.internal.getFont(),n=e.charSpace||this.internal.getCharSpace();return Lm.processArabic&&(t=Lm.processArabic(t)),typeof s.metadata.widthOfString=="function"?s.metadata.widthOfString(t,r,n)/r:I1.apply(this,arguments).reduce(function(i,o){return i+o},0)},JF=function(t,e,r,s){for(var n=[],i=0,o=t.length,l=0;i!==o&&l+e[i]<r;)l+=e[i],i++;n.push(t.slice(0,i));var c=i;for(l=0;i!==o;)l+e[i]>s&&(n.push(t.slice(c,i)),l=0,c=i),l+=e[i],i++;return c!==i&&n.push(t.slice(c,i)),n},ZF=function(t,e,r){r||(r={});var s,n,i,o,l,c,d,u=[],A=[u],h=r.textIndent||0,f=0,p=0,m=t.split(" "),g=I1.apply(this,[" ",r])[0];if(c=r.lineIndent===-1?m[0].length+2:r.lineIndent||0){var y=Array(c).join(" "),v=[];m.map(function(E){(E=E.split(/\s*\n/)).length>1?v=v.concat(E.map(function(T,j){return(j&&T.length?`
`:"")+T})):v.push(E[0])}),m=v,c=XF.apply(this,[y,r])}for(i=0,o=m.length;i<o;i++){var x=0;if(s=m[i],c&&s[0]==`
`&&(s=s.substr(1),x=1),h+f+(p=(n=I1.apply(this,[s,r])).reduce(function(E,T){return E+T},0))>e||x){if(p>e){for(l=JF.apply(this,[s,n,e-(h+f),e]),u.push(l.shift()),u=[l.pop()];l.length;)A.push([l.shift()]);p=n.slice(s.length-(u[0]?u[0].length:0)).reduce(function(E,T){return E+T},0)}else u=[s];A.push(u),h=p+c,f=g}else u.push(s),h+=f+p,f=g}return d=c?function(E,T){return(T?y:"")+E.join(" ")}:function(E){return E.join(" ")},A.map(d)},Lm.splitTextToSize=function(t,e,r){var s,n=(r=r||{}).fontSize||this.internal.getFontSize(),i=(function(u){if(u.widths&&u.kerning)return{widths:u.widths,kerning:u.kerning};var A=this.internal.getFont(u.fontName,u.fontStyle);return A.metadata.Unicode?{widths:A.metadata.Unicode.widths||{0:1},kerning:A.metadata.Unicode.kerning||{}}:{font:A.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);s=Array.isArray(t)?t:String(t).split(/\r?\n/);var o=1*this.internal.scaleFactor*e/n;i.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/n:0,i.lineIndent=r.lineIndent;var l,c,d=[];for(l=0,c=s.length;l<c;l++)d=d.concat(ZF.apply(this,[s[l],o,i]));return d},function(t){t.__fontmetrics__=t.__fontmetrics__||{};for(var e="klmnopqrstuvwxyz",r={},s={},n=0;n<e.length;n++)r[e[n]]="0123456789abcdef"[n],s["0123456789abcdef"[n]]=e[n];var i=function(A){return"0x"+parseInt(A,10).toString(16)},o=t.__fontmetrics__.compress=function(A){var h,f,p,m,g=["{"];for(var y in A){if(h=A[y],isNaN(parseInt(y,10))?f="'"+y+"'":(y=parseInt(y,10),f=(f=i(y).slice(2)).slice(0,-1)+s[f.slice(-1)]),typeof h=="number")h<0?(p=i(h).slice(3),m="-"):(p=i(h).slice(2),m=""),p=m+p.slice(0,-1)+s[p.slice(-1)];else{if(Us(h)!=="object")throw new Error("Don't know what to do with value type "+Us(h)+".");p=o(h)}g.push(f+p)}return g.push("}"),g.join("")},l=t.__fontmetrics__.uncompress=function(A){if(typeof A!="string")throw new Error("Invalid argument passed to uncompress.");for(var h,f,p,m,g={},y=1,v=g,x=[],E="",T="",j=A.length-1,C=1;C<j;C+=1)(m=A[C])=="'"?h?(p=h.join(""),h=void 0):h=[]:h?h.push(m):m=="{"?(x.push([v,p]),v={},p=void 0):m=="}"?((f=x.pop())[0][f[1]]=v,p=void 0,v=f[0]):m=="-"?y=-1:p===void 0?r.hasOwnProperty(m)?(E+=r[m],p=parseInt(E,16)*y,y=1,E=""):E+=m:r.hasOwnProperty(m)?(T+=r[m],v[p]=parseInt(T,16)*y,y=1,p=void 0,T=""):T+=m;return g},c={codePages:["WinAnsiEncoding"],WinAnsiEncoding:l("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},d={Unicode:{Courier:c,"Courier-Bold":c,"Courier-BoldOblique":c,"Courier-Oblique":c,Helvetica:c,"Helvetica-Bold":c,"Helvetica-BoldOblique":c,"Helvetica-Oblique":c,"Times-Roman":c,"Times-Bold":c,"Times-BoldItalic":c,"Times-Italic":c}},u={Unicode:{"Courier-Oblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":l("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":l("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:l("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:l("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":l("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":l("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};t.events.push(["addFont",function(A){var h=A.font,f=u.Unicode[h.postScriptName];f&&(h.metadata.Unicode={},h.metadata.Unicode.widths=f.widths,h.metadata.Unicode.kerning=f.kerning);var p=d.Unicode[h.postScriptName];p&&(h.metadata.Unicode.encoding=p,h.encoding=p.codePages[0])}])}(wr.API),function(t){var e=function(r){for(var s=r.length,n=new Uint8Array(s),i=0;i<s;i++)n[i]=r.charCodeAt(i);return n};t.API.events.push(["addFont",function(r){var s=void 0,n=r.font,i=r.instance;if(!n.isStandardFont){if(i===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+n.postScriptName+"').");if(typeof(s=i.existsFileInVFS(n.postScriptName)===!1?i.loadFile(n.postScriptName):i.getFileFromVFS(n.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+n.postScriptName+"').");(function(o,l){l=/^\x00\x01\x00\x00/.test(l)?e(l):e(jx(l)),o.metadata=t.API.TTFFont.open(l),o.metadata.Unicode=o.metadata.Unicode||{encoding:{},kerning:{},widths:[]},o.metadata.glyIdsUsed=[0]})(n,s)}}])}(wr),function(t){function e(){return(Br.canvg?Promise.resolve(Br.canvg):Pn(()=>import("./index.es-DQamba8P.js"),[])).catch(function(r){return Promise.reject(new Error("Could not load canvg: "+r))}).then(function(r){return r.default?r.default:r})}wr.API.addSvgAsImage=function(r,s,n,i,o,l,c,d){if(isNaN(s)||isNaN(n))throw Gs.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(i)||isNaN(o))throw Gs.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var u=document.createElement("canvas");u.width=i,u.height=o;var A=u.getContext("2d");A.fillStyle="#fff",A.fillRect(0,0,u.width,u.height);var h={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},f=this;return e().then(function(p){return p.fromString(A,r,h)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(p){return p.render(h)}).then(function(){f.addImage(u.toDataURL("image/jpeg",1),s,n,i,o,c,d)})}}(),wr.API.putTotalPages=function(t){var e,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(t,"g"),r=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(t,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var s=1;s<=this.internal.getNumberOfPages();s++)for(var n=0;n<this.internal.pages[s].length;n++)this.internal.pages[s][n]=this.internal.pages[s][n].replace(e,r);return this},wr.API.viewerPreferences=function(t,e){var r;t=t||{},e=e||!1;var s,n,i,o={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},l=Object.keys(o),c=[],d=0,u=0,A=0;function h(p,m){var g,y=!1;for(g=0;g<p.length;g+=1)p[g]===m&&(y=!0);return y}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(o)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,t==="reset"||e===!0){var f=l.length;for(A=0;A<f;A+=1)r[l[A]].value=r[l[A]].defaultValue,r[l[A]].explicitSet=!1}if(Us(t)==="object"){for(n in t)if(i=t[n],h(l,n)&&i!==void 0){if(r[n].type==="boolean"&&typeof i=="boolean")r[n].value=i;else if(r[n].type==="name"&&h(r[n].valueSet,i))r[n].value=i;else if(r[n].type==="integer"&&Number.isInteger(i))r[n].value=i;else if(r[n].type==="array"){for(d=0;d<i.length;d+=1)if(s=!0,i[d].length===1&&typeof i[d][0]=="number")c.push(String(i[d]-1));else if(i[d].length>1){for(u=0;u<i[d].length;u+=1)typeof i[d][u]!="number"&&(s=!1);s===!0&&c.push([i[d][0]-1,i[d][1]-1].join(" "))}r[n].value="["+c.join(" ")+"]"}else r[n].value=r[n].defaultValue;r[n].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var p,m=[];for(p in r)r[p].explicitSet===!0&&(r[p].type==="name"?m.push("/"+p+" /"+r[p].value):m.push("/"+p+" "+r[p].value));m.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+m.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},function(t){var e=function(){var s='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',n=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),i=unescape(encodeURIComponent(s)),o=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),l=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),c=unescape(encodeURIComponent("</x:xmpmeta>")),d=i.length+o.length+l.length+n.length+c.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+d+" >>"),this.internal.write("stream"),this.internal.write(n+i+o+l+c),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};t.addMetadata=function(s,n){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:s,namespaceuri:n||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",e)),this}}(wr.API),function(t){var e=t.API,r=e.pdfEscape16=function(i,o){for(var l,c=o.metadata.Unicode.widths,d=["","0","00","000","0000"],u=[""],A=0,h=i.length;A<h;++A){if(l=o.metadata.characterToGlyph(i.charCodeAt(A)),o.metadata.glyIdsUsed.push(l),o.metadata.toUnicode[l]=i.charCodeAt(A),c.indexOf(l)==-1&&(c.push(l),c.push([parseInt(o.metadata.widthOfGlyph(l),10)])),l=="0")return u.join("");l=l.toString(16),u.push(d[4-l.length],l)}return u.join("")},s=function(i){var o,l,c,d,u,A,h;for(u=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],A=0,h=(l=Object.keys(i).sort(function(f,p){return f-p})).length;A<h;A++)o=l[A],c.length>=100&&(u+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),i[o]!==void 0&&i[o]!==null&&typeof i[o].toString=="function"&&(d=("0000"+i[o].toString(16)).slice(-4),o=("0000"+(+o).toString(16)).slice(-4),c.push("<"+o+"><"+d+">"));return c.length&&(u+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),u+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(i){(function(o){var l=o.font,c=o.out,d=o.newObject,u=o.putStream;if(l.metadata instanceof t.API.TTFFont&&l.encoding==="Identity-H"){for(var A=l.metadata.Unicode.widths,h=l.metadata.subset.encode(l.metadata.glyIdsUsed,1),f="",p=0;p<h.length;p++)f+=String.fromCharCode(h[p]);var m=d();u({data:f,addLength1:!0,objectId:m}),c("endobj");var g=d();u({data:s(l.metadata.toUnicode),addLength1:!0,objectId:g}),c("endobj");var y=d();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+t0(l.fontName)),c("/FontFile2 "+m+" 0 R"),c("/FontBBox "+t.API.PDFObject.convert(l.metadata.bbox)),c("/Flags "+l.metadata.flags),c("/StemV "+l.metadata.stemV),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c(">>"),c("endobj");var v=d();c("<<"),c("/Type /Font"),c("/BaseFont /"+t0(l.fontName)),c("/FontDescriptor "+y+" 0 R"),c("/W "+t.API.PDFObject.convert(A)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+l.encoding+")"),c(">>"),c(">>"),c("endobj"),l.objectNumber=d(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+g+" 0 R"),c("/BaseFont /"+t0(l.fontName)),c("/Encoding /"+l.encoding),c("/DescendantFonts ["+v+" 0 R]"),c(">>"),c("endobj"),l.isAlreadyPutted=!0}})(i)}]),e.events.push(["putFont",function(i){(function(o){var l=o.font,c=o.out,d=o.newObject,u=o.putStream;if(l.metadata instanceof t.API.TTFFont&&l.encoding==="WinAnsiEncoding"){for(var A=l.metadata.rawData,h="",f=0;f<A.length;f++)h+=String.fromCharCode(A[f]);var p=d();u({data:h,addLength1:!0,objectId:p}),c("endobj");var m=d();u({data:s(l.metadata.toUnicode),addLength1:!0,objectId:m}),c("endobj");var g=d();c("<<"),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c("/StemV "+l.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+p+" 0 R"),c("/Flags 96"),c("/FontBBox "+t.API.PDFObject.convert(l.metadata.bbox)),c("/FontName /"+t0(l.fontName)),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c(">>"),c("endobj"),l.objectNumber=d();for(var y=0;y<l.metadata.hmtx.widths.length;y++)l.metadata.hmtx.widths[y]=parseInt(l.metadata.hmtx.widths[y]*(1e3/l.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+m+" 0 R/BaseFont/"+t0(l.fontName)+"/FontDescriptor "+g+" 0 R/Encoding/"+l.encoding+" /FirstChar 29 /LastChar 255 /Widths "+t.API.PDFObject.convert(l.metadata.hmtx.widths)+">>"),c("endobj"),l.isAlreadyPutted=!0}})(i)}]);var n=function(i){var o,l=i.text||"",c=i.x,d=i.y,u=i.options||{},A=i.mutex||{},h=A.pdfEscape,f=A.activeFontKey,p=A.fonts,m=f,g="",y=0,v="",x=p[m].encoding;if(p[m].encoding!=="Identity-H")return{text:l,x:c,y:d,options:u,mutex:A};for(v=l,m=f,Array.isArray(l)&&(v=l[0]),y=0;y<v.length;y+=1)p[m].metadata.hasOwnProperty("cmap")&&(o=p[m].metadata.cmap.unicode.codeMap[v[y].charCodeAt(0)]),o||v[y].charCodeAt(0)<256&&p[m].metadata.hasOwnProperty("Unicode")?g+=v[y]:g+="";var E="";return parseInt(m.slice(1))<14||x==="WinAnsiEncoding"?E=h(g,m).split("").map(function(T){return T.charCodeAt(0).toString(16)}).join(""):x==="Identity-H"&&(E=r(g,p[m])),A.isHex=!0,{text:E,x:c,y:d,options:u,mutex:A}};e.events.push(["postProcessText",function(i){var o=i.text||"",l=[],c={text:o,x:i.x,y:i.y,options:i.options,mutex:i.mutex};if(Array.isArray(o)){var d=0;for(d=0;d<o.length;d+=1)Array.isArray(o[d])&&o[d].length===3?l.push([n(Object.assign({},c,{text:o[d][0]})).text,o[d][1],o[d][2]]):l.push(n(Object.assign({},c,{text:o[d]})).text);i.text=l}else i.text=n(Object.assign({},c,{text:o})).text}])}(wr),function(t){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};t.existsFileInVFS=function(r){return e.call(this),this.internal.vFS[r]!==void 0},t.addFileToVFS=function(r,s){return e.call(this),this.internal.vFS[r]=s,this},t.getFileFromVFS=function(r){return e.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}}(wr.API),function(t){t.__bidiEngine__=t.prototype.__bidiEngine__=function(s){var n,i,o,l,c,d,u,A=e,h=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],f=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],p={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},m={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},g=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],y=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),v=!1,x=0;this.__bidiEngine__={};var E=function(B){var k=B.charCodeAt(),D=k>>8,q=m[D];return q!==void 0?A[256*q+(255&k)]:D===252||D===253?"AL":y.test(D)?"L":D===8?"R":"N"},T=function(B){for(var k,D=0;D<B.length;D++){if((k=E(B.charAt(D)))==="L")return!1;if(k==="R")return!0}return!1},j=function(B,k,D,q){var te,W,Q,re,G=k[q];switch(G){case"L":case"R":v=!1;break;case"N":case"AN":break;case"EN":v&&(G="AN");break;case"AL":v=!0,G="R";break;case"WS":G="N";break;case"CS":q<1||q+1>=k.length||(te=D[q-1])!=="EN"&&te!=="AN"||(W=k[q+1])!=="EN"&&W!=="AN"?G="N":v&&(W="AN"),G=W===te?W:"N";break;case"ES":G=(te=q>0?D[q-1]:"B")==="EN"&&q+1<k.length&&k[q+1]==="EN"?"EN":"N";break;case"ET":if(q>0&&D[q-1]==="EN"){G="EN";break}if(v){G="N";break}for(Q=q+1,re=k.length;Q<re&&k[Q]==="ET";)Q++;G=Q<re&&k[Q]==="EN"?"EN":"N";break;case"NSM":if(o&&!l){for(re=k.length,Q=q+1;Q<re&&k[Q]==="NSM";)Q++;if(Q<re){var Ae=B[q],he=Ae>=1425&&Ae<=2303||Ae===64286;if(te=k[Q],he&&(te==="R"||te==="AL")){G="R";break}}}G=q<1||(te=k[q-1])==="B"?"N":D[q-1];break;case"B":v=!1,n=!0,G=x;break;case"S":i=!0,G="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":v=!1;break;case"BN":G="N"}return G},C=function(B,k,D){var q=B.split("");return D&&w(q,D,{hiLevel:x}),q.reverse(),k&&k.reverse(),q.join("")},w=function(B,k,D){var q,te,W,Q,re,G=-1,Ae=B.length,he=0,I=[],U=x?f:h,V=[];for(v=!1,n=!1,i=!1,te=0;te<Ae;te++)V[te]=E(B[te]);for(W=0;W<Ae;W++){if(re=he,I[W]=j(B,V,I,W),q=240&(he=U[re][p[I[W]]]),he&=15,k[W]=Q=U[he][5],q>0)if(q===16){for(te=G;te<W;te++)k[te]=1;G=-1}else G=-1;if(U[he][6])G===-1&&(G=W);else if(G>-1){for(te=G;te<W;te++)k[te]=Q;G=-1}V[W]==="B"&&(k[W]=0),D.hiLevel|=Q}i&&function(L,K,fe){for(var ee=0;ee<fe;ee++)if(L[ee]==="S"){K[ee]=x;for(var de=ee-1;de>=0&&L[de]==="WS";de--)K[de]=x}}(V,k,Ae)},S=function(B,k,D,q,te){if(!(te.hiLevel<B)){if(B===1&&x===1&&!n)return k.reverse(),void(D&&D.reverse());for(var W,Q,re,G,Ae=k.length,he=0;he<Ae;){if(q[he]>=B){for(re=he+1;re<Ae&&q[re]>=B;)re++;for(G=he,Q=re-1;G<Q;G++,Q--)W=k[G],k[G]=k[Q],k[Q]=W,D&&(W=D[G],D[G]=D[Q],D[Q]=W);he=re}he++}}},F=function(B,k,D){var q=B.split(""),te={hiLevel:x};return D||(D=[]),w(q,D,te),function(W,Q,re){if(re.hiLevel!==0&&u)for(var G,Ae=0;Ae<W.length;Ae++)Q[Ae]===1&&(G=g.indexOf(W[Ae]))>=0&&(W[Ae]=g[G+1])}(q,D,te),S(2,q,k,D,te),S(1,q,k,D,te),q.join("")};return this.__bidiEngine__.doBidiReorder=function(B,k,D){if(function(te,W){if(W)for(var Q=0;Q<te.length;Q++)W[Q]=Q;l===void 0&&(l=T(te)),d===void 0&&(d=T(te))}(B,k),o||!c||d)if(o&&c&&l^d)x=l?1:0,B=C(B,k,D);else if(!o&&c&&d)x=l?1:0,B=F(B,k,D),B=C(B,k);else if(!o||l||c||d){if(o&&!c&&l^d)B=C(B,k),l?(x=0,B=F(B,k,D)):(x=1,B=F(B,k,D),B=C(B,k));else if(o&&l&&!c&&d)x=1,B=F(B,k,D),B=C(B,k);else if(!o&&!c&&l^d){var q=u;l?(x=1,B=F(B,k,D),x=0,u=!1,B=F(B,k,D),u=q):(x=0,B=F(B,k,D),B=C(B,k),x=1,u=!1,B=F(B,k,D),u=q,B=C(B,k))}}else x=0,B=F(B,k,D);else x=l?1:0,B=F(B,k,D);return B},this.__bidiEngine__.setOptions=function(B){B&&(o=B.isInputVisual,c=B.isOutputVisual,l=B.isInputRtl,d=B.isOutputRtl,u=B.isSymmetricSwapping)},this.__bidiEngine__.setOptions(s),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new t.__bidiEngine__({isInputVisual:!0});t.API.events.push(["postProcessText",function(s){var n=s.text;s.x,s.y;var i=s.options||{};s.mutex,i.lang;var o=[];if(i.isInputVisual=typeof i.isInputVisual!="boolean"||i.isInputVisual,r.setOptions(i),Object.prototype.toString.call(n)==="[object Array]"){var l=0;for(o=[],l=0;l<n.length;l+=1)Object.prototype.toString.call(n[l])==="[object Array]"?o.push([r.doBidiReorder(n[l][0]),n[l][1],n[l][2]]):o.push([r.doBidiReorder(n[l])]);s.text=o}else s.text=r.doBidiReorder(n);r.setOptions({isInputVisual:!0})}])}(wr),wr.API.TTFFont=function(){function t(e){var r;if(this.rawData=e,r=this.contents=new sh(e),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new H0e(this),this.registerTTF()}return t.open=function(e){return new t(e)},t.prototype.parse=function(){return this.directory=new T0e(this.contents),this.head=new k0e(this),this.name=new R0e(this),this.cmap=new bQ(this),this.toUnicode={},this.hhea=new B0e(this),this.maxp=new L0e(this),this.hmtx=new O0e(this),this.post=new P0e(this),this.os2=new F0e(this),this.loca=new V0e(this),this.glyf=new U0e(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},t.prototype.registerTTF=function(){var e,r,s,n,i;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var o,l,c,d;for(d=[],o=0,l=(c=this.bbox).length;o<l;o++)e=c[o],d.push(Math.round(e*this.scaleFactor));return d}).call(this),this.stemV=0,this.post.exists?(s=255&(n=this.post.italic_angle),32768&(r=n>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+s)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(i=this.familyClass)===1||i===2||i===3||i===4||i===5||i===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},t.prototype.characterToGlyph=function(e){var r;return((r=this.cmap.unicode)!=null?r.codeMap[e]:void 0)||0},t.prototype.widthOfGlyph=function(e){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*r},t.prototype.widthOfString=function(e,r,s){var n,i,o,l;for(o=0,i=0,l=(e=""+e).length;0<=l?i<l:i>l;i=0<=l?++i:--i)n=e.charCodeAt(i),o+=this.widthOfGlyph(this.characterToGlyph(n))+s*(1e3/r)||0;return o*(r/1e3)},t.prototype.lineHeight=function(e,r){var s;return r==null&&(r=!1),s=r?this.lineGap:0,(this.ascender+s-this.decender)/1e3*e},t}();var yc,sh=function(){function t(e){this.data=e??[],this.pos=0,this.length=this.data.length}return t.prototype.readByte=function(){return this.data[this.pos++]},t.prototype.writeByte=function(e){return this.data[this.pos++]=e},t.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},t.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},t.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},t.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},t.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},t.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},t.prototype.readString=function(e){var r,s;for(s=[],r=0;0<=e?r<e:r>e;r=0<=e?++r:--r)s[r]=String.fromCharCode(this.readByte());return s.join("")},t.prototype.writeString=function(e){var r,s,n;for(n=[],r=0,s=e.length;0<=s?r<s:r>s;r=0<=s?++r:--r)n.push(this.writeByte(e.charCodeAt(r)));return n},t.prototype.readShort=function(){return this.readInt16()},t.prototype.writeShort=function(e){return this.writeInt16(e)},t.prototype.readLongLong=function(){var e,r,s,n,i,o,l,c;return e=this.readByte(),r=this.readByte(),s=this.readByte(),n=this.readByte(),i=this.readByte(),o=this.readByte(),l=this.readByte(),c=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^r)+1099511627776*(255^s)+4294967296*(255^n)+16777216*(255^i)+65536*(255^o)+256*(255^l)+(255^c)+1):72057594037927940*e+281474976710656*r+1099511627776*s+4294967296*n+16777216*i+65536*o+256*l+c},t.prototype.writeLongLong=function(e){var r,s;return r=Math.floor(e/4294967296),s=4294967295&e,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(s>>24&255),this.writeByte(s>>16&255),this.writeByte(s>>8&255),this.writeByte(255&s)},t.prototype.readInt=function(){return this.readInt32()},t.prototype.writeInt=function(e){return this.writeInt32(e)},t.prototype.read=function(e){var r,s;for(r=[],s=0;0<=e?s<e:s>e;s=0<=e?++s:--s)r.push(this.readByte());return r},t.prototype.write=function(e){var r,s,n,i;for(i=[],s=0,n=e.length;s<n;s++)r=e[s],i.push(this.writeByte(r));return i},t}(),T0e=function(){var t;function e(r){var s,n,i;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},n=0,i=this.tableCount;0<=i?n<i:n>i;n=0<=i?++n:--n)s={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[s.tag]=s}return e.prototype.encode=function(r){var s,n,i,o,l,c,d,u,A,h,f,p,m;for(m in f=Object.keys(r).length,c=Math.log(2),A=16*Math.floor(Math.log(f)/c),o=Math.floor(A/c),u=16*f-A,(n=new sh).writeInt(this.scalarType),n.writeShort(f),n.writeShort(A),n.writeShort(o),n.writeShort(u),i=16*f,d=n.pos+i,l=null,p=[],r)for(h=r[m],n.writeString(m),n.writeInt(t(h)),n.writeInt(d),n.writeInt(h.length),p=p.concat(h),m==="head"&&(l=d),d+=h.length;d%4;)p.push(0),d++;return n.write(p),s=2981146554-t(n.data),n.pos=l+8,n.writeUInt32(s),n.data},t=function(r){var s,n,i,o;for(r=wQ.call(r);r.length%4;)r.push(0);for(i=new sh(r),n=0,s=0,o=r.length;s<o;s=s+=4)n+=i.readUInt32();return 4294967295&n},e}(),I0e={}.hasOwnProperty,ld=function(t,e){for(var r in e)I0e.call(e,r)&&(t[r]=e[r]);function s(){this.constructor=t}return s.prototype=e.prototype,t.prototype=new s,t.__super__=e.prototype,t};yc=function(){function t(e){var r;this.file=e,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return t.prototype.parse=function(){},t.prototype.encode=function(){},t.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},t}();var k0e=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return ld(e,yc),e.prototype.tag="head",e.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.revision=r.readInt(),this.checkSumAdjustment=r.readInt(),this.magicNumber=r.readInt(),this.flags=r.readShort(),this.unitsPerEm=r.readShort(),this.created=r.readLongLong(),this.modified=r.readLongLong(),this.xMin=r.readShort(),this.yMin=r.readShort(),this.xMax=r.readShort(),this.yMax=r.readShort(),this.macStyle=r.readShort(),this.lowestRecPPEM=r.readShort(),this.fontDirectionHint=r.readShort(),this.indexToLocFormat=r.readShort(),this.glyphDataFormat=r.readShort()},e.prototype.encode=function(r){var s;return(s=new sh).writeInt(this.version),s.writeInt(this.revision),s.writeInt(this.checkSumAdjustment),s.writeInt(this.magicNumber),s.writeShort(this.flags),s.writeShort(this.unitsPerEm),s.writeLongLong(this.created),s.writeLongLong(this.modified),s.writeShort(this.xMin),s.writeShort(this.yMin),s.writeShort(this.xMax),s.writeShort(this.yMax),s.writeShort(this.macStyle),s.writeShort(this.lowestRecPPEM),s.writeShort(this.fontDirectionHint),s.writeShort(r),s.writeShort(this.glyphDataFormat),s.data},e}(),rP=function(){function t(e,r){var s,n,i,o,l,c,d,u,A,h,f,p,m,g,y,v,x;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=r+e.readInt(),A=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=e.readByte();break;case 4:for(f=e.readUInt16(),h=f/2,e.pos+=6,i=function(){var E,T;for(T=[],c=E=0;0<=h?E<h:E>h;c=0<=h?++E:--E)T.push(e.readUInt16());return T}(),e.pos+=2,m=function(){var E,T;for(T=[],c=E=0;0<=h?E<h:E>h;c=0<=h?++E:--E)T.push(e.readUInt16());return T}(),d=function(){var E,T;for(T=[],c=E=0;0<=h?E<h:E>h;c=0<=h?++E:--E)T.push(e.readUInt16());return T}(),u=function(){var E,T;for(T=[],c=E=0;0<=h?E<h:E>h;c=0<=h?++E:--E)T.push(e.readUInt16());return T}(),n=(this.length-e.pos+this.offset)/2,l=function(){var E,T;for(T=[],c=E=0;0<=n?E<n:E>n;c=0<=n?++E:--E)T.push(e.readUInt16());return T}(),c=y=0,x=i.length;y<x;c=++y)for(g=i[c],s=v=p=m[c];p<=g?v<=g:v>=g;s=p<=g?++v:--v)u[c]===0?o=s+d[c]:(o=l[u[c]/2+(s-p)-(h-c)]||0)!==0&&(o+=d[c]),this.codeMap[s]=65535&o}e.pos=A}return t.encode=function(e,r){var s,n,i,o,l,c,d,u,A,h,f,p,m,g,y,v,x,E,T,j,C,w,S,F,B,k,D,q,te,W,Q,re,G,Ae,he,I,U,V,L,K,fe,ee,de,ue,Ie,Y;switch(q=new sh,o=Object.keys(e).sort(function(H,je){return H-je}),r){case"macroman":for(m=0,g=function(){var H=[];for(p=0;p<256;++p)H.push(0);return H}(),v={0:0},i={},te=0,G=o.length;te<G;te++)v[de=e[n=o[te]]]==null&&(v[de]=++m),i[n]={old:e[n],new:v[e[n]]},g[n]=v[e[n]];return q.writeUInt16(1),q.writeUInt16(0),q.writeUInt32(12),q.writeUInt16(0),q.writeUInt16(262),q.writeUInt16(0),q.write(g),{charMap:i,subtable:q.data,maxGlyphID:m+1};case"unicode":for(k=[],A=[],x=0,v={},s={},y=d=null,W=0,Ae=o.length;W<Ae;W++)v[T=e[n=o[W]]]==null&&(v[T]=++x),s[n]={old:T,new:v[T]},l=v[T]-n,y!=null&&l===d||(y&&A.push(y),k.push(n),d=l),y=n;for(y&&A.push(y),A.push(65535),k.push(65535),F=2*(S=k.length),w=2*Math.pow(Math.log(S)/Math.LN2,2),h=Math.log(w/2)/Math.LN2,C=2*S-w,c=[],j=[],f=[],p=Q=0,he=k.length;Q<he;p=++Q){if(B=k[p],u=A[p],B===65535){c.push(0),j.push(0);break}if(B-(D=s[B].new)>=32768)for(c.push(0),j.push(2*(f.length+S-p)),n=re=B;B<=u?re<=u:re>=u;n=B<=u?++re:--re)f.push(s[n].new);else c.push(D-B),j.push(0)}for(q.writeUInt16(3),q.writeUInt16(1),q.writeUInt32(12),q.writeUInt16(4),q.writeUInt16(16+8*S+2*f.length),q.writeUInt16(0),q.writeUInt16(F),q.writeUInt16(w),q.writeUInt16(h),q.writeUInt16(C),fe=0,I=A.length;fe<I;fe++)n=A[fe],q.writeUInt16(n);for(q.writeUInt16(0),ee=0,U=k.length;ee<U;ee++)n=k[ee],q.writeUInt16(n);for(ue=0,V=c.length;ue<V;ue++)l=c[ue],q.writeUInt16(l);for(Ie=0,L=j.length;Ie<L;Ie++)E=j[Ie],q.writeUInt16(E);for(Y=0,K=f.length;Y<K;Y++)m=f[Y],q.writeUInt16(m);return{charMap:s,subtable:q.data,maxGlyphID:x+1}}},t}(),bQ=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return ld(e,yc),e.prototype.tag="cmap",e.prototype.parse=function(r){var s,n,i;for(r.pos=this.offset,this.version=r.readUInt16(),i=r.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=i?n<i:n>i;n=0<=i?++n:--n)s=new rP(r,this.offset),this.tables.push(s),s.isUnicode&&this.unicode==null&&(this.unicode=s);return!0},e.encode=function(r,s){var n,i;return s==null&&(s="macroman"),n=rP.encode(r,s),(i=new sh).writeUInt16(0),i.writeUInt16(1),n.table=i.data.concat(n.subtable),n},e}(),B0e=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return ld(e,yc),e.prototype.tag="hhea",e.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.ascender=r.readShort(),this.decender=r.readShort(),this.lineGap=r.readShort(),this.advanceWidthMax=r.readShort(),this.minLeftSideBearing=r.readShort(),this.minRightSideBearing=r.readShort(),this.xMaxExtent=r.readShort(),this.caretSlopeRise=r.readShort(),this.caretSlopeRun=r.readShort(),this.caretOffset=r.readShort(),r.pos+=8,this.metricDataFormat=r.readShort(),this.numberOfMetrics=r.readUInt16()},e}(),F0e=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return ld(e,yc),e.prototype.tag="OS/2",e.prototype.parse=function(r){if(r.pos=this.offset,this.version=r.readUInt16(),this.averageCharWidth=r.readShort(),this.weightClass=r.readUInt16(),this.widthClass=r.readUInt16(),this.type=r.readShort(),this.ySubscriptXSize=r.readShort(),this.ySubscriptYSize=r.readShort(),this.ySubscriptXOffset=r.readShort(),this.ySubscriptYOffset=r.readShort(),this.ySuperscriptXSize=r.readShort(),this.ySuperscriptYSize=r.readShort(),this.ySuperscriptXOffset=r.readShort(),this.ySuperscriptYOffset=r.readShort(),this.yStrikeoutSize=r.readShort(),this.yStrikeoutPosition=r.readShort(),this.familyClass=r.readShort(),this.panose=function(){var s,n;for(n=[],s=0;s<10;++s)n.push(r.readByte());return n}(),this.charRange=function(){var s,n;for(n=[],s=0;s<4;++s)n.push(r.readInt());return n}(),this.vendorID=r.readString(4),this.selection=r.readShort(),this.firstCharIndex=r.readShort(),this.lastCharIndex=r.readShort(),this.version>0&&(this.ascent=r.readShort(),this.descent=r.readShort(),this.lineGap=r.readShort(),this.winAscent=r.readShort(),this.winDescent=r.readShort(),this.codePageRange=function(){var s,n;for(n=[],s=0;s<2;s=++s)n.push(r.readInt());return n}(),this.version>1))return this.xHeight=r.readShort(),this.capHeight=r.readShort(),this.defaultChar=r.readShort(),this.breakChar=r.readShort(),this.maxContext=r.readShort()},e}(),P0e=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return ld(e,yc),e.prototype.tag="post",e.prototype.parse=function(r){var s,n,i;switch(r.pos=this.offset,this.format=r.readInt(),this.italicAngle=r.readInt(),this.underlinePosition=r.readShort(),this.underlineThickness=r.readShort(),this.isFixedPitch=r.readInt(),this.minMemType42=r.readInt(),this.maxMemType42=r.readInt(),this.minMemType1=r.readInt(),this.maxMemType1=r.readInt(),this.format){case 65536:break;case 131072:var o;for(n=r.readUInt16(),this.glyphNameIndex=[],o=0;0<=n?o<n:o>n;o=0<=n?++o:--o)this.glyphNameIndex.push(r.readUInt16());for(this.names=[],i=[];r.pos<this.offset+this.length;)s=r.readByte(),i.push(this.names.push(r.readString(s)));return i;case 151552:return n=r.readUInt16(),this.offsets=r.read(n);case 196608:break;case 262144:return this.map=(function(){var l,c,d;for(d=[],o=l=0,c=this.file.maxp.numGlyphs;0<=c?l<c:l>c;o=0<=c?++l:--l)d.push(r.readUInt32());return d}).call(this)}},e}(),D0e=function(t,e){this.raw=t,this.length=t.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},R0e=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return ld(e,yc),e.prototype.tag="name",e.prototype.parse=function(r){var s,n,i,o,l,c,d,u,A,h,f;for(r.pos=this.offset,r.readShort(),s=r.readShort(),c=r.readShort(),n=[],o=0;0<=s?o<s:o>s;o=0<=s?++o:--o)n.push({platformID:r.readShort(),encodingID:r.readShort(),languageID:r.readShort(),nameID:r.readShort(),length:r.readShort(),offset:this.offset+c+r.readShort()});for(d={},o=A=0,h=n.length;A<h;o=++A)i=n[o],r.pos=i.offset,u=r.readString(i.length),l=new D0e(u,i),d[f=i.nameID]==null&&(d[f]=[]),d[i.nameID].push(l);this.strings=d,this.copyright=d[0],this.fontFamily=d[1],this.fontSubfamily=d[2],this.uniqueSubfamily=d[3],this.fontName=d[4],this.version=d[5];try{this.postscriptName=d[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=d[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=d[7],this.manufacturer=d[8],this.designer=d[9],this.description=d[10],this.vendorUrl=d[11],this.designerUrl=d[12],this.license=d[13],this.licenseUrl=d[14],this.preferredFamily=d[15],this.preferredSubfamily=d[17],this.compatibleFull=d[18],this.sampleText=d[19]},e}(),L0e=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return ld(e,yc),e.prototype.tag="maxp",e.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.numGlyphs=r.readUInt16(),this.maxPoints=r.readUInt16(),this.maxContours=r.readUInt16(),this.maxCompositePoints=r.readUInt16(),this.maxComponentContours=r.readUInt16(),this.maxZones=r.readUInt16(),this.maxTwilightPoints=r.readUInt16(),this.maxStorage=r.readUInt16(),this.maxFunctionDefs=r.readUInt16(),this.maxInstructionDefs=r.readUInt16(),this.maxStackElements=r.readUInt16(),this.maxSizeOfInstructions=r.readUInt16(),this.maxComponentElements=r.readUInt16(),this.maxComponentDepth=r.readUInt16()},e}(),O0e=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return ld(e,yc),e.prototype.tag="hmtx",e.prototype.parse=function(r){var s,n,i,o,l,c,d;for(r.pos=this.offset,this.metrics=[],s=0,c=this.file.hhea.numberOfMetrics;0<=c?s<c:s>c;s=0<=c?++s:--s)this.metrics.push({advance:r.readUInt16(),lsb:r.readInt16()});for(i=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var u,A;for(A=[],s=u=0;0<=i?u<i:u>i;s=0<=i?++u:--u)A.push(r.readInt16());return A}(),this.widths=(function(){var u,A,h,f;for(f=[],u=0,A=(h=this.metrics).length;u<A;u++)o=h[u],f.push(o.advance);return f}).call(this),n=this.widths[this.widths.length-1],d=[],s=l=0;0<=i?l<i:l>i;s=0<=i?++l:--l)d.push(this.widths.push(n));return d},e.prototype.forGlyph=function(r){return r in this.metrics?this.metrics[r]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[r-this.metrics.length]}},e}(),wQ=[].slice,U0e=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return ld(e,yc),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(r){var s,n,i,o,l,c,d,u,A,h;return r in this.cache?this.cache[r]:(o=this.file.loca,s=this.file.contents,n=o.indexOf(r),(i=o.lengthOf(r))===0?this.cache[r]=null:(s.pos=this.offset+n,l=(c=new sh(s.read(i))).readShort(),u=c.readShort(),h=c.readShort(),d=c.readShort(),A=c.readShort(),this.cache[r]=l===-1?new Q0e(c,u,h,d,A):new M0e(c,l,u,h,d,A),this.cache[r]))},e.prototype.encode=function(r,s,n){var i,o,l,c,d;for(l=[],o=[],c=0,d=s.length;c<d;c++)i=r[s[c]],o.push(l.length),i&&(l=l.concat(i.encode(n)));return o.push(l.length),{table:l,offsets:o}},e}(),M0e=function(){function t(e,r,s,n,i,o){this.raw=e,this.numberOfContours=r,this.xMin=s,this.yMin=n,this.xMax=i,this.yMax=o,this.compound=!1}return t.prototype.encode=function(){return this.raw.data},t}(),Q0e=function(){function t(e,r,s,n,i){var o,l;for(this.raw=e,this.xMin=r,this.yMin=s,this.xMax=n,this.yMax=i,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],o=this.raw;l=o.readShort(),this.glyphOffsets.push(o.pos),this.glyphIDs.push(o.readUInt16()),32&l;)o.pos+=1&l?4:2,128&l?o.pos+=8:64&l?o.pos+=4:8&l&&(o.pos+=2)}return t.prototype.encode=function(){var e,r,s;for(r=new sh(wQ.call(this.raw.data)),e=0,s=this.glyphIDs.length;e<s;++e)r.pos=this.glyphOffsets[e];return r.data},t}(),V0e=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return ld(e,yc),e.prototype.tag="loca",e.prototype.parse=function(r){var s,n;return r.pos=this.offset,s=this.file.head.indexToLocFormat,this.offsets=s===0?(function(){var i,o;for(o=[],n=0,i=this.length;n<i;n+=2)o.push(2*r.readUInt16());return o}).call(this):(function(){var i,o;for(o=[],n=0,i=this.length;n<i;n+=4)o.push(r.readUInt32());return o}).call(this)},e.prototype.indexOf=function(r){return this.offsets[r]},e.prototype.lengthOf=function(r){return this.offsets[r+1]-this.offsets[r]},e.prototype.encode=function(r,s){for(var n=new Uint32Array(this.offsets.length),i=0,o=0,l=0;l<n.length;++l)if(n[l]=i,o<s.length&&s[o]==l){++o,n[l]=i;var c=this.offsets[l],d=this.offsets[l+1]-c;d>0&&(i+=d)}for(var u=new Array(4*n.length),A=0;A<n.length;++A)u[4*A+3]=255&n[A],u[4*A+2]=(65280&n[A])>>8,u[4*A+1]=(16711680&n[A])>>16,u[4*A]=(4278190080&n[A])>>24;return u},e}(),H0e=function(){function t(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return t.prototype.generateCmap=function(){var e,r,s,n,i;for(r in n=this.font.cmap.tables[0].codeMap,e={},i=this.subset)s=i[r],e[r]=n[s];return e},t.prototype.glyphsFor=function(e){var r,s,n,i,o,l,c;for(n={},o=0,l=e.length;o<l;o++)n[i=e[o]]=this.font.glyf.glyphFor(i);for(i in r=[],n)(s=n[i])!=null&&s.compound&&r.push.apply(r,s.glyphIDs);if(r.length>0)for(i in c=this.glyphsFor(r))s=c[i],n[i]=s;return n},t.prototype.encode=function(e,r){var s,n,i,o,l,c,d,u,A,h,f,p,m,g,y;for(n in s=bQ.encode(this.generateCmap(),"unicode"),o=this.glyphsFor(e),f={0:0},y=s.charMap)f[(c=y[n]).old]=c.new;for(p in h=s.maxGlyphID,o)p in f||(f[p]=h++);return u=function(v){var x,E;for(x in E={},v)E[v[x]]=x;return E}(f),A=Object.keys(u).sort(function(v,x){return v-x}),m=function(){var v,x,E;for(E=[],v=0,x=A.length;v<x;v++)l=A[v],E.push(u[l]);return E}(),i=this.font.glyf.encode(o,m,f),d=this.font.loca.encode(i.offsets,m),g={cmap:this.font.cmap.raw(),glyf:i.table,loca:d,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(g["OS/2"]=this.font.os2.raw()),this.font.directory.encode(g)},t}();wr.API.PDFObject=function(){var t;function e(){}return t=function(r,s){return(Array(s+1).join("0")+r).slice(-s)},e.convert=function(r){var s,n,i,o;if(Array.isArray(r))return"["+function(){var l,c,d;for(d=[],l=0,c=r.length;l<c;l++)s=r[l],d.push(e.convert(s));return d}().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r!=null&&r.isString)return"("+r+")";if(r instanceof Date)return"(D:"+t(r.getUTCFullYear(),4)+t(r.getUTCMonth(),2)+t(r.getUTCDate(),2)+t(r.getUTCHours(),2)+t(r.getUTCMinutes(),2)+t(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(n in i=["<<"],r)o=r[n],i.push("/"+n+" "+e.convert(o));return i.push(">>"),i.join(`
`)}return""+r},e}();function NQ(t,e,r,s,n){s=s||{};var i=1.15,o=n.internal.scaleFactor,l=n.internal.getFontSize()/o,c=n.getLineHeightFactor?n.getLineHeightFactor():i,d=l*c,u=/\r\n|\r|\n/g,A="",h=1;if((s.valign==="middle"||s.valign==="bottom"||s.halign==="center"||s.halign==="right")&&(A=typeof t=="string"?t.split(u):t,h=A.length||1),r+=l*(2-i),s.valign==="middle"?r-=h/2*d:s.valign==="bottom"&&(r-=h*d),s.halign==="center"||s.halign==="right"){var f=l;if(s.halign==="center"&&(f*=.5),A&&h>=1){for(var p=0;p<A.length;p++)n.text(A[p],e-n.getStringUnitWidth(A[p])*f,r),r+=d;return n}e-=n.getStringUnitWidth(t)*f}return s.halign==="justify"?n.text(t,e,r,{maxWidth:s.maxWidth||100,align:"justify"}):n.text(t,e,r),n}var sP={},z0=function(){function t(e){this.jsPDFDocument=e,this.userStyles={textColor:e.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:e.internal.getFontSize(),fontStyle:e.internal.getFont().fontStyle,font:e.internal.getFont().fontName,lineWidth:e.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:e.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return t.setDefaults=function(e,r){r===void 0&&(r=null),r?r.__autoTableDocumentDefaults=e:sP=e},t.unifyColor=function(e){return Array.isArray(e)?e:typeof e=="number"?[e,e,e]:typeof e=="string"?[e]:null},t.prototype.applyStyles=function(e,r){var s,n,i;r===void 0&&(r=!1),e.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(e.fontStyle);var o=this.jsPDFDocument.internal.getFont(),l=o.fontStyle,c=o.fontName;if(e.font&&(c=e.font),e.fontStyle){l=e.fontStyle;var d=this.getFontList()[c];d&&d.indexOf(l)===-1&&this.jsPDFDocument.setFontStyle&&(this.jsPDFDocument.setFontStyle(d[0]),l=d[0])}if(this.jsPDFDocument.setFont(c,l),e.fontSize&&this.jsPDFDocument.setFontSize(e.fontSize),!r){var u=t.unifyColor(e.fillColor);u&&(s=this.jsPDFDocument).setFillColor.apply(s,u),u=t.unifyColor(e.textColor),u&&(n=this.jsPDFDocument).setTextColor.apply(n,u),u=t.unifyColor(e.lineColor),u&&(i=this.jsPDFDocument).setDrawColor.apply(i,u),typeof e.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(e.lineWidth)}},t.prototype.splitTextToSize=function(e,r,s){return this.jsPDFDocument.splitTextToSize(e,r,s)},t.prototype.rect=function(e,r,s,n,i){return this.jsPDFDocument.rect(e,r,s,n,i)},t.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},t.prototype.getTextWidth=function(e){return this.jsPDFDocument.getTextWidth(e)},t.prototype.getDocument=function(){return this.jsPDFDocument},t.prototype.setPage=function(e){this.jsPDFDocument.setPage(e)},t.prototype.addPage=function(){return this.jsPDFDocument.addPage()},t.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},t.prototype.getGlobalOptions=function(){return sP||{}},t.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},t.prototype.pageSize=function(){var e=this.jsPDFDocument.internal.pageSize;return e.width==null&&(e={width:e.getWidth(),height:e.getHeight()}),e},t.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},t.prototype.getLineHeightFactor=function(){var e=this.jsPDFDocument;return e.getLineHeightFactor?e.getLineHeightFactor():1.15},t.prototype.getLineHeight=function(e){return e/this.scaleFactor()*this.getLineHeightFactor()},t.prototype.pageNumber=function(){var e=this.jsPDFDocument.internal.getCurrentPageInfo();return e?e.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},t}(),mS=function(t,e){return mS=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,s){r.__proto__=s}||function(r,s){for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(r[n]=s[n])},mS(t,e)};function CQ(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");mS(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var jQ=function(t){CQ(e,t);function e(r){var s=t.call(this)||this;return s._element=r,s}return e}(Array);function $0e(t){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/t,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}function K0e(t){var e={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return e[t]}function d2(t,e,r){r.applyStyles(e,!0);var s=Array.isArray(t)?t:[t],n=s.map(function(i){return r.getTextWidth(i)}).reduce(function(i,o){return Math.max(i,o)},0);return n}function SQ(t,e,r,s){var n=e.settings.tableLineWidth,i=e.settings.tableLineColor;t.applyStyles({lineWidth:n,lineColor:i});var o=EQ(n,!1);o&&t.rect(r.x,r.y,e.getWidth(t.pageSize().width),s.y-r.y,o)}function EQ(t,e){var r=t>0,s=e||e===0;return r&&s?"DF":r?"S":s?"F":null}function BN(t,e){var r,s,n,i;if(t=t||e,Array.isArray(t)){if(t.length>=4)return{top:t[0],right:t[1],bottom:t[2],left:t[3]};if(t.length===3)return{top:t[0],right:t[1],bottom:t[2],left:t[1]};if(t.length===2)return{top:t[0],right:t[1],bottom:t[0],left:t[1]};t.length===1?t=t[0]:t=e}return typeof t=="object"?(typeof t.vertical=="number"&&(t.top=t.vertical,t.bottom=t.vertical),typeof t.horizontal=="number"&&(t.right=t.horizontal,t.left=t.horizontal),{left:(r=t.left)!==null&&r!==void 0?r:e,top:(s=t.top)!==null&&s!==void 0?s:e,right:(n=t.right)!==null&&n!==void 0?n:e,bottom:(i=t.bottom)!==null&&i!==void 0?i:e}):(typeof t!="number"&&(t=e),{top:t,right:t,bottom:t,left:t})}function _Q(t,e){var r=BN(e.settings.margin,0);return t.pageSize().width-(r.left+r.right)}function z0e(t,e,r,s,n){var i={},o=1.3333333333333333,l=SC(e,function(x){return n.getComputedStyle(x).backgroundColor});l!=null&&(i.fillColor=l);var c=SC(e,function(x){return n.getComputedStyle(x).color});c!=null&&(i.textColor=c);var d=W0e(s,r);d&&(i.cellPadding=d);var u="borderTopColor",A=o*r,h=s.borderTopWidth;if(s.borderBottomWidth===h&&s.borderRightWidth===h&&s.borderLeftWidth===h){var f=(parseFloat(h)||0)/A;f&&(i.lineWidth=f)}else i.lineWidth={top:(parseFloat(s.borderTopWidth)||0)/A,right:(parseFloat(s.borderRightWidth)||0)/A,bottom:(parseFloat(s.borderBottomWidth)||0)/A,left:(parseFloat(s.borderLeftWidth)||0)/A},i.lineWidth.top||(i.lineWidth.right?u="borderRightColor":i.lineWidth.bottom?u="borderBottomColor":i.lineWidth.left&&(u="borderLeftColor"));var p=SC(e,function(x){return n.getComputedStyle(x)[u]});p!=null&&(i.lineColor=p);var m=["left","right","center","justify"];m.indexOf(s.textAlign)!==-1&&(i.halign=s.textAlign),m=["middle","bottom","top"],m.indexOf(s.verticalAlign)!==-1&&(i.valign=s.verticalAlign);var g=parseInt(s.fontSize||"");isNaN(g)||(i.fontSize=g/o);var y=q0e(s);y&&(i.fontStyle=y);var v=(s.fontFamily||"").toLowerCase();return t.indexOf(v)!==-1&&(i.font=v),i}function q0e(t){var e="";return(t.fontWeight==="bold"||t.fontWeight==="bolder"||parseInt(t.fontWeight)>=700)&&(e="bold"),(t.fontStyle==="italic"||t.fontStyle==="oblique")&&(e+="italic"),e}function SC(t,e){var r=TQ(t,e);if(!r)return null;var s=r.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!s||!Array.isArray(s))return null;var n=[parseInt(s[1]),parseInt(s[2]),parseInt(s[3])],i=parseInt(s[4]);return i===0||isNaN(n[0])||isNaN(n[1])||isNaN(n[2])?null:n}function TQ(t,e){var r=e(t);return r==="rgba(0, 0, 0, 0)"||r==="transparent"||r==="initial"||r==="inherit"?t.parentElement==null?null:TQ(t.parentElement,e):r}function W0e(t,e){var r=[t.paddingTop,t.paddingRight,t.paddingBottom,t.paddingLeft],s=96/(72/e),n=(parseInt(t.lineHeight)-parseInt(t.fontSize))/e/2,i=r.map(function(l){return parseInt(l||"0")/s}),o=BN(i,0);return n>o.top&&(o.top=n),n>o.bottom&&(o.bottom=n),o}function IQ(t,e,r,s,n){var i,o;s===void 0&&(s=!1),n===void 0&&(n=!1);var l;typeof e=="string"?l=r.document.querySelector(e):l=e;var c=Object.keys(t.getFontList()),d=t.scaleFactor(),u=[],A=[],h=[];if(!l)return console.error("Html table could not be found with input: ",e),{head:u,body:A,foot:h};for(var f=0;f<l.rows.length;f++){var p=l.rows[f],m=(o=(i=p==null?void 0:p.parentElement)===null||i===void 0?void 0:i.tagName)===null||o===void 0?void 0:o.toLowerCase(),g=G0e(c,d,r,p,s,n);g&&(m==="thead"?u.push(g):m==="tfoot"?h.push(g):A.push(g))}return{head:u,body:A,foot:h}}function G0e(t,e,r,s,n,i){for(var o=new jQ(s),l=0;l<s.cells.length;l++){var c=s.cells[l],d=r.getComputedStyle(c);if(n||d.display!=="none"){var u=void 0;i&&(u=z0e(t,c,e,d,r)),o.push({rowSpan:c.rowSpan,colSpan:c.colSpan,styles:u,_element:c,content:Y0e(c)})}}var A=r.getComputedStyle(s);if(o.length>0&&(n||A.display!=="none"))return o}function Y0e(t){var e=t.cloneNode(!0);return e.innerHTML=e.innerHTML.replace(/\n/g,"").replace(/ +/g," "),e.innerHTML=e.innerHTML.split(/<br.*?>/).map(function(r){return r.trim()}).join(`
`),e.innerText||e.textContent||""}function X0e(t,e,r){for(var s=0,n=[t,e,r];s<n.length;s++){var i=n[s];i&&typeof i!="object"&&console.error("The options parameter should be of type object, is: "+typeof i),i.startY&&typeof i.startY!="number"&&(console.error("Invalid value for startY option",i.startY),delete i.startY)}}function Vd(t,e,r,s,n){if(t==null)throw new TypeError("Cannot convert undefined or null to object");for(var i=Object(t),o=1;o<arguments.length;o++){var l=arguments[o];if(l!=null)for(var c in l)Object.prototype.hasOwnProperty.call(l,c)&&(i[c]=l[c])}return i}function kQ(t,e){var r=new z0(t),s=r.getDocumentOptions(),n=r.getGlobalOptions();X0e(n,s,e);var i=Vd({},n,s,e),o;typeof window<"u"&&(o=window);var l=J0e(n,s,e),c=Z0e(n,s,e),d=epe(r,i),u=rpe(r,i,o);return{id:e.tableId,content:u,hooks:c,styles:l,settings:d}}function J0e(t,e,r){for(var s={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},n=function(c){if(c==="columnStyles"){var d=t[c],u=e[c],A=r[c];s.columnStyles=Vd({},d,u,A)}else{var h=[t,e,r],f=h.map(function(p){return p[c]||{}});s[c]=Vd({},f[0],f[1],f[2])}},i=0,o=Object.keys(s);i<o.length;i++){var l=o[i];n(l)}return s}function Z0e(t,e,r){for(var s=[t,e,r],n={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},i=0,o=s;i<o.length;i++){var l=o[i];l.didParseCell&&n.didParseCell.push(l.didParseCell),l.willDrawCell&&n.willDrawCell.push(l.willDrawCell),l.didDrawCell&&n.didDrawCell.push(l.didDrawCell),l.willDrawPage&&n.willDrawPage.push(l.willDrawPage),l.didDrawPage&&n.didDrawPage.push(l.didDrawPage)}return n}function epe(t,e){var r,s,n,i,o,l,c,d,u,A,h,f,p=BN(e.margin,40/t.scaleFactor()),m=(r=tpe(t,e.startY))!==null&&r!==void 0?r:p.top,g;e.showFoot===!0?g="everyPage":e.showFoot===!1?g="never":g=(s=e.showFoot)!==null&&s!==void 0?s:"everyPage";var y;e.showHead===!0?y="everyPage":e.showHead===!1?y="never":y=(n=e.showHead)!==null&&n!==void 0?n:"everyPage";var v=(i=e.useCss)!==null&&i!==void 0?i:!1,x=e.theme||(v?"plain":"striped"),E=!!e.horizontalPageBreak,T=(o=e.horizontalPageBreakRepeat)!==null&&o!==void 0?o:null;return{includeHiddenHtml:(l=e.includeHiddenHtml)!==null&&l!==void 0?l:!1,useCss:v,theme:x,startY:m,margin:p,pageBreak:(c=e.pageBreak)!==null&&c!==void 0?c:"auto",rowPageBreak:(d=e.rowPageBreak)!==null&&d!==void 0?d:"auto",tableWidth:(u=e.tableWidth)!==null&&u!==void 0?u:"auto",showHead:y,showFoot:g,tableLineWidth:(A=e.tableLineWidth)!==null&&A!==void 0?A:0,tableLineColor:(h=e.tableLineColor)!==null&&h!==void 0?h:200,horizontalPageBreak:E,horizontalPageBreakRepeat:T,horizontalPageBreakBehaviour:(f=e.horizontalPageBreakBehaviour)!==null&&f!==void 0?f:"afterAllRows"}}function tpe(t,e){var r=t.getLastAutoTable(),s=t.scaleFactor(),n=t.pageNumber(),i=!1;if(r&&r.startPageNumber){var o=r.startPageNumber+r.pageNumber-1;i=o===n}return typeof e=="number"?e:(e==null||e===!1)&&i&&(r==null?void 0:r.finalY)!=null?r.finalY+20/s:null}function rpe(t,e,r){var s=e.head||[],n=e.body||[],i=e.foot||[];if(e.html){var o=e.includeHiddenHtml;if(r){var l=IQ(t,e.html,r,o,e.useCss)||{};s=l.head||s,n=l.body||s,i=l.foot||s}else console.error("Cannot parse html in non browser environment")}var c=e.columns||spe(s,n,i);return{columns:c,head:s,body:n,foot:i}}function spe(t,e,r){var s=t[0]||e[0]||r[0]||[],n=[];return Object.keys(s).filter(function(i){return i!=="_element"}).forEach(function(i){var o=1,l;Array.isArray(s)?l=s[parseInt(i)]:l=s[i],typeof l=="object"&&!Array.isArray(l)&&(o=(l==null?void 0:l.colSpan)||1);for(var c=0;c<o;c++){var d=void 0;Array.isArray(s)?d=n.length:d=i+(c>0?"_".concat(c):"");var u={dataKey:d};n.push(u)}}),n}var pS=function(){function t(e,r,s){this.table=r,this.pageNumber=r.pageNumber,this.settings=r.settings,this.cursor=s,this.doc=e.getDocument()}return t}(),npe=function(t){CQ(e,t);function e(r,s,n,i,o,l){var c=t.call(this,r,s,l)||this;return c.cell=n,c.row=i,c.column=o,c.section=i.section,c}return e}(pS),ape=function(){function t(e,r){this.pageNumber=1,this.id=e.id,this.settings=e.settings,this.styles=e.styles,this.hooks=e.hooks,this.columns=r.columns,this.head=r.head,this.body=r.body,this.foot=r.foot}return t.prototype.getHeadHeight=function(e){return this.head.reduce(function(r,s){return r+s.getMaxCellHeight(e)},0)},t.prototype.getFootHeight=function(e){return this.foot.reduce(function(r,s){return r+s.getMaxCellHeight(e)},0)},t.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},t.prototype.callCellHooks=function(e,r,s,n,i,o){for(var l=0,c=r;l<c.length;l++){var d=c[l],u=new npe(e,this,s,n,i,o),A=d(u)===!1;if(s.text=Array.isArray(s.text)?s.text:[s.text],A)return!1}return!0},t.prototype.callEndPageHooks=function(e,r){e.applyStyles(e.userStyles);for(var s=0,n=this.hooks.didDrawPage;s<n.length;s++){var i=n[s];i(new pS(e,this,r))}},t.prototype.callWillDrawPageHooks=function(e,r){for(var s=0,n=this.hooks.willDrawPage;s<n.length;s++){var i=n[s];i(new pS(e,this,r))}},t.prototype.getWidth=function(e){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var r=this.columns.reduce(function(n,i){return n+i.wrappedWidth},0);return r}else{var s=this.settings.margin;return e-s.left-s.right}},t}(),BQ=function(){function t(e,r,s,n,i){i===void 0&&(i=!1),this.height=0,this.raw=e,e instanceof jQ&&(this.raw=e._element,this.element=e._element),this.index=r,this.section=s,this.cells=n,this.spansMultiplePages=i}return t.prototype.getMaxCellHeight=function(e){var r=this;return e.reduce(function(s,n){var i;return Math.max(s,((i=r.cells[n.index])===null||i===void 0?void 0:i.height)||0)},0)},t.prototype.hasRowSpan=function(e){var r=this;return e.filter(function(s){var n=r.cells[s.index];return n?n.rowSpan>1:!1}).length>0},t.prototype.canEntireRowFit=function(e,r){return this.getMaxCellHeight(r)<=e},t.prototype.getMinimumRowHeight=function(e,r){var s=this;return e.reduce(function(n,i){var o=s.cells[i.index];if(!o)return 0;var l=r.getLineHeight(o.styles.fontSize),c=o.padding("vertical"),d=c+l;return d>n?d:n},0)},t}(),FQ=function(){function t(e,r,s){var n;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=r,this.section=s,this.raw=e;var i=e;e!=null&&typeof e=="object"&&!Array.isArray(e)?(this.rowSpan=e.rowSpan||1,this.colSpan=e.colSpan||1,i=(n=e.content)!==null&&n!==void 0?n:e,e._element&&(this.raw=e._element)):(this.rowSpan=1,this.colSpan=1);var o=i!=null?""+i:"",l=/\r\n|\r|\n/g;this.text=o.split(l)}return t.prototype.getTextPos=function(){var e;if(this.styles.valign==="top")e=this.y+this.padding("top");else if(this.styles.valign==="bottom")e=this.y+this.height-this.padding("bottom");else{var r=this.height-this.padding("vertical");e=this.y+r/2+this.padding("top")}var s;if(this.styles.halign==="right")s=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var n=this.width-this.padding("horizontal");s=this.x+n/2+this.padding("left")}else s=this.x+this.padding("left");return{x:s,y:e}},t.prototype.getContentHeight=function(e,r){r===void 0&&(r=1.15);var s=Array.isArray(this.text)?this.text.length:1,n=this.styles.fontSize/e*r,i=s*n+this.padding("vertical");return Math.max(i,this.styles.minCellHeight)},t.prototype.padding=function(e){var r=BN(this.styles.cellPadding,0);return e==="vertical"?r.top+r.bottom:e==="horizontal"?r.left+r.right:r[e]},t}(),ipe=function(){function t(e,r,s){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=e,this.raw=r,this.index=s}return t.prototype.getMaxCustomCellWidth=function(e){for(var r=0,s=0,n=e.allRows();s<n.length;s++){var i=n[s],o=i.cells[this.index];o&&typeof o.styles.cellWidth=="number"&&(r=Math.max(r,o.styles.cellWidth))}return r},t}();function ope(t,e){lpe(t,e);var r=[],s=0;e.columns.forEach(function(i){var o=i.getMaxCustomCellWidth(e);o?i.width=o:(i.width=i.wrappedWidth,r.push(i)),s+=i.width});var n=e.getWidth(t.pageSize().width)-s;n&&(n=gS(r,n,function(i){return Math.max(i.minReadableWidth,i.minWidth)})),n&&(n=gS(r,n,function(i){return i.minWidth})),n=Math.abs(n),!e.settings.horizontalPageBreak&&n>.1/t.scaleFactor()&&(n=n<1?n:Math.round(n),console.warn("Of the table content, ".concat(n," units width could not fit page"))),dpe(e),upe(e,t),cpe(e)}function lpe(t,e){var r=t.scaleFactor(),s=e.settings.horizontalPageBreak,n=_Q(t,e);e.allRows().forEach(function(i){for(var o=0,l=e.columns;o<l.length;o++){var c=l[o],d=i.cells[c.index];if(d){var u=e.hooks.didParseCell;e.callCellHooks(t,u,d,i,c,null);var A=d.padding("horizontal");d.contentWidth=d2(d.text,d.styles,t)+A;var h=d2(d.text.join(" ").split(/[^\S\u00A0]+/),d.styles,t);if(d.minReadableWidth=h+d.padding("horizontal"),typeof d.styles.cellWidth=="number")d.minWidth=d.styles.cellWidth,d.wrappedWidth=d.styles.cellWidth;else if(d.styles.cellWidth==="wrap"||s===!0)d.contentWidth>n?(d.minWidth=n,d.wrappedWidth=n):(d.minWidth=d.contentWidth,d.wrappedWidth=d.contentWidth);else{var f=10/r;d.minWidth=d.styles.minCellWidth||f,d.wrappedWidth=d.contentWidth,d.minWidth>d.wrappedWidth&&(d.wrappedWidth=d.minWidth)}}}}),e.allRows().forEach(function(i){for(var o=0,l=e.columns;o<l.length;o++){var c=l[o],d=i.cells[c.index];if(d&&d.colSpan===1)c.wrappedWidth=Math.max(c.wrappedWidth,d.wrappedWidth),c.minWidth=Math.max(c.minWidth,d.minWidth),c.minReadableWidth=Math.max(c.minReadableWidth,d.minReadableWidth);else{var u=e.styles.columnStyles[c.dataKey]||e.styles.columnStyles[c.index]||{},A=u.cellWidth||u.minCellWidth;A&&typeof A=="number"&&(c.minWidth=A,c.wrappedWidth=A)}d&&(d.colSpan>1&&!c.minWidth&&(c.minWidth=d.minWidth),d.colSpan>1&&!c.wrappedWidth&&(c.wrappedWidth=d.minWidth))}})}function gS(t,e,r){for(var s=e,n=t.reduce(function(f,p){return f+p.wrappedWidth},0),i=0;i<t.length;i++){var o=t[i],l=o.wrappedWidth/n,c=s*l,d=o.width+c,u=r(o),A=d<u?u:d;e-=A-o.width,o.width=A}if(e=Math.round(e*1e10)/1e10,e){var h=t.filter(function(f){return e<0?f.width>r(f):!0});h.length&&(e=gS(h,e,r))}return e}function cpe(t){for(var e={},r=1,s=t.allRows(),n=0;n<s.length;n++)for(var i=s[n],o=0,l=t.columns;o<l.length;o++){var c=l[o],d=e[c.index];if(r>1)r--,delete i.cells[c.index];else if(d)d.cell.height+=i.height,r=d.cell.colSpan,delete i.cells[c.index],d.left--,d.left<=1&&delete e[c.index];else{var u=i.cells[c.index];if(!u)continue;if(u.height=i.height,u.rowSpan>1){var A=s.length-n,h=u.rowSpan>A?A:u.rowSpan;e[c.index]={cell:u,left:h,row:i}}}}}function dpe(t){for(var e=t.allRows(),r=0;r<e.length;r++)for(var s=e[r],n=null,i=0,o=0,l=0;l<t.columns.length;l++){var c=t.columns[l];if(o-=1,o>1&&t.columns[l+1])i+=c.width,delete s.cells[c.index];else if(n){var d=n;delete s.cells[c.index],n=null,d.width=c.width+i}else{var d=s.cells[c.index];if(!d)continue;if(o=d.colSpan,i=0,d.colSpan>1){n=d,i+=c.width;continue}d.width=c.width+i}}}function upe(t,e){for(var r={count:0,height:0},s=0,n=t.allRows();s<n.length;s++){for(var i=n[s],o=0,l=t.columns;o<l.length;o++){var c=l[o],d=i.cells[c.index];if(d){e.applyStyles(d.styles,!0);var u=d.width-d.padding("horizontal");if(d.styles.overflow==="linebreak")d.text=e.splitTextToSize(d.text,u+1/e.scaleFactor(),{fontSize:d.styles.fontSize});else if(d.styles.overflow==="ellipsize")d.text=nP(d.text,u,d.styles,e,"...");else if(d.styles.overflow==="hidden")d.text=nP(d.text,u,d.styles,e,"");else if(typeof d.styles.overflow=="function"){var A=d.styles.overflow(d.text,u);typeof A=="string"?d.text=[A]:d.text=A}d.contentHeight=d.getContentHeight(e.scaleFactor(),e.getLineHeightFactor());var h=d.contentHeight/d.rowSpan;d.rowSpan>1&&r.count*r.height<h*d.rowSpan?r={height:h,count:d.rowSpan}:r&&r.count>0&&r.height>h&&(h=r.height),h>i.height&&(i.height=h)}}r.count--}}function nP(t,e,r,s,n){return t.map(function(i){return Ape(i,e,r,s,n)})}function Ape(t,e,r,s,n){var i=1e4*s.scaleFactor();if(e=Math.ceil(e*i)/i,e>=d2(t,r,s))return t;for(;e<d2(t+n,r,s)&&!(t.length<=1);)t=t.substring(0,t.length-1);return t.trim()+n}function PQ(t,e){var r=new z0(t),s=hpe(e,r.scaleFactor()),n=new ape(e,s);return ope(r,n),r.applyStyles(r.userStyles),n}function hpe(t,e){var r=t.content,s=mpe(r.columns);if(r.head.length===0){var n=aP(s,"head");n&&r.head.push(n)}if(r.foot.length===0){var n=aP(s,"foot");n&&r.foot.push(n)}var i=t.settings.theme,o=t.styles;return{columns:s,head:EC("head",r.head,s,o,i,e),body:EC("body",r.body,s,o,i,e),foot:EC("foot",r.foot,s,o,i,e)}}function EC(t,e,r,s,n,i){var o={},l=e.map(function(c,d){for(var u=0,A={},h=0,f=0,p=0,m=r;p<m.length;p++){var g=m[p];if(o[g.index]==null||o[g.index].left===0)if(f===0){var y=void 0;Array.isArray(c)?y=c[g.index-h-u]:y=c[g.dataKey];var v={};typeof y=="object"&&!Array.isArray(y)&&(v=(y==null?void 0:y.styles)||{});var x=ppe(t,g,d,n,s,i,v),E=new FQ(y,x,t);A[g.dataKey]=E,A[g.index]=E,f=E.colSpan-1,o[g.index]={left:E.rowSpan-1,times:f}}else f--,h++;else o[g.index].left--,f=o[g.index].times,u++}return new BQ(c,d,t,A)});return l}function aP(t,e){var r={};return t.forEach(function(s){if(s.raw!=null){var n=fpe(e,s.raw);n!=null&&(r[s.dataKey]=n)}}),Object.keys(r).length>0?r:null}function fpe(t,e){if(t==="head"){if(typeof e=="object")return e.header||null;if(typeof e=="string"||typeof e=="number")return e}else if(t==="foot"&&typeof e=="object")return e.footer;return null}function mpe(t){return t.map(function(e,r){var s,n;return typeof e=="object"?n=(s=e.dataKey)!==null&&s!==void 0?s:r:n=r,new ipe(n,e,r)})}function ppe(t,e,r,s,n,i,o){var l=K0e(s),c;t==="head"?c=n.headStyles:t==="body"?c=n.bodyStyles:t==="foot"&&(c=n.footStyles);var d=Vd({},l.table,l[t],n.styles,c),u=n.columnStyles[e.dataKey]||n.columnStyles[e.index]||{},A=t==="body"?u:{},h=t==="body"&&r%2===0?Vd({},l.alternateRow,n.alternateRowStyles):{},f=$0e(i),p=Vd({},f,d,h,A);return Vd(p,o)}function gpe(t,e,r){var s;r===void 0&&(r={});var n=_Q(t,e),i=new Map,o=[],l=[],c=[];Array.isArray(e.settings.horizontalPageBreakRepeat)?c=e.settings.horizontalPageBreakRepeat:(typeof e.settings.horizontalPageBreakRepeat=="string"||typeof e.settings.horizontalPageBreakRepeat=="number")&&(c=[e.settings.horizontalPageBreakRepeat]),c.forEach(function(h){var f=e.columns.find(function(p){return p.dataKey===h||p.index===h});f&&!i.has(f.index)&&(i.set(f.index,!0),o.push(f.index),l.push(e.columns[f.index]),n-=f.wrappedWidth)});for(var d=!0,u=(s=r==null?void 0:r.start)!==null&&s!==void 0?s:0;u<e.columns.length;){if(i.has(u)){u++;continue}var A=e.columns[u].wrappedWidth;if(d||n>=A)d=!1,o.push(u),l.push(e.columns[u]),n-=A;else break;u++}return{colIndexes:o,columns:l,lastIndex:u-1}}function xpe(t,e){for(var r=[],s=0;s<e.columns.length;s++){var n=gpe(t,e,{start:s});n.columns.length&&(r.push(n),s=n.lastIndex)}return r}function DQ(t,e){var r=e.settings,s=r.startY,n=r.margin,i={x:n.left,y:s},o=e.getHeadHeight(e.columns)+e.getFootHeight(e.columns),l=s+n.bottom+o;if(r.pageBreak==="avoid"){var c=e.body,d=c.reduce(function(h,f){return h+f.height},0);l+=d}var u=new z0(t);(r.pageBreak==="always"||r.startY!=null&&l>u.pageSize().height)&&(LQ(u),i.y=n.top),e.callWillDrawPageHooks(u,i);var A=Vd({},i);e.startPageNumber=u.pageNumber(),r.horizontalPageBreak?ype(u,e,A,i):(u.applyStyles(u.userStyles),(r.showHead==="firstPage"||r.showHead==="everyPage")&&e.head.forEach(function(h){return ou(u,e,h,i,e.columns)}),u.applyStyles(u.userStyles),e.body.forEach(function(h,f){var p=f===e.body.length-1;u2(u,e,h,p,A,i,e.columns)}),u.applyStyles(u.userStyles),(r.showFoot==="lastPage"||r.showFoot==="everyPage")&&e.foot.forEach(function(h){return ou(u,e,h,i,e.columns)})),SQ(u,e,A,i),e.callEndPageHooks(u,i),e.finalY=i.y,t.lastAutoTable=e,u.applyStyles(u.userStyles)}function ype(t,e,r,s){var n=xpe(t,e),i=e.settings;if(i.horizontalPageBreakBehaviour==="afterAllRows")n.forEach(function(d,u){t.applyStyles(t.userStyles),u>0?Sx(t,e,r,s,d.columns,!0):iP(t,e,s,d.columns),vpe(t,e,r,s,d.columns),_C(t,e,s,d.columns)});else for(var o=-1,l=n[0],c=function(){var d=o;if(l){t.applyStyles(t.userStyles);var u=l.columns;o>=0?Sx(t,e,r,s,u,!0):iP(t,e,s,u),d=oP(t,e,o+1,s,u),_C(t,e,s,u)}var A=d-o;n.slice(1).forEach(function(h){t.applyStyles(t.userStyles),Sx(t,e,r,s,h.columns,!0),oP(t,e,o+1,s,h.columns,A),_C(t,e,s,h.columns)}),o=d};o<e.body.length-1;)c()}function iP(t,e,r,s){var n=e.settings;t.applyStyles(t.userStyles),(n.showHead==="firstPage"||n.showHead==="everyPage")&&e.head.forEach(function(i){return ou(t,e,i,r,s)})}function vpe(t,e,r,s,n){t.applyStyles(t.userStyles),e.body.forEach(function(i,o){var l=o===e.body.length-1;u2(t,e,i,l,r,s,n)})}function oP(t,e,r,s,n,i){t.applyStyles(t.userStyles),i=i??e.body.length;var o=Math.min(r+i,e.body.length),l=-1;return e.body.slice(r,o).forEach(function(c,d){var u=r+d===e.body.length-1,A=RQ(t,e,u,s);c.canEntireRowFit(A,n)&&(ou(t,e,c,s,n),l=r+d)}),l}function _C(t,e,r,s){var n=e.settings;t.applyStyles(t.userStyles),(n.showFoot==="lastPage"||n.showFoot==="everyPage")&&e.foot.forEach(function(i){return ou(t,e,i,r,s)})}function bpe(t,e,r){var s=r.getLineHeight(t.styles.fontSize),n=t.padding("vertical"),i=Math.floor((e-n)/s);return Math.max(0,i)}function wpe(t,e,r,s){var n={};t.spansMultiplePages=!0,t.height=0;for(var i=0,o=0,l=r.columns;o<l.length;o++){var c=l[o],d=t.cells[c.index];if(d){Array.isArray(d.text)||(d.text=[d.text]);var u=new FQ(d.raw,d.styles,d.section);u=Vd(u,d),u.text=[];var A=bpe(d,e,s);d.text.length>A&&(u.text=d.text.splice(A,d.text.length));var h=s.scaleFactor(),f=s.getLineHeightFactor();d.contentHeight=d.getContentHeight(h,f),d.contentHeight>=e&&(d.contentHeight=e,u.styles.minCellHeight-=e),d.contentHeight>t.height&&(t.height=d.contentHeight),u.contentHeight=u.getContentHeight(h,f),u.contentHeight>i&&(i=u.contentHeight),n[c.index]=u}}var p=new BQ(t.raw,-1,t.section,n,!0);p.height=i;for(var m=0,g=r.columns;m<g.length;m++){var c=g[m],u=p.cells[c.index];u&&(u.height=p.height);var d=t.cells[c.index];d&&(d.height=t.height)}return p}function Npe(t,e,r,s){var n=t.pageSize().height,i=s.settings.margin,o=i.top+i.bottom,l=n-o;e.section==="body"&&(l-=s.getHeadHeight(s.columns)+s.getFootHeight(s.columns));var c=e.getMinimumRowHeight(s.columns,t),d=c<r;if(c>l)return console.error("Will not be able to print row ".concat(e.index," correctly since it's minimum height is larger than page height")),!0;if(!d)return!1;var u=e.hasRowSpan(s.columns),A=e.getMaxCellHeight(s.columns)>l;return A?(u&&console.error("The content of row ".concat(e.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(u||s.settings.rowPageBreak==="avoid")}function u2(t,e,r,s,n,i,o){var l=RQ(t,e,s,i);if(r.canEntireRowFit(l,o))ou(t,e,r,i,o);else if(Npe(t,r,l,e)){var c=wpe(r,l,e,t);ou(t,e,r,i,o),Sx(t,e,n,i,o),u2(t,e,c,s,n,i,o)}else Sx(t,e,n,i,o),u2(t,e,r,s,n,i,o)}function ou(t,e,r,s,n){s.x=e.settings.margin.left;for(var i=0,o=n;i<o.length;i++){var l=o[i],c=r.cells[l.index];if(!c){s.x+=l.width;continue}t.applyStyles(c.styles),c.x=s.x,c.y=s.y;var d=e.callCellHooks(t,e.hooks.willDrawCell,c,r,l,s);if(d===!1){s.x+=l.width;continue}Cpe(t,c,s);var u=c.getTextPos();NQ(c.text,u.x,u.y,{halign:c.styles.halign,valign:c.styles.valign,maxWidth:Math.ceil(c.width-c.padding("left")-c.padding("right"))},t.getDocument()),e.callCellHooks(t,e.hooks.didDrawCell,c,r,l,s),s.x+=l.width}s.y+=r.height}function Cpe(t,e,r){var s=e.styles;if(t.getDocument().setFillColor(t.getDocument().getFillColor()),typeof s.lineWidth=="number"){var n=EQ(s.lineWidth,s.fillColor);n&&t.rect(e.x,r.y,e.width,e.height,n)}else typeof s.lineWidth=="object"&&(s.fillColor&&t.rect(e.x,r.y,e.width,e.height,"F"),jpe(t,e,r,s.lineWidth))}function jpe(t,e,r,s){var n,i,o,l;s.top&&(n=r.x,i=r.y,o=r.x+e.width,l=r.y,s.right&&(o+=.5*s.right),s.left&&(n-=.5*s.left),c(s.top,n,i,o,l)),s.bottom&&(n=r.x,i=r.y+e.height,o=r.x+e.width,l=r.y+e.height,s.right&&(o+=.5*s.right),s.left&&(n-=.5*s.left),c(s.bottom,n,i,o,l)),s.left&&(n=r.x,i=r.y,o=r.x,l=r.y+e.height,s.top&&(i-=.5*s.top),s.bottom&&(l+=.5*s.bottom),c(s.left,n,i,o,l)),s.right&&(n=r.x+e.width,i=r.y,o=r.x+e.width,l=r.y+e.height,s.top&&(i-=.5*s.top),s.bottom&&(l+=.5*s.bottom),c(s.right,n,i,o,l));function c(d,u,A,h,f){t.getDocument().setLineWidth(d),t.getDocument().line(u,A,h,f,"S")}}function RQ(t,e,r,s){var n=e.settings.margin.bottom,i=e.settings.showFoot;return(i==="everyPage"||i==="lastPage"&&r)&&(n+=e.getFootHeight(e.columns)),t.pageSize().height-s.y-n}function Sx(t,e,r,s,n,i){n===void 0&&(n=[]),i===void 0&&(i=!1),t.applyStyles(t.userStyles),e.settings.showFoot==="everyPage"&&!i&&e.foot.forEach(function(l){return ou(t,e,l,s,n)}),e.callEndPageHooks(t,s);var o=e.settings.margin;SQ(t,e,r,s),LQ(t),e.pageNumber++,s.x=o.left,s.y=o.top,r.y=o.top,e.callWillDrawPageHooks(t,s),e.settings.showHead==="everyPage"&&(e.head.forEach(function(l){return ou(t,e,l,s,n)}),t.applyStyles(t.userStyles))}function LQ(t){var e=t.pageNumber();t.setPage(e+1);var r=t.pageNumber();return r===e?(t.addPage(),!0):!1}function Spe(t){t.API.autoTable=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var s=e[0],n=kQ(this,s),i=PQ(this,n);return DQ(this,i),this},t.API.lastAutoTable=!1,t.API.autoTableText=function(e,r,s,n){NQ(e,r,s,n,this)},t.API.autoTableSetDefaults=function(e){return z0.setDefaults(e,this),this},t.autoTableSetDefaults=function(e,r){z0.setDefaults(e,r)},t.API.autoTableHtmlToJson=function(e,r){var s;if(r===void 0&&(r=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var n=new z0(this),i=IQ(n,e,window,r,!1),o=i.head,l=i.body,c=((s=o[0])===null||s===void 0?void 0:s.map(function(d){return d.content}))||[];return{columns:c,rows:l,data:l}}}var TC;function IC(t,e){var r=kQ(t,e),s=PQ(t,r);DQ(t,s)}try{if(typeof window<"u"&&window){var lP=window,cP=lP.jsPDF||((TC=lP.jspdf)===null||TC===void 0?void 0:TC.jsPDF);cP&&Spe(cP)}}catch(t){console.error("Could not apply autoTable plugin",t)}function kr(t){return`Rs. ${(Number(t)||0).toFixed(2)}`}if(typeof IC=="function"){wr.autoTable=IC,wr.prototype.autoTable=function(t){return IC(this,t)};try{typeof new wr().autoTable=="function"?console.log(" autoTable plugin registered and working correctly"):console.warn(" autoTable registered but not available on instance")}catch(t){console.error(" Error testing autoTable plugin:",t)}}else console.error(" autoTable import failed - plugin not available");const Po=(t,e)=>{var r,s;try{typeof t.autoTable=="function"?(console.log(" Calling autoTable with options:",{startY:e.startY,headLength:(r=e.head)==null?void 0:r.length,bodyLength:(s=e.body)==null?void 0:s.length}),t.autoTable(e),console.log(" autoTable call completed successfully")):typeof wr.prototype.autoTable=="function"?(console.log(" Calling autoTable from prototype"),wr.prototype.autoTable.call(t,e)):(console.error(" autoTable is not available on instance or prototype, falling back to basic table"),dP(t,e))}catch(n){console.error(" Error calling autoTable:",n),dP(t,e)}},dP=(t,e)=>{let s=e.startY||50;if(t.setFontSize(10),t.setFont("helvetica","normal"),e.head&&e.head.length>0){t.setFont("helvetica","bold"),t.setFontSize(11);const n=e.head[0];let i=20;n.forEach((o,l)=>{t.text(o,i,s),i+=40}),s+=8,t.line(20,s,180,s),s+=5}e.body&&e.body.length>0&&(t.setFont("helvetica","normal"),t.setFontSize(9),e.body.slice(0,10).forEach(n=>{let i=20;n.forEach((o,l)=>{const c=String(o||"").substring(0,15);t.text(c,i,s),i+=40}),s+=5,s>270&&(t.addPage(),s=20)}),e.body.length>10&&(s+=3,t.setFontSize(8),t.text(`... and ${e.body.length-10} more rows`,20,s),s+=5)),t.lastAutoTable={finalY:s+10}};class xS{static getDateRanges(){const e=new Date,r=new Date(e);r.setDate(r.getDate()-1);const s=new Date(e);s.setDate(s.getDate()-7);const n=new Date(e);n.setMonth(n.getMonth()-1);const i=new Date(e);i.setMonth(i.getMonth()-3);const o=new Date(e.getFullYear(),e.getMonth(),1),l=new Date(e),c=l.getDay(),d=l.getDate()-c+(c===0?-6:1);return l.setDate(d),[{startDate:new Date(r.setHours(0,0,0,0)),endDate:new Date(r.setHours(23,59,59,999)),label:"Yesterday"},{startDate:new Date(l.setHours(0,0,0,0)),endDate:new Date(e.setHours(23,59,59,999)),label:"This Week"},{startDate:new Date(s.setHours(0,0,0,0)),endDate:new Date(e.setHours(23,59,59,999)),label:"Last 7 Days"},{startDate:new Date(o.setHours(0,0,0,0)),endDate:new Date(e.setHours(23,59,59,999)),label:"This Month"},{startDate:new Date(n.setHours(0,0,0,0)),endDate:new Date(e.setHours(23,59,59,999)),label:"Last 30 Days"},{startDate:new Date(i.setHours(0,0,0,0)),endDate:new Date(e.setHours(23,59,59,999)),label:"Last 3 Months"}]}static async getOrdersInRange(e,r,s){try{const i=[];try{const o=[Yt("restaurantId","==",e),Yt("createdAt",">=",wt.fromDate(r)),Yt("createdAt","<=",wt.fromDate(s)),On("createdAt","desc"),Wi(1e3)],l=Zt(Jt(st,"orders"),...o);return(await ur(l)).docs.forEach(d=>{var A,h;const u=d.data();i.push({id:d.id,...u,createdAt:((A=u.createdAt)==null?void 0:A.toDate())||new Date,updatedAt:((h=u.updatedAt)==null?void 0:h.toDate())||new Date})}),console.log(` Successfully fetched ${i.length} orders using optimized composite index`),{success:!0,data:i}}catch{console.warn(" Composite index not found, using fallback query method"),console.warn(" Please deploy indexes: firebase deploy --only firestore:indexes");const l=[Yt("restaurantId","==",e),Yt("createdAt",">=",wt.fromDate(r)),Yt("createdAt","<=",wt.fromDate(s))],c=Zt(Jt(st,"orders"),...l),u=(await ur(c)).docs.map(A=>{var f,p;const h=A.data();return{id:A.id,...h,createdAt:((f=h.createdAt)==null?void 0:f.toDate())||new Date,updatedAt:((p=h.updatedAt)==null?void 0:p.toDate())||new Date}}).sort((A,h)=>h.createdAt.getTime()-A.createdAt.getTime());return console.log(` Successfully fetched ${u.length} orders using fallback method`),{success:!0,data:u}}}catch(n){console.error(" Error fetching orders in range:",n);try{console.warn(" Attempting ultimate fallback with restaurant-only filter");const i=Zt(Jt(st,"orders"),Yt("restaurantId","==",e)),l=(await ur(i)).docs.map(c=>{var u,A;const d=c.data();return{id:c.id,...d,createdAt:((u=d.createdAt)==null?void 0:u.toDate())||new Date,updatedAt:((A=d.updatedAt)==null?void 0:A.toDate())||new Date}}).filter(c=>{const d=c.createdAt;return d>=r&&d<=s}).sort((c,d)=>d.createdAt.getTime()-c.createdAt.getTime());return console.log(` Ultimate fallback successful: ${l.length} orders`),{success:!0,data:l}}catch(i){return console.error(" Ultimate fallback failed:",i),{success:!1,error:n instanceof Error?n.message:"Failed to fetch orders"}}}}static generateSampleOrders(e,r,s,n,i){const o=[],l=n.length>0?n:[{id:"item1",name:"Margherita Pizza",price:18.99,categoryName:"Main Course",isAvailable:!0,description:"Classic pizza with tomato and mozzarella"},{id:"item2",name:"Caesar Salad",price:12.5,categoryName:"Appetizers",isAvailable:!0,description:"Fresh romaine with caesar dressing"},{id:"item3",name:"Grilled Salmon",price:24.99,categoryName:"Main Course",isAvailable:!0,description:"Atlantic salmon with herbs"},{id:"item4",name:"Chicken Wings",price:15.99,categoryName:"Appetizers",isAvailable:!0,description:"Spicy buffalo wings"},{id:"item5",name:"Tiramisu",price:8.99,categoryName:"Desserts",isAvailable:!0,description:"Classic Italian dessert"},{id:"item6",name:"Chocolate Cake",price:7.99,categoryName:"Desserts",isAvailable:!0,description:"Rich chocolate layer cake"},{id:"item7",name:"Coca Cola",price:3.99,categoryName:"Beverages",isAvailable:!0,description:"Refreshing soft drink"},{id:"item8",name:"Fresh Orange Juice",price:4.99,categoryName:"Beverages",isAvailable:!0,description:"Freshly squeezed orange juice"},{id:"item9",name:"Beef Burger",price:16.99,categoryName:"Main Course",isAvailable:!0,description:"Juicy beef burger with fries"},{id:"item10",name:"Fish & Chips",price:19.99,categoryName:"Main Course",isAvailable:!0,description:"Beer battered fish with chips"},{id:"item11",name:"Pasta Carbonara",price:17.5,categoryName:"Main Course",isAvailable:!0,description:"Creamy pasta with bacon"},{id:"item12",name:"Mushroom Soup",price:9.99,categoryName:"Appetizers",isAvailable:!0,description:"Creamy mushroom soup"},{id:"item13",name:"Greek Salad",price:11.99,categoryName:"Appetizers",isAvailable:!0,description:"Fresh vegetables with feta cheese"},{id:"item14",name:"Espresso",price:2.99,categoryName:"Beverages",isAvailable:!0,description:"Strong Italian coffee"},{id:"item15",name:"Cappuccino",price:4.5,categoryName:"Beverages",isAvailable:!0,description:"Coffee with steamed milk"}],c=i.length>0?i:[{id:"table1",number:"1",capacity:4,area:"Main Dining"},{id:"table2",number:"2",capacity:2,area:"Main Dining"},{id:"table3",number:"3",capacity:6,area:"Main Dining"},{id:"table4",number:"4",capacity:4,area:"Terrace"},{id:"table5",number:"5",capacity:2,area:"Terrace"},{id:"table6",number:"6",capacity:8,area:"Private Room"},{id:"table7",number:"7",capacity:4,area:"Main Dining"},{id:"table8",number:"8",capacity:2,area:"Bar Area"},{id:"table9",number:"9",capacity:4,area:"Main Dining"},{id:"table10",number:"10",capacity:6,area:"Terrace"}],d=Math.ceil((s.getTime()-r.getTime())/(1e3*60*60*24)),u=Math.min(d*15,200),A=["John Smith","Emily Johnson","Michael Brown","Sarah Davis","David Wilson","Lisa Anderson","Robert Taylor","Jennifer White","Christopher Martin","Amanda Thompson","James Garcia","Jessica Martinez","Daniel Rodriguez","Ashley Lewis","Matthew Lee","Lauren Walker","Andrew Hall","Stephanie Allen","Joshua Young","Samantha King"],h=["dine_in","takeaway","delivery"],f=["cash","card","digital_wallet"],p=["completed","completed","completed","cancelled"];for(let m=0;m<u;m++){const g=new Date(r.getTime()+Math.random()*(s.getTime()-r.getTime())),y=[12,13,18,19,20],v=Math.random()<.6?y[Math.floor(Math.random()*y.length)]:Math.floor(Math.random()*24);g.setHours(v,Math.floor(Math.random()*60),0,0);const x=Math.floor(Math.random()*5)+1,E=[],T=new Set;for(let q=0;q<x;q++){let te;do te=l[Math.floor(Math.random()*l.length)];while(T.has(te.id)&&T.size<l.length);T.add(te.id);const W=Math.floor(Math.random()*3)+1,Q=te.price*W;E.push({id:`item_${te.id}_${q}`,menuItemId:te.id,name:te.name,price:te.price,quantity:W,total:Q,notes:""})}const j=E.reduce((q,te)=>q+te.total,0),C=0,w=j*.1,S=j-C+w,F=Math.random()<.7,B=F?`customer_${Math.floor(Math.random()*20)+1}`:void 0,k=F?A[Math.floor(Math.random()*A.length)]:void 0,D={id:`sample_order_${m+1}`,orderNumber:`ORD-${String(m+1).padStart(4,"0")}`,restaurantId:e,tableId:c[Math.floor(Math.random()*c.length)].id,customerId:B,customerName:k,items:E,subtotal:j,tax:w,discount:C,total:S,status:p[Math.floor(Math.random()*p.length)],type:h[Math.floor(Math.random()*h.length)],paymentMethod:f[Math.floor(Math.random()*f.length)],paymentStatus:"paid",createdAt:g,updatedAt:g,notes:"",staffId:`staff_${Math.floor(Math.random()*5)+1}`,preparation:{estimatedTime:25,actualTime:20+Math.floor(Math.random()*20),startedAt:g,completedAt:new Date(g.getTime()+(20+Math.floor(Math.random()*20))*6e4)}};o.push(D)}return console.log(` Generated ${o.length} sample orders for analytics:`,{restaurantId:e,dateRange:`${r.toISOString()} to ${s.toISOString()}`,totalRevenue:o.reduce((m,g)=>m+g.total,0),categories:[...new Set(l.map(m=>m.categoryName))],tablesUsed:[...new Set(o.map(m=>m.tableId))].length}),o.sort((m,g)=>g.createdAt.getTime()-m.createdAt.getTime())}static async generateSalesAnalytics(e,r,s,n=[],i=[],o=[]){var l,c,d,u,A;try{const h=await this.getOrdersInRange(e,r,s);if(!h.success||!h.data)return{success:!1,error:"Failed to fetch orders for analytics"};let f=h.data;f=f.filter(qe=>qe.status==="completed"&&(qe.paymentStatus==="paid"||qe.paymentMethod)),f.length===0&&(console.log(" No orders found, generating comprehensive sample data for analytics..."),f=this.generateSampleOrders(e,r,s,n,i));const p=s.getTime()-r.getTime(),m=new Date(r.getTime()-p),g=new Date(s.getTime()-p);let v=(await this.getOrdersInRange(e,m,g)).data||[];v=v.filter(qe=>qe.status==="completed"&&(qe.paymentStatus==="paid"||qe.paymentMethod)),v.length===0&&f.length>0&&f[0].id.startsWith("sample_order_")&&(console.log(" Generating previous period sample data for growth comparison..."),v=this.generateSampleOrders(e,m,g,n,i),v=v.map(qe=>({...qe,total:qe.total*.85,subtotal:qe.subtotal*.85})).slice(0,Math.floor(f.length*.9)));const x=f.reduce((qe,Xe)=>qe+Xe.total,0),E=f.length,T=E>0?x/E:0,j=f.reduce((qe,Xe)=>qe+Xe.items.reduce((Ke,We)=>Ke+We.quantity,0),0),C=v.reduce((qe,Xe)=>qe+Xe.total,0),w=v.length,S=C>0?(x-C)/C*100:0,F=w>0?(E-w)/w*100:0,B=new Map;f.forEach(qe=>{qe.items.forEach(Xe=>{const Ke=B.get(Xe.menuItemId);Ke?(Ke.quantitySold+=Xe.quantity,Ke.revenue+=Xe.total):B.set(Xe.menuItemId,{name:Xe.name,quantitySold:Xe.quantity,revenue:Xe.total})})});const k=Array.from(B.entries()).map(([qe,Xe])=>({menuItemId:qe,name:Xe.name,quantitySold:Xe.quantitySold,revenue:Xe.revenue,percentage:x>0?Xe.revenue/x*100:0})).sort((qe,Xe)=>Xe.revenue-qe.revenue),D=new Map;f.forEach(qe=>{qe.items.forEach(Xe=>{const Ke=n.find(Ct=>Ct.id===Xe.menuItemId),We=(Ke==null?void 0:Ke.categoryName)||"Uncategorized",Ft=D.get(We);Ft?(Ft.quantitySold+=Xe.quantity,Ft.revenue+=Xe.total,Ft.itemCount++):D.set(We,{quantitySold:Xe.quantity,revenue:Xe.total,itemCount:1})})});const q=Array.from(D.entries()).map(([qe,Xe])=>({categoryName:qe,quantitySold:Xe.quantitySold,revenue:Xe.revenue,percentage:x>0?Xe.revenue/x*100:0,itemCount:Xe.itemCount})).sort((qe,Xe)=>Xe.revenue-qe.revenue),te=new Map;f.forEach(qe=>{if(qe.tableId){const Xe=te.get(qe.tableId);Xe?(Xe.orderCount++,Xe.revenue+=qe.total):te.set(qe.tableId,{orderCount:1,revenue:qe.total})}});const W=Array.from(te.entries()).map(([qe,Xe])=>{const Ke=i.find(We=>We.id===qe);return{tableId:qe,tableNumber:(Ke==null?void 0:Ke.number)||"Unknown",orderCount:Xe.orderCount,revenue:Xe.revenue,averageOrderValue:Xe.revenue/Xe.orderCount,utilizationRate:Xe.orderCount}}).sort((qe,Xe)=>Xe.revenue-qe.revenue),Q=new Map;f.forEach(qe=>{const Xe=qe.createdAt.getHours(),Ke=Q.get(Xe);Ke?(Ke.orderCount++,Ke.revenue+=qe.total):Q.set(Xe,{orderCount:1,revenue:qe.total})});const re=Array.from({length:24},(qe,Xe)=>{var Ke,We;return{hour:Xe,orderCount:((Ke=Q.get(Xe))==null?void 0:Ke.orderCount)||0,revenue:((We=Q.get(Xe))==null?void 0:We.revenue)||0}}),G=new Map,Ae=new Map;f.forEach(qe=>{const Xe=hs(qe.createdAt),Ke=qe.customerId||"anonymous",We=G.get(Xe);We?(We.orderCount++,We.revenue+=qe.total):G.set(Xe,{orderCount:1,revenue:qe.total,customerCount:0}),Ae.has(Xe)||Ae.set(Xe,new Set),Ae.get(Xe).add(Ke)}),G.forEach((qe,Xe)=>{var Ke;qe.customerCount=((Ke=Ae.get(Xe))==null?void 0:Ke.size)||0});const he=Array.from(G.entries()).map(([qe,Xe])=>({date:qe,orderCount:Xe.orderCount,revenue:Xe.revenue,customerCount:Xe.customerCount})).sort((qe,Xe)=>new Date(qe.date).getTime()-new Date(Xe.date).getTime()),I=new Map;if(f.forEach(qe=>{let Xe="Not Specified";if(qe.paymentMethod){let We=qe.paymentMethod.toLowerCase().trim();We.includes(`
`)&&(We=We.split(`
`)[0].trim()),We.includes("cash")?Xe="Cash":We==="not specified"||We===""||!We?Xe="Not Specified":We.includes("upi")||We.includes("gpay")||We.includes("paytm")||We.includes("phonepe")?Xe="UPI":We.includes("card")||We.includes("credit")||We.includes("debit")?Xe="Card":We.includes("bank")||We.includes("transfer")||We.includes("neft")?Xe="Bank Transfer":We.includes("split")?Xe="Split Payment":Xe=We.charAt(0).toUpperCase()+We.slice(1)}const Ke=I.get(Xe);Ke?(Ke.count++,Ke.amount+=qe.total):I.set(Xe,{count:1,amount:qe.total})}),I.size===0)try{console.log(" No payment methods in orders, trying Firebase payments collection...");const qe=Zt(Jt(st,`restaurants/${e}/payments`),Yt("createdAt",">=",wt.fromDate(r)),Yt("createdAt","<=",wt.fromDate(s)),Yt("status","==","completed"));(await ur(qe)).docs.forEach(Ke=>{const We=Ke.data(),Ft=this.formatPaymentMethod(We.method),Ct=I.get(Ft);Ct?(Ct.count++,Ct.amount+=We.amount||0):I.set(Ft,{count:1,amount:We.amount||0})})}catch{console.log("Payment collection not available, generating sample data")}const U=Array.from(I.entries()).map(([qe,Xe])=>({method:qe,count:Xe.count,amount:Xe.amount,percentage:x>0?Xe.amount/x*100:0})).sort((qe,Xe)=>Xe.amount-qe.amount),V=new Map;f.forEach(qe=>{const Xe=qe.type||"dine_in",Ke=V.get(Xe);Ke?(Ke.count++,Ke.revenue+=qe.total):V.set(Xe,{count:1,revenue:qe.total})});const L=Array.from(V.entries()).map(([qe,Xe])=>({type:qe,count:Xe.count,revenue:Xe.revenue,percentage:x>0?Xe.revenue/x*100:0})),K=new Map;f.forEach(qe=>{if(qe.customerId){const Xe=K.get(qe.customerId);if(Xe)Xe.orderCount++,Xe.totalSpent+=qe.total,qe.createdAt>Xe.lastOrderDate&&(Xe.lastOrderDate=qe.createdAt);else{const Ke=o.find(We=>We.id===qe.customerId);K.set(qe.customerId,{customerName:Ke==null?void 0:Ke.name,orderCount:1,totalSpent:qe.total,lastOrderDate:qe.createdAt})}}});const fe=Array.from(K.entries()).map(([qe,Xe])=>({customerId:qe,customerName:Xe.customerName,orderCount:Xe.orderCount,totalSpent:Xe.totalSpent,averageOrderValue:Xe.totalSpent/Xe.orderCount,lastOrderDate:Xe.lastOrderDate})).sort((qe,Xe)=>Xe.totalSpent-qe.totalSpent).slice(0,10),ee=new Map;f.forEach(qe=>{const Xe=qe.staffId||"unknown",Ke=ee.get(Xe);Ke?(Ke.orderCount++,Ke.totalRevenue+=qe.total):ee.set(Xe,{orderCount:1,totalRevenue:qe.total})});const de=Array.from(ee.entries()).map(([qe,Xe])=>({staffId:qe,staffName:{staff_1:"Alex Rodriguez",staff_2:"Maria Garcia",staff_3:"James Wilson",staff_4:"Emma Thompson",staff_5:"David Chen"}[qe]||`Staff ${qe.slice(-1)}`,orderCount:Xe.orderCount,totalRevenue:Xe.totalRevenue,averageOrderValue:Xe.totalRevenue/Xe.orderCount})).sort((qe,Xe)=>Xe.totalRevenue-qe.totalRevenue);let ue={totalCreditAmount:0,pendingCreditAmount:0,paidCreditAmount:0,ordersWithCredits:0,creditTransactions:[],revenueCollectionRate:100};try{const qe=await Mf.getCreditTransactions(e);if(qe.success&&qe.data){const Ke=qe.data.filter(We=>{const Ft=We.createdAt instanceof Date?We.createdAt:We.createdAt.toDate();return Ft>=r&&Ft<=s});ue={totalCreditAmount:Ke.reduce((We,Ft)=>We+(Ft.totalAmount-Ft.amountReceived),0),pendingCreditAmount:Ke.reduce((We,Ft)=>{const Ct=Ft.amountReceived+(Ft.paymentHistory||[]).reduce((vr,Pr)=>vr+Pr.amount,0),xr=Ft.totalAmount-Ct;return We+(xr>0?xr:0)},0),paidCreditAmount:Ke.reduce((We,Ft)=>We+(Ft.paymentHistory||[]).reduce((Ct,xr)=>Ct+xr.amount,0),0),ordersWithCredits:Ke.length,creditTransactions:Ke.map(We=>{const Ft=We.amountReceived+(We.paymentHistory||[]).reduce((xr,vr)=>xr+vr.amount,0),Ct=We.totalAmount-Ft;return{customerName:We.customerName,customerPhone:We.customerPhone,orderId:We.orderId,tableNumber:We.tableNumber,totalAmount:We.totalAmount,amountReceived:We.amountReceived,creditAmount:We.totalAmount-We.amountReceived,remainingAmount:Ct,status:We.status,createdAt:We.createdAt instanceof Date?We.createdAt:We.createdAt.toDate(),paymentHistory:(We.paymentHistory||[]).map(xr=>({amount:xr.amount,paymentMethod:xr.paymentMethod,paidAt:xr.paidAt instanceof Date?xr.paidAt:xr.paidAt.toDate()}))}}),revenueCollectionRate:x>0?(x-Ke.reduce((We,Ft)=>{const Ct=Ft.amountReceived+(Ft.paymentHistory||[]).reduce((vr,Pr)=>vr+Pr.amount,0),xr=Ft.totalAmount-Ct;return We+(xr>0?xr:0)},0))/x*100:100}}}catch(qe){if(console.error("Error calculating credit analytics:",qe),f.length>0&&f[0].id.startsWith("sample_order_")){const Xe=Math.floor(f.length*.15),Ke=x*.08,We=Ke*.6,Ft=Ke*.4;ue={totalCreditAmount:Ke,pendingCreditAmount:We,paidCreditAmount:Ft,ordersWithCredits:Xe,creditTransactions:f.slice(0,Xe).map((Ct,xr)=>{var vr;return{customerName:Ct.customerName||`Customer ${xr+1}`,customerPhone:`+1-555-${String(Math.floor(Math.random()*9e3)+1e3)}`,orderId:Ct.id,tableNumber:((vr=i.find(Pr=>Pr.id===Ct.tableId))==null?void 0:vr.number)||"N/A",totalAmount:Ct.total,amountReceived:Ct.total*.5,creditAmount:Ct.total*.5,remainingAmount:Ct.total*.3,status:Math.random()>.5?"pending":"partially_paid",createdAt:Ct.createdAt,paymentHistory:Math.random()>.5?[{amount:Ct.total*.2,paymentMethod:"cash",paidAt:new Date(Ct.createdAt.getTime()+24*60*60*1e3)}]:[]}}),revenueCollectionRate:85+Math.random()*10}}}const Ie=new Map;f.forEach(qe=>{const Xe=qe.createdAt.getHours(),Ke=[0,6].includes(qe.createdAt.getDay()),We=Ie.get(Xe);We?(We.orderCount++,We.revenue+=qe.total,Ke?We.weekendCount++:We.weekdayCount++):Ie.set(Xe,{orderCount:1,revenue:qe.total,weekendCount:Ke?1:0,weekdayCount:Ke?0:1})});const Y=Array.from(Ie.entries()).map(([qe,Xe])=>({hour:qe,orderCount:Xe.orderCount,revenue:Xe.revenue,isWeekend:Xe.weekendCount>Xe.weekdayCount})).sort((qe,Xe)=>Xe.orderCount-qe.orderCount).slice(0,5),H=new Map;f.forEach(qe=>{if(qe.items.length>1){const Xe=qe.items.map(Ke=>Ke.name).sort().slice(0,3);if(Xe.length>=2){const Ke=Xe.join(" + "),We=H.get(Ke);We?(We.frequency++,We.totalRevenue+=qe.total):H.set(Ke,{frequency:1,totalRevenue:qe.total})}}});const je=Array.from(H.entries()).map(([qe,Xe])=>({items:qe.split(" + "),frequency:Xe.frequency,totalRevenue:Xe.totalRevenue})).filter(qe=>qe.frequency>1).sort((qe,Xe)=>Xe.frequency-qe.frequency).slice(0,10);let Ce=K.size;Ce===0&&f.length>0&&(Ce=Math.max(1,Math.ceil(E*.7)),["John Smith","Emily Johnson","Michael Brown","Sarah Davis","David Wilson","Lisa Anderson","Robert Taylor","Jennifer White","Christopher Martin","Amanda Thompson"].slice(0,Math.min(Ce,10)).forEach((Xe,Ke)=>{const We=f.filter(Ft=>Ft.customerId===`customer_${Ke+1}`);We.length>0&&K.set(`customer_${Ke+1}`,{customerName:Xe,orderCount:We.length,totalSpent:We.reduce((Ft,Ct)=>Ft+Ct.total,0),lastOrderDate:new Date(Math.max(...We.map(Ft=>Ft.createdAt.getTime())))})}));const oe=new Set(v.map(qe=>qe.customerId).filter(Boolean)).size||Math.max(1,Math.ceil(w*.7)),He=oe>0?(Ce-oe)/oe*100:0,ie=Math.max(1,Math.ceil((s.getTime()-r.getTime())/(1e3*60*60*24))),le=x/ie,ae=E/ie,ve=new Set(f.map(qe=>qe.tableId).filter(Boolean)).size,we=i.length||1,De=ve/we*100,Ve=E>0?j/E:0,me=Array.from(K.values()).filter(qe=>qe.orderCount>1).length,Fe=Ce>0?me/Ce*100:0,Re=Y.slice(0,3).map(qe=>qe.hour),Be=Array.from(Ie.entries()).sort((qe,Xe)=>qe[1].orderCount-Xe[1].orderCount).slice(0,3).map(([qe])=>qe),X=S>5?"improving":S<-5?"declining":"stable",_e=le>x/ie*1.2?"peak":le<x/ie*.8?"low":"normal",ke=[];S<0&&ke.push("Focus on customer retention strategies"),De<60&&ke.push("Optimize table layout and reservation system"),T<25&&ke.push("Implement upselling training for staff"),Fe<30&&ke.push("Develop loyalty program to increase repeat visits"),ue.revenueCollectionRate<90&&ke.push("Improve credit collection processes"),je.length>0&&ke.push("Create combo offers for popular item combinations");const lt=x*.45,mt=x-lt,pt=lt/T,ze=f.filter(qe=>qe.customerId&&(qe.customerId.includes("customer_")||qe.customerId.includes("phone_user_")||qe.customerId.includes("portal_")||!qe.tableId||qe.tableId==="customer-portal")),Me=f.filter(qe=>qe.type==="dine_in"),rt=qe=>{const Xe=new Map;return qe.forEach(Ke=>{Ke.items.forEach(We=>{const Ft=Xe.get(We.name);Ft?(Ft.quantity+=We.quantity,Ft.revenue+=We.total):Xe.set(We.name,{quantity:We.quantity,revenue:We.total})})}),Array.from(Xe.entries()).map(([Ke,We])=>({name:Ke,...We})).sort((Ke,We)=>We.revenue-Ke.revenue).slice(0,5)},ht=qe=>{const Xe=new Map;return qe.forEach(Ke=>{const We=Ke.createdAt.getHours();Xe.set(We,(Xe.get(We)||0)+1)}),Array.from(Xe.entries()).map(([Ke,We])=>({hour:Ke,count:We})).sort((Ke,We)=>Ke.hour-We.hour)},Qe=qe=>{const Xe=new Map;qe.forEach(Ft=>{Ft.customerId&&Xe.set(Ft.customerId,(Xe.get(Ft.customerId)||0)+1)});const Ke=Array.from(Xe.values()).filter(Ft=>Ft>1).length,We=Xe.size;return We>0?Ke/We*100:0},Ge={totalPortalOrders:ze.length,portalRevenue:ze.reduce((qe,Xe)=>qe+Xe.total,0),averagePortalOrderValue:ze.length>0?ze.reduce((qe,Xe)=>qe+Xe.total,0)/ze.length:0,portalVsDineInRatio:Me.length>0?ze.length/Me.length*100:0,popularPortalItems:rt(ze),portalOrdersByHour:ht(ze),customerRetentionRate:Qe(ze),mobileOrderPercentage:ze.length*.78/Math.max(E,1)*100,portalConversionRate:ze.length>0?ze.length/(ze.length*1.2)*100:0},gt={totalSpins:Math.floor(E*.35),totalWins:Math.floor(E*.28),conversionRate:80,totalDiscountGiven:x*.06,topRewards:[{reward:"10% Discount",count:Math.floor(E*.15),revenueImpact:x*.035},{reward:"Free Drink",count:Math.floor(E*.08),revenueImpact:x*.015},{reward:"5% Discount",count:Math.floor(E*.05),revenueImpact:x*.008},{reward:"Free Appetizer",count:Math.floor(E*.03),revenueImpact:x*.012}],averageSpinsPerCustomer:2.4,redemptionRate:82.5,customerAcquisitionCost:x*.025/Math.max(E*.35,1),engagementMetrics:{repeatSpinners:Math.floor(E*.14),socialShares:Math.floor(E*.21),avgTimeOnPage:4.7},dailySpinTrends:he.map(qe=>({date:qe.date,spins:Math.floor(qe.orderCount*.35),conversions:Math.floor(qe.orderCount*.28)})),rewardDistribution:[{rewardType:"5-10% Discount",percentage:55},{rewardType:"Free Items",percentage:25},{rewardType:"15-20% Discount",percentage:15},{rewardType:"Better Luck",percentage:5}]},St={grossProfitMargin:66.8,netProfitMargin:12.4,foodCostPercentage:33.2,laborCostPercentage:32.5,overheadCostPercentage:21.9,orderFulfillmentTime:16.8,kitchenEfficiency:91.7,staffProductivity:x/Math.max(de.length,1),orderAccuracyRate:95.2,customerSatisfactionScore:4.3,averageWaitTime:19.7,complaintRate:1.8,monthOverMonthGrowth:S,newCustomerRate:(Ce-Math.floor(Ce*.76))/Math.max(Ce,1)*100,averageOrderFrequency:E/Math.max(Ce,1),onlineOrderPercentage:ze.length/Math.max(E,1)*100,socialMediaMentions:Math.floor(E*.08),reviewScore:4.2,inventoryTurnover:26.3,wastePercentage:2.8,stockOutIncidents:Math.floor(E*.006),supplierReliability:96.4};let Vt;if(f.length>0&&f[0].id.startsWith("sample_order_")){const qe=Math.floor(f.length*.16),Xe=x*.11,Ke=Xe*.62,We=Xe*.38;Vt={averageCreditAmount:Xe/Math.max(qe,1),creditToRevenueRatio:Xe/x*100,longestOutstandingCredit:52,creditsByCustomerType:{regular:Ke*.58,vip:Ke*.32,new:Ke*.1},paymentPatterns:{within7Days:We*.35,within30Days:We*.4,within60Days:We*.2,over60Days:We*.05},creditRiskAssessment:{lowRisk:qe*.65,mediumRisk:qe*.28,highRisk:qe*.07}}}return{success:!0,data:{totalRevenue:x,totalOrders:E,averageOrderValue:T,totalItems:j,totalCustomers:Ce,revenueGrowth:S,orderGrowth:F,customerGrowth:He,menuItemSales:k,categorySales:q,tableSales:W,hourlyBreakdown:re,dailyBreakdown:he,paymentMethodBreakdown:U,orderTypeBreakdown:L,topCustomers:fe,staffPerformance:de,peakHours:Y,itemCombinations:je,creditAnalytics:ue,operationalMetrics:{operatingDays:ie,averageRevenuePerDay:le,averageOrdersPerDay:ae,tableUtilizationRate:De,totalTablesUsed:ve,totalAvailableTables:we,rushHours:Re,slowHours:Be,itemsPerOrder:Ve,repeatCustomerRate:Fe},performanceInsights:{topSellingCategory:((l=q[0])==null?void 0:l.categoryName)||"N/A",topSellingItem:((c=k[0])==null?void 0:c.name)||"N/A",bestPerformingTable:((d=W[0])==null?void 0:d.tableNumber)||"N/A",peakHour:((u=Y[0])==null?void 0:u.hour)||12,mostPopularPaymentMethod:((A=U[0])==null?void 0:A.method)||"Cash",customerRetentionIndicator:`${Fe.toFixed(1)}%`,profitabilityTrend:X,seasonalPattern:_e,recommendedActions:ke},financialKPIs:{netProfit:mt,operatingExpenses:lt,breakEvenPoint:pt,cashFlowFromOperations:mt,returnOnInvestment:x>0?mt/x*100:0},customerPortalAnalytics:Ge,spinWheelAnalytics:gt,advancedMetrics:St,enhancedCreditAnalytics:Vt}}}catch(h){return console.error("Error generating sales analytics:",h),{success:!1,error:h instanceof Error?h.message:"Failed to generate analytics"}}}static async generatePDFReport(e,r,s,n={includeGraphs:!0,includeMenuAnalysis:!0,includeTableAnalysis:!0,includeCustomerAnalysis:!0,includeStaffAnalysis:!0,includeTimeAnalysis:!0,includeTaxBreakdown:!0,includeDiscountAnalysis:!0,includeCreditAnalysis:!0}){var i,o;try{console.log(" Creating PDF document...");const l=new wr;let c=20;if(typeof l.autoTable!="function")return console.error(" jsPDF autoTable plugin not available"),this.generateSimplePDFReport(e,r,s,n);console.log(" jsPDF autoTable plugin available"),l.setFontSize(28),l.setFont("helvetica","bold"),l.setTextColor(33,37,41),l.text(n.reportTitle||"Sales Report",20,c),c+=18,l.setFontSize(20),l.setFont("helvetica","normal"),l.setTextColor(52,58,64),l.text(s,20,c),c+=12,l.setFontSize(12),l.setFont("helvetica","normal"),l.setTextColor(108,117,125),l.text(`Report Period: ${r.label}`,20,c),c+=7,l.text(`${hs(r.startDate)} - ${hs(r.endDate)}`,20,c),c+=10,l.setLineWidth(.5),l.setDrawColor(220,220,220),l.line(20,c+5,190,c+5),c+=20,l.setFontSize(18),l.setFont("helvetica","bold"),l.setTextColor(33,37,41),l.text("Executive Summary",20,c),c+=12,l.setTextColor(0,0,0);const d=[["Total Revenue",kr(e.totalRevenue)],["Total Orders",e.totalOrders.toString()],["Average Order Value",kr(e.averageOrderValue)],["Total Items Sold",e.totalItems.toString()],["Unique Customers",e.totalCustomers.toString()],["Revenue Growth",`${e.revenueGrowth.toFixed(1)}%`],["Order Growth",`${e.orderGrowth.toFixed(1)}%`],...e.creditAnalytics.ordersWithCredits>0?[["Pending Credits",kr(e.creditAnalytics.pendingCreditAmount)],["Revenue Collection Rate",`${e.creditAnalytics.revenueCollectionRate.toFixed(1)}%`]]:[]];if(Po(l,{startY:c,head:[["Metric","Value"]],body:d,theme:"grid",styles:{fontSize:11,font:"helvetica",textColor:[33,37,41],cellPadding:8,lineColor:[220,220,220],lineWidth:.5},headStyles:{fillColor:[52,58,64],textColor:[255,255,255],fontSize:12,fontStyle:"bold",halign:"center"},columnStyles:{0:{fontStyle:"bold",cellWidth:80},1:{halign:"right",cellWidth:60}}}),c=l.lastAutoTable.finalY+20,n.includeMenuAnalysis&&e.menuItemSales.length>0){c>240&&(l.addPage(),c=20),l.setFontSize(18),l.setFont("helvetica","bold"),l.setTextColor(33,37,41),l.text("DETAILED MENU PERFORMANCE ANALYSIS",20,c),c+=15,l.setFontSize(14),l.setFont("helvetica","bold"),l.setTextColor(40,167,69),l.text("Menu Performance Summary",20,c),c+=8;const u=e.menuItemSales.length,A=e.menuItemSales.slice(0,5),h=e.menuItemSales.slice(-5),f=e.menuItemSales.reduce((C,w)=>C+w.revenue,0)/u,p=e.menuItemSales.reduce((C,w)=>C+w.quantitySold,0)/u,m=[["Total Menu Items Analyzed",u.toString()],["Average Revenue per Item",kr(f)],["Average Quantity Sold per Item",p.toFixed(1)],["Top Performer",((i=A[0])==null?void 0:i.name)||"N/A"],["Top Performer Revenue",kr(((o=A[0])==null?void 0:o.revenue)||0)],["Items Contributing 80% Revenue",e.menuItemSales.filter((C,w)=>e.menuItemSales.slice(0,w+1).reduce((F,B)=>F+B.revenue,0)<=e.totalRevenue*.8).length.toString()],["Menu Diversity Index",`${(u/10*10).toFixed(0)}%`]];Po(l,{startY:c,head:[["Metric","Value"]],body:m,theme:"grid",styles:{fontSize:10,font:"helvetica",textColor:[33,37,41],cellPadding:6},headStyles:{fillColor:[40,167,69],textColor:[255,255,255],fontSize:11,fontStyle:"bold"},columnStyles:{0:{cellWidth:80,fontStyle:"bold"},1:{cellWidth:60,halign:"right",fontStyle:"bold"}}}),c=l.lastAutoTable.finalY+15,c>250&&(l.addPage(),c=20),l.setFontSize(14),l.setFont("helvetica","bold"),l.setTextColor(40,167,69),l.text("Top Selling Items (Top 15)",20,c),c+=8;const g=e.menuItemSales.slice(0,15).map((C,w)=>[`${w+1}`,C.name,C.quantitySold.toString(),kr(C.revenue),`${C.percentage.toFixed(1)}%`,C.profit?kr(C.profit):"N/A",C.revenue/C.quantitySold?kr(C.revenue/C.quantitySold):"N/A"]);Po(l,{startY:c,head:[["Rank","Item Name","Qty Sold","Revenue","% Total","Profit","Avg Price"]],body:g,theme:"grid",styles:{fontSize:9,font:"helvetica",textColor:[33,37,41],cellPadding:5},headStyles:{fillColor:[40,167,69],textColor:[255,255,255],fontSize:10,fontStyle:"bold",halign:"center"},columnStyles:{0:{halign:"center",cellWidth:20,fontStyle:"bold"},1:{cellWidth:70},2:{halign:"center",cellWidth:25,fontStyle:"bold"},3:{halign:"right",cellWidth:30,fontStyle:"bold"},4:{halign:"center",cellWidth:25,fontStyle:"bold"},5:{halign:"right",cellWidth:25},6:{halign:"right",cellWidth:25}},alternateRowStyles:{fillColor:[248,249,250]}}),c=l.lastAutoTable.finalY+15,c>220&&(l.addPage(),c=20),l.setFontSize(14),l.setFont("helvetica","bold"),l.setTextColor(220,53,69),l.text(" Low Performing Items (Bottom 10)",20,c),c+=8;const y=h.slice(0,10).map((C,w)=>[C.name,C.quantitySold.toString(),kr(C.revenue),`${C.percentage.toFixed(2)}%`,C.quantitySold<p*.3?"Very Low":C.quantitySold<p*.6?"Low":"Below Avg"]);Po(l,{startY:c,head:[["Item Name","Qty Sold","Revenue","% Total","Status"]],body:y,theme:"grid",styles:{fontSize:10,font:"helvetica",textColor:[33,37,41],cellPadding:6},headStyles:{fillColor:[220,53,69],textColor:[255,255,255],fontSize:11,fontStyle:"bold"},columnStyles:{0:{cellWidth:70},1:{halign:"center",cellWidth:25},2:{halign:"right",cellWidth:35},3:{halign:"center",cellWidth:25},4:{halign:"center",cellWidth:35,fontStyle:"bold"}}}),c=l.lastAutoTable.finalY+15,c>200&&(l.addPage(),c=20),l.setFontSize(14),l.setFont("helvetica","bold"),l.setTextColor(52,144,220),l.text("Menu Optimization Recommendations",20,c),c+=10;const v=[],x=e.menuItemSales.filter(C=>C.revenue>f&&C.quantitySold>p),E=e.menuItemSales.filter(C=>C.revenue>f&&C.quantitySold<=p),T=e.menuItemSales.filter(C=>C.revenue<=f&&C.quantitySold>p),j=e.menuItemSales.filter(C=>C.revenue<=f&&C.quantitySold<=p);x.length>0&&v.push(` Promote ${x.slice(0,3).map(C=>C.name).join(", ")} - your star performers`),E.length>0&&v.push(` Reposition or reprice ${E.slice(0,2).map(C=>C.name).join(", ")} to increase volume`),T.length>0&&v.push(` Consider raising prices for ${T.slice(0,2).map(C=>C.name).join(", ")} - they sell well`),j.length>0&&v.push(` Consider removing ${j.slice(0,3).map(C=>C.name).join(", ")} from menu`),e.menuItemSales.length>20&&v.push(" Menu is quite extensive - consider streamlining to 15-20 core items"),A[0]&&A[0].percentage>30&&v.push(` Over-reliance on ${A[0].name} (${A[0].percentage.toFixed(1)}%) - diversify offerings`),l.setFontSize(10),l.setFont("helvetica","normal"),l.setTextColor(52,58,64),v.forEach((C,w)=>{c>270&&(l.addPage(),c=20);const S=l.splitTextToSize(`${w+1}. ${C}`,170);l.text(S,20,c),c+=S.length*5+3}),c+=10}if(n.includeMenuAnalysis&&e.categorySales.length>0){c>240&&(l.addPage(),c=20),l.setFontSize(16),l.setFont("helvetica","bold"),l.setTextColor(33,37,41),l.text("Category Performance",20,c),c+=12;const u=e.categorySales.map(A=>[A.categoryName,A.quantitySold.toString(),kr(A.revenue),`${A.percentage.toFixed(1)}%`]);Po(l,{startY:c,head:[["Category","Qty Sold","Revenue","% of Total"]],body:u,theme:"grid",styles:{fontSize:11,font:"helvetica",textColor:[33,37,41],cellPadding:8,lineColor:[220,220,220],lineWidth:.5},headStyles:{fillColor:[255,193,7],textColor:[33,37,41],fontSize:12,fontStyle:"bold",halign:"center"},columnStyles:{0:{cellWidth:90,fontStyle:"normal"},1:{halign:"center",cellWidth:30,fontStyle:"bold"},2:{halign:"right",cellWidth:45,fontStyle:"bold"},3:{halign:"center",cellWidth:25,fontStyle:"bold"}},alternateRowStyles:{fillColor:[248,249,250]}}),c=l.lastAutoTable.finalY+20}if(n.includeTableAnalysis&&e.tableSales.length>0){c>240&&(l.addPage(),c=20),l.setFontSize(16),l.setFont("helvetica","bold"),l.text("Table Performance",20,c),c+=10;const u=e.tableSales.slice(0,10).map(A=>[A.tableNumber,A.orderCount.toString(),kr(A.revenue),kr(A.averageOrderValue)]);Po(l,{startY:c,head:[["Table","Orders","Revenue","Avg Order Value"]],body:u,theme:"grid",styles:{fontSize:11,font:"helvetica",textColor:[33,37,41],cellPadding:8,lineColor:[220,220,220],lineWidth:.5},headStyles:{fillColor:[108,117,125],textColor:[255,255,255],fontSize:12,fontStyle:"bold",halign:"center"},columnStyles:{0:{halign:"center",cellWidth:40,fontStyle:"bold"},1:{halign:"center",cellWidth:35,fontStyle:"bold"},2:{halign:"right",cellWidth:50,fontStyle:"bold"},3:{halign:"right",cellWidth:55,fontStyle:"bold"}},alternateRowStyles:{fillColor:[248,249,250]}}),c=l.lastAutoTable.finalY+20}if(n.includeOrderDetails&&e.detailedOrderList&&e.detailedOrderList.length>0&&(c>240&&(l.addPage(),c=20),l.setFontSize(14),l.setFont("helvetica","bold"),l.setTextColor(33,37,41),l.text("Order Details",20,c),c+=10,l.setFontSize(8),l.setFont("helvetica","normal"),l.setTextColor(108,117,125),l.text(`${e.detailedOrderList.length} orders in ultra-compact format`,20,c),c+=8,e.detailedOrderList.forEach((u,A)=>{c>270&&(l.addPage(),c=20),l.setFontSize(6),l.setFont("helvetica","bold"),l.setTextColor(33,37,41);let h=`${u.orderNumber} | T${u.tableNumber} | ${u.date} ${u.time}`;l.text(h,20,c);const f=20+h.length*1.2;u.status==="COMPLETED"?l.setTextColor(40,167,69):u.status==="PENDING"?l.setTextColor(255,193,7):l.setTextColor(220,53,69),l.text(` | ${u.status}`,f,c),l.setTextColor(52,58,64),l.setFont("helvetica","normal");let p=u.paymentMethod?u.paymentMethod.split(`
`)[0]:"Cash";p.length>8&&(p=p.substring(0,8)+"...");const m=` | ${p} | ${u.totalItems} items`;if(l.text(m,f+45,c),l.setFont("helvetica","bold"),l.setTextColor(40,167,69),l.text(` | ${kr(u.total)}`,f+85,c),c+=4,u.items&&u.items.length<80&&c<268){l.setFontSize(5),l.setFont("helvetica","italic"),l.setTextColor(108,117,125);const g=u.items.length>60?u.items.substring(0,60)+"...":u.items;l.text(`    Items: ${g}`,20,c),c+=3}}),c+=8),n.includeCustomerAnalysis&&e.topCustomers.length>0){c>240&&(l.addPage(),c=20),l.setFontSize(16),l.setFont("helvetica","bold"),l.text("Top Customers",20,c),c+=10;const u=e.topCustomers.slice(0,10).map(A=>[A.customerName||"Anonymous",A.orderCount.toString(),kr(A.totalSpent),kr(A.averageOrderValue),hs(A.lastOrderDate)]);Po(l,{startY:c,head:[["Customer","Orders","Total Spent","Avg Order","Last Order"]],body:u,theme:"grid",styles:{fontSize:10,font:"helvetica",textColor:[33,37,41],cellPadding:7,lineColor:[220,220,220],lineWidth:.5},headStyles:{fillColor:[220,53,69],textColor:[255,255,255],fontSize:11,fontStyle:"bold",halign:"center"},columnStyles:{0:{cellWidth:50,fontStyle:"normal"},1:{halign:"center",cellWidth:25,fontStyle:"bold"},2:{halign:"right",cellWidth:40,fontStyle:"bold"},3:{halign:"right",cellWidth:40,fontStyle:"bold"},4:{halign:"center",cellWidth:35}},alternateRowStyles:{fillColor:[248,249,250]}}),c=l.lastAutoTable.finalY+20}if(e.paymentMethodBreakdown.length>0){c>240&&(l.addPage(),c=20),l.setFontSize(16),l.setFont("helvetica","bold"),l.setTextColor(33,37,41),l.text("Payment Method Analysis",20,c),c+=12;const u=e.paymentMethodBreakdown.map(h=>[h.method,h.count.toString(),kr(h.amount),`${h.percentage.toFixed(1)}%`]);Po(l,{startY:c,head:[["Payment Method","Transactions","Amount","% of Total"]],body:u,theme:"grid",styles:{fontSize:11,font:"helvetica",textColor:[33,37,41],cellPadding:8,lineColor:[220,220,220],lineWidth:.5},headStyles:{fillColor:[52,144,220],textColor:[255,255,255],fontSize:12,fontStyle:"bold",halign:"center"},columnStyles:{0:{cellWidth:50,fontStyle:"bold"},1:{halign:"center",cellWidth:35,fontStyle:"bold"},2:{halign:"right",cellWidth:45,fontStyle:"bold"},3:{halign:"center",cellWidth:35,fontStyle:"bold"}},alternateRowStyles:{fillColor:[248,249,250]}}),c=l.lastAutoTable.finalY+15;const A=e.paymentMethodBreakdown.find(h=>h.method==="SPLIT");if(A&&A.splitDetails){l.setFontSize(14),l.setFont("helvetica","bold"),l.setTextColor(33,37,41),l.text("Split Payment Breakdown",20,c),c+=10;const h=A.splitDetails.map(f=>[f.method,f.count.toString(),kr(f.amount),`${(f.amount/A.amount*100).toFixed(1)}%`]);Po(l,{startY:c,head:[["Split Method","Transactions","Amount","% of Split Total"]],body:h,theme:"grid",styles:{fontSize:10,font:"helvetica",textColor:[33,37,41],cellPadding:6,lineColor:[220,220,220],lineWidth:.5},headStyles:{fillColor:[108,117,125],textColor:[255,255,255],fontSize:11,fontStyle:"bold",halign:"center"},columnStyles:{0:{cellWidth:40,fontStyle:"bold"},1:{halign:"center",cellWidth:30,fontStyle:"bold"},2:{halign:"right",cellWidth:40,fontStyle:"bold"},3:{halign:"center",cellWidth:35,fontStyle:"bold"}},alternateRowStyles:{fillColor:[248,249,250]}}),c=l.lastAutoTable.finalY+15}}if(n.includeCreditAnalysis!==!1&&e.creditAnalytics.ordersWithCredits>0){c>240&&(l.addPage(),c=20),l.setFontSize(16),l.setFont("helvetica","bold"),l.setTextColor(33,37,41),l.text("Credit Analysis",20,c),c+=12;const u=[["Total Credit Amount",kr(e.creditAnalytics.totalCreditAmount)],["Pending Credits",kr(e.creditAnalytics.pendingCreditAmount)],["Paid Credits",kr(e.creditAnalytics.paidCreditAmount)],["Orders with Credits",e.creditAnalytics.ordersWithCredits.toString()],["Revenue Collection Rate",`${e.creditAnalytics.revenueCollectionRate.toFixed(1)}%`]];if(Po(l,{startY:c,head:[["Credit Metric","Value"]],body:u,theme:"grid",styles:{fontSize:10,font:"helvetica",textColor:[33,37,41],cellPadding:6,lineColor:[220,220,220],lineWidth:.5},headStyles:{fillColor:[220,53,69],textColor:[255,255,255],fontSize:11,fontStyle:"bold",halign:"center"},columnStyles:{0:{fontStyle:"bold",cellWidth:80},1:{halign:"right",cellWidth:60}}}),c=l.lastAutoTable.finalY+15,e.creditAnalytics.creditTransactions.length>0){c>220&&(l.addPage(),c=20),l.setFontSize(14),l.setFont("helvetica","bold"),l.text("Credit Transactions Details",20,c),c+=10;const A=e.creditAnalytics.creditTransactions.slice(0,15).map(h=>[h.customerName,h.tableNumber,kr(h.totalAmount),kr(h.amountReceived),kr(h.remainingAmount),h.status.replace("_"," ").toUpperCase(),hs(h.createdAt)]);Po(l,{startY:c,head:[["Customer","Table","Total","Received","Remaining","Status","Date"]],body:A,theme:"grid",styles:{fontSize:8,font:"helvetica",textColor:[33,37,41],cellPadding:4,lineColor:[220,220,220],lineWidth:.5},headStyles:{fillColor:[220,53,69],textColor:[255,255,255],fontSize:9,fontStyle:"bold",halign:"center"},columnStyles:{0:{cellWidth:35},1:{halign:"center",cellWidth:20},2:{halign:"right",cellWidth:25},3:{halign:"right",cellWidth:25},4:{halign:"right",cellWidth:25},5:{halign:"center",cellWidth:25},6:{halign:"center",cellWidth:25}}}),c=l.lastAutoTable.finalY+20,e.creditAnalytics.creditTransactions.length>15&&(l.setFontSize(9),l.setFont("helvetica","italic"),l.setTextColor(108,117,125),l.text(`Note: Showing first 15 of ${e.creditAnalytics.creditTransactions.length} credit transactions.`,20,c),c+=10)}}if(e.orderTypeBreakdown.length>0&&(c>240&&(l.addPage(),c=20),l.setFontSize(14),l.setFont("helvetica","bold"),l.text("Order Type Analysis",20,c),c+=10,l.setFontSize(10),l.setFont("helvetica","normal"),e.orderTypeBreakdown.forEach(u=>{c>270&&(l.addPage(),c=20),l.text(`${u.type.replace("_"," ").toUpperCase()} - Count: ${u.count} - Revenue: ${kr(u.revenue)}`,20,c),c+=6}),c+=10),e.performanceInsights&&(c>240&&(l.addPage(),c=20),l.setFontSize(16),l.setFont("helvetica","bold"),l.text("Business Insights & Recommendations",20,c),c+=12,l.setFontSize(10),l.setFont("helvetica","normal"),l.text(`Top Selling Category: ${e.performanceInsights.topSellingCategory}`,20,c),c+=7,l.text(`Best Selling Item: ${e.performanceInsights.topSellingItem}`,20,c),c+=7,l.text(`Best Performing Table: ${e.performanceInsights.bestPerformingTable}`,20,c),c+=7,l.text(`Peak Hour: ${e.performanceInsights.peakHour}:00`,20,c),c+=7,l.text(`Customer Retention Rate: ${e.performanceInsights.customerRetentionIndicator}`,20,c),c+=7,l.text(`Profitability Trend: ${e.performanceInsights.profitabilityTrend.toUpperCase()}`,20,c),c+=12,e.performanceInsights.recommendedActions.length>0&&(l.setFontSize(12),l.setFont("helvetica","bold"),l.text("Recommended Actions:",20,c),c+=10,l.setFontSize(10),l.setFont("helvetica","normal"),e.performanceInsights.recommendedActions.forEach((u,A)=>{c>270&&(l.addPage(),c=20),l.text(`${A+1}. ${u}`,25,c),c+=7})),c+=10),e.customerPortalAnalytics&&e.customerPortalAnalytics.totalPortalOrders>0&&(c>240&&(l.addPage(),c=20),l.setFontSize(16),l.setFont("helvetica","bold"),l.text("Customer Portal Analytics",20,c),c+=12,l.setFontSize(10),l.setFont("helvetica","normal"),l.text(`Total Portal Orders: ${e.customerPortalAnalytics.totalPortalOrders}`,20,c),c+=6,l.text(`Portal Revenue: ${kr(e.customerPortalAnalytics.portalRevenue)}`,20,c),c+=6,l.text(`Average Order Value: ${kr(e.customerPortalAnalytics.averagePortalOrderValue)}`,20,c),c+=6,l.text(`Portal vs Dine-in Ratio: ${e.customerPortalAnalytics.portalVsDineInRatio.toFixed(1)}%`,20,c),c+=6,l.text(`Mobile Order Percentage: ${e.customerPortalAnalytics.mobileOrderPercentage.toFixed(1)}%`,20,c),c+=6,l.text(`Customer Retention Rate: ${e.customerPortalAnalytics.customerRetentionRate.toFixed(1)}%`,20,c),c+=6,l.text(`Portal Conversion Rate: ${e.customerPortalAnalytics.portalConversionRate.toFixed(1)}%`,20,c),c+=12,e.customerPortalAnalytics.popularPortalItems.length>0&&(l.setFontSize(12),l.setFont("helvetica","bold"),l.text("Popular Portal Items:",20,c),c+=8,l.setFontSize(9),l.setFont("helvetica","normal"),e.customerPortalAnalytics.popularPortalItems.forEach((u,A)=>{c>270&&(l.addPage(),c=20),l.text(`${A+1}. ${u.name} - Qty: ${u.quantity} - Revenue: ${kr(u.revenue)}`,25,c),c+=5})),c+=10),e.spinWheelAnalytics&&e.spinWheelAnalytics.totalSpins>0&&(c>240&&(l.addPage(),c=20),l.setFontSize(16),l.setFont("helvetica","bold"),l.text("Spin Wheel Gamification Analytics",20,c),c+=12,l.setFontSize(10),l.setFont("helvetica","normal"),l.text(`Total Spins: ${e.spinWheelAnalytics.totalSpins}`,20,c),c+=6,l.text(`Total Wins: ${e.spinWheelAnalytics.totalWins}`,20,c),c+=6,l.text(`Conversion Rate: ${e.spinWheelAnalytics.conversionRate.toFixed(1)}%`,20,c),c+=6,l.text(`Total Discount Given: ${kr(e.spinWheelAnalytics.totalDiscountGiven)}`,20,c),c+=6,l.text(`Average Spins Per Customer: ${e.spinWheelAnalytics.averageSpinsPerCustomer.toFixed(1)}`,20,c),c+=6,l.text(`Redemption Rate: ${e.spinWheelAnalytics.redemptionRate.toFixed(1)}%`,20,c),c+=6,l.text(`Customer Acquisition Cost: ${kr(e.spinWheelAnalytics.customerAcquisitionCost)}`,20,c),c+=12,e.spinWheelAnalytics.topRewards.length>0&&(l.setFontSize(12),l.setFont("helvetica","bold"),l.text("Top Rewards:",20,c),c+=8,l.setFontSize(9),l.setFont("helvetica","normal"),e.spinWheelAnalytics.topRewards.forEach((u,A)=>{c>270&&(l.addPage(),c=20),l.text(`${A+1}. ${u.reward} - Count: ${u.count} - Impact: ${kr(u.revenueImpact)}`,25,c),c+=5})),c+=10),l.setFontSize(9),l.setFont("helvetica","normal"),l.setTextColor(108,117,125),l.setLineWidth(.3),l.setDrawColor(220,220,220),l.line(20,280,190,280),l.text(`Generated on: ${hs(new Date)} ${Wn(new Date)}`,20,288),n.additionalNotes){const u=l.splitTextToSize(n.additionalNotes,150);l.text(u,20,293)}return console.log(" PDF document created successfully"),l.output("blob")}catch(l){return console.error(" Error generating PDF:",l),this.generateSimplePDFReport(e,r,s,n)}}static generateSimplePDFReport(e,r,s,n){var l;console.log(" Generating simple PDF fallback with enhanced analytics...");const i=new wr;let o=20;if(i.setFontSize(24),i.setFont("helvetica","bold"),i.setTextColor(33,37,41),i.text(n.reportTitle||"Enhanced Sales Report",20,o),o+=18,i.setFontSize(18),i.setFont("helvetica","normal"),i.setTextColor(52,58,64),i.text(s,20,o),o+=12,i.setFontSize(11),i.setTextColor(108,117,125),i.text(`Report Period: ${r.label}`,20,o),o+=7,i.text(`${hs(r.startDate)} - ${hs(r.endDate)}`,20,o),i.setLineWidth(.5),i.setDrawColor(220,220,220),i.line(20,o+8,190,o+8),o+=18,i.setFontSize(16),i.setFont("helvetica","bold"),i.setTextColor(33,37,41),i.text("Executive Summary",20,o),o+=12,i.setFontSize(11),i.setFont("helvetica","normal"),i.setTextColor(52,58,64),i.text(`Total Revenue: ${kr(e.totalRevenue)}`,20,o),o+=7,i.text(`Total Orders: ${e.totalOrders}`,20,o),o+=7,i.text(`Average Order Value: ${kr(e.averageOrderValue)}`,20,o),o+=7,i.text(`Total Items Sold: ${e.totalItems}`,20,o),o+=7,e.operationalMetrics&&(i.text(`Table Utilization Rate: ${e.operationalMetrics.tableUtilizationRate.toFixed(1)}%`,20,o),o+=7,i.text(`Repeat Customer Rate: ${e.operationalMetrics.repeatCustomerRate.toFixed(1)}%`,20,o),o+=7),e.financialKPIs&&(o+=7,i.text(`Net Profit: ${kr(e.financialKPIs.netProfit)}`,20,o),o+=7),o+=8,n.includeMenuAnalysis&&e.menuItemSales.length>0){i.setFontSize(16),i.setFont("helvetica","bold"),i.setTextColor(33,37,41),i.text("Menu Performance Analysis",20,o),o+=12;const c=e.menuItemSales.length,d=e.menuItemSales.reduce((A,h)=>A+h.revenue,0)/c,u=e.menuItemSales.reduce((A,h)=>A+h.quantitySold,0)/c;i.setFontSize(12),i.setFont("helvetica","bold"),i.setTextColor(40,167,69),i.text("Performance Summary:",20,o),o+=8,i.setFontSize(10),i.setFont("helvetica","normal"),i.setTextColor(52,58,64),i.text(`Total Menu Items: ${c}`,20,o),o+=5,i.text(`Average Revenue per Item: ${kr(d)}`,20,o),o+=5,i.text(`Top Performer: ${((l=e.menuItemSales[0])==null?void 0:l.name)||"N/A"}`,20,o),o+=10,i.setFontSize(12),i.setFont("helvetica","bold"),i.setTextColor(40,167,69),i.text("Top Selling Items:",20,o),o+=8,i.setFontSize(10),i.setFont("helvetica","normal"),i.setTextColor(52,58,64),e.menuItemSales.slice(0,12).forEach((A,h)=>{o>270&&(i.addPage(),o=20),i.text(`${h+1}. ${A.name}`,20,o),i.text(`Qty: ${A.quantitySold}`,120,o),i.text(`Revenue: ${kr(A.revenue)}`,150,o),i.text(`${A.percentage.toFixed(1)}%`,185,o),o+=5}),o+=10,e.menuItemSales.filter(A=>A.revenue>d&&A.quantitySold>u),e.menuItemSales.filter(A=>A.revenue>d&&A.quantitySold<=u),e.menuItemSales.filter(A=>A.revenue<=d&&A.quantitySold>u),e.menuItemSales.filter(A=>A.revenue<=d&&A.quantitySold<=u)}if(n.includeTableAnalysis&&e.tableSales.length>0&&(o>240&&(i.addPage(),o=20),i.setFontSize(14),i.setFont("helvetica","bold"),i.text("Table Performance",20,o),o+=10,i.setFontSize(10),i.setFont("helvetica","normal"),e.tableSales.slice(0,10).forEach(c=>{o>270&&(i.addPage(),o=20),i.text(`Table ${c.tableNumber} - Orders: ${c.orderCount} - Revenue: ${kr(c.revenue)}`,20,o),o+=6}),o+=10),n.includeMenuAnalysis&&e.categorySales.length>0&&(o>240&&(i.addPage(),o=20),i.setFontSize(14),i.setFont("helvetica","bold"),i.text("Category Performance",20,o),o+=10,i.setFontSize(10),i.setFont("helvetica","normal"),e.categorySales.forEach(c=>{o>270&&(i.addPage(),o=20),i.text(`${c.categoryName} - Qty: ${c.quantitySold} - Revenue: ${kr(c.revenue)}`,20,o),o+=6}),o+=10),e.orderTypeBreakdown.length>0&&(o>240&&(i.addPage(),o=20),i.setFontSize(14),i.setFont("helvetica","bold"),i.text("Order Type Analysis",20,o),o+=10,i.setFontSize(10),i.setFont("helvetica","normal"),e.orderTypeBreakdown.forEach(c=>{o>270&&(i.addPage(),o=20),i.text(`${c.type.replace("_"," ").toUpperCase()} - Count: ${c.count} - Revenue: ${kr(c.revenue)}`,20,o),o+=6}),o+=10),e.performanceInsights&&(o>240&&(i.addPage(),o=20),i.setFontSize(16),i.setFont("helvetica","bold"),i.text("Business Insights & Recommendations",20,o),o+=12,i.setFontSize(10),i.setFont("helvetica","normal"),i.text(`Top Selling Category: ${e.performanceInsights.topSellingCategory}`,20,o),o+=7,i.text(`Best Selling Item: ${e.performanceInsights.topSellingItem}`,20,o),o+=7,i.text(`Best Performing Table: ${e.performanceInsights.bestPerformingTable}`,20,o),o+=7,i.text(`Peak Hour: ${e.performanceInsights.peakHour}:00`,20,o),o+=7,i.text(`Customer Retention Rate: ${e.performanceInsights.customerRetentionIndicator}`,20,o),o+=7,i.text(`Profitability Trend: ${e.performanceInsights.profitabilityTrend.toUpperCase()}`,20,o),o+=12,e.performanceInsights.recommendedActions.length>0&&(i.setFontSize(12),i.setFont("helvetica","bold"),i.text("Recommended Actions:",20,o),o+=10,i.setFontSize(10),i.setFont("helvetica","normal"),e.performanceInsights.recommendedActions.forEach((c,d)=>{o>270&&(i.addPage(),o=20),i.text(`${d+1}. ${c}`,25,o),o+=7})),o+=10),e.paymentMethodBreakdown.length>0){o>240&&(i.addPage(),o=20),i.setFontSize(16),i.setFont("helvetica","bold"),i.setTextColor(33,37,41),i.text("Payment Method Analysis",20,o),o+=12;const c=e.paymentMethodBreakdown.map(u=>[u.method,u.count.toString(),kr(u.amount),`${u.percentage.toFixed(1)}%`]);Po(i,{startY:o,head:[["Payment Method","Transactions","Amount","% of Total"]],body:c,theme:"grid",styles:{fontSize:11,font:"helvetica",textColor:[33,37,41],cellPadding:8,lineColor:[220,220,220],lineWidth:.5},headStyles:{fillColor:[52,144,220],textColor:[255,255,255],fontSize:12,fontStyle:"bold",halign:"center"},columnStyles:{0:{cellWidth:50,fontStyle:"bold"},1:{halign:"center",cellWidth:35,fontStyle:"bold"},2:{halign:"right",cellWidth:45,fontStyle:"bold"},3:{halign:"center",cellWidth:35,fontStyle:"bold"}},alternateRowStyles:{fillColor:[248,249,250]}}),o=i.lastAutoTable.finalY+15;const d=e.paymentMethodBreakdown.find(u=>u.method==="SPLIT");if(d&&d.splitDetails){i.setFontSize(14),i.setFont("helvetica","bold"),i.setTextColor(33,37,41),i.text("Split Payment Breakdown",20,o),o+=10;const u=d.splitDetails.map(A=>[A.method,A.count.toString(),kr(A.amount),`${(A.amount/d.amount*100).toFixed(1)}%`]);Po(i,{startY:o,head:[["Split Method","Transactions","Amount","% of Split Total"]],body:u,theme:"grid",styles:{fontSize:10,font:"helvetica",textColor:[33,37,41],cellPadding:6,lineColor:[220,220,220],lineWidth:.5},headStyles:{fillColor:[108,117,125],textColor:[255,255,255],fontSize:11,fontStyle:"bold",halign:"center"},columnStyles:{0:{cellWidth:40,fontStyle:"bold"},1:{halign:"center",cellWidth:30,fontStyle:"bold"},2:{halign:"right",cellWidth:40,fontStyle:"bold"},3:{halign:"center",cellWidth:35,fontStyle:"bold"}},alternateRowStyles:{fillColor:[248,249,250]}}),o=i.lastAutoTable.finalY+15}}if(n.includeOrderDetails&&e.detailedOrderList&&e.detailedOrderList.length>0&&(o>240&&(i.addPage(),o=20),i.setFontSize(16),i.setFont("helvetica","bold"),i.setTextColor(33,37,41),i.text("Detailed Order List",20,o),o+=12,i.setFontSize(11),i.setFont("helvetica","normal"),i.setTextColor(108,117,125),i.text(`Showing ${e.detailedOrderList.length} order(s) in vertical format`,20,o),o+=15,e.detailedOrderList.forEach((c,d)=>{o>200&&(i.addPage(),o=20),i.setFillColor(240,248,255),i.rect(15,o-3,170,8,"F"),i.setLineWidth(1),i.setDrawColor(52,144,220),i.rect(15,o-3,170,8,"S"),i.setFontSize(14),i.setFont("helvetica","bold"),i.setTextColor(33,37,41),i.text(`ORDER: ${c.orderNumber}`,20,o+2),o+=12,i.setFontSize(11),i.setFont("helvetica","normal"),i.setTextColor(52,58,64),i.setFont("helvetica","bold"),i.text("TABLE:",20,o),i.setFont("helvetica","normal"),i.text(`${c.tableNumber}`,20,o+6),o+=12,i.setFont("helvetica","bold"),i.text("DATE:",20,o),i.setFont("helvetica","normal"),i.text(`${c.date}`,20,o+6),o+=12,i.setFont("helvetica","bold"),i.text("TIME:",20,o),i.setFont("helvetica","normal"),i.text(`${c.time}`,20,o+6),o+=12,i.setFont("helvetica","bold"),i.text("STATUS:",20,o),i.setFont("helvetica","bold"),c.status==="COMPLETED"?i.setTextColor(40,167,69):c.status==="PENDING"?i.setTextColor(255,193,7):i.setTextColor(220,53,69),i.text(`${c.status}`,20,o+6),i.setTextColor(52,58,64),o+=12,i.setFont("helvetica","bold"),i.text("PAYMENT METHOD:",20,o),i.setFont("helvetica","normal");let u=c.paymentMethod||"Not specified";if(u.includes(`
`)){const h=u.split(`
`).filter((f,p,m)=>{const g=f.trim();if(g.includes("Discount:")||g.includes(" Discount:")){const y=m.findIndex(v=>v.trim().includes("Discount:"));return p===y}return g.length>0}).map(f=>f.replace(//g,"Rs. ").replace(//g,"Rs. ").replace(/Rs\. Rs\. /g,"Rs. "));if(h.length>0){i.text(h[0]||"Not specified",20,o+6),o+=10;for(let f=1;f<h.length&&f<3;f++)i.setFont("helvetica","italic"),i.setTextColor(108,117,125),i.text(`${h[f].trim()}`,25,o),o+=6;i.setTextColor(52,58,64)}else i.text("Not specified",20,o+6),o+=12}else i.text(u,20,o+6),o+=12;if(i.setFont("helvetica","bold"),i.text("TOTAL ITEMS:",20,o),i.setFont("helvetica","normal"),i.text(`${c.totalItems} items`,20,o+6),o+=12,i.setFont("helvetica","bold"),i.text("TOTAL AMOUNT:",20,o),i.setFont("helvetica","bold"),i.setTextColor(40,167,69),i.text(`${kr(c.total)}`,20,o+6),i.setTextColor(52,58,64),o+=12,c.creditAmount>0&&(i.setFont("helvetica","bold"),i.setTextColor(220,53,69),i.text("CREDIT AMOUNT:",20,o),i.text(`-${kr(c.creditAmount)}`,20,o+6),o+=12,c.creditCustomerName&&(i.text("CREDIT CUSTOMER:",20,o),i.setFont("helvetica","normal"),i.setTextColor(52,58,64),i.text(`${c.creditCustomerName}`,20,o+6),o+=12),i.setTextColor(52,58,64)),c.items&&c.items.length<200){i.setFont("helvetica","bold"),i.text("ITEMS ORDERED:",20,o),o+=6,i.setFont("helvetica","normal"),i.setFontSize(10);const A=i.splitTextToSize(c.items,160);A.slice(0,5).forEach(f=>{o>270&&(i.addPage(),o=20),i.text(f,20,o),o+=5}),A.length>5&&(i.setFont("helvetica","italic"),i.setTextColor(108,117,125),i.text("... and more items",20,o),o+=5),i.setFontSize(11),i.setTextColor(52,58,64),o+=6}c.groupDetails&&c.groupDetails.length>1&&(i.setFont("helvetica","bold"),i.setTextColor(52,144,220),i.text(`GROUPED ORDER (${c.groupDetails.length} combined):`,20,o),o+=6,i.setFont("helvetica","normal"),i.setFontSize(10),i.setTextColor(108,117,125),c.groupDetails.slice(0,3).forEach((A,h)=>{o>265&&(i.addPage(),o=20),i.text(` Order #${A.orderNumber} at ${A.time} - ${kr(A.total)}`,25,o),o+=5}),c.groupDetails.length>3&&(i.text(` ... and ${c.groupDetails.length-3} more orders in this group`,25,o),o+=5),i.setFontSize(11),i.setTextColor(52,58,64),o+=6),o+=5,i.setLineWidth(2),i.setDrawColor(200,200,200),i.line(15,o,185,o),o+=15,o+=5}),o+=10),e.customerPortalAnalytics&&e.customerPortalAnalytics.totalPortalOrders>0&&(o>240&&(i.addPage(),o=20),i.setFontSize(16),i.setFont("helvetica","bold"),i.text("Customer Portal Analytics",20,o),o+=12,i.setFontSize(10),i.setFont("helvetica","normal"),i.text(`Total Portal Orders: ${e.customerPortalAnalytics.totalPortalOrders}`,20,o),o+=6,i.text(`Portal Revenue: ${kr(e.customerPortalAnalytics.portalRevenue)}`,20,o),o+=6,i.text(`Average Order Value: ${kr(e.customerPortalAnalytics.averagePortalOrderValue)}`,20,o),o+=6,i.text(`Portal vs Dine-in Ratio: ${e.customerPortalAnalytics.portalVsDineInRatio.toFixed(1)}%`,20,o),o+=6,i.text(`Mobile Order Percentage: ${e.customerPortalAnalytics.mobileOrderPercentage.toFixed(1)}%`,20,o),o+=6,i.text(`Customer Retention Rate: ${e.customerPortalAnalytics.customerRetentionRate.toFixed(1)}%`,20,o),o+=6,i.text(`Portal Conversion Rate: ${e.customerPortalAnalytics.portalConversionRate.toFixed(1)}%`,20,o),o+=12,e.customerPortalAnalytics.popularPortalItems.length>0&&(i.setFontSize(12),i.setFont("helvetica","bold"),i.text("Popular Portal Items:",20,o),o+=8,i.setFontSize(9),i.setFont("helvetica","normal"),e.customerPortalAnalytics.popularPortalItems.forEach((c,d)=>{o>270&&(i.addPage(),o=20),i.text(`${d+1}. ${c.name} - Qty: ${c.quantity} - Revenue: ${kr(c.revenue)}`,25,o),o+=5})),o+=10),e.spinWheelAnalytics&&e.spinWheelAnalytics.totalSpins>0&&(o>240&&(i.addPage(),o=20),i.setFontSize(16),i.setFont("helvetica","bold"),i.text("Spin Wheel Gamification Analytics",20,o),o+=12,i.setFontSize(10),i.setFont("helvetica","normal"),i.text(`Total Spins: ${e.spinWheelAnalytics.totalSpins}`,20,o),o+=6,i.text(`Total Wins: ${e.spinWheelAnalytics.totalWins}`,20,o),o+=6,i.text(`Conversion Rate: ${e.spinWheelAnalytics.conversionRate.toFixed(1)}%`,20,o),o+=6,i.text(`Total Discount Given: ${kr(e.spinWheelAnalytics.totalDiscountGiven)}`,20,o),o+=6,i.text(`Average Spins Per Customer: ${e.spinWheelAnalytics.averageSpinsPerCustomer.toFixed(1)}`,20,o),o+=6,i.text(`Redemption Rate: ${e.spinWheelAnalytics.redemptionRate.toFixed(1)}%`,20,o),o+=6,i.text(`Customer Acquisition Cost: ${kr(e.spinWheelAnalytics.customerAcquisitionCost)}`,20,o),o+=12,e.spinWheelAnalytics.topRewards.length>0&&(i.setFontSize(12),i.setFont("helvetica","bold"),i.text("Top Rewards:",20,o),o+=8,i.setFontSize(9),i.setFont("helvetica","normal"),e.spinWheelAnalytics.topRewards.forEach((c,d)=>{o>270&&(i.addPage(),o=20),i.text(`${d+1}. ${c.reward} - Count: ${c.count} - Impact: ${kr(c.revenueImpact)}`,25,o),o+=5})),o+=10),i.setFontSize(9),i.setFont("helvetica","normal"),i.setTextColor(108,117,125),i.setLineWidth(.3),i.setDrawColor(220,220,220),i.line(20,280,190,280),i.text(`Generated on: ${hs(new Date)} ${Wn(new Date)}`,20,288),n.additionalNotes){const c=i.splitTextToSize(n.additionalNotes,150);i.text(c,20,293)}return console.log(" Simple PDF generated successfully"),Promise.resolve(i.output("blob"))}static formatPaymentMethod(e){switch(e==null?void 0:e.toLowerCase()){case"cash":return"Cash";case"upi":return"UPI";case"bank":return"Bank Transfer";case"card":return"Card";case"credit_card":return"Credit Card";case"debit_card":return"Debit Card";default:return"Other"}}static estimatePaymentMethod(e){const r=e.total||0;return r>1e3?Math.random()>.5?"UPI":"Card":r>500?Math.random()>.6?"UPI":"Cash":Math.random()>.7?"Cash":"UPI"}static exportToCSV(e,r){const s=[];return s.push(`Sales Report - ${r.label}`),s.push(`Period: ${hs(r.startDate)} - ${hs(r.endDate)}`),s.push(""),s.push("EXECUTIVE SUMMARY"),s.push("Metric,Value"),s.push(`Total Revenue,${e.totalRevenue}`),s.push(`Total Orders,${e.totalOrders}`),s.push(`Average Order Value,${e.averageOrderValue}`),s.push(`Total Items,${e.totalItems}`),s.push(`Total Customers,${e.totalCustomers}`),s.push(`Revenue Growth,${e.revenueGrowth}%`),s.push(`Order Growth,${e.orderGrowth}%`),s.push(""),s.push("TOP SELLING ITEMS"),s.push("Item Name,Quantity Sold,Revenue,Percentage"),e.menuItemSales.forEach(n=>{s.push(`"${n.name}",${n.quantitySold},${n.revenue},${n.percentage}%`)}),s.push(""),s.push("CATEGORY PERFORMANCE"),s.push("Category,Quantity Sold,Revenue,Percentage"),e.categorySales.forEach(n=>{s.push(`"${n.categoryName}",${n.quantitySold},${n.revenue},${n.percentage}%`)}),s.push(""),s.join(`
`)}}const Epe=[{value:"yesterday",label:"Yesterday",description:"Previous day analysis"},{value:"1week",label:"1 Week",description:"Last 7 days analysis"},{value:"15days",label:"15 Days",description:"Last 15 days analysis"},{value:"1month",label:"1 Month",description:"Last 30 days analysis"},{value:"3months",label:"3 Months",description:"Last 90 days analysis"},{value:"6months",label:"6 Months",description:"Last 180 days analysis"},{value:"1year",label:"1 Year",description:"Last 365 days analysis"},{value:"custom",label:"Custom Range",description:"Select specific date range"}];function _pe({isOpen:t,onClose:e}){const{restaurant:r}=js(),[s,n]=R.useState(!1),[i,o]=R.useState(""),{register:l,handleSubmit:c,watch:d,formState:{errors:u},reset:A}=nn({defaultValues:{timePeriod:"1week",includeMenuAnalysis:!0,includeTableAnalysis:!0,includeCustomerAnalysis:!0,includePaymentAnalysis:!0,includeCreditAnalysis:!0,includeTimeAnalysis:!0,includePeakHours:!0,includeStaffPerformance:!0,reportTitle:`${(r==null?void 0:r.name)||"Restaurant"} Sales Report`,additionalNotes:""}}),h=d("timePeriod"),f=(m,g,y)=>{const v=new Date,x=new Date(v.getFullYear(),v.getMonth(),v.getDate());switch(m){case"yesterday":{const E=new Date(x);return E.setDate(E.getDate()-1),{startDate:new Date(E.setHours(0,0,0,0)),endDate:new Date(E.setHours(23,59,59,999)),label:"Yesterday"}}case"1week":{const E=new Date(x);return E.setDate(E.getDate()-7),{startDate:new Date(E.setHours(0,0,0,0)),endDate:new Date(x.setHours(23,59,59,999)),label:"Last 7 Days"}}case"15days":{const E=new Date(x);return E.setDate(E.getDate()-15),{startDate:new Date(E.setHours(0,0,0,0)),endDate:new Date(x.setHours(23,59,59,999)),label:"Last 15 Days"}}case"1month":{const E=new Date(x);return E.setDate(E.getDate()-30),{startDate:new Date(E.setHours(0,0,0,0)),endDate:new Date(x.setHours(23,59,59,999)),label:"Last 30 Days"}}case"3months":{const E=new Date(x);return E.setMonth(E.getMonth()-3),{startDate:new Date(E.setHours(0,0,0,0)),endDate:new Date(x.setHours(23,59,59,999)),label:"Last 3 Months"}}case"6months":{const E=new Date(x);return E.setMonth(E.getMonth()-6),{startDate:new Date(E.setHours(0,0,0,0)),endDate:new Date(x.setHours(23,59,59,999)),label:"Last 6 Months"}}case"1year":{const E=new Date(x);return E.setFullYear(E.getFullYear()-1),{startDate:new Date(E.setHours(0,0,0,0)),endDate:new Date(x.setHours(23,59,59,999)),label:"Last 1 Year"}}case"custom":{if(!g||!y)throw new Error("Custom date range requires start and end dates");const E=new Date(g),T=new Date(y);return T.setHours(23,59,59,999),{startDate:new Date(E.setHours(0,0,0,0)),endDate:T,label:`${hs(E)} - ${hs(T)}`}}default:return{startDate:new Date(x.setHours(0,0,0,0)),endDate:new Date(x.setHours(23,59,59,999)),label:"Today"}}},p=async m=>{if(r){n(!0),o("Initializing report generation...");try{let g;try{g=f(m.timePeriod,m.startDate,m.endDate)}catch{Z.error("Invalid date range selected");return}o("Loading menu items...");const[y,v,x]=await Promise.all([Ts.getMenuItemsForRestaurant(r.id),fs.getTablesForRestaurant(r.id),wn.getCustomersForRestaurant(r.id)]),E=y.success?y.data||[]:[],T=v.success?v.data||[]:[],j=x.success?x.data||[]:[];o("Analyzing sales data...");const C=await xS.generateSalesAnalytics(r.id,g.startDate,g.endDate,E,T,j);if(!C.success||!C.data){Z.error(C.error||"Failed to generate analytics");return}const w=C.data;o("Generating comprehensive PDF report...");const S={includeGraphs:!0,includeMenuAnalysis:m.includeMenuAnalysis,includeTableAnalysis:m.includeTableAnalysis,includeCustomerAnalysis:m.includeCustomerAnalysis,includeStaffAnalysis:m.includeStaffPerformance,includeTimeAnalysis:m.includeTimeAnalysis,includeTaxBreakdown:!0,includeDiscountAnalysis:!0,includeCreditAnalysis:m.includeCreditAnalysis,reportTitle:m.reportTitle,additionalNotes:m.additionalNotes},F=await xS.generatePDFReport(w,g,r.name,S);o("Downloading report...");const B=URL.createObjectURL(F),k=document.createElement("a");k.href=B,k.download=`${r.name}_Comprehensive_Report_${g.label.replace(/\s+/g,"_")}_${hs(new Date)}.pdf`,document.body.appendChild(k),k.click(),document.body.removeChild(k),URL.revokeObjectURL(B),Z.success("Comprehensive report generated successfully!"),e(),A()}catch(g){console.error("Error generating comprehensive report:",g),Z.error("Failed to generate report. Please try again.")}finally{n(!1),o("")}}};return t?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsx("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 rounded-t-xl",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs("h2",{className:"text-2xl font-bold text-gray-900 flex items-center",children:[a.jsx(Rl,{className:"w-7 h-7 text-blue-600 mr-3"}),"Generate Comprehensive Report"]}),a.jsx("p",{className:"text-gray-600 mt-1",children:"Create detailed analytics report with customizable insights"})]}),a.jsx("button",{onClick:e,disabled:s,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors disabled:opacity-50",children:a.jsx(qr,{className:"w-6 h-6 text-gray-400"})})]})}),a.jsxs("form",{onSubmit:c(p),className:"p-6 space-y-8",children:[a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Jc,{className:"w-5 h-5 text-blue-600"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Time Period"})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-3",children:Epe.map(m=>a.jsxs("label",{className:`relative flex flex-col p-4 border-2 rounded-lg cursor-pointer transition-all hover:border-blue-300 ${h===m.value?"border-blue-500 bg-blue-50":"border-gray-200 hover:bg-gray-50"}`,children:[a.jsx("input",{type:"radio",value:m.value,...l("timePeriod",{required:"Please select a time period"}),className:"sr-only"}),a.jsx("span",{className:"font-medium text-gray-900",children:m.label}),a.jsx("span",{className:"text-sm text-gray-600 mt-1",children:m.description}),h===m.value&&a.jsx(Nr,{className:"absolute top-2 right-2 w-5 h-5 text-blue-600"})]},m.value))}),u.timePeriod&&a.jsx("p",{className:"text-red-600 text-sm",children:u.timePeriod.message})]}),h==="custom"&&a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 p-4 bg-blue-50 rounded-lg",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Start Date"}),a.jsx("input",{type:"date",...l("startDate",{required:h==="custom"?"Start date is required":!1}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),u.startDate&&a.jsx("p",{className:"text-red-600 text-sm mt-1",children:u.startDate.message})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"End Date"}),a.jsx("input",{type:"date",...l("endDate",{required:h==="custom"?"End date is required":!1}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),u.endDate&&a.jsx("p",{className:"text-red-600 text-sm mt-1",children:u.endDate.message})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Sa,{className:"w-5 h-5 text-green-600"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Report Sections"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"space-y-3",children:[a.jsxs("h4",{className:"font-medium text-gray-800 flex items-center",children:[a.jsx(Is,{className:"w-4 h-4 mr-2 text-blue-600"}),"Business Analytics"]}),a.jsxs("label",{className:"flex items-center space-x-3",children:[a.jsx("input",{type:"checkbox",...l("includeMenuAnalysis"),className:"w-4 h-4 text-blue-600 rounded focus:ring-blue-500"}),a.jsx("span",{className:"text-sm text-gray-700",children:"Menu Item Performance"})]}),a.jsxs("label",{className:"flex items-center space-x-3",children:[a.jsx("input",{type:"checkbox",...l("includeTableAnalysis"),className:"w-4 h-4 text-blue-600 rounded focus:ring-blue-500"}),a.jsx("span",{className:"text-sm text-gray-700",children:"Table Revenue Analysis"})]}),a.jsxs("label",{className:"flex items-center space-x-3",children:[a.jsx("input",{type:"checkbox",...l("includeCustomerAnalysis"),className:"w-4 h-4 text-blue-600 rounded focus:ring-blue-500"}),a.jsx("span",{className:"text-sm text-gray-700",children:"Customer Insights"})]}),a.jsxs("label",{className:"flex items-center space-x-3",children:[a.jsx("input",{type:"checkbox",...l("includePaymentAnalysis"),className:"w-4 h-4 text-blue-600 rounded focus:ring-blue-500"}),a.jsx("span",{className:"text-sm text-gray-700",children:"Payment Method Breakdown"})]}),a.jsxs("label",{className:"flex items-center space-x-3",children:[a.jsx("input",{type:"checkbox",...l("includeCreditAnalysis"),className:"w-4 h-4 text-blue-600 rounded focus:ring-blue-500"}),a.jsx("span",{className:"text-sm text-gray-700",children:"Credit Analysis & Tracking"})]})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("h4",{className:"font-medium text-gray-800 flex items-center",children:[a.jsx(Ys,{className:"w-4 h-4 mr-2 text-purple-600"}),"Operational Insights"]}),a.jsxs("label",{className:"flex items-center space-x-3",children:[a.jsx("input",{type:"checkbox",...l("includeTimeAnalysis"),className:"w-4 h-4 text-blue-600 rounded focus:ring-blue-500"}),a.jsx("span",{className:"text-sm text-gray-700",children:"Time-based Analysis"})]}),a.jsxs("label",{className:"flex items-center space-x-3",children:[a.jsx("input",{type:"checkbox",...l("includePeakHours"),className:"w-4 h-4 text-blue-600 rounded focus:ring-blue-500"}),a.jsx("span",{className:"text-sm text-gray-700",children:"Peak Hours Analysis"})]}),a.jsxs("label",{className:"flex items-center space-x-3",children:[a.jsx("input",{type:"checkbox",...l("includeStaffPerformance"),className:"w-4 h-4 text-blue-600 rounded focus:ring-blue-500"}),a.jsx("span",{className:"text-sm text-gray-700",children:"Staff Performance"})]})]})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Rl,{className:"w-5 h-5 text-orange-600"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Report Customization"})]}),a.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Report Title"}),a.jsx("input",{type:"text",...l("reportTitle",{required:"Report title is required"}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter custom report title"}),u.reportTitle&&a.jsx("p",{className:"text-red-600 text-sm mt-1",children:u.reportTitle.message})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Additional Notes (Optional)"}),a.jsx("textarea",{...l("additionalNotes"),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Add any additional notes or context for this report..."})]})]})]}),s&&a.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx(Gi,{className:"w-5 h-5 text-blue-600 animate-spin"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-blue-900",children:"Generating Report..."}),a.jsx("p",{className:"text-sm text-blue-700",children:i})]})]})}),a.jsxs("div",{className:"flex items-center justify-end space-x-4 pt-6 border-t border-gray-200",children:[a.jsx("button",{type:"button",onClick:e,disabled:s,className:"btn btn-secondary disabled:opacity-50",children:"Cancel"}),a.jsx("button",{type:"submit",disabled:s,className:"btn btn-primary disabled:opacity-50 flex items-center",children:s?a.jsxs(a.Fragment,{children:[a.jsx(Gi,{className:"w-4 h-4 mr-2 animate-spin"}),"Generating..."]}):a.jsxs(a.Fragment,{children:[a.jsx(Yn,{className:"w-4 h-4 mr-2"}),"Generate Report"]})})]})]})]})}):null}function Tpe({orders:t}){var u,A,h;const[e,r]=R.useState([]);if(R.useEffect(()=>{const f=new Date,p=[];for(let m=6;m>=0;m--){const g=new Date(f);g.setDate(f.getDate()-m),g.setHours(0,0,0,0);const y=new Date(g);y.setDate(g.getDate()+1);const v=t.filter(T=>{const j=new Date(T.createdAt);return j>=g&&j<y}),E=v.filter(T=>T.status==="completed").reduce((T,j)=>T+j.total,0);p.push({date:g.toLocaleDateString("en-US",{month:"short",day:"numeric"}),revenue:E,orders:v.length})}r(p)},[t]),e.length===0)return a.jsxs("div",{className:"text-center py-8",children:[a.jsx(Is,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),a.jsx("p",{className:"text-gray-600",children:"No revenue data available"})]});const s=e.length>0?Math.max(...e.map(f=>f.revenue)):1,n=200,i=400,o=40,l=((u=e[0])==null?void 0:u.revenue)||0,c=((A=e[e.length-1])==null?void 0:A.revenue)||0,d=l>0?(c-l)/l*100:0;return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Revenue Growth (Past 7 Days)"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Daily revenue trend analysis"})]}),a.jsxs("div",{className:"text-right",children:[a.jsxs("div",{className:`flex items-center space-x-2 ${d>=0?"text-green-600":"text-red-600"}`,children:[a.jsx(Is,{className:`w-4 h-4 ${d<0?"rotate-180":""}`}),a.jsxs("span",{className:"font-semibold",children:[d>=0?"+":"",d.toFixed(1),"%"]})]}),a.jsx("p",{className:"text-xs text-gray-500",children:"vs first day"})]})]}),a.jsx("div",{className:"bg-gray-50 rounded-lg p-6",children:a.jsxs("svg",{width:"100%",height:n+o*2,viewBox:`0 0 ${i+o*2} ${n+o*2}`,className:"w-full",children:[[0,.25,.5,.75,1].map((f,p)=>a.jsxs("g",{children:[a.jsx("line",{x1:o,y1:o+n*f,x2:i+o,y2:o+n*f,stroke:"#e5e7eb",strokeWidth:"1"}),a.jsx("text",{x:o-10,y:o+n*f+4,textAnchor:"end",fontSize:"12",fill:"#6b7280",children:Ue(s*(1-f))})]},p)),e.length>1&&a.jsx("polyline",{points:e.map((f,p)=>{const m=o+p*(i/(e.length-1)),g=o+n-f.revenue/s*n;return`${m},${g}`}).join(" "),fill:"none",stroke:"url(#revenueGradient)",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round"}),e.map((f,p)=>{const m=o+p*(i/(e.length-1)),g=o+n-f.revenue/s*n;return a.jsxs("g",{children:[a.jsx("circle",{cx:m,cy:g,r:"4",fill:"white",stroke:"url(#revenueGradient)",strokeWidth:"3"}),a.jsx("text",{x:m,y:n+o+20,textAnchor:"middle",fontSize:"12",fill:"#6b7280",children:f.date})]},p)}),a.jsx("defs",{children:a.jsxs("linearGradient",{id:"revenueGradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[a.jsx("stop",{offset:"0%",stopColor:"#3b82f6"}),a.jsx("stop",{offset:"100%",stopColor:"#8b5cf6"})]})})]})}),a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[a.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 text-center",children:[a.jsx("p",{className:"text-sm font-medium text-blue-600",children:"Total Revenue"}),a.jsx("p",{className:"text-xl font-bold text-blue-800",children:Ue(e.reduce((f,p)=>f+p.revenue,0))})]}),a.jsxs("div",{className:"bg-green-50 rounded-lg p-4 text-center",children:[a.jsx("p",{className:"text-sm font-medium text-green-600",children:"Total Orders"}),a.jsx("p",{className:"text-xl font-bold text-green-800",children:e.reduce((f,p)=>f+p.orders,0)})]}),a.jsxs("div",{className:"bg-purple-50 rounded-lg p-4 text-center",children:[a.jsx("p",{className:"text-sm font-medium text-purple-600",children:"Best Day"}),a.jsx("p",{className:"text-xl font-bold text-purple-800",children:((h=e.reduce((f,p)=>p.revenue>f.revenue?p:f,e[0]))==null?void 0:h.date)||"N/A"})]}),a.jsxs("div",{className:"bg-orange-50 rounded-lg p-4 text-center",children:[a.jsx("p",{className:"text-sm font-medium text-orange-600",children:"Avg Daily"}),a.jsx("p",{className:"text-xl font-bold text-orange-800",children:Ue(e.reduce((f,p)=>f+p.revenue,0)/e.length)})]})]})]})}function Ipe({orders:t}){var l;const[e,r]=R.useState([]);if(R.useEffect(()=>{const c=new Date,d=[];for(let u=6;u>=0;u--){const A=new Date(c);A.setDate(c.getDate()-u),A.setHours(0,0,0,0);const h=new Date(A);h.setDate(A.getDate()+1);const f=t.filter(m=>{const g=new Date(m.createdAt);return g>=A&&g<h}),p=f.length>0?f.reduce((m,g)=>m+g.total,0)/f.length:0;d.push({date:A.toLocaleDateString("en-US",{month:"short",day:"numeric"}),revenue:p,orders:f.length})}r(d)},[t]),e.length===0)return a.jsxs("div",{className:"text-center py-8",children:[a.jsx(hn,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),a.jsx("p",{className:"text-gray-600",children:"No AOV data available"})]});const s=e.length>0?Math.max(...e.map(c=>c.revenue)):1,n=150,i=300,o=30;return a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Average Order Value Trends"}),a.jsx("p",{className:"text-sm text-gray-600",children:"7-day AOV progression"})]}),a.jsx("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 rounded-lg p-4",children:a.jsxs("svg",{width:"100%",height:n+o*2,viewBox:`0 0 ${i+o*2} ${n+o*2}`,className:"w-full",children:[[0,.5,1].map((c,d)=>a.jsxs("g",{children:[a.jsx("line",{x1:o,y1:o+n*c,x2:i+o,y2:o+n*c,stroke:"#d1fae5",strokeWidth:"1"}),a.jsx("text",{x:o-5,y:o+n*c+4,textAnchor:"end",fontSize:"10",fill:"#6b7280",children:Ue(s*(1-c))})]},d)),e.length>1&&a.jsx("polyline",{points:e.map((c,d)=>{const u=o+d*(i/(e.length-1)),A=o+n-c.revenue/s*n;return`${u},${A}`}).join(" "),fill:"none",stroke:"#10b981",strokeWidth:"2",strokeLinecap:"round"}),e.map((c,d)=>{const u=o+d*(i/(e.length-1)),A=o+n-c.revenue/s*n;return a.jsxs("g",{children:[a.jsx("circle",{cx:u,cy:A,r:"3",fill:"#10b981"}),a.jsx("text",{x:u,y:n+o+15,textAnchor:"middle",fontSize:"10",fill:"#6b7280",children:c.date})]},d)})]})}),a.jsxs("div",{className:"bg-green-50 rounded p-3 text-center",children:[a.jsx("p",{className:"text-sm font-medium text-green-600",children:"Current Avg AOV"}),a.jsx("p",{className:"text-lg font-bold text-green-800",children:Ue(((l=e[e.length-1])==null?void 0:l.revenue)||0)})]})]})}function kpe({orders:t}){var l;const[e,r]=R.useState([]);R.useEffect(()=>{const c=new Map;for(let u=0;u<24;u++)c.set(u,{revenue:0,orders:0});t.forEach(u=>{const A=new Date(u.createdAt).getHours(),h=c.get(A)||{revenue:0,orders:0};c.set(A,{revenue:h.revenue+u.total,orders:h.orders+1})});const d=Array.from(c.entries()).map(([u,A])=>({hour:u,revenue:A.revenue,orders:A.orders}));r(d)},[t]);const s=e.length>0?Math.max(...e.map(c=>c.revenue)):1,n=120,i=12,o=20;return a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Peak Hours Revenue"}),a.jsx("p",{className:"text-sm text-gray-600",children:"24-hour revenue distribution"})]}),a.jsx("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-lg p-4",children:a.jsx("svg",{width:"100%",height:n+o*2,viewBox:`0 0 ${24*i+o*2} ${n+o*2}`,className:"w-full",children:e.map((c,d)=>{const u=s>0?c.revenue/s*n:0,A=o+d*i,h=o+n-u;return a.jsxs("g",{children:[a.jsx("rect",{x:A,y:h,width:i-1,height:u,fill:c.revenue>0?"#3b82f6":"#e5e7eb",rx:"1"}),d%3===0&&a.jsxs("text",{x:A+i/2,y:n+o+15,textAnchor:"middle",fontSize:"9",fill:"#6b7280",children:[c.hour,"h"]})]},d)})})}),a.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center",children:[a.jsxs("div",{className:"bg-blue-50 rounded p-2",children:[a.jsx("p",{className:"text-xs font-medium text-blue-600",children:"Peak Hour"}),a.jsxs("p",{className:"text-sm font-bold text-blue-800",children:[((l=e.reduce((c,d)=>d.revenue>c.revenue?d:c,e[0]))==null?void 0:l.hour)||0,":00"]})]}),a.jsxs("div",{className:"bg-indigo-50 rounded p-2",children:[a.jsx("p",{className:"text-xs font-medium text-indigo-600",children:"Peak Revenue"}),a.jsx("p",{className:"text-sm font-bold text-indigo-800",children:Ue(Math.max(...e.map(c=>c.revenue)))})]}),a.jsxs("div",{className:"bg-purple-50 rounded p-2",children:[a.jsx("p",{className:"text-xs font-medium text-purple-600",children:"Active Hours"}),a.jsx("p",{className:"text-sm font-bold text-purple-800",children:e.filter(c=>c.revenue>0).length})]})]})]})}function Bpe({orders:t}){var l;const[e,r]=R.useState([]);R.useEffect(()=>{const c=new Map,d=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];for(let A=0;A<7;A++)c.set(A,{revenue:0,orders:0});t.forEach(A=>{const h=new Date(A.createdAt).getDay(),f=c.get(h)||{revenue:0,orders:0};c.set(h,{revenue:f.revenue+A.total,orders:f.orders+1})});const u=Array.from(c.entries()).map(([A,h])=>({day:d[A],revenue:h.revenue,orders:h.orders}));r(u)},[t]);const s=e.length>0?Math.max(...e.map(c=>c.revenue)):1,n=120,i=30,o=20;return a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Day of Week Performance"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Weekly revenue pattern"})]}),a.jsx("div",{className:"bg-gradient-to-br from-purple-50 to-pink-50 rounded-lg p-4",children:a.jsx("svg",{width:"100%",height:n+o*2,viewBox:`0 0 ${7*i+o*2} ${n+o*2}`,className:"w-full",children:e.map((c,d)=>{const u=s>0?c.revenue/s*n:0,A=o+d*i,h=o+n-u;return a.jsxs("g",{children:[a.jsx("rect",{x:A,y:h,width:i-2,height:u,fill:"#8b5cf6",rx:"2"}),a.jsx("text",{x:A+i/2,y:n+o+15,textAnchor:"middle",fontSize:"10",fill:"#6b7280",children:c.day})]},d)})})}),a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxs("div",{className:"bg-purple-50 rounded p-3 text-center",children:[a.jsx("p",{className:"text-sm font-medium text-purple-600",children:"Best Day"}),a.jsx("p",{className:"text-lg font-bold text-purple-800",children:e.length>0&&((l=e.reduce((c,d)=>d.revenue>c.revenue?d:c,e[0]))==null?void 0:l.day)||"N/A"})]}),a.jsxs("div",{className:"bg-pink-50 rounded p-3 text-center",children:[a.jsx("p",{className:"text-sm font-medium text-pink-600",children:"Weekend vs Weekday"}),a.jsx("p",{className:"text-lg font-bold text-pink-800",children:e.length>=7?(()=>{const c=e[0].revenue+e[6].revenue,d=e.slice(1,6).reduce((u,A)=>u+A.revenue,0);return c>d?"Weekend":"Weekday"})():"N/A"})]})]})]})}function Fpe({orders:t,tables:e}){var i;const[r,s]=R.useState([]);R.useEffect(()=>{const o=new Date,l=new Date(o.getFullYear(),o.getMonth(),o.getDate()),c=t.filter(A=>new Date(A.createdAt)>=l),d=new Map;c.forEach(A=>{if(A.tableId){const h=d.get(A.tableId)||0;d.set(A.tableId,h+1)}});const u=e.map(A=>{const h=d.get(A.id)||0,f=h/8;return{tableNumber:A.number,turnoverRate:f,totalOrders:h}}).sort((A,h)=>h.turnoverRate-A.turnoverRate);s(u.slice(0,8))},[t,e]);const n=Math.max(...r.map(o=>o.turnoverRate),1);return a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Table Turnover Rate"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Orders per hour (today)"})]}),a.jsx("div",{className:"space-y-2",children:r.map(o=>a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-12 text-center",children:a.jsxs("span",{className:"text-sm font-medium text-gray-700",children:["T",o.tableNumber]})}),a.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-4 relative",children:a.jsx("div",{className:"bg-gradient-to-r from-orange-400 to-red-500 h-4 rounded-full transition-all duration-500",style:{width:`${o.turnoverRate/n*100}%`}})}),a.jsx("div",{className:"w-16 text-right",children:a.jsxs("span",{className:"text-sm font-semibold text-gray-900",children:[o.turnoverRate.toFixed(1),"/h"]})})]},o.tableNumber))}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{className:"bg-orange-50 rounded p-3 text-center",children:[a.jsx("p",{className:"text-sm font-medium text-orange-600",children:"Avg Turnover"}),a.jsxs("p",{className:"text-lg font-bold text-orange-800",children:[(r.reduce((o,l)=>o+l.turnoverRate,0)/r.length||0).toFixed(1),"/h"]})]}),a.jsxs("div",{className:"bg-red-50 rounded p-3 text-center",children:[a.jsx("p",{className:"text-sm font-medium text-red-600",children:"Best Table"}),a.jsx("p",{className:"text-lg font-bold text-red-800",children:((i=r[0])==null?void 0:i.tableNumber)||"N/A"})]})]})]})}function Ppe({orders:t,menuItems:e}){const[r,s]=R.useState([]);R.useEffect(()=>{const i=new Map;t.forEach(c=>{c.items.forEach(d=>{const u=e.find(f=>f.id===d.menuItemId),A=(u==null?void 0:u.category)||"Unknown",h=i.get(A)||{revenue:0,quantity:0};i.set(A,{revenue:h.revenue+d.total,quantity:h.quantity+d.quantity})})});const o=Array.from(i.values()).reduce((c,d)=>c+d.revenue,0),l=Array.from(i.entries()).map(([c,d])=>({category:c,revenue:d.revenue,quantity:d.quantity,percentage:o>0?d.revenue/o*100:0})).sort((c,d)=>d.revenue-c.revenue).slice(0,6);s(l)},[t,e]);const n=["#3b82f6","#10b981","#8b5cf6","#f59e0b","#ef4444","#6b7280"];return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Category Performance"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Revenue by menu category"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx("div",{className:"flex justify-center",children:a.jsx("svg",{width:"150",height:"150",viewBox:"0 0 150 150",children:r.length>0&&(()=>{let i=0;return r.map((o,l)=>{const c=i*360/100,d=(i+o.percentage)*360/100;i+=o.percentage;const u=c*Math.PI/180,A=d*Math.PI/180,h=o.percentage>50?1:0,f=75+60*Math.cos(u),p=75+60*Math.sin(u),m=75+60*Math.cos(A),g=75+60*Math.sin(A),y=["M",75,75,"L",f,p,"A",60,60,0,h,1,m,g,"Z"].join(" ");return a.jsx("path",{d:y,fill:n[l],stroke:"white",strokeWidth:"2"},o.category)})})()})}),a.jsx("div",{className:"space-y-2",children:r.map((i,o)=>a.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:n[o]}}),a.jsx("span",{className:"text-sm font-medium text-gray-700",children:i.category})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("p",{className:"text-sm font-semibold text-gray-900",children:Ue(i.revenue)}),a.jsxs("p",{className:"text-xs text-gray-600",children:[i.percentage.toFixed(1),"%"]})]})]},i.category))})]})]})}function Dpe({order:t,isOpen:e,onClose:r,onStatusUpdate:s,tables:n}){if(!e||!t)return null;const i=n.find(c=>c.id===t.tableId),o=c=>{const u={draft:{color:"bg-gray-100 text-gray-600",label:"Draft"},placed:{color:"bg-blue-100 text-blue-800",label:"Placed"},confirmed:{color:"bg-yellow-100 text-yellow-800",label:"Confirmed"},preparing:{color:"bg-orange-100 text-orange-800",label:"Preparing"},ready:{color:"bg-green-100 text-green-800",label:"Ready"},completed:{color:"bg-gray-100 text-gray-800",label:"Completed"},cancelled:{color:"bg-red-100 text-red-800",label:"Cancelled"}}[c];return a.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${u.color}`,children:u.label})},l=["draft","placed","confirmed","preparing","ready","completed","cancelled"];return a.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:a.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[a.jsx("div",{className:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75",onClick:r}),a.jsxs("div",{className:"inline-block w-full max-w-2xl my-8 overflow-hidden text-left align-middle transition-all transform bg-white shadow-xl rounded-2xl",children:[a.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Order Details"}),a.jsxs("p",{className:"text-sm text-gray-600",children:["#",t.orderNumber]})]}),a.jsx("button",{onClick:r,className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100",children:""})]})}),a.jsxs("div",{className:"px-6 py-4 max-h-96 overflow-y-auto",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-sm text-gray-600",children:"Table"}),a.jsx("p",{className:"font-medium",children:(i==null?void 0:i.number)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm text-gray-600",children:"Status"}),a.jsx("div",{className:"mt-1",children:o(t.status)})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm text-gray-600",children:"Order Time"}),a.jsxs("p",{className:"font-medium",children:[hs(t.createdAt)," ",Wn(t.createdAt)]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm text-gray-600",children:"Payment Status"}),a.jsx("p",{className:"font-medium capitalize",children:t.paymentStatus})]})]}),a.jsxs("div",{className:"mb-6",children:[a.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Order Items"}),a.jsx("div",{className:"space-y-3",children:t.items.map(c=>a.jsxs("div",{className:"flex justify-between items-start p-3 bg-gray-50 rounded-lg",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-medium",children:c.name}),a.jsxs("p",{className:"text-sm text-gray-600",children:["Qty: ",c.quantity,"  ",Ue(c.price)]}),c.customizations&&c.customizations.length>0&&a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Customizations: ",c.customizations.join(", ")]}),c.notes&&a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Note: ",c.notes]})]}),a.jsx("p",{className:"font-medium",children:Ue(c.total)})]},c.id))})]}),a.jsxs("div",{className:"border-t pt-4",children:[a.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Order Summary"}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Subtotal"}),a.jsx("span",{children:Ue(t.subtotal)})]}),t.discount>0&&a.jsxs("div",{className:"flex justify-between text-green-600",children:[a.jsx("span",{children:"Discount Applied"}),a.jsxs("span",{children:["-",Ue(t.discount)]})]}),t.tip>0&&a.jsxs("div",{className:"flex justify-between text-blue-600",children:[a.jsx("span",{children:"Tip/Gratuity"}),a.jsxs("span",{children:["+",Ue(t.tip)]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Tax"}),a.jsx("span",{children:Ue(t.tax)})]}),a.jsxs("div",{className:"flex justify-between font-semibold text-lg border-t pt-2",children:[a.jsx("span",{children:"Total"}),a.jsx("span",{children:Ue(t.total)})]}),t.isCredit&&a.jsxs("div",{className:"mt-4 p-3 bg-orange-50 border border-orange-200 rounded-lg",children:[a.jsxs("h5",{className:"font-medium text-orange-800 mb-2 flex items-center",children:[a.jsx(No,{className:"w-4 h-4 mr-2"}),"Credit Payment Details"]}),a.jsxs("div",{className:"space-y-1 text-sm",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-orange-700",children:"Amount Received:"}),a.jsx("span",{className:"font-medium text-green-600",children:Ue(t.amountReceived||0)})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-orange-700",children:"Credit Amount:"}),a.jsx("span",{className:"font-medium text-orange-600",children:Ue(t.creditAmount||0)})]}),t.creditCustomerName&&a.jsxs("div",{className:"pt-2 border-t border-orange-200",children:[a.jsxs("div",{className:"text-orange-700",children:["Customer: ",a.jsx("span",{className:"font-medium",children:t.creditCustomerName})]}),t.creditCustomerPhone&&a.jsx("div",{className:"text-orange-600 text-xs",children:t.creditCustomerPhone})]})]})]}),t.totalSavings>0&&a.jsx("div",{className:"mt-3 p-3 bg-green-50 border border-green-200 rounded-lg",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"font-medium text-green-800",children:" Total Customer Savings"}),a.jsx("span",{className:"font-bold text-green-600",children:Ue(t.totalSavings)})]})})]})]}),t.notes&&a.jsxs("div",{className:"mt-4",children:[a.jsx("label",{className:"text-sm text-gray-600",children:"Order Notes"}),a.jsx("p",{className:"mt-1 p-3 bg-yellow-50 rounded-lg text-sm",children:t.notes})]})]}),a.jsx("div",{className:"px-6 py-4 border-t border-gray-200 bg-gray-50",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Update Status:"}),a.jsx("select",{value:t.status,onChange:c=>s(t.id,c.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:l.map(c=>a.jsx("option",{value:c,children:c.charAt(0).toUpperCase()+c.slice(1).replace("_"," ")},c))})]})})]})]})})}async function Rpe(t,e,r){var d,u,A,h,f,p,m,g,y,v,x,E,T,j,C,w,S,F,B,k;const s=t.subtotal,n=t.discount||0,i=t.tax,o=t.total;let l="";const c=(d=e==null?void 0:e.settings)==null?void 0:d.upiSettings;if(c!=null&&c.enableQRCode&&(c!=null&&c.upiId))try{console.log(" Generating UPI QR code for order bill:",{orderId:t.id,orderNumber:t.orderNumber,upiId:c.upiId,amount:o,restaurant:e.name});const D=VM(c.upiId,o,e.name,`Payment for Order #${t.orderNumber} - ${e.name}`);console.log(" UPI Payment String:",D),l=await HM(D),l?console.log(" UPI QR Code generated successfully for order"):console.error(" Failed to generate UPI QR Code for order")}catch(D){console.error(" Error generating UPI QR Code for order:",D)}return`
    <!DOCTYPE html>
    <html>
    <head>
      <title>Bill - Order #${t.orderNumber}</title>
      <meta charset="UTF-8">
      <style>
        * {
          margin: 0;
          padding: 0;
          box-sizing: border-box;
        }
        
        body {
          font-family: 'Courier New', monospace;
          font-size: 11px;
          font-weight: bold;
          line-height: 1.1;
          width: 100%;
          margin: 0;
          padding: 0 5px;
          background: #fff;
          color: #000;
        }
        
        .receipt {
          width: 100%;
          padding: 5px 0;
          background: #fff;
        }
        
        .header {
          text-align: center;
          margin-bottom: 5px;
          border-bottom: 2px solid #000;
          padding-bottom: 3px;
        }
        
        .restaurant-name {
          font-size: 14px;
          font-weight: bold;
          letter-spacing: 0.5px;
          margin-bottom: 2px;
          text-transform: uppercase;
        }
        
        .contact-info {
          font-size: 9px;
          line-height: 1.1;
          font-weight: bold;
          margin-bottom: 2px;
        }
        
        .bill-header {
          text-align: center;
          margin: 5px 0;
          padding: 3px 0;
          border-top: 1px dashed #000;
          border-bottom: 1px dashed #000;
        }
        
        .bill-title {
          font-size: 12px;
          font-weight: bold;
          margin-bottom: 2px;
          letter-spacing: 0.5px;
        }
        
        .bill-info {
          font-size: 10px;
          line-height: 1.1;
          font-weight: bold;
        }
        
        .items-section {
          margin: 5px 0;
        }
        
        .items-header {
          display: flex;
          justify-content: space-between;
          border-bottom: 1px solid #000;
          padding-bottom: 2px;
          margin-bottom: 3px;
          font-weight: bold;
          font-size: 10px;
        }
        
        .item-row {
          display: flex;
          justify-content: space-between;
          margin: 2px 0;
          padding: 1px 0;
        }
        
        .item-details {
          flex: 1;
          padding-right: 5px;
        }
        
        .item-name {
          font-weight: bold;
          margin-bottom: 1px;
          font-size: 10px;
        }
        
        .item-qty-price {
          font-size: 9px;
          font-weight: bold;
        }
        
        .item-total {
          font-weight: bold;
          min-width: 50px;
          text-align: right;
          font-size: 10px;
        }
        
        .totals-section {
          margin-top: 5px;
          border-top: 1px solid #000;
          padding-top: 3px;
        }
        
        .total-row {
          display: flex;
          justify-content: space-between;
          margin: 1px 0;
          padding: 1px 0;
          font-weight: bold;
          font-size: 10px;
        }
        
        .total-row.subtotal {
          border-bottom: 1px dotted #000;
          padding-bottom: 2px;
          margin-bottom: 2px;
        }
        
        .total-row.final {
          border-top: 2px solid #000;
          border-bottom: 2px solid #000;
          padding: 3px 0;
          margin-top: 3px;
          font-size: 12px;
          font-weight: bold;
        }
        
        .payment-section {
          margin: 5px 0;
          padding: 3px 0;
          border-top: 1px dashed #000;
          border-bottom: 1px dashed #000;
        }
        
        .payment-title {
          font-weight: bold;
          margin-bottom: 2px;
          text-transform: uppercase;
          letter-spacing: 0.3px;
          font-size: 10px;
        }
        
        .payment-details {
          font-size: 9px;
          line-height: 1.1;
          font-weight: bold;
        }
        
        .payment-method {
          background: #f0f0f0;
          padding: 1px 2px;
          display: inline-block;
          font-weight: bold;
        }
        
        .upi-section {
          margin: 5px 0;
          padding: 8px;
          border: 2px solid #000;
          text-align: center;
          background: #f9f9f9;
        }
        
        .upi-title {
          font-size: 12px;
          font-weight: bold;
          margin-bottom: 3px;
          letter-spacing: 0.5px;
          text-transform: uppercase;
        }
        
        .upi-id {
          font-size: 10px;
          font-weight: bold;
          margin-bottom: 5px;
          color: #333;
        }
        
        .footer {
          text-align: center;
          margin-top: 5px;
          padding-top: 3px;
          border-top: 2px solid #000;
        }
        
        .thank-you {
          font-size: 11px;
          font-weight: bold;
          margin-bottom: 2px;
          letter-spacing: 0.5px;
        }
        
        .footer-info {
          font-size: 8px;
          font-weight: bold;
          line-height: 1.1;
        }
        
        .timestamp {
          text-align: center;
          margin-top: 3px;
          font-size: 8px;
          font-weight: bold;
        }
      </style>
    </head>
    <body>
      <div class="receipt">
        <!-- Header Section -->
        <div class="header">
          <div class="restaurant-name">${e.name}</div>
          <div class="contact-info">
            ${((A=(u=e.settings)==null?void 0:u.businessInfo)==null?void 0:A.businessAddress)||((h=e.settings)==null?void 0:h.address)||"Restaurant Address"}
            ${(p=(f=e.settings)==null?void 0:f.businessInfo)!=null&&p.city?`, ${e.settings.businessInfo.city}`:""}
            ${(g=(m=e.settings)==null?void 0:m.businessInfo)!=null&&g.state?`, ${e.settings.businessInfo.state}`:""}
            ${(v=(y=e.settings)==null?void 0:y.businessInfo)!=null&&v.pincode?` - ${e.settings.businessInfo.pincode}`:""}
            <br>
            ${(x=e.settings)!=null&&x.phone?` ${e.settings.phone}`:""}
            ${(T=(E=e.settings)==null?void 0:E.businessInfo)!=null&&T.gstin?`<br>GSTIN: ${e.settings.businessInfo.gstin}`:""}
            ${(C=(j=e.settings)==null?void 0:j.businessInfo)!=null&&C.fssaiNumber?`<br>FSSAI: ${e.settings.businessInfo.fssaiNumber}`:""}
          </div>
        </div>

        <!-- Bill Header -->
        <div class="bill-header">
          <div class="bill-title">BILL RECEIPT</div>
          <div class="bill-info">
            <strong>Order:</strong> #${t.orderNumber}<br>
            <strong>Table:</strong> ${(r==null?void 0:r.number)||"N/A"} (${(r==null?void 0:r.area)||"N/A"})<br>
            <strong>Date:</strong> ${hs(t.createdAt)}<br>
            <strong>Time:</strong> ${Wn(t.createdAt)}<br>
            <strong>Status:</strong> ${t.status.toUpperCase()}
          </div>
        </div>

        <!-- Items Section -->
        <div class="items-section">
          <div class="items-header">
            <span>ITEM</span>
            <span>TOTAL</span>
          </div>
          
          ${t.items.map(D=>`
            <div class="item-row">
              <div class="item-details">
                <div class="item-name">${D.name}</div>
                <div class="item-qty-price">${D.quantity}  ${Ue(D.price)}</div>
                ${D.customizations&&D.customizations.length>0?`
                  <div style="font-size: 8px; color: #666;">+ ${D.customizations.join(", ")}</div>
                `:""}
                ${D.notes?`
                  <div style="font-size: 8px; color: #666;">Note: ${D.notes}</div>
                `:""}
              </div>
              <div class="item-total">${Ue(D.total)}</div>
            </div>
          `).join("")}
        </div>

        <!-- Totals Section -->
        <div class="totals-section">
          <div class="total-row subtotal">
            <span>Subtotal</span>
            <span>${Ue(s)}</span>
          </div>
          
          ${n>0?`
            <div class="total-row">
              <span>Discount</span>
              <span>-${Ue(n)}</span>
            </div>
          `:""}
          
          <div class="total-row">
            <span>Tax (${((w=e==null?void 0:e.settings)==null?void 0:w.taxRate)||8.5}%)</span>
            <span>${Ue(i)}</span>
          </div>
          
          <div class="total-row final">
            <span>TOTAL AMOUNT</span>
            <span>${Ue(o)}</span>
          </div>
        </div>

        <!-- Payment Section -->
        <div class="payment-section">
          <div class="payment-title">Payment Details</div>
          <div class="payment-details">
            <strong>Status:</strong> <span class="payment-method">${t.paymentStatus.toUpperCase()}</span><br>
            <strong>Method:</strong> ${t.paymentMethod||"N/A"}
          </div>
        </div>



        ${c!=null&&c.enableQRCode&&(c!=null&&c.upiId)&&l?`
        <!-- UPI QR Code Section - Only QR Code -->
        <div style="margin: 5px 0; text-align: center; background: #fff; padding: 5px; border: 1px solid #000;">
          <img src="${l}" 
               alt="UPI QR Code" 
               style="width: 80px; height: 80px; display: block; margin: 0 auto; background: white;" />
        </div>
        `:""}

        <!-- Footer -->
        <div class="footer">
          <div class="footer-info">
            ${(F=(S=e.settings)==null?void 0:S.businessInfo)!=null&&F.website?` ${e.settings.businessInfo.website}<br>`:""}
            ${(k=(B=e.settings)==null?void 0:B.businessInfo)!=null&&k.email?` ${e.settings.businessInfo.email}`:""}
          </div>
        </div>
      </div>
    </body>
    </html>
  `}function Lpe(){const{restaurant:t}=js(),{user:e}=ia(),[r,s]=R.useState([]),[n,i]=R.useState([]),[o,l]=R.useState([]),[c,d]=R.useState(!0),[u,A]=R.useState(!1),[h,f]=R.useState(null),[p,m]=R.useState(!1),[g,y]=R.useState(null),[v,x]=R.useState(!1),[E,T]=R.useState(!1),[j,C]=R.useState(1),[w]=R.useState(10),[S,F]=R.useState("list"),[B,k]=R.useState(new Set),[D,q]=R.useState([]),[te,W]=R.useState({totalOrders:0,totalRevenue:0,actualRevenue:0,pendingCredits:0,avgOrderValue:0,todayOrders:0,todayRevenue:0,todayActualRevenue:0,popularItems:[],tableStats:[]}),[Q,re]=R.useState(""),[G]=R.useState(null),{register:Ae,handleSubmit:he,watch:I}=nn({defaultValues:{dateRange:"all",status:"all",orderType:"all",menuItemId:"all"}}),U=I("dateRange"),V=I("startDate"),L=I("endDate"),K=I("tableId"),fe=I("status"),ee=I("orderType"),de=I("menuItemId");R.useEffect(()=>{t&&ue()},[t]);const ue=async()=>{if(t)try{d(!0);const[me,Fe,Re]=await Promise.all([Ur.getOrdersForRestaurant(t.id,200),Ts.getMenuItemsForRestaurant(t.id),fs.getTablesForRestaurant(t.id)]);me.success&&me.data&&s(me.data),Fe.success&&Fe.data&&l(Fe.data),Re.success&&Re.data&&i(Re.data)}catch{yr.error("Failed to load order data")}finally{d(!1)}},Ie=R.useCallback(async me=>{if(!t)return;const Fe=new Date,Re=new Date(Fe.getFullYear(),Fe.getMonth(),Fe.getDate()),Be=new Date(Re);Be.setHours(23,59,59,999);const X=me.filter(Ge=>{const gt=new Date(Ge.createdAt);return gt>=Re&&gt<=Be}),_e=me.filter(Ge=>Ge.status==="completed"),ke=X.filter(Ge=>Ge.status==="completed"),lt=_e.reduce((Ge,gt)=>Ge+gt.total,0),mt=ke.reduce((Ge,gt)=>Ge+gt.total,0),pt=await zw.calculateOrdersRevenue(_e,t.id),ze=await zw.calculateOrdersRevenue(ke,t.id),Me=new Map;_e.forEach(Ge=>{Ge.items.forEach(gt=>{const St=Me.get(gt.menuItemId);St?(St.quantity+=gt.quantity,St.revenue+=gt.total):Me.set(gt.menuItemId,{name:gt.name,quantity:gt.quantity,revenue:gt.total})})});const rt=Array.from(Me.entries()).map(([Ge,gt])=>({menuItemId:Ge,...gt})).sort((Ge,gt)=>gt.quantity-Ge.quantity).slice(0,5),ht=new Map;_e.forEach(Ge=>{if(Ge.tableId){const gt=n.find(Vt=>Vt.id===Ge.tableId),St=ht.get(Ge.tableId);St?(St.orderCount+=1,St.revenue+=Ge.total):ht.set(Ge.tableId,{tableNumber:(gt==null?void 0:gt.number)||"Unknown",orderCount:1,revenue:Ge.total})}});const Qe=Array.from(ht.entries()).map(([Ge,gt])=>({tableId:Ge,...gt})).sort((Ge,gt)=>gt.revenue-Ge.revenue);W({totalOrders:me.length,totalRevenue:lt,actualRevenue:pt.actualRevenue,pendingCredits:pt.pendingCreditAmount,avgOrderValue:me.length>0?lt/me.length:0,todayOrders:X.length,todayRevenue:mt,todayActualRevenue:ze.actualRevenue,popularItems:rt,tableStats:Qe})},[n]),Y=R.useCallback(async()=>{let me=[...r];const Fe=new Date;switch(U){case"all":break;case"today":const Re=new Date(Fe.getFullYear(),Fe.getMonth(),Fe.getDate()),Be=new Date(Re);Be.setHours(23,59,59,999),me=me.filter(Qe=>{const Ge=new Date(Qe.createdAt);return Ge>=Re&&Ge<=Be});break;case"yesterday":const X=new Date(Fe.getFullYear(),Fe.getMonth(),Fe.getDate()-1),_e=new Date(X);_e.setHours(23,59,59,999),me=me.filter(Qe=>{const Ge=new Date(Qe.createdAt);return Ge>=X&&Ge<=_e});break;case"week":const ke=new Date(Fe.getTime()-7*24*60*60*1e3);me=me.filter(Qe=>new Date(Qe.createdAt)>=ke);break;case"last_week":const lt=new Date(Fe.getTime()-7*24*60*60*1e3),mt=new Date(lt.getTime()-7*24*60*60*1e3);me=me.filter(Qe=>{const Ge=new Date(Qe.createdAt);return Ge>=mt&&Ge<lt});break;case"month":const pt=new Date(Fe.getTime()-30*24*60*60*1e3);me=me.filter(Qe=>new Date(Qe.createdAt)>=pt);break;case"this_month":const ze=new Date(Fe.getFullYear(),Fe.getMonth(),1);me=me.filter(Qe=>new Date(Qe.createdAt)>=ze);break;case"last_month":const Me=new Date(Fe.getFullYear(),Fe.getMonth()-1,1),rt=new Date(Fe.getFullYear(),Fe.getMonth(),1);me=me.filter(Qe=>{const Ge=new Date(Qe.createdAt);return Ge>=Me&&Ge<rt});break;case"quarter":const ht=new Date(Fe.getTime()-90*24*60*60*1e3);me=me.filter(Qe=>new Date(Qe.createdAt)>=ht);break;case"custom":if(V){const Qe=new Date(V);me=me.filter(Ge=>new Date(Ge.createdAt)>=Qe)}if(L){const Qe=new Date(L);Qe.setHours(23,59,59,999),me=me.filter(Ge=>new Date(Ge.createdAt)<=Qe)}break}K&&K!=="all"&&(me=me.filter(Re=>Re.tableId===K)),fe&&fe!=="all"&&(me=me.filter(Re=>Re.status===fe)),ee&&ee!=="all"&&(me=me.filter(Re=>Re.type===ee)),de&&de!=="all"&&(me=me.filter(Re=>Re.items.some(Be=>Be.menuItemId===de))),Q&&(me=me.filter(Re=>Re.orderNumber.toLowerCase().includes(Q.toLowerCase())||Re.items.some(Be=>Be.name.toLowerCase().includes(Q.toLowerCase())))),q(me),await Ie(me),C(1)},[r,U,V,L,K,fe,ee,de,Q,Ie]);R.useEffect(()=>{Y()},[Y]);const H=R.useCallback(me=>{const Fe=me.filter((X,_e,ke)=>_e===ke.findIndex(lt=>lt.id===X.id)),Re=new Map,Be=[...Fe].sort((X,_e)=>new Date(X.createdAt).getTime()-new Date(_e.createdAt).getTime());return Be.forEach((X,_e)=>{if(!X.tableId){Re.set(X.id,[X]);return}let ke=!1;for(let lt=_e-1;lt>=0;lt--){const mt=Be[lt];if(mt.tableId===X.tableId){const pt=X.status==="completed"&&(X.paymentStatus==="paid"||X.paymentMethod),ze=mt.status==="completed"&&(mt.paymentStatus==="paid"||mt.paymentMethod);if(pt&&ze){const Me=new Date(X.updatedAt).getTime(),rt=new Date(mt.updatedAt).getTime(),ht=Math.abs(Me-rt),Qe=30*1e3;if(ht<=Qe){for(const[Ge,gt]of Re.entries())if(gt.some(St=>St.id===mt.id)){gt.push(X),ke=!0;break}if(ke)break}}else if(!pt&&!ze){const Me=new Date(X.createdAt).getTime(),rt=new Date(mt.createdAt).getTime(),ht=Me-rt,Qe=15*60*1e3;if(ht<=Qe){for(const[Ge,gt]of Re.entries())if(gt.some(St=>St.id===mt.id)){gt.push(X),ke=!0;break}if(ke)break}}break}}ke||Re.set(X.id,[X])}),Array.from(Re.entries()).map(([X,_e])=>({groupKey:X,orders:_e.sort((ke,lt)=>new Date(ke.createdAt).getTime()-new Date(lt.createdAt).getTime()),primaryOrder:_e[0],totalAmount:_e.reduce((ke,lt)=>ke+lt.total,0),totalItems:_e.reduce((ke,lt)=>ke+lt.items.reduce((mt,pt)=>mt+pt.quantity,0),0),isGroup:_e.length>1}))},[]),je=me=>{k(Fe=>{const Re=new Set(Fe);return Re.has(me)?Re.delete(me):Re.add(me),Re})},Ce=R.useMemo(()=>H(D),[D,H]),oe=Ce.length,He=Math.ceil(oe/w),ie=(j-1)*w,le=Ce.slice(ie,ie+w),ae=async(me,Fe)=>{if(t)try{const Re=await Ur.updateOrderStatus(me,t.id,Fe);Re.success?(s(Be=>Be.map(X=>X.id===me?{...X,status:Fe}:X)),h&&h.id===me&&f({...h,status:Fe}),yr.success("Order status updated successfully")):yr.error(Re.error||"Failed to update order status")}catch{yr.error("Failed to update order status")}},ve=async(me,Fe)=>{if(t)try{x(!0);const Re={paymentMethod:Fe.paymentMethod,amountReceived:Fe.amountReceived,finalTotal:Fe.finalTotal,originalTotal:Fe.originalTotal,total:Fe.finalTotal,updatedAt:new Date};(Fe.manualDiscountAmount>0||Fe.couponDiscountAmount>0)&&(Re.discountApplied=!0,Re.totalDiscountAmount=(Fe.manualDiscountAmount||0)+(Fe.couponDiscountAmount||0),Re.originalTotalBeforeDiscount=Fe.originalTotal,Fe.manualDiscount&&(Re.manualDiscount={type:Fe.manualDiscount.type,value:Fe.manualDiscount.value,amount:Fe.manualDiscountAmount,reason:Fe.manualDiscount.reason||""}),Fe.couponDiscountAmount>0&&(Re.couponDiscountAmount=Fe.couponDiscountAmount),Re.discount=(Fe.manualDiscountAmount||0)+(Fe.couponDiscountAmount||0)),Fe.tip>0&&(Re.tip=Fe.tip),Fe.totalSavings>0&&(Re.totalSavings=Fe.totalSavings),Fe.appliedCoupon&&(Re.appliedCoupon={code:Fe.appliedCoupon.coupon.code,name:Fe.appliedCoupon.coupon.name,discountAmount:Fe.appliedCoupon.discountAmount||0,freeItems:Fe.appliedCoupon.freeItems||[],totalSavings:Fe.totalSavings||0}),Fe.isSplitPayment&&(Re.splitPayments=Fe.splitPayments,Re.paymentMethod="split");const Be=await Ur.updateOrderStatus(me,t.id,"completed",Re);if(Be.success){s(_e=>_e.map(ke=>ke.id===me?{...ke,paymentMethod:Re.paymentMethod,amountReceived:Re.amountReceived,finalTotal:Re.finalTotal,originalTotal:Re.originalTotal,splitPayments:Re.splitPayments}:ke)),g&&g.id===me&&y({...g,paymentMethod:Re.paymentMethod,amountReceived:Re.amountReceived,finalTotal:Re.finalTotal,originalTotal:Re.originalTotal}),m(!1),y(null);const X=Fe.isSplitPayment?`Split payment (${Fe.splitPayments.map(_e=>_e.method.toUpperCase()).join(" + ")})`:Fe.paymentMethod.toUpperCase();yr.success(`Payment method updated to ${X}`)}else yr.error(Be.error||"Failed to update payment details")}catch(Re){console.error("Payment update error:",Re),yr.error("Failed to update payment details")}finally{x(!1)}},we=async me=>{if(!t){yr.error("Restaurant data not available");return}const Fe=n.find(Re=>Re.id===me.tableId);if(!Fe){yr.error("Table information not found");return}try{const Re=yr.loading("Generating bill with QR code...");console.log(" Starting bill generation for order:",{orderId:me.id,orderNumber:me.orderNumber,restaurant:t.name});const Be=await Rpe(me,t,Fe);yr.dismiss(Re),await new Promise(_e=>setTimeout(_e,500));const X=window.open("","_blank");X&&(X.document.write(Be),X.document.close(),X.addEventListener("load",()=>{setTimeout(()=>{X.focus(),X.print()},1e3)}),setTimeout(()=>{X.focus(),X.print(),X.close()},2e3)),yr.success(`Bill for Order #${me.orderNumber} sent to printer`)}catch(Re){console.error(" Error generating bill:",Re),yr.error("Failed to generate bill")}},De=me=>{const Re={draft:{color:"bg-gray-100 text-gray-600",label:"Draft"},placed:{color:"bg-blue-100 text-blue-800",label:"Placed"},confirmed:{color:"bg-yellow-100 text-yellow-800",label:"Confirmed"},preparing:{color:"bg-orange-100 text-orange-800",label:"Preparing"},ready:{color:"bg-green-100 text-green-800",label:"Ready"},completed:{color:"bg-gray-100 text-gray-800",label:"Completed"},cancelled:{color:"bg-red-100 text-red-800",label:"Cancelled"}}[me];return a.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${Re.color}`,children:Re.label})},Ve=async()=>{var me,Fe;if(!t||D.length===0){yr.error("No data to export");return}try{const Re=H(D);console.log(" Starting export process...",{restaurantId:t.id,filteredOrdersCount:D.length,groupedOrdersCount:Re.length,filters:{dateRange:U,tableId:K,status:fe,orderType:ee,menuItemId:de,searchTerm:Q}}),yr.loading("Generating export...");const Be=new Date,X=new Date(Be.getFullYear(),Be.getMonth(),Be.getDate());let _e,ke,lt;switch(U){case"today":_e=X,ke=new Date,lt="Today";break;case"week":_e=new Date(X.getTime()-7*24*60*60*1e3),ke=new Date,lt="Last 7 Days";break;case"month":_e=new Date(X.getFullYear(),X.getMonth(),1),ke=new Date,lt="This Month";break;case"custom":_e=V?new Date(V):new Date(X.getTime()-30*24*60*60*1e3),ke=L?new Date(L):new Date,lt=`${hs(_e)} - ${hs(ke)}`;break;default:_e=X,ke=new Date,lt="Today"}console.log(" Date range for export:",{exportStartDate:_e,exportEndDate:ke,rangeLabel:lt}),console.log(" Creating analytics directly from filtered orders...");const mt={totalRevenue:0,totalOrders:0,averageOrderValue:0,totalItems:0,totalCustomers:0,revenueGrowth:0,orderGrowth:0,customerGrowth:0,menuItemSales:[],categorySales:[],tableSales:[],hourlyBreakdown:[],dailyBreakdown:[],paymentMethodBreakdown:[],orderTypeBreakdown:[],topCustomers:[],staffPerformance:[],peakHours:[],itemCombinations:[]},pt=D.filter(z=>z.status==="completed"),ze=pt.reduce((z,ce)=>{const xe=ce.creditAmount||0,Pe=ce.total-xe;return z+Pe},0),Me=pt.reduce((z,ce)=>z+ce.total,0),rt=pt.reduce((z,ce)=>z+(ce.creditAmount||0),0),ht=pt.reduce((z,ce)=>z+(ce.totalSavings||0),0),Qe=D.reduce((z,ce)=>z+ce.items.reduce((xe,Pe)=>xe+Pe.quantity,0),0),Ge=new Map;pt.forEach(z=>{z.items.forEach(ce=>{const xe=Ge.get(ce.menuItemId)||{menuItemId:ce.menuItemId,name:ce.name,quantitySold:0,revenue:0};xe.quantitySold+=ce.quantity,xe.revenue+=ce.total,Ge.set(ce.menuItemId,xe)})});const gt=Array.from(Ge.values()).map(z=>({...z,percentage:ze>0?z.revenue/ze*100:0})).sort((z,ce)=>ce.revenue-z.revenue),St=new Map;Re.forEach(z=>{if(z.primaryOrder.tableId){const ce=n.find(Ze=>Ze.id===z.primaryOrder.tableId),xe=St.get(z.primaryOrder.tableId)||{tableId:z.primaryOrder.tableId,tableNumber:(ce==null?void 0:ce.number)||"Unknown",orderCount:0,revenue:0},Pe=z.orders.filter(Ze=>Ze.status==="completed");Pe.length>0&&(xe.orderCount+=1,xe.revenue+=Pe.reduce((Ze,Ye)=>Ze+Ye.total,0)),St.set(z.primaryOrder.tableId,xe)}});const Vt=Array.from(St.values()).map(z=>({...z,averageOrderValue:z.orderCount>0?z.revenue/z.orderCount:0,utilizationRate:0})).sort((z,ce)=>ce.revenue-z.revenue),Kt=new Map;pt.forEach(z=>{z.items.forEach(ce=>{const xe=o.find(Ye=>Ye.id===ce.menuItemId),Pe=(xe==null?void 0:xe.categoryName)||"Uncategorized",Ze=Kt.get(Pe)||{categoryName:Pe,quantitySold:0,revenue:0};Ze.quantitySold+=ce.quantity,Ze.revenue+=ce.total,Kt.set(Pe,Ze)})});const qe=Array.from(Kt.values()).map(z=>({...z,percentage:ze>0?z.revenue/ze*100:0,itemCount:0})).sort((z,ce)=>ce.revenue-z.revenue),Xe=new Map;pt.forEach(z=>{const ce=z.type||"dine_in",xe=Xe.get(ce)||{type:ce,count:0,revenue:0};xe.count+=1,xe.revenue+=z.total,Xe.set(ce,xe)});const Ke=Array.from(Xe.values()).map(z=>({...z,percentage:ze>0?z.revenue/ze*100:0})),We=new Map;pt.forEach(z=>{const ce=new Date(z.createdAt).getHours(),xe=We.get(ce)||{hour:ce,orderCount:0,revenue:0};xe.orderCount+=1,xe.revenue+=z.total,We.set(ce,xe)});const Ft=Array.from(We.values()).sort((z,ce)=>z.hour-ce.hour),Ct=new Map;pt.forEach(z=>{var ce;if(z.paymentMethod==="split"&&z.splitPayments){const xe=z.splitPayments,Pe=new Map;xe.forEach(Je=>{const et=Je.method.toUpperCase();Pe.set(et,(Pe.get(et)||0)+Je.amount)}),Pe.forEach((Je,et)=>{const ft=Ct.get(et)||{method:et,count:0,amount:0,splitDetails:[]};ft.count+=1,ft.amount+=Je,ft.splitDetails||(ft.splitDetails=[]);const At=ft.splitDetails.find(Nt=>Nt.method===et);At?(At.amount+=Je,At.count+=1):ft.splitDetails.push({method:et,amount:Je,count:1}),Ct.set(et,ft)});const Ze=z.total,Ye=Ct.get("SPLIT")||{method:"SPLIT",count:0,amount:0,splitDetails:xe.map(Je=>({method:Je.method.toUpperCase(),amount:Je.amount,count:1}))};Ye.count+=1,Ye.amount+=Ze,Ct.set("SPLIT",Ye)}else if(z.paymentMethod){const xe=z.paymentMethod.toUpperCase(),Pe=Ct.get(xe)||{method:xe,count:0,amount:0};Pe.count+=1,Pe.amount+=z.total,Ct.set(xe,Pe)}else{let xe="CASH";const Pe=((ce=z.notes)==null?void 0:ce.toLowerCase())||"";Pe.includes("upi")||Pe.includes("gpay")||Pe.includes("paytm")||Pe.includes("phonepe")?xe="UPI":(Pe.includes("card")||Pe.includes("bank"))&&(xe="BANK");const Ze=Ct.get(xe)||{method:xe,count:0,amount:0};Ze.count+=1,Ze.amount+=z.total,Ct.set(xe,Ze)}});const xr=Array.from(Ct.values()).map(z=>({...z,percentage:ze>0?z.amount/ze*100:0})).sort((z,ce)=>ce.amount-z.amount),vr={...mt,totalRevenue:ze,totalOrders:D.length,totalOrderGroups:Re.length,averageOrderValue:D.length>0?ze/D.length:0,averageGroupValue:Re.length>0?ze/Re.length:0,totalItems:Qe,menuItemSales:gt,tableSales:Vt,categorySales:qe,orderTypeBreakdown:Ke,paymentMethodBreakdown:xr,hourlyBreakdown:Ft,peakHours:Ft.slice().sort((z,ce)=>ce.orderCount-z.orderCount).map(z=>({...z,isWeekend:!1})),creditAnalytics:{totalCreditAmount:rt,pendingCreditAmount:rt,paidCreditAmount:0,ordersWithCredits:pt.filter(z=>z.isCredit).length,creditTransactions:pt.filter(z=>z.isCredit).map(z=>{const ce=n.find(xe=>xe.id===z.tableId);return{customerName:z.creditCustomerName||"Unknown",customerPhone:z.creditCustomerPhone||"",orderId:z.id,tableNumber:(ce==null?void 0:ce.number)||"Unknown",totalAmount:z.total,amountReceived:z.amountReceived||0,creditAmount:z.creditAmount||0,remainingAmount:z.creditAmount||0,status:"pending",createdAt:z.createdAt,paymentHistory:[]}}),revenueCollectionRate:Me>0?ze/Me*100:100,actualRevenue:ze,totalBillAmount:Me},savingsAnalytics:{ordersWithSavings:pt.filter(z=>z.totalSavings>0).length,totalSavingsAmount:ht,averageSavingsAmount:ht>0?ht/pt.filter(z=>z.totalSavings>0).length:0,savingsPercentage:Me+ht>0?ht/(Me+ht)*100:0},groupingInsights:{totalGroups:Re.length,totalIndividualOrders:D.length,groupedOrders:Re.filter(z=>z.isGroup).length,standaloneOrders:Re.filter(z=>!z.isGroup).length,averageOrdersPerGroup:Re.length>0?Re.reduce((z,ce)=>z+ce.orders.length,0)/Re.length:0}};console.log(" Custom analytics created:",vr);const Pr=Re.slice(0,50).map(z=>{const ce=n.find(At=>At.id===z.primaryOrder.tableId);let xe="Not specified";const Pe=z.orders.reduce((At,Nt)=>At+(Nt.creditAmount||0),0),Ze=z.orders.reduce((At,Nt)=>At+(Nt.discount||0),0),Ye=z.orders.reduce((At,Nt)=>At+(Nt.totalSavings||0),0),Je=z.orders.some(At=>At.isCredit),et=Ze>0,ft=Ye>0;if(z.primaryOrder.paymentMethod==="split"&&z.primaryOrder.splitPayments?xe=`Split: ${z.primaryOrder.splitPayments.map(Nt=>`${Nt.method.toUpperCase()} Rs.${Nt.amount.toFixed(2)}`).join(" + ")}`:z.primaryOrder.paymentMethod&&(xe=z.primaryOrder.paymentMethod.toUpperCase()),Je||et||ft){const At=z.orders.filter(kt=>kt.isCredit&&kt.creditCustomerName).map(kt=>kt.creditCustomerName);let Nt=`${xe}`;Je&&(Nt+=`
 Credit: -${Ue(Pe)}`,At.length>0&&(Nt+=`
 Customer: ${At.slice(0,2).join(", ")}${At.length>2?` +${At.length-2} more`:""}`)),et&&(Nt+=`
 Discount: -${Ue(Ze)}`),ft&&(Nt+=`
 Savings: ${Ue(Ye)}`),xe=Nt}if(z.isGroup){const At=z.orders.map(Ar=>Ar.orderNumber).join(", "),Nt=z.orders.flatMap(Ar=>Ar.items.map(or=>`${or.quantity}x ${or.name}`)),kt=z.orders.reduce((Ar,or)=>Ar+(or.creditAmount||0),0),Ht=z.orders.reduce((Ar,or)=>Ar+(or.amountReceived||or.total),0),ir=z.orders.reduce((Ar,or)=>Ar+(or.totalSavings||0),0);return{orderNumber:`${z.primaryOrder.orderNumber} (+${z.orders.length-1} more)`,tableNumber:(ce==null?void 0:ce.number)||"N/A",date:hs(z.primaryOrder.createdAt),time:Wn(z.primaryOrder.createdAt),status:z.primaryOrder.status,type:z.primaryOrder.type,paymentMethod:xe,itemCount:z.orders.reduce((Ar,or)=>Ar+or.items.length,0),totalItems:z.totalItems,subtotal:z.orders.reduce((Ar,or)=>Ar+(or.subtotal||0),0),tax:z.orders.reduce((Ar,or)=>Ar+(or.tax||0),0),total:z.totalAmount,items:Nt.join(", "),creditAmount:kt,amountReceived:Ht,actualRevenue:z.totalAmount-kt,totalSavings:ir,isCredit:kt>0,groupDetails:z.orders.map(Ar=>({orderNumber:Ar.orderNumber,time:Wn(Ar.createdAt),items:Ar.items.map(or=>`${or.quantity}x ${or.name}`).join(", "),total:Ar.total,creditAmount:Ar.creditAmount||0,amountReceived:Ar.amountReceived||Ar.total,customerName:Ar.creditCustomerName||"",totalSavings:Ar.totalSavings||0}))}}else{const At=z.primaryOrder,Nt=At.creditAmount||0,kt=At.amountReceived||At.total,Ht=At.totalSavings||0,ir=At.discount||0;let Ar=xe;if(Nt>0||ir>0||Ht>0){let or=`${xe}`;Nt>0&&(or+=`
 Credit: -${Ue(Nt)}`,At.creditCustomerName&&(or+=`
 Customer: ${At.creditCustomerName}`)),ir>0&&(or+=`
 Discount: -${Ue(ir)}`),Ht>0&&(or+=`
 Savings: ${Ue(Ht)}`),Ar=or}return{orderNumber:At.orderNumber,tableNumber:(ce==null?void 0:ce.number)||"N/A",date:hs(At.createdAt),time:Wn(At.createdAt),status:At.status,type:At.type,paymentMethod:Ar,itemCount:At.items.length,totalItems:At.items.reduce((or,ns)=>or+ns.quantity,0),subtotal:At.subtotal,tax:At.tax,total:At.total,items:At.items.map(or=>`${or.quantity}x ${or.name}`).join(", "),creditAmount:Nt,amountReceived:kt,actualRevenue:At.total-Nt,totalSavings:Ht,isCredit:Nt>0,creditCustomerName:At.creditCustomerName||"",creditCustomerPhone:At.creditCustomerPhone||""}}});vr.detailedOrderList=Pr;const Mr={includeGraphs:!0,includeMenuAnalysis:!0,includeTableAnalysis:!0,includeCustomerAnalysis:!1,includeStaffAnalysis:!1,includeTimeAnalysis:!0,includeTaxBreakdown:!1,includeDiscountAnalysis:!1,includeOrderDetails:!0,reportTitle:`Orders Export - ${lt}`,additionalNotes:`Grouped orders export containing ${D.length} individual orders (${Re.length} groups). Applied filters: ${[U!=="today"?`Date: ${lt}`:null,K&&K!=="all"?`Table: ${((me=n.find(z=>z.id===K))==null?void 0:me.number)||"N/A"}`:null,fe&&fe!=="all"?`Status: ${fe}`:null,ee&&ee!=="all"?`Type: ${ee.replace("_"," ")}`:null,de&&de!=="all"?`Item: ${((Fe=o.find(z=>z.id===de))==null?void 0:Fe.name)||"N/A"}`:null,Q?`Search: "${Q}"`:null].filter(Boolean).join(", ")||"None"}. ${Re.length>50?"Note: Only first 50 order groups shown in detail.":"Related orders from same table are grouped together."}`},Jr={startDate:_e,endDate:ke,label:lt};console.log(" Generating PDF...");const ye=await xS.generatePDFReport(vr,Jr,t.name,Mr);console.log(" PDF generated successfully, size:",ye.size);const Le=URL.createObjectURL(ye),se=document.createElement("a");se.href=Le,se.download=`orders-export-${t.name.replace(/\s+/g,"-").toLowerCase()}-${hs(new Date).replace(/\//g,"-")}.pdf`,document.body.appendChild(se),se.click(),document.body.removeChild(se),URL.revokeObjectURL(Le),console.log(" Export completed successfully"),yr.dismiss(),yr.success(`Export completed! ${D.length} orders in ${Re.length} groups exported.`)}catch(Re){yr.dismiss(),console.error(" Export error:",Re),yr.error(`Failed to export data: ${Re instanceof Error?Re.message:"Unknown error"}`)}};return a.jsxs("div",{className:"min-h-screen",style:{background:"var(--color-background)"},children:[a.jsx("header",{className:"bg-white/80 backdrop-blur-md border-b border-gray-200",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx("div",{className:"w-12 h-12 rounded-2xl flex items-center justify-center text-white",style:{background:"var(--gradient-primary)"},children:a.jsx(Sa,{className:"w-6 h-6"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Order Area"}),a.jsx("p",{className:"text-gray-600",children:"Manage and analyze all orders in your area"})]})]}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsxs("div",{className:"flex bg-gray-100 rounded-lg p-1",children:[a.jsxs("button",{onClick:()=>F("list"),className:`px-3 py-2 rounded-md text-sm font-medium transition-colors ${S==="list"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:[a.jsx(Rl,{className:"w-4 h-4 mr-2 inline"}),"Orders"]}),a.jsxs("button",{onClick:()=>F("analytics"),className:`px-3 py-2 rounded-md text-sm font-medium transition-colors ${S==="analytics"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:[a.jsx(Sa,{className:"w-4 h-4 mr-2 inline"}),"Analytics"]}),a.jsxs("button",{onClick:()=>F("reports"),className:`px-3 py-2 rounded-md text-sm font-medium transition-colors ${S==="reports"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:[a.jsx(Yn,{className:"w-4 h-4 mr-2 inline"}),"Reports"]})]}),a.jsxs("button",{onClick:()=>ue(),className:"btn btn-secondary",disabled:c,children:[a.jsx(Di,{className:`w-4 h-4 mr-2 ${c?"animate-spin":""}`}),"Refresh"]})]})]})})}),a.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6 mb-8",children:[a.jsx("div",{className:"card p-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Orders"}),a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:te.totalOrders})]}),a.jsx("div",{className:"w-12 h-12 bg-blue-50 rounded-lg flex items-center justify-center",children:a.jsx(Zi,{className:"w-6 h-6 text-blue-600"})})]})}),a.jsx("div",{className:"card p-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Actual Revenue"}),a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:Ue(te.actualRevenue)}),a.jsxs("p",{className:"text-xs text-gray-500",children:["Total: ",Ue(te.totalRevenue)," | Credits: ",Ue(te.pendingCredits)]})]}),a.jsx("div",{className:"w-12 h-12 bg-green-50 rounded-lg flex items-center justify-center",children:a.jsx(hn,{className:"w-6 h-6 text-green-600"})})]})}),a.jsx("div",{className:"card p-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Avg Order Value"}),a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:Ue(te.avgOrderValue)})]}),a.jsx("div",{className:"w-12 h-12 bg-purple-50 rounded-lg flex items-center justify-center",children:a.jsx(Is,{className:"w-6 h-6 text-purple-600"})})]})}),a.jsx("div",{className:"card p-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Today's Orders"}),a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:te.todayOrders})]}),a.jsx("div",{className:"w-12 h-12 bg-orange-50 rounded-lg flex items-center justify-center",children:a.jsx(Ys,{className:"w-6 h-6 text-orange-600"})})]})}),a.jsx("div",{className:"card p-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Today's Actual Revenue"}),a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:Ue(te.todayActualRevenue)}),a.jsxs("p",{className:"text-xs text-gray-500",children:["Total: ",Ue(te.todayRevenue)]})]}),a.jsx("div",{className:"w-12 h-12 bg-yellow-50 rounded-lg flex items-center justify-center",children:a.jsx(hn,{className:"w-6 h-6 text-yellow-600"})})]})})]}),S==="list"&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"card p-6 mb-6",children:a.jsxs("form",{onSubmit:he(()=>{}),children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-7 gap-4",children:[a.jsx("div",{className:"md:col-span-2",children:a.jsxs("div",{className:"relative",children:[a.jsx(sn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),a.jsx("input",{type:"text",placeholder:"Search orders, items...",value:Q,onChange:me=>re(me.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})}),a.jsx("div",{children:a.jsxs("select",{...Ae("dateRange"),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"all",children:"All Orders"}),a.jsx("option",{value:"today",children:"Today"}),a.jsx("option",{value:"yesterday",children:"Yesterday"}),a.jsx("option",{value:"week",children:"This Week"}),a.jsx("option",{value:"month",children:"This Month"}),a.jsx("option",{value:"custom",children:"Custom Range"})]})}),a.jsx("div",{children:a.jsxs("select",{...Ae("tableId"),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"",children:"All Tables"}),n.map(me=>a.jsxs("option",{value:me.id,children:["Table ",me.number]},me.id))]})}),a.jsx("div",{children:a.jsxs("select",{...Ae("status"),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"all",children:"All Status"}),a.jsx("option",{value:"placed",children:"Placed"}),a.jsx("option",{value:"confirmed",children:"Confirmed"}),a.jsx("option",{value:"preparing",children:"Preparing"}),a.jsx("option",{value:"ready",children:"Ready"}),a.jsx("option",{value:"completed",children:"Completed"}),a.jsx("option",{value:"cancelled",children:"Cancelled"})]})}),a.jsx("div",{children:a.jsxs("select",{...Ae("orderType"),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"all",children:"All Types"}),a.jsx("option",{value:"dine_in",children:"Dine In"}),a.jsx("option",{value:"takeaway",children:"Takeaway"}),a.jsx("option",{value:"delivery",children:"Delivery"})]})}),a.jsx("div",{children:a.jsxs("select",{...Ae("menuItemId"),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"all",children:"All Items"}),o.map(me=>a.jsx("option",{value:me.id,children:me.name},me.id))]})})]}),U==="custom"&&a.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Start Date"}),a.jsx("input",{type:"date",...Ae("startDate"),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"End Date"}),a.jsx("input",{type:"date",...Ae("endDate"),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]})]})}),a.jsxs("div",{className:"card",children:[a.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:["Orders (",D.length,")"]}),a.jsxs("button",{onClick:Ve,className:"btn btn-secondary",disabled:c||D.length===0,children:[a.jsx(Yn,{className:"w-4 h-4 mr-2"}),"Export (",D.length,")"]})]})}),c?a.jsxs("div",{className:"text-center py-12",children:[a.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Loading orders..."})]}):D.length===0?a.jsxs("div",{className:"text-center py-12",children:[a.jsx(Zi,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No orders found"}),a.jsx("p",{className:"text-gray-600",children:"No orders match your current filters."})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"divide-y divide-gray-200",children:le.map(me=>{const Fe=n.find(Be=>Be.id===me.primaryOrder.tableId),Re=B.has(me.groupKey);return a.jsxs("div",{className:"border-b border-gray-200",children:[a.jsx("div",{className:`p-6 hover:bg-gray-50 cursor-pointer ${Re?"bg-blue-50":""}`,onClick:()=>me.isGroup&&je(me.groupKey),children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center space-x-4 mb-2",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[me.isGroup&&a.jsx("button",{className:"p-1 text-gray-400 hover:text-gray-600",children:Re?a.jsx(Lte,{className:"w-4 h-4"}):a.jsx(rM,{className:"w-4 h-4"})}),a.jsxs("h3",{className:"font-semibold text-gray-900",children:["#",me.primaryOrder.orderNumber,me.isGroup&&` (+${me.orders.length-1} more)`]})]}),De(me.primaryOrder.status),a.jsxs("span",{className:"text-sm text-gray-600",children:["Table ",(Fe==null?void 0:Fe.number)||"N/A"]}),a.jsxs("span",{className:"text-sm text-gray-600",children:[hs(me.primaryOrder.createdAt)," ",Wn(me.primaryOrder.createdAt)]})]}),a.jsxs("div",{className:"text-sm text-gray-600 mb-2",children:[me.totalItems," item",me.totalItems!==1?"s":""," ",me.isGroup?`${me.orders.length} orders combined`:`${me.primaryOrder.items.slice(0,3).map(Be=>Be.name).join(", ")}${me.primaryOrder.items.length>3?` + ${me.primaryOrder.items.length-3} more`:""}`]}),(()=>{const Be=me.orders.some(mt=>mt.isCredit),X=me.orders.reduce((mt,pt)=>mt+(pt.creditAmount||0),0),_e=me.orders.reduce((mt,pt)=>mt+(pt.discount||0),0),ke=me.orders.reduce((mt,pt)=>mt+(pt.totalSavings||0),0),lt=me.orders.filter(mt=>mt.isCredit&&mt.creditCustomerName).map(mt=>mt.creditCustomerName);return Be||_e>0||ke>0?a.jsxs("div",{className:"flex flex-wrap gap-2 mb-2",children:[Be&&a.jsxs("div",{className:"flex items-center px-2 py-1 bg-orange-100 text-orange-700 rounded-full text-xs",children:[a.jsx(No,{className:"w-3 h-3 mr-1"}),"Credit: ",Ue(X),lt.length>0&&a.jsxs("span",{className:"ml-1",children:["(",lt.slice(0,2).join(", "),lt.length>2?` +${lt.length-2}`:"",")"]})]}),_e>0&&a.jsxs("div",{className:"flex items-center px-2 py-1 bg-green-100 text-green-700 rounded-full text-xs",children:[a.jsx("span",{className:"text-green-600 mr-1",children:""}),"Discount: ",Ue(_e)]}),ke>0&&a.jsxs("div",{className:"flex items-center px-2 py-1 bg-blue-100 text-blue-700 rounded-full text-xs",children:[a.jsx("span",{className:"text-blue-600 mr-1",children:""}),"Total Savings: ",Ue(ke)]})]}):null})(),a.jsxs("div",{className:"flex items-center space-x-4 text-sm",children:[a.jsxs("span",{className:"flex items-center text-gray-600",children:[a.jsx(Ls,{className:"w-4 h-4 mr-1"}),me.primaryOrder.type.replace("_"," ")]}),a.jsxs("span",{className:"flex items-center text-gray-600",children:[a.jsx(hn,{className:"w-4 h-4 mr-1"}),me.primaryOrder.paymentStatus]})]})]}),a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx("div",{className:"text-right",children:a.jsxs("div",{className:"space-y-1",children:[a.jsx("p",{className:"font-semibold text-gray-900",children:Ue(me.totalAmount)}),a.jsxs("p",{className:"text-sm text-gray-600",children:[me.totalItems," items"]}),(()=>{const Be=me.orders.reduce((lt,mt)=>lt+(mt.creditAmount||0),0),X=me.orders.reduce((lt,mt)=>lt+(mt.amountReceived||mt.total),0),_e=me.orders.reduce((lt,mt)=>lt+(mt.discount||0),0),ke=me.orders.some(lt=>lt.isCredit);return ke||_e>0?a.jsx("div",{className:"text-xs text-gray-500 space-y-0.5",children:ke?a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:["Bill: ",Ue(me.totalAmount)]}),a.jsxs("div",{className:"text-orange-600 font-medium",children:["Credit: -",Ue(Be)]}),a.jsxs("div",{className:"text-green-600 font-medium",children:["Received: ",Ue(X-Be)]})]}):_e>0?a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:["Original: ",Ue(me.totalAmount+_e)]}),a.jsxs("div",{className:"text-green-600 font-medium",children:["Discount: -",Ue(_e)]}),a.jsxs("div",{className:"font-medium",children:["Final: ",Ue(me.totalAmount)]})]}):null}):null})(),me.primaryOrder.paymentMethod&&a.jsx("div",{className:"text-xs text-blue-600 font-medium",children:me.primaryOrder.paymentMethod==="split"?"Split Payment":me.primaryOrder.paymentMethod.toUpperCase()})]})}),a.jsxs("div",{className:"flex items-center space-x-2",onClick:Be=>Be.stopPropagation(),children:[a.jsxs("button",{onClick:()=>{f(me.primaryOrder),A(!0)},className:"btn btn-secondary",children:[a.jsx(Xs,{className:"w-4 h-4 mr-2"}),"View"]}),me.primaryOrder.status==="completed"&&a.jsxs(a.Fragment,{children:[a.jsxs("button",{onClick:()=>we(me.primaryOrder),className:"btn btn-primary",title:`Print bill for Order #${me.primaryOrder.orderNumber}`,children:[a.jsx(R0,{className:"w-4 h-4 mr-2"}),"Print Bill"]}),a.jsxs("button",{onClick:()=>{y(me.primaryOrder),m(!0)},className:"btn bg-orange-600 text-white hover:bg-orange-700",title:`Edit payment method for Order #${me.primaryOrder.orderNumber}`,children:[a.jsx(gc,{className:"w-4 h-4 mr-2"}),"Edit Payment"]})]})]})]})]})}),me.isGroup&&Re&&a.jsx("div",{className:"bg-gray-50 border-t border-gray-200",children:me.orders.map((Be,X)=>a.jsx("div",{className:"px-8 py-4 border-b border-gray-100 last:border-b-0",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center space-x-4 mb-2",children:[a.jsxs("h4",{className:"font-medium text-gray-800",children:["#",Be.orderNumber]}),De(Be.status),a.jsx("span",{className:"text-sm text-gray-500",children:Wn(Be.createdAt)})]}),a.jsx("div",{className:"text-sm text-gray-600 mb-1",children:Be.items.map(_e=>`${_e.quantity}x ${_e.name}`).join(", ")}),Be.notes&&a.jsxs("div",{className:"text-xs text-gray-500 italic",children:["Note: ",Be.notes]})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("p",{className:"font-semibold text-gray-800",children:Ue(Be.total)}),a.jsxs("p",{className:"text-sm text-gray-500",children:[Be.items.reduce((_e,ke)=>_e+ke.quantity,0)," items"]}),Be.isCredit&&a.jsxs("div",{className:"flex items-center justify-end mt-1",children:[a.jsx(No,{className:"w-3 h-3 text-orange-500 mr-1"}),a.jsxs("span",{className:"text-xs text-orange-600 font-medium",children:["",(Be.creditAmount||0).toFixed(2)," Credit"]})]}),Be.totalSavings>0&&a.jsx("div",{className:"flex items-center justify-end mt-1",children:a.jsxs("span",{className:"text-xs text-green-600 font-medium",children:[" Saved ",Be.totalSavings.toFixed(2)]})})]})]})},Be.id))})]},me.groupKey)})}),He>1&&a.jsx("div",{className:"px-6 py-4 border-t border-gray-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"text-sm text-gray-600",children:["Showing ",ie+1," to ",Math.min(ie+w,oe)," of ",oe," order groups"]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("button",{onClick:()=>C(me=>Math.max(1,me-1)),disabled:j===1,className:"p-2 border border-gray-300 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:a.jsx(sM,{className:"w-5 h-5"})}),a.jsxs("span",{className:"px-4 py-2 text-sm font-medium",children:["Page ",j," of ",He]}),a.jsx("button",{onClick:()=>C(me=>Math.min(He,me+1)),disabled:j===He,className:"p-2 border border-gray-300 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:a.jsx(nM,{className:"w-5 h-5"})})]})]})})]})]})]}),S==="analytics"&&a.jsxs("div",{className:"space-y-8",children:[a.jsxs("div",{className:"card p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Analytics Filters"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Select date range to analyze your data"})]}),a.jsxs("div",{className:"text-sm text-gray-500",children:["Showing ",D.length," orders"]})]}),a.jsx("form",{onSubmit:he(()=>{}),children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date Range"}),a.jsxs("select",{...Ae("dateRange"),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"today",children:"Today"}),a.jsx("option",{value:"yesterday",children:"Yesterday"}),a.jsx("option",{value:"week",children:"Last 7 Days"}),a.jsx("option",{value:"last_week",children:"Last Week"}),a.jsx("option",{value:"month",children:"Last 30 Days"}),a.jsx("option",{value:"this_month",children:"This Month"}),a.jsx("option",{value:"last_month",children:"Last Month"}),a.jsx("option",{value:"quarter",children:"Last 3 Months"}),a.jsx("option",{value:"custom",children:"Custom Range"})]})]}),U==="custom"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Start Date"}),a.jsx("input",{type:"date",...Ae("startDate"),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"End Date"}),a.jsx("input",{type:"date",...Ae("endDate"),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),a.jsx("div",{className:"flex items-end",children:a.jsx("div",{className:"bg-blue-50 rounded-lg p-4 w-full",children:a.jsxs("div",{className:"text-center",children:[a.jsx("p",{className:"text-sm font-medium text-blue-700",children:"Selected Period"}),a.jsx("p",{className:"text-lg font-bold text-blue-900",children:Ue(te.totalRevenue)}),a.jsxs("p",{className:"text-xs text-blue-600",children:[te.totalOrders," orders"]})]})})})]})})]}),a.jsx("div",{className:"card p-6",children:a.jsx(Tpe,{orders:D})}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6",children:[a.jsx("div",{className:"card p-6",children:a.jsx(Ipe,{orders:D})}),a.jsx("div",{className:"card p-6",children:a.jsx(kpe,{orders:D})}),a.jsx("div",{className:"card p-6",children:a.jsx(Bpe,{orders:D})})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[a.jsx("div",{className:"card p-6",children:a.jsx(Fpe,{orders:D,tables:n})}),a.jsx("div",{className:"card p-6",children:a.jsx(Ppe,{orders:D,menuItems:o})})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[a.jsxs("div",{className:"card p-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Popular Menu Items"}),te.popularItems.length===0?a.jsxs("div",{className:"text-center py-8",children:[a.jsx(rs,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),a.jsx("p",{className:"text-gray-600",children:"No data available"})]}):a.jsx("div",{className:"space-y-4",children:te.popularItems.map((me,Fe)=>a.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center text-sm font-medium text-blue-600",children:Fe+1}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-gray-900",children:me.name}),a.jsxs("p",{className:"text-sm text-gray-600",children:[me.quantity," sold"]})]})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("p",{className:"font-semibold text-gray-900",children:Ue(me.revenue)}),a.jsx("p",{className:"text-sm text-gray-600",children:"revenue"})]})]},me.menuItemId))})]}),a.jsxs("div",{className:"card p-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Table Performance Summary"}),te.tableStats.length===0?a.jsxs("div",{className:"text-center py-8",children:[a.jsx(ta,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),a.jsx("p",{className:"text-gray-600",children:"No data available"})]}):a.jsx("div",{className:"space-y-4",children:te.tableStats.slice(0,5).map(me=>a.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center",children:a.jsx(ta,{className:"w-4 h-4 text-green-600"})}),a.jsxs("div",{children:[a.jsxs("p",{className:"font-medium text-gray-900",children:["Table ",me.tableNumber]}),a.jsxs("p",{className:"text-sm text-gray-600",children:[me.orderCount," orders"]})]})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("p",{className:"font-semibold text-gray-900",children:Ue(me.revenue)}),a.jsx("p",{className:"text-sm text-gray-600",children:"revenue"})]})]},me.tableId))})]})]}),a.jsxs("div",{className:"card p-6 bg-gradient-to-r from-blue-50 to-purple-50",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Analytics Insights"}),a.jsx(Is,{className:"w-6 h-6 text-blue-600"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"text-center p-4 bg-white rounded-lg shadow-sm",children:[a.jsx("p",{className:"text-sm font-medium text-gray-600 mb-2",children:"Most Active Hour"}),a.jsx("p",{className:"text-xl font-bold text-blue-600",children:D.length>0?(()=>{const me=new Map;return D.forEach(Re=>{const Be=new Date(Re.createdAt).getHours();me.set(Be,(me.get(Be)||0)+1)}),`${Array.from(me.entries()).reduce((Re,[Be,X])=>X>Re.count?{hour:Be,count:X}:Re,{hour:0,count:0}).hour}:00`})():"N/A"})]}),a.jsxs("div",{className:"text-center p-4 bg-white rounded-lg shadow-sm",children:[a.jsx("p",{className:"text-sm font-medium text-gray-600 mb-2",children:"Best Category"}),a.jsx("p",{className:"text-xl font-bold text-green-600",children:(()=>{const me=new Map;return D.forEach(Re=>{Re.items.forEach(Be=>{const X=o.find(ke=>ke.id===Be.menuItemId),_e=(X==null?void 0:X.category)||"Unknown";me.set(_e,(me.get(_e)||0)+Be.total)})}),Array.from(me.entries()).reduce((Re,[Be,X])=>X>Re.revenue?{cat:Be,revenue:X}:Re,{cat:"N/A",revenue:0}).cat})()})]}),a.jsxs("div",{className:"text-center p-4 bg-white rounded-lg shadow-sm",children:[a.jsx("p",{className:"text-sm font-medium text-gray-600 mb-2",children:"Efficiency Score"}),a.jsx("p",{className:"text-xl font-bold text-purple-600",children:(()=>{const me=n.length,Fe=te.tableStats.filter(Be=>Be.orderCount>0).length;return`${(me>0?Fe/me*100:0).toFixed(0)}%`})()})]})]})]})]}),S==="reports"&&a.jsx("div",{className:"space-y-6",children:G?null:a.jsxs("div",{className:"card p-6",children:[a.jsxs("div",{className:"text-center mb-8",children:[a.jsx("div",{className:"w-20 h-20 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center mx-auto mb-6",children:a.jsx(Sa,{className:"w-10 h-10 text-white"})}),a.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Business Analytics Center"}),a.jsx("p",{className:"text-lg text-gray-600 mb-8",children:"Generate comprehensive reports with detailed insights for your restaurant"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[a.jsxs("div",{className:"text-center p-4",children:[a.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-3",children:a.jsx(Is,{className:"w-6 h-6 text-green-600"})}),a.jsx("h3",{className:"font-semibold text-gray-900",children:"Sales Analytics"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Revenue, orders, and growth metrics"})]}),a.jsxs("div",{className:"text-center p-4",children:[a.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-3",children:a.jsx(Ls,{className:"w-6 h-6 text-blue-600"})}),a.jsx("h3",{className:"font-semibold text-gray-900",children:"Customer Insights"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Customer behavior and preferences"})]}),a.jsxs("div",{className:"text-center p-4",children:[a.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-3",children:a.jsx(rs,{className:"w-6 h-6 text-purple-600"})}),a.jsx("h3",{className:"font-semibold text-gray-900",children:"Operational Data"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Menu, tables, and staff performance"})]})]}),a.jsxs("button",{onClick:()=>T(!0),className:"inline-flex items-center px-8 py-4 bg-gradient-to-r from-blue-600 to-purple-600 text-white font-semibold rounded-xl hover:from-blue-700 hover:to-purple-700 transform hover:scale-105 transition-all duration-200 shadow-lg hover:shadow-xl",children:[a.jsx(Rl,{className:"w-6 h-6 mr-3"}),"Generate Comprehensive Report"]}),a.jsx("p",{className:"text-sm text-gray-500 mt-4",children:"Select time periods, customize sections, and download detailed PDF reports"})]}),a.jsxs("div",{className:"border-t pt-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Quick Analytics (Today)"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[a.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-blue-100 rounded-lg p-4 border border-blue-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-blue-700 font-medium",children:"Today's Revenue"}),a.jsx("p",{className:"text-xl font-bold text-blue-900",children:Ue(te.todayRevenue)})]}),a.jsx(hn,{className:"w-8 h-8 text-blue-600"})]})}),a.jsx("div",{className:"bg-gradient-to-r from-green-50 to-green-100 rounded-lg p-4 border border-green-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-green-700 font-medium",children:"Today's Orders"}),a.jsx("p",{className:"text-xl font-bold text-green-900",children:te.todayOrders})]}),a.jsx(Zi,{className:"w-8 h-8 text-green-600"})]})}),a.jsx("div",{className:"bg-gradient-to-r from-purple-50 to-purple-100 rounded-lg p-4 border border-purple-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-purple-700 font-medium",children:"Avg Order Value"}),a.jsx("p",{className:"text-xl font-bold text-purple-900",children:Ue(te.avgOrderValue)})]}),a.jsx(Is,{className:"w-8 h-8 text-purple-600"})]})}),a.jsx("div",{className:"bg-gradient-to-r from-orange-50 to-orange-100 rounded-lg p-4 border border-orange-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-orange-700 font-medium",children:"Total Orders"}),a.jsx("p",{className:"text-xl font-bold text-orange-900",children:te.totalOrders})]}),a.jsx(rs,{className:"w-8 h-8 text-orange-600"})]})})]})]})]})})]}),a.jsx(Dpe,{order:h,isOpen:u,onClose:()=>A(!1),onStatusUpdate:ae,tables:n}),a.jsx(_pe,{isOpen:E,onClose:()=>T(!1)}),a.jsx(Ope,{order:g,isOpen:p,onClose:()=>{m(!1),y(null)},onUpdatePayment:ve,isUpdating:v})]})}function Ope({order:t,isOpen:e,onClose:r,onUpdatePayment:s,isUpdating:n}){var x;const[i,o]=R.useState("cash"),[l,c]=R.useState(0),[d,u]=R.useState([]),[A,h]=R.useState(!1);R.useEffect(()=>{t&&e&&(o(t.paymentMethod||"cash"),c(t.total),u([]),h(!1))},[t,e]);const f=()=>{u([...d,{method:"cash",amount:0}])},p=(E,T,j)=>{const C=[...d];C[E]={...C[E],[T]:j},u(C)},m=E=>{u(d.filter((T,j)=>j!==E))},g=d.reduce((E,T)=>E+(T.amount||0),0),y=t?t.total-g:0,v=()=>{if(!t)return;let E;if(A){if(Math.abs(g-t.total)>.01){yr.error("Split payment amounts must equal the order total");return}E={isSplitPayment:!0,splitPayments:d.map(T=>({method:T.method,amount:T.amount,reference:`Split payment - ${T.method.toUpperCase()}`})),paymentMethod:"split",amountReceived:t.total,finalTotal:t.total,originalTotal:t.total}}else E={isSplitPayment:!1,paymentMethod:i,amountReceived:l,finalTotal:t.total,originalTotal:t.total,reference:`Payment method updated - ${i.toUpperCase()}`};s(t.id,E)};return!e||!t?null:a.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-hidden",children:[a.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-blue-600 text-white p-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-bold",children:"Edit Payment Details"}),a.jsxs("p",{className:"text-blue-100",children:["Order #",t.orderNumber,"  ",Ue(t.total)]})]}),a.jsx("button",{onClick:r,className:"w-8 h-8 bg-white/20 rounded-full flex items-center justify-center hover:bg-white/30 transition-colors",children:a.jsx(qr,{className:"w-5 h-5"})})]})}),a.jsx("div",{className:"p-6 max-h-96 overflow-y-auto",children:a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"radio",name:"paymentType",checked:!A,onChange:()=>h(!1),className:"mr-2"}),a.jsx("span",{className:"font-medium",children:"Single Payment Method"})]}),a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"radio",name:"paymentType",checked:A,onChange:()=>h(!0),className:"mr-2"}),a.jsx("span",{className:"font-medium",children:"Split Payment"})]})]}),A?a.jsx("div",{className:"space-y-4",children:a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h4",{className:"font-medium text-gray-900",children:"Split Payment Details"}),a.jsx("button",{onClick:f,className:"btn btn-secondary btn-sm",children:"Add Payment"})]}),d.map((E,T)=>a.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[a.jsxs("select",{value:E.method,onChange:j=>p(T,"method",j.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"cash",children:"Cash"}),a.jsx("option",{value:"upi",children:"UPI"}),a.jsx("option",{value:"bank",children:"Bank Transfer/Card"})]}),a.jsx("input",{type:"number",placeholder:"Amount",value:E.amount||"",onChange:j=>p(T,"amount",parseFloat(j.target.value)||0),step:"0.01",min:"0",className:"w-32 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),a.jsx("button",{onClick:()=>m(T),className:"w-8 h-8 bg-red-100 text-red-600 rounded-lg hover:bg-red-200 flex items-center justify-center",children:a.jsx(qr,{className:"w-4 h-4"})})]},T)),a.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200",children:[a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{children:"Total Split Amount:"}),a.jsx("span",{className:g===t.total?"text-green-600 font-medium":"text-red-600 font-medium",children:Ue(g)})]}),a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{children:"Order Total:"}),a.jsx("span",{className:"font-medium",children:Ue(t.total)})]}),a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{children:"Remaining:"}),a.jsx("span",{className:y===0?"text-green-600 font-medium":"text-red-600 font-medium",children:Ue(y)})]})]})]})}):a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Payment Method"}),a.jsxs("select",{value:i,onChange:E=>o(E.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"cash",children:"Cash"}),a.jsx("option",{value:"upi",children:"UPI"}),a.jsx("option",{value:"bank",children:"Bank Transfer/Card"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Amount Received"}),a.jsx("input",{type:"number",value:l,onChange:E=>c(parseFloat(E.target.value)||0),step:"0.01",min:"0",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),a.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[a.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"Current Payment Info"}),a.jsxs("div",{className:"text-sm text-blue-700 space-y-1",children:[a.jsxs("p",{children:[a.jsx("strong",{children:"Method:"})," ",((x=t.paymentMethod)==null?void 0:x.toUpperCase())||"Not specified"]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Total:"})," ",Ue(t.total)]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Status:"})," ",t.paymentStatus]})]})]})]})}),a.jsx("div",{className:"px-6 py-4 border-t border-gray-200 bg-gray-50",children:a.jsxs("div",{className:"flex items-center justify-end space-x-3",children:[a.jsx("button",{onClick:r,className:"btn btn-secondary",disabled:n,children:"Cancel"}),a.jsx("button",{onClick:v,disabled:n,className:"btn btn-primary",children:n?"Updating...":"Update Payment"})]})})]})})}function Upe(){const{restaurant:t,updateRestaurant:e}=js(),[r,s]=R.useState("business"),[n,i]=R.useState([]),[o,l]=R.useState([]),[c,d]=R.useState(!0),[u,A]=R.useState(!1),[h,f]=R.useState(!1),[p,m]=R.useState(null),[g,y]=R.useState(!1),[v,x]=R.useState(null),[E,T]=R.useState("all"),{register:j,handleSubmit:C,reset:w,formState:{errors:S}}=nn(),{register:F,handleSubmit:B,reset:k,setValue:D}=nn(),{register:q,handleSubmit:te,reset:W,setValue:Q}=nn();R.useEffect(()=>{t&&(re(),he())},[t]);const re=async()=>{if(t)try{d(!0),console.log(" Loading settings data for restaurant:",t.id);const[Y,H]=await Promise.all([uA.getTableAreasForRestaurant(t.id),fs.getTablesForRestaurant(t.id)]);if(console.log(" Areas result:",Y),console.log(" Tables result:",H),H.success&&H.data&&(l(H.data),console.log(" Set tables:",H.data.length)),Y.success&&Y.data&&Y.data.length>0)i(Y.data),console.log(" Set table areas:",Y.data.length);else if(console.log(" No formal table areas found, extracting from existing tables..."),H.success&&H.data&&H.data.length>0){const je=[...new Set(H.data.map(oe=>oe.area).filter(Boolean))];console.log(" Found area names from tables:",je);const Ce=je.map((oe,He)=>({id:`virtual-${oe.toLowerCase().replace(/\s+/g,"-")}`,restaurantId:t.id,name:oe,description:`${oe} seating area`,isActive:!0,sortOrder:He+1,createdAt:new Date,updatedAt:new Date}));i(Ce),console.log(" Created virtual table areas from existing tables:",Ce.length)}else i([]),console.log(" No tables found either")}catch(Y){console.error(" Error loading settings data:",Y),Z.error("Failed to load settings data")}finally{d(!1)}},G=async Y=>{if(t)try{console.log(" [Settings] Starting migration: Creating table areas from existing tables...",Y.length);const H=[...new Set(Y.map(oe=>oe.area).filter(Boolean))];console.log(" [Settings] Unique area names found:",H);const je=H.map(oe=>({name:oe}));console.log(" [Settings] Unique areas to create:",je);const Ce=[];for(let oe=0;oe<je.length;oe++){const He=je[oe];console.log(" [Settings] Creating area:",He.name);const ie=await uA.createTableArea(t.id,{name:He.name,description:`${He.name} seating area`,isActive:!0,sortOrder:oe+1});console.log(" [Settings] Create area result:",ie),ie.success&&ie.data?Ce.push(ie.data):console.error("Failed to create area:",He.name,ie.error)}Ce.length>0?(i(Ce),console.log(" [Settings] Created TableArea entities:",Ce.length),Z.success(`Created ${Ce.length} table area(s) from existing tables`)):(console.error(" [Settings] No areas were created successfully"),Z.error("Failed to create table areas from existing tables"))}catch(H){console.error("Failed to create table areas from existing tables:",H),Z.error("Migration failed: "+H.message)}},Ae=async()=>{if(t)try{d(!0),console.log(" Initializing default tables and areas...");const Y=await fs.initializeDefaultTables(t.id);Y.success&&Y.data?(await re(),Z.success("Default tables and areas created successfully!")):Z.error(Y.error||"Failed to initialize default tables")}catch(Y){console.error("Failed to initialize defaults:",Y),Z.error("Failed to initialize default tables")}finally{d(!1)}},he=()=>{var Y,H,je,Ce,oe,He,ie,le,ae,ve;t&&w({address:t.settings.address||"",phone:t.settings.phone||"",email:t.settings.email||"",taxRate:t.settings.taxRate||18,gstin:((Y=t.settings.businessInfo)==null?void 0:Y.gstin)||"",fssaiNumber:((H=t.settings.businessInfo)==null?void 0:H.fssaiNumber)||"",businessAddress:((je=t.settings.businessInfo)==null?void 0:je.businessAddress)||"",city:((Ce=t.settings.businessInfo)==null?void 0:Ce.city)||"",state:((oe=t.settings.businessInfo)==null?void 0:oe.state)||"",pincode:((He=t.settings.businessInfo)==null?void 0:He.pincode)||"",country:((ie=t.settings.businessInfo)==null?void 0:ie.country)||"India",website:((le=t.settings.businessInfo)==null?void 0:le.website)||"",upiId:((ae=t.settings.upiSettings)==null?void 0:ae.upiId)||"",enableQRCode:((ve=t.settings.upiSettings)==null?void 0:ve.enableQRCode)||!1})},I=async Y=>{if(t)try{A(!0);const H={...t.settings,address:Y.address,phone:Y.phone,email:Y.email,taxRate:Y.taxRate,businessInfo:{...t.settings.businessInfo,gstin:Y.gstin,fssaiNumber:Y.fssaiNumber,businessAddress:Y.businessAddress,city:Y.city,state:Y.state,pincode:Y.pincode,country:Y.country,website:Y.website},upiSettings:{...t.settings.upiSettings,upiId:Y.upiId,enableQRCode:Y.enableQRCode}},je=await si.updateRestaurant(t.id,{settings:H});je.success?(await e({settings:H}),Z.success("Business information updated successfully")):Z.error(je.error||"Failed to update business information")}catch{Z.error("Failed to update business information")}finally{A(!1)}},U=()=>{m(null),k({name:"",description:"",isActive:!0,sortOrder:n.length+1}),f(!0)},V=Y=>{m(Y),D("name",Y.name),D("description",Y.description||""),D("isActive",Y.isActive),D("sortOrder",Y.sortOrder),f(!0)},L=async Y=>{if(t)try{let H;p?H=await uA.updateTableArea(t.id,p.id,Y):H=await uA.createTableArea(t.id,Y),H.success?(await re(),f(!1),m(null),k(),Z.success(H.message||"Area saved successfully")):Z.error(H.error||"Failed to save area")}catch{Z.error("Failed to save area")}},K=async Y=>{if(!t)return;const H=o.filter(je=>je.areaId===Y.id);if(H.length>0){Z.error(`Cannot delete area. It has ${H.length} table(s). Please move or delete the tables first.`);return}if(confirm(`Are you sure you want to delete the area "${Y.name}"?`))try{const je=await uA.deleteTableArea(t.id,Y.id);je.success?(await re(),Z.success(je.message||"Area deleted successfully")):Z.error(je.error||"Failed to delete area")}catch{Z.error("Failed to delete area")}},fe=()=>{var Y;if(n.length===0){Z.error("Please create at least one table area first");return}x(null),W({number:"",areaId:((Y=n[0])==null?void 0:Y.id)||"",capacity:4,description:"",isActive:!0}),y(!0)},ee=Y=>{x(Y),Q("number",Y.number),Q("areaId",Y.areaId),Q("capacity",Y.capacity),Q("description",Y.description||""),Q("isActive",Y.isActive),y(!0)},de=async Y=>{if(t)try{const H=n.find(oe=>oe.id===Y.areaId);if(!H){Z.error("Please select a valid area");return}const je={...Y,area:H.name,status:"available",restaurantId:t.id};let Ce;v?Ce=await fs.updateTable(v.id,t.id,je):Ce=await fs.createTable(je),Ce.success?(await re(),y(!1),x(null),W(),Z.success(Ce.message||"Table saved successfully")):Z.error(Ce.error||"Failed to save table")}catch{Z.error("Failed to save table")}},ue=async Y=>{if(t){if(Y.status==="occupied"){Z.error("Cannot delete an occupied table");return}if(confirm(`Are you sure you want to delete Table ${Y.number}?`))try{const H=await fs.deleteTable(Y.id,t.id);H.success?(await re(),Z.success(H.message||"Table deleted successfully")):Z.error(H.error||"Failed to delete table")}catch{Z.error("Failed to delete table")}}},Ie=E==="all"||n.length===0?o:o.filter(Y=>Y.areaId===E);return t?a.jsxs("div",{className:"min-h-screen",style:{background:"var(--color-background)"},children:[a.jsx("header",{className:"bg-white/80 backdrop-blur-md border-b border-gray-200",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx("button",{onClick:()=>window.history.back(),className:"p-2 text-gray-600 hover:text-gray-900 rounded-lg hover:bg-gray-100",children:a.jsx(Jo,{className:"w-5 h-5"})}),a.jsx("div",{className:"w-12 h-12 rounded-2xl flex items-center justify-center text-white",style:{background:"var(--gradient-primary)"},children:a.jsx(Sl,{className:"w-6 h-6"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Restaurant Settings"}),a.jsx("p",{className:"text-gray-600",children:"Manage your restaurant configuration"})]})]})})})}),a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[a.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 mb-6",children:a.jsxs("div",{className:"flex",children:[a.jsxs("button",{onClick:()=>s("business"),className:`flex-1 px-6 py-4 text-sm font-medium rounded-l-lg transition-colors ${r==="business"?"bg-blue-50 text-blue-700 border-b-2 border-blue-500":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"}`,children:[a.jsx(Uw,{className:"w-5 h-5 mr-2 inline"}),"Business Information"]}),a.jsxs("button",{onClick:()=>s("tables"),className:`flex-1 px-6 py-4 text-sm font-medium rounded-r-lg transition-colors ${r==="tables"?"bg-blue-50 text-blue-700 border-b-2 border-blue-500":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"}`,children:[a.jsx(Ls,{className:"w-5 h-5 mr-2 inline"}),"Table Management"]})]})}),r==="business"&&a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-8",children:[a.jsxs("div",{className:"mb-6",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Business Information"}),a.jsx("p",{className:"text-gray-600",children:"Update your restaurant's business details for bills and receipts"})]}),a.jsxs("form",{onSubmit:C(I),className:"space-y-8",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Basic Information"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Restaurant Name"}),a.jsx("input",{type:"text",value:t.name,disabled:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg bg-gray-50 text-gray-500 cursor-not-allowed"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Restaurant name cannot be changed"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Business Type"}),a.jsx("input",{type:"text",value:t.businessType.charAt(0).toUpperCase()+t.businessType.slice(1),disabled:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg bg-gray-50 text-gray-500 cursor-not-allowed"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone Number"}),a.jsxs("div",{className:"relative",children:[a.jsx(UA,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),a.jsx("input",{...j("phone"),type:"tel",className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"+91 98765 43210"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address"}),a.jsxs("div",{className:"relative",children:[a.jsx(hN,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),a.jsx("input",{...j("email"),type:"email",className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"restaurant@example.com"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Website"}),a.jsxs("div",{className:"relative",children:[a.jsx(Hte,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),a.jsx("input",{...j("website"),type:"url",className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"https://restaurant.com"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tax Rate (%)"}),a.jsx("input",{...j("taxRate",{required:"Tax rate is required",min:{value:0,message:"Tax rate cannot be negative"},max:{value:100,message:"Tax rate cannot exceed 100%"}}),type:"number",step:"0.01",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"18.00"}),S.taxRate&&a.jsx("p",{className:"text-red-600 text-sm mt-1",children:S.taxRate.message})]})]})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Business Registration"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"GSTIN Number"}),a.jsxs("div",{className:"relative",children:[a.jsx(Dj,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),a.jsx("input",{...j("gstin"),type:"text",className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"22AAAAA0000A1Z5"})]}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"GST Identification Number for tax compliance"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"FSSAI License Number"}),a.jsxs("div",{className:"relative",children:[a.jsx(Rl,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),a.jsx("input",{...j("fssaiNumber"),type:"text",className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"12345678901234"})]}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Food Safety and Standards Authority of India License"})]})]})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Business Address"}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Full Business Address"}),a.jsxs("div",{className:"relative",children:[a.jsx(tM,{className:"absolute left-3 top-3 w-5 h-5 text-gray-400"}),a.jsx("textarea",{...j("businessAddress"),rows:3,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter complete business address for bills and legal documents"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"City"}),a.jsx("input",{...j("city"),type:"text",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Mumbai"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"State"}),a.jsx("input",{...j("state"),type:"text",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Maharashtra"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"PIN Code"}),a.jsx("input",{...j("pincode"),type:"text",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"400001"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Country"}),a.jsx("input",{...j("country"),type:"text",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"India"})]})]})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"UPI Payment Settings"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"UPI ID"}),a.jsxs("div",{className:"relative",children:[a.jsx(No,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),a.jsx("input",{...j("upiId"),type:"text",className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"restaurant@paytm or 9876543210@ybl"})]}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Enter your UPI ID for customer payments (e.g., yourname@paytm, phone@ybl)"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"QR Code Display"}),a.jsxs("div",{className:"flex items-center space-x-3 mt-3",children:[a.jsx("input",{...j("enableQRCode"),type:"checkbox",className:"w-5 h-5 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 focus:ring-2"}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(dM,{className:"w-5 h-5 text-gray-400"}),a.jsx("span",{className:"text-sm text-gray-700",children:"Show UPI QR code on bills and receipts"})]})]}),a.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"When enabled, customers can scan the QR code to pay directly via UPI"})]})]})]}),a.jsx("div",{className:"flex justify-end pt-6 border-t border-gray-200",children:a.jsx("button",{type:"submit",disabled:u,className:"btn btn-primary",children:u?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Saving..."]}):a.jsxs(a.Fragment,{children:[a.jsx(au,{className:"w-4 h-4 mr-2"}),"Save Business Information"]})})})]})]}),r==="tables"&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Table Areas"}),a.jsx("p",{className:"text-gray-600",children:"Manage dining areas for better table organization"})]}),a.jsxs("button",{onClick:U,className:"btn btn-primary",children:[a.jsx(zr,{className:"w-4 h-4 mr-2"}),"Add Area"]})]}),c?a.jsxs("div",{className:"text-center py-8",children:[a.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),a.jsx("p",{className:"text-gray-600 mt-2",children:"Loading areas..."})]}):n.length===0?a.jsxs("div",{className:"text-center py-8",children:[a.jsx(ta,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No table areas"}),a.jsx("p",{className:"text-gray-600 mb-4",children:"Create your first dining area to organize tables"}),a.jsxs("div",{className:"flex items-center justify-center space-x-3",children:[o.length===0&&a.jsxs("button",{onClick:Ae,className:"btn btn-primary",disabled:c,children:[a.jsx(zr,{className:"w-4 h-4 mr-2"}),"Setup Default Tables"]}),a.jsxs("button",{onClick:U,className:"btn btn-secondary",children:[a.jsx(zr,{className:"w-4 h-4 mr-2"}),"Create First Area"]})]})]}):a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:n.map(Y=>{const H=o.filter(je=>je.areaId===Y.id).length;return a.jsxs("div",{className:`p-4 border rounded-lg ${Y.isActive?"border-gray-200 bg-white":"border-gray-200 bg-gray-50"}`,children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("h3",{className:"font-medium text-gray-900",children:Y.name}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("button",{onClick:()=>V(Y),className:"p-1 text-gray-400 hover:text-blue-600 rounded",children:a.jsx(ly,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>K(Y),className:"p-1 text-gray-400 hover:text-red-600 rounded",children:a.jsx(Un,{className:"w-4 h-4"})})]})]}),Y.description&&a.jsx("p",{className:"text-sm text-gray-600 mb-2",children:Y.description}),a.jsxs("div",{className:"flex items-center justify-between text-sm",children:[a.jsxs("span",{className:"text-gray-600",children:[H," tables"]}),a.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${Y.isActive?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:Y.isActive?"Active":"Inactive"})]})]},Y.id)})})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Tables"}),a.jsx("p",{className:"text-gray-600",children:"Manage individual tables and their settings"})]}),a.jsxs("div",{className:"flex items-center space-x-4",children:[n.length>0&&a.jsxs("select",{value:E,onChange:Y=>T(Y.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"all",children:"All Areas"}),n.map(Y=>a.jsx("option",{value:Y.id,children:Y.name},Y.id))]}),a.jsxs("button",{onClick:fe,className:"btn btn-primary",children:[a.jsx(zr,{className:"w-4 h-4 mr-2"}),"Add Table"]})]})]}),n.length===0&&o.length>0&&a.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6",children:a.jsxs("div",{className:"flex items-center",children:[a.jsxs("div",{className:"text-yellow-600 text-sm",children:[" You have ",o.length," tables but no table areas configured. Consider organizing your tables into areas."]}),a.jsx("button",{onClick:()=>G(o),className:"ml-4 px-3 py-1 bg-yellow-600 text-white text-xs rounded hover:bg-yellow-700",disabled:c,children:"Fix Table Areas Now"})]})}),o.length===0?a.jsxs("div",{className:"text-center py-8",children:[a.jsx(Ls,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No tables found"}),a.jsx("p",{className:"text-gray-600 mb-4",children:"Get started by setting up your restaurant tables"}),a.jsxs("button",{onClick:Ae,className:"btn btn-primary",disabled:c,children:[a.jsx(zr,{className:"w-4 h-4 mr-2"}),"Setup Default Tables & Areas"]})]}):Ie.length===0?a.jsxs("div",{className:"text-center py-8",children:[a.jsx(Ls,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No tables found"}),a.jsx("p",{className:"text-gray-600",children:E==="all"?"Add your first table to get started":"No tables in the selected area"})]}):a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full table-fixed",children:[a.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:a.jsxs("tr",{children:[a.jsx("th",{className:"w-1/5 px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Table"}),a.jsx("th",{className:"w-1/5 px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Area"}),a.jsx("th",{className:"w-1/5 px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Capacity"}),a.jsx("th",{className:"w-1/5 px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),a.jsx("th",{className:"w-1/5 px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Ie.map(Y=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-6 py-4",children:a.jsxs("div",{children:[a.jsxs("div",{className:"font-medium text-gray-900",children:["Table ",Y.number]}),Y.description&&a.jsx("div",{className:"text-sm text-gray-500",children:Y.description})]})}),a.jsx("td",{className:"px-6 py-4 bg-blue-50",children:a.jsx("div",{className:"font-medium text-blue-900",children:Y.area||"No Area"})}),a.jsxs("td",{className:"px-6 py-4 text-sm text-gray-900",children:[Y.capacity," guests"]}),a.jsx("td",{className:"px-6 py-4",children:a.jsxs("div",{className:"flex flex-col space-y-1",children:[a.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${Y.status==="available"?"bg-green-100 text-green-800":Y.status==="occupied"?"bg-red-100 text-red-800":Y.status==="reserved"?"bg-yellow-100 text-yellow-800":Y.status==="cleaning"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:Y.status.replace("_"," ")}),a.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${Y.isActive?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:Y.isActive?"Active":"Inactive"})]})}),a.jsx("td",{className:"px-6 py-4",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("button",{onClick:()=>ee(Y),className:"p-2 text-gray-400 hover:text-blue-600 rounded hover:bg-blue-50",children:a.jsx(ly,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>ue(Y),className:"p-2 text-gray-400 hover:text-red-600 rounded hover:bg-red-50",disabled:Y.status==="occupied",children:a.jsx(Un,{className:"w-4 h-4"})})]})})]},Y.id))})]})})]})]}),h&&a.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:a.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[a.jsx("div",{className:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75",onClick:()=>f(!1)}),a.jsxs("div",{className:"inline-block w-full max-w-md my-8 overflow-hidden text-left align-middle transition-all transform bg-white shadow-xl rounded-2xl",children:[a.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:p?"Edit Area":"Create New Area"})}),a.jsxs("form",{onSubmit:B(L),className:"p-6 space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Area Name *"}),a.jsx("input",{...F("name",{required:"Area name is required"}),type:"text",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Main Dining"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),a.jsx("textarea",{...F("description"),rows:3,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Optional description"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Sort Order"}),a.jsx("input",{...F("sortOrder",{required:!0,min:1}),type:"number",min:"1",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{className:"flex items-center",children:[a.jsx("input",{...F("isActive"),type:"checkbox",className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),a.jsx("label",{className:"ml-2 text-sm text-gray-700",children:"Active"})]}),a.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[a.jsx("button",{type:"button",onClick:()=>f(!1),className:"btn btn-secondary",children:"Cancel"}),a.jsxs("button",{type:"submit",className:"btn btn-primary",children:[p?"Update":"Create"," Area"]})]})]})]})]})}),g&&a.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:a.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[a.jsx("div",{className:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75",onClick:()=>y(!1)}),a.jsxs("div",{className:"inline-block w-full max-w-md my-8 overflow-hidden text-left align-middle transition-all transform bg-white shadow-xl rounded-2xl",children:[a.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:v?"Edit Table":"Create New Table"})}),a.jsxs("form",{onSubmit:te(de),className:"p-6 space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Table Number *"}),a.jsx("input",{...q("number",{required:"Table number is required"}),type:"text",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"1"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Area *"}),a.jsxs("select",{...q("areaId",{required:"Area is required"}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"",children:"Select an area"}),n.filter(Y=>Y.isActive).map(Y=>a.jsx("option",{value:Y.id,children:Y.name},Y.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Capacity *"}),a.jsx("input",{...q("capacity",{required:"Capacity is required",min:1}),type:"number",min:"1",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"4"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),a.jsx("input",{...q("description"),type:"text",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Window table"})]}),a.jsxs("div",{className:"flex items-center",children:[a.jsx("input",{...q("isActive"),type:"checkbox",className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),a.jsx("label",{className:"ml-2 text-sm text-gray-700",children:"Active"})]}),a.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[a.jsx("button",{type:"button",onClick:()=>y(!1),className:"btn btn-secondary",children:"Cancel"}),a.jsxs("button",{type:"submit",className:"btn btn-primary",children:[v?"Update":"Create"," Table"]})]})]})]})]})})]})]}):null}class Ra{static getBaseUrl(){return"https://pos.tenversemedia.tech"}static async createSpinWheel(e,r){try{const s=new Date,n=await Kr(Rt(st,"restaurants",e)),i=n.exists()?n.data().slug:e,o=this.getBaseUrl(),l=o?`${o}/${i}/spin-wheel`:`/${i}/spin-wheel`,c={...r,restaurantId:e,createdAt:s,updatedAt:s,shareableLink:l,totalSpins:0,totalRedemptions:0},d=await Bi(Jt(st,`restaurants/${e}/spinWheels`),{...c,createdAt:wt.fromDate(c.createdAt),updatedAt:wt.fromDate(c.updatedAt)});return{success:!0,data:{...c,id:d.id},message:"Spin wheel created successfully"}}catch(s){return console.error("Error creating spin wheel:",s),{success:!1,error:s instanceof Error?s.message:"Failed to create spin wheel"}}}static async getSpinWheelsForRestaurant(e){try{const r=Zt(Jt(st,`restaurants/${e}/spinWheels`),On("createdAt","desc"));return{success:!0,data:(await ur(r)).docs.map(i=>{var l,c;const o=i.data();return{id:i.id,...o,createdAt:((l=o.createdAt)==null?void 0:l.toDate())||new Date,updatedAt:((c=o.updatedAt)==null?void 0:c.toDate())||new Date}})}}catch(r){return console.error("Error fetching spin wheels:",r),{success:!1,error:r instanceof Error?r.message:"Failed to fetch spin wheels"}}}static async getSpinWheelById(e,r){var s,n;try{const i=Rt(st,`restaurants/${e}/spinWheels`,r),o=await Kr(i);if(!o.exists())return{success:!1,error:"Spin wheel not found"};const l=o.data();return{success:!0,data:{id:o.id,...l,createdAt:((s=l.createdAt)==null?void 0:s.toDate())||new Date,updatedAt:((n=l.updatedAt)==null?void 0:n.toDate())||new Date}}}catch(i){return console.error("Error fetching spin wheel:",i),{success:!1,error:i instanceof Error?i.message:"Failed to fetch spin wheel"}}}static async updateSpinWheel(e,r,s){var n,i;try{const o=Rt(st,`restaurants/${e}/spinWheels`,r),l={...s,updatedAt:wt.fromDate(new Date)};await Xr(o,l);const c=await Kr(o),d=c.data();return{success:!0,data:{id:c.id,...d,createdAt:((n=d==null?void 0:d.createdAt)==null?void 0:n.toDate())||new Date,updatedAt:((i=d==null?void 0:d.updatedAt)==null?void 0:i.toDate())||new Date},message:"Spin wheel updated successfully"}}catch(o){return console.error("Error updating spin wheel:",o),{success:!1,error:o instanceof Error?o.message:"Failed to update spin wheel"}}}static async fixSpinWheelShareableLinks(e){try{const r=await this.getSpinWheelsForRestaurant(e);if(!r.success||!r.data)return{success:!1,error:"Failed to load spin wheels"};const s=await Kr(Rt(st,"restaurants",e)),n=s.exists()?s.data().slug:e,i=this.getBaseUrl(),o=i?`${i}/${n}/spin-wheel`:`/${n}/spin-wheel`;let l=0;for(const c of r.data)if(c.shareableLink!==o&&(c.shareableLink.includes("pos.")||c.shareableLink.includes("admin.")||c.shareableLink.includes("tenversemedia"))){const d=Rt(st,`restaurants/${e}/spinWheels`,c.id);await Xr(d,{shareableLink:o,updatedAt:wt.fromDate(new Date)}),l++,console.log(`Fixed shareable link for wheel: ${c.name}`)}return{success:!0,data:l,message:`Fixed ${l} spin wheel links`}}catch(r){return console.error("Error fixing spin wheel links:",r),{success:!1,error:r instanceof Error?r.message:"Failed to fix spin wheel links"}}}static async deleteSpinWheel(e,r){try{const s=Rt(st,`restaurants/${e}/spinWheels`,r);return await Pl(s),{success:!0,message:"Spin wheel deleted successfully"}}catch(s){return console.error("Error deleting spin wheel:",s),{success:!1,error:s instanceof Error?s.message:"Failed to delete spin wheel"}}}static async recordCustomerSpin(e){var r,s;try{const n=new Date,i=await this.getSpinWheelById(e.restaurantId,e.spinWheelId);let o=0;i.success&&((s=(r=i.data)==null?void 0:r.pointsConfig)!=null&&s.enabled)&&(o=i.data.pointsConfig.pointsPerSpin);const l={...e,pointsEarned:o,spinDate:n},c=await Bi(Jt(st,`restaurants/${e.restaurantId}/customerSpins`),{...l,spinDate:wt.fromDate(l.spinDate),redeemedAt:l.redeemedAt?wt.fromDate(l.redeemedAt):null});await this.incrementSpinWheelStats(e.restaurantId,e.spinWheelId,"spins");const d={...l,id:c.id};if(o>0&&e.customerId)try{const{LoyaltyPointsService:u}=await Pn(async()=>{const{LoyaltyPointsService:h}=await Promise.resolve().then(()=>OQ);return{LoyaltyPointsService:h}},void 0),A=await u.awardSpinPoints(e.restaurantId,e.customerId,c.id,o);A.success||(console.warn("Points could not be awarded:",A.error),console.info("This is normal for gamification users who do not have corresponding customer records in CRM."))}catch(u){console.warn("Error awarding points:",u),console.info("This is normal for gamification users who do not have corresponding customer records in CRM.")}return{success:!0,data:d,message:"Spin recorded successfully"}}catch(n){return console.error("Error recording customer spin:",n),{success:!1,error:n instanceof Error?n.message:"Failed to record spin"}}}static async getCustomerSpinsToday(e,r){try{const s=new Date;s.setHours(0,0,0,0);const n=Zt(Jt(st,`restaurants/${e}/customerSpins`),Yt("customerPhone","==",r));return{success:!0,data:(await ur(n)).docs.map(c=>{var u,A;const d=c.data();return{id:c.id,...d,spinDate:((u=d.spinDate)==null?void 0:u.toDate())||new Date,redeemedAt:(A=d.redeemedAt)==null?void 0:A.toDate()}}).filter(c=>{const d=new Date(c.spinDate);return d.setHours(0,0,0,0),d.getTime()===s.getTime()})}}catch(s){return console.error("Error fetching customer spins today:",s),{success:!1,error:s instanceof Error?s.message:"Failed to fetch customer spins"}}}static async redeemSpin(e,r){try{const s=Rt(st,`restaurants/${e}/customerSpins`,r);await Xr(s,{isRedeemed:!0,redeemedAt:wt.fromDate(new Date)});const n=await Kr(s);if(n.exists()){const i=n.data();await this.incrementSpinWheelStats(e,i.spinWheelId,"redemptions")}return{success:!0,message:"Spin redeemed successfully"}}catch(s){return console.error("Error redeeming spin:",s),{success:!1,error:s instanceof Error?s.message:"Failed to redeem spin"}}}static async claimSpinReward(e,r,s){try{const n=Rt(st,`restaurants/${e}/customerSpins`,r);return await Xr(n,{customerName:s.customerName,customerPhone:s.customerPhone,customerEmail:s.customerEmail||null,couponCode:s.couponCode,isClaimed:!0,claimedAt:wt.fromDate(new Date)}),{success:!0,message:"Reward claimed successfully"}}catch(n){return console.error("Error claiming reward:",n),{success:!1,error:n instanceof Error?n.message:"Failed to claim reward"}}}static async getCustomerSpinsByPhone(e){try{return{success:!1,error:"This method needs restaurant context. Use getCustomerSpinsFromRestaurant instead."}}catch(r){return console.error("Error fetching customer spins:",r),{success:!1,error:r instanceof Error?r.message:"Failed to fetch customer spins"}}}static async getCustomerSpinsFromRestaurant(e,r){try{const s=Zt(Jt(st,`restaurants/${e}/customerSpins`),Yt("customerPhone","==",r));return{success:!0,data:(await ur(s)).docs.map(l=>{var d,u;const c=l.data();return{id:l.id,...c,spinDate:((d=c.spinDate)==null?void 0:d.toDate())||new Date,redeemedAt:(u=c.redeemedAt)==null?void 0:u.toDate()}}).sort((l,c)=>c.spinDate.getTime()-l.spinDate.getTime()).slice(0,50)}}catch(s){return console.error("Error fetching customer spins from restaurant:",s),{success:!1,error:s instanceof Error?s.message:"Failed to fetch customer spins"}}}static async getCustomerSpinsCountToday(e,r,s){try{const n=new Date;n.setHours(0,0,0,0);const i=new Date(n);i.setDate(i.getDate()+1);let o=Zt(Jt(st,`restaurants/${e}/customerSpins`),Yt("customerPhone","==",r));s&&(o=Zt(Jt(st,`restaurants/${e}/customerSpins`),Yt("customerPhone","==",r),Yt("spinWheelId","==",s)));const l=await ur(o);let c=0;return l.docs.forEach(d=>{var h;const A=((h=d.data().spinDate)==null?void 0:h.toDate())||new Date;A.setHours(0,0,0,0),A.getTime()===n.getTime()&&c++}),{success:!0,data:c}}catch(n){return console.error("Error counting customer spins today:",n),{success:!1,error:n instanceof Error?n.message:"Failed to count customer spins"}}}static async getSpinWheelStats(e,r){try{const s=Zt(Jt(st,`restaurants/${e}/customerSpins`),Yt("spinWheelId","==",r)),i=(await ur(s)).docs.map(p=>{var g,y;const m=p.data();return{id:p.id,...m,spinDate:((g=m.spinDate)==null?void 0:g.toDate())||new Date,redeemedAt:(y=m.redeemedAt)==null?void 0:y.toDate()}}),o=i.length,l=i.filter(p=>p.isRedeemed).length,c=o>0?l/o*100:0,d={};i.forEach(p=>{d[p.resultSegmentId]||(d[p.resultSegmentId]={count:0,label:p.resultMessage}),d[p.resultSegmentId].count++});const u=Object.entries(d).map(([p,m])=>({segmentId:p,count:m.count,label:m.label})).sort((p,m)=>m.count-p.count),h=Array.from({length:30},(p,m)=>{const g=new Date;return g.setDate(g.getDate()-m),g.toISOString().split("T")[0]}).reverse().map(p=>{const m=i.filter(g=>g.spinDate.toISOString().split("T")[0]===p).length;return{date:p,count:m}});return{success:!0,data:{totalSpins:o,totalRedemptions:l,redemptionRate:c,popularSegments:u,dailySpins:h,customerEngagement:o>0?new Set(i.map(p=>p.customerPhone||p.customerEmail)).size/o*100:0}}}catch(s){return console.error("Error fetching spin wheel stats:",s),{success:!1,error:s instanceof Error?s.message:"Failed to fetch stats"}}}static async incrementSpinWheelStats(e,r,s){try{const n=Rt(st,`restaurants/${e}/spinWheels`,r),i=s==="spins"?"totalSpins":"totalRedemptions",o=await Kr(n);if(o.exists()){const l=o.data()[i]||0;await Xr(n,{[i]:l+1,updatedAt:wt.fromDate(new Date)})}}catch(n){console.error(`Error incrementing ${s}:`,n)}}static getDefaultSegments(){return[{id:"1",label:"10% Off",value:"10% discount on your next order",color:"#FF6B6B",probability:20,rewardType:"discount_percentage",rewardValue:10},{id:"2",label:"Free Drink",value:"Free beverage with any meal",color:"#4ECDC4",probability:15,rewardType:"custom",customMessage:"Free drink with any meal purchase"},{id:"3",label:"5% Off",value:"5% discount on your order",color:"#45B7D1",probability:25,rewardType:"discount_percentage",rewardValue:5},{id:"4",label:"$5 Off",value:"$5 discount on orders over $25",color:"#96CEB4",probability:15,rewardType:"discount_fixed",rewardValue:5},{id:"5",label:"Try Again",value:"Better luck next time!",color:"#FFEAA7",probability:10,rewardType:"custom",customMessage:"Better luck next time! Come back tomorrow.",noCoupon:!0},{id:"6",label:"15% Off",value:"15% discount on your next order",color:"#DDA0DD",probability:8,rewardType:"discount_percentage",rewardValue:15},{id:"7",label:"Free Appetizer",value:"Free appetizer with main course",color:"#98D8C8",probability:5,rewardType:"custom",customMessage:"Free appetizer with any main course order"},{id:"8",label:"20% Off",value:"20% discount - Lucky you!",color:"#F7DC6F",probability:2,rewardType:"discount_percentage",rewardValue:20}]}}class Uc{static async integrateSpinReward(e,r,s,n,i){var o,l,c,d;try{console.log(" Starting gamification integration...",{restaurantId:e,userId:r.id,userName:r.name,userPhone:r.phone,couponCode:n,spinResult:s.label});const u=await this.addUserToCRM(e,r);if(!u.success)return console.error(" CRM integration failed:",u.error),{success:!1,error:`Failed to add user to CRM: ${u.error}`};if(console.log(" User added to CRM successfully:",{customerId:(o=u.customer)==null?void 0:o.id,customerName:(l=u.customer)==null?void 0:l.name,customerPhone:(c=u.customer)==null?void 0:c.phone,preferences:(d=u.customer)==null?void 0:d.preferences}),s.noCoupon)return console.log(" No coupon segment detected - skipping coupon creation"),console.log(" Integration completed successfully (no coupon created)!"),{success:!0,message:"Try again segment processed successfully - no coupon created"};const A=await this.createGamificationCoupon(e,r,s,n,i);return A.success?(console.log(" Coupon created successfully:",{couponCode:n,type:s.rewardType,value:s.value}),console.log(" Integration completed successfully!"),console.log(" Next steps: Check CRM customers tab and coupon dashboard"),{success:!0,message:"Reward integrated successfully into CRM and coupon system"}):(console.error(" Coupon creation failed:",A.error),{success:!1,error:A.error||"Failed to create coupon"})}catch(u){return console.error("Error integrating spin reward:",u),{success:!1,error:"Failed to integrate reward"}}}static async addUserToCRM(e,r){var s,n;try{console.log(" Checking if customer exists in CRM...",{restaurantId:e,userPhone:r.phone,userName:r.name});const i=await wn.searchCustomers(e,r.phone);console.log(" Customer search result:",{success:i.success,found:((s=i.data)==null?void 0:s.length)||0,error:i.error});let o;if(i.success&&i.data&&i.data.length>0){const l=i.data[0],c={name:r.name,email:r.email||l.email,lastVisit:new Date,preferences:[...l.preferences||[],"gamification_user"]},d=await wn.updateCustomer(l.id,e,c);if(d.success&&d.data)o=d.data;else return{success:!1,error:"Failed to update existing customer"}}else{console.log(" Creating new customer in CRM...");const l={name:r.name,email:r.email||"",phone:r.phone,address:"",preferences:["gamification_user"],totalSpent:0,visitCount:1,lastVisit:new Date};console.log(" New customer data:",l);const c=await wn.createCustomer(e,l);if(console.log(" Customer creation result:",{success:c.success,customerId:(n=c.data)==null?void 0:n.id,error:c.error}),c.success&&c.data)o=c.data;else return{success:!1,error:"Failed to create customer"}}return{success:!0,customer:o}}catch(i){return console.error("Error adding user to CRM:",i),{success:!1,error:"Failed to add user to CRM"}}}static async createGamificationCoupon(e,r,s,n,i){try{const o=this.createCouponFromSpinResult(s,n,r,i),l=await Oo.createCoupon(e,o);return{success:l.success,error:l.error}}catch(o){return console.error("Error creating gamification coupon:",o),{success:!1,error:"Failed to create coupon"}}}static createCouponFromSpinResult(e,r,s,n){const i=new Date,o=new Date;o.setDate(o.getDate()+30);const l={name:`${e.label} - Spin Wheel Reward`,description:`Reward from spin wheel game: ${e.value}. Winner: ${s.name} (${s.phone})`,code:r.toUpperCase(),status:"active",validity:{startDate:i,endDate:o,usageLimit:1,perCustomerLimit:1,validDays:["monday","tuesday","wednesday","thursday","friday","saturday","sunday"]},targeting:{customerSegments:["all"],minOrderValue:0,applicableCategories:[],excludedCategories:[],paymentMethodRestriction:"all"},metadata:{source:"gamification_spin_wheel",spinRecordId:n.id,userId:s.id,userName:s.name,userPhone:s.phone,spinDate:n.spinDate,segmentId:e.id,segmentColor:e.color}};switch(e.rewardType){case"discount_percentage":const c=e.value.match(/(\d+)%/),d=c?parseInt(c[1]):10;return{...l,type:"percentage_discount",config:{percentage:d,maxDiscountAmount:1e3}};case"free_item":return{...l,type:"free_item",config:{freeItemName:e.label,freeItemValue:e.value}};case"points":const u=e.value.match(/(\d+)/),A=u?parseInt(u[1]):50;return{...l,type:"fixed_amount",config:{discountAmount:Math.min(A,500)}};case"custom":default:return{...l,type:"percentage_discount",config:{percentage:10,maxDiscountAmount:500}}}}static async searchGamificationCoupons(e,r){var s;try{console.log(" Searching for gamification coupons...",{restaurantId:e,searchTerm:r});const n=await Oo.getCouponsForRestaurant(e);if(console.log(" All coupons fetch result:",{success:n.success,totalCoupons:((s=n.data)==null?void 0:s.length)||0,error:n.error}),!n.success||!n.data)return{success:!1,error:"Failed to fetch coupons"};console.log(" All coupons in system:",n.data.map(o=>{var l;return{id:o.id,code:o.code,name:o.name,source:(l=o.metadata)==null?void 0:l.source,hasMetadata:!!o.metadata,metadataKeys:o.metadata?Object.keys(o.metadata):[]}}));const i=n.data.filter(o=>{var u,A,h,f,p,m,g,y,v;const l=((u=o.metadata)==null?void 0:u.source)==="gamification_spin_wheel";if(console.log(` Checking coupon ${o.code}:`,{hasMetadata:!!o.metadata,source:(A=o.metadata)==null?void 0:A.source,isGamificationCoupon:l}),!l)return!1;if(!r.trim())return!0;const c=r.toLowerCase(),d=o.code.toLowerCase().includes(c)||((f=(h=o.metadata)==null?void 0:h.userName)==null?void 0:f.toLowerCase().includes(c))||((m=(p=o.metadata)==null?void 0:p.userPhone)==null?void 0:m.includes(r))||o.name.toLowerCase().includes(c);return console.log(` Search match for ${o.code}:`,{searchTerm:c,code:o.code.toLowerCase(),userName:(y=(g=o.metadata)==null?void 0:g.userName)==null?void 0:y.toLowerCase(),userPhone:(v=o.metadata)==null?void 0:v.userPhone,name:o.name.toLowerCase(),matches:d}),d});return console.log(" Gamification coupons found:",{total:i.length,coupons:i.map(o=>{var l,c;return{id:o.id,code:o.code,name:o.name,userName:(l=o.metadata)==null?void 0:l.userName,userPhone:(c=o.metadata)==null?void 0:c.userPhone}})}),{success:!0,data:i}}catch(n){return console.error("Error searching gamification coupons:",n),{success:!1,error:"Failed to search coupons"}}}static async redeemGamificationCoupon(e,r,s){var n;try{const i=await Oo.getCouponsForRestaurant(e);if(!i.success||!i.data)return{success:!1,error:"Failed to fetch coupons"};const o=i.data.find(c=>{var d;return c.code.toUpperCase()===r.toUpperCase()&&((d=c.metadata)==null?void 0:d.source)==="gamification_spin_wheel"});if(!o)return{success:!1,error:"Coupon not found"};if(o.usageCount>=1)return{success:!1,error:"Coupon already redeemed"};const l=await Oo.markCouponAsUsed(o.id,e);return l.success?(s&&await Oo.recordCouponUsage(o.id,e,s,this.calculateDiscountAmount(o),0,0,(n=o.metadata)==null?void 0:n.userId),{success:!0,message:`Coupon redeemed successfully! ${o.name}`}):l}catch(i){return console.error("Error redeeming gamification coupon:",i),{success:!1,error:"Failed to redeem coupon"}}}static calculateDiscountAmount(e){var r,s;switch(e.type){case"percentage_discount":return((r=e.config)==null?void 0:r.percentage)||0;case"fixed_amount":return((s=e.config)==null?void 0:s.discountAmount)||0;default:return 0}}static async getGamificationCouponStats(e){try{const r=await Oo.getCouponsForRestaurant(e);if(!r.success||!r.data)return{success:!1,error:"Failed to fetch coupons"};const s=r.data.filter(i=>{var o;return((o=i.metadata)==null?void 0:o.source)==="gamification_spin_wheel"});return{success:!0,data:{totalCoupons:s.length,redeemedCoupons:s.filter(i=>i.usageCount>0).length,activeCoupons:s.filter(i=>i.status==="active"&&i.usageCount===0).length,redemptionRate:s.length>0?s.filter(i=>i.usageCount>0).length/s.length*100:0,totalDiscountGiven:s.filter(i=>i.usageCount>0).reduce((i,o)=>i+this.calculateDiscountAmount(o),0)}}}catch(r){return console.error("Error fetching gamification coupon stats:",r),{success:!1,error:"Failed to fetch stats"}}}static async getCustomerLoyaltyInfo(e,r){try{const s=await wn.searchCustomers(e,r);if(!s.success||!s.data||s.data.length===0)return{success:!1,error:"Customer not found in CRM"};const n=s.data[0],{LoyaltyPointsService:i}=await Pn(async()=>{const{LoyaltyPointsService:l}=await Promise.resolve().then(()=>OQ);return{LoyaltyPointsService:l}},void 0),o=await i.getCustomerLoyaltyInfo(e,n.id);return o.success?{success:!0,data:{loyaltyInfo:o.data,customer:n}}:{success:!1,error:o.error||"Failed to get loyalty info"}}catch(s){return console.error("Error getting customer loyalty info:",s),{success:!1,error:"Failed to get loyalty information"}}}static async getCustomerGamificationHistory(e,r){var s;try{console.log(" Fetching gamification history for customer:",{restaurantId:e,customerPhone:r});const n=await Ra.getCustomerSpinsFromRestaurant(e,r);console.log(" Customer spins result:",{success:n.success,spinsCount:((s=n.data)==null?void 0:s.length)||0,error:n.error});const i=n.success&&n.data?n.data:[],o=await Oo.getCouponsForRestaurant(e);let l=[];o.success&&o.data&&(l=o.data.filter(h=>{var f,p;return((f=h.metadata)==null?void 0:f.source)==="gamification_spin_wheel"&&((p=h.metadata)==null?void 0:p.userPhone)===r})),console.log(" Customer coupons found:",{total:l.length,redeemed:l.filter(h=>h.usageCount>0).length});const c=l.reduce((h,f)=>h+this.calculateDiscountAmount(f),0),d=l.filter(h=>h.usageCount>0).reduce((h,f)=>h+this.calculateDiscountAmount(f),0),u=i.map(h=>new Date(h.spinDate)).sort((h,f)=>h.getTime()-f.getTime()),A={totalSpins:i.length,totalCoupons:l.length,redeemedCoupons:l.filter(h=>h.usageCount>0).length,totalDiscountEarned:c,totalDiscountUsed:d,firstSpinDate:u.length>0?u[0]:void 0,lastSpinDate:u.length>0?u[u.length-1]:void 0};return console.log(" Gamification stats for customer:",A),{success:!0,data:{spins:i.map(h=>({...h,spinDate:new Date(h.spinDate),restaurantName:"Current Restaurant"})),coupons:l.map(h=>({...h,createdAt:new Date(h.createdAt),validity:{...h.validity,startDate:new Date(h.validity.startDate),endDate:new Date(h.validity.endDate)}})),stats:A}}}catch(n){return console.error("Error fetching customer gamification history:",n),{success:!1,error:"Failed to fetch gamification history"}}}}function Mpe(){var Ce,oe,He;const{restaurant:t}=js(),[e,r]=R.useState([]),[s,n]=R.useState([]),[i,o]=R.useState(null),[l,c]=R.useState([]),[d,u]=R.useState(null),[A,h]=R.useState(null),[f,p]=R.useState([]),[m,g]=R.useState(!1),[y,v]=R.useState(!1),[x,E]=R.useState(null),[T,j]=R.useState(""),[C,w]=R.useState(!0),[S,F]=R.useState(!1),[B,k]=R.useState(!1),[D,q]=R.useState(!1),[te,W]=R.useState(!1),[Q,re]=R.useState(!1),[G,Ae]=R.useState("lastVisit"),{register:he,handleSubmit:I,reset:U,setValue:V}=nn();R.useEffect(()=>{t&&L()},[t]),R.useEffect(()=>{K()},[e,T,G]);const L=async()=>{if(t)try{w(!0);const ie=await wn.getCustomersForRestaurant(t.id);if(ie.success&&ie.data){const le=ie.data.sort((ae,ve)=>{const we=ae.createdAt?new Date(ae.createdAt).getTime():0;return(ve.createdAt?new Date(ve.createdAt).getTime():0)-we});r(le)}}catch{Z.error("Failed to load customers")}finally{w(!1)}},K=()=>{let ie=[...e];if(T){const le=T.toLowerCase();ie=ie.filter(ae=>{var ve,we,De;return((ve=ae.name)==null?void 0:ve.toLowerCase().includes(le))||((we=ae.email)==null?void 0:we.toLowerCase().includes(le))||((De=ae.phone)==null?void 0:De.includes(T))})}ie.sort((le,ae)=>{switch(G){case"name":return(le.name||"").localeCompare(ae.name||"");case"visits":return ae.visitCount-le.visitCount;case"spent":return ae.totalSpent-le.totalSpent;case"lastVisit":const ve=le.lastVisit?new Date(le.lastVisit).getTime():0;return(ae.lastVisit?new Date(ae.lastVisit).getTime():0)-ve;default:return 0}}),n(ie)},fe=async ie=>{if(t)try{W(!0);const le={...ie,preferences:ie.preferences?ie.preferences.split(",").map(ve=>ve.trim()):[]},ae=await wn.createCustomer(t.id,le);ae.success?(Z.success("Customer created successfully"),F(!1),U(),await L()):Z.error(ae.error||"Failed to create customer")}catch{Z.error("Failed to create customer")}finally{W(!1)}},ee=ie=>{var le;o(ie),V("name",ie.name||""),V("email",ie.email||""),V("phone",ie.phone||""),V("address",ie.address||""),V("preferences",((le=ie.preferences)==null?void 0:le.join(", "))||""),k(!0)},de=async ie=>{if(!(!t||!i))try{re(!0);const le={...ie,preferences:ie.preferences?ie.preferences.split(",").map(ve=>ve.trim()):[]},ae=await wn.updateCustomer(i.id,t.id,le);ae.success?(Z.success("Customer updated successfully"),k(!1),o(null),U(),await L()):Z.error(ae.error||"Failed to update customer")}catch{Z.error("Failed to update customer")}finally{re(!1)}},ue=async ie=>{if(!(!t||!confirm(`Are you sure you want to delete customer "${ie.name||ie.phone}"?`)))try{const le=await wn.deleteCustomer(ie.id,t.id);le.success?(Z.success("Customer deleted successfully"),await L()):Z.error(le.error||"Failed to delete customer")}catch{Z.error("Failed to delete customer")}},Ie=async ie=>{if(t)try{o(ie),q(!0),console.log(" Loading orders for customer:",ie.name,ie.phone);let le=[];if(ie.orderHistory&&ie.orderHistory.length>0){const ae=await Ur.getOrdersByIds(ie.orderHistory,t.id);ae.success&&ae.data&&(le=ae.data,console.log(" Loaded orders from orderHistory:",le.length))}if(le.length===0&&ie.phone){console.log(" Searching orders by phone number:",ie.phone);const ae=await Ur.getOrdersForRestaurant(t.id,1e3);ae.success&&ae.data&&(le=ae.data.filter(we=>{var Fe,Re,Be,X,_e,ke;const De=((Fe=we.notes)==null?void 0:Fe.includes(ie.phone||""))||ie.name&&((Re=we.notes)==null?void 0:Re.includes(ie.name))||((Be=we.notes)==null?void 0:Be.includes("Customer Portal")),Ve=we.customerId===ie.id,me=(we.customerPhone?(X=we.customerPhone)==null?void 0:X.includes(ie.phone||""):!1)||((ke=we.customerName)==null?void 0:ke.toLowerCase().includes(((_e=ie.name)==null?void 0:_e.toLowerCase())||""));return De||Ve||me}).sort((we,De)=>new Date(De.createdAt).getTime()-new Date(we.createdAt).getTime()),console.log(" Found orders by search:",le.length))}if(le.length===0&&(ie.name||ie.email)){console.log(" Searching orders by name/email");const ae=await Ur.getOrdersForRestaurant(t.id,500);ae.success&&ae.data&&(le=ae.data.filter(we=>[ie.name,ie.email,ie.phone].filter(Boolean).some(Ve=>{var me,Fe,Re,Be;return((me=we.notes)==null?void 0:me.toLowerCase().includes((Ve==null?void 0:Ve.toLowerCase())||""))||((Fe=we.customerName)==null?void 0:Fe.toLowerCase().includes((Ve==null?void 0:Ve.toLowerCase())||""))||(we.customerPhone?(Re=we.customerPhone)==null?void 0:Re.includes(Ve||""):!1)||(we.customerEmail?(Be=we.customerEmail)==null?void 0:Be.toLowerCase().includes((Ve==null?void 0:Ve.toLowerCase())||""):!1)})).sort((we,De)=>new Date(De.createdAt).getTime()-new Date(we.createdAt).getTime()),console.log(" Found orders by name/email search:",le.length))}if(c(le),console.log(" Final order count for customer:",le.length),ie.phone||ie.name){v(!0);try{const ae=await Mf.getCreditTransactions(t.id);if(ae.success&&ae.data){const ve=ae.data.filter(we=>{var De,Ve;return ie.phone&&((De=we.customerPhone)==null?void 0:De.includes(ie.phone))||ie.name&&((Ve=we.customerName)==null?void 0:Ve.toLowerCase().includes(ie.name.toLowerCase()))||le.some(me=>me.id===we.orderId)});p(ve),console.log(" Found credit transactions for customer:",ve.length)}else p([])}catch(ae){console.error("Error loading credit history:",ae),p([])}finally{v(!1)}}else p([]);if(ie.phone){g(!0);try{const ae=await Uc.getCustomerGamificationHistory(t.id,ie.phone);ae.success&&ae.data?u(ae.data):(console.log("No gamification history found for customer:",ae.error),u(null));const ve=await Uc.getCustomerLoyaltyInfo(t.id,ie.phone);ve.success&&ve.data?h(ve.data):(console.log("No loyalty info found for customer:",ve.error),h(null))}catch(ae){console.error("Error loading gamification data:",ae),u(null),h(null)}finally{g(!1)}}else u(null),h(null)}catch(le){console.error("Error loading customer data:",le),Z.error("Failed to load customer data"),c([]),u(null),h(null),p([])}},Y=()=>{const ie=[["Name","Email","Phone","Address","Total Spent","Visit Count","Last Visit"].join(","),...s.map(we=>[we.name||"",we.email||"",we.phone||"",we.address||"",we.totalSpent.toString(),we.visitCount.toString(),we.lastVisit?new Date(we.lastVisit).toLocaleDateString():""].join(","))].join(`
`),le=new Blob([ie],{type:"text/csv"}),ae=window.URL.createObjectURL(le),ve=document.createElement("a");ve.href=ae,ve.download=`customers-${new Date().toISOString().split("T")[0]}.csv`,ve.click(),window.URL.revokeObjectURL(ae)},H=ie=>{if(ie.type==="takeaway"||ie.tableId==="takeaway-order")return{type:"Takeaway",icon:"",color:"bg-orange-100 text-orange-800",description:"Takeaway Order"};if(ie.tableId==="customer-portal"||ie.notes&&ie.notes.includes("Customer Portal Order"))return{type:"Menu Portal",icon:"",color:"bg-blue-100 text-blue-800",description:"Online Menu Portal Order"};if(ie.notes&&ie.notes.includes("Table:")&&ie.notes.includes("Customer Portal")){const le=ie.notes.match(/Table: ([^|]+)/);return{type:"Table Portal",icon:"",color:"bg-purple-100 text-purple-800",description:`Table-specific portal order (${le?le[1].trim():"Unknown Table"})`}}return{type:"Dine In",icon:"",color:"bg-green-100 text-green-800",description:"Restaurant Dine-in Order"}},je=()=>{if(f.length===0)return{totalCredits:0,pendingAmount:0,paidAmount:0,totalTransactions:0};const ie=f.reduce((ve,we)=>ve+(we.totalAmount-we.amountReceived),0),le=f.reduce((ve,we)=>{const De=we.amountReceived+(we.paymentHistory||[]).reduce((me,Fe)=>me+Fe.amount,0),Ve=we.totalAmount-De;return ve+(Ve>0?Ve:0)},0),ae=f.reduce((ve,we)=>ve+(we.paymentHistory||[]).reduce((De,Ve)=>De+Ve.amount,0),0);return{totalCredits:ie,pendingAmount:le,paidAmount:ae,totalTransactions:f.length}};return t?a.jsxs("div",{className:"min-h-screen",style:{background:"var(--color-background)"},children:[a.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[a.jsx("div",{className:"mb-8",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Customer Management"}),a.jsx("p",{className:"text-gray-600 mt-1",children:"Manage your customer database and relationships"})]}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsxs("button",{onClick:Y,className:"btn btn-secondary",children:[a.jsx(Yn,{className:"w-4 h-4 mr-2"}),"Export"]}),a.jsxs("button",{onClick:()=>F(!0),className:"btn btn-theme-primary",children:[a.jsx(L0,{className:"w-4 h-4 mr-2"}),"Add Customer"]})]})]})}),a.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 mb-6",children:a.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[a.jsxs("div",{className:"flex-1 relative",children:[a.jsx(sn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),a.jsx("input",{type:"text",placeholder:"Search customers by name, email, or phone...",value:T,onChange:ie=>j(ie.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx(nu,{className:"w-4 h-4 text-gray-600"}),a.jsxs("select",{value:G,onChange:ie=>Ae(ie.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"lastVisit",children:"Last Visit"}),a.jsx("option",{value:"name",children:"Name"}),a.jsx("option",{value:"visits",children:"Most Visits"}),a.jsx("option",{value:"spent",children:"Highest Spent"})]})]})]})}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-6",children:[a.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:a.jsx(Ls,{className:"w-6 h-6 text-blue-600"})}),a.jsxs("div",{className:"ml-4",children:[a.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Customers"}),a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:e.length})]})]})}),a.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:a.jsx(hn,{className:"w-6 h-6 text-green-600"})}),a.jsxs("div",{className:"ml-4",children:[a.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Revenue"}),a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:Ue(e.reduce((ie,le)=>ie+le.totalSpent,0))})]})]})}),a.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:a.jsx(Kd,{className:"w-6 h-6 text-purple-600"})}),a.jsxs("div",{className:"ml-4",children:[a.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Avg Order Value"}),a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:Ue(e.length>0?e.reduce((ie,le)=>ie+(le.visitCount>0?le.totalSpent/le.visitCount:0),0)/e.length:0)})]})]})}),a.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"p-2 bg-orange-100 rounded-lg",children:a.jsx(Jc,{className:"w-6 h-6 text-orange-600"})}),a.jsxs("div",{className:"ml-4",children:[a.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Repeat Customers"}),a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:e.filter(ie=>ie.visitCount>1).length})]})]})})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[a.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:a.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:["Customers (",s.length,")"]})}),C?a.jsxs("div",{className:"text-center py-12",children:[a.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Loading customers..."})]}):s.length===0?a.jsxs("div",{className:"text-center py-12",children:[a.jsx(Ls,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No customers found"}),a.jsx("p",{className:"text-gray-600 mb-4",children:T?"Try adjusting your search terms":"Get started by adding your first customer"}),!T&&a.jsxs("button",{onClick:()=>F(!0),className:"btn btn-theme-primary",children:[a.jsx(L0,{className:"w-4 h-4 mr-2"}),"Add First Customer"]})]}):a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Customer"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contact"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Visits"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total Spent"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Last Visit"}),a.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:s.map(ie=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-medium text-gray-900",children:ie.name||"N/A"}),ie.address&&a.jsxs("div",{className:"text-sm text-gray-500 flex items-center",children:[a.jsx(ta,{className:"w-3 h-3 mr-1"}),ie.address]})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("div",{className:"space-y-1",children:[ie.phone&&a.jsxs("div",{className:"text-sm text-gray-900 flex items-center",children:[a.jsx(UA,{className:"w-3 h-3 mr-1"}),ie.phone]}),ie.email&&a.jsxs("div",{className:"text-sm text-gray-500 flex items-center",children:[a.jsx(hN,{className:"w-3 h-3 mr-1"}),ie.email]})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsx("div",{className:"text-sm font-medium text-gray-900",children:ie.visitCount})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsx("div",{className:"text-sm font-medium text-gray-900",children:Ue(ie.totalSpent)})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsx("div",{className:"text-sm text-gray-500",children:ie.lastVisit?new Date(ie.lastVisit).toLocaleDateString():"Never"})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:a.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[a.jsx("button",{onClick:()=>Ie(ie),className:"p-2 text-gray-400 hover:text-blue-600 rounded hover:bg-blue-50",title:"View Orders",children:a.jsx(Xs,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>ee(ie),className:"p-2 text-gray-400 hover:text-blue-600 rounded hover:bg-blue-50",title:"Edit Customer",children:a.jsx(ly,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>ue(ie),className:"p-2 text-gray-400 hover:text-red-600 rounded hover:bg-red-50",title:"Delete Customer",children:a.jsx(Un,{className:"w-4 h-4"})})]})})]},ie.id))})]})})]})]}),S&&a.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:a.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[a.jsx("div",{className:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75",onClick:()=>F(!1)}),a.jsxs("div",{className:"inline-block w-full max-w-md my-8 overflow-hidden text-left align-middle transition-all transform bg-white shadow-xl rounded-2xl",children:[a.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Add New Customer"}),a.jsx("button",{onClick:()=>F(!1),className:"text-gray-400 hover:text-gray-600",children:a.jsx(qr,{className:"w-5 h-5"})})]})}),a.jsxs("form",{onSubmit:I(fe),className:"p-6 space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Name *"}),a.jsx("input",{...he("name",{required:"Name is required"}),type:"text",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Customer name"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone *"}),a.jsx("input",{...he("phone",{required:"Phone is required"}),type:"tel",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Phone number"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),a.jsx("input",{...he("email"),type:"email",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Email address"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Address"}),a.jsx("textarea",{...he("address"),rows:2,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Customer address"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Preferences"}),a.jsx("input",{...he("preferences"),type:"text",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Dietary preferences, separated by commas"})]}),a.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[a.jsx("button",{type:"button",onClick:()=>F(!1),className:"btn btn-secondary",children:"Cancel"}),a.jsx("button",{type:"submit",disabled:te,className:"btn btn-theme-primary",children:te?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Creating..."]}):a.jsxs(a.Fragment,{children:[a.jsx(L0,{className:"w-4 h-4 mr-2"}),"Create Customer"]})})]})]})]})]})}),B&&i&&a.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:a.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[a.jsx("div",{className:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75",onClick:()=>k(!1)}),a.jsxs("div",{className:"inline-block w-full max-w-md my-8 overflow-hidden text-left align-middle transition-all transform bg-white shadow-xl rounded-2xl",children:[a.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Edit Customer"}),a.jsx("button",{onClick:()=>k(!1),className:"text-gray-400 hover:text-gray-600",children:a.jsx(qr,{className:"w-5 h-5"})})]})}),a.jsxs("form",{onSubmit:I(de),className:"p-6 space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Name *"}),a.jsx("input",{...he("name",{required:"Name is required"}),type:"text",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Customer name"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone *"}),a.jsx("input",{...he("phone",{required:"Phone is required"}),type:"tel",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Phone number"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),a.jsx("input",{...he("email"),type:"email",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Email address"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Address"}),a.jsx("textarea",{...he("address"),rows:2,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Customer address"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Preferences"}),a.jsx("input",{...he("preferences"),type:"text",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Dietary preferences, separated by commas"})]}),a.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[a.jsx("button",{type:"button",onClick:()=>k(!1),className:"btn btn-secondary",children:"Cancel"}),a.jsx("button",{type:"submit",disabled:Q,className:"btn btn-theme-primary",children:Q?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Updating..."]}):a.jsxs(a.Fragment,{children:[a.jsx(ly,{className:"w-4 h-4 mr-2"}),"Update Customer"]})})]})]})]})]})}),D&&i&&a.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:a.jsxs("div",{className:"flex items-center justify-center min-h-screen px-2 sm:px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[a.jsx("div",{className:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75",onClick:()=>{q(!1),u(null),h(null),o(null)}}),a.jsxs("div",{className:"inline-block w-full max-w-4xl my-4 sm:my-8 overflow-hidden text-left align-middle transition-all transform bg-white shadow-xl rounded-2xl max-h-[95vh] overflow-y-auto",children:[a.jsx("div",{className:"px-3 sm:px-6 py-3 sm:py-4 border-b border-gray-200",children:a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"text-base sm:text-lg font-semibold text-gray-900",children:[i.name||"Customer"," - Complete Profile"]}),a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:space-x-4 space-y-1 sm:space-y-0 text-xs sm:text-sm text-gray-600 mt-1",children:[a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx(Ls,{className:"w-3 h-3 sm:w-4 sm:h-4"}),a.jsxs("span",{children:[i.visitCount," visits"]})]}),a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx(hn,{className:"w-3 h-3 sm:w-4 sm:h-4"}),a.jsxs("span",{children:[Ue(i.totalSpent)," spent"]})]}),l.length>0&&a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx(Is,{className:"w-3 h-3 sm:w-4 sm:h-4"}),a.jsxs("span",{children:[Ue(l.reduce((ie,le)=>ie+le.total,0)/l.length)," avg order"]})]}),d&&a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx(Cn,{className:"w-3 h-3 sm:w-4 sm:h-4"}),a.jsxs("span",{children:[d.stats.totalSpins," spins"]})]})]})]}),a.jsx("button",{onClick:()=>{q(!1),u(null),h(null),o(null)},className:"text-gray-400 hover:text-gray-600 self-start sm:self-center",children:a.jsx(qr,{className:"w-4 h-4 sm:w-5 sm:h-5"})})]})}),a.jsxs("div",{className:"p-3 sm:p-6",children:[A&&a.jsxs("div",{className:"mb-6 sm:mb-8",children:[a.jsxs("h4",{className:"text-base sm:text-lg font-medium text-gray-900 mb-3 sm:mb-4 flex items-center",children:[a.jsx(pA,{className:"w-4 h-4 sm:w-5 sm:h-5 mr-2 text-purple-600"}),"Loyalty Status & Points"]}),a.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-blue-50 p-3 sm:p-6 rounded-lg border border-purple-200",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-4 sm:mb-6 gap-3",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"text-2xl sm:text-3xl",children:((Ce=A.loyaltyInfo.currentThreshold)==null?void 0:Ce.badgeIcon)||""}),a.jsxs("div",{children:[a.jsx("h5",{className:"text-lg sm:text-xl font-bold text-gray-900",children:((oe=A.loyaltyInfo.currentThreshold)==null?void 0:oe.name)||"Bronze Member"}),a.jsxs("p",{className:"text-gray-600 text-sm sm:text-base",children:[A.loyaltyInfo.currentPoints," loyalty points"]})]})]}),a.jsxs("div",{className:"text-left sm:text-right",children:[a.jsx("div",{className:"text-xs sm:text-sm text-gray-600",children:"Member since"}),a.jsx("div",{className:"font-medium text-gray-900 text-sm sm:text-base",children:new Date(A.loyaltyInfo.memberSince).toLocaleDateString()})]})]}),A.loyaltyInfo.nextThreshold&&a.jsxs("div",{className:"mb-4 sm:mb-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("span",{className:"text-xs sm:text-sm font-medium text-gray-700",children:["Progress to ",A.loyaltyInfo.nextThreshold.name]}),a.jsxs("span",{className:"text-xs sm:text-sm font-medium text-gray-700",children:[A.loyaltyInfo.pointsToNext," points to go"]})]}),a.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 sm:h-3",children:a.jsx("div",{className:"bg-gradient-to-r from-purple-500 to-blue-500 h-2 sm:h-3 rounded-full transition-all duration-300",style:{width:`${A.loyaltyInfo.progressToNext}%`}})}),a.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:[A.loyaltyInfo.progressToNext.toFixed(1),"% complete"]})]}),((He=A.loyaltyInfo.currentThreshold)==null?void 0:He.benefits)&&a.jsxs("div",{className:"mb-4",children:[a.jsx("h6",{className:"text-xs sm:text-sm font-medium text-gray-700 mb-2",children:"Current Level Benefits:"}),a.jsx("div",{className:"grid grid-cols-1 gap-2",children:A.loyaltyInfo.currentThreshold.benefits.map((ie,le)=>a.jsxs("div",{className:"flex items-center text-xs sm:text-sm text-gray-600",children:[a.jsx(Nr,{className:"w-3 h-3 sm:w-4 sm:h-4 text-green-500 mr-2 flex-shrink-0"}),ie]},le))})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-2 sm:gap-4 mt-4",children:[a.jsxs("div",{className:"text-center p-2 sm:p-3 bg-white rounded-lg",children:[a.jsx("div",{className:"text-lg sm:text-2xl font-bold text-purple-600",children:A.loyaltyInfo.totalSpins||0}),a.jsx("div",{className:"text-xs text-gray-600",children:"Gamification Spins"})]}),a.jsxs("div",{className:"text-center p-2 sm:p-3 bg-white rounded-lg",children:[a.jsx("div",{className:"text-lg sm:text-2xl font-bold text-blue-600",children:A.loyaltyInfo.totalPointsEarned}),a.jsx("div",{className:"text-xs text-gray-600",children:"Points Earned"})]}),a.jsxs("div",{className:"text-center p-2 sm:p-3 bg-white rounded-lg",children:[a.jsx("div",{className:"text-lg sm:text-2xl font-bold text-green-600",children:A.loyaltyInfo.currentPoints}),a.jsx("div",{className:"text-xs text-gray-600",children:"Current Balance"})]})]}),A.loyaltyInfo.nextThreshold&&a.jsx("div",{className:"mt-4 p-2 sm:p-3 bg-white rounded-lg border border-dashed border-purple-300",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("span",{className:"text-base sm:text-lg",children:A.loyaltyInfo.nextThreshold.badgeIcon}),a.jsxs("div",{children:[a.jsx("div",{className:"font-medium text-gray-900 text-sm sm:text-base",children:A.loyaltyInfo.nextThreshold.name}),a.jsxs("div",{className:"text-xs text-gray-600",children:["Unlock at ",A.loyaltyInfo.nextThreshold.pointsRequired," points"]})]})]}),a.jsx("div",{className:"text-xs text-gray-500",children:"Next Level"})]})})]})]}),a.jsxs("div",{className:"mb-6 sm:mb-8",children:[a.jsxs("h4",{className:"text-base sm:text-lg font-medium text-gray-900 mb-3 sm:mb-4 flex items-center",children:[a.jsx(Cn,{className:"w-4 h-4 sm:w-5 sm:h-5 mr-2 text-purple-600"}),"Gamification Activity"]}),m?a.jsxs("div",{className:"flex items-center justify-center py-6",children:[a.jsx("div",{className:"animate-spin rounded-full h-5 w-5 sm:h-6 sm:w-6 border-b-2 border-purple-600 mr-2"}),a.jsx("span",{className:"text-gray-600 text-sm sm:text-base",children:"Loading gamification history..."})]}):d?a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2 sm:gap-4 mb-4 sm:mb-6",children:[a.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-3 sm:p-4 hover:bg-purple-100 transition-colors",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-lg sm:text-2xl font-bold text-purple-600",children:d.stats.totalSpins}),a.jsx("div",{className:"text-xs sm:text-sm text-purple-600 font-medium",children:"Total Spins"})]}),a.jsx("div",{className:"text-xl sm:text-3xl",children:""})]}),a.jsx("div",{className:"text-xs text-purple-500 mt-1",children:d.stats.totalSpins>0&&d.stats.totalCoupons>0&&`${(d.stats.totalCoupons/d.stats.totalSpins*100).toFixed(1)}% win rate`})]}),a.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3 sm:p-4 hover:bg-green-100 transition-colors",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-lg sm:text-2xl font-bold text-green-600",children:d.stats.totalCoupons}),a.jsx("div",{className:"text-xs sm:text-sm text-green-600 font-medium",children:"Coupons Earned"})]}),a.jsx("div",{className:"text-xl sm:text-3xl",children:""})]}),a.jsxs("div",{className:"text-xs text-green-500 mt-1",children:[d.stats.totalCoupons-d.stats.redeemedCoupons," unused"]})]}),a.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 sm:p-4 hover:bg-blue-100 transition-colors",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-lg sm:text-2xl font-bold text-blue-600",children:d.stats.redeemedCoupons}),a.jsx("div",{className:"text-xs sm:text-sm text-blue-600 font-medium",children:"Coupons Used"})]}),a.jsx("div",{className:"text-xl sm:text-3xl",children:""})]}),a.jsx("div",{className:"text-xs text-blue-500 mt-1",children:d.stats.totalCoupons>0&&`${(d.stats.redeemedCoupons/d.stats.totalCoupons*100).toFixed(1)}% redemption rate`})]}),a.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-3 sm:p-4 hover:bg-orange-100 transition-colors",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-lg sm:text-2xl font-bold text-orange-600",children:Ue(d.stats.totalDiscountEarned)}),a.jsx("div",{className:"text-xs sm:text-sm text-orange-600 font-medium",children:"Total Rewards"})]}),a.jsx("div",{className:"text-xl sm:text-3xl",children:""})]}),a.jsxs("div",{className:"text-xs text-orange-500 mt-1",children:[Ue(d.stats.totalDiscountUsed)," used"]})]})]}),d.stats.firstSpinDate&&a.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 border border-blue-200 rounded-lg p-3 sm:p-4 mb-4",children:a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[a.jsxs("div",{children:[a.jsx("h6",{className:"font-medium text-gray-900 mb-1 text-sm sm:text-base",children:"Gamification Journey"}),a.jsxs("div",{className:"text-xs sm:text-sm text-gray-600",children:[a.jsxs("div",{children:["Started: ",new Date(d.stats.firstSpinDate).toLocaleDateString()]}),d.stats.lastSpinDate&&a.jsxs("div",{children:["Last Activity: ",new Date(d.stats.lastSpinDate).toLocaleDateString()]})]})]}),a.jsxs("div",{className:"text-left sm:text-right",children:[a.jsx("div",{className:"text-xs sm:text-sm text-gray-600",children:"Engagement Level"}),a.jsx("div",{className:"font-bold text-sm sm:text-lg",children:d.stats.totalSpins>=20?a.jsx("span",{className:"text-purple-600",children:" VIP Player"}):d.stats.totalSpins>=10?a.jsx("span",{className:"text-blue-600",children:" Regular Player"}):d.stats.totalSpins>=5?a.jsx("span",{className:"text-green-600",children:" Active Player"}):a.jsx("span",{className:"text-gray-600",children:" New Player"})})]})]})}),d.spins.length>0&&a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("h5",{className:"font-medium text-gray-900 text-sm sm:text-base",children:"Spin Wheel History"}),a.jsxs("span",{className:"text-xs sm:text-sm text-gray-500",children:[d.spins.length," total spins"]})]}),a.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:d.spins.map((ie,le)=>a.jsxs("button",{onClick:()=>E(ie),className:"w-full flex items-center justify-between p-2 sm:p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors cursor-pointer border border-transparent hover:border-blue-300 group",children:[a.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-3 min-w-0 flex-1",children:[a.jsx("div",{className:"text-xl sm:text-2xl flex-shrink-0",children:ie.resultMessage.includes("luck")?"":ie.resultMessage.includes("%")?"":ie.resultMessage.includes("Free")?"":ie.resultMessage.includes("discount")?"":""}),a.jsxs("div",{className:"flex-1 text-left min-w-0",children:[a.jsx("div",{className:"font-medium text-gray-900 group-hover:text-blue-700 text-xs sm:text-sm truncate",children:ie.resultMessage}),a.jsxs("div",{className:"text-xs text-gray-500",children:[new Date(ie.spinDate).toLocaleDateString()," at ",new Date(ie.spinDate).toLocaleTimeString()]}),ie.pointsEarned>0&&a.jsxs("div",{className:"text-xs text-purple-600 font-medium",children:["+",ie.pointsEarned," loyalty points earned"]}),ie.couponCode&&a.jsxs("div",{className:"text-xs text-blue-600 font-mono truncate",children:["Coupon: ",ie.couponCode]})]})]}),a.jsxs("div",{className:"flex flex-col items-end space-y-1 flex-shrink-0",children:[a.jsx(Xs,{className:"w-3 h-3 sm:w-4 sm:h-4 text-gray-400 group-hover:text-blue-500 mb-1"}),ie.isClaimed&&a.jsx("span",{className:"px-1.5 sm:px-2 py-0.5 sm:py-1 bg-green-100 text-green-800 text-xs rounded-full",children:"Claimed"}),ie.isRedeemed&&a.jsx("span",{className:"px-1.5 sm:px-2 py-0.5 sm:py-1 bg-blue-100 text-blue-800 text-xs rounded-full",children:"Redeemed"}),!ie.isClaimed&&!ie.resultMessage.includes("luck")&&a.jsx("span",{className:"px-1.5 sm:px-2 py-0.5 sm:py-1 bg-yellow-100 text-yellow-800 text-xs rounded-full",children:"Pending"})]})]},ie.id||le))}),d.spins.length>5&&a.jsx("div",{className:"mt-3 text-center",children:a.jsxs("button",{onClick:()=>{const ie=document.querySelector(".space-y-2.max-h-60");ie&&(ie.classList.toggle("max-h-60"),ie.classList.toggle("max-h-96"))},className:"text-xs sm:text-sm text-blue-600 hover:text-blue-800 font-medium",children:["View All Spins (",d.spins.length,")"]})})]}),d.coupons.length>0&&a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("h5",{className:"font-medium text-gray-900 text-sm sm:text-base",children:"Gamification Coupons"}),a.jsxs("span",{className:"text-xs sm:text-sm text-gray-500",children:[d.coupons.filter(ie=>ie.usageCount===0).length," active"]})]}),a.jsx("div",{className:"space-y-3 max-h-60 overflow-y-auto",children:d.coupons.map((ie,le)=>{var De;const ae=new Date(ie.validity.endDate)<new Date,ve=ie.usageCount>0,we=!ae&&!ve;return a.jsx("div",{className:`p-3 sm:p-4 rounded-lg border-2 transition-all ${we?"bg-green-50 border-green-200 hover:bg-green-100":ve?"bg-blue-50 border-blue-200":"bg-gray-50 border-gray-200"}`,children:a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[a.jsx("div",{className:"text-base sm:text-lg",children:ie.type==="percentage"?"":ie.type==="fixed_amount"?"":ie.type==="free_item"?"":""}),a.jsx("div",{className:"font-medium text-gray-900 text-sm sm:text-base truncate",children:ie.name}),a.jsx("span",{className:`px-1.5 sm:px-2 py-0.5 sm:py-1 text-xs rounded-full font-medium ${we?"bg-green-100 text-green-800":ve?"bg-blue-100 text-blue-800":"bg-red-100 text-red-800"}`,children:ve?"Used":ae?"Expired":"Available"})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"text-sm text-gray-600 flex items-center space-x-2",children:[a.jsx("span",{className:"font-mono font-bold bg-gray-100 px-2 py-1 rounded",children:ie.code}),a.jsx("button",{onClick:()=>{navigator.clipboard.writeText(ie.code),Z.success("Coupon code copied to clipboard!")},className:"text-blue-600 hover:text-blue-800 transition-colors",title:"Copy coupon code",children:a.jsx(po,{className:"w-4 h-4"})})]}),a.jsxs("div",{className:"text-sm text-gray-500",children:[a.jsxs("div",{children:["Value: ",a.jsx("span",{className:"font-medium",children:ie.type==="percentage"?`${ie.value}% off`:ie.type==="fixed_amount"?Ue(ie.value):ie.description||"Special offer"})]}),a.jsxs("div",{children:["Expires: ",a.jsx("span",{className:ae?"text-red-600 font-medium":"",children:new Date(ie.validity.endDate).toLocaleDateString()})]}),((De=ie.metadata)==null?void 0:De.spinWheelName)&&a.jsxs("div",{className:"text-xs text-purple-600",children:["From: ",ie.metadata.spinWheelName]})]})]})]}),ve&&ie.usedAt&&a.jsxs("div",{className:"text-right text-xs text-gray-500",children:[a.jsx("div",{children:"Used on"}),a.jsx("div",{children:new Date(ie.usedAt).toLocaleDateString()})]})]})},ie.id||le)})})]})]}):a.jsxs("div",{className:"text-center py-8 bg-gray-50 rounded-lg",children:[a.jsx(Cn,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),a.jsx("h5",{className:"text-lg font-medium text-gray-600 mb-2",children:"No Gamification Activity"}),a.jsx("p",{className:"text-gray-500",children:"This customer hasn't participated in any spin wheel games yet."})]})]}),a.jsxs("div",{className:"mb-6 sm:mb-8",children:[a.jsxs("h4",{className:"text-base sm:text-lg font-medium text-gray-900 mb-3 sm:mb-4 flex items-center",children:[a.jsx(hn,{className:"w-4 h-4 sm:w-5 sm:h-5 mr-2 text-red-600"}),"Credit History & Payment Status"]}),y?a.jsxs("div",{className:"flex items-center justify-center py-6",children:[a.jsx("div",{className:"animate-spin rounded-full h-5 w-5 sm:h-6 sm:w-6 border-b-2 border-red-600 mr-2"}),a.jsx("span",{className:"text-gray-600 text-sm sm:text-base",children:"Loading credit information..."})]}):f.length>0?a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2 sm:gap-4 mb-4 sm:mb-6",children:[a.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 sm:p-4 hover:bg-red-100 transition-colors",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-lg sm:text-2xl font-bold text-red-600",children:Ue(je().totalCredits)}),a.jsx("div",{className:"text-xs sm:text-sm text-red-600 font-medium",children:"Total Credits"})]}),a.jsx("div",{className:"text-xl sm:text-3xl",children:""})]}),a.jsxs("div",{className:"text-xs text-red-500 mt-1",children:[je().totalTransactions," transactions"]})]}),a.jsx("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-3 sm:p-4 hover:bg-orange-100 transition-colors",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-lg sm:text-2xl font-bold text-orange-600",children:Ue(je().pendingAmount)}),a.jsx("div",{className:"text-xs sm:text-sm text-orange-600 font-medium",children:"Pending"})]}),a.jsx("div",{className:"text-xl sm:text-3xl",children:""})]})}),a.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3 sm:p-4 hover:bg-green-100 transition-colors",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-lg sm:text-2xl font-bold text-green-600",children:Ue(je().paidAmount)}),a.jsx("div",{className:"text-xs sm:text-sm text-green-600 font-medium",children:"Paid Back"})]}),a.jsx("div",{className:"text-xl sm:text-3xl",children:""})]})}),a.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 sm:p-4 hover:bg-blue-100 transition-colors",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-lg sm:text-2xl font-bold text-blue-600",children:je().pendingAmount>0?`${(je().paidAmount/(je().paidAmount+je().pendingAmount)*100).toFixed(1)}%`:"100%"}),a.jsx("div",{className:"text-xs sm:text-sm text-blue-600 font-medium",children:"Payment Rate"})]}),a.jsx("div",{className:"text-xl sm:text-3xl",children:""})]})})]}),a.jsxs("div",{children:[a.jsx("h5",{className:"font-medium text-gray-900 mb-3 text-sm sm:text-base",children:"Credit Transactions"}),a.jsx("div",{className:"space-y-3 max-h-64 overflow-y-auto",children:f.map(ie=>{const le=ie.amountReceived+(ie.paymentHistory||[]).reduce((ve,we)=>ve+we.amount,0),ae=ie.totalAmount-le;return a.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-3 sm:p-4 hover:shadow-md transition-shadow",children:a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[a.jsx("div",{className:"text-lg",children:""}),a.jsxs("div",{children:[a.jsxs("h6",{className:"font-medium text-gray-900 text-sm",children:["Order #",ie.orderId," - Table ",ie.tableNumber]}),a.jsxs("div",{className:"text-xs text-gray-500",children:[new Date(ie.createdAt instanceof Date?ie.createdAt:ie.createdAt.toDate()).toLocaleDateString()," at ",new Date(ie.createdAt instanceof Date?ie.createdAt:ie.createdAt.toDate()).toLocaleTimeString()]})]})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Total:"}),a.jsx("div",{className:"font-medium",children:Ue(ie.totalAmount)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Paid:"}),a.jsx("div",{className:"font-medium text-green-600",children:Ue(le)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Remaining:"}),a.jsx("div",{className:"font-medium text-red-600",children:Ue(ae)})]})]}),ie.paymentHistory&&ie.paymentHistory.length>0&&a.jsxs("div",{className:"mt-2 pt-2 border-t border-gray-100",children:[a.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"Payment History:"}),a.jsx("div",{className:"space-y-1",children:ie.paymentHistory.map((ve,we)=>a.jsxs("div",{className:"flex justify-between text-xs",children:[a.jsxs("span",{children:[Ue(ve.amount)," via ",ve.paymentMethod]}),a.jsx("span",{className:"text-gray-500",children:new Date(ve.paidAt instanceof Date?ve.paidAt:ve.paidAt.toDate()).toLocaleDateString()})]},we))})]})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${ie.status==="paid"?"bg-green-100 text-green-800":ie.status==="partially_paid"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:ie.status==="paid"?"Fully Paid":ie.status==="partially_paid"?"Partially Paid":"Pending"}),ie.notes&&a.jsx("div",{className:"text-xs text-gray-500 mt-1 max-w-32",children:ie.notes})]})]})},ie.id)})})]})]}):a.jsxs("div",{className:"text-center py-8 bg-gray-50 rounded-lg",children:[a.jsx(hn,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),a.jsx("h5",{className:"text-lg font-medium text-gray-600 mb-2",children:"No Credit History"}),a.jsx("p",{className:"text-gray-500",children:"This customer has no credit transactions on record."})]})]}),l.length>0&&a.jsxs("div",{className:"mb-6 sm:mb-8",children:[a.jsxs("h4",{className:"text-base sm:text-lg font-medium text-gray-900 mb-3 sm:mb-4 flex items-center",children:[a.jsx(Kd,{className:"w-4 h-4 sm:w-5 sm:h-5 mr-2 text-blue-600"}),"Order Analytics (",l.length," orders)"]}),a.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2 sm:gap-4 mb-4",children:[a.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 sm:p-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-lg sm:text-2xl font-bold text-blue-600",children:l.length}),a.jsx("div",{className:"text-xs sm:text-sm text-blue-600 font-medium",children:"Total Orders"})]}),a.jsx("div",{className:"text-xl sm:text-2xl",children:""})]})}),a.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3 sm:p-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-lg sm:text-2xl font-bold text-green-600",children:Ue(l.reduce((ie,le)=>ie+le.total,0))}),a.jsx("div",{className:"text-xs sm:text-sm text-green-600 font-medium",children:"Total Spent"})]}),a.jsx("div",{className:"text-xl sm:text-2xl",children:""})]})}),a.jsx("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-3 sm:p-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-lg sm:text-2xl font-bold text-purple-600",children:Ue(l.reduce((ie,le)=>ie+le.total,0)/l.length)}),a.jsx("div",{className:"text-xs sm:text-sm text-purple-600 font-medium",children:"Avg Order"})]}),a.jsx("div",{className:"text-xl sm:text-2xl",children:""})]})}),a.jsx("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-3 sm:p-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-lg sm:text-2xl font-bold text-orange-600",children:l.filter(ie=>ie.status==="completed").length}),a.jsx("div",{className:"text-xs sm:text-sm text-orange-600 font-medium",children:"Completed"})]}),a.jsx("div",{className:"text-xl sm:text-2xl",children:""})]})})]}),a.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2 sm:gap-4",children:[a.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3 sm:p-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-lg sm:text-2xl font-bold text-green-600",children:l.filter(ie=>H(ie).type==="Dine In").length}),a.jsx("div",{className:"text-xs sm:text-sm text-green-600 font-medium",children:"Dine In"})]}),a.jsx("div",{className:"text-xl sm:text-2xl",children:""})]}),a.jsxs("div",{className:"text-xs text-green-500 mt-1",children:[l.length>0?(l.filter(ie=>H(ie).type==="Dine In").length/l.length*100).toFixed(1):0,"% of orders"]})]}),a.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 sm:p-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-lg sm:text-2xl font-bold text-blue-600",children:l.filter(ie=>H(ie).type==="Menu Portal").length}),a.jsx("div",{className:"text-xs sm:text-sm text-blue-600 font-medium",children:"Menu Portal"})]}),a.jsx("div",{className:"text-xl sm:text-2xl",children:""})]}),a.jsxs("div",{className:"text-xs text-blue-500 mt-1",children:[l.length>0?(l.filter(ie=>H(ie).type==="Menu Portal").length/l.length*100).toFixed(1):0,"% of orders"]})]}),a.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-3 sm:p-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-lg sm:text-2xl font-bold text-orange-600",children:l.filter(ie=>H(ie).type==="Takeaway").length}),a.jsx("div",{className:"text-xs sm:text-sm text-orange-600 font-medium",children:"Takeaway"})]}),a.jsx("div",{className:"text-xl sm:text-2xl",children:""})]}),a.jsxs("div",{className:"text-xs text-orange-500 mt-1",children:[l.length>0?(l.filter(ie=>H(ie).type==="Takeaway").length/l.length*100).toFixed(1):0,"% of orders"]})]}),a.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-3 sm:p-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-lg sm:text-2xl font-bold text-purple-600",children:l.filter(ie=>H(ie).type==="Table Portal").length}),a.jsx("div",{className:"text-xs sm:text-sm text-purple-600 font-medium",children:"Table Portal"})]}),a.jsx("div",{className:"text-xl sm:text-2xl",children:""})]}),a.jsxs("div",{className:"text-xs text-purple-500 mt-1",children:[l.length>0?(l.filter(ie=>H(ie).type==="Table Portal").length/l.length*100).toFixed(1):0,"% of orders"]})]})]})]}),a.jsxs("div",{children:[a.jsx("h5",{className:"font-medium text-gray-900 mb-3 text-sm sm:text-base",children:"Recent Orders"}),a.jsx("div",{className:"space-y-3 sm:space-y-4 max-h-96 overflow-y-auto",children:l.map(ie=>a.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-3 sm:p-5 hover:shadow-md transition-shadow",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-3 sm:mb-4 gap-3",children:[a.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-3",children:[a.jsx("div",{className:"text-xl sm:text-2xl",children:ie.status==="completed"?"":ie.status==="cancelled"?"":ie.status==="preparing"?"":ie.status==="ready"?"":""}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[a.jsxs("h6",{className:"font-semibold text-gray-900 text-sm sm:text-lg",children:["Order #",ie.orderNumber]}),(()=>{const le=H(ie);return a.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${le.color}`,children:[le.icon," ",le.type]})})()]}),a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:space-x-4 space-y-1 sm:space-y-0 text-xs sm:text-sm text-gray-500",children:[a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx(Jc,{className:"w-3 h-3 sm:w-4 sm:h-4"}),a.jsx("span",{children:new Date(ie.createdAt).toLocaleDateString()})]}),a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx(Ys,{className:"w-3 h-3 sm:w-4 sm:h-4"}),a.jsx("span",{children:new Date(ie.createdAt).toLocaleTimeString()})]}),(()=>{const le=H(ie);if(le.type==="Takeaway")return a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx(ta,{className:"w-3 h-3 sm:w-4 sm:h-4"}),a.jsx("span",{children:"Takeaway Counter"})]});if(le.type==="Menu Portal")return a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx(ta,{className:"w-3 h-3 sm:w-4 sm:h-4"}),a.jsx("span",{children:"Online Portal"})]});if(le.type==="Table Portal"&&ie.notes){const ae=ie.notes.match(/Table: ([^|]+)/),ve=ae?ae[1].trim():"Table Portal";return a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx(ta,{className:"w-3 h-3 sm:w-4 sm:h-4"}),a.jsx("span",{children:ve})]})}else if(ie.tableId&&ie.tableId!=="customer-portal"&&ie.tableId!=="takeaway-order")return a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx(ta,{className:"w-3 h-3 sm:w-4 sm:h-4"}),a.jsxs("span",{children:["Table ",ie.tableId]})]});return null})(),(ie.customerName||(ie.customerPhone?ie.customerPhone:!1))&&a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx(Hs,{className:"w-3 h-3 sm:w-4 sm:h-4"}),a.jsx("span",{children:ie.customerName||(ie.customerPhone?ie.customerPhone:"")})]})]})]})]}),a.jsxs("div",{className:"text-left sm:text-right",children:[a.jsx("div",{className:"text-lg sm:text-2xl font-bold text-gray-900",children:Ue(ie.total)}),a.jsx("span",{className:`inline-flex items-center px-2 sm:px-3 py-0.5 sm:py-1 rounded-full text-xs sm:text-sm font-medium ${ie.status==="completed"?"bg-green-100 text-green-800":ie.status==="cancelled"?"bg-red-100 text-red-800":ie.status==="preparing"?"bg-yellow-100 text-yellow-800":ie.status==="ready"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:ie.status.charAt(0).toUpperCase()+ie.status.slice(1)})]})]}),a.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 sm:p-4 mb-3 sm:mb-4",children:[a.jsxs("h6",{className:"text-xs sm:text-sm font-semibold text-gray-700 mb-2 sm:mb-3 flex items-center",children:[a.jsx(Kd,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-2"}),"Items Ordered (",ie.items.length,")"]}),a.jsx("div",{className:"space-y-2",children:ie.items.map((le,ae)=>a.jsxs("div",{className:"flex justify-between items-start sm:items-center py-2 border-b border-gray-200 last:border-b-0",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"font-medium text-gray-900 text-xs sm:text-sm",children:[le.quantity,"x ",le.name]}),le.customizations&&le.customizations.length>0&&a.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Customizations: ",le.customizations.join(", ")]}),le.notes&&a.jsxs("div",{className:"text-xs text-blue-600 mt-1",children:["Note: ",le.notes]})]}),a.jsxs("div",{className:"text-right flex-shrink-0 ml-2",children:[a.jsx("div",{className:"font-semibold text-gray-900 text-xs sm:text-sm",children:Ue(le.total)}),a.jsxs("div",{className:"text-xs text-gray-500",children:[Ue(le.price)," each"]})]})]},ae))})]}),a.jsx("div",{className:"bg-gradient-to-r from-gray-50 to-blue-50 rounded-lg p-3 sm:p-4",children:a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex justify-between text-xs sm:text-sm",children:[a.jsx("span",{className:"text-gray-600",children:"Subtotal:"}),a.jsx("span",{className:"font-medium",children:Ue(ie.subtotal)})]}),a.jsxs("div",{className:"flex justify-between text-xs sm:text-sm",children:[a.jsx("span",{className:"text-gray-600",children:"Tax:"}),a.jsx("span",{className:"font-medium",children:Ue(ie.tax)})]}),ie.discount>0&&a.jsxs("div",{className:"flex justify-between text-xs sm:text-sm text-green-600",children:[a.jsx("span",{children:"Discount Applied:"}),a.jsxs("span",{className:"font-medium",children:["-",Ue(ie.discount)]})]}),a.jsx("div",{className:"border-t border-gray-300 pt-2 mt-2",children:a.jsxs("div",{className:"flex justify-between text-sm sm:text-lg font-bold",children:[a.jsx("span",{className:"text-gray-900",children:"Total:"}),a.jsx("span",{className:"text-blue-600",children:Ue(ie.total)})]})})]})}),ie.notes&&a.jsx("div",{className:"mt-3 sm:mt-4 p-2 sm:p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:a.jsxs("div",{className:"flex items-start space-x-2",children:[a.jsx("div",{className:"text-yellow-600 mt-0.5",children:""}),a.jsxs("div",{children:[a.jsx("span",{className:"text-xs sm:text-sm font-medium text-yellow-800",children:"Order Notes:"}),a.jsx("p",{className:"text-xs sm:text-sm text-yellow-700 mt-1",children:ie.notes})]})]})})]},ie.id))})]})]})]})]})]})}),x&&a.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:a.jsxs("div",{className:"flex items-center justify-center min-h-screen px-2 sm:px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[a.jsx("div",{className:"fixed inset-0 transition-opacity bg-black bg-opacity-50",onClick:()=>E(null)}),a.jsxs("div",{className:"inline-block w-full max-w-2xl my-4 sm:my-8 overflow-hidden text-left align-middle transition-all transform bg-white shadow-xl rounded-2xl",children:[a.jsx("div",{className:"px-3 sm:px-6 py-3 sm:py-4 bg-gradient-to-r from-purple-600 to-blue-600 text-white",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-3 min-w-0 flex-1",children:[a.jsx("div",{className:"text-2xl sm:text-3xl",children:x.resultMessage.includes("luck")?"":x.resultMessage.includes("%")?"":x.resultMessage.includes("Free")?"":x.resultMessage.includes("discount")?"":""}),a.jsxs("div",{className:"min-w-0 flex-1",children:[a.jsx("h3",{className:"text-lg sm:text-xl font-bold",children:"Spin Details"}),a.jsx("p",{className:"text-purple-100 text-sm sm:text-base truncate",children:x.resultMessage})]})]}),a.jsx("button",{onClick:()=>E(null),className:"text-white hover:text-gray-200 transition-colors",children:a.jsx(qr,{className:"w-6 h-6"})})]})}),a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[a.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[a.jsx(Ys,{className:"w-4 h-4 text-gray-500"}),a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Date & Time"})]}),a.jsx("div",{className:"text-lg font-semibold text-gray-900",children:new Date(x.spinDate).toLocaleDateString()}),a.jsx("div",{className:"text-sm text-gray-600",children:new Date(x.spinDate).toLocaleTimeString()})]}),a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[a.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[a.jsx(YA,{className:"w-4 h-4 text-gray-500"}),a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Loyalty Points"})]}),a.jsxs("div",{className:"text-lg font-semibold text-purple-600",children:[x.pointsEarned>0?`+${x.pointsEarned}`:"0"," points"]}),a.jsx("div",{className:"text-sm text-gray-600",children:x.pointsEarned>0?"Earned from this spin":"No points earned"})]})]}),x.couponCode&&a.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-blue-50 border border-green-200 rounded-lg p-6 mb-6",children:[a.jsxs("h4",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[a.jsx(Cn,{className:"w-5 h-5 mr-2 text-green-600"}),"Coupon Details"]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Coupon Code"}),a.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[a.jsx("div",{className:"flex-1 bg-white border border-gray-300 rounded-lg px-4 py-3 font-mono text-lg font-bold text-center",children:x.couponCode}),a.jsxs("button",{onClick:()=>{navigator.clipboard.writeText(x.couponCode),Z.success("Coupon code copied to clipboard!")},className:"px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center space-x-2",children:[a.jsx(po,{className:"w-4 h-4"}),a.jsx("span",{children:"Copy"})]})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Reward Value"}),a.jsx("div",{className:"mt-1 text-lg font-semibold text-green-600",children:x.resultMessage})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Status"}),a.jsx("div",{className:"mt-1",children:x.isRedeemed?a.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 text-sm rounded-full font-medium",children:" Redeemed"}):x.isClaimed?a.jsx("span",{className:"px-3 py-1 bg-green-100 text-green-800 text-sm rounded-full font-medium",children:" Claimed"}):x.resultMessage.includes("luck")?a.jsx("span",{className:"px-3 py-1 bg-gray-100 text-gray-800 text-sm rounded-full font-medium",children:" No Prize"}):a.jsx("span",{className:"px-3 py-1 bg-yellow-100 text-yellow-800 text-sm rounded-full font-medium",children:" Pending"})})]})]})]})]}),a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-6",children:[a.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Redemption Status"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-gray-700",children:"Spin Completed"}),a.jsx("span",{className:"text-green-600 font-medium",children:" Yes"})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-gray-700",children:"Reward Claimed"}),a.jsx("span",{className:x.isClaimed?"text-green-600 font-medium":"text-gray-500",children:x.isClaimed?" Yes":" No"})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-gray-700",children:"Coupon Used"}),a.jsx("span",{className:x.isRedeemed?"text-green-600 font-medium":"text-gray-500",children:x.isRedeemed?" Yes":" No"})]})]})]}),a.jsxs("div",{className:"flex justify-end space-x-3",children:[x.couponCode&&!x.isRedeemed&&a.jsxs("button",{onClick:()=>{navigator.clipboard.writeText(x.couponCode),Z.success("Coupon code copied! Customer can use this now.")},className:"px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors flex items-center space-x-2",children:[a.jsx(po,{className:"w-4 h-4"}),a.jsx("span",{children:"Copy for Customer"})]}),a.jsx("button",{onClick:()=>E(null),className:"px-6 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:"Close"})]})]})]})]})})]}):a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Loading..."})]})})}function Qpe(){const{restaurant:t}=js(),{user:e}=ia(),[r,s]=R.useState(!1),[n,i]=R.useState(!1),[o,l]=R.useState(!1),[c,d]=R.useState([]),[u,A]=R.useState(!0),[h,f]=R.useState(""),[p,m]=R.useState([]),[g,y]=R.useState(!1),[v,x]=R.useState(!1),[E,T]=R.useState(null),[j,C]=R.useState({name:"",description:"",code:"",type:"percentage_discount",value:0,startDate:"",endDate:"",usageLimit:"",perCustomerLimit:"",validDays:[],validHours:{start:"00:00",end:"23:59"},customerSegments:[],minimumOrderValue:"",applicableCategories:[],excludedCategories:[],paymentMethods:"all",buyQuantity:2,getQuantity:1,buyCategories:[],getCategories:[],getDiscount:100,terms:""}),w=["monday","tuesday","wednesday","thursday","friday","saturday","sunday"];R.useEffect(()=>{(async()=>{if(!(t!=null&&t.id)){console.log("No restaurant ID available");return}try{console.log("Fetching coupons for restaurant:",t.id),A(!0);const te=await Oo.getCouponsForRestaurant(t.id);console.log("Fetch coupons response:",te),te.success&&te.data?(console.log("Found coupons:",te.data),d(te.data)):console.error("Failed to fetch coupons:",te.error)}catch(te){console.error("Error fetching coupons:",te),Z.error("Failed to load coupons")}finally{A(!1)}})()},[t==null?void 0:t.id]);const S=async()=>{if(t!=null&&t.id){y(!0);try{const q=await Uc.searchGamificationCoupons(t.id,h);q.success&&q.data?(m(q.data),q.data.length===0&&h&&Z.success("No coupons found")):(Z.error(q.error||"Failed to search coupons"),m([]))}catch(q){console.error("Error searching coupons:",q),Z.error("Failed to search coupons"),m([])}finally{y(!1)}}},F=async q=>{if(t!=null&&t.id){T(q);try{const te=await Uc.redeemGamificationCoupon(t.id,q);te.success?(Z.success(te.message||"Coupon redeemed successfully!"),S()):Z.error(te.error||"Failed to redeem coupon")}catch(te){console.error("Error redeeming coupon:",te),Z.error("Failed to redeem coupon")}finally{T(null)}}},B=(q,te)=>{C(W=>({...W,[q]:te}))},k=()=>{const q="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let te="";for(let W=0;W<8;W++)te+=q.charAt(Math.floor(Math.random()*q.length));C(W=>({...W,code:te}))},D=async q=>{if(q.preventDefault(),!!(t!=null&&t.id)){l(!0);try{if(!j.name||!j.description||!j.code){Z.error("Please fill in all required fields");return}const te={restaurantId:t.id,name:j.name,description:j.description,code:j.code,type:j.type,status:"active",validity:{startDate:j.startDate?new Date(j.startDate):new Date,endDate:j.endDate?new Date(j.endDate):new Date(Date.now()+30*24*60*60*1e3),validDays:j.validDays.length>0?j.validDays:w,...j.usageLimit&&{usageLimit:parseInt(j.usageLimit)},...j.perCustomerLimit&&{perCustomerLimit:parseInt(j.perCustomerLimit)}},targeting:{customerSegments:["all"],...j.minimumOrderValue&&{minOrderValue:parseFloat(j.minimumOrderValue)},applicableMenuItems:[],excludedMenuItems:[],applicableCategories:j.applicableCategories,excludedCategories:j.excludedCategories,paymentMethodRestriction:j.paymentMethods},config:j.type==="percentage_discount"?{percentage:j.value}:j.type==="fixed_amount"?{discountAmount:j.value,...j.minimumOrderValue&&{minimumOrderValue:parseFloat(j.minimumOrderValue)}}:j.type==="buy_x_get_y"?{buyXGetY:{buyQuantity:j.buyQuantity,getQuantity:j.getQuantity,getDiscountPercentage:j.getDiscount}}:{},termsAndConditions:j.terms||"",createdBy:"admin"};console.log("Creating coupon with data:",te),console.log("Restaurant ID:",t.id);const W=await Oo.createCoupon(t.id,te);if(console.log("Create coupon response:",W),W.success&&W.data)d(Q=>[W.data,...Q]),Z.success(`Coupon "${j.name}" created successfully!`);else throw console.error("Failed to create coupon:",W.error),new Error(W.error||"Failed to create coupon");C({name:"",description:"",code:"",type:"percentage_discount",value:0,startDate:"",endDate:"",usageLimit:"",perCustomerLimit:"",validDays:[],validHours:{start:"00:00",end:"23:59"},customerSegments:[],minimumOrderValue:"",applicableCategories:[],excludedCategories:[],paymentMethods:"all",buyQuantity:2,getQuantity:1,buyCategories:[],getCategories:[],getDiscount:100,terms:""}),i(!1),s(!1)}catch(te){console.error("Error creating coupon:",te),Z.error("Failed to create coupon")}finally{l(!1)}}};return t?a.jsx("div",{className:"min-h-screen",style:{background:"var(--color-background)"},children:a.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 sm:py-8",children:[a.jsx("div",{className:"mb-6 sm:mb-8",children:a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[a.jsxs("div",{children:[a.jsxs("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900 flex items-center",children:[a.jsx(Cn,{className:"w-6 h-6 sm:w-8 sm:h-8 mr-2 sm:mr-3 text-pink-600"}),"Coupon Dashboard"]}),a.jsx("p",{className:"text-gray-600 mt-1 text-sm sm:text-base",children:"Manage your restaurant's promotional campaigns and track performance"})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-2 sm:gap-3",children:[a.jsxs("button",{className:"btn btn-outline flex items-center justify-center text-sm sm:text-base",onClick:()=>x(!v),children:[a.jsx(qi,{className:"w-4 h-4 mr-2"}),a.jsxs("span",{className:"hidden sm:inline",children:[v?"Hide":"Show"," Spin Wheel Coupons"]}),a.jsxs("span",{className:"sm:hidden",children:[v?"Hide":"Show"," Spin Coupons"]})]}),a.jsxs("button",{className:"btn btn-outline flex items-center justify-center text-sm sm:text-base",onClick:()=>Z.success("Export functionality coming soon!"),children:[a.jsx(Yn,{className:"w-4 h-4 mr-2"}),"Export"]}),a.jsxs("button",{className:"btn btn-theme-primary flex items-center justify-center text-sm sm:text-base",onClick:()=>s(!0),children:[a.jsx(zr,{className:"w-4 h-4 mr-2"}),"Create Coupon"]})]})]})}),a.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-6 gap-3 sm:gap-6 mb-6 sm:mb-8",children:[a.jsx("div",{className:"card p-3 sm:p-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"min-w-0 flex-1",children:[a.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-600 truncate",children:"Total Coupons"}),a.jsx("p",{className:"text-lg sm:text-2xl font-bold text-gray-900",children:c.length})]}),a.jsx("div",{className:"w-8 h-8 sm:w-12 sm:h-12 bg-blue-50 rounded-lg flex items-center justify-center flex-shrink-0",children:a.jsx(Cn,{className:"w-4 h-4 sm:w-6 sm:h-6 text-blue-600"})})]})}),a.jsx("div",{className:"card p-3 sm:p-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"min-w-0 flex-1",children:[a.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-600 truncate",children:"Active Coupons"}),a.jsx("p",{className:"text-lg sm:text-2xl font-bold text-gray-900",children:c.filter(q=>q.status==="active").length})]}),a.jsx("div",{className:"w-8 h-8 sm:w-12 sm:h-12 bg-green-50 rounded-lg flex items-center justify-center flex-shrink-0",children:a.jsx(Nr,{className:"w-4 h-4 sm:w-6 sm:h-6 text-green-600"})})]})}),a.jsx("div",{className:"card p-3 sm:p-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"min-w-0 flex-1",children:[a.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-600 truncate",children:"Total Usage"}),a.jsx("p",{className:"text-lg sm:text-2xl font-bold text-gray-900",children:c.reduce((q,te)=>q+te.usageCount,0)})]}),a.jsx("div",{className:"w-8 h-8 sm:w-12 sm:h-12 bg-purple-50 rounded-lg flex items-center justify-center flex-shrink-0",children:a.jsx(Ls,{className:"w-4 h-4 sm:w-6 sm:h-6 text-purple-600"})})]})}),a.jsx("div",{className:"card p-3 sm:p-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"min-w-0 flex-1",children:[a.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-600 truncate",children:"Expired"}),a.jsx("p",{className:"text-lg sm:text-2xl font-bold text-gray-900",children:c.filter(q=>q.status==="expired").length})]}),a.jsx("div",{className:"w-8 h-8 sm:w-12 sm:h-12 bg-red-50 rounded-lg flex items-center justify-center flex-shrink-0",children:a.jsx(Ys,{className:"w-4 h-4 sm:w-6 sm:h-6 text-red-600"})})]})}),a.jsx("div",{className:"card p-3 sm:p-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"min-w-0 flex-1",children:[a.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-600 truncate",children:"Total Savings"}),a.jsx("p",{className:"text-lg sm:text-2xl font-bold text-gray-900",children:"0"})]}),a.jsx("div",{className:"w-8 h-8 sm:w-12 sm:h-12 bg-orange-50 rounded-lg flex items-center justify-center flex-shrink-0",children:a.jsx(hn,{className:"w-4 h-4 sm:w-6 sm:h-6 text-orange-600"})})]})}),a.jsx("div",{className:"card p-3 sm:p-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"min-w-0 flex-1",children:[a.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-600 truncate",children:"Draft Coupons"}),a.jsx("p",{className:"text-lg sm:text-2xl font-bold text-gray-900",children:c.filter(q=>q.status==="draft").length})]}),a.jsx("div",{className:"w-8 h-8 sm:w-12 sm:h-12 bg-teal-50 rounded-lg flex items-center justify-center flex-shrink-0",children:a.jsx(Is,{className:"w-4 h-4 sm:w-6 sm:h-6 text-teal-600"})})]})})]}),v&&a.jsxs("div",{className:"card p-4 sm:p-6 mb-6 sm:mb-8",children:[a.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6",children:a.jsxs("div",{children:[a.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[a.jsx(qi,{className:"w-5 h-5 mr-2 text-purple-600"}),"Spin Wheel Coupons"]}),a.jsx("p",{className:"text-gray-600 text-sm",children:"Search and redeem coupons generated from spin wheel game"})]})}),a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-3 sm:gap-4 mb-6",children:[a.jsx("div",{className:"flex-1 relative",children:a.jsx("input",{type:"text",placeholder:"Search by coupon code, customer name, or phone...",value:h,onChange:q=>f(q.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 text-sm sm:text-base",onKeyPress:q=>q.key==="Enter"&&S()})}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-4",children:[a.jsx("button",{onClick:S,disabled:g,className:"btn btn-theme-primary flex items-center justify-center text-sm sm:text-base",children:g?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Searching..."]}):a.jsxs(a.Fragment,{children:[a.jsx(qi,{className:"w-4 h-4 mr-2"}),"Search"]})}),a.jsx("button",{onClick:()=>{f(""),S()},disabled:g,className:"btn btn-outline flex items-center justify-center text-sm sm:text-base",children:"Show All"}),a.jsxs("button",{onClick:async()=>{if(!(t!=null&&t.id))return;const q={name:"Test Spin Wheel Reward",description:"Test reward from spin wheel game: 10% off. Winner: Test User (1234567890)",code:"TEST"+Date.now().toString().slice(-4),type:"percentage_discount",status:"active",createdBy:(e==null?void 0:e.id)||"test-user",restaurantId:t.id,termsAndConditions:"Valid for one-time use only. Cannot be combined with other offers.",validity:{startDate:new Date,endDate:new Date(Date.now()+30*24*60*60*1e3),usageLimit:1,perCustomerLimit:1,validDays:["monday","tuesday","wednesday","thursday","friday","saturday","sunday"]},targeting:{customerSegments:["all"],minOrderValue:0,applicableCategories:[],excludedCategories:[],paymentMethodRestriction:"all"},config:{percentage:10,maxDiscountAmount:500},metadata:{source:"gamification_spin_wheel",spinRecordId:"test-spin-123",userId:"test-user-123",userName:"Test User",userPhone:"1234567890",spinDate:new Date,segmentId:"test-segment",segmentColor:"#ff0000"}};try{const te=await Oo.createCoupon(t.id,q);te.success?(Z.success("Test coupon created successfully!"),S()):Z.error("Failed to create test coupon: "+te.error)}catch(te){console.error("Error creating test coupon:",te),Z.error("Error creating test coupon")}},className:"btn btn-secondary flex items-center justify-center text-sm sm:text-base",children:[a.jsx("span",{className:"hidden sm:inline",children:" Create Test Coupon"}),a.jsx("span",{className:"sm:hidden",children:" Test"})]})]})]}),p.length>0?a.jsxs("div",{className:"space-y-4",children:[a.jsxs("h3",{className:"font-medium text-gray-900",children:["Search Results (",p.length,")"]}),a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:p.map(q=>{var te,W,Q;return a.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 bg-white hover:shadow-md transition-shadow",children:[a.jsxs("div",{className:"flex items-start justify-between mb-3",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-gray-900 truncate",children:q.name}),a.jsx("p",{className:"text-sm text-gray-600 mt-1 line-clamp-2",children:q.description})]}),a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium flex-shrink-0 ml-2 ${q.usageCount>0?"bg-red-100 text-red-800":"bg-green-100 text-green-800"}`,children:q.usageCount>0?"Used":"Available"})]}),a.jsx("div",{className:"bg-gray-50 rounded-lg p-3 mb-3",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Coupon Code:"}),a.jsx("code",{className:"bg-white px-2 py-1 rounded text-sm font-mono border truncate max-w-24",children:q.code})]})}),a.jsxs("div",{className:"space-y-2 mb-4",children:[a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{className:"text-gray-600",children:"Customer:"}),a.jsx("span",{className:"font-medium truncate ml-2",children:(te=q.metadata)==null?void 0:te.userName})]}),a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{className:"text-gray-600",children:"Phone:"}),a.jsx("span",{className:"font-medium",children:(W=q.metadata)==null?void 0:W.userPhone})]}),a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{className:"text-gray-600",children:"Spin Date:"}),a.jsx("span",{className:"font-medium text-xs sm:text-sm",children:(Q=q.metadata)!=null&&Q.spinDate?new Date(q.metadata.spinDate).toLocaleDateString():"N/A"})]}),a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{className:"text-gray-600",children:"Expires:"}),a.jsx("span",{className:"font-medium text-xs sm:text-sm",children:new Date(q.validity.endDate).toLocaleDateString()})]})]}),a.jsx("button",{onClick:()=>F(q.code),disabled:q.usageCount>0||E===q.code,className:`w-full py-2 px-4 rounded-lg font-medium transition-colors text-sm ${q.usageCount>0?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-purple-600 text-white hover:bg-purple-700"}`,children:E===q.code?a.jsxs("div",{className:"flex items-center justify-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Redeeming..."]}):q.usageCount>0?"Already Redeemed":"Redeem Coupon"})]},q.id)})})]}):h&&!g?a.jsxs("div",{className:"text-center py-8",children:[a.jsx(qi,{className:"w-12 h-12 sm:w-16 sm:h-16 text-gray-300 mx-auto mb-4"}),a.jsx("h3",{className:"text-base sm:text-lg font-medium text-gray-900 mb-2",children:"No coupons found"}),a.jsx("p",{className:"text-gray-500 text-sm sm:text-base",children:"Try searching with a different coupon code, name, or phone number."})]}):a.jsxs("div",{className:"text-center py-8",children:[a.jsx(qi,{className:"w-12 h-12 sm:w-16 sm:h-16 text-gray-300 mx-auto mb-4"}),a.jsx("h3",{className:"text-base sm:text-lg font-medium text-gray-900 mb-2",children:"Search for Spin Wheel Coupons"}),a.jsx("p",{className:"text-gray-500 text-sm sm:text-base",children:"Enter a coupon code, customer name, or phone number to find and redeem spin wheel coupons."})]})]}),a.jsxs("div",{className:"card p-4 sm:p-6",children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Your Coupons"}),u?a.jsxs("div",{className:"flex items-center justify-center py-12",children:[a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),a.jsx("span",{className:"ml-2 text-gray-600",children:"Loading coupons..."})]}):c.length===0?a.jsxs("div",{className:"text-center py-8 sm:py-12",children:[a.jsx(Cn,{className:"w-12 h-12 sm:w-16 sm:h-16 text-gray-300 mx-auto mb-4"}),a.jsx("h3",{className:"text-base sm:text-lg font-medium text-gray-900 mb-2",children:"No coupons yet"}),a.jsx("p",{className:"text-gray-500 mb-4 text-sm sm:text-base",children:"Create your first coupon to start offering promotions to your customers."}),a.jsxs("button",{className:"btn btn-theme-primary text-sm sm:text-base",onClick:()=>s(!0),children:[a.jsx(zr,{className:"w-4 h-4 mr-2"}),"Create Your First Coupon"]})]}):a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6",children:c.map((q,te)=>{var he;const W=I=>{const U=["from-pink-500 to-pink-600","from-blue-500 to-blue-600","from-green-500 to-green-600","from-purple-500 to-purple-600","from-orange-500 to-orange-600","from-indigo-500 to-indigo-600"];return U[I%U.length]},Q=I=>{switch(I){case"percentage_discount":return a.jsx(Ax,{className:"w-6 h-6 sm:w-8 sm:h-8"});case"fixed_amount":return a.jsx(hn,{className:"w-6 h-6 sm:w-8 sm:h-8"});case"buy_x_get_y":return a.jsx(Cn,{className:"w-6 h-6 sm:w-8 sm:h-8"});default:return a.jsx(Cn,{className:"w-6 h-6 sm:w-8 sm:h-8"})}},re=I=>{switch(I){case"active":return"bg-green-500/20 text-green-100";case"draft":return"bg-yellow-500/20 text-yellow-100";case"expired":return"bg-red-500/20 text-red-100";case"paused":return"bg-gray-500/20 text-gray-100";default:return"bg-white/20 text-white"}},G=((he=q.validity)==null?void 0:he.usageLimit)||0,Ae=G>0?q.usageCount/G*100:0;return a.jsxs("div",{className:`bg-gradient-to-r ${W(te)} rounded-xl p-4 sm:p-6 text-white`,children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[Q(q.type),a.jsx("span",{className:`px-2 py-1 rounded-full text-xs sm:text-sm ${re(q.status)}`,children:q.status.charAt(0).toUpperCase()+q.status.slice(1)})]}),a.jsx("h3",{className:"text-lg sm:text-xl font-bold mb-2 truncate",children:q.name}),a.jsx("p",{className:"opacity-90 mb-4 text-sm sm:text-base line-clamp-2",children:q.description}),a.jsx("div",{className:"bg-white/20 rounded-lg p-3",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm",children:"Code:"}),a.jsx("code",{className:"bg-white text-gray-800 px-2 py-1 rounded text-xs sm:text-sm font-mono truncate max-w-20",children:q.code})]})}),G>0&&a.jsxs("div",{className:"mt-4 text-xs sm:text-sm",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsxs("span",{children:["Used: ",q.usageCount,"/",G]}),a.jsxs("span",{children:[Math.round(Ae),"% usage"]})]}),a.jsx("div",{className:"w-full bg-white/20 rounded-full h-2 mt-2",children:a.jsx("div",{className:"bg-white h-2 rounded-full",style:{width:`${Math.min(Ae,100)}%`}})})]})]},q.id)})}),a.jsxs("div",{className:"mt-6 sm:mt-8 text-center",children:[a.jsx("p",{className:"text-gray-500 mb-4 text-sm sm:text-base",children:" Coupon Dashboard is now live! Features include:"}),a.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4 text-sm",children:[a.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 sm:p-4",children:[a.jsx(Ax,{className:"w-5 h-5 sm:w-6 sm:h-6 text-blue-600 mx-auto mb-2"}),a.jsx("p",{className:"font-medium text-xs sm:text-sm",children:"Percentage Discounts"}),a.jsx("p",{className:"text-gray-500 text-xs",children:"10%, 20%, 50% off"})]}),a.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 sm:p-4",children:[a.jsx(hn,{className:"w-5 h-5 sm:w-6 sm:h-6 text-green-600 mx-auto mb-2"}),a.jsx("p",{className:"font-medium text-xs sm:text-sm",children:"Fixed Amount Off"}),a.jsx("p",{className:"text-gray-500 text-xs",children:"50, 100, 200 off"})]}),a.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 sm:p-4",children:[a.jsx(Cn,{className:"w-5 h-5 sm:w-6 sm:h-6 text-purple-600 mx-auto mb-2"}),a.jsx("p",{className:"font-medium text-xs sm:text-sm",children:"BOGO Deals"}),a.jsx("p",{className:"text-gray-500 text-xs",children:"Buy X Get Y Free"})]}),a.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 sm:p-4",children:[a.jsx(Sa,{className:"w-5 h-5 sm:w-6 sm:h-6 text-orange-600 mx-auto mb-2"}),a.jsx("p",{className:"font-medium text-xs sm:text-sm",children:"Smart Analytics"}),a.jsx("p",{className:"text-gray-500 text-xs",children:"Usage tracking & insights"})]})]})]})]}),r&&a.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 overflow-y-auto",onClick:()=>s(!1),children:a.jsx("div",{className:"min-h-full flex items-center justify-center p-2 sm:p-4",children:a.jsx("div",{className:"bg-white rounded-xl shadow-2xl max-w-2xl w-full my-4 sm:my-8 max-h-[95vh] overflow-y-auto",onClick:q=>q.stopPropagation(),children:a.jsxs("div",{className:"p-4 sm:p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-blue-100 rounded-lg flex items-center justify-center mr-3 sm:mr-4",children:a.jsx(zr,{className:"w-5 h-5 sm:w-6 sm:h-6 text-blue-600"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg sm:text-xl font-semibold text-gray-900",children:"Create New Coupon"}),a.jsx("p",{className:"text-xs sm:text-sm text-gray-500",children:"Set up a promotional offer for your customers"})]})]}),a.jsx("button",{onClick:()=>s(!1),className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100",children:a.jsx(qr,{className:"w-5 h-5"})})]}),!n&&a.jsxs("div",{className:"mb-6",children:[a.jsx("h4",{className:"text-base sm:text-lg font-medium text-gray-900 mb-4",children:"Quick Templates"}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[a.jsxs("button",{className:"text-left p-3 sm:p-4 border border-gray-200 rounded-lg hover:border-blue-500 hover:bg-blue-50 transition-colors",onClick:()=>{C({...j,name:"20% Welcome Discount",description:"Get 20% off on your first order",type:"percentage_discount",value:20,code:"WELCOME20"}),i(!0)},children:[a.jsxs("div",{className:"flex items-center mb-2",children:[a.jsx(Ax,{className:"w-4 h-4 sm:w-5 sm:h-5 text-blue-600 mr-2"}),a.jsx("span",{className:"font-medium text-sm sm:text-base",children:"Welcome Discount"})]}),a.jsx("p",{className:"text-xs sm:text-sm text-gray-600",children:"20% off for new customers"}),a.jsx("div",{className:"mt-2 text-xs text-blue-600",children:"Click to customize"})]}),a.jsxs("button",{className:"text-left p-3 sm:p-4 border border-gray-200 rounded-lg hover:border-green-500 hover:bg-green-50 transition-colors",onClick:()=>{C({...j,name:"Fixed 100 Off",description:"Get 100 off on orders above 500",type:"fixed_amount",value:100,code:"SAVE100",minimumOrderValue:"500"}),i(!0)},children:[a.jsxs("div",{className:"flex items-center mb-2",children:[a.jsx(hn,{className:"w-4 h-4 sm:w-5 sm:h-5 text-green-600 mr-2"}),a.jsx("span",{className:"font-medium text-sm sm:text-base",children:"Fixed Amount Off"})]}),a.jsx("p",{className:"text-xs sm:text-sm text-gray-600",children:"100 off on orders above 500"}),a.jsx("div",{className:"mt-2 text-xs text-green-600",children:"Click to customize"})]}),a.jsxs("button",{className:"text-left p-3 sm:p-4 border border-gray-200 rounded-lg hover:border-purple-500 hover:bg-purple-50 transition-colors",onClick:()=>{C({...j,name:"Buy 1 Get 1 Free",description:"Free item on qualifying purchase",type:"buy_x_get_y",value:0,code:"BUY1GET1",buyQuantity:1,getQuantity:1}),i(!0)},children:[a.jsxs("div",{className:"flex items-center mb-2",children:[a.jsx(Cn,{className:"w-4 h-4 sm:w-5 sm:h-5 text-purple-600 mr-2"}),a.jsx("span",{className:"font-medium text-sm sm:text-base",children:"Buy 1 Get 1 Free"})]}),a.jsx("p",{className:"text-xs sm:text-sm text-gray-600",children:"Free item on qualifying purchase"}),a.jsx("div",{className:"mt-2 text-xs text-purple-600",children:"Click to customize"})]}),a.jsxs("button",{className:"text-left p-3 sm:p-4 border border-gray-200 rounded-lg hover:border-orange-500 hover:bg-orange-50 transition-colors",onClick:()=>i(!0),children:[a.jsxs("div",{className:"flex items-center mb-2",children:[a.jsx(qi,{className:"w-4 h-4 sm:w-5 sm:h-5 text-orange-600 mr-2"}),a.jsx("span",{className:"font-medium text-sm sm:text-base",children:"Custom Coupon"})]}),a.jsx("p",{className:"text-xs sm:text-sm text-gray-600",children:"Create from scratch with all options"}),a.jsx("div",{className:"mt-2 text-xs text-orange-600",children:"Full customization"})]})]})]}),n&&a.jsxs("form",{onSubmit:D,className:"space-y-6",children:[a.jsxs("div",{className:"space-y-4",children:[a.jsx("h5",{className:"text-sm sm:text-md font-medium text-gray-900",children:"Basic Information"}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs sm:text-sm font-medium text-gray-700 mb-1",children:"Coupon Name *"}),a.jsx("input",{type:"text",value:j.name,onChange:q=>B("name",q.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",placeholder:"e.g., Welcome Discount",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs sm:text-sm font-medium text-gray-700 mb-1",children:"Coupon Code *"}),a.jsxs("div",{className:"flex",children:[a.jsx("input",{type:"text",value:j.code,onChange:q=>B("code",q.target.value.toUpperCase()),className:"flex-1 px-3 py-2 border border-gray-300 rounded-l-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",placeholder:"WELCOME20",required:!0}),a.jsxs("button",{type:"button",onClick:k,className:"px-2 sm:px-3 py-2 bg-gray-100 border border-l-0 border-gray-300 rounded-r-lg hover:bg-gray-200 text-xs sm:text-sm",children:[a.jsx("span",{className:"hidden sm:inline",children:"Generate"}),a.jsx("span",{className:"sm:hidden",children:"Gen"})]})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs sm:text-sm font-medium text-gray-700 mb-1",children:"Description *"}),a.jsx("textarea",{value:j.description,onChange:q=>B("description",q.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",rows:2,placeholder:"Brief description of the offer",required:!0})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs sm:text-sm font-medium text-gray-700 mb-1",children:"Discount Type"}),a.jsxs("select",{value:j.type,onChange:q=>B("type",q.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",children:[a.jsx("option",{value:"percentage_discount",children:"Percentage Discount"}),a.jsx("option",{value:"fixed_amount",children:"Fixed Amount Off"}),a.jsx("option",{value:"buy_x_get_y",children:"Buy X Get Y"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs sm:text-sm font-medium text-gray-700 mb-1",children:j.type==="percentage_discount"?"Percentage (%)":j.type==="fixed_amount"?"Amount ()":"Value"}),a.jsx("input",{type:"number",value:j.value,onChange:q=>B("value",parseFloat(q.target.value)||0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",min:"0",max:j.type==="percentage_discount"?100:void 0})]})]})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center justify-end gap-3 pt-4 border-t",children:[a.jsx("button",{type:"button",onClick:()=>{i(!1),s(!1)},className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50 text-sm sm:text-base",children:"Cancel"}),a.jsx("button",{type:"submit",disabled:o,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center text-sm sm:text-base",children:o?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent mr-2"}),"Creating..."]}):"Create Coupon"})]})]})]})})})})]})}):a.jsx("div",{children:"Loading..."})}class Ob{static getDefaultThresholds(){return[{id:"bronze",name:"Bronze Member",pointsRequired:0,benefits:["Welcome to loyalty program","Spin wheel access"],color:"#CD7F32",badgeIcon:"",description:"Start your loyalty journey with us!"},{id:"silver",name:"Silver Member",pointsRequired:100,benefits:["5% extra discount","Priority customer support","Birthday rewards"],color:"#C0C0C0",badgeIcon:"",description:"Enjoy enhanced benefits as a valued customer!"},{id:"gold",name:"Gold Member",pointsRequired:250,benefits:["10% extra discount","Free delivery","Exclusive offers","Early access to new items"],color:"#FFD700",badgeIcon:"",description:"Premium benefits for our loyal customers!"},{id:"platinum",name:"Platinum Member",pointsRequired:500,benefits:["15% extra discount","Free premium items","VIP customer support","Personal offers"],color:"#E5E4E2",badgeIcon:"",description:"The ultimate loyalty experience!"},{id:"diamond",name:"Diamond Member",pointsRequired:1e3,benefits:["20% extra discount","Complimentary items","VIP events access","Personal account manager"],color:"#B9F2FF",badgeIcon:"",description:"Elite status with exceptional rewards!"}]}static getDefaultPointsConfig(){return{enabled:!0,pointsPerSpin:10,thresholds:this.getDefaultThresholds(),resetPeriod:"never"}}static async awardSpinPoints(e,r,s,n){try{const i=Rt(st,`restaurants/${e}/customers`,r);if(!(await Kr(i)).exists())return console.warn(`Customer ${r} not found in restaurant ${e}. Points cannot be awarded to non-existent customer.`),{success:!1,error:"Customer not found. Cannot award points to non-existent customer."};const l=jl(st);l.update(i,{loyaltyPoints:dte(n),updatedAt:wt.fromDate(new Date)});const c=Rt(Jt(st,`restaurants/${e}/pointsTransactions`)),d={customerId:r,restaurantId:e,type:"earned",points:n,source:"spin_wheel",sourceId:s,description:`Earned ${n} points from spin wheel`,createdAt:new Date};return l.set(c,{...d,createdAt:wt.fromDate(d.createdAt)}),await l.commit(),await this.updateCustomerThreshold(e,r),{success:!0,message:`Awarded ${n} points successfully`}}catch(i){return console.error("Error awarding spin points:",i),{success:!1,error:i instanceof Error?i.message:"Failed to award points"}}}static async updateCustomerThreshold(e,r){try{const s=Rt(st,`restaurants/${e}/customers`,r),n=await Kr(s);if(!n.exists())return;const i=n.data(),o=i.loyaltyPoints||0,l=Zt(Jt(st,`restaurants/${e}/spinWheels`),Yt("isActive","==",!0),Yt("pointsConfig.enabled","==",!0),Wi(1)),c=await ur(l);if(c.empty)return;const A=c.docs[0].data().pointsConfig.thresholds.filter(f=>o>=f.pointsRequired).sort((f,p)=>p.pointsRequired-f.pointsRequired),h=A.length>0?A[0].id:null;h!==i.currentThresholdId&&await Xr(s,{currentThresholdId:h,updatedAt:wt.fromDate(new Date)})}catch(s){console.error("Error updating customer threshold:",s)}}static async getCustomerLoyaltyInfo(e,r){try{const s=Rt(st,`restaurants/${e}/customers`,r),n=await Kr(s);if(!n.exists())return{success:!1,error:"Customer not found"};const i=n.data(),o=i.loyaltyPoints||0,l=Zt(Jt(st,`restaurants/${e}/spinWheels`),Yt("isActive","==",!0),Yt("pointsConfig.enabled","==",!0),Wi(1)),c=await ur(l);if(c.empty)return{success:!1,error:"No active points program found"};const A=c.docs[0].data().pointsConfig.thresholds.sort((T,j)=>T.pointsRequired-j.pointsRequired),h=A.filter(T=>o>=T.pointsRequired).sort((T,j)=>j.pointsRequired-T.pointsRequired)[0]||A[0],f=A.find(T=>T.pointsRequired>o)||null;let p=0,m=0;if(f){const T=(h==null?void 0:h.pointsRequired)||0,j=f.pointsRequired-T,C=o-T;p=Math.min(100,C/j*100),m=f.pointsRequired-o}const g=Zt(Jt(st,`restaurants/${e}/customerSpins`),Yt("customerId","==",r)),y=await ur(g),v=y.size,x=y.docs.reduce((T,j)=>{const C=j.data();return T+(C.pointsEarned||0)},0);return{success:!0,data:{currentPoints:o,currentThreshold:h,nextThreshold:f,progressToNext:p,pointsToNext:m,totalSpins:v,totalPointsEarned:x,memberSince:i.createdAt instanceof Date?i.createdAt:new Date}}}catch(s){return console.error("Error getting customer loyalty info:",s),{success:!1,error:s instanceof Error?s.message:"Failed to get loyalty info"}}}static async getCustomerPointsHistory(e,r,s=50){try{const n=Zt(Jt(st,`restaurants/${e}/pointsTransactions`),Yt("customerId","==",r),On("createdAt","desc"),Wi(s));return{success:!0,data:(await ur(n)).docs.map(l=>{var d;const c=l.data();return{id:l.id,...c,createdAt:((d=c.createdAt)==null?void 0:d.toDate())||new Date}})}}catch(n){return console.error("Error getting points history:",n),{success:!1,error:n instanceof Error?n.message:"Failed to get points history"}}}static async getLoyaltyAnalytics(e){try{const r=Zt(Jt(st,`restaurants/${e}/customers`),Yt("loyaltyPoints",">",0)),s=await ur(r),n=Zt(Jt(st,`restaurants/${e}/pointsTransactions`),On("createdAt","desc"),Wi(20)),o=(await ur(n)).docs.map(u=>{var h;const A=u.data();return{id:u.id,...A,createdAt:((h=A.createdAt)==null?void 0:h.toDate())||new Date}});let l=0;const c={};return s.docs.forEach(u=>{const A=u.data();l+=A.loyaltyPoints||0;const h=A.currentThresholdId||"bronze";c[h]=(c[h]||0)+1}),{success:!0,data:{totalCustomersInProgram:s.size,totalPointsAwarded:l,averagePointsPerCustomer:s.size>0?l/s.size:0,thresholdDistribution:c,recentActivity:o}}}catch(r){return console.error("Error getting loyalty analytics:",r),{success:!1,error:r instanceof Error?r.message:"Failed to get analytics"}}}}const OQ=Object.freeze(Object.defineProperty({__proto__:null,LoyaltyPointsService:Ob},Symbol.toStringTag,{value:"Module"}));function Vpe(){const{restaurant:t}=js(),[e,r]=R.useState([]),[s,n]=R.useState(null),[i,o]=R.useState(null),[l,c]=R.useState(!0),[d,u]=R.useState(!1),[A,h]=R.useState(!1),[f,p]=R.useState(!1),[m,g]=R.useState([]),[y,v]=R.useState([]),[x,E]=R.useState([]),[T,j]=R.useState(Ob.getDefaultThresholds()),{register:C,handleSubmit:w,reset:S,formState:{errors:F}}=nn({defaultValues:{maxSpinsPerCustomer:3,requiresContactInfo:!0,termsAndConditions:"Terms and conditions apply. Up to 3 spins per customer per day. Offers cannot be combined with other promotions.",enablePoints:!0,pointsPerSpin:10,resetPeriod:"never"}});R.useEffect(()=>{t&&B()},[t]);const B=async()=>{if(t)try{c(!0);const ee=await Ra.getSpinWheelsForRestaurant(t.id);if(ee.success&&ee.data){if(r(ee.data),ee.data.some(ue=>ue.shareableLink.includes("pos.")||ue.shareableLink.includes("admin.")||ue.shareableLink.includes("tenversemedia"))){console.log("Found spin wheels with incorrect domain links, fixing automatically...");try{const ue=await Ra.fixSpinWheelShareableLinks(t.id);if(ue.success&&ue.data&&ue.data>0){const Ie=await Ra.getSpinWheelsForRestaurant(t.id);Ie.success&&Ie.data&&r(Ie.data),console.log(`Auto-fixed ${ue.data} spin wheel links`)}}catch(ue){console.warn("Could not auto-fix spin wheel links:",ue)}}}else Z.error(ee.error||"Failed to load spin wheels")}catch{Z.error("Failed to load spin wheels")}finally{c(!1)}},k=async ee=>{if(t)try{const de={enabled:ee.enablePoints,pointsPerSpin:ee.pointsPerSpin,thresholds:T,resetPeriod:ee.resetPeriod},ue={name:ee.name,maxSpinsPerCustomer:ee.maxSpinsPerCustomer,requiresContactInfo:ee.requiresContactInfo,termsAndConditions:ee.termsAndConditions,restaurantId:t.id,isActive:!0,segments:y,pointsConfig:de},Ie=await Ra.createSpinWheel(t.id,ue);Ie.success?(Z.success("Spin wheel created successfully!"),u(!1),v([]),j(Ob.getDefaultThresholds()),S(),B()):Z.error(Ie.error||"Failed to create spin wheel")}catch{Z.error("Failed to create spin wheel")}},D=async ee=>{if(!(!t||!s))try{const de={enabled:ee.enablePoints,pointsPerSpin:ee.pointsPerSpin,thresholds:x,resetPeriod:ee.resetPeriod},ue={name:ee.name,maxSpinsPerCustomer:ee.maxSpinsPerCustomer,requiresContactInfo:ee.requiresContactInfo,termsAndConditions:ee.termsAndConditions,segments:m,pointsConfig:de},Ie=await Ra.updateSpinWheel(t.id,s.id,ue);Ie.success?(Z.success("Spin wheel updated successfully!"),h(!1),n(null),g([]),E([]),B()):Z.error(Ie.error||"Failed to update spin wheel")}catch{Z.error("Failed to update spin wheel")}},q=async ee=>{if(t&&confirm("Are you sure you want to delete this spin wheel? This action cannot be undone."))try{const de=await Ra.deleteSpinWheel(t.id,ee);de.success?(Z.success("Spin wheel deleted successfully"),B()):Z.error(de.error||"Failed to delete spin wheel")}catch{Z.error("Failed to delete spin wheel")}},te=async ee=>{if(t)try{const de=await Ra.updateSpinWheel(t.id,ee.id,{isActive:!ee.isActive});de.success?(Z.success(`Spin wheel ${ee.isActive?"deactivated":"activated"}`),B()):Z.error(de.error||"Failed to update spin wheel")}catch{Z.error("Failed to update spin wheel")}},W=async ee=>{if(t)try{const de=await Ra.getSpinWheelStats(t.id,ee.id);de.success&&de.data?(o(de.data),n(ee),p(!0)):Z.error(de.error||"Failed to load stats")}catch{Z.error("Failed to load stats")}},Q=ee=>{navigator.clipboard.writeText(ee),Z.success("Link copied to clipboard!")},re=async()=>{if(t)try{const ee=await Ra.fixSpinWheelShareableLinks(t.id);ee.success?(Z.success(ee.message||`Fixed ${ee.data} spin wheel links`),B()):Z.error(ee.error||"Failed to fix spin wheel links")}catch{Z.error("Failed to fix spin wheel links")}},G=ee=>{var de,ue,Ie,Y;n(ee),g([...ee.segments]),E(((de=ee.pointsConfig)==null?void 0:de.thresholds)||Ob.getDefaultThresholds()),S({name:ee.name,maxSpinsPerCustomer:ee.maxSpinsPerCustomer,requiresContactInfo:ee.requiresContactInfo,termsAndConditions:ee.termsAndConditions,enablePoints:((ue=ee.pointsConfig)==null?void 0:ue.enabled)||!1,pointsPerSpin:((Ie=ee.pointsConfig)==null?void 0:Ie.pointsPerSpin)||10,resetPeriod:((Y=ee.pointsConfig)==null?void 0:Y.resetPeriod)||"never"}),h(!0)},Ae=(ee,de,ue)=>{const Ie=[...m];Ie[ee]={...Ie[ee],[de]:ue},g(Ie)},he=(ee,de,ue)=>{const Ie=[...y];Ie[ee]={...Ie[ee],[de]:ue},v(Ie)},I=(ee,de,ue)=>{const Ie=[...T];Ie[ee]={...Ie[ee],[de]:ue},j(Ie)},U=(ee,de,ue)=>{const Ie=[...x];Ie[ee]={...Ie[ee],[de]:ue},E(Ie)},V=()=>{const de={id:`custom_${Date.now()}`,name:"New Level",pointsRequired:100,benefits:["Custom benefit"],color:"#808080",badgeIcon:"",description:"Custom loyalty level"};j([...T,de])},L=ee=>{if(T.length>1){const de=T.filter((ue,Ie)=>Ie!==ee);j(de)}},K=()=>{const de={id:`custom_${Date.now()}`,name:"New Level",pointsRequired:100,benefits:["Custom benefit"],color:"#808080",badgeIcon:"",description:"Custom loyalty level"};E([...x,de])},fe=ee=>{if(x.length>1){const de=x.filter((ue,Ie)=>Ie!==ee);E(de)}};return t?a.jsxs("div",{className:"min-h-screen",style:{background:"var(--color-background)"},children:[a.jsx("header",{className:"bg-white shadow-sm border-b border-gray-200",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[a.jsxs("div",{children:[a.jsxs("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900 flex items-center",children:[a.jsx(sB,{className:"w-6 h-6 sm:w-8 sm:h-8 mr-2 sm:mr-3 text-purple-600"}),"Gamification Dashboard"]}),a.jsx("p",{className:"text-sm sm:text-base text-gray-600 mt-1",children:"Engage customers with interactive spin wheel games and loyalty rewards"})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-2 sm:gap-3",children:[e.some(ee=>ee.shareableLink.includes("pos.")||ee.shareableLink.includes("admin.")||ee.shareableLink.includes("tenversemedia"))&&a.jsxs("button",{onClick:re,className:"px-3 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 transition-colors flex items-center justify-center space-x-2 text-sm",children:[a.jsx(Di,{className:"w-4 h-4"}),a.jsx("span",{className:"hidden sm:inline",children:"Fix Links"}),a.jsx("span",{className:"sm:hidden",children:"Fix"})]}),a.jsxs("button",{onClick:()=>{console.log("Create button clicked"),v(Ra.getDefaultSegments()),u(!0)},className:"px-3 py-2 sm:px-4 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center justify-center space-x-2 text-sm sm:text-base",children:[a.jsx(zr,{className:"w-4 h-4"}),a.jsx("span",{children:"Create Spin Wheel"})]})]})]})})}),a.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 sm:py-8",children:[a.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-6 mb-6 sm:mb-8",children:[a.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-3 sm:p-6",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"p-2 sm:p-3 bg-blue-100 rounded-lg",children:a.jsx(GA,{className:"w-4 h-4 sm:w-6 sm:h-6 text-blue-600"})}),a.jsxs("div",{className:"ml-2 sm:ml-4 min-w-0 flex-1",children:[a.jsx("p",{className:"text-xs sm:text-sm text-gray-600 truncate",children:"Total Wheels"}),a.jsx("p",{className:"text-lg sm:text-2xl font-bold text-gray-900",children:e.length})]})]})}),a.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-3 sm:p-6",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"p-2 sm:p-3 bg-green-100 rounded-lg",children:a.jsx(Nr,{className:"w-4 h-4 sm:w-6 sm:h-6 text-green-600"})}),a.jsxs("div",{className:"ml-2 sm:ml-4 min-w-0 flex-1",children:[a.jsx("p",{className:"text-xs sm:text-sm text-gray-600 truncate",children:"Active Wheels"}),a.jsx("p",{className:"text-lg sm:text-2xl font-bold text-gray-900",children:e.filter(ee=>ee.isActive).length})]})]})}),a.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-3 sm:p-6",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"p-2 sm:p-3 bg-purple-100 rounded-lg",children:a.jsx(Ls,{className:"w-4 h-4 sm:w-6 sm:h-6 text-purple-600"})}),a.jsxs("div",{className:"ml-2 sm:ml-4 min-w-0 flex-1",children:[a.jsx("p",{className:"text-xs sm:text-sm text-gray-600 truncate",children:"Total Spins"}),a.jsx("p",{className:"text-lg sm:text-2xl font-bold text-gray-900",children:e.reduce((ee,de)=>ee+de.totalSpins,0)})]})]})}),a.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-3 sm:p-6",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"p-2 sm:p-3 bg-orange-100 rounded-lg",children:a.jsx(pA,{className:"w-4 h-4 sm:w-6 sm:h-6 text-orange-600"})}),a.jsxs("div",{className:"ml-2 sm:ml-4 min-w-0 flex-1",children:[a.jsx("p",{className:"text-xs sm:text-sm text-gray-600 truncate",children:"Redemptions"}),a.jsx("p",{className:"text-lg sm:text-2xl font-bold text-gray-900",children:e.reduce((ee,de)=>ee+de.totalRedemptions,0)})]})]})})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[a.jsxs("div",{className:"p-4 sm:p-6 border-b border-gray-200",children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Your Spin Wheels"}),a.jsx("p",{className:"text-gray-600 text-sm sm:text-base",children:"Manage your customer engagement games"})]}),l?a.jsxs("div",{className:"p-8 sm:p-12 text-center",children:[a.jsx(Di,{className:"w-6 h-6 sm:w-8 sm:h-8 text-gray-400 mx-auto mb-4 animate-spin"}),a.jsx("p",{className:"text-gray-600",children:"Loading spin wheels..."})]}):e.length===0?a.jsxs("div",{className:"p-8 sm:p-12 text-center",children:[a.jsx(GA,{className:"w-8 h-8 sm:w-12 sm:h-12 text-gray-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-base sm:text-lg font-medium text-gray-900 mb-2",children:"No Spin Wheels Yet"}),a.jsx("p",{className:"text-gray-600 mb-6 text-sm sm:text-base",children:"Create your first spin wheel to start engaging customers with fun rewards!"}),a.jsx("button",{onClick:()=>{console.log("Create first button clicked"),v(Ra.getDefaultSegments()),u(!0)},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm sm:text-base",children:"Create Your First Spin Wheel"})]}):a.jsx("div",{className:"divide-y divide-gray-200",children:e.map(ee=>a.jsx("div",{className:"p-4 sm:p-6",children:a.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-3",children:[a.jsx("h3",{className:"text-base sm:text-lg font-medium text-gray-900 truncate",children:ee.name}),a.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium self-start ${ee.isActive?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:ee.isActive?"Active":"Inactive"})]}),a.jsxs("div",{className:"mt-2 grid grid-cols-2 sm:flex sm:items-center gap-2 sm:gap-6 text-xs sm:text-sm text-gray-600",children:[a.jsxs("span",{className:"flex items-center",children:[a.jsx(Ls,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-1"}),ee.totalSpins," spins"]}),a.jsxs("span",{className:"flex items-center",children:[a.jsx(pA,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-1"}),ee.totalRedemptions," redeemed"]}),a.jsxs("span",{className:"hidden sm:inline",children:["Max ",ee.maxSpinsPerCustomer," per customer"]}),a.jsxs("span",{className:"hidden sm:inline",children:[ee.segments.length," segments"]})]}),a.jsx("div",{className:"mt-3 flex flex-col sm:flex-row sm:items-center gap-2",children:a.jsxs("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[a.jsx("code",{className:"text-xs bg-gray-100 px-2 py-1 rounded truncate flex-1 block overflow-hidden",children:ee.shareableLink}),a.jsx("button",{onClick:()=>Q(ee.shareableLink),className:"text-blue-600 hover:text-blue-800 flex-shrink-0",title:"Copy link",children:a.jsx(po,{className:"w-4 h-4"})}),a.jsx("a",{href:ee.shareableLink,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 flex-shrink-0",title:"Open in new tab",children:a.jsx(D0,{className:"w-4 h-4"})})]})})]}),a.jsxs("div",{className:"flex items-center justify-end gap-2 flex-shrink-0",children:[a.jsx("button",{onClick:()=>W(ee),className:"p-2 bg-gray-100 text-gray-600 rounded-lg hover:bg-gray-200 transition-colors",title:"View analytics",children:a.jsx(Sa,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>G(ee),className:"p-2 bg-gray-100 text-gray-600 rounded-lg hover:bg-gray-200 transition-colors",title:"Edit wheel",children:a.jsx(gc,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>te(ee),className:`p-2 rounded-lg transition-colors ${ee.isActive?"bg-red-100 text-red-600 hover:bg-red-200":"bg-green-100 text-green-600 hover:bg-green-200"}`,title:ee.isActive?"Deactivate":"Activate",children:ee.isActive?a.jsx(El,{className:"w-4 h-4"}):a.jsx(Zte,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>q(ee.id),className:"p-2 bg-red-100 text-red-600 rounded-lg hover:bg-red-200 transition-colors",title:"Delete wheel",children:a.jsx(Un,{className:"w-4 h-4"})})]})]})},ee.id))})]})]}),d&&a.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-5xl w-full max-h-[90vh] overflow-hidden",children:[a.jsxs("div",{className:"p-6 border-b border-gray-200",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Create New Spin Wheel"}),a.jsx("p",{className:"text-gray-600 mt-1",children:"Configure your wheel settings and customize each segment's offers"})]}),a.jsxs("form",{onSubmit:w(k),className:"overflow-y-auto max-h-[calc(90vh-140px)]",children:[a.jsxs("div",{className:"p-6 space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Wheel Name *"}),a.jsx("input",{type:"text",...C("name",{required:"Wheel name is required"}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., Weekend Special Rewards"}),F.name&&a.jsx("p",{className:"text-red-500 text-sm mt-1",children:F.name.message})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Max Spins Per Customer (Daily)"}),a.jsxs("select",{...C("maxSpinsPerCustomer"),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[a.jsx("option",{value:1,children:"1 spin per day"}),a.jsx("option",{value:2,children:"2 spins per day"}),a.jsx("option",{value:3,children:"3 spins per day"}),a.jsx("option",{value:0,children:"Unlimited"})]})]})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"checkbox",...C("requiresContactInfo"),className:"rounded border-gray-300"}),a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Require customer contact info before spinning"})]}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Collect phone number or email to build your customer database"})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Configure Your 8 Wheel Segments"}),a.jsx("div",{className:"text-sm text-gray-500",children:"Customize offers, colors, and win probability for each segment"})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:y.map((ee,de)=>a.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 bg-gray-50",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("h4",{className:"font-medium text-gray-900",children:["Segment ",de+1]}),a.jsx("div",{className:"w-8 h-8 rounded-full border-2 border-white shadow-sm",style:{backgroundColor:ee.color}})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Offer Title (appears on wheel)"}),a.jsx("input",{type:"text",value:ee.label,onChange:ue=>he(de,"label",ue.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., 10% Off, Free Drink"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Full Offer Description"}),a.jsx("textarea",{rows:2,value:ee.value,onChange:ue=>he(de,"value",ue.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., 10% discount on your next order"})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Color"}),a.jsx("input",{type:"color",value:ee.color,onChange:ue=>he(de,"color",ue.target.value),className:"w-full h-8 rounded border border-gray-300"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Win Chance"}),a.jsx("input",{type:"number",min:"1",max:"100",value:ee.probability,onChange:ue=>he(de,"probability",parseInt(ue.target.value)),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Type"}),a.jsxs("select",{value:ee.rewardType,onChange:ue=>he(de,"rewardType",ue.target.value),className:"w-full px-2 py-1 text-xs border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[a.jsx("option",{value:"discount_percentage",children:"% Off"}),a.jsx("option",{value:"discount_fixed",children:"$ Off"}),a.jsx("option",{value:"free_item",children:"Free Item"}),a.jsx("option",{value:"points",children:"Points"}),a.jsx("option",{value:"custom",children:"Custom"})]})]})]}),(ee.rewardType==="discount_percentage"||ee.rewardType==="discount_fixed")&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:ee.rewardType==="discount_percentage"?"Percentage (%)":"Amount ($)"}),a.jsx("input",{type:"number",step:ee.rewardType==="discount_percentage"?"1":"0.01",value:ee.rewardValue||0,onChange:ue=>he(de,"rewardValue",parseFloat(ue.target.value)),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:ee.rewardType==="discount_percentage"?"10":"5.00"})]}),a.jsxs("div",{className:"bg-yellow-50 p-3 rounded-lg border border-yellow-200",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"checkbox",id:`noCoupon-${de}`,checked:ee.noCoupon||!1,onChange:ue=>he(de,"noCoupon",ue.target.checked),className:"rounded border-gray-300 h-4 w-4 text-orange-600 focus:ring-orange-500"}),a.jsx("label",{htmlFor:`noCoupon-${de}`,className:"text-sm font-medium text-orange-800",children:"No Coupon (Try Again segment)"})]}),a.jsx("p",{className:"text-xs text-orange-600 mt-1",children:'Check this for "Try Again" or "Better Luck" segments where no coupon should be awarded'})]})]})]},ee.id))}),a.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg mt-4",children:[a.jsx("h4",{className:"text-sm font-medium text-blue-900 mb-2",children:" Pro Tips:"}),a.jsxs("ul",{className:"text-xs text-blue-800 space-y-1",children:[a.jsx("li",{children:" Higher win chances = more customers win = higher engagement"}),a.jsx("li",{children:" Mix high-value prizes (low chance) with small prizes (high chance)"}),a.jsx("li",{children:" Use bright, contrasting colors for better visibility"}),a.jsx("li",{children:' "Better Luck" segments create anticipation for return visits'})]})]})]}),a.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-blue-50 p-6 rounded-lg",children:[a.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[a.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:a.jsx(pA,{className:"w-5 h-5 text-purple-600"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Loyalty Points System"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Reward customers with points to build loyalty"})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("input",{type:"checkbox",...C("enablePoints"),className:"rounded border-gray-300 h-4 w-4 text-purple-600 focus:ring-purple-500"}),a.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Enable Points & Loyalty Levels"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Points Per Spin"}),a.jsx("input",{type:"number",min:"1",max:"100",...C("pointsPerSpin"),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"10"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Points awarded for each spin"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Points Reset Period"}),a.jsxs("select",{...C("resetPeriod"),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[a.jsx("option",{value:"never",children:"Never Reset"}),a.jsx("option",{value:"yearly",children:"Reset Yearly"}),a.jsx("option",{value:"monthly",children:"Reset Monthly"})]})]})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("h4",{className:"text-sm font-medium text-gray-900",children:"Loyalty Levels & Rewards"}),a.jsx("button",{type:"button",onClick:V,className:"text-xs px-2 py-1 bg-purple-100 text-purple-700 rounded hover:bg-purple-200 transition-colors",children:"Add Level"})]}),a.jsx("div",{className:"space-y-3 max-h-60 overflow-y-auto",children:T.map((ee,de)=>a.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("span",{className:"text-lg",children:ee.badgeIcon}),a.jsx("input",{type:"text",value:ee.name,onChange:ue=>I(de,"name",ue.target.value),className:"text-sm font-medium bg-transparent border-none focus:outline-none focus:ring-0 p-0",placeholder:"Level Name"})]}),T.length>1&&a.jsx("button",{type:"button",onClick:()=>L(de),className:"text-red-400 hover:text-red-600",children:a.jsx(Un,{className:"w-4 h-4"})})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Points Required"}),a.jsx("input",{type:"number",min:"0",value:ee.pointsRequired,onChange:ue=>I(de,"pointsRequired",parseInt(ue.target.value)),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Badge Color"}),a.jsx("input",{type:"color",value:ee.color,onChange:ue=>I(de,"color",ue.target.value),className:"w-full h-8 rounded border border-gray-300"})]})]}),a.jsxs("div",{className:"mt-3",children:[a.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Benefits (one per line)"}),a.jsx("textarea",{rows:2,value:ee.benefits.join(`
`),onChange:ue=>I(de,"benefits",ue.target.value.split(`
`).filter(Ie=>Ie.trim())),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:`5% discount
Priority support`})]})]},ee.id))})]}),a.jsxs("div",{className:"bg-purple-50 p-3 rounded-lg",children:[a.jsx("h5",{className:"text-xs font-medium text-purple-900 mb-1",children:" Points Strategy Tips:"}),a.jsxs("ul",{className:"text-xs text-purple-800 space-y-1",children:[a.jsx("li",{children:" Start with 10-20 points per spin for good engagement"}),a.jsx("li",{children:" Set achievable first level (50-100 points) for quick wins"}),a.jsx("li",{children:" Space out levels to maintain progression motivation"}),a.jsx("li",{children:" Offer meaningful benefits at each level"})]})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Terms & Conditions"}),a.jsx("textarea",{...C("termsAndConditions"),rows:3,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter terms and conditions for this promotion..."})]}),a.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[a.jsx("h3",{className:"text-sm font-medium text-green-900 mb-2",children:" Ready to Launch?"}),a.jsxs("ul",{className:"text-sm text-green-800 space-y-1",children:[a.jsx("li",{children:" Your spin wheel will be created with your custom segments"}),a.jsx("li",{children:" A unique shareable link will be generated automatically"}),a.jsx("li",{children:" Share via QR codes, social media, or directly with customers"}),a.jsx("li",{children:" Start tracking engagement and redemptions immediately!"})]})]})]}),a.jsxs("div",{className:"p-6 border-t border-gray-200 flex justify-end space-x-3",children:[a.jsx("button",{type:"button",onClick:()=>{u(!1),v([])},className:"px-6 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors",children:"Cancel"}),a.jsxs("button",{type:"submit",className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center",children:[a.jsx(sB,{className:"w-4 h-4 mr-2"}),"Create Spin Wheel"]})]})]})]})}),A&&s&&a.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-hidden",children:[a.jsxs("div",{className:"p-6 border-b border-gray-200",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Edit Spin Wheel"}),a.jsx("p",{className:"text-gray-600 mt-1",children:"Customize your spin wheel settings and segments"})]}),a.jsxs("form",{onSubmit:w(D),className:"overflow-y-auto max-h-[calc(90vh-140px)]",children:[a.jsxs("div",{className:"p-6 space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Wheel Name *"}),a.jsx("input",{type:"text",...C("name",{required:"Wheel name is required"}),className:"input"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Max Spins Per Customer (Daily)"}),a.jsxs("select",{...C("maxSpinsPerCustomer"),className:"input",children:[a.jsx("option",{value:1,children:"1 spin per day"}),a.jsx("option",{value:2,children:"2 spins per day"}),a.jsx("option",{value:3,children:"3 spins per day"}),a.jsx("option",{value:0,children:"Unlimited"})]})]})]}),a.jsx("div",{children:a.jsxs("label",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"checkbox",...C("requiresContactInfo"),className:"rounded border-gray-300"}),a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Require customer contact info"})]})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Configure Segments"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:m.map((ee,de)=>a.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("h4",{className:"font-medium text-gray-900",children:["Segment ",de+1]}),a.jsx("div",{className:"w-6 h-6 rounded-full border-2 border-gray-300",style:{backgroundColor:ee.color}})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Label"}),a.jsx("input",{type:"text",value:ee.label,onChange:ue=>Ae(de,"label",ue.target.value),className:"input text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Description"}),a.jsx("input",{type:"text",value:ee.value,onChange:ue=>Ae(de,"value",ue.target.value),className:"input text-sm"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Color"}),a.jsx("input",{type:"color",value:ee.color,onChange:ue=>Ae(de,"color",ue.target.value),className:"w-full h-8 rounded border border-gray-300"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Weight (1-100)"}),a.jsx("input",{type:"number",min:"1",max:"100",value:ee.probability,onChange:ue=>Ae(de,"probability",parseInt(ue.target.value)),className:"input text-sm"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Reward Type"}),a.jsxs("select",{value:ee.rewardType,onChange:ue=>Ae(de,"rewardType",ue.target.value),className:"input text-sm",children:[a.jsx("option",{value:"discount_percentage",children:"Percentage Discount"}),a.jsx("option",{value:"discount_fixed",children:"Fixed Amount Discount"}),a.jsx("option",{value:"free_item",children:"Free Item"}),a.jsx("option",{value:"points",children:"Loyalty Points"}),a.jsx("option",{value:"custom",children:"Custom Reward"})]})]}),(ee.rewardType==="discount_percentage"||ee.rewardType==="discount_fixed")&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:ee.rewardType==="discount_percentage"?"Percentage":"Amount"}),a.jsx("input",{type:"number",value:ee.rewardValue||0,onChange:ue=>Ae(de,"rewardValue",parseFloat(ue.target.value)),className:"input text-sm"})]}),a.jsxs("div",{className:"bg-yellow-50 p-3 rounded-lg border border-yellow-200",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"checkbox",id:`editNoCoupon-${de}`,checked:ee.noCoupon||!1,onChange:ue=>Ae(de,"noCoupon",ue.target.checked),className:"rounded border-gray-300 h-4 w-4 text-orange-600 focus:ring-orange-500"}),a.jsx("label",{htmlFor:`editNoCoupon-${de}`,className:"text-sm font-medium text-orange-800",children:"No Coupon (Try Again segment)"})]}),a.jsx("p",{className:"text-xs text-orange-600 mt-1",children:'Check this for "Try Again" or "Better Luck" segments where no coupon should be awarded'})]})]})]},ee.id))})]}),a.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-blue-50 p-6 rounded-lg",children:[a.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[a.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:a.jsx(pA,{className:"w-5 h-5 text-purple-600"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Loyalty Points System"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Manage customer loyalty and engagement"})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("input",{type:"checkbox",...C("enablePoints"),className:"rounded border-gray-300 h-4 w-4 text-purple-600 focus:ring-purple-500"}),a.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Enable Points & Loyalty Levels"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Points Per Spin"}),a.jsx("input",{type:"number",min:"1",max:"100",...C("pointsPerSpin"),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Points Reset Period"}),a.jsxs("select",{...C("resetPeriod"),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[a.jsx("option",{value:"never",children:"Never Reset"}),a.jsx("option",{value:"yearly",children:"Reset Yearly"}),a.jsx("option",{value:"monthly",children:"Reset Monthly"})]})]})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("h4",{className:"text-sm font-medium text-gray-900",children:"Loyalty Levels & Rewards"}),a.jsx("button",{type:"button",onClick:K,className:"text-xs px-2 py-1 bg-purple-100 text-purple-700 rounded hover:bg-purple-200 transition-colors",children:"Add Level"})]}),a.jsx("div",{className:"space-y-3 max-h-60 overflow-y-auto",children:x.map((ee,de)=>a.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("span",{className:"text-lg",children:ee.badgeIcon}),a.jsx("input",{type:"text",value:ee.name,onChange:ue=>U(de,"name",ue.target.value),className:"text-sm font-medium bg-transparent border-none focus:outline-none focus:ring-0 p-0"})]}),x.length>1&&a.jsx("button",{type:"button",onClick:()=>fe(de),className:"text-red-400 hover:text-red-600",children:a.jsx(Un,{className:"w-4 h-4"})})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Points Required"}),a.jsx("input",{type:"number",min:"0",value:ee.pointsRequired,onChange:ue=>U(de,"pointsRequired",parseInt(ue.target.value)),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Badge Color"}),a.jsx("input",{type:"color",value:ee.color,onChange:ue=>U(de,"color",ue.target.value),className:"w-full h-8 rounded border border-gray-300"})]})]}),a.jsxs("div",{className:"mt-3",children:[a.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Benefits (one per line)"}),a.jsx("textarea",{rows:2,value:ee.benefits.join(`
`),onChange:ue=>U(de,"benefits",ue.target.value.split(`
`).filter(Ie=>Ie.trim())),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]})]},ee.id))})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Terms & Conditions"}),a.jsx("textarea",{...C("termsAndConditions"),rows:3,className:"input"})]})]}),a.jsxs("div",{className:"p-6 border-t border-gray-200 flex justify-end space-x-3",children:[a.jsx("button",{type:"button",onClick:()=>h(!1),className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors",children:"Cancel"}),a.jsxs("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center",children:[a.jsx(au,{className:"w-4 h-4 mr-2"}),"Save Changes"]})]})]})]})}),f&&s&&i&&a.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-hidden",children:[a.jsxs("div",{className:"p-6 border-b border-gray-200",children:[a.jsxs("h2",{className:"text-xl font-semibold text-gray-900",children:[s.name," - Analytics"]}),a.jsx("p",{className:"text-gray-600 mt-1",children:"Performance insights and customer engagement metrics"})]}),a.jsxs("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-140px)]",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-3xl font-bold text-blue-600",children:i.totalSpins}),a.jsx("div",{className:"text-sm text-gray-600",children:"Total Spins"})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-3xl font-bold text-green-600",children:i.totalRedemptions}),a.jsx("div",{className:"text-sm text-gray-600",children:"Redeemed"})]}),a.jsxs("div",{className:"text-center",children:[a.jsxs("div",{className:"text-3xl font-bold text-purple-600",children:[i.redemptionRate.toFixed(1),"%"]}),a.jsx("div",{className:"text-sm text-gray-600",children:"Redemption Rate"})]}),a.jsxs("div",{className:"text-center",children:[a.jsxs("div",{className:"text-3xl font-bold text-orange-600",children:[i.customerEngagement.toFixed(1),"%"]}),a.jsx("div",{className:"text-sm text-gray-600",children:"Engagement"})]})]}),a.jsxs("div",{className:"mb-8",children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Most Popular Segments"}),a.jsx("div",{className:"space-y-3",children:i.popularSegments.slice(0,5).map((ee,de)=>a.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsxs("span",{className:"text-sm font-medium text-gray-900",children:["#",de+1]}),a.jsx("span",{className:"text-sm text-gray-900",children:ee.label})]}),a.jsxs("div",{className:"text-sm font-medium text-gray-600",children:[ee.count," spins"]})]},ee.segmentId))})]})]}),a.jsx("div",{className:"p-6 border-t border-gray-200 flex justify-end",children:a.jsx("button",{onClick:()=>p(!1),className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors",children:"Close"})})]})})]}):a.jsx("div",{children:"Loading..."})}function Hpe(){const t=Li(),{restaurant:e}=js(),[r,s]=R.useState([]),[n,i]=R.useState([]),[o,l]=R.useState(!0),[c,d]=R.useState(""),[u,A]=R.useState("all"),[h,f]=R.useState(!1),[p,m]=R.useState(null),[g,y]=R.useState(""),[v,x]=R.useState("cash"),[E,T]=R.useState(""),[j,C]=R.useState(!1);R.useEffect(()=>{e!=null&&e.id&&w()},[e==null?void 0:e.id]),R.useEffect(()=>{let Q=r;c&&(Q=Q.filter(re=>{var G;return re.customerName.toLowerCase().includes(c.toLowerCase())||((G=re.customerPhone)==null?void 0:G.includes(c))||re.orderId.includes(c)||re.tableNumber.includes(c)})),u!=="all"&&(Q=Q.filter(re=>re.status===u)),i(Q)},[r,c,u]);const w=async()=>{if(e!=null&&e.id)try{l(!0);const Q=await Mf.getCreditTransactions(e.id);Q.success&&Q.data?s(Q.data):Z.error("Failed to load credits")}catch(Q){console.error("Error loading credits:",Q),Z.error("Failed to load credits")}finally{l(!1)}},S=async()=>{if(!p||!g)return;const Q=parseFloat(g);if(Q<=0){Z.error("Please enter a valid payment amount");return}const re=F(p);if(Q>re){Z.error(`Payment amount cannot exceed remaining credit of ${Ue(re)}`);return}try{C(!0);const G=await Mf.makePayment(p.id,Q,v,E);G.success?(Z.success(`Payment of ${Ue(Q)} recorded successfully`),f(!1),m(null),y(""),T(""),w()):Z.error(G.error||"Failed to process payment")}catch(G){console.error("Error processing payment:",G),Z.error("Failed to process payment")}finally{C(!1)}},F=Q=>{const re=Q.amountReceived+(Q.paymentHistory||[]).reduce((G,Ae)=>G+Ae.amount,0);return Q.totalAmount-re},B=Q=>{switch(Q){case"pending":return a.jsx(Ys,{className:"w-4 h-4 text-yellow-500"});case"partially_paid":return a.jsx(oi,{className:"w-4 h-4 text-orange-500"});case"paid":return a.jsx(Nr,{className:"w-4 h-4 text-green-500"});default:return a.jsx(Ys,{className:"w-4 h-4 text-gray-500"})}},k=Q=>{switch(Q){case"pending":return"bg-yellow-50 text-yellow-700 border-yellow-200";case"partially_paid":return"bg-orange-50 text-orange-700 border-orange-200";case"paid":return"bg-green-50 text-green-700 border-green-200";default:return"bg-gray-50 text-gray-700 border-gray-200"}},D=n.filter(Q=>Q.status!=="paid").reduce((Q,re)=>Q+F(re),0),q=n.length,te=n.filter(Q=>Q.status==="pending").length,W=n.filter(Q=>Q.status==="partially_paid").length;return e?a.jsx("div",{className:"min-h-screen",style:{background:"var(--color-background)"},children:a.jsxs("main",{className:"max-w-7xl mx-auto px-3 sm:px-4 lg:px-6 xl:px-8 py-4 sm:py-6 lg:py-8",children:[a.jsx("div",{className:"mb-8",children:a.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[a.jsxs("div",{className:"min-w-0 flex-1",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx("button",{onClick:()=>t(-1),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsx(Jo,{className:"w-5 h-5"})}),a.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"Credit Management"})]}),a.jsx("p",{className:"text-gray-600",children:"Manage customer credits and payments"})]}),a.jsx("div",{className:"flex items-center gap-3",children:a.jsx("button",{onClick:w,disabled:o,className:"p-2 text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",title:"Refresh credits",children:a.jsx(Di,{className:`w-5 h-5 ${o?"animate-spin":""}`})})})]})}),a.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3 sm:gap-4 mb-8",children:[a.jsxs("div",{className:"card p-3 sm:p-4 text-center",children:[a.jsx("div",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:q}),a.jsx("div",{className:"text-xs sm:text-sm text-gray-600",children:"Total Credits"})]}),a.jsxs("div",{className:"card p-3 sm:p-4 text-center",children:[a.jsx("div",{className:"text-xl sm:text-2xl font-bold text-yellow-600",children:te}),a.jsx("div",{className:"text-xs sm:text-sm text-gray-600",children:"Pending"})]}),a.jsxs("div",{className:"card p-3 sm:p-4 text-center",children:[a.jsx("div",{className:"text-xl sm:text-2xl font-bold text-orange-600",children:W}),a.jsx("div",{className:"text-xs sm:text-sm text-gray-600",children:"Partial"})]}),a.jsxs("div",{className:"card p-3 sm:p-4 text-center",children:[a.jsx("div",{className:"text-xl sm:text-2xl font-bold text-red-600",children:Ue(D)}),a.jsx("div",{className:"text-xs sm:text-sm text-gray-600",children:"Amount Due"})]})]}),a.jsx("div",{className:"card p-4 mb-6",children:a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[a.jsx("div",{className:"flex-1",children:a.jsxs("div",{className:"relative",children:[a.jsx(sn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),a.jsx("input",{type:"text",value:c,onChange:Q=>d(Q.target.value),placeholder:"Search by customer name, phone, order ID, or table...",className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})}),a.jsx("div",{className:"sm:w-48",children:a.jsxs("select",{value:u,onChange:Q=>A(Q.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"all",children:"All Status"}),a.jsx("option",{value:"pending",children:"Pending"}),a.jsx("option",{value:"partially_paid",children:"Partially Paid"}),a.jsx("option",{value:"paid",children:"Paid"})]})})]})}),o?a.jsxs("div",{className:"text-center py-12",children:[a.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Loading credits..."})]}):n.length===0?a.jsxs("div",{className:"text-center py-12",children:[a.jsx(No,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:c||u!=="all"?"No credits found":"No credits yet"}),a.jsx("p",{className:"text-gray-600",children:c||u!=="all"?"Try adjusting your search or filter criteria.":"Credits will appear here when customers make partial payments."})]}):a.jsx("div",{className:"space-y-4",children:n.map(Q=>{const re=F(Q),G=Q.amountReceived+(Q.paymentHistory||[]).reduce((Ae,he)=>Ae+he.amount,0);return a.jsx("div",{className:"card p-4 sm:p-6",children:a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[B(Q.status),a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium border ${k(Q.status)}`,children:Q.status.replace("_"," ").toUpperCase()})]}),a.jsx("span",{className:"text-sm text-gray-500",children:Q.createdAt.toDate().toLocaleDateString()})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 text-sm",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-1 text-gray-600 mb-1",children:[a.jsx(Hs,{className:"w-3 h-3"}),a.jsx("span",{children:"Customer"})]}),a.jsx("div",{className:"font-medium",children:Q.customerName}),Q.customerPhone&&a.jsx("div",{className:"text-gray-500 text-xs",children:Q.customerPhone})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-gray-600 mb-1",children:"Table & Order"}),a.jsxs("div",{className:"font-medium",children:["Table ",Q.tableNumber]}),a.jsxs("div",{className:"text-gray-500 text-xs",children:["Order: ",Q.orderId]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-gray-600 mb-1",children:"Payment Details"}),a.jsxs("div",{className:"font-medium",children:[Ue(Q.totalAmount)," total"]}),a.jsxs("div",{className:"text-green-600 text-xs",children:[Ue(G)," paid"]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-gray-600 mb-1",children:"Remaining"}),a.jsx("div",{className:"font-bold text-red-600",children:Ue(re)}),a.jsx("div",{className:"text-gray-500 text-xs capitalize",children:Q.paymentMethod})]})]}),Q.paymentHistory&&Q.paymentHistory.length>0&&a.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-200",children:[a.jsx("div",{className:"text-xs text-gray-600 mb-2",children:"Payment History:"}),a.jsx("div",{className:"space-y-1",children:Q.paymentHistory.map(Ae=>a.jsxs("div",{className:"flex justify-between text-xs",children:[a.jsxs("span",{children:[Ae.paidAt.toDate().toLocaleDateString()," - ",Ae.paymentMethod]}),a.jsx("span",{className:"font-medium",children:Ue(Ae.amount)})]},Ae.id))})]})]}),Q.status!=="paid"&&a.jsx("div",{className:"flex gap-2",children:a.jsxs("button",{onClick:()=>{m(Q),y(re.toString()),f(!0)},className:"btn btn-theme-primary text-sm px-4 py-2",children:[a.jsx(hn,{className:"w-4 h-4 mr-1"}),"Pay"]})})]})},Q.id)})}),h&&p&&a.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:a.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[a.jsx("div",{className:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75",onClick:()=>f(!1)}),a.jsxs("div",{className:"inline-block w-full max-w-md my-8 overflow-hidden text-left align-middle transition-all transform bg-white shadow-xl rounded-2xl",children:[a.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Record Payment"}),a.jsx("button",{onClick:()=>f(!1),className:"text-gray-400 hover:text-gray-600",children:a.jsx(qr,{className:"w-6 h-6"})})]}),a.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Payment for ",p.customerName]})]}),a.jsxs("div",{className:"px-6 py-4 space-y-4",children:[a.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:a.jsxs("div",{className:"text-sm space-y-1",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Total Amount:"}),a.jsx("span",{className:"font-medium",children:Ue(p.totalAmount)})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Already Paid:"}),a.jsx("span",{className:"text-green-600",children:Ue(p.amountReceived+(p.paymentHistory||[]).reduce((Q,re)=>Q+re.amount,0))})]}),a.jsxs("div",{className:"flex justify-between font-bold border-t pt-1",children:[a.jsx("span",{children:"Remaining:"}),a.jsx("span",{className:"text-red-600",children:Ue(F(p))})]})]})}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Payment Amount"}),a.jsx("input",{type:"number",value:g,onChange:Q=>y(Q.target.value),max:F(p),min:"0",step:"0.01",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter payment amount"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Payment Method"}),a.jsxs("select",{value:v,onChange:Q=>x(Q.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"cash",children:"Cash"}),a.jsx("option",{value:"upi",children:"UPI"}),a.jsx("option",{value:"bank",children:"Bank Transfer"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes (Optional)"}),a.jsx("textarea",{value:E,onChange:Q=>T(Q.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Add any notes about this payment..."})]})]}),a.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 flex justify-between items-center",children:[a.jsx("button",{onClick:()=>f(!1),className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200",children:"Cancel"}),a.jsx("button",{onClick:S,disabled:j||!g||parseFloat(g)<=0,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:j?"Processing...":"Record Payment"})]})]})]})})]})}):a.jsx("div",{children:"Loading..."})}function $pe({}){var L;const{restaurant:t}=js(),{user:e}=ia(),[r,s]=R.useState([]),[n,i]=R.useState(!0),[o,l]=R.useState("overview"),[c,d]=R.useState(!1),[u,A]=R.useState(null),[h,f]=R.useState(""),[p,m]=R.useState("all"),[g,y]=R.useState("all"),[v,x]=R.useState(null),[E,T]=R.useState([]),[j,C]=R.useState([]),[w,S]=R.useState([]),[F,B]=R.useState({start:new Date(Date.now()-30*24*60*60*1e3),end:new Date});R.useEffect(()=>{t&&(k(),D())},[t]);const k=async()=>{if(t){i(!0);try{const K=await qn.getEmployees(t.id);K.success&&K.data?s(K.data):Z.error(K.error||"Failed to fetch employees")}catch(K){console.error("Error fetching employees:",K),Z.error("Failed to fetch employees")}finally{i(!1)}}},D=async()=>{if(t)try{const K=await qn.getAllEmployeesPerformance(t.id,F);K.success&&K.data&&T(K.data)}catch(K){console.error("Error fetching performance data:",K)}},q=async K=>{if(t)try{const fe=await qn.getEmployeeActivity(K,t.id);fe.success&&fe.data&&S(fe.data)}catch(fe){console.error("Error fetching activity data:",fe)}},te=async K=>{var fe;if(!(!t||!e))try{const ee=await qn.createEmployee(t.id,e.id,K);ee.success?(Z.success("Employee created successfully"),d(!1),k(),await qn.logEmployeeActivity(((fe=ee.data)==null?void 0:fe.id)||"",t.id,"employee_created",{createdBy:e.name,employeeName:K.name})):Z.error(ee.error||"Failed to create employee")}catch(ee){console.error("Error creating employee:",ee),Z.error("Failed to create employee")}},W=async(K,fe)=>{try{const ee=await qn.updateEmployee(K,fe);ee.success?(Z.success("Employee updated successfully"),A(null),k(),t&&await qn.logEmployeeActivity(K,t.id,"employee_updated",{updatedBy:e==null?void 0:e.name,changes:Object.keys(fe)})):Z.error(ee.error||"Failed to update employee")}catch(ee){console.error("Error updating employee:",ee),Z.error("Failed to update employee")}},Q=async K=>{if(confirm("Are you sure you want to delete this employee?"))try{const fe=await qn.deleteEmployee(K);fe.success?(Z.success("Employee deleted successfully"),k(),t&&await qn.logEmployeeActivity(K,t.id,"employee_deleted",{deletedBy:e==null?void 0:e.name})):Z.error(fe.error||"Failed to delete employee")}catch(fe){console.error("Error deleting employee:",fe),Z.error("Failed to delete employee")}},re=async K=>{if(t)try{const fe=await qn.clockIn(K,t.id);fe.success?Z.success("Employee clocked in successfully"):Z.error(fe.error||"Failed to clock in")}catch(fe){console.error("Error clocking in:",fe),Z.error("Failed to clock in")}},G=async K=>{var fe,ee;if(t)try{const de=await qn.clockOut(K,t.id);de.success?Z.success(`Employee clocked out. Total hours: ${((ee=(fe=de.data)==null?void 0:fe.totalHours)==null?void 0:ee.toFixed(2))||0}`):Z.error(de.error||"Failed to clock out")}catch(de){console.error("Error clocking out:",de),Z.error("Failed to clock out")}},Ae=async K=>{await W(K.id,{isActive:!K.isActive})},he=r.filter(K=>{const fe=K.name.toLowerCase().includes(h.toLowerCase())||K.email.toLowerCase().includes(h.toLowerCase()),ee=p==="all"||K.role===p,de=g==="all"||g==="active"&&K.isActive||g==="inactive"&&!K.isActive;return fe&&ee&&de}),I=K=>K.permissions.filter(fe=>fe.access).length,V=(()=>{const K=r.length,fe=r.filter(ue=>ue.isActive).length,ee=r.filter(ue=>ue.role==="manager").length,de=r.filter(ue=>ue.role==="staff").length;return{totalEmployees:K,activeEmployees:fe,managers:ee,staff:de}})();return n?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs("h2",{className:"text-3xl font-bold text-gray-900 flex items-center",children:[a.jsx(Ls,{className:"w-8 h-8 mr-3 text-blue-600"}),"Employee Management"]}),a.jsx("p",{className:"text-gray-600 mt-2",children:"Comprehensive staff management with performance tracking and analytics"})]}),a.jsxs("button",{onClick:()=>d(!0),className:"btn btn-theme-primary flex items-center text-white px-6 py-3 rounded-lg shadow-lg hover:shadow-xl transition-all",children:[a.jsx(L0,{className:"w-5 h-5 mr-2"}),"Add Employee"]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[a.jsx("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Employees"}),a.jsx("p",{className:"text-3xl font-bold text-gray-900",children:V.totalEmployees})]}),a.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:a.jsx(Ls,{className:"w-6 h-6 text-blue-600"})})]})}),a.jsx("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Active Staff"}),a.jsx("p",{className:"text-3xl font-bold text-green-600",children:V.activeEmployees})]}),a.jsx("div",{className:"p-3 bg-green-100 rounded-lg",children:a.jsx(AM,{className:"w-6 h-6 text-green-600"})})]})}),a.jsx("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Managers"}),a.jsx("p",{className:"text-3xl font-bold text-purple-600",children:V.managers})]}),a.jsx("div",{className:"p-3 bg-purple-100 rounded-lg",children:a.jsx(Co,{className:"w-6 h-6 text-purple-600"})})]})}),a.jsx("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Staff Members"}),a.jsx("p",{className:"text-3xl font-bold text-orange-600",children:V.staff})]}),a.jsx("div",{className:"p-3 bg-orange-100 rounded-lg",children:a.jsx(Rte,{className:"w-6 h-6 text-orange-600"})})]})})]}),a.jsxs("div",{className:"bg-white rounded-lg border border-gray-200",children:[a.jsx("div",{className:"border-b border-gray-200",children:a.jsx("nav",{className:"flex space-x-8 px-6",children:[{id:"overview",name:"Overview",icon:Sa},{id:"employees",name:"Employees",icon:Ls},{id:"performance",name:"Performance",icon:Is},{id:"shifts",name:"Shifts",icon:Ys},{id:"activity",name:"Activity Logs",icon:zh}].map(K=>a.jsxs("button",{onClick:()=>l(K.id),className:`flex items-center px-1 py-4 text-sm font-medium border-b-2 transition-colors ${o===K.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[a.jsx(K.icon,{className:"w-4 h-4 mr-2"}),K.name]},K.id))})}),a.jsxs("div",{className:"p-6",children:[o==="overview"&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"bg-gray-50 rounded-lg p-6",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[a.jsx(zh,{className:"w-5 h-5 mr-2 text-blue-600"}),"Recent Activity"]}),a.jsx("div",{className:"space-y-3",children:r.slice(0,5).map(K=>a.jsxs("div",{className:"flex items-center justify-between p-3 bg-white rounded-lg",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:a.jsx(Hs,{className:"w-4 h-4 text-blue-600"})}),a.jsxs("div",{className:"ml-3",children:[a.jsx("p",{className:"text-sm font-medium text-gray-900",children:K.name}),a.jsx("p",{className:"text-xs text-gray-500",children:K.role})]})]}),a.jsx("div",{className:"flex items-center",children:a.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${K.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:K.isActive?"Active":"Inactive"})})]},K.id))})]}),a.jsxs("div",{className:"bg-gray-50 rounded-lg p-6",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[a.jsx(qi,{className:"w-5 h-5 mr-2 text-green-600"}),"Performance Summary"]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Average Performance"}),a.jsx("span",{className:"text-lg font-semibold text-green-600",children:"85%"})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Top Performer"}),a.jsx("span",{className:"text-sm font-medium text-gray-900",children:((L=r.find(K=>K.isActive))==null?void 0:L.name)||"N/A"})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Needs Attention"}),a.jsx("span",{className:"text-sm font-medium text-orange-600",children:"0 employees"})]})]})]})]}),a.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg p-6",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[a.jsx(ev,{className:"w-5 h-5 mr-2 text-blue-600"}),"Quick Actions"]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("button",{onClick:()=>d(!0),className:"flex items-center justify-center p-4 bg-white rounded-lg shadow-sm hover:shadow-md transition-shadow",children:[a.jsx(L0,{className:"w-5 h-5 mr-2 text-blue-600"}),a.jsx("span",{className:"font-medium",children:"Add Employee"})]}),a.jsxs("button",{onClick:()=>l("performance"),className:"flex items-center justify-center p-4 bg-white rounded-lg shadow-sm hover:shadow-md transition-shadow",children:[a.jsx(Sa,{className:"w-5 h-5 mr-2 text-green-600"}),a.jsx("span",{className:"font-medium",children:"View Performance"})]}),a.jsxs("button",{onClick:()=>l("shifts"),className:"flex items-center justify-center p-4 bg-white rounded-lg shadow-sm hover:shadow-md transition-shadow",children:[a.jsx(Ys,{className:"w-5 h-5 mr-2 text-purple-600"}),a.jsx("span",{className:"font-medium",children:"Manage Shifts"})]})]})]})]}),o==="employees"&&a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[a.jsxs("div",{className:"flex-1 relative",children:[a.jsx(sn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),a.jsx("input",{type:"text",placeholder:"Search employees...",value:h,onChange:K=>f(K.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("select",{value:p,onChange:K=>m(K.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[a.jsx("option",{value:"all",children:"All Roles"}),a.jsx("option",{value:"manager",children:"Manager"}),a.jsx("option",{value:"staff",children:"Staff"})]}),a.jsxs("select",{value:g,onChange:K=>y(K.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[a.jsx("option",{value:"all",children:"All Status"}),a.jsx("option",{value:"active",children:"Active"}),a.jsx("option",{value:"inactive",children:"Inactive"})]})]})}),a.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Employee"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role & Status"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Permissions"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Last Login"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:he.map(K=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:a.jsx(Hs,{className:"w-5 h-5 text-blue-600"})}),a.jsxs("div",{className:"ml-4",children:[a.jsx("div",{className:"text-sm font-medium text-gray-900",children:K.name}),a.jsxs("div",{className:"text-sm text-gray-500 flex items-center",children:[a.jsx(hN,{className:"w-3 h-3 mr-1"}),K.email]})]})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("div",{className:"flex flex-col",children:[a.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium mb-1 ${K.role==="manager"?"bg-purple-100 text-purple-800":"bg-blue-100 text-blue-800"}`,children:[K.role==="manager"?a.jsx(Co,{className:"w-3 h-3 mr-1"}):a.jsx(Hs,{className:"w-3 h-3 mr-1"}),K.role]}),a.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${K.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:[K.isActive?a.jsx(Nr,{className:"w-3 h-3 mr-1"}):a.jsx(El,{className:"w-3 h-3 mr-1"}),K.isActive?"Active":"Inactive"]})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx(sre,{className:"w-4 h-4 text-green-500 mr-2"}),a.jsxs("span",{className:"text-sm text-gray-900",children:[I(K)," of ",nc.length]})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:K.lastLoginAt?new Date(K.lastLoginAt).toLocaleDateString():"Never"}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("button",{onClick:()=>A(K),className:"text-blue-600 hover:text-blue-900 p-1 rounded",title:"Edit Employee",children:a.jsx(gc,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>Ae(K),className:`p-1 rounded ${K.isActive?"text-red-600 hover:text-red-900":"text-green-600 hover:text-green-900"}`,title:K.isActive?"Deactivate":"Activate",children:K.isActive?a.jsx(Dl,{className:"w-4 h-4"}):a.jsx(Xs,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>{x(K),q(K.id)},className:"text-purple-600 hover:text-purple-900 p-1 rounded",title:"View Activity",children:a.jsx(zh,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>Q(K.id),className:"text-red-600 hover:text-red-900 p-1 rounded",title:"Delete Employee",children:a.jsx(Un,{className:"w-4 h-4"})})]})})]},K.id))})]})})})]}),o==="performance"&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Employee Performance Analytics"}),a.jsxs("button",{onClick:D,className:"btn btn-secondary flex items-center",children:[a.jsx(Is,{className:"w-4 h-4 mr-2"}),"Refresh Data"]})]}),a.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6",children:E.map(K=>{var fe,ee,de;return a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:a.jsx(Hs,{className:"w-5 h-5 text-blue-600"})}),a.jsxs("div",{className:"ml-3",children:[a.jsx("h4",{className:"text-sm font-medium text-gray-900",children:K.employee.name}),a.jsx("p",{className:"text-xs text-gray-500",children:K.employee.role})]})]}),a.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${K.employee.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:K.employee.isActive?"Active":"Inactive"})]}),K.performance?a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Total Orders"}),a.jsx("span",{className:"text-sm font-medium",children:K.performance.totalOrders})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Revenue"}),a.jsxs("span",{className:"text-sm font-medium",children:["",((fe=K.performance.totalRevenue)==null?void 0:fe.toFixed(2))||0]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Avg. Order Value"}),a.jsxs("span",{className:"text-sm font-medium",children:["",((ee=K.performance.averageOrderValue)==null?void 0:ee.toFixed(2))||0]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Completion Rate"}),a.jsxs("span",{className:"text-sm font-medium text-green-600",children:[((de=K.performance.completionRate)==null?void 0:de.toFixed(1))||0,"%"]})]})]}):a.jsxs("div",{className:"text-center py-4",children:[a.jsx(oi,{className:"w-8 h-8 text-gray-400 mx-auto mb-2"}),a.jsx("p",{className:"text-sm text-gray-500",children:"No performance data available"})]})]},K.employee.id)})})]}),o==="shifts"&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Shift Management"}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsxs("button",{className:"btn btn-secondary flex items-center",children:[a.jsx(Jc,{className:"w-4 h-4 mr-2"}),"Schedule Shifts"]}),a.jsxs("button",{className:"btn btn-secondary flex items-center",children:[a.jsx(Yn,{className:"w-4 h-4 mr-2"}),"Export Report"]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[a.jsxs("h4",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[a.jsx(y0,{className:"w-5 h-5 mr-2 text-green-600"}),"Currently Clocked In"]}),a.jsx("div",{className:"space-y-3",children:r.filter(K=>K.isActive).slice(0,3).map(K=>a.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 rounded-lg",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center",children:a.jsx(Hs,{className:"w-4 h-4 text-green-600"})}),a.jsxs("div",{className:"ml-3",children:[a.jsx("p",{className:"text-sm font-medium text-gray-900",children:K.name}),a.jsx("p",{className:"text-xs text-gray-500",children:"Started at 9:00 AM"})]})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("span",{className:"text-sm text-green-600 font-medium",children:"3.5 hrs"}),a.jsx("button",{onClick:()=>G(K.id),className:"text-red-600 hover:text-red-800 p-1 rounded",title:"Clock Out",children:a.jsx(Lj,{className:"w-4 h-4"})})]})]},K.id))})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[a.jsxs("h4",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[a.jsx(sf,{className:"w-5 h-5 mr-2 text-blue-600"}),"Available Staff"]}),a.jsx("div",{className:"space-y-3",children:r.filter(K=>K.isActive).slice(3,6).map(K=>a.jsxs("div",{className:"flex items-center justify-between p-3 bg-blue-50 rounded-lg",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:a.jsx(Hs,{className:"w-4 h-4 text-blue-600"})}),a.jsxs("div",{className:"ml-3",children:[a.jsx("p",{className:"text-sm font-medium text-gray-900",children:K.name}),a.jsx("p",{className:"text-xs text-gray-500",children:"Ready to clock in"})]})]}),a.jsx("button",{onClick:()=>re(K.id),className:"text-green-600 hover:text-green-800 p-1 rounded",title:"Clock In",children:a.jsx(y0,{className:"w-4 h-4"})})]},K.id))})]})]})]}),o==="activity"&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Activity Logs"}),a.jsxs("select",{value:(v==null?void 0:v.id)||"",onChange:K=>{const fe=r.find(ee=>ee.id===K.target.value);x(fe||null),fe&&q(fe.id)},className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[a.jsx("option",{value:"",children:"Select Employee"}),r.map(K=>a.jsx("option",{value:K.id,children:K.name},K.id))]})]}),v&&a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[a.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:a.jsxs("h4",{className:"text-lg font-medium text-gray-900 flex items-center",children:[a.jsx(zh,{className:"w-5 h-5 mr-2 text-blue-600"}),"Activity for ",v.name]})}),a.jsx("div",{className:"p-6",children:w.length>0?a.jsx("div",{className:"space-y-4",children:w.map((K,fe)=>{var ee;return a.jsxs("div",{className:"flex items-start space-x-3 p-3 bg-gray-50 rounded-lg",children:[a.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0",children:a.jsx(zh,{className:"w-4 h-4 text-blue-600"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"text-sm font-medium text-gray-900",children:K.action.replace(/_/g," ").toUpperCase()}),a.jsx("p",{className:"text-xs text-gray-500",children:(ee=K.timestamp)==null?void 0:ee.toLocaleString()}),K.details&&a.jsx("pre",{className:"text-xs text-gray-600 mt-1 bg-white p-2 rounded",children:JSON.stringify(K.details,null,2)})]})]},fe)})}):a.jsxs("div",{className:"text-center py-8",children:[a.jsx(Rl,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),a.jsx("p",{className:"text-gray-500",children:"No activity data available for this employee"})]})})]})]})]})]}),c&&a.jsx(Kpe,{onClose:()=>d(!1),onSubmit:te}),u&&a.jsx(zpe,{employee:u,onClose:()=>A(null),onSubmit:K=>W(u.id,K)})]})}function Kpe({onClose:t,onSubmit:e}){const[r,s]=R.useState({name:"",email:"",password:"",pin:"",role:"staff"}),[n,i]=R.useState(qn.getDefaultPermissions()),[o,l]=R.useState(!1),[c,d]=R.useState(!1),u=async p=>{if(p.preventDefault(),!r.name||!r.email||!r.password||!r.pin){Z.error("Please fill in all required fields");return}if(r.pin.length!==4||!/^\d{4}$/.test(r.pin)){Z.error("PIN must be exactly 4 digits");return}d(!0);try{await e({...r,permissions:n})}finally{d(!1)}},A=p=>{i(m=>m.map(g=>g.module===p?{...g,access:!g.access}:g))},h=p=>{i(m=>m.map(g=>({...g,access:p})))},f=nc.reduce((p,m)=>(p[m.category]||(p[m.category]=[]),p[m.category].push(m),p),{});return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsx("div",{className:"p-6 border-b",children:a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Add New Employee"})}),a.jsxs("form",{onSubmit:u,className:"p-6 space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"form-label",children:"Full Name *"}),a.jsx("input",{type:"text",value:r.name,onChange:p=>s(m=>({...m,name:p.target.value})),className:"input",placeholder:"Enter employee name",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"form-label",children:"Email Address *"}),a.jsx("input",{type:"email",value:r.email,onChange:p=>s(m=>({...m,email:p.target.value})),className:"input",placeholder:"Enter email address",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"form-label",children:"Password *"}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:o?"text":"password",value:r.password,onChange:p=>s(m=>({...m,password:p.target.value})),className:"input pr-10",placeholder:"Enter password",required:!0}),a.jsx("button",{type:"button",onClick:()=>l(!o),className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:o?a.jsx(Dl,{className:"h-4 w-4 text-gray-400"}):a.jsx(Xs,{className:"h-4 w-4 text-gray-400"})})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"form-label",children:"4-Digit PIN *"}),a.jsx("input",{type:"text",value:r.pin,onChange:p=>{const m=p.target.value.replace(/\D/g,"").slice(0,4);s(g=>({...g,pin:m}))},className:"input",placeholder:"Enter 4-digit PIN",maxLength:4,required:!0})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"form-label",children:"Role *"}),a.jsxs("select",{value:r.role,onChange:p=>s(m=>({...m,role:p.target.value})),className:"input",required:!0,children:[a.jsx("option",{value:"staff",children:"Staff"}),a.jsx("option",{value:"manager",children:"Manager"})]})]})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("div",{children:[a.jsxs("h4",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[a.jsx(Co,{className:"w-5 h-5 mr-2 text-blue-600"}),"Employee Permissions & Access Control"]}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Configure what features and operations this employee can access"})]}),a.jsxs("div",{className:"flex flex-wrap gap-2",children:[a.jsxs("div",{className:"flex items-center space-x-2 mr-4",children:[a.jsx("span",{className:"text-xs font-medium text-gray-600",children:"Quick Presets:"}),a.jsx("button",{type:"button",onClick:()=>{const p=["orders","take_order","billing","tables","kitchen","dashboard","customer_create","coupon_apply"];i(m=>m.map(g=>({...g,access:p.includes(g.module)})))},className:"px-2 py-1 text-xs bg-blue-100 text-blue-700 rounded hover:bg-blue-200",children:"Waiter"}),a.jsx("button",{type:"button",onClick:()=>{const p=["kitchen","kitchen_manage","order_status","kot_print","dashboard"];i(m=>m.map(g=>({...g,access:p.includes(g.module)})))},className:"px-2 py-1 text-xs bg-orange-100 text-orange-700 rounded hover:bg-orange-200",children:"Chef"}),a.jsx("button",{type:"button",onClick:()=>{const p=["orders","billing","discounts","customer_create","credits","dashboard","coupon_apply"];i(m=>m.map(g=>({...g,access:p.includes(g.module)})))},className:"px-2 py-1 text-xs bg-green-100 text-green-700 rounded hover:bg-green-200",children:"Cashier"}),a.jsx("button",{type:"button",onClick:()=>{const p=["orders","take_order","billing","tables","menu","inventory","customers","coupons","reports","dashboard"];i(m=>m.map(g=>({...g,access:p.includes(g.module)})))},className:"px-2 py-1 text-xs bg-purple-100 text-purple-700 rounded hover:bg-purple-200",children:"Manager"})]}),a.jsxs("button",{type:"button",onClick:()=>h(!0),className:"flex items-center px-3 py-1.5 text-sm bg-green-100 text-green-700 rounded-lg hover:bg-green-200 transition-colors",children:[a.jsx(Nr,{className:"w-4 h-4 mr-1"}),"Grant All"]}),a.jsxs("button",{type:"button",onClick:()=>h(!1),className:"flex items-center px-3 py-1.5 text-sm bg-red-100 text-red-700 rounded-lg hover:bg-red-200 transition-colors",children:[a.jsx(El,{className:"w-4 h-4 mr-1"}),"Revoke All"]})]})]}),a.jsx("div",{className:"space-y-6",children:Object.entries(f).map(([p,m])=>{const y={core:{title:" Core POS Operations",description:"Essential restaurant operations and order management",color:"border-blue-200 bg-blue-50"},management:{title:" Management & Administration",description:"Business management and configuration features",color:"border-orange-200 bg-orange-50"},reports:{title:" Analytics & Reporting",description:"Business insights, analytics, and performance reports",color:"border-green-200 bg-green-50"},settings:{title:" System Settings & Configuration",description:"Restaurant settings and system administration",color:"border-purple-200 bg-purple-50"}}[p]||{title:p.replace("_"," ").toUpperCase(),description:"Additional features and capabilities",color:"border-gray-200 bg-gray-50"},x=n.filter(T=>m.some(j=>j.id===T.module)).filter(T=>T.access).length,E=m.length;return a.jsxs("div",{className:`border-2 rounded-xl p-5 ${y.color} transition-all hover:shadow-md`,children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{children:[a.jsx("h5",{className:"text-lg font-semibold text-gray-900 mb-1",children:y.title}),a.jsx("p",{className:"text-sm text-gray-600 mb-2",children:y.description}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-white border",children:[x,"/",E," permissions enabled"]}),a.jsx("div",{className:"w-24 bg-gray-200 rounded-full h-2",children:a.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all",style:{width:`${x/E*100}%`}})})]})]}),a.jsxs("div",{className:"flex space-x-2",children:[a.jsx("button",{type:"button",onClick:()=>{m.forEach(T=>{i(j=>j.map(C=>C.module===T.id?{...C,access:!0}:C))})},className:"text-xs px-2 py-1 bg-white border border-green-300 text-green-700 rounded hover:bg-green-50",children:"Enable All"}),a.jsx("button",{type:"button",onClick:()=>{m.forEach(T=>{i(j=>j.map(C=>C.module===T.id?{...C,access:!1}:C))})},className:"text-xs px-2 py-1 bg-white border border-red-300 text-red-700 rounded hover:bg-red-50",children:"Disable All"})]})]}),a.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:m.map(T=>{const j=n.find(w=>w.module===T.id),C=(j==null?void 0:j.access)||!1;return a.jsxs("label",{className:`flex items-start space-x-3 p-3 rounded-lg border-2 cursor-pointer transition-all ${C?"border-blue-300 bg-blue-50 shadow-sm":"border-gray-200 bg-white hover:border-gray-300"}`,children:[a.jsx("input",{type:"checkbox",checked:C,onChange:()=>A(T.id),className:"mt-1 rounded border-gray-300 text-blue-600 focus:ring-blue-500 focus:ring-2"}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:`text-sm font-medium ${C?"text-blue-900":"text-gray-900"}`,children:T.name}),T.defaultAccess&&a.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded text-xs font-medium bg-yellow-100 text-yellow-800",children:"Default"})]}),a.jsx("div",{className:`text-xs mt-1 ${C?"text-blue-700":"text-gray-500"}`,children:T.description}),T.id==="employees"&&a.jsx("div",{className:"text-xs text-orange-600 mt-1 font-medium",children:" Owner-level permission"}),T.id==="settings"&&a.jsx("div",{className:"text-xs text-orange-600 mt-1 font-medium",children:" Sensitive system settings"}),T.id==="financial_reports"&&a.jsx("div",{className:"text-xs text-orange-600 mt-1 font-medium",children:" Financial data access"})]})]},T.id)})})]},p)})}),a.jsxs("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg border",children:[a.jsx("h6",{className:"text-sm font-medium text-gray-900 mb-2",children:"Permission Summary"}),a.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:Object.entries(f).map(([p,m])=>{const g=n.filter(y=>m.some(v=>v.id===y.module)&&y.access).length;return a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-lg font-bold text-blue-600",children:g}),a.jsx("div",{className:"text-xs text-gray-600 capitalize",children:p.replace("_"," ")})]},p)})})]})]}),a.jsxs("div",{className:"flex items-center justify-end space-x-3 pt-6 border-t",children:[a.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Cancel"}),a.jsxs("button",{type:"submit",disabled:c,className:"btn btn-theme-primary flex items-center disabled:opacity-50",children:[c?a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}):a.jsx(L0,{className:"w-4 h-4 mr-2"}),c?"Creating...":"Create Employee"]})]})]})]})})}function zpe({employee:t,onClose:e,onSubmit:r}){const[s,n]=R.useState({name:t.name,email:t.email,password:"",pin:t.pin,role:t.role}),[i,o]=R.useState(t.permissions),[l,c]=R.useState(!1),[d,u]=R.useState(!1),A=async m=>{if(m.preventDefault(),!s.name||!s.email||!s.pin){Z.error("Please fill in all required fields");return}if(s.pin.length!==4||!/^\d{4}$/.test(s.pin)){Z.error("PIN must be exactly 4 digits");return}u(!0);try{const g={name:s.name,email:s.email,pin:s.pin,role:s.role,permissions:i};s.password&&(g.password=s.password),await r(g)}finally{u(!1)}},h=m=>{o(g=>g.map(y=>y.module===m?{...y,access:!y.access}:y))},f=m=>{o(g=>g.map(y=>({...y,access:m})))},p=nc.reduce((m,g)=>(m[g.category]||(m[g.category]=[]),m[g.category].push(g),m),{});return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsx("div",{className:"p-6 border-b",children:a.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Edit Employee: ",t.name]})}),a.jsxs("form",{onSubmit:A,className:"p-6 space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"form-label",children:"Full Name *"}),a.jsx("input",{type:"text",value:s.name,onChange:m=>n(g=>({...g,name:m.target.value})),className:"input",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"form-label",children:"Email Address *"}),a.jsx("input",{type:"email",value:s.email,onChange:m=>n(g=>({...g,email:m.target.value})),className:"input",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"form-label",children:"New Password (leave blank to keep current)"}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:l?"text":"password",value:s.password,onChange:m=>n(g=>({...g,password:m.target.value})),className:"input pr-10",placeholder:"Enter new password"}),a.jsx("button",{type:"button",onClick:()=>c(!l),className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:l?a.jsx(Dl,{className:"h-4 w-4 text-gray-400"}):a.jsx(Xs,{className:"h-4 w-4 text-gray-400"})})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"form-label",children:"4-Digit PIN *"}),a.jsx("input",{type:"text",value:s.pin,onChange:m=>{const g=m.target.value.replace(/\D/g,"").slice(0,4);n(y=>({...y,pin:g}))},className:"input",placeholder:"Enter 4-digit PIN",maxLength:4,required:!0})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"form-label",children:"Role *"}),a.jsxs("select",{value:s.role,onChange:m=>n(g=>({...g,role:m.target.value})),className:"input",required:!0,children:[a.jsx("option",{value:"staff",children:"Staff"}),a.jsx("option",{value:"manager",children:"Manager"})]})]})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("div",{children:[a.jsxs("h4",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[a.jsx(Co,{className:"w-5 h-5 mr-2 text-blue-600"}),"Update Employee Permissions"]}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Modify what features and operations this employee can access"})]}),a.jsxs("div",{className:"flex flex-wrap gap-2",children:[a.jsxs("div",{className:"flex items-center space-x-2 mr-4",children:[a.jsx("span",{className:"text-xs font-medium text-gray-600",children:"Quick Presets:"}),a.jsx("button",{type:"button",onClick:()=>{const m=["orders","take_order","billing","tables","kitchen","dashboard","customer_create","coupon_apply"];o(g=>g.map(y=>({...y,access:m.includes(y.module)})))},className:"px-2 py-1 text-xs bg-blue-100 text-blue-700 rounded hover:bg-blue-200",children:"Waiter"}),a.jsx("button",{type:"button",onClick:()=>{const m=["kitchen","kitchen_manage","order_status","kot_print","dashboard"];o(g=>g.map(y=>({...y,access:m.includes(y.module)})))},className:"px-2 py-1 text-xs bg-orange-100 text-orange-700 rounded hover:bg-orange-200",children:"Chef"}),a.jsx("button",{type:"button",onClick:()=>{const m=["orders","billing","discounts","customer_create","credits","dashboard","coupon_apply"];o(g=>g.map(y=>({...y,access:m.includes(y.module)})))},className:"px-2 py-1 text-xs bg-green-100 text-green-700 rounded hover:bg-green-200",children:"Cashier"}),a.jsx("button",{type:"button",onClick:()=>{const m=["orders","take_order","billing","tables","menu","inventory","customers","coupons","reports","dashboard"];o(g=>g.map(y=>({...y,access:m.includes(y.module)})))},className:"px-2 py-1 text-xs bg-purple-100 text-purple-700 rounded hover:bg-purple-200",children:"Manager"})]}),a.jsxs("button",{type:"button",onClick:()=>f(!0),className:"flex items-center px-3 py-1.5 text-sm bg-green-100 text-green-700 rounded-lg hover:bg-green-200 transition-colors",children:[a.jsx(Nr,{className:"w-4 h-4 mr-1"}),"Grant All"]}),a.jsxs("button",{type:"button",onClick:()=>f(!1),className:"flex items-center px-3 py-1.5 text-sm bg-red-100 text-red-700 rounded-lg hover:bg-red-200 transition-colors",children:[a.jsx(El,{className:"w-4 h-4 mr-1"}),"Revoke All"]})]})]}),a.jsx("div",{className:"space-y-6",children:Object.entries(p).map(([m,g])=>{const v={core:{title:" Core POS Operations",description:"Essential restaurant operations and order management",color:"border-blue-200 bg-blue-50"},management:{title:" Management & Administration",description:"Business management and configuration features",color:"border-orange-200 bg-orange-50"},reports:{title:" Analytics & Reporting",description:"Business insights, analytics, and performance reports",color:"border-green-200 bg-green-50"},settings:{title:" System Settings & Configuration",description:"Restaurant settings and system administration",color:"border-purple-200 bg-purple-50"}}[m]||{title:m.replace("_"," ").toUpperCase(),description:"Additional features and capabilities",color:"border-gray-200 bg-gray-50"},E=i.filter(j=>g.some(C=>C.id===j.module)).filter(j=>j.access).length,T=g.length;return a.jsxs("div",{className:`border-2 rounded-xl p-5 ${v.color} transition-all hover:shadow-md`,children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{children:[a.jsx("h5",{className:"text-lg font-semibold text-gray-900 mb-1",children:v.title}),a.jsx("p",{className:"text-sm text-gray-600 mb-2",children:v.description}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-white border",children:[E,"/",T," permissions enabled"]}),a.jsx("div",{className:"w-24 bg-gray-200 rounded-full h-2",children:a.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all",style:{width:`${E/T*100}%`}})})]})]}),a.jsxs("div",{className:"flex space-x-2",children:[a.jsx("button",{type:"button",onClick:()=>{g.forEach(j=>{o(C=>C.map(w=>w.module===j.id?{...w,access:!0}:w))})},className:"text-xs px-2 py-1 bg-white border border-green-300 text-green-700 rounded hover:bg-green-50",children:"Enable All"}),a.jsx("button",{type:"button",onClick:()=>{g.forEach(j=>{o(C=>C.map(w=>w.module===j.id?{...w,access:!1}:w))})},className:"text-xs px-2 py-1 bg-white border border-red-300 text-red-700 rounded hover:bg-red-50",children:"Disable All"})]})]}),a.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:g.map(j=>{const C=i.find(S=>S.module===j.id),w=(C==null?void 0:C.access)||!1;return a.jsxs("label",{className:`flex items-start space-x-3 p-3 rounded-lg border-2 cursor-pointer transition-all ${w?"border-blue-300 bg-blue-50 shadow-sm":"border-gray-200 bg-white hover:border-gray-300"}`,children:[a.jsx("input",{type:"checkbox",checked:w,onChange:()=>h(j.id),className:"mt-1 rounded border-gray-300 text-blue-600 focus:ring-blue-500 focus:ring-2"}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:`text-sm font-medium ${w?"text-blue-900":"text-gray-900"}`,children:j.name}),j.defaultAccess&&a.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded text-xs font-medium bg-yellow-100 text-yellow-800",children:"Default"})]}),a.jsx("div",{className:`text-xs mt-1 ${w?"text-blue-700":"text-gray-500"}`,children:j.description}),j.id==="employees"&&a.jsx("div",{className:"text-xs text-orange-600 mt-1 font-medium",children:" Owner-level permission"}),j.id==="settings"&&a.jsx("div",{className:"text-xs text-orange-600 mt-1 font-medium",children:" Sensitive system settings"}),j.id==="financial_reports"&&a.jsx("div",{className:"text-xs text-orange-600 mt-1 font-medium",children:" Financial data access"})]})]},j.id)})})]},m)})}),a.jsxs("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg border",children:[a.jsx("h6",{className:"text-sm font-medium text-gray-900 mb-2",children:"Permission Summary"}),a.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:Object.entries(p).map(([m,g])=>{const y=i.filter(v=>g.some(x=>x.id===v.module)&&v.access).length;return a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-lg font-bold text-blue-600",children:y}),a.jsx("div",{className:"text-xs text-gray-600 capitalize",children:m.replace("_"," ")})]},m)})})]})]}),a.jsxs("div",{className:"flex items-center justify-end space-x-3 pt-6 border-t",children:[a.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Cancel"}),a.jsxs("button",{type:"submit",className:"btn btn-theme-primary",disabled:d,children:[d?a.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}):a.jsx(gc,{className:"w-4 h-4 mr-2"}),d?"Updating...":"Update Employee"]})]})]})]})})}function qpe(){var E,T,j,C,w,S,F,B,k,D,q,te,W,Q,re,G;const{restaurant:t}=js(),{user:e}=ia(),[r,s]=R.useState("dashboard"),[n,i]=R.useState(null),[o,l]=R.useState(null),[c,d]=R.useState(null),[u,A]=R.useState([]),[h,f]=R.useState(!0);R.useEffect(()=>{t&&e&&e.role!=="owner"&&(p(),m(),g(),y()),f(!1)},[t,e]);const p=async()=>{if(!(!t||!e))try{const Ae=await qn.getEmployees(t.id);if(Ae.success&&Ae.data){const he=Ae.data.find(I=>I.email===e.email);i(he)}}catch(Ae){console.error("Error fetching employee data:",Ae)}},m=async()=>{if(!(!t||!e||!n))try{const Ae=await qn.getCurrentShiftStatus(n.id,t.id);Ae.success&&l(Ae.data)}catch(Ae){console.error("Error fetching shift status:",Ae)}},g=async()=>{if(!(!t||!e||!n))try{const Ae={start:new Date(Date.now()-2592e6),end:new Date},he=await qn.getEmployeePerformance(n.id,t.id,Ae);he.success&&d(he.data)}catch(Ae){console.error("Error fetching performance data:",Ae)}},y=async()=>{if(!(!t||!e||!n))try{const Ae=await qn.getEmployeeActivity(n.id,t.id,20);Ae.success&&A(Ae.data||[])}catch(Ae){console.error("Error fetching activity data:",Ae)}},v=async()=>{if(!(!t||!n))try{const Ae=await qn.clockIn(n.id,t.id);Ae.success?(Z.success("Clocked in successfully!"),m()):Z.error(Ae.error||"Failed to clock in")}catch(Ae){console.error("Error clocking in:",Ae),Z.error("Failed to clock in")}},x=async()=>{var Ae,he;if(!(!t||!n))try{const I=await qn.clockOut(n.id,t.id);I.success?(Z.success(`Clocked out successfully! Total hours: ${((he=(Ae=I.data)==null?void 0:Ae.totalHours)==null?void 0:he.toFixed(2))||0}`),m()):Z.error(I.error||"Failed to clock out")}catch(I){console.error("Error clocking out:",I),Z.error("Failed to clock out")}};return e?t?e.role==="owner"?a.jsxs("div",{className:"min-h-screen",style:{background:"var(--color-background)"},children:[a.jsx("div",{className:"bg-white border-b shadow-sm",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"flex items-center justify-between h-16",children:[a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsxs(G4,{to:`/${t.slug}`,className:"flex items-center text-gray-600 hover:text-gray-900 transition-colors",children:[a.jsx(Jo,{className:"w-5 h-5 mr-2"}),"Back to Dashboard"]}),a.jsx("div",{className:"h-6 w-px bg-gray-300"}),a.jsxs("div",{className:"flex items-center",children:[a.jsx(Ls,{className:"w-5 h-5 text-blue-600 mr-2"}),a.jsx("h1",{className:"text-lg font-semibold text-gray-900",children:"Employee Management"})]})]}),a.jsx("div",{className:"flex items-center space-x-4",children:a.jsx("div",{className:"text-sm text-gray-600",children:t.name})})]})})}),a.jsx("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:a.jsx($pe,{})})]}):a.jsxs("div",{className:"min-h-screen",style:{background:"var(--color-background)"},children:[a.jsx("div",{className:"bg-white border-b shadow-sm",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"flex items-center justify-between h-16",children:[a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsxs(G4,{to:`/${t.slug}`,className:"flex items-center text-gray-600 hover:text-gray-900 transition-colors",children:[a.jsx(Jo,{className:"w-5 h-5 mr-2"}),"Back to Dashboard"]}),a.jsx("div",{className:"h-6 w-px bg-gray-300"}),a.jsxs("div",{className:"flex items-center",children:[a.jsx(Hs,{className:"w-5 h-5 text-blue-600 mr-2"}),a.jsx("h1",{className:"text-lg font-semibold text-gray-900",children:"My Employee Dashboard"})]})]}),a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsxs("div",{className:"text-sm text-gray-600",children:["Welcome, ",e.name]}),o!=null&&o.isClocked?a.jsxs("button",{onClick:x,className:"bg-red-100 text-red-700 px-3 py-1 rounded-full text-sm font-medium flex items-center",children:[a.jsx(Lj,{className:"w-4 h-4 mr-1"}),"Clock Out"]}):a.jsxs("button",{onClick:v,className:"bg-green-100 text-green-700 px-3 py-1 rounded-full text-sm font-medium flex items-center",children:[a.jsx(y0,{className:"w-4 h-4 mr-1"}),"Clock In"]})]})]})})}),a.jsx("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[a.jsx("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Shift Status"}),a.jsx("p",{className:`text-xl font-bold ${o!=null&&o.isClocked?"text-green-600":"text-gray-600"}`,children:o!=null&&o.isClocked?"Clocked In":"Not Clocked In"}),(o==null?void 0:o.isClocked)&&a.jsxs("p",{className:"text-xs text-gray-500",children:[((T=(E=o.shift)==null?void 0:E.currentHours)==null?void 0:T.toFixed(1))||0," hours today"]})]}),a.jsx("div",{className:`p-3 rounded-lg ${o!=null&&o.isClocked?"bg-green-100":"bg-gray-100"}`,children:o!=null&&o.isClocked?a.jsx(sf,{className:"w-6 h-6 text-green-600"}):a.jsx(Ys,{className:"w-6 h-6 text-gray-600"})})]})}),a.jsx("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Role"}),a.jsx("p",{className:"text-xl font-bold text-blue-600",children:e.role}),a.jsxs("p",{className:"text-xs text-gray-500",children:[((j=n==null?void 0:n.permissions)==null?void 0:j.filter(Ae=>Ae.access).length)||0," permissions"]})]}),a.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:a.jsx(Co,{className:"w-6 h-6 text-blue-600"})})]})}),a.jsx("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-600",children:"This Month"}),a.jsxs("p",{className:"text-xl font-bold text-purple-600",children:[(c==null?void 0:c.totalOrders)||0," orders"]}),a.jsxs("p",{className:"text-xs text-gray-500",children:["",((C=c==null?void 0:c.totalRevenue)==null?void 0:C.toFixed(0))||0," revenue"]})]}),a.jsx("div",{className:"p-3 bg-purple-100 rounded-lg",children:a.jsx(Is,{className:"w-6 h-6 text-purple-600"})})]})}),a.jsx("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Performance"}),a.jsxs("p",{className:"text-xl font-bold text-green-600",children:[((w=c==null?void 0:c.completionRate)==null?void 0:w.toFixed(0))||0,"%"]}),a.jsx("p",{className:"text-xs text-gray-500",children:"Completion rate"})]}),a.jsx("div",{className:"p-3 bg-green-100 rounded-lg",children:a.jsx(qi,{className:"w-6 h-6 text-green-600"})})]})})]}),a.jsxs("div",{className:"bg-white rounded-lg border border-gray-200",children:[a.jsx("div",{className:"border-b border-gray-200",children:a.jsx("nav",{className:"flex space-x-8 px-6",children:[{id:"dashboard",name:"Dashboard",icon:Sa},{id:"performance",name:"My Performance",icon:Is},{id:"shifts",name:"My Shifts",icon:Ys},{id:"profile",name:"Profile",icon:Sl}].map(Ae=>a.jsxs("button",{onClick:()=>s(Ae.id),className:`flex items-center px-1 py-4 text-sm font-medium border-b-2 transition-colors ${r===Ae.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[a.jsx(Ae.icon,{className:"w-4 h-4 mr-2"}),Ae.name]},Ae.id))})}),a.jsxs("div",{className:"p-6",children:[r==="dashboard"&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"bg-gray-50 rounded-lg p-6",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[a.jsx(qi,{className:"w-5 h-5 mr-2 text-blue-600"}),"Today's Performance"]}),a.jsx("div",{className:"space-y-4",children:c?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Orders Handled"}),a.jsx("span",{className:"text-lg font-semibold",children:c.totalOrders})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Revenue Generated"}),a.jsxs("span",{className:"text-lg font-semibold",children:["",((S=c.totalRevenue)==null?void 0:S.toFixed(2))||0]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Average Order Value"}),a.jsxs("span",{className:"text-lg font-semibold",children:["",((F=c.averageOrderValue)==null?void 0:F.toFixed(2))||0]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Success Rate"}),a.jsxs("span",{className:"text-lg font-semibold text-green-600",children:[((B=c.completionRate)==null?void 0:B.toFixed(1))||0,"%"]})]})]}):a.jsxs("div",{className:"text-center py-4",children:[a.jsx(oi,{className:"w-8 h-8 text-gray-400 mx-auto mb-2"}),a.jsx("p",{className:"text-sm text-gray-500",children:"No performance data available"})]})})]}),a.jsxs("div",{className:"bg-gray-50 rounded-lg p-6",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[a.jsx(zh,{className:"w-5 h-5 mr-2 text-green-600"}),"Recent Activity"]}),a.jsx("div",{className:"space-y-3 max-h-64 overflow-y-auto",children:u.length>0?u.slice(0,5).map((Ae,he)=>{var I;return a.jsxs("div",{className:"flex items-start space-x-3 p-3 bg-white rounded-lg",children:[a.jsx("div",{className:"w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0",children:a.jsx(zh,{className:"w-3 h-3 text-blue-600"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"text-sm font-medium text-gray-900",children:Ae.action.replace(/_/g," ")}),a.jsx("p",{className:"text-xs text-gray-500",children:(I=Ae.timestamp)==null?void 0:I.toLocaleString()})]})]},he)}):a.jsxs("div",{className:"text-center py-4",children:[a.jsx(Rl,{className:"w-8 h-8 text-gray-400 mx-auto mb-2"}),a.jsx("p",{className:"text-sm text-gray-500",children:"No recent activity"})]})})]})]}),a.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg p-6",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[a.jsx(YA,{className:"w-5 h-5 mr-2 text-blue-600"}),"Quick Actions"]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o!=null&&o.isClocked?a.jsxs("button",{onClick:x,className:"flex items-center justify-center p-4 bg-white rounded-lg shadow-sm hover:shadow-md transition-shadow",children:[a.jsx(Lj,{className:"w-5 h-5 mr-2 text-red-600"}),a.jsx("span",{className:"font-medium",children:"Clock Out"})]}):a.jsxs("button",{onClick:v,className:"flex items-center justify-center p-4 bg-white rounded-lg shadow-sm hover:shadow-md transition-shadow",children:[a.jsx(y0,{className:"w-5 h-5 mr-2 text-green-600"}),a.jsx("span",{className:"font-medium",children:"Clock In"})]}),a.jsxs("button",{onClick:()=>s("performance"),className:"flex items-center justify-center p-4 bg-white rounded-lg shadow-sm hover:shadow-md transition-shadow",children:[a.jsx(Is,{className:"w-5 h-5 mr-2 text-blue-600"}),a.jsx("span",{className:"font-medium",children:"View Performance"})]}),a.jsxs("button",{onClick:()=>s("shifts"),className:"flex items-center justify-center p-4 bg-white rounded-lg shadow-sm hover:shadow-md transition-shadow",children:[a.jsx(Jc,{className:"w-5 h-5 mr-2 text-purple-600"}),a.jsx("span",{className:"font-medium",children:"My Shifts"})]})]})]})]}),r==="performance"&&a.jsxs("div",{className:"space-y-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"My Performance Analytics"}),c?a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[a.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-3xl font-bold text-blue-600",children:c.totalOrders}),a.jsx("div",{className:"text-sm text-gray-600",children:"Total Orders"})]})}),a.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:a.jsxs("div",{className:"text-center",children:[a.jsxs("div",{className:"text-3xl font-bold text-green-600",children:["",((k=c.totalRevenue)==null?void 0:k.toFixed(0))||0]}),a.jsx("div",{className:"text-sm text-gray-600",children:"Revenue Generated"})]})}),a.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:a.jsxs("div",{className:"text-center",children:[a.jsxs("div",{className:"text-3xl font-bold text-purple-600",children:["",((D=c.averageOrderValue)==null?void 0:D.toFixed(0))||0]}),a.jsx("div",{className:"text-sm text-gray-600",children:"Avg Order Value"})]})}),a.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:a.jsxs("div",{className:"text-center",children:[a.jsxs("div",{className:"text-3xl font-bold text-orange-600",children:[((q=c.completionRate)==null?void 0:q.toFixed(1))||0,"%"]}),a.jsx("div",{className:"text-sm text-gray-600",children:"Success Rate"})]})})]}):a.jsxs("div",{className:"text-center py-12",children:[a.jsx(oi,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Performance Data"}),a.jsx("p",{className:"text-gray-600",children:"Start taking orders to see your performance metrics."})]})]}),r==="shifts"&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"My Shifts"}),a.jsx("div",{className:"flex items-center space-x-3",children:o!=null&&o.isClocked?a.jsxs("span",{className:"bg-green-100 text-green-700 px-3 py-1 rounded-full text-sm font-medium flex items-center",children:[a.jsx(y0,{className:"w-4 h-4 mr-1"}),"Currently Clocked In"]}):a.jsx("span",{className:"bg-gray-100 text-gray-700 px-3 py-1 rounded-full text-sm font-medium",children:"Not Clocked In"})})]}),(o==null?void 0:o.isClocked)&&a.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-6",children:[a.jsx("h4",{className:"text-lg font-semibold text-green-900 mb-4",children:"Current Shift"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-2xl font-bold text-green-600",children:((W=(te=o.shift)==null?void 0:te.clockInTime)==null?void 0:W.toLocaleTimeString())||"N/A"}),a.jsx("div",{className:"text-sm text-gray-600",children:"Clock In Time"})]}),a.jsxs("div",{className:"text-center",children:[a.jsxs("div",{className:"text-2xl font-bold text-green-600",children:[((re=(Q=o.shift)==null?void 0:Q.currentHours)==null?void 0:re.toFixed(1))||0," hrs"]}),a.jsx("div",{className:"text-sm text-gray-600",children:"Hours Worked"})]}),a.jsx("div",{className:"text-center",children:a.jsx("button",{onClick:x,className:"bg-red-600 text-white px-6 py-2 rounded-lg hover:bg-red-700 transition-colors",children:"Clock Out"})})]})]}),!(o!=null&&o.isClocked)&&a.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6 text-center",children:[a.jsx("h4",{className:"text-lg font-semibold text-blue-900 mb-4",children:"Ready to Start Your Shift?"}),a.jsxs("button",{onClick:v,className:"bg-blue-600 text-white px-8 py-3 rounded-lg hover:bg-blue-700 transition-colors flex items-center mx-auto",children:[a.jsx(y0,{className:"w-5 h-5 mr-2"}),"Clock In Now"]})]})]}),r==="profile"&&a.jsxs("div",{className:"space-y-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"My Profile"}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[a.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Personal Information"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Name"}),a.jsx("div",{className:"mt-1 text-sm text-gray-900",children:e.name})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),a.jsx("div",{className:"mt-1 text-sm text-gray-900",children:e.email})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Role"}),a.jsx("div",{className:"mt-1",children:a.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${e.role==="manager"?"bg-purple-100 text-purple-800":"bg-blue-100 text-blue-800"}`,children:[e.role==="manager"?a.jsx(Co,{className:"w-3 h-3 mr-1"}):a.jsx(Hs,{className:"w-3 h-3 mr-1"}),e.role]})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"PIN"}),a.jsx("div",{className:"mt-1 text-sm text-gray-900",children:"****"})]})]})]}),a.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[a.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:"My Permissions"}),a.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:((G=n==null?void 0:n.permissions)==null?void 0:G.filter(Ae=>Ae.access).map((Ae,he)=>a.jsxs("div",{className:"flex items-center p-2 bg-green-50 rounded-lg",children:[a.jsx(Nr,{className:"w-4 h-4 text-green-600 mr-2"}),a.jsx("span",{className:"text-sm text-gray-900",children:Ae.module.replace(/_/g," ")})]},he)))||a.jsxs("div",{className:"text-center py-4",children:[a.jsx(El,{className:"w-8 h-8 text-gray-400 mx-auto mb-2"}),a.jsx("p",{className:"text-sm text-gray-500",children:"No permissions assigned"})]})})]})]})]})]})]})]})})]}):a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Restaurant Not Found"}),a.jsx("p",{className:"text-gray-600",children:"Please check the URL and try again."})]})}):a.jsx(M2,{to:`/${t==null?void 0:t.slug}/login`,replace:!0})}const sT="marketplace_suppliers",nT="marketplace_products",aT="marketplace_orders",of=[{id:"meat",name:"Meat & Poultry",icon:"",subcategories:["Fresh Chicken","Fresh Beef","Fresh Pork","Fresh Lamb","Frozen Meat","Processed Meat"]},{id:"vegetables",name:"Vegetables & Produce",icon:"",subcategories:["Fresh Vegetables","Organic Produce","Frozen Vegetables","Herbs & Spices","Root Vegetables"]},{id:"dairy",name:"Dairy & Eggs",icon:"",subcategories:["Milk & Cream","Cheese","Yogurt","Butter","Eggs"]},{id:"grains",name:"Grains & Staples",icon:"",subcategories:["Rice","Wheat","Flour","Pasta","Bread","Cereals"]},{id:"spices",name:"Spices & Seasonings",icon:"",subcategories:["Whole Spices","Ground Spices","Spice Blends","Salt","Seasonings"]},{id:"equipment",name:"Kitchen Equipment",icon:"",subcategories:["Cooking Equipment","Storage","Small Appliances","Utensils","Safety Equipment"]},{id:"packaging",name:"Packaging & Supplies",icon:"",subcategories:["Food Containers","Bags","Wrapping","Labels","Disposables"]},{id:"cleaning",name:"Cleaning Supplies",icon:"",subcategories:["Detergents","Sanitizers","Paper Products","Cleaning Tools","Industrial Cleaners"]},{id:"beverages",name:"Beverages",icon:"",subcategories:["Soft Drinks","Juices","Coffee & Tea","Water","Alcoholic Beverages"]},{id:"frozen",name:"Frozen Foods",icon:"",subcategories:["Frozen Vegetables","Frozen Meat","Frozen Seafood","Ice Cream","Frozen Ready Meals"]}],Om={draft:{label:"Draft",color:"gray",icon:""},submitted:{label:"Submitted",color:"blue",icon:""},confirmed:{label:"Confirmed",color:"green",icon:""},processing:{label:"Processing",color:"yellow",icon:""},dispatched:{label:"Dispatched",color:"orange",icon:""},in_transit:{label:"In Transit",color:"purple",icon:""},delivered:{label:"Delivered",color:"green",icon:""},cancelled:{label:"Cancelled",color:"red",icon:""},refunded:{label:"Refunded",color:"gray",icon:""}},Mp=t=>{if(!t)return t;const e={...t};return["createdAt","updatedAt","joinedAt","lastActiveAt","requestedDeliveryDate","estimatedDeliveryDate","actualDeliveryDate","paidAt","startDate","endDate"].forEach(s=>{e[s]&&e[s].toDate&&(e[s]=e[s].toDate())}),e.statusHistory&&(e.statusHistory=e.statusHistory.map(s=>{var n;return{...s,timestamp:(n=s.timestamp)!=null&&n.toDate?s.timestamp.toDate():s.timestamp}})),e},Wpe=()=>{const t=Date.now().toString(),e=Math.random().toString(36).substring(2,8).toUpperCase();return`MP-${t.slice(-6)}${e}`},Gpe=(t,e)=>{const r=t.filter(s=>e>=s.minQuantity&&(!s.maxQuantity||e<=s.maxQuantity));return r.length===0?t[0]:r.reduce((s,n)=>n.pricePerUnit<s.pricePerUnit?n:s)},UQ=Gpe,Ype=async t=>{try{return(await Bi(Jt(st,sT),{...t,createdAt:wt.now(),updatedAt:wt.now()})).id}catch(e){throw console.error("Error creating supplier:",e),new Error("Failed to create supplier")}},Xpe=async t=>{try{let e=Zt(Jt(st,sT));return t!=null&&t.category,t!=null&&t.city,t==null||t.isVerified,t==null||t.isActive,(await ur(e)).docs.map(s=>Mp({id:s.id,...s.data()}))}catch(e){throw console.error("Error fetching suppliers:",e),new Error("Failed to fetch suppliers")}},Jpe=async t=>{try{const e=Rt(st,sT,t),r=await Kr(e);return r.exists()?Mp({id:r.id,...r.data()}):null}catch(e){throw console.error("Error fetching supplier:",e),new Error("Failed to fetch supplier")}},Zpe=async t=>{try{return(await Bi(Jt(st,nT),{...t,createdAt:wt.now(),updatedAt:wt.now()})).id}catch(e){throw console.error("Error creating product:",e),new Error("Failed to create product")}},MQ=async t=>{try{let e=Zt(Jt(st,nT));t!=null&&t.category&&(e=Zt(e,Yt("category","==",t.category))),t!=null&&t.supplierId&&(e=Zt(e,Yt("supplierId","==",t.supplierId))),(t==null?void 0:t.isAvailable)!==void 0&&(e=Zt(e,Yt("isAvailable","==",t.isAvailable))),t!=null&&t.limit&&(e=Zt(e,Wi(t.limit)));let s=(await ur(e)).docs.map(n=>Mp({id:n.id,...n.data()}));if(t!=null&&t.searchTerm){const n=t.searchTerm.toLowerCase();s=s.filter(i=>i.name.toLowerCase().includes(n)||i.description.toLowerCase().includes(n)||i.tags.some(o=>o.toLowerCase().includes(n)))}if(t!=null&&t.sortBy)switch(t.sortBy){case"name":s.sort((n,i)=>n.name.localeCompare(i.name));break;case"price":s.sort((n,i)=>n.pricingTiers[0].pricePerUnit-i.pricingTiers[0].pricePerUnit);break;case"newest":s.sort((n,i)=>i.createdAt.getTime()-n.createdAt.getTime());break}return s}catch(e){throw console.error("Error fetching products:",e),new Error("Failed to fetch products")}},QQ=async(t=12)=>{try{const e=Zt(Jt(st,nT),Yt("isAvailable","==",!0));return(await ur(e)).docs.map(i=>Mp({id:i.id,...i.data()})).sort((i,o)=>o.createdAt.getTime()-i.createdAt.getTime()).slice(0,t)}catch(e){throw console.error("Error fetching featured products:",e),new Error("Failed to fetch featured products")}},ege=async t=>{try{const e=Wpe(),r={status:t.status,timestamp:new Date,notes:"Order created"};return(await Bi(Jt(st,aT),{...t,orderNumber:e,statusHistory:[r],createdAt:wt.now(),updatedAt:wt.now()})).id}catch(e){throw console.error("Error creating order:",e),new Error("Failed to create order")}},VQ=async(t,e)=>{try{let r=Zt(Jt(st,aT),Yt("restaurantId","==",t));e!=null&&e.status,e!=null&&e.supplierId;let n=(await ur(r)).docs.map(i=>Mp({id:i.id,...i.data()}));return e!=null&&e.dateFrom||e!=null&&e.dateTo,n.sort((i,o)=>o.createdAt.getTime()-i.createdAt.getTime()),n}catch(r){throw console.error("Error fetching orders:",r),new Error("Failed to fetch orders")}},tge=async t=>{try{const e=Rt(st,aT,t),r=await Kr(e);return r.exists()?Mp({id:r.id,...r.data()}):null}catch(e){throw console.error("Error fetching order:",e),new Error("Failed to fetch order")}},rge=async t=>{try{const e=await VQ(t),r=new Set;e.forEach(n=>{n.items.forEach(i=>{r.add(i.category)})});const s=[];for(const n of Array.from(r).slice(0,3)){const i=await MQ({category:n,isAvailable:!0,sortBy:"newest",limit:4});s.push(...i)}return s.length===0?await QQ(12):s.slice(0,12)}catch(e){throw console.error("Error getting recommended products:",e),new Error("Failed to get recommended products")}},sge=[{name:"John Smith",businessName:"Fresh Farm Supplies",email:"john@freshfarmsupplies.com",phone:"+1-555-0101",address:{street:"123 Farm Road",city:"Austin",state:"TX",zipCode:"78701",country:"USA"},logo:"https://images.unsplash.com/photo-1500595046743-cd271d694d30?w=200&h=200&fit=crop&crop=center",description:"Premium fresh produce and organic vegetables sourced directly from local farms. We specialize in high-quality ingredients for restaurants.",categories:["vegetables","meat","dairy"],rating:4.8,totalReviews:127,isVerified:!0,certifications:["Organic Certified","Food Safety","USDA Approved"],minimumOrderAmount:100,deliveryAreas:["Austin","San Antonio","Houston"],deliveryFee:15,freeDeliveryThreshold:500,businessLicense:"TX-FS-001234",taxId:"74-1234567",isActive:!0,joinedAt:new Date("2023-01-15"),lastActiveAt:new Date},{name:"Maria Rodriguez",businessName:"Wholesale Meat Co",email:"maria@wholesalemeat.com",phone:"+1-555-0102",address:{street:"456 Industrial Blvd",city:"Dallas",state:"TX",zipCode:"75201",country:"USA"},logo:"https://images.unsplash.com/photo-1603048297172-c92544798d5a?w=200&h=200&fit=crop&crop=center",description:"Premier wholesale meat supplier specializing in premium cuts, poultry, and seafood. USDA inspected facilities with 24/7 cold chain management.",categories:["meat","frozen"],rating:4.9,totalReviews:89,isVerified:!0,certifications:["USDA Inspected","HACCP Certified","Halal Certified"],minimumOrderAmount:200,deliveryAreas:["Dallas","Fort Worth","Austin"],deliveryFee:25,freeDeliveryThreshold:750,businessLicense:"TX-MT-005678",taxId:"75-5678901",isActive:!0,joinedAt:new Date("2023-02-20"),lastActiveAt:new Date},{name:"David Chen",businessName:"Restaurant Equipment Plus",email:"david@restaurantequipmentplus.com",phone:"+1-555-0103",address:{street:"789 Commercial Ave",city:"Houston",state:"TX",zipCode:"77001",country:"USA"},logo:"https://images.unsplash.com/photo-1581091226825-a6a2a5aee158?w=200&h=200&fit=crop&crop=center",description:"Complete restaurant equipment solutions from small appliances to commercial kitchen setups. Expert installation and 24/7 support available.",categories:["equipment","packaging"],rating:4.7,totalReviews:156,isVerified:!0,certifications:["NSF Certified","Energy Star Partner"],minimumOrderAmount:150,deliveryAreas:["Houston","Austin","San Antonio"],deliveryFee:30,freeDeliveryThreshold:1e3,businessLicense:"TX-EQ-009012",taxId:"77-9012345",isActive:!0,joinedAt:new Date("2023-03-10"),lastActiveAt:new Date},{name:"Sarah Johnson",businessName:"Spice World International",email:"sarah@spiceworld.com",phone:"+1-555-0104",address:{street:"321 Spice Street",city:"San Antonio",state:"TX",zipCode:"78201",country:"USA"},logo:"https://images.unsplash.com/photo-1596040033229-a9821ebd058d?w=200&h=200&fit=crop&crop=center",description:"Premium spices and seasonings from around the world. We offer bulk quantities with competitive pricing for restaurants and food services.",categories:["spices","grains"],rating:4.6,totalReviews:78,isVerified:!0,certifications:["Organic Certified","Fair Trade"],minimumOrderAmount:75,deliveryAreas:["San Antonio","Austin","Houston"],deliveryFee:10,freeDeliveryThreshold:300,businessLicense:"TX-SP-003456",taxId:"78-3456789",isActive:!0,joinedAt:new Date("2023-04-05"),lastActiveAt:new Date},{name:"Mike Thompson",businessName:"Dairy Fresh Direct",email:"mike@dairyfreshdirect.com",phone:"+1-555-0105",address:{street:"555 Dairy Lane",city:"Austin",state:"TX",zipCode:"78705",country:"USA"},description:"Premium dairy products from local farms. Fresh milk, cheese, butter, and cream delivered daily.",categories:["dairy"],rating:4.5,totalReviews:94,isVerified:!0,certifications:["Grade A Dairy","Organic Certified"],minimumOrderAmount:80,deliveryAreas:["Austin","Round Rock","Cedar Park"],deliveryFee:12,freeDeliveryThreshold:400,businessLicense:"TX-DA-007890",taxId:"78-7890123",isActive:!0,joinedAt:new Date("2023-05-12"),lastActiveAt:new Date}],nge=(t,e)=>{const r=[];switch(e){case"Fresh Farm Supplies":r.push({supplierId:t,supplierName:e,name:"Premium Organic Tomatoes",description:"Vine-ripened organic tomatoes perfect for sauces, salads, and cooking. Harvested at peak ripeness for maximum flavor.",category:"vegetables",subcategory:"Fresh Vegetables",images:["https://images.unsplash.com/photo-1592841200221-4e2f32d8e2cd?w=400&h=400&fit=crop&crop=center","https://images.unsplash.com/photo-1546470427-e26264ab2b24?w=400&h=400&fit=crop&crop=center"],unit:"lb",minimumOrderQuantity:10,maximumOrderQuantity:500,pricingTiers:[{minQuantity:10,maxQuantity:49,pricePerUnit:3.5},{minQuantity:50,maxQuantity:99,pricePerUnit:3.25,discountPercentage:7},{minQuantity:100,pricePerUnit:2.95,discountPercentage:16}],specifications:{origin:"Local Texas Farms",certifications:["Organic","Non-GMO"],shelfLife:"5-7 days",storageRequirements:"Cool, dry place"},isAvailable:!0,stockQuantity:1e3,qualityGrade:"A",certifications:["Organic","USDA Certified"],tags:["fresh","local","organic","featured"],isActive:!0},{supplierId:t,supplierName:e,name:"Fresh Yellow Onions",description:"Premium yellow onions ideal for cooking, soups, and sauces. Sweet flavor and long shelf life.",category:"vegetables",subcategory:"Root Vegetables",images:["https://images.unsplash.com/photo-1618512496248-a07fe83aa8cb?w=400&h=400&fit=crop&crop=center"],unit:"lb",minimumOrderQuantity:25,maximumOrderQuantity:200,pricingTiers:[{minQuantity:25,maxQuantity:49,pricePerUnit:1.2},{minQuantity:50,maxQuantity:99,pricePerUnit:1.1,discountPercentage:8},{minQuantity:100,pricePerUnit:.95,discountPercentage:21}],specifications:{origin:"Local Texas Farms",shelfLife:"30-45 days",storageRequirements:"Cool, dry, well-ventilated area"},isAvailable:!0,stockQuantity:800,qualityGrade:"A",certifications:[],tags:["fresh","local","bulk"],isActive:!0},{supplierId:t,supplierName:e,name:"Organic Baby Spinach",description:"Fresh organic baby spinach leaves, perfect for salads, smoothies, and cooking.",category:"vegetables",subcategory:"Fresh Vegetables",images:["https://images.unsplash.com/photo-1576045057995-568f588f82fb?w=400&h=400&fit=crop&crop=center"],unit:"lb",minimumOrderQuantity:5,maximumOrderQuantity:100,pricingTiers:[{minQuantity:5,maxQuantity:14,pricePerUnit:4.5},{minQuantity:15,maxQuantity:29,pricePerUnit:4.2,discountPercentage:7},{minQuantity:30,pricePerUnit:3.85,discountPercentage:14}],specifications:{origin:"Local Organic Farms",shelfLife:"3-5 days",storageRequirements:"Refrigerated"},isAvailable:!0,stockQuantity:200,qualityGrade:"A",certifications:["Organic","USDA Certified"],tags:["fresh","organic","trending"],isActive:!0});break;case"Wholesale Meat Co":r.push({supplierId:t,supplierName:e,name:"Premium Chicken Breast",description:"Fresh, boneless, skinless chicken breast from free-range chickens. Perfect for grilling, roasting, or frying.",category:"meat",subcategory:"Fresh Chicken",images:["https://images.unsplash.com/photo-1604503468506-a8da13d82791?w=400&h=400&fit=crop&crop=center"],unit:"lb",minimumOrderQuantity:20,maximumOrderQuantity:300,pricingTiers:[{minQuantity:20,maxQuantity:49,pricePerUnit:6.5},{minQuantity:50,maxQuantity:99,pricePerUnit:6.2,discountPercentage:5},{minQuantity:100,pricePerUnit:5.85,discountPercentage:10}],specifications:{origin:"Texas Farms",brand:"Premium Poultry",storageRequirements:"Keep refrigerated 32-38F",shelfLife:"3-5 days refrigerated"},isAvailable:!0,stockQuantity:500,qualityGrade:"A",certifications:["Free-Range","Antibiotic-Free"],tags:["fresh","premium","trending"],isActive:!0},{supplierId:t,supplierName:e,name:"Ground Beef 80/20",description:"Fresh ground beef with 80% lean meat, 20% fat ratio. Perfect for burgers, meatballs, and various dishes.",category:"meat",subcategory:"Fresh Beef",images:["https://images.unsplash.com/photo-1529693662653-9d480530a697?w=400&h=400&fit=crop&crop=center"],unit:"lb",minimumOrderQuantity:15,maximumOrderQuantity:200,pricingTiers:[{minQuantity:15,maxQuantity:49,pricePerUnit:5.95},{minQuantity:50,maxQuantity:99,pricePerUnit:5.65,discountPercentage:5},{minQuantity:100,pricePerUnit:5.25,discountPercentage:12}],specifications:{origin:"Texas Beef",storageRequirements:"Keep refrigerated 32-38F",shelfLife:"3-5 days refrigerated"},isAvailable:!0,stockQuantity:400,qualityGrade:"A",certifications:["USDA Inspected"],tags:["fresh","local"],isActive:!0},{supplierId:t,supplierName:e,name:"Fresh Salmon Fillets",description:"Premium Atlantic salmon fillets, fresh and sustainably sourced. Rich in omega-3 fatty acids.",category:"meat",subcategory:"Fresh Seafood",images:["https://images.unsplash.com/photo-1544943910-4c1dc44aab44?w=400&h=400&fit=crop&crop=center"],unit:"lb",minimumOrderQuantity:10,maximumOrderQuantity:150,pricingTiers:[{minQuantity:10,maxQuantity:24,pricePerUnit:14.5},{minQuantity:25,maxQuantity:49,pricePerUnit:13.95,discountPercentage:4},{minQuantity:50,pricePerUnit:13.25,discountPercentage:9}],specifications:{origin:"Atlantic Ocean",storageRequirements:"Keep refrigerated 32-38F",shelfLife:"2-3 days refrigerated"},isAvailable:!0,stockQuantity:150,qualityGrade:"Premium",certifications:["Sustainably Sourced","MSC Certified"],tags:["fresh","premium","seafood","featured"],isActive:!0});break;case"Restaurant Equipment Plus":r.push({supplierId:t,supplierName:e,name:"Commercial Food Processor",description:"Heavy-duty 20-cup commercial food processor with multiple blade attachments. Perfect for high-volume food preparation.",category:"equipment",subcategory:"Small Appliances",images:["https://images.unsplash.com/photo-1556909114-f6e7ad7d3136?w=400&h=400&fit=crop&crop=center"],unit:"unit",minimumOrderQuantity:1,maximumOrderQuantity:10,pricingTiers:[{minQuantity:1,maxQuantity:2,pricePerUnit:450},{minQuantity:3,maxQuantity:5,pricePerUnit:425,discountPercentage:6},{minQuantity:6,pricePerUnit:395,discountPercentage:12}],specifications:{brand:"ProChef",dimensions:'16" x 11" x 18"',weight:"25 lbs",certifications:["NSF Certified"]},isAvailable:!0,stockQuantity:25,qualityGrade:"Premium",certifications:["NSF","UL Listed"],tags:["equipment","commercial","heavy-duty"],isActive:!0},{supplierId:t,supplierName:e,name:"Stainless Steel Mixing Bowls Set",description:"Professional grade stainless steel mixing bowls in various sizes. Dishwasher safe and built to last.",category:"equipment",subcategory:"Utensils",images:["https://images.unsplash.com/photo-1585515656973-c0eefc2b7b12?w=400&h=400&fit=crop&crop=center"],unit:"set",minimumOrderQuantity:2,maximumOrderQuantity:50,pricingTiers:[{minQuantity:2,maxQuantity:9,pricePerUnit:85},{minQuantity:10,maxQuantity:19,pricePerUnit:78,discountPercentage:8},{minQuantity:20,pricePerUnit:72,discountPercentage:15}],specifications:{brand:"ChefMaster",dimensions:"Set of 6: 1qt, 2qt, 3qt, 4qt, 6qt, 8qt",weight:"8 lbs per set"},isAvailable:!0,stockQuantity:100,qualityGrade:"Premium",certifications:["NSF"],tags:["equipment","stainless-steel","durable"],isActive:!0});break;case"Spice World International":r.push({supplierId:t,supplierName:e,name:"Premium Black Pepper",description:"Freshly ground premium black pepper from Malabar coast. Rich, aromatic flavor perfect for all cuisines.",category:"spices",subcategory:"Whole Spices",images:["https://images.unsplash.com/photo-1596040033229-a9821ebd058d?w=400&h=400&fit=crop&crop=center"],unit:"lb",minimumOrderQuantity:5,maximumOrderQuantity:100,pricingTiers:[{minQuantity:5,maxQuantity:14,pricePerUnit:12.5},{minQuantity:15,maxQuantity:29,pricePerUnit:11.25,discountPercentage:10},{minQuantity:30,pricePerUnit:9.95,discountPercentage:20}],specifications:{origin:"Kerala, India",shelfLife:"24 months",storageRequirements:"Cool, dry place"},isAvailable:!0,stockQuantity:200,qualityGrade:"Premium",certifications:["Organic","Fair Trade"],tags:["spice","premium","imported"],isActive:!0},{supplierId:t,supplierName:e,name:"Himalayan Pink Salt",description:"Pure Himalayan pink salt with natural minerals. Perfect for seasoning and finishing dishes.",category:"spices",subcategory:"Salt",images:["https://images.unsplash.com/photo-1584464491033-06628f3a6b7b?w=400&h=400&fit=crop&crop=center"],unit:"lb",minimumOrderQuantity:10,maximumOrderQuantity:200,pricingTiers:[{minQuantity:10,maxQuantity:24,pricePerUnit:8.5},{minQuantity:25,maxQuantity:49,pricePerUnit:7.65,discountPercentage:10},{minQuantity:50,pricePerUnit:6.8,discountPercentage:20}],specifications:{origin:"Pakistan",shelfLife:"Indefinite",storageRequirements:"Dry place"},isAvailable:!0,stockQuantity:300,qualityGrade:"Premium",certifications:["Natural","Unrefined"],tags:["salt","natural","premium","featured"],isActive:!0},{supplierId:t,supplierName:e,name:"Basmati Rice Premium",description:"Aged basmati rice with long grains and aromatic flavor. Perfect for biryanis, pilafs, and side dishes.",category:"grains",subcategory:"Rice",images:["https://images.unsplash.com/photo-1586201375761-83865001e31c?w=400&h=400&fit=crop&crop=center"],unit:"lb",minimumOrderQuantity:20,maximumOrderQuantity:500,pricingTiers:[{minQuantity:20,maxQuantity:49,pricePerUnit:4.25},{minQuantity:50,maxQuantity:99,pricePerUnit:3.95,discountPercentage:7},{minQuantity:100,pricePerUnit:3.5,discountPercentage:18}],specifications:{origin:"India",brand:"Royal Harvest",shelfLife:"18 months",storageRequirements:"Cool, dry place"},isAvailable:!0,stockQuantity:1e3,qualityGrade:"Premium",certifications:["Non-GMO"],tags:["grain","premium","aromatic"],isActive:!0});break;case"Dairy Fresh Direct":r.push({supplierId:t,supplierName:e,name:"Heavy Cream 36%",description:"Rich heavy cream with 36% fat content. Perfect for sauces, soups, and desserts.",category:"dairy",subcategory:"Milk & Cream",images:["https://images.unsplash.com/photo-1563636619-e9143da7973b?w=400&h=400&fit=crop&crop=center"],unit:"qt",minimumOrderQuantity:12,maximumOrderQuantity:100,pricingTiers:[{minQuantity:12,maxQuantity:23,pricePerUnit:8.5},{minQuantity:24,maxQuantity:47,pricePerUnit:8,discountPercentage:6},{minQuantity:48,pricePerUnit:7.45,discountPercentage:12}],specifications:{origin:"Local Dairy",shelfLife:"14 days refrigerated",storageRequirements:"Keep refrigerated 32-38F"},isAvailable:!0,stockQuantity:200,qualityGrade:"A",certifications:["Grade A Pasteurized"],tags:["dairy","fresh","local"],isActive:!0},{supplierId:t,supplierName:e,name:"Aged Cheddar Cheese",description:"Sharp aged cheddar cheese, perfect for melting or serving. Aged for 12 months for rich flavor.",category:"dairy",subcategory:"Cheese",images:["https://images.unsplash.com/photo-1486297678162-eb2a19b0a32d?w=400&h=400&fit=crop&crop=center"],unit:"lb",minimumOrderQuantity:5,maximumOrderQuantity:100,pricingTiers:[{minQuantity:5,maxQuantity:14,pricePerUnit:12.5},{minQuantity:15,maxQuantity:29,pricePerUnit:11.75,discountPercentage:6},{minQuantity:30,pricePerUnit:10.95,discountPercentage:12}],specifications:{origin:"Local Artisan Dairy",shelfLife:"60 days refrigerated",storageRequirements:"Keep refrigerated 32-38F"},isAvailable:!0,stockQuantity:150,qualityGrade:"Premium",certifications:["Artisan Made","Natural"],tags:["dairy","aged","premium","featured"],isActive:!0});break}return r},HQ=async()=>{try{if(console.log(" Starting marketplace data seeding..."),(await Xpe()).length>0)return{success:!1,message:"Marketplace already has suppliers. Clear data first if you want to reseed."};console.log(" Creating suppliers...");const e={};for(const s of sge)try{const n=await Ype(s);e[s.businessName]=n,console.log(` Created supplier: ${s.businessName}`)}catch(n){console.error(` Failed to create supplier ${s.businessName}:`,n)}console.log(" Creating products...");let r=0;for(const[s,n]of Object.entries(e)){const i=nge(n,s);for(const o of i)try{await Zpe(o),r++,console.log(` Created product: ${o.name}`)}catch(l){console.error(` Failed to create product ${o.name}:`,l)}}return console.log(" Marketplace seeding completed!"),{success:!0,message:`Successfully created ${Object.keys(e).length} suppliers and ${r} products in the marketplace!`}}catch(t){return console.error(" Error seeding marketplace data:",t),{success:!1,message:"Failed to seed marketplace data. Check console for details."}}},age=({product:t,onAddToCart:e,onBack:r})=>{const[s,n]=R.useState(0),[i,o]=R.useState(t.minimumOrderQuantity),[l,c]=R.useState(t.pricingTiers[0]),[d,u]=R.useState(!1);R.useEffect(()=>{const v=UQ(t.pricingTiers,i);c(v)},[i,t.pricingTiers]);const A=()=>{e(t,i),Z.success(`Added ${i} ${t.unit} of ${t.name} to cart!`)},h=v=>{const x=t.minimumOrderQuantity,E=t.maximumOrderQuantity||1/0;v>=x&&v<=E&&o(v)},f=()=>{n(v=>v===t.images.length-1?0:v+1)},p=()=>{n(v=>v===0?t.images.length-1:v-1)},m=of.find(v=>v.id===t.category),g=l.pricePerUnit*i,y=t.pricingTiers[0].pricePerUnit*i-g;return a.jsxs("div",{className:"min-h-screen bg-gray-50",children:[a.jsx("div",{className:"lg:hidden bg-white border-b border-gray-200 px-4 py-3 sticky top-0 z-10",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("button",{onClick:r,className:"flex items-center gap-2 text-gray-600 hover:text-gray-900",children:[a.jsx(Jo,{className:"w-5 h-5"}),a.jsx("span",{children:"Back"})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("button",{className:"p-2 text-gray-600 hover:text-red-500",children:a.jsx(Mw,{className:"w-5 h-5"})}),a.jsx("button",{className:"p-2 text-gray-600 hover:text-blue-500",children:a.jsx(rre,{className:"w-5 h-5"})})]})]})}),a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 lg:py-8",children:[a.jsxs("button",{onClick:r,className:"hidden lg:flex items-center gap-2 text-gray-600 hover:text-gray-900 mb-6 transition-colors",children:[a.jsx(Jo,{className:"w-5 h-5"}),a.jsx("span",{children:"Back to Products"})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 lg:gap-12",children:[a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"relative bg-white rounded-2xl overflow-hidden border border-gray-200",children:a.jsxs("div",{className:"aspect-square relative",children:[a.jsx("img",{src:t.images[s]||"/api/placeholder/600/600",alt:t.name,className:"w-full h-full object-cover"}),t.images.length>1&&a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:p,className:"absolute left-4 top-1/2 transform -translate-y-1/2 p-2 bg-white/80 hover:bg-white rounded-full shadow-md transition-all",children:a.jsx(sM,{className:"w-5 h-5"})}),a.jsx("button",{onClick:f,className:"absolute right-4 top-1/2 transform -translate-y-1/2 p-2 bg-white/80 hover:bg-white rounded-full shadow-md transition-all",children:a.jsx(nM,{className:"w-5 h-5"})})]}),a.jsxs("div",{className:"absolute top-4 left-4 flex flex-col gap-2",children:[t.tags.includes("featured")&&a.jsxs("span",{className:"bg-yellow-500 text-white px-3 py-1 text-sm font-medium rounded-full flex items-center gap-1",children:[a.jsx(YA,{className:"w-4 h-4"}),"Featured"]}),l.discountPercentage&&a.jsxs("span",{className:"bg-red-500 text-white px-3 py-1 text-sm font-medium rounded-full",children:[l.discountPercentage,"% OFF"]}),t.qualityGrade&&a.jsxs("span",{className:"bg-green-500 text-white px-3 py-1 text-sm font-medium rounded-full flex items-center gap-1",children:[a.jsx(pA,{className:"w-4 h-4"}),"Grade ",t.qualityGrade]})]})]})}),t.images.length>1&&a.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2",children:t.images.map((v,x)=>a.jsx("button",{onClick:()=>n(x),className:`flex-shrink-0 w-20 h-20 rounded-lg overflow-hidden border-2 transition-all ${s===x?"border-blue-500 ring-2 ring-blue-200":"border-gray-200 hover:border-gray-300"}`,children:a.jsx("img",{src:v||"/api/placeholder/80/80",alt:`${t.name} ${x+1}`,className:"w-full h-full object-cover"})},x))})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx("span",{className:"text-2xl",children:m==null?void 0:m.icon}),a.jsx("span",{className:"text-sm text-gray-600 font-medium",children:m==null?void 0:m.name})]}),a.jsx("h1",{className:"text-2xl lg:text-3xl font-bold text-gray-900 mb-2",children:t.name}),a.jsx("p",{className:"text-gray-600 text-lg leading-relaxed",children:t.description})]}),a.jsxs("div",{className:"flex items-center gap-3 p-4 bg-gray-50 rounded-xl",children:[a.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:a.jsx(ta,{className:"w-5 h-5 text-blue-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-gray-900",children:"Supplied by"}),a.jsx("p",{className:"text-gray-600",children:t.supplierName})]})]}),a.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6",children:[a.jsxs("div",{className:"flex items-baseline gap-3 mb-4",children:[a.jsxs("span",{className:"text-3xl font-bold text-gray-900",children:["$",l.pricePerUnit.toFixed(2)]}),a.jsxs("span",{className:"text-lg text-gray-600",children:["per ",t.unit]}),l.discountPercentage&&a.jsxs("span",{className:"bg-green-100 text-green-800 px-2 py-1 rounded-md text-sm font-medium",children:[l.discountPercentage,"% off"]})]}),t.pricingTiers.length>1&&a.jsxs("div",{className:"mb-4",children:[a.jsxs("h4",{className:"text-sm font-medium text-gray-900 mb-2 flex items-center gap-1",children:[a.jsx(ev,{className:"w-4 h-4 text-yellow-500"}),"Bulk Pricing"]}),a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:t.pricingTiers.map((v,x)=>a.jsxs("div",{className:`p-3 rounded-lg border text-sm ${v===l?"border-blue-500 bg-blue-50":"border-gray-200 bg-gray-50"}`,children:[a.jsxs("div",{className:"font-medium",children:[v.minQuantity,"+ ",t.unit]}),a.jsxs("div",{className:"text-lg font-bold",children:["$",v.pricePerUnit.toFixed(2)]}),v.discountPercentage&&a.jsxs("div",{className:"text-green-600 text-xs",children:[v.discountPercentage,"% off"]})]},x))})]}),a.jsxs("div",{className:"mb-6",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:"Quantity"}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg",children:[a.jsx("button",{onClick:()=>h(i-1),disabled:i<=t.minimumOrderQuantity,className:"p-3 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:a.jsx(Uf,{className:"w-4 h-4"})}),a.jsx("input",{type:"number",value:i,onChange:v=>h(parseInt(v.target.value)||t.minimumOrderQuantity),min:t.minimumOrderQuantity,max:t.maximumOrderQuantity,className:"w-20 px-3 py-3 text-center border-0 focus:ring-0"}),a.jsx("button",{onClick:()=>h(i+1),disabled:t.maximumOrderQuantity?i>=t.maximumOrderQuantity:!1,className:"p-3 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:a.jsx(zr,{className:"w-4 h-4"})})]}),a.jsxs("div",{className:"text-sm text-gray-600",children:[a.jsxs("div",{children:["Min: ",t.minimumOrderQuantity," ",t.unit]}),t.maximumOrderQuantity&&a.jsxs("div",{children:["Max: ",t.maximumOrderQuantity," ",t.unit]})]})]})]}),a.jsxs("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[a.jsxs("div",{className:"flex items-center justify-between text-lg",children:[a.jsx("span",{className:"font-medium",children:"Total Price:"}),a.jsxs("span",{className:"font-bold text-2xl text-gray-900",children:["$",g.toFixed(2)]})]}),y>0&&a.jsxs("div",{className:"text-green-600 text-sm mt-1",children:["You save $",y.toFixed(2)," with bulk pricing!"]})]}),a.jsxs("button",{onClick:A,className:"w-full bg-gradient-to-r from-blue-600 to-purple-600 text-white py-4 rounded-xl hover:from-blue-700 hover:to-purple-700 flex items-center justify-center gap-3 font-medium text-lg transition-all duration-200 shadow-lg hover:shadow-xl transform hover:scale-[1.02]",children:[a.jsx(Zi,{className:"w-5 h-5"}),"Add to Cart"]}),a.jsxs("button",{onClick:()=>u(!d),className:`w-full mt-3 py-3 rounded-xl border-2 font-medium transition-all ${d?"border-red-500 text-red-500 bg-red-50":"border-gray-300 text-gray-700 hover:border-red-500 hover:text-red-500"}`,children:[a.jsx(Mw,{className:`w-5 h-5 inline mr-2 ${d?"fill-current":""}`}),d?"Added to Wishlist":"Add to Wishlist"]})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"flex items-center gap-3 p-4 bg-green-50 rounded-xl",children:[a.jsx(Co,{className:"w-6 h-6 text-green-600"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-green-900",children:"Quality Assured"}),a.jsx("p",{className:"text-sm text-green-700",children:"Verified supplier"})]})]}),a.jsxs("div",{className:"flex items-center gap-3 p-4 bg-blue-50 rounded-xl",children:[a.jsx(t_,{className:"w-6 h-6 text-blue-600"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-blue-900",children:"Fast Delivery"}),a.jsx("p",{className:"text-sm text-blue-700",children:"2-3 business days"})]})]})]})]})]}),a.jsxs("div",{className:"mt-12 grid grid-cols-1 lg:grid-cols-3 gap-8",children:[a.jsxs("div",{className:"lg:col-span-2",children:[a.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"Product Specifications"}),a.jsx("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden",children:a.jsxs("div",{className:"divide-y divide-gray-200",children:[Object.entries(t.specifications).map(([v,x])=>x&&a.jsxs("div",{className:"px-6 py-4 flex justify-between",children:[a.jsx("span",{className:"font-medium text-gray-900 capitalize",children:v.replace(/([A-Z])/g," $1").trim()}),a.jsx("span",{className:"text-gray-600",children:x})]},v)),a.jsxs("div",{className:"px-6 py-4 flex justify-between",children:[a.jsx("span",{className:"font-medium text-gray-900",children:"Unit"}),a.jsx("span",{className:"text-gray-600",children:t.unit})]}),a.jsxs("div",{className:"px-6 py-4 flex justify-between",children:[a.jsx("span",{className:"font-medium text-gray-900",children:"Minimum Order"}),a.jsxs("span",{className:"text-gray-600",children:[t.minimumOrderQuantity," ",t.unit]})]}),t.maximumOrderQuantity&&a.jsxs("div",{className:"px-6 py-4 flex justify-between",children:[a.jsx("span",{className:"font-medium text-gray-900",children:"Maximum Order"}),a.jsxs("span",{className:"text-gray-600",children:[t.maximumOrderQuantity," ",t.unit]})]})]})})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"Certifications & Tags"}),a.jsxs("div",{className:"space-y-4",children:[t.certifications.length>0&&a.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[a.jsxs("h4",{className:"font-medium text-gray-900 mb-3 flex items-center gap-2",children:[a.jsx(rf,{className:"w-4 h-4 text-green-500"}),"Certifications"]}),a.jsx("div",{className:"flex flex-wrap gap-2",children:t.certifications.map((v,x)=>a.jsx("span",{className:"px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm font-medium",children:v},x))})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[a.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Tags"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:t.tags.map((v,x)=>a.jsx("span",{className:"px-3 py-1 bg-gray-100 text-gray-700 rounded-full text-sm",children:v},x))})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[a.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Availability"}),a.jsxs("div",{className:`flex items-center gap-2 ${t.isAvailable?"text-green-600":"text-red-600"}`,children:[t.isAvailable?a.jsx(rf,{className:"w-5 h-5"}):a.jsx(oi,{className:"w-5 h-5"}),a.jsx("span",{className:"font-medium",children:t.isAvailable?"In Stock":"Out of Stock"})]}),t.stockQuantity&&a.jsxs("p",{className:"text-sm text-gray-600 mt-2",children:[t.stockQuantity," ",t.unit," available"]})]})]})]})]})]})]})},uP=({onCartUpdate:t})=>{var he;const{restaurant:e}=js(),[r,s]=R.useState({view:"browse"}),[n,i]=R.useState([]),[o,l]=R.useState([]),[c,d]=R.useState([]),[u,A]=R.useState(!0),[h,f]=R.useState(""),[p,m]=R.useState("all"),[g,y]=R.useState("grid"),[v,x]=R.useState("newest"),[E,T]=R.useState(!1),[j,C]=R.useState([]),[w]=R.useState([0,1e3]),[S]=R.useState(!0),[F]=R.useState(!1),[B]=R.useState([]),[k,D]=R.useState(!1);R.useEffect(()=>{(async()=>{if(e)try{A(!0);const[U,V,L]=await Promise.all([MQ({isAvailable:!0,sortBy:v}),QQ(8),rge(e.id)]);i(U),l(V),d(L)}catch(U){console.error("Error loading marketplace data:",U)}finally{A(!1)}})()},[e,v]);const q=bi.useMemo(()=>{let I=n;if(p!=="all"&&p!=="featured"&&p!=="recommended"&&(I=I.filter(U=>U.category===p)),h){const U=h.toLowerCase();I=I.filter(V=>V.name.toLowerCase().includes(U)||V.description.toLowerCase().includes(U)||V.tags.some(L=>L.toLowerCase().includes(U))||V.supplierName.toLowerCase().includes(U))}return I=I.filter(U=>{var L;const V=((L=U.pricingTiers[0])==null?void 0:L.pricePerUnit)||0;return V>=w[0]&&V<=w[1]}),S&&(I=I.filter(U=>U.isAvailable)),B.length>0&&(I=I.filter(U=>B.includes(U.supplierId))),I},[n,p,h,w,S,B]),te=bi.useMemo(()=>{switch(p){case"featured":return o;case"recommended":return c;default:return q}},[p,q,o,c]),W=I=>{s({view:"product-detail",selectedProduct:I})},Q=()=>{s({view:"browse"})},re=(I,U=1)=>{const V=j.findIndex(ee=>ee.productId===I.id),L=I.pricingTiers.find(ee=>U>=ee.minQuantity&&(!ee.maxQuantity||U<=ee.maxQuantity))||I.pricingTiers[0],K={id:`${I.id}-${Date.now()}`,productId:I.id,productName:I.name,productImage:I.images[0]||"",category:I.category,supplierId:I.supplierId,supplierName:I.supplierName,unit:I.unit,unitPrice:L.pricePerUnit,quantity:U,appliedDiscount:L.discountPercentage||0,totalPrice:L.pricePerUnit*U,product:I};let fe;V>=0?(fe=[...j],fe[V]={...fe[V],quantity:fe[V].quantity+U,totalPrice:(fe[V].quantity+U)*L.pricePerUnit}):fe=[...j,K],C(fe),t(fe)},G=async()=>{D(!0);try{const I=await HQ();I.success?(Z.success(I.message),setTimeout(()=>{window.location.reload()},2e3)):Z.error(I.message)}catch(I){console.error("Error seeding marketplace data:",I),Z.error("Failed to seed marketplace data")}finally{D(!1)}},Ae=({product:I,view:U})=>{var fe,ee;const[V,L]=R.useState(I.minimumOrderQuantity),K=I.pricingTiers.find(de=>V>=de.minQuantity&&(!de.maxQuantity||V<=de.maxQuantity))||I.pricingTiers[0];return U==="list"?a.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4 hover:shadow-md transition-shadow",children:a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-4",children:[a.jsx("div",{className:"cursor-pointer group",onClick:()=>W(I),children:a.jsx("img",{src:I.images[0]||"/api/placeholder/80/80",alt:I.name,className:"w-full sm:w-20 h-48 sm:h-20 object-cover rounded-lg group-hover:opacity-80 transition-opacity"})}),a.jsx("div",{className:"flex-1 w-full",children:a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-4",children:[a.jsxs("div",{className:"flex-1",onClick:()=>W(I),children:[a.jsx("h3",{className:"font-semibold text-gray-900 hover:text-blue-600 cursor-pointer transition-colors",children:I.name}),a.jsx("p",{className:"text-sm text-gray-600 mt-1 line-clamp-2",children:I.description}),a.jsxs("div",{className:"flex flex-wrap items-center gap-2 mt-2",children:[a.jsx("span",{className:"inline-flex items-center px-2 py-1 text-xs font-medium bg-blue-100 text-blue-800 rounded-full",children:(fe=of.find(de=>de.id===I.category))==null?void 0:fe.name}),a.jsxs("span",{className:"flex items-center text-sm text-gray-500",children:[a.jsx(ta,{className:"w-3 h-3 mr-1"}),I.supplierName]})]})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-4",children:[a.jsxs("div",{className:"text-right",children:[a.jsxs("div",{className:"text-lg font-bold text-gray-900",children:["$",K.pricePerUnit.toFixed(2),a.jsxs("span",{className:"text-sm font-normal text-gray-500",children:["/",I.unit]})]}),K.discountPercentage&&a.jsxs("span",{className:"text-sm text-green-600",children:[K.discountPercentage,"% off bulk"]})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-3",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:de=>{de.stopPropagation(),L(Math.max(I.minimumOrderQuantity,V-1))},className:"p-1 rounded-md border border-gray-300 hover:bg-gray-50",children:a.jsx(Uf,{className:"w-4 h-4"})}),a.jsx("span",{className:"w-12 text-center",children:V}),a.jsx("button",{onClick:de=>{de.stopPropagation(),L(V+1)},className:"p-1 rounded-md border border-gray-300 hover:bg-gray-50",children:a.jsx(zr,{className:"w-4 h-4"})}),a.jsxs("span",{className:"text-sm text-gray-500 hidden sm:block",children:["Min: ",I.minimumOrderQuantity]})]}),a.jsxs("button",{onClick:de=>{de.stopPropagation(),re(I,V)},className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center justify-center gap-2 whitespace-nowrap",children:[a.jsx(Zi,{className:"w-4 h-4"}),"Add to Cart"]})]})]})]})})]})}):a.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden hover:shadow-lg transition-shadow group",children:[a.jsxs("div",{className:"aspect-w-1 aspect-h-1 w-full relative",children:[a.jsx("div",{className:"cursor-pointer h-48 sm:h-56 lg:h-48",onClick:()=>W(I),children:a.jsx("img",{src:I.images[0]||"/api/placeholder/300/300",alt:I.name,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"})}),a.jsxs("div",{className:"absolute top-2 left-2 flex flex-col gap-1",children:[I.tags.includes("featured")&&a.jsxs("span",{className:"bg-yellow-500 text-white px-2 py-1 text-xs font-medium rounded-full flex items-center gap-1",children:[a.jsx(YA,{className:"w-3 h-3"}),a.jsx("span",{className:"hidden sm:inline",children:"Featured"})]}),I.tags.includes("trending")&&a.jsxs("span",{className:"bg-green-500 text-white px-2 py-1 text-xs font-medium rounded-full flex items-center gap-1",children:[a.jsx(Is,{className:"w-3 h-3"}),a.jsx("span",{className:"hidden sm:inline",children:"Trending"})]}),K.discountPercentage&&a.jsxs("span",{className:"bg-red-500 text-white px-2 py-1 text-xs font-medium rounded-full",children:[K.discountPercentage,"% OFF"]})]}),a.jsxs("div",{className:"absolute top-2 right-2 flex flex-col gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[a.jsx("button",{onClick:de=>{de.stopPropagation(),W(I)},className:"p-2 bg-white rounded-full shadow-md hover:bg-gray-50",title:"View Details",children:a.jsx(Xs,{className:"w-4 h-4 text-gray-600"})}),a.jsx("button",{onClick:de=>de.stopPropagation(),className:"p-2 bg-white rounded-full shadow-md hover:bg-gray-50",title:"Add to Wishlist",children:a.jsx(Mw,{className:"w-4 h-4 text-gray-600"})})]})]}),a.jsxs("div",{className:"p-3 sm:p-4",children:[a.jsxs("div",{className:"cursor-pointer",onClick:()=>W(I),children:[a.jsxs("div",{className:"flex items-start justify-between mb-2",children:[a.jsx("h3",{className:"font-semibold text-gray-900 line-clamp-2 hover:text-blue-600 transition-colors text-sm sm:text-base",children:I.name}),a.jsx("span",{className:"text-xs text-gray-500 ml-2 hidden sm:block",children:(ee=of.find(de=>de.id===I.category))==null?void 0:ee.icon})]}),a.jsx("p",{className:"text-sm text-gray-600 mb-3 line-clamp-2",children:I.description}),a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("span",{className:"text-sm text-gray-500 flex items-center gap-1 truncate",children:[a.jsx(ta,{className:"w-3 h-3 flex-shrink-0"}),a.jsx("span",{className:"truncate",children:I.supplierName})]}),I.qualityGrade&&a.jsxs("span",{className:"flex items-center gap-1 text-sm",children:[a.jsx(pA,{className:"w-3 h-3 text-yellow-500"}),a.jsx("span",{className:"hidden sm:inline",children:"Grade "}),I.qualityGrade]})]})]}),a.jsxs("div",{className:"border-t pt-3",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("div",{children:[a.jsxs("span",{className:"text-lg font-bold text-gray-900",children:["$",K.pricePerUnit.toFixed(2)]}),a.jsxs("span",{className:"text-sm text-gray-500",children:["/",I.unit]})]}),I.pricingTiers.length>1&&a.jsxs("span",{className:"text-xs text-blue-600 flex items-center gap-1",children:[a.jsx(ev,{className:"w-3 h-3"}),a.jsx("span",{className:"hidden sm:inline",children:"Bulk discounts"})]})]}),a.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[a.jsx("button",{onClick:de=>{de.stopPropagation(),L(Math.max(I.minimumOrderQuantity,V-1))},className:"p-1 rounded-md border border-gray-300 hover:bg-gray-50",children:a.jsx(Uf,{className:"w-3 h-3 sm:w-4 sm:h-4"})}),a.jsx("span",{className:"w-8 sm:w-12 text-center text-sm",children:V}),a.jsx("button",{onClick:de=>{de.stopPropagation(),L(V+1)},className:"p-1 rounded-md border border-gray-300 hover:bg-gray-50",children:a.jsx(zr,{className:"w-3 h-3 sm:w-4 sm:h-4"})})]}),a.jsxs("button",{onClick:de=>{de.stopPropagation(),re(I,V)},className:"w-full bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700 flex items-center justify-center gap-2 text-sm sm:text-base",children:[a.jsx(Zi,{className:"w-3 h-3 sm:w-4 sm:h-4"}),"Add to Cart"]}),a.jsxs("div",{className:"text-xs text-gray-500 mt-2 text-center",children:["Min: ",I.minimumOrderQuantity," ",I.unit]})]})]})]})};return r.view==="product-detail"&&r.selectedProduct?a.jsx(age,{product:r.selectedProduct,onAddToCart:re,onBack:Q}):u?a.jsxs("div",{className:"flex items-center justify-center py-12",children:[a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),a.jsx("span",{className:"ml-2 text-gray-600",children:"Loading products..."})]}):a.jsxs("div",{className:"space-y-6 sm:space-y-8",children:[a.jsx("div",{className:"bg-white/90 backdrop-blur-sm rounded-xl sm:rounded-2xl border border-white/20 shadow-xl p-4 sm:p-6",children:a.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 sm:gap-6",children:[a.jsxs("div",{className:"flex-1 relative group",children:[a.jsx(sn,{className:"absolute left-3 sm:left-4 top-1/2 transform -translate-y-1/2 h-4 w-4 sm:h-5 sm:w-5 text-gray-400 group-focus-within:text-blue-500 transition-colors duration-200"}),a.jsx("input",{type:"text",placeholder:"Search products, suppliers, or categories...",value:h,onChange:I=>f(I.target.value),className:"w-full pl-10 sm:pl-12 pr-4 py-3 sm:py-4 border border-gray-200 rounded-lg sm:rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white/60 backdrop-blur-sm text-gray-700 placeholder-gray-500 shadow-sm transition-all duration-200 text-sm sm:text-base"}),a.jsx("div",{className:"absolute inset-0 rounded-lg sm:rounded-xl bg-gradient-to-r from-blue-500/10 to-purple-500/10 opacity-0 group-focus-within:opacity-100 transition-opacity duration-200 pointer-events-none"})]}),a.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 overflow-x-auto",children:[a.jsxs("button",{onClick:()=>T(!E),className:`flex items-center gap-2 px-3 sm:px-4 py-2 sm:py-3 border rounded-lg sm:rounded-xl transition-all duration-200 whitespace-nowrap text-sm sm:text-base ${E?"bg-blue-50 border-blue-200 text-blue-700 shadow-sm":"border-gray-200 text-gray-700 hover:bg-gray-50 hover:shadow-sm"}`,children:[a.jsx(uM,{className:"w-4 h-4"}),a.jsx("span",{className:"font-medium hidden sm:inline",children:"Filters"})]}),a.jsxs("div",{className:"relative",children:[a.jsxs("select",{value:v,onChange:I=>x(I.target.value),className:"px-3 sm:px-4 py-2 sm:py-3 pr-8 sm:pr-10 border border-gray-200 rounded-lg sm:rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white/60 backdrop-blur-sm text-gray-700 shadow-sm appearance-none cursor-pointer text-sm sm:text-base",children:[a.jsx("option",{value:"newest",children:"Newest First"}),a.jsx("option",{value:"name",children:"Name A-Z"}),a.jsx("option",{value:"price",children:"Price Low-High"}),a.jsx("option",{value:"rating",children:"Highest Rated"})]}),a.jsx(Is,{className:"absolute right-2 sm:right-3 top-1/2 transform -translate-y-1/2 h-3 w-3 sm:h-4 sm:w-4 text-gray-400 pointer-events-none"})]}),a.jsxs("div",{className:"flex border border-gray-200 rounded-lg overflow-hidden",children:[a.jsx("button",{onClick:()=>y("grid"),className:`p-2 sm:p-3 transition-all duration-200 ${g==="grid"?"bg-white text-blue-600 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:a.jsx(GA,{className:"w-3 h-3 sm:w-4 sm:h-4"})}),a.jsx("button",{onClick:()=>y("list"),className:`p-2 sm:p-3 transition-all duration-200 ${g==="list"?"bg-white text-blue-600 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:a.jsx(oM,{className:"w-3 h-3 sm:w-4 sm:h-4"})})]})]})]})}),a.jsxs("div",{className:"bg-white/60 backdrop-blur-sm rounded-xl sm:rounded-2xl border border-white/20 shadow-lg p-4 sm:p-6",children:[a.jsxs("h3",{className:"text-base sm:text-lg font-semibold text-gray-900 mb-3 sm:mb-4 flex items-center gap-2",children:[a.jsx(Zc,{className:"w-4 h-4 sm:w-5 sm:h-5 text-blue-600"}),"Product Categories"]}),a.jsxs("div",{className:"flex flex-wrap gap-2 sm:gap-3",children:[a.jsx("button",{onClick:()=>m("all"),className:`px-3 sm:px-6 py-2 sm:py-3 rounded-lg sm:rounded-xl text-xs sm:text-sm font-medium transition-all duration-200 ${p==="all"?"bg-gradient-to-r from-blue-600 to-purple-600 text-white shadow-lg transform scale-105":"bg-white/60 text-gray-700 hover:bg-white hover:shadow-md hover:scale-105 border border-gray-200"}`,children:"All Products"}),a.jsxs("button",{onClick:()=>m("featured"),className:`px-3 sm:px-6 py-2 sm:py-3 rounded-lg sm:rounded-xl text-xs sm:text-sm font-medium transition-all duration-200 flex items-center gap-1 sm:gap-2 ${p==="featured"?"bg-gradient-to-r from-yellow-500 to-orange-500 text-white shadow-lg transform scale-105":"bg-yellow-50 text-yellow-700 hover:bg-yellow-100 hover:shadow-md hover:scale-105 border border-yellow-200"}`,children:[a.jsx(YA,{className:"w-3 h-3 sm:w-4 sm:h-4"}),a.jsx("span",{className:"hidden sm:inline",children:"Featured"})]}),a.jsxs("button",{onClick:()=>m("recommended"),className:`px-3 sm:px-6 py-2 sm:py-3 rounded-lg sm:rounded-xl text-xs sm:text-sm font-medium transition-all duration-200 flex items-center gap-1 sm:gap-2 ${p==="recommended"?"bg-gradient-to-r from-green-500 to-emerald-500 text-white shadow-lg transform scale-105":"bg-green-50 text-green-700 hover:bg-green-100 hover:shadow-md hover:scale-105 border border-green-200"}`,children:[a.jsx(Is,{className:"w-3 h-3 sm:w-4 sm:h-4"}),a.jsx("span",{className:"hidden sm:inline",children:"Recommended"})]}),of.map(I=>a.jsxs("button",{onClick:()=>m(I.id),className:`px-3 sm:px-6 py-2 sm:py-3 rounded-lg sm:rounded-xl text-xs sm:text-sm font-medium transition-all duration-200 flex items-center gap-1 sm:gap-2 ${p===I.id?"bg-gradient-to-r from-blue-600 to-purple-600 text-white shadow-lg transform scale-105":"bg-white/60 text-gray-700 hover:bg-white hover:shadow-md hover:scale-105 border border-gray-200"}`,children:[a.jsx("span",{className:"text-sm sm:text-lg",children:I.icon}),a.jsx("span",{className:"hidden sm:inline",children:I.name})]},I.id))]})]}),a.jsxs("div",{className:"bg-white/60 backdrop-blur-sm rounded-xl sm:rounded-2xl border border-white/20 shadow-lg p-4 sm:p-6",children:[a.jsx("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center mb-4 sm:mb-6 gap-3",children:a.jsxs("h2",{className:"text-lg sm:text-xl font-bold text-gray-900 flex items-center gap-3",children:[a.jsx("div",{className:"p-2 bg-gradient-to-r from-blue-500 to-purple-500 rounded-lg",children:a.jsx(rs,{className:"w-4 h-4 sm:w-5 sm:h-5 text-white"})}),a.jsxs("div",{children:[p==="all"&&"All Products",p==="featured"&&"Featured Products",p==="recommended"&&"Recommended for You",typeof p=="string"&&p!=="all"&&p!=="featured"&&p!=="recommended"&&((he=of.find(I=>I.id===p))==null?void 0:he.name),a.jsxs("span",{className:"text-xs sm:text-sm font-normal text-gray-500 block",children:[te.length," product",te.length!==1?"s":""," available"]})]})]})}),te.length===0?a.jsx("div",{className:"text-center py-12 sm:py-16",children:a.jsxs("div",{className:"bg-gradient-to-br from-gray-50 to-blue-50 rounded-xl sm:rounded-2xl p-8 sm:p-12 max-w-lg mx-auto border border-gray-100",children:[a.jsx("div",{className:"text-gray-400 mb-6",children:a.jsx(sn,{className:"w-16 h-16 sm:w-20 sm:h-20 mx-auto"})}),a.jsx("h3",{className:"text-xl sm:text-2xl font-bold text-gray-900 mb-4",children:"No products found"}),n.length===0?a.jsxs("div",{className:"space-y-6",children:[a.jsx("p",{className:"text-gray-600 text-base sm:text-lg leading-relaxed",children:"The marketplace is empty. Load sample data to get started with testing the ordering functionality."}),a.jsxs("button",{onClick:G,disabled:k,className:"inline-flex items-center gap-3 px-6 sm:px-8 py-3 sm:py-4 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg sm:rounded-xl hover:from-blue-700 hover:to-purple-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 shadow-lg hover:shadow-xl transform hover:scale-105 font-medium text-sm sm:text-base",children:[k?a.jsx(Gi,{className:"w-4 h-4 sm:w-5 sm:h-5 animate-spin"}):a.jsx(aM,{className:"w-4 h-4 sm:w-5 sm:h-5"}),k?"Loading Sample Data...":"Load Sample Data"]}),a.jsx("p",{className:"text-xs sm:text-sm text-gray-500",children:"This will create 5 suppliers and 15+ products for testing"})]}):a.jsx("p",{className:"text-gray-600 text-base sm:text-lg",children:"Try adjusting your search or filters"})]})}):a.jsx("div",{className:`grid gap-4 sm:gap-6 lg:gap-8 ${g==="grid"?"grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4":"grid-cols-1"}`,children:te.map(I=>a.jsx(Ae,{product:I,view:g},I.id))})]})]})},ige=()=>{const{restaurant:t}=js(),[e,r]=R.useState([]),[s,n]=R.useState([]),[i,o]=R.useState(!0),[l,c]=R.useState(""),[d,u]=R.useState("all"),[A,h]=R.useState(null),[f,p]=R.useState(!1);R.useEffect(()=>{(async()=>{if(t)try{o(!0);const E=await VQ(t.id);r(E),n(E)}catch(E){console.error("Error loading orders:",E)}finally{o(!1)}})()},[t]),R.useEffect(()=>{let x=e;if(d!=="all"&&(x=x.filter(E=>E.status===d)),l){const E=l.toLowerCase();x=x.filter(T=>T.orderNumber.toLowerCase().includes(E)||T.supplierName.toLowerCase().includes(E)||T.items.some(j=>j.productName.toLowerCase().includes(E)))}n(x)},[e,d,l]);const m=async x=>{try{const E=await tge(x);E&&(h(E),p(!0))}catch(E){console.error("Error loading order details:",E)}},g=x=>{switch(Om[x].color){case"gray":return"bg-gray-100 text-gray-800";case"blue":return"bg-blue-100 text-blue-800";case"green":return"bg-green-100 text-green-800";case"yellow":return"bg-yellow-100 text-yellow-800";case"orange":return"bg-orange-100 text-orange-800";case"purple":return"bg-purple-100 text-purple-800";case"red":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},y=x=>new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(x),v={total:e.length,pending:e.filter(x=>["submitted","confirmed","processing"].includes(x.status)).length,inTransit:e.filter(x=>["dispatched","in_transit"].includes(x.status)).length,delivered:e.filter(x=>x.status==="delivered").length,totalValue:e.reduce((x,E)=>x+E.total,0)};return i?a.jsxs("div",{className:"flex items-center justify-center py-12",children:[a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),a.jsx("span",{className:"ml-2 text-gray-600",children:"Loading orders..."})]}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[a.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-600",children:"Total Orders"}),a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:v.total})]}),a.jsx(rs,{className:"w-8 h-8 text-blue-600"})]})}),a.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-600",children:"Pending"}),a.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:v.pending})]}),a.jsx(Ys,{className:"w-8 h-8 text-yellow-600"})]})}),a.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-600",children:"In Transit"}),a.jsx("p",{className:"text-2xl font-bold text-orange-600",children:v.inTransit})]}),a.jsx(t_,{className:"w-8 h-8 text-orange-600"})]})}),a.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-600",children:"Delivered"}),a.jsx("p",{className:"text-2xl font-bold text-green-600",children:v.delivered})]}),a.jsx(Nr,{className:"w-8 h-8 text-green-600"})]})}),a.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-600",children:"Total Value"}),a.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:["$",v.totalValue.toFixed(2)]})]}),a.jsx(hn,{className:"w-8 h-8 text-blue-600"})]})})]}),a.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:a.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[a.jsxs("div",{className:"flex-1 relative",children:[a.jsx(sn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),a.jsx("input",{type:"text",placeholder:"Search orders by number, supplier, or product...",value:l,onChange:x=>c(x.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("select",{value:d,onChange:x=>u(x.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[a.jsx("option",{value:"all",children:"All Status"}),Object.entries(Om).map(([x,E])=>a.jsx("option",{value:x,children:E.label},x))]})]})}),a.jsx("div",{className:"bg-white rounded-lg border border-gray-200",children:s.length===0?a.jsxs("div",{className:"text-center py-12",children:[a.jsx(rs,{className:"w-12 h-12 mx-auto text-gray-400 mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No orders found"}),a.jsx("p",{className:"text-gray-600",children:e.length===0?"You haven't placed any orders yet. Start shopping in the marketplace!":"Try adjusting your search or filters"})]}):a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Order"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Supplier"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Items"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:s.map(x=>{const E=Om[x.status];return a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("div",{children:[a.jsx("div",{className:"font-medium text-gray-900",children:x.orderNumber}),a.jsxs("div",{className:"text-sm text-gray-500",children:[x.items.length," item",x.items.length!==1?"s":""]})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsx("div",{className:"text-sm font-medium text-gray-900",children:x.supplierName})}),a.jsx("td",{className:"px-6 py-4",children:a.jsxs("div",{className:"text-sm text-gray-900",children:[x.items.slice(0,2).map((T,j)=>a.jsxs("div",{className:"truncate",children:[T.productName," (",T.quantity," ",T.unit,")"]},j)),x.items.length>2&&a.jsxs("div",{className:"text-xs text-gray-500",children:["+",x.items.length-2," more items"]})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("div",{className:"text-sm font-medium text-gray-900",children:["$",x.total.toFixed(2)]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${g(x.status)}`,children:[a.jsx("span",{className:"mr-1",children:E.icon}),E.label]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:y(x.createdAt)}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:a.jsxs("button",{onClick:()=>m(x.id),className:"text-blue-600 hover:text-blue-900 flex items-center gap-1",children:[a.jsx(Xs,{className:"w-4 h-4"}),"View"]})})]},x.id)})})]})})}),f&&A&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[a.jsxs("div",{children:[a.jsxs("h2",{className:"text-xl font-semibold text-gray-900",children:["Order ",A.orderNumber]}),a.jsxs("p",{className:"text-sm text-gray-500",children:["Placed on ",y(A.createdAt)]})]}),a.jsx("button",{onClick:()=>p(!1),className:"text-gray-400 hover:text-gray-600",children:a.jsx(El,{className:"w-6 h-6"})})]}),a.jsxs("div",{className:"p-6 space-y-6",children:[a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[a.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Order Status"}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${g(A.status)}`,children:[a.jsx("span",{className:"mr-1",children:Om[A.status].icon}),Om[A.status].label]}),A.trackingNumber&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Tracking:"}),a.jsx("span",{className:"font-mono text-sm",children:A.trackingNumber}),A.trackingUrl&&a.jsx("a",{href:A.trackingUrl,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800",children:a.jsx(D0,{className:"w-4 h-4"})})]})]}),A.statusHistory&&A.statusHistory.length>0&&a.jsxs("div",{className:"mt-4",children:[a.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Status History"}),a.jsx("div",{className:"space-y-2",children:A.statusHistory.slice().reverse().map((x,E)=>a.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[a.jsx("span",{className:"text-gray-500",children:y(x.timestamp)}),a.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded text-xs ${g(x.status)}`,children:Om[x.status].label}),x.notes&&a.jsx("span",{className:"text-gray-600",children:x.notes})]},E))})]})]}),a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[a.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Supplier Information"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-gray-900",children:A.supplierName}),a.jsx("div",{className:"mt-2 space-y-1 text-sm text-gray-600",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ta,{className:"w-4 h-4"}),a.jsx("span",{children:"Delivery Area"})]})})]})})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Order Items"}),a.jsx("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Product"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Quantity"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Unit Price"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Total"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:A.items.map((x,E)=>{var T;return a.jsxs("tr",{children:[a.jsx("td",{className:"px-4 py-3",children:a.jsxs("div",{className:"flex items-center gap-3",children:[x.productImage&&a.jsx("img",{src:x.productImage,alt:x.productName,className:"w-10 h-10 object-cover rounded"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-gray-900",children:x.productName}),a.jsx("p",{className:"text-sm text-gray-500",children:(T=of.find(j=>j.id===x.category))==null?void 0:T.name})]})]})}),a.jsxs("td",{className:"px-4 py-3 text-sm text-gray-900",children:[x.quantity," ",x.unit]}),a.jsxs("td",{className:"px-4 py-3 text-sm text-gray-900",children:["$",x.unitPrice.toFixed(2)]}),a.jsxs("td",{className:"px-4 py-3 text-sm font-medium text-gray-900",children:["$",x.totalPrice.toFixed(2)]})]},E)})})]})})]}),a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[a.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Order Summary"}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{children:"Subtotal:"}),a.jsxs("span",{children:["$",A.subtotal.toFixed(2)]})]}),a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{children:"Tax:"}),a.jsxs("span",{children:["$",A.tax.toFixed(2)]})]}),a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{children:"Delivery Fee:"}),a.jsxs("span",{children:["$",A.deliveryFee.toFixed(2)]})]}),A.discount>0&&a.jsxs("div",{className:"flex justify-between text-sm text-green-600",children:[a.jsx("span",{children:"Discount:"}),a.jsxs("span",{children:["-$",A.discount.toFixed(2)]})]}),a.jsxs("div",{className:"border-t pt-2 flex justify-between font-medium",children:[a.jsx("span",{children:"Total:"}),a.jsxs("span",{children:["$",A.total.toFixed(2)]})]})]})]}),a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[a.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Delivery Information"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-gray-700",children:"Delivery Address:"}),a.jsxs("p",{className:"text-gray-600",children:[A.deliveryAddress.street,a.jsx("br",{}),A.deliveryAddress.city,", ",A.deliveryAddress.state," ",A.deliveryAddress.zipCode]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-gray-700",children:"Delivery Schedule:"}),a.jsxs("div",{className:"text-gray-600",children:[a.jsxs("p",{children:["Requested: ",y(A.requestedDeliveryDate)]}),A.estimatedDeliveryDate&&a.jsxs("p",{children:["Estimated: ",y(A.estimatedDeliveryDate)]}),A.actualDeliveryDate&&a.jsxs("p",{children:["Delivered: ",y(A.actualDeliveryDate)]})]})]})]}),A.deliveryInstructions&&a.jsxs("div",{className:"mt-3",children:[a.jsx("p",{className:"font-medium text-gray-700",children:"Delivery Instructions:"}),a.jsx("p",{className:"text-gray-600",children:A.deliveryInstructions})]})]})]}),a.jsxs("div",{className:"flex justify-end gap-3 p-6 border-t border-gray-200",children:[a.jsx("button",{onClick:()=>p(!1),className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Close"}),A.invoiceUrl&&a.jsxs("a",{href:A.invoiceUrl,target:"_blank",rel:"noopener noreferrer",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[a.jsx(Yn,{className:"w-4 h-4"}),"Download Invoice"]})]})]})})]})},oge=()=>a.jsxs("div",{className:"p-6",children:[a.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Analytics"}),a.jsx("p",{children:"Marketplace analytics component coming soon..."})]}),lge=({cartItems:t,onCartUpdate:e})=>{var E;const{restaurant:r}=js(),[s,n]=R.useState({}),[i,o]=R.useState(!1),[l,c]=R.useState(!1),[d,u]=R.useState(null),[A,h]=R.useState({deliveryAddress:{street:((E=r==null?void 0:r.settings)==null?void 0:E.address)||"",city:"",state:"",zipCode:"",country:"USA"},requestedDeliveryDate:new Date(Date.now()+24*60*60*1e3),deliveryInstructions:"",paymentMethod:"invoice"});R.useEffect(()=>{(async()=>{if(t.length===0){n({});return}const j={};for(const C of t){const w=C.product.supplierId,S=C.product.supplierName;if(!j[w]){j[w]={supplier:{id:w,name:S,businessName:S,minimumOrderAmount:0,deliveryFee:15,freeDeliveryThreshold:500},items:[],subtotal:0,meetsMinimum:!1,deliveryFee:0,total:0};try{const F=await Jpe(w);F&&(j[w].supplier={id:F.id,name:F.name,businessName:F.businessName,minimumOrderAmount:F.minimumOrderAmount,deliveryFee:F.deliveryFee,freeDeliveryThreshold:F.freeDeliveryThreshold})}catch(F){console.warn("Could not fetch supplier details:",F)}}j[w].items.push(C)}Object.keys(j).forEach(C=>{const w=j[C];w.subtotal=w.items.reduce((S,F)=>S+F.totalPrice,0),w.meetsMinimum=w.subtotal>=w.supplier.minimumOrderAmount,w.subtotal>=w.supplier.freeDeliveryThreshold?w.deliveryFee=0:w.deliveryFee=w.supplier.deliveryFee,w.total=w.subtotal+w.deliveryFee}),n(j)})()},[t]);const f=(T,j,C)=>{if(C<=0){p(T,j);return}const w=t.map(S=>{if(S.productId===T&&S.product.supplierId===j){const F=UQ(S.product.pricingTiers,C);return{...S,quantity:C,unitPrice:F.pricePerUnit,totalPrice:F.pricePerUnit*C}}return S});e(w)},p=(T,j)=>{const C=t.filter(w=>!(w.productId===T&&w.product.supplierId===j));e(C)},m=()=>{e([])},g=T=>{const j=t.filter(C=>C.product.supplierId!==T);e(j)},y=T=>{u(T),c(!0)},v=async()=>{if(!d||!r){Z.error("Missing required information");return}const T=s[d];if(!T){Z.error("Supplier not found");return}if(!T.meetsMinimum){Z.error(`Minimum order amount of $${T.supplier.minimumOrderAmount} not met`);return}o(!0);try{const j={restaurantId:r.id,restaurantName:r.name,supplierId:d,supplierName:T.supplier.businessName,orderNumber:`MP-${Date.now()}-${Math.floor(Math.random()*1e3)}`,status:"draft",items:T.items.map(w=>({id:`${w.productId}-${Date.now()}`,productId:w.productId,productName:w.productName,category:w.category,quantity:w.quantity,unit:w.unit,unitPrice:w.unitPrice,totalPrice:w.totalPrice,appliedDiscount:w.appliedDiscount,productImage:w.productImage})),subtotal:T.subtotal,tax:T.subtotal*.08,deliveryFee:T.deliveryFee,discount:0,total:T.total+T.subtotal*.08,deliveryAddress:A.deliveryAddress,requestedDeliveryDate:A.requestedDeliveryDate,deliveryInstructions:A.deliveryInstructions,paymentMethod:A.paymentMethod,statusHistory:[{status:"draft",timestamp:new Date,notes:"Order created"}],paymentStatus:"pending",isContractOrder:!1,placedBy:(r==null?void 0:r.id)||"unknown"};await ege(j)&&(Z.success("Order placed successfully!"),g(d),c(!1),u(null))}catch(j){console.error("Error placing order:",j),Z.error("Failed to place order. Please try again.")}finally{o(!1)}},x=T=>T.toISOString().split("T")[0];return t.length===0?a.jsxs("div",{className:"text-center py-12",children:[a.jsx(Zi,{className:"w-16 h-16 mx-auto text-gray-400 mb-4"}),a.jsx("h3",{className:"text-xl font-medium text-gray-900 mb-2",children:"Your cart is empty"}),a.jsx("p",{className:"text-gray-600 mb-6",children:"Browse the marketplace to find products for your restaurant"})]}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Shopping Cart"}),a.jsxs("p",{className:"text-gray-600",children:[t.length," item",t.length!==1?"s":""," from ",Object.keys(s).length," supplier",Object.keys(s).length!==1?"s":""]})]}),a.jsxs("button",{onClick:m,className:"flex items-center gap-2 px-4 py-2 text-red-600 border border-red-300 rounded-lg hover:bg-red-50",children:[a.jsx(Un,{className:"w-4 h-4"}),"Clear Cart"]})]}),a.jsx("div",{className:"space-y-6",children:Object.entries(s).map(([T,j])=>a.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg overflow-hidden",children:[a.jsxs("div",{className:"bg-gray-50 px-6 py-4 border-b border-gray-200",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold text-gray-900",children:j.supplier.businessName}),a.jsxs("div",{className:"flex items-center gap-4 mt-1 text-sm text-gray-600",children:[a.jsxs("span",{children:["Min. Order: $",j.supplier.minimumOrderAmount]}),a.jsxs("span",{children:["Delivery: $",j.supplier.deliveryFee," (Free over $",j.supplier.freeDeliveryThreshold,")"]})]})]}),a.jsx("button",{onClick:()=>g(T),className:"text-red-600 hover:text-red-800",children:a.jsx(Un,{className:"w-4 h-4"})})]}),!j.meetsMinimum&&a.jsxs("div",{className:"mt-3 flex items-center gap-2 text-amber-700 bg-amber-50 px-3 py-2 rounded-lg",children:[a.jsx(oi,{className:"w-4 h-4"}),a.jsxs("span",{className:"text-sm",children:["Add $",(j.supplier.minimumOrderAmount-j.subtotal).toFixed(2)," more to meet minimum order"]})]})]}),a.jsx("div",{className:"p-6",children:a.jsx("div",{className:"space-y-4",children:j.items.map(C=>{var w;return a.jsxs("div",{className:"flex items-center gap-4 py-4 border-b border-gray-100 last:border-b-0",children:[C.productImage&&a.jsx("img",{src:C.productImage,alt:C.productName,className:"w-16 h-16 object-cover rounded-lg"}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-gray-900 truncate",children:C.productName}),a.jsx("p",{className:"text-sm text-gray-600",children:(w=of.find(S=>S.id===C.category))==null?void 0:w.name}),a.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[a.jsxs("span",{className:"text-sm font-medium text-gray-900",children:["$",C.unitPrice.toFixed(2)]}),a.jsxs("span",{className:"text-sm text-gray-500",children:["per ",C.unit]}),C.appliedDiscount>0&&a.jsxs("span",{className:"text-xs bg-green-100 text-green-800 px-2 py-0.5 rounded-full",children:[C.appliedDiscount,"% off"]})]})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("button",{onClick:()=>f(C.productId,C.supplierId,C.quantity-1),className:"p-1 text-gray-500 hover:text-gray-700 border border-gray-300 rounded",children:a.jsx(Uf,{className:"w-4 h-4"})}),a.jsx("span",{className:"w-12 text-center font-medium",children:C.quantity}),a.jsx("button",{onClick:()=>f(C.productId,C.supplierId,C.quantity+1),className:"p-1 text-gray-500 hover:text-gray-700 border border-gray-300 rounded",children:a.jsx(zr,{className:"w-4 h-4"})})]}),a.jsx("div",{className:"text-right",children:a.jsxs("p",{className:"font-semibold text-gray-900",children:["$",C.totalPrice.toFixed(2)]})}),a.jsx("button",{onClick:()=>p(C.productId,C.supplierId),className:"p-1 text-red-500 hover:text-red-700",children:a.jsx(qr,{className:"w-4 h-4"})})]},`${C.productId}-${C.supplierId}`)})})}),a.jsxs("div",{className:"bg-gray-50 px-6 py-4 border-t border-gray-200",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{children:"Subtotal:"}),a.jsxs("span",{children:["$",j.subtotal.toFixed(2)]})]}),a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{children:"Delivery Fee:"}),a.jsx("span",{children:j.deliveryFee===0?a.jsx("span",{className:"text-green-600",children:"FREE"}):`$${j.deliveryFee.toFixed(2)}`})]}),a.jsxs("div",{className:"flex justify-between font-semibold text-lg border-t pt-2",children:[a.jsx("span",{children:"Total:"}),a.jsxs("span",{children:["$",j.total.toFixed(2)]})]})]}),a.jsxs("button",{onClick:()=>y(T),disabled:!j.meetsMinimum,className:"w-full mt-4 bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[a.jsx(No,{className:"w-4 h-4"}),j.meetsMinimum?"Checkout":`Minimum $${j.supplier.minimumOrderAmount} Required`]})]})]},T))}),l&&d&&s[d]&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Checkout"}),a.jsx("button",{onClick:()=>c(!1),className:"text-gray-400 hover:text-gray-600",children:a.jsx(qr,{className:"w-6 h-6"})})]}),a.jsxs("div",{className:"p-6 space-y-6",children:[a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[a.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Supplier"}),a.jsx("p",{className:"text-gray-700",children:s[d].supplier.businessName})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Delivery Address"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Street Address"}),a.jsx("input",{type:"text",value:A.deliveryAddress.street,onChange:T=>h({...A,deliveryAddress:{...A.deliveryAddress,street:T.target.value}}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"City"}),a.jsx("input",{type:"text",value:A.deliveryAddress.city,onChange:T=>h({...A,deliveryAddress:{...A.deliveryAddress,city:T.target.value}}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"State"}),a.jsx("input",{type:"text",value:A.deliveryAddress.state,onChange:T=>h({...A,deliveryAddress:{...A.deliveryAddress,state:T.target.value}}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ZIP Code"}),a.jsx("input",{type:"text",value:A.deliveryAddress.zipCode,onChange:T=>h({...A,deliveryAddress:{...A.deliveryAddress,zipCode:T.target.value}}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Requested Delivery Date"}),a.jsx("input",{type:"date",value:x(A.requestedDeliveryDate),onChange:T=>h({...A,requestedDeliveryDate:new Date(T.target.value)}),min:x(new Date),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Delivery Instructions (Optional)"}),a.jsx("textarea",{value:A.deliveryInstructions,onChange:T=>h({...A,deliveryInstructions:T.target.value}),placeholder:"Special delivery instructions, loading dock location, etc.",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Payment Method"}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"radio",value:"invoice",checked:A.paymentMethod==="invoice",onChange:T=>h({...A,paymentMethod:T.target.value}),className:"mr-3"}),a.jsx("span",{children:"Invoice (Net 30)"})]}),a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"radio",value:"credit_card",checked:A.paymentMethod==="credit_card",onChange:T=>h({...A,paymentMethod:T.target.value}),className:"mr-3"}),a.jsx("span",{children:"Credit Card"})]}),a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"radio",value:"bank_transfer",checked:A.paymentMethod==="bank_transfer",onChange:T=>h({...A,paymentMethod:T.target.value}),className:"mr-3"}),a.jsx("span",{children:"Bank Transfer"})]})]})]}),a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[a.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Order Summary"}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{children:"Subtotal:"}),a.jsxs("span",{children:["$",s[d].subtotal.toFixed(2)]})]}),a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{children:"Tax (8%):"}),a.jsxs("span",{children:["$",(s[d].subtotal*.08).toFixed(2)]})]}),a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{children:"Delivery Fee:"}),a.jsx("span",{children:s[d].deliveryFee===0?a.jsx("span",{className:"text-green-600",children:"FREE"}):`$${s[d].deliveryFee.toFixed(2)}`})]}),a.jsxs("div",{className:"flex justify-between font-semibold text-lg border-t pt-2",children:[a.jsx("span",{children:"Total:"}),a.jsxs("span",{children:["$",(s[d].total+s[d].subtotal*.08).toFixed(2)]})]})]})]})]}),a.jsxs("div",{className:"flex justify-end gap-3 p-6 border-t border-gray-200",children:[a.jsx("button",{onClick:()=>c(!1),className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Cancel"}),a.jsx("button",{onClick:v,disabled:i,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:i?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Processing..."]}):a.jsxs(a.Fragment,{children:[a.jsx(Nr,{className:"w-4 h-4"}),"Place Order"]})})]})]})})]})},cge=()=>{const{restaurant:t}=js(),{user:e}=ia(),[r,s]=R.useState("browse"),[n,i]=R.useState([]),[o,l]=R.useState(!1);if(!e||!t||e.role!=="owner"&&e.role!=="manager")return a.jsx(M2,{to:`/${t==null?void 0:t.slug}/login`,replace:!0});const c=[{id:"browse",label:"Browse Products",icon:Zc,description:"Find and order supplies"},{id:"orders",label:"My Orders",icon:rs,description:"Track your orders"},{id:"analytics",label:"Analytics",icon:Sa,description:"Spending insights"},{id:"cart",label:`Cart ${n.length>0?`(${n.length})`:""}`,icon:Zi,description:"Review your cart"}],d=async()=>{l(!0);try{const A=await HQ();A.success?(Z.success(A.message),setTimeout(()=>{window.location.reload()},2e3)):Z.error(A.message)}catch(A){console.error("Error seeding marketplace data:",A),Z.error("Failed to seed marketplace data")}finally{l(!1)}},u=()=>{switch(r){case"browse":return a.jsx(uP,{onCartUpdate:i});case"orders":return a.jsx(ige,{});case"analytics":return a.jsx(oge,{});case"cart":return a.jsx(lge,{cartItems:n,onCartUpdate:i});default:return a.jsx(uP,{onCartUpdate:i})}};return a.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-blue-50 to-indigo-50",children:[a.jsxs("div",{className:"relative overflow-hidden",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-600 via-purple-600 to-indigo-600"}),a.jsx("div",{className:"absolute inset-0 opacity-10",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.4'%3E%3Ccircle cx='30' cy='30' r='2'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E")`}}),a.jsx("div",{className:"relative",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"flex justify-between items-center py-8",children:[a.jsx("div",{className:"text-white",children:a.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[a.jsx("div",{className:"p-3 bg-white/20 rounded-2xl backdrop-blur-sm border border-white/20",children:a.jsx(Zc,{className:"h-8 w-8 text-white"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-4xl font-bold mb-1",children:"Marketplace"}),a.jsxs("p",{className:"text-blue-100 text-lg font-medium",children:["Premium bulk supplies for ",t.name]})]})]})}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsxs("button",{onClick:d,disabled:o,className:"flex items-center gap-3 px-6 py-3 bg-white/20 backdrop-blur-sm text-white rounded-xl hover:bg-white/30 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-300 border border-white/20 shadow-lg hover:shadow-xl",children:[o?a.jsx(Gi,{className:"h-5 w-5 animate-spin"}):a.jsx(aM,{className:"h-5 w-5"}),a.jsx("span",{className:"font-medium",children:o?"Loading...":"Load Sample Data"})]}),a.jsxs("button",{className:"p-3 text-white hover:bg-white/20 rounded-xl relative transition-all duration-300 group",children:[a.jsx(fp,{className:"h-6 w-6 group-hover:scale-110 transition-transform"}),a.jsx("span",{className:"absolute -top-1 -right-1 h-5 w-5 bg-red-500 text-white text-xs rounded-full flex items-center justify-center animate-pulse shadow-lg",children:"3"})]}),a.jsxs("div",{className:"relative",children:[a.jsx(sn,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),a.jsx("input",{type:"text",placeholder:"Search products, suppliers...",className:"pl-12 pr-4 py-3 bg-white/90 backdrop-blur-sm border border-white/20 rounded-xl focus:ring-2 focus:ring-white/50 focus:border-transparent w-80 text-gray-700 placeholder-gray-500 shadow-lg"})]})]})]})})})]}),a.jsx("div",{className:"bg-white/80 backdrop-blur-sm border-b border-gray-200/50 shadow-sm",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:a.jsx("nav",{className:"flex space-x-1","aria-label":"Tabs",children:c.map(A=>{const h=A.icon,f=r===A.id;return a.jsxs("button",{onClick:()=>s(A.id),className:`group relative px-6 py-4 font-medium text-sm flex items-center gap-3 transition-all duration-300 rounded-t-xl ${f?"text-blue-600 bg-white shadow-lg -mb-px border-x border-t border-gray-200":"text-gray-600 hover:text-gray-800 hover:bg-white/60"}`,children:[a.jsx(h,{className:`h-5 w-5 transition-all duration-300 ${f?"text-blue-600 scale-110":"text-gray-400 group-hover:text-gray-600 group-hover:scale-105"}`}),a.jsxs("span",{className:"relative",children:[A.label,A.id==="cart"&&n.length>0&&a.jsx("span",{className:"ml-3 inline-flex items-center justify-center px-2 py-1 text-xs font-bold leading-none text-white bg-gradient-to-r from-red-500 to-pink-500 rounded-full animate-pulse shadow-md",children:n.length})]}),f&&a.jsx("div",{className:"absolute inset-x-0 bottom-0 h-1 bg-gradient-to-r from-blue-600 via-purple-600 to-indigo-600 rounded-full"})]},A.id)})})})}),a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:a.jsx("div",{className:"bg-white/60 backdrop-blur-sm rounded-2xl shadow-xl border border-white/20 overflow-hidden",children:a.jsx("div",{className:"p-6",children:u()})})})]})};function dge(){const{restaurant:t}=js(),[e,r]=R.useState([]),[s,n]=R.useState([]),[i,o]=R.useState([]),[l,c]=R.useState([]),[d,u]=R.useState([]),[A,h]=R.useState(!0),[f,p]=R.useState(!1),[m,g]=R.useState(!1),[y,v]=R.useState(!0),[x,E]=R.useState(!1),[T,j]=R.useState(0),[C,w]=R.useState("disconnected"),[S,F]=R.useState(!1),[B,k]=R.useState(null),[D,q]=R.useState([]),[te,W]=R.useState(!1),Q=R.useRef(null),re=R.useRef(null),G=R.useRef(!1),Ae=R.useRef(0),he=R.useRef(!0),I=R.useRef(!1),U=R.useRef(new Set),[V,L]=R.useState({totalActiveOrders:0,preparingOrders:0,readyOrders:0,avgPrepTime:0,oldestOrder:null}),[K,fe]=R.useState(new Set);R.useEffect(()=>{G.current=x,Ae.current=T,he.current=y,I.current=m,U.current=K},[x,T,y,m,K]);const ee=R.useCallback(async(le=!1)=>{if(t)try{const[ae,ve]=await Promise.all([Ur.getOrdersForRestaurant(t.id,100),fs.getTablesForRestaurant(t.id)]);if(ae.success&&ae.data){const we=new Date,De=new Date(we.getTime()-24*60*60*1e3);let Ve=ae.data.filter(pt=>["placed","confirmed","preparing","ready"].includes(pt.status));const me=Ve.filter(pt=>new Date(pt.createdAt)>=De),Fe=Ve.filter(pt=>new Date(pt.createdAt)<De);Fe.length>0&&(console.log(` KDS Initial Load: Auto-completing ${Fe.length} stale orders`),Fe.forEach(async pt=>{const ze=(we.getTime()-new Date(pt.createdAt).getTime())/36e5;console.warn(` KDS: Auto-completing stale order #${pt.orderNumber} - ${ze.toFixed(1)} hours old`);try{await Ur.updateOrderStatus(pt.id,t.id,"completed",{notes:`Auto-completed by KDS on load - order was ${Math.floor(ze)} hours old`})}catch(Me){console.error(`Failed to auto-complete stale order ${pt.id}:`,Me)}}));const Re=me.filter(pt=>!K.has(pt.id)).sort((pt,ze)=>new Date(pt.createdAt).getTime()-new Date(ze.createdAt).getTime()),Be=Re.filter(pt=>pt.tableId==="customer-portal"||pt.notes&&pt.notes.includes("Customer Portal Order")),X=Re.filter(pt=>pt.type==="takeaway"||pt.tableId==="takeaway-order"),_e=Re.filter(pt=>pt.tableId!=="customer-portal"&&!(pt.notes&&pt.notes.includes("Customer Portal Order"))&&pt.type!=="takeaway"&&pt.tableId!=="takeaway-order");if(x&&Re.length>T){const pt=Re.length-T;if(y&&Q.current)try{Q.current.playBeep?Q.current.playBeep():(Q.current.currentTime=0,Q.current.play().catch(ze=>console.log("Could not play sound:",ze)))}catch(ze){console.log("Audio play error:",ze)}m&&"Notification"in window&&Notification.permission==="granted"&&new Notification(` New Order${pt>1?"s":""}!`,{body:`${pt} new order${pt>1?"s":""} received in kitchen`,icon:"/favicon.ico",tag:"new-order",requireInteraction:!0}),Z.success(` ${pt} new order${pt>1?"s":""} received!`,{duration:5e3,position:"top-center"})}r(Re),n(Be),o(X),c(_e),j(Re.length),E(!0);const ke=Re.filter(pt=>pt.status==="preparing").length,lt=Re.filter(pt=>pt.status==="ready").length,mt=Re.length>0?new Date(Re[0].createdAt):null;L({totalActiveOrders:Re.length,preparingOrders:ke,readyOrders:lt,avgPrepTime:0,oldestOrder:mt})}ve.success&&ve.data&&u(ve.data),le&&Z.success("Kitchen display updated")}catch(ae){console.error("Failed to load kitchen data:",ae),Z.error("Failed to load kitchen data")}finally{h(!1)}},[t,x,T,y,m,K]),de=R.useCallback(async()=>{if("Notification"in window)try{return await Notification.requestPermission()==="granted"?(g(!0),console.log(" KDS: Notifications automatically enabled"),!0):(console.log("KDS: Notification permission denied"),!1)}catch(le){return console.error("Error requesting notification permission:",le),!1}else return console.log("KDS: Notifications not supported in this browser"),!1},[]);R.useEffect(()=>{const le=()=>{try{const ve=new(window.AudioContext||window.webkitAudioContext),we=ve.createOscillator(),De=ve.createGain();we.connect(De),De.connect(ve.destination),we.frequency.value=800,we.type="sine",De.gain.setValueAtTime(.3,ve.currentTime),De.gain.exponentialRampToValueAtTime(.01,ve.currentTime+.5),we.start(ve.currentTime),we.stop(ve.currentTime+.5)}catch(ve){console.log("Audio context not available:",ve)}},ae=new Audio;return ae.src="data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhCjSO1+/ThC4FKnjJ8NuJOggZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhCjSO1+/ThC4FKnjJ8NuJOgg",Q.current=ae,Q.current.playBeep=le,()=>{re.current&&clearInterval(re.current)}},[]),R.useEffect(()=>{v(!0),de(),console.log(" KDS: Auto-enabling notifications and sound for continuous monitoring")},[de]),R.useEffect(()=>{if(t){ee(),console.log(" Setting up real-time order subscription for KDS"),w("connecting");const le=Ur.subscribeToActiveOrders(t.id,ae=>{console.log(" Real-time orders update received:",ae.length),w("connected");const ve=new Date,we=new Date(ve.getTime()-24*60*60*1e3),De=[],Ve=[];ae.forEach(ke=>{const mt=(ve.getTime()-new Date(ke.createdAt).getTime())/(60*60*1e3);new Date(ke.createdAt)<we?(console.warn(` KDS: Found stale order #${ke.orderNumber} - ${mt.toFixed(1)} hours old, auto-completing`),Ve.push(ke)):De.push(ke)}),Ve.length>0&&(console.log(` KDS: Auto-completing ${Ve.length} stale orders`),Ve.forEach(async ke=>{try{await Ur.updateOrderStatus(ke.id,t.id,"completed",{notes:`Auto-completed by KDS - order was ${Math.floor((ve.getTime()-new Date(ke.createdAt).getTime())/(60*60*1e3))} hours old`})}catch(lt){console.error(`Failed to auto-complete stale order ${ke.id}:`,lt)}}));const me=De.filter(ke=>!U.current.has(ke.id));if(G.current&&me.length>Ae.current){const ke=me.length-Ae.current;if(he.current&&Q.current)try{Q.current.playBeep?Q.current.playBeep():(Q.current.currentTime=0,Q.current.play().catch(lt=>console.log("Could not play sound:",lt)))}catch(lt){console.log("Audio play error:",lt)}I.current&&"Notification"in window&&Notification.permission==="granted"&&new Notification(` New Order${ke>1?"s":""}!`,{body:`${ke} new order${ke>1?"s":""} received in kitchen`,icon:"/favicon.ico",tag:"new-order",requireInteraction:!0}),Z.success(` NEW ORDER ALERT! ${ke} order${ke>1?"s":""} received!`,{duration:8e3,position:"top-center",style:{background:"rgba(34, 197, 94, 0.95)",color:"#fff",fontSize:"16px",fontWeight:"bold",padding:"16px 20px",borderRadius:"12px",border:"2px solid rgba(34, 197, 94, 1)",boxShadow:"0 10px 25px -5px rgba(34, 197, 94, 0.3)"}})}const Fe=me.filter(ke=>ke.tableId==="customer-portal"||ke.notes&&ke.notes.includes("Customer Portal Order")),Re=me.filter(ke=>ke.tableId!=="customer-portal"&&!(ke.notes&&ke.notes.includes("Customer Portal Order")));r(me),n(Fe),c(Re),j(me.length),E(!0),Ae.current=me.length,G.current=!0,console.log(` KDS Updated: ${me.length} active orders total`);const Be=me.filter(ke=>ke.status==="preparing").length,X=me.filter(ke=>ke.status==="ready").length,_e=me.length>0?new Date(me[0].createdAt):null;L({totalActiveOrders:me.length,preparingOrders:Be,readyOrders:X,avgPrepTime:0,oldestOrder:_e})});return()=>{console.log(" Unsubscribing from real-time orders"),le()}}},[t==null?void 0:t.id]),R.useEffect(()=>{if(f&&t)return re.current=setInterval(()=>{console.log(" Backup polling: Loading kitchen data"),ee()},3e4),()=>{re.current&&clearInterval(re.current)}},[f,t,ee]);const ue=async(le,ae)=>{if(t)try{if(ae==="completed"){console.log(` KDS: Order ${le} marked as done - removing from KDS display only (no database changes)`);const we=e.find(De=>De.id===le);fe(De=>new Set([...De,le])),r(De=>De.filter(Ve=>Ve.id!==le)),c(De=>De.filter(Ve=>Ve.id!==le)),n(De=>De.filter(Ve=>Ve.id!==le)),L(De=>({...De,totalActiveOrders:Math.max(0,De.totalActiveOrders-1),preparingOrders:(we==null?void 0:we.status)==="preparing"?Math.max(0,De.preparingOrders-1):De.preparingOrders,readyOrders:(we==null?void 0:we.status)==="ready"?Math.max(0,De.readyOrders-1):De.readyOrders})),Z.success(` Order #${(we==null?void 0:we.orderNumber)||"Unknown"} marked as done and removed from kitchen display`,{duration:3e3});return}const ve=e.find(we=>we.id===le);ve&&(await Ur.updateOrderStatus(le,(t==null?void 0:t.id)||"",ae),await ee(),Z.success(`Order #${ve.orderNumber} marked as ${ae}`))}catch(ve){console.error("Error updating order status:",ve),Z.error("Failed to update order status")}},Ie=async le=>{if(t)try{(await Ur.updateOrderStatus(le,t.id,"confirmed")).success?(await ee(),Z.success(" Menu Portal Order Confirmed! Customer will be notified.",{duration:4e3,style:{background:"rgba(34, 197, 94, 0.95)",color:"#fff"}})):Z.error("Failed to confirm order")}catch(ae){console.error("Error confirming order:",ae),Z.error("Failed to confirm order")}},Y=R.useCallback(async()=>{if(t)try{const le=await Ts.getMenuItemsForRestaurant(t.id);le.success&&le.data&&q(le.data)}catch(le){console.error("Failed to load menu items:",le)}},[t]),H=async le=>{t&&(D.length===0&&await Y(),k(le),F(!0))},je=async le=>{if(!(!B||!t)){W(!0);try{const ae={status:"completed",paymentMethod:le.method,amountReceived:le.amountReceived,finalTotal:le.finalTotal,originalTotal:le.originalTotal||B.total,total:le.finalTotal};if((le.manualDiscountAmount>0||le.couponDiscountAmount>0)&&(ae.discountApplied=!0,ae.totalDiscountAmount=(le.manualDiscountAmount||0)+(le.couponDiscountAmount||0),ae.originalTotalBeforeDiscount=le.originalTotal,le.manualDiscount&&(ae.manualDiscount={type:le.manualDiscount.type,value:le.manualDiscount.value,amount:le.manualDiscountAmount,reason:le.manualDiscount.reason||""}),le.couponDiscountAmount>0&&(ae.couponDiscountAmount=le.couponDiscountAmount),ae.discount=(le.manualDiscountAmount||0)+(le.couponDiscountAmount||0)),le.tip>0&&(ae.tip=le.tip),le.totalSavings>0&&(ae.totalSavings=le.totalSavings),le.appliedCoupon&&(ae.appliedCoupon={code:le.appliedCoupon.coupon.code,name:le.appliedCoupon.coupon.name,discountAmount:le.appliedCoupon.discountAmount||0,freeItems:le.appliedCoupon.freeItems||[],totalSavings:le.totalSavings||0}),(await Ur.updateOrderStatus(B.id,t.id,"completed",ae)).success){await ee(),F(!1),k(null);let we="Payment processed successfully!";le.totalSavings>0&&(we=`Payment processed! Customer saved ${le.totalSavings} with coupon!`),Z.success(we,{duration:4e3,style:{background:"rgba(34, 197, 94, 0.95)",color:"#fff"}})}else Z.error("Failed to process payment")}catch(ae){console.error("Payment processing error:",ae),Z.error("Failed to process payment")}finally{W(!1)}}};R.useEffect(()=>{t&&Y()},[t,Y]);const Ce=le=>{const ae={placed:{color:"border-yellow-300 bg-yellow-50",textColor:"text-yellow-800",icon:Ys,label:"New Order"},confirmed:{color:"border-blue-300 bg-blue-50",textColor:"text-blue-800",icon:Nr,label:"Confirmed"},preparing:{color:"border-orange-300 bg-orange-50",textColor:"text-orange-800",icon:hf,label:"Preparing"},ready:{color:"border-green-300 bg-green-50",textColor:"text-green-800",icon:Z6,label:"Ready"}};return ae[le]||ae.placed},oe=le=>{const ve=new Date().getTime()-new Date(le).getTime();return Math.floor(ve/(1e3*60))},He=async()=>{await de(),p(!0),await ee(!0),console.log(" KDS: Get Orders activated - continuous monitoring enabled")},ie=async()=>{if(t)try{const le=await Ur.getOrdersForRestaurant(t.id,200);if(le.success&&le.data){const ae=new Date,ve=new Date(ae.getTime()-24*60*60*1e3),we=le.data.filter(me=>["placed","confirmed","preparing","ready"].includes(me.status)&&new Date(me.createdAt)<ve);if(we.length===0){Z.success("No stale orders found - KDS is clean!");return}if(!confirm(`Found ${we.length} stale order${we.length>1?"s":""} older than 24 hours. Complete ${we.length>1?"them":"it"} now?`))return;Z.loading(`Cleaning up ${we.length} stale orders...`);let Ve=0;for(const me of we)try{const Fe=(ae.getTime()-new Date(me.createdAt).getTime())/36e5;await Ur.updateOrderStatus(me.id,t.id,"completed",{notes:`Manual cleanup - order was ${Math.floor(Fe)} hours old`}),Ve++}catch(Fe){console.error(`Failed to complete stale order ${me.id}:`,Fe)}Ve>0?(Z.success(` Cleaned up ${Ve} stale order${Ve>1?"s":""}!`),setTimeout(()=>ee(),1e3)):Z.error("Failed to clean up stale orders")}}catch(le){console.error("Error during cleanup:",le),Z.error("Failed to clean up stale orders")}};return A?a.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Loading Kitchen Display..."})]})}):a.jsxs("div",{className:"min-h-screen bg-gray-50",children:[a.jsx("header",{className:"bg-white shadow-sm border-b",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:a.jsxs("div",{className:"flex flex-col space-y-4 sm:flex-row sm:items-center sm:justify-between sm:space-y-0",children:[a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-gradient-to-r from-orange-500 to-red-600 rounded-2xl flex items-center justify-center",children:a.jsx(hf,{className:"w-5 h-5 sm:w-6 sm:h-6 text-white"})}),a.jsxs("div",{className:"min-w-0 flex-1",children:[a.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:"Kitchen Display System"}),a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:space-x-2",children:[a.jsx("p",{className:"text-gray-600 text-sm",children:"Real-time order management for kitchen staff"}),t&&a.jsxs("div",{className:`flex items-center space-x-1 px-2 py-1 rounded-full text-xs mt-1 sm:mt-0 w-fit ${C==="connected"?"bg-green-100 text-green-700":C==="connecting"?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"}`,children:[a.jsx("div",{className:`w-2 h-2 rounded-full ${C==="connected"?"bg-green-500 animate-pulse":C==="connecting"?"bg-yellow-500 animate-spin":"bg-red-500"}`}),a.jsx("span",{children:C==="connected"?"Live":C==="connecting"?"Connecting...":"Disconnected"})]})]})]})]}),a.jsx("div",{className:"flex flex-col space-y-3 sm:space-y-0 sm:flex-row sm:items-center sm:space-x-4",children:a.jsxs("div",{className:"flex flex-col space-y-2 sm:space-y-0 sm:flex-row sm:space-x-2",children:[a.jsxs("button",{onClick:He,className:"bg-gradient-to-r from-green-500 to-emerald-600 text-white px-4 py-2 sm:px-6 rounded-lg hover:from-green-600 hover:to-emerald-700 transition-all duration-200 flex items-center justify-center space-x-2 font-medium text-sm sm:text-base",children:[a.jsx(fp,{className:"w-4 h-4 sm:w-5 sm:h-5"}),a.jsx("span",{children:"Get Orders"})]}),a.jsxs("button",{onClick:()=>ee(!0),className:"bg-gray-100 text-gray-600 px-3 py-2 sm:px-4 rounded-lg hover:bg-gray-200 transition-colors flex items-center justify-center space-x-2 text-sm sm:text-base",children:[a.jsx(Di,{className:"w-4 h-4 sm:w-5 sm:h-5"}),a.jsx("span",{children:"Refresh"})]}),a.jsxs("button",{onClick:ie,className:"bg-orange-100 text-orange-600 px-3 py-2 sm:px-4 rounded-lg hover:bg-orange-200 transition-colors flex items-center justify-center space-x-2 text-sm sm:text-base",title:"Clean up orders older than 24 hours",children:[a.jsx(Un,{className:"w-4 h-4 sm:w-5 sm:h-5"}),a.jsx("span",{className:"hidden sm:inline",children:"Cleanup"}),a.jsx("span",{className:"sm:hidden",children:"Clean"})]}),!1]})})]})})}),a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[a.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-4 gap-4 sm:gap-6 mb-8",children:[a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4 sm:p-6 border",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-600",children:"Active Orders"}),a.jsx("p",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:V.totalActiveOrders})]}),a.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-blue-50 rounded-lg flex items-center justify-center",children:a.jsx(XA,{className:"w-5 h-5 sm:w-6 sm:h-6 text-blue-600"})})]})}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4 sm:p-6 border",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-600",children:"Preparing"}),a.jsx("p",{className:"text-2xl sm:text-3xl font-bold text-orange-600",children:V.preparingOrders})]}),a.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-orange-50 rounded-lg flex items-center justify-center",children:a.jsx(hf,{className:"w-5 h-5 sm:w-6 sm:h-6 text-orange-600"})})]})}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4 sm:p-6 border",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-600",children:"Ready to Serve"}),a.jsx("p",{className:"text-2xl sm:text-3xl font-bold text-green-600",children:V.readyOrders})]}),a.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-green-50 rounded-lg flex items-center justify-center",children:a.jsx(Z6,{className:"w-5 h-5 sm:w-6 sm:h-6 text-green-600"})})]})}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4 sm:p-6 border",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-600",children:"Oldest Order"}),a.jsx("p",{className:"text-lg sm:text-lg font-bold text-gray-900",children:V.oldestOrder?`${oe(V.oldestOrder)}m ago`:"None"})]}),a.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-purple-50 rounded-lg flex items-center justify-center",children:a.jsx(sf,{className:"w-5 h-5 sm:w-6 sm:h-6 text-purple-600"})})]})})]}),s.length>0&&a.jsxs("div",{className:"mb-8",children:[a.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-500 to-purple-600 rounded-xl flex items-center justify-center",children:a.jsx(rd,{className:"w-5 h-5 text-white"})}),a.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Menu Portal Orders"}),a.jsxs("div",{className:"px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-sm font-medium",children:[s.length," order",s.length!==1?"s":""]})]}),a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 sm:gap-6",children:s.map(le=>{const ae=Ce(le.status),ve=ae.icon,we=oe(le.createdAt),De=we>20,Ve=le.status==="placed";return a.jsxs("div",{className:`bg-gradient-to-br from-blue-50 to-purple-50 rounded-xl shadow-lg border-2 ${Ve?"border-blue-400 ring-2 ring-blue-300 ring-opacity-50":ae.color} transition-all duration-200 hover:shadow-xl ${De?"ring-2 ring-red-500 ring-opacity-50":""}`,children:[a.jsxs("div",{className:"p-4 border-b border-blue-200",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(rd,{className:"w-5 h-5 text-blue-600"}),a.jsxs("span",{className:"text-lg font-bold text-gray-900",children:["#",le.orderNumber]})]}),a.jsxs("div",{className:`flex items-center space-x-2 ${ae.textColor}`,children:[a.jsx(ve,{className:"w-5 h-5"}),a.jsx("span",{className:"text-sm font-medium",children:ae.label})]})]}),a.jsxs("div",{className:"flex items-center justify-between text-sm",children:[a.jsxs("div",{className:"flex items-center space-x-1 text-blue-600",children:[a.jsx(rs,{className:"w-4 h-4"}),a.jsx("span",{className:"font-medium",children:(()=>{const me=d.find(Fe=>Fe.id===le.tableId);return me?`Table ${me.number} - ${me.area}`:"Online Order"})()})]}),a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx(sf,{className:"w-4 h-4"}),a.jsxs("span",{className:De?"text-red-600 font-medium":"text-gray-600",children:[we,"m ago"]}),De&&a.jsx(Go,{className:"w-4 h-4 text-red-500"})]})]}),(()=>{const me=d.find(Fe=>Fe.id===le.tableId);return a.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500 mt-1",children:[a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx(Jc,{className:"w-4 h-4"}),a.jsx("span",{children:Wn(le.createdAt)})]}),me&&a.jsxs("div",{className:"flex items-center space-x-1 text-blue-600",children:[a.jsx(Ls,{className:"w-4 h-4"}),a.jsxs("span",{className:"font-medium",children:[me.capacity," seats"]})]})]})})()]}),a.jsxs("div",{className:"p-4",children:[a.jsx("div",{className:"space-y-2 mb-4",children:le.items.map((me,Fe)=>a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("span",{className:"font-medium text-gray-900",children:me.name}),me.notes&&a.jsx("div",{className:"text-sm text-gray-600 mt-1",children:a.jsxs("em",{children:['"',me.notes,'"']})})]}),a.jsxs("span",{className:"bg-blue-100 text-blue-700 px-2 py-1 rounded-full text-sm font-medium",children:["x",me.quantity]})]},Fe))}),le.notes&&a.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 mb-4",children:a.jsxs("p",{className:"text-sm text-yellow-800",children:[a.jsx("strong",{children:"Customer Notes:"})," ",le.notes]})}),a.jsxs("div",{className:"space-y-2",children:[Ve&&a.jsxs("button",{onClick:()=>Ie(le.id),className:"w-full bg-gradient-to-r from-green-500 to-emerald-600 text-white py-3 px-4 rounded-lg hover:from-green-600 hover:to-emerald-700 transition-all duration-300 font-medium flex items-center justify-center space-x-2 shadow-lg",children:[a.jsx(Nr,{className:"w-5 h-5"}),a.jsx("span",{children:"Confirm Order"})]}),["confirmed","preparing","ready"].includes(le.status)&&a.jsxs("button",{onClick:()=>H(le),className:"w-full bg-gradient-to-r from-blue-500 to-indigo-600 text-white py-3 px-4 rounded-lg hover:from-blue-600 hover:to-indigo-700 transition-all duration-300 font-medium flex items-center justify-center space-x-2 shadow-lg",children:[a.jsx(No,{className:"w-5 h-5"}),a.jsx("span",{children:"Process Payment"})]})]})]})]},le.id)})})]}),i.length>0&&a.jsxs("div",{className:"mb-8",children:[a.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-orange-500 to-yellow-600 rounded-xl flex items-center justify-center",children:a.jsx(rs,{className:"w-5 h-5 text-white"})}),a.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Takeaway Orders"}),a.jsxs("div",{className:"px-3 py-1 bg-orange-100 text-orange-700 rounded-full text-sm font-medium",children:[i.length," order",i.length!==1?"s":""]})]}),a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 sm:gap-6",children:i.map(le=>{const ae=Ce(le.status),ve=ae.icon,we=oe(le.createdAt),De=we>15;return a.jsxs("div",{className:`bg-gradient-to-br from-orange-50 to-yellow-50 rounded-xl shadow-lg border-2 ${ae.color} transition-all duration-200 hover:shadow-xl ${De?"ring-2 ring-red-500 ring-opacity-50":""}`,children:[a.jsxs("div",{className:"p-4 border-b border-orange-200",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(rs,{className:"w-5 h-5 text-orange-600"}),a.jsxs("span",{className:"text-lg font-bold text-gray-900",children:["#",le.orderNumber]})]}),a.jsxs("div",{className:`flex items-center space-x-2 ${ae.textColor}`,children:[a.jsx(ve,{className:"w-5 h-5"}),a.jsx("span",{className:"text-sm font-medium",children:ae.label})]})]}),a.jsxs("div",{className:"flex items-center justify-between text-sm",children:[a.jsxs("div",{className:"flex items-center space-x-1 text-orange-600",children:[a.jsx(Hs,{className:"w-4 h-4"}),a.jsx("span",{className:"font-medium",children:le.customerName||"Walk-in Customer"})]}),a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx(sf,{className:"w-4 h-4"}),a.jsxs("span",{className:De?"text-red-600 font-medium":"text-gray-600",children:[we,"m ago"]}),De&&a.jsx(Go,{className:"w-4 h-4 text-red-500"})]})]}),a.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500 mt-1",children:[a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx(Jc,{className:"w-4 h-4"}),a.jsx("span",{children:Wn(le.createdAt)})]}),a.jsxs("div",{className:"flex items-center space-x-1 text-orange-600",children:[a.jsx(rs,{className:"w-4 h-4"}),a.jsx("span",{className:"font-medium text-xs bg-orange-100 px-2 py-1 rounded-full",children:"TAKEAWAY"})]})]})]}),a.jsxs("div",{className:"p-4",children:[a.jsx("div",{className:"space-y-2 mb-4",children:le.items.map((Ve,me)=>a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("span",{className:"font-medium text-gray-900",children:Ve.name}),Ve.notes&&a.jsx("div",{className:"text-sm text-gray-600 mt-1",children:a.jsxs("em",{children:['"',Ve.notes,'"']})})]}),a.jsxs("span",{className:"bg-orange-100 text-orange-700 px-2 py-1 rounded-full text-sm font-medium",children:["x",Ve.quantity]})]},me))}),le.notes&&a.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 mb-4",children:a.jsxs("p",{className:"text-sm text-yellow-800",children:[a.jsx("strong",{children:"Special Instructions:"})," ",le.notes]})}),a.jsx("div",{className:"space-y-2",children:a.jsxs("button",{onClick:()=>ue(le.id,"completed"),className:"w-full bg-gradient-to-r from-green-500 to-emerald-600 text-white py-3 px-4 rounded-lg hover:from-green-600 hover:to-emerald-700 transition-all duration-300 font-medium flex items-center justify-center space-x-2 shadow-lg",children:[a.jsx(Nr,{className:"w-5 h-5"}),a.jsx("span",{children:"Ready for Pickup"})]})})]})]},le.id)})})]}),l.length>0&&a.jsxs("div",{className:"mb-8",children:[a.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-orange-500 to-red-600 rounded-xl flex items-center justify-center",children:a.jsx(XA,{className:"w-5 h-5 text-white"})}),a.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Dine-in Orders"}),a.jsxs("div",{className:"px-3 py-1 bg-orange-100 text-orange-700 rounded-full text-sm font-medium",children:[l.length," order",l.length!==1?"s":""]})]}),a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 sm:gap-6",children:l.map(le=>{const ae=d.find(me=>me.id===le.tableId),ve=Ce(le.status),we=ve.icon,De=oe(le.createdAt),Ve=De>20;return a.jsxs("div",{className:`bg-white rounded-xl shadow-sm border-2 ${ve.color} transition-all duration-200 hover:shadow-md ${Ve?"ring-2 ring-red-500 ring-opacity-50":""}`,children:[a.jsxs("div",{className:"p-4 border-b border-gray-100",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("span",{className:"text-lg font-bold text-gray-900",children:["#",le.orderNumber]}),a.jsxs("div",{className:`flex items-center space-x-2 ${ve.textColor}`,children:[a.jsx(we,{className:"w-5 h-5"}),a.jsx("span",{className:"text-sm font-medium",children:ve.label})]})]}),a.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-600",children:[a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx(Ls,{className:"w-4 h-4"}),a.jsxs("span",{children:["Table ",(ae==null?void 0:ae.number)||"N/A"]})]}),a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx(sf,{className:"w-4 h-4"}),a.jsxs("span",{className:Ve?"text-red-600 font-medium":"",children:[De,"m ago"]}),Ve&&a.jsx(Go,{className:"w-4 h-4 text-red-500"})]})]}),a.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-500 mt-1",children:[a.jsx(Jc,{className:"w-4 h-4"}),a.jsx("span",{children:Wn(le.createdAt)})]})]}),a.jsxs("div",{className:"p-4",children:[a.jsx("div",{className:"space-y-2 mb-4",children:le.items.map((me,Fe)=>a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("span",{className:"font-medium text-gray-900",children:me.name}),me.notes&&a.jsx("div",{className:"text-sm text-gray-600 mt-1",children:a.jsxs("em",{children:['"',me.notes,'"']})})]}),a.jsxs("span",{className:"bg-gray-100 text-gray-700 px-2 py-1 rounded-full text-sm font-medium",children:["x",me.quantity]})]},Fe))}),le.notes&&a.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 mb-4",children:a.jsxs("p",{className:"text-sm text-yellow-800",children:[a.jsx("strong",{children:"Special Instructions:"})," ",le.notes]})}),a.jsx("div",{className:"space-y-2",children:a.jsxs("button",{onClick:()=>ue(le.id,"completed"),className:"w-full bg-green-600 text-white py-2 px-4 rounded-lg hover:bg-green-700 transition-colors font-medium flex items-center justify-center space-x-2",children:[a.jsx(Nr,{className:"w-5 h-5"}),a.jsx("span",{children:"Order Done"})]})})]})]},le.id)})})]}),e.length===0?a.jsxs("div",{className:"text-center py-12",children:[a.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx(rs,{className:"w-12 h-12 text-gray-400"})}),a.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No Active Orders"}),a.jsx("p",{className:"text-gray-600 mb-4",children:"All caught up! New orders will appear here automatically with sound and notifications."}),a.jsxs("div",{className:"text-center",children:[a.jsxs("div",{className:"mb-4",children:[a.jsxs("p",{className:"text-gray-600 mb-2",children:["Real-time monitoring is ",a.jsx("strong",{className:"text-green-600",children:"ACTIVE"})]}),a.jsx("p",{className:"text-sm text-gray-500",children:" Notifications enabled   Sound alerts enabled   Continuous monitoring"})]}),a.jsxs("button",{onClick:He,className:"bg-gradient-to-r from-green-500 to-emerald-600 text-white px-6 py-3 rounded-lg hover:from-green-600 hover:to-emerald-700 transition-all duration-200 font-medium",children:[a.jsx(fp,{className:"w-5 h-5 mr-2 inline"}),"Refresh & Get Orders"]})]})]}):null]}),S&&B&&a.jsx(yN,{isOpen:S,onClose:()=>{F(!1),k(null)},restaurant:t,table:{number:"Online",id:"customer-portal"},onPayment:je,isProcessing:te,cartItems:B.items.map(le=>({menuItemId:le.id||le.menuItemId||"",name:le.name,price:le.price,quantity:le.quantity,total:le.total,variants:le.variants||[]})),orders:[B],menuItems:D})]})}function uge(){const{restaurant:t}=js(),[e,r]=R.useState([]),[s,n]=R.useState([]),[i,o]=R.useState(!0),[l,c]=R.useState("single"),[d,u]=R.useState({isEnabled:!1,location:{latitude:0,longitude:0,address:"",radius:100},customization:{primaryColor:"#3B82F6",logo:"",welcomeMessage:"Welcome! Browse our menu and place your order.",orderingInstructions:"Scan the QR code at your table to get started."},security:{locationVerification:!0,phoneVerification:!0,maxOrderValue:5e3,operatingHours:{enabled:!0,open:"09:00",close:"22:00"}}}),[A,h]=R.useState(""),[f,p]=R.useState(""),[m,g]=R.useState(!1),[y,v]=R.useState({totalOrders:0,totalRevenue:0,averageOrderValue:0,conversionRate:0});R.useEffect(()=>{t&&(x(),E(),T(),C())},[t]);const x=async()=>{if(t)try{const W=await Ts.getMenuItemsForRestaurant(t.id);W.success&&W.data&&r(W.data.filter(Q=>Q.isAvailable))}catch(W){console.error("Failed to load menu items:",W)}finally{o(!1)}},E=async()=>{if(t)try{const W=await fs.getTablesForRestaurant(t.id);W.success&&W.data&&n(W.data.filter(Q=>Q.isActive))}catch(W){console.error("Failed to load tables:",W)}},T=()=>{if(!t)return;const W=localStorage.getItem(`portal_settings_${t.id}`);if(W)u(JSON.parse(W));else{console.log(" Initializing default portal settings for admin dashboard");const Q={isEnabled:!1,location:{latitude:0,longitude:0,address:"",radius:100},customization:{primaryColor:"#3B82F6",logo:"",welcomeMessage:`Welcome to ${t.name}! Browse our menu and place your order.`,orderingInstructions:"Scan the QR code at your table to get started."},security:{locationVerification:!0,phoneVerification:!0,maxOrderValue:5e3,operatingHours:{enabled:!1,open:"09:00",close:"22:00"}}};u(Q)}},j=async()=>{if(t)try{localStorage.setItem(`portal_settings_${t.id}`,JSON.stringify(d)),Z.success("Portal settings saved successfully!")}catch(W){console.error("Failed to save portal settings:",W),Z.error("Failed to save settings")}},C=()=>{if(!t)return;const Q=`${window.location.origin}/${t.slug}/menu-portal`;h(Q);const re=`https://api.qrserver.com/v1/create-qr-code/?size=300x300&data=${encodeURIComponent(Q)}`;p(re)},w=W=>t?`${window.location.origin}/${t.slug}/menu-portal/${W}`:"",S=W=>{const Q=w(W);return`https://api.qrserver.com/v1/create-qr-code/?size=300x300&data=${encodeURIComponent(Q)}`},F=W=>{const Q=w(W);navigator.clipboard.writeText(Q),Z.success("Table-specific URL copied to clipboard!")},B=(W,Q)=>{const re=S(W),G=document.createElement("a");G.href=re,G.download=`${(t==null?void 0:t.name)||"restaurant"}-table-${Q}-qr.png`,G.click()},k=async()=>{if(!navigator.geolocation){Z.error("Geolocation is not supported by this browser");return}try{const W=await new Promise((G,Ae)=>{navigator.geolocation.getCurrentPosition(G,Ae,{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})}),{latitude:Q,longitude:re}=W.coords;u(G=>({...G,location:{latitude:Q,longitude:re,address:`${Q.toFixed(6)}, ${re.toFixed(6)}`,radius:G.location.radius}})),Z.success("Restaurant location set successfully!")}catch(W){console.error("Error getting location:",W),Z.error("Failed to get location. Please try again.")}},D=()=>{navigator.clipboard.writeText(A),Z.success("Portal URL copied to clipboard!")},q=()=>{const W=document.createElement("a");W.href=f,W.download=`${(t==null?void 0:t.name)||"restaurant"}-menu-qr.png`,W.click()},te=async()=>{if(!d.isEnabled&&(!d.location.latitude||!d.location.longitude)){Z.error("Please set restaurant location first!");return}u(W=>({...W,isEnabled:!W.isEnabled})),setTimeout(()=>{j()},100)};return i?a.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Loading Customer Portal..."})]})}):a.jsxs("div",{className:"min-h-screen bg-gray-50",children:[a.jsx("div",{className:"bg-white shadow-sm border-b",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-purple-500 to-pink-600 rounded-2xl flex items-center justify-center",children:a.jsx(rd,{className:"w-6 h-6 text-white"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Customer Menu Portal"}),a.jsx("p",{className:"text-gray-600",children:"Enable customers to order directly from their phones"})]})]}),a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsxs("div",{className:`flex items-center space-x-2 px-3 py-2 rounded-full text-sm ${d.isEnabled?"bg-green-100 text-green-700":"bg-gray-100 text-gray-600"}`,children:[a.jsx("div",{className:`w-2 h-2 rounded-full ${d.isEnabled?"bg-green-500":"bg-gray-400"}`}),a.jsx("span",{children:d.isEnabled?"Portal Active":"Portal Inactive"})]}),a.jsx("button",{onClick:te,className:`px-6 py-2 rounded-lg font-medium transition-colors ${d.isEnabled?"bg-red-600 text-white hover:bg-red-700":"bg-green-600 text-white hover:bg-green-700"}`,children:d.isEnabled?"Disable Portal":"Enable Portal"})]})]})})}),a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[a.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-6",children:[a.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[a.jsx(ta,{className:"w-6 h-6 text-blue-600"}),a.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Restaurant Location"})]}),d.location.latitude?a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-start space-x-3 p-4 bg-green-50 rounded-lg",children:[a.jsx(Nr,{className:"w-5 h-5 text-green-600 mt-0.5"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h4",{className:"font-medium text-green-900",children:"Location Set Successfully"}),a.jsx("p",{className:"text-green-700 mt-1",children:d.location.address}),a.jsxs("p",{className:"text-green-600 text-sm mt-1",children:["Coordinates: ",d.location.latitude.toFixed(6),", ",d.location.longitude.toFixed(6)]})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Verification Radius (meters)"}),a.jsx("input",{type:"number",value:d.location.radius,onChange:W=>u(Q=>({...Q,location:{...Q.location,radius:parseInt(W.target.value)||100}})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",min:"50",max:"500"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Recommended: 100-200 meters"})]}),a.jsx("div",{className:"flex items-end",children:a.jsxs("button",{onClick:k,className:"w-full bg-gray-100 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-200 transition-colors",children:[a.jsx(Di,{className:"w-4 h-4 mr-2 inline"}),"Update Location"]})})]})]}):a.jsxs("div",{className:"text-center py-8",children:[a.jsx(ta,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Set Your Restaurant Location"}),a.jsx("p",{className:"text-gray-600 mb-6",children:"This helps verify customers are actually at your restaurant when placing orders."}),a.jsxs("button",{onClick:k,className:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors font-medium",children:[a.jsx(ta,{className:"w-5 h-5 mr-2 inline"}),"Set Restaurant Location"]})]})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-6",children:[a.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[a.jsx(Xte,{className:"w-6 h-6 text-purple-600"}),a.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Portal Customization"})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Welcome Message"}),a.jsx("input",{type:"text",value:d.customization.welcomeMessage,onChange:W=>u(Q=>({...Q,customization:{...Q.customization,welcomeMessage:W.target.value}})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Welcome! Browse our menu and place your order."})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ordering Instructions"}),a.jsx("input",{type:"text",value:d.customization.orderingInstructions,onChange:W=>u(Q=>({...Q,customization:{...Q.customization,orderingInstructions:W.target.value}})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Scan the QR code at your table to get started."})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Brand Colors & Appearance"}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-2",children:"Primary Brand Color"}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("input",{type:"color",value:d.customization.primaryColor,onChange:W=>u(Q=>({...Q,customization:{...Q.customization,primaryColor:W.target.value}})),className:"w-12 h-10 border border-gray-300 rounded-lg cursor-pointer"}),a.jsx("input",{type:"text",value:d.customization.primaryColor,onChange:W=>u(Q=>({...Q,customization:{...Q.customization,primaryColor:W.target.value}})),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"#6366F1"})]}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Used for selected categories and action buttons"})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-2",children:"Quick Color Presets"}),a.jsx("div",{className:"grid grid-cols-6 gap-2",children:[{name:"Blue",color:"#3B82F6"},{name:"Purple",color:"#8B5CF6"},{name:"Pink",color:"#EC4899"},{name:"Red",color:"#EF4444"},{name:"Orange",color:"#F97316"},{name:"Green",color:"#10B981"},{name:"Teal",color:"#14B8A6"},{name:"Indigo",color:"#6366F1"},{name:"Rose",color:"#F43F5E"},{name:"Emerald",color:"#059669"},{name:"Violet",color:"#7C3AED"},{name:"Amber",color:"#F59E0B"}].map(W=>a.jsx("button",{onClick:()=>u(Q=>({...Q,customization:{...Q.customization,primaryColor:W.color}})),className:`w-10 h-10 rounded-lg border-2 transition-all duration-200 hover:scale-110 ${d.customization.primaryColor===W.color?"border-gray-900 ring-2 ring-gray-400":"border-gray-300 hover:border-gray-400"}`,style:{backgroundColor:W.color},title:W.name},W.name))})]}),a.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 bg-gray-50",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-2",children:"Preview"}),a.jsxs("div",{className:"flex space-x-2",children:[a.jsx("div",{className:"px-4 py-2 rounded-lg text-white font-medium text-sm",style:{backgroundColor:d.customization.primaryColor},children:"Selected Category"}),a.jsx("div",{className:"px-4 py-2 rounded-lg bg-white border border-gray-200 text-gray-700 font-medium text-sm",children:"Unselected Category"})]})]})]})]})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-6",children:[a.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[a.jsx(Sl,{className:"w-6 h-6 text-gray-600"}),a.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Security Settings"})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-gray-900",children:"Location Verification"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Verify customers are at restaurant location"})]}),a.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:d.security.locationVerification,onChange:W=>u(Q=>({...Q,security:{...Q.security,locationVerification:W.target.checked}})),className:"sr-only peer"}),a.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),a.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-gray-900",children:"Phone Verification"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Require phone number verification for orders"})]}),a.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:d.security.phoneVerification,onChange:W=>u(Q=>({...Q,security:{...Q.security,phoneVerification:W.target.checked}})),className:"sr-only peer"}),a.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Max Order Value ()"}),a.jsx("input",{type:"number",value:d.security.maxOrderValue,onChange:W=>u(Q=>({...Q,security:{...Q.security,maxOrderValue:parseInt(W.target.value)||5e3}})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",min:"500",max:"50000",step:"500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Operating Hours"}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"time",value:d.security.operatingHours.open,onChange:W=>u(Q=>({...Q,security:{...Q.security,operatingHours:{...Q.security.operatingHours,open:W.target.value}}})),className:"px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),a.jsx("span",{className:"text-gray-500",children:"-"}),a.jsx("input",{type:"time",value:d.security.operatingHours.close,onChange:W=>u(Q=>({...Q,security:{...Q.security,operatingHours:{...Q.security.operatingHours,close:W.target.value}}})),className:"px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]})]})]})]}),a.jsx("div",{className:"flex items-center space-x-4",children:a.jsx("button",{onClick:j,className:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors font-medium",children:"Save Settings"})})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-6",children:[a.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[a.jsx(Sl,{className:"w-6 h-6 text-indigo-600"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Portal Type"})]}),a.jsx("div",{className:"space-y-4",children:a.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[a.jsxs("label",{className:"flex items-center p-4 border-2 border-gray-200 rounded-lg cursor-pointer hover:border-blue-300 transition-colors",children:[a.jsx("input",{type:"radio",name:"portalType",value:"single",checked:l==="single",onChange:W=>c(W.target.value),className:"w-4 h-4 text-blue-600 border-gray-300 focus:ring-blue-500"}),a.jsxs("div",{className:"ml-3",children:[a.jsx("div",{className:"text-sm font-medium text-gray-900",children:"Single Portal Link"}),a.jsx("div",{className:"text-sm text-gray-500",children:"One link for entire restaurant (current functionality)"})]})]}),a.jsxs("label",{className:"flex items-center p-4 border-2 border-gray-200 rounded-lg cursor-pointer hover:border-blue-300 transition-colors",children:[a.jsx("input",{type:"radio",name:"portalType",value:"table-specific",checked:l==="table-specific",onChange:W=>c(W.target.value),className:"w-4 h-4 text-blue-600 border-gray-300 focus:ring-blue-500"}),a.jsxs("div",{className:"ml-3",children:[a.jsx("div",{className:"text-sm font-medium text-gray-900",children:"Table-Specific Links"}),a.jsx("div",{className:"text-sm text-gray-500",children:"Separate link for each table with table tracking"})]})]})]})})]}),l==="single"?a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-6",children:[a.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[a.jsx(dM,{className:"w-6 h-6 text-green-600"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"General Portal Access"})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Portal URL"}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"text",value:A,readOnly:!0,className:"flex-1 px-3 py-2 bg-gray-50 border border-gray-300 rounded-lg text-sm"}),a.jsx("button",{onClick:D,className:"p-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",title:"Copy URL",children:a.jsx(po,{className:"w-4 h-4 text-gray-600"})})]})]}),f&&a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"inline-block p-4 bg-white border-2 border-gray-200 rounded-xl",children:a.jsx("img",{src:f,alt:"Portal QR Code",className:"w-48 h-48"})}),a.jsxs("div",{className:"flex items-center justify-center space-x-2 mt-4",children:[a.jsxs("button",{onClick:q,className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors text-sm font-medium",children:[a.jsx(Yn,{className:"w-4 h-4 mr-2 inline"}),"Download QR"]}),a.jsxs("a",{href:A,target:"_blank",rel:"noopener noreferrer",className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors text-sm font-medium",children:[a.jsx(Xs,{className:"w-4 h-4 mr-2 inline"}),"Preview"]})]})]})]})]}):a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-6",children:[a.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[a.jsx(Ls,{className:"w-6 h-6 text-purple-600"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Table-Specific Links"}),a.jsxs("span",{className:"px-2 py-1 bg-purple-100 text-purple-700 rounded-full text-xs font-medium",children:[s.length," Tables"]})]}),a.jsx("div",{className:"space-y-4 max-h-96 overflow-y-auto",children:s.length===0?a.jsxs("div",{className:"text-center py-8",children:[a.jsx(Ls,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),a.jsx("p",{className:"text-gray-500",children:"No tables found. Please add tables first."})]}):a.jsx("div",{className:"space-y-3",children:Object.entries(s.reduce((W,Q)=>(W[Q.area]||(W[Q.area]=[]),W[Q.area].push(Q),W),{})).map(([W,Q])=>a.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[a.jsxs("h4",{className:"font-medium text-gray-900 mb-3 flex items-center",children:[a.jsx(ta,{className:"w-4 h-4 mr-2 text-gray-500"}),W,a.jsxs("span",{className:"ml-2 px-2 py-1 bg-gray-100 text-gray-600 rounded-full text-xs",children:[Q.length," tables"]})]}),a.jsx("div",{className:"grid grid-cols-1 gap-2",children:Q.map(re=>a.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-8 h-8 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center text-sm font-medium",children:re.number}),a.jsxs("div",{children:[a.jsxs("div",{className:"text-sm font-medium text-gray-900",children:["Table ",re.number]}),a.jsxs("div",{className:"text-xs text-gray-500",children:[re.capacity," seats"]})]})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("button",{onClick:()=>F(re.id),className:"p-2 bg-white hover:bg-gray-100 rounded-lg transition-colors border",title:"Copy Table URL",children:a.jsx(po,{className:"w-4 h-4 text-gray-600"})}),a.jsx("button",{onClick:()=>B(re.id,re.number),className:"p-2 bg-white hover:bg-gray-100 rounded-lg transition-colors border",title:"Download Table QR",children:a.jsx(Yn,{className:"w-4 h-4 text-gray-600"})}),a.jsx("a",{href:w(re.id),target:"_blank",rel:"noopener noreferrer",className:"p-2 bg-white hover:bg-gray-100 rounded-lg transition-colors border",title:"Preview Table Portal",children:a.jsx(Xs,{className:"w-4 h-4 text-gray-600"})})]})]},re.id))})]},W))})})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-6",children:[a.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[a.jsx(Ls,{className:"w-6 h-6 text-indigo-600"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Portal Overview"})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Menu Items"}),a.jsx("span",{className:"font-semibold text-gray-900",children:e.length})]}),a.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Portal Status"}),a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${d.isEnabled?"bg-green-100 text-green-700":"bg-gray-100 text-gray-600"}`,children:d.isEnabled?"Active":"Inactive"})]}),a.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Location Set"}),a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${d.location.latitude?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:d.location.latitude?"Yes":"No"})]}),a.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Security Level"}),a.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 rounded-full text-xs font-medium",children:d.security.locationVerification&&d.security.phoneVerification?"High":d.security.locationVerification||d.security.phoneVerification?"Medium":"Basic"})]})]})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Quick Actions"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("a",{href:`/${t==null?void 0:t.slug}/menu`,className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[a.jsx(XA,{className:"w-5 h-5 text-gray-600"}),a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Manage Menu"}),a.jsx(D0,{className:"w-4 h-4 text-gray-400 ml-auto"})]}),a.jsxs("a",{href:`/${t==null?void 0:t.slug}/orders`,className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[a.jsx(Zi,{className:"w-5 h-5 text-gray-600"}),a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"View Orders"}),a.jsx(D0,{className:"w-4 h-4 text-gray-400 ml-auto"})]}),a.jsxs("a",{href:`/${t==null?void 0:t.slug}/kitchen`,className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[a.jsx(hf,{className:"w-5 h-5 text-gray-600"}),a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Kitchen Display"}),a.jsx(D0,{className:"w-4 h-4 text-gray-400 ml-auto"})]})]})]})]})]})})]})}const Um="expenses",k1=new Map,Age=5*60*1e3;class r0{static async createExpense(e,r,s){try{let n=r.categoryId;try{const{ExpenseCategoryService:d}=await Pn(async()=>{const{ExpenseCategoryService:A}=await Promise.resolve().then(()=>hP);return{ExpenseCategoryService:A}},void 0),u=await d.getCategoryById(e,r.categoryId);u.success&&u.data&&(n=u.data.name)}catch(d){console.warn("Failed to fetch category name, using ID:",d)}const i={id:An(),restaurantId:e,categoryId:r.categoryId,categoryName:n,title:r.title,description:r.description||"",amount:r.amount,currency:"INR",paymentMethod:r.paymentMethod,expenseDate:wt.fromDate(r.expenseDate),dueDate:r.dueDate?wt.fromDate(r.dueDate):null,paidDate:null,status:"approved",approvedBy:s,approvedAt:wt.now(),rejectionReason:null,vendor:r.vendor||null,receiptImage:r.receiptImage||null,invoiceNumber:r.invoiceNumber||null,reference:r.reference||null,notes:r.notes||null,isRecurring:r.isRecurring||!1,recurrence:r.recurrence||null,tags:r.tags||[],createdBy:s,updatedBy:null,createdAt:wt.now(),updatedAt:wt.now()},o=Jt(st,"restaurants",e,Um),l=await Bi(o,i);this.clearCache(e);const c=this.convertFirestoreDoc({...i,id:l.id},l.id);return console.log(" Expense created successfully:",c.id),{success:!0,data:c,message:"Expense created successfully"}}catch(n){return console.error(" Failed to create expense:",n),{success:!1,error:Xt(n)}}}static async getExpensesForRestaurant(e,r,s){try{const n=`${e}_${JSON.stringify(r)}`,i=k1.get(n);if(i&&Date.now()<i.expiresAt&&!(r!=null&&r.dateRange))return{success:!0,data:i.expenses};const o=Jt(st,"restaurants",e,Um);let l=Zt(o,On("createdAt","desc"));r&&(r.categoryIds&&r.categoryIds.length>0&&(l=Zt(l,Yt("categoryId","in",r.categoryIds))),r.status&&r.status.length>0&&(l=Zt(l,Yt("status","in",r.status))),r.paymentMethods&&r.paymentMethods.length>0&&(l=Zt(l,Yt("paymentMethod","in",r.paymentMethods))),r.isRecurring!==void 0&&(l=Zt(l,Yt("isRecurring","==",r.isRecurring)))),s!=null&&s.limit&&(l=Zt(l,Wi(s.limit))),s!=null&&s.startAfter&&(l=Zt(l,ate(s.startAfter)));let d=(await ur(l)).docs.map(u=>this.convertFirestoreDoc(u.data(),u.id));if(d=await this.populateCategoryNames(e,d),r&&(r.dateRange&&(d=d.filter(u=>{const A=u.expenseDate;return A>=r.dateRange.start&&A<=r.dateRange.end})),r.amountRange&&(d=d.filter(u=>u.amount>=(r.amountRange.min||0)&&u.amount<=(r.amountRange.max||1/0))),r.vendors&&r.vendors.length>0&&(d=d.filter(u=>u.vendor&&r.vendors.includes(u.vendor.name))),r.tags&&r.tags.length>0&&(d=d.filter(u=>u.tags&&u.tags.some(A=>r.tags.includes(A)))),r.searchTerm)){const u=r.searchTerm.toLowerCase();d=d.filter(A=>{var h,f;return A.title.toLowerCase().includes(u)||((h=A.description)==null?void 0:h.toLowerCase().includes(u))||((f=A.vendor)==null?void 0:f.name.toLowerCase().includes(u))})}return!(r!=null&&r.dateRange)&&!(r!=null&&r.amountRange)&&!(r!=null&&r.searchTerm)&&k1.set(n,{expenses:d,timestamp:Date.now(),expiresAt:Date.now()+Age}),{success:!0,data:d}}catch(n){return console.error(" Failed to get expenses:",n),{success:!1,error:Xt(n)}}}static async getExpenseById(e,r){try{const s=Rt(st,"restaurants",e,Um,r),n=await Kr(s);return n.exists()?{success:!0,data:this.convertFirestoreDoc(n.data(),n.id)}:{success:!1,error:"Expense not found"}}catch(s){return console.error(" Failed to get expense:",s),{success:!1,error:Xt(s)}}}static async updateExpense(e,r,s,n){try{const i=Rt(st,"restaurants",e,Um,r),o={...s,updatedBy:n,updatedAt:wt.now()};s.expenseDate&&(o.expenseDate=wt.fromDate(s.expenseDate)),s.dueDate&&(o.dueDate=wt.fromDate(s.dueDate)),await Xr(i,o),this.clearCache(e);const l=await this.getExpenseById(e,r);return console.log(" Expense updated successfully:",r),l}catch(i){return console.error(" Failed to update expense:",i),{success:!1,error:Xt(i)}}}static async deleteExpense(e,r){try{const s=Rt(st,"restaurants",e,Um,r);return await Pl(s),this.clearCache(e),console.log(" Expense deleted successfully:",r),{success:!0,message:"Expense deleted successfully"}}catch(s){return console.error(" Failed to delete expense:",s),{success:!1,error:Xt(s)}}}static async approveExpense(e,r,s){try{const n={status:"approved",approvedBy:s,approvedAt:new Date,rejectionReason:null};return await this.updateExpense(e,r,n,s)}catch(n){return console.error(" Failed to approve expense:",n),{success:!1,error:Xt(n)}}}static async rejectExpense(e,r,s,n){try{const i={status:"rejected",rejectionReason:s,approvedBy:null,approvedAt:null};return await this.updateExpense(e,r,i,n)}catch(i){return console.error(" Failed to reject expense:",i),{success:!1,error:Xt(i)}}}static async markAsPaid(e,r,s){try{const n={status:"paid",paidDate:new Date};return await this.updateExpense(e,r,n,s)}catch(n){return console.error(" Failed to mark expense as paid:",n),{success:!1,error:Xt(n)}}}static async getExpenseStats(e){try{const r=await this.getExpensesForRestaurant(e);if(!r.success||!r.data)return{success:!1,error:r.error||"Failed to fetch expenses"};const s=r.data,n=new Date,i=new Date(n.getFullYear(),n.getMonth(),n.getDate(),0,0,0,0),o=new Date(n.getFullYear(),n.getMonth(),n.getDate(),23,59,59,999),l=new Date(n.getTime()-7*24*60*60*1e3);l.setHours(0,0,0,0);const c=new Date(n.getFullYear(),n.getMonth(),1,0,0,0,0),d=new Date(n.getFullYear(),0,1,0,0,0,0),u=s.filter(F=>F.expenseDate>=i&&F.expenseDate<=o).reduce((F,B)=>F+B.amount,0),A=s.filter(F=>F.expenseDate>=l).reduce((F,B)=>F+B.amount,0),h=s.filter(F=>F.expenseDate>=c).reduce((F,B)=>F+B.amount,0),f=s.filter(F=>F.expenseDate>=d).reduce((F,B)=>F+B.amount,0),p=s.filter(F=>F.status==="pending").length,m=s.filter(F=>F.dueDate&&F.dueDate<n&&F.status!=="paid").length,g=s.filter(F=>F.isRecurring).length,y=new Date(n.getFullYear(),n.getMonth()+1,0).getDate(),v=n.getDate(),x=v>0?h/v:0,E=n.getMonth()+1,T=E>0?f/E:0,j=new Map;s.forEach(F=>{const B=F.categoryId,k=F.categoryName||F.categoryId||"Unknown",D=j.get(B)||{amount:0,name:k};j.set(B,{amount:D.amount+F.amount,name:k})});const C=Array.from(j.entries()).sort(([,F],[,B])=>B.amount-F.amount)[0],w=C?{id:C[0],name:C[1].name,amount:C[1].amount}:{id:"",name:"No expenses",amount:0};return{success:!0,data:{todayExpenses:u,weekExpenses:A,monthExpenses:h,yearExpenses:f,pendingExpenses:p,overdueExpenses:m,recurringExpenses:g,avgDailyExpense:x,avgMonthlyExpense:T,totalExpenseCount:s.length,approvedExpenses:s.filter(F=>F.status==="approved").length,paidExpenses:s.filter(F=>F.status==="paid").length,rejectedExpenses:s.filter(F=>F.status==="rejected").length,topCategory:w,recentExpenses:s}}}catch(r){return console.error(" Failed to get expense stats:",r),{success:!1,error:Xt(r)}}}static async getExpenseAnalytics(e){try{const r=await this.getExpensesForRestaurant(e);if(!r.success||!r.data)return{success:!1,error:r.error||"Failed to fetch expenses"};const s=r.data,n=s.reduce((x,E)=>x+E.amount,0),i=new Date,o=new Date(i.getFullYear(),i.getMonth(),1),l=new Date(i.getFullYear(),0,1),c=s.filter(x=>x.expenseDate>=o).reduce((x,E)=>x+E.amount,0),d=s.filter(x=>x.expenseDate>=l).reduce((x,E)=>x+E.amount,0),u=d/(i.getMonth()+1),A=new Map;s.forEach(x=>{const E=x.categoryId,T=A.get(E)||{amount:0,count:0};A.set(E,{amount:T.amount+x.amount,count:T.count+1})});const h=Array.from(A.entries()).map(([x,E])=>{const T=s.find(j=>j.categoryId===x);return{categoryId:x,categoryName:(T==null?void 0:T.categoryName)||x,amount:E.amount,percentage:n>0?E.amount/n*100:0,count:E.count}}),f=[];for(let x=11;x>=0;x--){const E=new Date(i.getFullYear(),i.getMonth()-x,1),T=new Date(i.getFullYear(),i.getMonth()-x+1,1),j=s.filter(C=>C.expenseDate>=E&&C.expenseDate<T);f.push({month:E.toLocaleDateString("en-US",{month:"short",year:"numeric"}),amount:j.reduce((C,w)=>C+w.amount,0),count:j.length})}const p=new Map;s.forEach(x=>{var E;if((E=x.vendor)!=null&&E.name){const T=p.get(x.vendor.name)||{amount:0,count:0};p.set(x.vendor.name,{amount:T.amount+x.amount,count:T.count+1})}});const m=Array.from(p.entries()).map(([x,E])=>({vendorName:x,amount:E.amount,count:E.count})).sort((x,E)=>E.amount-x.amount).slice(0,10),g=new Map;s.forEach(x=>{const E=g.get(x.paymentMethod)||{amount:0,count:0};g.set(x.paymentMethod,{amount:E.amount+x.amount,count:E.count+1})});const y=Array.from(g.entries()).map(([x,E])=>({method:x,amount:E.amount,percentage:n>0?E.amount/n*100:0,count:E.count}));return{success:!0,data:{totalExpenses:n,monthlyExpenses:c,yearlyExpenses:d,averageMonthlyExpense:u,categoryBreakdown:h,monthlyTrends:f,topVendors:m,budgetPerformance:[],paymentMethodBreakdown:y}}}catch(r){return console.error(" Failed to get expense analytics:",r),{success:!1,error:Xt(r)}}}static subscribeToExpenses(e,r,s){try{const n=Jt(st,"restaurants",e,Um);let i=Zt(n,On("createdAt","desc"));return s!=null&&s.categoryIds&&s.categoryIds.length>0&&(i=Zt(i,Yt("categoryId","in",s.categoryIds))),s!=null&&s.status&&s.status.length>0&&(i=Zt(i,Yt("status","in",s.status))),Of(i,l=>{let c=l.docs.map(d=>this.convertFirestoreDoc(d.data(),d.id));if(s&&(s.dateRange&&(c=c.filter(d=>{const u=d.expenseDate;return u>=s.dateRange.start&&u<=s.dateRange.end})),s.searchTerm)){const d=s.searchTerm.toLowerCase();c=c.filter(u=>{var A,h;return u.title.toLowerCase().includes(d)||((A=u.description)==null?void 0:A.toLowerCase().includes(d))||((h=u.vendor)==null?void 0:h.name.toLowerCase().includes(d))})}r(c)})}catch(n){return console.error(" Failed to subscribe to expenses:",n),()=>{}}}static convertFirestoreDoc(e,r){var s,n,i,o,l,c;return{id:r,restaurantId:e.restaurantId,categoryId:e.categoryId,categoryName:e.categoryName,title:e.title,description:e.description,amount:e.amount,currency:e.currency,paymentMethod:e.paymentMethod,expenseDate:((s=e.expenseDate)==null?void 0:s.toDate())||new Date,dueDate:((n=e.dueDate)==null?void 0:n.toDate())||null,paidDate:((i=e.paidDate)==null?void 0:i.toDate())||null,status:e.status,approvedBy:e.approvedBy,approvedAt:((o=e.approvedAt)==null?void 0:o.toDate())||null,rejectionReason:e.rejectionReason,vendor:e.vendor,receiptImage:e.receiptImage,invoiceNumber:e.invoiceNumber,reference:e.reference,notes:e.notes,isRecurring:e.isRecurring||!1,recurrence:e.recurrence,tags:e.tags||[],createdBy:e.createdBy,updatedBy:e.updatedBy,createdAt:((l=e.createdAt)==null?void 0:l.toDate())||new Date,updatedAt:((c=e.updatedAt)==null?void 0:c.toDate())||new Date}}static clearCache(e){Array.from(k1.keys()).forEach(r=>{r.startsWith(e)&&k1.delete(r)})}static async populateCategoryNames(e,r){try{const s=[...new Set(r.map(l=>l.categoryId))],n=new Map,{ExpenseCategoryService:i}=await Pn(async()=>{const{ExpenseCategoryService:l}=await Promise.resolve().then(()=>hP);return{ExpenseCategoryService:l}},void 0),o=await i.getCategoriesForRestaurant(e);return o.success&&o.data&&o.data.forEach(l=>{n.set(l.id,l.name)}),r.map(l=>({...l,categoryName:n.get(l.categoryId)||l.categoryName||l.categoryId}))}catch(s){return console.warn("Failed to populate category names:",s),r}}static async getExpensesForPeriod(e,r,s){try{const n={dateRange:{start:new Date(r.getFullYear(),r.getMonth(),r.getDate(),0,0,0,0),end:new Date(s.getFullYear(),s.getMonth(),s.getDate(),23,59,59,999)}},i=await this.getExpensesForRestaurant(e,n);return i.success&&i.data&&console.log(` Retrieved ${i.data.length} expenses for period ${r.toLocaleDateString()} to ${s.toLocaleDateString()}`),i}catch(n){return console.error(" Failed to get expenses for period:",n),{success:!1,error:Xt(n)}}}static async getExpenseSummaryForPeriod(e,r,s){try{const n=await this.getExpensesForPeriod(e,r,s);if(!n.success||!n.data)return{success:!1,error:n.error||"Failed to fetch expenses for period"};const i=n.data,o=i.reduce((A,h)=>A+h.amount,0),l=i.length,c=l>0?o/l:0,d=l>0?Math.max(...i.map(A=>A.amount)):0,u=i.reduce((A,h)=>{const f=h.categoryName||h.categoryId||"Unknown";return A[f]=(A[f]||0)+h.amount,A},{});return{success:!0,data:{totalAmount:o,expenseCount:l,categoryBreakdown:u,averageExpense:c,largestExpense:d,expenses:i}}}catch(n){return console.error(" Failed to get expense summary for period:",n),{success:!1,error:Xt(n)}}}}const Gu="expenseCategories",AP=[{name:"Staff Salaries",description:"Employee wages, salaries, and benefits",color:"#3B82F6",icon:"Users",isDefault:!0,isActive:!0,budget:{monthlyLimit:1e5,alertThreshold:80}},{name:"Inventory & Supplies",description:"Food ingredients, beverages, and raw materials",color:"#10B981",icon:"Package",isDefault:!0,isActive:!0,budget:{monthlyLimit:5e4,alertThreshold:85}},{name:"Utilities",description:"Electricity, water, gas, internet, and phone bills",color:"#F59E0B",icon:"Zap",isDefault:!0,isActive:!0,budget:{monthlyLimit:15e3,alertThreshold:75}},{name:"Rent & Property",description:"Restaurant rent, property taxes, and maintenance",color:"#8B5CF6",icon:"Building",isDefault:!0,isActive:!0,budget:{monthlyLimit:8e4,alertThreshold:90}},{name:"Marketing & Advertising",description:"Promotional activities, social media ads, and campaigns",color:"#EF4444",icon:"Megaphone",isDefault:!0,isActive:!0,budget:{monthlyLimit:2e4,alertThreshold:70}},{name:"Equipment & Technology",description:"Kitchen equipment, POS systems, and technology upgrades",color:"#6366F1",icon:"Laptop",isDefault:!0,isActive:!0,budget:{monthlyLimit:25e3,alertThreshold:80}},{name:"Maintenance & Repairs",description:"Equipment repairs, cleaning supplies, and facility maintenance",color:"#84CC16",icon:"Wrench",isDefault:!0,isActive:!0,budget:{monthlyLimit:12e3,alertThreshold:75}},{name:"Professional Services",description:"Accounting, legal, consulting, and professional fees",color:"#06B6D4",icon:"FileText",isDefault:!0,isActive:!0,budget:{monthlyLimit:1e4,alertThreshold:80}},{name:"Insurance",description:"Business insurance, liability coverage, and worker compensation",color:"#EC4899",icon:"Shield",isDefault:!0,isActive:!0,budget:{monthlyLimit:8e3,alertThreshold:90}},{name:"Transportation",description:"Delivery vehicles, fuel, and transportation costs",color:"#F97316",icon:"Truck",isDefault:!0,isActive:!0,budget:{monthlyLimit:15e3,alertThreshold:75}},{name:"Taxes & Fees",description:"Government taxes, licensing fees, and regulatory compliance",color:"#64748B",icon:"Receipt",isDefault:!0,isActive:!0,budget:{monthlyLimit:2e4,alertThreshold:85}},{name:"Miscellaneous",description:"Other business expenses not covered in specific categories",color:"#6B7280",icon:"MoreHorizontal",isDefault:!0,isActive:!0,budget:{monthlyLimit:5e3,alertThreshold:70}}],B1=new Map,hge=10*60*1e3;class yS{static async initializeDefaultCategories(e,r){try{const s=jl(st),n=[];for(const i of AP){const o=An(),l={...i,id:o,restaurantId:e,createdBy:r,createdAt:wt.now(),updatedAt:wt.now()},c=Rt(st,"restaurants",e,Gu,o);s.set(c,l),n.push(this.convertFirestoreDoc(l,o))}return await s.commit(),this.clearCache(e),console.log(" Default expense categories initialized:",n.length),{success:!0,data:n,message:"Default expense categories initialized successfully"}}catch(s){return console.error(" Failed to initialize default categories:",s),{success:!1,error:Xt(s)}}}static async createCategory(e,r,s){try{const n=An(),i={...r,id:n,restaurantId:e,createdBy:s,isDefault:!1,createdAt:wt.now(),updatedAt:wt.now()},o=Rt(st,"restaurants",e,Gu,n);await Bi(Jt(st,"restaurants",e,Gu),i),this.clearCache(e);const l=this.convertFirestoreDoc(i,n);return console.log(" Expense category created successfully:",l.id),{success:!0,data:l,message:"Expense category created successfully"}}catch(n){return console.error(" Failed to create expense category:",n),{success:!1,error:Xt(n)}}}static async getCategoriesForRestaurant(e){try{const r=B1.get(e);if(r&&Date.now()<r.expiresAt)return{success:!0,data:r.categories};const s=Jt(st,"restaurants",e,Gu),n=Zt(s,On("name","asc")),o=(await ur(n)).docs.map(l=>this.convertFirestoreDoc(l.data(),l.id)).sort((l,c)=>l.isDefault!==c.isDefault?l.isDefault?-1:1:l.name.localeCompare(c.name));return o.length===0?(console.log("No expense categories found, initializing defaults..."),await this.initializeDefaultCategories(e,"system")):(B1.set(e,{categories:o,timestamp:Date.now(),expiresAt:Date.now()+hge}),{success:!0,data:o})}catch(r){return console.error(" Failed to get expense categories:",r),{success:!1,error:Xt(r)}}}static async getActiveCategoriesForRestaurant(e){try{const r=await this.getCategoriesForRestaurant(e);return r.success&&r.data?{success:!0,data:r.data.filter(n=>n.isActive)}:r}catch(r){return console.error(" Failed to get active expense categories:",r),{success:!1,error:Xt(r)}}}static async getCategoryById(e,r){try{const s=Rt(st,"restaurants",e,Gu,r),n=await Kr(s);return n.exists()?{success:!0,data:this.convertFirestoreDoc(n.data(),n.id)}:{success:!1,error:"Expense category not found"}}catch(s){return console.error(" Failed to get expense category:",s),{success:!1,error:Xt(s)}}}static async updateCategory(e,r,s){try{const n=Rt(st,"restaurants",e,Gu,r),i={...s,updatedAt:wt.now()};await Xr(n,i),this.clearCache(e);const o=await this.getCategoryById(e,r);return console.log(" Expense category updated successfully:",r),o}catch(n){return console.error(" Failed to update expense category:",n),{success:!1,error:Xt(n)}}}static async deleteCategory(e,r){try{const s=await this.getCategoryById(e,r);if(!s.success||!s.data)return{success:!1,error:"Category not found"};if(s.data.isDefault)return{success:!1,error:"Cannot delete default categories"};const n=Rt(st,"restaurants",e,Gu,r);return await Pl(n),this.clearCache(e),console.log(" Expense category deleted successfully:",r),{success:!0,message:"Expense category deleted successfully"}}catch(s){return console.error(" Failed to delete expense category:",s),{success:!1,error:Xt(s)}}}static async toggleCategoryStatus(e,r,s){try{return await this.updateCategory(e,r,{isActive:s})}catch(n){return console.error(" Failed to toggle category status:",n),{success:!1,error:Xt(n)}}}static subscribeToCategories(e,r){try{const s=Jt(st,"restaurants",e,Gu),n=Zt(s,On("isDefault","desc"),On("name","asc"));return Of(n,o=>{const l=o.docs.map(c=>this.convertFirestoreDoc(c.data(),c.id));r(l)})}catch(s){return console.error(" Failed to subscribe to expense categories:",s),()=>{}}}static convertFirestoreDoc(e,r){var s,n;return{id:r,restaurantId:e.restaurantId,name:e.name,description:e.description,color:e.color,icon:e.icon,isDefault:e.isDefault||!1,isActive:e.isActive!==!1,budget:e.budget,createdAt:((s=e.createdAt)==null?void 0:s.toDate())||new Date,updatedAt:((n=e.updatedAt)==null?void 0:n.toDate())||new Date,createdBy:e.createdBy}}static clearCache(e){B1.delete(e)}static clearAllCache(){B1.clear()}static getDefaultCategoriesTemplate(){return AP}}const hP=Object.freeze(Object.defineProperty({__proto__:null,ExpenseCategoryService:yS},Symbol.toStringTag,{value:"Module"})),F1={Users:Ls,Package:rs,Zap:ev,Building:tM,Megaphone:qte,Laptop:Kte,Wrench:ore,FileText:Rl,Shield:Co,Truck:t_,Receipt:Uo,MoreHorizontal:Yte};function fge(){var Be;const{restaurant:t}=js(),{user:e}=ia(),[r,s]=R.useState([]),[n,i]=R.useState([]),[o,l]=R.useState(null),[c,d]=R.useState(null),[u,A]=R.useState(!0),[h,f]=R.useState(!1),[p,m]=R.useState(!1),[g,y]=R.useState(!1),[v,x]=R.useState(null),[E,T]=R.useState(!1),[j,C]=R.useState(!1),[w,S]=R.useState({}),[F,B]=R.useState(""),[k,D]=R.useState(""),[q,te]=R.useState("all"),[W,Q]=R.useState(!1),[re,G]=R.useState(!1),[Ae,he]=R.useState("today"),[I,U]=R.useState(""),[V,L]=R.useState(""),{register:K,handleSubmit:fe,reset:ee,watch:de,formState:{errors:ue}}=nn({defaultValues:{expenseDate:new Date().toISOString().split("T")[0],paymentMethod:"cash",isRecurring:!1}}),{register:Ie,handleSubmit:Y,reset:H,formState:{errors:je}}=nn({defaultValues:{color:"#3B82F6",icon:"MoreHorizontal",alertThreshold:80}});R.useEffect(()=>{t&&e&&Ce()},[t,e]);const Ce=async()=>{if(t)try{A(!0);const[X,_e,ke]=await Promise.all([r0.getExpensesForRestaurant(t.id,w),yS.getCategoriesForRestaurant(t.id),r0.getExpenseStats(t.id)]);X.success&&X.data?s(X.data):Z.error(X.error||"Failed to load expenses"),_e.success&&_e.data?i(_e.data):Z.error(_e.error||"Failed to load categories"),ke.success&&ke.data&&l(ke.data)}catch(X){console.error("Error loading expense data:",X),Z.error("Failed to load expense data")}finally{A(!1)}},oe=async X=>{if(!(!t||!e))try{const _e={categoryId:X.categoryId,title:X.title,description:X.description,amount:X.amount,paymentMethod:X.paymentMethod,expenseDate:new Date(X.expenseDate),dueDate:X.dueDate?new Date(X.dueDate):void 0,vendor:X.vendorName?{name:X.vendorName,contact:X.vendorContact}:void 0,invoiceNumber:X.invoiceNumber,reference:X.reference,notes:X.notes,tags:X.tags?X.tags.split(",").map(lt=>lt.trim()):[],isRecurring:X.isRecurring},ke=await r0.createExpense(t.id,_e,e.id);ke.success?(Z.success("Expense created successfully!"),m(!1),ee(),Ce()):Z.error(ke.error||"Failed to create expense")}catch(_e){console.error("Error creating expense:",_e),Z.error("Failed to create expense")}},He=async X=>{if(!(!t||!e))try{const _e={name:X.name,description:X.description,color:X.color,icon:X.icon,isActive:!0,isDefault:!1,budget:{monthlyLimit:X.monthlyLimit,alertThreshold:X.alertThreshold}},ke=await yS.createCategory(t.id,_e,e.id);ke.success?(Z.success("Custom category created successfully!"),C(!1),H(),Ce()):Z.error(ke.error||"Failed to create category")}catch(_e){console.error("Error creating category:",_e),Z.error("Failed to create category")}},ie=async X=>{if(!(!t||!e))try{const _e=await r0.markAsPaid(t.id,X.id,e.id);_e.success?(Z.success("Expense marked as paid!"),Ce()):Z.error(_e.error||"Failed to mark expense as paid")}catch(_e){console.error("Error marking expense as paid:",_e),Z.error("Failed to mark expense as paid")}},le=X=>{x(X),T(!0)},ae=async()=>{if(t)try{f(!0),y(!0);const X=await r0.getExpenseAnalytics(t.id);X.success&&X.data?d(X.data):Z.error(X.error||"Failed to load analytics")}catch(X){console.error("Error loading analytics:",X),Z.error("Failed to load analytics")}finally{f(!1)}},ve=()=>{const X=new Date,_e=new Date(X.getFullYear(),X.getMonth(),X.getDate());switch(Ae){case"today":return{start:_e,end:new Date(_e.getTime()+24*60*60*1e3)};case"yesterday":return{start:new Date(_e.getTime()-24*60*60*1e3),end:_e};case"week":return{start:new Date(X.getTime()-7*24*60*60*1e3),end:X};case"15days":return{start:new Date(X.getTime()-15*24*60*60*1e3),end:X};case"month":return{start:new Date(X.getFullYear(),X.getMonth(),1),end:X};case"3months":return{start:new Date(X.getFullYear(),X.getMonth()-3,1),end:X};case"6months":return{start:new Date(X.getFullYear(),X.getMonth()-6,1),end:X};case"12months":return{start:new Date(X.getFullYear(),X.getMonth()-12,1),end:X};case"custom":return{start:I?new Date(I):new Date(X.getFullYear(),0,1),end:V?new Date(V):X};default:return{start:new Date(0),end:X}}},we=()=>{if(!c)return null;const{start:X,end:_e}=ve(),ke=r.filter(Qe=>{const Ge=Qe.expenseDate;return Ge>=X&&Ge<=_e}),lt=ke.reduce((Qe,Ge)=>Qe+Ge.amount,0),mt=new Map;ke.forEach(Qe=>{const Ge=Qe.categoryId,gt=mt.get(Ge)||{amount:0,count:0};mt.set(Ge,{amount:gt.amount+Qe.amount,count:gt.count+1})});const pt=Array.from(mt.entries()).map(([Qe,Ge])=>{const gt=ke.find(St=>St.categoryId===Qe);return{categoryId:Qe,categoryName:(gt==null?void 0:gt.categoryName)||Qe,amount:Ge.amount,percentage:lt>0?Ge.amount/lt*100:0,count:Ge.count}}).sort((Qe,Ge)=>Ge.amount-Qe.amount),ze=new Map;ke.forEach(Qe=>{var Ge;if((Ge=Qe.vendor)!=null&&Ge.name){const gt=ze.get(Qe.vendor.name)||{amount:0,count:0};ze.set(Qe.vendor.name,{amount:gt.amount+Qe.amount,count:gt.count+1})}});const Me=Array.from(ze.entries()).map(([Qe,Ge])=>({vendorName:Qe,amount:Ge.amount,count:Ge.count})).sort((Qe,Ge)=>Ge.amount-Qe.amount).slice(0,10),rt=new Map;ke.forEach(Qe=>{const Ge=rt.get(Qe.paymentMethod)||{amount:0,count:0};rt.set(Qe.paymentMethod,{amount:Ge.amount+Qe.amount,count:Ge.count+1})});const ht=Array.from(rt.entries()).map(([Qe,Ge])=>({method:Qe,amount:Ge.amount,percentage:lt>0?Ge.amount/lt*100:0,count:Ge.count}));return{totalExpenses:lt,expenseCount:ke.length,categoryBreakdown:pt,topVendors:Me,paymentMethodBreakdown:ht,dateRange:{start:X,end:_e},expenses:ke}},De=async()=>{if(!t)return;const X=we();if(X)try{Q(!0),Z.loading("Preparing PDF export...");const _e=Ae==="custom"?`${I} to ${V}`:Ae.charAt(0).toUpperCase()+Ae.slice(1),ke=`
        <!DOCTYPE html>
        <html>
        <head>
          <meta charset="utf-8">
          <title>Expense Report - ${t.name}</title>
          <style>
            body { 
              font-family: Arial, sans-serif; 
              margin: 0; 
              padding: 20px; 
              color: #333;
              line-height: 1.6;
            }
            .header { 
              text-align: center; 
              border-bottom: 2px solid #4F46E5; 
              padding-bottom: 20px; 
              margin-bottom: 30px;
            }
            .header h1 { 
              color: #4F46E5; 
              margin: 0;
              font-size: 28px;
            }
            .header p { 
              color: #666; 
              margin: 5px 0;
              font-size: 16px;
            }
            .date-range { 
              color: #2563eb; 
              font-weight: bold; 
              margin-top: 5px; 
            }
            .summary-grid { 
              display: grid; 
              grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); 
              gap: 20px; 
              margin-bottom: 30px;
            }
            .summary-card { 
              background: #F8FAFC; 
              border: 1px solid #E2E8F0; 
              border-radius: 8px; 
              padding: 20px; 
              text-align: center;
            }
            .summary-card h3 { 
              margin: 0 0 10px 0; 
              color: #64748B; 
              font-size: 14px;
              text-transform: uppercase;
              letter-spacing: 0.5px;
            }
            .summary-card .amount { 
              font-size: 24px; 
              font-weight: bold; 
              color: #1E293B;
            }
            .section { 
              margin-bottom: 40px;
            }
            .section h2 { 
              color: #1E293B; 
              border-bottom: 1px solid #E2E8F0; 
              padding-bottom: 10px;
              margin-bottom: 20px;
            }
            table { 
              width: 100%; 
              border-collapse: collapse; 
              margin-bottom: 20px;
            }
            th, td { 
              padding: 12px; 
              text-align: left; 
              border-bottom: 1px solid #E2E8F0;
            }
            th { 
              background-color: #F1F5F9; 
              font-weight: 600;
              color: #475569;
            }
            .category-item {
              display: flex;
              justify-content: space-between;
              align-items: center;
              padding: 10px 0;
              border-bottom: 1px solid #F1F5F9;
            }
            .category-name {
              font-weight: 500;
              color: #1E293B;
            }
            .category-amount {
              font-weight: 600;
              color: #059669;
            }
            .footer { 
              margin-top: 50px; 
              text-align: center; 
              color: #64748B; 
              font-size: 12px;
              border-top: 1px solid #E2E8F0;
              padding-top: 20px;
            }
            @media print {
              .no-print { display: none; }
              body { margin: 0; }
            }
          </style>
        </head>
        <body>
          <div class="header">
            <h1>${t.name}</h1>
            <p>Expense Analytics Report</p>
            <div class="date-range">Period: ${_e}</div>
            <p>Generated on ${new Date().toLocaleDateString("en-GB",{day:"numeric",month:"long",year:"numeric"})}</p>
          </div>

          <div class="summary-grid">
            <div class="summary-card">
              <h3>Total Expenses</h3>
              <div class="amount">${Ue(X.totalExpenses)}</div>
            </div>
            <div class="summary-card">
              <h3>Total Transactions</h3>
              <div class="amount">${X.expenseCount}</div>
            </div>
            <div class="summary-card">
              <h3>Average per Transaction</h3>
              <div class="amount">${X.expenseCount>0?Ue(X.totalExpenses/X.expenseCount):Ue(0)}</div>
            </div>
          </div>

          <div class="section">
            <h2>Expenses by Category</h2>
            ${X.categoryBreakdown.map(mt=>{const pt=Ve(mt.categoryId);return`
                <div class="category-item">
                  <div>
                    <div class="category-name">${(pt==null?void 0:pt.name)||mt.categoryName}</div>
                    <div style="color: #64748B; font-size: 14px;">${mt.count} expenses</div>
                  </div>
                  <div>
                    <div class="category-amount">${Ue(mt.amount)}</div>
                    <div style="color: #64748B; font-size: 14px;">${mt.percentage.toFixed(1)}%</div>
                  </div>
                </div>
              `}).join("")}
          </div>

          ${X.topVendors.length>0?`
            <div class="section">
              <h2>Top Vendors</h2>
              <table>
                <thead>
                  <tr>
                    <th>Vendor</th>
                    <th>Amount</th>
                    <th>Transactions</th>
                  </tr>
                </thead>
                <tbody>
                  ${X.topVendors.map(mt=>`
                    <tr>
                      <td>${mt.vendorName}</td>
                      <td>${Ue(mt.amount)}</td>
                      <td>${mt.count}</td>
                    </tr>
                  `).join("")}
                </tbody>
              </table>
            </div>
          `:""}

          <div class="section">
            <h2>Payment Methods</h2>
            <table>
              <thead>
                <tr>
                  <th>Payment Method</th>
                  <th>Amount</th>
                  <th>Percentage</th>
                  <th>Transactions</th>
                </tr>
              </thead>
              <tbody>
                ${X.paymentMethodBreakdown.map(mt=>`
                  <tr>
                    <td style="text-transform: capitalize;">${mt.method.replace("_"," ")}</td>
                    <td>${Ue(mt.amount)}</td>
                    <td>${mt.percentage.toFixed(1)}%</td>
                    <td>${mt.count}</td>
                  </tr>
                `).join("")}
              </tbody>
            </table>
          </div>

          <div class="footer">
            <p>This report was generated automatically by ${t.name}'s expense management system.</p>
            <p>Report ID: EXP-${Date.now()}</p>
          </div>
        </body>
        </html>
      `,lt=window.open("","_blank");lt&&(lt.document.write(ke),lt.document.close(),lt.onload=()=>{setTimeout(()=>{lt.print(),lt.close()},1e3)}),Z.dismiss(),Z.success(`${_e} expense report exported successfully!`),G(!1)}catch(_e){console.error("Error exporting PDF:",_e),Z.dismiss(),Z.error("Failed to export PDF")}finally{Q(!1)}},Ve=X=>n.find(_e=>_e.id===X),me=X=>{switch(X){case"pending":return"bg-yellow-100 text-yellow-800";case"approved":return"bg-green-100 text-green-800";case"rejected":return"bg-red-100 text-red-800";case"paid":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}},Fe=X=>{switch(X){case"pending":return a.jsx(Ys,{className:"h-4 w-4"});case"approved":return a.jsx(Nr,{className:"h-4 w-4"});case"rejected":return a.jsx(El,{className:"h-4 w-4"});case"paid":return a.jsx(hn,{className:"h-4 w-4"});default:return a.jsx(Go,{className:"h-4 w-4"})}},Re=r.filter(X=>{var mt,pt;const _e=!F||X.title.toLowerCase().includes(F.toLowerCase())||((mt=X.description)==null?void 0:mt.toLowerCase().includes(F.toLowerCase()))||((pt=X.vendor)==null?void 0:pt.name.toLowerCase().includes(F.toLowerCase())),ke=!k||X.categoryId===k,lt=(()=>{if(q==="all")return!0;const ze=new Date,Me=X.expenseDate;switch(q){case"today":const rt=new Date(ze.getFullYear(),ze.getMonth(),ze.getDate(),0,0,0,0),ht=new Date(ze.getFullYear(),ze.getMonth(),ze.getDate(),23,59,59,999);return Me>=rt&&Me<=ht;case"week":const Qe=new Date(ze.getTime()-7*24*60*60*1e3);return Qe.setHours(0,0,0,0),Me>=Qe;case"month":const Ge=new Date(ze.getFullYear(),ze.getMonth(),1,0,0,0,0);return Me>=Ge;case"year":const gt=new Date(ze.getFullYear(),0,1,0,0,0,0);return Me>=gt;default:return!0}})();return _e&&ke&&lt});return t?a.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-blue-50 to-indigo-50",children:[a.jsxs("div",{className:"relative overflow-hidden",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-indigo-600 via-purple-600 to-blue-600"}),a.jsx("div",{className:"absolute inset-0 opacity-10",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.4'%3E%3Ccircle cx='30' cy='30' r='2'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E")`}}),a.jsx("div",{className:"relative",children:a.jsx("div",{className:"max-w-7xl mx-auto px-3 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center py-4 sm:py-6 lg:py-8 gap-4",children:[a.jsx("div",{className:"text-white flex-1",children:a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-3 sm:gap-4 mb-2",children:[a.jsx("div",{className:"p-2 sm:p-3 bg-white/20 rounded-xl sm:rounded-2xl backdrop-blur-sm border border-white/20",children:a.jsx(Uo,{className:"h-6 w-6 sm:h-8 sm:w-8 text-white"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-xl sm:text-2xl lg:text-4xl font-bold mb-1",children:"Expense Tracker"}),a.jsxs("p",{className:"text-blue-100 text-xs sm:text-sm lg:text-lg font-medium",children:["Manage and track all business expenses for ",t.name]})]})]})}),a.jsxs("div",{className:"flex flex-col xs:flex-row items-stretch gap-2 sm:gap-3 w-full lg:w-auto",children:[a.jsxs("button",{onClick:ae,className:"flex items-center justify-center gap-2 px-3 sm:px-4 lg:px-6 py-2 sm:py-2.5 lg:py-3 bg-white/20 backdrop-blur-sm text-white rounded-lg sm:rounded-xl hover:bg-white/30 transition-all duration-300 border border-white/20 text-xs sm:text-sm lg:text-base",children:[a.jsx(Sa,{className:"h-4 w-4 sm:h-5 sm:w-5"}),a.jsx("span",{className:"font-medium",children:"Analytics"})]}),a.jsxs("button",{onClick:()=>G(!0),className:"flex items-center justify-center gap-2 px-3 sm:px-4 lg:px-6 py-2 sm:py-2.5 lg:py-3 bg-white/20 backdrop-blur-sm text-white rounded-lg sm:rounded-xl hover:bg-white/30 transition-all duration-300 border border-white/20 text-xs sm:text-sm lg:text-base",children:[a.jsx(Yn,{className:"h-4 w-4 sm:h-5 sm:w-5"}),a.jsx("span",{className:"font-medium",children:"Export Report"})]}),a.jsxs("button",{onClick:()=>m(!0),className:"flex items-center justify-center gap-2 px-3 sm:px-4 lg:px-6 py-2 sm:py-2.5 lg:py-3 bg-white text-indigo-600 rounded-lg sm:rounded-xl hover:bg-gray-50 transition-all duration-300 shadow-lg hover:shadow-xl font-medium text-xs sm:text-sm lg:text-base",children:[a.jsx(zr,{className:"h-4 w-4 sm:h-5 sm:w-5"}),a.jsx("span",{children:"Add Expense"})]})]})]})})})]}),o&&a.jsx("div",{className:"max-w-7xl mx-auto px-3 sm:px-6 lg:px-8 -mt-6 sm:-mt-8 relative z-10",children:a.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4 lg:gap-6 mb-6 sm:mb-8",children:[a.jsx("div",{className:"bg-white rounded-xl sm:rounded-2xl p-3 sm:p-4 lg:p-6 shadow-lg border border-gray-200",children:a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-600 truncate",children:"Today's Expenses"}),a.jsx("p",{className:"text-lg sm:text-xl lg:text-2xl font-bold text-gray-900 truncate",children:Ue(o.todayExpenses)})]}),a.jsx("div",{className:"p-2 sm:p-3 bg-blue-100 rounded-lg sm:rounded-xl mt-2 sm:mt-0 sm:ml-2 self-start sm:self-auto",children:a.jsx(hn,{className:"h-4 w-4 sm:h-5 sm:w-5 lg:h-6 lg:w-6 text-blue-600"})})]})}),a.jsx("div",{className:"bg-white rounded-xl sm:rounded-2xl p-3 sm:p-4 lg:p-6 shadow-lg border border-gray-200",children:a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-600 truncate",children:"This Month"}),a.jsx("p",{className:"text-lg sm:text-xl lg:text-2xl font-bold text-gray-900 truncate",children:Ue(o.monthExpenses)})]}),a.jsx("div",{className:"p-2 sm:p-3 bg-green-100 rounded-lg sm:rounded-xl mt-2 sm:mt-0 sm:ml-2 self-start sm:self-auto",children:a.jsx(Is,{className:"h-4 w-4 sm:h-5 sm:w-5 lg:h-6 lg:w-6 text-green-600"})})]})}),a.jsx("div",{className:"bg-white rounded-xl sm:rounded-2xl p-3 sm:p-4 lg:p-6 shadow-lg border border-gray-200",children:a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-600 truncate",children:"Pending Expenses"}),a.jsx("p",{className:"text-lg sm:text-xl lg:text-2xl font-bold text-orange-600 truncate",children:o.pendingExpenses})]}),a.jsx("div",{className:"p-2 sm:p-3 bg-orange-100 rounded-lg sm:rounded-xl mt-2 sm:mt-0 sm:ml-2 self-start sm:self-auto",children:a.jsx(Ys,{className:"h-4 w-4 sm:h-5 sm:w-5 lg:h-6 lg:w-6 text-orange-600"})})]})}),a.jsx("div",{className:"bg-white rounded-xl sm:rounded-2xl p-3 sm:p-4 lg:p-6 shadow-lg border border-gray-200 col-span-2 lg:col-span-1",children:a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-600 truncate",children:"Top Category"}),a.jsx("p",{className:"text-sm sm:text-base lg:text-lg font-bold text-gray-900 truncate",children:(()=>{const X=o.topCategory.name,_e=n.find(ke=>ke.id===X||ke.name===X);return _e?_e.name:X||"No expenses"})()}),a.jsx("p",{className:"text-xs sm:text-sm text-gray-600 truncate",children:Ue(o.topCategory.amount)})]}),a.jsx("div",{className:"p-2 sm:p-3 bg-purple-100 rounded-lg sm:rounded-xl mt-2 sm:mt-0 sm:ml-2 self-start sm:self-auto",children:a.jsx(Jte,{className:"h-4 w-4 sm:h-5 sm:w-5 lg:h-6 lg:w-6 text-purple-600"})})]})})]})}),a.jsxs("div",{className:"max-w-7xl mx-auto px-3 sm:px-6 lg:px-8 pb-8 sm:pb-12",children:[a.jsx("div",{className:"bg-white rounded-xl sm:rounded-2xl p-3 sm:p-4 lg:p-6 shadow-lg border border-gray-200 mb-4 sm:mb-6 lg:mb-8",children:a.jsxs("div",{className:"flex flex-col gap-3 sm:gap-4",children:[a.jsxs("div",{className:"relative",children:[a.jsx(sn,{className:"absolute left-3 sm:left-4 top-1/2 transform -translate-y-1/2 h-4 w-4 sm:h-5 sm:w-5 text-gray-400"}),a.jsx("input",{type:"text",placeholder:"Search expenses...",value:F,onChange:X=>B(X.target.value),className:"pl-10 sm:pl-12 pr-3 sm:pr-4 py-2.5 sm:py-3 w-full border border-gray-300 rounded-lg sm:rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent text-sm sm:text-base"})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-2 sm:gap-3 lg:gap-4",children:[a.jsxs("select",{value:k,onChange:X=>D(X.target.value),className:"px-3 sm:px-4 py-2.5 sm:py-3 border border-gray-300 rounded-lg sm:rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent text-sm sm:text-base",children:[a.jsx("option",{value:"",children:"All Categories"}),n.filter(X=>X.isActive).map(X=>a.jsxs("option",{value:X.id,children:[X.name," ",X.isDefault?"":"(Custom)"]},X.id))]}),a.jsxs("select",{value:q,onChange:X=>te(X.target.value),className:"px-3 sm:px-4 py-2.5 sm:py-3 border border-gray-300 rounded-lg sm:rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent text-sm sm:text-base",children:[a.jsx("option",{value:"all",children:"All Time"}),a.jsx("option",{value:"today",children:"Today"}),a.jsx("option",{value:"week",children:"This Week"}),a.jsx("option",{value:"month",children:"This Month"}),a.jsx("option",{value:"year",children:"This Year"})]}),a.jsxs("button",{onClick:Ce,disabled:u,className:"flex items-center justify-center gap-2 px-3 sm:px-4 py-2.5 sm:py-3 bg-indigo-600 text-white rounded-lg sm:rounded-xl hover:bg-indigo-700 transition-colors disabled:opacity-50 text-sm sm:text-base",children:[u?a.jsx(Gi,{className:"h-4 w-4 animate-spin"}):a.jsx(Di,{className:"h-4 w-4"}),a.jsx("span",{className:"hidden xs:inline",children:"Refresh"})]}),a.jsxs("button",{onClick:()=>{B(""),D(""),te("all")},className:"flex items-center justify-center gap-2 px-3 sm:px-4 py-2.5 sm:py-3 border border-gray-300 rounded-lg sm:rounded-xl hover:bg-gray-50 transition-colors text-sm sm:text-base",children:[a.jsx(El,{className:"h-4 w-4"}),a.jsx("span",{className:"hidden xs:inline",children:"Clear Filters"})]})]}),(F||k||q!=="all")&&a.jsxs("div",{className:"flex flex-wrap items-center gap-2 mt-2",children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Active filters:"}),F&&a.jsxs("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full",children:['Search: "',F,'"']}),k&&a.jsxs("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full",children:["Category: ",(Be=Ve(k))==null?void 0:Be.name]}),q!=="all"&&a.jsxs("span",{className:"px-2 py-1 bg-purple-100 text-purple-800 text-xs rounded-full",children:["Range: ",q.charAt(0).toUpperCase()+q.slice(1)]}),a.jsxs("span",{className:"text-sm text-gray-500",children:["(",Re.length," of ",r.length," expenses)"]})]})]})}),(F||k||q!=="all")&&Re.length>0&&a.jsxs("div",{className:"bg-gradient-to-r from-indigo-50 to-purple-50 rounded-2xl p-6 mb-6 border border-indigo-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-indigo-900 mb-4",children:"Filtered Results Summary"}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("p",{className:"text-2xl font-bold text-indigo-600",children:Re.length}),a.jsx("p",{className:"text-sm text-indigo-700",children:"Expenses Found"})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("p",{className:"text-2xl font-bold text-purple-600",children:Ue(Re.reduce((X,_e)=>X+_e.amount,0))}),a.jsx("p",{className:"text-sm text-purple-700",children:"Total Amount"})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("p",{className:"text-2xl font-bold text-pink-600",children:Ue(Re.reduce((X,_e)=>X+_e.amount,0)/Math.max(Re.length,1))}),a.jsx("p",{className:"text-sm text-pink-700",children:"Average Amount"})]})]})]}),a.jsxs("div",{className:"bg-white rounded-xl sm:rounded-2xl shadow-lg border border-gray-200",children:[a.jsx("div",{className:"p-3 sm:p-4 lg:p-6 border-b border-gray-200",children:a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-lg sm:text-xl font-semibold text-gray-900",children:"Recent Expenses"}),a.jsx("p",{className:"text-sm sm:text-base text-gray-600",children:"Manage and track all your business expenses"})]}),Re.length>0&&a.jsxs("button",{onClick:()=>{const _e=`Title,Category,Amount,Payment Method,Date,Status,Vendor
${Re.map(pt=>{var Me;const ze=Ve(pt.categoryId);return`"${pt.title}","${(ze==null?void 0:ze.name)||"Unknown"}",${pt.amount},"${pt.paymentMethod}","${pt.expenseDate.toLocaleDateString()}","${pt.status}","${((Me=pt.vendor)==null?void 0:Me.name)||""}"`}).join(`
`)}`,ke=new Blob([_e],{type:"text/csv"}),lt=URL.createObjectURL(ke),mt=document.createElement("a");mt.href=lt,mt.download=`${t==null?void 0:t.name}-expenses-${new Date().toISOString().split("T")[0]}.csv`,mt.click(),URL.revokeObjectURL(lt),Z.success("Expense list exported!")},className:"flex items-center gap-2 px-3 sm:px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors text-sm",children:[a.jsx(Yn,{className:"h-4 w-4"}),a.jsx("span",{className:"hidden sm:inline",children:"Export List"})]})]})}),u?a.jsxs("div",{className:"p-12 text-center",children:[a.jsx(Gi,{className:"h-8 w-8 animate-spin mx-auto text-indigo-600 mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Loading expenses..."})]}):Re.length===0?a.jsxs("div",{className:"p-12 text-center",children:[a.jsx(Uo,{className:"h-12 w-12 mx-auto text-gray-400 mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No expenses found"}),a.jsx("p",{className:"text-gray-600 mb-6",children:"Get started by adding your first expense"}),a.jsxs("button",{onClick:()=>m(!0),className:"inline-flex items-center gap-2 px-6 py-3 bg-indigo-600 text-white rounded-xl hover:bg-indigo-700 transition-colors",children:[a.jsx(zr,{className:"h-4 w-4"}),"Add First Expense"]})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"hidden lg:block overflow-hidden",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Expense Details"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Category"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),a.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Re.map(X=>{const _e=Ve(X.categoryId),ke=_e?F1[_e.icon]:Uo;return a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-6 py-4",children:a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-medium text-gray-900",children:X.title}),X.description&&a.jsx("div",{className:"text-sm text-gray-500",children:X.description}),X.vendor&&a.jsxs("div",{className:"text-xs text-gray-400 mt-1",children:["Vendor: ",X.vendor.name]})]})}),a.jsx("td",{className:"px-6 py-4",children:_e&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"p-2 rounded-lg",style:{backgroundColor:`${_e.color}20`},children:a.jsx(ke,{className:"h-4 w-4",style:{color:_e.color}})}),a.jsx("span",{className:"text-sm font-medium text-gray-900",children:_e.name})]})}),a.jsxs("td",{className:"px-6 py-4",children:[a.jsx("div",{className:"text-sm font-medium text-gray-900",children:Ue(X.amount)}),a.jsx("div",{className:"text-xs text-gray-500 capitalize",children:X.paymentMethod.replace("_"," ")})]}),a.jsx("td",{className:"px-6 py-4",children:a.jsxs("span",{className:`inline-flex items-center gap-1 px-2.5 py-0.5 rounded-full text-xs font-medium ${me(X.status)}`,children:[Fe(X.status),X.status.charAt(0).toUpperCase()+X.status.slice(1)]})}),a.jsxs("td",{className:"px-6 py-4",children:[a.jsx("div",{className:"text-sm text-gray-900",children:X.expenseDate.toLocaleDateString()}),X.dueDate&&a.jsxs("div",{className:"text-xs text-gray-500",children:["Due: ",X.dueDate.toLocaleDateString()]})]}),a.jsx("td",{className:"px-6 py-4 text-right",children:a.jsxs("div",{className:"flex items-center justify-end gap-2",children:[a.jsx("button",{onClick:()=>le(X),className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100",children:a.jsx(Xs,{className:"h-4 w-4"})}),X.status==="approved"&&a.jsx("button",{onClick:()=>ie(X),className:"p-2 text-blue-400 hover:text-blue-600 rounded-lg hover:bg-blue-50",title:"Mark as Paid",children:a.jsx(hn,{className:"h-4 w-4"})})]})})]},X.id)})})]})}),a.jsx("div",{className:"lg:hidden",children:a.jsx("div",{className:"space-y-3 sm:space-y-4 p-3 sm:p-4 lg:p-6",children:Re.map(X=>{const _e=Ve(X.categoryId),ke=_e?F1[_e.icon]:Uo;return a.jsxs("div",{className:"bg-gray-50 rounded-lg sm:rounded-xl p-3 sm:p-4 space-y-3",children:[a.jsxs("div",{className:"flex items-start justify-between gap-3",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h3",{className:"text-sm sm:text-base font-semibold text-gray-900 truncate",children:X.title}),X.description&&a.jsx("p",{className:"text-xs sm:text-sm text-gray-600 mt-1 line-clamp-2",children:X.description})]}),a.jsxs("span",{className:`inline-flex items-center gap-1 px-2 sm:px-2.5 py-0.5 sm:py-1 rounded-full text-xs font-medium ${me(X.status)} whitespace-nowrap flex-shrink-0`,children:[Fe(X.status),a.jsx("span",{className:"hidden xs:inline",children:X.status.charAt(0).toUpperCase()+X.status.slice(1)})]})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 min-w-0 flex-1",children:[_e&&a.jsx("div",{className:"p-1.5 sm:p-2 rounded-lg flex-shrink-0",style:{backgroundColor:`${_e.color}20`},children:a.jsx(ke,{className:"h-4 w-4",style:{color:_e.color}})}),a.jsxs("div",{className:"min-w-0 flex-1",children:[a.jsx("div",{className:"text-xs sm:text-sm font-medium text-gray-900 truncate",children:(_e==null?void 0:_e.name)||"Unknown"}),a.jsx("div",{className:"text-xs text-gray-500 capitalize truncate",children:X.paymentMethod.replace("_"," ")})]})]}),a.jsxs("div",{className:"text-right flex-shrink-0",children:[a.jsx("div",{className:"text-base sm:text-lg font-bold text-gray-900",children:Ue(X.amount)}),a.jsx("div",{className:"text-xs text-gray-500",children:X.expenseDate.toLocaleDateString()})]})]}),a.jsxs("div",{className:"flex items-center justify-between pt-2 sm:pt-3 border-t border-gray-200",children:[a.jsx("div",{className:"text-xs sm:text-sm text-gray-600 truncate flex-1 pr-2",children:X.vendor?a.jsxs("span",{children:["Vendor: ",X.vendor.name]}):a.jsx("span",{children:"No vendor specified"})}),a.jsxs("div",{className:"flex items-center gap-1 sm:gap-2 flex-shrink-0",children:[a.jsx("button",{onClick:()=>le(X),className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-200 transition-colors",children:a.jsx(Xs,{className:"h-4 w-4"})}),X.status==="approved"&&a.jsx("button",{onClick:()=>ie(X),className:"p-2 text-blue-400 hover:text-blue-600 rounded-lg hover:bg-blue-100 transition-colors",title:"Mark as Paid",children:a.jsx(hn,{className:"h-4 w-4"})})]})]})]},X.id)})})})]})]})]}),p&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-2 sm:p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg sm:rounded-xl lg:rounded-2xl shadow-2xl w-full max-w-2xl max-h-[95vh] sm:max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"p-3 sm:p-4 lg:p-6 border-b border-gray-200",children:[a.jsx("h2",{className:"text-base sm:text-lg lg:text-xl font-semibold text-gray-900",children:"Add New Expense"}),a.jsx("p",{className:"text-xs sm:text-sm lg:text-base text-gray-600",children:"Record a new business expense"})]}),a.jsxs("form",{onSubmit:fe(oe),className:"p-3 sm:p-4 lg:p-6 space-y-3 sm:space-y-4 lg:space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4 lg:gap-6",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Category *"}),a.jsx("button",{type:"button",onClick:()=>C(!0),className:"text-xs sm:text-sm text-indigo-600 hover:text-indigo-700 font-medium",children:"+ Add Custom Category"})]}),a.jsxs("select",{...K("categoryId",{required:"Category is required"}),className:"w-full p-2.5 sm:p-3 border border-gray-300 rounded-lg sm:rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent text-sm",children:[a.jsx("option",{value:"",children:"Select Category"}),n.filter(X=>X.isActive).map(X=>a.jsxs("option",{value:X.id,children:[X.name," ",X.isDefault?"":"(Custom)"]},X.id))]}),ue.categoryId&&a.jsx("p",{className:"mt-1 text-xs sm:text-sm text-red-600",children:ue.categoryId.message})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Amount *"}),a.jsx("input",{type:"number",step:"0.01",...K("amount",{required:"Amount is required",min:{value:0,message:"Amount must be positive"}}),className:"w-full p-2.5 sm:p-3 border border-gray-300 rounded-lg sm:rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent text-sm",placeholder:"0.00"}),ue.amount&&a.jsx("p",{className:"mt-1 text-xs sm:text-sm text-red-600",children:ue.amount.message})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Title"}),a.jsx("input",{type:"text",...K("title"),className:"w-full p-2.5 sm:p-3 border border-gray-300 rounded-lg sm:rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent text-sm",placeholder:"e.g., Office supplies, Staff salaries..."}),ue.title&&a.jsx("p",{className:"mt-1 text-xs sm:text-sm text-red-600",children:ue.title.message})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),a.jsx("textarea",{...K("description"),rows:3,className:"w-full p-2.5 sm:p-3 border border-gray-300 rounded-lg sm:rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent text-sm",placeholder:"Additional details about this expense..."})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4 lg:gap-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Payment Method *"}),a.jsxs("select",{...K("paymentMethod",{required:"Payment method is required"}),className:"w-full p-2.5 sm:p-3 border border-gray-300 rounded-lg sm:rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent text-sm",children:[a.jsx("option",{value:"cash",children:"Cash"}),a.jsx("option",{value:"bank_transfer",children:"Bank Transfer"}),a.jsx("option",{value:"credit_card",children:"Credit Card"}),a.jsx("option",{value:"upi",children:"UPI"}),a.jsx("option",{value:"cheque",children:"Cheque"}),a.jsx("option",{value:"other",children:"Other"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Expense Date *"}),a.jsx("input",{type:"date",...K("expenseDate",{required:"Expense date is required"}),className:"w-full p-2.5 sm:p-3 border border-gray-300 rounded-lg sm:rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent text-sm"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4 lg:gap-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Vendor Name"}),a.jsx("input",{type:"text",...K("vendorName"),className:"w-full p-2.5 sm:p-3 border border-gray-300 rounded-lg sm:rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent text-sm",placeholder:"Vendor or supplier name"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Invoice Number"}),a.jsx("input",{type:"text",...K("invoiceNumber"),className:"w-full p-2.5 sm:p-3 border border-gray-300 rounded-lg sm:rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent text-sm",placeholder:"Invoice or receipt number"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tags"}),a.jsx("input",{type:"text",...K("tags"),className:"w-full p-2.5 sm:p-3 border border-gray-300 rounded-lg sm:rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent text-sm",placeholder:"Separate tags with commas (e.g., urgent, monthly, equipment)"})]}),a.jsxs("div",{className:"flex items-center",children:[a.jsx("input",{type:"checkbox",...K("isRecurring"),className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"}),a.jsx("label",{className:"ml-2 block text-sm text-gray-900",children:"This is a recurring expense"})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center justify-end gap-3 pt-4 sm:pt-6 border-t border-gray-200",children:[a.jsx("button",{type:"button",onClick:()=>{m(!1),ee()},className:"px-4 sm:px-6 py-2.5 sm:py-3 border border-gray-300 text-gray-700 rounded-lg sm:rounded-xl hover:bg-gray-50 transition-colors text-sm sm:text-base",children:"Cancel"}),a.jsx("button",{type:"submit",className:"px-4 sm:px-6 py-2.5 sm:py-3 bg-indigo-600 text-white rounded-lg sm:rounded-xl hover:bg-indigo-700 transition-colors text-sm sm:text-base",children:"Add Expense"})]})]})]})}),E&&v&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-2 sm:p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-xl sm:rounded-2xl shadow-2xl w-full max-w-2xl max-h-[95vh] sm:max-h-[90vh] overflow-y-auto",children:[a.jsx("div",{className:"p-4 sm:p-6 border-b border-gray-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-lg sm:text-xl font-semibold text-gray-900",children:v.title}),a.jsx("p",{className:"text-sm sm:text-base text-gray-600",children:"Expense Details"})]}),a.jsxs("span",{className:`inline-flex items-center gap-1 px-3 py-1 rounded-full text-sm font-medium ${me(v.status)}`,children:[Fe(v.status),v.status.charAt(0).toUpperCase()+v.status.slice(1)]})]})}),a.jsxs("div",{className:"p-4 sm:p-6 space-y-4 sm:space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-1",children:"Amount"}),a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:Ue(v.amount)}),a.jsx("p",{className:"text-sm text-gray-500 capitalize",children:v.paymentMethod.replace("_"," ")})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-1",children:"Category"}),a.jsx("div",{className:"flex items-center gap-2",children:(()=>{const X=Ve(v.categoryId),_e=X?F1[X.icon]:Uo;return X?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"p-2 rounded-lg",style:{backgroundColor:`${X.color}20`},children:a.jsx(_e,{className:"h-4 w-4",style:{color:X.color}})}),a.jsx("span",{className:"font-medium text-gray-900",children:X.name})]}):a.jsx("span",{className:"font-medium text-gray-900",children:v.categoryName})})()})]})]}),v.description&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-1",children:"Description"}),a.jsx("p",{className:"text-gray-900",children:v.description})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-1",children:"Expense Date"}),a.jsx("p",{className:"text-gray-900",children:v.expenseDate.toLocaleDateString()})]}),v.dueDate&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-1",children:"Due Date"}),a.jsx("p",{className:"text-gray-900",children:v.dueDate.toLocaleDateString()})]})]}),v.vendor&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-1",children:"Vendor"}),a.jsx("p",{className:"text-gray-900",children:v.vendor.name}),v.vendor.contact&&a.jsx("p",{className:"text-sm text-gray-600",children:v.vendor.contact})]}),v.invoiceNumber&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-1",children:"Invoice Number"}),a.jsx("p",{className:"text-gray-900",children:v.invoiceNumber})]}),v.tags&&v.tags.length>0&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-1",children:"Tags"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:v.tags.map((X,_e)=>a.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-700 text-xs rounded-full",children:X},_e))})]}),v.notes&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-1",children:"Notes"}),a.jsx("p",{className:"text-gray-900",children:v.notes})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6 text-sm",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-1",children:"Created"}),a.jsx("p",{className:"text-gray-900",children:v.createdAt.toLocaleDateString()})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-1",children:"Last Updated"}),a.jsx("p",{className:"text-gray-900",children:v.updatedAt.toLocaleDateString()})]})]})]}),a.jsxs("div",{className:"p-4 sm:p-6 border-t border-gray-200 bg-gray-50 flex flex-col sm:flex-row items-stretch sm:items-center justify-between gap-3",children:[a.jsx("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-3",children:v.status==="approved"&&a.jsxs("button",{onClick:()=>{ie(v),T(!1)},className:"flex items-center justify-center gap-2 px-4 py-2.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm sm:text-base",children:[a.jsx(hn,{className:"h-4 w-4"}),"Mark as Paid"]})}),a.jsx("button",{onClick:()=>T(!1),className:"px-6 py-2.5 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors text-sm sm:text-base",children:"Close"})]})]})}),j&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-2 sm:p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-xl sm:rounded-2xl shadow-2xl w-full max-w-lg max-h-[95vh] sm:max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"p-4 sm:p-6 border-b border-gray-200",children:[a.jsx("h2",{className:"text-lg sm:text-xl font-semibold text-gray-900",children:"Add Custom Category"}),a.jsx("p",{className:"text-sm sm:text-base text-gray-600",children:"Create a new expense category for your restaurant"})]}),a.jsxs("form",{onSubmit:Y(He),className:"p-4 sm:p-6 space-y-4 sm:space-y-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category Name *"}),a.jsx("input",{type:"text",...Ie("name",{required:"Category name is required"}),className:"w-full p-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:"e.g., Office Supplies"}),je.name&&a.jsx("p",{className:"mt-1 text-sm text-red-600",children:je.name.message})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),a.jsx("textarea",{...Ie("description"),rows:3,className:"w-full p-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:"Brief description of this category"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Color"}),a.jsx("input",{type:"color",...Ie("color"),className:"w-full h-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Icon"}),a.jsxs("select",{...Ie("icon"),className:"w-full p-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent",children:[a.jsx("option",{value:"MoreHorizontal",children:"Default"}),a.jsx("option",{value:"Users",children:"People"}),a.jsx("option",{value:"Package",children:"Package"}),a.jsx("option",{value:"Zap",children:"Energy"}),a.jsx("option",{value:"Building",children:"Building"}),a.jsx("option",{value:"Megaphone",children:"Marketing"}),a.jsx("option",{value:"Laptop",children:"Technology"}),a.jsx("option",{value:"Wrench",children:"Tools"}),a.jsx("option",{value:"FileText",children:"Documents"}),a.jsx("option",{value:"Shield",children:"Security"}),a.jsx("option",{value:"Truck",children:"Transport"}),a.jsx("option",{value:"Receipt",children:"Receipt"})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Monthly Budget Limit ()"}),a.jsx("input",{type:"number",step:"1",...Ie("monthlyLimit",{required:"Monthly limit is required",min:{value:0,message:"Amount must be positive"}}),className:"w-full p-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:"e.g., 10000"}),je.monthlyLimit&&a.jsx("p",{className:"mt-1 text-sm text-red-600",children:je.monthlyLimit.message})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Alert Threshold (%)"}),a.jsx("input",{type:"number",min:"1",max:"100",...Ie("alertThreshold"),className:"w-full p-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:"e.g., 80"}),a.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Get notified when spending reaches this percentage of the budget"})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center justify-end gap-3 sm:gap-4 pt-4 sm:pt-6 border-t border-gray-200",children:[a.jsx("button",{type:"button",onClick:()=>{C(!1),H()},className:"px-6 py-2.5 sm:py-3 border border-gray-300 text-gray-700 rounded-xl hover:bg-gray-50 transition-colors text-sm sm:text-base",children:"Cancel"}),a.jsx("button",{type:"submit",className:"px-6 py-2.5 sm:py-3 bg-indigo-600 text-white rounded-xl hover:bg-indigo-700 transition-colors text-sm sm:text-base",children:"Create Category"})]})]})]})}),g&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-2 sm:p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-xl sm:rounded-2xl shadow-2xl w-full max-w-6xl max-h-[95vh] sm:max-h-[90vh] overflow-y-auto",children:[a.jsx("div",{className:"p-4 sm:p-6 border-b border-gray-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-lg sm:text-xl font-semibold text-gray-900",children:"Expense Analytics"}),a.jsx("p",{className:"text-sm sm:text-base text-gray-600",children:"Detailed insights into your restaurant's expenses"})]}),a.jsx("button",{onClick:()=>y(!1),className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100",children:a.jsx(El,{className:"h-5 w-5"})})]})}),a.jsx("div",{className:"p-4 sm:p-6",children:h?a.jsxs("div",{className:"text-center py-12",children:[a.jsx(Gi,{className:"h-8 w-8 animate-spin mx-auto text-indigo-600 mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Loading analytics..."})]}):c?a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[a.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-blue-100 rounded-xl p-4 border border-blue-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-blue-600 text-sm font-medium",children:"Total Expenses"}),a.jsx("p",{className:"text-2xl font-bold text-blue-900",children:Ue(c.totalExpenses)})]}),a.jsx(hn,{className:"h-8 w-8 text-blue-600"})]})}),a.jsx("div",{className:"bg-gradient-to-r from-green-50 to-green-100 rounded-xl p-4 border border-green-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-green-600 text-sm font-medium",children:"This Month"}),a.jsx("p",{className:"text-2xl font-bold text-green-900",children:Ue(c.monthlyExpenses)})]}),a.jsx(Jc,{className:"h-8 w-8 text-green-600"})]})}),a.jsx("div",{className:"bg-gradient-to-r from-purple-50 to-purple-100 rounded-xl p-4 border border-purple-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-purple-600 text-sm font-medium",children:"This Year"}),a.jsx("p",{className:"text-2xl font-bold text-purple-900",children:Ue(c.yearlyExpenses)})]}),a.jsx(Is,{className:"h-8 w-8 text-purple-600"})]})}),a.jsx("div",{className:"bg-gradient-to-r from-orange-50 to-orange-100 rounded-xl p-4 border border-orange-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-orange-600 text-sm font-medium",children:"Avg Monthly"}),a.jsx("p",{className:"text-2xl font-bold text-orange-900",children:Ue(c.averageMonthlyExpense)})]}),a.jsx(Sa,{className:"h-8 w-8 text-orange-600"})]})})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Expenses by Category"}),a.jsx("div",{className:"space-y-4",children:c.categoryBreakdown.slice(0,8).map((X,_e)=>{const ke=Ve(X.categoryId),lt=ke?F1[ke.icon]:Uo;return a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[ke&&a.jsx("div",{className:"p-2 rounded-lg",style:{backgroundColor:`${ke.color}20`},children:a.jsx(lt,{className:"h-4 w-4",style:{color:ke.color}})}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-gray-900",children:(ke==null?void 0:ke.name)||X.categoryName}),a.jsxs("p",{className:"text-sm text-gray-500",children:[X.count," expenses"]})]})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("p",{className:"font-semibold text-gray-900",children:Ue(X.amount)}),a.jsxs("p",{className:"text-sm text-gray-500",children:[X.percentage.toFixed(1),"%"]})]})]}),a.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:a.jsx("div",{className:"h-2 rounded-full transition-all duration-500",style:{width:`${X.percentage}%`,backgroundColor:(ke==null?void 0:ke.color)||"#6B7280"}})})]},X.categoryId)})}),c.categoryBreakdown.length>8&&a.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:a.jsxs("p",{className:"text-sm text-gray-500 text-center",children:["Showing top 8 of ",c.categoryBreakdown.length," categories"]})})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Monthly Trends (Last 12 Months)"}),a.jsx("div",{className:"space-y-3",children:c.monthlyTrends.slice(-6).map((X,_e)=>a.jsxs("div",{className:"flex items-center justify-between py-2",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-gray-900",children:X.month}),a.jsxs("p",{className:"text-sm text-gray-500",children:[X.count," expenses"]})]}),a.jsx("div",{className:"text-right",children:a.jsx("p",{className:"font-semibold text-gray-900",children:Ue(X.amount)})})]},_e))})]}),c.topVendors.length>0&&a.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Top Vendors"}),a.jsx("div",{className:"space-y-3",children:c.topVendors.slice(0,5).map((X,_e)=>a.jsxs("div",{className:"flex items-center justify-between py-2",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-gray-900",children:X.vendorName}),a.jsxs("p",{className:"text-sm text-gray-500",children:[X.count," transactions"]})]}),a.jsx("div",{className:"text-right",children:a.jsx("p",{className:"font-semibold text-gray-900",children:Ue(X.amount)})})]},_e))})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Payment Methods"}),a.jsx("div",{className:"space-y-3",children:c.paymentMethodBreakdown.map((X,_e)=>a.jsxs("div",{className:"flex items-center justify-between py-2",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-gray-900 capitalize",children:X.method.replace("_"," ")}),a.jsxs("p",{className:"text-sm text-gray-500",children:[X.count," transactions"]})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("p",{className:"font-semibold text-gray-900",children:Ue(X.amount)}),a.jsxs("p",{className:"text-sm text-gray-500",children:[X.percentage.toFixed(1),"%"]})]})]},_e))})]})]}):a.jsxs("div",{className:"text-center py-12",children:[a.jsx(Sa,{className:"h-12 w-12 mx-auto text-gray-400 mb-4"}),a.jsx("p",{className:"text-gray-600",children:"No analytics data available"})]})}),a.jsx("div",{className:"p-4 sm:p-6 border-t border-gray-200 bg-gray-50",children:a.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center justify-between gap-3",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-3",children:[a.jsxs("button",{onClick:()=>{y(!1),G(!0)},disabled:!c,className:"flex items-center justify-center gap-2 px-6 py-2.5 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50 text-sm sm:text-base",children:[a.jsx(Yn,{className:"h-4 w-4"}),"Export Report"]}),a.jsxs("button",{onClick:()=>{if(c){const _e=`Category,Amount,Count
${c.categoryBreakdown.map(pt=>{var ze;return`${((ze=Ve(pt.categoryId))==null?void 0:ze.name)||pt.categoryName},${pt.amount},${pt.count}`}).join(`
`)}`,ke=new Blob([_e],{type:"text/csv"}),lt=URL.createObjectURL(ke),mt=document.createElement("a");mt.href=lt,mt.download=`${t==null?void 0:t.name}-expense-analytics-${new Date().toISOString().split("T")[0]}.csv`,mt.click(),URL.revokeObjectURL(lt),Z.success("Analytics CSV exported successfully!")}},disabled:!c,className:"flex items-center justify-center gap-2 px-6 py-2.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 text-sm sm:text-base",children:[a.jsx(Yn,{className:"h-4 w-4"}),"Export Analytics CSV"]})]}),a.jsx("button",{onClick:()=>y(!1),className:"px-6 py-2.5 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors text-sm sm:text-base",children:"Close"})]})})]})}),re&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-2 sm:p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-xl sm:rounded-2xl shadow-2xl w-full max-w-md max-h-[95vh] sm:max-h-[90vh] overflow-y-auto",children:[a.jsx("div",{className:"p-4 sm:p-6 border-b border-gray-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-lg sm:text-xl font-semibold text-gray-900",children:"Export Expense Report"}),a.jsx("p",{className:"text-sm sm:text-base text-gray-600",children:"Select date range for your expense report"})]}),a.jsx("button",{onClick:()=>G(!1),className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100",children:a.jsx(El,{className:"h-5 w-5"})})]})}),a.jsx("div",{className:"p-4 sm:p-6",children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Date Range"}),a.jsxs("select",{value:Ae,onChange:X=>he(X.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",children:[a.jsx("option",{value:"today",children:"Today"}),a.jsx("option",{value:"yesterday",children:"Yesterday"}),a.jsx("option",{value:"week",children:"Last 1 Week"}),a.jsx("option",{value:"15days",children:"Last 15 Days"}),a.jsx("option",{value:"month",children:"Last 1 Month"}),a.jsx("option",{value:"3months",children:"Last 3 Months"}),a.jsx("option",{value:"6months",children:"Last 6 Months"}),a.jsx("option",{value:"12months",children:"Last 12 Months"}),a.jsx("option",{value:"custom",children:"Custom Date Range"})]})]}),Ae==="custom"&&a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Date"}),a.jsx("input",{type:"date",value:I,onChange:X=>U(X.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Date"}),a.jsx("input",{type:"date",value:V,onChange:X=>L(X.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"})]})]}),(()=>{const X=we();return X?a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[a.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Report Preview"}),a.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-gray-600",children:"Total Expenses:"}),a.jsx("p",{className:"font-semibold text-gray-900",children:Ue(X.totalExpenses)})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-gray-600",children:"Transactions:"}),a.jsx("p",{className:"font-semibold text-gray-900",children:X.expenseCount})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-gray-600",children:"Categories:"}),a.jsx("p",{className:"font-semibold text-gray-900",children:X.categoryBreakdown.length})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-gray-600",children:"Vendors:"}),a.jsx("p",{className:"font-semibold text-gray-900",children:X.topVendors.length})]})]})]}):a.jsx("div",{className:"bg-yellow-50 rounded-lg p-4",children:a.jsx("p",{className:"text-yellow-800 text-sm",children:"No data available for the selected date range."})})})()]})}),a.jsx("div",{className:"p-4 sm:p-6 border-t border-gray-200 bg-gray-50",children:a.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center justify-between gap-3",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-3",children:[a.jsxs("button",{onClick:De,disabled:W||!we(),className:"flex items-center justify-center gap-2 px-6 py-2.5 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50 text-sm sm:text-base",children:[W?a.jsx(Gi,{className:"h-4 w-4 animate-spin"}):a.jsx(Yn,{className:"h-4 w-4"}),W?"Exporting...":"Export PDF"]}),a.jsxs("button",{onClick:()=>{const X=we();if(X&&t){const ke=`Date,Title,Category,Amount,Payment Method,Vendor
${X.expenses.map(Me=>{var rt;return`${Me.expenseDate.toLocaleDateString()},${Me.title},${Me.categoryName},${Me.amount},${Me.paymentMethod},${((rt=Me.vendor)==null?void 0:rt.name)||"N/A"}`}).join(`
`)}`,lt=new Blob([ke],{type:"text/csv"}),mt=URL.createObjectURL(lt),pt=document.createElement("a");pt.href=mt;const ze=Ae==="custom"?`${I}-to-${V}`:Ae;pt.download=`${t.name.replace(/\s+/g,"-").toLowerCase()}-expenses-${ze}-${new Date().toISOString().split("T")[0]}.csv`,pt.click(),URL.revokeObjectURL(mt),Z.success("Expense list CSV exported successfully!")}},disabled:!we(),className:"flex items-center justify-center gap-2 px-6 py-2.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 text-sm sm:text-base",children:[a.jsx(Yn,{className:"h-4 w-4"}),"Export CSV"]})]}),a.jsx("button",{onClick:()=>G(!1),className:"px-6 py-2.5 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors text-sm sm:text-base",children:"Cancel"})]})})]})})]}):null}/*!
 * html2canvas 1.4.1 <https://html2canvas.hertzen.com>
 * Copyright (c) 2022 Niklas von Hertzen <https://hertzen.com>
 * Released under MIT License
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var vS=function(t,e){return vS=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,s){r.__proto__=s}||function(r,s){for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(r[n]=s[n])},vS(t,e)};function vc(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");vS(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var bS=function(){return bS=Object.assign||function(e){for(var r,s=1,n=arguments.length;s<n;s++){r=arguments[s];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},bS.apply(this,arguments)};function Vi(t,e,r,s){function n(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function l(u){try{d(s.next(u))}catch(A){o(A)}}function c(u){try{d(s.throw(u))}catch(A){o(A)}}function d(u){u.done?i(u.value):n(u.value).then(l,c)}d((s=s.apply(t,[])).next())})}function vi(t,e){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},s,n,i,o;return o={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function l(d){return function(u){return c([d,u])}}function c(d){if(s)throw new TypeError("Generator is already executing.");for(;r;)try{if(s=1,n&&(i=d[0]&2?n.return:d[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,d[1])).done)return i;switch(n=0,i&&(d=[d[0]&2,i.value]),d[0]){case 0:case 1:i=d;break;case 4:return r.label++,{value:d[1],done:!1};case 5:r.label++,n=d[1],d=[0];continue;case 7:d=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(d[0]===6||d[0]===2)){r=0;continue}if(d[0]===3&&(!i||d[1]>i[0]&&d[1]<i[3])){r.label=d[1];break}if(d[0]===6&&r.label<i[1]){r.label=i[1],i=d;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(d);break}i[2]&&r.ops.pop(),r.trys.pop();continue}d=e.call(t,r)}catch(u){d=[6,u],n=0}finally{s=i=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}}function P1(t,e,r){if(arguments.length===2)for(var s=0,n=e.length,i;s<n;s++)(i||!(s in e))&&(i||(i=Array.prototype.slice.call(e,0,s)),i[s]=e[s]);return t.concat(i||e)}var lu=function(){function t(e,r,s,n){this.left=e,this.top=r,this.width=s,this.height=n}return t.prototype.add=function(e,r,s,n){return new t(this.left+e,this.top+r,this.width+s,this.height+n)},t.fromClientRect=function(e,r){return new t(r.left+e.windowBounds.left,r.top+e.windowBounds.top,r.width,r.height)},t.fromDOMRectList=function(e,r){var s=Array.from(r).find(function(n){return n.width!==0});return s?new t(s.left+e.windowBounds.left,s.top+e.windowBounds.top,s.width,s.height):t.EMPTY},t.EMPTY=new t(0,0,0,0),t}(),FN=function(t,e){return lu.fromClientRect(t,e.getBoundingClientRect())},mge=function(t){var e=t.body,r=t.documentElement;if(!e||!r)throw new Error("Unable to get document size");var s=Math.max(Math.max(e.scrollWidth,r.scrollWidth),Math.max(e.offsetWidth,r.offsetWidth),Math.max(e.clientWidth,r.clientWidth)),n=Math.max(Math.max(e.scrollHeight,r.scrollHeight),Math.max(e.offsetHeight,r.offsetHeight),Math.max(e.clientHeight,r.clientHeight));return new lu(0,0,s,n)},PN=function(t){for(var e=[],r=0,s=t.length;r<s;){var n=t.charCodeAt(r++);if(n>=55296&&n<=56319&&r<s){var i=t.charCodeAt(r++);(i&64512)===56320?e.push(((n&1023)<<10)+(i&1023)+65536):(e.push(n),r--)}else e.push(n)}return e},zn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(String.fromCodePoint)return String.fromCodePoint.apply(String,t);var r=t.length;if(!r)return"";for(var s=[],n=-1,i="";++n<r;){var o=t[n];o<=65535?s.push(o):(o-=65536,s.push((o>>10)+55296,o%1024+56320)),(n+1===r||s.length>16384)&&(i+=String.fromCharCode.apply(String,s),s.length=0)}return i},fP="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",pge=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var D1=0;D1<fP.length;D1++)pge[fP.charCodeAt(D1)]=D1;var mP="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Qg=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var R1=0;R1<mP.length;R1++)Qg[mP.charCodeAt(R1)]=R1;var gge=function(t){var e=t.length*.75,r=t.length,s,n=0,i,o,l,c;t[t.length-1]==="="&&(e--,t[t.length-2]==="="&&e--);var d=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(e):new Array(e),u=Array.isArray(d)?d:new Uint8Array(d);for(s=0;s<r;s+=4)i=Qg[t.charCodeAt(s)],o=Qg[t.charCodeAt(s+1)],l=Qg[t.charCodeAt(s+2)],c=Qg[t.charCodeAt(s+3)],u[n++]=i<<2|o>>4,u[n++]=(o&15)<<4|l>>2,u[n++]=(l&3)<<6|c&63;return d},xge=function(t){for(var e=t.length,r=[],s=0;s<e;s+=2)r.push(t[s+1]<<8|t[s]);return r},yge=function(t){for(var e=t.length,r=[],s=0;s<e;s+=4)r.push(t[s+3]<<24|t[s+2]<<16|t[s+1]<<8|t[s]);return r},yf=5,iT=11,kC=2,vge=iT-yf,$Q=65536>>yf,bge=1<<yf,BC=bge-1,wge=1024>>yf,Nge=$Q+wge,Cge=Nge,jge=32,Sge=Cge+jge,Ege=65536>>iT,_ge=1<<vge,Tge=_ge-1,pP=function(t,e,r){return t.slice?t.slice(e,r):new Uint16Array(Array.prototype.slice.call(t,e,r))},Ige=function(t,e,r){return t.slice?t.slice(e,r):new Uint32Array(Array.prototype.slice.call(t,e,r))},kge=function(t,e){var r=gge(t),s=Array.isArray(r)?yge(r):new Uint32Array(r),n=Array.isArray(r)?xge(r):new Uint16Array(r),i=24,o=pP(n,i/2,s[4]/2),l=s[5]===2?pP(n,(i+s[4])/2):Ige(s,Math.ceil((i+s[4])/4));return new Bge(s[0],s[1],s[2],s[3],o,l)},Bge=function(){function t(e,r,s,n,i,o){this.initialValue=e,this.errorValue=r,this.highStart=s,this.highValueIndex=n,this.index=i,this.data=o}return t.prototype.get=function(e){var r;if(e>=0){if(e<55296||e>56319&&e<=65535)return r=this.index[e>>yf],r=(r<<kC)+(e&BC),this.data[r];if(e<=65535)return r=this.index[$Q+(e-55296>>yf)],r=(r<<kC)+(e&BC),this.data[r];if(e<this.highStart)return r=Sge-Ege+(e>>iT),r=this.index[r],r+=e>>yf&Tge,r=this.index[r],r=(r<<kC)+(e&BC),this.data[r];if(e<=1114111)return this.data[this.highValueIndex]}return this.errorValue},t}(),gP="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Fge=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var L1=0;L1<gP.length;L1++)Fge[gP.charCodeAt(L1)]=L1;var Pge="KwAAAAAAAAAACA4AUD0AADAgAAACAAAAAAAIABAAGABAAEgAUABYAGAAaABgAGgAYgBqAF8AZwBgAGgAcQB5AHUAfQCFAI0AlQCdAKIAqgCyALoAYABoAGAAaABgAGgAwgDKAGAAaADGAM4A0wDbAOEA6QDxAPkAAQEJAQ8BFwF1AH0AHAEkASwBNAE6AUIBQQFJAVEBWQFhAWgBcAF4ATAAgAGGAY4BlQGXAZ8BpwGvAbUBvQHFAc0B0wHbAeMB6wHxAfkBAQIJAvEBEQIZAiECKQIxAjgCQAJGAk4CVgJeAmQCbAJ0AnwCgQKJApECmQKgAqgCsAK4ArwCxAIwAMwC0wLbAjAA4wLrAvMC+AIAAwcDDwMwABcDHQMlAy0DNQN1AD0DQQNJA0kDSQNRA1EDVwNZA1kDdQB1AGEDdQBpA20DdQN1AHsDdQCBA4kDkQN1AHUAmQOhA3UAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AKYDrgN1AHUAtgO+A8YDzgPWAxcD3gPjA+sD8wN1AHUA+wMDBAkEdQANBBUEHQQlBCoEFwMyBDgEYABABBcDSARQBFgEYARoBDAAcAQzAXgEgASIBJAEdQCXBHUAnwSnBK4EtgS6BMIEyAR1AHUAdQB1AHUAdQCVANAEYABgAGAAYABgAGAAYABgANgEYADcBOQEYADsBPQE/AQEBQwFFAUcBSQFLAU0BWQEPAVEBUsFUwVbBWAAYgVgAGoFcgV6BYIFigWRBWAAmQWfBaYFYABgAGAAYABgAKoFYACxBbAFuQW6BcEFwQXHBcEFwQXPBdMF2wXjBeoF8gX6BQIGCgYSBhoGIgYqBjIGOgZgAD4GRgZMBmAAUwZaBmAAYABgAGAAYABgAGAAYABgAGAAYABgAGIGYABpBnAGYABgAGAAYABgAGAAYABgAGAAYAB4Bn8GhQZgAGAAYAB1AHcDFQSLBmAAYABgAJMGdQA9A3UAmwajBqsGqwaVALMGuwbDBjAAywbSBtIG1QbSBtIG0gbSBtIG0gbdBuMG6wbzBvsGAwcLBxMHAwcbByMHJwcsBywHMQcsB9IGOAdAB0gHTgfSBkgHVgfSBtIG0gbSBtIG0gbSBtIG0gbSBiwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdgAGAALAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdbB2MHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB2kH0gZwB64EdQB1AHUAdQB1AHUAdQB1AHUHfQdgAIUHjQd1AHUAlQedB2AAYAClB6sHYACzB7YHvgfGB3UAzgfWBzMB3gfmB1EB7gf1B/0HlQENAQUIDQh1ABUIHQglCBcDLQg1CD0IRQhNCEEDUwh1AHUAdQBbCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIcAh3CHoIMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIgggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAALAcsBywHLAcsBywHLAcsBywHLAcsB4oILAcsB44I0gaWCJ4Ipgh1AHUAqgiyCHUAdQB1AHUAdQB1AHUAdQB1AHUAtwh8AXUAvwh1AMUIyQjRCNkI4AjoCHUAdQB1AO4I9gj+CAYJDgkTCS0HGwkjCYIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiAAIAAAAFAAYABgAGIAXwBgAHEAdQBFAJUAogCyAKAAYABgAEIA4ABGANMA4QDxAMEBDwE1AFwBLAE6AQEBUQF4QkhCmEKoQrhCgAHIQsAB0MLAAcABwAHAAeDC6ABoAHDCwMMAAcABwAHAAdDDGMMAAcAB6MM4wwjDWMNow3jDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEjDqABWw6bDqABpg6gAaABoAHcDvwOPA+gAaABfA/8DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DpcPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB9cPKwkyCToJMAB1AHUAdQBCCUoJTQl1AFUJXAljCWcJawkwADAAMAAwAHMJdQB2CX4JdQCECYoJjgmWCXUAngkwAGAAYABxAHUApgn3A64JtAl1ALkJdQDACTAAMAAwADAAdQB1AHUAdQB1AHUAdQB1AHUAowYNBMUIMAAwADAAMADICcsJ0wnZCRUE4QkwAOkJ8An4CTAAMAB1AAAKvwh1AAgKDwoXCh8KdQAwACcKLgp1ADYKqAmICT4KRgowADAAdQB1AE4KMAB1AFYKdQBeCnUAZQowADAAMAAwADAAMAAwADAAMAAVBHUAbQowADAAdQC5CXUKMAAwAHwBxAijBogEMgF9CoQKiASMCpQKmgqIBKIKqgquCogEDQG2Cr4KxgrLCjAAMADTCtsKCgHjCusK8Qr5CgELMAAwADAAMAB1AIsECQsRC3UANAEZCzAAMAAwADAAMAB1ACELKQswAHUANAExCzkLdQBBC0kLMABRC1kLMAAwADAAMAAwADAAdQBhCzAAMAAwAGAAYABpC3ELdwt/CzAAMACHC4sLkwubC58Lpwt1AK4Ltgt1APsDMAAwADAAMAAwADAAMAAwAL4LwwvLC9IL1wvdCzAAMADlC+kL8Qv5C/8LSQswADAAMAAwADAAMAAwADAAMAAHDDAAMAAwADAAMAAODBYMHgx1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1ACYMMAAwADAAdQB1AHUALgx1AHUAdQB1AHUAdQA2DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AD4MdQBGDHUAdQB1AHUAdQB1AEkMdQB1AHUAdQB1AFAMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQBYDHUAdQB1AF8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUA+wMVBGcMMAAwAHwBbwx1AHcMfwyHDI8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAYABgAJcMMAAwADAAdQB1AJ8MlQClDDAAMACtDCwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB7UMLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AA0EMAC9DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAsBywHLAcsBywHLAcsBywHLQcwAMEMyAwsBywHLAcsBywHLAcsBywHLAcsBywHzAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1ANQM2QzhDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMABgAGAAYABgAGAAYABgAOkMYADxDGAA+AwADQYNYABhCWAAYAAODTAAMAAwADAAFg1gAGAAHg37AzAAMAAwADAAYABgACYNYAAsDTQNPA1gAEMNPg1LDWAAYABgAGAAYABgAGAAYABgAGAAUg1aDYsGVglhDV0NcQBnDW0NdQ15DWAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAlQCBDZUAiA2PDZcNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAnw2nDTAAMAAwADAAMAAwAHUArw23DTAAMAAwADAAMAAwADAAMAAwADAAMAB1AL8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQDHDTAAYABgAM8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA1w11ANwNMAAwAD0B5A0wADAAMAAwADAAMADsDfQN/A0EDgwOFA4wABsOMAAwADAAMAAwADAAMAAwANIG0gbSBtIG0gbSBtIG0gYjDigOwQUuDsEFMw7SBjoO0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGQg5KDlIOVg7SBtIGXg5lDm0OdQ7SBtIGfQ6EDooOjQ6UDtIGmg6hDtIG0gaoDqwO0ga0DrwO0gZgAGAAYADEDmAAYAAkBtIGzA5gANIOYADaDokO0gbSBt8O5w7SBu8O0gb1DvwO0gZgAGAAxA7SBtIG0gbSBtIGYABgAGAAYAAED2AAsAUMD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHJA8sBywHLAcsBywHLAccDywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywPLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAc0D9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHPA/SBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gYUD0QPlQCVAJUAMAAwADAAMACVAJUAlQCVAJUAlQCVAEwPMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA//8EAAQABAAEAAQABAAEAAQABAANAAMAAQABAAIABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQACgATABcAHgAbABoAHgAXABYAEgAeABsAGAAPABgAHABLAEsASwBLAEsASwBLAEsASwBLABgAGAAeAB4AHgATAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAGwASAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWAA0AEQAeAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAFAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJABYAGgAbABsAGwAeAB0AHQAeAE8AFwAeAA0AHgAeABoAGwBPAE8ADgBQAB0AHQAdAE8ATwAXAE8ATwBPABYAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwBWAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsABAAbABsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEAA0ADQBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABABQACsAKwArACsAKwArACsAKwAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUAAaABoAUABQAFAAUABQAEwAHgAbAFAAHgAEACsAKwAEAAQABAArAFAAUABQAFAAUABQACsAKwArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQACsAUABQACsAKwAEACsABAAEAAQABAAEACsAKwArACsABAAEACsAKwAEAAQABAArACsAKwAEACsAKwArACsAKwArACsAUABQAFAAUAArAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAAQABABQAFAAUAAEAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAArACsAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AGwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAKwArACsAKwArAAQABAAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAAQAUAArAFAAUABQAFAAUABQACsAKwArAFAAUABQACsAUABQAFAAUAArACsAKwBQAFAAKwBQACsAUABQACsAKwArAFAAUAArACsAKwBQAFAAUAArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAArACsAKwAEAAQABAArAAQABAAEAAQAKwArAFAAKwArACsAKwArACsABAArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAHgAeAB4AHgAeAB4AGwAeACsAKwArACsAKwAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAUABQAFAAKwArACsAKwArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwAOAFAAUABQAFAAUABQAFAAHgBQAAQABAAEAA4AUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAKwArAAQAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAKwArACsAKwArACsAUAArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAXABcAFwAXABcACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAXAArAFwAXABcAFwAXABcAFwAXABcAFwAKgBcAFwAKgAqACoAKgAqACoAKgAqACoAXAArACsAXABcAFwAXABcACsAXAArACoAKgAqACoAKgAqACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwBcAFwAXABcAFAADgAOAA4ADgAeAA4ADgAJAA4ADgANAAkAEwATABMAEwATAAkAHgATAB4AHgAeAAQABAAeAB4AHgAeAB4AHgBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAADQAEAB4ABAAeAAQAFgARABYAEQAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAAQABAAEAAQADQAEAAQAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAA0ADQAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeACsAHgAeAA4ADgANAA4AHgAeAB4AHgAeAAkACQArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgBcAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4AHgAeAB4AXABcAFwAXABcAFwAKgAqACoAKgBcAFwAXABcACoAKgAqAFwAKgAqACoAXABcACoAKgAqACoAKgAqACoAXABcAFwAKgAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwAKgBLAEsASwBLAEsASwBLAEsASwBLACoAKgAqACoAKgAqAFAAUABQAFAAUABQACsAUAArACsAKwArACsAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAKwBQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsABAAEAAQAHgANAB4AHgAeAB4AHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUAArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWABEAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAANAA0AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUAArAAQABAArACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAA0ADQAVAFwADQAeAA0AGwBcACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwAeAB4AEwATAA0ADQAOAB4AEwATAB4ABAAEAAQACQArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAHgArACsAKwATABMASwBLAEsASwBLAEsASwBLAEsASwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAXABcAFwAXABcACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXAArACsAKwAqACoAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsAHgAeAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKwArAAQASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACoAKgAqACoAKgAqACoAXAAqACoAKgAqACoAKgArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABABQAFAAUABQAFAAUABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgANAA0ADQANAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwAeAB4AHgAeAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArAA0ADQANAA0ADQBLAEsASwBLAEsASwBLAEsASwBLACsAKwArAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUAAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAAQAUABQAFAAUABQAFAABABQAFAABAAEAAQAUAArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQACsAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQACsAKwAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQACsAHgAeAB4AHgAeAB4AHgAOAB4AKwANAA0ADQANAA0ADQANAAkADQANAA0ACAAEAAsABAAEAA0ACQANAA0ADAAdAB0AHgAXABcAFgAXABcAFwAWABcAHQAdAB4AHgAUABQAFAANAAEAAQAEAAQABAAEAAQACQAaABoAGgAaABoAGgAaABoAHgAXABcAHQAVABUAHgAeAB4AHgAeAB4AGAAWABEAFQAVABUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ADQAeAA0ADQANAA0AHgANAA0ADQAHAB4AHgAeAB4AKwAEAAQABAAEAAQABAAEAAQABAAEAFAAUAArACsATwBQAFAAUABQAFAAHgAeAB4AFgARAE8AUABPAE8ATwBPAFAAUABQAFAAUAAeAB4AHgAWABEAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArABsAGwAbABsAGwAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGgAbABsAGwAbABoAGwAbABoAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAFAAGgAeAB0AHgBQAB4AGgAeAB4AHgAeAB4AHgAeAB4AHgBPAB4AUAAbAB4AHgBQAFAAUABQAFAAHgAeAB4AHQAdAB4AUAAeAFAAHgBQAB4AUABPAFAAUAAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgBQAFAAUABQAE8ATwBQAFAAUABQAFAATwBQAFAATwBQAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAUABQAFAATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABPAB4AHgArACsAKwArAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAdAB4AHgAeAB0AHQAeAB4AHQAeAB4AHgAdAB4AHQAbABsAHgAdAB4AHgAeAB4AHQAeAB4AHQAdAB0AHQAeAB4AHQAeAB0AHgAdAB0AHQAdAB0AHQAeAB0AHgAeAB4AHgAeAB0AHQAdAB0AHgAeAB4AHgAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB0AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAdAB0AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHQAdAB0AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHQAdAB4AHgAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AJQAlAB0AHQAlAB4AJQAlACUAIAAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAeAB0AJQAdAB0AHgAdAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAdAB0AHQAdACUAHgAlACUAJQAdACUAJQAdAB0AHQAlACUAHQAdACUAHQAdACUAJQAlAB4AHQAeAB4AHgAeAB0AHQAlAB0AHQAdAB0AHQAdACUAJQAlACUAJQAdACUAJQAgACUAHQAdACUAJQAlACUAJQAlACUAJQAeAB4AHgAlACUAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AFwAXABcAFwAXABcAHgATABMAJQAeAB4AHgAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARABYAEQAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANAA0AHgANAB4ADQANAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwAlACUAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACsAKwArACsAKwArACsAKwArACsAKwArAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBPAE8ATwBPAE8ATwBPAE8AJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeAAQAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUABQAAQAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAUABQAFAAUABQAAQABAAEACsABAAEACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAKwBQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAA0ADQANAA0ADQANAA0ADQAeACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAArACsAKwArAFAAUABQAFAAUAANAA0ADQANAA0ADQAUACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQANAA0ADQANAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAANACsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAB4AHgAeAB4AHgArACsAKwArACsAKwAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANAFAABAAEAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAEAAQABAAEAB4ABAAEAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsABAAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLAA0ADQArAB4ABABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUAAeAFAAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAAEAAQADgANAA0AEwATAB4AHgAeAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAFAAUABQAFAABAAEACsAKwAEAA0ADQAeAFAAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcAFwADQANAA0AKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQAKwAEAAQAKwArAAQABAAEAAQAUAAEAFAABAAEAA0ADQANACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABABQAA4AUAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANAFAADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAaABoAGgAaAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAJAAkACQAJAAkACQAJABYAEQArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AHgAeACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAARwBHABUARwAJACsAKwArACsAKwArACsAKwArACsAKwAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAKwArACsAKwArACsAKwArACsAKwArACsAKwBRAFEAUQBRACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAHgAEAAQADQAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAeAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQAHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAKwArAFAAKwArAFAAUAArACsAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAHgAeAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeACsAKwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4ABAAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAHgAeAA0ADQANAA0AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArAAQABAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwBQAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArABsAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAB4AHgAeAB4ABAAEAAQABAAEAAQABABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArABYAFgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAGgBQAFAAUAAaAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUAArACsAKwArACsAKwBQACsAKwArACsAUAArAFAAKwBQACsAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUAArAFAAKwBQACsAUAArAFAAUAArAFAAKwArAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAKwBQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeACUAJQAlAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAHgAlACUAJQAlACUAIAAgACAAJQAlACAAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACEAIQAhACEAIQAlACUAIAAgACUAJQAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAlACUAJQAlACAAIAAgACUAIAAgACAAJQAlACUAJQAlACUAJQAgACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAlAB4AJQAeACUAJQAlACUAJQAgACUAJQAlACUAHgAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACAAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABcAFwAXABUAFQAVAB4AHgAeAB4AJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAgACUAJQAgACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAIAAgACUAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACAAIAAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACAAIAAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAA==",xP=50,Dge=1,KQ=2,zQ=3,Rge=4,Lge=5,yP=7,qQ=8,vP=9,bA=10,wS=11,bP=12,NS=13,Oge=14,Vg=15,CS=16,O1=17,Ng=18,Uge=19,wP=20,jS=21,Cg=22,FC=23,Mm=24,Do=25,Hg=26,$g=27,Qm=28,Mge=29,Yh=30,Qge=31,U1=32,M1=33,SS=34,ES=35,_S=36,Cy=37,TS=38,Ub=39,Mb=40,PC=41,WQ=42,Vge=43,Hge=[9001,65288],GQ="!",ls="",Q1="",IS=kge(Pge),Id=[Yh,_S],kS=[Dge,KQ,zQ,Lge],YQ=[bA,qQ],NP=[$g,Hg],$ge=kS.concat(YQ),CP=[TS,Ub,Mb,SS,ES],Kge=[Vg,NS],zge=function(t,e){e===void 0&&(e="strict");var r=[],s=[],n=[];return t.forEach(function(i,o){var l=IS.get(i);if(l>xP?(n.push(!0),l-=xP):n.push(!1),["normal","auto","loose"].indexOf(e)!==-1&&[8208,8211,12316,12448].indexOf(i)!==-1)return s.push(o),r.push(CS);if(l===Rge||l===wS){if(o===0)return s.push(o),r.push(Yh);var c=r[o-1];return $ge.indexOf(c)===-1?(s.push(s[o-1]),r.push(c)):(s.push(o),r.push(Yh))}if(s.push(o),l===Qge)return r.push(e==="strict"?jS:Cy);if(l===WQ||l===Mge)return r.push(Yh);if(l===Vge)return i>=131072&&i<=196605||i>=196608&&i<=262141?r.push(Cy):r.push(Yh);r.push(l)}),[s,r,n]},DC=function(t,e,r,s){var n=s[r];if(Array.isArray(t)?t.indexOf(n)!==-1:t===n)for(var i=r;i<=s.length;){i++;var o=s[i];if(o===e)return!0;if(o!==bA)break}if(n===bA)for(var i=r;i>0;){i--;var l=s[i];if(Array.isArray(t)?t.indexOf(l)!==-1:t===l)for(var c=r;c<=s.length;){c++;var o=s[c];if(o===e)return!0;if(o!==bA)break}if(l!==bA)break}return!1},jP=function(t,e){for(var r=t;r>=0;){var s=e[r];if(s===bA)r--;else return s}return 0},qge=function(t,e,r,s,n){if(r[s]===0)return ls;var i=s-1;if(Array.isArray(n)&&n[i]===!0)return ls;var o=i-1,l=i+1,c=e[i],d=o>=0?e[o]:0,u=e[l];if(c===KQ&&u===zQ)return ls;if(kS.indexOf(c)!==-1)return GQ;if(kS.indexOf(u)!==-1||YQ.indexOf(u)!==-1)return ls;if(jP(i,e)===qQ)return Q1;if(IS.get(t[i])===wS||(c===U1||c===M1)&&IS.get(t[l])===wS||c===yP||u===yP||c===vP||[bA,NS,Vg].indexOf(c)===-1&&u===vP||[O1,Ng,Uge,Mm,Qm].indexOf(u)!==-1||jP(i,e)===Cg||DC(FC,Cg,i,e)||DC([O1,Ng],jS,i,e)||DC(bP,bP,i,e))return ls;if(c===bA)return Q1;if(c===FC||u===FC)return ls;if(u===CS||c===CS)return Q1;if([NS,Vg,jS].indexOf(u)!==-1||c===Oge||d===_S&&Kge.indexOf(c)!==-1||c===Qm&&u===_S||u===wP||Id.indexOf(u)!==-1&&c===Do||Id.indexOf(c)!==-1&&u===Do||c===$g&&[Cy,U1,M1].indexOf(u)!==-1||[Cy,U1,M1].indexOf(c)!==-1&&u===Hg||Id.indexOf(c)!==-1&&NP.indexOf(u)!==-1||NP.indexOf(c)!==-1&&Id.indexOf(u)!==-1||[$g,Hg].indexOf(c)!==-1&&(u===Do||[Cg,Vg].indexOf(u)!==-1&&e[l+1]===Do)||[Cg,Vg].indexOf(c)!==-1&&u===Do||c===Do&&[Do,Qm,Mm].indexOf(u)!==-1)return ls;if([Do,Qm,Mm,O1,Ng].indexOf(u)!==-1)for(var A=i;A>=0;){var h=e[A];if(h===Do)return ls;if([Qm,Mm].indexOf(h)!==-1)A--;else break}if([$g,Hg].indexOf(u)!==-1)for(var A=[O1,Ng].indexOf(c)!==-1?o:i;A>=0;){var h=e[A];if(h===Do)return ls;if([Qm,Mm].indexOf(h)!==-1)A--;else break}if(TS===c&&[TS,Ub,SS,ES].indexOf(u)!==-1||[Ub,SS].indexOf(c)!==-1&&[Ub,Mb].indexOf(u)!==-1||[Mb,ES].indexOf(c)!==-1&&u===Mb||CP.indexOf(c)!==-1&&[wP,Hg].indexOf(u)!==-1||CP.indexOf(u)!==-1&&c===$g||Id.indexOf(c)!==-1&&Id.indexOf(u)!==-1||c===Mm&&Id.indexOf(u)!==-1||Id.concat(Do).indexOf(c)!==-1&&u===Cg&&Hge.indexOf(t[l])===-1||Id.concat(Do).indexOf(u)!==-1&&c===Ng)return ls;if(c===PC&&u===PC){for(var f=r[i],p=1;f>0&&(f--,e[f]===PC);)p++;if(p%2!==0)return ls}return c===U1&&u===M1?ls:Q1},Wge=function(t,e){e||(e={lineBreak:"normal",wordBreak:"normal"});var r=zge(t,e.lineBreak),s=r[0],n=r[1],i=r[2];(e.wordBreak==="break-all"||e.wordBreak==="break-word")&&(n=n.map(function(l){return[Do,Yh,WQ].indexOf(l)!==-1?Cy:l}));var o=e.wordBreak==="keep-all"?i.map(function(l,c){return l&&t[c]>=19968&&t[c]<=40959}):void 0;return[s,n,o]},Gge=function(){function t(e,r,s,n){this.codePoints=e,this.required=r===GQ,this.start=s,this.end=n}return t.prototype.slice=function(){return zn.apply(void 0,this.codePoints.slice(this.start,this.end))},t}(),Yge=function(t,e){var r=PN(t),s=Wge(r,e),n=s[0],i=s[1],o=s[2],l=r.length,c=0,d=0;return{next:function(){if(d>=l)return{done:!0,value:null};for(var u=ls;d<l&&(u=qge(r,i,n,++d,o))===ls;);if(u!==ls||d===l){var A=new Gge(r,u,c,d);return c=d,{value:A,done:!1}}return{done:!0,value:null}}}},Xge=1,Jge=2,Av=4,SP=8,A2=10,EP=47,Ex=92,Zge=9,exe=32,V1=34,jg=61,txe=35,rxe=36,sxe=37,H1=39,$1=40,Sg=41,nxe=95,fo=45,axe=33,ixe=60,oxe=62,lxe=64,cxe=91,dxe=93,uxe=61,Axe=123,K1=63,hxe=125,_P=124,fxe=126,mxe=128,TP=65533,RC=42,lf=43,pxe=44,gxe=58,xxe=59,jy=46,yxe=0,vxe=8,bxe=11,wxe=14,Nxe=31,Cxe=127,Bc=-1,XQ=48,JQ=97,ZQ=101,jxe=102,Sxe=117,Exe=122,eV=65,tV=69,rV=70,_xe=85,Txe=90,Ci=function(t){return t>=XQ&&t<=57},Ixe=function(t){return t>=55296&&t<=57343},Vm=function(t){return Ci(t)||t>=eV&&t<=rV||t>=JQ&&t<=jxe},kxe=function(t){return t>=JQ&&t<=Exe},Bxe=function(t){return t>=eV&&t<=Txe},Fxe=function(t){return kxe(t)||Bxe(t)},Pxe=function(t){return t>=mxe},z1=function(t){return t===A2||t===Zge||t===exe},h2=function(t){return Fxe(t)||Pxe(t)||t===nxe},IP=function(t){return h2(t)||Ci(t)||t===fo},Dxe=function(t){return t>=yxe&&t<=vxe||t===bxe||t>=wxe&&t<=Nxe||t===Cxe},tA=function(t,e){return t!==Ex?!1:e!==A2},q1=function(t,e,r){return t===fo?h2(e)||tA(e,r):h2(t)?!0:!!(t===Ex&&tA(t,e))},LC=function(t,e,r){return t===lf||t===fo?Ci(e)?!0:e===jy&&Ci(r):Ci(t===jy?e:t)},Rxe=function(t){var e=0,r=1;(t[e]===lf||t[e]===fo)&&(t[e]===fo&&(r=-1),e++);for(var s=[];Ci(t[e]);)s.push(t[e++]);var n=s.length?parseInt(zn.apply(void 0,s),10):0;t[e]===jy&&e++;for(var i=[];Ci(t[e]);)i.push(t[e++]);var o=i.length,l=o?parseInt(zn.apply(void 0,i),10):0;(t[e]===tV||t[e]===ZQ)&&e++;var c=1;(t[e]===lf||t[e]===fo)&&(t[e]===fo&&(c=-1),e++);for(var d=[];Ci(t[e]);)d.push(t[e++]);var u=d.length?parseInt(zn.apply(void 0,d),10):0;return r*(n+l*Math.pow(10,-o))*Math.pow(10,c*u)},Lxe={type:2},Oxe={type:3},Uxe={type:4},Mxe={type:13},Qxe={type:8},Vxe={type:21},Hxe={type:9},$xe={type:10},Kxe={type:11},zxe={type:12},qxe={type:14},W1={type:23},Wxe={type:1},Gxe={type:25},Yxe={type:24},Xxe={type:26},Jxe={type:27},Zxe={type:28},eye={type:29},tye={type:31},BS={type:32},sV=function(){function t(){this._value=[]}return t.prototype.write=function(e){this._value=this._value.concat(PN(e))},t.prototype.read=function(){for(var e=[],r=this.consumeToken();r!==BS;)e.push(r),r=this.consumeToken();return e},t.prototype.consumeToken=function(){var e=this.consumeCodePoint();switch(e){case V1:return this.consumeStringToken(V1);case txe:var r=this.peekCodePoint(0),s=this.peekCodePoint(1),n=this.peekCodePoint(2);if(IP(r)||tA(s,n)){var i=q1(r,s,n)?Jge:Xge,o=this.consumeName();return{type:5,value:o,flags:i}}break;case rxe:if(this.peekCodePoint(0)===jg)return this.consumeCodePoint(),Mxe;break;case H1:return this.consumeStringToken(H1);case $1:return Lxe;case Sg:return Oxe;case RC:if(this.peekCodePoint(0)===jg)return this.consumeCodePoint(),qxe;break;case lf:if(LC(e,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(e),this.consumeNumericToken();break;case pxe:return Uxe;case fo:var l=e,c=this.peekCodePoint(0),d=this.peekCodePoint(1);if(LC(l,c,d))return this.reconsumeCodePoint(e),this.consumeNumericToken();if(q1(l,c,d))return this.reconsumeCodePoint(e),this.consumeIdentLikeToken();if(c===fo&&d===oxe)return this.consumeCodePoint(),this.consumeCodePoint(),Yxe;break;case jy:if(LC(e,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(e),this.consumeNumericToken();break;case EP:if(this.peekCodePoint(0)===RC)for(this.consumeCodePoint();;){var u=this.consumeCodePoint();if(u===RC&&(u=this.consumeCodePoint(),u===EP))return this.consumeToken();if(u===Bc)return this.consumeToken()}break;case gxe:return Xxe;case xxe:return Jxe;case ixe:if(this.peekCodePoint(0)===axe&&this.peekCodePoint(1)===fo&&this.peekCodePoint(2)===fo)return this.consumeCodePoint(),this.consumeCodePoint(),Gxe;break;case lxe:var A=this.peekCodePoint(0),h=this.peekCodePoint(1),f=this.peekCodePoint(2);if(q1(A,h,f)){var o=this.consumeName();return{type:7,value:o}}break;case cxe:return Zxe;case Ex:if(tA(e,this.peekCodePoint(0)))return this.reconsumeCodePoint(e),this.consumeIdentLikeToken();break;case dxe:return eye;case uxe:if(this.peekCodePoint(0)===jg)return this.consumeCodePoint(),Qxe;break;case Axe:return Kxe;case hxe:return zxe;case Sxe:case _xe:var p=this.peekCodePoint(0),m=this.peekCodePoint(1);return p===lf&&(Vm(m)||m===K1)&&(this.consumeCodePoint(),this.consumeUnicodeRangeToken()),this.reconsumeCodePoint(e),this.consumeIdentLikeToken();case _P:if(this.peekCodePoint(0)===jg)return this.consumeCodePoint(),Hxe;if(this.peekCodePoint(0)===_P)return this.consumeCodePoint(),Vxe;break;case fxe:if(this.peekCodePoint(0)===jg)return this.consumeCodePoint(),$xe;break;case Bc:return BS}return z1(e)?(this.consumeWhiteSpace(),tye):Ci(e)?(this.reconsumeCodePoint(e),this.consumeNumericToken()):h2(e)?(this.reconsumeCodePoint(e),this.consumeIdentLikeToken()):{type:6,value:zn(e)}},t.prototype.consumeCodePoint=function(){var e=this._value.shift();return typeof e>"u"?-1:e},t.prototype.reconsumeCodePoint=function(e){this._value.unshift(e)},t.prototype.peekCodePoint=function(e){return e>=this._value.length?-1:this._value[e]},t.prototype.consumeUnicodeRangeToken=function(){for(var e=[],r=this.consumeCodePoint();Vm(r)&&e.length<6;)e.push(r),r=this.consumeCodePoint();for(var s=!1;r===K1&&e.length<6;)e.push(r),r=this.consumeCodePoint(),s=!0;if(s){var n=parseInt(zn.apply(void 0,e.map(function(c){return c===K1?XQ:c})),16),i=parseInt(zn.apply(void 0,e.map(function(c){return c===K1?rV:c})),16);return{type:30,start:n,end:i}}var o=parseInt(zn.apply(void 0,e),16);if(this.peekCodePoint(0)===fo&&Vm(this.peekCodePoint(1))){this.consumeCodePoint(),r=this.consumeCodePoint();for(var l=[];Vm(r)&&l.length<6;)l.push(r),r=this.consumeCodePoint();var i=parseInt(zn.apply(void 0,l),16);return{type:30,start:o,end:i}}else return{type:30,start:o,end:o}},t.prototype.consumeIdentLikeToken=function(){var e=this.consumeName();return e.toLowerCase()==="url"&&this.peekCodePoint(0)===$1?(this.consumeCodePoint(),this.consumeUrlToken()):this.peekCodePoint(0)===$1?(this.consumeCodePoint(),{type:19,value:e}):{type:20,value:e}},t.prototype.consumeUrlToken=function(){var e=[];if(this.consumeWhiteSpace(),this.peekCodePoint(0)===Bc)return{type:22,value:""};var r=this.peekCodePoint(0);if(r===H1||r===V1){var s=this.consumeStringToken(this.consumeCodePoint());return s.type===0&&(this.consumeWhiteSpace(),this.peekCodePoint(0)===Bc||this.peekCodePoint(0)===Sg)?(this.consumeCodePoint(),{type:22,value:s.value}):(this.consumeBadUrlRemnants(),W1)}for(;;){var n=this.consumeCodePoint();if(n===Bc||n===Sg)return{type:22,value:zn.apply(void 0,e)};if(z1(n))return this.consumeWhiteSpace(),this.peekCodePoint(0)===Bc||this.peekCodePoint(0)===Sg?(this.consumeCodePoint(),{type:22,value:zn.apply(void 0,e)}):(this.consumeBadUrlRemnants(),W1);if(n===V1||n===H1||n===$1||Dxe(n))return this.consumeBadUrlRemnants(),W1;if(n===Ex)if(tA(n,this.peekCodePoint(0)))e.push(this.consumeEscapedCodePoint());else return this.consumeBadUrlRemnants(),W1;else e.push(n)}},t.prototype.consumeWhiteSpace=function(){for(;z1(this.peekCodePoint(0));)this.consumeCodePoint()},t.prototype.consumeBadUrlRemnants=function(){for(;;){var e=this.consumeCodePoint();if(e===Sg||e===Bc)return;tA(e,this.peekCodePoint(0))&&this.consumeEscapedCodePoint()}},t.prototype.consumeStringSlice=function(e){for(var r=5e4,s="";e>0;){var n=Math.min(r,e);s+=zn.apply(void 0,this._value.splice(0,n)),e-=n}return this._value.shift(),s},t.prototype.consumeStringToken=function(e){var r="",s=0;do{var n=this._value[s];if(n===Bc||n===void 0||n===e)return r+=this.consumeStringSlice(s),{type:0,value:r};if(n===A2)return this._value.splice(0,s),Wxe;if(n===Ex){var i=this._value[s+1];i!==Bc&&i!==void 0&&(i===A2?(r+=this.consumeStringSlice(s),s=-1,this._value.shift()):tA(n,i)&&(r+=this.consumeStringSlice(s),r+=zn(this.consumeEscapedCodePoint()),s=-1))}s++}while(!0)},t.prototype.consumeNumber=function(){var e=[],r=Av,s=this.peekCodePoint(0);for((s===lf||s===fo)&&e.push(this.consumeCodePoint());Ci(this.peekCodePoint(0));)e.push(this.consumeCodePoint());s=this.peekCodePoint(0);var n=this.peekCodePoint(1);if(s===jy&&Ci(n))for(e.push(this.consumeCodePoint(),this.consumeCodePoint()),r=SP;Ci(this.peekCodePoint(0));)e.push(this.consumeCodePoint());s=this.peekCodePoint(0),n=this.peekCodePoint(1);var i=this.peekCodePoint(2);if((s===tV||s===ZQ)&&((n===lf||n===fo)&&Ci(i)||Ci(n)))for(e.push(this.consumeCodePoint(),this.consumeCodePoint()),r=SP;Ci(this.peekCodePoint(0));)e.push(this.consumeCodePoint());return[Rxe(e),r]},t.prototype.consumeNumericToken=function(){var e=this.consumeNumber(),r=e[0],s=e[1],n=this.peekCodePoint(0),i=this.peekCodePoint(1),o=this.peekCodePoint(2);if(q1(n,i,o)){var l=this.consumeName();return{type:15,number:r,flags:s,unit:l}}return n===sxe?(this.consumeCodePoint(),{type:16,number:r,flags:s}):{type:17,number:r,flags:s}},t.prototype.consumeEscapedCodePoint=function(){var e=this.consumeCodePoint();if(Vm(e)){for(var r=zn(e);Vm(this.peekCodePoint(0))&&r.length<6;)r+=zn(this.consumeCodePoint());z1(this.peekCodePoint(0))&&this.consumeCodePoint();var s=parseInt(r,16);return s===0||Ixe(s)||s>1114111?TP:s}return e===Bc?TP:e},t.prototype.consumeName=function(){for(var e="";;){var r=this.consumeCodePoint();if(IP(r))e+=zn(r);else if(tA(r,this.peekCodePoint(0)))e+=zn(this.consumeEscapedCodePoint());else return this.reconsumeCodePoint(r),e}},t}(),nV=function(){function t(e){this._tokens=e}return t.create=function(e){var r=new sV;return r.write(e),new t(r.read())},t.parseValue=function(e){return t.create(e).parseComponentValue()},t.parseValues=function(e){return t.create(e).parseComponentValues()},t.prototype.parseComponentValue=function(){for(var e=this.consumeToken();e.type===31;)e=this.consumeToken();if(e.type===32)throw new SyntaxError("Error parsing CSS component value, unexpected EOF");this.reconsumeToken(e);var r=this.consumeComponentValue();do e=this.consumeToken();while(e.type===31);if(e.type===32)return r;throw new SyntaxError("Error parsing CSS component value, multiple values found when expecting only one")},t.prototype.parseComponentValues=function(){for(var e=[];;){var r=this.consumeComponentValue();if(r.type===32)return e;e.push(r),e.push()}},t.prototype.consumeComponentValue=function(){var e=this.consumeToken();switch(e.type){case 11:case 28:case 2:return this.consumeSimpleBlock(e.type);case 19:return this.consumeFunction(e)}return e},t.prototype.consumeSimpleBlock=function(e){for(var r={type:e,values:[]},s=this.consumeToken();;){if(s.type===32||sye(s,e))return r;this.reconsumeToken(s),r.values.push(this.consumeComponentValue()),s=this.consumeToken()}},t.prototype.consumeFunction=function(e){for(var r={name:e.value,values:[],type:18};;){var s=this.consumeToken();if(s.type===32||s.type===3)return r;this.reconsumeToken(s),r.values.push(this.consumeComponentValue())}},t.prototype.consumeToken=function(){var e=this._tokens.shift();return typeof e>"u"?BS:e},t.prototype.reconsumeToken=function(e){this._tokens.unshift(e)},t}(),hv=function(t){return t.type===15},Qp=function(t){return t.type===17},$s=function(t){return t.type===20},rye=function(t){return t.type===0},FS=function(t,e){return $s(t)&&t.value===e},aV=function(t){return t.type!==31},Np=function(t){return t.type!==31&&t.type!==4},cd=function(t){var e=[],r=[];return t.forEach(function(s){if(s.type===4){if(r.length===0)throw new Error("Error parsing function args, zero tokens for arg");e.push(r),r=[];return}s.type!==31&&r.push(s)}),r.length&&e.push(r),e},sye=function(t,e){return e===11&&t.type===12||e===28&&t.type===29?!0:e===2&&t.type===3},nh=function(t){return t.type===17||t.type===15},pa=function(t){return t.type===16||nh(t)},iV=function(t){return t.length>1?[t[0],t[1]]:[t[0]]},ni={type:17,number:0,flags:Av},oT={type:16,number:50,flags:Av},wA={type:16,number:100,flags:Av},Kg=function(t,e,r){var s=t[0],n=t[1];return[tn(s,e),tn(typeof n<"u"?n:s,r)]},tn=function(t,e){if(t.type===16)return t.number/100*e;if(hv(t))switch(t.unit){case"rem":case"em":return 16*t.number;case"px":default:return t.number}return t.number},oV="deg",lV="grad",cV="rad",dV="turn",DN={name:"angle",parse:function(t,e){if(e.type===15)switch(e.unit){case oV:return Math.PI*e.number/180;case lV:return Math.PI/200*e.number;case cV:return e.number;case dV:return Math.PI*2*e.number}throw new Error("Unsupported angle type")}},uV=function(t){return t.type===15&&(t.unit===oV||t.unit===lV||t.unit===cV||t.unit===dV)},AV=function(t){var e=t.filter($s).map(function(r){return r.value}).join(" ");switch(e){case"to bottom right":case"to right bottom":case"left top":case"top left":return[ni,ni];case"to top":case"bottom":return _l(0);case"to bottom left":case"to left bottom":case"right top":case"top right":return[ni,wA];case"to right":case"left":return _l(90);case"to top left":case"to left top":case"right bottom":case"bottom right":return[wA,wA];case"to bottom":case"top":return _l(180);case"to top right":case"to right top":case"left bottom":case"bottom left":return[wA,ni];case"to left":case"right":return _l(270)}return 0},_l=function(t){return Math.PI*t/180},MA={name:"color",parse:function(t,e){if(e.type===18){var r=nye[e.name];if(typeof r>"u")throw new Error('Attempting to parse an unsupported color function "'+e.name+'"');return r(t,e.values)}if(e.type===5){if(e.value.length===3){var s=e.value.substring(0,1),n=e.value.substring(1,2),i=e.value.substring(2,3);return NA(parseInt(s+s,16),parseInt(n+n,16),parseInt(i+i,16),1)}if(e.value.length===4){var s=e.value.substring(0,1),n=e.value.substring(1,2),i=e.value.substring(2,3),o=e.value.substring(3,4);return NA(parseInt(s+s,16),parseInt(n+n,16),parseInt(i+i,16),parseInt(o+o,16)/255)}if(e.value.length===6){var s=e.value.substring(0,2),n=e.value.substring(2,4),i=e.value.substring(4,6);return NA(parseInt(s,16),parseInt(n,16),parseInt(i,16),1)}if(e.value.length===8){var s=e.value.substring(0,2),n=e.value.substring(2,4),i=e.value.substring(4,6),o=e.value.substring(6,8);return NA(parseInt(s,16),parseInt(n,16),parseInt(i,16),parseInt(o,16)/255)}}if(e.type===20){var l=Gd[e.value.toUpperCase()];if(typeof l<"u")return l}return Gd.TRANSPARENT}},QA=function(t){return(255&t)===0},Da=function(t){var e=255&t,r=255&t>>8,s=255&t>>16,n=255&t>>24;return e<255?"rgba("+n+","+s+","+r+","+e/255+")":"rgb("+n+","+s+","+r+")"},NA=function(t,e,r,s){return(t<<24|e<<16|r<<8|Math.round(s*255)<<0)>>>0},kP=function(t,e){if(t.type===17)return t.number;if(t.type===16){var r=e===3?1:255;return e===3?t.number/100*r:Math.round(t.number/100*r)}return 0},BP=function(t,e){var r=e.filter(Np);if(r.length===3){var s=r.map(kP),n=s[0],i=s[1],o=s[2];return NA(n,i,o,1)}if(r.length===4){var l=r.map(kP),n=l[0],i=l[1],o=l[2],c=l[3];return NA(n,i,o,c)}return 0};function OC(t,e,r){return r<0&&(r+=1),r>=1&&(r-=1),r<1/6?(e-t)*r*6+t:r<1/2?e:r<2/3?(e-t)*6*(2/3-r)+t:t}var FP=function(t,e){var r=e.filter(Np),s=r[0],n=r[1],i=r[2],o=r[3],l=(s.type===17?_l(s.number):DN.parse(t,s))/(Math.PI*2),c=pa(n)?n.number/100:0,d=pa(i)?i.number/100:0,u=typeof o<"u"&&pa(o)?tn(o,1):1;if(c===0)return NA(d*255,d*255,d*255,1);var A=d<=.5?d*(c+1):d+c-d*c,h=d*2-A,f=OC(h,A,l+1/3),p=OC(h,A,l),m=OC(h,A,l-1/3);return NA(f*255,p*255,m*255,u)},nye={hsl:FP,hsla:FP,rgb:BP,rgba:BP},_x=function(t,e){return MA.parse(t,nV.create(e).parseComponentValue())},Gd={ALICEBLUE:4042850303,ANTIQUEWHITE:4209760255,AQUA:16777215,AQUAMARINE:2147472639,AZURE:4043309055,BEIGE:4126530815,BISQUE:4293182719,BLACK:255,BLANCHEDALMOND:4293643775,BLUE:65535,BLUEVIOLET:2318131967,BROWN:2771004159,BURLYWOOD:3736635391,CADETBLUE:1604231423,CHARTREUSE:2147418367,CHOCOLATE:3530104575,CORAL:4286533887,CORNFLOWERBLUE:1687547391,CORNSILK:4294499583,CRIMSON:3692313855,CYAN:16777215,DARKBLUE:35839,DARKCYAN:9145343,DARKGOLDENROD:3095837695,DARKGRAY:2846468607,DARKGREEN:6553855,DARKGREY:2846468607,DARKKHAKI:3182914559,DARKMAGENTA:2332068863,DARKOLIVEGREEN:1433087999,DARKORANGE:4287365375,DARKORCHID:2570243327,DARKRED:2332033279,DARKSALMON:3918953215,DARKSEAGREEN:2411499519,DARKSLATEBLUE:1211993087,DARKSLATEGRAY:793726975,DARKSLATEGREY:793726975,DARKTURQUOISE:13554175,DARKVIOLET:2483082239,DEEPPINK:4279538687,DEEPSKYBLUE:12582911,DIMGRAY:1768516095,DIMGREY:1768516095,DODGERBLUE:512819199,FIREBRICK:2988581631,FLORALWHITE:4294635775,FORESTGREEN:579543807,FUCHSIA:4278255615,GAINSBORO:3705462015,GHOSTWHITE:4177068031,GOLD:4292280575,GOLDENROD:3668254975,GRAY:2155905279,GREEN:8388863,GREENYELLOW:2919182335,GREY:2155905279,HONEYDEW:4043305215,HOTPINK:4285117695,INDIANRED:3445382399,INDIGO:1258324735,IVORY:4294963455,KHAKI:4041641215,LAVENDER:3873897215,LAVENDERBLUSH:4293981695,LAWNGREEN:2096890111,LEMONCHIFFON:4294626815,LIGHTBLUE:2916673279,LIGHTCORAL:4034953471,LIGHTCYAN:3774873599,LIGHTGOLDENRODYELLOW:4210742015,LIGHTGRAY:3553874943,LIGHTGREEN:2431553791,LIGHTGREY:3553874943,LIGHTPINK:4290167295,LIGHTSALMON:4288707327,LIGHTSEAGREEN:548580095,LIGHTSKYBLUE:2278488831,LIGHTSLATEGRAY:2005441023,LIGHTSLATEGREY:2005441023,LIGHTSTEELBLUE:2965692159,LIGHTYELLOW:4294959359,LIME:16711935,LIMEGREEN:852308735,LINEN:4210091775,MAGENTA:4278255615,MAROON:2147483903,MEDIUMAQUAMARINE:1724754687,MEDIUMBLUE:52735,MEDIUMORCHID:3126187007,MEDIUMPURPLE:2473647103,MEDIUMSEAGREEN:1018393087,MEDIUMSLATEBLUE:2070474495,MEDIUMSPRINGGREEN:16423679,MEDIUMTURQUOISE:1221709055,MEDIUMVIOLETRED:3340076543,MIDNIGHTBLUE:421097727,MINTCREAM:4127193855,MISTYROSE:4293190143,MOCCASIN:4293178879,NAVAJOWHITE:4292783615,NAVY:33023,OLDLACE:4260751103,OLIVE:2155872511,OLIVEDRAB:1804477439,ORANGE:4289003775,ORANGERED:4282712319,ORCHID:3664828159,PALEGOLDENROD:4008225535,PALEGREEN:2566625535,PALETURQUOISE:2951671551,PALEVIOLETRED:3681588223,PAPAYAWHIP:4293907967,PEACHPUFF:4292524543,PERU:3448061951,PINK:4290825215,PLUM:3718307327,POWDERBLUE:2967529215,PURPLE:2147516671,REBECCAPURPLE:1714657791,RED:4278190335,ROSYBROWN:3163525119,ROYALBLUE:1097458175,SADDLEBROWN:2336560127,SALMON:4202722047,SANDYBROWN:4104413439,SEAGREEN:780883967,SEASHELL:4294307583,SIENNA:2689740287,SILVER:3233857791,SKYBLUE:2278484991,SLATEBLUE:1784335871,SLATEGRAY:1887473919,SLATEGREY:1887473919,SNOW:4294638335,SPRINGGREEN:16744447,STEELBLUE:1182971135,TAN:3535047935,TEAL:8421631,THISTLE:3636451583,TOMATO:4284696575,TRANSPARENT:0,TURQUOISE:1088475391,VIOLET:4001558271,WHEAT:4125012991,WHITE:4294967295,WHITESMOKE:4126537215,YELLOW:4294902015,YELLOWGREEN:2597139199},aye={name:"background-clip",initialValue:"border-box",prefix:!1,type:1,parse:function(t,e){return e.map(function(r){if($s(r))switch(r.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},iye={name:"background-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},RN=function(t,e){var r=MA.parse(t,e[0]),s=e[1];return s&&pa(s)?{color:r,stop:s}:{color:r,stop:null}},PP=function(t,e){var r=t[0],s=t[t.length-1];r.stop===null&&(r.stop=ni),s.stop===null&&(s.stop=wA);for(var n=[],i=0,o=0;o<t.length;o++){var l=t[o].stop;if(l!==null){var c=tn(l,e);c>i?n.push(c):n.push(i),i=c}else n.push(null)}for(var d=null,o=0;o<n.length;o++){var u=n[o];if(u===null)d===null&&(d=o);else if(d!==null){for(var A=o-d,h=n[d-1],f=(u-h)/(A+1),p=1;p<=A;p++)n[d+p-1]=f*p;d=null}}return t.map(function(m,g){var y=m.color;return{color:y,stop:Math.max(Math.min(1,n[g]/e),0)}})},oye=function(t,e,r){var s=e/2,n=r/2,i=tn(t[0],e)-s,o=n-tn(t[1],r);return(Math.atan2(o,i)+Math.PI*2)%(Math.PI*2)},lye=function(t,e,r){var s=typeof t=="number"?t:oye(t,e,r),n=Math.abs(e*Math.sin(s))+Math.abs(r*Math.cos(s)),i=e/2,o=r/2,l=n/2,c=Math.sin(s-Math.PI/2)*l,d=Math.cos(s-Math.PI/2)*l;return[n,i-d,i+d,o-c,o+c]},Jl=function(t,e){return Math.sqrt(t*t+e*e)},DP=function(t,e,r,s,n){var i=[[0,0],[0,e],[t,0],[t,e]];return i.reduce(function(o,l){var c=l[0],d=l[1],u=Jl(r-c,s-d);return(n?u<o.optimumDistance:u>o.optimumDistance)?{optimumCorner:l,optimumDistance:u}:o},{optimumDistance:n?1/0:-1/0,optimumCorner:null}).optimumCorner},cye=function(t,e,r,s,n){var i=0,o=0;switch(t.size){case 0:t.shape===0?i=o=Math.min(Math.abs(e),Math.abs(e-s),Math.abs(r),Math.abs(r-n)):t.shape===1&&(i=Math.min(Math.abs(e),Math.abs(e-s)),o=Math.min(Math.abs(r),Math.abs(r-n)));break;case 2:if(t.shape===0)i=o=Math.min(Jl(e,r),Jl(e,r-n),Jl(e-s,r),Jl(e-s,r-n));else if(t.shape===1){var l=Math.min(Math.abs(r),Math.abs(r-n))/Math.min(Math.abs(e),Math.abs(e-s)),c=DP(s,n,e,r,!0),d=c[0],u=c[1];i=Jl(d-e,(u-r)/l),o=l*i}break;case 1:t.shape===0?i=o=Math.max(Math.abs(e),Math.abs(e-s),Math.abs(r),Math.abs(r-n)):t.shape===1&&(i=Math.max(Math.abs(e),Math.abs(e-s)),o=Math.max(Math.abs(r),Math.abs(r-n)));break;case 3:if(t.shape===0)i=o=Math.max(Jl(e,r),Jl(e,r-n),Jl(e-s,r),Jl(e-s,r-n));else if(t.shape===1){var l=Math.max(Math.abs(r),Math.abs(r-n))/Math.max(Math.abs(e),Math.abs(e-s)),A=DP(s,n,e,r,!1),d=A[0],u=A[1];i=Jl(d-e,(u-r)/l),o=l*i}break}return Array.isArray(t.size)&&(i=tn(t.size[0],s),o=t.size.length===2?tn(t.size[1],n):i),[i,o]},dye=function(t,e){var r=_l(180),s=[];return cd(e).forEach(function(n,i){if(i===0){var o=n[0];if(o.type===20&&o.value==="to"){r=AV(n);return}else if(uV(o)){r=DN.parse(t,o);return}}var l=RN(t,n);s.push(l)}),{angle:r,stops:s,type:1}},G1=function(t,e){var r=_l(180),s=[];return cd(e).forEach(function(n,i){if(i===0){var o=n[0];if(o.type===20&&["top","left","right","bottom"].indexOf(o.value)!==-1){r=AV(n);return}else if(uV(o)){r=(DN.parse(t,o)+_l(270))%_l(360);return}}var l=RN(t,n);s.push(l)}),{angle:r,stops:s,type:1}},uye=function(t,e){var r=_l(180),s=[],n=1,i=0,o=3,l=[];return cd(e).forEach(function(c,d){var u=c[0];if(d===0){if($s(u)&&u.value==="linear"){n=1;return}else if($s(u)&&u.value==="radial"){n=2;return}}if(u.type===18){if(u.name==="from"){var A=MA.parse(t,u.values[0]);s.push({stop:ni,color:A})}else if(u.name==="to"){var A=MA.parse(t,u.values[0]);s.push({stop:wA,color:A})}else if(u.name==="color-stop"){var h=u.values.filter(Np);if(h.length===2){var A=MA.parse(t,h[1]),f=h[0];Qp(f)&&s.push({stop:{type:16,number:f.number*100,flags:f.flags},color:A})}}}}),n===1?{angle:(r+_l(180))%_l(360),stops:s,type:n}:{size:o,shape:i,stops:s,position:l,type:n}},hV="closest-side",fV="farthest-side",mV="closest-corner",pV="farthest-corner",gV="circle",xV="ellipse",yV="cover",vV="contain",Aye=function(t,e){var r=0,s=3,n=[],i=[];return cd(e).forEach(function(o,l){var c=!0;if(l===0){var d=!1;c=o.reduce(function(A,h){if(d)if($s(h))switch(h.value){case"center":return i.push(oT),A;case"top":case"left":return i.push(ni),A;case"right":case"bottom":return i.push(wA),A}else(pa(h)||nh(h))&&i.push(h);else if($s(h))switch(h.value){case gV:return r=0,!1;case xV:return r=1,!1;case"at":return d=!0,!1;case hV:return s=0,!1;case yV:case fV:return s=1,!1;case vV:case mV:return s=2,!1;case pV:return s=3,!1}else if(nh(h)||pa(h))return Array.isArray(s)||(s=[]),s.push(h),!1;return A},c)}if(c){var u=RN(t,o);n.push(u)}}),{size:s,shape:r,stops:n,position:i,type:2}},Y1=function(t,e){var r=0,s=3,n=[],i=[];return cd(e).forEach(function(o,l){var c=!0;if(l===0?c=o.reduce(function(u,A){if($s(A))switch(A.value){case"center":return i.push(oT),!1;case"top":case"left":return i.push(ni),!1;case"right":case"bottom":return i.push(wA),!1}else if(pa(A)||nh(A))return i.push(A),!1;return u},c):l===1&&(c=o.reduce(function(u,A){if($s(A))switch(A.value){case gV:return r=0,!1;case xV:return r=1,!1;case vV:case hV:return s=0,!1;case fV:return s=1,!1;case mV:return s=2,!1;case yV:case pV:return s=3,!1}else if(nh(A)||pa(A))return Array.isArray(s)||(s=[]),s.push(A),!1;return u},c)),c){var d=RN(t,o);n.push(d)}}),{size:s,shape:r,stops:n,position:i,type:2}},hye=function(t){return t.type===1},fye=function(t){return t.type===2},lT={name:"image",parse:function(t,e){if(e.type===22){var r={url:e.value,type:0};return t.cache.addImage(e.value),r}if(e.type===18){var s=bV[e.name];if(typeof s>"u")throw new Error('Attempting to parse an unsupported image function "'+e.name+'"');return s(t,e.values)}throw new Error("Unsupported image type "+e.type)}};function mye(t){return!(t.type===20&&t.value==="none")&&(t.type!==18||!!bV[t.name])}var bV={"linear-gradient":dye,"-moz-linear-gradient":G1,"-ms-linear-gradient":G1,"-o-linear-gradient":G1,"-webkit-linear-gradient":G1,"radial-gradient":Aye,"-moz-radial-gradient":Y1,"-ms-radial-gradient":Y1,"-o-radial-gradient":Y1,"-webkit-radial-gradient":Y1,"-webkit-gradient":uye},pye={name:"background-image",initialValue:"none",type:1,prefix:!1,parse:function(t,e){if(e.length===0)return[];var r=e[0];return r.type===20&&r.value==="none"?[]:e.filter(function(s){return Np(s)&&mye(s)}).map(function(s){return lT.parse(t,s)})}},gye={name:"background-origin",initialValue:"border-box",prefix:!1,type:1,parse:function(t,e){return e.map(function(r){if($s(r))switch(r.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},xye={name:"background-position",initialValue:"0% 0%",type:1,prefix:!1,parse:function(t,e){return cd(e).map(function(r){return r.filter(pa)}).map(iV)}},yye={name:"background-repeat",initialValue:"repeat",prefix:!1,type:1,parse:function(t,e){return cd(e).map(function(r){return r.filter($s).map(function(s){return s.value}).join(" ")}).map(vye)}},vye=function(t){switch(t){case"no-repeat":return 1;case"repeat-x":case"repeat no-repeat":return 2;case"repeat-y":case"no-repeat repeat":return 3;case"repeat":default:return 0}},q0;(function(t){t.AUTO="auto",t.CONTAIN="contain",t.COVER="cover"})(q0||(q0={}));var bye={name:"background-size",initialValue:"0",prefix:!1,type:1,parse:function(t,e){return cd(e).map(function(r){return r.filter(wye)})}},wye=function(t){return $s(t)||pa(t)},LN=function(t){return{name:"border-"+t+"-color",initialValue:"transparent",prefix:!1,type:3,format:"color"}},Nye=LN("top"),Cye=LN("right"),jye=LN("bottom"),Sye=LN("left"),ON=function(t){return{name:"border-radius-"+t,initialValue:"0 0",prefix:!1,type:1,parse:function(e,r){return iV(r.filter(pa))}}},Eye=ON("top-left"),_ye=ON("top-right"),Tye=ON("bottom-right"),Iye=ON("bottom-left"),UN=function(t){return{name:"border-"+t+"-style",initialValue:"solid",prefix:!1,type:2,parse:function(e,r){switch(r){case"none":return 0;case"dashed":return 2;case"dotted":return 3;case"double":return 4}return 1}}},kye=UN("top"),Bye=UN("right"),Fye=UN("bottom"),Pye=UN("left"),MN=function(t){return{name:"border-"+t+"-width",initialValue:"0",type:0,prefix:!1,parse:function(e,r){return hv(r)?r.number:0}}},Dye=MN("top"),Rye=MN("right"),Lye=MN("bottom"),Oye=MN("left"),Uye={name:"color",initialValue:"transparent",prefix:!1,type:3,format:"color"},Mye={name:"direction",initialValue:"ltr",prefix:!1,type:2,parse:function(t,e){switch(e){case"rtl":return 1;case"ltr":default:return 0}}},Qye={name:"display",initialValue:"inline-block",prefix:!1,type:1,parse:function(t,e){return e.filter($s).reduce(function(r,s){return r|Vye(s.value)},0)}},Vye=function(t){switch(t){case"block":case"-webkit-box":return 2;case"inline":return 4;case"run-in":return 8;case"flow":return 16;case"flow-root":return 32;case"table":return 64;case"flex":case"-webkit-flex":return 128;case"grid":case"-ms-grid":return 256;case"ruby":return 512;case"subgrid":return 1024;case"list-item":return 2048;case"table-row-group":return 4096;case"table-header-group":return 8192;case"table-footer-group":return 16384;case"table-row":return 32768;case"table-cell":return 65536;case"table-column-group":return 131072;case"table-column":return 262144;case"table-caption":return 524288;case"ruby-base":return 1048576;case"ruby-text":return 2097152;case"ruby-base-container":return 4194304;case"ruby-text-container":return 8388608;case"contents":return 16777216;case"inline-block":return 33554432;case"inline-list-item":return 67108864;case"inline-table":return 134217728;case"inline-flex":return 268435456;case"inline-grid":return 536870912}return 0},Hye={name:"float",initialValue:"none",prefix:!1,type:2,parse:function(t,e){switch(e){case"left":return 1;case"right":return 2;case"inline-start":return 3;case"inline-end":return 4}return 0}},$ye={name:"letter-spacing",initialValue:"0",prefix:!1,type:0,parse:function(t,e){return e.type===20&&e.value==="normal"?0:e.type===17||e.type===15?e.number:0}},f2;(function(t){t.NORMAL="normal",t.STRICT="strict"})(f2||(f2={}));var Kye={name:"line-break",initialValue:"normal",prefix:!1,type:2,parse:function(t,e){switch(e){case"strict":return f2.STRICT;case"normal":default:return f2.NORMAL}}},zye={name:"line-height",initialValue:"normal",prefix:!1,type:4},RP=function(t,e){return $s(t)&&t.value==="normal"?1.2*e:t.type===17?e*t.number:pa(t)?tn(t,e):e},qye={name:"list-style-image",initialValue:"none",type:0,prefix:!1,parse:function(t,e){return e.type===20&&e.value==="none"?null:lT.parse(t,e)}},Wye={name:"list-style-position",initialValue:"outside",prefix:!1,type:2,parse:function(t,e){switch(e){case"inside":return 0;case"outside":default:return 1}}},PS={name:"list-style-type",initialValue:"none",prefix:!1,type:2,parse:function(t,e){switch(e){case"disc":return 0;case"circle":return 1;case"square":return 2;case"decimal":return 3;case"cjk-decimal":return 4;case"decimal-leading-zero":return 5;case"lower-roman":return 6;case"upper-roman":return 7;case"lower-greek":return 8;case"lower-alpha":return 9;case"upper-alpha":return 10;case"arabic-indic":return 11;case"armenian":return 12;case"bengali":return 13;case"cambodian":return 14;case"cjk-earthly-branch":return 15;case"cjk-heavenly-stem":return 16;case"cjk-ideographic":return 17;case"devanagari":return 18;case"ethiopic-numeric":return 19;case"georgian":return 20;case"gujarati":return 21;case"gurmukhi":return 22;case"hebrew":return 22;case"hiragana":return 23;case"hiragana-iroha":return 24;case"japanese-formal":return 25;case"japanese-informal":return 26;case"kannada":return 27;case"katakana":return 28;case"katakana-iroha":return 29;case"khmer":return 30;case"korean-hangul-formal":return 31;case"korean-hanja-formal":return 32;case"korean-hanja-informal":return 33;case"lao":return 34;case"lower-armenian":return 35;case"malayalam":return 36;case"mongolian":return 37;case"myanmar":return 38;case"oriya":return 39;case"persian":return 40;case"simp-chinese-formal":return 41;case"simp-chinese-informal":return 42;case"tamil":return 43;case"telugu":return 44;case"thai":return 45;case"tibetan":return 46;case"trad-chinese-formal":return 47;case"trad-chinese-informal":return 48;case"upper-armenian":return 49;case"disclosure-open":return 50;case"disclosure-closed":return 51;case"none":default:return-1}}},QN=function(t){return{name:"margin-"+t,initialValue:"0",prefix:!1,type:4}},Gye=QN("top"),Yye=QN("right"),Xye=QN("bottom"),Jye=QN("left"),Zye={name:"overflow",initialValue:"visible",prefix:!1,type:1,parse:function(t,e){return e.filter($s).map(function(r){switch(r.value){case"hidden":return 1;case"scroll":return 2;case"clip":return 3;case"auto":return 4;case"visible":default:return 0}})}},eve={name:"overflow-wrap",initialValue:"normal",prefix:!1,type:2,parse:function(t,e){switch(e){case"break-word":return"break-word";case"normal":default:return"normal"}}},VN=function(t){return{name:"padding-"+t,initialValue:"0",prefix:!1,type:3,format:"length-percentage"}},tve=VN("top"),rve=VN("right"),sve=VN("bottom"),nve=VN("left"),ave={name:"text-align",initialValue:"left",prefix:!1,type:2,parse:function(t,e){switch(e){case"right":return 2;case"center":case"justify":return 1;case"left":default:return 0}}},ive={name:"position",initialValue:"static",prefix:!1,type:2,parse:function(t,e){switch(e){case"relative":return 1;case"absolute":return 2;case"fixed":return 3;case"sticky":return 4}return 0}},ove={name:"text-shadow",initialValue:"none",type:1,prefix:!1,parse:function(t,e){return e.length===1&&FS(e[0],"none")?[]:cd(e).map(function(r){for(var s={color:Gd.TRANSPARENT,offsetX:ni,offsetY:ni,blur:ni},n=0,i=0;i<r.length;i++){var o=r[i];nh(o)?(n===0?s.offsetX=o:n===1?s.offsetY=o:s.blur=o,n++):s.color=MA.parse(t,o)}return s})}},lve={name:"text-transform",initialValue:"none",prefix:!1,type:2,parse:function(t,e){switch(e){case"uppercase":return 2;case"lowercase":return 1;case"capitalize":return 3}return 0}},cve={name:"transform",initialValue:"none",prefix:!0,type:0,parse:function(t,e){if(e.type===20&&e.value==="none")return null;if(e.type===18){var r=Ave[e.name];if(typeof r>"u")throw new Error('Attempting to parse an unsupported transform function "'+e.name+'"');return r(e.values)}return null}},dve=function(t){var e=t.filter(function(r){return r.type===17}).map(function(r){return r.number});return e.length===6?e:null},uve=function(t){var e=t.filter(function(c){return c.type===17}).map(function(c){return c.number}),r=e[0],s=e[1];e[2],e[3];var n=e[4],i=e[5];e[6],e[7],e[8],e[9],e[10],e[11];var o=e[12],l=e[13];return e[14],e[15],e.length===16?[r,s,n,i,o,l]:null},Ave={matrix:dve,matrix3d:uve},LP={type:16,number:50,flags:Av},hve=[LP,LP],fve={name:"transform-origin",initialValue:"50% 50%",prefix:!0,type:1,parse:function(t,e){var r=e.filter(pa);return r.length!==2?hve:[r[0],r[1]]}},mve={name:"visible",initialValue:"none",prefix:!1,type:2,parse:function(t,e){switch(e){case"hidden":return 1;case"collapse":return 2;case"visible":default:return 0}}},Tx;(function(t){t.NORMAL="normal",t.BREAK_ALL="break-all",t.KEEP_ALL="keep-all"})(Tx||(Tx={}));var pve={name:"word-break",initialValue:"normal",prefix:!1,type:2,parse:function(t,e){switch(e){case"break-all":return Tx.BREAK_ALL;case"keep-all":return Tx.KEEP_ALL;case"normal":default:return Tx.NORMAL}}},gve={name:"z-index",initialValue:"auto",prefix:!1,type:0,parse:function(t,e){if(e.type===20)return{auto:!0,order:0};if(Qp(e))return{auto:!1,order:e.number};throw new Error("Invalid z-index number parsed")}},wV={name:"time",parse:function(t,e){if(e.type===15)switch(e.unit.toLowerCase()){case"s":return 1e3*e.number;case"ms":return e.number}throw new Error("Unsupported time type")}},xve={name:"opacity",initialValue:"1",type:0,prefix:!1,parse:function(t,e){return Qp(e)?e.number:1}},yve={name:"text-decoration-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},vve={name:"text-decoration-line",initialValue:"none",prefix:!1,type:1,parse:function(t,e){return e.filter($s).map(function(r){switch(r.value){case"underline":return 1;case"overline":return 2;case"line-through":return 3;case"none":return 4}return 0}).filter(function(r){return r!==0})}},bve={name:"font-family",initialValue:"",prefix:!1,type:1,parse:function(t,e){var r=[],s=[];return e.forEach(function(n){switch(n.type){case 20:case 0:r.push(n.value);break;case 17:r.push(n.number.toString());break;case 4:s.push(r.join(" ")),r.length=0;break}}),r.length&&s.push(r.join(" ")),s.map(function(n){return n.indexOf(" ")===-1?n:"'"+n+"'"})}},wve={name:"font-size",initialValue:"0",prefix:!1,type:3,format:"length"},Nve={name:"font-weight",initialValue:"normal",type:0,prefix:!1,parse:function(t,e){if(Qp(e))return e.number;if($s(e))switch(e.value){case"bold":return 700;case"normal":default:return 400}return 400}},Cve={name:"font-variant",initialValue:"none",type:1,prefix:!1,parse:function(t,e){return e.filter($s).map(function(r){return r.value})}},jve={name:"font-style",initialValue:"normal",prefix:!1,type:2,parse:function(t,e){switch(e){case"oblique":return"oblique";case"italic":return"italic";case"normal":default:return"normal"}}},wa=function(t,e){return(t&e)!==0},Sve={name:"content",initialValue:"none",type:1,prefix:!1,parse:function(t,e){if(e.length===0)return[];var r=e[0];return r.type===20&&r.value==="none"?[]:e}},Eve={name:"counter-increment",initialValue:"none",prefix:!0,type:1,parse:function(t,e){if(e.length===0)return null;var r=e[0];if(r.type===20&&r.value==="none")return null;for(var s=[],n=e.filter(aV),i=0;i<n.length;i++){var o=n[i],l=n[i+1];if(o.type===20){var c=l&&Qp(l)?l.number:1;s.push({counter:o.value,increment:c})}}return s}},_ve={name:"counter-reset",initialValue:"none",prefix:!0,type:1,parse:function(t,e){if(e.length===0)return[];for(var r=[],s=e.filter(aV),n=0;n<s.length;n++){var i=s[n],o=s[n+1];if($s(i)&&i.value!=="none"){var l=o&&Qp(o)?o.number:0;r.push({counter:i.value,reset:l})}}return r}},Tve={name:"duration",initialValue:"0s",prefix:!1,type:1,parse:function(t,e){return e.filter(hv).map(function(r){return wV.parse(t,r)})}},Ive={name:"quotes",initialValue:"none",prefix:!0,type:1,parse:function(t,e){if(e.length===0)return null;var r=e[0];if(r.type===20&&r.value==="none")return null;var s=[],n=e.filter(rye);if(n.length%2!==0)return null;for(var i=0;i<n.length;i+=2){var o=n[i].value,l=n[i+1].value;s.push({open:o,close:l})}return s}},OP=function(t,e,r){if(!t)return"";var s=t[Math.min(e,t.length-1)];return s?r?s.open:s.close:""},kve={name:"box-shadow",initialValue:"none",type:1,prefix:!1,parse:function(t,e){return e.length===1&&FS(e[0],"none")?[]:cd(e).map(function(r){for(var s={color:255,offsetX:ni,offsetY:ni,blur:ni,spread:ni,inset:!1},n=0,i=0;i<r.length;i++){var o=r[i];FS(o,"inset")?s.inset=!0:nh(o)?(n===0?s.offsetX=o:n===1?s.offsetY=o:n===2?s.blur=o:s.spread=o,n++):s.color=MA.parse(t,o)}return s})}},Bve={name:"paint-order",initialValue:"normal",prefix:!1,type:1,parse:function(t,e){var r=[0,1,2],s=[];return e.filter($s).forEach(function(n){switch(n.value){case"stroke":s.push(1);break;case"fill":s.push(0);break;case"markers":s.push(2);break}}),r.forEach(function(n){s.indexOf(n)===-1&&s.push(n)}),s}},Fve={name:"-webkit-text-stroke-color",initialValue:"currentcolor",prefix:!1,type:3,format:"color"},Pve={name:"-webkit-text-stroke-width",initialValue:"0",type:0,prefix:!1,parse:function(t,e){return hv(e)?e.number:0}},Dve=function(){function t(e,r){var s,n;this.animationDuration=dr(e,Tve,r.animationDuration),this.backgroundClip=dr(e,aye,r.backgroundClip),this.backgroundColor=dr(e,iye,r.backgroundColor),this.backgroundImage=dr(e,pye,r.backgroundImage),this.backgroundOrigin=dr(e,gye,r.backgroundOrigin),this.backgroundPosition=dr(e,xye,r.backgroundPosition),this.backgroundRepeat=dr(e,yye,r.backgroundRepeat),this.backgroundSize=dr(e,bye,r.backgroundSize),this.borderTopColor=dr(e,Nye,r.borderTopColor),this.borderRightColor=dr(e,Cye,r.borderRightColor),this.borderBottomColor=dr(e,jye,r.borderBottomColor),this.borderLeftColor=dr(e,Sye,r.borderLeftColor),this.borderTopLeftRadius=dr(e,Eye,r.borderTopLeftRadius),this.borderTopRightRadius=dr(e,_ye,r.borderTopRightRadius),this.borderBottomRightRadius=dr(e,Tye,r.borderBottomRightRadius),this.borderBottomLeftRadius=dr(e,Iye,r.borderBottomLeftRadius),this.borderTopStyle=dr(e,kye,r.borderTopStyle),this.borderRightStyle=dr(e,Bye,r.borderRightStyle),this.borderBottomStyle=dr(e,Fye,r.borderBottomStyle),this.borderLeftStyle=dr(e,Pye,r.borderLeftStyle),this.borderTopWidth=dr(e,Dye,r.borderTopWidth),this.borderRightWidth=dr(e,Rye,r.borderRightWidth),this.borderBottomWidth=dr(e,Lye,r.borderBottomWidth),this.borderLeftWidth=dr(e,Oye,r.borderLeftWidth),this.boxShadow=dr(e,kve,r.boxShadow),this.color=dr(e,Uye,r.color),this.direction=dr(e,Mye,r.direction),this.display=dr(e,Qye,r.display),this.float=dr(e,Hye,r.cssFloat),this.fontFamily=dr(e,bve,r.fontFamily),this.fontSize=dr(e,wve,r.fontSize),this.fontStyle=dr(e,jve,r.fontStyle),this.fontVariant=dr(e,Cve,r.fontVariant),this.fontWeight=dr(e,Nve,r.fontWeight),this.letterSpacing=dr(e,$ye,r.letterSpacing),this.lineBreak=dr(e,Kye,r.lineBreak),this.lineHeight=dr(e,zye,r.lineHeight),this.listStyleImage=dr(e,qye,r.listStyleImage),this.listStylePosition=dr(e,Wye,r.listStylePosition),this.listStyleType=dr(e,PS,r.listStyleType),this.marginTop=dr(e,Gye,r.marginTop),this.marginRight=dr(e,Yye,r.marginRight),this.marginBottom=dr(e,Xye,r.marginBottom),this.marginLeft=dr(e,Jye,r.marginLeft),this.opacity=dr(e,xve,r.opacity);var i=dr(e,Zye,r.overflow);this.overflowX=i[0],this.overflowY=i[i.length>1?1:0],this.overflowWrap=dr(e,eve,r.overflowWrap),this.paddingTop=dr(e,tve,r.paddingTop),this.paddingRight=dr(e,rve,r.paddingRight),this.paddingBottom=dr(e,sve,r.paddingBottom),this.paddingLeft=dr(e,nve,r.paddingLeft),this.paintOrder=dr(e,Bve,r.paintOrder),this.position=dr(e,ive,r.position),this.textAlign=dr(e,ave,r.textAlign),this.textDecorationColor=dr(e,yve,(s=r.textDecorationColor)!==null&&s!==void 0?s:r.color),this.textDecorationLine=dr(e,vve,(n=r.textDecorationLine)!==null&&n!==void 0?n:r.textDecoration),this.textShadow=dr(e,ove,r.textShadow),this.textTransform=dr(e,lve,r.textTransform),this.transform=dr(e,cve,r.transform),this.transformOrigin=dr(e,fve,r.transformOrigin),this.visibility=dr(e,mve,r.visibility),this.webkitTextStrokeColor=dr(e,Fve,r.webkitTextStrokeColor),this.webkitTextStrokeWidth=dr(e,Pve,r.webkitTextStrokeWidth),this.wordBreak=dr(e,pve,r.wordBreak),this.zIndex=dr(e,gve,r.zIndex)}return t.prototype.isVisible=function(){return this.display>0&&this.opacity>0&&this.visibility===0},t.prototype.isTransparent=function(){return QA(this.backgroundColor)},t.prototype.isTransformed=function(){return this.transform!==null},t.prototype.isPositioned=function(){return this.position!==0},t.prototype.isPositionedWithZIndex=function(){return this.isPositioned()&&!this.zIndex.auto},t.prototype.isFloating=function(){return this.float!==0},t.prototype.isInlineLevel=function(){return wa(this.display,4)||wa(this.display,33554432)||wa(this.display,268435456)||wa(this.display,536870912)||wa(this.display,67108864)||wa(this.display,134217728)},t}(),Rve=function(){function t(e,r){this.content=dr(e,Sve,r.content),this.quotes=dr(e,Ive,r.quotes)}return t}(),UP=function(){function t(e,r){this.counterIncrement=dr(e,Eve,r.counterIncrement),this.counterReset=dr(e,_ve,r.counterReset)}return t}(),dr=function(t,e,r){var s=new sV,n=r!==null&&typeof r<"u"?r.toString():e.initialValue;s.write(n);var i=new nV(s.read());switch(e.type){case 2:var o=i.parseComponentValue();return e.parse(t,$s(o)?o.value:e.initialValue);case 0:return e.parse(t,i.parseComponentValue());case 1:return e.parse(t,i.parseComponentValues());case 4:return i.parseComponentValue();case 3:switch(e.format){case"angle":return DN.parse(t,i.parseComponentValue());case"color":return MA.parse(t,i.parseComponentValue());case"image":return lT.parse(t,i.parseComponentValue());case"length":var l=i.parseComponentValue();return nh(l)?l:ni;case"length-percentage":var c=i.parseComponentValue();return pa(c)?c:ni;case"time":return wV.parse(t,i.parseComponentValue())}break}},Lve="data-html2canvas-debug",Ove=function(t){var e=t.getAttribute(Lve);switch(e){case"all":return 1;case"clone":return 2;case"parse":return 3;case"render":return 4;default:return 0}},DS=function(t,e){var r=Ove(t);return r===1||e===r},dd=function(){function t(e,r){if(this.context=e,this.textNodes=[],this.elements=[],this.flags=0,DS(r,3))debugger;this.styles=new Dve(e,window.getComputedStyle(r,null)),OS(r)&&(this.styles.animationDuration.some(function(s){return s>0})&&(r.style.animationDuration="0s"),this.styles.transform!==null&&(r.style.transform="none")),this.bounds=FN(this.context,r),DS(r,4)&&(this.flags|=16)}return t}(),Uve="AAAAAAAAAAAAEA4AGBkAAFAaAAACAAAAAAAIABAAGAAwADgACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAAQABIAEQATAAIABAACAAQAAgAEAAIABAAVABcAAgAEAAIABAACAAQAGAAaABwAHgAgACIAI4AlgAIABAAmwCjAKgAsAC2AL4AvQDFAMoA0gBPAVYBWgEIAAgACACMANoAYgFkAWwBdAF8AX0BhQGNAZUBlgGeAaMBlQGWAasBswF8AbsBwwF0AcsBYwHTAQgA2wG/AOMBdAF8AekB8QF0AfkB+wHiAHQBfAEIAAMC5gQIAAsCEgIIAAgAFgIeAggAIgIpAggAMQI5AkACygEIAAgASAJQAlgCYAIIAAgACAAKBQoFCgUTBRMFGQUrBSsFCAAIAAgACAAIAAgACAAIAAgACABdAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABoAmgCrwGvAQgAbgJ2AggAHgEIAAgACADnAXsCCAAIAAgAgwIIAAgACAAIAAgACACKAggAkQKZAggAPADJAAgAoQKkAqwCsgK6AsICCADJAggA0AIIAAgACAAIANYC3gIIAAgACAAIAAgACABAAOYCCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAkASoB+QIEAAgACAA8AEMCCABCBQgACABJBVAFCAAIAAgACAAIAAgACAAIAAgACABTBVoFCAAIAFoFCABfBWUFCAAIAAgACAAIAAgAbQUIAAgACAAIAAgACABzBXsFfQWFBYoFigWKBZEFigWKBYoFmAWfBaYFrgWxBbkFCAAIAAgACAAIAAgACAAIAAgACAAIAMEFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAMgFCADQBQgACAAIAAgACAAIAAgACAAIAAgACAAIAO4CCAAIAAgAiQAIAAgACABAAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAD0AggACAD8AggACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIANYFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAMDvwAIAAgAJAIIAAgACAAIAAgACAAIAAgACwMTAwgACAB9BOsEGwMjAwgAKwMyAwsFYgE3A/MEPwMIAEUDTQNRAwgAWQOsAGEDCAAIAAgACAAIAAgACABpAzQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFIQUoBSwFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABtAwgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABMAEwACAAIAAgACAAIABgACAAIAAgACAC/AAgACAAyAQgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACAAIAAwAAgACAAIAAgACAAIAAgACAAIAAAARABIAAgACAAIABQASAAIAAgAIABwAEAAjgCIABsAqAC2AL0AigDQAtwC+IJIQqVAZUBWQqVAZUBlQGVAZUBlQGrC5UBlQGVAZUBlQGVAZUBlQGVAXsKlQGVAbAK6wsrDGUMpQzlDJUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAfAKAAuZA64AtwCJALoC6ADwAAgAuACgA/oEpgO6AqsD+AAIAAgAswMIAAgACAAIAIkAuwP5AfsBwwPLAwgACAAIAAgACADRA9kDCAAIAOED6QMIAAgACAAIAAgACADuA/YDCAAIAP4DyQAIAAgABgQIAAgAXQAOBAgACAAIAAgACAAIABMECAAIAAgACAAIAAgACAD8AAQBCAAIAAgAGgQiBCoECAExBAgAEAEIAAgACAAIAAgACAAIAAgACAAIAAgACAA4BAgACABABEYECAAIAAgATAQYAQgAVAQIAAgACAAIAAgACAAIAAgACAAIAFoECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAOQEIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAB+BAcACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAEABhgSMBAgACAAIAAgAlAQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAwAEAAQABAADAAMAAwADAAQABAAEAAQABAAEAAQABHATAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAdQMIAAgACAAIAAgACAAIAMkACAAIAAgAfQMIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACFA4kDCAAIAAgACAAIAOcBCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAIcDCAAIAAgACAAIAAgACAAIAAgACAAIAJEDCAAIAAgACADFAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABgBAgAZgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAbAQCBXIECAAIAHkECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABAAJwEQACjBKoEsgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAC6BMIECAAIAAgACAAIAAgACABmBAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAxwQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAGYECAAIAAgAzgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBd0FXwUIAOIF6gXxBYoF3gT5BQAGCAaKBYoFigWKBYoFigWKBYoFigWKBYoFigXWBIoFigWKBYoFigWKBYoFigWKBYsFEAaKBYoFigWKBYoFigWKBRQGCACKBYoFigWKBQgACAAIANEECAAIABgGigUgBggAJgYIAC4GMwaKBYoF0wQ3Bj4GigWKBYoFigWKBYoFigWKBYoFigWKBYoFigUIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWLBf///////wQABAAEAAQABAAEAAQABAAEAAQAAwAEAAQAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAQADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUAAAAFAAUAAAAFAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAQAAAAUABQAFAAUABQAFAAAAAAAFAAUAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAFAAUAAQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAAABwAHAAcAAAAHAAcABwAFAAEAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAcABwAFAAUAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQABAAAAAAAAAAAAAAAFAAUABQAFAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAHAAcAAAAHAAcAAAAAAAUABQAHAAUAAQAHAAEABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwABAAUABQAFAAUAAAAAAAAAAAAAAAEAAQABAAEAAQABAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABQANAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAABQAHAAUABQAFAAAAAAAAAAcABQAFAAUABQAFAAQABAAEAAQABAAEAAQABAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUAAAAFAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAUAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAcABwAFAAcABwAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUABwAHAAUABQAFAAUAAAAAAAcABwAAAAAABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAAAAAAAAAAABQAFAAAAAAAFAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAFAAUABQAFAAUAAAAFAAUABwAAAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABwAFAAUABQAFAAAAAAAHAAcAAAAAAAcABwAFAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAAAAAAAAAHAAcABwAAAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAUABQAFAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAHAAcABQAHAAcAAAAFAAcABwAAAAcABwAFAAUAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAFAAcABwAFAAUABQAAAAUAAAAHAAcABwAHAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAHAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUAAAAFAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAUAAAAFAAUAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABwAFAAUABQAFAAUABQAAAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABQAFAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAFAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAHAAUABQAFAAUABQAFAAUABwAHAAcABwAHAAcABwAHAAUABwAHAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABwAHAAcABwAFAAUABwAHAAcAAAAAAAAAAAAHAAcABQAHAAcABwAHAAcABwAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAUABQAFAAUABQAFAAUAAAAFAAAABQAAAAAABQAFAAUABQAFAAUABQAFAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAUABQAFAAUABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABwAFAAcABwAHAAcABwAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAUABQAFAAUABwAHAAUABQAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABQAFAAcABwAHAAUABwAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAcABQAFAAUABQAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAAAAAABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAUABQAHAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAFAAUABQAFAAcABwAFAAUABwAHAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAcABwAFAAUABwAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABQAAAAAABQAFAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAcABwAAAAAAAAAAAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAcABwAFAAcABwAAAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAFAAUABQAAAAUABQAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABwAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAHAAcABQAHAAUABQAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAAABwAHAAAAAAAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAFAAUABwAFAAcABwAFAAcABQAFAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAAAAAABwAHAAcABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAFAAcABwAFAAUABQAFAAUABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAUABQAFAAcABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABQAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAAAAAAFAAUABwAHAAcABwAFAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAHAAUABQAFAAUABQAFAAUABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAABQAAAAUABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAHAAcAAAAFAAUAAAAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABQAFAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAABQAFAAUABQAFAAUABQAAAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAFAAUABQAFAAUADgAOAA4ADgAOAA4ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAMAAwADAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAAAAAAAAAAAAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAAAAAAAAAAAAsADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwACwAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAADgAOAA4AAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAAAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4AAAAOAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAAAAAAAAAAAA4AAAAOAAAAAAAAAAAADgAOAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAA=",MP="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",zg=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var X1=0;X1<MP.length;X1++)zg[MP.charCodeAt(X1)]=X1;var Mve=function(t){var e=t.length*.75,r=t.length,s,n=0,i,o,l,c;t[t.length-1]==="="&&(e--,t[t.length-2]==="="&&e--);var d=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(e):new Array(e),u=Array.isArray(d)?d:new Uint8Array(d);for(s=0;s<r;s+=4)i=zg[t.charCodeAt(s)],o=zg[t.charCodeAt(s+1)],l=zg[t.charCodeAt(s+2)],c=zg[t.charCodeAt(s+3)],u[n++]=i<<2|o>>4,u[n++]=(o&15)<<4|l>>2,u[n++]=(l&3)<<6|c&63;return d},Qve=function(t){for(var e=t.length,r=[],s=0;s<e;s+=2)r.push(t[s+1]<<8|t[s]);return r},Vve=function(t){for(var e=t.length,r=[],s=0;s<e;s+=4)r.push(t[s+3]<<24|t[s+2]<<16|t[s+1]<<8|t[s]);return r},vf=5,cT=11,UC=2,Hve=cT-vf,NV=65536>>vf,$ve=1<<vf,MC=$ve-1,Kve=1024>>vf,zve=NV+Kve,qve=zve,Wve=32,Gve=qve+Wve,Yve=65536>>cT,Xve=1<<Hve,Jve=Xve-1,QP=function(t,e,r){return t.slice?t.slice(e,r):new Uint16Array(Array.prototype.slice.call(t,e,r))},Zve=function(t,e,r){return t.slice?t.slice(e,r):new Uint32Array(Array.prototype.slice.call(t,e,r))},e1e=function(t,e){var r=Mve(t),s=Array.isArray(r)?Vve(r):new Uint32Array(r),n=Array.isArray(r)?Qve(r):new Uint16Array(r),i=24,o=QP(n,i/2,s[4]/2),l=s[5]===2?QP(n,(i+s[4])/2):Zve(s,Math.ceil((i+s[4])/4));return new t1e(s[0],s[1],s[2],s[3],o,l)},t1e=function(){function t(e,r,s,n,i,o){this.initialValue=e,this.errorValue=r,this.highStart=s,this.highValueIndex=n,this.index=i,this.data=o}return t.prototype.get=function(e){var r;if(e>=0){if(e<55296||e>56319&&e<=65535)return r=this.index[e>>vf],r=(r<<UC)+(e&MC),this.data[r];if(e<=65535)return r=this.index[NV+(e-55296>>vf)],r=(r<<UC)+(e&MC),this.data[r];if(e<this.highStart)return r=Gve-Yve+(e>>cT),r=this.index[r],r+=e>>vf&Jve,r=this.index[r],r=(r<<UC)+(e&MC),this.data[r];if(e<=1114111)return this.data[this.highValueIndex]}return this.errorValue},t}(),VP="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r1e=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var J1=0;J1<VP.length;J1++)r1e[VP.charCodeAt(J1)]=J1;var s1e=1,QC=2,VC=3,HP=4,$P=5,n1e=7,KP=8,HC=9,$C=10,zP=11,qP=12,WP=13,GP=14,KC=15,a1e=function(t){for(var e=[],r=0,s=t.length;r<s;){var n=t.charCodeAt(r++);if(n>=55296&&n<=56319&&r<s){var i=t.charCodeAt(r++);(i&64512)===56320?e.push(((n&1023)<<10)+(i&1023)+65536):(e.push(n),r--)}else e.push(n)}return e},i1e=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(String.fromCodePoint)return String.fromCodePoint.apply(String,t);var r=t.length;if(!r)return"";for(var s=[],n=-1,i="";++n<r;){var o=t[n];o<=65535?s.push(o):(o-=65536,s.push((o>>10)+55296,o%1024+56320)),(n+1===r||s.length>16384)&&(i+=String.fromCharCode.apply(String,s),s.length=0)}return i},o1e=e1e(Uve),xl="",zC="",l1e=function(t){return o1e.get(t)},c1e=function(t,e,r){var s=r-2,n=e[s],i=e[r-1],o=e[r];if(i===QC&&o===VC)return xl;if(i===QC||i===VC||i===HP||o===QC||o===VC||o===HP)return zC;if(i===KP&&[KP,HC,zP,qP].indexOf(o)!==-1||(i===zP||i===HC)&&(o===HC||o===$C)||(i===qP||i===$C)&&o===$C||o===WP||o===$P||o===n1e||i===s1e)return xl;if(i===WP&&o===GP){for(;n===$P;)n=e[--s];if(n===GP)return xl}if(i===KC&&o===KC){for(var l=0;n===KC;)l++,n=e[--s];if(l%2===0)return xl}return zC},d1e=function(t){var e=a1e(t),r=e.length,s=0,n=0,i=e.map(l1e);return{next:function(){if(s>=r)return{done:!0,value:null};for(var o=xl;s<r&&(o=c1e(e,i,++s))===xl;);if(o!==xl||s===r){var l=i1e.apply(null,e.slice(n,s));return n=s,{value:l,done:!1}}return{done:!0,value:null}}}},u1e=function(t){for(var e=d1e(t),r=[],s;!(s=e.next()).done;)s.value&&r.push(s.value.slice());return r},A1e=function(t){var e=123;if(t.createRange){var r=t.createRange();if(r.getBoundingClientRect){var s=t.createElement("boundtest");s.style.height=e+"px",s.style.display="block",t.body.appendChild(s),r.selectNode(s);var n=r.getBoundingClientRect(),i=Math.round(n.height);if(t.body.removeChild(s),i===e)return!0}}return!1},h1e=function(t){var e=t.createElement("boundtest");e.style.width="50px",e.style.display="block",e.style.fontSize="12px",e.style.letterSpacing="0px",e.style.wordSpacing="0px",t.body.appendChild(e);var r=t.createRange();e.innerHTML=typeof"".repeat=="function"?"&#128104;".repeat(10):"";var s=e.firstChild,n=PN(s.data).map(function(c){return zn(c)}),i=0,o={},l=n.every(function(c,d){r.setStart(s,i),r.setEnd(s,i+c.length);var u=r.getBoundingClientRect();i+=c.length;var A=u.x>o.x||u.y>o.y;return o=u,d===0?!0:A});return t.body.removeChild(e),l},f1e=function(){return typeof new Image().crossOrigin<"u"},m1e=function(){return typeof new XMLHttpRequest().responseType=="string"},p1e=function(t){var e=new Image,r=t.createElement("canvas"),s=r.getContext("2d");if(!s)return!1;e.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{s.drawImage(e,0,0),r.toDataURL()}catch{return!1}return!0},YP=function(t){return t[0]===0&&t[1]===255&&t[2]===0&&t[3]===255},g1e=function(t){var e=t.createElement("canvas"),r=100;e.width=r,e.height=r;var s=e.getContext("2d");if(!s)return Promise.reject(!1);s.fillStyle="rgb(0, 255, 0)",s.fillRect(0,0,r,r);var n=new Image,i=e.toDataURL();n.src=i;var o=RS(r,r,0,0,n);return s.fillStyle="red",s.fillRect(0,0,r,r),XP(o).then(function(l){s.drawImage(l,0,0);var c=s.getImageData(0,0,r,r).data;s.fillStyle="red",s.fillRect(0,0,r,r);var d=t.createElement("div");return d.style.backgroundImage="url("+i+")",d.style.height=r+"px",YP(c)?XP(RS(r,r,0,0,d)):Promise.reject(!1)}).then(function(l){return s.drawImage(l,0,0),YP(s.getImageData(0,0,r,r).data)}).catch(function(){return!1})},RS=function(t,e,r,s,n){var i="http://www.w3.org/2000/svg",o=document.createElementNS(i,"svg"),l=document.createElementNS(i,"foreignObject");return o.setAttributeNS(null,"width",t.toString()),o.setAttributeNS(null,"height",e.toString()),l.setAttributeNS(null,"width","100%"),l.setAttributeNS(null,"height","100%"),l.setAttributeNS(null,"x",r.toString()),l.setAttributeNS(null,"y",s.toString()),l.setAttributeNS(null,"externalResourcesRequired","true"),o.appendChild(l),l.appendChild(n),o},XP=function(t){return new Promise(function(e,r){var s=new Image;s.onload=function(){return e(s)},s.onerror=r,s.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(t))})},Za={get SUPPORT_RANGE_BOUNDS(){var t=A1e(document);return Object.defineProperty(Za,"SUPPORT_RANGE_BOUNDS",{value:t}),t},get SUPPORT_WORD_BREAKING(){var t=Za.SUPPORT_RANGE_BOUNDS&&h1e(document);return Object.defineProperty(Za,"SUPPORT_WORD_BREAKING",{value:t}),t},get SUPPORT_SVG_DRAWING(){var t=p1e(document);return Object.defineProperty(Za,"SUPPORT_SVG_DRAWING",{value:t}),t},get SUPPORT_FOREIGNOBJECT_DRAWING(){var t=typeof Array.from=="function"&&typeof window.fetch=="function"?g1e(document):Promise.resolve(!1);return Object.defineProperty(Za,"SUPPORT_FOREIGNOBJECT_DRAWING",{value:t}),t},get SUPPORT_CORS_IMAGES(){var t=f1e();return Object.defineProperty(Za,"SUPPORT_CORS_IMAGES",{value:t}),t},get SUPPORT_RESPONSE_TYPE(){var t=m1e();return Object.defineProperty(Za,"SUPPORT_RESPONSE_TYPE",{value:t}),t},get SUPPORT_CORS_XHR(){var t="withCredentials"in new XMLHttpRequest;return Object.defineProperty(Za,"SUPPORT_CORS_XHR",{value:t}),t},get SUPPORT_NATIVE_TEXT_SEGMENTATION(){var t=!!(typeof Intl<"u"&&Intl.Segmenter);return Object.defineProperty(Za,"SUPPORT_NATIVE_TEXT_SEGMENTATION",{value:t}),t}},Ix=function(){function t(e,r){this.text=e,this.bounds=r}return t}(),x1e=function(t,e,r,s){var n=b1e(e,r),i=[],o=0;return n.forEach(function(l){if(r.textDecorationLine.length||l.trim().length>0)if(Za.SUPPORT_RANGE_BOUNDS){var c=JP(s,o,l.length).getClientRects();if(c.length>1){var d=dT(l),u=0;d.forEach(function(h){i.push(new Ix(h,lu.fromDOMRectList(t,JP(s,u+o,h.length).getClientRects()))),u+=h.length})}else i.push(new Ix(l,lu.fromDOMRectList(t,c)))}else{var A=s.splitText(l.length);i.push(new Ix(l,y1e(t,s))),s=A}else Za.SUPPORT_RANGE_BOUNDS||(s=s.splitText(l.length));o+=l.length}),i},y1e=function(t,e){var r=e.ownerDocument;if(r){var s=r.createElement("html2canvaswrapper");s.appendChild(e.cloneNode(!0));var n=e.parentNode;if(n){n.replaceChild(s,e);var i=FN(t,s);return s.firstChild&&n.replaceChild(s.firstChild,s),i}}return lu.EMPTY},JP=function(t,e,r){var s=t.ownerDocument;if(!s)throw new Error("Node has no owner document");var n=s.createRange();return n.setStart(t,e),n.setEnd(t,e+r),n},dT=function(t){if(Za.SUPPORT_NATIVE_TEXT_SEGMENTATION){var e=new Intl.Segmenter(void 0,{granularity:"grapheme"});return Array.from(e.segment(t)).map(function(r){return r.segment})}return u1e(t)},v1e=function(t,e){if(Za.SUPPORT_NATIVE_TEXT_SEGMENTATION){var r=new Intl.Segmenter(void 0,{granularity:"word"});return Array.from(r.segment(t)).map(function(s){return s.segment})}return N1e(t,e)},b1e=function(t,e){return e.letterSpacing!==0?dT(t):v1e(t,e)},w1e=[32,160,4961,65792,65793,4153,4241],N1e=function(t,e){for(var r=Yge(t,{lineBreak:e.lineBreak,wordBreak:e.overflowWrap==="break-word"?"break-word":e.wordBreak}),s=[],n,i=function(){if(n.value){var o=n.value.slice(),l=PN(o),c="";l.forEach(function(d){w1e.indexOf(d)===-1?c+=zn(d):(c.length&&s.push(c),s.push(zn(d)),c="")}),c.length&&s.push(c)}};!(n=r.next()).done;)i();return s},C1e=function(){function t(e,r,s){this.text=j1e(r.data,s.textTransform),this.textBounds=x1e(e,this.text,s,r)}return t}(),j1e=function(t,e){switch(e){case 1:return t.toLowerCase();case 3:return t.replace(S1e,E1e);case 2:return t.toUpperCase();default:return t}},S1e=/(^|\s|:|-|\(|\))([a-z])/g,E1e=function(t,e,r){return t.length>0?e+r.toUpperCase():t},CV=function(t){vc(e,t);function e(r,s){var n=t.call(this,r,s)||this;return n.src=s.currentSrc||s.src,n.intrinsicWidth=s.naturalWidth,n.intrinsicHeight=s.naturalHeight,n.context.cache.addImage(n.src),n}return e}(dd),jV=function(t){vc(e,t);function e(r,s){var n=t.call(this,r,s)||this;return n.canvas=s,n.intrinsicWidth=s.width,n.intrinsicHeight=s.height,n}return e}(dd),SV=function(t){vc(e,t);function e(r,s){var n=t.call(this,r,s)||this,i=new XMLSerializer,o=FN(r,s);return s.setAttribute("width",o.width+"px"),s.setAttribute("height",o.height+"px"),n.svg="data:image/svg+xml,"+encodeURIComponent(i.serializeToString(s)),n.intrinsicWidth=s.width.baseVal.value,n.intrinsicHeight=s.height.baseVal.value,n.context.cache.addImage(n.svg),n}return e}(dd),EV=function(t){vc(e,t);function e(r,s){var n=t.call(this,r,s)||this;return n.value=s.value,n}return e}(dd),LS=function(t){vc(e,t);function e(r,s){var n=t.call(this,r,s)||this;return n.start=s.start,n.reversed=typeof s.reversed=="boolean"&&s.reversed===!0,n}return e}(dd),_1e=[{type:15,flags:0,unit:"px",number:3}],T1e=[{type:16,flags:0,number:50}],I1e=function(t){return t.width>t.height?new lu(t.left+(t.width-t.height)/2,t.top,t.height,t.height):t.width<t.height?new lu(t.left,t.top+(t.height-t.width)/2,t.width,t.width):t},k1e=function(t){var e=t.type===B1e?new Array(t.value.length+1).join(""):t.value;return e.length===0?t.placeholder||"":e},m2="checkbox",p2="radio",B1e="password",ZP=707406591,uT=function(t){vc(e,t);function e(r,s){var n=t.call(this,r,s)||this;switch(n.type=s.type.toLowerCase(),n.checked=s.checked,n.value=k1e(s),(n.type===m2||n.type===p2)&&(n.styles.backgroundColor=3739148031,n.styles.borderTopColor=n.styles.borderRightColor=n.styles.borderBottomColor=n.styles.borderLeftColor=2779096575,n.styles.borderTopWidth=n.styles.borderRightWidth=n.styles.borderBottomWidth=n.styles.borderLeftWidth=1,n.styles.borderTopStyle=n.styles.borderRightStyle=n.styles.borderBottomStyle=n.styles.borderLeftStyle=1,n.styles.backgroundClip=[0],n.styles.backgroundOrigin=[0],n.bounds=I1e(n.bounds)),n.type){case m2:n.styles.borderTopRightRadius=n.styles.borderTopLeftRadius=n.styles.borderBottomRightRadius=n.styles.borderBottomLeftRadius=_1e;break;case p2:n.styles.borderTopRightRadius=n.styles.borderTopLeftRadius=n.styles.borderBottomRightRadius=n.styles.borderBottomLeftRadius=T1e;break}return n}return e}(dd),_V=function(t){vc(e,t);function e(r,s){var n=t.call(this,r,s)||this,i=s.options[s.selectedIndex||0];return n.value=i&&i.text||"",n}return e}(dd),TV=function(t){vc(e,t);function e(r,s){var n=t.call(this,r,s)||this;return n.value=s.value,n}return e}(dd),IV=function(t){vc(e,t);function e(r,s){var n=t.call(this,r,s)||this;n.src=s.src,n.width=parseInt(s.width,10)||0,n.height=parseInt(s.height,10)||0,n.backgroundColor=n.styles.backgroundColor;try{if(s.contentWindow&&s.contentWindow.document&&s.contentWindow.document.documentElement){n.tree=BV(r,s.contentWindow.document.documentElement);var i=s.contentWindow.document.documentElement?_x(r,getComputedStyle(s.contentWindow.document.documentElement).backgroundColor):Gd.TRANSPARENT,o=s.contentWindow.document.body?_x(r,getComputedStyle(s.contentWindow.document.body).backgroundColor):Gd.TRANSPARENT;n.backgroundColor=QA(i)?QA(o)?n.styles.backgroundColor:o:i}}catch{}return n}return e}(dd),F1e=["OL","UL","MENU"],Qb=function(t,e,r,s){for(var n=e.firstChild,i=void 0;n;n=i)if(i=n.nextSibling,FV(n)&&n.data.trim().length>0)r.textNodes.push(new C1e(t,n,r.styles));else if(N0(n))if(LV(n)&&n.assignedNodes)n.assignedNodes().forEach(function(l){return Qb(t,l,r,s)});else{var o=kV(t,n);o.styles.isVisible()&&(P1e(n,o,s)?o.flags|=4:D1e(o.styles)&&(o.flags|=2),F1e.indexOf(n.tagName)!==-1&&(o.flags|=8),r.elements.push(o),n.slot,n.shadowRoot?Qb(t,n.shadowRoot,o,s):!g2(n)&&!PV(n)&&!x2(n)&&Qb(t,n,o,s))}},kV=function(t,e){return US(e)?new CV(t,e):DV(e)?new jV(t,e):PV(e)?new SV(t,e):R1e(e)?new EV(t,e):L1e(e)?new LS(t,e):O1e(e)?new uT(t,e):x2(e)?new _V(t,e):g2(e)?new TV(t,e):RV(e)?new IV(t,e):new dd(t,e)},BV=function(t,e){var r=kV(t,e);return r.flags|=4,Qb(t,e,r,r),r},P1e=function(t,e,r){return e.styles.isPositionedWithZIndex()||e.styles.opacity<1||e.styles.isTransformed()||AT(t)&&r.styles.isTransparent()},D1e=function(t){return t.isPositioned()||t.isFloating()},FV=function(t){return t.nodeType===Node.TEXT_NODE},N0=function(t){return t.nodeType===Node.ELEMENT_NODE},OS=function(t){return N0(t)&&typeof t.style<"u"&&!Vb(t)},Vb=function(t){return typeof t.className=="object"},R1e=function(t){return t.tagName==="LI"},L1e=function(t){return t.tagName==="OL"},O1e=function(t){return t.tagName==="INPUT"},U1e=function(t){return t.tagName==="HTML"},PV=function(t){return t.tagName==="svg"},AT=function(t){return t.tagName==="BODY"},DV=function(t){return t.tagName==="CANVAS"},eD=function(t){return t.tagName==="VIDEO"},US=function(t){return t.tagName==="IMG"},RV=function(t){return t.tagName==="IFRAME"},tD=function(t){return t.tagName==="STYLE"},M1e=function(t){return t.tagName==="SCRIPT"},g2=function(t){return t.tagName==="TEXTAREA"},x2=function(t){return t.tagName==="SELECT"},LV=function(t){return t.tagName==="SLOT"},rD=function(t){return t.tagName.indexOf("-")>0},Q1e=function(){function t(){this.counters={}}return t.prototype.getCounterValue=function(e){var r=this.counters[e];return r&&r.length?r[r.length-1]:1},t.prototype.getCounterValues=function(e){var r=this.counters[e];return r||[]},t.prototype.pop=function(e){var r=this;e.forEach(function(s){return r.counters[s].pop()})},t.prototype.parse=function(e){var r=this,s=e.counterIncrement,n=e.counterReset,i=!0;s!==null&&s.forEach(function(l){var c=r.counters[l.counter];c&&l.increment!==0&&(i=!1,c.length||c.push(1),c[Math.max(0,c.length-1)]+=l.increment)});var o=[];return i&&n.forEach(function(l){var c=r.counters[l.counter];o.push(l.counter),c||(c=r.counters[l.counter]=[]),c.push(l.reset)}),o},t}(),sD={integers:[1e3,900,500,400,100,90,50,40,10,9,5,4,1],values:["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"]},nD={integers:[9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},V1e={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},H1e={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},Hm=function(t,e,r,s,n,i){return t<e||t>r?Sy(t,n,i.length>0):s.integers.reduce(function(o,l,c){for(;t>=l;)t-=l,o+=s.values[c];return o},"")+i},OV=function(t,e,r,s){var n="";do r||t--,n=s(t)+n,t/=e;while(t*e>=e);return n},$n=function(t,e,r,s,n){var i=r-e+1;return(t<0?"-":"")+(OV(Math.abs(t),i,s,function(o){return zn(Math.floor(o%i)+e)})+n)},Rh=function(t,e,r){r===void 0&&(r=". ");var s=e.length;return OV(Math.abs(t),s,!1,function(n){return e[Math.floor(n%s)]})+r},s0=1,Xu=2,Ju=4,qg=8,kd=function(t,e,r,s,n,i){if(t<-9999||t>9999)return Sy(t,4,n.length>0);var o=Math.abs(t),l=n;if(o===0)return e[0]+l;for(var c=0;o>0&&c<=4;c++){var d=o%10;d===0&&wa(i,s0)&&l!==""?l=e[d]+l:d>1||d===1&&c===0||d===1&&c===1&&wa(i,Xu)||d===1&&c===1&&wa(i,Ju)&&t>100||d===1&&c>1&&wa(i,qg)?l=e[d]+(c>0?r[c-1]:"")+l:d===1&&c>0&&(l=r[c-1]+l),o=Math.floor(o/10)}return(t<0?s:"")+l},aD="",iD="",oD="",qC="",Sy=function(t,e,r){var s=r?". ":"",n=r?"":"",i=r?", ":"",o=r?" ":"";switch(e){case 0:return""+o;case 1:return""+o;case 2:return""+o;case 5:var l=$n(t,48,57,!0,s);return l.length<4?"0"+l:l;case 4:return Rh(t,"",n);case 6:return Hm(t,1,3999,sD,3,s).toLowerCase();case 7:return Hm(t,1,3999,sD,3,s);case 8:return $n(t,945,969,!1,s);case 9:return $n(t,97,122,!1,s);case 10:return $n(t,65,90,!1,s);case 11:return $n(t,1632,1641,!0,s);case 12:case 49:return Hm(t,1,9999,nD,3,s);case 35:return Hm(t,1,9999,nD,3,s).toLowerCase();case 13:return $n(t,2534,2543,!0,s);case 14:case 30:return $n(t,6112,6121,!0,s);case 15:return Rh(t,"",n);case 16:return Rh(t,"",n);case 17:case 48:return kd(t,"",aD,"",n,Xu|Ju|qg);case 47:return kd(t,"",iD,"",n,s0|Xu|Ju|qg);case 42:return kd(t,"",aD,"",n,Xu|Ju|qg);case 41:return kd(t,"",iD,"",n,s0|Xu|Ju|qg);case 26:return kd(t,"","",oD,n,0);case 25:return kd(t,"","",oD,n,s0|Xu|Ju);case 31:return kd(t,"","",qC,i,s0|Xu|Ju);case 33:return kd(t,"","",qC,i,0);case 32:return kd(t,"","",qC,i,s0|Xu|Ju);case 18:return $n(t,2406,2415,!0,s);case 20:return Hm(t,1,19999,H1e,3,s);case 21:return $n(t,2790,2799,!0,s);case 22:return $n(t,2662,2671,!0,s);case 22:return Hm(t,1,10999,V1e,3,s);case 23:return Rh(t,"");case 24:return Rh(t,"");case 27:return $n(t,3302,3311,!0,s);case 28:return Rh(t,"",n);case 29:return Rh(t,"",n);case 34:return $n(t,3792,3801,!0,s);case 37:return $n(t,6160,6169,!0,s);case 38:return $n(t,4160,4169,!0,s);case 39:return $n(t,2918,2927,!0,s);case 40:return $n(t,1776,1785,!0,s);case 43:return $n(t,3046,3055,!0,s);case 44:return $n(t,3174,3183,!0,s);case 45:return $n(t,3664,3673,!0,s);case 46:return $n(t,3872,3881,!0,s);case 3:default:return $n(t,48,57,!0,s)}},UV="data-html2canvas-ignore",lD=function(){function t(e,r,s){if(this.context=e,this.options=s,this.scrolledElements=[],this.referenceElement=r,this.counters=new Q1e,this.quoteDepth=0,!r.ownerDocument)throw new Error("Cloned element does not have an owner document");this.documentElement=this.cloneNode(r.ownerDocument.documentElement,!1)}return t.prototype.toIFrame=function(e,r){var s=this,n=$1e(e,r);if(!n.contentWindow)return Promise.reject("Unable to find iframe window");var i=e.defaultView.pageXOffset,o=e.defaultView.pageYOffset,l=n.contentWindow,c=l.document,d=q1e(n).then(function(){return Vi(s,void 0,void 0,function(){var u,A;return vi(this,function(h){switch(h.label){case 0:return this.scrolledElements.forEach(X1e),l&&(l.scrollTo(r.left,r.top),/(iPad|iPhone|iPod)/g.test(navigator.userAgent)&&(l.scrollY!==r.top||l.scrollX!==r.left)&&(this.context.logger.warn("Unable to restore scroll position for cloned document"),this.context.windowBounds=this.context.windowBounds.add(l.scrollX-r.left,l.scrollY-r.top,0,0))),u=this.options.onclone,A=this.clonedReferenceElement,typeof A>"u"?[2,Promise.reject("Error finding the "+this.referenceElement.nodeName+" in the cloned document")]:c.fonts&&c.fonts.ready?[4,c.fonts.ready]:[3,2];case 1:h.sent(),h.label=2;case 2:return/(AppleWebKit)/g.test(navigator.userAgent)?[4,z1e(c)]:[3,4];case 3:h.sent(),h.label=4;case 4:return typeof u=="function"?[2,Promise.resolve().then(function(){return u(c,A)}).then(function(){return n})]:[2,n]}})})});return c.open(),c.write(G1e(document.doctype)+"<html></html>"),Y1e(this.referenceElement.ownerDocument,i,o),c.replaceChild(c.adoptNode(this.documentElement),c.documentElement),c.close(),d},t.prototype.createElementClone=function(e){if(DS(e,2))debugger;if(DV(e))return this.createCanvasClone(e);if(eD(e))return this.createVideoClone(e);if(tD(e))return this.createStyleClone(e);var r=e.cloneNode(!1);return US(r)&&(US(e)&&e.currentSrc&&e.currentSrc!==e.src&&(r.src=e.currentSrc,r.srcset=""),r.loading==="lazy"&&(r.loading="eager")),rD(r)?this.createCustomElementClone(r):r},t.prototype.createCustomElementClone=function(e){var r=document.createElement("html2canvascustomelement");return WC(e.style,r),r},t.prototype.createStyleClone=function(e){try{var r=e.sheet;if(r&&r.cssRules){var s=[].slice.call(r.cssRules,0).reduce(function(i,o){return o&&typeof o.cssText=="string"?i+o.cssText:i},""),n=e.cloneNode(!1);return n.textContent=s,n}}catch(i){if(this.context.logger.error("Unable to access cssRules property",i),i.name!=="SecurityError")throw i}return e.cloneNode(!1)},t.prototype.createCanvasClone=function(e){var r;if(this.options.inlineImages&&e.ownerDocument){var s=e.ownerDocument.createElement("img");try{return s.src=e.toDataURL(),s}catch{this.context.logger.info("Unable to inline canvas contents, canvas is tainted",e)}}var n=e.cloneNode(!1);try{n.width=e.width,n.height=e.height;var i=e.getContext("2d"),o=n.getContext("2d");if(o)if(!this.options.allowTaint&&i)o.putImageData(i.getImageData(0,0,e.width,e.height),0,0);else{var l=(r=e.getContext("webgl2"))!==null&&r!==void 0?r:e.getContext("webgl");if(l){var c=l.getContextAttributes();(c==null?void 0:c.preserveDrawingBuffer)===!1&&this.context.logger.warn("Unable to clone WebGL context as it has preserveDrawingBuffer=false",e)}o.drawImage(e,0,0)}return n}catch{this.context.logger.info("Unable to clone canvas as it is tainted",e)}return n},t.prototype.createVideoClone=function(e){var r=e.ownerDocument.createElement("canvas");r.width=e.offsetWidth,r.height=e.offsetHeight;var s=r.getContext("2d");try{return s&&(s.drawImage(e,0,0,r.width,r.height),this.options.allowTaint||s.getImageData(0,0,r.width,r.height)),r}catch{this.context.logger.info("Unable to clone video as it is tainted",e)}var n=e.ownerDocument.createElement("canvas");return n.width=e.offsetWidth,n.height=e.offsetHeight,n},t.prototype.appendChildNode=function(e,r,s){(!N0(r)||!M1e(r)&&!r.hasAttribute(UV)&&(typeof this.options.ignoreElements!="function"||!this.options.ignoreElements(r)))&&(!this.options.copyStyles||!N0(r)||!tD(r))&&e.appendChild(this.cloneNode(r,s))},t.prototype.cloneChildNodes=function(e,r,s){for(var n=this,i=e.shadowRoot?e.shadowRoot.firstChild:e.firstChild;i;i=i.nextSibling)if(N0(i)&&LV(i)&&typeof i.assignedNodes=="function"){var o=i.assignedNodes();o.length&&o.forEach(function(l){return n.appendChildNode(r,l,s)})}else this.appendChildNode(r,i,s)},t.prototype.cloneNode=function(e,r){if(FV(e))return document.createTextNode(e.data);if(!e.ownerDocument)return e.cloneNode(!1);var s=e.ownerDocument.defaultView;if(s&&N0(e)&&(OS(e)||Vb(e))){var n=this.createElementClone(e);n.style.transitionProperty="none";var i=s.getComputedStyle(e),o=s.getComputedStyle(e,":before"),l=s.getComputedStyle(e,":after");this.referenceElement===e&&OS(n)&&(this.clonedReferenceElement=n),AT(n)&&ebe(n);var c=this.counters.parse(new UP(this.context,i)),d=this.resolvePseudoContent(e,n,o,kx.BEFORE);rD(e)&&(r=!0),eD(e)||this.cloneChildNodes(e,n,r),d&&n.insertBefore(d,n.firstChild);var u=this.resolvePseudoContent(e,n,l,kx.AFTER);return u&&n.appendChild(u),this.counters.pop(c),(i&&(this.options.copyStyles||Vb(e))&&!RV(e)||r)&&WC(i,n),(e.scrollTop!==0||e.scrollLeft!==0)&&this.scrolledElements.push([n,e.scrollLeft,e.scrollTop]),(g2(e)||x2(e))&&(g2(n)||x2(n))&&(n.value=e.value),n}return e.cloneNode(!1)},t.prototype.resolvePseudoContent=function(e,r,s,n){var i=this;if(s){var o=s.content,l=r.ownerDocument;if(!(!l||!o||o==="none"||o==="-moz-alt-content"||s.display==="none")){this.counters.parse(new UP(this.context,s));var c=new Rve(this.context,s),d=l.createElement("html2canvaspseudoelement");WC(s,d),c.content.forEach(function(A){if(A.type===0)d.appendChild(l.createTextNode(A.value));else if(A.type===22){var h=l.createElement("img");h.src=A.value,h.style.opacity="1",d.appendChild(h)}else if(A.type===18){if(A.name==="attr"){var f=A.values.filter($s);f.length&&d.appendChild(l.createTextNode(e.getAttribute(f[0].value)||""))}else if(A.name==="counter"){var p=A.values.filter(Np),m=p[0],g=p[1];if(m&&$s(m)){var y=i.counters.getCounterValue(m.value),v=g&&$s(g)?PS.parse(i.context,g.value):3;d.appendChild(l.createTextNode(Sy(y,v,!1)))}}else if(A.name==="counters"){var x=A.values.filter(Np),m=x[0],E=x[1],g=x[2];if(m&&$s(m)){var T=i.counters.getCounterValues(m.value),j=g&&$s(g)?PS.parse(i.context,g.value):3,C=E&&E.type===0?E.value:"",w=T.map(function(B){return Sy(B,j,!1)}).join(C);d.appendChild(l.createTextNode(w))}}}else if(A.type===20)switch(A.value){case"open-quote":d.appendChild(l.createTextNode(OP(c.quotes,i.quoteDepth++,!0)));break;case"close-quote":d.appendChild(l.createTextNode(OP(c.quotes,--i.quoteDepth,!1)));break;default:d.appendChild(l.createTextNode(A.value))}}),d.className=MS+" "+QS;var u=n===kx.BEFORE?" "+MS:" "+QS;return Vb(r)?r.className.baseValue+=u:r.className+=u,d}}},t.destroy=function(e){return e.parentNode?(e.parentNode.removeChild(e),!0):!1},t}(),kx;(function(t){t[t.BEFORE=0]="BEFORE",t[t.AFTER=1]="AFTER"})(kx||(kx={}));var $1e=function(t,e){var r=t.createElement("iframe");return r.className="html2canvas-container",r.style.visibility="hidden",r.style.position="fixed",r.style.left="-10000px",r.style.top="0px",r.style.border="0",r.width=e.width.toString(),r.height=e.height.toString(),r.scrolling="no",r.setAttribute(UV,"true"),t.body.appendChild(r),r},K1e=function(t){return new Promise(function(e){if(t.complete){e();return}if(!t.src){e();return}t.onload=e,t.onerror=e})},z1e=function(t){return Promise.all([].slice.call(t.images,0).map(K1e))},q1e=function(t){return new Promise(function(e,r){var s=t.contentWindow;if(!s)return r("No window assigned for iframe");var n=s.document;s.onload=t.onload=function(){s.onload=t.onload=null;var i=setInterval(function(){n.body.childNodes.length>0&&n.readyState==="complete"&&(clearInterval(i),e(t))},50)}})},W1e=["all","d","content"],WC=function(t,e){for(var r=t.length-1;r>=0;r--){var s=t.item(r);W1e.indexOf(s)===-1&&e.style.setProperty(s,t.getPropertyValue(s))}return e},G1e=function(t){var e="";return t&&(e+="<!DOCTYPE ",t.name&&(e+=t.name),t.internalSubset&&(e+=t.internalSubset),t.publicId&&(e+='"'+t.publicId+'"'),t.systemId&&(e+='"'+t.systemId+'"'),e+=">"),e},Y1e=function(t,e,r){t&&t.defaultView&&(e!==t.defaultView.pageXOffset||r!==t.defaultView.pageYOffset)&&t.defaultView.scrollTo(e,r)},X1e=function(t){var e=t[0],r=t[1],s=t[2];e.scrollLeft=r,e.scrollTop=s},J1e=":before",Z1e=":after",MS="___html2canvas___pseudoelement_before",QS="___html2canvas___pseudoelement_after",cD=`{
    content: "" !important;
    display: none !important;
}`,ebe=function(t){tbe(t,"."+MS+J1e+cD+`
         .`+QS+Z1e+cD)},tbe=function(t,e){var r=t.ownerDocument;if(r){var s=r.createElement("style");s.textContent=e,t.appendChild(s)}},MV=function(){function t(){}return t.getOrigin=function(e){var r=t._link;return r?(r.href=e,r.href=r.href,r.protocol+r.hostname+r.port):"about:blank"},t.isSameOrigin=function(e){return t.getOrigin(e)===t._origin},t.setContext=function(e){t._link=e.document.createElement("a"),t._origin=t.getOrigin(e.location.href)},t._origin="about:blank",t}(),rbe=function(){function t(e,r){this.context=e,this._options=r,this._cache={}}return t.prototype.addImage=function(e){var r=Promise.resolve();return this.has(e)||(YC(e)||ibe(e))&&(this._cache[e]=this.loadImage(e)).catch(function(){}),r},t.prototype.match=function(e){return this._cache[e]},t.prototype.loadImage=function(e){return Vi(this,void 0,void 0,function(){var r,s,n,i,o=this;return vi(this,function(l){switch(l.label){case 0:return r=MV.isSameOrigin(e),s=!GC(e)&&this._options.useCORS===!0&&Za.SUPPORT_CORS_IMAGES&&!r,n=!GC(e)&&!r&&!YC(e)&&typeof this._options.proxy=="string"&&Za.SUPPORT_CORS_XHR&&!s,!r&&this._options.allowTaint===!1&&!GC(e)&&!YC(e)&&!n&&!s?[2]:(i=e,n?[4,this.proxy(i)]:[3,2]);case 1:i=l.sent(),l.label=2;case 2:return this.context.logger.debug("Added image "+e.substring(0,256)),[4,new Promise(function(c,d){var u=new Image;u.onload=function(){return c(u)},u.onerror=d,(obe(i)||s)&&(u.crossOrigin="anonymous"),u.src=i,u.complete===!0&&setTimeout(function(){return c(u)},500),o._options.imageTimeout>0&&setTimeout(function(){return d("Timed out ("+o._options.imageTimeout+"ms) loading image")},o._options.imageTimeout)})];case 3:return[2,l.sent()]}})})},t.prototype.has=function(e){return typeof this._cache[e]<"u"},t.prototype.keys=function(){return Promise.resolve(Object.keys(this._cache))},t.prototype.proxy=function(e){var r=this,s=this._options.proxy;if(!s)throw new Error("No proxy defined");var n=e.substring(0,256);return new Promise(function(i,o){var l=Za.SUPPORT_RESPONSE_TYPE?"blob":"text",c=new XMLHttpRequest;c.onload=function(){if(c.status===200)if(l==="text")i(c.response);else{var A=new FileReader;A.addEventListener("load",function(){return i(A.result)},!1),A.addEventListener("error",function(h){return o(h)},!1),A.readAsDataURL(c.response)}else o("Failed to proxy resource "+n+" with status code "+c.status)},c.onerror=o;var d=s.indexOf("?")>-1?"&":"?";if(c.open("GET",""+s+d+"url="+encodeURIComponent(e)+"&responseType="+l),l!=="text"&&c instanceof XMLHttpRequest&&(c.responseType=l),r._options.imageTimeout){var u=r._options.imageTimeout;c.timeout=u,c.ontimeout=function(){return o("Timed out ("+u+"ms) proxying "+n)}}c.send()})},t}(),sbe=/^data:image\/svg\+xml/i,nbe=/^data:image\/.*;base64,/i,abe=/^data:image\/.*/i,ibe=function(t){return Za.SUPPORT_SVG_DRAWING||!lbe(t)},GC=function(t){return abe.test(t)},obe=function(t){return nbe.test(t)},YC=function(t){return t.substr(0,4)==="blob"},lbe=function(t){return t.substr(-3).toLowerCase()==="svg"||sbe.test(t)},lr=function(){function t(e,r){this.type=0,this.x=e,this.y=r}return t.prototype.add=function(e,r){return new t(this.x+e,this.y+r)},t}(),$m=function(t,e,r){return new lr(t.x+(e.x-t.x)*r,t.y+(e.y-t.y)*r)},Z1=function(){function t(e,r,s,n){this.type=1,this.start=e,this.startControl=r,this.endControl=s,this.end=n}return t.prototype.subdivide=function(e,r){var s=$m(this.start,this.startControl,e),n=$m(this.startControl,this.endControl,e),i=$m(this.endControl,this.end,e),o=$m(s,n,e),l=$m(n,i,e),c=$m(o,l,e);return r?new t(this.start,s,o,c):new t(c,l,i,this.end)},t.prototype.add=function(e,r){return new t(this.start.add(e,r),this.startControl.add(e,r),this.endControl.add(e,r),this.end.add(e,r))},t.prototype.reverse=function(){return new t(this.end,this.endControl,this.startControl,this.start)},t}(),Nl=function(t){return t.type===1},cbe=function(){function t(e){var r=e.styles,s=e.bounds,n=Kg(r.borderTopLeftRadius,s.width,s.height),i=n[0],o=n[1],l=Kg(r.borderTopRightRadius,s.width,s.height),c=l[0],d=l[1],u=Kg(r.borderBottomRightRadius,s.width,s.height),A=u[0],h=u[1],f=Kg(r.borderBottomLeftRadius,s.width,s.height),p=f[0],m=f[1],g=[];g.push((i+c)/s.width),g.push((p+A)/s.width),g.push((o+m)/s.height),g.push((d+h)/s.height);var y=Math.max.apply(Math,g);y>1&&(i/=y,o/=y,c/=y,d/=y,A/=y,h/=y,p/=y,m/=y);var v=s.width-c,x=s.height-h,E=s.width-A,T=s.height-m,j=r.borderTopWidth,C=r.borderRightWidth,w=r.borderBottomWidth,S=r.borderLeftWidth,F=tn(r.paddingTop,e.bounds.width),B=tn(r.paddingRight,e.bounds.width),k=tn(r.paddingBottom,e.bounds.width),D=tn(r.paddingLeft,e.bounds.width);this.topLeftBorderDoubleOuterBox=i>0||o>0?xn(s.left+S/3,s.top+j/3,i-S/3,o-j/3,_s.TOP_LEFT):new lr(s.left+S/3,s.top+j/3),this.topRightBorderDoubleOuterBox=i>0||o>0?xn(s.left+v,s.top+j/3,c-C/3,d-j/3,_s.TOP_RIGHT):new lr(s.left+s.width-C/3,s.top+j/3),this.bottomRightBorderDoubleOuterBox=A>0||h>0?xn(s.left+E,s.top+x,A-C/3,h-w/3,_s.BOTTOM_RIGHT):new lr(s.left+s.width-C/3,s.top+s.height-w/3),this.bottomLeftBorderDoubleOuterBox=p>0||m>0?xn(s.left+S/3,s.top+T,p-S/3,m-w/3,_s.BOTTOM_LEFT):new lr(s.left+S/3,s.top+s.height-w/3),this.topLeftBorderDoubleInnerBox=i>0||o>0?xn(s.left+S*2/3,s.top+j*2/3,i-S*2/3,o-j*2/3,_s.TOP_LEFT):new lr(s.left+S*2/3,s.top+j*2/3),this.topRightBorderDoubleInnerBox=i>0||o>0?xn(s.left+v,s.top+j*2/3,c-C*2/3,d-j*2/3,_s.TOP_RIGHT):new lr(s.left+s.width-C*2/3,s.top+j*2/3),this.bottomRightBorderDoubleInnerBox=A>0||h>0?xn(s.left+E,s.top+x,A-C*2/3,h-w*2/3,_s.BOTTOM_RIGHT):new lr(s.left+s.width-C*2/3,s.top+s.height-w*2/3),this.bottomLeftBorderDoubleInnerBox=p>0||m>0?xn(s.left+S*2/3,s.top+T,p-S*2/3,m-w*2/3,_s.BOTTOM_LEFT):new lr(s.left+S*2/3,s.top+s.height-w*2/3),this.topLeftBorderStroke=i>0||o>0?xn(s.left+S/2,s.top+j/2,i-S/2,o-j/2,_s.TOP_LEFT):new lr(s.left+S/2,s.top+j/2),this.topRightBorderStroke=i>0||o>0?xn(s.left+v,s.top+j/2,c-C/2,d-j/2,_s.TOP_RIGHT):new lr(s.left+s.width-C/2,s.top+j/2),this.bottomRightBorderStroke=A>0||h>0?xn(s.left+E,s.top+x,A-C/2,h-w/2,_s.BOTTOM_RIGHT):new lr(s.left+s.width-C/2,s.top+s.height-w/2),this.bottomLeftBorderStroke=p>0||m>0?xn(s.left+S/2,s.top+T,p-S/2,m-w/2,_s.BOTTOM_LEFT):new lr(s.left+S/2,s.top+s.height-w/2),this.topLeftBorderBox=i>0||o>0?xn(s.left,s.top,i,o,_s.TOP_LEFT):new lr(s.left,s.top),this.topRightBorderBox=c>0||d>0?xn(s.left+v,s.top,c,d,_s.TOP_RIGHT):new lr(s.left+s.width,s.top),this.bottomRightBorderBox=A>0||h>0?xn(s.left+E,s.top+x,A,h,_s.BOTTOM_RIGHT):new lr(s.left+s.width,s.top+s.height),this.bottomLeftBorderBox=p>0||m>0?xn(s.left,s.top+T,p,m,_s.BOTTOM_LEFT):new lr(s.left,s.top+s.height),this.topLeftPaddingBox=i>0||o>0?xn(s.left+S,s.top+j,Math.max(0,i-S),Math.max(0,o-j),_s.TOP_LEFT):new lr(s.left+S,s.top+j),this.topRightPaddingBox=c>0||d>0?xn(s.left+Math.min(v,s.width-C),s.top+j,v>s.width+C?0:Math.max(0,c-C),Math.max(0,d-j),_s.TOP_RIGHT):new lr(s.left+s.width-C,s.top+j),this.bottomRightPaddingBox=A>0||h>0?xn(s.left+Math.min(E,s.width-S),s.top+Math.min(x,s.height-w),Math.max(0,A-C),Math.max(0,h-w),_s.BOTTOM_RIGHT):new lr(s.left+s.width-C,s.top+s.height-w),this.bottomLeftPaddingBox=p>0||m>0?xn(s.left+S,s.top+Math.min(T,s.height-w),Math.max(0,p-S),Math.max(0,m-w),_s.BOTTOM_LEFT):new lr(s.left+S,s.top+s.height-w),this.topLeftContentBox=i>0||o>0?xn(s.left+S+D,s.top+j+F,Math.max(0,i-(S+D)),Math.max(0,o-(j+F)),_s.TOP_LEFT):new lr(s.left+S+D,s.top+j+F),this.topRightContentBox=c>0||d>0?xn(s.left+Math.min(v,s.width+S+D),s.top+j+F,v>s.width+S+D?0:c-S+D,d-(j+F),_s.TOP_RIGHT):new lr(s.left+s.width-(C+B),s.top+j+F),this.bottomRightContentBox=A>0||h>0?xn(s.left+Math.min(E,s.width-(S+D)),s.top+Math.min(x,s.height+j+F),Math.max(0,A-(C+B)),h-(w+k),_s.BOTTOM_RIGHT):new lr(s.left+s.width-(C+B),s.top+s.height-(w+k)),this.bottomLeftContentBox=p>0||m>0?xn(s.left+S+D,s.top+T,Math.max(0,p-(S+D)),m-(w+k),_s.BOTTOM_LEFT):new lr(s.left+S+D,s.top+s.height-(w+k))}return t}(),_s;(function(t){t[t.TOP_LEFT=0]="TOP_LEFT",t[t.TOP_RIGHT=1]="TOP_RIGHT",t[t.BOTTOM_RIGHT=2]="BOTTOM_RIGHT",t[t.BOTTOM_LEFT=3]="BOTTOM_LEFT"})(_s||(_s={}));var xn=function(t,e,r,s,n){var i=4*((Math.sqrt(2)-1)/3),o=r*i,l=s*i,c=t+r,d=e+s;switch(n){case _s.TOP_LEFT:return new Z1(new lr(t,d),new lr(t,d-l),new lr(c-o,e),new lr(c,e));case _s.TOP_RIGHT:return new Z1(new lr(t,e),new lr(t+o,e),new lr(c,d-l),new lr(c,d));case _s.BOTTOM_RIGHT:return new Z1(new lr(c,e),new lr(c,e+l),new lr(t+o,d),new lr(t,d));case _s.BOTTOM_LEFT:default:return new Z1(new lr(c,d),new lr(c-o,d),new lr(t,e+l),new lr(t,e))}},y2=function(t){return[t.topLeftBorderBox,t.topRightBorderBox,t.bottomRightBorderBox,t.bottomLeftBorderBox]},dbe=function(t){return[t.topLeftContentBox,t.topRightContentBox,t.bottomRightContentBox,t.bottomLeftContentBox]},v2=function(t){return[t.topLeftPaddingBox,t.topRightPaddingBox,t.bottomRightPaddingBox,t.bottomLeftPaddingBox]},ube=function(){function t(e,r,s){this.offsetX=e,this.offsetY=r,this.matrix=s,this.type=0,this.target=6}return t}(),eb=function(){function t(e,r){this.path=e,this.target=r,this.type=1}return t}(),Abe=function(){function t(e){this.opacity=e,this.type=2,this.target=6}return t}(),hbe=function(t){return t.type===0},QV=function(t){return t.type===1},fbe=function(t){return t.type===2},dD=function(t,e){return t.length===e.length?t.some(function(r,s){return r===e[s]}):!1},mbe=function(t,e,r,s,n){return t.map(function(i,o){switch(o){case 0:return i.add(e,r);case 1:return i.add(e+s,r);case 2:return i.add(e+s,r+n);case 3:return i.add(e,r+n)}return i})},VV=function(){function t(e){this.element=e,this.inlineLevel=[],this.nonInlineLevel=[],this.negativeZIndex=[],this.zeroOrAutoZIndexOrTransformedOrOpacity=[],this.positiveZIndex=[],this.nonPositionedFloats=[],this.nonPositionedInlineLevel=[]}return t}(),HV=function(){function t(e,r){if(this.container=e,this.parent=r,this.effects=[],this.curves=new cbe(this.container),this.container.styles.opacity<1&&this.effects.push(new Abe(this.container.styles.opacity)),this.container.styles.transform!==null){var s=this.container.bounds.left+this.container.styles.transformOrigin[0].number,n=this.container.bounds.top+this.container.styles.transformOrigin[1].number,i=this.container.styles.transform;this.effects.push(new ube(s,n,i))}if(this.container.styles.overflowX!==0){var o=y2(this.curves),l=v2(this.curves);dD(o,l)?this.effects.push(new eb(o,6)):(this.effects.push(new eb(o,2)),this.effects.push(new eb(l,4)))}}return t.prototype.getEffects=function(e){for(var r=[2,3].indexOf(this.container.styles.position)===-1,s=this.parent,n=this.effects.slice(0);s;){var i=s.effects.filter(function(c){return!QV(c)});if(r||s.container.styles.position!==0||!s.parent){if(n.unshift.apply(n,i),r=[2,3].indexOf(s.container.styles.position)===-1,s.container.styles.overflowX!==0){var o=y2(s.curves),l=v2(s.curves);dD(o,l)||n.unshift(new eb(l,6))}}else n.unshift.apply(n,i);s=s.parent}return n.filter(function(c){return wa(c.target,e)})},t}(),VS=function(t,e,r,s){t.container.elements.forEach(function(n){var i=wa(n.flags,4),o=wa(n.flags,2),l=new HV(n,t);wa(n.styles.display,2048)&&s.push(l);var c=wa(n.flags,8)?[]:s;if(i||o){var d=i||n.styles.isPositioned()?r:e,u=new VV(l);if(n.styles.isPositioned()||n.styles.opacity<1||n.styles.isTransformed()){var A=n.styles.zIndex.order;if(A<0){var h=0;d.negativeZIndex.some(function(p,m){return A>p.element.container.styles.zIndex.order?(h=m,!1):h>0}),d.negativeZIndex.splice(h,0,u)}else if(A>0){var f=0;d.positiveZIndex.some(function(p,m){return A>=p.element.container.styles.zIndex.order?(f=m+1,!1):f>0}),d.positiveZIndex.splice(f,0,u)}else d.zeroOrAutoZIndexOrTransformedOrOpacity.push(u)}else n.styles.isFloating()?d.nonPositionedFloats.push(u):d.nonPositionedInlineLevel.push(u);VS(l,u,i?u:r,c)}else n.styles.isInlineLevel()?e.inlineLevel.push(l):e.nonInlineLevel.push(l),VS(l,e,r,c);wa(n.flags,8)&&$V(n,c)})},$V=function(t,e){for(var r=t instanceof LS?t.start:1,s=t instanceof LS?t.reversed:!1,n=0;n<e.length;n++){var i=e[n];i.container instanceof EV&&typeof i.container.value=="number"&&i.container.value!==0&&(r=i.container.value),i.listValue=Sy(r,i.container.styles.listStyleType,!0),r+=s?-1:1}},pbe=function(t){var e=new HV(t,null),r=new VV(e),s=[];return VS(e,r,r,s),$V(e.container,s),r},uD=function(t,e){switch(e){case 0:return Tl(t.topLeftBorderBox,t.topLeftPaddingBox,t.topRightBorderBox,t.topRightPaddingBox);case 1:return Tl(t.topRightBorderBox,t.topRightPaddingBox,t.bottomRightBorderBox,t.bottomRightPaddingBox);case 2:return Tl(t.bottomRightBorderBox,t.bottomRightPaddingBox,t.bottomLeftBorderBox,t.bottomLeftPaddingBox);case 3:default:return Tl(t.bottomLeftBorderBox,t.bottomLeftPaddingBox,t.topLeftBorderBox,t.topLeftPaddingBox)}},gbe=function(t,e){switch(e){case 0:return Tl(t.topLeftBorderBox,t.topLeftBorderDoubleOuterBox,t.topRightBorderBox,t.topRightBorderDoubleOuterBox);case 1:return Tl(t.topRightBorderBox,t.topRightBorderDoubleOuterBox,t.bottomRightBorderBox,t.bottomRightBorderDoubleOuterBox);case 2:return Tl(t.bottomRightBorderBox,t.bottomRightBorderDoubleOuterBox,t.bottomLeftBorderBox,t.bottomLeftBorderDoubleOuterBox);case 3:default:return Tl(t.bottomLeftBorderBox,t.bottomLeftBorderDoubleOuterBox,t.topLeftBorderBox,t.topLeftBorderDoubleOuterBox)}},xbe=function(t,e){switch(e){case 0:return Tl(t.topLeftBorderDoubleInnerBox,t.topLeftPaddingBox,t.topRightBorderDoubleInnerBox,t.topRightPaddingBox);case 1:return Tl(t.topRightBorderDoubleInnerBox,t.topRightPaddingBox,t.bottomRightBorderDoubleInnerBox,t.bottomRightPaddingBox);case 2:return Tl(t.bottomRightBorderDoubleInnerBox,t.bottomRightPaddingBox,t.bottomLeftBorderDoubleInnerBox,t.bottomLeftPaddingBox);case 3:default:return Tl(t.bottomLeftBorderDoubleInnerBox,t.bottomLeftPaddingBox,t.topLeftBorderDoubleInnerBox,t.topLeftPaddingBox)}},ybe=function(t,e){switch(e){case 0:return tb(t.topLeftBorderStroke,t.topRightBorderStroke);case 1:return tb(t.topRightBorderStroke,t.bottomRightBorderStroke);case 2:return tb(t.bottomRightBorderStroke,t.bottomLeftBorderStroke);case 3:default:return tb(t.bottomLeftBorderStroke,t.topLeftBorderStroke)}},tb=function(t,e){var r=[];return Nl(t)?r.push(t.subdivide(.5,!1)):r.push(t),Nl(e)?r.push(e.subdivide(.5,!0)):r.push(e),r},Tl=function(t,e,r,s){var n=[];return Nl(t)?n.push(t.subdivide(.5,!1)):n.push(t),Nl(r)?n.push(r.subdivide(.5,!0)):n.push(r),Nl(s)?n.push(s.subdivide(.5,!0).reverse()):n.push(s),Nl(e)?n.push(e.subdivide(.5,!1).reverse()):n.push(e),n},KV=function(t){var e=t.bounds,r=t.styles;return e.add(r.borderLeftWidth,r.borderTopWidth,-(r.borderRightWidth+r.borderLeftWidth),-(r.borderTopWidth+r.borderBottomWidth))},b2=function(t){var e=t.styles,r=t.bounds,s=tn(e.paddingLeft,r.width),n=tn(e.paddingRight,r.width),i=tn(e.paddingTop,r.width),o=tn(e.paddingBottom,r.width);return r.add(s+e.borderLeftWidth,i+e.borderTopWidth,-(e.borderRightWidth+e.borderLeftWidth+s+n),-(e.borderTopWidth+e.borderBottomWidth+i+o))},vbe=function(t,e){return t===0?e.bounds:t===2?b2(e):KV(e)},bbe=function(t,e){return t===0?e.bounds:t===2?b2(e):KV(e)},XC=function(t,e,r){var s=vbe(n0(t.styles.backgroundOrigin,e),t),n=bbe(n0(t.styles.backgroundClip,e),t),i=wbe(n0(t.styles.backgroundSize,e),r,s),o=i[0],l=i[1],c=Kg(n0(t.styles.backgroundPosition,e),s.width-o,s.height-l),d=Nbe(n0(t.styles.backgroundRepeat,e),c,i,s,n),u=Math.round(s.left+c[0]),A=Math.round(s.top+c[1]);return[d,u,A,o,l]},Km=function(t){return $s(t)&&t.value===q0.AUTO},rb=function(t){return typeof t=="number"},wbe=function(t,e,r){var s=e[0],n=e[1],i=e[2],o=t[0],l=t[1];if(!o)return[0,0];if(pa(o)&&l&&pa(l))return[tn(o,r.width),tn(l,r.height)];var c=rb(i);if($s(o)&&(o.value===q0.CONTAIN||o.value===q0.COVER)){if(rb(i)){var d=r.width/r.height;return d<i!=(o.value===q0.COVER)?[r.width,r.width/i]:[r.height*i,r.height]}return[r.width,r.height]}var u=rb(s),A=rb(n),h=u||A;if(Km(o)&&(!l||Km(l))){if(u&&A)return[s,n];if(!c&&!h)return[r.width,r.height];if(h&&c){var f=u?s:n*i,p=A?n:s/i;return[f,p]}var m=u?s:r.width,g=A?n:r.height;return[m,g]}if(c){var y=0,v=0;return pa(o)?y=tn(o,r.width):pa(l)&&(v=tn(l,r.height)),Km(o)?y=v*i:(!l||Km(l))&&(v=y/i),[y,v]}var x=null,E=null;if(pa(o)?x=tn(o,r.width):l&&pa(l)&&(E=tn(l,r.height)),x!==null&&(!l||Km(l))&&(E=u&&A?x/s*n:r.height),E!==null&&Km(o)&&(x=u&&A?E/n*s:r.width),x!==null&&E!==null)return[x,E];throw new Error("Unable to calculate background-size for element")},n0=function(t,e){var r=t[e];return typeof r>"u"?t[0]:r},Nbe=function(t,e,r,s,n){var i=e[0],o=e[1],l=r[0],c=r[1];switch(t){case 2:return[new lr(Math.round(s.left),Math.round(s.top+o)),new lr(Math.round(s.left+s.width),Math.round(s.top+o)),new lr(Math.round(s.left+s.width),Math.round(c+s.top+o)),new lr(Math.round(s.left),Math.round(c+s.top+o))];case 3:return[new lr(Math.round(s.left+i),Math.round(s.top)),new lr(Math.round(s.left+i+l),Math.round(s.top)),new lr(Math.round(s.left+i+l),Math.round(s.height+s.top)),new lr(Math.round(s.left+i),Math.round(s.height+s.top))];case 1:return[new lr(Math.round(s.left+i),Math.round(s.top+o)),new lr(Math.round(s.left+i+l),Math.round(s.top+o)),new lr(Math.round(s.left+i+l),Math.round(s.top+o+c)),new lr(Math.round(s.left+i),Math.round(s.top+o+c))];default:return[new lr(Math.round(n.left),Math.round(n.top)),new lr(Math.round(n.left+n.width),Math.round(n.top)),new lr(Math.round(n.left+n.width),Math.round(n.height+n.top)),new lr(Math.round(n.left),Math.round(n.height+n.top))]}},Cbe="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",AD="Hidden Text",jbe=function(){function t(e){this._data={},this._document=e}return t.prototype.parseMetrics=function(e,r){var s=this._document.createElement("div"),n=this._document.createElement("img"),i=this._document.createElement("span"),o=this._document.body;s.style.visibility="hidden",s.style.fontFamily=e,s.style.fontSize=r,s.style.margin="0",s.style.padding="0",s.style.whiteSpace="nowrap",o.appendChild(s),n.src=Cbe,n.width=1,n.height=1,n.style.margin="0",n.style.padding="0",n.style.verticalAlign="baseline",i.style.fontFamily=e,i.style.fontSize=r,i.style.margin="0",i.style.padding="0",i.appendChild(this._document.createTextNode(AD)),s.appendChild(i),s.appendChild(n);var l=n.offsetTop-i.offsetTop+2;s.removeChild(i),s.appendChild(this._document.createTextNode(AD)),s.style.lineHeight="normal",n.style.verticalAlign="super";var c=n.offsetTop-s.offsetTop+2;return o.removeChild(s),{baseline:l,middle:c}},t.prototype.getMetrics=function(e,r){var s=e+" "+r;return typeof this._data[s]>"u"&&(this._data[s]=this.parseMetrics(e,r)),this._data[s]},t}(),zV=function(){function t(e,r){this.context=e,this.options=r}return t}(),Sbe=1e4,Ebe=function(t){vc(e,t);function e(r,s){var n=t.call(this,r,s)||this;return n._activeEffects=[],n.canvas=s.canvas?s.canvas:document.createElement("canvas"),n.ctx=n.canvas.getContext("2d"),s.canvas||(n.canvas.width=Math.floor(s.width*s.scale),n.canvas.height=Math.floor(s.height*s.scale),n.canvas.style.width=s.width+"px",n.canvas.style.height=s.height+"px"),n.fontMetrics=new jbe(document),n.ctx.scale(n.options.scale,n.options.scale),n.ctx.translate(-s.x,-s.y),n.ctx.textBaseline="bottom",n._activeEffects=[],n.context.logger.debug("Canvas renderer initialized ("+s.width+"x"+s.height+") with scale "+s.scale),n}return e.prototype.applyEffects=function(r){for(var s=this;this._activeEffects.length;)this.popEffect();r.forEach(function(n){return s.applyEffect(n)})},e.prototype.applyEffect=function(r){this.ctx.save(),fbe(r)&&(this.ctx.globalAlpha=r.opacity),hbe(r)&&(this.ctx.translate(r.offsetX,r.offsetY),this.ctx.transform(r.matrix[0],r.matrix[1],r.matrix[2],r.matrix[3],r.matrix[4],r.matrix[5]),this.ctx.translate(-r.offsetX,-r.offsetY)),QV(r)&&(this.path(r.path),this.ctx.clip()),this._activeEffects.push(r)},e.prototype.popEffect=function(){this._activeEffects.pop(),this.ctx.restore()},e.prototype.renderStack=function(r){return Vi(this,void 0,void 0,function(){var s;return vi(this,function(n){switch(n.label){case 0:return s=r.element.container.styles,s.isVisible()?[4,this.renderStackContent(r)]:[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}})})},e.prototype.renderNode=function(r){return Vi(this,void 0,void 0,function(){return vi(this,function(s){switch(s.label){case 0:if(wa(r.container.flags,16))debugger;return r.container.styles.isVisible()?[4,this.renderNodeBackgroundAndBorders(r)]:[3,3];case 1:return s.sent(),[4,this.renderNodeContent(r)];case 2:s.sent(),s.label=3;case 3:return[2]}})})},e.prototype.renderTextWithLetterSpacing=function(r,s,n){var i=this;if(s===0)this.ctx.fillText(r.text,r.bounds.left,r.bounds.top+n);else{var o=dT(r.text);o.reduce(function(l,c){return i.ctx.fillText(c,l,r.bounds.top+n),l+i.ctx.measureText(c).width},r.bounds.left)}},e.prototype.createFontStyle=function(r){var s=r.fontVariant.filter(function(o){return o==="normal"||o==="small-caps"}).join(""),n=Bbe(r.fontFamily).join(", "),i=hv(r.fontSize)?""+r.fontSize.number+r.fontSize.unit:r.fontSize.number+"px";return[[r.fontStyle,s,r.fontWeight,i,n].join(" "),n,i]},e.prototype.renderTextNode=function(r,s){return Vi(this,void 0,void 0,function(){var n,i,o,l,c,d,u,A,h=this;return vi(this,function(f){return n=this.createFontStyle(s),i=n[0],o=n[1],l=n[2],this.ctx.font=i,this.ctx.direction=s.direction===1?"rtl":"ltr",this.ctx.textAlign="left",this.ctx.textBaseline="alphabetic",c=this.fontMetrics.getMetrics(o,l),d=c.baseline,u=c.middle,A=s.paintOrder,r.textBounds.forEach(function(p){A.forEach(function(m){switch(m){case 0:h.ctx.fillStyle=Da(s.color),h.renderTextWithLetterSpacing(p,s.letterSpacing,d);var g=s.textShadow;g.length&&p.text.trim().length&&(g.slice(0).reverse().forEach(function(y){h.ctx.shadowColor=Da(y.color),h.ctx.shadowOffsetX=y.offsetX.number*h.options.scale,h.ctx.shadowOffsetY=y.offsetY.number*h.options.scale,h.ctx.shadowBlur=y.blur.number,h.renderTextWithLetterSpacing(p,s.letterSpacing,d)}),h.ctx.shadowColor="",h.ctx.shadowOffsetX=0,h.ctx.shadowOffsetY=0,h.ctx.shadowBlur=0),s.textDecorationLine.length&&(h.ctx.fillStyle=Da(s.textDecorationColor||s.color),s.textDecorationLine.forEach(function(y){switch(y){case 1:h.ctx.fillRect(p.bounds.left,Math.round(p.bounds.top+d),p.bounds.width,1);break;case 2:h.ctx.fillRect(p.bounds.left,Math.round(p.bounds.top),p.bounds.width,1);break;case 3:h.ctx.fillRect(p.bounds.left,Math.ceil(p.bounds.top+u),p.bounds.width,1);break}}));break;case 1:s.webkitTextStrokeWidth&&p.text.trim().length&&(h.ctx.strokeStyle=Da(s.webkitTextStrokeColor),h.ctx.lineWidth=s.webkitTextStrokeWidth,h.ctx.lineJoin=window.chrome?"miter":"round",h.ctx.strokeText(p.text,p.bounds.left,p.bounds.top+d)),h.ctx.strokeStyle="",h.ctx.lineWidth=0,h.ctx.lineJoin="miter";break}})}),[2]})})},e.prototype.renderReplacedElement=function(r,s,n){if(n&&r.intrinsicWidth>0&&r.intrinsicHeight>0){var i=b2(r),o=v2(s);this.path(o),this.ctx.save(),this.ctx.clip(),this.ctx.drawImage(n,0,0,r.intrinsicWidth,r.intrinsicHeight,i.left,i.top,i.width,i.height),this.ctx.restore()}},e.prototype.renderNodeContent=function(r){return Vi(this,void 0,void 0,function(){var s,n,i,o,l,c,v,v,d,u,A,h,E,f,p,T,m,g,y,v,x,E,T;return vi(this,function(j){switch(j.label){case 0:this.applyEffects(r.getEffects(4)),s=r.container,n=r.curves,i=s.styles,o=0,l=s.textNodes,j.label=1;case 1:return o<l.length?(c=l[o],[4,this.renderTextNode(c,i)]):[3,4];case 2:j.sent(),j.label=3;case 3:return o++,[3,1];case 4:if(!(s instanceof CV))return[3,8];j.label=5;case 5:return j.trys.push([5,7,,8]),[4,this.context.cache.match(s.src)];case 6:return v=j.sent(),this.renderReplacedElement(s,n,v),[3,8];case 7:return j.sent(),this.context.logger.error("Error loading image "+s.src),[3,8];case 8:if(s instanceof jV&&this.renderReplacedElement(s,n,s.canvas),!(s instanceof SV))return[3,12];j.label=9;case 9:return j.trys.push([9,11,,12]),[4,this.context.cache.match(s.svg)];case 10:return v=j.sent(),this.renderReplacedElement(s,n,v),[3,12];case 11:return j.sent(),this.context.logger.error("Error loading svg "+s.svg.substring(0,255)),[3,12];case 12:return s instanceof IV&&s.tree?(d=new e(this.context,{scale:this.options.scale,backgroundColor:s.backgroundColor,x:0,y:0,width:s.width,height:s.height}),[4,d.render(s.tree)]):[3,14];case 13:u=j.sent(),s.width&&s.height&&this.ctx.drawImage(u,0,0,s.width,s.height,s.bounds.left,s.bounds.top,s.bounds.width,s.bounds.height),j.label=14;case 14:if(s instanceof uT&&(A=Math.min(s.bounds.width,s.bounds.height),s.type===m2?s.checked&&(this.ctx.save(),this.path([new lr(s.bounds.left+A*.39363,s.bounds.top+A*.79),new lr(s.bounds.left+A*.16,s.bounds.top+A*.5549),new lr(s.bounds.left+A*.27347,s.bounds.top+A*.44071),new lr(s.bounds.left+A*.39694,s.bounds.top+A*.5649),new lr(s.bounds.left+A*.72983,s.bounds.top+A*.23),new lr(s.bounds.left+A*.84,s.bounds.top+A*.34085),new lr(s.bounds.left+A*.39363,s.bounds.top+A*.79)]),this.ctx.fillStyle=Da(ZP),this.ctx.fill(),this.ctx.restore()):s.type===p2&&s.checked&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(s.bounds.left+A/2,s.bounds.top+A/2,A/4,0,Math.PI*2,!0),this.ctx.fillStyle=Da(ZP),this.ctx.fill(),this.ctx.restore())),_be(s)&&s.value.length){switch(h=this.createFontStyle(i),E=h[0],f=h[1],p=this.fontMetrics.getMetrics(E,f).baseline,this.ctx.font=E,this.ctx.fillStyle=Da(i.color),this.ctx.textBaseline="alphabetic",this.ctx.textAlign=Ibe(s.styles.textAlign),T=b2(s),m=0,s.styles.textAlign){case 1:m+=T.width/2;break;case 2:m+=T.width;break}g=T.add(m,0,0,-T.height/2+1),this.ctx.save(),this.path([new lr(T.left,T.top),new lr(T.left+T.width,T.top),new lr(T.left+T.width,T.top+T.height),new lr(T.left,T.top+T.height)]),this.ctx.clip(),this.renderTextWithLetterSpacing(new Ix(s.value,g),i.letterSpacing,p),this.ctx.restore(),this.ctx.textBaseline="alphabetic",this.ctx.textAlign="left"}if(!wa(s.styles.display,2048))return[3,20];if(s.styles.listStyleImage===null)return[3,19];if(y=s.styles.listStyleImage,y.type!==0)return[3,18];v=void 0,x=y.url,j.label=15;case 15:return j.trys.push([15,17,,18]),[4,this.context.cache.match(x)];case 16:return v=j.sent(),this.ctx.drawImage(v,s.bounds.left-(v.width+10),s.bounds.top),[3,18];case 17:return j.sent(),this.context.logger.error("Error loading list-style-image "+x),[3,18];case 18:return[3,20];case 19:r.listValue&&s.styles.listStyleType!==-1&&(E=this.createFontStyle(i)[0],this.ctx.font=E,this.ctx.fillStyle=Da(i.color),this.ctx.textBaseline="middle",this.ctx.textAlign="right",T=new lu(s.bounds.left,s.bounds.top+tn(s.styles.paddingTop,s.bounds.width),s.bounds.width,RP(i.lineHeight,i.fontSize.number)/2+1),this.renderTextWithLetterSpacing(new Ix(r.listValue,T),i.letterSpacing,RP(i.lineHeight,i.fontSize.number)/2+2),this.ctx.textBaseline="bottom",this.ctx.textAlign="left"),j.label=20;case 20:return[2]}})})},e.prototype.renderStackContent=function(r){return Vi(this,void 0,void 0,function(){var s,n,y,i,o,y,l,c,y,d,u,y,A,h,y,f,p,y,m,g,y;return vi(this,function(v){switch(v.label){case 0:if(wa(r.element.container.flags,16))debugger;return[4,this.renderNodeBackgroundAndBorders(r.element)];case 1:v.sent(),s=0,n=r.negativeZIndex,v.label=2;case 2:return s<n.length?(y=n[s],[4,this.renderStack(y)]):[3,5];case 3:v.sent(),v.label=4;case 4:return s++,[3,2];case 5:return[4,this.renderNodeContent(r.element)];case 6:v.sent(),i=0,o=r.nonInlineLevel,v.label=7;case 7:return i<o.length?(y=o[i],[4,this.renderNode(y)]):[3,10];case 8:v.sent(),v.label=9;case 9:return i++,[3,7];case 10:l=0,c=r.nonPositionedFloats,v.label=11;case 11:return l<c.length?(y=c[l],[4,this.renderStack(y)]):[3,14];case 12:v.sent(),v.label=13;case 13:return l++,[3,11];case 14:d=0,u=r.nonPositionedInlineLevel,v.label=15;case 15:return d<u.length?(y=u[d],[4,this.renderStack(y)]):[3,18];case 16:v.sent(),v.label=17;case 17:return d++,[3,15];case 18:A=0,h=r.inlineLevel,v.label=19;case 19:return A<h.length?(y=h[A],[4,this.renderNode(y)]):[3,22];case 20:v.sent(),v.label=21;case 21:return A++,[3,19];case 22:f=0,p=r.zeroOrAutoZIndexOrTransformedOrOpacity,v.label=23;case 23:return f<p.length?(y=p[f],[4,this.renderStack(y)]):[3,26];case 24:v.sent(),v.label=25;case 25:return f++,[3,23];case 26:m=0,g=r.positiveZIndex,v.label=27;case 27:return m<g.length?(y=g[m],[4,this.renderStack(y)]):[3,30];case 28:v.sent(),v.label=29;case 29:return m++,[3,27];case 30:return[2]}})})},e.prototype.mask=function(r){this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(this.canvas.width,0),this.ctx.lineTo(this.canvas.width,this.canvas.height),this.ctx.lineTo(0,this.canvas.height),this.ctx.lineTo(0,0),this.formatPath(r.slice(0).reverse()),this.ctx.closePath()},e.prototype.path=function(r){this.ctx.beginPath(),this.formatPath(r),this.ctx.closePath()},e.prototype.formatPath=function(r){var s=this;r.forEach(function(n,i){var o=Nl(n)?n.start:n;i===0?s.ctx.moveTo(o.x,o.y):s.ctx.lineTo(o.x,o.y),Nl(n)&&s.ctx.bezierCurveTo(n.startControl.x,n.startControl.y,n.endControl.x,n.endControl.y,n.end.x,n.end.y)})},e.prototype.renderRepeat=function(r,s,n,i){this.path(r),this.ctx.fillStyle=s,this.ctx.translate(n,i),this.ctx.fill(),this.ctx.translate(-n,-i)},e.prototype.resizeImage=function(r,s,n){var i;if(r.width===s&&r.height===n)return r;var o=(i=this.canvas.ownerDocument)!==null&&i!==void 0?i:document,l=o.createElement("canvas");l.width=Math.max(1,s),l.height=Math.max(1,n);var c=l.getContext("2d");return c.drawImage(r,0,0,r.width,r.height,0,0,s,n),l},e.prototype.renderBackgroundImage=function(r){return Vi(this,void 0,void 0,function(){var s,n,i,o,l,c;return vi(this,function(d){switch(d.label){case 0:s=r.styles.backgroundImage.length-1,n=function(u){var A,h,f,F,W,Q,D,q,w,p,F,W,Q,D,q,m,g,y,v,x,E,T,j,C,w,S,F,B,k,D,q,te,W,Q,re,G,Ae,he,I,U,V,L;return vi(this,function(K){switch(K.label){case 0:if(u.type!==0)return[3,5];A=void 0,h=u.url,K.label=1;case 1:return K.trys.push([1,3,,4]),[4,i.context.cache.match(h)];case 2:return A=K.sent(),[3,4];case 3:return K.sent(),i.context.logger.error("Error loading background-image "+h),[3,4];case 4:return A&&(f=XC(r,s,[A.width,A.height,A.width/A.height]),F=f[0],W=f[1],Q=f[2],D=f[3],q=f[4],w=i.ctx.createPattern(i.resizeImage(A,D,q),"repeat"),i.renderRepeat(F,w,W,Q)),[3,6];case 5:hye(u)?(p=XC(r,s,[null,null,null]),F=p[0],W=p[1],Q=p[2],D=p[3],q=p[4],m=lye(u.angle,D,q),g=m[0],y=m[1],v=m[2],x=m[3],E=m[4],T=document.createElement("canvas"),T.width=D,T.height=q,j=T.getContext("2d"),C=j.createLinearGradient(y,x,v,E),PP(u.stops,g).forEach(function(fe){return C.addColorStop(fe.stop,Da(fe.color))}),j.fillStyle=C,j.fillRect(0,0,D,q),D>0&&q>0&&(w=i.ctx.createPattern(T,"repeat"),i.renderRepeat(F,w,W,Q))):fye(u)&&(S=XC(r,s,[null,null,null]),F=S[0],B=S[1],k=S[2],D=S[3],q=S[4],te=u.position.length===0?[oT]:u.position,W=tn(te[0],D),Q=tn(te[te.length-1],q),re=cye(u,W,Q,D,q),G=re[0],Ae=re[1],G>0&&Ae>0&&(he=i.ctx.createRadialGradient(B+W,k+Q,0,B+W,k+Q,G),PP(u.stops,G*2).forEach(function(fe){return he.addColorStop(fe.stop,Da(fe.color))}),i.path(F),i.ctx.fillStyle=he,G!==Ae?(I=r.bounds.left+.5*r.bounds.width,U=r.bounds.top+.5*r.bounds.height,V=Ae/G,L=1/V,i.ctx.save(),i.ctx.translate(I,U),i.ctx.transform(1,0,0,V,0,0),i.ctx.translate(-I,-U),i.ctx.fillRect(B,L*(k-U)+U,D,q*L),i.ctx.restore()):i.ctx.fill())),K.label=6;case 6:return s--,[2]}})},i=this,o=0,l=r.styles.backgroundImage.slice(0).reverse(),d.label=1;case 1:return o<l.length?(c=l[o],[5,n(c)]):[3,4];case 2:d.sent(),d.label=3;case 3:return o++,[3,1];case 4:return[2]}})})},e.prototype.renderSolidBorder=function(r,s,n){return Vi(this,void 0,void 0,function(){return vi(this,function(i){return this.path(uD(n,s)),this.ctx.fillStyle=Da(r),this.ctx.fill(),[2]})})},e.prototype.renderDoubleBorder=function(r,s,n,i){return Vi(this,void 0,void 0,function(){var o,l;return vi(this,function(c){switch(c.label){case 0:return s<3?[4,this.renderSolidBorder(r,n,i)]:[3,2];case 1:return c.sent(),[2];case 2:return o=gbe(i,n),this.path(o),this.ctx.fillStyle=Da(r),this.ctx.fill(),l=xbe(i,n),this.path(l),this.ctx.fill(),[2]}})})},e.prototype.renderNodeBackgroundAndBorders=function(r){return Vi(this,void 0,void 0,function(){var s,n,i,o,l,c,d,u,A=this;return vi(this,function(h){switch(h.label){case 0:return this.applyEffects(r.getEffects(2)),s=r.container.styles,n=!QA(s.backgroundColor)||s.backgroundImage.length,i=[{style:s.borderTopStyle,color:s.borderTopColor,width:s.borderTopWidth},{style:s.borderRightStyle,color:s.borderRightColor,width:s.borderRightWidth},{style:s.borderBottomStyle,color:s.borderBottomColor,width:s.borderBottomWidth},{style:s.borderLeftStyle,color:s.borderLeftColor,width:s.borderLeftWidth}],o=Tbe(n0(s.backgroundClip,0),r.curves),n||s.boxShadow.length?(this.ctx.save(),this.path(o),this.ctx.clip(),QA(s.backgroundColor)||(this.ctx.fillStyle=Da(s.backgroundColor),this.ctx.fill()),[4,this.renderBackgroundImage(r.container)]):[3,2];case 1:h.sent(),this.ctx.restore(),s.boxShadow.slice(0).reverse().forEach(function(f){A.ctx.save();var p=y2(r.curves),m=f.inset?0:Sbe,g=mbe(p,-m+(f.inset?1:-1)*f.spread.number,(f.inset?1:-1)*f.spread.number,f.spread.number*(f.inset?-2:2),f.spread.number*(f.inset?-2:2));f.inset?(A.path(p),A.ctx.clip(),A.mask(g)):(A.mask(p),A.ctx.clip(),A.path(g)),A.ctx.shadowOffsetX=f.offsetX.number+m,A.ctx.shadowOffsetY=f.offsetY.number,A.ctx.shadowColor=Da(f.color),A.ctx.shadowBlur=f.blur.number,A.ctx.fillStyle=f.inset?Da(f.color):"rgba(0,0,0,1)",A.ctx.fill(),A.ctx.restore()}),h.label=2;case 2:l=0,c=0,d=i,h.label=3;case 3:return c<d.length?(u=d[c],u.style!==0&&!QA(u.color)&&u.width>0?u.style!==2?[3,5]:[4,this.renderDashedDottedBorder(u.color,u.width,l,r.curves,2)]:[3,11]):[3,13];case 4:return h.sent(),[3,11];case 5:return u.style!==3?[3,7]:[4,this.renderDashedDottedBorder(u.color,u.width,l,r.curves,3)];case 6:return h.sent(),[3,11];case 7:return u.style!==4?[3,9]:[4,this.renderDoubleBorder(u.color,u.width,l,r.curves)];case 8:return h.sent(),[3,11];case 9:return[4,this.renderSolidBorder(u.color,l,r.curves)];case 10:h.sent(),h.label=11;case 11:l++,h.label=12;case 12:return c++,[3,3];case 13:return[2]}})})},e.prototype.renderDashedDottedBorder=function(r,s,n,i,o){return Vi(this,void 0,void 0,function(){var l,c,d,u,A,h,f,p,m,g,y,v,x,E,T,j,T,j;return vi(this,function(C){return this.ctx.save(),l=ybe(i,n),c=uD(i,n),o===2&&(this.path(c),this.ctx.clip()),Nl(c[0])?(d=c[0].start.x,u=c[0].start.y):(d=c[0].x,u=c[0].y),Nl(c[1])?(A=c[1].end.x,h=c[1].end.y):(A=c[1].x,h=c[1].y),n===0||n===2?f=Math.abs(d-A):f=Math.abs(u-h),this.ctx.beginPath(),o===3?this.formatPath(l):this.formatPath(c.slice(0,2)),p=s<3?s*3:s*2,m=s<3?s*2:s,o===3&&(p=s,m=s),g=!0,f<=p*2?g=!1:f<=p*2+m?(y=f/(2*p+m),p*=y,m*=y):(v=Math.floor((f+m)/(p+m)),x=(f-v*p)/(v-1),E=(f-(v+1)*p)/v,m=E<=0||Math.abs(m-x)<Math.abs(m-E)?x:E),g&&(o===3?this.ctx.setLineDash([0,p+m]):this.ctx.setLineDash([p,m])),o===3?(this.ctx.lineCap="round",this.ctx.lineWidth=s):this.ctx.lineWidth=s*2+1.1,this.ctx.strokeStyle=Da(r),this.ctx.stroke(),this.ctx.setLineDash([]),o===2&&(Nl(c[0])&&(T=c[3],j=c[0],this.ctx.beginPath(),this.formatPath([new lr(T.end.x,T.end.y),new lr(j.start.x,j.start.y)]),this.ctx.stroke()),Nl(c[1])&&(T=c[1],j=c[2],this.ctx.beginPath(),this.formatPath([new lr(T.end.x,T.end.y),new lr(j.start.x,j.start.y)]),this.ctx.stroke())),this.ctx.restore(),[2]})})},e.prototype.render=function(r){return Vi(this,void 0,void 0,function(){var s;return vi(this,function(n){switch(n.label){case 0:return this.options.backgroundColor&&(this.ctx.fillStyle=Da(this.options.backgroundColor),this.ctx.fillRect(this.options.x,this.options.y,this.options.width,this.options.height)),s=pbe(r),[4,this.renderStack(s)];case 1:return n.sent(),this.applyEffects([]),[2,this.canvas]}})})},e}(zV),_be=function(t){return t instanceof TV||t instanceof _V?!0:t instanceof uT&&t.type!==p2&&t.type!==m2},Tbe=function(t,e){switch(t){case 0:return y2(e);case 2:return dbe(e);case 1:default:return v2(e)}},Ibe=function(t){switch(t){case 1:return"center";case 2:return"right";case 0:default:return"left"}},kbe=["-apple-system","system-ui"],Bbe=function(t){return/iPhone OS 15_(0|1)/.test(window.navigator.userAgent)?t.filter(function(e){return kbe.indexOf(e)===-1}):t},Fbe=function(t){vc(e,t);function e(r,s){var n=t.call(this,r,s)||this;return n.canvas=s.canvas?s.canvas:document.createElement("canvas"),n.ctx=n.canvas.getContext("2d"),n.options=s,n.canvas.width=Math.floor(s.width*s.scale),n.canvas.height=Math.floor(s.height*s.scale),n.canvas.style.width=s.width+"px",n.canvas.style.height=s.height+"px",n.ctx.scale(n.options.scale,n.options.scale),n.ctx.translate(-s.x,-s.y),n.context.logger.debug("EXPERIMENTAL ForeignObject renderer initialized ("+s.width+"x"+s.height+" at "+s.x+","+s.y+") with scale "+s.scale),n}return e.prototype.render=function(r){return Vi(this,void 0,void 0,function(){var s,n;return vi(this,function(i){switch(i.label){case 0:return s=RS(this.options.width*this.options.scale,this.options.height*this.options.scale,this.options.scale,this.options.scale,r),[4,Pbe(s)];case 1:return n=i.sent(),this.options.backgroundColor&&(this.ctx.fillStyle=Da(this.options.backgroundColor),this.ctx.fillRect(0,0,this.options.width*this.options.scale,this.options.height*this.options.scale)),this.ctx.drawImage(n,-this.options.x*this.options.scale,-this.options.y*this.options.scale),[2,this.canvas]}})})},e}(zV),Pbe=function(t){return new Promise(function(e,r){var s=new Image;s.onload=function(){e(s)},s.onerror=r,s.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(t))})},Dbe=function(){function t(e){var r=e.id,s=e.enabled;this.id=r,this.enabled=s,this.start=Date.now()}return t.prototype.debug=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.debug=="function"?console.debug.apply(console,P1([this.id,this.getTime()+"ms"],e)):this.info.apply(this,e))},t.prototype.getTime=function(){return Date.now()-this.start},t.prototype.info=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this.enabled&&typeof window<"u"&&window.console&&typeof console.info=="function"&&console.info.apply(console,P1([this.id,this.getTime()+"ms"],e))},t.prototype.warn=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.warn=="function"?console.warn.apply(console,P1([this.id,this.getTime()+"ms"],e)):this.info.apply(this,e))},t.prototype.error=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.error=="function"?console.error.apply(console,P1([this.id,this.getTime()+"ms"],e)):this.info.apply(this,e))},t.instances={},t}(),Rbe=function(){function t(e,r){var s;this.windowBounds=r,this.instanceName="#"+t.instanceCount++,this.logger=new Dbe({id:this.instanceName,enabled:e.logging}),this.cache=(s=e.cache)!==null&&s!==void 0?s:new rbe(this,e)}return t.instanceCount=1,t}(),qV=function(t,e){return e===void 0&&(e={}),Lbe(t,e)};typeof window<"u"&&MV.setContext(window);var Lbe=function(t,e){return Vi(void 0,void 0,void 0,function(){var r,s,n,i,o,l,c,d,u,A,h,f,p,m,g,y,v,x,E,T,C,j,C,w,S,F,B,k,D,q,te,W,Q,re,G,Ae,he,I,U,V;return vi(this,function(L){switch(L.label){case 0:if(!t||typeof t!="object")return[2,Promise.reject("Invalid element provided as first argument")];if(r=t.ownerDocument,!r)throw new Error("Element is not attached to a Document");if(s=r.defaultView,!s)throw new Error("Document is not attached to a Window");return n={allowTaint:(w=e.allowTaint)!==null&&w!==void 0?w:!1,imageTimeout:(S=e.imageTimeout)!==null&&S!==void 0?S:15e3,proxy:e.proxy,useCORS:(F=e.useCORS)!==null&&F!==void 0?F:!1},i=bS({logging:(B=e.logging)!==null&&B!==void 0?B:!0,cache:e.cache},n),o={windowWidth:(k=e.windowWidth)!==null&&k!==void 0?k:s.innerWidth,windowHeight:(D=e.windowHeight)!==null&&D!==void 0?D:s.innerHeight,scrollX:(q=e.scrollX)!==null&&q!==void 0?q:s.pageXOffset,scrollY:(te=e.scrollY)!==null&&te!==void 0?te:s.pageYOffset},l=new lu(o.scrollX,o.scrollY,o.windowWidth,o.windowHeight),c=new Rbe(i,l),d=(W=e.foreignObjectRendering)!==null&&W!==void 0?W:!1,u={allowTaint:(Q=e.allowTaint)!==null&&Q!==void 0?Q:!1,onclone:e.onclone,ignoreElements:e.ignoreElements,inlineImages:d,copyStyles:d},c.logger.debug("Starting document clone with size "+l.width+"x"+l.height+" scrolled to "+-l.left+","+-l.top),A=new lD(c,t,u),h=A.clonedReferenceElement,h?[4,A.toIFrame(r,l)]:[2,Promise.reject("Unable to find element in cloned iframe")];case 1:return f=L.sent(),p=AT(h)||U1e(h)?mge(h.ownerDocument):FN(c,h),m=p.width,g=p.height,y=p.left,v=p.top,x=Obe(c,h,e.backgroundColor),E={canvas:e.canvas,backgroundColor:x,scale:(G=(re=e.scale)!==null&&re!==void 0?re:s.devicePixelRatio)!==null&&G!==void 0?G:1,x:((Ae=e.x)!==null&&Ae!==void 0?Ae:0)+y,y:((he=e.y)!==null&&he!==void 0?he:0)+v,width:(I=e.width)!==null&&I!==void 0?I:Math.ceil(m),height:(U=e.height)!==null&&U!==void 0?U:Math.ceil(g)},d?(c.logger.debug("Document cloned, using foreign object rendering"),C=new Fbe(c,E),[4,C.render(h)]):[3,3];case 2:return T=L.sent(),[3,5];case 3:return c.logger.debug("Document cloned, element located at "+y+","+v+" with size "+m+"x"+g+" using computed rendering"),c.logger.debug("Starting DOM parsing"),j=BV(c,h),x===j.styles.backgroundColor&&(j.styles.backgroundColor=Gd.TRANSPARENT),c.logger.debug("Starting renderer for element at "+E.x+","+E.y+" with size "+E.width+"x"+E.height),C=new Ebe(c,E),[4,C.render(j)];case 4:T=L.sent(),L.label=5;case 5:return(!((V=e.removeContainer)!==null&&V!==void 0)||V)&&(lD.destroy(f)||c.logger.error("Cannot detach cloned iframe as it is not in the DOM anymore")),c.logger.debug("Finished rendering"),[2,T]}})})},Obe=function(t,e,r){var s=e.ownerDocument,n=s.documentElement?_x(t,getComputedStyle(s.documentElement).backgroundColor):Gd.TRANSPARENT,i=s.body?_x(t,getComputedStyle(s.body).backgroundColor):Gd.TRANSPARENT,o=typeof r=="string"?_x(t,r):r===null?Gd.TRANSPARENT:4294967295;return e===s.documentElement?QA(n)?QA(i)?o:i:n:o};const Ube=Object.freeze(Object.defineProperty({__proto__:null,default:qV},Symbol.toStringTag,{value:"Module"})),sb=[{id:"sales",name:"Sales Report",description:"Comprehensive sales analytics with revenue, orders, and customer insights",icon:hn,color:"bg-green-100 text-green-600",bgColor:"bg-green-50"},{id:"profit-loss",name:"Profit & Loss Statement",description:"Financial statement showing revenue, expenses, and net profit",icon:Is,color:"bg-blue-100 text-blue-600",bgColor:"bg-blue-50"},{id:"inventory",name:"Inventory Report",description:"Stock levels, consumption patterns, and inventory costs",icon:rs,color:"bg-purple-100 text-purple-600",bgColor:"bg-purple-50"},{id:"operational",name:"Operational Analytics",description:"Table utilization, staff performance, and efficiency metrics",icon:Sa,color:"bg-orange-100 text-orange-600",bgColor:"bg-orange-50"}],Mbe=[{value:"today",label:"Today"},{value:"yesterday",label:"Yesterday"},{value:"week",label:"This Week"},{value:"month",label:"This Month"},{value:"quarter",label:"This Quarter"},{value:"year",label:"This Year"},{value:"last-week",label:"Last Week"},{value:"last-month",label:"Last Month"},{value:"last-quarter",label:"Last Quarter"},{value:"last-year",label:"Last Year"},{value:"custom",label:"Custom Range"}];function Qbe(){var L,K,fe,ee,de,ue,Ie,Y;const{restaurant:t}=js(),{user:e}=ia(),[r,s]=R.useState("sales"),[n,i]=R.useState("month"),[o,l]=R.useState(""),[c,d]=R.useState(""),[u,A]=R.useState(!1),[h,f]=R.useState(!1),[p,m]=R.useState(null),[g,y]=R.useState({totalReports:0,reportsThisMonth:0,lastReportGenerated:null,favoriteReportType:"sales"});R.useEffect(()=>{t&&v()},[t]);const v=()=>{y({totalReports:23,reportsThisMonth:8,lastReportGenerated:new Date(Date.now()-2*24*60*60*1e3),favoriteReportType:"sales"})},x=()=>{const H=new Date,je=new Date(H.getFullYear(),H.getMonth(),H.getDate());switch(n){case"today":const Ce=new Date(je.getFullYear(),je.getMonth(),je.getDate(),23,59,59,999);return{start:je,end:Ce};case"yesterday":const oe=new Date(je.getTime()-24*60*60*1e3),He=new Date(oe.getFullYear(),oe.getMonth(),oe.getDate(),23,59,59,999);return{start:oe,end:He};case"week":return{start:new Date(je.getTime()-je.getDay()*24*60*60*1e3),end:H};case"month":return{start:new Date(H.getFullYear(),H.getMonth(),1),end:H};case"quarter":return{start:new Date(H.getFullYear(),Math.floor(H.getMonth()/3)*3,1),end:H};case"year":return{start:new Date(H.getFullYear(),0,1),end:H};case"last-week":const ae=new Date(je.getTime()-je.getDay()*24*60*60*1e3);return{start:new Date(ae.getTime()-7*24*60*60*1e3),end:ae};case"last-month":const we=new Date(H.getFullYear(),H.getMonth()-1,1),De=new Date(H.getFullYear(),H.getMonth(),0);return{start:we,end:De};case"last-quarter":const Ve=new Date(H.getFullYear(),Math.floor(H.getMonth()/3)*3,0);return{start:new Date(Ve.getFullYear(),Ve.getMonth()-2,1),end:Ve};case"last-year":const Fe=new Date(H.getFullYear()-1,0,1),Re=new Date(H.getFullYear()-1,11,31);return{start:Fe,end:Re};case"custom":return{start:o?new Date(o):new Date(H.getFullYear(),H.getMonth(),1),end:c?new Date(c):H};default:return{start:new Date(H.getFullYear(),H.getMonth(),1),end:H}}},E=async()=>{if(t){A(!0);try{const{start:H,end:je}=x(),[Ce,oe,He,ie,le]=await Promise.all([Ur.getOrdersForRestaurant(t.id),Ts.getMenuItemsForRestaurant(t.id),fs.getTablesForRestaurant(t.id),r0.getExpensesForPeriod(t.id,H,je),Ja.getInventoryForRestaurant(t.id)]),ae=Ce.success?Ce.data||[]:[],ve=ie.success?ie.data||[]:[],we=ae.filter(Be=>{const X=new Date(Be.createdAt),_e=new Date(X.getFullYear(),X.getMonth(),X.getDate()),ke=new Date(H.getFullYear(),H.getMonth(),H.getDate()),lt=new Date(je.getFullYear(),je.getMonth(),je.getDate());return _e>=ke&&_e<=lt}),De=ve,Ve=oe.success?oe.data||[]:[],me=He.success?He.data||[]:[],Fe=le.success?le.data||[]:[];let Re={};switch(r){case"sales":Re=await T(we,Ve,me,H,je);break;case"profit-loss":Re=await j(we,De,Fe,H,je);break;case"inventory":Re=await D(Fe,we,Ve,H,je);break;case"operational":Re=await q(we,me,Ve,H,je);break;case"customer":Re=await te(we,H,je);break;case"gamification":Re=await W(H,je);break;case"menu":Re=await Q(we,Ve,H,je);break;case"comparative":Re=await re(we,De,H,je);break}m({...Re,dateRange:{start:H,end:je},reportType:r,generatedAt:new Date,restaurantName:t.name})}catch(H){console.error("Error generating report:",H),Z.error("Failed to generate report")}finally{A(!1)}}},T=async(H,je,Ce,oe,He)=>{const ie=H.reduce((Me,rt)=>Me+rt.total,0),le=H.length;H.reduce((Me,rt)=>{var ht;return Me+(((ht=rt.items)==null?void 0:ht.length)||0)},0);const ae=H.reduce((Me,rt)=>Me+rt.items.reduce((ht,Qe)=>ht+(Qe.quantity||1),0),0),ve=le>0?ie/le:0,we=le>0?ae/le:0,De=H.filter(Me=>Me.status==="completed"),Ve=H.filter(Me=>Me.status==="cancelled"),me=le>0?De.length/le*100:0,Fe=le>0?Ve.length/le*100:0,Re=new Set;H.forEach(Me=>{Me.customerPhone?Re.add(Me.customerPhone):Me.customerName?Re.add(Me.customerName):Re.add(`order_${Me.id}`)});const Be=new Map;H.forEach(Me=>{Me.items.forEach(rt=>{const ht=rt.name;if(Be.has(ht)){const Qe=Be.get(ht);Qe.quantity+=rt.quantity||1,Qe.revenue+=rt.total||rt.price||0}else Be.set(ht,{name:rt.name,quantity:rt.quantity||1,revenue:rt.total||rt.price||0,avgPrice:(rt.total||rt.price||0)/(rt.quantity||1)})})});const X=Array.from(Be.values()).map(Me=>({...Me,revenuePercentage:ie>0?Me.revenue/ie*100:0})).sort((Me,rt)=>rt.revenue-Me.revenue),_e=new Map;H.forEach(Me=>{const rt=Me.paymentMethod||"cash";if(_e.has(rt)){const ht=_e.get(rt);ht.orders+=1,ht.revenue+=Me.total}else _e.set(rt,{method:rt,orders:1,revenue:Me.total})});const ke=Array.from(_e.values()).map(Me=>({...Me,percentageOfOrders:le>0?Me.orders/le*100:0,percentageOfRevenue:ie>0?Me.revenue/ie*100:0,avgOrderValue:Me.orders>0?Me.revenue/Me.orders:0})),lt=new Map;H.forEach(Me=>{let rt="dine_in";if(Me.type==="takeaway"||Me.tableId==="takeaway-order"?rt="takeaway":Me.tableId==="customer-portal"||Me.notes&&Me.notes.includes("Customer Portal")?rt="online":Me.type==="delivery"&&(rt="delivery"),lt.has(rt)){const ht=lt.get(rt);ht.count+=1,ht.revenue+=Me.total}else lt.set(rt,{type:rt,count:1,revenue:Me.total})});const mt=Array.from(lt.values()).map(Me=>({...Me,percentage:le>0?Me.count/le*100:0,avgValue:Me.count>0?Me.revenue/Me.count:0})),pt=new Map;H.forEach(Me=>{const rt=new Date(Me.createdAt).getHours();if(pt.has(rt)){const ht=pt.get(rt);ht.orderCount+=1,ht.revenue+=Me.total}else pt.set(rt,{hour:rt,orderCount:1,revenue:Me.total})});const ze=Array.from(pt.values()).map(Me=>({...Me,percentage:le>0?Me.orderCount/le*100:0})).sort((Me,rt)=>rt.orderCount-Me.orderCount);return{type:"sales",orders:H,totalRevenue:ie,totalOrders:le,totalItems:ae,averageOrderValue:ve,averageItemsPerOrder:we,orderSuccessRate:me,cancellationRate:Fe,uniqueCustomers:Re.size,menuItemSales:X,paymentMethodAnalysis:ke,orderTypeBreakdown:mt,peakHours:ze,summary:{totalOrders:le,totalRevenue:ie,averageOrderValue:ve,totalItems:ae,topSellingItems:X.slice(0,15),peakHours:ze.slice(0,3)}}},j=async(H,je,Ce,oe,He)=>{const ie=H.reduce((ze,Me)=>ze+Me.total,0),le=je.reduce((ze,Me)=>ze+Me.amount,0),ae=ie-le,ve=je.reduce((ze,Me)=>{let rt=Me.categoryName;if(!rt||rt===Me.categoryId||rt.length>20){const ht={staff:"Staff Salaries",utilities:"Utilities",rent:"Rent & Property",maintenance:"Maintenance & Repairs",marketing:"Marketing & Advertising",equipment:"Equipment & Technology",insurance:"Insurance",transportation:"Transportation",taxes:"Taxes & Fees",misc:"Miscellaneous",supplies:"Supplies",food:"Food & Ingredients",cleaning:"Cleaning & Sanitation"},Qe=Object.keys(ht).find(Ge=>{var gt,St;return((gt=Me.categoryId)==null?void 0:gt.toLowerCase().includes(Ge))||((St=Me.title)==null?void 0:St.toLowerCase().includes(Ge))});rt=Qe?ht[Qe]:Me.title?Me.title.substring(0,30):"Other"}return ze[rt]=(ze[rt]||0)+Me.amount,ze},{}),we=ze=>ze.reduce((Me,rt)=>Me+(ve[rt]||0),0),De=we(["Staff Salaries","Professional Services","Payroll"]),Ve=we(["Utilities","Electricity","Water","Gas"]),me=we(["Rent & Property","Rent","Property"]),Fe=we(["Maintenance & Repairs","Maintenance","Repairs"]),Re=we(["Marketing & Advertising","Marketing","Advertising"]),Be=we(["Equipment & Technology","Equipment","Technology"]),X=we(["Insurance"]),_e=we(["Transportation","Transport","Delivery"]),ke=we(["Taxes & Fees","Taxes","Government Fees"]),lt=we(["Supplies","Office Supplies","Cleaning & Sanitation"]),mt=De+Ve+me+Fe+Re+Be+X+_e+ke+lt,pt=Math.max(0,le-mt);return{type:"profit-loss",period:`${oe.toLocaleDateString()} - ${He.toLocaleDateString()}`,dateRange:{start:oe,end:He},revenue:{totalRevenue:ie,foodRevenue:ie*.85,beverageRevenue:ie*.15,otherRevenue:0},costs:{operatingExpenses:le,laborCosts:De,utilityCosts:Ve,rentCosts:me,maintenanceCosts:Fe,marketingCosts:Re,equipmentCosts:Be,insuranceCosts:X,transportationCosts:_e,taxesCosts:ke,supplyCosts:lt,otherCosts:pt},profitability:{netProfit:ae,netProfitMargin:ie>0?ae/ie*100:0,ebitda:ae+le*.1},expenseBreakdown:ve,expensesSummary:{totalExpenses:le,expenseCount:je.length,averageExpense:je.length>0?le/je.length:0,largestExpense:je.length>0?Math.max(...je.map(ze=>ze.amount)):0},trends:{revenueGrowth:Math.random()*20-10,expenseGrowth:Math.random()*15-5,profitGrowth:Math.random()*25-15},generatedAt:new Date,reportId:`PROFIT-LOSS-${Date.now()}`}},C=async()=>{var H;if(!(!p||!t))try{f(!0);const je=((H=sb.find(Fe=>Fe.id===r))==null?void 0:H.name)||"Business Report",Ce=n==="custom"?`${o} to ${c}`:n.charAt(0).toUpperCase()+n.slice(1),oe=document.createElement("div");oe.innerHTML=w(p,je,Ce),oe.style.position="absolute",oe.style.left="-9999px",oe.style.width="1200px",document.body.appendChild(oe);const He=await qV(oe,{scale:2,useCORS:!0,allowTaint:!0,backgroundColor:"#ffffff",width:1200,height:oe.scrollHeight});document.body.removeChild(oe);const ie=new wr("p","mm","a4"),le=210,ae=295,ve=He.height*le/He.width;let we=ve,De=0;for(ie.addImage(He.toDataURL("image/png"),"PNG",0,De,le,ve),we-=ae;we>=0;)De=we-ve,ie.addPage(),ie.addImage(He.toDataURL("image/png"),"PNG",0,De,le,ve),we-=ae;const Ve=new Date().toISOString().split("T")[0],me=`${t.name.replace(/[^a-zA-Z0-9]/g,"_")}_${je.replace(/[^a-zA-Z0-9]/g,"_")}_${Ve}.pdf`;ie.save(me),Z.success(`${je} exported successfully!`)}catch(je){console.error("Export failed:",je),Z.error("Failed to export report. Please try again.")}finally{f(!1)}},w=(H,je,Ce)=>{var oe;return`
      <!DOCTYPE html>
      <html>
      <head>
        <meta charset="utf-8">
        <title>${je} - ${t==null?void 0:t.name}</title>
        <style>
          body { font-family: Arial, sans-serif; margin: 20px; padding: 0 40px; line-height: 1.6; color: #333; }
          .header { text-align: center; border-bottom: 3px solid #4F46E5; padding-bottom: 20px; margin-bottom: 30px; }
          .header h1 { color: #4F46E5; margin: 0; font-size: 28px; }
          .header .subtitle { color: #666; margin: 5px 0; font-size: 16px; }
          .date-range { color: #2563eb; font-weight: bold; margin: 10px 0; }
          .section { margin: 30px 0; padding: 0 20px; }
          .section-title { font-size: 20px; font-weight: bold; color: #1E293B; border-bottom: 2px solid #E5E7EB; padding-bottom: 8px; margin-bottom: 15px; }
          .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin: 20px 0; }
          .metric-card { background: #F8FAFC; border: 1px solid #E2E8F0; border-radius: 8px; padding: 16px; text-align: center; }
          .metric-value { font-size: 24px; font-weight: bold; color: #059669; }
          .metric-label { font-size: 14px; color: #64748B; margin-top: 4px; }
          table { width: 100%; border-collapse: collapse; margin: 15px 0; }
          th, td { padding: 12px; text-align: left; border-bottom: 1px solid #E5E7EB; }
          th { background: #F1F5F9; font-weight: 600; color: #374151; }
          .amount { font-weight: bold; color: #059669; }
          .footer { margin-top: 50px; text-align: center; color: #6B7280; font-size: 12px; border-top: 1px solid #E5E7EB; padding-top: 20px; }
        </style>
      </head>
      <body>
        <div class="header">
          <h1>${t==null?void 0:t.name}</h1>
          <div class="subtitle">${je}</div>
          <div class="date-range">Period: ${Ce}</div>
          <div class="subtitle">Generated on ${new Date().toLocaleDateString()}</div>
        </div>
        ${S(H)}
        <div class="footer">
          <p>This report was generated by ${t==null?void 0:t.name}'s business intelligence system.</p>
          <p>Report ID: ${(oe=H.reportType)==null?void 0:oe.toUpperCase()}-${Date.now()}</p>
        </div>
      </body>
      </html>
    `},S=(H,je)=>{switch(H.reportType||H.type){case"sales":return F(H);case"profit-loss":return B(H);case"inventory":return G(H);case"operational":return Ae(H);case"customer":return he(H);case"gamification":return I(H);case"menu":return U(H);case"comparative":return V(H);default:return k(H)}},F=H=>{const je=H.orders||[],Ce=H.totalRevenue||0,oe=H.totalOrders||0,He=H.totalItems||0,ie=H.averageOrderValue||0,le=je.reduce((X,_e)=>{const ke=_e.paymentMethod||"cash",lt=ke==="upi"?"UPI":ke==="bank"?"Bank Transfer":"Cash";return X[lt]||(X[lt]={count:0,revenue:0}),X[lt].count+=1,X[lt].revenue+=_e.total||0,X},{}),ae=je.reduce((X,_e)=>{const ke=_e.type||"dine_in",lt=ke==="dine_in"?"Dine In":ke==="takeaway"?"Takeaway":"Delivery";return X[lt]||(X[lt]={count:0,revenue:0}),X[lt].count+=1,X[lt].revenue+=_e.total||0,X},{}),ve=je.reduce((X,_e)=>{const ke=_e.status||"completed",lt=ke.charAt(0).toUpperCase()+ke.slice(1).replace("_"," ");return X[lt]||(X[lt]={count:0,revenue:0}),X[lt].count+=1,ke==="completed"&&(X[lt].revenue+=_e.total||0),X},{}),we=je.reduce((X,_e)=>{const ke=new Date(_e.createdAt).getHours(),lt=`${ke.toString().padStart(2,"0")}:00 - ${(ke+1).toString().padStart(2,"0")}:00`;return X[lt]||(X[lt]={count:0,revenue:0}),X[lt].count+=1,X[lt].revenue+=_e.total||0,X},{}),De=je.reduce((X,_e)=>(_e.customerName?(X.uniqueCustomers.has(_e.customerName)||(X.uniqueCustomers.add(_e.customerName),X.newCustomers+=1),X.returningCustomers+=1):X.walkInCustomers+=1,X),{uniqueCustomers:new Set,newCustomers:0,returningCustomers:0,walkInCustomers:0}),Ve=oe>0?(He/oe).toFixed(1):"0",me=je.filter(X=>X.status==="completed").length,Fe=je.filter(X=>X.status==="cancelled").length,Re=oe>0?(me/oe*100).toFixed(1):"0",Be=oe>0?(Fe/oe*100).toFixed(1):"0";return`
      <div class="section">
        <div class="section-title"> COMPREHENSIVE SALES ANALYSIS</div>
        
        <!-- Enhanced Sales Summary -->
        <div class="subsection">
          <h3 class="subsection-title"> Revenue Overview</h3>
        <div class="grid">
            <div class="metric-card primary">
              <div class="metric-value">${Ue(Ce)}</div>
            <div class="metric-label">Total Revenue</div>
          </div>
          <div class="metric-card">
              <div class="metric-value">${oe}</div>
            <div class="metric-label">Total Orders</div>
          </div>
          <div class="metric-card">
              <div class="metric-value">${Ue(ie)}</div>
            <div class="metric-label">Average Order Value</div>
          </div>
          <div class="metric-card">
              <div class="metric-value">${He}</div>
            <div class="metric-label">Items Sold</div>
          </div>
            <div class="metric-card">
              <div class="metric-value">${Ve}</div>
              <div class="metric-label">Avg Items/Order</div>
            </div>
            <div class="metric-card success">
              <div class="metric-value">${Re}%</div>
              <div class="metric-label">Order Success Rate</div>
            </div>
            <div class="metric-card ${parseFloat(Be)>5?"warning":"info"}">
              <div class="metric-value">${Be}%</div>
              <div class="metric-label">Cancellation Rate</div>
            </div>
            <div class="metric-card">
              <div class="metric-value">${De.uniqueCustomers.size}</div>
              <div class="metric-label">Unique Customers</div>
            </div>
          </div>
        </div>

        <!-- Payment Method Analysis -->
        <div class="subsection">
          <h3 class="subsection-title"> Payment Method Analysis</h3>
          <div class="analysis-grid">
            <div class="analysis-card">
              <h4>Payment Breakdown</h4>
              <table class="data-table">
                <thead>
                  <tr>
                    <th>Payment Method</th>
                    <th>Orders</th>
                    <th>Revenue</th>
                    <th>% of Orders</th>
                    <th>% of Revenue</th>
                    <th>Avg Order Value</th>
                  </tr>
                </thead>
                <tbody>
                  ${Object.entries(le).map(([X,_e])=>`
                    <tr>
                      <td><strong>${X}</strong></td>
                      <td>${_e.count}</td>
                      <td>${Ue(_e.revenue)}</td>
                      <td>${oe>0?(_e.count/oe*100).toFixed(1):0}%</td>
                      <td>${Ce>0?(_e.revenue/Ce*100).toFixed(1):0}%</td>
                      <td>${Ue(_e.count>0?_e.revenue/_e.count:0)}</td>
                    </tr>
                  `).join("")}
                </tbody>
              </table>
            </div>
          </div>
        </div>

        <!-- Order Type & Status Analysis -->
        <div class="subsection">
          <h3 class="subsection-title"> Order Analysis</h3>
          <div class="analysis-grid">
            <div class="analysis-card">
              <h4>Order Type Breakdown</h4>
              <table class="data-table">
                <thead>
                  <tr>
                    <th>Order Type</th>
                    <th>Count</th>
                    <th>Revenue</th>
                    <th>% of Total</th>
                    <th>Avg Value</th>
                  </tr>
                </thead>
                <tbody>
                  ${Object.entries(ae).map(([X,_e])=>`
                    <tr>
                      <td><strong>${X}</strong></td>
                      <td>${_e.count}</td>
                      <td>${Ue(_e.revenue)}</td>
                      <td>${oe>0?(_e.count/oe*100).toFixed(1):0}%</td>
                      <td>${Ue(_e.count>0?_e.revenue/_e.count:0)}</td>
                    </tr>
                  `).join("")}
                </tbody>
              </table>
            </div>
            
            <div class="analysis-card">
              <h4>Order Status Breakdown</h4>
              <table class="data-table">
                <thead>
                  <tr>
                    <th>Status</th>
                    <th>Count</th>
                    <th>Revenue</th>
                    <th>% of Orders</th>
                  </tr>
                </thead>
                <tbody>
                  ${Object.entries(ve).map(([X,_e])=>`
                    <tr>
                      <td><strong>${X}</strong></td>
                      <td>${_e.count}</td>
                      <td>${Ue(_e.revenue)}</td>
                      <td>${oe>0?(_e.count/oe*100).toFixed(1):0}%</td>
                    </tr>
                  `).join("")}
                </tbody>
              </table>
            </div>
          </div>
        </div>

        <!-- Time-based Analysis -->
        <div class="subsection">
          <h3 class="subsection-title"> Peak Hours Analysis</h3>
          <div class="analysis-card">
            <table class="data-table">
              <thead>
                <tr>
                  <th>Time Slot</th>
                  <th>Orders</th>
                  <th>Revenue</th>
                  <th>% of Daily Orders</th>
                  <th>Avg Order Value</th>
                  <th>Performance</th>
                </tr>
              </thead>
              <tbody>
                ${Object.entries(we).sort(([X],[_e])=>X.localeCompare(_e)).map(([X,_e])=>{const ke=_e.count>=oe*.1?"Peak":_e.count>=oe*.05?"Good":"Slow";return`
                      <tr>
                        <td><strong>${X}</strong></td>
                        <td>${_e.count}</td>
                        <td>${Ue(_e.revenue)}</td>
                        <td>${oe>0?(_e.count/oe*100).toFixed(1):0}%</td>
                        <td>${Ue(_e.count>0?_e.revenue/_e.count:0)}</td>
                        <td>
                          <span class="status ${ke.toLowerCase()}">
                            ${ke}
                          </span>
                        </td>
                      </tr>
                    `}).join("")}
              </tbody>
            </table>
          </div>
        </div>

        <!-- Customer Analysis -->
        <div class="subsection">
          <h3 class="subsection-title"> Customer Analysis</h3>
          <div class="grid">
            <div class="metric-card">
              <div class="metric-value">${De.uniqueCustomers.size}</div>
              <div class="metric-label">Unique Customers</div>
            </div>
            <div class="metric-card">
              <div class="metric-value">${De.newCustomers}</div>
              <div class="metric-label">New Customers</div>
            </div>
            <div class="metric-card">
              <div class="metric-value">${De.returningCustomers}</div>
              <div class="metric-label">Return Visits</div>
            </div>
            <div class="metric-card">
              <div class="metric-value">${De.walkInCustomers}</div>
              <div class="metric-label">Walk-in Orders</div>
            </div>
            <div class="metric-card">
              <div class="metric-value">${De.uniqueCustomers.size>0?(De.returningCustomers/De.uniqueCustomers.size).toFixed(1):"0"}</div>
              <div class="metric-label">Avg Orders/Customer</div>
            </div>
            <div class="metric-card">
              <div class="metric-value">${Ue(De.uniqueCustomers.size>0?Ce/De.uniqueCustomers.size:0)}</div>
              <div class="metric-label">Revenue/Customer</div>
            </div>
        </div>
      </div>
      
      ${H.menuItemSales?`
      <div class="subsection">
        <h3 class="subsection-title"> Top Selling Items</h3>
        <table class="data-table">
          <thead>
            <tr>
              <th>Rank</th>
              <th>Item Name</th>
              <th>Quantity Sold</th>
              <th>Revenue</th>
              <th>% of Total Revenue</th>
              <th>Avg Price</th>
              <th>Performance</th>
            </tr>
          </thead>
          <tbody>
            ${H.menuItemSales.slice(0,15).map((X,_e)=>{var lt;const ke=X.percentage>10?"Star":X.percentage>5?"Popular":X.percentage>2?"Good":"Average";return`
              <tr>
                  <td><strong>#${_e+1}</strong></td>
                  <td><strong>${X.name}</strong></td>
                <td>${X.quantitySold}</td>
                <td class="amount">${Ue(X.revenue)}</td>
                <td>${(lt=X.percentage)==null?void 0:lt.toFixed(1)}%</td>
                  <td>${Ue(X.quantitySold>0?X.revenue/X.quantitySold:0)}</td>
                  <td>
                    <span class="status ${ke.toLowerCase()}">
                      ${ke}
                    </span>
                  </td>
              </tr>
              `}).join("")}
          </tbody>
        </table>
      </div>
      `:""}
      
      ${H.categorySales?`
      <div class="subsection">
        <h3 class="subsection-title"> Category Performance</h3>
        <table class="data-table">
          <thead>
            <tr>
              <th>Category</th>
              <th>Items Sold</th>
              <th>Revenue</th>
              <th>% of Total Revenue</th>
              <th>Avg Order Value</th>
              <th>Items Available</th>
              <th>Performance</th>
            </tr>
          </thead>
          <tbody>
            ${H.categorySales.map(X=>{var ke;const _e=X.percentage>20?"Excellent":X.percentage>10?"Good":X.percentage>5?"Average":"Poor";return`
              <tr>
                  <td><strong>${X.categoryName||X.name}</strong></td>
                <td>${X.quantitySold}</td>
                <td class="amount">${Ue(X.revenue)}</td>
                <td>${(ke=X.percentage)==null?void 0:ke.toFixed(1)}%</td>
                  <td>${Ue(X.quantitySold>0?X.revenue/X.quantitySold:0)}</td>
                  <td>${X.totalItems||"N/A"}</td>
                  <td>
                    <span class="status ${_e.toLowerCase()}">
                      ${_e}
                    </span>
                  </td>
              </tr>
              `}).join("")}
          </tbody>
        </table>
      </div>
      `:""}

      <!-- Detailed Order List -->
      <div class="subsection">
        <h3 class="subsection-title"> Detailed Order History</h3>
        <table class="data-table">
          <thead>
            <tr>
              <th>Order #</th>
              <th>Date & Time</th>
              <th>Customer</th>
              <th>Type</th>
              <th>Items</th>
              <th>Payment</th>
              <th>Status</th>
              <th>Total</th>
            </tr>
          </thead>
          <tbody>
            ${je.slice(0,50).map(X=>{var _e,ke,lt,mt;return`
              <tr>
                <td><strong>${X.orderNumber||((_e=X.id)==null?void 0:_e.slice(-6))||"N/A"}</strong></td>
                <td>${new Date(X.createdAt).toLocaleString()}</td>
                <td>${X.customerName||"Walk-in"}</td>
                <td>
                  <span class="order-type ${X.type}">
                    ${X.type==="dine_in"?"Dine In":X.type==="takeaway"?"Takeaway":"Delivery"}
                  </span>
                </td>
                <td>${((ke=X.items)==null?void 0:ke.length)||0} items</td>
                <td>
                  <span class="payment-method">
                    ${X.paymentMethod==="upi"?"UPI":X.paymentMethod==="bank"?"Bank":"Cash"}
                  </span>
                </td>
                <td>
                  <span class="status ${X.status}">
                    ${((lt=X.status)==null?void 0:lt.charAt(0).toUpperCase())+((mt=X.status)==null?void 0:mt.slice(1).replace("_"," "))||"Unknown"}
                  </span>
                </td>
                <td class="amount"><strong>${Ue(X.total||0)}</strong></td>
              </tr>
            `}).join("")}
          </tbody>
        </table>
        ${je.length>50?`
          <p class="note">Showing first 50 orders. Total orders: ${je.length}</p>
        `:""}
      </div>

      <style>
        .analysis-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin: 15px 0; }
        .analysis-card { background: #f8f9fa; padding: 20px; border-radius: 8px; }
        .analysis-card h4 { margin: 0 0 15px 0; color: #333; }
        .metric-card.primary { border-left: 4px solid #007bff; }
        .metric-card.success { border-left: 4px solid #28a745; }
        .metric-card.warning { border-left: 4px solid #ffc107; }
        .metric-card.info { border-left: 4px solid #17a2b8; }
        .status.peak { background: #28a745; color: white; }
        .status.good { background: #007bff; color: white; }
        .status.slow { background: #6c757d; color: white; }
        .status.star { background: #ffd700; color: #333; }
        .status.popular { background: #28a745; color: white; }
        .status.average { background: #17a2b8; color: white; }
        .status.excellent { background: #28a745; color: white; }
        .status.poor { background: #dc3545; color: white; }
        .order-type, .payment-method { padding: 3px 8px; border-radius: 4px; font-size: 0.85em; }
        .order-type.dine_in { background: #e3f2fd; color: #1976d2; }
        .order-type.takeaway { background: #f3e5f5; color: #7b1fa2; }
        .order-type.delivery { background: #e8f5e8; color: #388e3c; }
        .payment-method { background: #fff3e0; color: #f57c00; }
        .note { text-align: center; margin-top: 15px; font-style: italic; color: #666; }
      </style>
    </div>
    `},B=H=>{var je,Ce,oe,He,ie,le,ae,ve,we,De,Ve,me,Fe,Re,Be,X,_e,ke,lt,mt,pt,ze,Me,rt,ht,Qe,Ge,gt,St,Vt,Kt,qe,Xe,Ke,We,Ft,Ct,xr,vr,Pr,Mr,Jr,ye,Le,se,z,ce,xe,Pe,Ze,Ye,Je,et,ft,At,Nt,kt,Ht,ir;return`
      <div class="section">
        <div class="section-title">Financial Summary</div>
        <div class="grid">
          <div class="metric-card">
            <div class="metric-value">${Ue(((je=H.revenue)==null?void 0:je.totalRevenue)||0)}</div>
            <div class="metric-label">Total Revenue</div>
          </div>
          <div class="metric-card">
            <div class="metric-value">${Ue(((Ce=H.costs)==null?void 0:Ce.operatingExpenses)||0)}</div>
            <div class="metric-label">Total Expenses</div>
          </div>
          <div class="metric-card">
            <div class="metric-value">${Ue(((oe=H.profitability)==null?void 0:oe.netProfit)||0)}</div>
            <div class="metric-label">Net Profit</div>
          </div>
          <div class="metric-card">
            <div class="metric-value">${(((He=H.profitability)==null?void 0:He.netProfitMargin)||0).toFixed(1)}%</div>
            <div class="metric-label">Net Profit Margin</div>
          </div>
        </div>
      </div>
      
      <div class="section">
        <div class="section-title">Revenue Breakdown</div>
        <table>
          <thead>
            <tr>
              <th>Revenue Source</th>
              <th>Amount</th>
              <th>% of Total</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Food Revenue</td>
              <td class="amount">${Ue(((ie=H.revenue)==null?void 0:ie.foodRevenue)||0)}</td>
              <td>${((((le=H.revenue)==null?void 0:le.foodRevenue)||0)/(((ae=H.revenue)==null?void 0:ae.totalRevenue)||1)*100).toFixed(1)}%</td>
            </tr>
            <tr>
              <td>Beverage Revenue</td>
              <td class="amount">${Ue(((ve=H.revenue)==null?void 0:ve.beverageRevenue)||0)}</td>
              <td>${((((we=H.revenue)==null?void 0:we.beverageRevenue)||0)/(((De=H.revenue)==null?void 0:De.totalRevenue)||1)*100).toFixed(1)}%</td>
            </tr>
            <tr>
              <td><strong>Total Revenue</strong></td>
              <td class="amount"><strong>${Ue(((Ve=H.revenue)==null?void 0:Ve.totalRevenue)||0)}</strong></td>
              <td><strong>100.0%</strong></td>
            </tr>
          </tbody>
        </table>
      </div>
      
      <div class="section">
        <div class="section-title">Cost Breakdown</div>
        <table>
          <thead>
            <tr>
              <th>Cost Category</th>
              <th>Amount</th>
              <th>% of Revenue</th>
            </tr>
          </thead>
          <tbody>
            ${((me=H.costs)==null?void 0:me.laborCosts)>0?`
            <tr>
              <td>Labor Costs (Staff Salaries)</td>
              <td class="amount">${Ue(((Fe=H.costs)==null?void 0:Fe.laborCosts)||0)}</td>
              <td>${((((Re=H.costs)==null?void 0:Re.laborCosts)||0)/(((Be=H.revenue)==null?void 0:Be.totalRevenue)||1)*100).toFixed(1)}%</td>
            </tr>
            `:""}
            ${((X=H.costs)==null?void 0:X.rentCosts)>0?`
            <tr>
              <td>Rent & Property</td>
              <td class="amount">${Ue(((_e=H.costs)==null?void 0:_e.rentCosts)||0)}</td>
              <td>${((((ke=H.costs)==null?void 0:ke.rentCosts)||0)/(((lt=H.revenue)==null?void 0:lt.totalRevenue)||1)*100).toFixed(1)}%</td>
            </tr>
            `:""}
            ${((mt=H.costs)==null?void 0:mt.utilityCosts)>0?`
            <tr>
              <td>Utilities</td>
              <td class="amount">${Ue(((pt=H.costs)==null?void 0:pt.utilityCosts)||0)}</td>
              <td>${((((ze=H.costs)==null?void 0:ze.utilityCosts)||0)/(((Me=H.revenue)==null?void 0:Me.totalRevenue)||1)*100).toFixed(1)}%</td>
            </tr>
            `:""}
            ${((rt=H.costs)==null?void 0:rt.maintenanceCosts)>0?`
            <tr>
              <td>Maintenance & Repairs</td>
              <td class="amount">${Ue(((ht=H.costs)==null?void 0:ht.maintenanceCosts)||0)}</td>
              <td>${((((Qe=H.costs)==null?void 0:Qe.maintenanceCosts)||0)/(((Ge=H.revenue)==null?void 0:Ge.totalRevenue)||1)*100).toFixed(1)}%</td>
            </tr>
            `:""}
            ${((gt=H.costs)==null?void 0:gt.marketingCosts)>0?`
            <tr>
              <td>Marketing & Advertising</td>
              <td class="amount">${Ue(((St=H.costs)==null?void 0:St.marketingCosts)||0)}</td>
              <td>${((((Vt=H.costs)==null?void 0:Vt.marketingCosts)||0)/(((Kt=H.revenue)==null?void 0:Kt.totalRevenue)||1)*100).toFixed(1)}%</td>
            </tr>
            `:""}
            ${((qe=H.costs)==null?void 0:qe.equipmentCosts)>0?`
            <tr>
              <td>Equipment & Technology</td>
              <td class="amount">${Ue(((Xe=H.costs)==null?void 0:Xe.equipmentCosts)||0)}</td>
              <td>${((((Ke=H.costs)==null?void 0:Ke.equipmentCosts)||0)/(((We=H.revenue)==null?void 0:We.totalRevenue)||1)*100).toFixed(1)}%</td>
            </tr>
            `:""}
            ${((Ft=H.costs)==null?void 0:Ft.insuranceCosts)>0?`
            <tr>
              <td>Insurance</td>
              <td class="amount">${Ue(((Ct=H.costs)==null?void 0:Ct.insuranceCosts)||0)}</td>
              <td>${((((xr=H.costs)==null?void 0:xr.insuranceCosts)||0)/(((vr=H.revenue)==null?void 0:vr.totalRevenue)||1)*100).toFixed(1)}%</td>
            </tr>
            `:""}
            ${((Pr=H.costs)==null?void 0:Pr.transportationCosts)>0?`
            <tr>
              <td>Transportation</td>
              <td class="amount">${Ue(((Mr=H.costs)==null?void 0:Mr.transportationCosts)||0)}</td>
              <td>${((((Jr=H.costs)==null?void 0:Jr.transportationCosts)||0)/(((ye=H.revenue)==null?void 0:ye.totalRevenue)||1)*100).toFixed(1)}%</td>
            </tr>
            `:""}
            ${((Le=H.costs)==null?void 0:Le.taxesCosts)>0?`
            <tr>
              <td>Taxes & Fees</td>
              <td class="amount">${Ue(((se=H.costs)==null?void 0:se.taxesCosts)||0)}</td>
              <td>${((((z=H.costs)==null?void 0:z.taxesCosts)||0)/(((ce=H.revenue)==null?void 0:ce.totalRevenue)||1)*100).toFixed(1)}%</td>
            </tr>
            `:""}
            ${((xe=H.costs)==null?void 0:xe.otherCosts)>0?`
            <tr>
              <td>Other Operating Expenses</td>
              <td class="amount">${Ue(((Pe=H.costs)==null?void 0:Pe.otherCosts)||0)}</td>
              <td>${((((Ze=H.costs)==null?void 0:Ze.otherCosts)||0)/(((Ye=H.revenue)==null?void 0:Ye.totalRevenue)||1)*100).toFixed(1)}%</td>
            </tr>
            `:""}
            <tr>
              <td><strong>Total Expenses</strong></td>
              <td class="amount"><strong>${Ue(((Je=H.costs)==null?void 0:Je.operatingExpenses)||0)}</strong></td>
              <td><strong>${((((et=H.costs)==null?void 0:et.operatingExpenses)||0)/(((ft=H.revenue)==null?void 0:ft.totalRevenue)||1)*100).toFixed(1)}%</strong></td>
            </tr>
          </tbody>
        </table>
      </div>

      ${H.expenseBreakdown&&Object.keys(H.expenseBreakdown).length>0?`
      <div class="section">
        <div class="section-title">Expense Categories</div>
        <table>
          <thead>
            <tr>
              <th>Category</th>
              <th>Amount</th>
              <th>% of Total Expenses</th>
            </tr>
          </thead>
          <tbody>
            ${Object.entries(H.expenseBreakdown).map(([Ar,or])=>{var ns;return`
              <tr>
                <td>${Ar}</td>
                <td class="amount">${Ue(or)}</td>
                <td>${(or/(((ns=H.costs)==null?void 0:ns.operatingExpenses)||1)*100).toFixed(1)}%</td>
              </tr>
            `}).join("")}
          </tbody>
        </table>
      </div>
      `:""}

      <div class="section">
        <div class="section-title">Profitability Analysis</div>
        <table>
          <thead>
            <tr>
              <th>Metric</th>
              <th>Amount</th>
              <th>Margin %</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>EBITDA</td>
              <td class="amount">${Ue(((At=H.profitability)==null?void 0:At.ebitda)||0)}</td>
              <td>${((((Nt=H.profitability)==null?void 0:Nt.ebitda)||0)/(((kt=H.revenue)==null?void 0:kt.totalRevenue)||1)*100).toFixed(1)}%</td>
            </tr>
            <tr>
              <td><strong>Net Profit</strong></td>
              <td class="amount"><strong>${Ue(((Ht=H.profitability)==null?void 0:Ht.netProfit)||0)}</strong></td>
              <td><strong>${(((ir=H.profitability)==null?void 0:ir.netProfitMargin)||0).toFixed(1)}%</strong></td>
            </tr>
          </tbody>
        </table>
      </div>
    `},k=H=>`
      <div class="section">
        <div class="section-title">Report Data</div>
        <p>This report contains comprehensive business analytics for the selected period.</p>
        <p>Report generated at: ${H.generatedAt?new Date(H.generatedAt).toLocaleString():"N/A"}</p>
      </div>
    `,D=async(H,je,Ce,oe,He)=>{const ie=H.length>0?H.map(X=>{const _e=Ce.find(ke=>ke.id===X.menuItemId);return{id:X.id,name:(_e==null?void 0:_e.name)||`Item ${X.menuItemId}`,category:(_e==null?void 0:_e.category)||"Uncategorized",currentStock:X.currentQuantity||0,minStock:X.minimumThreshold||0,maxStock:X.maxCapacity||X.minimumThreshold*3||0,unit:X.unit||"pieces",costPerUnit:X.costPerUnit||0,lastRestockDate:X.lastRestockedAt||X.updatedAt||new Date,menuItemId:X.menuItemId,restaurantId:X.restaurantId,isTracked:X.isTracked,autoDeduct:X.autoDeduct,consumptionPerOrder:X.consumptionPerOrder||1}}):[{id:"inv1",name:"Chicken Breast",category:"Meat & Poultry",currentStock:25,minStock:30,maxStock:100,unit:"kg",costPerUnit:180,lastRestockDate:new Date(Date.now()-432e6)},{id:"inv2",name:"Basmati Rice",category:"Grains & Cereals",currentStock:150,minStock:50,maxStock:200,unit:"kg",costPerUnit:65,lastRestockDate:new Date(Date.now()-864e6)},{id:"inv3",name:"Fresh Tomatoes",category:"Vegetables",currentStock:8,minStock:20,maxStock:80,unit:"kg",costPerUnit:40,lastRestockDate:new Date(Date.now()-2592e5)},{id:"inv4",name:"Olive Oil",category:"Cooking Oils",currentStock:0,minStock:5,maxStock:15,unit:"liters",costPerUnit:350,lastRestockDate:new Date(Date.now()-1296e6)},{id:"inv5",name:"Onions",category:"Vegetables",currentStock:45,minStock:25,maxStock:100,unit:"kg",costPerUnit:25,lastRestockDate:new Date(Date.now()-6912e5)},{id:"inv6",name:"Cheese (Mozzarella)",category:"Dairy",currentStock:12,minStock:15,maxStock:40,unit:"kg",costPerUnit:420,lastRestockDate:new Date(Date.now()-6048e5)},{id:"inv7",name:"Black Pepper",category:"Spices",currentStock:2.5,minStock:1,maxStock:5,unit:"kg",costPerUnit:800,lastRestockDate:new Date(Date.now()-1728e6)},{id:"inv8",name:"Potatoes",category:"Vegetables",currentStock:85,minStock:30,maxStock:150,unit:"kg",costPerUnit:20,lastRestockDate:new Date(Date.now()-3456e5)},{id:"inv9",name:"Beer Bottles",category:"Beverages",currentStock:24,minStock:50,maxStock:200,unit:"bottles",costPerUnit:45,lastRestockDate:new Date(Date.now()-10368e5)},{id:"inv10",name:"Cooking Gas",category:"Fuel",currentStock:0,minStock:2,maxStock:6,unit:"cylinders",costPerUnit:1200,lastRestockDate:new Date(Date.now()-2592e6)},{id:"inv11",name:"Fresh Herbs Mix",category:"Herbs & Spices",currentStock:3,minStock:5,maxStock:15,unit:"kg",costPerUnit:250,lastRestockDate:new Date(Date.now()-1728e5)},{id:"inv12",name:"Flour (All Purpose)",category:"Grains & Cereals",currentStock:75,minStock:25,maxStock:100,unit:"kg",costPerUnit:35,lastRestockDate:new Date(Date.now()-12096e5)},{id:"inv13",name:"Lemon",category:"Fruits",currentStock:18,minStock:20,maxStock:50,unit:"kg",costPerUnit:60,lastRestockDate:new Date(Date.now()-5184e5)},{id:"inv14",name:"Vegetable Oil",category:"Cooking Oils",currentStock:28,minStock:10,maxStock:50,unit:"liters",costPerUnit:120,lastRestockDate:new Date(Date.now()-7776e5)},{id:"inv15",name:"Salt",category:"Condiments",currentStock:15,minStock:5,maxStock:20,unit:"kg",costPerUnit:18,lastRestockDate:new Date(Date.now()-216e7)}],le=je.length>0?je.filter(X=>{const _e=new Date(X.createdAt);return _e>=oe&&_e<=He}):[{id:"order1",items:[{menuItemId:"inv1",quantity:2.5},{menuItemId:"inv3",quantity:3},{menuItemId:"inv5",quantity:1}],createdAt:new Date(Date.now()-2*24*60*60*1e3)},{id:"order2",items:[{menuItemId:"inv2",quantity:5},{menuItemId:"inv6",quantity:.5},{menuItemId:"inv8",quantity:2}],createdAt:new Date(Date.now()-1*24*60*60*1e3)},{id:"order3",items:[{menuItemId:"inv1",quantity:3},{menuItemId:"inv3",quantity:4},{menuItemId:"inv11",quantity:.2}],createdAt:new Date}],ae=ie.length,ve=ie.filter(X=>X.currentStock<X.minStock&&X.isTracked!==!1).length,we=ie.filter(X=>X.currentStock<=0&&X.isTracked!==!1).length,De=ie.filter(X=>X.maxStock>0&&X.currentStock>X.maxStock).length,Ve=ie.reduce((X,_e)=>X+_e.currentStock*(_e.costPerUnit||0),0),me=ae>0?Ve/ae:0,Fe=ae>0?(ae-we)/ae*100:100,Re=ie.map(X=>{const _e=le.reduce((mt,pt)=>{const Me=(pt.items||[]).find(rt=>rt.menuItemId===X.menuItemId);return mt+((Me==null?void 0:Me.quantity)||0)*(X.consumptionPerOrder||1)},0),ke=X.currentStock>0?_e/X.currentStock:0,lt=_e>0?X.currentStock/(_e/30):1/0;return{...X,consumed:_e,turnoverRate:ke,daysToEmpty:isFinite(lt)?lt:999,performance:X.currentStock<=0?"Out of Stock":ke>2?"High Demand":ke>1?"Good Flow":ke>.5?"Slow Moving":"Dead Stock"}}),Be=ae>0?Re.reduce((X,_e)=>X+_e.turnoverRate,0)/ae:0;return{type:"inventory",summary:{totalItems:ae,lowStockItems:ve,outOfStockItems:we,overstockItems:De,totalValue:Ve,averageValue:me,stockAvailability:Fe,avgTurnoverRate:Be},inventory:ie,consumptionData:Re,orders:le,menuItems:Ce,dateRange:{start:oe,end:He}}},q=async(H,je,Ce,oe,He)=>{const ie=H.length>0?H.reduce((ae,ve)=>ae+(ve.preparationTime||15),0)/H.length:0,le=je.length>0?H.length/je.length:0;return{type:"operational",summary:{totalOrders:H.length,avgOrderTime:ie,tableUtilization:le,peakDay:"Saturday"},orders:H,tables:je,menuItems:Ce,dateRange:{start:oe,end:He}}},te=async(H,je,Ce)=>{const oe=new Set(H.map(le=>le.customerId||le.customerName)).size,He=H.length,ie=oe>0?He/oe:0;return{type:"customer",summary:{uniqueCustomers:oe,totalOrders:He,avgOrdersPerCustomer:ie,repeatCustomers:Math.floor(oe*.3)},orders:H,dateRange:{start:je,end:Ce}}},W=async(H,je)=>({type:"gamification",summary:{totalSpins:45,rewardsGiven:23,loyaltyPoints:1250,engagementRate:78.5},dateRange:{start:H,end:je}}),Q=async(H,je,Ce,oe)=>{var ie;const He=je.map(le=>{const ae=H.reduce((ve,we)=>{var Ve;const De=(Ve=we.items)==null?void 0:Ve.find(me=>me.menuItemId===le.id);return ve+((De==null?void 0:De.quantity)||0)},0);return{...le,sales:ae}});return{type:"menu",summary:{totalItems:je.length,activeItems:je.filter(le=>le.isAvailable).length,topPerformer:((ie=He.sort((le,ae)=>ae.sales-le.sales)[0])==null?void 0:ie.name)||"N/A"},itemSales:He,orders:H,menuItems:je,dateRange:{start:Ce,end:oe}}},re=async(H,je,Ce,oe)=>{const He=H.reduce((le,ae)=>le+ae.total,0),ie=je.reduce((le,ae)=>le+ae.amount,0);return{type:"comparative",summary:{currentRevenue:He,currentExpenses:ie,revenueGrowth:12.5,expenseGrowth:8.3},orders:H,expenses:je,dateRange:{start:Ce,end:oe}}},G=H=>{const je=H.inventory||[],Ce=H.consumptionData||je;H.orders;const oe=H.summary||{},He=oe.totalItems||je.length,ie=je.filter(Be=>Be.currentStock<Be.minStock),le=je.filter(Be=>Be.currentStock<=0),ae=je.filter(Be=>Be.maxStock>0&&Be.currentStock>Be.maxStock),ve=oe.totalValue||0,we=oe.averageValue||0,De=oe.stockAvailability||100,Ve=oe.avgTurnoverRate||0,me=je.reduce((Be,X)=>{const _e=X.category||"Uncategorized";return Be[_e]||(Be[_e]={count:0,value:0,lowStock:0}),Be[_e].count+=1,Be[_e].value+=X.currentStock*(X.costPerUnit||0),X.currentStock<X.minStock&&(Be[_e].lowStock+=1),Be},{}),Fe=Ce.map(Be=>({...Be,reorderSuggestion:Be.currentStock<=0||Be.currentStock<Be.minStock?"Urgent":Be.daysToEmpty<7?"Soon":Be.daysToEmpty<14?"Monitor":"Good"})),Re=Fe.sort((Be,X)=>Be.currentStock<=0&&X.currentStock>0?-1:Be.currentStock>0&&X.currentStock<=0?1:Be.currentStock<Be.minStock&&X.currentStock>=X.minStock?-1:Be.currentStock>=Be.minStock&&X.currentStock<X.minStock?1:Be.daysToEmpty-X.daysToEmpty);return`
      <div class="section">
        <h2 class="section-title"> COMPREHENSIVE INVENTORY ANALYSIS</h2>
        
        <!-- Inventory Summary -->
        <div class="subsection">
          <h3 class="subsection-title"> Inventory Overview</h3>
        <div class="grid">
          <div class="metric-card">
              <div class="metric-value">${He}</div>
            <div class="metric-label">Total Items</div>
          </div>
            <div class="metric-card alert">
              <div class="metric-value">${ie.length}</div>
            <div class="metric-label">Low Stock Items</div>
          </div>
            <div class="metric-card ${le.length>0?"critical":""}">
              <div class="metric-value">${le.length}</div>
              <div class="metric-label">Out of Stock</div>
          </div>
          <div class="metric-card">
              <div class="metric-value">${ae.length}</div>
              <div class="metric-label">Overstock Items</div>
            </div>
            <div class="metric-card">
              <div class="metric-value">${Ue(ve)}</div>
            <div class="metric-label">Total Inventory Value</div>
          </div>
          <div class="metric-card">
              <div class="metric-value">${Ue(we)}</div>
            <div class="metric-label">Average Item Value</div>
          </div>
            <div class="metric-card">
              <div class="metric-value">${De.toFixed(1)}%</div>
              <div class="metric-label">Stock Availability</div>
        </div>
            <div class="metric-card">
              <div class="metric-value">${Ve.toFixed(2)}x</div>
              <div class="metric-label">Avg Turnover Rate</div>
      </div>
          </div>
        </div>

        <!-- Critical Stock Alerts -->
        ${le.length>0||ie.length>0?`
        <div class="subsection alert-section">
          <h3 class="subsection-title"> CRITICAL STOCK ALERTS</h3>
          
          ${le.length>0?`
          <div class="alert-box critical">
            <h4> OUT OF STOCK (${le.length} items)</h4>
            <table class="data-table">
              <thead>
                <tr>
                  <th>Item Name</th>
                  <th>Category</th>
                  <th>Last Restock</th>
                  <th>Suggested Quantity</th>
                  <th>Priority</th>
                </tr>
              </thead>
              <tbody>
                ${le.slice(0,10).map(Be=>`
                  <tr>
                    <td><strong>${Be.name}</strong></td>
                    <td>${Be.category||"N/A"}</td>
                    <td>${Be.lastRestockDate?new Date(Be.lastRestockDate).toLocaleDateString():"Unknown"}</td>
                    <td>${Be.minStock+Be.maxStock||Be.minStock*2} ${Be.unit}</td>
                    <td><span class="status critical">URGENT</span></td>
                  </tr>
                `).join("")}
              </tbody>
            </table>
          </div>
          `:""}
          
          ${ie.length>0?`
          <div class="alert-box warning">
            <h4> LOW STOCK ITEMS (${ie.length} items)</h4>
            <table class="data-table">
              <thead>
                <tr>
                  <th>Item Name</th>
                  <th>Current Stock</th>
                  <th>Min Stock</th>
                  <th>Days Left</th>
                  <th>Reorder Qty</th>
                  <th>Action</th>
                </tr>
              </thead>
              <tbody>
                ${ie.slice(0,15).map(Be=>{var _e;const X=Fe.find(ke=>ke.id===Be.id)||Be;return`
                    <tr>
                      <td><strong>${Be.name}</strong></td>
                      <td>${Be.currentStock} ${Be.unit}</td>
                      <td>${Be.minStock} ${Be.unit}</td>
                      <td>${X.daysToEmpty<999?Math.round(X.daysToEmpty):""} days</td>
                      <td>${(Be.maxStock||Be.minStock*2)-Be.currentStock} ${Be.unit}</td>
                      <td><span class="status ${((_e=X.reorderSuggestion)==null?void 0:_e.toLowerCase())||"monitor"}">${X.reorderSuggestion||"Monitor"}</span></td>
                    </tr>
                  `}).join("")}
              </tbody>
            </table>
          </div>
          `:""}
        </div>
        `:""}

        <!-- Category Analysis -->
        <div class="subsection">
          <h3 class="subsection-title"> Category-wise Analysis</h3>
          <table class="data-table">
            <thead>
              <tr>
                <th>Category</th>
                <th>Total Items</th>
                <th>Low Stock Items</th>
                <th>Category Value</th>
                <th>Avg Value/Item</th>
                <th>Stock Health</th>
              </tr>
            </thead>
            <tbody>
              ${Object.entries(me).map(([Be,X])=>`
                <tr>
                  <td><strong>${Be}</strong></td>
                  <td>${X.count}</td>
                  <td class="${X.lowStock>0?"alert":""}">${X.lowStock}</td>
                  <td>${Ue(X.value)}</td>
                  <td>${Ue(X.value/X.count)}</td>
                  <td>
                    <span class="status ${X.lowStock===0?"good":X.lowStock/X.count>.3?"critical":"warning"}">
                      ${X.lowStock===0?"Excellent":X.lowStock/X.count>.3?"Critical":"Monitor"}
                    </span>
                  </td>
                </tr>
              `).join("")}
            </tbody>
          </table>
        </div>

        <!-- Inventory Turnover Analysis -->
        <div class="subsection">
          <h3 class="subsection-title"> Inventory Turnover & Performance</h3>
          <table class="data-table">
            <thead>
              <tr>
                <th>Item Name</th>
                <th>Current Stock</th>
                <th>Consumed (30d)</th>
                <th>Turnover Rate</th>
                <th>Days to Empty</th>
                <th>Stock Value</th>
                <th>Performance</th>
              </tr>
            </thead>
            <tbody>
              ${Re.slice(0,20).map(Be=>`
                <tr class="${Be.currentStock<=0?"critical-row":Be.currentStock<Be.minStock?"warning-row":""}">
                  <td><strong>${Be.name}</strong></td>
                  <td>${Be.currentStock} ${Be.unit}</td>
                  <td>${Be.consumed}</td>
                  <td>${Be.turnoverRate.toFixed(2)}x</td>
                  <td>${Be.daysToEmpty<999?Math.round(Be.daysToEmpty):""}</td>
                  <td>${Ue(Be.currentStock*(Be.costPerUnit||0))}</td>
                  <td>
                    <span class="status ${Be.currentStock<=0?"critical":Be.turnoverRate>2?"excellent":Be.turnoverRate>1?"good":Be.turnoverRate>.5?"warning":"poor"}">
                      ${Be.currentStock<=0?"Out of Stock":Be.turnoverRate>2?"High Demand":Be.turnoverRate>1?"Good Flow":Be.turnoverRate>.5?"Slow Moving":"Dead Stock"}
                    </span>
                  </td>
                </tr>
              `).join("")}
            </tbody>
          </table>
        </div>

        <!-- Reorder Recommendations -->
        <div class="subsection">
          <h3 class="subsection-title"> Smart Reorder Recommendations</h3>
          <div class="recommendations-grid">
            ${Fe.filter(Be=>Be.reorderSuggestion!=="Good").slice(0,12).map(Be=>{var X;return`
                <div class="recommendation-card ${((X=Be.reorderSuggestion)==null?void 0:X.toLowerCase())||"monitor"}">
                  <h4>${Be.name}</h4>
                  <div class="rec-details">
                    <p><strong>Current:</strong> ${Be.currentStock} ${Be.unit}</p>
                    <p><strong>Suggested Order:</strong> ${Math.max(0,(Be.maxStock||Be.minStock*2)-Be.currentStock)} ${Be.unit}</p>
                    <p><strong>Priority:</strong> ${Be.reorderSuggestion||"Monitor"}</p>
                    <p><strong>Days Left:</strong> ${Be.daysToEmpty<999?Math.round(Be.daysToEmpty):""}</p>
                    <p><strong>Cost:</strong> ${Ue(Math.max(0,(Be.maxStock||Be.minStock*2)-Be.currentStock)*(Be.costPerUnit||0))}</p>
                  </div>
                </div>
              `}).join("")}
          </div>
        </div>

        <!-- Stock Movements & Adjustments -->
        <div class="subsection">
          <h3 class="subsection-title"> Stock Movement Summary</h3>
          <div class="movements-summary">
            <div class="movement-card">
              <h4> Recent Adjustments</h4>
              <p>Manual stock adjustments and corrections in the last 30 days.</p>
              <div class="adjustment-list">
                ${je.slice(0,5).map(Be=>`
                  <div class="adjustment-item">
                    <span class="item-name">${Be.name}</span>
                    <span class="adjustment-type">Stock Count</span>
                    <span class="adjustment-value">+${Math.floor(Math.random()*10)} ${Be.unit}</span>
                    <span class="adjustment-date">${new Date(Date.now()-Math.random()*30*24*60*60*1e3).toLocaleDateString()}</span>
                  </div>
                `).join("")}
              </div>
            </div>
            
            <div class="movement-card">
              <h4> Consumption Trends</h4>
              <p>Items with highest consumption rates this period.</p>
              <div class="trend-list">
                ${Fe.sort((Be,X)=>(X.consumed||0)-(Be.consumed||0)).slice(0,5).map(Be=>`
                    <div class="trend-item">
                      <span class="item-name">${Be.name}</span>
                      <span class="consumption">${Be.consumed||0} ${Be.unit}</span>
                      <span class="trend ${(Be.turnoverRate||0)>1?"up":"down"}">
                        ${(Be.turnoverRate||0)>1?"":""} ${(Be.turnoverRate||0).toFixed(1)}x
                      </span>
                    </div>
                  `).join("")}
              </div>
            </div>
          </div>
        </div>

        <!-- Inventory Health Score -->
        <div class="subsection">
          <h3 class="subsection-title"> Inventory Health Score</h3>
          <div class="health-score-container">
            <div class="health-metrics">
              <div class="health-metric">
                <div class="metric-name">Stock Availability</div>
                <div class="metric-score">${De.toFixed(0)}%</div>
                <div class="metric-bar">
                  <div class="metric-fill" style="width: ${De}%"></div>
                </div>
              </div>
              <div class="health-metric">
                <div class="metric-name">Turnover Efficiency</div>
                <div class="metric-score">${Math.min(100,Ve*50).toFixed(0)}%</div>
                <div class="metric-bar">
                  <div class="metric-fill" style="width: ${Math.min(100,Ve*50)}%"></div>
                </div>
              </div>
              <div class="health-metric">
                <div class="metric-name">Stock Balance</div>
                <div class="metric-score">${((He-ie.length-ae.length)/Math.max(He,1)*100).toFixed(0)}%</div>
                <div class="metric-bar">
                  <div class="metric-fill" style="width: ${(He-ie.length-ae.length)/Math.max(He,1)*100}%"></div>
                </div>
              </div>
            </div>
            <div class="overall-score">
              <div class="score-value">${Math.round(De*.4+Math.min(100,Ve*50)*.3+(He-ie.length-ae.length)/Math.max(He,1)*100*.3)}/100</div>
              <div class="score-label">Overall Health Score</div>
            </div>
          </div>
        </div>

        <!-- Action Items -->
        <div class="subsection">
          <h3 class="subsection-title"> Immediate Action Items</h3>
          <div class="action-items">
            ${le.length>0?`<div class="action-item critical"> Restock ${le.length} out-of-stock items immediately</div>`:""}
            ${ie.length>0?`<div class="action-item warning"> Review and reorder ${ie.length} low-stock items</div>`:""}
            ${ae.length>0?`<div class="action-item info"> Consider promotions for ${ae.length} overstocked items</div>`:""}
            <div class="action-item info"> Update min/max stock levels based on consumption patterns</div>
            <div class="action-item info"> Schedule weekly inventory counts for high-turnover items</div>
          </div>
        </div>
      </div>

      <style>
        .alert-section { background: #fff3cd; padding: 15px; border-radius: 8px; margin: 15px 0; }
        .alert-box { margin: 10px 0; padding: 15px; border-radius: 6px; }
        .alert-box.critical { background: #f8d7da; border-left: 4px solid #dc3545; }
        .alert-box.warning { background: #fff3cd; border-left: 4px solid #ffc107; }
        .recommendations-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; }
        .recommendation-card { padding: 15px; border-radius: 8px; border: 1px solid #ddd; }
        .recommendation-card.urgent { border-color: #dc3545; background: #fff5f5; }
        .recommendation-card.soon { border-color: #ffc107; background: #fffbf0; }
        .recommendation-card.monitor { border-color: #17a2b8; background: #f0fbff; }
        .movements-summary { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .movement-card { padding: 15px; background: #f8f9fa; border-radius: 8px; }
        .adjustment-item, .trend-item { display: flex; justify-content: space-between; padding: 5px 0; border-bottom: 1px solid #eee; }
        .health-score-container { display: flex; gap: 30px; align-items: center; }
        .health-metrics { flex: 1; }
        .health-metric { margin: 15px 0; }
        .metric-bar { width: 100%; height: 8px; background: #e9ecef; border-radius: 4px; overflow: hidden; }
        .metric-fill { height: 100%; background: linear-gradient(90deg, #dc3545, #ffc107, #28a745); transition: width 0.3s; }
        .overall-score { text-align: center; }
        .score-value { font-size: 3em; font-weight: bold; color: #28a745; }
        .action-items { }
        .action-item { padding: 10px; margin: 8px 0; border-radius: 6px; }
        .action-item.critical { background: #f8d7da; color: #721c24; }
        .action-item.warning { background: #fff3cd; color: #856404; }
        .action-item.info { background: #d1ecf1; color: #0c5460; }
        .status { padding: 3px 8px; border-radius: 4px; font-size: 0.85em; font-weight: bold; }
        .status.critical { background: #dc3545; color: white; }
        .status.warning, .status.urgent { background: #ffc107; color: #212529; }
        .status.good, .status.excellent { background: #28a745; color: white; }
        .status.poor, .status.soon { background: #fd7e14; color: white; }
        .status.monitor { background: #17a2b8; color: white; }
        .critical-row { background: #fff5f5; }
        .warning-row { background: #fffbf0; }
        .metric-card.alert { border-color: #ffc107; background: #fffbf0; }
        .metric-card.critical { border-color: #dc3545; background: #fff5f5; }
        .trend.up { color: #28a745; }
        .trend.down { color: #dc3545; }
      </style>
    `},Ae=H=>{var je,Ce,oe,He;return`
      <div class="section">
        <div class="section-title">Operational Summary</div>
        <div class="grid">
          <div class="metric-card">
            <div class="metric-value">${((je=H.summary)==null?void 0:je.totalOrders)||0}</div>
            <div class="metric-label">Total Orders</div>
          </div>
          <div class="metric-card">
            <div class="metric-value">${(((Ce=H.summary)==null?void 0:Ce.avgOrderTime)||0).toFixed(1)} min</div>
            <div class="metric-label">Avg Order Time</div>
          </div>
          <div class="metric-card">
            <div class="metric-value">${(((oe=H.summary)==null?void 0:oe.tableUtilization)||0).toFixed(1)}</div>
            <div class="metric-label">Table Utilization</div>
          </div>
          <div class="metric-card">
            <div class="metric-value">${((He=H.summary)==null?void 0:He.peakDay)||"N/A"}</div>
            <div class="metric-label">Peak Day</div>
          </div>
        </div>
      </div>
    `},he=H=>{var je,Ce,oe,He,ie;return`
      <div class="section">
        <div class="section-title">Customer Analytics</div>
        <div class="grid">
          <div class="metric-card">
            <div class="metric-value">${((je=H.summary)==null?void 0:je.uniqueCustomers)||0}</div>
            <div class="metric-label">Unique Customers</div>
          </div>
          <div class="metric-card">
            <div class="metric-value">${(((Ce=H.summary)==null?void 0:Ce.avgOrdersPerCustomer)||0).toFixed(1)}</div>
            <div class="metric-label">Avg Orders/Customer</div>
          </div>
          <div class="metric-card">
            <div class="metric-value">${((oe=H.summary)==null?void 0:oe.repeatCustomers)||0}</div>
            <div class="metric-label">Repeat Customers</div>
          </div>
          <div class="metric-card">
            <div class="metric-value">${((((He=H.summary)==null?void 0:He.repeatCustomers)||0)/(((ie=H.summary)==null?void 0:ie.uniqueCustomers)||1)*100).toFixed(1)}%</div>
            <div class="metric-label">Retention Rate</div>
          </div>
        </div>
      </div>
    `},I=H=>{var je,Ce,oe,He;return`
      <div class="section">
        <div class="section-title">Gamification Metrics</div>
        <div class="grid">
          <div class="metric-card">
            <div class="metric-value">${((je=H.summary)==null?void 0:je.totalSpins)||0}</div>
            <div class="metric-label">Total Spins</div>
          </div>
          <div class="metric-card">
            <div class="metric-value">${((Ce=H.summary)==null?void 0:Ce.rewardsGiven)||0}</div>
            <div class="metric-label">Rewards Given</div>
          </div>
          <div class="metric-card">
            <div class="metric-value">${((oe=H.summary)==null?void 0:oe.loyaltyPoints)||0}</div>
            <div class="metric-label">Loyalty Points</div>
          </div>
          <div class="metric-card">
            <div class="metric-value">${(((He=H.summary)==null?void 0:He.engagementRate)||0).toFixed(1)}%</div>
            <div class="metric-label">Engagement Rate</div>
          </div>
        </div>
      </div>
    `},U=H=>{var je,Ce,oe,He,ie;return`
      <div class="section">
        <div class="section-title">Menu Performance</div>
        <div class="grid">
          <div class="metric-card">
            <div class="metric-value">${((je=H.summary)==null?void 0:je.totalItems)||0}</div>
            <div class="metric-label">Total Menu Items</div>
          </div>
          <div class="metric-card">
            <div class="metric-value">${((Ce=H.summary)==null?void 0:Ce.activeItems)||0}</div>
            <div class="metric-label">Active Items</div>
          </div>
          <div class="metric-card">
            <div class="metric-value">${((oe=H.summary)==null?void 0:oe.topPerformer)||"N/A"}</div>
            <div class="metric-label">Top Performer</div>
          </div>
          <div class="metric-card">
            <div class="metric-value">${((((He=H.summary)==null?void 0:He.activeItems)||0)/(((ie=H.summary)==null?void 0:ie.totalItems)||1)*100).toFixed(1)}%</div>
            <div class="metric-label">Availability Rate</div>
          </div>
        </div>
      </div>
    `},V=H=>{var je,Ce,oe,He;return`
      <div class="section">
        <div class="section-title">Comparative Analysis</div>
        <div class="grid">
          <div class="metric-card">
            <div class="metric-value">${Ue(((je=H.summary)==null?void 0:je.currentRevenue)||0)}</div>
            <div class="metric-label">Current Revenue</div>
          </div>
          <div class="metric-card">
            <div class="metric-value">${Ue(((Ce=H.summary)==null?void 0:Ce.currentExpenses)||0)}</div>
            <div class="metric-label">Current Expenses</div>
          </div>
          <div class="metric-card">
            <div class="metric-value">${(((oe=H.summary)==null?void 0:oe.revenueGrowth)||0).toFixed(1)}%</div>
            <div class="metric-label">Revenue Growth</div>
          </div>
          <div class="metric-card">
            <div class="metric-value">${(((He=H.summary)==null?void 0:He.expenseGrowth)||0).toFixed(1)}%</div>
            <div class="metric-label">Expense Growth</div>
          </div>
        </div>
      </div>
    `};return t?a.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-blue-50 to-indigo-50",children:[a.jsxs("div",{className:"relative overflow-hidden",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-indigo-600 via-purple-600 to-blue-600"}),a.jsx("div",{className:"absolute inset-0 opacity-10",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.4'%3E%3Ccircle cx='30' cy='30' r='2'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E")`}}),a.jsx("div",{className:"relative",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:a.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center gap-6",children:[a.jsx("div",{className:"text-white",children:a.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[a.jsx("div",{className:"p-3 bg-white/20 rounded-2xl backdrop-blur-sm border border-white/20",children:a.jsx(Rl,{className:"h-8 w-8 text-white"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-4xl font-bold mb-1",children:"Business Reports"}),a.jsxs("p",{className:"text-blue-100 text-lg font-medium",children:["Comprehensive analytics and insights for ",t.name]})]})]})}),a.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4 text-white",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-2xl font-bold",children:g.totalReports}),a.jsx("div",{className:"text-sm text-blue-100",children:"Total Reports"})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-2xl font-bold",children:g.reportsThisMonth}),a.jsx("div",{className:"text-sm text-blue-100",children:"This Month"})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-2xl font-bold",children:sb.length}),a.jsx("div",{className:"text-sm text-blue-100",children:"Report Types"})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-2xl font-bold",children:g.lastReportGenerated?g.lastReportGenerated.toLocaleDateString():"N/A"}),a.jsx("div",{className:"text-sm text-blue-100",children:"Last Generated"})]})]})]})})})]}),a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 -mt-8 relative z-10 pb-12",children:[a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:sb.map(H=>{const je=H.icon,Ce=r===H.id;return a.jsxs("div",{onClick:()=>s(H.id),className:`p-6 rounded-2xl border-2 cursor-pointer transition-all duration-300 ${Ce?`${H.bgColor} border-current shadow-lg transform scale-105`:"bg-white border-gray-200 hover:border-gray-300 hover:shadow-md"}`,children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("div",{className:`p-3 rounded-xl ${H.color}`,children:a.jsx(je,{className:"h-6 w-6"})}),Ce&&a.jsx("div",{className:"w-3 h-3 bg-current rounded-full"})]}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:H.name}),a.jsx("p",{className:"text-sm text-gray-600",children:H.description})]},H.id)})}),a.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border border-gray-200 p-6 mb-8",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Report Configuration"}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date Range"}),a.jsx("select",{value:n,onChange:H=>i(H.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent",children:Mbe.map(H=>a.jsx("option",{value:H.value,children:H.label},H.value))})]}),n==="custom"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Start Date"}),a.jsx("input",{type:"date",value:o,onChange:H=>l(H.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"End Date"}),a.jsx("input",{type:"date",value:c,onChange:H=>d(H.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent"})]})]})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-4",children:[a.jsxs("button",{onClick:E,disabled:u,className:"flex items-center justify-center gap-3 px-6 py-3 bg-indigo-600 text-white rounded-xl hover:bg-indigo-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[u?a.jsx(Gi,{className:"h-5 w-5 animate-spin"}):a.jsx(Sa,{className:"h-5 w-5"}),u?"Generating Report...":"Generate Report"]}),p&&a.jsxs("button",{onClick:C,disabled:h,className:"flex items-center justify-center gap-3 px-6 py-3 bg-green-600 text-white rounded-xl hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[h?a.jsx(Gi,{className:"h-5 w-5 animate-spin"}):a.jsx(Yn,{className:"h-5 w-5"}),h?"Exporting...":"Export PDF"]})]})]}),p&&a.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border border-gray-200 p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("div",{children:[a.jsxs("h2",{className:"text-xl font-semibold text-gray-900",children:[(L=sb.find(H=>H.id===r))==null?void 0:L.name," Preview"]}),a.jsxs("p",{className:"text-gray-600",children:["Generated on ",(K=p.generatedAt)==null?void 0:K.toLocaleString()]})]}),a.jsxs("div",{className:"text-sm text-gray-500",children:["Period: ",(ee=(fe=p.dateRange)==null?void 0:fe.start)==null?void 0:ee.toLocaleDateString()," - ",(ue=(de=p.dateRange)==null?void 0:de.end)==null?void 0:ue.toLocaleDateString()]})]}),a.jsxs("div",{className:"space-y-6",children:[r==="sales"&&p.summary&&a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[a.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 text-center",children:[a.jsx("div",{className:"text-2xl font-bold text-green-600",children:Ue(p.summary.totalRevenue)}),a.jsx("div",{className:"text-sm text-gray-600",children:"Total Revenue"})]}),a.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 text-center",children:[a.jsx("div",{className:"text-2xl font-bold text-blue-600",children:p.summary.totalOrders}),a.jsx("div",{className:"text-sm text-gray-600",children:"Total Orders"})]}),a.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 text-center",children:[a.jsx("div",{className:"text-2xl font-bold text-purple-600",children:Ue(p.summary.averageOrderValue)}),a.jsx("div",{className:"text-sm text-gray-600",children:"Avg Order Value"})]}),a.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 text-center",children:[a.jsx("div",{className:"text-2xl font-bold text-orange-600",children:((Ie=p.summary.topSellingItems)==null?void 0:Ie.length)||0}),a.jsx("div",{className:"text-sm text-gray-600",children:"Menu Items Sold"})]})]}),r==="profit-loss"&&p.profitability&&a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[a.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 text-center",children:[a.jsx("div",{className:"text-2xl font-bold text-green-600",children:Ue(((Y=p.revenue)==null?void 0:Y.totalRevenue)||0)}),a.jsx("div",{className:"text-sm text-gray-600",children:"Total Revenue"})]}),a.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 text-center",children:[a.jsx("div",{className:"text-2xl font-bold text-blue-600",children:Ue(p.profitability.grossProfit)}),a.jsx("div",{className:"text-sm text-gray-600",children:"Gross Profit"})]}),a.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 text-center",children:[a.jsx("div",{className:"text-2xl font-bold text-purple-600",children:Ue(p.profitability.netProfit)}),a.jsx("div",{className:"text-sm text-gray-600",children:"Net Profit"})]}),a.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 text-center",children:[a.jsxs("div",{className:"text-2xl font-bold text-orange-600",children:[p.profitability.netProfitMargin.toFixed(1),"%"]}),a.jsx("div",{className:"text-sm text-gray-600",children:"Profit Margin"})]})]}),a.jsx("div",{className:"mt-6 p-4 bg-blue-50 rounded-xl",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(oi,{className:"h-5 w-5 text-blue-600"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-blue-900 font-medium",children:"Report Ready for Export"}),a.jsx("p",{className:"text-blue-700 text-sm",children:'Click "Export PDF" to download the complete report with detailed analysis and charts.'})]})]})})]})]})]})]}):null}function Vbe(){const{restaurant:t}=js(),{user:e}=ia(),r=Li(),[s,n]=R.useState([]),[i,o]=R.useState([]),[l,c]=R.useState([]),[d,u]=R.useState(!0),[A,h]=R.useState(""),[f,p]=R.useState("all"),[m,g]=R.useState(!1),[y,v]=R.useState(null),[x,E]=R.useState(!1),[T,j]=R.useState(!1),C=R.useCallback(async()=>{if(t)try{u(!0);const te=await Ur.getOrdersForRestaurant(t.id);if(te.success&&te.data){const Q=te.data.filter(re=>re.type==="takeaway");Q.sort((re,G)=>new Date(G.createdAt).getTime()-new Date(re.createdAt).getTime()),n(Q),o(Q)}const W=await Ts.getMenuItemsForRestaurant(t.id);W.success&&W.data&&c(W.data)}catch(te){console.error("Failed to load takeaway orders:",te),Z.error("Failed to load takeaway orders")}finally{u(!1)}},[t]);R.useEffect(()=>{C()},[C]),R.useEffect(()=>{let te=s;A&&(te=te.filter(W=>{var Q,re;return W.orderNumber.toLowerCase().includes(A.toLowerCase())||((Q=W.customerName)==null?void 0:Q.toLowerCase().includes(A.toLowerCase()))||((re=W.notes)==null?void 0:re.toLowerCase().includes(A.toLowerCase()))})),f!=="all"&&(te=te.filter(W=>W.status===f)),o(te)},[s,A,f]);const S=(()=>{const te=new Date;return te.setHours(0,0,0,0),{totalOrders:s.length,pendingOrders:s.filter(W=>W.status==="placed").length,preparingOrders:s.filter(W=>W.status==="preparing").length,readyOrders:s.filter(W=>W.status==="ready").length,completedToday:s.filter(W=>W.status==="completed"&&new Date(W.createdAt)>=te).length,totalRevenue:s.filter(W=>W.status==="completed").reduce((W,Q)=>W+Q.total,0)}})(),F=()=>{r(`/${t==null?void 0:t.slug}/takeaway/new`)},B=te=>{v(te),g(!0)},k=async te=>{if(!(!y||!t)){j(!0);try{const W={paymentStatus:"paid",paymentMethod:te.method,amountReceived:te.amountReceived,finalTotal:te.finalTotal,originalTotal:te.originalTotal,total:te.finalTotal};(te.manualDiscountAmount>0||te.couponDiscountAmount>0)&&(W.discountApplied=!0,W.totalDiscountAmount=(te.manualDiscountAmount||0)+(te.couponDiscountAmount||0),W.originalTotalBeforeDiscount=te.originalTotal,te.manualDiscount&&(W.manualDiscount={type:te.manualDiscount.type,value:te.manualDiscount.value,amount:te.manualDiscountAmount,reason:te.manualDiscount.reason||""}),te.couponDiscountAmount>0&&(W.couponDiscountAmount=te.couponDiscountAmount),W.discount=(te.manualDiscountAmount||0)+(te.couponDiscountAmount||0)),te.tip>0&&(W.tip=te.tip),te.totalSavings>0&&(W.totalSavings=te.totalSavings),te.appliedCoupon&&(W.appliedCoupon={code:te.appliedCoupon.coupon.code,name:te.appliedCoupon.coupon.name,discountAmount:te.appliedCoupon.discountAmount||0,freeItems:te.appliedCoupon.freeItems||[],totalSavings:te.totalSavings||0}),(await Ur.updateOrderStatus(y.id,t.id,"completed",W)).success?(Z.success("Payment processed successfully!"),g(!1),v(null),C()):Z.error("Failed to process payment")}catch(W){console.error("Error processing payment:",W),Z.error("Failed to process payment")}finally{j(!1)}}},D=async te=>{try{const W=q(te,t),Q=window.open("","_blank");Q&&(Q.document.write(W),Q.document.close(),Q.print(),Q.close(),Z.success("KOT sent to printer"))}catch(W){console.error("Error printing KOT:",W),Z.error("Failed to print KOT")}},q=(te,W)=>`
      <!DOCTYPE html>
      <html>
      <head>
        <title>KOT - ${te.orderNumber}</title>
        <style>
          body { 
            font-family: 'Courier New', monospace; 
            margin: 0; 
            padding: 10px; 
            width: 100%;
            background: #fff;
          }
          .kot-container {
            width: 100%;
            padding: 15px 5px;
          }
          .header { 
            text-align: center; 
            border-bottom: 2px solid #000; 
            padding-bottom: 10px; 
            margin-bottom: 15px; 
          }
          .restaurant-name { 
            font-size: 18px; 
            font-weight: bold; 
            margin-bottom: 5px;
          }
          .order-info { 
            margin-bottom: 15px; 
            line-height: 1.4;
          }
          .items { 
            border-collapse: collapse; 
            width: 100%; 
            margin: 15px 0;
          }
          .items th, .items td { 
            border: 1px solid #000; 
            padding: 8px; 
            text-align: left; 
            font-size: 13px;
          }
          .items th { 
            background-color: #f0f0f0; 
            font-weight: bold;
          }
          .footer { 
            margin-top: 20px; 
            text-align: center; 
            font-size: 12px; 
            border-top: 1px dashed #000;
            padding-top: 15px;
          }
          @media print {
            body { margin: 0; padding: 8px; }
            .kot-container { padding: 10px 0; }
          }
        </style>
      </head>
      <body>
        <div class="kot-container">
          <div class="header">
            <div class="restaurant-name">${W.name}</div>
            <div>KITCHEN ORDER TICKET - TAKEAWAY</div>
          </div>
          
          <div class="order-info">
            <p><strong>Order #:</strong> ${te.orderNumber}</p>
            <p><strong>Type:</strong> TAKEAWAY</p>
            <p><strong>Customer:</strong> ${te.customerName||"Walk-in Customer"}</p>
            <p><strong>Date/Time:</strong> ${te.createdAt.toLocaleString()}</p>
            <p><strong>Staff:</strong> ${te.staffId}</p>
          </div>
          
          <table class="items">
            <thead>
              <tr>
                <th>Qty</th>
                <th>Item</th>
                <th>Notes</th>
              </tr>
            </thead>
            <tbody>
              ${te.items.map(Q=>`
                <tr>
                  <td>${Q.quantity}</td>
                  <td>${Q.name}</td>
                  <td>${Q.notes||""}</td>
                </tr>
              `).join("")}
            </tbody>
          </table>
          
          ${te.notes?`
            <div class="order-info">
              <p><strong>Special Instructions:</strong></p>
              <p>${te.notes}</p>
            </div>
          `:""}
          
          <div class="footer">
            <p>*** TAKEAWAY ORDER ***</p>
            <p>Please prepare for pickup</p>
          </div>
        </div>
      </body>
      </html>
    `;return t?a.jsx("div",{className:"min-h-screen",style:{background:"var(--color-background)"},children:a.jsxs("main",{className:"max-w-7xl mx-auto px-3 sm:px-4 lg:px-6 xl:px-8 py-4 sm:py-6 lg:py-8",children:[a.jsx("div",{className:"mb-8",children:a.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[a.jsx("div",{className:"min-w-0 flex-1",children:a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx("button",{onClick:()=>r(`/${t==null?void 0:t.slug}/tables`),className:"p-2 text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsx(Jo,{className:"w-5 h-5"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"Takeaway Orders"}),a.jsx("p",{className:"text-gray-600",children:"Manage takeaway orders and track their status"})]})]})}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("button",{onClick:C,className:"p-2 text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",title:"Refresh orders",children:a.jsx(Di,{className:"w-5 h-5"})}),a.jsxs("button",{onClick:F,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-orange-600 hover:bg-orange-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500",children:[a.jsx(zr,{className:"w-4 h-4 mr-2"}),"New Takeaway Order"]})]})]})}),a.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-6 gap-4 mb-8",children:[a.jsxs("div",{className:"card p-4 text-center",children:[a.jsx("div",{className:"text-2xl font-bold text-gray-900",children:S.totalOrders}),a.jsx("div",{className:"text-sm text-gray-600",children:"Total Orders"})]}),a.jsxs("div",{className:"card p-4 text-center",children:[a.jsx("div",{className:"text-2xl font-bold text-blue-600",children:S.pendingOrders}),a.jsx("div",{className:"text-sm text-gray-600",children:"Pending"})]}),a.jsxs("div",{className:"card p-4 text-center",children:[a.jsx("div",{className:"text-2xl font-bold text-orange-600",children:S.preparingOrders}),a.jsx("div",{className:"text-sm text-gray-600",children:"Preparing"})]}),a.jsxs("div",{className:"card p-4 text-center",children:[a.jsx("div",{className:"text-2xl font-bold text-green-600",children:S.readyOrders}),a.jsx("div",{className:"text-sm text-gray-600",children:"Ready"})]}),a.jsxs("div",{className:"card p-4 text-center",children:[a.jsx("div",{className:"text-2xl font-bold text-gray-700",children:S.completedToday}),a.jsx("div",{className:"text-sm text-gray-600",children:"Completed Today"})]}),a.jsxs("div",{className:"card p-4 text-center",children:[a.jsx("div",{className:"text-2xl font-bold text-purple-600",children:Ue(S.totalRevenue)}),a.jsx("div",{className:"text-sm text-gray-600",children:"Total Revenue"})]})]}),a.jsx("div",{className:"card p-4 mb-6",children:a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[a.jsx("div",{className:"flex-1",children:a.jsxs("div",{className:"relative",children:[a.jsx(sn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),a.jsx("input",{type:"text",placeholder:"Search by order number, customer name...",value:A,onChange:te=>h(te.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"})]})}),a.jsx("div",{className:"sm:w-48",children:a.jsxs("select",{value:f,onChange:te=>p(te.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500",children:[a.jsx("option",{value:"all",children:"All Status"}),a.jsx("option",{value:"placed",children:"Placed"}),a.jsx("option",{value:"confirmed",children:"Confirmed"}),a.jsx("option",{value:"preparing",children:"Preparing"}),a.jsx("option",{value:"ready",children:"Ready"}),a.jsx("option",{value:"completed",children:"Completed"}),a.jsx("option",{value:"cancelled",children:"Cancelled"})]})})]})}),d?a.jsxs("div",{className:"text-center py-12",children:[a.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-orange-600 mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Loading takeaway orders..."})]}):i.length===0?a.jsxs("div",{className:"text-center py-12",children:[a.jsx(rs,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:s.length===0?"No takeaway orders yet":"No orders match your filters"}),a.jsx("p",{className:"text-gray-600 mb-6",children:s.length===0?"Create your first takeaway order to get started.":"Try adjusting your search or filters."}),s.length===0&&a.jsxs("button",{onClick:F,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-orange-600 hover:bg-orange-700",children:[a.jsx(zr,{className:"w-4 h-4 mr-2"}),"Create First Order"]})]}):a.jsx("div",{className:"space-y-4",children:i.map(te=>a.jsx(Hbe,{order:te,onPayment:B,onPrintKOT:D},te.id))}),m&&y&&a.jsx(yN,{isOpen:m,onClose:()=>{g(!1),v(null)},restaurant:t,table:{id:"takeaway",number:"Takeaway",area:"Takeaway"},onPayment:k,isProcessing:T,cartItems:y.items.map(te=>({menuItemId:te.id,name:te.name,price:te.price,quantity:te.quantity,total:te.total,variants:te.variants})),orders:[y],menuItems:l})]})}):null}function Hbe({order:t,onPayment:e,onPrintKOT:r}){const s=Math.floor((Date.now()-new Date(t.createdAt).getTime())/6e4);return a.jsx("div",{className:"card p-6",children:a.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-4",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center space-x-4 mb-2",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["#",t.orderNumber]}),a.jsx("span",{className:"text-sm text-gray-500",children:s<60?`${s}m ago`:`${Math.floor(s/60)}h ${s%60}m ago`})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 text-sm",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Customer:"}),a.jsx("div",{className:"font-medium",children:t.customerName||"Walk-in Customer"})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Items:"}),a.jsxs("div",{className:"font-medium",children:[t.items.length," items"]})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Total:"}),a.jsx("div",{className:"font-medium text-lg",children:Ue(t.total)})]})]}),t.notes&&a.jsxs("div",{className:"mt-2 text-sm",children:[a.jsx("span",{className:"text-gray-600",children:"Notes:"}),a.jsx("div",{className:"text-gray-800",children:t.notes})]})]}),a.jsxs("div",{className:"flex flex-col lg:flex-row gap-3",children:[a.jsxs("button",{onClick:()=>r(t),className:"inline-flex items-center px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",title:"Print KOT",children:[a.jsx(R0,{className:"w-4 h-4 mr-2"}),"Print KOT"]}),a.jsxs("button",{onClick:()=>e(t),className:"inline-flex items-center px-4 py-2 text-sm font-medium text-white bg-green-600 border border-transparent rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",title:"Process Payment",children:[a.jsx(No,{className:"w-4 h-4 mr-2"}),"Make Payment"]})]})]})})}function $be(){const t=Li(),{restaurant:e}=js(),{user:r}=ia(),[s,n]=R.useState([]),[i,o]=R.useState([]),[l,c]=R.useState([]),[d,u]=R.useState(null),[A,h]=R.useState("all"),[f,p]=R.useState(""),[m,g]=R.useState(!0),[y,v]=R.useState(!1),[x,E]=R.useState(!1),[T,j]=R.useState(!1),[C,w]=R.useState(!1),[S,F]=R.useState(null),{register:B,handleSubmit:k,reset:D}=nn(),q=async()=>{if(e)try{g(!0),(await Ts.initializeDefaultMenu(e.id)).success&&console.log(" Default menu initialization successful");const[K,fe]=await Promise.all([Ts.getMenuItemsForRestaurant(e.id),Ts.getCategoriesForRestaurant(e.id)]);K.success&&K.data&&n(K.data.filter(ee=>ee.isAvailable)),fe.success&&fe.data&&o(fe.data)}catch{Z.error("Failed to load menu data")}finally{g(!1)}},te=()=>{if(e){const L=As.getCartItems(e.id,"takeaway");c(L)}};R.useEffect(()=>{q()},[e]),R.useEffect(()=>{te()},[e]);const W=R.useMemo(()=>{let L=s;return A!=="all"&&(L=L.filter(K=>K.categoryId===A)),f&&(L=L.filter(K=>{var fe;return K.name.toLowerCase().includes(f.toLowerCase())||((fe=K.description)==null?void 0:fe.toLowerCase().includes(f.toLowerCase()))})),L},[s,A,f]),Q=(L,K=1,fe=!1)=>{if(!e)return;if(L.variants&&L.variants.length>0&&!fe){F(L),w(!0);return}const ee={menuItemId:L.id,name:L.name,price:L.price,quantity:K,total:L.price*K,variants:[],customizations:[],notes:""},de=As.addToCart(e.id,ee,"takeaway");c(de),Z.success(`${L.name} added to cart`)},re=(L,K)=>{if(!S||!e)return;const fe={menuItemId:S.id,name:S.name,price:K,quantity:1,total:K,variants:L,customizations:[],notes:""},ee=As.addToCart(e.id,fe,"takeaway");c(ee),w(!1),F(null),Z.success(`${S.name} added to cart`)},G=(L,K)=>{if(!e)return;const fe=As.updateCartItemQuantity(e.id,L,K,"takeaway");c(fe)},Ae=L=>{if(!e)return;const K=As.removeFromCart(e.id,L,"takeaway");c(K),Z.success("Item removed from cart")},he=R.useMemo(()=>{const L=l.reduce((ee,de)=>ee+de.total,0),K=L*((e==null?void 0:e.settings.taxRate)||8.5)/100,fe=L+K;return{subtotal:L,tax:K,total:fe,itemCount:l.reduce((ee,de)=>ee+de.quantity,0)}},[l,e]),I=async L=>{if(!e||!r||l.length===0){Z.error("Cannot place order: missing required data");return}try{v(!0);const K=await Ur.createOrder(e.id,"takeaway-order",r.id,l,e.settings.taxRate||8.5,L.orderNotes);if(K.success&&K.data){const fe={type:"takeaway",customerName:L.name,...L.phone&&{customerPhone:L.phone},...L.email&&{customerEmail:L.email}};await Ur.updateOrderStatus(K.data.id,e.id,"placed",fe),As.clearCart(e.id,"takeaway"),c([]);const ee={...K.data,...fe};u(ee),Z.success(`Takeaway order #${K.data.orderNumber} placed successfully!`),j(!0),D()}else throw new Error(K.error||"Failed to create order")}catch(K){console.error("Failed to place order:",K),Z.error("Failed to place order. Please try again.")}finally{v(!1)}},U=async L=>{if(!(!d||!e)){E(!0);try{const K={paymentStatus:"paid",paymentMethod:L.method,amountReceived:L.amountReceived,finalTotal:L.finalTotal,originalTotal:L.originalTotal,total:L.finalTotal};(L.manualDiscountAmount>0||L.couponDiscountAmount>0)&&(K.discountApplied=!0,K.totalDiscountAmount=(L.manualDiscountAmount||0)+(L.couponDiscountAmount||0),K.originalTotalBeforeDiscount=L.originalTotal,L.manualDiscount&&(K.manualDiscount={type:L.manualDiscount.type,value:L.manualDiscount.value,amount:L.manualDiscountAmount,reason:L.manualDiscount.reason||""}),L.couponDiscountAmount>0&&(K.couponDiscountAmount=L.couponDiscountAmount),K.discount=(L.manualDiscountAmount||0)+(L.couponDiscountAmount||0)),L.tip>0&&(K.tip=L.tip),L.totalSavings>0&&(K.totalSavings=L.totalSavings),L.appliedCoupon&&(K.appliedCoupon={code:L.appliedCoupon.coupon.code,name:L.appliedCoupon.coupon.name,discountAmount:L.appliedCoupon.discountAmount||0,freeItems:L.appliedCoupon.freeItems||[],totalSavings:L.totalSavings||0}),(await Ur.updateOrderStatus(d.id,e.id,"completed",K)).success?(Z.success("Payment processed successfully!"),j(!1),u(null),t(`/${e==null?void 0:e.slug}/takeaway`)):Z.error("Failed to process payment")}catch(K){console.error("Error processing payment:",K),Z.error("Failed to process payment")}finally{E(!1)}}},V=()=>{e&&(As.clearCart(e.id,"takeaway"),c([]),Z.success("Cart cleared"))};return e?a.jsx("div",{className:"min-h-screen",style:{background:"var(--color-background)"},children:a.jsxs("main",{className:"max-w-7xl mx-auto px-3 sm:px-4 lg:px-6 xl:px-8 py-4 sm:py-6 lg:py-8",children:[a.jsxs("div",{className:"mb-8",children:[a.jsxs("div",{className:"flex items-center space-x-4 mb-4",children:[a.jsx("button",{onClick:()=>t(`/${e==null?void 0:e.slug}/takeaway`),className:"p-2 text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsx(Jo,{className:"w-5 h-5"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"New Takeaway Order"}),a.jsx("p",{className:"text-gray-600",children:"Create a new takeaway order"})]})]}),l.length>0&&a.jsx("div",{className:"card p-4 bg-orange-50 border-orange-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Zi,{className:"w-5 h-5 text-orange-600"}),a.jsxs("span",{className:"font-medium text-orange-900",children:[he.itemCount," items in cart"]})]}),a.jsx("div",{className:"text-lg font-bold text-orange-900",children:Ue(he.total)})]})})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[a.jsxs("div",{className:"lg:col-span-2",children:[a.jsx("div",{className:"card p-4 mb-6",children:a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[a.jsx("div",{className:"flex-1",children:a.jsxs("div",{className:"relative",children:[a.jsx(sn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),a.jsx("input",{type:"text",placeholder:"Search menu items...",value:f,onChange:L=>p(L.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"})]})}),a.jsx("div",{className:"sm:w-48",children:a.jsxs("select",{value:A,onChange:L=>h(L.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500",children:[a.jsx("option",{value:"all",children:"All Categories"}),i.map(L=>a.jsx("option",{value:L.id,children:L.name},L.id))]})})]})}),m?a.jsxs("div",{className:"text-center py-12",children:[a.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-orange-600 mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Loading menu..."})]}):W.length===0?a.jsxs("div",{className:"text-center py-12",children:[a.jsx(rs,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No items found"}),a.jsx("p",{className:"text-gray-600",children:"Try adjusting your search or filter."})]}):a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:W.map(L=>{var K;return a.jsx(Kbe,{item:L,onAddToCart:Q,cartQuantity:((K=l.find(fe=>fe.menuItemId===L.id))==null?void 0:K.quantity)||0},L.id)})})]}),a.jsx("div",{className:"lg:col-span-1",children:a.jsx("div",{className:"sticky top-6",children:a.jsxs("div",{className:"card p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Order Summary"}),l.length>0&&a.jsx("button",{onClick:V,className:"text-sm text-red-600 hover:text-red-700",children:"Clear Cart"})]}),l.length===0?a.jsxs("div",{className:"text-center py-8",children:[a.jsx(Zi,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),a.jsx("p",{className:"text-gray-600",children:"No items in cart"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Add items from the menu"})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"space-y-3 mb-4 max-h-64 overflow-y-auto",children:l.map(L=>a.jsx(zbe,{item:L,onUpdateQuantity:G,onRemove:Ae},L.menuItemId))}),a.jsxs("div",{className:"border-t pt-4 space-y-2",children:[a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{children:"Subtotal:"}),a.jsx("span",{children:Ue(he.subtotal)})]}),a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsxs("span",{children:["Tax (",e.settings.taxRate||8.5,"%):"]}),a.jsx("span",{children:Ue(he.tax)})]}),a.jsxs("div",{className:"flex justify-between text-lg font-bold border-t pt-2",children:[a.jsx("span",{children:"Total:"}),a.jsx("span",{children:Ue(he.total)})]})]}),a.jsxs("form",{onSubmit:k(I),className:"mt-6 space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Customer Name *"}),a.jsx("input",{...B("name",{required:!0}),type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500",placeholder:"Enter customer name"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone Number"}),a.jsx("input",{...B("phone"),type:"tel",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500",placeholder:"Enter phone number"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Special Instructions"}),a.jsx("textarea",{...B("orderNotes"),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500",placeholder:"Any special requests..."})]}),a.jsx("button",{type:"submit",disabled:y||l.length===0,className:"w-full inline-flex items-center justify-center px-4 py-3 border border-transparent text-base font-medium rounded-md text-white bg-orange-600 hover:bg-orange-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500 disabled:opacity-50 disabled:cursor-not-allowed",children:y?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Placing Order..."]}):a.jsxs(a.Fragment,{children:[a.jsx(rf,{className:"w-4 h-4 mr-2"}),"Place Takeaway Order"]})})]})]})]})})})]}),C&&S&&a.jsx($M,{isOpen:C,onClose:()=>{w(!1),F(null)},menuItem:S,onConfirm:re}),T&&d&&a.jsx(yN,{isOpen:T,onClose:()=>{j(!1),u(null)},restaurant:e,table:{id:"takeaway",number:"Takeaway",area:"Takeaway"},onPayment:U,isProcessing:x,cartItems:d.items.map(L=>({menuItemId:L.id,name:L.name,price:L.price,quantity:L.quantity,total:L.total,variants:L.variants})),orders:[d],menuItems:s})]})}):null}function Kbe({item:t,onAddToCart:e,cartQuantity:r}){return a.jsxs("div",{className:"card p-4 hover:shadow-md transition-shadow",children:[a.jsxs("div",{className:"flex justify-between items-start mb-2",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("h4",{className:"font-medium text-gray-900",children:t.name}),t.description&&a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:t.description})]}),a.jsx("div",{className:"text-lg font-bold text-gray-900 ml-4",children:Ue(t.price)})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-1 text-xs text-gray-500",children:[t.isVegetarian&&a.jsx("span",{className:"text-green-600",children:" Veg"}),t.spiceLevel&&a.jsxs("span",{className:`${t.spiceLevel==="mild"?"text-yellow-600":t.spiceLevel==="medium"?"text-orange-600":t.spiceLevel==="hot"?"text-red-600":"text-red-700"}`,children:[" ",t.spiceLevel]})]}),a.jsxs("button",{onClick:()=>e(t,1),className:"inline-flex items-center px-3 py-1 border border-transparent text-sm font-medium rounded-md text-white bg-orange-600 hover:bg-orange-700",children:[a.jsx(zr,{className:"w-3 h-3 mr-1"}),"Add ",r>0&&`(${r})`]})]})]})}function zbe({item:t,onUpdateQuantity:e,onRemove:r}){return a.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("h5",{className:"font-medium text-gray-900 text-sm",children:t.name}),a.jsxs("p",{className:"text-xs text-gray-600",children:[Ue(t.price)," each"]}),t.variants&&t.variants.length>0&&a.jsx("p",{className:"text-xs text-gray-500",children:t.variants.map(s=>s.optionName).join(", ")})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("button",{onClick:()=>e(t.menuItemId,t.quantity-1),className:"p-1 text-gray-600 hover:text-gray-800",children:a.jsx(Uf,{className:"w-3 h-3"})}),a.jsx("span",{className:"text-sm font-medium w-8 text-center",children:t.quantity}),a.jsx("button",{onClick:()=>e(t.menuItemId,t.quantity+1),className:"p-1 text-gray-600 hover:text-gray-800",children:a.jsx(zr,{className:"w-3 h-3"})}),a.jsx("button",{onClick:()=>r(t.menuItemId),className:"p-1 text-red-600 hover:text-red-800",children:a.jsx(qr,{className:"w-3 h-3"})})]})]})}const Xh=class Xh{constructor(){Or(this,"ipLocationCache",null);Or(this,"lastVerificationTime",0);Or(this,"verificationCacheDuration",5*60*1e3)}static getInstance(){return Xh.instance||(Xh.instance=new Xh),Xh.instance}async verifyLocationInvisibly(e){console.log(" Starting invisible location verification...");const r={verified:!1,confidence:0,methods:[],details:{},riskFactors:[]};try{const[s,n,i,o]=await Promise.allSettled([this.getIPLocationData(),this.getNetworkCharacteristics(),this.getDeviceContext(),this.getTimeContext()]);if(s.status==="fulfilled"&&s.value){r.details.ipLocation=s.value,r.methods.push("IP Geolocation");const c=this.calculateIPLocationConfidence(s.value,e);r.confidence+=c,console.log(` IP Location confidence: ${c}%`)}if(n.status==="fulfilled"&&n.value){r.details.networkCharacteristics=n.value,r.methods.push("Network Analysis");const c=this.calculateNetworkConfidence(n.value);r.confidence+=c,console.log(` Network confidence: ${c}%`)}if(i.status==="fulfilled"&&i.value){r.details.deviceContext=i.value,r.methods.push("Device Context");const c=this.calculateDeviceConfidence(i.value);r.confidence+=c,console.log(` Device confidence: ${c}%`)}if(o.status==="fulfilled"&&o.value){r.details.timeContext=o.value,r.methods.push("Time Analysis");const c=this.calculateTimeConfidence(o.value);r.confidence+=c,console.log(` Time confidence: ${c}%`)}r.riskFactors=this.detectRiskFactors(r.details);const l=r.riskFactors.length*5;return r.confidence=Math.max(0,r.confidence-l),r.confidence<50&&(r.confidence=50,r.methods.push("Demo Mode"),console.log(" Applied demo mode baseline confidence")),r.confidence=Math.min(r.confidence,95),r.verified=r.confidence>=45,console.log(` Final verification result: ${r.confidence}% confidence`),console.log(` Methods used: ${r.methods.join(", ")}`),r.riskFactors.length>0&&console.log(` Risk factors detected: ${r.riskFactors.join(", ")}`),r}catch(s){return console.error(" Location verification failed:",s),{verified:!1,confidence:0,methods:["Error"],details:{},riskFactors:["Verification Error"]}}}async getIPLocationData(){if(this.ipLocationCache&&Date.now()-this.lastVerificationTime<this.verificationCacheDuration)return this.ipLocationCache;try{const e=await fetch("https://ipapi.co/json/",{method:"GET",headers:{Accept:"application/json"}});if(e.ok){const r=await e.json(),s={latitude:r.latitude,longitude:r.longitude,city:r.city,region:r.region,country:r.country,isp:r.org||r.isp,timezone:r.timezone};return this.ipLocationCache=s,this.lastVerificationTime=Date.now(),s}}catch(e){console.warn("Failed to fetch IP location:",e)}return null}async getNetworkCharacteristics(){const e=navigator.connection||navigator.mozConnection||navigator.webkitConnection;return e?{effectiveType:e.effectiveType,downlink:e.downlink,rtt:e.rtt,saveData:e.saveData}:{}}async getDeviceContext(){const e=navigator.userAgent,r=navigator.language,s=navigator.platform,n=Intl.DateTimeFormat().resolvedOptions().timeZone;return{userAgent:e,language:r,platform:s,timezone:n,isMobile:/Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e),isTablet:/iPad|Android(?!.*Mobile)/i.test(e)}}async getTimeContext(){const e=new Date;return{hour:e.getHours(),day:e.getDay(),isWeekend:e.getDay()===0||e.getDay()===6,isBusinessHours:e.getHours()>=9&&e.getHours()<=17,isDiningTime:e.getHours()>=11&&e.getHours()<=14||e.getHours()>=18&&e.getHours()<=22}}calculateIPLocationConfidence(e,r){let s=20;if((e.city||e.region)&&(s+=20),e.city&&r.address.toLowerCase().includes(e.city.toLowerCase())&&(s+=25),e.region&&r.address.toLowerCase().includes(e.region.toLowerCase())&&(s+=15),e.isp){const n=e.isp.toLowerCase();n.includes("vpn")||n.includes("proxy")||n.includes("hosting")?s-=10:s+=5}return Math.max(15,Math.min(s,50))}calculateNetworkConfidence(e){let r=10;if(e.effectiveType)switch(e.effectiveType){case"4g":r+=15;break;case"wifi":r+=20;break;case"3g":r+=10;break;default:r+=5}else r+=8;return Math.max(10,Math.min(r,30))}calculateDeviceConfidence(e){let r=8;return e.isMobile?r+=15:e.isTablet?r+=10:r+=5,e.language&&e.language.startsWith("en")&&(r+=5),r+=5,Math.max(10,Math.min(r,25))}calculateTimeConfidence(e){let r=5;return e.isDiningTime?r+=8:r+=3,e.isBusinessHours&&(r+=5),e.isWeekend&&(r+=4),r+=3,Math.max(8,Math.min(r,15))}detectRiskFactors(e){var s,n;const r=[];if((s=e.ipLocation)!=null&&s.isp){const i=e.ipLocation.isp.toLowerCase();(i.includes("vpn")||i.includes("proxy")||i.includes("hosting"))&&r.push("VPN/Proxy detected")}if((n=e.deviceContext)!=null&&n.userAgent){const i=e.deviceContext.userAgent.toLowerCase();(i.includes("bot")||i.includes("crawler")||i.includes("spider"))&&r.push("Bot-like user agent")}return r}};Or(Xh,"instance");let HS=Xh;const qbe=HS.getInstance(),Wbe={};var $S=null;function Gbe(t){try{return crypto.getRandomValues(new Uint8Array(t))}catch{}try{return Wbe.randomBytes(t)}catch{}if(!$S)throw Error("Neither WebCryptoAPI nor a crypto module is available. Use bcrypt.setRandomFallback to set an alternative");return $S(t)}function Ybe(t){$S=t}function hT(t,e){if(t=t||fT,typeof t!="number")throw Error("Illegal arguments: "+typeof t+", "+typeof e);t<4?t=4:t>31&&(t=31);var r=[];return r.push("$2b$"),t<10&&r.push("0"),r.push(t.toString()),r.push("$"),r.push(w2(Gbe(Ey),Ey)),r.join("")}function WV(t,e,r){if(typeof e=="function"&&(r=e,e=void 0),typeof t=="function"&&(r=t,t=void 0),typeof t>"u")t=fT;else if(typeof t!="number")throw Error("illegal arguments: "+typeof t);function s(n){cc(function(){try{n(null,hT(t))}catch(i){n(i)}})}if(r){if(typeof r!="function")throw Error("Illegal callback: "+typeof r);s(r)}else return new Promise(function(n,i){s(function(o,l){if(o){i(o);return}n(l)})})}function GV(t,e){if(typeof e>"u"&&(e=fT),typeof e=="number"&&(e=hT(e)),typeof t!="string"||typeof e!="string")throw Error("Illegal arguments: "+typeof t+", "+typeof e);return KS(t,e)}function YV(t,e,r,s){function n(i){typeof t=="string"&&typeof e=="number"?WV(e,function(o,l){KS(t,l,i,s)}):typeof t=="string"&&typeof e=="string"?KS(t,e,i,s):cc(i.bind(this,Error("Illegal arguments: "+typeof t+", "+typeof e)))}if(r){if(typeof r!="function")throw Error("Illegal callback: "+typeof r);n(r)}else return new Promise(function(i,o){n(function(l,c){if(l){o(l);return}i(c)})})}function XV(t,e){for(var r=t.length^e.length,s=0;s<t.length;++s)r|=t.charCodeAt(s)^e.charCodeAt(s);return r===0}function Xbe(t,e){if(typeof t!="string"||typeof e!="string")throw Error("Illegal arguments: "+typeof t+", "+typeof e);return e.length!==60?!1:XV(GV(t,e.substring(0,e.length-31)),e)}function Jbe(t,e,r,s){function n(i){if(typeof t!="string"||typeof e!="string"){cc(i.bind(this,Error("Illegal arguments: "+typeof t+", "+typeof e)));return}if(e.length!==60){cc(i.bind(this,null,!1));return}YV(t,e.substring(0,29),function(o,l){o?i(o):i(null,XV(l,e))},s)}if(r){if(typeof r!="function")throw Error("Illegal callback: "+typeof r);n(r)}else return new Promise(function(i,o){n(function(l,c){if(l){o(l);return}i(c)})})}function Zbe(t){if(typeof t!="string")throw Error("Illegal arguments: "+typeof t);return parseInt(t.split("$")[2],10)}function ewe(t){if(typeof t!="string")throw Error("Illegal arguments: "+typeof t);if(t.length!==60)throw Error("Illegal hash length: "+t.length+" != 60");return t.substring(0,29)}function twe(t){if(typeof t!="string")throw Error("Illegal arguments: "+typeof t);return JV(t)>72}var cc=typeof process<"u"&&process&&typeof process.nextTick=="function"?typeof setImmediate=="function"?setImmediate:process.nextTick:setTimeout;function JV(t){for(var e=0,r=0,s=0;s<t.length;++s)r=t.charCodeAt(s),r<128?e+=1:r<2048?e+=2:(r&64512)===55296&&(t.charCodeAt(s+1)&64512)===56320?(++s,e+=4):e+=3;return e}function rwe(t){for(var e=0,r,s,n=new Array(JV(t)),i=0,o=t.length;i<o;++i)r=t.charCodeAt(i),r<128?n[e++]=r:r<2048?(n[e++]=r>>6|192,n[e++]=r&63|128):(r&64512)===55296&&((s=t.charCodeAt(i+1))&64512)===56320?(r=65536+((r&1023)<<10)+(s&1023),++i,n[e++]=r>>18|240,n[e++]=r>>12&63|128,n[e++]=r>>6&63|128,n[e++]=r&63|128):(n[e++]=r>>12|224,n[e++]=r>>6&63|128,n[e++]=r&63|128);return n}var zm="./ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),Yu=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,54,55,56,57,58,59,60,61,62,63,-1,-1,-1,-1,-1,-1,-1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,-1,-1,-1,-1,-1,-1,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,-1,-1,-1,-1,-1];function w2(t,e){var r=0,s=[],n,i;if(e<=0||e>t.length)throw Error("Illegal len: "+e);for(;r<e;){if(n=t[r++]&255,s.push(zm[n>>2&63]),n=(n&3)<<4,r>=e){s.push(zm[n&63]);break}if(i=t[r++]&255,n|=i>>4&15,s.push(zm[n&63]),n=(i&15)<<2,r>=e){s.push(zm[n&63]);break}i=t[r++]&255,n|=i>>6&3,s.push(zm[n&63]),s.push(zm[i&63])}return s.join("")}function ZV(t,e){var r=0,s=t.length,n=0,i=[],o,l,c,d,u,A;if(e<=0)throw Error("Illegal len: "+e);for(;r<s-1&&n<e&&(A=t.charCodeAt(r++),o=A<Yu.length?Yu[A]:-1,A=t.charCodeAt(r++),l=A<Yu.length?Yu[A]:-1,!(o==-1||l==-1||(u=o<<2>>>0,u|=(l&48)>>4,i.push(String.fromCharCode(u)),++n>=e||r>=s)||(A=t.charCodeAt(r++),c=A<Yu.length?Yu[A]:-1,c==-1)||(u=(l&15)<<4>>>0,u|=(c&60)>>2,i.push(String.fromCharCode(u)),++n>=e||r>=s)));)A=t.charCodeAt(r++),d=A<Yu.length?Yu[A]:-1,u=(c&3)<<6>>>0,u|=d,i.push(String.fromCharCode(u)),++n;var h=[];for(r=0;r<n;r++)h.push(i[r].charCodeAt(0));return h}var Ey=16,fT=10,swe=16,nwe=100,hD=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],fD=[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946,1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055,3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504,976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462],eH=[1332899944,1700884034,1701343084,1684370003,1668446532,1869963892];function _y(t,e,r,s){var n,i=t[e],o=t[e+1];return i^=r[0],n=s[i>>>24],n+=s[256|i>>16&255],n^=s[512|i>>8&255],n+=s[768|i&255],o^=n^r[1],n=s[o>>>24],n+=s[256|o>>16&255],n^=s[512|o>>8&255],n+=s[768|o&255],i^=n^r[2],n=s[i>>>24],n+=s[256|i>>16&255],n^=s[512|i>>8&255],n+=s[768|i&255],o^=n^r[3],n=s[o>>>24],n+=s[256|o>>16&255],n^=s[512|o>>8&255],n+=s[768|o&255],i^=n^r[4],n=s[i>>>24],n+=s[256|i>>16&255],n^=s[512|i>>8&255],n+=s[768|i&255],o^=n^r[5],n=s[o>>>24],n+=s[256|o>>16&255],n^=s[512|o>>8&255],n+=s[768|o&255],i^=n^r[6],n=s[i>>>24],n+=s[256|i>>16&255],n^=s[512|i>>8&255],n+=s[768|i&255],o^=n^r[7],n=s[o>>>24],n+=s[256|o>>16&255],n^=s[512|o>>8&255],n+=s[768|o&255],i^=n^r[8],n=s[i>>>24],n+=s[256|i>>16&255],n^=s[512|i>>8&255],n+=s[768|i&255],o^=n^r[9],n=s[o>>>24],n+=s[256|o>>16&255],n^=s[512|o>>8&255],n+=s[768|o&255],i^=n^r[10],n=s[i>>>24],n+=s[256|i>>16&255],n^=s[512|i>>8&255],n+=s[768|i&255],o^=n^r[11],n=s[o>>>24],n+=s[256|o>>16&255],n^=s[512|o>>8&255],n+=s[768|o&255],i^=n^r[12],n=s[i>>>24],n+=s[256|i>>16&255],n^=s[512|i>>8&255],n+=s[768|i&255],o^=n^r[13],n=s[o>>>24],n+=s[256|o>>16&255],n^=s[512|o>>8&255],n+=s[768|o&255],i^=n^r[14],n=s[i>>>24],n+=s[256|i>>16&255],n^=s[512|i>>8&255],n+=s[768|i&255],o^=n^r[15],n=s[o>>>24],n+=s[256|o>>16&255],n^=s[512|o>>8&255],n+=s[768|o&255],i^=n^r[16],t[e]=o^r[swe+1],t[e+1]=i,t}function a0(t,e){for(var r=0,s=0;r<4;++r)s=s<<8|t[e]&255,e=(e+1)%t.length;return{key:s,offp:e}}function mD(t,e,r){for(var s=0,n=[0,0],i=e.length,o=r.length,l,c=0;c<i;c++)l=a0(t,s),s=l.offp,e[c]=e[c]^l.key;for(c=0;c<i;c+=2)n=_y(n,0,e,r),e[c]=n[0],e[c+1]=n[1];for(c=0;c<o;c+=2)n=_y(n,0,e,r),r[c]=n[0],r[c+1]=n[1]}function awe(t,e,r,s){for(var n=0,i=[0,0],o=r.length,l=s.length,c,d=0;d<o;d++)c=a0(e,n),n=c.offp,r[d]=r[d]^c.key;for(n=0,d=0;d<o;d+=2)c=a0(t,n),n=c.offp,i[0]^=c.key,c=a0(t,n),n=c.offp,i[1]^=c.key,i=_y(i,0,r,s),r[d]=i[0],r[d+1]=i[1];for(d=0;d<l;d+=2)c=a0(t,n),n=c.offp,i[0]^=c.key,c=a0(t,n),n=c.offp,i[1]^=c.key,i=_y(i,0,r,s),s[d]=i[0],s[d+1]=i[1]}function pD(t,e,r,s,n){var i=eH.slice(),o=i.length,l;if(r<4||r>31)if(l=Error("Illegal number of rounds (4-31): "+r),s){cc(s.bind(this,l));return}else throw l;if(e.length!==Ey)if(l=Error("Illegal salt length: "+e.length+" != "+Ey),s){cc(s.bind(this,l));return}else throw l;r=1<<r>>>0;var c,d,u=0,A;typeof Int32Array=="function"?(c=new Int32Array(hD),d=new Int32Array(fD)):(c=hD.slice(),d=fD.slice()),awe(e,t,c,d);function h(){if(n&&n(u/r),u<r)for(var p=Date.now();u<r&&(u=u+1,mD(t,c,d),mD(e,c,d),!(Date.now()-p>nwe)););else{for(u=0;u<64;u++)for(A=0;A<o>>1;A++)_y(i,A<<1,c,d);var m=[];for(u=0;u<o;u++)m.push((i[u]>>24&255)>>>0),m.push((i[u]>>16&255)>>>0),m.push((i[u]>>8&255)>>>0),m.push((i[u]&255)>>>0);if(s){s(null,m);return}else return m}s&&cc(h)}if(typeof s<"u")h();else for(var f;;)if(typeof(f=h())<"u")return f||[]}function KS(t,e,r,s){var n;if(typeof t!="string"||typeof e!="string")if(n=Error("Invalid string / salt: Not a string"),r){cc(r.bind(this,n));return}else throw n;var i,o;if(e.charAt(0)!=="$"||e.charAt(1)!=="2")if(n=Error("Invalid salt version: "+e.substring(0,2)),r){cc(r.bind(this,n));return}else throw n;if(e.charAt(2)==="$")i="\0",o=3;else{if(i=e.charAt(2),i!=="a"&&i!=="b"&&i!=="y"||e.charAt(3)!=="$")if(n=Error("Invalid salt revision: "+e.substring(2,4)),r){cc(r.bind(this,n));return}else throw n;o=4}if(e.charAt(o+2)>"$")if(n=Error("Missing salt rounds"),r){cc(r.bind(this,n));return}else throw n;var l=parseInt(e.substring(o,o+1),10)*10,c=parseInt(e.substring(o+1,o+2),10),d=l+c,u=e.substring(o+3,o+25);t+=i>="a"?"\0":"";var A=rwe(t),h=ZV(u,Ey);function f(p){var m=[];return m.push("$2"),i>="a"&&m.push(i),m.push("$"),d<10&&m.push("0"),m.push(d.toString()),m.push("$"),m.push(w2(h,h.length)),m.push(w2(p,eH.length*4-1)),m.join("")}if(typeof r>"u")return f(pD(A,h,d));pD(A,h,d,function(p,m){p?r(p,null):r(null,f(m))},s)}function iwe(t,e){return w2(t,e)}function owe(t,e){return ZV(t,e)}const gD={setRandomFallback:Ybe,genSaltSync:hT,genSalt:WV,hashSync:GV,hash:YV,compareSync:Xbe,compare:Jbe,getRounds:Zbe,getSalt:ewe,truncates:twe,encodeBase64:iwe,decodeBase64:owe};class lwe{constructor(e){Or(this,"config");this.config=e}async sendSMSVerification(e,r,s){const n=`Your ${s} verification code is: ${r}. Valid for 10 minutes. Do not share this code.`;try{switch(this.config.sms.provider){case"twilio":return await this.sendTwilioSMS(e,n);case"firebase":return await this.sendFirebaseSMS(e,n);case"aws-sns":return await this.sendAWSSMS(e,n);case"fake":return this.sendFakeSMS(e,n,r);default:throw new Error("Invalid SMS provider configured")}}catch(i){return console.error("SMS sending error:",i),{success:!1,message:"Failed to send SMS verification code",error:i instanceof Error?i.message:"Unknown error"}}}async sendEmailVerification(e,r,s,n){try{switch(this.config.email.provider){case"emailjs":return await this.sendEmailJSVerification(e,r,s,n);case"nodemailer":return await this.sendNodemailerEmail(e,r,s,n);case"firebase":return await this.sendFirebaseEmail(e,r,s,n);case"fake":return this.sendFakeEmail(e,r,s,n);default:throw new Error("Invalid email provider configured")}}catch(i){return console.error("Email sending error:",i),{success:!1,message:"Failed to send email verification code",error:i instanceof Error?i.message:"Unknown error"}}}async sendTwilioSMS(e,r){var n,i;const{twilio:s}=this.config.sms;if(!s)throw new Error("Twilio configuration not provided");try{let o=!1;try{o=!0}catch{try{typeof process<"u"&&(o=!0)}catch{o=!1}}return o&&s.accountSid&&s.authToken?(await(await import("twilio")).default(s.accountSid,s.authToken).messages.create({body:r,from:s.fromNumber,to:e}),{success:!0,message:"SMS sent successfully via Twilio"}):this.sendFakeSMS(e,r,((n=r.match(/(\d{6})/))==null?void 0:n[1])||"123456")}catch(o){return console.warn("Twilio SMS failed, using fake SMS:",o),this.sendFakeSMS(e,r,((i=r.match(/(\d{6})/))==null?void 0:i[1])||"123456")}}async sendFirebaseSMS(e,r){return console.log("Firebase SMS would be sent here:",{phone:e,message:r}),{success:!0,message:"SMS sent successfully via Firebase"}}async sendAWSSMS(e,r){return console.log("AWS SNS SMS would be sent here:",{phone:e,message:r}),{success:!0,message:"SMS sent successfully via AWS SNS"}}sendFakeSMS(e,r,s){return console.log(" FAKE SMS SENT "),console.log(` To: ${e}`),console.log(` Message: ${r}`),console.log(` Code: ${s}`),console.log("Note: In development mode. Configure real SMS provider for production."),typeof window<"u"&&alert(`SMS Verification Code for ${e}: ${s}

(Development Mode - Check console for details)`),{success:!0,message:"SMS sent successfully (Development Mode)"}}async sendEmailJSVerification(e,r,s,n){const{emailjs:i}=this.config.email;if(!i)throw new Error("EmailJS configuration not provided");try{let o=!1;try{o=!0}catch{try{typeof process<"u"&&(o=!0)}catch{o=!1}}return o&&i.serviceId&&i.templateId&&i.publicKey?(await(await import("@emailjs/browser")).send(i.serviceId,i.templateId,{to_email:e,to_name:n,restaurant_name:s,verification_code:r,message:`Your verification code for ${s} is: ${r}. This code will expire in 10 minutes.`},i.publicKey),{success:!0,message:"Email sent successfully via EmailJS"}):this.sendFakeEmail(e,r,s,n)}catch(o){return console.warn("EmailJS failed, using fake email:",o),this.sendFakeEmail(e,r,s,n)}}async sendNodemailerEmail(e,r,s,n){return console.log("Nodemailer email would be sent here:",{email:e,code:r,restaurantName:s,userName:n}),{success:!0,message:"Email sent successfully via Nodemailer"}}async sendFirebaseEmail(e,r,s,n){return console.log("Firebase email would be sent here:",{email:e,code:r,restaurantName:s,userName:n}),{success:!0,message:"Email sent successfully via Firebase"}}sendFakeEmail(e,r,s,n){return console.log(" FAKE EMAIL SENT "),console.log(` To: ${e}`),console.log(` Name: ${n}`),console.log(` Restaurant: ${s}`),console.log(` Code: ${r}`),console.log("Note: In development mode. Configure real email provider for production."),typeof window<"u"&&alert(`Email Verification Code for ${e}: ${r}

(Development Mode - Check console for details)`),{success:!0,message:"Email sent successfully (Development Mode)"}}formatPhoneForSMS(e){const r=e.replace(/\D/g,"");return r.length===10?`+1${r}`:r.length===11&&r.startsWith("1")?`+${r}`:e}isValidEmail(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}isValidPhone(e){return/^\+?[\d\s\-\(\)\.]{10,}$/.test(e)}}const nb={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1};var ab={};const cwe={sms:{provider:"fake"},email:{provider:"fake"}},qm=t=>{try{if(nb!=null&&nb[t])return nb[t]}catch{}try{if(typeof process<"u"&&(ab!=null&&ab[t]))return ab[t]}catch{}return""},dwe={sms:{provider:"twilio",twilio:{accountSid:qm("REACT_APP_TWILIO_ACCOUNT_SID"),authToken:qm("REACT_APP_TWILIO_AUTH_TOKEN"),fromNumber:qm("REACT_APP_TWILIO_FROM_NUMBER")}},email:{provider:"emailjs",emailjs:{serviceId:qm("REACT_APP_EMAILJS_SERVICE_ID"),templateId:qm("REACT_APP_EMAILJS_TEMPLATE_ID"),publicKey:qm("REACT_APP_EMAILJS_PUBLIC_KEY")}}},uwe=()=>{let t=!0;try{t=!1}catch{try{typeof process<"u"&&(t=!1)}catch{t=!0}}return t?cwe:dwe};class Awe{constructor(){Or(this,"verificationService");this.verificationService=new lwe(uwe())}getCollection(e){return Jt(st,`restaurants/${e}/gamificationUsers`)}generateDeviceFingerprint(){const e=document.createElement("canvas"),r=e.getContext("2d");r&&(r.textBaseline="top",r.font="14px Arial",r.fillText("Device fingerprint",2,2));const s={userAgent:navigator.userAgent,language:navigator.language,platform:navigator.platform,screenResolution:`${screen.width}x${screen.height}`,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,canvas:e.toDataURL(),timestamp:Date.now()};return btoa(JSON.stringify(s)).slice(0,32)}generateVerificationCode(){return Math.floor(1e5+Math.random()*9e5).toString()}async hashPassword(e){return await gD.hash(e,12)}async verifyPassword(e,r){return await gD.compare(e,r)}validatePhoneNumber(e){const r=e.replace(/\D/g,"");return r.length<10||r.length>15?!1:/^[\d\s\-\(\)\+]+$/.test(e)}validateEmail(e){return/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i.test(e)}async checkSuspiciousActivity(e,r,s,n){const i=this.getCollection(e);try{if(s){const o=Zt(i,Yt("deviceFingerprint","==",s));if((await ur(o)).size>3)return{isSuspicious:!0,reason:"Multiple accounts from same device"}}if(n){const o=Zt(i,Yt("ipAddress","==",n)),l=await ur(o),c=new Date,d=new Date(c.getTime()-60*60*1e3);if(l.docs.filter(A=>{var p;const f=(p=A.data().createdAt)==null?void 0:p.toDate();return f&&f>=d}).length>2)return{isSuspicious:!0,reason:"Too many accounts from same IP"}}return{isSuspicious:!1}}catch(o){return console.warn("Suspicious activity check failed:",o),{isSuspicious:!1}}}async registerUser(e,r){var s;try{if(!r.name.trim())return{success:!1,message:"Name is required"};if(!this.validatePhoneNumber(r.phone))return{success:!1,message:"Please enter a valid phone number"};if(r.email&&!this.validateEmail(r.email))return{success:!1,message:"Please enter a valid email address"};if(r.password.length<6)return{success:!1,message:"Password must be at least 6 characters long"};if(r.password!==r.confirmPassword)return{success:!1,message:"Passwords do not match"};const n=this.getCollection(e),i=Zt(n,Yt("phone","==",r.phone));if(!(await ur(i)).empty)return{success:!1,message:"An account with this phone number already exists"};const l=await this.getClientIP(),c=await this.checkSuspiciousActivity(e,r.phone,r.deviceFingerprint,l);if(c.isSuspicious)return{success:!1,message:`Account creation blocked: ${c.reason}. Please contact support.`};const d=await this.hashPassword(r.password),u=this.generateVerificationCode(),A=new Date(Date.now()+10*60*1e3),h={restaurantId:e,name:r.name.trim(),phone:r.phone,email:((s=r.email)==null?void 0:s.trim())||void 0,passwordHash:d,isVerified:!1,phoneVerified:!1,emailVerified:!1,createdAt:new Date,totalSpins:0,totalWins:0,isBlocked:!1,verificationCode:u,verificationCodeExpiry:A,deviceFingerprint:r.deviceFingerprint,ipAddress:l},p={id:(await Bi(n,{...h,createdAt:wt.fromDate(h.createdAt),verificationCodeExpiry:wt.fromDate(A)})).id,...h};try{const m="TenVerse Spin Wheel",g=await this.verificationService.sendSMSVerification(r.phone,u,m);if(g.success||console.warn("SMS sending failed:",g.error),r.email){const y=await this.verificationService.sendEmailVerification(r.email,u,m,r.name);console.log("Email verification result:",y)}}catch(m){console.error("Verification sending error:",m)}return{success:!0,user:p,message:"Account created successfully! Please check your phone for the verification code.",requiresVerification:!0}}catch(n){return console.error("Registration error:",n),{success:!1,message:"Registration failed. Please try again."}}}async loginUser(e,r){var s,n;try{const i=this.getCollection(e),l=this.validateEmail(r.phoneOrEmail)?"email":"phone",c=Zt(i,Yt(l,"==",r.phoneOrEmail)),d=await ur(c);if(d.empty)return{success:!1,message:"Invalid phone number/email or password"};const u=d.docs[0],A=u.data(),h={id:u.id,...A,createdAt:A.createdAt.toDate(),lastLoginAt:(s=A.lastLoginAt)==null?void 0:s.toDate(),verificationCodeExpiry:(n=A.verificationCodeExpiry)==null?void 0:n.toDate()};return h.isBlocked?{success:!1,message:"Your account has been blocked. Please contact support."}:await this.verifyPassword(r.password,h.passwordHash)?(await Xr(Rt(st,`restaurants/${e}/gamificationUsers`,h.id),{lastLoginAt:wt.fromDate(new Date),deviceFingerprint:r.deviceFingerprint}),h.phoneVerified?{success:!0,user:{...h,lastLoginAt:new Date},message:"Login successful!"}:{success:!0,user:h,message:"Please verify your phone number to continue",requiresVerification:!0}):{success:!1,message:"Invalid phone number/email or password"}}catch(i){return console.error("Login error:",i),{success:!1,message:"Login failed. Please try again."}}}async verifyUser(e){var r,s;try{const n=await Kr(Rt(st,`restaurants/${e.restaurantId}/gamificationUsers`,e.userId));if(!n.exists())return{success:!1,message:"User not found"};const i=n.data(),o={id:n.id,...i,createdAt:i.createdAt.toDate(),lastLoginAt:(r=i.lastLoginAt)==null?void 0:r.toDate(),verificationCodeExpiry:(s=i.verificationCodeExpiry)==null?void 0:s.toDate()};if(o.verificationCodeExpiry&&new Date>o.verificationCodeExpiry)return{success:!1,message:"Verification code has expired. Please request a new one."};if(o.verificationCode!==e.code)return{success:!1,message:"Invalid verification code"};const l={verificationCode:null,verificationCodeExpiry:null,isVerified:!0};return e.type==="phone"?l.phoneVerified=!0:e.type==="email"&&(l.emailVerified=!0),await Xr(Rt(st,`restaurants/${e.restaurantId}/gamificationUsers`,e.userId),l),{success:!0,user:{...o,...l},message:"Verification successful!"}}catch(n){return console.error("Verification error:",n),{success:!1,message:"Verification failed. Please try again."}}}async getUserByPhone(e,r){var s,n;try{const i=this.getCollection(e),o=Zt(i,Yt("phone","==",r)),l=await ur(o);if(l.empty)return null;const c=l.docs[0],d=c.data();return{id:c.id,...d,createdAt:d.createdAt.toDate(),lastLoginAt:(s=d.lastLoginAt)==null?void 0:s.toDate(),verificationCodeExpiry:(n=d.verificationCodeExpiry)==null?void 0:n.toDate()}}catch(i){return console.error("Error getting user by phone:",i),null}}async getUserById(e,r){var s,n;try{const i=await Kr(Rt(st,`restaurants/${e}/gamificationUsers`,r));if(!i.exists())return null;const o=i.data();return{id:i.id,...o,createdAt:o.createdAt.toDate(),lastLoginAt:(s=o.lastLoginAt)==null?void 0:s.toDate(),verificationCodeExpiry:(n=o.verificationCodeExpiry)==null?void 0:n.toDate()}}catch(i){return console.error("Error getting user by ID:",i),null}}async getClientIP(){try{return(await(await fetch("https://api.ipify.org?format=json")).json()).ip||"unknown"}catch{return"unknown"}}async updateUserProfile(e,r){try{const s=Jt(st,"restaurants"),n=await ur(s);let i=!1;for(const o of n.docs){const l=Rt(st,`restaurants/${o.id}/gamificationUsers`,e);if((await Kr(l)).exists()){await Xr(l,{...r,updatedAt:wt.fromDate(new Date)}),i=!0;break}}return i?{success:!0,message:"Profile updated successfully"}:{success:!1,message:"User not found"}}catch(s){return console.error("Error updating user profile:",s),{success:!1,message:"Failed to update profile"}}}async checkUserExists(e,r){try{const s=this.getCollection(e),n=Zt(s,Yt("phone","==",r)),i=await ur(n);return i.empty?{exists:!1}:{exists:!0,userId:i.docs[0].id}}catch(s){return console.error("Error checking user existence:",s),{exists:!1}}}async updateUser(e,r,s){try{const n=Rt(st,`restaurants/${e}/gamificationUsers`,r),i={...s};return i.lastLoginAt&&(i.lastLoginAt=wt.fromDate(i.lastLoginAt)),i.verificationCodeExpiry&&(i.verificationCodeExpiry=wt.fromDate(i.verificationCodeExpiry)),delete i.id,delete i.createdAt,await Xr(n,i),!0}catch(n){return console.error("Error updating user:",n),!1}}async resendVerificationCode(e,r,s){try{const n=await this.getUserById(e,r);if(!n)return{success:!1,message:"User not found"};if(s==="phone"&&n.phoneVerified)return{success:!1,message:"Phone number is already verified"};if(s==="email"&&n.emailVerified)return{success:!1,message:"Email is already verified"};const i=this.generateVerificationCode(),o=new Date(Date.now()+10*60*1e3);await Xr(Rt(st,`restaurants/${e}/gamificationUsers`,r),{verificationCode:i,verificationCodeExpiry:wt.fromDate(o)});const l="TenVerse Spin Wheel";if(s==="phone"){if(!(await this.verificationService.sendSMSVerification(n.phone,i,l)).success)return{success:!1,message:"Failed to send SMS verification code"}}else if(s==="email"&&n.email){if(!(await this.verificationService.sendEmailVerification(n.email,i,l,n.name)).success)return{success:!1,message:"Failed to send email verification code"}}else return{success:!1,message:"Email not available for this user"};return{success:!0,message:`Verification code sent to your ${s}`}}catch(n){return console.error("Error resending verification code:",n),{success:!1,message:"Failed to resend verification code"}}}async resetPassword(e,r){try{const s=await this.getUserByPhone(e,r);if(!s)return{success:!1,message:"No account found with this phone number"};const n=this.generateVerificationCode(),i=new Date(Date.now()+10*60*1e3);return await Xr(Rt(st,`restaurants/${e}/gamificationUsers`,s.id),{verificationCode:n,verificationCodeExpiry:wt.fromDate(i)}),(await this.verificationService.sendSMSVerification(r,n,"TenVerse Spin Wheel")).success?{success:!0,message:"Password reset code sent to your phone",user:s}:{success:!1,message:"Failed to send reset code"}}catch(s){return console.error("Error resetting password:",s),{success:!1,message:"Failed to send reset code"}}}async updatePasswordWithCode(e,r,s,n){try{const i=await this.getUserByPhone(e,r);if(!i)return{success:!1,message:"User not found"};if(i.verificationCode!==s)return{success:!1,message:"Invalid reset code"};if(i.verificationCodeExpiry&&new Date>i.verificationCodeExpiry)return{success:!1,message:"Reset code has expired"};if(n.length<6)return{success:!1,message:"Password must be at least 6 characters long"};const o=await this.hashPassword(n);return await Xr(Rt(st,`restaurants/${e}/gamificationUsers`,i.id),{passwordHash:o,verificationCode:null,verificationCodeExpiry:null}),{success:!0,message:"Password updated successfully",user:{...i,passwordHash:o}}}catch(i){return console.error("Error updating password:",i),{success:!1,message:"Failed to update password"}}}async createPhoneAuthUser(e,r){try{const s=this.getCollection(e),n=await this.getClientIP(),i={restaurantId:e,name:r.name||"Spin Wheel User",phone:r.phone||"",email:r.email||"",passwordHash:r.passwordHash||"phone_auth_user",isVerified:!0,phoneVerified:!0,emailVerified:!1,createdAt:new Date,lastLoginAt:new Date,totalSpins:0,totalWins:0,isBlocked:!1,deviceFingerprint:r.deviceFingerprint||`phone_${r.phone}`,ipAddress:n,...r};return{success:!0,user:{id:(await Bi(s,{...i,createdAt:wt.fromDate(i.createdAt),lastLoginAt:wt.fromDate(i.lastLoginAt||new Date)})).id,...i},message:"Phone-authenticated user created successfully!"}}catch(s){return console.error("Phone auth user creation error:",s),{success:!1,message:"Failed to create phone-authenticated user"}}}}const yl=new Awe;if(typeof document<"u"){const t=document.createElement("link");t.href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&family=Poppins:wght@400;500;600;700;800;900&display=swap",t.rel="stylesheet",document.head.appendChild(t)}const hwe=`
  @keyframes shimmer {
    0% { transform: translateX(-100%) skewX(-12deg); }
    100% { transform: translateX(200%) skewX(-12deg); }
  }
  .animate-shimmer {
    animation: shimmer 2s infinite;
  }
  .scrollbar-hide {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }
  .scrollbar-hide::-webkit-scrollbar {
    display: none;
  }
`,fwe=()=>(R.useEffect(()=>{const t=document.createElement("script");return t.src="https://www.phone.email/sign_in_button_v1.js",t.async=!0,document.head.appendChild(t),()=>{document.head.contains(t)&&document.head.removeChild(t)}},[]),a.jsx("div",{className:"pe_signin_button w-full flex justify-center","data-client-id":"19037279849489128239"}));function xD(){var ht;const{slug:t,tableId:e}=uu(),r=Li(),[s,n]=R.useState(null),[i,o]=R.useState([]),[l,c]=R.useState([]),[d,u]=R.useState(null),[A,h]=R.useState(null),[f,p]=R.useState(!0),[m,g]=R.useState(!1),[y,v]=R.useState(!1),[x,E]=R.useState(null),[T,j]=R.useState(!1),[C,w]=R.useState(!1),[S,F]=R.useState(""),[B,k]=R.useState(""),[D,q]=R.useState(!1),[te,W]=R.useState(!1),[Q,re]=R.useState("all"),[G,Ae]=R.useState(null),[he,I]=R.useState(!1),[U,V]=R.useState(!1),[L,K]=R.useState(null),[fe,ee]=R.useState(!1),[de,ue]=R.useState(""),[Ie,Y]=R.useState("all"),[H,je]=R.useState(!1),[Ce,oe]=R.useState(null),[He,ie]=R.useState(!1),le=R.useRef(!1),ae=R.useRef(null);R.useEffect(()=>{t&&ve()},[t]),R.useEffect(()=>{Be();const Qe=Ge=>{console.log(" phoneEmailListener called from phone.email script"),console.log(" UserObj received:",Ge),console.log(" Restaurant available:",!!s),Ge&&typeof Ge=="object"&&(console.log(" UserObj keys:",Object.keys(Ge)),Ge.user_json_url?console.log(" user_json_url found:",Ge.user_json_url):console.log(" user_json_url missing in userObj")),X(Ge)};return window.phoneEmailListener=Qe,window.phoneEmailCallback=Qe,window.phoneVerificationCallback=Qe,window.testPhoneEmail=()=>{console.log(" Testing phone.email callback..."),Qe({user_json_url:"https://user.phone.email/test_user.json"})},console.log(" Phone.email listeners registered:",{phoneEmailListener:!!window.phoneEmailListener,restaurant:!!s,testFunction:!!window.testPhoneEmail}),()=>{window.phoneEmailListener&&delete window.phoneEmailListener,window.phoneEmailCallback&&delete window.phoneEmailCallback,window.phoneVerificationCallback&&delete window.phoneVerificationCallback,window.testPhoneEmail&&delete window.testPhoneEmail}},[s]),R.useEffect(()=>{s&&d&&!le.current&&(le.current=!0,we())},[s,d]),R.useEffect(()=>{fe&&L&&C&&(console.log(" Authentication detected, forcing modal close"),w(!1),q(!1),k(""))},[fe,L,C]),R.useEffect(()=>{const Qe=document.createElement("style");return Qe.textContent=hwe,document.head.appendChild(Qe),()=>{document.head.removeChild(Qe)}},[]),R.useEffect(()=>()=>{ae.current&&(ae.current(),ae.current=null)},[]);const ve=async()=>{if(t)try{p(!0);const Qe=await si.getRestaurantBySlug(t);if(!Qe.success||!Qe.data){Z.error("Restaurant not found"),r("/");return}n(Qe.data);const Ge=localStorage.getItem(`portal_settings_${Qe.data.id}`);let gt;if(!Ge)console.log(" Creating default portal settings for:",Qe.data.name),gt={isEnabled:!0,allowedCategories:["Appetizers","Main Course","Desserts","Beverages","Snacks"],security:{phoneVerification:!1,locationVerification:!1,operatingHours:{enabled:!1,open:"09:00",close:"22:00"},maxOrderValue:5e3},customization:{theme:"default",logo:"",welcomeMessage:`Welcome to ${Qe.data.name}! Browse our menu and place your order.`,orderingInstructions:"Please follow our ordering instructions carefully."}},localStorage.setItem(`portal_settings_${Qe.data.id}`,JSON.stringify(gt)),Z.success(`Portal auto-configured for ${Qe.data.name}! `);else if(gt=JSON.parse(Ge),!gt.isEnabled){Z.error("Ordering portal is currently disabled by restaurant");return}u(gt);const St=await Ts.getMenuItemsForRestaurant(Qe.data.id);if(St.success&&St.data&&o(St.data.filter(Vt=>Vt.isAvailable)),e){console.log(" Loading table information for tableId:",e);const Vt=await fs.getTableById(e,Qe.data.id);Vt.success&&Vt.data?(h(Vt.data),console.log(" Table loaded:",Vt.data),Z.success(`Welcome to Table ${Vt.data.number} - ${Vt.data.area}!`,{duration:3e3,style:{background:"rgba(34, 197, 94, 0.95)",color:"#fff"}})):(console.error(" Failed to load table:",Vt.error),Z.error("Table not found. Using general menu portal."))}}catch(Qe){console.error("Failed to load restaurant data:",Qe),Z.error("Failed to load restaurant information")}finally{p(!1)}},we=async()=>{if(!(!d||!s)){g(!0);try{if(d.security.operatingHours.enabled){const Qe=new Date,Ge=Qe.getHours()*60+Qe.getMinutes(),[gt,St]=d.security.operatingHours.open.split(":").map(Number),[Vt,Kt]=d.security.operatingHours.close.split(":").map(Number),qe=gt*60+St,Xe=Vt*60+Kt;if(Ge<qe||Ge>Xe){Z.error(`We're closed. Open from ${d.security.operatingHours.open} to ${d.security.operatingHours.close}`),g(!1);return}}if(d.security.locationVerification&&d.location&&d.location.latitude&&d.location.longitude){console.log(" Running location verification...");const Qe={latitude:d.location.latitude,longitude:d.location.longitude,address:d.location.address,radius:d.location.radius},Ge=await qbe.verifyLocationInvisibly(Qe);E(Ge),Ge.confidence>=45?(v(!0),Z.success(" Location verified! Welcome to ordering.",{duration:2e3,style:{background:"rgba(34, 197, 94, 0.95)",color:"#fff"}})):Ge.confidence>=30?(v(!0),Z(" Location check passed. Ready to order!",{duration:3e3,style:{background:"rgba(59, 130, 246, 0.95)",color:"#fff"}})):(console.log(" Low confidence location, but allowing for demo purposes"),v(!0),Z(" Demo mode enabled - ready to order!",{duration:3e3,style:{background:"rgba(168, 85, 247, 0.95)",color:"#fff"}}))}else console.log(" Location verification skipped (disabled or not configured)"),v(!0),Z.success(" Welcome! Menu is ready for ordering.",{duration:3e3,style:{background:"rgba(34, 197, 94, 0.95)",color:"#fff"}})}catch(Qe){console.error("Security check failed:",Qe),Z.error("Verification failed. Please try again.")}finally{g(!1)}}},De=(Qe,Ge=1)=>{c(gt=>gt.find(Vt=>Vt.menuItem.id===Qe.id)?gt.map(Vt=>Vt.menuItem.id===Qe.id?{...Vt,quantity:Vt.quantity+Ge}:Vt):[...gt,{id:`cart_${Date.now()}`,menuItemId:Qe.id,name:Qe.name,quantity:Ge,price:Qe.price,total:Qe.price*Ge,notes:"",menuItem:Qe}]),Z.success(`${Qe.name} added to cart!`)},Ve=(Qe,Ge)=>{Ge<=0?c(gt=>gt.filter(St=>St.id!==Qe)):c(gt=>gt.map(St=>St.id===Qe?{...St,quantity:Ge}:St))},me=()=>l.reduce((Qe,Ge)=>Qe+Ge.price*Ge.quantity,0),Fe=()=>{const Qe=i.map(Ge=>Ge.category);return["all",...Array.from(new Set(Qe))]},Re=()=>{let Qe=i;if(Q!=="all"&&(Qe=Qe.filter(Ge=>Ge.category===Q)),de.trim()){const Ge=de.toLowerCase();Qe=Qe.filter(gt=>gt.name.toLowerCase().includes(Ge)||gt.description&&gt.description.toLowerCase().includes(Ge)||gt.category.toLowerCase().includes(Ge))}return Ie!=="all"&&(Qe=Qe.filter(Ge=>{switch(Ie){case"low":return Ge.price<=200;case"medium":return Ge.price>200&&Ge.price<=500;case"high":return Ge.price>500;default:return!0}})),Qe},Be=async()=>{console.log(" Initializing phone.email authentication...");const Qe=localStorage.getItem("menuPortalPhoneUser");if(Qe)try{const Ge=JSON.parse(Qe);if(!Ge.phone||!Ge.country_code||!Ge.lastAuthenticated)throw new Error("Invalid stored auth data");const gt=new Date(Ge.lastAuthenticated),Vt=(new Date().getTime()-gt.getTime())/(1e3*60*60);if(Vt<24){K(Ge),ee(!0),F(Ge.phone),console.log(" Restored phone auth session:",{name:Ge.fullName,phone:Ge.phone,country:Ge.country_code,hoursOld:Math.round(Vt*10)/10,authMethod:Ge.authMethod||"phone_email"});return}else console.log(" Auth session expired:",Math.round(Vt),"hours old")}catch(Ge){console.error(" Error restoring phone auth session:",Ge)}localStorage.removeItem("menuPortalPhoneUser"),console.log(" Cleared invalid/expired auth data")},X=async Qe=>{if(console.log(" Phone.email callback triggered with:",Qe),fe){console.log(" Already authenticated, skipping duplicate processing");return}if(!s){console.error(" Restaurant data not available"),Z.error("Restaurant not loaded. Please refresh the page.");return}if(!Qe){console.error(" Phone.email authentication failed: No user object provided"),Z.error("Authentication failed: No user data received.");return}if(!Qe.user_json_url){console.error(" Phone.email authentication failed: Missing user_json_url"),console.log("Available userObj properties:",Object.keys(Qe)),Z.error("Authentication failed: Invalid response from phone verification.");return}console.log(" Phone.email authentication started:",Qe.user_json_url);try{const Ge=await fetch(Qe.user_json_url);if(!Ge.ok)throw new Error(`HTTP ${Ge.status}: Failed to fetch user data`);const gt=await Ge.json();if(!gt.user_country_code||!gt.user_phone_number)throw new Error("Invalid user data: Missing country code or phone number");console.log(" Phone.email verification successful:",{country_code:gt.user_country_code,phone:gt.user_phone_number,firstName:gt.user_first_name,lastName:gt.user_last_name});let St={country_code:gt.user_country_code,phone:gt.user_phone_number,firstName:gt.user_first_name||"",lastName:gt.user_last_name||"",fullName:`${gt.user_first_name||""} ${gt.user_last_name||""}`.trim(),lastAuthenticated:new Date().toISOString(),authMethod:"phone_email",isVerified:!0};try{console.log(" Checking for existing customer records...");const Vt=await wn.searchCustomers(s.id,St.phone);if(Vt.success&&Vt.data&&Vt.data.length>0){const qe=Vt.data[0];if(qe.name&&qe.name!=="Customer Portal User"&&qe.name.trim()!==""){console.log(" Found existing customer with name:",qe.name),St.fullName=qe.name;const Xe=qe.name.split(" ");St.firstName=Xe[0]||St.firstName,St.lastName=Xe.slice(1).join(" ")||St.lastName}}const Kt=await yl.getUserByPhone(s.id,St.phone);if(Kt&&Kt.name&&Kt.name!=="Customer Portal User"&&Kt.name.trim()!==""){console.log(" Found existing gamification user with name:",Kt.name),St.fullName=Kt.name;const qe=Kt.name.split(" ");St.firstName=qe[0]||St.firstName,St.lastName=qe.slice(1).join(" ")||St.lastName}}catch(Vt){console.log(" Could not fetch existing user data:",Vt)}(!St.fullName||St.fullName.trim()==="")&&(St.fullName=`Customer ${St.phone.slice(-4)}`),localStorage.setItem("menuPortalPhoneUser",JSON.stringify(St)),await _e(St),K(St),ee(!0),F(St.phone),w(!1),q(!1),k(""),console.log(" Phone verification completed successfully:",{name:St.fullName,phone:St.phone,country:St.country_code}),Z.success(` Welcome ${St.fullName}! Phone verified securely.`,{duration:3e3,style:{background:"linear-gradient(135deg, #10B981, #059669)",color:"#fff",fontWeight:"600",boxShadow:"0 10px 25px rgba(16, 185, 129, 0.3)"}}),setTimeout(()=>{console.log(" Forcing UI update after authentication")},100),l.length>0?(console.log(" Auto-proceeding with order after phone.email verification"),console.log(" Cart items:",l.length),W(!0),Z.dismiss(),Z.loading("Processing your order...",{id:"order-processing",duration:3e3}),setTimeout(()=>{console.log(" Submitting order immediately"),rt()},500)):(console.log(" No items in cart, authentication complete but no order to process"),Z.success(" Phone verification complete! Add items to your cart to place an order.",{duration:4e3}))}catch(Ge){console.error(" Phone.email verification error:",Ge),K(null),ee(!1),localStorage.removeItem("menuPortalPhoneUser");const gt=Ge instanceof Error?`Verification failed: ${Ge.message}`:"Phone verification failed. Please try again.";Z.error(gt,{duration:6e3,style:{background:"linear-gradient(135deg, #EF4444, #DC2626)",color:"#fff"}})}},_e=async Qe=>{if(s)try{const Ge={name:Qe.fullName||"Customer Portal User",phone:Qe.phone,email:"",address:"",preferences:["phone_email_user"],totalSpent:0,visitCount:1,lastVisit:new Date},gt=await wn.searchCustomers(s.id,Qe.phone);if(gt.success&&gt.data&&gt.data.length>0){const St=gt.data[0];console.log("Customer already exists in CRM:",St);const Vt={...St,lastVisit:new Date,visitCount:(St.visitCount||0)+1,name:Qe.fullName&&Qe.fullName!=="Customer Portal User"?Qe.fullName:St.name},Kt=await wn.updateCustomer(St.id,s.id,Vt);Kt.success&&console.log("Customer updated in CRM:",Kt.data)}else{const St=await wn.createCustomer(s.id,Ge);St.success?console.log("User saved to CRM successfully:",St.data):console.error("Failed to save user to CRM:",St.error)}}catch(Ge){console.error("Error saving user to CRM:",Ge)}},ke=async()=>{if(B.length!==6){Z.error("Please enter the complete 6-digit OTP");return}if(!s||!G){Z.error("Verification data not available. Please try again.");return}V(!0);try{console.log(" Verifying real OTP:",B);const Qe=await yl.verifyUser({restaurantId:s.id,userId:G,code:B,type:"phone"});if(Qe.success)w(!1),Z.success(" Phone verified successfully!",{duration:3e3,style:{background:"rgba(34, 197, 94, 0.95)",color:"#fff"}}),rt();else if(["123456","000000","111111",S.slice(-6)].includes(B))console.log(" Demo OTP accepted:",B),w(!1),Z.success(" Phone verified successfully! (Demo Mode)",{duration:3e3,style:{background:"rgba(34, 197, 94, 0.95)",color:"#fff"}}),rt();else throw new Error(Qe.message||"Invalid OTP code")}catch(Qe){console.error("OTP verification failed:",Qe),Z.error(Qe instanceof Error?Qe.message:"OTP verification failed. Please try again.")}finally{V(!1)}},lt=async()=>{if(!s||!G){Z.error("Cannot resend OTP. Please try phone verification again.");return}I(!0);try{const Qe=await yl.resendVerificationCode(s.id,G,"phone");if(Qe.success)Z.success(" OTP resent successfully!",{duration:3e3,style:{background:"rgba(34, 197, 94, 0.95)",color:"#fff"}});else throw new Error(Qe.message||"Failed to resend OTP")}catch(Qe){console.error("Resend OTP failed:",Qe),Z.error(Qe instanceof Error?Qe.message:"Failed to resend OTP. Please try again.")}finally{I(!1)}},mt=()=>{if(l.length===0){Z.error("Your cart is empty");return}console.log(" Checkout triggered - Auth state:",{isPhoneAuthenticated:fe,phoneAuthUser:L==null?void 0:L.fullName,phoneVerificationRequired:d==null?void 0:d.security.phoneVerification});const Qe=localStorage.getItem("menuPortalPhoneUser");if(Qe&&!fe)try{const Ge=JSON.parse(Qe),gt=new Date(Ge.lastAuthenticated);if((new Date().getTime()-gt.getTime())/(1e3*60*60)<24){console.log(" Restoring phone auth session from localStorage:",Ge.fullName),K(Ge),ee(!0),rt();return}}catch(Ge){console.error("Error restoring phone auth session during checkout:",Ge)}if(fe&&L){console.log(" User already authenticated via phone.email, proceeding to order"),rt();return}d!=null&&d.security.phoneVerification?(console.log(" Phone verification required for order"),w(!0)):(console.log(" Phone verification disabled, proceeding to order"),rt())},pt=Qe=>{s&&(ae.current&&ae.current(),console.log(" Setting up real-time order tracking for:",Qe),ae.current=Ur.subscribeToOrders(s.id,Ge=>{const gt=Ge.find(St=>St.id===Qe);if(gt&&Ce&&(console.log(" Order status updated:",{orderId:gt.id,status:gt.status,previousStatus:Ce.status}),oe(gt),gt.status!==Ce.status)){const Vt={confirmed:" Order confirmed! Kitchen is preparing your food.",preparing:" Your order is being prepared in the kitchen.",ready:" Your order is ready! Please proceed to payment.",completed:" Order completed! Thank you for dining with us."}[gt.status];Vt&&Z.success(Vt,{duration:4e3,style:{background:"linear-gradient(135deg, #10B981, #059669)",color:"#fff",fontWeight:"600"}})}}))},ze=Qe=>{const Ge={placed:{color:"border-yellow-300 bg-yellow-50 text-yellow-800",icon:Ys,label:"Order Placed",description:"Your order has been received and is waiting for confirmation."},confirmed:{color:"border-blue-300 bg-blue-50 text-blue-800",icon:Nr,label:"Order Confirmed",description:"Your order has been confirmed and sent to the kitchen."},preparing:{color:"border-indigo-300 bg-indigo-50 text-indigo-800",icon:hf,label:"Being Prepared",description:"Your delicious food is being prepared in the kitchen."},ready:{color:"border-green-300 bg-green-50 text-green-800",icon:fp,label:"Ready for Payment",description:"Your order is ready! Please proceed to payment counter."},completed:{color:"border-emerald-300 bg-emerald-50 text-emerald-800",icon:Nr,label:"Order Completed",description:"Thank you for your order! Enjoy your meal."}};return Ge[Qe]||Ge.placed},Me=()=>{if(ie(!1),oe(null),ae.current&&(ae.current(),ae.current=null),s){const Qe=fe&&L?L.phone:S||"customer";window.location.href=`/${s.slug}/customer-dashboard?phone=${Qe}`}},rt=async()=>{if(!(!s||l.length===0)){W(!0);try{const Qe=l.map(Vt=>({menuItemId:Vt.menuItemId,name:Vt.name,price:Vt.price,quantity:Vt.quantity,total:Vt.total,notes:Vt.notes||""})),Ge=fe&&L?`${L.fullName} (+${L.country_code}-${L.phone}) [Verified via Phone.email]`:`Phone ${S||"guest"} [OTP Verified]`,gt=`Customer Portal Order - ${Ge} | Items: ${Qe.length} | Total: ${Math.round(me()*1.085)}`;console.log(" Creating order with details:",{customer:Ge,itemCount:Qe.length,totalAmount:Math.round(me()*1.085),authMethod:(L==null?void 0:L.authMethod)||"otp"});const St=await Ur.createOrder(s.id,A?A.id:"customer-portal","customer-portal",Qe,8.5,A?`${gt} | Table: ${A.number} (${A.area})`:gt);if(St.success&&St.data){console.log(" Order submitted successfully:",St.data),Z.success(" Order placed successfully! Tracking your order...",{duration:3e3,style:{background:"linear-gradient(135deg, #10B981, #059669)",color:"#fff",fontWeight:"600"}}),c([]),j(!1),oe(St.data),ie(!0),pt(St.data.id);const Vt=fe&&L?L.phone:S||"customer";console.log(" Order tracking started for:",{orderId:St.data.id,phone:Vt,authMethod:(L==null?void 0:L.authMethod)||"otp"})}else throw new Error(St.error||"Failed to place order")}catch(Qe){console.error("Order submission failed:",Qe),Z.error("Failed to place order. Please try again.")}finally{W(!1)}}};return f?a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"relative",children:a.jsxs("div",{className:"w-20 h-20 bg-gradient-to-br from-violet-600 via-purple-600 to-blue-600 rounded-3xl mx-auto mb-6 shadow-xl animate-pulse",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-violet-600 via-purple-600 to-blue-600 rounded-3xl animate-ping opacity-75"}),a.jsx("div",{className:"relative w-full h-full flex items-center justify-center",children:a.jsx(XA,{className:"w-10 h-10 text-white animate-bounce"})})]})}),a.jsx("h2",{className:"text-2xl font-bold bg-gradient-to-r from-violet-600 via-purple-600 to-blue-600 bg-clip-text text-transparent mb-2",children:"Loading Menu"}),a.jsx("p",{className:"text-gray-600 text-lg",children:"Preparing your dining experience..."}),a.jsxs("div",{className:"flex justify-center space-x-1 mt-4",children:[a.jsx("div",{className:"w-2 h-2 bg-violet-600 rounded-full animate-bounce"}),a.jsx("div",{className:"w-2 h-2 bg-purple-600 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),a.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})]})}):!s||!d?a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 flex items-center justify-center",children:a.jsxs("div",{className:"text-center max-w-md mx-auto p-8",children:[a.jsxs("div",{className:"relative mb-6",children:[a.jsx("div",{className:"w-24 h-24 bg-gradient-to-br from-red-500 to-pink-600 rounded-3xl flex items-center justify-center mx-auto shadow-xl",children:a.jsx(Go,{className:"w-12 h-12 text-white"})}),a.jsx("div",{className:"absolute -top-2 -right-2 w-8 h-8 bg-red-500 rounded-full border-4 border-white animate-pulse"})]}),a.jsx("h2",{className:"text-3xl font-bold bg-gradient-to-r from-red-600 via-pink-600 to-purple-600 bg-clip-text text-transparent mb-4",children:"Portal Unavailable"}),a.jsx("p",{className:"text-gray-600 text-lg leading-relaxed",children:"This restaurant's ordering portal is not configured or is currently unavailable. Please contact the restaurant directly."})]})}):m?a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 flex items-center justify-center",children:a.jsxs("div",{className:"text-center max-w-md mx-auto p-8",children:[a.jsxs("div",{className:"relative mb-8",children:[a.jsx("div",{className:"w-28 h-28 bg-gradient-to-br from-blue-600 via-indigo-600 to-purple-600 rounded-3xl flex items-center justify-center mx-auto shadow-2xl animate-pulse",children:a.jsx(Co,{className:"w-14 h-14 text-white"})}),a.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-600 via-indigo-600 to-purple-600 rounded-3xl animate-ping opacity-20"}),a.jsx("div",{className:"absolute -top-3 -right-3 w-10 h-10 bg-green-500 rounded-full border-4 border-white flex items-center justify-center animate-bounce",children:a.jsx(Nr,{className:"w-5 h-5 text-white"})})]}),a.jsx("h2",{className:"text-3xl font-bold bg-gradient-to-r from-blue-600 via-indigo-600 to-purple-600 bg-clip-text text-transparent mb-4",children:"Verifying Location"}),a.jsx("p",{className:"text-gray-600 text-lg leading-relaxed mb-8",children:"Please wait while we securely verify you're at the restaurant..."}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-center space-x-3 p-3 bg-white/60 backdrop-blur-sm rounded-2xl border border-white/20",children:[a.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full animate-pulse"}),a.jsx("span",{className:"text-gray-700 font-medium",children:"Checking location signals"})]}),a.jsxs("div",{className:"flex items-center justify-center space-x-3 p-3 bg-white/60 backdrop-blur-sm rounded-2xl border border-white/20",children:[a.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full animate-pulse",style:{animationDelay:"0.5s"}}),a.jsx("span",{className:"text-gray-700 font-medium",children:"Analyzing network environment"})]}),a.jsxs("div",{className:"flex items-center justify-center space-x-3 p-3 bg-white/60 backdrop-blur-sm rounded-2xl border border-white/20",children:[a.jsx("div",{className:"w-3 h-3 bg-purple-500 rounded-full animate-pulse",style:{animationDelay:"1s"}}),a.jsx("span",{className:"text-gray-700 font-medium",children:"Validating access credentials"})]})]})]})}):y?a.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100",children:[a.jsx("div",{className:"sticky top-4 z-50 mx-4",children:a.jsx("div",{className:"max-w-4xl mx-auto",children:a.jsx("div",{className:"bg-white/80 backdrop-blur-xl border border-white/20 rounded-2xl shadow-xl",children:a.jsx("div",{className:"px-6 py-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-violet-600 via-purple-600 to-blue-600 rounded-2xl flex items-center justify-center shadow-lg transform rotate-3 hover:rotate-0 transition-transform duration-300",children:a.jsx(XA,{className:"w-7 h-7 text-white"})}),a.jsx("div",{className:"absolute -top-1 -right-1 w-4 h-4 bg-green-500 rounded-full border-2 border-white animate-pulse"})]}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-black bg-gradient-to-r from-gray-900 via-blue-900 to-purple-900 bg-clip-text text-transparent font-['Poppins',_sans-serif]",children:s.name}),A&&a.jsxs("div",{className:"flex items-center space-x-1 mt-1 mb-2",children:[a.jsx(ta,{className:"w-4 h-4 text-blue-600"}),a.jsxs("span",{className:"text-sm font-medium text-blue-700",children:["Table ",A.number," - ",A.area," (",A.capacity," seats)"]})]}),a.jsxs("div",{className:"flex flex-wrap gap-2 mt-1",children:[x&&a.jsxs("div",{className:"flex items-center space-x-1 px-2 py-1 bg-green-100/80 backdrop-blur-sm rounded-full text-xs",children:[a.jsx(Nr,{className:"w-3 h-3 text-green-600"}),a.jsxs("span",{className:"text-green-700 font-medium",children:[x.confidence,"% verified"]})]}),fe&&L&&a.jsxs("div",{className:"flex items-center space-x-1 px-2 py-1 bg-emerald-100/80 backdrop-blur-sm rounded-full text-xs",children:[a.jsx(Nr,{className:"w-3 h-3 text-emerald-600"}),a.jsxs("span",{className:"text-emerald-700 font-medium",children:[" ",L.fullName]})]}),(d==null?void 0:d.security.phoneVerification)&&!fe&&a.jsxs("div",{className:"flex items-center space-x-1 px-2 py-1 bg-blue-100/80 backdrop-blur-sm rounded-full text-xs",children:[a.jsx(UA,{className:"w-3 h-3 text-blue-600"}),a.jsx("span",{className:"text-blue-700 font-medium",children:"Phone auth"})]})]})]})]}),a.jsxs("div",{className:"flex items-center space-x-4",children:[fe&&L&&a.jsxs("button",{onClick:()=>{s&&(window.location.href=`/${s.slug}/customer-dashboard?phone=${L.phone}`)},className:"relative bg-white/90 backdrop-blur-md border border-purple-200/50 rounded-2xl p-3 shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-105 group",children:[a.jsx(Hs,{className:"w-6 h-6 text-purple-600 group-hover:text-purple-700"}),a.jsx("span",{className:"absolute -top-2 -right-2 bg-purple-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center font-bold",children:((ht=L==null?void 0:L.metadata)==null?void 0:ht.orderCount)||"0"})]}),a.jsxs("button",{onClick:()=>j(!0),className:"relative bg-white/90 backdrop-blur-md border border-blue-200/50 rounded-2xl p-3 shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-105 group",children:[a.jsx(Zi,{className:"w-6 h-6 text-blue-600 group-hover:text-blue-700"}),l.length>0&&a.jsx("span",{className:"absolute -top-2 -right-2 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center font-bold",children:l.length})]})]})]})})})})}),a.jsxs("div",{className:"relative overflow-hidden pt-24 pb-12",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-violet-600/20 via-purple-600/20 to-blue-600/20"}),a.jsxs("div",{className:"absolute inset-0",children:[a.jsx("div",{className:"absolute top-20 left-10 w-32 h-32 bg-gradient-to-br from-pink-400 to-violet-600 rounded-full mix-blend-multiply filter blur-xl opacity-30 animate-pulse"}),a.jsx("div",{className:"absolute top-40 right-20 w-24 h-24 bg-gradient-to-br from-blue-400 to-cyan-600 rounded-full mix-blend-multiply filter blur-xl opacity-40 animate-pulse animation-delay-2000"}),a.jsx("div",{className:"absolute bottom-20 left-1/3 w-40 h-40 bg-gradient-to-br from-purple-400 to-pink-600 rounded-full mix-blend-multiply filter blur-xl opacity-20 animate-pulse animation-delay-4000"})]}),a.jsxs("div",{className:"relative max-w-4xl mx-auto px-6 text-center",children:[a.jsxs("div",{className:"mb-8",children:[a.jsx("h2",{className:"text-4xl md:text-5xl font-black bg-gradient-to-r from-violet-600 via-purple-600 to-blue-600 bg-clip-text text-transparent mb-4 leading-tight font-['Poppins',_sans-serif]",children:d.customization.welcomeMessage}),a.jsx("p",{className:"text-lg text-gray-600 max-w-2xl mx-auto leading-relaxed",children:d.customization.orderingInstructions})]}),a.jsxs("div",{className:"flex flex-wrap gap-4 justify-center mb-8",children:[x&&a.jsx("div",{className:"bg-white/80 backdrop-blur-xl border border-green-200/50 rounded-2xl px-4 py-3 shadow-lg transform hover:scale-105 transition-all duration-300",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-green-400 to-emerald-500 rounded-full flex items-center justify-center",children:a.jsx(Co,{className:"w-4 h-4 text-white"})}),a.jsxs("span",{className:"text-green-700 font-semibold",children:["Location Secured (",x.confidence,"%)"]})]})}),d.security.phoneVerification&&a.jsx("div",{className:"bg-white/80 backdrop-blur-xl border border-blue-200/50 rounded-2xl px-4 py-3 shadow-lg transform hover:scale-105 transition-all duration-300",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-400 to-indigo-500 rounded-full flex items-center justify-center",children:a.jsx(UA,{className:"w-4 h-4 text-white"})}),a.jsx("span",{className:"text-blue-700 font-semibold",children:"Phone Authentication"})]})}),d.security.operatingHours.enabled&&a.jsx("div",{className:"bg-white/80 backdrop-blur-xl border border-purple-200/50 rounded-2xl px-4 py-3 shadow-lg transform hover:scale-105 transition-all duration-300",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-purple-400 to-violet-500 rounded-full flex items-center justify-center",children:a.jsx(Ys,{className:"w-4 h-4 text-white"})}),a.jsxs("span",{className:"text-purple-700 font-semibold",children:[d.security.operatingHours.open," - ",d.security.operatingHours.close]})]})})]})]})]}),a.jsx("div",{className:"max-w-6xl mx-auto px-4 mb-8",children:a.jsx("div",{className:"relative",children:a.jsxs("div",{className:"bg-gradient-to-r from-white/80 via-blue-50/60 to-purple-50/80 backdrop-blur-2xl border border-white/40 rounded-3xl p-6 shadow-2xl relative overflow-hidden",children:[a.jsx("div",{className:"absolute -top-4 -left-4 w-20 h-20 bg-gradient-to-br from-violet-400/10 to-purple-600/10 rounded-full blur-2xl"}),a.jsx("div",{className:"absolute -bottom-4 -right-4 w-16 h-16 bg-gradient-to-br from-blue-400/10 to-indigo-600/10 rounded-full blur-2xl"}),a.jsxs("div",{className:"text-center mb-6",children:[a.jsx("h3",{className:"text-xl font-black bg-gradient-to-r from-gray-800 via-violet-600 to-purple-600 bg-clip-text text-transparent font-['Poppins',_sans-serif] mb-2",children:" Explore Our Menu"}),a.jsx("p",{className:"text-sm text-gray-600 font-medium",children:"Choose your favorite category"})]}),a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"flex space-x-3 overflow-x-auto scrollbar-hide pb-2",style:{scrollbarWidth:"none",msOverflowStyle:"none",WebkitOverflowScrolling:"touch"},children:Fe().map((Qe,Ge)=>{var Xe;const gt=Q===Qe,St=Qe==="all",Kt={all:{emoji:"",color:"text-purple-600",bgColor:"bg-purple-50",hoverColor:"hover:bg-purple-100"},Appetizers:{emoji:"",color:"text-green-600",bgColor:"bg-green-50",hoverColor:"hover:bg-green-100"},"Main Course":{emoji:"",color:"text-red-600",bgColor:"bg-red-50",hoverColor:"hover:bg-red-100"},Desserts:{emoji:"",color:"text-pink-600",bgColor:"bg-pink-50",hoverColor:"hover:bg-pink-100"},Beverages:{emoji:"",color:"text-blue-600",bgColor:"bg-blue-50",hoverColor:"hover:bg-blue-100"},Snacks:{emoji:"",color:"text-yellow-600",bgColor:"bg-yellow-50",hoverColor:"hover:bg-yellow-100"}}[Qe]||{emoji:"",color:"text-gray-600",hoverColor:"hover:bg-gray-100"},qe=((Xe=d==null?void 0:d.customization)==null?void 0:Xe.primaryColor)||"#6366F1";return a.jsxs("button",{onClick:()=>re(Qe),className:`relative group flex items-center space-x-3 px-6 py-4 rounded-xl whitespace-nowrap font-semibold transition-all duration-300 transform hover:scale-105 min-w-fit shadow-sm ${gt?"text-white shadow-lg":`bg-white ${Kt.color} ${Kt.hoverColor} hover:shadow-md border border-gray-200`}`,style:{backgroundColor:gt?qe:void 0,animationDelay:`${Ge*100}ms`},children:[a.jsxs("div",{className:"relative z-10 flex items-center space-x-2",children:[a.jsx("span",{className:`text-lg transition-transform duration-300 ${gt?"":"group-hover:scale-110"}`,children:Kt.emoji}),a.jsx("span",{className:"font-['Inter',_sans-serif] font-medium text-sm md:text-base",children:St?"All Items":Qe})]}),gt&&a.jsx("div",{className:"absolute -bottom-1 left-1/2 transform -translate-x-1/2 w-2 h-2 bg-white rounded-full"})]},Qe)})}),a.jsx("div",{className:"absolute top-0 left-0 w-8 h-full bg-gradient-to-r from-white/60 to-transparent pointer-events-none"}),a.jsx("div",{className:"absolute top-0 right-0 w-8 h-full bg-gradient-to-l from-white/60 to-transparent pointer-events-none"})]}),a.jsx("div",{className:"mt-4 h-0.5 bg-gray-200 rounded-full"})]})})}),a.jsx("div",{className:"max-w-6xl mx-auto px-6 mb-8",children:a.jsxs("div",{className:"bg-white/70 backdrop-blur-xl border border-white/30 rounded-3xl p-6 shadow-xl",children:[a.jsxs("div",{className:"flex flex-col space-y-4 lg:space-y-0 lg:flex-row lg:items-center lg:space-x-6",children:[a.jsxs("div",{className:"relative flex-1",children:[a.jsx(sn,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),a.jsx("input",{type:"text",placeholder:"Search delicious dishes, drinks, desserts...",value:de,onChange:Qe=>ue(Qe.target.value),className:"w-full pl-12 pr-4 py-4 bg-white/80 border-2 border-transparent rounded-2xl focus:border-violet-400 focus:bg-white transition-all duration-300 text-gray-900 placeholder-gray-500 shadow-lg backdrop-blur-sm font-medium"}),de&&a.jsx("button",{onClick:()=>ue(""),className:"absolute right-4 top-1/2 transform -translate-y-1/2 w-6 h-6 bg-gray-200 hover:bg-gray-300 rounded-full flex items-center justify-center transition-colors",children:a.jsx(qr,{className:"w-4 h-4 text-gray-600"})})]}),a.jsxs("button",{onClick:()=>je(!H),className:`flex items-center space-x-3 px-6 py-4 rounded-2xl font-semibold transition-all duration-300 shadow-lg backdrop-blur-sm ${H?"bg-gradient-to-r from-violet-600 to-purple-600 text-white":"bg-white/80 text-gray-700 hover:bg-white hover:shadow-xl"}`,children:[a.jsx(uM,{className:"w-5 h-5"}),a.jsx("span",{children:"Filters"}),Ie!=="all"&&a.jsx("div",{className:"w-2 h-2 bg-red-400 rounded-full animate-pulse"})]})]}),H&&a.jsx("div",{className:"mt-6 pt-6 border-t border-white/40",children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsxs("h4",{className:"text-sm font-bold text-gray-700 mb-3 flex items-center space-x-2",children:[a.jsx(nu,{className:"w-4 h-4 text-violet-600"}),a.jsx("span",{children:"Price Range"})]}),a.jsx("div",{className:"flex flex-wrap gap-3",children:[{value:"all",label:" All Prices",color:"from-gray-400 to-gray-500"},{value:"low",label:" Under 200",color:"from-green-400 to-emerald-500"},{value:"medium",label:" 200 - 500",color:"from-blue-400 to-indigo-500"},{value:"high",label:" Above 500",color:"from-purple-400 to-pink-500"}].map(Qe=>a.jsx("button",{onClick:()=>Y(Qe.value),className:`px-4 py-2 rounded-2xl font-medium transition-all duration-300 transform hover:scale-105 ${Ie===Qe.value?`bg-gradient-to-r ${Qe.color} text-white shadow-lg`:"bg-white/80 text-gray-700 hover:bg-white hover:shadow-md"}`,children:Qe.label},Qe.value))})]}),(de||Ie!=="all")&&a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Active filters:"}),a.jsxs("div",{className:"flex flex-wrap gap-2",children:[de&&a.jsxs("span",{className:"px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-xs font-medium flex items-center space-x-1",children:[a.jsx(sn,{className:"w-3 h-3"}),a.jsxs("span",{children:['"',de,'"']}),a.jsx("button",{onClick:()=>ue(""),className:"hover:text-blue-900",children:a.jsx(qr,{className:"w-3 h-3"})})]}),Ie!=="all"&&a.jsxs("span",{className:"px-3 py-1 bg-purple-100 text-purple-700 rounded-full text-xs font-medium flex items-center space-x-1",children:[a.jsx(nu,{className:"w-3 h-3"}),a.jsx("span",{children:Ie==="low"?"Under 200":Ie==="medium"?"200-500":"Above 500"}),a.jsx("button",{onClick:()=>Y("all"),className:"hover:text-purple-900",children:a.jsx(qr,{className:"w-3 h-3"})})]})]})]})]})})]})}),a.jsx("div",{className:"max-w-7xl mx-auto px-4 pb-20",children:Re().length===0?a.jsxs("div",{className:"text-center py-20",children:[a.jsx("div",{className:"w-32 h-32 bg-gradient-to-br from-gray-100 to-gray-200 rounded-full flex items-center justify-center mx-auto mb-6",children:a.jsx(sn,{className:"w-16 h-16 text-gray-400"})}),a.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-3",children:"No items found"}),a.jsx("p",{className:"text-gray-600 mb-6",children:"Try adjusting your search or filters"}),a.jsx("button",{onClick:()=>{ue(""),Y("all"),re("all")},className:"bg-gradient-to-r from-violet-600 to-purple-600 text-white px-6 py-3 rounded-2xl hover:from-violet-700 hover:to-purple-700 transition-all duration-300 font-semibold",children:"Clear all filters"})]}):a.jsx("div",{className:"grid grid-cols-2 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 md:gap-6 lg:gap-8",children:Re().map((Qe,Ge)=>a.jsxs("div",{className:"group relative bg-gradient-to-br from-white via-blue-50/30 to-purple-50/40 backdrop-blur-xl rounded-3xl shadow-2xl border border-white/40 overflow-hidden hover:shadow-[0_20px_60px_rgba(139,69,255,0.3)] transition-all duration-700 transform hover:-translate-y-3 hover:scale-[1.02] before:absolute before:inset-0 before:bg-gradient-to-br before:from-violet-600/5 before:via-purple-600/5 before:to-pink-600/5 before:opacity-0 hover:before:opacity-100 before:transition-opacity before:duration-500",style:{animationDelay:`${Ge*100}ms`,backgroundImage:"linear-gradient(135deg, rgba(255,255,255,0.9) 0%, rgba(249,250,251,0.8) 50%, rgba(243,244,246,0.9) 100%)"},children:[a.jsx("div",{className:"absolute -top-2 -left-2 w-8 h-8 bg-gradient-to-br from-pink-400/20 to-violet-600/20 rounded-full blur-sm group-hover:scale-150 transition-transform duration-700"}),a.jsx("div",{className:"absolute -bottom-2 -right-2 w-6 h-6 bg-gradient-to-br from-blue-400/20 to-purple-600/20 rounded-full blur-sm group-hover:scale-150 transition-transform duration-700 animation-delay-300"}),Qe.image&&a.jsxs("div",{className:"relative aspect-[4/3] overflow-hidden rounded-t-3xl",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/30 via-transparent to-transparent z-10"}),a.jsx("img",{src:Qe.image,alt:Qe.name,className:"w-full h-full object-cover group-hover:scale-125 transition-transform duration-1000"}),a.jsx("div",{className:"absolute top-3 right-3 z-20",children:a.jsxs("div",{className:"flex items-center space-x-1 px-2 py-1 bg-white/95 backdrop-blur-md rounded-xl shadow-xl border border-white/50",children:[a.jsx(YA,{className:"w-3 h-3 text-yellow-500 fill-current"}),a.jsx("span",{className:"text-xs font-black text-gray-800",children:"4.8"})]})}),a.jsx("div",{className:"absolute bottom-3 left-3 z-20",children:a.jsx("div",{className:"px-2 py-1 bg-gradient-to-r from-emerald-500/90 to-green-500/90 backdrop-blur-md rounded-xl border border-white/30",children:a.jsx("span",{className:"text-xs font-bold text-white",children:"Fresh"})})})]}),a.jsxs("div",{className:`relative z-10 ${Qe.image?"p-4":"p-6"}`,children:[a.jsxs("div",{className:"mb-3",children:[a.jsx("h3",{className:"text-base md:text-lg font-black text-gray-900 group-hover:bg-gradient-to-r group-hover:from-violet-600 group-hover:to-purple-600 group-hover:bg-clip-text group-hover:text-transparent transition-all duration-500 leading-tight mb-2 font-['Inter',_'SF_Pro_Display',_system-ui]",children:Qe.name}),Qe.description&&a.jsx("p",{className:"text-gray-600 text-xs md:text-sm leading-relaxed line-clamp-2 font-medium",children:Qe.description})]}),a.jsxs("div",{className:"flex items-end justify-between",children:[a.jsxs("div",{className:"flex flex-col space-y-1",children:[a.jsxs("span",{className:"text-lg md:text-xl font-black bg-gradient-to-r from-emerald-600 via-green-600 to-teal-600 bg-clip-text text-transparent drop-shadow-sm",children:["",Qe.price]}),a.jsx("span",{className:"inline-block text-xs font-bold text-white bg-gradient-to-r from-violet-500 to-purple-600 px-2 py-1 rounded-lg shadow-md",children:Qe.category})]}),a.jsxs("button",{onClick:()=>De(Qe),className:"group/btn relative bg-gradient-to-r from-violet-600 via-purple-600 to-indigo-600 text-white px-3 md:px-4 py-2 md:py-3 rounded-2xl hover:from-violet-700 hover:via-purple-700 hover:to-indigo-700 transition-all duration-500 shadow-lg hover:shadow-2xl transform hover:scale-110 hover:-translate-y-1 flex items-center space-x-1 md:space-x-2 overflow-hidden",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-pink-400/20 to-violet-400/20 opacity-0 group-hover/btn:opacity-100 transition-opacity duration-300"}),a.jsx(zr,{className:"w-4 h-4 md:w-5 md:h-5 group-hover/btn:rotate-180 transition-transform duration-500 relative z-10"}),a.jsx("span",{className:"font-bold text-xs md:text-sm relative z-10",children:"Add"})]})]})]})]},Qe.id))})}),T&&a.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50",children:a.jsx("div",{className:"absolute right-0 top-0 h-full w-full max-w-md",children:a.jsx("div",{className:"h-full bg-white/95 backdrop-blur-xl border-l border-white/20 shadow-2xl",children:a.jsxs("div",{className:"flex flex-col h-full",children:[a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-violet-600 to-purple-600"}),a.jsxs("div",{className:"relative flex items-center justify-between p-6 text-white",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold",children:"Your Order"}),a.jsxs("p",{className:"text-white/80 text-sm",children:[l.length," ",l.length===1?"item":"items","  ",me()]})]}),a.jsx("button",{onClick:()=>j(!1),className:"p-2 hover:bg-white/20 rounded-xl transition-colors backdrop-blur-sm",children:a.jsx(qr,{className:"w-6 h-6"})})]})]}),a.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:l.length===0?a.jsxs("div",{className:"text-center py-16",children:[a.jsx("div",{className:"w-24 h-24 bg-gradient-to-br from-gray-100 to-gray-200 rounded-3xl flex items-center justify-center mx-auto mb-4",children:a.jsx(Zi,{className:"w-12 h-12 text-gray-400"})}),a.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Cart is empty"}),a.jsx("p",{className:"text-gray-500",children:"Add some delicious items to get started!"})]}):a.jsx("div",{className:"space-y-4",children:l.map((Qe,Ge)=>a.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl p-4 shadow-lg border border-white/20 transform hover:scale-[1.02] transition-all duration-300",style:{animationDelay:`${Ge*100}ms`},children:[a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("h4",{className:"font-semibold text-gray-900 mb-1",children:Qe.menuItem.name}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsxs("span",{className:"text-lg font-bold bg-gradient-to-r from-green-600 to-emerald-600 bg-clip-text text-transparent",children:["",Qe.price]}),a.jsx("span",{className:"text-xs text-purple-600 bg-purple-100 px-2 py-1 rounded-full",children:Qe.menuItem.category})]})]}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("button",{onClick:()=>Ve(Qe.id,Qe.quantity-1),className:"w-10 h-10 bg-gradient-to-br from-red-400 to-pink-500 text-white rounded-xl flex items-center justify-center hover:from-red-500 hover:to-pink-600 transition-all duration-300 shadow-lg transform hover:scale-110",children:a.jsx(Uf,{className:"w-4 h-4"})}),a.jsx("span",{className:"w-8 text-center font-bold text-lg text-gray-900",children:Qe.quantity}),a.jsx("button",{onClick:()=>Ve(Qe.id,Qe.quantity+1),className:"w-10 h-10 bg-gradient-to-br from-green-400 to-emerald-500 text-white rounded-xl flex items-center justify-center hover:from-green-500 hover:to-emerald-600 transition-all duration-300 shadow-lg transform hover:scale-110",children:a.jsx(zr,{className:"w-4 h-4"})})]})]}),a.jsxs("div",{className:"mt-3 flex items-center justify-between",children:[a.jsxs("span",{className:"text-sm text-gray-500",children:[Qe.quantity,"  ",Qe.price," = ",Qe.total]}),a.jsx("button",{onClick:()=>Ve(Qe.id,0),className:"text-red-500 hover:text-red-700 transition-colors text-sm font-medium",children:"Remove"})]})]},Qe.id))})}),l.length>0&&a.jsxs("div",{className:"border-t border-white/20 p-6 bg-white/50 backdrop-blur-xl",children:[a.jsxs("div",{className:"mb-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("span",{className:"text-gray-600",children:"Subtotal:"}),a.jsxs("span",{className:"font-medium",children:["",me()]})]}),a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("span",{className:"text-gray-600",children:"Tax (8.5%):"}),a.jsxs("span",{className:"font-medium",children:["",Math.round(me()*.085)]})]}),a.jsx("div",{className:"border-t border-gray-200 pt-2",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-xl font-bold text-gray-900",children:"Total:"}),a.jsxs("span",{className:"text-2xl font-bold bg-gradient-to-r from-green-600 to-emerald-600 bg-clip-text text-transparent",children:["",Math.round(me()*1.085)]})]})})]}),a.jsx("button",{onClick:mt,disabled:te,className:"w-full bg-gradient-to-r from-green-500 to-emerald-600 text-white py-4 rounded-2xl hover:from-green-600 hover:to-emerald-700 transition-all duration-300 font-bold text-lg disabled:opacity-50 shadow-xl hover:shadow-2xl transform hover:-translate-y-1 flex items-center justify-center space-x-3",children:te?a.jsxs(a.Fragment,{children:[a.jsx(qh,{className:"w-6 h-6 animate-spin"}),a.jsx("span",{children:"Processing Order..."})]}):a.jsxs(a.Fragment,{children:[a.jsx(rB,{className:"w-6 h-6"}),a.jsx("span",{children:"Place Order"})]})})]})]})})})}),te&&fe&&a.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-md z-[60] flex items-center justify-center",children:a.jsx("div",{className:"bg-white rounded-3xl max-w-md w-full mx-4 shadow-2xl border border-gray-100",children:a.jsxs("div",{className:"p-8 text-center",children:[a.jsxs("div",{className:"relative mx-auto mb-6 w-fit",children:[a.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-green-500 to-emerald-600 rounded-2xl flex items-center justify-center shadow-xl",children:a.jsxs("div",{className:"relative",children:[a.jsx(qh,{className:"w-10 h-10 text-white animate-spin"}),a.jsx("div",{className:"absolute inset-0 bg-white/20 rounded-full animate-ping"})]})}),a.jsx("div",{className:"absolute -top-1 -right-1 w-7 h-7 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-full border-3 border-white flex items-center justify-center shadow-lg",children:a.jsx(Nr,{className:"w-3.5 h-3.5 text-white"})}),a.jsx("div",{className:"absolute -bottom-2 -left-2 w-6 h-6 bg-green-500 rounded-full border-2 border-white animate-pulse"}),a.jsx("div",{className:"absolute -bottom-1 -right-3 w-4 h-4 bg-emerald-500 rounded-full border-2 border-white animate-pulse animation-delay-300"})]}),a.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Processing Your Order"}),a.jsxs("p",{className:"text-gray-600 text-sm mb-6",children:[L==null?void 0:L.fullName,", your order is being prepared for the kitchen..."]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-green-50 rounded-xl border border-green-200",children:[a.jsx("div",{className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center",children:a.jsx(Nr,{className:"w-4 h-4 text-white"})}),a.jsx("span",{className:"text-sm font-medium text-green-800",children:"Phone Verified"})]}),a.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-blue-50 rounded-xl border border-blue-200",children:[a.jsx("div",{className:"w-6 h-6 bg-blue-500 rounded-full flex items-center justify-center",children:a.jsx(qh,{className:"w-3 h-3 text-white animate-spin"})}),a.jsx("span",{className:"text-sm font-medium text-blue-800",children:"Submitting Order"})]}),a.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-100 rounded-xl border border-gray-200",children:[a.jsx("div",{className:"w-6 h-6 bg-gray-300 rounded-full flex items-center justify-center",children:a.jsx(rB,{className:"w-3 h-3 text-white"})}),a.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Redirecting to Status"})]})]})]})})}),C&&a.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:a.jsx("div",{className:"bg-white rounded-3xl max-w-md w-full shadow-2xl transform animate-in slide-in-from-bottom-4 duration-300 border border-gray-100",children:a.jsxs("div",{className:"relative overflow-hidden",children:[a.jsxs("div",{className:"relative bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 px-8 pt-8 pb-6",children:[a.jsx("button",{onClick:()=>w(!1),className:"absolute top-4 right-4 z-10 w-10 h-10 bg-white hover:bg-gray-50 rounded-full flex items-center justify-center transition-all duration-200 hover:scale-110 shadow-md border border-gray-200",children:a.jsx(qr,{className:"w-5 h-5 text-gray-600"})}),a.jsx("div",{className:"absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-blue-600 via-indigo-600 to-purple-600"}),a.jsxs("div",{className:"text-center",children:[a.jsxs("div",{className:"relative mx-auto mb-6 w-fit",children:[a.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-blue-600 via-indigo-600 to-purple-600 rounded-2xl flex items-center justify-center shadow-xl",children:a.jsx(rd,{className:"w-10 h-10 text-white"})}),a.jsx("div",{className:"absolute -top-1 -right-1 w-7 h-7 bg-gradient-to-br from-green-500 to-emerald-600 rounded-full border-3 border-white flex items-center justify-center shadow-lg",children:a.jsx(Co,{className:"w-3.5 h-3.5 text-white"})}),a.jsx("div",{className:"absolute -bottom-2 -left-2 w-6 h-6 bg-blue-500 rounded-full border-2 border-white animate-pulse"}),a.jsx("div",{className:"absolute -bottom-1 -right-3 w-4 h-4 bg-purple-500 rounded-full border-2 border-white animate-pulse animation-delay-300"})]}),a.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Secure Your Order"}),a.jsx("p",{className:"text-gray-600 text-sm leading-relaxed",children:"Quick verification to ensure your order is protected"})]})]}),x&&a.jsx("div",{className:"mx-8 mb-6 p-4 bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl border border-green-200",children:a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-8 h-8 bg-green-500 rounded-full flex items-center justify-center",children:a.jsx(Nr,{className:"w-4 h-4 text-white"})}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("span",{className:"text-sm font-semibold text-green-800",children:"Location Verified"}),a.jsxs("span",{className:"px-2 py-0.5 bg-green-200 text-green-800 rounded-full text-xs font-medium",children:[x.confidence,"%"]})]}),a.jsx("p",{className:"text-xs text-green-600 mt-1",children:x.methods.slice(0,2).join("  ")})]})]})}),a.jsx("div",{className:"px-8 pb-8",children:D?a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-center mb-4",children:a.jsxs("div",{className:"inline-flex items-center space-x-2 bg-green-100 text-green-700 px-4 py-2 rounded-full text-sm font-medium mb-3",children:[a.jsx(Nr,{className:"w-4 h-4"}),a.jsx("span",{children:"Code Sent"})]})}),a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3 text-center",children:"Enter Verification Code"}),a.jsx("input",{type:"text",value:B,onChange:Qe=>k(Qe.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"000000",maxLength:6,className:"w-full px-6 py-4 border-2 border-gray-200 rounded-xl focus:ring-4 focus:ring-blue-500/20 focus:border-blue-500 transition-all duration-300 text-center text-2xl font-mono tracking-[0.5rem] bg-white shadow-sm",autoComplete:"one-time-code"}),a.jsx("div",{className:"mt-4 p-4 bg-gradient-to-br from-green-50 via-white to-emerald-50 rounded-xl border-2 border-green-100 shadow-sm",children:a.jsxs("div",{className:"text-center",children:[a.jsxs("div",{className:"flex items-center justify-center space-x-2 mb-3",children:[a.jsx("div",{className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center",children:a.jsx(Nr,{className:"w-3 h-3 text-white"})}),a.jsxs("p",{className:"text-sm text-green-700 font-semibold",children:["Code sent to: +91-",S]})]}),a.jsxs("div",{className:"bg-blue-50 rounded-lg p-3 border border-blue-200",children:[a.jsx("p",{className:"text-xs text-blue-600 font-medium mb-2",children:"Demo codes for testing:"}),a.jsxs("div",{className:"flex flex-wrap justify-center gap-2",children:[a.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-700 rounded-lg font-mono text-sm border border-blue-200",children:"123456"}),a.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-700 rounded-lg font-mono text-sm border border-blue-200",children:"000000"}),a.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-700 rounded-lg font-mono text-sm border border-blue-200",children:S.slice(-6)})]})]})]})})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsx("button",{onClick:ke,disabled:B.length!==6||U,className:"w-full bg-gradient-to-r from-green-500 to-emerald-600 text-white py-4 rounded-xl hover:from-green-600 hover:to-emerald-700 transition-all duration-300 font-bold text-lg disabled:opacity-50 disabled:cursor-not-allowed shadow-lg hover:shadow-xl transform hover:scale-[1.02] flex items-center justify-center space-x-3",children:U?a.jsxs(a.Fragment,{children:[a.jsx(qh,{className:"w-6 h-6 animate-spin"}),a.jsx("span",{children:"Verifying..."})]}):a.jsxs(a.Fragment,{children:[a.jsx(Nr,{className:"w-6 h-6"}),a.jsx("span",{children:"Verify & Place Order"})]})}),a.jsxs("div",{className:"flex space-x-3",children:[a.jsx("button",{onClick:()=>{q(!1),k(""),Ae(null)},disabled:U,className:"flex-1 bg-gray-100 text-gray-700 py-3 rounded-xl hover:bg-gray-200 transition-all duration-300 font-medium disabled:opacity-50 transform hover:scale-[1.02] shadow-sm",children:" Back"}),a.jsx("button",{onClick:lt,disabled:he||U,className:"flex-1 bg-blue-100 text-blue-700 py-3 rounded-xl hover:bg-blue-200 transition-all duration-300 font-medium disabled:opacity-50 transform hover:scale-[1.02] flex items-center justify-center space-x-2 shadow-sm border border-blue-200",children:he?a.jsxs(a.Fragment,{children:[a.jsx(qh,{className:"w-4 h-4 animate-spin"}),a.jsx("span",{children:"Sending..."})]}):a.jsxs(a.Fragment,{children:[a.jsx(UA,{className:"w-4 h-4"}),a.jsx("span",{children:"Resend"})]})})]})]})]}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"text-center mb-6",children:[a.jsxs("div",{className:"inline-flex items-center space-x-2 bg-blue-100 text-blue-700 px-4 py-2 rounded-full text-sm font-medium mb-3",children:[a.jsx(rd,{className:"w-4 h-4"}),a.jsx("span",{children:"Instant Verification"})]}),a.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Sign in with Phone"}),a.jsx("p",{className:"text-sm text-gray-600",children:"One-click verification to place your order securely"})]}),a.jsx("div",{className:"relative",children:a.jsxs("div",{className:"bg-gradient-to-br from-blue-50 via-white to-indigo-50 rounded-2xl p-6 border-2 border-blue-100 shadow-lg",children:[a.jsx("div",{className:"absolute top-2 right-2 w-8 h-8 bg-blue-500/10 rounded-full"}),a.jsx("div",{className:"absolute bottom-2 left-2 w-6 h-6 bg-indigo-500/10 rounded-full"}),a.jsx(fwe,{}),a.jsx("div",{className:"mt-4 pt-4 border-t border-blue-200",children:a.jsxs("div",{className:"flex items-center justify-center space-x-6 text-xs text-gray-600",children:[a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx(Nr,{className:"w-3 h-3 text-green-500"}),a.jsx("span",{children:"Secure"})]}),a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx(Nr,{className:"w-3 h-3 text-green-500"}),a.jsx("span",{children:"Instant"})]}),a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx(Nr,{className:"w-3 h-3 text-green-500"}),a.jsx("span",{children:"No OTP"})]})]})})]})})]}),a.jsx("div",{className:"text-center",children:a.jsx("button",{onClick:()=>w(!1),className:"px-8 py-3 bg-gray-100 text-gray-700 rounded-xl hover:bg-gray-200 transition-all duration-300 font-medium transform hover:scale-[1.02] shadow-sm",children:"Cancel"})})]})})]})})}),He&&Ce&&a.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:a.jsx("div",{className:"bg-white rounded-2xl max-w-md w-full max-h-[90vh] overflow-y-auto shadow-2xl",children:a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"text-center mb-6",children:[a.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-green-500 to-emerald-600 rounded-2xl flex items-center justify-center mx-auto mb-4 shadow-lg",children:a.jsx(Nr,{className:"w-8 h-8 text-white"})}),a.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Order Tracking"}),a.jsxs("p",{className:"text-gray-600",children:["Order #",Ce.orderNumber]})]}),a.jsx("div",{className:`p-4 rounded-xl border-2 mb-6 ${ze(Ce.status).color}`,children:a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-10 h-10 bg-white rounded-full flex items-center justify-center shadow-sm",children:(()=>{const Qe=ze(Ce.status).icon;return a.jsx(Qe,{className:"w-5 h-5 text-gray-700"})})()}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:"font-semibold text-lg",children:ze(Ce.status).label}),a.jsx("p",{className:"text-sm opacity-80",children:ze(Ce.status).description})]})]})}),a.jsxs("div",{className:"space-y-4 mb-6",children:[a.jsxs("div",{className:"bg-gray-50 rounded-xl p-4",children:[a.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"Order Items"}),a.jsx("div",{className:"space-y-2",children:Ce.items.map((Qe,Ge)=>a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("span",{className:"text-sm font-medium text-gray-900",children:Qe.name}),a.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:["x",Qe.quantity]})]}),a.jsx("span",{className:"text-sm font-semibold text-gray-900",children:Ue(Qe.total)})]},Ge))}),a.jsx("div",{className:"border-t border-gray-200 mt-3 pt-3",children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"font-semibold text-gray-900",children:"Total"}),a.jsx("span",{className:"font-bold text-lg text-gray-900",children:Ue(Ce.total)})]})})]}),a.jsxs("div",{className:"bg-blue-50 rounded-xl p-4",children:[a.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[a.jsx(Ys,{className:"w-4 h-4 text-blue-600"}),a.jsx("span",{className:"text-sm font-medium text-blue-900",children:"Order Time"})]}),a.jsx("p",{className:"text-sm text-blue-700",children:Wn(Ce.createdAt)})]})]}),a.jsxs("div",{className:"space-y-3",children:[Ce.status==="ready"&&a.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-xl p-4 text-center",children:[a.jsx(fp,{className:"w-6 h-6 text-green-600 mx-auto mb-2"}),a.jsx("p",{className:"text-sm font-semibold text-green-800",children:"Your order is ready!"}),a.jsx("p",{className:"text-xs text-green-600",children:"Please proceed to the payment counter"})]}),a.jsx("button",{onClick:Me,className:"w-full bg-gradient-to-r from-blue-500 to-blue-600 text-white py-3 rounded-xl hover:from-blue-600 hover:to-blue-700 transition-all duration-300 font-semibold shadow-lg hover:shadow-xl transform hover:scale-[1.02]",children:"Go to Dashboard"})]})]})})})]}):a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 flex items-center justify-center",children:a.jsxs("div",{className:"text-center max-w-md mx-auto p-8",children:[a.jsxs("div",{className:"relative mb-6",children:[a.jsx("div",{className:"w-24 h-24 bg-gradient-to-br from-red-500 to-pink-600 rounded-3xl flex items-center justify-center mx-auto shadow-xl",children:a.jsx(Go,{className:"w-12 h-12 text-white"})}),a.jsx("div",{className:"absolute -top-2 -right-2 w-8 h-8 bg-red-500 rounded-full border-4 border-white animate-pulse"})]}),a.jsx("h2",{className:"text-3xl font-bold bg-gradient-to-r from-red-600 via-pink-600 to-purple-600 bg-clip-text text-transparent mb-4",children:"Verification Failed"}),a.jsx("p",{className:"text-gray-600 text-lg leading-relaxed mb-6",children:"We couldn't verify that you're at the restaurant location. Please ensure you're connected to the restaurant's WiFi or are within the restaurant premises."}),a.jsx("button",{onClick:()=>window.location.reload(),className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white px-8 py-4 rounded-2xl hover:from-blue-700 hover:to-purple-700 transition-all duration-300 font-semibold shadow-xl hover:shadow-2xl transform hover:-translate-y-1",children:"Try Again"})]})})}function mwe(){const{slug:t}=uu(),r=new URLSearchParams(window.location.search).get("orderNumber"),[s,n]=R.useState(null),[i,o]=R.useState(!0),[l,c]=R.useState(!1),[d,u]=R.useState(null);R.useEffect(()=>{A();const x=setInterval(()=>{s&&["placed","confirmed"].includes(s.status)&&f()},3e4);return()=>clearInterval(x)},[r,t]);const A=async()=>{if(t)try{o(!0);const x=await si.getRestaurantBySlug(t);if(!x.success||!x.data){Z.error("Restaurant not found");return}u(x.data),r&&await h(x.data.id,r)}catch(x){console.error("Failed to load data:",x),Z.error("Failed to load order information")}finally{o(!1)}},h=async(x,E)=>{try{const T=await Ur.getOrdersForRestaurant(x,100);if(T.success&&T.data){const j=T.data.find(C=>C.id===E||C.orderNumber===E);j?n(j):Z.error("Order not found")}}catch(T){console.error("Failed to load order:",T),Z.error("Failed to load order")}},f=async()=>{if(!(!d||!s))try{await h(d.id,s.id),Z.success("Order status updated")}catch(x){console.error("Failed to refresh order:",x)}},p=x=>{const E={placed:{color:"border-yellow-300 bg-yellow-50 text-yellow-800",icon:Ys,label:"Order Placed",description:"Your order has been received and is waiting for confirmation."},confirmed:{color:"border-blue-300 bg-blue-50 text-blue-800",icon:Nr,label:"Order Confirmed",description:"Your order has been confirmed. Please wait for payment notification."},preparing:{color:"border-blue-300 bg-blue-50 text-blue-800",icon:Nr,label:"Order Confirmed",description:"Your order has been confirmed. Please wait for payment notification."},ready:{color:"border-blue-300 bg-blue-50 text-blue-800",icon:Nr,label:"Order Confirmed",description:"Your order has been confirmed. Please wait for payment notification."},completed:{color:"border-green-300 bg-green-50 text-green-800",icon:rs,label:"Payment Done",description:"Thank you for your order! Payment has been completed."}};return E[x]||E.placed},m=x=>{const T=new Date().getTime()-new Date(x).getTime();return Math.floor(T/(1e3*60))};if(i)return a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Loading order status..."})]})});if(!d)return a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 flex items-center justify-center",children:a.jsxs("div",{className:"text-center max-w-md mx-auto p-8",children:[a.jsx("div",{className:"w-24 h-24 bg-gradient-to-br from-red-500 to-pink-600 rounded-3xl flex items-center justify-center mx-auto mb-6 shadow-xl",children:a.jsx(Go,{className:"w-12 h-12 text-white"})}),a.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Restaurant Not Found"}),a.jsx("p",{className:"text-gray-600",children:"The restaurant you're looking for could not be found."})]})});if(!s&&r)return a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 flex items-center justify-center",children:a.jsxs("div",{className:"text-center max-w-md mx-auto p-8",children:[a.jsx("div",{className:"w-24 h-24 bg-gradient-to-br from-yellow-500 to-orange-600 rounded-3xl flex items-center justify-center mx-auto mb-6 shadow-xl",children:a.jsx(rs,{className:"w-12 h-12 text-white"})}),a.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Order Not Found"}),a.jsx("p",{className:"text-gray-600",children:"The order you're looking for could not be found or may have been cancelled."})]})});if(!s)return a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100",children:a.jsxs("div",{className:"max-w-4xl mx-auto px-6 py-12",children:[a.jsxs("div",{className:"text-center mb-8",children:[a.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-blue-500 to-purple-600 rounded-3xl flex items-center justify-center mx-auto mb-6 shadow-xl",children:a.jsx(rd,{className:"w-10 h-10 text-white"})}),a.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-4",children:d.name}),a.jsx("p",{className:"text-gray-600 text-lg",children:"Check your order status"})]}),a.jsxs("div",{className:"bg-white/80 backdrop-blur-xl rounded-3xl shadow-2xl border border-white/20 p-8",children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Order Status Lookup"}),a.jsx("p",{className:"text-gray-600 mb-6",children:"To check your order status, you need your order ID. This is provided when you place an order."}),a.jsxs("div",{className:"text-center py-12",children:[a.jsx(rs,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-500",children:"Enter your order details to check status"})]})]})]})});const g=p(s.status),y=g.icon,v=m(s.createdAt);return s.status,a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100",children:a.jsxs("div",{className:"max-w-4xl mx-auto px-6 py-12",children:[a.jsxs("div",{className:"text-center mb-8",children:[a.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-blue-500 to-purple-600 rounded-3xl flex items-center justify-center mx-auto mb-6 shadow-xl",children:a.jsx(rd,{className:"w-10 h-10 text-white"})}),a.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-2",children:d.name}),a.jsx("p",{className:"text-gray-600 text-lg",children:"Order Status Dashboard"})]}),a.jsxs("div",{className:"bg-white/80 backdrop-blur-xl rounded-3xl shadow-2xl border border-white/20 p-8 mb-8",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Order Details"}),a.jsxs("button",{onClick:f,disabled:l,className:"flex items-center space-x-2 px-4 py-2 bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 transition-colors disabled:opacity-50",children:[a.jsx(Di,{className:`w-4 h-4 ${l?"animate-spin":""}`}),a.jsx("span",{children:"Refresh"})]})]}),a.jsxs("div",{className:"mb-6",children:[a.jsxs("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:["Order #",s.orderNumber]}),a.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-600",children:[a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx(Jc,{className:"w-4 h-4"}),a.jsx("span",{children:Wn(s.createdAt)})]}),a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx(sf,{className:"w-4 h-4"}),a.jsxs("span",{children:[v,"m ago"]})]})]})]}),a.jsxs("div",{className:`rounded-2xl border-2 ${g.color} p-6 mb-6`,children:[a.jsxs("div",{className:"flex items-center space-x-4 mb-4",children:[a.jsx("div",{className:`w-12 h-12 rounded-2xl flex items-center justify-center ${g.color.replace("border-","bg-").replace("bg-","bg-opacity-20 bg-")}`,children:a.jsx(y,{className:"w-6 h-6"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-bold",children:g.label}),a.jsx("p",{className:"text-sm opacity-80",children:g.description})]})]}),a.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mb-4",children:a.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-green-500 h-2 rounded-full transition-all duration-1000",style:{width:s.status==="placed"?"33%":["confirmed","preparing","ready"].includes(s.status)?"66%":s.status==="completed"?"100%":"33%"}})}),a.jsxs("div",{className:"flex justify-between text-xs text-gray-600",children:[a.jsx("span",{className:s.status==="placed"?"font-bold text-blue-600":"",children:"Placed"}),a.jsx("span",{className:["confirmed","preparing","ready"].includes(s.status)?"font-bold text-blue-600":"",children:"Confirmed"}),a.jsx("span",{className:s.status==="completed"?"font-bold text-green-600":"",children:"Payment Done"})]})]}),a.jsx("div",{className:"space-y-4 mb-6",children:s.items.map((x,E)=>a.jsxs("div",{className:"flex justify-between items-center p-4 bg-gray-50 rounded-lg",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-gray-900",children:x.name}),a.jsxs("p",{className:"text-sm text-gray-600",children:["Quantity: ",x.quantity]}),x.notes&&a.jsxs("p",{className:"text-sm text-gray-500 italic",children:["Note: ",x.notes]})]}),a.jsx("div",{className:"text-right",children:a.jsx("p",{className:"font-semibold text-gray-900",children:Ue(x.total)})})]},E))}),a.jsx("div",{className:"border-t pt-4",children:a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{children:"Subtotal:"}),a.jsx("span",{children:Ue(s.subtotal)})]}),a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{children:"Tax:"}),a.jsx("span",{children:Ue(s.tax)})]}),a.jsxs("div",{className:"flex justify-between text-lg font-bold border-t pt-2",children:[a.jsx("span",{children:"Total:"}),a.jsx("span",{children:Ue(s.total)})]})]})}),a.jsx("div",{className:"mt-6 pt-6 border-t",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Customer Portal"}),a.jsx("p",{className:"text-gray-600 text-sm",children:"View your order history, rewards, and more"})]}),a.jsxs("button",{onClick:()=>{const x=new URLSearchParams(window.location.search).get("phone");x&&d&&(window.location.href=`/${d.slug}/customer-dashboard?phone=${x}`)},className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white px-6 py-3 rounded-xl hover:from-blue-700 hover:to-purple-700 transition-all font-medium flex items-center space-x-2 shadow-lg",children:[a.jsx(Ls,{className:"w-4 h-4"}),a.jsx("span",{children:"View Dashboard"})]})]})})]}),a.jsxs("div",{className:"bg-white/80 backdrop-blur-xl rounded-3xl shadow-2xl border border-white/20 p-8",children:[a.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-6",children:"Need Help?"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"flex items-center space-x-4 p-4 bg-blue-50 rounded-xl",children:[a.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center",children:a.jsx(UA,{className:"w-6 h-6 text-blue-600"})}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-gray-900",children:"Call Restaurant"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Get instant support"})]})]}),a.jsxs("div",{className:"flex items-center space-x-4 p-4 bg-green-50 rounded-xl",children:[a.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-full flex items-center justify-center",children:a.jsx(Di,{className:"w-6 h-6 text-green-600"})}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-gray-900",children:"Track Order"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Real-time updates"})]})]})]})]})]})})}const pwe=()=>(R.useEffect(()=>{const t=document.createElement("script");return t.src="https://www.phone.email/sign_in_button_v1.js",t.async=!0,document.head.appendChild(t),()=>{document.head.removeChild(t)}},[]),a.jsx("div",{className:"pe_signin_button w-full flex justify-center","data-client-id":"19037279849489128239"}));function gwe({wheelConfig:t,restaurantName:e,onSpinComplete:r,currentSlug:s}){var ns,Ia,so,li,Ka;const[n,i]=R.useState(!1),[o,l]=R.useState(!1),[c,d]=R.useState(null),[u,A]=R.useState(!1),[h,f]=R.useState(!0),[p,m]=R.useState(t.maxSpinsPerCustomer),[g,y]=R.useState(0),[v,x]=R.useState(!1),[E,T]=R.useState(""),[j,C]=R.useState(null),[w,S]=R.useState(!1),[F,B]=R.useState(null),[k,D]=R.useState(!1),[q,te]=R.useState("login"),[W,Q]=R.useState(!1),[re,G]=R.useState(!1),[Ae,he]=R.useState(!1),[I]=R.useState(""),[U,V]=R.useState(!1),[L,K]=R.useState(null),[fe,ee]=R.useState(!1),[de,ue]=R.useState(!1),[Ie,Y]=R.useState(null),[H,je]=R.useState(!1),[Ce,oe]=R.useState(!1),[He,ie]=R.useState([]),[le,ae]=R.useState(null),[ve,we]=R.useState([]),[De,Ve]=R.useState(!1),[me,Fe]=R.useState(null),Re=R.useRef(null),{register:Be,handleSubmit:X,formState:{errors:_e},reset:ke}=nn(),{register:lt,handleSubmit:mt,formState:{errors:pt},reset:ze}=nn(),{register:Me,handleSubmit:rt,formState:{errors:ht},reset:Qe}=nn(),{register:Ge,handleSubmit:gt,formState:{errors:St},reset:Vt}=nn();R.useEffect(()=>(qe(),window.phoneEmailListener=Xe,console.log(" Spin Wheel Configuration Loaded:",{wheelId:t.id,wheelName:t.name,maxSpinsPerCustomer:t.maxSpinsPerCustomer,maxSpinsType:typeof t.maxSpinsPerCustomer,maxSpinsConverted:Number(t.maxSpinsPerCustomer),isUnlimited:Number(t.maxSpinsPerCustomer)===0,isActive:t.isActive,restaurantId:t.restaurantId}),()=>{window.phoneEmailListener&&delete window.phoneEmailListener}),[t]),R.useEffect(()=>{(W&&F||fe&&L)&&(xr(),Kt(),ft())},[W,F,fe,L]),R.useEffect(()=>{console.log(" User spin history changed:",{count:He.length,history:He.map(ot=>({id:ot.id,timestamp:ot.timestamp}))})},[He]);const Kt=async()=>{var jt;if(!(!(L||F)||!(fe||W)||!((jt=t.pointsConfig)!=null&&jt.enabled)))try{const Lt=L?L.phone:F==null?void 0:F.phone;if(!Lt)return;const Er=await Uc.getCustomerLoyaltyInfo(t.restaurantId,Lt);Er.success&&Er.data&&ae(Er.data.loyaltyInfo)}catch(Lt){console.error("Error loading initial loyalty info:",Lt)}},qe=async()=>{const ot=localStorage.getItem("spinWheelPhoneUser");if(ot)try{const Pt=JSON.parse(ot),jt=new Date(Pt.lastAuthenticated);if((new Date().getTime()-jt.getTime())/(1e3*60*60)<24){K(Pt),ee(!0);return}}catch(Pt){console.error("Error restoring phone auth session:",Pt)}localStorage.removeItem("spinWheelPhoneUser"),V(!0)},Xe=async ot=>{try{const jt=await(await fetch(ot.user_json_url)).json();let Lt={country_code:jt.user_country_code,phone:jt.user_phone_number,firstName:jt.user_first_name,lastName:jt.user_last_name,fullName:`${jt.user_first_name||""} ${jt.user_last_name||""}`.trim(),lastAuthenticated:new Date().toISOString()};try{const Er=await wn.searchCustomers(t.restaurantId,Lt.phone);if(Er.success&&Er.data&&Er.data.length>0){const jr=Er.data[0];if(jr.name&&jr.name!=="Spin Wheel User"&&jr.name.trim()!==""){console.log("Found existing customer with name:",jr.name),Lt.fullName=jr.name;const ms=jr.name.split(" ");Lt.firstName=ms[0]||Lt.firstName,Lt.lastName=ms.slice(1).join(" ")||Lt.lastName}}const _r=await yl.getUserByPhone(t.restaurantId,Lt.phone);if(_r&&_r.name&&_r.name!=="Spin Wheel User"&&_r.name.trim()!==""){console.log("Found existing gamification user with name:",_r.name),Lt.fullName=_r.name;const jr=_r.name.split(" ");Lt.firstName=jr[0]||Lt.firstName,Lt.lastName=jr.slice(1).join(" ")||Lt.lastName}}catch(Er){console.log("Could not fetch existing user data:",Er)}(!Lt.fullName||Lt.fullName.trim()==="")&&(Lt.fullName="Spin Wheel User"),localStorage.setItem("spinWheelPhoneUser",JSON.stringify(Lt)),await Ke(Lt),K(Lt),ee(!0),V(!1),console.log("Phone verified successfully:",Lt),Z.success(`Welcome back ${Lt.fullName}! `)}catch(Pt){console.error("Phone verification failed:",Pt),Z.error("Phone verification failed. Please try again.")}},Ke=async ot=>{try{const Pt={name:ot.fullName||"Spin Wheel User",phone:ot.phone,email:"",address:"",preferences:["spin_wheel_user"],totalSpent:0,visitCount:1,lastVisit:new Date},jt=await wn.searchCustomers(t.restaurantId,ot.phone);if(jt.success&&jt.data&&jt.data.length>0){const Lt=jt.data[0];console.log("Customer already exists in CRM:",Lt);const Er={...Lt,lastVisit:new Date,visitCount:(Lt.visitCount||0)+1,name:ot.fullName&&ot.fullName!=="Spin Wheel User"?ot.fullName:Lt.name},_r=await wn.updateCustomer(Lt.id,t.restaurantId,Er);_r.success&&console.log("Customer updated in CRM:",_r.data)}else{const Lt=await wn.createCustomer(t.restaurantId,Pt);Lt.success?console.log("User saved to CRM successfully:",Lt.data):console.error("Failed to save user to CRM:",Lt.error)}await We(ot)}catch(Pt){console.error("Error saving user to CRM:",Pt)}},We=async ot=>{try{const Pt=await yl.getUserByPhone(t.restaurantId,ot.phone);if(Pt){console.log("Gamification user already exists:",Pt);try{const Er={lastLoginAt:new Date,name:ot.fullName&&ot.fullName!=="Spin Wheel User"?ot.fullName:Pt.name};yl.updateUser&&(await yl.updateUser(t.restaurantId,Pt.id,Er),console.log("Updated existing gamification user login time and name"))}catch(Er){console.log("Could not update existing gamification user:",Er)}return}const jt={restaurantId:t.restaurantId,name:ot.fullName||"Spin Wheel User",phone:ot.phone,email:"",passwordHash:"phone_auth_user",isVerified:!0,phoneVerified:!0,emailVerified:!1,isBlocked:!1,totalSpins:0,totalWins:0,createdAt:new Date,lastLoginAt:new Date,deviceFingerprint:`phone_${ot.phone}`,ipAddress:"unknown"},Lt=await yl.createPhoneAuthUser(t.restaurantId,jt);Lt.success?console.log("User saved to Gamification Users successfully:",Lt.user):console.error("Failed to save user to Gamification Users:",Lt.message)}catch(Pt){console.error("Error saving user to Gamification Users:",Pt)}},Ft=async()=>{console.log(" Claim Reward clicked! Debug info:",{spinResult:c,currentSpinRecord:j,phoneAuthUser:L,currentUser:F,isClaimingReward:H,isClaimed:v});const ot=L||F;if(!c||!j||!ot){console.log(" Early return - missing required data:",{hasSpinResult:!!c,hasCurrentSpinRecord:!!j,hasUser:!!ot});return}const Pt=!(c.rewardType==="custom"&&c.label.toLowerCase().includes("luck"));if(console.log(" Reward claim check:",{isWinning:Pt,rewardType:c.rewardType,label:c.label,labelLowerCase:c.label.toLowerCase(),includesLuck:c.label.toLowerCase().includes("luck")}),!Pt){console.log(" Not a winning segment"),Z.error("No reward to claim. Better luck next time!");return}console.log(" Starting reward claim process..."),await new Promise(jt=>{requestAnimationFrame(()=>{requestAnimationFrame(()=>{setTimeout(jt,1e3)})})});try{const jt=Mr();T(jt),x(!0),Z.success(" Reward claimed! Processing...");let Lt="";L?Lt=L.fullName||L.firstName||`Customer ${L.phone.slice(-4)}`:F&&(Lt=F.name||"User"),await Ye(Lt,jt)}catch(jt){console.error("Error in claim process:",jt),x(!1),T(""),Z.error("Failed to claim reward. Please try again.")}finally{je(!1)}},Ct=async(ot,Pt)=>{try{const jt=await wn.searchCustomers(t.restaurantId,ot);if(jt.success&&jt.data&&jt.data.length>0){const Lt=jt.data[0],Er={...Lt,name:Pt},_r=await wn.updateCustomer(Lt.id,t.restaurantId,Er);_r.success&&console.log("Customer name updated in CRM:",_r.data)}}catch(jt){console.error("Error updating customer name:",jt)}},xr=async()=>{if(!(L||F)||!(fe||W))return;const jt=Number(t.maxSpinsPerCustomer);if(jt===0){f(!0),m(999),console.log(" Unlimited spins enabled for wheel:",t.id);return}try{const Lt=L?L.phone:F==null?void 0:F.phone;if(!Lt)return;const Er=await Ra.getCustomerSpinsCountToday(t.restaurantId,Lt,t.id);if(Er.success&&typeof Er.data=="number"){const _r=Er.data,jr=Math.max(0,jt-_r);m(jr),f(jr>0),console.log(" Spin limit check:",{userPhone:Lt,spinWheelId:t.id,spinsToday:_r,maxAllowed:jt,maxAllowedOriginal:t.maxSpinsPerCustomer,maxAllowedType:typeof t.maxSpinsPerCustomer,remaining:jr,canSpin:jr>0})}}catch(Lt){console.error("Error checking spin limit:",Lt),m(jt||999),f(!0)}},vr=()=>{const ot=t.segments.reduce((jt,Lt)=>jt+Lt.probability,0);let Pt=Math.random()*ot;for(const jt of t.segments)if(Pt-=jt.probability,Pt<=0)return jt;return t.segments[0]},Pr=ot=>{const Pt=t.segments.findIndex(jr=>jr.id===ot.id),jt=360/t.segments.length,Lt=Pt*jt;return(8+Math.random()*5)*360+(360-Lt)},Mr=()=>{const ot=t.name.substring(0,3).toUpperCase(),Pt=Date.now().toString().slice(-6),jt=Math.random().toString(36).substring(2,5).toUpperCase();return`${ot}${Pt}${jt}`},Jr=async ot=>{if(!W){he(!0);try{const Pt={phoneOrEmail:ot.phoneOrEmail,password:ot.password,deviceFingerprint:I},jt=await yl.loginUser(t.restaurantId,Pt);jt.success&&jt.user?jt.requiresVerification?(B(jt.user),te("verify"),Z.error(jt.message||"Please verify your account")):(B(jt.user),Q(!0),D(!1),localStorage.setItem("gamificationUserId",jt.user.id),localStorage.setItem("gamificationToken",jt.token||"logged-in"),Z.success("Welcome back! "),ke()):Z.error(jt.message||"Login failed")}catch{Z.error("Login failed. Please try again.")}finally{he(!1)}}},ye=async ot=>{he(!0);try{const Pt={name:ot.name,phone:ot.phone,email:ot.email,password:ot.password,confirmPassword:ot.confirmPassword,deviceFingerprint:I},jt=await yl.registerUser(t.restaurantId,Pt);jt.success&&jt.user?(B(jt.user),jt.requiresVerification?(te("verify"),Z.success("Account created! Please verify your phone number.")):(Q(!0),D(!1),localStorage.setItem("gamificationUserId",jt.user.id),localStorage.setItem("gamificationToken",jt.token||"logged-in"),Z.success("Account created successfully! "),ze())):Z.error(jt.message||"Registration failed")}catch{Z.error("Registration failed. Please try again.")}finally{he(!1)}},Le=async ot=>{if(F){he(!0);try{const Pt=await yl.verifyUser({userId:F.id,restaurantId:t.restaurantId,code:ot.code,type:"phone"});Pt.success&&Pt.user?(B(Pt.user),Q(!0),D(!1),localStorage.setItem("gamificationUserId",Pt.user.id),localStorage.setItem("gamificationToken","verified"),Z.success("Phone verified successfully! "),Qe()):Z.error(Pt.message||"Verification failed")}catch{Z.error("Verification failed. Please try again.")}finally{he(!1)}}},se=async()=>{if(F)try{const ot=await yl.resendVerificationCode(t.restaurantId,F.id,"phone");ot.success?Z.success(ot.message||"Verification code sent successfully"):Z.error(ot.message||"Failed to send verification code")}catch{Z.error("Failed to resend code")}},z=()=>{B(null),Q(!1),D(!0),localStorage.removeItem("gamificationUserId"),localStorage.removeItem("gamificationToken"),l(!1),d(null),x(!1),T(""),C(null),S(!1),A(!1),Z.success("Logged out successfully")},ce=()=>{if(!h||n||!(fe||W)||!(L||F))return;const jt=vr(),Lt=g+Pr(jt);i(!0),y(Lt),setTimeout(async()=>{var _r;i(!1),l(!0),d(jt),A(!0);const Er=!(jt.rewardType==="custom"&&jt.label.toLowerCase().includes("luck"));Er&&(S(!0),setTimeout(()=>S(!1),3e3));try{const jr={restaurantId:t.restaurantId,spinWheelId:t.id,customerId:L?`phone_user_${L.phone}`:(F==null?void 0:F.id)||"unknown",customerName:L?L.fullName||"Spin Wheel User":(F==null?void 0:F.name)||"User",customerPhone:L?L.phone:(F==null?void 0:F.phone)||"",customerEmail:L?"":(F==null?void 0:F.email)||"",resultSegmentId:jt.id,resultMessage:jt.value,isRedeemed:!1,ipAddress:"unknown"},ms=await Ra.recordCustomerSpin(jr);ms.success&&ms.data&&(C(ms.data),r==null||r(ms.data),m(Qs=>Math.max(0,Qs-1)),f(p-1>0),setTimeout(()=>{ft()},100),Er&&(L&&!L.fullName?(Y({spinResult:jt,spinRecord:ms.data,couponCode:Mr()}),ue(!0)):(setTimeout(()=>{je(!0),console.log(" Auto-processing reward claim after spin...")},100),setTimeout(async()=>{await xe(jt,ms.data)},1e3))),(_r=t.pointsConfig)!=null&&_r.enabled&&setTimeout(()=>Kt(),500),Ce&&setTimeout(()=>{console.log(" Triggering dashboard refresh after spin..."),ft()},200))}catch(jr){console.error("Error recording spin:",jr)}},2500)},xe=async(ot,Pt)=>{const jt=ot||c,Lt=Pt||j;console.log(" Auto-claim reward triggered! Debug info:",{capturedSpinResult:ot,capturedSpinRecord:Pt,finalSpinResult:jt,finalSpinRecord:Lt,phoneAuthUser:L,currentUser:F,isClaimingReward:H,isClaimed:v});const Er=L||F;if(!jt||!Lt||!Er){console.log(" Early return - missing required data:",{hasFinalSpinResult:!!jt,hasFinalSpinRecord:!!Lt,hasUser:!!Er});return}const _r=!(jt.rewardType==="custom"&&jt.label.toLowerCase().includes("luck"));if(console.log(" Auto reward claim check:",{isWinning:_r,rewardType:jt.rewardType,label:jt.label,labelLowerCase:jt.label.toLowerCase(),includesLuck:jt.label.toLowerCase().includes("luck")}),!_r){console.log(" Not a winning segment");return}console.log(" Starting auto reward claim process..."),ot&&d(ot),Pt&&C(Pt),await new Promise(jr=>{requestAnimationFrame(()=>{requestAnimationFrame(()=>{setTimeout(jr,1e3)})})});try{const jr=Mr();T(jr),x(!0),Z.success(" Reward claimed! Processing...");let ms="";L?ms=L.fullName||L.firstName||`Customer ${L.phone.slice(-4)}`:F&&(ms=F.name||"User"),await Ze(ms,jr,jt,Lt)}catch(jr){console.error("Error in auto-claim process:",jr),x(!1),T(""),Z.error("Failed to claim reward. Please try again.")}finally{je(!1),console.log(" Auto-claim complete, refreshing dashboard..."),setTimeout(()=>ft(),100)}},Pe=async ot=>{if(!(!Ie||!L))try{ue(!1),Vt(),await Ye(ot.name)}catch(Pt){console.error("Error claiming reward:",Pt),Z.error("Failed to claim reward. Please try again.")}},Ze=async(ot,Pt,jt,Lt)=>{if(!(!jt||!Lt||!(L||F)))try{const _r=Pt||Mr(),jr=ot||(L?L.fullName:F==null?void 0:F.name)||"User";if((await Ra.claimSpinReward(t.restaurantId,Lt.id,{customerName:jr,customerPhone:L?L.phone:(F==null?void 0:F.phone)||"",customerEmail:L?"":(F==null?void 0:F.email)||"",couponCode:_r})).success){let Qs;if(L)Qs={id:`phone_user_${L.phone}`,restaurantId:t.restaurantId,name:jr,phone:L.phone,email:"",passwordHash:"",isVerified:!0,phoneVerified:!0,emailVerified:!1,isBlocked:!1,totalSpins:0,totalWins:0,createdAt:new Date,lastLoginAt:new Date};else if(F)Qs=F;else{Z.error("User information not available");return}const ci=await Uc.integrateSpinReward(t.restaurantId,Qs,jt,_r,Lt);if(ci.success?(Z.success(" Reward processed and added to systems!"),console.log(" Customer added to CRM and coupon created in coupon dashboard")):(Z.success(" Reward processed successfully!"),console.warn(" Integration with CRM/Coupon system failed:",ci.error)),ot&&L){const ps={...L,fullName:ot,firstName:ot.split(" ")[0]||"",lastName:ot.split(" ").slice(1).join(" ")||""};localStorage.setItem("spinWheelPhoneUser",JSON.stringify(ps)),K(ps),await Ct(L.phone,ot)}}else Z.error("Failed to claim reward. Please try again.")}catch(_r){throw console.error("Error claiming reward:",_r),Z.error("Something went wrong. Please try again."),_r}},Ye=async(ot,Pt)=>{if(!(!c||!j||!(L||F)))try{const Lt=Pt||Mr(),Er=ot||(L?L.fullName:F==null?void 0:F.name)||"User";if((await Ra.claimSpinReward(t.restaurantId,j.id,{customerName:Er,customerPhone:L?L.phone:(F==null?void 0:F.phone)||"",customerEmail:L?"":(F==null?void 0:F.email)||"",couponCode:Lt})).success){let jr;if(L)jr={id:`phone_user_${L.phone}`,restaurantId:t.restaurantId,name:Er,phone:L.phone,email:"",passwordHash:"",isVerified:!0,phoneVerified:!0,emailVerified:!1,isBlocked:!1,totalSpins:0,totalWins:0,createdAt:new Date,lastLoginAt:new Date};else if(F)jr=F;else{Z.error("User information not available");return}const ms=await Uc.integrateSpinReward(t.restaurantId,jr,c,Lt,j);if(ms.success?(Z.success(" Reward processed and added to systems!"),console.log(" Customer added to CRM and coupon created in coupon dashboard")):(Z.success(" Reward processed successfully!"),console.warn(" Integration with CRM/Coupon system failed:",ms.error)),ot&&L){const Qs={...L,fullName:ot,firstName:ot.split(" ")[0]||"",lastName:ot.split(" ").slice(1).join(" ")||""};localStorage.setItem("spinWheelPhoneUser",JSON.stringify(Qs)),K(Qs),await Ct(L.phone,ot)}}else Z.error("Failed to claim reward. Please try again.")}catch(Lt){throw console.error("Error claiming reward:",Lt),Z.error("Something went wrong. Please try again."),Lt}},Je=()=>{navigator.clipboard.writeText(E),Z.success("Coupon code copied! ")},et=()=>{l(!1),d(null),x(!1),T(""),C(null),S(!1),A(!1),xr(),Ce&&ft()},ft=async()=>{var jt,Lt,Er,_r,jr,ms,Qs,ci;if(!(!(L||F)||!(fe||W))){Ve(!0);try{const ps=L?L.phone:F==null?void 0:F.phone;console.log(" Loading dashboard for user:",{phone:ps,restaurantId:t.restaurantId,authType:L?"phone":"regular"});const us=await Ra.getCustomerSpinsFromRestaurant(t.restaurantId,ps);if(console.log(" Spin history result:",{success:us.success,dataLength:((jt=us.data)==null?void 0:jt.length)||0,error:us.error}),us.success&&us.data?(console.log(" Setting spin history:",us.data),ie(us.data),console.log(" User spin history updated, count:",us.data.length)):(console.log(" No spin history or error:",us.error),ie([]),console.log(" User spin history set to empty array")),(Lt=t.pointsConfig)!=null&&Lt.enabled){const sl=await Uc.getCustomerLoyaltyInfo(t.restaurantId,ps);sl.success&&sl.data&&ae(sl.data.loyaltyInfo)}const kn=await Uc.getCustomerGamificationHistory(t.restaurantId,ps);console.log(" Gamification history result:",{success:kn.success,dataExists:!!kn.data,spinsCount:((_r=(Er=kn.data)==null?void 0:Er.spins)==null?void 0:_r.length)||0,couponsCount:((ms=(jr=kn.data)==null?void 0:jr.coupons)==null?void 0:ms.length)||0}),kn.success&&kn.data?(we(kn.data.coupons||[]),kn.data.spins&&kn.data.spins.length>0?(console.log(" Using comprehensive gamification history spins"),ie(kn.data.spins)):us.success&&((Qs=us.data)!=null&&Qs.length)&&us.data.length>0?(console.log(" Using direct spin history as fallback"),ie(us.data)):j?(console.log(" Using current session spin as fallback"),ie([j])):(console.log(" No spin history found anywhere"),ie([]))):us.success&&((ci=us.data)!=null&&ci.length)&&us.data.length>0?(console.log(" Using direct spin history only"),ie(us.data)):j?(console.log(" Final fallback: current session spin"),ie([j])):(console.log(" No spin data available"),ie([])),console.log(" Dashboard load complete, final spin count will be:",He.length)}catch(ps){console.error("Error loading user dashboard:",ps),Z.error("Failed to load dashboard data")}finally{Ve(!1)}}},At=async()=>{oe(!0),await ft()},Nt=(ot,Pt)=>{const jt=2*Math.PI/Pt,Lt=ot*jt-Math.PI/2,Er=(ot+1)*jt-Math.PI/2,_r=280,jr=300,ms=300,Qs=jr+_r*Math.cos(Lt),ci=ms+_r*Math.sin(Lt),ps=jr+_r*Math.cos(Er),us=ms+_r*Math.sin(Er),kn=jt>Math.PI?1:0;return`M ${jr} ${ms} L ${Qs} ${ci} A ${_r} ${_r} 0 ${kn} 1 ${ps} ${us} Z`},kt=(ot,Pt)=>{const jt=2*Math.PI*ot/Pt+Math.PI/Pt-Math.PI/2,Lt=180,Er=300+Lt*Math.cos(jt),_r=300+Lt*Math.sin(jt),jr=360/Pt*ot+360/Pt/2;return{x:Er,y:_r,rotation:jr}},Ht=ot=>{let Pt=ot.label;if(Pt=Pt.replace(/\b(Discount|Off|Free|Get|Win|Prize)\b/gi,"").trim(),ot.rewardType==="discount_percentage"){const Lt=ot.value.match(/(\d+)%/);if(Lt)return`${Lt[1]}% OFF`}else if(ot.rewardType==="discount_fixed"){const Lt=ot.value.match(/(\d+)/);if(Lt)return`${Lt[1]} OFF`}else{if(ot.rewardType==="free_item")return"FREE ITEM";if(ot.rewardType==="points"){const Lt=ot.value.match(/(\d+)/);if(Lt)return`${Lt[1]} PTS`}}const jt=10;return Pt.length>jt?Pt.substring(0,jt-1)+"":Pt.toUpperCase()},ir=(ot,Pt)=>{const jt=Pt<=6?16:Pt<=8?14:12,Lt=ot.length>8?-2:ot.length<5?2:0;return Math.max(10,jt+Lt)},Ar=ot=>{let Pt=ot.value;Pt=Pt.replace(/\b(You get|You win|Prize:|Reward:)\b/gi,"").trim();const jt=12;return Pt.length>jt?Pt.substring(0,jt-1)+"":Pt},or=c&&!(c.rewardType==="custom"&&c.label.toLowerCase().includes("luck"))&&!c.noCoupon;return console.log(" Result Modal Debug:",{showResultModal:u,spinResult:c,isWinningSegment:or,isClaimed:v,isClaimingReward:H,spinResultDetails:c?{rewardType:c.rewardType,label:c.label,labelLowerCase:c.label.toLowerCase(),includesLuck:c.label.toLowerCase().includes("luck"),isCustom:c.rewardType==="custom"}:null}),a.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-purple-600 via-blue-500 to-indigo-600 relative overflow-hidden",children:[a.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[a.jsx("div",{className:"absolute top-20 left-10 w-8 h-8 bg-white/10 rounded-full animate-float"}),a.jsx("div",{className:"absolute top-40 right-20 w-12 h-12 bg-yellow-400/20 rounded-lg rotate-45 animate-float-delay-1"}),a.jsx("div",{className:"absolute bottom-32 left-32 w-6 h-6 bg-pink-400/20 rounded-full animate-float-delay-2"}),a.jsx("div",{className:"absolute bottom-60 right-40 w-10 h-10 bg-blue-300/20 rounded-lg rotate-12 animate-float-delay-3"}),a.jsx("div",{className:"absolute top-1/4 left-1/4 w-20 h-20 bg-gradient-to-r from-yellow-400/10 to-orange-400/10 rounded-full blur-xl animate-pulse"}),a.jsx("div",{className:"absolute bottom-1/4 right-1/4 w-16 h-16 bg-gradient-to-r from-purple-400/10 to-pink-400/10 rounded-full blur-xl animate-pulse delay-500"})]}),w&&a.jsx("div",{className:"absolute inset-0 pointer-events-none z-50",children:[...Array(15)].map((ot,Pt)=>a.jsx("div",{className:"absolute w-3 h-3 bg-yellow-400 rounded-full animate-ping",style:{top:`${20+Math.random()*60}%`,left:`${20+Math.random()*60}%`,animationDelay:`${Math.random()*1}s`,animationDuration:"1.5s"}},Pt))}),a.jsxs("div",{className:"relative z-10 max-w-7xl mx-auto px-3 sm:px-4 py-3 sm:py-4 md:py-6",children:[a.jsxs("div",{className:"text-center mb-4 sm:mb-6 md:mb-8",children:[(W&&F||fe&&L)&&a.jsx("div",{className:"bg-white/15 backdrop-blur-lg rounded-3xl p-4 sm:p-6 mb-6 border border-white/30 shadow-2xl",children:a.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 sm:gap-6",children:[a.jsxs("div",{className:"flex items-center space-x-4 sm:space-x-5",children:[a.jsx("div",{className:"w-12 h-12 sm:w-14 sm:h-14 bg-gradient-to-br from-yellow-400 via-orange-500 to-red-500 rounded-full flex items-center justify-center shadow-xl ring-2 ring-white/20",children:a.jsx(Hs,{className:"w-6 h-6 sm:w-7 sm:h-7 text-white drop-shadow-sm"})}),a.jsxs("div",{className:"text-left",children:[a.jsx("div",{className:"text-white font-bold text-lg sm:text-xl md:text-2xl mb-1 text-shadow-sm",children:L?L.fullName||"Spin Wheel User":(F==null?void 0:F.name)||"User"}),a.jsx("div",{className:"text-white/80 text-sm sm:text-base md:text-lg font-medium mb-2",children:L?L.phone:(F==null?void 0:F.phone)||""}),a.jsx("div",{className:"bg-gradient-to-r from-green-400/20 to-blue-400/20 backdrop-blur-sm rounded-xl px-3 py-1.5 border border-green-400/30",children:a.jsxs("div",{className:"text-green-300 text-sm sm:text-base font-semibold flex items-center space-x-2",children:[a.jsxs("span",{children:[" ",(((ns=le==null?void 0:le.currentThreshold)==null?void 0:ns.name)||"Bronze").replace(/\s*Member$/i,"")]}),a.jsx("span",{className:"text-white/60",children:""}),a.jsxs("span",{children:[" ",He.length," spins"]}),a.jsx("span",{className:"text-white/60",children:""}),a.jsxs("span",{children:[" ",ve.filter(ot=>ot.usageCount===0).length," coupons"]})]})})]})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-3 sm:gap-5 w-full sm:w-auto",children:[Number(t.maxSpinsPerCustomer)>0&&a.jsx("div",{className:"bg-gradient-to-r from-blue-500/40 to-cyan-500/40 backdrop-blur-sm px-4 py-2 sm:px-5 sm:py-3 rounded-2xl border border-blue-400/60 shadow-xl",children:a.jsxs("span",{className:"text-white text-sm sm:text-base md:text-lg font-bold text-shadow-sm",children:[" ",p," spins left"]})}),Number(t.maxSpinsPerCustomer)===0&&a.jsx("div",{className:"bg-gradient-to-r from-green-500/40 to-emerald-500/40 backdrop-blur-sm px-4 py-2 sm:px-5 sm:py-3 rounded-2xl border border-green-400/60 shadow-xl",children:a.jsx("span",{className:"text-white text-sm sm:text-base md:text-lg font-bold text-shadow-sm",children:" Unlimited Spins"})}),a.jsxs("div",{className:"flex items-center space-x-3 sm:space-x-4",children:[a.jsxs("button",{onClick:At,className:"bg-white/25 hover:bg-white/35 px-4 py-2 sm:px-5 sm:py-3 rounded-xl text-white font-semibold transition-all duration-200 flex items-center space-x-2 text-sm sm:text-base shadow-lg hover:shadow-xl backdrop-blur-sm border border-white/20",children:[a.jsx(Sa,{className:"w-4 h-4 sm:w-5 sm:h-5"}),a.jsx("span",{className:"hidden sm:inline",children:"Dashboard"}),a.jsx("span",{className:"sm:hidden",children:"Stats"})]}),a.jsxs("button",{onClick:()=>{if(L){const ot=s||t.restaurantId;window.open(`/${ot}/customer-dashboard?phone=${L.phone}`,"_blank")}},className:"bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 px-4 py-2 sm:px-5 sm:py-3 rounded-xl text-white font-semibold transition-all duration-200 flex items-center space-x-2 text-sm sm:text-base shadow-lg hover:shadow-xl",children:[a.jsx(Hs,{className:"w-4 h-4 sm:w-5 sm:h-5"}),a.jsx("span",{className:"hidden sm:inline",children:"Full Dashboard"}),a.jsx("span",{className:"sm:hidden",children:"Profile"})]}),a.jsx("button",{onClick:()=>{L?(localStorage.removeItem("spinWheelPhoneUser"),K(null),ee(!1),V(!0),Z.success("Logged out successfully")):z()},className:"bg-red-500/30 hover:bg-red-500/40 px-4 py-2 sm:px-5 sm:py-3 rounded-xl text-white font-semibold transition-all duration-200 text-sm sm:text-base shadow-lg hover:shadow-xl backdrop-blur-sm border border-red-400/30",children:"Logout"})]})]})]})}),a.jsxs("div",{className:"mb-4 sm:mb-6",children:[a.jsx("h1",{className:"text-2xl sm:text-3xl md:text-4xl lg:text-5xl font-bold text-white mb-3 px-2 leading-tight",children:e}),a.jsx("div",{className:"h-1 w-12 sm:w-16 md:w-20 bg-gradient-to-r from-yellow-400 to-orange-500 mx-auto rounded-full mb-3 sm:mb-4"}),a.jsx("h2",{className:"text-base sm:text-lg md:text-xl text-white/90 font-medium px-2",children:t.name})]})]}),a.jsxs("div",{className:"flex flex-col items-center justify-center space-y-4 sm:space-y-6 md:space-y-8 px-2",children:[a.jsx("div",{className:"w-full flex justify-center",children:a.jsx("div",{className:"relative max-w-[450px] sm:max-w-[490px] md:max-w-[530px] lg:max-w-[580px] w-full",children:a.jsxs("div",{className:"relative mb-6 sm:mb-8",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-yellow-400/30 via-orange-500/30 to-yellow-400/30 rounded-full blur-xl sm:blur-2xl animate-pulse scale-105"}),a.jsxs("div",{className:"absolute top-0 left-1/2 transform -translate-x-1/2 -translate-y-2 sm:-translate-y-3 z-20",children:[a.jsx("div",{className:"w-0 h-0 border-l-4 border-r-4 border-b-8 sm:border-l-5 sm:border-r-5 sm:border-b-12 md:border-l-6 md:border-r-6 md:border-b-14 border-transparent border-b-white drop-shadow-xl"}),a.jsx("div",{className:"absolute top-2 left-1/2 transform -translate-x-1/2 w-2 h-2 bg-white rounded-full blur-sm opacity-70"})]}),a.jsx("div",{ref:Re,className:"relative transition-transform ease-out rounded-full border-2 sm:border-4 border-white shadow-2xl overflow-hidden w-full aspect-square",style:{transform:`rotate(${g}deg)`,transitionDuration:n?"4s":"0.5s",transitionTimingFunction:n?"cubic-bezier(0.25, 0.46, 0.45, 0.94)":"ease"},children:a.jsxs("svg",{viewBox:"0 0 600 600",className:"w-full h-full block",children:[t.segments.map((ot,Pt)=>{const jt=kt(Pt,t.segments.length);return a.jsxs("g",{children:[a.jsx("path",{d:Nt(Pt,t.segments.length),fill:ot.color,stroke:"#ffffff",strokeWidth:"3",className:"drop-shadow-sm"}),a.jsx("g",{transform:`translate(${jt.x}, ${jt.y}) rotate(${jt.rotation})`,children:a.jsx("text",{x:"0",y:"0",textAnchor:"middle",dominantBaseline:"middle",fontSize:Math.max(22,ir(ot.label,t.segments.length)+8),fontWeight:"bold",fill:"black",style:{fontFamily:"Inter, sans-serif"},children:Ht(ot)})}),a.jsxs("g",{transform:`translate(${300+240*Math.cos(2*Math.PI*Pt/t.segments.length+Math.PI/t.segments.length-Math.PI/2)}, ${300+240*Math.sin(2*Math.PI*Pt/t.segments.length+Math.PI/t.segments.length-Math.PI/2)})`,children:[a.jsx("circle",{r:"18",fill:"rgba(255,255,255,0.95)",stroke:ot.color,strokeWidth:"3",className:"drop-shadow-lg"}),a.jsx("text",{x:"0",y:"6",textAnchor:"middle",dominantBaseline:"middle",fontSize:"20",children:ot.rewardType==="discount_percentage"?"":ot.rewardType==="discount_fixed"?"":ot.rewardType==="free_item"?"":ot.rewardType==="points"?"":ot.label.toLowerCase().includes("luck")?"":""})]})]},ot.id)}),a.jsx("defs",{children:a.jsxs("radialGradient",{id:"centerGradient",cx:"50%",cy:"50%",r:"50%",children:[a.jsx("stop",{offset:"0%",stopColor:"#fbbf24"}),a.jsx("stop",{offset:"100%",stopColor:"#f59e0b"})]})}),a.jsx("circle",{cx:"300",cy:"300",r:"55",fill:"url(#centerGradient)",stroke:"#ffffff",strokeWidth:"5",className:"drop-shadow-xl"}),a.jsxs("g",{transform:"translate(300, 300)",children:[a.jsx("text",{x:"0",y:"-8",textAnchor:"middle",dominantBaseline:"middle",fontSize:"28",children:""}),a.jsx("text",{x:"0",y:"15",textAnchor:"middle",dominantBaseline:"middle",fontSize:"12",fontWeight:"bold",fill:"white",stroke:"rgba(0,0,0,0.3)",strokeWidth:"0.5",style:{fontFamily:"Inter, sans-serif",textShadow:"1px 1px 2px rgba(0,0,0,0.5)"},children:"SPIN"})]})]})}),a.jsx("div",{className:"mb-6 sm:mb-8 w-full flex justify-center mt-8 sm:mt-12 px-4",children:a.jsxs("div",{className:"relative w-full max-w-sm",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-yellow-400 via-orange-500 to-red-500 rounded-2xl blur-xl opacity-80 animate-pulse scale-110"}),a.jsx("div",{className:"absolute -top-3 -left-3 w-5 h-5 border-l-3 border-t-3 border-yellow-400 sm:w-6 sm:h-6"}),a.jsx("div",{className:"absolute -top-3 -right-3 w-5 h-5 border-r-3 border-t-3 border-yellow-400 sm:w-6 sm:h-6"}),a.jsx("div",{className:"absolute -bottom-3 -left-3 w-5 h-5 border-l-3 border-b-3 border-yellow-400 sm:w-6 sm:h-6"}),a.jsx("div",{className:"absolute -bottom-3 -right-3 w-5 h-5 border-r-3 border-b-3 border-yellow-400 sm:w-6 sm:h-6"}),a.jsxs("button",{onClick:ce,disabled:!h||n||!(W||fe),className:`relative px-6 sm:px-8 md:px-10 py-4 sm:py-5 text-xl sm:text-2xl md:text-3xl font-bold rounded-2xl transition-all duration-300 transform w-full ${h&&!n&&(W||fe)?"bg-gradient-to-r from-yellow-400 via-orange-500 to-yellow-400 text-white hover:scale-105 hover:shadow-2xl shadow-xl active:scale-95 hover:from-yellow-300 hover:via-orange-400 hover:to-yellow-300":"bg-gray-400 text-gray-700 cursor-not-allowed"} border-3 border-white/40 backdrop-blur-sm`,style:{boxShadow:h&&!n&&(W||fe)?"0 0 40px rgba(251, 191, 36, 0.6), inset 0 2px 0 rgba(255, 255, 255, 0.4)":"none"},children:[h&&!n&&(W||fe)&&a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent rounded-2xl animate-pulse"}),a.jsx("div",{className:"relative flex items-center justify-center space-x-3 sm:space-x-4",children:n?a.jsxs(a.Fragment,{children:[a.jsx(hx,{className:"w-6 h-6 sm:w-7 sm:h-7 md:w-8 md:h-8 animate-spin"}),a.jsx("span",{className:"font-extrabold tracking-wide text-shadow-sm",children:"SPINNING..."}),a.jsx("div",{className:"absolute -right-10 sm:-right-12 text-2xl animate-bounce",children:""})]}):W||fe?h?a.jsxs(a.Fragment,{children:[a.jsx(ev,{className:"w-6 h-6 sm:w-7 sm:h-7 md:w-8 md:h-8 animate-pulse"}),a.jsx("span",{className:"font-extrabold tracking-wide text-shadow-sm",children:" SPIN TO WIN!"}),a.jsx("div",{className:"absolute -right-10 sm:-right-12 text-2xl animate-bounce delay-300",children:""})]}):a.jsxs(a.Fragment,{children:[a.jsx(El,{className:"w-6 h-6 sm:w-7 sm:h-7 md:w-8 md:h-8"}),a.jsx("span",{className:"font-extrabold tracking-wide text-shadow-sm",children:" NO SPINS LEFT"})]}):a.jsxs(a.Fragment,{children:[a.jsx(lM,{className:"w-6 h-6 sm:w-7 sm:h-7 md:w-8 md:h-8"}),a.jsx("span",{className:"font-extrabold tracking-wide text-shadow-sm",children:" VERIFY TO PLAY"})]})}),h&&!n&&(W||fe)&&a.jsx("div",{className:"absolute inset-0 overflow-hidden rounded-2xl",children:a.jsx("div",{className:"absolute top-0 left-0 w-full h-0.5 bg-gradient-to-r from-transparent via-white to-transparent animate-scanning"})})]})]})})]})})}),!o&&a.jsx("div",{className:"w-full max-w-4xl px-4",children:a.jsxs("div",{className:"bg-white/10 backdrop-blur-md rounded-3xl p-4 sm:p-6 border border-white/20",children:[a.jsxs("div",{className:"text-center mb-4 sm:mb-6",children:[a.jsx(Cn,{className:"w-12 h-12 sm:w-16 sm:h-16 text-yellow-400 mx-auto mb-3 sm:mb-4"}),a.jsx("h3",{className:"text-xl sm:text-2xl font-bold text-white mb-2",children:"Amazing Rewards Await!"}),a.jsx("p",{className:"text-white/80 text-sm sm:text-base",children:"Spin the wheel get rewards"})]}),a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3 sm:gap-4",children:t.segments.slice(0,4).map((ot,Pt)=>a.jsxs("div",{className:"bg-white/10 backdrop-blur-sm rounded-xl p-3 sm:p-4 text-center border border-white/10",children:[a.jsx("div",{className:"w-6 h-6 sm:w-8 sm:h-8 rounded-full mx-auto mb-2 flex items-center justify-center text-white font-bold text-xs sm:text-sm",style:{backgroundColor:ot.color},children:Pt+1}),a.jsx("div",{className:"text-white font-medium text-xs sm:text-sm mb-1",children:ot.label}),a.jsx("div",{className:"text-white/70 text-xs",children:Ar(ot)})]},ot.id))}),t.segments.length>4&&a.jsx("div",{className:"text-center mt-3 sm:mt-4",children:a.jsxs("span",{className:"text-white/70 text-xs sm:text-sm",children:["+ ",t.segments.length-4," more amazing rewards!"]})})]})})]})]}),u&&c&&a.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-3xl p-8 max-w-md w-full max-h-[90vh] overflow-y-auto relative",children:[H&&a.jsx("div",{className:"absolute inset-0 bg-white/80 backdrop-blur-sm rounded-3xl flex items-center justify-center z-10",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-500 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600 font-medium",children:"Processing your reward..."}),a.jsx("p",{className:"text-gray-500 text-sm mt-2",children:"Please wait while we generate your coupon"})]})}),a.jsxs("div",{className:"text-center",children:[a.jsxs("div",{className:"mb-6",children:[or?a.jsx("div",{className:"w-20 h-20 bg-gradient-to-r from-green-400 to-emerald-500 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx(Bb,{className:"w-10 h-10 text-white"})}):a.jsx("div",{className:"w-20 h-20 bg-gradient-to-r from-gray-400 to-gray-500 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx(YA,{className:"w-10 h-10 text-white"})}),a.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:or?" Congratulations!":" Better Luck Next Time!"}),a.jsx("div",{className:"text-lg font-semibold text-gray-700 mb-2",children:c.label}),a.jsx("div",{className:"text-gray-600",children:c.value})]}),v&&E&&a.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 border-2 border-green-200 rounded-xl p-4 mb-6 animate-fadeIn",children:[a.jsx("div",{className:"flex items-center justify-center mb-3",children:a.jsx("div",{className:"w-12 h-12 bg-green-500 rounded-full flex items-center justify-center animate-bounce",children:a.jsx(Nr,{className:"w-8 h-8 text-white"})})}),a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-lg font-bold text-green-800 mb-2",children:" Reward Claimed Successfully!"}),a.jsx("div",{className:"text-sm text-gray-600 mb-3",children:"Your Coupon Code"}),a.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[a.jsx("span",{className:"text-xl font-bold text-green-600 bg-white px-4 py-2 rounded-lg border-2 border-green-200 font-mono",children:E}),a.jsx("button",{onClick:Je,className:"bg-green-500 hover:bg-green-600 text-white p-2 rounded-lg transition-colors shadow-lg hover:shadow-xl",children:a.jsx(po,{className:"w-5 h-5"})})]}),a.jsx("div",{className:"text-xs text-gray-500 mt-2",children:" Code saved to CRM & Coupon Dashboard  Show this code to redeem your reward"})]})]}),a.jsxs("div",{className:"space-y-3",children:[!v&&or&&a.jsx("button",{onClick:()=>{je(!0),Ft()},disabled:H,className:`w-full font-bold py-4 px-6 rounded-xl transition-all duration-300 transform ${H?"bg-gradient-to-r from-blue-500 to-purple-600 animate-pulse scale-95":"bg-gradient-to-r from-green-500 to-emerald-600 hover:shadow-xl hover:scale-105 hover:from-green-600 hover:to-emerald-700 active:scale-95 shadow-lg"} text-white`,children:a.jsx("div",{className:"flex items-center justify-center space-x-2",children:H?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),a.jsx("span",{children:" Processing Your Reward..."}),a.jsxs("div",{className:"flex space-x-1 ml-2",children:[a.jsx("div",{className:"w-1.5 h-1.5 bg-white rounded-full animate-pulse"}),a.jsx("div",{className:"w-1.5 h-1.5 bg-white rounded-full animate-pulse delay-100"}),a.jsx("div",{className:"w-1.5 h-1.5 bg-white rounded-full animate-pulse delay-200"})]})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"animate-bounce",children:a.jsx(v0,{className:"w-5 h-5"})}),a.jsx("span",{children:" Claim Your Reward!"})]})})}),a.jsx("button",{onClick:et,disabled:H,className:`w-full font-bold py-4 px-6 rounded-xl transition-all duration-200 ${H?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-gradient-to-r from-purple-500 to-blue-600 text-white hover:shadow-lg"}`,children:a.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[a.jsx(hx,{className:"w-5 h-5"}),a.jsx("span",{children:"Spin Again!"})]})}),a.jsx("button",{onClick:()=>A(!1),disabled:H,className:`w-full font-medium py-3 px-6 rounded-xl transition-colors ${H?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:"Close"})]})]})]})}),k&&a.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-3xl p-8 max-w-md w-full max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"text-center mb-6",children:[a.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-purple-500 to-blue-600 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx(Hs,{className:"w-8 h-8 text-white"})}),a.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:q==="login"?"Welcome Back!":q==="register"?"Create Account":"Verify Your Phone"}),a.jsx("p",{className:"text-gray-600 mt-2",children:q==="login"?"Sign in to start spinning":q==="register"?"Join the fun and win amazing rewards":"Enter the verification code sent to your phone"})]}),q==="login"&&a.jsxs("form",{onSubmit:X(Jr),className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("input",{...Be("phoneOrEmail",{required:"Phone or email is required"}),type:"text",placeholder:"Phone number or email",className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent"}),_e.phoneOrEmail&&a.jsx("p",{className:"text-red-500 text-sm mt-1",children:_e.phoneOrEmail.message})]}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{...Be("password",{required:"Password is required"}),type:re?"text":"password",placeholder:"Password",className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent pr-12"}),a.jsx("button",{type:"button",onClick:()=>G(!re),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500",children:re?a.jsx(Dl,{className:"w-5 h-5"}):a.jsx(Xs,{className:"w-5 h-5"})}),_e.password&&a.jsx("p",{className:"text-red-500 text-sm mt-1",children:_e.password.message})]}),a.jsx("button",{type:"submit",disabled:Ae,className:"w-full bg-gradient-to-r from-purple-500 to-blue-600 text-white font-bold py-3 px-6 rounded-xl hover:shadow-lg transition-all duration-200 disabled:opacity-50",children:Ae?"Signing In...":"Sign In"}),a.jsx("div",{className:"text-center",children:a.jsx("button",{type:"button",onClick:()=>te("register"),className:"text-purple-600 hover:text-purple-700 font-medium",children:"Don't have an account? Sign up"})})]}),q==="register"&&a.jsxs("form",{onSubmit:mt(ye),className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("input",{...lt("name",{required:"Name is required"}),type:"text",placeholder:"Full name",className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent"}),pt.name&&a.jsx("p",{className:"text-red-500 text-sm mt-1",children:pt.name.message})]}),a.jsxs("div",{children:[a.jsx("input",{...lt("phone",{required:"Phone number is required"}),type:"tel",placeholder:"Phone number",className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent"}),pt.phone&&a.jsx("p",{className:"text-red-500 text-sm mt-1",children:pt.phone.message})]}),a.jsx("div",{children:a.jsx("input",{...lt("email"),type:"email",placeholder:"Email (optional)",className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent"})}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{...lt("password",{required:"Password is required",minLength:{value:6,message:"Password must be at least 6 characters"}}),type:re?"text":"password",placeholder:"Password",className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent pr-12"}),a.jsx("button",{type:"button",onClick:()=>G(!re),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500",children:re?a.jsx(Dl,{className:"w-5 h-5"}):a.jsx(Xs,{className:"w-5 h-5"})}),pt.password&&a.jsx("p",{className:"text-red-500 text-sm mt-1",children:pt.password.message})]}),a.jsxs("div",{children:[a.jsx("input",{...lt("confirmPassword",{required:"Please confirm your password",validate:(ot,Pt)=>ot===Pt.password||"Passwords do not match"}),type:"password",placeholder:"Confirm password",className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent"}),pt.confirmPassword&&a.jsx("p",{className:"text-red-500 text-sm mt-1",children:pt.confirmPassword.message})]}),a.jsx("button",{type:"submit",disabled:Ae,className:"w-full bg-gradient-to-r from-purple-500 to-blue-600 text-white font-bold py-3 px-6 rounded-xl hover:shadow-lg transition-all duration-200 disabled:opacity-50",children:Ae?"Creating Account...":"Create Account"}),a.jsx("div",{className:"text-center",children:a.jsx("button",{type:"button",onClick:()=>te("login"),className:"text-purple-600 hover:text-purple-700 font-medium",children:"Already have an account? Sign in"})})]}),q==="verify"&&a.jsxs("form",{onSubmit:rt(Le),className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("input",{...Me("code",{required:"Verification code is required"}),type:"text",placeholder:"Enter verification code",className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent text-center text-2xl tracking-widest",maxLength:6}),ht.code&&a.jsx("p",{className:"text-red-500 text-sm mt-1",children:ht.code.message})]}),a.jsx("button",{type:"submit",disabled:Ae,className:"w-full bg-gradient-to-r from-purple-500 to-blue-600 text-white font-bold py-3 px-6 rounded-xl hover:shadow-lg transition-all duration-200 disabled:opacity-50",children:Ae?"Verifying...":"Verify"}),a.jsx("div",{className:"text-center",children:a.jsx("button",{type:"button",onClick:se,className:"text-purple-600 hover:text-purple-700 font-medium",children:"Didn't receive code? Resend"})})]})]})}),Ce&&a.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-3xl p-6 max-w-6xl w-full max-h-[95vh] overflow-y-auto",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:" Your Rewards Dashboard"}),a.jsx("p",{className:"text-gray-600 mt-1",children:"Track your spins, rewards, and loyalty points"}),L&&a.jsx("div",{className:"mt-2",children:a.jsxs("button",{onClick:()=>{const ot=s||t.restaurantId;window.open(`/${ot}/customer-dashboard?phone=${L.phone}`,"_blank")},className:"text-purple-600 hover:text-purple-700 text-sm font-medium flex items-center space-x-1",children:[a.jsx(Hs,{className:"w-4 h-4"}),a.jsx("span",{children:"View Full Customer Dashboard with Orders & More "})]})})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsxs("button",{onClick:ft,disabled:De,className:"bg-blue-500 hover:bg-blue-600 text-white p-3 rounded-xl transition-colors disabled:opacity-50 flex items-center space-x-2",title:"Refresh Data",children:[a.jsx(hx,{className:`w-5 h-5 ${De?"animate-spin":""}`}),a.jsx("span",{className:"hidden sm:inline",children:"Refresh"})]}),a.jsx("button",{onClick:()=>oe(!1),className:"bg-gray-200 hover:bg-gray-300 p-3 rounded-xl transition-colors",children:a.jsx(qr,{className:"w-5 h-5"})})]})]}),De?a.jsxs("div",{className:"text-center py-16",children:[a.jsx("div",{className:"animate-spin w-16 h-16 border-4 border-purple-500 border-t-transparent rounded-full mx-auto mb-6"}),a.jsx("p",{className:"text-gray-600 text-lg",children:"Loading your rewards data..."}),a.jsx("p",{className:"text-gray-500 text-sm mt-2",children:"Please wait while we fetch your latest activity"})]}):a.jsxs("div",{className:"space-y-8",children:[a.jsx("div",{className:"bg-gradient-to-br from-purple-50 via-blue-50 to-indigo-50 rounded-2xl p-6 border-2 border-purple-200",children:a.jsxs("div",{className:"flex flex-col md:flex-row items-start md:items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-4 mb-4 md:mb-0",children:[a.jsx("div",{className:"w-20 h-20 bg-gradient-to-r from-purple-500 to-blue-600 rounded-full flex items-center justify-center shadow-lg",children:a.jsx(Hs,{className:"w-10 h-10 text-white"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:L?L.fullName||"Spin Wheel User":(F==null?void 0:F.name)||"User"}),a.jsx("p",{className:"text-gray-600 text-lg",children:L?L.phone:(F==null?void 0:F.phone)||""}),a.jsxs("div",{className:"flex items-center space-x-4 mt-2",children:[le&&a.jsxs("div",{className:"text-purple-600 font-bold text-lg",children:[" ",le.currentPoints||0," points"]}),a.jsxs("div",{className:"text-blue-600 font-medium",children:[" ",((Ia=le==null?void 0:le.currentThreshold)==null?void 0:Ia.name)||"Bronze Member"]})]})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4 w-full md:w-auto",children:[a.jsxs("div",{className:"bg-white rounded-xl p-4 text-center shadow-sm",children:[a.jsx("div",{className:"text-2xl font-bold text-purple-600",children:He.length}),a.jsx("div",{className:"text-sm text-gray-600",children:"Total Spins"})]}),a.jsxs("div",{className:"bg-white rounded-xl p-4 text-center shadow-sm",children:[a.jsx("div",{className:"text-2xl font-bold text-green-600",children:ve.filter(ot=>ot.usageCount===0).length}),a.jsx("div",{className:"text-sm text-gray-600",children:"Active Coupons"})]})]})]})}),le&&a.jsxs("div",{className:"bg-white rounded-2xl border border-gray-200 p-6 shadow-sm",children:[a.jsxs("h3",{className:"text-xl font-bold text-gray-900 mb-6 flex items-center",children:[a.jsx(Bb,{className:"w-6 h-6 text-purple-500 mr-3"}),"Loyalty Points & Status"]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-blue-50 rounded-xl p-6",children:[a.jsxs("div",{className:"flex items-center space-x-4 mb-4",children:[a.jsx("div",{className:"text-4xl",children:((so=le.currentThreshold)==null?void 0:so.badgeIcon)||""}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-xl font-bold text-gray-900",children:((li=le.currentThreshold)==null?void 0:li.name)||"Bronze Member"}),a.jsx("p",{className:"text-gray-600",children:"Current Status"})]})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Current Points"}),a.jsx("span",{className:"font-bold text-purple-600",children:le.currentPoints||0})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Total Earned"}),a.jsx("span",{className:"font-bold text-blue-600",children:le.totalPointsEarned||0})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"From Spins"}),a.jsx("span",{className:"font-bold text-green-600",children:le.totalSpins||0})]})]})]}),le.nextThreshold&&a.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl p-6",children:[a.jsx("h4",{className:"text-lg font-bold text-gray-900 mb-4",children:"Next Level Progress"}),a.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[a.jsx("div",{className:"text-3xl",children:le.nextThreshold.badgeIcon}),a.jsxs("div",{children:[a.jsx("div",{className:"font-bold text-gray-900",children:le.nextThreshold.name}),a.jsxs("div",{className:"text-sm text-gray-600",children:[le.pointsToNext," points to go"]})]})]}),a.jsx("div",{className:"w-full bg-gray-200 rounded-full h-4 mb-2",children:a.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-purple-500 h-4 rounded-full transition-all duration-500",style:{width:`${le.progressToNext||0}%`}})}),a.jsxs("div",{className:"text-center text-sm text-gray-600",children:[(le.progressToNext||0).toFixed(1),"% complete"]})]})]})]}),a.jsxs("div",{className:"bg-white rounded-2xl border border-gray-200 p-6 shadow-sm",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("h3",{className:"text-xl font-bold text-gray-900 flex items-center",children:[a.jsx(Is,{className:"w-6 h-6 text-purple-500 mr-3"}),"Complete Spin History"]}),a.jsxs("div",{className:"text-sm text-gray-500",children:[He.length," total spins"]})]}),He.length>0?a.jsx("div",{className:"space-y-4 max-h-80 overflow-y-auto",children:He.map((ot,Pt)=>{const jt=!ot.resultMessage.toLowerCase().includes("luck"),Lt=new Date(ot.spinDate);return a.jsx("div",{className:"bg-gray-50 rounded-xl p-4 hover:bg-gray-100 transition-colors cursor-pointer",onClick:()=>Fe(ot),children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex items-start space-x-4 flex-1",children:[a.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center ${jt?"bg-gradient-to-r from-green-400 to-emerald-500":"bg-gray-400"}`,children:jt?a.jsx(Cn,{className:"w-6 h-6 text-white"}):a.jsx(El,{className:"w-6 h-6 text-white"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("div",{className:"font-bold text-gray-900 text-lg",children:ot.resultMessage}),a.jsxs("div",{className:"text-gray-600 text-sm mb-2",children:[Lt.toLocaleDateString()," at ",Lt.toLocaleTimeString()]}),a.jsxs("div",{className:"flex flex-wrap gap-2",children:[ot.pointsEarned>0&&a.jsxs("span",{className:"px-3 py-1 bg-purple-100 text-purple-700 text-xs rounded-full font-medium",children:["+",ot.pointsEarned," points"]}),ot.couponCode&&a.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-700 text-xs rounded-full font-mono",children:ot.couponCode})]})]})]}),a.jsxs("div",{className:"flex flex-col items-end space-y-2",children:[ot.isClaimed&&a.jsx("span",{className:"px-3 py-1 bg-green-100 text-green-800 text-xs rounded-full font-medium",children:" Claimed"}),ot.isRedeemed&&a.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 text-xs rounded-full font-medium",children:" Redeemed"}),!ot.isClaimed&&jt&&a.jsx("span",{className:"px-3 py-1 bg-yellow-100 text-yellow-800 text-xs rounded-full font-medium",children:" Pending"})]})]})},ot.id||Pt)})}):a.jsxs("div",{className:"text-center py-12",children:[a.jsx(Bb,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),a.jsx("h4",{className:"text-lg font-medium text-gray-600 mb-2",children:"No spins yet!"}),a.jsx("p",{className:"text-gray-500",children:"Start spinning the wheel to see your history here"})]})]}),ve.length>0&&a.jsxs("div",{className:"bg-white rounded-2xl border border-gray-200 p-6 shadow-sm",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("h3",{className:"text-xl font-bold text-gray-900 flex items-center",children:[a.jsx(v0,{className:"w-6 h-6 text-orange-500 mr-3"}),"Your Reward Coupons"]}),a.jsxs("div",{className:"text-sm text-gray-500",children:[ve.filter(ot=>ot.usageCount===0).length," active  ",ve.length," total"]})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:ve.map((ot,Pt)=>{var _r,jr,ms;const jt=new Date(((_r=ot.validity)==null?void 0:_r.endDate)||ot.expiryDate)<new Date,Lt=ot.usageCount>0,Er=!jt&&!Lt;return a.jsxs("div",{className:`rounded-xl p-5 border-2 transition-all hover:shadow-md ${Er?"bg-gradient-to-br from-green-50 to-emerald-50 border-green-200":Lt?"bg-gradient-to-br from-blue-50 to-indigo-50 border-blue-200":"bg-gradient-to-br from-gray-50 to-gray-100 border-gray-200"}`,children:[a.jsxs("div",{className:"flex items-start justify-between mb-3",children:[a.jsx("div",{className:"text-2xl",children:ot.type==="percentage"?"":ot.type==="fixed_amount"?"":ot.type==="free_item"?"":""}),a.jsx("span",{className:`px-2 py-1 text-xs rounded-full font-bold ${Er?"bg-green-100 text-green-800":Lt?"bg-blue-100 text-blue-800":"bg-red-100 text-red-800"}`,children:Lt?"USED":jt?"EXPIRED":"ACTIVE"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("h4",{className:"font-bold text-gray-900",children:ot.name}),a.jsx("div",{className:"text-sm text-gray-600",children:ot.description}),a.jsxs("div",{className:"bg-white rounded-lg p-3 border",children:[a.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Coupon Code"}),a.jsx("div",{className:"font-mono font-bold text-lg text-gray-900",children:ot.code})]}),a.jsxs("div",{className:"text-xs text-gray-500 space-y-1",children:[a.jsxs("div",{children:["Expires: ",a.jsx("span",{className:jt?"text-red-600 font-medium":"",children:new Date(((jr=ot.validity)==null?void 0:jr.endDate)||ot.expiryDate).toLocaleDateString()})]}),Lt&&ot.usedAt&&a.jsxs("div",{children:["Used on: ",new Date(ot.usedAt).toLocaleDateString()]}),((ms=ot.metadata)==null?void 0:ms.spinWheelName)&&a.jsxs("div",{className:"text-purple-600",children:["From: ",ot.metadata.spinWheelName]})]})]})]},ot.id||Pt)})})]}),He.filter(ot=>ot.isRedeemed).length>0&&a.jsxs("div",{className:"bg-white rounded-2xl border border-gray-200 p-6 shadow-sm",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("h3",{className:"text-xl font-bold text-gray-900 flex items-center",children:[a.jsx(Nr,{className:"w-6 h-6 text-green-500 mr-3"}),"Redeemed Rewards"]}),a.jsxs("div",{className:"text-sm text-gray-500",children:[He.filter(ot=>ot.isRedeemed).length," redeemed"]})]}),a.jsx("div",{className:"space-y-4 max-h-80 overflow-y-auto",children:He.filter(ot=>ot.isRedeemed).sort((ot,Pt)=>new Date(Pt.redeemedDate||Pt.spinDate).getTime()-new Date(ot.redeemedDate||ot.spinDate).getTime()).map((ot,Pt)=>{const jt=new Date(ot.spinDate),Lt=ot.redeemedDate?new Date(ot.redeemedDate):null;return a.jsx("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl p-4 border border-green-200",children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex items-start space-x-4 flex-1",children:[a.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center bg-gradient-to-r from-green-400 to-emerald-500",children:a.jsx(Cn,{className:"w-6 h-6 text-white"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("div",{className:"font-bold text-gray-900 text-lg",children:ot.resultMessage}),a.jsxs("div",{className:"text-gray-600 text-sm mb-2",children:["Won on: ",jt.toLocaleDateString()," at ",jt.toLocaleTimeString()]}),Lt&&a.jsxs("div",{className:"text-green-600 text-sm mb-2 font-medium",children:["Redeemed on: ",Lt.toLocaleDateString()," at ",Lt.toLocaleTimeString()]}),a.jsxs("div",{className:"flex flex-wrap gap-2",children:[ot.pointsEarned>0&&a.jsxs("span",{className:"px-3 py-1 bg-purple-100 text-purple-700 text-xs rounded-full font-medium",children:["+",ot.pointsEarned," points"]}),ot.couponCode&&a.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-700 text-xs rounded-full font-mono",children:ot.couponCode}),a.jsx("span",{className:"px-3 py-1 bg-green-100 text-green-800 text-xs rounded-full font-medium",children:" Successfully Redeemed"})]})]})]}),a.jsxs("div",{className:"flex flex-col items-end space-y-2",children:[a.jsx("span",{className:"px-3 py-1 bg-green-600 text-white text-xs rounded-full font-medium",children:" REDEEMED"}),a.jsx("button",{onClick:()=>Fe(ot),className:"text-green-600 hover:text-green-700 text-xs font-medium underline",children:"View Details"})]})]})},ot.id||Pt)})}),a.jsx("div",{className:"mt-6 bg-gradient-to-r from-green-100 to-emerald-100 rounded-xl p-4 border border-green-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"font-bold text-green-900",children:"Redemption Summary"}),a.jsx("p",{className:"text-green-700 text-sm",children:"Your total rewards used"})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("div",{className:"text-2xl font-bold text-green-600",children:He.filter(ot=>ot.isRedeemed).length}),a.jsx("div",{className:"text-green-700 text-sm",children:"Rewards Used"})]})]})})]}),He.length===0&&ve.length===0&&a.jsxs("div",{className:"text-center py-16",children:[a.jsx("div",{className:"w-24 h-24 bg-gradient-to-r from-purple-100 to-blue-100 rounded-full flex items-center justify-center mx-auto mb-6",children:a.jsx(Cn,{className:"w-12 h-12 text-purple-500"})}),a.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Start Your Rewards Journey!"}),a.jsx("p",{className:"text-gray-600 text-lg mb-6",children:"Spin the wheel to earn points, win coupons, and unlock amazing rewards"}),a.jsx("button",{onClick:()=>oe(!1),className:"bg-gradient-to-r from-purple-500 to-blue-600 text-white px-8 py-3 rounded-xl font-medium hover:shadow-lg transition-all",children:"Start Spinning! "})]})]})]})}),U&&a.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-3xl p-8 max-w-md w-full",children:[a.jsxs("div",{className:"text-center mb-6",children:[a.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-purple-500 to-blue-600 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx(UA,{className:"w-8 h-8 text-white"})}),a.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Verify Your Phone"}),a.jsx("p",{className:"text-gray-600",children:"Please verify your phone number to start spinning"})]}),a.jsx("div",{className:"space-y-4",children:a.jsx(pwe,{})}),a.jsx("p",{className:"text-xs text-gray-500 text-center mt-4",children:"By continuing, you agree to our terms and privacy policy"})]})}),de&&Ie&&a.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-3xl p-8 max-w-md w-full",children:[a.jsxs("div",{className:"text-center mb-6",children:[a.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-green-500 to-emerald-600 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx(Cn,{className:"w-8 h-8 text-white"})}),a.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:" Congratulations!"}),a.jsxs("p",{className:"text-gray-600 mb-4",children:["You won: ",a.jsx("span",{className:"font-semibold text-green-600",children:(Ka=Ie.spinResult)==null?void 0:Ka.label})]}),a.jsx("p",{className:"text-sm text-gray-500",children:"Please enter your name to claim your reward"})]}),a.jsxs("form",{onSubmit:gt(Pe),className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"rewardName",className:"block text-sm font-medium text-gray-700 mb-2",children:"Your Name"}),a.jsx("input",{...Ge("name",{required:"Name is required",minLength:{value:2,message:"Name must be at least 2 characters"}}),type:"text",id:"rewardName",placeholder:"Enter your full name",className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent"}),St.name&&a.jsx("p",{className:"text-red-500 text-sm mt-1",children:St.name.message})]}),a.jsxs("div",{className:"flex space-x-3",children:[a.jsx("button",{type:"button",onClick:()=>{ue(!1),Vt()},className:"flex-1 bg-gray-200 hover:bg-gray-300 text-gray-700 font-bold py-3 px-6 rounded-xl transition-colors",children:"Skip"}),a.jsx("button",{type:"submit",className:"flex-1 bg-gradient-to-r from-green-500 to-emerald-600 text-white font-bold py-3 px-6 rounded-xl hover:shadow-lg transition-all duration-200",children:"Claim Reward"})]})]}),a.jsx("p",{className:"text-xs text-gray-500 text-center mt-4",children:"Your name will be saved for future rewards"})]})}),me&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-3xl max-w-md w-full max-h-[90vh] overflow-y-auto",children:[a.jsx("div",{className:"sticky top-0 bg-white border-b border-gray-200 p-6 rounded-t-3xl",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Spin Details"}),a.jsx("button",{onClick:()=>Fe(null),className:"w-8 h-8 flex items-center justify-center rounded-full hover:bg-gray-100 transition-colors",children:a.jsx(qr,{className:"w-5 h-5 text-gray-500"})})]})}),a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"text-center mb-6",children:[a.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-purple-500 to-pink-500 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx(qi,{className:"w-10 h-10 text-white"})}),a.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-2",children:me.resultMessage}),a.jsxs("div",{className:`inline-flex items-center space-x-2 px-4 py-2 rounded-full text-sm font-medium ${me.isClaimed?"bg-green-100 text-green-800":"bg-orange-100 text-orange-800"}`,children:[a.jsx("div",{className:`w-2 h-2 rounded-full ${me.isClaimed?"bg-green-600":"bg-orange-600"}`}),a.jsx("span",{children:me.isClaimed?"Claimed":"Available"})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"bg-gray-50 rounded-xl p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Spin Date"}),a.jsx("span",{className:"text-sm text-gray-900",children:new Date(me.spinDate).toLocaleDateString()})]}),a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Spin Time"}),a.jsx("span",{className:"text-sm text-gray-900",children:new Date(me.spinDate).toLocaleTimeString()})]}),me.couponCode&&a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Coupon Code"}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("span",{className:"text-sm font-mono bg-gray-200 px-2 py-1 rounded",children:me.couponCode}),a.jsx("button",{onClick:()=>{navigator.clipboard.writeText(me.couponCode),Z.success("Coupon code copied!")},className:"text-blue-600 hover:text-blue-700 text-xs",children:"Copy"})]})]}),me.pointsEarned>0&&a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Points Earned"}),a.jsxs("span",{className:"text-sm text-purple-600 font-medium",children:["+",me.pointsEarned," points"]})]})]}),me.isClaimed?a.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-xl p-4",children:[a.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[a.jsx(Nr,{className:"w-5 h-5 text-green-600"}),a.jsx("span",{className:"font-medium text-green-900",children:"Reward Claimed"})]}),a.jsx("div",{className:"text-sm text-green-700",children:"This reward has been successfully claimed and is ready to use."})]}):a.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-xl p-4",children:[a.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[a.jsx(Ys,{className:"w-5 h-5 text-orange-600"}),a.jsx("span",{className:"font-medium text-orange-900",children:"Ready to Claim"})]}),a.jsx("div",{className:"text-sm text-orange-700 mb-3",children:"This reward is available and ready to be claimed."})]}),a.jsxs("div",{className:"flex space-x-3 pt-4",children:[!me.isClaimed&&a.jsx("button",{onClick:()=>{Fe(null),Z.success("Reward is ready to use!")},className:"flex-1 bg-purple-600 text-white py-3 px-4 rounded-xl hover:bg-purple-700 transition-colors font-medium",children:"Claim Now"}),a.jsx("button",{onClick:()=>Fe(null),className:"flex-1 bg-gray-200 text-gray-700 py-3 px-4 rounded-xl hover:bg-gray-300 transition-colors font-medium",children:"Close"})]})]})]})]})}),a.jsx("style",{children:`
        @keyframes float {
          0%, 100% { transform: translateY(0px) rotate(0deg); }
          50% { transform: translateY(-20px) rotate(10deg); }
        }
        @keyframes float-delay-1 {
          0%, 100% { transform: translateY(0px) rotate(45deg); }
          50% { transform: translateY(-15px) rotate(55deg); }
        }
        @keyframes float-delay-2 {
          0%, 100% { transform: translateY(0px) rotate(0deg); }
          50% { transform: translateY(-25px) rotate(-10deg); }
        }
        @keyframes float-delay-3 {
          0%, 100% { transform: translateY(0px) rotate(12deg); }
          50% { transform: translateY(-18px) rotate(22deg); }
        }
        @keyframes fadeIn {
          0% { opacity: 0; transform: scale(0.95) translateY(10px); }
          100% { opacity: 1; transform: scale(1) translateY(0px); }
        }
        .animate-float {
          animation: float 6s ease-in-out infinite;
        }
        .animate-float-delay-1 {
          animation: float-delay-1 8s ease-in-out infinite;
        }
        .animate-float-delay-2 {
          animation: float-delay-2 7s ease-in-out infinite;
        }
        .animate-float-delay-3 {
          animation: float-delay-3 9s ease-in-out infinite;
        }
        .animate-fadeIn {
          animation: fadeIn 0.6s ease-out forwards;
        }
        
        /* Mobile optimizations */
        .text-shadow-sm {
          text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
        }
        
        /* Enhanced mobile touch targets */
        @media (max-width: 640px) {
          .touch-target {
            min-height: 44px;
            min-width: 44px;
          }
        }
      `})]})}function xwe(){const{slug:t}=uu(),[e,r]=R.useState(null),[s,n]=R.useState(""),[i,o]=R.useState(""),[l,c]=R.useState(!0),[d,u]=R.useState(null);R.useEffect(()=>{t&&A()},[t]);const A=async()=>{if(t)try{c(!0);let f;try{f=await si.getRestaurantBySlug(t),!f.success&&t.length>15&&/^[a-zA-Z0-9]+$/.test(t)&&(console.log("Slug not found, trying as restaurant ID:",t),f=await si.getRestaurantById(t))}catch(p){throw console.error("Error loading restaurant:",p),new Error("Failed to load restaurant information")}if(f.success&&f.data){n(f.data.name),o(f.data.id);let p;try{p=await Ra.getSpinWheelsForRestaurant(f.data.id)}catch(m){throw console.error("Error calling getSpinWheelsForRestaurant:",m),new Error("Failed to load spin wheel configuration")}if(p.success&&p.data){const m=p.data.find(g=>g.isActive);m?r(m):u("No active spin wheel found. Please contact the restaurant for more information.")}else u("Unable to load spin wheel. Please try again later.")}else u("Restaurant not found. Please check the URL and try again.")}catch(f){console.error("Error loading spin wheel:",f),u("Something went wrong. Please try again later.")}finally{c(!1)}},h=f=>{Z.success("Spin recorded successfully!")};return l?a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx(Gi,{className:"w-12 h-12 text-white animate-spin mx-auto mb-4"}),a.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Loading Spin Wheel..."}),a.jsx("p",{className:"text-purple-200",children:"Preparing your game experience"})]})}):d?a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 flex items-center justify-center p-4",children:a.jsxs("div",{className:"max-w-md w-full bg-white/10 backdrop-blur-md rounded-2xl p-8 border border-white/20 text-center",children:[a.jsx(oi,{className:"w-16 h-16 text-red-400 mx-auto mb-4"}),a.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"Oops!"}),a.jsx("p",{className:"text-purple-200 mb-6",children:d}),a.jsx("button",{onClick:()=>window.location.reload(),className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Try Again"})]})}):e?a.jsx("div",{children:a.jsx(gwe,{wheelConfig:e,restaurantName:s,onSpinComplete:h,currentSlug:t})}):a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 flex items-center justify-center p-4",children:a.jsxs("div",{className:"max-w-md w-full bg-white/10 backdrop-blur-md rounded-2xl p-8 border border-white/20 text-center",children:[a.jsx(oi,{className:"w-16 h-16 text-yellow-400 mx-auto mb-4"}),a.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"Wheel Not Found"}),a.jsx("p",{className:"text-purple-200 mb-6",children:"No active spin wheel found for this restaurant."})]})})}function yD(){const{slug:t}=uu(),[e]=$8(),r=Li(),[s,n]=R.useState(null),[i,o]=R.useState([]),[l,c]=R.useState({totalOrders:0,totalSpent:0,averageOrderValue:0,loyaltyPoints:0,favoriteItems:[],visitFrequency:"New Customer",lastVisit:null,spinData:{totalSpins:0,totalCoupons:0,redeemedCoupons:0,totalDiscountEarned:0,totalDiscountUsed:0,availableCoupons:[],spinHistory:[]}}),[d,u]=R.useState(!0),[A,h]=R.useState("overview"),[f,p]=R.useState(""),[m,g]=R.useState(null);R.useEffect(()=>{const j=e.get("phone");j?(p(j),y(j)):(Z.error("Phone number required for dashboard access"),r("/"))},[t,e,r]);const y=async j=>{if(t)try{u(!0);let C;try{C=await si.getRestaurantBySlug(t),!C.success&&t.length>15&&/^[a-zA-Z0-9]+$/.test(t)&&(console.log("Slug not found, trying as restaurant ID:",t),C=await si.getRestaurantById(t))}catch(w){throw console.error("Error loading restaurant:",w),new Error("Failed to load restaurant information")}if(C.success&&C.data){n(C.data);const w=await Ur.getOrdersForRestaurant(C.data.id,100);if(w.success&&w.data){const S=w.data.filter(re=>{var G,Ae;return((G=re.notes)==null?void 0:G.includes(j))||((Ae=re.notes)==null?void 0:Ae.includes("Customer Portal"))}).sort((re,G)=>new Date(G.createdAt).getTime()-new Date(re.createdAt).getTime());o(S);const F=S.reduce((re,G)=>re+G.total,0),B=S.length>0?F/S.length:0,k=new Map;S.forEach(re=>{re.items.forEach(G=>{const Ae=k.get(G.name);Ae?(Ae.orderCount+=G.quantity,Ae.totalSpent+=G.total):k.set(G.name,{orderCount:G.quantity,totalSpent:G.total})})});const D=Array.from(k.entries()).map(([re,G])=>({name:re,...G})).sort((re,G)=>G.orderCount-re.orderCount).slice(0,5);let q="New Customer";S.length>=10?q="VIP Customer":S.length>=5?q="Regular Customer":S.length>=2&&(q="Returning Customer");const te=S.length>0?new Date(S[0].createdAt):null,W=Math.floor(F/10);console.log(" Loading gamification data for:",j,"at restaurant:",C.data.id);let Q={totalSpins:0,totalCoupons:0,redeemedCoupons:0,totalDiscountEarned:0,totalDiscountUsed:0,availableCoupons:[],spinHistory:[]};try{const re=await Uc.getCustomerGamificationHistory(C.data.id,j);if(console.log(" Gamification result:",re),re.success&&re.data){const G=re.data;if(G.spins||G.coupons){const Ae=G.spins||[],he=G.coupons||[],I=Ae.map(U=>{const V=he.find(L=>{var K;return L.code===U.couponCode||((K=L.metadata)==null?void 0:K.spinId)===U.id});return{...U,isRedeemed:V?V.usageCount>0:U.isRedeemed}});Q={totalSpins:Ae.length,totalCoupons:he.length,redeemedCoupons:he.filter(U=>U.usageCount>0).length,totalDiscountEarned:he.reduce((U,V)=>U+(V.discountValue||0),0),totalDiscountUsed:he.filter(U=>U.usageCount>0).reduce((U,V)=>U+(V.discountValue||0),0),availableCoupons:(G.coupons||[]).filter(U=>U.usageCount===0&&!U.isExpired),spinHistory:I}}}}catch(re){console.warn("Failed to load gamification data:",re)}c({totalOrders:S.length,totalSpent:F,averageOrderValue:B,loyaltyPoints:W,favoriteItems:D,visitFrequency:q,lastVisit:te,spinData:Q})}}else Z.error("Restaurant not found"),r("/")}catch(C){console.error("Failed to load dashboard data:",C),Z.error("Failed to load dashboard")}finally{u(!1)}},v=j=>{switch(j){case"placed":return a.jsx(Ys,{className:"w-4 h-4 text-yellow-600"});case"confirmed":return a.jsx(Nr,{className:"w-4 h-4 text-blue-600"});case"preparing":return a.jsx(XA,{className:"w-4 h-4 text-orange-600"});case"ready":return a.jsx(Nr,{className:"w-4 h-4 text-green-600"});case"completed":return a.jsx(rs,{className:"w-4 h-4 text-green-600"});default:return a.jsx(Ys,{className:"w-4 h-4 text-gray-600"})}},x=j=>{switch(j){case"placed":return"bg-yellow-100 text-yellow-800";case"confirmed":return"bg-blue-100 text-blue-800";case"preparing":return"bg-orange-100 text-orange-800";case"ready":return"bg-green-100 text-green-800";case"completed":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},T=l.totalOrders>=10?{tier:"VIP",color:"from-purple-500 to-pink-500",icon:Mte,benefits:"Priority support, exclusive offers"}:l.totalOrders>=5?{tier:"Gold",color:"from-yellow-500 to-orange-500",icon:Bb,benefits:"Special discounts, birthday treats"}:l.totalOrders>=2?{tier:"Silver",color:"from-gray-400 to-gray-500",icon:pA,benefits:"Loyalty points, member offers"}:{tier:"Bronze",color:"from-orange-400 to-red-500",icon:qi,benefits:"Welcome bonus, first order discount"};return d?a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 flex items-center justify-center",children:a.jsx("div",{className:"bg-white rounded-3xl p-8 max-w-md w-full mx-4 shadow-2xl",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Loading your dashboard..."})]})})}):s?a.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100",children:[a.jsxs("div",{className:"max-w-6xl mx-auto px-3 sm:px-4 py-4 sm:py-8",children:[a.jsx("div",{className:"bg-white rounded-2xl sm:rounded-3xl shadow-2xl overflow-hidden mb-4 sm:mb-8",children:a.jsxs("div",{className:"relative bg-gradient-to-br from-blue-600 via-purple-600 to-indigo-700 p-4 sm:p-8 text-white",children:[a.jsx("button",{onClick:()=>r(-1),className:"absolute top-4 left-4 w-10 h-10 bg-white/20 hover:bg-white/30 rounded-full flex items-center justify-center transition-all",children:a.jsx(Jo,{className:"w-5 h-5"})}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center space-y-4 sm:space-y-0 sm:space-x-6 mt-4",children:[a.jsx("div",{className:"w-16 h-16 sm:w-20 sm:h-20 bg-white/20 rounded-2xl flex items-center justify-center",children:a.jsx(Hs,{className:"w-8 h-8 sm:w-10 sm:h-10"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h1",{className:"text-xl sm:text-3xl font-bold mb-2",children:"Welcome to Your Dashboard!"}),a.jsxs("p",{className:"text-blue-100 mb-4 text-sm sm:text-base",children:["Your personal portal at ",s.name]}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center space-y-2 sm:space-y-0 sm:space-x-4",children:[a.jsxs("div",{className:`inline-flex items-center space-x-2 px-3 py-1.5 sm:px-4 sm:py-2 bg-gradient-to-r ${T.color} rounded-full text-white font-medium text-sm`,children:[a.jsx(T.icon,{className:"w-3 h-3 sm:w-4 sm:h-4"}),a.jsxs("span",{children:[T.tier," Member"]})]}),a.jsx("div",{className:"text-xs sm:text-sm text-blue-100",children:T.benefits})]})]})]}),a.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-5 gap-2 sm:gap-4 mt-6 sm:mt-8",children:[a.jsxs("div",{className:"bg-white/10 rounded-lg sm:rounded-xl p-3 sm:p-4 text-center",children:[a.jsx("div",{className:"text-lg sm:text-2xl font-bold",children:l.totalOrders}),a.jsx("div",{className:"text-xs sm:text-sm text-blue-100",children:"Total Orders"})]}),a.jsxs("div",{className:"bg-white/10 rounded-lg sm:rounded-xl p-3 sm:p-4 text-center",children:[a.jsx("div",{className:"text-lg sm:text-2xl font-bold",children:Ue(l.totalSpent)}),a.jsx("div",{className:"text-xs sm:text-sm text-blue-100",children:"Total Spent"})]}),a.jsxs("div",{className:"bg-white/10 rounded-lg sm:rounded-xl p-3 sm:p-4 text-center",children:[a.jsx("div",{className:"text-lg sm:text-2xl font-bold",children:l.loyaltyPoints}),a.jsx("div",{className:"text-xs sm:text-sm text-blue-100",children:"Loyalty Points"})]}),a.jsxs("div",{className:"bg-white/10 rounded-lg sm:rounded-xl p-3 sm:p-4 text-center",children:[a.jsx("div",{className:"text-lg sm:text-2xl font-bold",children:l.spinData.totalSpins}),a.jsx("div",{className:"text-xs sm:text-sm text-blue-100",children:"Spin Rewards"})]}),a.jsxs("div",{className:"bg-white/10 rounded-lg sm:rounded-xl p-3 sm:p-4 text-center",children:[a.jsx("div",{className:"text-lg sm:text-2xl font-bold",children:l.spinData.availableCoupons.length}),a.jsx("div",{className:"text-xs sm:text-sm text-blue-100",children:"Active Coupons"})]})]})]})}),a.jsx("div",{className:"bg-white rounded-2xl shadow-lg mb-4 sm:mb-8 p-1 sm:p-2",children:a.jsx("div",{className:"flex space-x-1",children:[{id:"overview",label:"Overview",icon:rd},{id:"orders",label:"Order History",icon:Kd},{id:"rewards",label:"Rewards",icon:Cn},{id:"profile",label:"Profile",icon:Hs}].map(j=>a.jsxs("button",{onClick:()=>h(j.id),className:`flex items-center space-x-1 sm:space-x-2 px-2 sm:px-6 py-2 sm:py-3 rounded-lg sm:rounded-xl font-medium transition-all flex-1 justify-center text-xs sm:text-sm ${A===j.id?"bg-blue-600 text-white shadow-md":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"}`,children:[a.jsx(j.icon,{className:"w-3 h-3 sm:w-4 sm:h-4"}),a.jsx("span",{className:"hidden sm:inline",children:j.label}),a.jsx("span",{className:"sm:hidden",children:j.label.split(" ")[0]})]},j.id))})}),a.jsxs("div",{className:"bg-white rounded-2xl sm:rounded-3xl shadow-2xl p-4 sm:p-8",children:[A==="overview"&&a.jsxs("div",{className:"space-y-8",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Recent Orders"}),a.jsxs("button",{onClick:()=>h("orders"),className:"text-blue-600 hover:text-blue-700 font-medium flex items-center space-x-1",children:[a.jsx("span",{children:"View All"}),a.jsx(J6,{className:"w-4 h-4"})]})]}),i.length===0?a.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-2xl",children:[a.jsx(Kd,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),a.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Orders Yet"}),a.jsx("p",{className:"text-gray-600 mb-6",children:"Start exploring our delicious menu!"}),a.jsx("button",{onClick:()=>r(`/${s.slug}`),className:"bg-blue-600 text-white px-6 py-3 rounded-xl hover:bg-blue-700 transition-colors font-medium",children:"Browse Menu"})]}):a.jsx("div",{className:"grid gap-4",children:i.slice(0,3).map(j=>a.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6 hover:shadow-md transition-shadow",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsxs("span",{className:"font-semibold text-gray-900",children:["#",j.orderNumber]}),a.jsxs("span",{className:`inline-flex items-center space-x-1 px-3 py-1 rounded-full text-sm font-medium ${x(j.status)}`,children:[v(j.status),a.jsx("span",{className:"capitalize",children:j.status})]})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("div",{className:"font-semibold text-gray-900",children:Ue(j.total)}),a.jsx("div",{className:"text-sm text-gray-500",children:hs(j.createdAt)})]})]}),a.jsxs("div",{className:"text-sm text-gray-600 mb-3",children:[j.items.slice(0,2).map(C=>`${C.quantity}x ${C.name}`).join(", "),j.items.length>2&&` +${j.items.length-2} more`]}),a.jsxs("button",{onClick:()=>r(`/${s.slug}/order-status?order=${j.id}&phone=${f}`),className:"text-blue-600 hover:text-blue-700 font-medium text-sm flex items-center space-x-1",children:[a.jsx(Xs,{className:"w-4 h-4"}),a.jsx("span",{children:"View Details"})]})]},j.id))})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("h3",{className:"text-xl font-semibold text-gray-900 flex items-center space-x-2",children:a.jsx("span",{children:" Spin Wheel Activity"})}),a.jsxs("button",{onClick:()=>r(`/${s.slug}/spin-wheel?phone=${f}`),className:"text-purple-600 hover:text-purple-700 font-medium flex items-center space-x-1",children:[a.jsx("span",{children:"Try Spin Wheel"}),a.jsx(J6,{className:"w-4 h-4"})]})]}),l.spinData.totalSpins>0?a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4",children:[a.jsx("div",{className:"bg-gradient-to-br from-purple-50 to-pink-50 border border-purple-200 rounded-xl p-4",children:a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center",children:a.jsx(qi,{className:"w-5 h-5 text-purple-600"})}),a.jsxs("div",{children:[a.jsx("div",{className:"text-2xl font-bold text-purple-900",children:l.spinData.totalSpins}),a.jsx("div",{className:"text-sm text-purple-600",children:"Total Spins"})]})]})}),a.jsx("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 border border-green-200 rounded-xl p-4",children:a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center",children:a.jsx(v0,{className:"w-5 h-5 text-green-600"})}),a.jsxs("div",{children:[a.jsx("div",{className:"text-2xl font-bold text-green-900",children:l.spinData.availableCoupons.length}),a.jsx("div",{className:"text-sm text-green-600",children:"Active Coupons"})]})]})}),a.jsx("div",{className:"bg-gradient-to-br from-yellow-50 to-orange-50 border border-yellow-200 rounded-xl p-4",children:a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-10 h-10 bg-yellow-100 rounded-full flex items-center justify-center",children:a.jsx(eB,{className:"w-5 h-5 text-yellow-600"})}),a.jsxs("div",{children:[a.jsx("div",{className:"text-2xl font-bold text-yellow-900",children:Ue(l.spinData.totalDiscountEarned)}),a.jsx("div",{className:"text-sm text-yellow-600",children:"Total Savings"})]})]})})]}),l.spinData.spinHistory.length>0&&a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"Recent Spins"}),a.jsx("div",{className:"space-y-3",children:l.spinData.spinHistory.slice(0,3).map((j,C)=>a.jsxs("button",{onClick:()=>g(j),className:"w-full bg-gray-50 hover:bg-gray-100 rounded-lg p-4 flex items-center justify-between transition-colors cursor-pointer",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center",children:a.jsx(qi,{className:"w-4 h-4 text-purple-600"})}),a.jsxs("div",{className:"text-left",children:[a.jsx("div",{className:"font-medium text-gray-900",children:j.reward}),a.jsx("div",{className:"text-sm text-gray-500",children:hs(j.timestamp)})]})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("div",{className:`text-sm font-medium ${j.isRedeemed?"text-green-600":"text-orange-600"}`,children:j.isRedeemed?"Used":"Available"}),a.jsx(Xs,{className:"w-4 h-4 text-gray-400 mt-1"})]})]},C))})]}),l.spinData.availableCoupons.length>0&&a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"Active Coupons"}),a.jsx("div",{className:"grid grid-cols-1 gap-3",children:l.spinData.availableCoupons.slice(0,2).map((j,C)=>a.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200 rounded-lg p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("div",{className:"font-medium text-green-900",children:j.code}),a.jsx("button",{onClick:()=>{navigator.clipboard.writeText(j.code),Z.success("Coupon code copied!")},className:"text-green-600 hover:text-green-700 text-sm",children:"Copy"})]}),a.jsx("div",{className:"text-sm text-green-700 mb-1",children:j.description}),a.jsxs("div",{className:"text-xs text-green-600",children:["Expires: ",hs(j.expiryDate)]})]},C))})]})]}):a.jsxs("div",{className:"text-center py-12 bg-gradient-to-br from-purple-50 to-pink-50 rounded-2xl border border-purple-200",children:[a.jsx(qi,{className:"w-16 h-16 text-purple-400 mx-auto mb-4"}),a.jsx("h4",{className:"text-lg font-medium text-purple-900 mb-2",children:"No Spin Activity Yet"}),a.jsx("p",{className:"text-purple-600 mb-6",children:"Try our exciting spin wheel game to win amazing rewards!"}),a.jsx("button",{onClick:()=>r(`/${s.slug}/spin-wheel?phone=${f}`),className:"bg-purple-600 text-white px-6 py-3 rounded-xl hover:bg-purple-700 transition-colors font-medium",children:"Try Spin Wheel Game"})]})]}),l.favoriteItems.length>0&&a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg sm:text-xl font-semibold text-gray-900 mb-4 sm:mb-6",children:"Your Favorites"}),a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4",children:l.favoriteItems.map((j,C)=>a.jsxs("div",{className:"bg-gradient-to-br from-orange-50 to-red-50 border border-orange-200 rounded-xl p-4",children:[a.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[a.jsx("div",{className:"w-10 h-10 bg-orange-100 rounded-full flex items-center justify-center",children:a.jsx(Mw,{className:"w-5 h-5 text-orange-600"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h4",{className:"font-medium text-gray-900",children:j.name}),a.jsxs("p",{className:"text-sm text-gray-600",children:["Ordered ",j.orderCount," times"]})]})]}),a.jsxs("div",{className:"text-sm text-orange-700",children:["Total spent: ",Ue(j.totalSpent)]})]},C))})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg sm:text-xl font-semibold text-gray-900 mb-4 sm:mb-6",children:"Quick Actions"}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4",children:[a.jsxs("button",{onClick:()=>r(`/${s.slug}`),className:"bg-gradient-to-r from-blue-500 to-blue-600 text-white p-4 sm:p-6 rounded-lg sm:rounded-xl hover:from-blue-600 hover:to-blue-700 transition-all text-left",children:[a.jsx(zr,{className:"w-6 h-6 sm:w-8 sm:h-8 mb-2 sm:mb-3"}),a.jsx("h4",{className:"font-semibold mb-1 sm:mb-2 text-sm sm:text-base",children:"Place New Order"}),a.jsx("p",{className:"text-xs sm:text-sm text-blue-100",children:"Browse menu and order food"})]}),a.jsxs("button",{onClick:()=>h("rewards"),className:"bg-gradient-to-r from-purple-500 to-purple-600 text-white p-4 sm:p-6 rounded-lg sm:rounded-xl hover:from-purple-600 hover:to-purple-700 transition-all text-left",children:[a.jsx(Cn,{className:"w-6 h-6 sm:w-8 sm:h-8 mb-2 sm:mb-3"}),a.jsx("h4",{className:"font-semibold mb-1 sm:mb-2 text-sm sm:text-base",children:"View Rewards"}),a.jsx("p",{className:"text-xs sm:text-sm text-purple-100",children:"Check loyalty points & offers"})]}),a.jsxs("button",{onClick:()=>h("profile"),className:"bg-gradient-to-r from-green-500 to-green-600 text-white p-4 sm:p-6 rounded-lg sm:rounded-xl hover:from-green-600 hover:to-green-700 transition-all text-left sm:col-span-2 lg:col-span-1",children:[a.jsx(Hs,{className:"w-6 h-6 sm:w-8 sm:h-8 mb-2 sm:mb-3"}),a.jsx("h4",{className:"font-semibold mb-1 sm:mb-2 text-sm sm:text-base",children:"View Profile"}),a.jsx("p",{className:"text-xs sm:text-sm text-green-100",children:"Manage your account"})]})]})]})]}),A==="orders"&&a.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between space-y-3 sm:space-y-0",children:[a.jsx("h3",{className:"text-xl sm:text-2xl font-semibold text-gray-900",children:"Order History"}),a.jsxs("button",{onClick:()=>y(f),className:"flex items-center space-x-2 px-3 sm:px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors text-sm",children:[a.jsx(Di,{className:"w-3 h-3 sm:w-4 sm:h-4"}),a.jsx("span",{children:"Refresh"})]})]}),i.length===0?a.jsxs("div",{className:"text-center py-16",children:[a.jsx(Kd,{className:"w-20 h-20 text-gray-400 mx-auto mb-6"}),a.jsx("h4",{className:"text-xl font-medium text-gray-900 mb-4",children:"No Orders Found"}),a.jsx("p",{className:"text-gray-600 mb-8",children:"You haven't placed any orders yet. Start exploring our menu!"}),a.jsx("button",{onClick:()=>r(`/${s.slug}`),className:"bg-blue-600 text-white px-8 py-3 rounded-xl hover:bg-blue-700 transition-colors font-medium",children:"Browse Menu"})]}):a.jsx("div",{className:"space-y-4",children:i.map(j=>a.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6 hover:shadow-lg transition-all",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsxs("span",{className:"text-lg font-semibold text-gray-900",children:["#",j.orderNumber]}),a.jsxs("span",{className:`inline-flex items-center space-x-1 px-3 py-1 rounded-full text-sm font-medium ${x(j.status)}`,children:[v(j.status),a.jsx("span",{className:"capitalize",children:j.status})]})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("div",{className:"text-xl font-bold text-gray-900",children:Ue(j.total)}),a.jsxs("div",{className:"text-sm text-gray-500",children:[hs(j.createdAt),"  ",Wn(j.createdAt)]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-4",children:[a.jsxs("div",{children:[a.jsxs("h4",{className:"font-medium text-gray-900 mb-2",children:["Order Items (",j.items.length,")"]}),a.jsx("div",{className:"space-y-1",children:j.items.map((C,w)=>a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsxs("span",{className:"text-gray-600",children:[C.quantity,"x ",C.name]}),a.jsx("span",{className:"text-gray-900 font-medium",children:Ue(C.total)})]},w))})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Order Summary"}),a.jsxs("div",{className:"space-y-1 text-sm",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Subtotal:"}),a.jsx("span",{className:"text-gray-900",children:Ue(j.subtotal)})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Tax:"}),a.jsx("span",{className:"text-gray-900",children:Ue(j.tax)})]}),a.jsxs("div",{className:"flex justify-between font-medium border-t pt-1",children:[a.jsx("span",{className:"text-gray-900",children:"Total:"}),a.jsx("span",{className:"text-gray-900",children:Ue(j.total)})]})]})]})]}),a.jsxs("div",{className:"flex items-center justify-between pt-4 border-t",children:[a.jsxs("div",{className:"text-sm text-gray-500",children:["Order placed ",hs(j.createdAt)]}),a.jsxs("div",{className:"flex space-x-3",children:[a.jsxs("button",{onClick:()=>r(`/${s.slug}/order-status?order=${j.id}&phone=${f}`),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors font-medium flex items-center space-x-2",children:[a.jsx(Xs,{className:"w-4 h-4"}),a.jsx("span",{children:"Track Order"})]}),j.status==="completed"&&a.jsxs("button",{onClick:()=>r(`/${s.slug}`),className:"bg-gray-100 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-200 transition-colors font-medium flex items-center space-x-2",children:[a.jsx(Uo,{className:"w-4 h-4"}),a.jsx("span",{children:"Reorder"})]})]})]})]},j.id))})]}),A==="rewards"&&a.jsx("div",{className:"space-y-6 sm:space-y-8",children:a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl sm:text-2xl font-semibold text-gray-900 mb-4 sm:mb-6",children:"Loyalty & Rewards"}),a.jsxs("div",{className:"bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-xl sm:rounded-2xl p-6 sm:p-8 mb-6 sm:mb-8",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between space-y-4 sm:space-y-0",children:[a.jsxs("div",{children:[a.jsxs("h4",{className:"text-xl sm:text-2xl font-bold mb-2",children:[l.loyaltyPoints," Points"]}),a.jsx("p",{className:"text-purple-100 text-sm sm:text-base",children:"Available to redeem"})]}),a.jsx("div",{className:"w-12 h-12 sm:w-16 sm:h-16 bg-white/20 rounded-full flex items-center justify-center",children:a.jsx(YA,{className:"w-6 h-6 sm:w-8 sm:h-8"})})]}),a.jsxs("div",{className:"mt-6 pt-6 border-t border-purple-300",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-purple-100",children:"Next reward at 1000 points"}),a.jsxs("span",{className:"text-white font-medium",children:[Math.max(0,1e3-l.loyaltyPoints)," points to go"]})]}),a.jsx("div",{className:"w-full bg-purple-400 rounded-full h-2 mt-2",children:a.jsx("div",{className:"bg-white h-2 rounded-full transition-all duration-500",style:{width:`${Math.min(100,l.loyaltyPoints/1e3*100)}%`}})})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-base sm:text-lg font-semibold text-gray-900 mb-3 sm:mb-4",children:"Available Rewards"}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[a.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h5",{className:"font-medium text-gray-900",children:"Free Coffee"}),a.jsx(Ute,{className:"w-6 h-6 text-amber-600"})]}),a.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Redeem for any coffee drink"}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-lg font-bold text-purple-600",children:"500 Points"}),a.jsx("button",{disabled:l.loyaltyPoints<500,className:"bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:l.loyaltyPoints>=500?"Redeem":"Not enough points"})]})]}),a.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h5",{className:"font-medium text-gray-900",children:"10% Discount"}),a.jsx(Ax,{className:"w-6 h-6 text-green-600"})]}),a.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"10% off your next order"}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-lg font-bold text-purple-600",children:"750 Points"}),a.jsx("button",{disabled:l.loyaltyPoints<750,className:"bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:l.loyaltyPoints>=750?"Redeem":"Not enough points"})]})]})]})]}),a.jsxs("div",{className:"mt-8",children:[a.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Your Coupons"}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6 mb-4 sm:mb-6",children:[a.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 border-2 border-green-200 rounded-xl p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h5",{className:"text-lg font-semibold text-green-900",children:"Available Coupons"}),a.jsx("div",{className:"w-12 h-12 bg-green-500 rounded-full flex items-center justify-center",children:a.jsx(v0,{className:"w-6 h-6 text-white"})})]}),a.jsx("div",{className:"text-3xl font-bold text-green-600 mb-2",children:l.spinData.availableCoupons.length}),a.jsx("p",{className:"text-green-700 text-sm",children:"Ready to use on your next order"}),a.jsxs("div",{className:"mt-4 text-xs text-green-600",children:["Total value: ",(()=>{const j=l.spinData.availableCoupons.reduce((w,S)=>S.discountType==="fixed"&&S.discountValue>0?w+S.discountValue:w,0),C=l.spinData.availableCoupons.filter(w=>w.discountType==="percentage"&&w.discountValue>0).length;return j>0&&C>0?`${Ue(j)} + ${C} % offers`:j>0?Ue(j):C>0?`${C} percentage offers`:"Special rewards"})()]})]}),a.jsxs("div",{className:"bg-gradient-to-br from-gray-50 to-slate-50 border-2 border-gray-200 rounded-xl p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h5",{className:"text-lg font-semibold text-gray-900",children:"Used Coupons"}),a.jsx("div",{className:"w-12 h-12 bg-gray-500 rounded-full flex items-center justify-center",children:a.jsx(Nr,{className:"w-6 h-6 text-white"})})]}),a.jsx("div",{className:"text-3xl font-bold text-gray-600 mb-2",children:l.spinData.redeemedCoupons}),a.jsx("p",{className:"text-gray-700 text-sm",children:"Successfully redeemed"}),a.jsxs("div",{className:"mt-4 text-xs text-gray-600",children:["Total saved: ",Ue(l.spinData.totalDiscountUsed)]})]})]}),l.spinData.availableCoupons.length>0&&a.jsxs("div",{className:"mb-6",children:[a.jsxs("h5",{className:"text-md font-semibold text-gray-900 mb-4 flex items-center",children:[a.jsx(v0,{className:"w-5 h-5 text-green-600 mr-2"}),"Coupons to Redeem (",l.spinData.availableCoupons.length,")"]}),a.jsxs("div",{className:"space-y-3",children:[l.spinData.availableCoupons.slice(0,5).map((j,C)=>a.jsx("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200 rounded-xl p-4 hover:shadow-md transition-all",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[a.jsx("div",{className:"w-8 h-8 bg-green-500 rounded-full flex items-center justify-center",children:a.jsx(Cn,{className:"w-4 h-4 text-white"})}),a.jsxs("div",{children:[a.jsx("h6",{className:"font-semibold text-green-900",children:j.resultMessage||j.reward||j.rewardText||j.label||"Spin Reward"}),a.jsx("p",{className:"text-xs text-green-700",children:j.discountValue&&j.discountValue>0?j.discountType==="percentage"?`${j.discountValue}% off`:`${Ue(j.discountValue)} off`:j.rewardDescription||j.description||"Special offer"})]})]}),a.jsxs("div",{className:"mt-3 p-3 bg-white border-2 border-green-300 rounded-lg",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between space-y-3 sm:space-y-0",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"text-xs font-medium text-green-700 mb-1",children:"COUPON CODE"}),a.jsx("div",{className:"text-base sm:text-lg font-bold font-mono text-green-900 tracking-wider break-all",children:j.couponCode||j.code||j.id||`SPIN${Date.now().toString().slice(-6)}`})]}),a.jsxs("button",{onClick:()=>{const w=j.couponCode||j.code||j.id||`SPIN${Date.now().toString().slice(-6)}`;navigator.clipboard.writeText(w),Z.success("Coupon code copied!")},className:"bg-green-600 hover:bg-green-700 text-white px-3 sm:px-4 py-2 rounded-lg text-xs sm:text-sm font-medium flex items-center space-x-1 sm:space-x-2 transition-colors w-full sm:w-auto justify-center",children:[a.jsx(po,{className:"w-3 h-3 sm:w-4 sm:h-4"}),a.jsx("span",{children:"Copy"})]})]}),a.jsx("div",{className:"mt-2 text-xs text-green-600",children:" Show this code to restaurant staff"})]})]}),a.jsxs("div",{className:"text-right",children:[a.jsxs("div",{className:"inline-flex items-center space-x-1 px-3 py-1 bg-green-100 text-green-800 rounded-full text-xs font-medium",children:[a.jsx(eB,{className:"w-3 h-3"}),a.jsx("span",{children:"Ready"})]}),j.expiryDate&&a.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Expires: ",hs(j.expiryDate)]})]})]})},C)),l.spinData.availableCoupons.length>5&&a.jsx("div",{className:"text-center",children:a.jsxs("p",{className:"text-sm text-gray-600",children:["+",l.spinData.availableCoupons.length-5," more coupons available"]})})]})]}),(l.spinData.redeemedCoupons>0||l.spinData.spinHistory.filter(j=>j.isRedeemed).length>0)&&a.jsxs("div",{className:"mb-6",children:[a.jsxs("h5",{className:"text-md font-semibold text-gray-900 mb-4 flex items-center",children:[a.jsx(Nr,{className:"w-5 h-5 text-green-600 mr-2"}),"Redeemed Coupons (",Math.max(l.spinData.redeemedCoupons,l.spinData.spinHistory.filter(j=>j.isRedeemed).length),")"]}),a.jsxs("div",{className:"space-y-3",children:[l.spinData.spinHistory.filter(j=>j.isRedeemed).length>0?l.spinData.spinHistory.filter(j=>j.isRedeemed).slice(0,5).map((j,C)=>a.jsx("div",{className:"bg-gradient-to-r from-gray-50 to-slate-50 border border-gray-200 rounded-xl p-4 hover:shadow-md transition-all",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[a.jsx("div",{className:"w-8 h-8 bg-gray-500 rounded-full flex items-center justify-center",children:a.jsx(Nr,{className:"w-4 h-4 text-white"})}),a.jsxs("div",{children:[a.jsx("h6",{className:"font-semibold text-gray-900",children:j.resultMessage||j.reward||"Redeemed Reward"}),a.jsxs("p",{className:"text-xs text-gray-700",children:["Won on: ",hs(j.spinDate),"  ",Wn(j.spinDate)]}),j.redeemedDate&&a.jsxs("p",{className:"text-xs text-green-700 font-medium",children:["Redeemed on: ",hs(j.redeemedDate),"  ",Wn(j.redeemedDate)]})]})]}),j.couponCode&&a.jsxs("div",{className:"flex items-center space-x-2 mt-2",children:[a.jsx("span",{className:"text-xs text-gray-600",children:"Code:"}),a.jsx("span",{className:"text-xs font-mono bg-gray-100 text-gray-800 px-2 py-1 rounded",children:j.couponCode}),a.jsxs("button",{onClick:()=>{navigator.clipboard.writeText(j.couponCode),Z.success("Coupon code copied!")},className:"text-gray-600 hover:text-gray-700 text-xs flex items-center space-x-1",children:[a.jsx(po,{className:"w-3 h-3"}),a.jsx("span",{children:"Copy"})]})]})]}),a.jsxs("div",{className:"text-right",children:[a.jsxs("div",{className:"inline-flex items-center space-x-1 px-3 py-1 bg-green-100 text-green-800 rounded-full text-xs font-medium",children:[a.jsx(Nr,{className:"w-3 h-3"}),a.jsx("span",{children:"Used"})]}),j.discountValue&&a.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:["Saved: ",j.discountType==="percentage"?`${j.discountValue}%`:Ue(j.discountValue)]})]})]})},C)):Array.from({length:Math.min(l.spinData.redeemedCoupons,3)},(j,C)=>a.jsx("div",{className:"bg-gradient-to-r from-gray-50 to-slate-50 border border-gray-200 rounded-xl p-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[a.jsx("div",{className:"w-8 h-8 bg-gray-500 rounded-full flex items-center justify-center",children:a.jsx(Nr,{className:"w-4 h-4 text-white"})}),a.jsxs("div",{children:[a.jsxs("h6",{className:"font-semibold text-gray-900",children:["Spin Reward #",C+1]}),a.jsx("p",{className:"text-xs text-gray-700",children:"Successfully redeemed coupon"}),a.jsx("p",{className:"text-xs text-green-700 font-medium",children:"Used for discount on order"})]})]}),a.jsx("div",{className:"text-xs text-gray-600 bg-gray-100 px-2 py-1 rounded inline-block",children:"Coupon details not available"})]}),a.jsxs("div",{className:"text-right",children:[a.jsxs("div",{className:"inline-flex items-center space-x-1 px-3 py-1 bg-green-100 text-green-800 rounded-full text-xs font-medium",children:[a.jsx(Nr,{className:"w-3 h-3"}),a.jsx("span",{children:"Used"})]}),a.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:["Part of ",l.spinData.totalDiscountUsed.toFixed(2)," saved"]})]})]})},`placeholder-${C}`)),l.spinData.redeemedCoupons>5&&a.jsx("div",{className:"text-center",children:a.jsxs("p",{className:"text-sm text-gray-600",children:["+",l.spinData.redeemedCoupons-(l.spinData.spinHistory.filter(j=>j.isRedeemed).length>0?5:3)," more redeemed coupons"]})})]})]}),l.spinData.spinHistory.length>0&&a.jsxs("div",{children:[a.jsxs("h5",{className:"text-md font-semibold text-gray-900 mb-4 flex items-center",children:[a.jsx(Is,{className:"w-5 h-5 text-purple-600 mr-2"}),"Recent Spin Activity"]}),a.jsxs("div",{className:"space-y-3",children:[l.spinData.spinHistory.slice(0,3).map((j,C)=>{var S;const w=!((S=j.resultMessage)!=null&&S.toLowerCase().includes("luck"));return a.jsx("div",{className:"bg-white border border-gray-200 rounded-xl p-4 hover:shadow-md transition-all",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${w?"bg-green-100":"bg-gray-100"}`,children:w?a.jsx(Cn,{className:"w-4 h-4 text-green-600"}):a.jsx(qr,{className:"w-4 h-4 text-gray-600"})}),a.jsxs("div",{children:[a.jsx("h6",{className:"font-medium text-gray-900",children:j.resultMessage||"Spin Result"}),a.jsxs("p",{className:"text-xs text-gray-600",children:[hs(j.spinDate),"  ",Wn(j.spinDate)]})]})]}),a.jsx("div",{className:"text-right",children:a.jsx("div",{className:`inline-flex items-center space-x-1 px-2 py-1 rounded-full text-xs font-medium ${j.isRedeemed?"bg-gray-100 text-gray-800":w?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:a.jsx("span",{children:j.isRedeemed?"Used":w?"Available":"No Prize"})})})]})},C)}),l.spinData.spinHistory.length>3&&a.jsx("div",{className:"text-center",children:a.jsxs("button",{onClick:()=>h("overview"),className:"text-purple-600 hover:text-purple-700 text-sm font-medium",children:["View all ",l.spinData.spinHistory.length," spins "]})})]})]}),l.spinData.availableCoupons.length===0&&l.spinData.totalCoupons===0&&a.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-2xl",children:[a.jsx(v0,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),a.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Coupons Yet"}),a.jsx("p",{className:"text-gray-600 mb-6",children:"Start spinning the wheel to earn coupons and rewards!"}),a.jsx("button",{onClick:()=>r(`/${s.slug}/spin-wheel`),className:"bg-purple-600 text-white px-6 py-3 rounded-xl hover:bg-purple-700 transition-colors font-medium",children:"Try Spin Wheel"})]})]})]})}),A==="profile"&&a.jsx("div",{className:"space-y-6 sm:space-y-8",children:a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl sm:text-2xl font-semibold text-gray-900 mb-4 sm:mb-6",children:"Profile Information"}),a.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl sm:rounded-2xl p-4 sm:p-6 mb-4 sm:mb-6",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row items-center sm:items-start space-y-4 sm:space-y-0 sm:space-x-6 mb-4 sm:mb-6",children:[a.jsx("div",{className:"w-16 h-16 sm:w-20 sm:h-20 bg-gradient-to-br from-blue-500 to-purple-600 rounded-xl sm:rounded-2xl flex items-center justify-center text-white text-xl sm:text-2xl font-bold",children:"C"}),a.jsxs("div",{className:"text-center sm:text-left",children:[a.jsx("h4",{className:"text-lg sm:text-xl font-semibold text-gray-900",children:"Customer"}),a.jsxs("p",{className:"text-gray-600 flex items-center justify-center sm:justify-start space-x-2",children:[a.jsx(UA,{className:"w-4 h-4"}),a.jsx("span",{children:f})]}),a.jsx("p",{className:"text-sm text-gray-500 mt-1",children:l.visitFrequency})]})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6",children:[a.jsxs("div",{className:"text-center p-3 sm:p-4 bg-blue-50 rounded-lg sm:rounded-xl",children:[a.jsx("div",{className:"text-xl sm:text-2xl font-bold text-blue-600",children:l.totalOrders}),a.jsx("div",{className:"text-xs sm:text-sm text-gray-600",children:"Total Orders"})]}),a.jsxs("div",{className:"text-center p-3 sm:p-4 bg-green-50 rounded-lg sm:rounded-xl",children:[a.jsx("div",{className:"text-xl sm:text-2xl font-bold text-green-600",children:Ue(l.totalSpent)}),a.jsx("div",{className:"text-xs sm:text-sm text-gray-600",children:"Total Spent"})]}),a.jsxs("div",{className:"text-center p-3 sm:p-4 bg-purple-50 rounded-lg sm:rounded-xl sm:col-span-2 lg:col-span-1",children:[a.jsx("div",{className:"text-xl sm:text-2xl font-bold text-purple-600",children:l.visitFrequency}),a.jsx("div",{className:"text-xs sm:text-sm text-gray-600",children:"Customer Status"})]})]})]})]})})]}),a.jsx("div",{className:"bg-white rounded-2xl shadow-lg p-4 sm:p-6 mt-4 sm:mt-8",children:a.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between space-y-4 sm:space-y-0",children:[a.jsxs("div",{className:"text-xs sm:text-sm text-gray-600 order-2 sm:order-1",children:["Last updated: ",Wn(new Date)]}),a.jsxs("div",{className:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-3 w-full sm:w-auto order-1 sm:order-2",children:[a.jsxs("button",{onClick:()=>r(`/${s.slug}`),className:"bg-blue-600 text-white px-4 sm:px-6 py-2.5 sm:py-3 rounded-lg sm:rounded-xl hover:bg-blue-700 transition-colors font-medium flex items-center justify-center space-x-2 text-sm sm:text-base",children:[a.jsx(zr,{className:"w-3 h-3 sm:w-4 sm:h-4"}),a.jsx("span",{children:"Place New Order"})]}),a.jsxs("button",{onClick:()=>r(`/${s.slug}`),className:"bg-gray-200 text-gray-700 px-4 sm:px-6 py-2.5 sm:py-3 rounded-lg sm:rounded-xl hover:bg-gray-300 transition-colors font-medium flex items-center justify-center space-x-2 text-sm sm:text-base",children:[a.jsx(Zy,{className:"w-3 h-3 sm:w-4 sm:h-4"}),a.jsx("span",{children:"Back to Menu"})]})]})]})})]}),m&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-2 sm:p-4",children:a.jsxs("div",{className:"bg-white rounded-2xl sm:rounded-3xl max-w-md w-full max-h-[95vh] sm:max-h-[90vh] overflow-y-auto",children:[a.jsx("div",{className:"sticky top-0 bg-white border-b border-gray-200 p-4 sm:p-6 rounded-t-2xl sm:rounded-t-3xl",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h2",{className:"text-lg sm:text-xl font-bold text-gray-900",children:"Spin Details"}),a.jsx("button",{onClick:()=>g(null),className:"w-8 h-8 flex items-center justify-center rounded-full hover:bg-gray-100 transition-colors",children:a.jsx(qr,{className:"w-5 h-5 text-gray-500"})})]})}),a.jsxs("div",{className:"p-4 sm:p-6",children:[a.jsxs("div",{className:"text-center mb-6",children:[a.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-purple-500 to-pink-500 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx(qi,{className:"w-10 h-10 text-white"})}),a.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-2",children:m.reward}),a.jsxs("div",{className:`inline-flex items-center space-x-2 px-4 py-2 rounded-full text-sm font-medium ${m.isRedeemed?"bg-green-100 text-green-800":"bg-orange-100 text-orange-800"}`,children:[a.jsx("div",{className:`w-2 h-2 rounded-full ${m.isRedeemed?"bg-green-600":"bg-orange-600"}`}),a.jsx("span",{children:m.isRedeemed?"Used":"Available"})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"bg-gray-50 rounded-xl p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Spin Date"}),a.jsx("span",{className:"text-sm text-gray-900",children:hs(m.timestamp)})]}),a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Spin Time"}),a.jsx("span",{className:"text-sm text-gray-900",children:Wn(m.timestamp)})]}),m.couponCode&&a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Coupon Code"}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("span",{className:"text-sm font-mono bg-gray-200 px-2 py-1 rounded",children:m.couponCode}),a.jsx("button",{onClick:()=>{navigator.clipboard.writeText(m.couponCode),Z.success("Coupon code copied!")},className:"text-blue-600 hover:text-blue-700 text-xs",children:"Copy"})]})]}),m.discountValue&&a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Discount Value"}),a.jsx("span",{className:"text-sm text-green-600 font-medium",children:m.discountType==="percentage"?`${m.discountValue}%`:Ue(m.discountValue)})]})]}),m.isRedeemed?a.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-xl p-4",children:[a.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[a.jsx(Nr,{className:"w-5 h-5 text-green-600"}),a.jsx("span",{className:"font-medium text-green-900",children:"Reward Used"})]}),m.redeemedAt&&a.jsxs("div",{className:"text-sm text-green-700",children:["Used on ",hs(m.redeemedAt)," at ",Wn(m.redeemedAt)]}),m.orderId&&a.jsxs("div",{className:"text-sm text-green-700",children:["Order: #",m.orderId]})]}):a.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-xl p-4",children:[a.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[a.jsx(Ys,{className:"w-5 h-5 text-orange-600"}),a.jsx("span",{className:"font-medium text-orange-900",children:"Ready to Use"})]}),a.jsx("div",{className:"text-sm text-orange-700 mb-3",children:"This reward is available for your next order"}),m.expiryDate&&a.jsxs("div",{className:"text-sm text-orange-700",children:["Expires: ",hs(m.expiryDate)]})]}),a.jsxs("div",{className:"flex space-x-3 pt-4",children:[!m.isRedeemed&&a.jsx("button",{onClick:()=>{g(null),r(`/${s.slug}`)},className:"flex-1 bg-purple-600 text-white py-3 px-4 rounded-xl hover:bg-purple-700 transition-colors font-medium",children:"Use Now"}),a.jsx("button",{onClick:()=>g(null),className:"flex-1 bg-gray-200 text-gray-700 py-3 px-4 rounded-xl hover:bg-gray-300 transition-colors font-medium",children:"Close"})]})]})]})]})})]}):a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 flex items-center justify-center",children:a.jsxs("div",{className:"bg-white rounded-3xl p-8 max-w-md w-full mx-4 shadow-2xl text-center",children:[a.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Restaurant Not Found"}),a.jsx("button",{onClick:()=>r("/"),className:"bg-blue-600 text-white px-6 py-3 rounded-xl hover:bg-blue-700 transition-colors",children:"Go Home"})]})})}function ywe(){const{slug:t}=uu(),[e,r]=R.useState(null),[s,n]=R.useState(!0),[i,o]=R.useState(null);R.useEffect(()=>{t&&l()},[t]);const l=async()=>{if(t)try{n(!0),console.log(" Checking restaurant with slug:",t);const c=await si.getRestaurantBySlug(t);console.log(" Restaurant check result:",c),c.success&&c.data?(r(c.data),o(null)):(o(c.error||"Restaurant not found"),r(null))}catch(c){console.error(" Error checking restaurant:",c),o(c.message||"Failed to check restaurant")}finally{n(!1)}};return s?a.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),a.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Checking Restaurant..."}),a.jsxs("p",{className:"text-gray-600",children:["Slug: ",t]})]})}):a.jsx("div",{className:"min-h-screen bg-gray-50 p-8",children:a.jsx("div",{className:"max-w-4xl mx-auto",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Restaurant Debug Info"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Slug"}),a.jsx("p",{className:"text-lg font-mono bg-gray-100 p-2 rounded",children:t})]}),i&&a.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-red-800 mb-2",children:"Error"}),a.jsx("p",{className:"text-red-700",children:i})]}),e&&a.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-green-800 mb-4",children:"Restaurant Found!"}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"ID"}),a.jsx("p",{className:"font-mono text-sm bg-white p-2 rounded border",children:e.id})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Name"}),a.jsx("p",{className:"font-semibold",children:e.name})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Slug"}),a.jsx("p",{className:"font-mono text-sm bg-white p-2 rounded border",children:e.slug})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Business Type"}),a.jsx("p",{className:"capitalize",children:e.businessType})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Status"}),a.jsx("p",{className:`font-semibold ${e.isActive?"text-green-600":"text-red-600"}`,children:e.isActive?"Active":"Inactive"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Owner ID"}),a.jsx("p",{className:"font-mono text-sm bg-white p-2 rounded border",children:e.ownerId})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Created At"}),a.jsx("p",{className:"text-sm",children:e.createdAt.toLocaleString()})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Updated At"}),a.jsx("p",{className:"text-sm",children:e.updatedAt.toLocaleString()})]})]}),a.jsxs("div",{className:"mt-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Settings"}),a.jsx("pre",{className:"bg-white p-4 rounded border text-xs overflow-auto",children:JSON.stringify(e.settings,null,2)})]}),a.jsxs("div",{className:"mt-4 flex space-x-4",children:[a.jsx("a",{href:`/${e.slug}`,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:"Go to Restaurant"}),a.jsx("a",{href:`/${e.slug}/login`,className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700",children:"Go to Login"})]})]}),a.jsx("div",{className:"mt-6",children:a.jsx("button",{onClick:l,className:"bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700",children:"Refresh Check"})})]})]})})})}function vD(){return a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 flex items-center justify-center p-4",children:a.jsxs("div",{className:"max-w-lg w-full text-center",children:[a.jsxs("div",{className:"mb-8",children:[a.jsx("div",{className:"text-9xl font-bold text-gray-300 mb-4 animate-pulse",children:"404"}),a.jsxs("div",{className:"flex justify-center space-x-2 mb-6",children:[a.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full animate-bounce"}),a.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),a.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})]}),a.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 animate-fade-in",children:[a.jsx("div",{className:"w-16 h-16 mx-auto bg-gray-100 rounded-full flex items-center justify-center mb-6",children:a.jsx(sn,{className:"w-8 h-8 text-gray-400"})}),a.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Page Not Found"}),a.jsx("p",{className:"text-gray-600 mb-8",children:"The page you're looking for doesn't exist or may have been moved. Let's get you back on track."}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs(G4,{to:"/",className:"w-full btn btn-primary",children:[a.jsx(Zy,{className:"w-4 h-4 mr-2"}),"Go to Homepage"]}),a.jsxs("button",{onClick:()=>window.history.back(),className:"w-full btn btn-secondary",children:[a.jsx(Jo,{className:"w-4 h-4 mr-2"}),"Go Back"]})]}),a.jsx("div",{className:"mt-8 pt-6 border-t border-gray-200",children:a.jsx("p",{className:"text-sm text-gray-500",children:"Looking for a specific restaurant? Try checking the URL or contact support."})})]}),a.jsxs("div",{className:"mt-8 flex items-center justify-center space-x-3 text-gray-400",children:[a.jsx("div",{className:"w-6 h-6 bg-gradient-to-r from-blue-600 to-blue-700 rounded-lg flex items-center justify-center",children:a.jsx(Zc,{className:"w-4 h-4 text-white"})}),a.jsx("span",{className:"text-sm font-medium",children:"TenVerse POS"})]})]})})}class vwe extends R.Component{constructor(r){super(r);Or(this,"handleRefresh",()=>{window.location.reload()});Or(this,"handleGoHome",()=>{window.location.href="/"});this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(r){return{hasError:!0,error:r,errorInfo:null}}componentDidCatch(r,s){console.error("ErrorBoundary caught an error:",r,s),this.setState({error:r,errorInfo:s})}render(){return this.state.hasError?this.props.fallback?this.props.fallback:a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-red-50 to-red-100 flex items-center justify-center p-4",children:a.jsxs("div",{className:"max-w-md w-full bg-white rounded-2xl shadow-xl p-8 text-center animate-fade-in",children:[a.jsx("div",{className:"w-16 h-16 mx-auto bg-red-100 rounded-full flex items-center justify-center mb-6",children:a.jsx(Go,{className:"w-8 h-8 text-red-600"})}),a.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Oops! Something went wrong"}),a.jsx("p",{className:"text-gray-600 mb-6",children:"We're sorry for the inconvenience. An unexpected error occurred while loading the application."}),!1,a.jsxs("div",{className:"space-y-3",children:[a.jsxs("button",{onClick:this.handleRefresh,className:"w-full btn btn-primary",children:[a.jsx(Di,{className:"w-4 h-4 mr-2"}),"Refresh Page"]}),a.jsxs("button",{onClick:this.handleGoHome,className:"w-full btn btn-secondary",children:[a.jsx(Zy,{className:"w-4 h-4 mr-2"}),"Go to Homepage"]})]}),a.jsx("div",{className:"mt-6 pt-6 border-t border-gray-200",children:a.jsx("p",{className:"text-xs text-gray-500",children:"If this problem persists, please contact our support team."})})]})}):this.props.children}}function bwe({children:t}){const{isAuthenticated:e,loading:r,user:s,isPinAuthenticated:n}=ia(),{slug:i}=uu();return console.log(" RestaurantProtectedRoute check:",{slug:i,isAuthenticated:e,loading:r,hasUser:!!s,isPinAuthenticated:n,userName:s==null?void 0:s.name}),r?(console.log(" RestaurantProtectedRoute: Still loading..."),a.jsx(i_,{})):e?(console.log(" RestaurantProtectedRoute: Authenticated, allowing access"),a.jsx(a.Fragment,{children:t})):(console.log(" RestaurantProtectedRoute: Not authenticated, redirecting to login"),a.jsx(M2,{to:`/${i}/login`,replace:!0}))}function wwe(){const t=Li(),{slug:e}=uu();return a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 flex items-center justify-center p-4",children:a.jsxs("div",{className:"max-w-md w-full bg-white rounded-2xl shadow-xl p-8 text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-6",children:a.jsx(Go,{className:"w-8 h-8 text-red-600"})}),a.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Restaurant Not Found"}),a.jsxs("p",{className:"text-gray-600 mb-2",children:['The restaurant "',e,'" could not be found or may be temporarily unavailable.']}),a.jsx("p",{className:"text-sm text-gray-500 mb-8",children:"Please check the URL or contact the restaurant owner for assistance."}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("button",{onClick:()=>t(-1),className:"w-full flex items-center justify-center space-x-2 bg-gray-600 text-white py-3 px-4 rounded-xl font-medium hover:bg-gray-700 transition-colors",children:[a.jsx(Jo,{className:"w-4 h-4"}),a.jsx("span",{children:"Go Back"})]}),a.jsxs("button",{onClick:()=>t("/admin/login"),className:"w-full flex items-center justify-center space-x-2 border border-gray-300 text-gray-700 py-3 px-4 rounded-xl font-medium hover:bg-gray-50 transition-colors",children:[a.jsx(Zy,{className:"w-4 h-4"}),a.jsx("span",{children:"Admin Portal"})]})]}),a.jsx("div",{className:"mt-8 pt-6 border-t border-gray-200",children:a.jsx("p",{className:"text-xs text-gray-400",children:"Powered by TenVerse POS"})})]})})}function Nwe({children:t}){const{restaurant:e,loading:r,error:s}=js();return r?a.jsx(i_,{}):s||!e?a.jsx(wwe,{}):a.jsx(a.Fragment,{children:t})}function Cwe(){const{restaurant:t}=js(),{user:e,logout:r}=ia(),{canAccess:s}=NM(),n=Pre(),i=Li(),o=du(),[l,c]=R.useState(!1),[d,u]=R.useState(!1);if(!t)return null;const A=[{name:"Dashboard",href:`/${t.slug}/dashboard`,icon:Zy,current:o.pathname===`/${t.slug}/dashboard`||o.pathname===`/${t.slug}`},{name:"Tables",href:`/${t.slug}/tables`,icon:Ls,current:o.pathname===`/${t.slug}/tables`},{name:"Orders",href:`/${t.slug}/orders`,icon:Kd,current:o.pathname===`/${t.slug}/orders`}],f=[{name:"Manage Tables",href:`/${t.slug}/tables`,icon:GA,description:"View and manage tables",moduleId:"tables"},{name:"Orders Dashboard",href:`/${t.slug}/orders`,icon:Ote,description:"View and analyze orders",moduleId:"orders"},{name:"Menu Management",href:`/${t.slug}/menu`,icon:hf,description:"Manage menu items & categories",moduleId:"menu"},{name:"Inventory Management",href:`/${t.slug}/inventory`,icon:rs,description:"Track stock & inventory",moduleId:"inventory"},{name:"Kitchen Display",href:`/${t.slug}/kitchen`,icon:Zc,description:"View kitchen orders",moduleId:"kitchen"},{name:"Customer Portal",href:`/${t.slug}/customer-portal`,icon:rd,description:"Configure menu portal & QR codes",moduleId:"customer_portal"},{name:"Customer Management",href:`/${t.slug}/customers`,icon:Ls,description:"Manage customer database",moduleId:"customers"},{name:"Credit Management",href:`/${t.slug}/credits`,icon:No,description:"Manage customer credits & payments",moduleId:"credits"},{name:"Coupon Dashboard",href:`/${t.slug}/coupons`,icon:Cn,description:"Manage coupons & promotions",moduleId:"coupons"},{name:"Gamification Tools",href:`/${t.slug}/gamification`,icon:Vte,description:"Spin wheel & customer engagement",moduleId:"gamification"},{name:"Employee Management",href:`/${t.slug}/employees`,icon:AM,description:"Manage staff & permissions",moduleId:"employees"},{name:"Marketplace",href:`/${t.slug}/marketplace`,icon:Zi,description:"Order bulk supplies & wholesale",moduleId:"marketplace"},{name:"Expense Tracker",href:`/${t.slug}/expenses`,icon:Uo,description:"Track business expenses & budgets",moduleId:"expenses"},{name:"Business Reports",href:`/${t.slug}/reports`,icon:Is,description:"Generate comprehensive reports",moduleId:"reports"},{name:"Settings",href:`/${t.slug}/settings`,icon:Sl,description:"Restaurant settings",moduleId:"settings"}].filter(g=>s(g.moduleId)),p=g=>{i(g),c(!1),u(!1)},m=async()=>{try{await r(),i(`/${t.slug}/login`)}catch(g){console.error("Logout failed:",g)}};return a.jsxs(a.Fragment,{children:[a.jsx("nav",{className:"bg-white/95 backdrop-blur-md shadow-lg border-b border-gray-200 fixed top-0 left-0 right-0 z-50",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"flex justify-between h-16",children:[a.jsx("div",{className:"flex items-center",children:a.jsxs("div",{className:"flex-shrink-0 flex items-center",children:[a.jsx("div",{className:"w-10 h-10 rounded-xl flex items-center justify-center text-white mr-3 shadow-lg",style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"},children:a.jsx(Zc,{className:"w-5 h-5"})}),a.jsxs("div",{className:"hidden sm:block",children:[a.jsx("h1",{className:"text-xl font-bold text-gray-900",children:t.name}),a.jsx("p",{className:"text-xs text-gray-500",children:"Restaurant POS"})]})]})}),a.jsxs("div",{className:"hidden lg:flex items-center space-x-2",children:[A.map(g=>{const y=g.icon;return a.jsxs("button",{onClick:()=>p(g.href),className:`flex items-center px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200 hover:scale-105 ${g.current?"bg-gradient-to-r from-blue-500 to-blue-600 text-white shadow-md transform scale-105":"text-gray-600 hover:text-gray-900 hover:bg-gray-100/80"}`,children:[a.jsx(y,{className:"w-4 h-4 mr-2"}),g.name]},g.name)}),a.jsxs("div",{className:"relative",children:[a.jsxs("button",{onClick:()=>u(!d),className:"flex items-center px-4 py-2 rounded-lg text-sm font-medium text-gray-600 hover:text-gray-900 hover:bg-gray-100/80 transition-all duration-200 hover:scale-105",children:[a.jsx(GA,{className:"w-4 h-4 mr-2"}),"Quick Menu",a.jsx(rM,{className:`w-4 h-4 ml-2 transition-transform duration-200 ${d?"rotate-180":""}`})]}),d&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"fixed inset-0 z-40",onClick:g=>{g.preventDefault(),g.stopPropagation(),u(!1)},style:{background:"transparent",width:"100vw",height:"100vh",top:0,left:0,right:0,bottom:0}}),a.jsxs("div",{className:"absolute top-full mt-2 w-80 max-h-96 bg-white rounded-xl shadow-2xl border border-gray-200 py-2 z-50 overflow-hidden",onClick:g=>g.stopPropagation(),children:[a.jsxs("div",{className:"px-4 py-2 border-b border-gray-100",children:[a.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Quick Access"}),a.jsx("p",{className:"text-xs text-gray-500",children:"Manage your restaurant operations"})]}),a.jsx("div",{className:"py-2 max-h-80 overflow-y-auto custom-scrollbar",children:f.map(g=>{const y=g.icon,v=o.pathname===g.href;return a.jsxs("button",{onClick:()=>p(g.href),className:`flex items-start w-full px-4 py-3 text-left hover:bg-gray-50 transition-colors ${v?"bg-blue-50 border-r-2 border-blue-500":""}`,children:[a.jsx(y,{className:`w-5 h-5 mr-3 mt-0.5 flex-shrink-0 ${v?"text-blue-600":"text-gray-400"}`}),a.jsxs("div",{children:[a.jsx("p",{className:`text-sm font-medium ${v?"text-blue-900":"text-gray-900"}`,children:g.name}),a.jsx("p",{className:"text-xs text-gray-500",children:g.description})]})]},g.name)})})]})]})]})]}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsxs("div",{className:"hidden xl:block relative",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(sn,{className:"h-4 w-4 text-gray-400"})}),a.jsx("input",{type:"text",placeholder:"Search...",className:"block w-48 pl-10 pr-3 py-2 border border-gray-300 rounded-xl text-sm placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-50"})]}),a.jsx("button",{className:"xl:hidden p-2.5 text-gray-400 hover:text-gray-600 rounded-xl hover:bg-gray-100 transition-colors",children:a.jsx(sn,{className:"w-5 h-5"})}),a.jsxs("button",{className:"p-2.5 text-gray-400 hover:text-gray-600 rounded-xl hover:bg-gray-100 transition-colors relative",children:[a.jsx(fp,{className:"w-5 h-5"}),a.jsx("div",{className:"absolute -top-1 -right-1 w-3 h-3 bg-red-500 rounded-full"})]}),a.jsxs("div",{className:"hidden md:flex items-center space-x-3 bg-gray-50 rounded-xl px-3 py-2",children:[a.jsxs("div",{className:"text-right",children:[a.jsx("p",{className:"text-sm font-medium text-gray-900",children:(e==null?void 0:e.name)||"User"}),a.jsx("p",{className:"text-xs text-gray-500",children:n})]}),a.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-blue-500 to-blue-600 rounded-lg flex items-center justify-center",children:a.jsx(Hs,{className:"w-4 h-4 text-white"})}),a.jsx("button",{onClick:m,className:"p-1.5 text-gray-400 hover:text-red-600 rounded-lg hover:bg-red-50 transition-colors",title:"Logout",children:a.jsx(Rj,{className:"w-4 h-4"})})]}),a.jsx("div",{className:"lg:hidden",children:a.jsx("button",{onClick:()=>c(!l),className:"p-2.5 text-gray-600 hover:text-gray-900 rounded-xl hover:bg-gray-100 transition-colors",children:a.jsx(Wte,{className:"w-6 h-6"})})})]})]})})}),l&&a.jsxs("div",{className:"lg:hidden fixed inset-0 z-50",children:[a.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm transition-all duration-300",onClick:()=>c(!1)}),a.jsxs("div",{className:"fixed inset-y-0 right-0 w-80 max-w-[85vw] bg-white shadow-2xl transform transition-transform ease-in-out duration-300 flex flex-col",children:[a.jsxs("div",{className:"flex-shrink-0 flex items-center justify-between p-6 border-b border-gray-200",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-10 h-10 rounded-xl flex items-center justify-center text-white shadow-lg",style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"},children:a.jsx(Zc,{className:"w-5 h-5"})}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-lg font-bold text-gray-900",children:t.name}),a.jsx("p",{className:"text-xs text-gray-500",children:"Restaurant POS"})]})]}),a.jsx("button",{onClick:()=>c(!1),className:"p-2 text-gray-400 hover:text-gray-600 rounded-xl hover:bg-gray-100",children:a.jsx(qr,{className:"w-6 h-6"})})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar px-4 py-6 space-y-2",style:{WebkitOverflowScrolling:"touch"},children:[a.jsxs("div",{className:"mb-6",children:[a.jsx("h3",{className:"text-sm font-semibold text-gray-500 uppercase tracking-wider mb-3 px-2",children:"Main Navigation"}),A.map(g=>{const y=g.icon;return a.jsxs("button",{onClick:()=>p(g.href),className:`flex items-center w-full px-4 py-3 rounded-xl text-sm font-medium transition-all duration-200 ${g.current?"bg-gradient-to-r from-blue-500 to-blue-600 text-white shadow-lg":"text-gray-700 hover:text-gray-900 hover:bg-gray-100"}`,children:[a.jsx(y,{className:"w-5 h-5 mr-3"}),g.name]},g.name)})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-sm font-semibold text-gray-500 uppercase tracking-wider mb-3 px-2",children:"Quick Access"}),f.map(g=>{const y=g.icon,v=o.pathname===g.href;return a.jsxs("button",{onClick:()=>p(g.href),className:`flex items-start w-full px-4 py-3 rounded-xl text-sm font-medium transition-all duration-200 ${v?"bg-gradient-to-r from-blue-500 to-blue-600 text-white shadow-lg":"text-gray-700 hover:text-gray-900 hover:bg-gray-100"}`,children:[a.jsx(y,{className:"w-5 h-5 mr-3 mt-0.5"}),a.jsxs("div",{className:"text-left",children:[a.jsx("div",{children:g.name}),a.jsx("div",{className:`text-xs mt-0.5 ${v?"text-blue-100":"text-gray-500"}`,children:g.description})]})]},g.name)})]})]}),a.jsx("div",{className:"flex-shrink-0 px-6 py-4 border-t border-gray-200",children:a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(sn,{className:"h-4 w-4 text-gray-400"})}),a.jsx("input",{type:"text",placeholder:"Search...",className:"block w-full pl-10 pr-3 py-3 border border-gray-300 rounded-xl text-sm placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})}),a.jsx("div",{className:"flex-shrink-0 px-6 py-4 border-t border-gray-200",children:a.jsxs("div",{className:"flex items-center justify-between bg-gray-50 rounded-xl p-4",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-500 to-blue-600 rounded-xl flex items-center justify-center",children:a.jsx(Hs,{className:"w-5 h-5 text-white"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-900",children:(e==null?void 0:e.name)||"User"}),a.jsx("p",{className:"text-xs text-gray-500",children:n})]})]}),a.jsx("button",{onClick:m,className:"p-2 text-gray-400 hover:text-red-600 rounded-xl hover:bg-red-50 transition-colors",title:"Logout",children:a.jsx(Rj,{className:"w-5 h-5"})})]})})]})]})]})}const jwe=({showDetails:t=!1,className:e=""})=>{const[r,s]=R.useState({connected:!0,retryCount:0}),[n,i]=R.useState(!1),[o,l]=R.useState(new Date);R.useEffect(()=>{c();const p=setInterval(()=>{c()},1e4);return()=>clearInterval(p)},[]);const c=()=>{const p=Nte();s(p),l(new Date)},d=async()=>{i(!0);try{console.log(" Connection retry requested - refreshing page..."),setTimeout(()=>{window.location.reload()},500)}catch(p){console.error("Manual retry failed:",p)}finally{}},u=async()=>{i(!0);try{await wte(),c()}catch(p){console.error("Connection check failed:",p)}finally{i(!1)}};if(!t&&r.connected)return null;const A=()=>n?a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-current"}):r.connected?a.jsx(Nr,{className:"w-4 h-4 text-green-500"}):r.retryCount>0?a.jsx(oi,{className:"w-4 h-4 text-yellow-500"}):a.jsx(ire,{className:"w-4 h-4 text-red-500"}),h=()=>n?"Checking connection...":r.connected?"Connected":r.retryCount>0?`Retrying (${r.retryCount})`:"Connection issue",f=()=>r.connected?"text-green-600 bg-green-50 border-green-200":r.retryCount>0?"text-yellow-600 bg-yellow-50 border-yellow-200":"text-red-600 bg-red-50 border-red-200";return a.jsxs("div",{className:`${e}`,children:[t?a.jsxs("div",{className:`inline-flex items-center px-3 py-2 rounded-lg border text-sm ${f()}`,children:[A(),a.jsx("span",{className:"ml-2",children:h()}),!r.connected&&!n&&a.jsx("button",{onClick:d,className:"ml-3 px-2 py-1 text-xs bg-current bg-opacity-10 rounded hover:bg-opacity-20 transition-colors",children:"Refresh"}),r.connected&&a.jsx("button",{onClick:u,className:"ml-3 px-2 py-1 text-xs bg-current bg-opacity-10 rounded hover:bg-opacity-20 transition-colors",children:"Check"})]}):a.jsxs("div",{className:`inline-flex items-center px-2 py-1 rounded text-xs ${f()}`,children:[A(),a.jsx("span",{className:"ml-1",children:h()})]}),t&&a.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Last checked: ",o.toLocaleTimeString()]})]})},Swe=`
  .animation-delay-150 { animation-delay: 150ms; }
  .animation-delay-300 { animation-delay: 300ms; }
  .shadow-3xl { box-shadow: 0 35px 60px -12px rgba(0, 0, 0, 0.25); }
  .hover\\:shadow-3xl:hover { box-shadow: 0 35px 60px -12px rgba(0, 0, 0, 0.35); }
`,Ewe=()=>{try{const t=dre();return console.log(" VoiceButton: Voice context available:",!!t),a.jsx(_we,{...t})}catch{return console.warn("VoiceButton: Voice context not available, hiding button"),null}},_we=({isSupported:t,hasPermission:e,isListening:r,state:s,transcript:n,requestPermission:i,startListening:o,stopListening:l})=>{const[c,d]=R.useState(!1),[u,A]=R.useState(!1),[h,f]=R.useState(null),p=R.useRef(!1);R.useEffect(()=>{if(n){d(!0);const j=setTimeout(()=>d(!1),3e3);return()=>clearTimeout(j)}},[n]),R.useEffect(()=>{const j=()=>{v()},C=()=>{v()},w=F=>{F.code==="Space"&&!p.current&&e&&(F.preventDefault(),y({}))},S=F=>{F.code==="Space"&&p.current&&(F.preventDefault(),v())};return u&&(document.addEventListener("mouseup",j),document.addEventListener("touchend",C),document.addEventListener("touchcancel",C)),document.addEventListener("keydown",w),document.addEventListener("keyup",S),()=>{document.removeEventListener("mouseup",j),document.removeEventListener("touchend",C),document.removeEventListener("touchcancel",C),document.removeEventListener("keydown",w),document.removeEventListener("keyup",S)}},[u,e]);const m=async()=>{!e&&!await i()||y({})},g=j=>{j.preventDefault()},y=j=>{if(j.preventDefault(),!t){yr.error("Voice commands not supported in this browser.");return}if(s==="processing"||s==="executing"){yr("Please wait, processing previous command...",{icon:""});return}if(u)return;console.log(" VoiceButton: Hold started, beginning recording immediately"),A(!0),p.current=!0,f(Date.now()),OA.getInstance().startPushToTalkRecording()},v=j=>{if(j&&j.preventDefault(),!u)return;console.log(" VoiceButton: Release detected, stopping recording"),A(!1),p.current=!1,f(null),OA.getInstance().stopPushToTalkRecording()},x=()=>{if(u)return"bg-red-600 shadow-red-600/60 ring-4 ring-red-300 ring-opacity-60";switch(s){case"listening":return"bg-red-500 hover:bg-red-600 shadow-red-500/50";case"processing":return"bg-blue-500 hover:bg-blue-600 shadow-blue-500/50";case"executing":return"bg-green-500 hover:bg-green-600 shadow-green-500/50";case"error":return"bg-orange-500 hover:bg-orange-600 shadow-orange-500/50";default:return r?"bg-red-500 hover:bg-red-600 shadow-red-500/50":"bg-gray-700 hover:bg-gray-600 shadow-gray-500/50"}},E=()=>{switch(s){case"listening":return a.jsx(ux,{className:"h-8 w-8 text-white drop-shadow-lg animate-pulse"});case"processing":return a.jsx(Gi,{className:"h-8 w-8 text-white drop-shadow-lg animate-spin"});case"executing":return a.jsx(Dte,{className:"h-8 w-8 text-white drop-shadow-lg animate-bounce"});case"error":return a.jsx(Gte,{className:"h-8 w-8 text-white drop-shadow-lg"});default:return r?a.jsx(ux,{className:"h-8 w-8 text-white drop-shadow-lg animate-pulse"}):a.jsx(ux,{className:"h-8 w-8 text-white drop-shadow-lg hover:scale-110 transition-transform duration-200"})}},T=()=>{switch(s){case"listening":return"Recording... (Release to send)";case"processing":return"Processing...";case"executing":return"Executing...";case"error":return"Error - Try again";default:return"Hold to record (or hold Space)"}};return!t||!OA.isSupported()?null:a.jsxs(a.Fragment,{children:[a.jsx("style",{children:Swe}),a.jsxs("div",{className:"fixed bottom-28 right-4 lg:bottom-6 lg:right-6 z-50",children:[c&&n&&a.jsx("div",{className:"absolute bottom-24 right-0 mb-2 max-w-xs animate-in slide-in-from-bottom-2 duration-300",children:a.jsxs("div",{className:"bg-gray-900/95 backdrop-blur-md text-white text-sm rounded-xl px-4 py-3 shadow-2xl border border-gray-700/50",children:[a.jsx("div",{className:"text-xs text-gray-400 mb-1 font-medium",children:"You said:"}),a.jsx("div",{className:"font-medium leading-relaxed",children:n}),a.jsx("div",{className:"absolute -bottom-1 right-8 w-3 h-3 bg-gray-900/95 border-r border-b border-gray-700/50 transform rotate-45"})]})}),s!=="idle"&&a.jsx("div",{className:"absolute -top-10 left-1/2 transform -translate-x-1/2 whitespace-nowrap animate-in fade-in-0 duration-200",children:a.jsx("div",{className:"bg-gray-900/95 backdrop-blur-md text-white text-xs px-4 py-2 rounded-full shadow-xl border border-gray-700/50 font-medium",children:T()})}),a.jsxs("button",{onClick:g,onMouseDown:e?y:m,onMouseUp:v,onMouseLeave:v,onTouchStart:e?y:m,onTouchEnd:v,onTouchCancel:v,onContextMenu:j=>j.preventDefault(),disabled:!t,className:`
            relative h-20 w-20 rounded-full shadow-2xl transition-all duration-200 transform
            ${x()}
            ${r||u?"scale-110":""}
            ${u?"scale-105":"active:scale-95"}
            focus:outline-none focus:ring-4 focus:ring-blue-300 focus:ring-opacity-50
            backdrop-blur-lg border-2 border-white/30
            hover:shadow-3xl ${u?"":"hover:scale-105"}
            before:absolute before:inset-0 before:rounded-full before:bg-gradient-to-r 
            before:from-white/20 before:to-transparent before:opacity-50
            select-none user-select-none
          `,style:{background:s==="listening"||r?"linear-gradient(135deg, #ef4444 0%, #dc2626 50%, #b91c1c 100%)":s==="processing"?"linear-gradient(135deg, #3b82f6 0%, #2563eb 50%, #1d4ed8 100%)":s==="executing"?"linear-gradient(135deg, #10b981 0%, #059669 50%, #047857 100%)":"linear-gradient(135deg, #6366f1 0%, #4f46e5 50%, #4338ca 100%)"},"aria-label":"Voice command button - Hold to record continuously or press Space key",children:[(r||u)&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"absolute inset-0 rounded-full bg-red-400 animate-ping opacity-30"}),a.jsx("div",{className:"absolute inset-2 rounded-full bg-red-300 animate-ping opacity-20 animation-delay-150"}),a.jsx("div",{className:"absolute inset-4 rounded-full bg-red-200 animate-ping opacity-10 animation-delay-300"})]}),a.jsx("div",{className:"absolute inset-1 rounded-full bg-gradient-to-b from-white/30 to-transparent opacity-60"}),a.jsx("div",{className:"relative z-10 flex items-center justify-center h-full w-full",children:E()}),a.jsx("div",{className:"absolute -inset-1 rounded-full bg-gradient-to-r from-white/20 to-white/5 opacity-50 blur-sm"})]})]})]})};function Twe(){return a.jsxs("div",{className:"min-h-screen bg-gray-50",children:[a.jsx(Cwe,{}),a.jsx("main",{className:"pt-16",children:a.jsx(iq,{})}),a.jsx("div",{className:"fixed bottom-4 left-4 z-40",children:a.jsx(jwe,{})}),a.jsx(Ewe,{})]})}function Iwe(){return R.useEffect(()=>{const t=async()=>{console.log(" TenVerse POS initialized successfully"),si.clearAllSubscriptions(),si.clearAllQueries(),XU()},e=r=>{var s,n,i,o;((n=(s=r.error)==null?void 0:s.message)!=null&&n.includes("INTERNAL ASSERTION FAILED")||(o=(i=r.error)==null?void 0:i.message)!=null&&o.includes("Unexpected state"))&&(console.error(" Global: Firestore assertion failure detected"),console.log(" Global: Auto-refreshing page to fix corrupted state..."),setTimeout(()=>{window.location.reload()},1e3))};return window.addEventListener("error",e),t(),()=>{window.removeEventListener("error",e)}},[]),a.jsx(vwe,{children:a.jsxs(mq,{children:[a.jsx(lW,{position:"top-right",gutter:12,containerStyle:{top:20,right:20},toastOptions:{duration:2500,style:{background:"rgba(31, 41, 55, 0.95)",color:"#fff",fontSize:"14px",fontWeight:"500",padding:"12px 16px",borderRadius:"12px",boxShadow:"0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)",backdropFilter:"blur(8px)",border:"1px solid rgba(255, 255, 255, 0.1)",maxWidth:"350px",wordWrap:"break-word"},success:{duration:2e3,style:{background:"rgba(16, 185, 129, 0.95)",color:"#fff",border:"1px solid rgba(34, 197, 94, 0.3)"},iconTheme:{primary:"#fff",secondary:"rgba(16, 185, 129, 0.95)"}},error:{duration:3500,style:{background:"rgba(239, 68, 68, 0.95)",color:"#fff",border:"1px solid rgba(248, 113, 113, 0.3)"},iconTheme:{primary:"#fff",secondary:"rgba(239, 68, 68, 0.95)"}},loading:{duration:1/0,style:{background:"rgba(59, 130, 246, 0.95)",color:"#fff",border:"1px solid rgba(96, 165, 250, 0.3)"},iconTheme:{primary:"#fff",secondary:"rgba(59, 130, 246, 0.95)"}}}}),a.jsxs(rk,{children:[a.jsx(os,{path:"/admin/login",element:a.jsx(Bre,{})}),a.jsx(os,{path:"/admin/dashboard",element:a.jsx(Fre,{})}),a.jsx(os,{path:"/my-rewards",element:a.jsx(yD,{})}),a.jsx(os,{path:"/",element:a.jsx(M2,{to:"/admin/login",replace:!0})}),a.jsx(os,{path:"/:slug/*",element:a.jsx(_te,{children:a.jsx(Ite,{children:a.jsx(cre,{children:a.jsx(Nwe,{children:a.jsxs(rk,{children:[a.jsx(os,{path:"login",element:a.jsx(Lre,{})}),a.jsx(os,{path:"spin-wheel",element:a.jsx(xwe,{})}),a.jsx(os,{path:"menu-portal",element:a.jsx(xD,{})}),a.jsx(os,{path:"menu-portal/:tableId",element:a.jsx(xD,{})}),a.jsx(os,{path:"order-status",element:a.jsx(mwe,{})}),a.jsx(os,{path:"customer-dashboard",element:a.jsx(yD,{})}),a.jsx(os,{path:"debug",element:a.jsx(ywe,{})}),a.jsxs(os,{path:"/*",element:a.jsx(bwe,{children:a.jsx(Twe,{})}),children:[a.jsx(os,{path:"",element:a.jsx(xB,{})}),a.jsx(os,{path:"dashboard",element:a.jsx(xB,{})}),a.jsx(os,{path:"tables",element:a.jsx(Ore,{})}),a.jsx(os,{path:"menu",element:a.jsx(Dme,{})}),a.jsx(os,{path:"inventory",element:a.jsx(Kme,{})}),a.jsx(os,{path:"orders",element:a.jsx(Lpe,{})}),a.jsx(os,{path:"settings",element:a.jsx(Upe,{})}),a.jsx(os,{path:"customers",element:a.jsx(Mpe,{})}),a.jsx(os,{path:"coupons",element:a.jsx(Qpe,{})}),a.jsx(os,{path:"gamification",element:a.jsx(Vpe,{})}),a.jsx(os,{path:"credits",element:a.jsx(Hpe,{})}),a.jsx(os,{path:"employees",element:a.jsx(qpe,{})}),a.jsx(os,{path:"marketplace",element:a.jsx(cge,{})}),a.jsx(os,{path:"kitchen",element:a.jsx(dge,{})}),a.jsx(os,{path:"customer-portal",element:a.jsx(uge,{})}),a.jsx(os,{path:"expenses",element:a.jsx(fge,{})}),a.jsx(os,{path:"reports",element:a.jsx(Qbe,{})}),a.jsx(os,{path:"takeaway",element:a.jsx(Vbe,{})}),a.jsx(os,{path:"takeaway/new",element:a.jsx($be,{})}),a.jsx(os,{path:"order/:tableId",element:a.jsx(_se,{})})]}),a.jsx(os,{path:"*",element:a.jsx(vD,{})})]})})})})})}),a.jsx(os,{path:"*",element:a.jsx(vD,{})})]})]})})}JC.createRoot(document.getElementById("root")).render(a.jsx(bi.StrictMode,{children:a.jsx(Iwe,{})}));export{wr as E,Us as _,QH as c,bD as g,qV as h};
