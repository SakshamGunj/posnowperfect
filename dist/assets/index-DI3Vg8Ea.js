var H7=Object.defineProperty;var G7=(t,e,r)=>e in t?H7(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var Rr=(t,e,r)=>G7(t,typeof e!="symbol"?e+"":e,r);function K7(t,e){for(var r=0;r<e.length;r++){const n=e[r];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in t)){const a=Object.getOwnPropertyDescriptor(n,s);a&&Object.defineProperty(t,s,a.get?a:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=r(s);fetch(s.href,a)}})();var $ce=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Y7(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var g6={exports:{}},c2={},x6={exports:{}},Mr={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ux=Symbol.for("react.element"),X7=Symbol.for("react.portal"),Q7=Symbol.for("react.fragment"),J7=Symbol.for("react.strict_mode"),Z7=Symbol.for("react.profiler"),eO=Symbol.for("react.provider"),tO=Symbol.for("react.context"),rO=Symbol.for("react.forward_ref"),nO=Symbol.for("react.suspense"),sO=Symbol.for("react.memo"),aO=Symbol.for("react.lazy"),Y3=Symbol.iterator;function iO(t){return t===null||typeof t!="object"?null:(t=Y3&&t[Y3]||t["@@iterator"],typeof t=="function"?t:null)}var y6={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v6=Object.assign,b6={};function wm(t,e,r){this.props=t,this.context=e,this.refs=b6,this.updater=r||y6}wm.prototype.isReactComponent={};wm.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};wm.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function w6(){}w6.prototype=wm.prototype;function gN(t,e,r){this.props=t,this.context=e,this.refs=b6,this.updater=r||y6}var xN=gN.prototype=new w6;xN.constructor=gN;v6(xN,wm.prototype);xN.isPureReactComponent=!0;var X3=Array.isArray,_6=Object.prototype.hasOwnProperty,yN={current:null},N6={key:!0,ref:!0,__self:!0,__source:!0};function S6(t,e,r){var n,s={},a=null,i=null;if(e!=null)for(n in e.ref!==void 0&&(i=e.ref),e.key!==void 0&&(a=""+e.key),e)_6.call(e,n)&&!N6.hasOwnProperty(n)&&(s[n]=e[n]);var l=arguments.length-2;if(l===1)s.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(t&&t.defaultProps)for(n in l=t.defaultProps,l)s[n]===void 0&&(s[n]=l[n]);return{$$typeof:ux,type:t,key:a,ref:i,props:s,_owner:yN.current}}function oO(t,e){return{$$typeof:ux,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function vN(t){return typeof t=="object"&&t!==null&&t.$$typeof===ux}function lO(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var Q3=/\/+/g;function Pb(t,e){return typeof t=="object"&&t!==null&&t.key!=null?lO(""+t.key):e.toString(36)}function ly(t,e,r,n,s){var a=typeof t;(a==="undefined"||a==="boolean")&&(t=null);var i=!1;if(t===null)i=!0;else switch(a){case"string":case"number":i=!0;break;case"object":switch(t.$$typeof){case ux:case X7:i=!0}}if(i)return i=t,s=s(i),t=n===""?"."+Pb(i,0):n,X3(s)?(r="",t!=null&&(r=t.replace(Q3,"$&/")+"/"),ly(s,e,r,"",function(u){return u})):s!=null&&(vN(s)&&(s=oO(s,r+(!s.key||i&&i.key===s.key?"":(""+s.key).replace(Q3,"$&/")+"/")+t)),e.push(s)),1;if(i=0,n=n===""?".":n+":",X3(t))for(var l=0;l<t.length;l++){a=t[l];var c=n+Pb(a,l);i+=ly(a,e,r,c,s)}else if(c=iO(t),typeof c=="function")for(t=c.call(t),l=0;!(a=t.next()).done;)a=a.value,c=n+Pb(a,l++),i+=ly(a,e,r,c,s);else if(a==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return i}function x1(t,e,r){if(t==null)return t;var n=[],s=0;return ly(t,n,"","",function(a){return e.call(r,a,s++)}),n}function cO(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var ai={current:null},cy={transition:null},uO={ReactCurrentDispatcher:ai,ReactCurrentBatchConfig:cy,ReactCurrentOwner:yN};function T6(){throw Error("act(...) is not supported in production builds of React.")}Mr.Children={map:x1,forEach:function(t,e,r){x1(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return x1(t,function(){e++}),e},toArray:function(t){return x1(t,function(e){return e})||[]},only:function(t){if(!vN(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Mr.Component=wm;Mr.Fragment=Q7;Mr.Profiler=Z7;Mr.PureComponent=gN;Mr.StrictMode=J7;Mr.Suspense=nO;Mr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=uO;Mr.act=T6;Mr.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=v6({},t.props),s=t.key,a=t.ref,i=t._owner;if(e!=null){if(e.ref!==void 0&&(a=e.ref,i=yN.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)_6.call(e,c)&&!N6.hasOwnProperty(c)&&(n[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];n.children=l}return{$$typeof:ux,type:t.type,key:s,ref:a,props:n,_owner:i}};Mr.createContext=function(t){return t={$$typeof:tO,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:eO,_context:t},t.Consumer=t};Mr.createElement=S6;Mr.createFactory=function(t){var e=S6.bind(null,t);return e.type=t,e};Mr.createRef=function(){return{current:null}};Mr.forwardRef=function(t){return{$$typeof:rO,render:t}};Mr.isValidElement=vN;Mr.lazy=function(t){return{$$typeof:aO,_payload:{_status:-1,_result:t},_init:cO}};Mr.memo=function(t,e){return{$$typeof:sO,type:t,compare:e===void 0?null:e}};Mr.startTransition=function(t){var e=cy.transition;cy.transition={};try{t()}finally{cy.transition=e}};Mr.unstable_act=T6;Mr.useCallback=function(t,e){return ai.current.useCallback(t,e)};Mr.useContext=function(t){return ai.current.useContext(t)};Mr.useDebugValue=function(){};Mr.useDeferredValue=function(t){return ai.current.useDeferredValue(t)};Mr.useEffect=function(t,e){return ai.current.useEffect(t,e)};Mr.useId=function(){return ai.current.useId()};Mr.useImperativeHandle=function(t,e,r){return ai.current.useImperativeHandle(t,e,r)};Mr.useInsertionEffect=function(t,e){return ai.current.useInsertionEffect(t,e)};Mr.useLayoutEffect=function(t,e){return ai.current.useLayoutEffect(t,e)};Mr.useMemo=function(t,e){return ai.current.useMemo(t,e)};Mr.useReducer=function(t,e,r){return ai.current.useReducer(t,e,r)};Mr.useRef=function(t){return ai.current.useRef(t)};Mr.useState=function(t){return ai.current.useState(t)};Mr.useSyncExternalStore=function(t,e,r){return ai.current.useSyncExternalStore(t,e,r)};Mr.useTransition=function(){return ai.current.useTransition()};Mr.version="18.3.1";x6.exports=Mr;var X=x6.exports;const mi=Y7(X),dO=K7({__proto__:null,default:mi},[X]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fO=X,hO=Symbol.for("react.element"),mO=Symbol.for("react.fragment"),pO=Object.prototype.hasOwnProperty,gO=fO.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,xO={key:!0,ref:!0,__self:!0,__source:!0};function A6(t,e,r){var n,s={},a=null,i=null;r!==void 0&&(a=""+r),e.key!==void 0&&(a=""+e.key),e.ref!==void 0&&(i=e.ref);for(n in e)pO.call(e,n)&&!xO.hasOwnProperty(n)&&(s[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)s[n]===void 0&&(s[n]=e[n]);return{$$typeof:hO,type:t,key:a,ref:i,props:s,_owner:gO.current}}c2.Fragment=mO;c2.jsx=A6;c2.jsxs=A6;g6.exports=c2;var o=g6.exports,Xw={},E6={exports:{}},no={},C6={exports:{}},k6={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(se,Y){var ye=se.length;se.push(Y);e:for(;0<ye;){var re=ye-1>>>1,C=se[re];if(0<s(C,Y))se[re]=Y,se[ye]=C,ye=re;else break e}}function r(se){return se.length===0?null:se[0]}function n(se){if(se.length===0)return null;var Y=se[0],ye=se.pop();if(ye!==Y){se[0]=ye;e:for(var re=0,C=se.length,O=C>>>1;re<O;){var L=2*(re+1)-1,H=se[L],K=L+1,q=se[K];if(0>s(H,ye))K<C&&0>s(q,H)?(se[re]=q,se[K]=ye,re=K):(se[re]=H,se[L]=ye,re=L);else if(K<C&&0>s(q,ye))se[re]=q,se[K]=ye,re=K;else break e}}return Y}function s(se,Y){var ye=se.sortIndex-Y.sortIndex;return ye!==0?ye:se.id-Y.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;t.unstable_now=function(){return a.now()}}else{var i=Date,l=i.now();t.unstable_now=function(){return i.now()-l}}var c=[],u=[],d=1,f=null,m=3,h=!1,g=!1,p=!1,v=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function N(se){for(var Y=r(u);Y!==null;){if(Y.callback===null)n(u);else if(Y.startTime<=se)n(u),Y.sortIndex=Y.expirationTime,e(c,Y);else break;Y=r(u)}}function j(se){if(p=!1,N(se),!g)if(r(c)!==null)g=!0,ae(F);else{var Y=r(u);Y!==null&&de(j,Y.startTime-se)}}function F(se,Y){g=!1,p&&(p=!1,b(S),S=-1),h=!0;var ye=m;try{for(N(Y),f=r(c);f!==null&&(!(f.expirationTime>Y)||se&&!I());){var re=f.callback;if(typeof re=="function"){f.callback=null,m=f.priorityLevel;var C=re(f.expirationTime<=Y);Y=t.unstable_now(),typeof C=="function"?f.callback=C:f===r(c)&&n(c),N(Y)}else n(c);f=r(c)}if(f!==null)var O=!0;else{var L=r(u);L!==null&&de(j,L.startTime-Y),O=!1}return O}finally{f=null,m=ye,h=!1}}var U=!1,A=null,S=-1,k=5,M=-1;function I(){return!(t.unstable_now()-M<k)}function E(){if(A!==null){var se=t.unstable_now();M=se;var Y=!0;try{Y=A(!0,se)}finally{Y?D():(U=!1,A=null)}}else U=!1}var D;if(typeof w=="function")D=function(){w(E)};else if(typeof MessageChannel<"u"){var G=new MessageChannel,Z=G.port2;G.port1.onmessage=E,D=function(){Z.postMessage(null)}}else D=function(){v(E,0)};function ae(se){A=se,U||(U=!0,D())}function de(se,Y){S=v(function(){se(t.unstable_now())},Y)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(se){se.callback=null},t.unstable_continueExecution=function(){g||h||(g=!0,ae(F))},t.unstable_forceFrameRate=function(se){0>se||125<se?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<se?Math.floor(1e3/se):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(se){switch(m){case 1:case 2:case 3:var Y=3;break;default:Y=m}var ye=m;m=Y;try{return se()}finally{m=ye}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(se,Y){switch(se){case 1:case 2:case 3:case 4:case 5:break;default:se=3}var ye=m;m=se;try{return Y()}finally{m=ye}},t.unstable_scheduleCallback=function(se,Y,ye){var re=t.unstable_now();switch(typeof ye=="object"&&ye!==null?(ye=ye.delay,ye=typeof ye=="number"&&0<ye?re+ye:re):ye=re,se){case 1:var C=-1;break;case 2:C=250;break;case 5:C=1073741823;break;case 4:C=1e4;break;default:C=5e3}return C=ye+C,se={id:d++,callback:Y,priorityLevel:se,startTime:ye,expirationTime:C,sortIndex:-1},ye>re?(se.sortIndex=ye,e(u,se),r(c)===null&&se===r(u)&&(p?(b(S),S=-1):p=!0,de(j,ye-re))):(se.sortIndex=C,e(c,se),g||h||(g=!0,ae(F))),se},t.unstable_shouldYield=I,t.unstable_wrapCallback=function(se){var Y=m;return function(){var ye=m;m=Y;try{return se.apply(this,arguments)}finally{m=ye}}}})(k6);C6.exports=k6;var yO=C6.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vO=X,eo=yO;function Ft(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var I6=new Set,ug={};function fh(t,e){Y0(t,e),Y0(t+"Capture",e)}function Y0(t,e){for(ug[t]=e,t=0;t<e.length;t++)I6.add(e[t])}var Rc=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Qw=Object.prototype.hasOwnProperty,bO=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,J3={},Z3={};function wO(t){return Qw.call(Z3,t)?!0:Qw.call(J3,t)?!1:bO.test(t)?Z3[t]=!0:(J3[t]=!0,!1)}function _O(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function NO(t,e,r,n){if(e===null||typeof e>"u"||_O(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function ii(t,e,r,n,s,a,i){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=a,this.removeEmptyString=i}var xa={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){xa[t]=new ii(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];xa[e]=new ii(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){xa[t]=new ii(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){xa[t]=new ii(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){xa[t]=new ii(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){xa[t]=new ii(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){xa[t]=new ii(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){xa[t]=new ii(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){xa[t]=new ii(t,5,!1,t.toLowerCase(),null,!1,!1)});var bN=/[\-:]([a-z])/g;function wN(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(bN,wN);xa[e]=new ii(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(bN,wN);xa[e]=new ii(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(bN,wN);xa[e]=new ii(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){xa[t]=new ii(t,1,!1,t.toLowerCase(),null,!1,!1)});xa.xlinkHref=new ii("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){xa[t]=new ii(t,1,!1,t.toLowerCase(),null,!0,!0)});function _N(t,e,r,n){var s=xa.hasOwnProperty(e)?xa[e]:null;(s!==null?s.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(NO(e,r,s,n)&&(r=null),n||s===null?wO(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):s.mustUseProperty?t[s.propertyName]=r===null?s.type===3?!1:"":r:(e=s.attributeName,n=s.attributeNamespace,r===null?t.removeAttribute(e):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var Hc=vO.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,y1=Symbol.for("react.element"),p0=Symbol.for("react.portal"),g0=Symbol.for("react.fragment"),NN=Symbol.for("react.strict_mode"),Jw=Symbol.for("react.profiler"),j6=Symbol.for("react.provider"),P6=Symbol.for("react.context"),SN=Symbol.for("react.forward_ref"),Zw=Symbol.for("react.suspense"),e5=Symbol.for("react.suspense_list"),TN=Symbol.for("react.memo"),Fu=Symbol.for("react.lazy"),R6=Symbol.for("react.offscreen"),eT=Symbol.iterator;function ep(t){return t===null||typeof t!="object"?null:(t=eT&&t[eT]||t["@@iterator"],typeof t=="function"?t:null)}var es=Object.assign,Rb;function yp(t){if(Rb===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);Rb=e&&e[1]||""}return`
`+Rb+t}var Db=!1;function Fb(t,e){if(!t||Db)return"";Db=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var n=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){n=u}t.call(e.prototype)}else{try{throw Error()}catch(u){n=u}t()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),a=n.stack.split(`
`),i=s.length-1,l=a.length-1;1<=i&&0<=l&&s[i]!==a[l];)l--;for(;1<=i&&0<=l;i--,l--)if(s[i]!==a[l]){if(i!==1||l!==1)do if(i--,l--,0>l||s[i]!==a[l]){var c=`
`+s[i].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=i&&0<=l);break}}}finally{Db=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?yp(t):""}function SO(t){switch(t.tag){case 5:return yp(t.type);case 16:return yp("Lazy");case 13:return yp("Suspense");case 19:return yp("SuspenseList");case 0:case 2:case 15:return t=Fb(t.type,!1),t;case 11:return t=Fb(t.type.render,!1),t;case 1:return t=Fb(t.type,!0),t;default:return""}}function t5(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case g0:return"Fragment";case p0:return"Portal";case Jw:return"Profiler";case NN:return"StrictMode";case Zw:return"Suspense";case e5:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case P6:return(t.displayName||"Context")+".Consumer";case j6:return(t._context.displayName||"Context")+".Provider";case SN:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case TN:return e=t.displayName||null,e!==null?e:t5(t.type)||"Memo";case Fu:e=t._payload,t=t._init;try{return t5(t(e))}catch{}}return null}function TO(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return t5(e);case 8:return e===NN?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function bd(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function D6(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function AO(t){var e=D6(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,a=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(i){n=""+i,a.call(this,i)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(i){n=""+i},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function v1(t){t._valueTracker||(t._valueTracker=AO(t))}function F6(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=D6(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function $y(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function r5(t,e){var r=e.checked;return es({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function tT(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=bd(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function L6(t,e){e=e.checked,e!=null&&_N(t,"checked",e,!1)}function n5(t,e){L6(t,e);var r=bd(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?s5(t,e.type,r):e.hasOwnProperty("defaultValue")&&s5(t,e.type,bd(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function rT(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function s5(t,e,r){(e!=="number"||$y(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var vp=Array.isArray;function I0(t,e,r,n){if(t=t.options,e){e={};for(var s=0;s<r.length;s++)e["$"+r[s]]=!0;for(r=0;r<t.length;r++)s=e.hasOwnProperty("$"+t[r].value),t[r].selected!==s&&(t[r].selected=s),s&&n&&(t[r].defaultSelected=!0)}else{for(r=""+bd(r),e=null,s=0;s<t.length;s++){if(t[s].value===r){t[s].selected=!0,n&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function a5(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Ft(91));return es({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function nT(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(Ft(92));if(vp(r)){if(1<r.length)throw Error(Ft(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:bd(r)}}function O6(t,e){var r=bd(e.value),n=bd(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function sT(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function M6(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function i5(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?M6(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var b1,V6=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,s){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(b1=b1||document.createElement("div"),b1.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=b1.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function dg(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var Rp={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},EO=["Webkit","ms","Moz","O"];Object.keys(Rp).forEach(function(t){EO.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Rp[e]=Rp[t]})});function B6(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||Rp.hasOwnProperty(t)&&Rp[t]?(""+e).trim():e+"px"}function U6(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=B6(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,s):t[r]=s}}var CO=es({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function o5(t,e){if(e){if(CO[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Ft(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Ft(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Ft(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Ft(62))}}function l5(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var c5=null;function AN(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var u5=null,j0=null,P0=null;function aT(t){if(t=hx(t)){if(typeof u5!="function")throw Error(Ft(280));var e=t.stateNode;e&&(e=m2(e),u5(t.stateNode,t.type,e))}}function $6(t){j0?P0?P0.push(t):P0=[t]:j0=t}function z6(){if(j0){var t=j0,e=P0;if(P0=j0=null,aT(t),e)for(t=0;t<e.length;t++)aT(e[t])}}function q6(t,e){return t(e)}function W6(){}var Lb=!1;function H6(t,e,r){if(Lb)return t(e,r);Lb=!0;try{return q6(t,e,r)}finally{Lb=!1,(j0!==null||P0!==null)&&(W6(),z6())}}function fg(t,e){var r=t.stateNode;if(r===null)return null;var n=m2(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(Ft(231,e,typeof r));return r}var d5=!1;if(Rc)try{var tp={};Object.defineProperty(tp,"passive",{get:function(){d5=!0}}),window.addEventListener("test",tp,tp),window.removeEventListener("test",tp,tp)}catch{d5=!1}function kO(t,e,r,n,s,a,i,l,c){var u=Array.prototype.slice.call(arguments,3);try{e.apply(r,u)}catch(d){this.onError(d)}}var Dp=!1,zy=null,qy=!1,f5=null,IO={onError:function(t){Dp=!0,zy=t}};function jO(t,e,r,n,s,a,i,l,c){Dp=!1,zy=null,kO.apply(IO,arguments)}function PO(t,e,r,n,s,a,i,l,c){if(jO.apply(this,arguments),Dp){if(Dp){var u=zy;Dp=!1,zy=null}else throw Error(Ft(198));qy||(qy=!0,f5=u)}}function hh(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function G6(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function iT(t){if(hh(t)!==t)throw Error(Ft(188))}function RO(t){var e=t.alternate;if(!e){if(e=hh(t),e===null)throw Error(Ft(188));return e!==t?null:t}for(var r=t,n=e;;){var s=r.return;if(s===null)break;var a=s.alternate;if(a===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===a.child){for(a=s.child;a;){if(a===r)return iT(s),t;if(a===n)return iT(s),e;a=a.sibling}throw Error(Ft(188))}if(r.return!==n.return)r=s,n=a;else{for(var i=!1,l=s.child;l;){if(l===r){i=!0,r=s,n=a;break}if(l===n){i=!0,n=s,r=a;break}l=l.sibling}if(!i){for(l=a.child;l;){if(l===r){i=!0,r=a,n=s;break}if(l===n){i=!0,n=a,r=s;break}l=l.sibling}if(!i)throw Error(Ft(189))}}if(r.alternate!==n)throw Error(Ft(190))}if(r.tag!==3)throw Error(Ft(188));return r.stateNode.current===r?t:e}function K6(t){return t=RO(t),t!==null?Y6(t):null}function Y6(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Y6(t);if(e!==null)return e;t=t.sibling}return null}var X6=eo.unstable_scheduleCallback,oT=eo.unstable_cancelCallback,DO=eo.unstable_shouldYield,FO=eo.unstable_requestPaint,gs=eo.unstable_now,LO=eo.unstable_getCurrentPriorityLevel,EN=eo.unstable_ImmediatePriority,Q6=eo.unstable_UserBlockingPriority,Wy=eo.unstable_NormalPriority,OO=eo.unstable_LowPriority,J6=eo.unstable_IdlePriority,u2=null,Ll=null;function MO(t){if(Ll&&typeof Ll.onCommitFiberRoot=="function")try{Ll.onCommitFiberRoot(u2,t,void 0,(t.current.flags&128)===128)}catch{}}var rl=Math.clz32?Math.clz32:UO,VO=Math.log,BO=Math.LN2;function UO(t){return t>>>=0,t===0?32:31-(VO(t)/BO|0)|0}var w1=64,_1=4194304;function bp(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Hy(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,s=t.suspendedLanes,a=t.pingedLanes,i=r&268435455;if(i!==0){var l=i&~s;l!==0?n=bp(l):(a&=i,a!==0&&(n=bp(a)))}else i=r&~s,i!==0?n=bp(i):a!==0&&(n=bp(a));if(n===0)return 0;if(e!==0&&e!==n&&!(e&s)&&(s=n&-n,a=e&-e,s>=a||s===16&&(a&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-rl(e),s=1<<r,n|=t[r],e&=~s;return n}function $O(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function zO(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,s=t.expirationTimes,a=t.pendingLanes;0<a;){var i=31-rl(a),l=1<<i,c=s[i];c===-1?(!(l&r)||l&n)&&(s[i]=$O(l,e)):c<=e&&(t.expiredLanes|=l),a&=~l}}function h5(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Z6(){var t=w1;return w1<<=1,!(w1&4194240)&&(w1=64),t}function Ob(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function dx(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-rl(e),t[e]=r}function qO(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var s=31-rl(r),a=1<<s;e[s]=0,n[s]=-1,t[s]=-1,r&=~a}}function CN(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-rl(r),s=1<<n;s&e|t[n]&e&&(t[n]|=e),r&=~s}}var vn=0;function eI(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var tI,kN,rI,nI,sI,m5=!1,N1=[],nd=null,sd=null,ad=null,hg=new Map,mg=new Map,Mu=[],WO="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function lT(t,e){switch(t){case"focusin":case"focusout":nd=null;break;case"dragenter":case"dragleave":sd=null;break;case"mouseover":case"mouseout":ad=null;break;case"pointerover":case"pointerout":hg.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":mg.delete(e.pointerId)}}function rp(t,e,r,n,s,a){return t===null||t.nativeEvent!==a?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:a,targetContainers:[s]},e!==null&&(e=hx(e),e!==null&&kN(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function HO(t,e,r,n,s){switch(e){case"focusin":return nd=rp(nd,t,e,r,n,s),!0;case"dragenter":return sd=rp(sd,t,e,r,n,s),!0;case"mouseover":return ad=rp(ad,t,e,r,n,s),!0;case"pointerover":var a=s.pointerId;return hg.set(a,rp(hg.get(a)||null,t,e,r,n,s)),!0;case"gotpointercapture":return a=s.pointerId,mg.set(a,rp(mg.get(a)||null,t,e,r,n,s)),!0}return!1}function aI(t){var e=Ef(t.target);if(e!==null){var r=hh(e);if(r!==null){if(e=r.tag,e===13){if(e=G6(r),e!==null){t.blockedOn=e,sI(t.priority,function(){rI(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function uy(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=p5(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);c5=n,r.target.dispatchEvent(n),c5=null}else return e=hx(r),e!==null&&kN(e),t.blockedOn=r,!1;e.shift()}return!0}function cT(t,e,r){uy(t)&&r.delete(e)}function GO(){m5=!1,nd!==null&&uy(nd)&&(nd=null),sd!==null&&uy(sd)&&(sd=null),ad!==null&&uy(ad)&&(ad=null),hg.forEach(cT),mg.forEach(cT)}function np(t,e){t.blockedOn===e&&(t.blockedOn=null,m5||(m5=!0,eo.unstable_scheduleCallback(eo.unstable_NormalPriority,GO)))}function pg(t){function e(s){return np(s,t)}if(0<N1.length){np(N1[0],t);for(var r=1;r<N1.length;r++){var n=N1[r];n.blockedOn===t&&(n.blockedOn=null)}}for(nd!==null&&np(nd,t),sd!==null&&np(sd,t),ad!==null&&np(ad,t),hg.forEach(e),mg.forEach(e),r=0;r<Mu.length;r++)n=Mu[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<Mu.length&&(r=Mu[0],r.blockedOn===null);)aI(r),r.blockedOn===null&&Mu.shift()}var R0=Hc.ReactCurrentBatchConfig,Gy=!0;function KO(t,e,r,n){var s=vn,a=R0.transition;R0.transition=null;try{vn=1,IN(t,e,r,n)}finally{vn=s,R0.transition=a}}function YO(t,e,r,n){var s=vn,a=R0.transition;R0.transition=null;try{vn=4,IN(t,e,r,n)}finally{vn=s,R0.transition=a}}function IN(t,e,r,n){if(Gy){var s=p5(t,e,r,n);if(s===null)Gb(t,e,n,Ky,r),lT(t,n);else if(HO(s,t,e,r,n))n.stopPropagation();else if(lT(t,n),e&4&&-1<WO.indexOf(t)){for(;s!==null;){var a=hx(s);if(a!==null&&tI(a),a=p5(t,e,r,n),a===null&&Gb(t,e,n,Ky,r),a===s)break;s=a}s!==null&&n.stopPropagation()}else Gb(t,e,n,null,r)}}var Ky=null;function p5(t,e,r,n){if(Ky=null,t=AN(n),t=Ef(t),t!==null)if(e=hh(t),e===null)t=null;else if(r=e.tag,r===13){if(t=G6(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Ky=t,null}function iI(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(LO()){case EN:return 1;case Q6:return 4;case Wy:case OO:return 16;case J6:return 536870912;default:return 16}default:return 16}}var Yu=null,jN=null,dy=null;function oI(){if(dy)return dy;var t,e=jN,r=e.length,n,s="value"in Yu?Yu.value:Yu.textContent,a=s.length;for(t=0;t<r&&e[t]===s[t];t++);var i=r-t;for(n=1;n<=i&&e[r-n]===s[a-n];n++);return dy=s.slice(t,1<n?1-n:void 0)}function fy(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function S1(){return!0}function uT(){return!1}function so(t){function e(r,n,s,a,i){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=a,this.target=i,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(r=t[l],this[l]=r?r(a):a[l]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?S1:uT,this.isPropagationStopped=uT,this}return es(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=S1)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=S1)},persist:function(){},isPersistent:S1}),e}var _m={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},PN=so(_m),fx=es({},_m,{view:0,detail:0}),XO=so(fx),Mb,Vb,sp,d2=es({},fx,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:RN,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==sp&&(sp&&t.type==="mousemove"?(Mb=t.screenX-sp.screenX,Vb=t.screenY-sp.screenY):Vb=Mb=0,sp=t),Mb)},movementY:function(t){return"movementY"in t?t.movementY:Vb}}),dT=so(d2),QO=es({},d2,{dataTransfer:0}),JO=so(QO),ZO=es({},fx,{relatedTarget:0}),Bb=so(ZO),e9=es({},_m,{animationName:0,elapsedTime:0,pseudoElement:0}),t9=so(e9),r9=es({},_m,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),n9=so(r9),s9=es({},_m,{data:0}),fT=so(s9),a9={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},i9={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},o9={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function l9(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=o9[t])?!!e[t]:!1}function RN(){return l9}var c9=es({},fx,{key:function(t){if(t.key){var e=a9[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=fy(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?i9[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:RN,charCode:function(t){return t.type==="keypress"?fy(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?fy(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),u9=so(c9),d9=es({},d2,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),hT=so(d9),f9=es({},fx,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:RN}),h9=so(f9),m9=es({},_m,{propertyName:0,elapsedTime:0,pseudoElement:0}),p9=so(m9),g9=es({},d2,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),x9=so(g9),y9=[9,13,27,32],DN=Rc&&"CompositionEvent"in window,Fp=null;Rc&&"documentMode"in document&&(Fp=document.documentMode);var v9=Rc&&"TextEvent"in window&&!Fp,lI=Rc&&(!DN||Fp&&8<Fp&&11>=Fp),mT=" ",pT=!1;function cI(t,e){switch(t){case"keyup":return y9.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function uI(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var x0=!1;function b9(t,e){switch(t){case"compositionend":return uI(e);case"keypress":return e.which!==32?null:(pT=!0,mT);case"textInput":return t=e.data,t===mT&&pT?null:t;default:return null}}function w9(t,e){if(x0)return t==="compositionend"||!DN&&cI(t,e)?(t=oI(),dy=jN=Yu=null,x0=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return lI&&e.locale!=="ko"?null:e.data;default:return null}}var _9={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function gT(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!_9[t.type]:e==="textarea"}function dI(t,e,r,n){$6(n),e=Yy(e,"onChange"),0<e.length&&(r=new PN("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var Lp=null,gg=null;function N9(t){_I(t,0)}function f2(t){var e=b0(t);if(F6(e))return t}function S9(t,e){if(t==="change")return e}var fI=!1;if(Rc){var Ub;if(Rc){var $b="oninput"in document;if(!$b){var xT=document.createElement("div");xT.setAttribute("oninput","return;"),$b=typeof xT.oninput=="function"}Ub=$b}else Ub=!1;fI=Ub&&(!document.documentMode||9<document.documentMode)}function yT(){Lp&&(Lp.detachEvent("onpropertychange",hI),gg=Lp=null)}function hI(t){if(t.propertyName==="value"&&f2(gg)){var e=[];dI(e,gg,t,AN(t)),H6(N9,e)}}function T9(t,e,r){t==="focusin"?(yT(),Lp=e,gg=r,Lp.attachEvent("onpropertychange",hI)):t==="focusout"&&yT()}function A9(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return f2(gg)}function E9(t,e){if(t==="click")return f2(e)}function C9(t,e){if(t==="input"||t==="change")return f2(e)}function k9(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var il=typeof Object.is=="function"?Object.is:k9;function xg(t,e){if(il(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!Qw.call(e,s)||!il(t[s],e[s]))return!1}return!0}function vT(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function bT(t,e){var r=vT(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=vT(r)}}function mI(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?mI(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function pI(){for(var t=window,e=$y();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=$y(t.document)}return e}function FN(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function I9(t){var e=pI(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&mI(r.ownerDocument.documentElement,r)){if(n!==null&&FN(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=r.textContent.length,a=Math.min(n.start,s);n=n.end===void 0?a:Math.min(n.end,s),!t.extend&&a>n&&(s=n,n=a,a=s),s=bT(r,a);var i=bT(r,n);s&&i&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==i.node||t.focusOffset!==i.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),a>n?(t.addRange(e),t.extend(i.node,i.offset)):(e.setEnd(i.node,i.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var j9=Rc&&"documentMode"in document&&11>=document.documentMode,y0=null,g5=null,Op=null,x5=!1;function wT(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;x5||y0==null||y0!==$y(n)||(n=y0,"selectionStart"in n&&FN(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Op&&xg(Op,n)||(Op=n,n=Yy(g5,"onSelect"),0<n.length&&(e=new PN("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=y0)))}function T1(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var v0={animationend:T1("Animation","AnimationEnd"),animationiteration:T1("Animation","AnimationIteration"),animationstart:T1("Animation","AnimationStart"),transitionend:T1("Transition","TransitionEnd")},zb={},gI={};Rc&&(gI=document.createElement("div").style,"AnimationEvent"in window||(delete v0.animationend.animation,delete v0.animationiteration.animation,delete v0.animationstart.animation),"TransitionEvent"in window||delete v0.transitionend.transition);function h2(t){if(zb[t])return zb[t];if(!v0[t])return t;var e=v0[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in gI)return zb[t]=e[r];return t}var xI=h2("animationend"),yI=h2("animationiteration"),vI=h2("animationstart"),bI=h2("transitionend"),wI=new Map,_T="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Od(t,e){wI.set(t,e),fh(e,[t])}for(var qb=0;qb<_T.length;qb++){var Wb=_T[qb],P9=Wb.toLowerCase(),R9=Wb[0].toUpperCase()+Wb.slice(1);Od(P9,"on"+R9)}Od(xI,"onAnimationEnd");Od(yI,"onAnimationIteration");Od(vI,"onAnimationStart");Od("dblclick","onDoubleClick");Od("focusin","onFocus");Od("focusout","onBlur");Od(bI,"onTransitionEnd");Y0("onMouseEnter",["mouseout","mouseover"]);Y0("onMouseLeave",["mouseout","mouseover"]);Y0("onPointerEnter",["pointerout","pointerover"]);Y0("onPointerLeave",["pointerout","pointerover"]);fh("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));fh("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));fh("onBeforeInput",["compositionend","keypress","textInput","paste"]);fh("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));fh("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));fh("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var wp="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),D9=new Set("cancel close invalid load scroll toggle".split(" ").concat(wp));function NT(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,PO(n,e,void 0,t),t.currentTarget=null}function _I(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],s=n.event;n=n.listeners;e:{var a=void 0;if(e)for(var i=n.length-1;0<=i;i--){var l=n[i],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==a&&s.isPropagationStopped())break e;NT(s,l,u),a=c}else for(i=0;i<n.length;i++){if(l=n[i],c=l.instance,u=l.currentTarget,l=l.listener,c!==a&&s.isPropagationStopped())break e;NT(s,l,u),a=c}}}if(qy)throw t=f5,qy=!1,f5=null,t}function Rn(t,e){var r=e[_5];r===void 0&&(r=e[_5]=new Set);var n=t+"__bubble";r.has(n)||(NI(e,t,2,!1),r.add(n))}function Hb(t,e,r){var n=0;e&&(n|=4),NI(r,t,n,e)}var A1="_reactListening"+Math.random().toString(36).slice(2);function yg(t){if(!t[A1]){t[A1]=!0,I6.forEach(function(r){r!=="selectionchange"&&(D9.has(r)||Hb(r,!1,t),Hb(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[A1]||(e[A1]=!0,Hb("selectionchange",!1,e))}}function NI(t,e,r,n){switch(iI(e)){case 1:var s=KO;break;case 4:s=YO;break;default:s=IN}r=s.bind(null,e,r,t),s=void 0,!d5||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),n?s!==void 0?t.addEventListener(e,r,{capture:!0,passive:s}):t.addEventListener(e,r,!0):s!==void 0?t.addEventListener(e,r,{passive:s}):t.addEventListener(e,r,!1)}function Gb(t,e,r,n,s){var a=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var i=n.tag;if(i===3||i===4){var l=n.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(i===4)for(i=n.return;i!==null;){var c=i.tag;if((c===3||c===4)&&(c=i.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;i=i.return}for(;l!==null;){if(i=Ef(l),i===null)return;if(c=i.tag,c===5||c===6){n=a=i;continue e}l=l.parentNode}}n=n.return}H6(function(){var u=a,d=AN(r),f=[];e:{var m=wI.get(t);if(m!==void 0){var h=PN,g=t;switch(t){case"keypress":if(fy(r)===0)break e;case"keydown":case"keyup":h=u9;break;case"focusin":g="focus",h=Bb;break;case"focusout":g="blur",h=Bb;break;case"beforeblur":case"afterblur":h=Bb;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=dT;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=JO;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=h9;break;case xI:case yI:case vI:h=t9;break;case bI:h=p9;break;case"scroll":h=XO;break;case"wheel":h=x9;break;case"copy":case"cut":case"paste":h=n9;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=hT}var p=(e&4)!==0,v=!p&&t==="scroll",b=p?m!==null?m+"Capture":null:m;p=[];for(var w=u,N;w!==null;){N=w;var j=N.stateNode;if(N.tag===5&&j!==null&&(N=j,b!==null&&(j=fg(w,b),j!=null&&p.push(vg(w,j,N)))),v)break;w=w.return}0<p.length&&(m=new h(m,g,null,r,d),f.push({event:m,listeners:p}))}}if(!(e&7)){e:{if(m=t==="mouseover"||t==="pointerover",h=t==="mouseout"||t==="pointerout",m&&r!==c5&&(g=r.relatedTarget||r.fromElement)&&(Ef(g)||g[Dc]))break e;if((h||m)&&(m=d.window===d?d:(m=d.ownerDocument)?m.defaultView||m.parentWindow:window,h?(g=r.relatedTarget||r.toElement,h=u,g=g?Ef(g):null,g!==null&&(v=hh(g),g!==v||g.tag!==5&&g.tag!==6)&&(g=null)):(h=null,g=u),h!==g)){if(p=dT,j="onMouseLeave",b="onMouseEnter",w="mouse",(t==="pointerout"||t==="pointerover")&&(p=hT,j="onPointerLeave",b="onPointerEnter",w="pointer"),v=h==null?m:b0(h),N=g==null?m:b0(g),m=new p(j,w+"leave",h,r,d),m.target=v,m.relatedTarget=N,j=null,Ef(d)===u&&(p=new p(b,w+"enter",g,r,d),p.target=N,p.relatedTarget=v,j=p),v=j,h&&g)t:{for(p=h,b=g,w=0,N=p;N;N=Wh(N))w++;for(N=0,j=b;j;j=Wh(j))N++;for(;0<w-N;)p=Wh(p),w--;for(;0<N-w;)b=Wh(b),N--;for(;w--;){if(p===b||b!==null&&p===b.alternate)break t;p=Wh(p),b=Wh(b)}p=null}else p=null;h!==null&&ST(f,m,h,p,!1),g!==null&&v!==null&&ST(f,v,g,p,!0)}}e:{if(m=u?b0(u):window,h=m.nodeName&&m.nodeName.toLowerCase(),h==="select"||h==="input"&&m.type==="file")var F=S9;else if(gT(m))if(fI)F=C9;else{F=A9;var U=T9}else(h=m.nodeName)&&h.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(F=E9);if(F&&(F=F(t,u))){dI(f,F,r,d);break e}U&&U(t,m,u),t==="focusout"&&(U=m._wrapperState)&&U.controlled&&m.type==="number"&&s5(m,"number",m.value)}switch(U=u?b0(u):window,t){case"focusin":(gT(U)||U.contentEditable==="true")&&(y0=U,g5=u,Op=null);break;case"focusout":Op=g5=y0=null;break;case"mousedown":x5=!0;break;case"contextmenu":case"mouseup":case"dragend":x5=!1,wT(f,r,d);break;case"selectionchange":if(j9)break;case"keydown":case"keyup":wT(f,r,d)}var A;if(DN)e:{switch(t){case"compositionstart":var S="onCompositionStart";break e;case"compositionend":S="onCompositionEnd";break e;case"compositionupdate":S="onCompositionUpdate";break e}S=void 0}else x0?cI(t,r)&&(S="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(S="onCompositionStart");S&&(lI&&r.locale!=="ko"&&(x0||S!=="onCompositionStart"?S==="onCompositionEnd"&&x0&&(A=oI()):(Yu=d,jN="value"in Yu?Yu.value:Yu.textContent,x0=!0)),U=Yy(u,S),0<U.length&&(S=new fT(S,t,null,r,d),f.push({event:S,listeners:U}),A?S.data=A:(A=uI(r),A!==null&&(S.data=A)))),(A=v9?b9(t,r):w9(t,r))&&(u=Yy(u,"onBeforeInput"),0<u.length&&(d=new fT("onBeforeInput","beforeinput",null,r,d),f.push({event:d,listeners:u}),d.data=A))}_I(f,e)})}function vg(t,e,r){return{instance:t,listener:e,currentTarget:r}}function Yy(t,e){for(var r=e+"Capture",n=[];t!==null;){var s=t,a=s.stateNode;s.tag===5&&a!==null&&(s=a,a=fg(t,r),a!=null&&n.unshift(vg(t,a,s)),a=fg(t,e),a!=null&&n.push(vg(t,a,s))),t=t.return}return n}function Wh(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function ST(t,e,r,n,s){for(var a=e._reactName,i=[];r!==null&&r!==n;){var l=r,c=l.alternate,u=l.stateNode;if(c!==null&&c===n)break;l.tag===5&&u!==null&&(l=u,s?(c=fg(r,a),c!=null&&i.unshift(vg(r,c,l))):s||(c=fg(r,a),c!=null&&i.push(vg(r,c,l)))),r=r.return}i.length!==0&&t.push({event:e,listeners:i})}var F9=/\r\n?/g,L9=/\u0000|\uFFFD/g;function TT(t){return(typeof t=="string"?t:""+t).replace(F9,`
`).replace(L9,"")}function E1(t,e,r){if(e=TT(e),TT(t)!==e&&r)throw Error(Ft(425))}function Xy(){}var y5=null,v5=null;function b5(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var w5=typeof setTimeout=="function"?setTimeout:void 0,O9=typeof clearTimeout=="function"?clearTimeout:void 0,AT=typeof Promise=="function"?Promise:void 0,M9=typeof queueMicrotask=="function"?queueMicrotask:typeof AT<"u"?function(t){return AT.resolve(null).then(t).catch(V9)}:w5;function V9(t){setTimeout(function(){throw t})}function Kb(t,e){var r=e,n=0;do{var s=r.nextSibling;if(t.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){t.removeChild(s),pg(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);pg(e)}function id(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function ET(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var Nm=Math.random().toString(36).slice(2),kl="__reactFiber$"+Nm,bg="__reactProps$"+Nm,Dc="__reactContainer$"+Nm,_5="__reactEvents$"+Nm,B9="__reactListeners$"+Nm,U9="__reactHandles$"+Nm;function Ef(t){var e=t[kl];if(e)return e;for(var r=t.parentNode;r;){if(e=r[Dc]||r[kl]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=ET(t);t!==null;){if(r=t[kl])return r;t=ET(t)}return e}t=r,r=t.parentNode}return null}function hx(t){return t=t[kl]||t[Dc],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function b0(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Ft(33))}function m2(t){return t[bg]||null}var N5=[],w0=-1;function Md(t){return{current:t}}function Mn(t){0>w0||(t.current=N5[w0],N5[w0]=null,w0--)}function In(t,e){w0++,N5[w0]=t.current,t.current=e}var wd={},Ua=Md(wd),Ni=Md(!1),$f=wd;function X0(t,e){var r=t.type.contextTypes;if(!r)return wd;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var s={},a;for(a in r)s[a]=e[a];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Si(t){return t=t.childContextTypes,t!=null}function Qy(){Mn(Ni),Mn(Ua)}function CT(t,e,r){if(Ua.current!==wd)throw Error(Ft(168));In(Ua,e),In(Ni,r)}function SI(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in e))throw Error(Ft(108,TO(t)||"Unknown",s));return es({},r,n)}function Jy(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||wd,$f=Ua.current,In(Ua,t),In(Ni,Ni.current),!0}function kT(t,e,r){var n=t.stateNode;if(!n)throw Error(Ft(169));r?(t=SI(t,e,$f),n.__reactInternalMemoizedMergedChildContext=t,Mn(Ni),Mn(Ua),In(Ua,t)):Mn(Ni),In(Ni,r)}var xc=null,p2=!1,Yb=!1;function TI(t){xc===null?xc=[t]:xc.push(t)}function $9(t){p2=!0,TI(t)}function Vd(){if(!Yb&&xc!==null){Yb=!0;var t=0,e=vn;try{var r=xc;for(vn=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}xc=null,p2=!1}catch(s){throw xc!==null&&(xc=xc.slice(t+1)),X6(EN,Vd),s}finally{vn=e,Yb=!1}}return null}var _0=[],N0=0,Zy=null,ev=0,wo=[],_o=0,zf=null,yc=1,vc="";function gf(t,e){_0[N0++]=ev,_0[N0++]=Zy,Zy=t,ev=e}function AI(t,e,r){wo[_o++]=yc,wo[_o++]=vc,wo[_o++]=zf,zf=t;var n=yc;t=vc;var s=32-rl(n)-1;n&=~(1<<s),r+=1;var a=32-rl(e)+s;if(30<a){var i=s-s%5;a=(n&(1<<i)-1).toString(32),n>>=i,s-=i,yc=1<<32-rl(e)+s|r<<s|n,vc=a+t}else yc=1<<a|r<<s|n,vc=t}function LN(t){t.return!==null&&(gf(t,1),AI(t,1,0))}function ON(t){for(;t===Zy;)Zy=_0[--N0],_0[N0]=null,ev=_0[--N0],_0[N0]=null;for(;t===zf;)zf=wo[--_o],wo[_o]=null,vc=wo[--_o],wo[_o]=null,yc=wo[--_o],wo[_o]=null}var Qi=null,Hi=null,qn=!1,Xo=null;function EI(t,e){var r=No(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function IT(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Qi=t,Hi=id(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Qi=t,Hi=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=zf!==null?{id:yc,overflow:vc}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=No(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,Qi=t,Hi=null,!0):!1;default:return!1}}function S5(t){return(t.mode&1)!==0&&(t.flags&128)===0}function T5(t){if(qn){var e=Hi;if(e){var r=e;if(!IT(t,e)){if(S5(t))throw Error(Ft(418));e=id(r.nextSibling);var n=Qi;e&&IT(t,e)?EI(n,r):(t.flags=t.flags&-4097|2,qn=!1,Qi=t)}}else{if(S5(t))throw Error(Ft(418));t.flags=t.flags&-4097|2,qn=!1,Qi=t}}}function jT(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Qi=t}function C1(t){if(t!==Qi)return!1;if(!qn)return jT(t),qn=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!b5(t.type,t.memoizedProps)),e&&(e=Hi)){if(S5(t))throw CI(),Error(Ft(418));for(;e;)EI(t,e),e=id(e.nextSibling)}if(jT(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Ft(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){Hi=id(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}Hi=null}}else Hi=Qi?id(t.stateNode.nextSibling):null;return!0}function CI(){for(var t=Hi;t;)t=id(t.nextSibling)}function Q0(){Hi=Qi=null,qn=!1}function MN(t){Xo===null?Xo=[t]:Xo.push(t)}var z9=Hc.ReactCurrentBatchConfig;function ap(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Ft(309));var n=r.stateNode}if(!n)throw Error(Ft(147,t));var s=n,a=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===a?e.ref:(e=function(i){var l=s.refs;i===null?delete l[a]:l[a]=i},e._stringRef=a,e)}if(typeof t!="string")throw Error(Ft(284));if(!r._owner)throw Error(Ft(290,t))}return t}function k1(t,e){throw t=Object.prototype.toString.call(e),Error(Ft(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function PT(t){var e=t._init;return e(t._payload)}function kI(t){function e(b,w){if(t){var N=b.deletions;N===null?(b.deletions=[w],b.flags|=16):N.push(w)}}function r(b,w){if(!t)return null;for(;w!==null;)e(b,w),w=w.sibling;return null}function n(b,w){for(b=new Map;w!==null;)w.key!==null?b.set(w.key,w):b.set(w.index,w),w=w.sibling;return b}function s(b,w){return b=ud(b,w),b.index=0,b.sibling=null,b}function a(b,w,N){return b.index=N,t?(N=b.alternate,N!==null?(N=N.index,N<w?(b.flags|=2,w):N):(b.flags|=2,w)):(b.flags|=1048576,w)}function i(b){return t&&b.alternate===null&&(b.flags|=2),b}function l(b,w,N,j){return w===null||w.tag!==6?(w=rw(N,b.mode,j),w.return=b,w):(w=s(w,N),w.return=b,w)}function c(b,w,N,j){var F=N.type;return F===g0?d(b,w,N.props.children,j,N.key):w!==null&&(w.elementType===F||typeof F=="object"&&F!==null&&F.$$typeof===Fu&&PT(F)===w.type)?(j=s(w,N.props),j.ref=ap(b,w,N),j.return=b,j):(j=vy(N.type,N.key,N.props,null,b.mode,j),j.ref=ap(b,w,N),j.return=b,j)}function u(b,w,N,j){return w===null||w.tag!==4||w.stateNode.containerInfo!==N.containerInfo||w.stateNode.implementation!==N.implementation?(w=nw(N,b.mode,j),w.return=b,w):(w=s(w,N.children||[]),w.return=b,w)}function d(b,w,N,j,F){return w===null||w.tag!==7?(w=Df(N,b.mode,j,F),w.return=b,w):(w=s(w,N),w.return=b,w)}function f(b,w,N){if(typeof w=="string"&&w!==""||typeof w=="number")return w=rw(""+w,b.mode,N),w.return=b,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case y1:return N=vy(w.type,w.key,w.props,null,b.mode,N),N.ref=ap(b,null,w),N.return=b,N;case p0:return w=nw(w,b.mode,N),w.return=b,w;case Fu:var j=w._init;return f(b,j(w._payload),N)}if(vp(w)||ep(w))return w=Df(w,b.mode,N,null),w.return=b,w;k1(b,w)}return null}function m(b,w,N,j){var F=w!==null?w.key:null;if(typeof N=="string"&&N!==""||typeof N=="number")return F!==null?null:l(b,w,""+N,j);if(typeof N=="object"&&N!==null){switch(N.$$typeof){case y1:return N.key===F?c(b,w,N,j):null;case p0:return N.key===F?u(b,w,N,j):null;case Fu:return F=N._init,m(b,w,F(N._payload),j)}if(vp(N)||ep(N))return F!==null?null:d(b,w,N,j,null);k1(b,N)}return null}function h(b,w,N,j,F){if(typeof j=="string"&&j!==""||typeof j=="number")return b=b.get(N)||null,l(w,b,""+j,F);if(typeof j=="object"&&j!==null){switch(j.$$typeof){case y1:return b=b.get(j.key===null?N:j.key)||null,c(w,b,j,F);case p0:return b=b.get(j.key===null?N:j.key)||null,u(w,b,j,F);case Fu:var U=j._init;return h(b,w,N,U(j._payload),F)}if(vp(j)||ep(j))return b=b.get(N)||null,d(w,b,j,F,null);k1(w,j)}return null}function g(b,w,N,j){for(var F=null,U=null,A=w,S=w=0,k=null;A!==null&&S<N.length;S++){A.index>S?(k=A,A=null):k=A.sibling;var M=m(b,A,N[S],j);if(M===null){A===null&&(A=k);break}t&&A&&M.alternate===null&&e(b,A),w=a(M,w,S),U===null?F=M:U.sibling=M,U=M,A=k}if(S===N.length)return r(b,A),qn&&gf(b,S),F;if(A===null){for(;S<N.length;S++)A=f(b,N[S],j),A!==null&&(w=a(A,w,S),U===null?F=A:U.sibling=A,U=A);return qn&&gf(b,S),F}for(A=n(b,A);S<N.length;S++)k=h(A,b,S,N[S],j),k!==null&&(t&&k.alternate!==null&&A.delete(k.key===null?S:k.key),w=a(k,w,S),U===null?F=k:U.sibling=k,U=k);return t&&A.forEach(function(I){return e(b,I)}),qn&&gf(b,S),F}function p(b,w,N,j){var F=ep(N);if(typeof F!="function")throw Error(Ft(150));if(N=F.call(N),N==null)throw Error(Ft(151));for(var U=F=null,A=w,S=w=0,k=null,M=N.next();A!==null&&!M.done;S++,M=N.next()){A.index>S?(k=A,A=null):k=A.sibling;var I=m(b,A,M.value,j);if(I===null){A===null&&(A=k);break}t&&A&&I.alternate===null&&e(b,A),w=a(I,w,S),U===null?F=I:U.sibling=I,U=I,A=k}if(M.done)return r(b,A),qn&&gf(b,S),F;if(A===null){for(;!M.done;S++,M=N.next())M=f(b,M.value,j),M!==null&&(w=a(M,w,S),U===null?F=M:U.sibling=M,U=M);return qn&&gf(b,S),F}for(A=n(b,A);!M.done;S++,M=N.next())M=h(A,b,S,M.value,j),M!==null&&(t&&M.alternate!==null&&A.delete(M.key===null?S:M.key),w=a(M,w,S),U===null?F=M:U.sibling=M,U=M);return t&&A.forEach(function(E){return e(b,E)}),qn&&gf(b,S),F}function v(b,w,N,j){if(typeof N=="object"&&N!==null&&N.type===g0&&N.key===null&&(N=N.props.children),typeof N=="object"&&N!==null){switch(N.$$typeof){case y1:e:{for(var F=N.key,U=w;U!==null;){if(U.key===F){if(F=N.type,F===g0){if(U.tag===7){r(b,U.sibling),w=s(U,N.props.children),w.return=b,b=w;break e}}else if(U.elementType===F||typeof F=="object"&&F!==null&&F.$$typeof===Fu&&PT(F)===U.type){r(b,U.sibling),w=s(U,N.props),w.ref=ap(b,U,N),w.return=b,b=w;break e}r(b,U);break}else e(b,U);U=U.sibling}N.type===g0?(w=Df(N.props.children,b.mode,j,N.key),w.return=b,b=w):(j=vy(N.type,N.key,N.props,null,b.mode,j),j.ref=ap(b,w,N),j.return=b,b=j)}return i(b);case p0:e:{for(U=N.key;w!==null;){if(w.key===U)if(w.tag===4&&w.stateNode.containerInfo===N.containerInfo&&w.stateNode.implementation===N.implementation){r(b,w.sibling),w=s(w,N.children||[]),w.return=b,b=w;break e}else{r(b,w);break}else e(b,w);w=w.sibling}w=nw(N,b.mode,j),w.return=b,b=w}return i(b);case Fu:return U=N._init,v(b,w,U(N._payload),j)}if(vp(N))return g(b,w,N,j);if(ep(N))return p(b,w,N,j);k1(b,N)}return typeof N=="string"&&N!==""||typeof N=="number"?(N=""+N,w!==null&&w.tag===6?(r(b,w.sibling),w=s(w,N),w.return=b,b=w):(r(b,w),w=rw(N,b.mode,j),w.return=b,b=w),i(b)):r(b,w)}return v}var J0=kI(!0),II=kI(!1),tv=Md(null),rv=null,S0=null,VN=null;function BN(){VN=S0=rv=null}function UN(t){var e=tv.current;Mn(tv),t._currentValue=e}function A5(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function D0(t,e){rv=t,VN=S0=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(vi=!0),t.firstContext=null)}function ko(t){var e=t._currentValue;if(VN!==t)if(t={context:t,memoizedValue:e,next:null},S0===null){if(rv===null)throw Error(Ft(308));S0=t,rv.dependencies={lanes:0,firstContext:t}}else S0=S0.next=t;return e}var Cf=null;function $N(t){Cf===null?Cf=[t]:Cf.push(t)}function jI(t,e,r,n){var s=e.interleaved;return s===null?(r.next=r,$N(e)):(r.next=s.next,s.next=r),e.interleaved=r,Fc(t,n)}function Fc(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var Lu=!1;function zN(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function PI(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Ac(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function od(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,Zr&2){var s=n.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),n.pending=e,Fc(t,r)}return s=n.interleaved,s===null?(e.next=e,$N(n)):(e.next=s.next,s.next=e),n.interleaved=e,Fc(t,r)}function hy(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,CN(t,r)}}function RT(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,a=null;if(r=r.firstBaseUpdate,r!==null){do{var i={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};a===null?s=a=i:a=a.next=i,r=r.next}while(r!==null);a===null?s=a=e:a=a.next=e}else s=a=e;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:a,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function nv(t,e,r,n){var s=t.updateQueue;Lu=!1;var a=s.firstBaseUpdate,i=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,u=c.next;c.next=null,i===null?a=u:i.next=u,i=c;var d=t.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==i&&(l===null?d.firstBaseUpdate=u:l.next=u,d.lastBaseUpdate=c))}if(a!==null){var f=s.baseState;i=0,d=u=c=null,l=a;do{var m=l.lane,h=l.eventTime;if((n&m)===m){d!==null&&(d=d.next={eventTime:h,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var g=t,p=l;switch(m=e,h=r,p.tag){case 1:if(g=p.payload,typeof g=="function"){f=g.call(h,f,m);break e}f=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=p.payload,m=typeof g=="function"?g.call(h,f,m):g,m==null)break e;f=es({},f,m);break e;case 2:Lu=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,m=s.effects,m===null?s.effects=[l]:m.push(l))}else h={eventTime:h,lane:m,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(u=d=h,c=f):d=d.next=h,i|=m;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;m=l,l=m.next,m.next=null,s.lastBaseUpdate=m,s.shared.pending=null}}while(!0);if(d===null&&(c=f),s.baseState=c,s.firstBaseUpdate=u,s.lastBaseUpdate=d,e=s.shared.interleaved,e!==null){s=e;do i|=s.lane,s=s.next;while(s!==e)}else a===null&&(s.shared.lanes=0);Wf|=i,t.lanes=i,t.memoizedState=f}}function DT(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(Ft(191,s));s.call(n)}}}var mx={},Ol=Md(mx),wg=Md(mx),_g=Md(mx);function kf(t){if(t===mx)throw Error(Ft(174));return t}function qN(t,e){switch(In(_g,e),In(wg,t),In(Ol,mx),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:i5(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=i5(e,t)}Mn(Ol),In(Ol,e)}function Z0(){Mn(Ol),Mn(wg),Mn(_g)}function RI(t){kf(_g.current);var e=kf(Ol.current),r=i5(e,t.type);e!==r&&(In(wg,t),In(Ol,r))}function WN(t){wg.current===t&&(Mn(Ol),Mn(wg))}var Kn=Md(0);function sv(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Xb=[];function HN(){for(var t=0;t<Xb.length;t++)Xb[t]._workInProgressVersionPrimary=null;Xb.length=0}var my=Hc.ReactCurrentDispatcher,Qb=Hc.ReactCurrentBatchConfig,qf=0,Jn=null,Us=null,Zs=null,av=!1,Mp=!1,Ng=0,q9=0;function ba(){throw Error(Ft(321))}function GN(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!il(t[r],e[r]))return!1;return!0}function KN(t,e,r,n,s,a){if(qf=a,Jn=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,my.current=t===null||t.memoizedState===null?K9:Y9,t=r(n,s),Mp){a=0;do{if(Mp=!1,Ng=0,25<=a)throw Error(Ft(301));a+=1,Zs=Us=null,e.updateQueue=null,my.current=X9,t=r(n,s)}while(Mp)}if(my.current=iv,e=Us!==null&&Us.next!==null,qf=0,Zs=Us=Jn=null,av=!1,e)throw Error(Ft(300));return t}function YN(){var t=Ng!==0;return Ng=0,t}function Al(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Zs===null?Jn.memoizedState=Zs=t:Zs=Zs.next=t,Zs}function Io(){if(Us===null){var t=Jn.alternate;t=t!==null?t.memoizedState:null}else t=Us.next;var e=Zs===null?Jn.memoizedState:Zs.next;if(e!==null)Zs=e,Us=t;else{if(t===null)throw Error(Ft(310));Us=t,t={memoizedState:Us.memoizedState,baseState:Us.baseState,baseQueue:Us.baseQueue,queue:Us.queue,next:null},Zs===null?Jn.memoizedState=Zs=t:Zs=Zs.next=t}return Zs}function Sg(t,e){return typeof e=="function"?e(t):e}function Jb(t){var e=Io(),r=e.queue;if(r===null)throw Error(Ft(311));r.lastRenderedReducer=t;var n=Us,s=n.baseQueue,a=r.pending;if(a!==null){if(s!==null){var i=s.next;s.next=a.next,a.next=i}n.baseQueue=s=a,r.pending=null}if(s!==null){a=s.next,n=n.baseState;var l=i=null,c=null,u=a;do{var d=u.lane;if((qf&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:t(n,u.action);else{var f={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=f,i=n):c=c.next=f,Jn.lanes|=d,Wf|=d}u=u.next}while(u!==null&&u!==a);c===null?i=n:c.next=l,il(n,e.memoizedState)||(vi=!0),e.memoizedState=n,e.baseState=i,e.baseQueue=c,r.lastRenderedState=n}if(t=r.interleaved,t!==null){s=t;do a=s.lane,Jn.lanes|=a,Wf|=a,s=s.next;while(s!==t)}else s===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function Zb(t){var e=Io(),r=e.queue;if(r===null)throw Error(Ft(311));r.lastRenderedReducer=t;var n=r.dispatch,s=r.pending,a=e.memoizedState;if(s!==null){r.pending=null;var i=s=s.next;do a=t(a,i.action),i=i.next;while(i!==s);il(a,e.memoizedState)||(vi=!0),e.memoizedState=a,e.baseQueue===null&&(e.baseState=a),r.lastRenderedState=a}return[a,n]}function DI(){}function FI(t,e){var r=Jn,n=Io(),s=e(),a=!il(n.memoizedState,s);if(a&&(n.memoizedState=s,vi=!0),n=n.queue,XN(MI.bind(null,r,n,t),[t]),n.getSnapshot!==e||a||Zs!==null&&Zs.memoizedState.tag&1){if(r.flags|=2048,Tg(9,OI.bind(null,r,n,s,e),void 0,null),aa===null)throw Error(Ft(349));qf&30||LI(r,e,s)}return s}function LI(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=Jn.updateQueue,e===null?(e={lastEffect:null,stores:null},Jn.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function OI(t,e,r,n){e.value=r,e.getSnapshot=n,VI(e)&&BI(t)}function MI(t,e,r){return r(function(){VI(e)&&BI(t)})}function VI(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!il(t,r)}catch{return!0}}function BI(t){var e=Fc(t,1);e!==null&&nl(e,t,1,-1)}function FT(t){var e=Al();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Sg,lastRenderedState:t},e.queue=t,t=t.dispatch=G9.bind(null,Jn,t),[e.memoizedState,t]}function Tg(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=Jn.updateQueue,e===null?(e={lastEffect:null,stores:null},Jn.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function UI(){return Io().memoizedState}function py(t,e,r,n){var s=Al();Jn.flags|=t,s.memoizedState=Tg(1|e,r,void 0,n===void 0?null:n)}function g2(t,e,r,n){var s=Io();n=n===void 0?null:n;var a=void 0;if(Us!==null){var i=Us.memoizedState;if(a=i.destroy,n!==null&&GN(n,i.deps)){s.memoizedState=Tg(e,r,a,n);return}}Jn.flags|=t,s.memoizedState=Tg(1|e,r,a,n)}function LT(t,e){return py(8390656,8,t,e)}function XN(t,e){return g2(2048,8,t,e)}function $I(t,e){return g2(4,2,t,e)}function zI(t,e){return g2(4,4,t,e)}function qI(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function WI(t,e,r){return r=r!=null?r.concat([t]):null,g2(4,4,qI.bind(null,e,t),r)}function QN(){}function HI(t,e){var r=Io();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&GN(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function GI(t,e){var r=Io();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&GN(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function KI(t,e,r){return qf&21?(il(r,e)||(r=Z6(),Jn.lanes|=r,Wf|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,vi=!0),t.memoizedState=r)}function W9(t,e){var r=vn;vn=r!==0&&4>r?r:4,t(!0);var n=Qb.transition;Qb.transition={};try{t(!1),e()}finally{vn=r,Qb.transition=n}}function YI(){return Io().memoizedState}function H9(t,e,r){var n=cd(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},XI(t))QI(e,r);else if(r=jI(t,e,r,n),r!==null){var s=ei();nl(r,t,n,s),JI(r,e,n)}}function G9(t,e,r){var n=cd(t),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(XI(t))QI(e,s);else{var a=t.alternate;if(t.lanes===0&&(a===null||a.lanes===0)&&(a=e.lastRenderedReducer,a!==null))try{var i=e.lastRenderedState,l=a(i,r);if(s.hasEagerState=!0,s.eagerState=l,il(l,i)){var c=e.interleaved;c===null?(s.next=s,$N(e)):(s.next=c.next,c.next=s),e.interleaved=s;return}}catch{}finally{}r=jI(t,e,s,n),r!==null&&(s=ei(),nl(r,t,n,s),JI(r,e,n))}}function XI(t){var e=t.alternate;return t===Jn||e!==null&&e===Jn}function QI(t,e){Mp=av=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function JI(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,CN(t,r)}}var iv={readContext:ko,useCallback:ba,useContext:ba,useEffect:ba,useImperativeHandle:ba,useInsertionEffect:ba,useLayoutEffect:ba,useMemo:ba,useReducer:ba,useRef:ba,useState:ba,useDebugValue:ba,useDeferredValue:ba,useTransition:ba,useMutableSource:ba,useSyncExternalStore:ba,useId:ba,unstable_isNewReconciler:!1},K9={readContext:ko,useCallback:function(t,e){return Al().memoizedState=[t,e===void 0?null:e],t},useContext:ko,useEffect:LT,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,py(4194308,4,qI.bind(null,e,t),r)},useLayoutEffect:function(t,e){return py(4194308,4,t,e)},useInsertionEffect:function(t,e){return py(4,2,t,e)},useMemo:function(t,e){var r=Al();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=Al();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=H9.bind(null,Jn,t),[n.memoizedState,t]},useRef:function(t){var e=Al();return t={current:t},e.memoizedState=t},useState:FT,useDebugValue:QN,useDeferredValue:function(t){return Al().memoizedState=t},useTransition:function(){var t=FT(!1),e=t[0];return t=W9.bind(null,t[1]),Al().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=Jn,s=Al();if(qn){if(r===void 0)throw Error(Ft(407));r=r()}else{if(r=e(),aa===null)throw Error(Ft(349));qf&30||LI(n,e,r)}s.memoizedState=r;var a={value:r,getSnapshot:e};return s.queue=a,LT(MI.bind(null,n,a,t),[t]),n.flags|=2048,Tg(9,OI.bind(null,n,a,r,e),void 0,null),r},useId:function(){var t=Al(),e=aa.identifierPrefix;if(qn){var r=vc,n=yc;r=(n&~(1<<32-rl(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=Ng++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=q9++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},Y9={readContext:ko,useCallback:HI,useContext:ko,useEffect:XN,useImperativeHandle:WI,useInsertionEffect:$I,useLayoutEffect:zI,useMemo:GI,useReducer:Jb,useRef:UI,useState:function(){return Jb(Sg)},useDebugValue:QN,useDeferredValue:function(t){var e=Io();return KI(e,Us.memoizedState,t)},useTransition:function(){var t=Jb(Sg)[0],e=Io().memoizedState;return[t,e]},useMutableSource:DI,useSyncExternalStore:FI,useId:YI,unstable_isNewReconciler:!1},X9={readContext:ko,useCallback:HI,useContext:ko,useEffect:XN,useImperativeHandle:WI,useInsertionEffect:$I,useLayoutEffect:zI,useMemo:GI,useReducer:Zb,useRef:UI,useState:function(){return Zb(Sg)},useDebugValue:QN,useDeferredValue:function(t){var e=Io();return Us===null?e.memoizedState=t:KI(e,Us.memoizedState,t)},useTransition:function(){var t=Zb(Sg)[0],e=Io().memoizedState;return[t,e]},useMutableSource:DI,useSyncExternalStore:FI,useId:YI,unstable_isNewReconciler:!1};function Ho(t,e){if(t&&t.defaultProps){e=es({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function E5(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:es({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var x2={isMounted:function(t){return(t=t._reactInternals)?hh(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=ei(),s=cd(t),a=Ac(n,s);a.payload=e,r!=null&&(a.callback=r),e=od(t,a,s),e!==null&&(nl(e,t,s,n),hy(e,t,s))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=ei(),s=cd(t),a=Ac(n,s);a.tag=1,a.payload=e,r!=null&&(a.callback=r),e=od(t,a,s),e!==null&&(nl(e,t,s,n),hy(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=ei(),n=cd(t),s=Ac(r,n);s.tag=2,e!=null&&(s.callback=e),e=od(t,s,n),e!==null&&(nl(e,t,n,r),hy(e,t,n))}};function OT(t,e,r,n,s,a,i){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,a,i):e.prototype&&e.prototype.isPureReactComponent?!xg(r,n)||!xg(s,a):!0}function ZI(t,e,r){var n=!1,s=wd,a=e.contextType;return typeof a=="object"&&a!==null?a=ko(a):(s=Si(e)?$f:Ua.current,n=e.contextTypes,a=(n=n!=null)?X0(t,s):wd),e=new e(r,a),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=x2,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=a),e}function MT(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&x2.enqueueReplaceState(e,e.state,null)}function C5(t,e,r,n){var s=t.stateNode;s.props=r,s.state=t.memoizedState,s.refs={},zN(t);var a=e.contextType;typeof a=="object"&&a!==null?s.context=ko(a):(a=Si(e)?$f:Ua.current,s.context=X0(t,a)),s.state=t.memoizedState,a=e.getDerivedStateFromProps,typeof a=="function"&&(E5(t,e,a,r),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&x2.enqueueReplaceState(s,s.state,null),nv(t,r,s,n),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function em(t,e){try{var r="",n=e;do r+=SO(n),n=n.return;while(n);var s=r}catch(a){s=`
Error generating stack: `+a.message+`
`+a.stack}return{value:t,source:e,stack:s,digest:null}}function ew(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function k5(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var Q9=typeof WeakMap=="function"?WeakMap:Map;function ej(t,e,r){r=Ac(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){lv||(lv=!0,V5=n),k5(t,e)},r}function tj(t,e,r){r=Ac(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var s=e.value;r.payload=function(){return n(s)},r.callback=function(){k5(t,e)}}var a=t.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(r.callback=function(){k5(t,e),typeof n!="function"&&(ld===null?ld=new Set([this]):ld.add(this));var i=e.stack;this.componentDidCatch(e.value,{componentStack:i!==null?i:""})}),r}function VT(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new Q9;var s=new Set;n.set(e,s)}else s=n.get(e),s===void 0&&(s=new Set,n.set(e,s));s.has(r)||(s.add(r),t=dM.bind(null,t,e,r),e.then(t,t))}function BT(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function UT(t,e,r,n,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=Ac(-1,1),e.tag=2,od(r,e,1))),r.lanes|=1),t)}var J9=Hc.ReactCurrentOwner,vi=!1;function Ka(t,e,r,n){e.child=t===null?II(e,null,r,n):J0(e,t.child,r,n)}function $T(t,e,r,n,s){r=r.render;var a=e.ref;return D0(e,s),n=KN(t,e,r,n,a,s),r=YN(),t!==null&&!vi?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Lc(t,e,s)):(qn&&r&&LN(e),e.flags|=1,Ka(t,e,n,s),e.child)}function zT(t,e,r,n,s){if(t===null){var a=r.type;return typeof a=="function"&&!a4(a)&&a.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=a,rj(t,e,a,n,s)):(t=vy(r.type,null,n,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(a=t.child,!(t.lanes&s)){var i=a.memoizedProps;if(r=r.compare,r=r!==null?r:xg,r(i,n)&&t.ref===e.ref)return Lc(t,e,s)}return e.flags|=1,t=ud(a,n),t.ref=e.ref,t.return=e,e.child=t}function rj(t,e,r,n,s){if(t!==null){var a=t.memoizedProps;if(xg(a,n)&&t.ref===e.ref)if(vi=!1,e.pendingProps=n=a,(t.lanes&s)!==0)t.flags&131072&&(vi=!0);else return e.lanes=t.lanes,Lc(t,e,s)}return I5(t,e,r,n,s)}function nj(t,e,r){var n=e.pendingProps,s=n.children,a=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},In(A0,Vi),Vi|=r;else{if(!(r&1073741824))return t=a!==null?a.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,In(A0,Vi),Vi|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=a!==null?a.baseLanes:r,In(A0,Vi),Vi|=n}else a!==null?(n=a.baseLanes|r,e.memoizedState=null):n=r,In(A0,Vi),Vi|=n;return Ka(t,e,s,r),e.child}function sj(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function I5(t,e,r,n,s){var a=Si(r)?$f:Ua.current;return a=X0(e,a),D0(e,s),r=KN(t,e,r,n,a,s),n=YN(),t!==null&&!vi?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Lc(t,e,s)):(qn&&n&&LN(e),e.flags|=1,Ka(t,e,r,s),e.child)}function qT(t,e,r,n,s){if(Si(r)){var a=!0;Jy(e)}else a=!1;if(D0(e,s),e.stateNode===null)gy(t,e),ZI(e,r,n),C5(e,r,n,s),n=!0;else if(t===null){var i=e.stateNode,l=e.memoizedProps;i.props=l;var c=i.context,u=r.contextType;typeof u=="object"&&u!==null?u=ko(u):(u=Si(r)?$f:Ua.current,u=X0(e,u));var d=r.getDerivedStateFromProps,f=typeof d=="function"||typeof i.getSnapshotBeforeUpdate=="function";f||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(l!==n||c!==u)&&MT(e,i,n,u),Lu=!1;var m=e.memoizedState;i.state=m,nv(e,n,i,s),c=e.memoizedState,l!==n||m!==c||Ni.current||Lu?(typeof d=="function"&&(E5(e,r,d,n),c=e.memoizedState),(l=Lu||OT(e,r,l,n,m,c,u))?(f||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(e.flags|=4194308)):(typeof i.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=c),i.props=n,i.state=c,i.context=u,n=l):(typeof i.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{i=e.stateNode,PI(t,e),l=e.memoizedProps,u=e.type===e.elementType?l:Ho(e.type,l),i.props=u,f=e.pendingProps,m=i.context,c=r.contextType,typeof c=="object"&&c!==null?c=ko(c):(c=Si(r)?$f:Ua.current,c=X0(e,c));var h=r.getDerivedStateFromProps;(d=typeof h=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(l!==f||m!==c)&&MT(e,i,n,c),Lu=!1,m=e.memoizedState,i.state=m,nv(e,n,i,s);var g=e.memoizedState;l!==f||m!==g||Ni.current||Lu?(typeof h=="function"&&(E5(e,r,h,n),g=e.memoizedState),(u=Lu||OT(e,r,u,n,m,g,c)||!1)?(d||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(n,g,c),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(n,g,c)),typeof i.componentDidUpdate=="function"&&(e.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof i.componentDidUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=g),i.props=n,i.state=g,i.context=c,n=u):(typeof i.componentDidUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),n=!1)}return j5(t,e,r,n,a,s)}function j5(t,e,r,n,s,a){sj(t,e);var i=(e.flags&128)!==0;if(!n&&!i)return s&&kT(e,r,!1),Lc(t,e,a);n=e.stateNode,J9.current=e;var l=i&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&i?(e.child=J0(e,t.child,null,a),e.child=J0(e,null,l,a)):Ka(t,e,l,a),e.memoizedState=n.state,s&&kT(e,r,!0),e.child}function aj(t){var e=t.stateNode;e.pendingContext?CT(t,e.pendingContext,e.pendingContext!==e.context):e.context&&CT(t,e.context,!1),qN(t,e.containerInfo)}function WT(t,e,r,n,s){return Q0(),MN(s),e.flags|=256,Ka(t,e,r,n),e.child}var P5={dehydrated:null,treeContext:null,retryLane:0};function R5(t){return{baseLanes:t,cachePool:null,transitions:null}}function ij(t,e,r){var n=e.pendingProps,s=Kn.current,a=!1,i=(e.flags&128)!==0,l;if((l=i)||(l=t!==null&&t.memoizedState===null?!1:(s&2)!==0),l?(a=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),In(Kn,s&1),t===null)return T5(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(i=n.children,t=n.fallback,a?(n=e.mode,a=e.child,i={mode:"hidden",children:i},!(n&1)&&a!==null?(a.childLanes=0,a.pendingProps=i):a=b2(i,n,0,null),t=Df(t,n,r,null),a.return=e,t.return=e,a.sibling=t,e.child=a,e.child.memoizedState=R5(r),e.memoizedState=P5,t):JN(e,i));if(s=t.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return Z9(t,e,i,n,l,s,r);if(a){a=n.fallback,i=e.mode,s=t.child,l=s.sibling;var c={mode:"hidden",children:n.children};return!(i&1)&&e.child!==s?(n=e.child,n.childLanes=0,n.pendingProps=c,e.deletions=null):(n=ud(s,c),n.subtreeFlags=s.subtreeFlags&14680064),l!==null?a=ud(l,a):(a=Df(a,i,r,null),a.flags|=2),a.return=e,n.return=e,n.sibling=a,e.child=n,n=a,a=e.child,i=t.child.memoizedState,i=i===null?R5(r):{baseLanes:i.baseLanes|r,cachePool:null,transitions:i.transitions},a.memoizedState=i,a.childLanes=t.childLanes&~r,e.memoizedState=P5,n}return a=t.child,t=a.sibling,n=ud(a,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function JN(t,e){return e=b2({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function I1(t,e,r,n){return n!==null&&MN(n),J0(e,t.child,null,r),t=JN(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function Z9(t,e,r,n,s,a,i){if(r)return e.flags&256?(e.flags&=-257,n=ew(Error(Ft(422))),I1(t,e,i,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(a=n.fallback,s=e.mode,n=b2({mode:"visible",children:n.children},s,0,null),a=Df(a,s,i,null),a.flags|=2,n.return=e,a.return=e,n.sibling=a,e.child=n,e.mode&1&&J0(e,t.child,null,i),e.child.memoizedState=R5(i),e.memoizedState=P5,a);if(!(e.mode&1))return I1(t,e,i,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var l=n.dgst;return n=l,a=Error(Ft(419)),n=ew(a,n,void 0),I1(t,e,i,n)}if(l=(i&t.childLanes)!==0,vi||l){if(n=aa,n!==null){switch(i&-i){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|i)?0:s,s!==0&&s!==a.retryLane&&(a.retryLane=s,Fc(t,s),nl(n,t,s,-1))}return s4(),n=ew(Error(Ft(421))),I1(t,e,i,n)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=fM.bind(null,t),s._reactRetry=e,null):(t=a.treeContext,Hi=id(s.nextSibling),Qi=e,qn=!0,Xo=null,t!==null&&(wo[_o++]=yc,wo[_o++]=vc,wo[_o++]=zf,yc=t.id,vc=t.overflow,zf=e),e=JN(e,n.children),e.flags|=4096,e)}function HT(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),A5(t.return,e,r)}function tw(t,e,r,n,s){var a=t.memoizedState;a===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(a.isBackwards=e,a.rendering=null,a.renderingStartTime=0,a.last=n,a.tail=r,a.tailMode=s)}function oj(t,e,r){var n=e.pendingProps,s=n.revealOrder,a=n.tail;if(Ka(t,e,n.children,r),n=Kn.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&HT(t,r,e);else if(t.tag===19)HT(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(In(Kn,n),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(r=e.child,s=null;r!==null;)t=r.alternate,t!==null&&sv(t)===null&&(s=r),r=r.sibling;r=s,r===null?(s=e.child,e.child=null):(s=r.sibling,r.sibling=null),tw(e,!1,s,r,a);break;case"backwards":for(r=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&sv(t)===null){e.child=s;break}t=s.sibling,s.sibling=r,r=s,s=t}tw(e,!0,r,null,a);break;case"together":tw(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function gy(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Lc(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),Wf|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Ft(153));if(e.child!==null){for(t=e.child,r=ud(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=ud(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function eM(t,e,r){switch(e.tag){case 3:aj(e),Q0();break;case 5:RI(e);break;case 1:Si(e.type)&&Jy(e);break;case 4:qN(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,s=e.memoizedProps.value;In(tv,n._currentValue),n._currentValue=s;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(In(Kn,Kn.current&1),e.flags|=128,null):r&e.child.childLanes?ij(t,e,r):(In(Kn,Kn.current&1),t=Lc(t,e,r),t!==null?t.sibling:null);In(Kn,Kn.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return oj(t,e,r);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),In(Kn,Kn.current),n)break;return null;case 22:case 23:return e.lanes=0,nj(t,e,r)}return Lc(t,e,r)}var lj,D5,cj,uj;lj=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};D5=function(){};cj=function(t,e,r,n){var s=t.memoizedProps;if(s!==n){t=e.stateNode,kf(Ol.current);var a=null;switch(r){case"input":s=r5(t,s),n=r5(t,n),a=[];break;case"select":s=es({},s,{value:void 0}),n=es({},n,{value:void 0}),a=[];break;case"textarea":s=a5(t,s),n=a5(t,n),a=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=Xy)}o5(r,n);var i;r=null;for(u in s)if(!n.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var l=s[u];for(i in l)l.hasOwnProperty(i)&&(r||(r={}),r[i]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(ug.hasOwnProperty(u)?a||(a=[]):(a=a||[]).push(u,null));for(u in n){var c=n[u];if(l=s!=null?s[u]:void 0,n.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(i in l)!l.hasOwnProperty(i)||c&&c.hasOwnProperty(i)||(r||(r={}),r[i]="");for(i in c)c.hasOwnProperty(i)&&l[i]!==c[i]&&(r||(r={}),r[i]=c[i])}else r||(a||(a=[]),a.push(u,r)),r=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(a=a||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(a=a||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(ug.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&Rn("scroll",t),a||l===c||(a=[])):(a=a||[]).push(u,c))}r&&(a=a||[]).push("style",r);var u=a;(e.updateQueue=u)&&(e.flags|=4)}};uj=function(t,e,r,n){r!==n&&(e.flags|=4)};function ip(t,e){if(!qn)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function wa(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var s=t.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function tM(t,e,r){var n=e.pendingProps;switch(ON(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return wa(e),null;case 1:return Si(e.type)&&Qy(),wa(e),null;case 3:return n=e.stateNode,Z0(),Mn(Ni),Mn(Ua),HN(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(C1(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Xo!==null&&($5(Xo),Xo=null))),D5(t,e),wa(e),null;case 5:WN(e);var s=kf(_g.current);if(r=e.type,t!==null&&e.stateNode!=null)cj(t,e,r,n,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(Ft(166));return wa(e),null}if(t=kf(Ol.current),C1(e)){n=e.stateNode,r=e.type;var a=e.memoizedProps;switch(n[kl]=e,n[bg]=a,t=(e.mode&1)!==0,r){case"dialog":Rn("cancel",n),Rn("close",n);break;case"iframe":case"object":case"embed":Rn("load",n);break;case"video":case"audio":for(s=0;s<wp.length;s++)Rn(wp[s],n);break;case"source":Rn("error",n);break;case"img":case"image":case"link":Rn("error",n),Rn("load",n);break;case"details":Rn("toggle",n);break;case"input":tT(n,a),Rn("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!a.multiple},Rn("invalid",n);break;case"textarea":nT(n,a),Rn("invalid",n)}o5(r,a),s=null;for(var i in a)if(a.hasOwnProperty(i)){var l=a[i];i==="children"?typeof l=="string"?n.textContent!==l&&(a.suppressHydrationWarning!==!0&&E1(n.textContent,l,t),s=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(a.suppressHydrationWarning!==!0&&E1(n.textContent,l,t),s=["children",""+l]):ug.hasOwnProperty(i)&&l!=null&&i==="onScroll"&&Rn("scroll",n)}switch(r){case"input":v1(n),rT(n,a,!0);break;case"textarea":v1(n),sT(n);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(n.onclick=Xy)}n=s,e.updateQueue=n,n!==null&&(e.flags|=4)}else{i=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=M6(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=i.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=i.createElement(r,{is:n.is}):(t=i.createElement(r),r==="select"&&(i=t,n.multiple?i.multiple=!0:n.size&&(i.size=n.size))):t=i.createElementNS(t,r),t[kl]=e,t[bg]=n,lj(t,e,!1,!1),e.stateNode=t;e:{switch(i=l5(r,n),r){case"dialog":Rn("cancel",t),Rn("close",t),s=n;break;case"iframe":case"object":case"embed":Rn("load",t),s=n;break;case"video":case"audio":for(s=0;s<wp.length;s++)Rn(wp[s],t);s=n;break;case"source":Rn("error",t),s=n;break;case"img":case"image":case"link":Rn("error",t),Rn("load",t),s=n;break;case"details":Rn("toggle",t),s=n;break;case"input":tT(t,n),s=r5(t,n),Rn("invalid",t);break;case"option":s=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},s=es({},n,{value:void 0}),Rn("invalid",t);break;case"textarea":nT(t,n),s=a5(t,n),Rn("invalid",t);break;default:s=n}o5(r,s),l=s;for(a in l)if(l.hasOwnProperty(a)){var c=l[a];a==="style"?U6(t,c):a==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&V6(t,c)):a==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&dg(t,c):typeof c=="number"&&dg(t,""+c):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(ug.hasOwnProperty(a)?c!=null&&a==="onScroll"&&Rn("scroll",t):c!=null&&_N(t,a,c,i))}switch(r){case"input":v1(t),rT(t,n,!1);break;case"textarea":v1(t),sT(t);break;case"option":n.value!=null&&t.setAttribute("value",""+bd(n.value));break;case"select":t.multiple=!!n.multiple,a=n.value,a!=null?I0(t,!!n.multiple,a,!1):n.defaultValue!=null&&I0(t,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=Xy)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return wa(e),null;case 6:if(t&&e.stateNode!=null)uj(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(Ft(166));if(r=kf(_g.current),kf(Ol.current),C1(e)){if(n=e.stateNode,r=e.memoizedProps,n[kl]=e,(a=n.nodeValue!==r)&&(t=Qi,t!==null))switch(t.tag){case 3:E1(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&E1(n.nodeValue,r,(t.mode&1)!==0)}a&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[kl]=e,e.stateNode=n}return wa(e),null;case 13:if(Mn(Kn),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(qn&&Hi!==null&&e.mode&1&&!(e.flags&128))CI(),Q0(),e.flags|=98560,a=!1;else if(a=C1(e),n!==null&&n.dehydrated!==null){if(t===null){if(!a)throw Error(Ft(318));if(a=e.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(Ft(317));a[kl]=e}else Q0(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;wa(e),a=!1}else Xo!==null&&($5(Xo),Xo=null),a=!0;if(!a)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||Kn.current&1?zs===0&&(zs=3):s4())),e.updateQueue!==null&&(e.flags|=4),wa(e),null);case 4:return Z0(),D5(t,e),t===null&&yg(e.stateNode.containerInfo),wa(e),null;case 10:return UN(e.type._context),wa(e),null;case 17:return Si(e.type)&&Qy(),wa(e),null;case 19:if(Mn(Kn),a=e.memoizedState,a===null)return wa(e),null;if(n=(e.flags&128)!==0,i=a.rendering,i===null)if(n)ip(a,!1);else{if(zs!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(i=sv(t),i!==null){for(e.flags|=128,ip(a,!1),n=i.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)a=r,t=n,a.flags&=14680066,i=a.alternate,i===null?(a.childLanes=0,a.lanes=t,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=i.childLanes,a.lanes=i.lanes,a.child=i.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=i.memoizedProps,a.memoizedState=i.memoizedState,a.updateQueue=i.updateQueue,a.type=i.type,t=i.dependencies,a.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return In(Kn,Kn.current&1|2),e.child}t=t.sibling}a.tail!==null&&gs()>tm&&(e.flags|=128,n=!0,ip(a,!1),e.lanes=4194304)}else{if(!n)if(t=sv(i),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),ip(a,!0),a.tail===null&&a.tailMode==="hidden"&&!i.alternate&&!qn)return wa(e),null}else 2*gs()-a.renderingStartTime>tm&&r!==1073741824&&(e.flags|=128,n=!0,ip(a,!1),e.lanes=4194304);a.isBackwards?(i.sibling=e.child,e.child=i):(r=a.last,r!==null?r.sibling=i:e.child=i,a.last=i)}return a.tail!==null?(e=a.tail,a.rendering=e,a.tail=e.sibling,a.renderingStartTime=gs(),e.sibling=null,r=Kn.current,In(Kn,n?r&1|2:r&1),e):(wa(e),null);case 22:case 23:return n4(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?Vi&1073741824&&(wa(e),e.subtreeFlags&6&&(e.flags|=8192)):wa(e),null;case 24:return null;case 25:return null}throw Error(Ft(156,e.tag))}function rM(t,e){switch(ON(e),e.tag){case 1:return Si(e.type)&&Qy(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Z0(),Mn(Ni),Mn(Ua),HN(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return WN(e),null;case 13:if(Mn(Kn),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Ft(340));Q0()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Mn(Kn),null;case 4:return Z0(),null;case 10:return UN(e.type._context),null;case 22:case 23:return n4(),null;case 24:return null;default:return null}}var j1=!1,Pa=!1,nM=typeof WeakSet=="function"?WeakSet:Set,Jt=null;function T0(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){is(t,e,n)}else r.current=null}function F5(t,e,r){try{r()}catch(n){is(t,e,n)}}var GT=!1;function sM(t,e){if(y5=Gy,t=pI(),FN(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,a=n.focusNode;n=n.focusOffset;try{r.nodeType,a.nodeType}catch{r=null;break e}var i=0,l=-1,c=-1,u=0,d=0,f=t,m=null;t:for(;;){for(var h;f!==r||s!==0&&f.nodeType!==3||(l=i+s),f!==a||n!==0&&f.nodeType!==3||(c=i+n),f.nodeType===3&&(i+=f.nodeValue.length),(h=f.firstChild)!==null;)m=f,f=h;for(;;){if(f===t)break t;if(m===r&&++u===s&&(l=i),m===a&&++d===n&&(c=i),(h=f.nextSibling)!==null)break;f=m,m=f.parentNode}f=h}r=l===-1||c===-1?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(v5={focusedElem:t,selectionRange:r},Gy=!1,Jt=e;Jt!==null;)if(e=Jt,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Jt=t;else for(;Jt!==null;){e=Jt;try{var g=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var p=g.memoizedProps,v=g.memoizedState,b=e.stateNode,w=b.getSnapshotBeforeUpdate(e.elementType===e.type?p:Ho(e.type,p),v);b.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var N=e.stateNode.containerInfo;N.nodeType===1?N.textContent="":N.nodeType===9&&N.documentElement&&N.removeChild(N.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Ft(163))}}catch(j){is(e,e.return,j)}if(t=e.sibling,t!==null){t.return=e.return,Jt=t;break}Jt=e.return}return g=GT,GT=!1,g}function Vp(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&t)===t){var a=s.destroy;s.destroy=void 0,a!==void 0&&F5(e,r,a)}s=s.next}while(s!==n)}}function y2(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function L5(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function dj(t){var e=t.alternate;e!==null&&(t.alternate=null,dj(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[kl],delete e[bg],delete e[_5],delete e[B9],delete e[U9])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function fj(t){return t.tag===5||t.tag===3||t.tag===4}function KT(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||fj(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function O5(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=Xy));else if(n!==4&&(t=t.child,t!==null))for(O5(t,e,r),t=t.sibling;t!==null;)O5(t,e,r),t=t.sibling}function M5(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(M5(t,e,r),t=t.sibling;t!==null;)M5(t,e,r),t=t.sibling}var da=null,Ko=!1;function Eu(t,e,r){for(r=r.child;r!==null;)hj(t,e,r),r=r.sibling}function hj(t,e,r){if(Ll&&typeof Ll.onCommitFiberUnmount=="function")try{Ll.onCommitFiberUnmount(u2,r)}catch{}switch(r.tag){case 5:Pa||T0(r,e);case 6:var n=da,s=Ko;da=null,Eu(t,e,r),da=n,Ko=s,da!==null&&(Ko?(t=da,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):da.removeChild(r.stateNode));break;case 18:da!==null&&(Ko?(t=da,r=r.stateNode,t.nodeType===8?Kb(t.parentNode,r):t.nodeType===1&&Kb(t,r),pg(t)):Kb(da,r.stateNode));break;case 4:n=da,s=Ko,da=r.stateNode.containerInfo,Ko=!0,Eu(t,e,r),da=n,Ko=s;break;case 0:case 11:case 14:case 15:if(!Pa&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var a=s,i=a.destroy;a=a.tag,i!==void 0&&(a&2||a&4)&&F5(r,e,i),s=s.next}while(s!==n)}Eu(t,e,r);break;case 1:if(!Pa&&(T0(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){is(r,e,l)}Eu(t,e,r);break;case 21:Eu(t,e,r);break;case 22:r.mode&1?(Pa=(n=Pa)||r.memoizedState!==null,Eu(t,e,r),Pa=n):Eu(t,e,r);break;default:Eu(t,e,r)}}function YT(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new nM),e.forEach(function(n){var s=hM.bind(null,t,n);r.has(n)||(r.add(n),n.then(s,s))})}}function $o(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var a=t,i=e,l=i;e:for(;l!==null;){switch(l.tag){case 5:da=l.stateNode,Ko=!1;break e;case 3:da=l.stateNode.containerInfo,Ko=!0;break e;case 4:da=l.stateNode.containerInfo,Ko=!0;break e}l=l.return}if(da===null)throw Error(Ft(160));hj(a,i,s),da=null,Ko=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(u){is(s,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)mj(e,t),e=e.sibling}function mj(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if($o(e,t),bl(t),n&4){try{Vp(3,t,t.return),y2(3,t)}catch(p){is(t,t.return,p)}try{Vp(5,t,t.return)}catch(p){is(t,t.return,p)}}break;case 1:$o(e,t),bl(t),n&512&&r!==null&&T0(r,r.return);break;case 5:if($o(e,t),bl(t),n&512&&r!==null&&T0(r,r.return),t.flags&32){var s=t.stateNode;try{dg(s,"")}catch(p){is(t,t.return,p)}}if(n&4&&(s=t.stateNode,s!=null)){var a=t.memoizedProps,i=r!==null?r.memoizedProps:a,l=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{l==="input"&&a.type==="radio"&&a.name!=null&&L6(s,a),l5(l,i);var u=l5(l,a);for(i=0;i<c.length;i+=2){var d=c[i],f=c[i+1];d==="style"?U6(s,f):d==="dangerouslySetInnerHTML"?V6(s,f):d==="children"?dg(s,f):_N(s,d,f,u)}switch(l){case"input":n5(s,a);break;case"textarea":O6(s,a);break;case"select":var m=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!a.multiple;var h=a.value;h!=null?I0(s,!!a.multiple,h,!1):m!==!!a.multiple&&(a.defaultValue!=null?I0(s,!!a.multiple,a.defaultValue,!0):I0(s,!!a.multiple,a.multiple?[]:"",!1))}s[bg]=a}catch(p){is(t,t.return,p)}}break;case 6:if($o(e,t),bl(t),n&4){if(t.stateNode===null)throw Error(Ft(162));s=t.stateNode,a=t.memoizedProps;try{s.nodeValue=a}catch(p){is(t,t.return,p)}}break;case 3:if($o(e,t),bl(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{pg(e.containerInfo)}catch(p){is(t,t.return,p)}break;case 4:$o(e,t),bl(t);break;case 13:$o(e,t),bl(t),s=t.child,s.flags&8192&&(a=s.memoizedState!==null,s.stateNode.isHidden=a,!a||s.alternate!==null&&s.alternate.memoizedState!==null||(t4=gs())),n&4&&YT(t);break;case 22:if(d=r!==null&&r.memoizedState!==null,t.mode&1?(Pa=(u=Pa)||d,$o(e,t),Pa=u):$o(e,t),bl(t),n&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!d&&t.mode&1)for(Jt=t,d=t.child;d!==null;){for(f=Jt=d;Jt!==null;){switch(m=Jt,h=m.child,m.tag){case 0:case 11:case 14:case 15:Vp(4,m,m.return);break;case 1:T0(m,m.return);var g=m.stateNode;if(typeof g.componentWillUnmount=="function"){n=m,r=m.return;try{e=n,g.props=e.memoizedProps,g.state=e.memoizedState,g.componentWillUnmount()}catch(p){is(n,r,p)}}break;case 5:T0(m,m.return);break;case 22:if(m.memoizedState!==null){QT(f);continue}}h!==null?(h.return=m,Jt=h):QT(f)}d=d.sibling}e:for(d=null,f=t;;){if(f.tag===5){if(d===null){d=f;try{s=f.stateNode,u?(a=s.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(l=f.stateNode,c=f.memoizedProps.style,i=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=B6("display",i))}catch(p){is(t,t.return,p)}}}else if(f.tag===6){if(d===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(p){is(t,t.return,p)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===t)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===t)break e;for(;f.sibling===null;){if(f.return===null||f.return===t)break e;d===f&&(d=null),f=f.return}d===f&&(d=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:$o(e,t),bl(t),n&4&&YT(t);break;case 21:break;default:$o(e,t),bl(t)}}function bl(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(fj(r)){var n=r;break e}r=r.return}throw Error(Ft(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(dg(s,""),n.flags&=-33);var a=KT(t);M5(t,a,s);break;case 3:case 4:var i=n.stateNode.containerInfo,l=KT(t);O5(t,l,i);break;default:throw Error(Ft(161))}}catch(c){is(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function aM(t,e,r){Jt=t,pj(t)}function pj(t,e,r){for(var n=(t.mode&1)!==0;Jt!==null;){var s=Jt,a=s.child;if(s.tag===22&&n){var i=s.memoizedState!==null||j1;if(!i){var l=s.alternate,c=l!==null&&l.memoizedState!==null||Pa;l=j1;var u=Pa;if(j1=i,(Pa=c)&&!u)for(Jt=s;Jt!==null;)i=Jt,c=i.child,i.tag===22&&i.memoizedState!==null?JT(s):c!==null?(c.return=i,Jt=c):JT(s);for(;a!==null;)Jt=a,pj(a),a=a.sibling;Jt=s,j1=l,Pa=u}XT(t)}else s.subtreeFlags&8772&&a!==null?(a.return=s,Jt=a):XT(t)}}function XT(t){for(;Jt!==null;){var e=Jt;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Pa||y2(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!Pa)if(r===null)n.componentDidMount();else{var s=e.elementType===e.type?r.memoizedProps:Ho(e.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var a=e.updateQueue;a!==null&&DT(e,a,n);break;case 3:var i=e.updateQueue;if(i!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}DT(e,i,r)}break;case 5:var l=e.stateNode;if(r===null&&e.flags&4){r=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var f=d.dehydrated;f!==null&&pg(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Ft(163))}Pa||e.flags&512&&L5(e)}catch(m){is(e,e.return,m)}}if(e===t){Jt=null;break}if(r=e.sibling,r!==null){r.return=e.return,Jt=r;break}Jt=e.return}}function QT(t){for(;Jt!==null;){var e=Jt;if(e===t){Jt=null;break}var r=e.sibling;if(r!==null){r.return=e.return,Jt=r;break}Jt=e.return}}function JT(t){for(;Jt!==null;){var e=Jt;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{y2(4,e)}catch(c){is(e,r,c)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var s=e.return;try{n.componentDidMount()}catch(c){is(e,s,c)}}var a=e.return;try{L5(e)}catch(c){is(e,a,c)}break;case 5:var i=e.return;try{L5(e)}catch(c){is(e,i,c)}}}catch(c){is(e,e.return,c)}if(e===t){Jt=null;break}var l=e.sibling;if(l!==null){l.return=e.return,Jt=l;break}Jt=e.return}}var iM=Math.ceil,ov=Hc.ReactCurrentDispatcher,ZN=Hc.ReactCurrentOwner,Ao=Hc.ReactCurrentBatchConfig,Zr=0,aa=null,Os=null,pa=0,Vi=0,A0=Md(0),zs=0,Ag=null,Wf=0,v2=0,e4=0,Bp=null,yi=null,t4=0,tm=1/0,gc=null,lv=!1,V5=null,ld=null,P1=!1,Xu=null,cv=0,Up=0,B5=null,xy=-1,yy=0;function ei(){return Zr&6?gs():xy!==-1?xy:xy=gs()}function cd(t){return t.mode&1?Zr&2&&pa!==0?pa&-pa:z9.transition!==null?(yy===0&&(yy=Z6()),yy):(t=vn,t!==0||(t=window.event,t=t===void 0?16:iI(t.type)),t):1}function nl(t,e,r,n){if(50<Up)throw Up=0,B5=null,Error(Ft(185));dx(t,r,n),(!(Zr&2)||t!==aa)&&(t===aa&&(!(Zr&2)&&(v2|=r),zs===4&&Vu(t,pa)),Ti(t,n),r===1&&Zr===0&&!(e.mode&1)&&(tm=gs()+500,p2&&Vd()))}function Ti(t,e){var r=t.callbackNode;zO(t,e);var n=Hy(t,t===aa?pa:0);if(n===0)r!==null&&oT(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&oT(r),e===1)t.tag===0?$9(ZT.bind(null,t)):TI(ZT.bind(null,t)),M9(function(){!(Zr&6)&&Vd()}),r=null;else{switch(eI(n)){case 1:r=EN;break;case 4:r=Q6;break;case 16:r=Wy;break;case 536870912:r=J6;break;default:r=Wy}r=Nj(r,gj.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function gj(t,e){if(xy=-1,yy=0,Zr&6)throw Error(Ft(327));var r=t.callbackNode;if(F0()&&t.callbackNode!==r)return null;var n=Hy(t,t===aa?pa:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=uv(t,n);else{e=n;var s=Zr;Zr|=2;var a=yj();(aa!==t||pa!==e)&&(gc=null,tm=gs()+500,Rf(t,e));do try{cM();break}catch(l){xj(t,l)}while(!0);BN(),ov.current=a,Zr=s,Os!==null?e=0:(aa=null,pa=0,e=zs)}if(e!==0){if(e===2&&(s=h5(t),s!==0&&(n=s,e=U5(t,s))),e===1)throw r=Ag,Rf(t,0),Vu(t,n),Ti(t,gs()),r;if(e===6)Vu(t,n);else{if(s=t.current.alternate,!(n&30)&&!oM(s)&&(e=uv(t,n),e===2&&(a=h5(t),a!==0&&(n=a,e=U5(t,a))),e===1))throw r=Ag,Rf(t,0),Vu(t,n),Ti(t,gs()),r;switch(t.finishedWork=s,t.finishedLanes=n,e){case 0:case 1:throw Error(Ft(345));case 2:xf(t,yi,gc);break;case 3:if(Vu(t,n),(n&130023424)===n&&(e=t4+500-gs(),10<e)){if(Hy(t,0)!==0)break;if(s=t.suspendedLanes,(s&n)!==n){ei(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=w5(xf.bind(null,t,yi,gc),e);break}xf(t,yi,gc);break;case 4:if(Vu(t,n),(n&4194240)===n)break;for(e=t.eventTimes,s=-1;0<n;){var i=31-rl(n);a=1<<i,i=e[i],i>s&&(s=i),n&=~a}if(n=s,n=gs()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*iM(n/1960))-n,10<n){t.timeoutHandle=w5(xf.bind(null,t,yi,gc),n);break}xf(t,yi,gc);break;case 5:xf(t,yi,gc);break;default:throw Error(Ft(329))}}}return Ti(t,gs()),t.callbackNode===r?gj.bind(null,t):null}function U5(t,e){var r=Bp;return t.current.memoizedState.isDehydrated&&(Rf(t,e).flags|=256),t=uv(t,e),t!==2&&(e=yi,yi=r,e!==null&&$5(e)),t}function $5(t){yi===null?yi=t:yi.push.apply(yi,t)}function oM(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],a=s.getSnapshot;s=s.value;try{if(!il(a(),s))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Vu(t,e){for(e&=~e4,e&=~v2,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-rl(e),n=1<<r;t[r]=-1,e&=~n}}function ZT(t){if(Zr&6)throw Error(Ft(327));F0();var e=Hy(t,0);if(!(e&1))return Ti(t,gs()),null;var r=uv(t,e);if(t.tag!==0&&r===2){var n=h5(t);n!==0&&(e=n,r=U5(t,n))}if(r===1)throw r=Ag,Rf(t,0),Vu(t,e),Ti(t,gs()),r;if(r===6)throw Error(Ft(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,xf(t,yi,gc),Ti(t,gs()),null}function r4(t,e){var r=Zr;Zr|=1;try{return t(e)}finally{Zr=r,Zr===0&&(tm=gs()+500,p2&&Vd())}}function Hf(t){Xu!==null&&Xu.tag===0&&!(Zr&6)&&F0();var e=Zr;Zr|=1;var r=Ao.transition,n=vn;try{if(Ao.transition=null,vn=1,t)return t()}finally{vn=n,Ao.transition=r,Zr=e,!(Zr&6)&&Vd()}}function n4(){Vi=A0.current,Mn(A0)}function Rf(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,O9(r)),Os!==null)for(r=Os.return;r!==null;){var n=r;switch(ON(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Qy();break;case 3:Z0(),Mn(Ni),Mn(Ua),HN();break;case 5:WN(n);break;case 4:Z0();break;case 13:Mn(Kn);break;case 19:Mn(Kn);break;case 10:UN(n.type._context);break;case 22:case 23:n4()}r=r.return}if(aa=t,Os=t=ud(t.current,null),pa=Vi=e,zs=0,Ag=null,e4=v2=Wf=0,yi=Bp=null,Cf!==null){for(e=0;e<Cf.length;e++)if(r=Cf[e],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,a=r.pending;if(a!==null){var i=a.next;a.next=s,n.next=i}r.pending=n}Cf=null}return t}function xj(t,e){do{var r=Os;try{if(BN(),my.current=iv,av){for(var n=Jn.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}av=!1}if(qf=0,Zs=Us=Jn=null,Mp=!1,Ng=0,ZN.current=null,r===null||r.return===null){zs=1,Ag=e,Os=null;break}e:{var a=t,i=r.return,l=r,c=e;if(e=pa,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=l,f=d.tag;if(!(d.mode&1)&&(f===0||f===11||f===15)){var m=d.alternate;m?(d.updateQueue=m.updateQueue,d.memoizedState=m.memoizedState,d.lanes=m.lanes):(d.updateQueue=null,d.memoizedState=null)}var h=BT(i);if(h!==null){h.flags&=-257,UT(h,i,l,a,e),h.mode&1&&VT(a,u,e),e=h,c=u;var g=e.updateQueue;if(g===null){var p=new Set;p.add(c),e.updateQueue=p}else g.add(c);break e}else{if(!(e&1)){VT(a,u,e),s4();break e}c=Error(Ft(426))}}else if(qn&&l.mode&1){var v=BT(i);if(v!==null){!(v.flags&65536)&&(v.flags|=256),UT(v,i,l,a,e),MN(em(c,l));break e}}a=c=em(c,l),zs!==4&&(zs=2),Bp===null?Bp=[a]:Bp.push(a),a=i;do{switch(a.tag){case 3:a.flags|=65536,e&=-e,a.lanes|=e;var b=ej(a,c,e);RT(a,b);break e;case 1:l=c;var w=a.type,N=a.stateNode;if(!(a.flags&128)&&(typeof w.getDerivedStateFromError=="function"||N!==null&&typeof N.componentDidCatch=="function"&&(ld===null||!ld.has(N)))){a.flags|=65536,e&=-e,a.lanes|=e;var j=tj(a,l,e);RT(a,j);break e}}a=a.return}while(a!==null)}bj(r)}catch(F){e=F,Os===r&&r!==null&&(Os=r=r.return);continue}break}while(!0)}function yj(){var t=ov.current;return ov.current=iv,t===null?iv:t}function s4(){(zs===0||zs===3||zs===2)&&(zs=4),aa===null||!(Wf&268435455)&&!(v2&268435455)||Vu(aa,pa)}function uv(t,e){var r=Zr;Zr|=2;var n=yj();(aa!==t||pa!==e)&&(gc=null,Rf(t,e));do try{lM();break}catch(s){xj(t,s)}while(!0);if(BN(),Zr=r,ov.current=n,Os!==null)throw Error(Ft(261));return aa=null,pa=0,zs}function lM(){for(;Os!==null;)vj(Os)}function cM(){for(;Os!==null&&!DO();)vj(Os)}function vj(t){var e=_j(t.alternate,t,Vi);t.memoizedProps=t.pendingProps,e===null?bj(t):Os=e,ZN.current=null}function bj(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=rM(r,e),r!==null){r.flags&=32767,Os=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{zs=6,Os=null;return}}else if(r=tM(r,e,Vi),r!==null){Os=r;return}if(e=e.sibling,e!==null){Os=e;return}Os=e=t}while(e!==null);zs===0&&(zs=5)}function xf(t,e,r){var n=vn,s=Ao.transition;try{Ao.transition=null,vn=1,uM(t,e,r,n)}finally{Ao.transition=s,vn=n}return null}function uM(t,e,r,n){do F0();while(Xu!==null);if(Zr&6)throw Error(Ft(327));r=t.finishedWork;var s=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(Ft(177));t.callbackNode=null,t.callbackPriority=0;var a=r.lanes|r.childLanes;if(qO(t,a),t===aa&&(Os=aa=null,pa=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||P1||(P1=!0,Nj(Wy,function(){return F0(),null})),a=(r.flags&15990)!==0,r.subtreeFlags&15990||a){a=Ao.transition,Ao.transition=null;var i=vn;vn=1;var l=Zr;Zr|=4,ZN.current=null,sM(t,r),mj(r,t),I9(v5),Gy=!!y5,v5=y5=null,t.current=r,aM(r),FO(),Zr=l,vn=i,Ao.transition=a}else t.current=r;if(P1&&(P1=!1,Xu=t,cv=s),a=t.pendingLanes,a===0&&(ld=null),MO(r.stateNode),Ti(t,gs()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)s=e[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(lv)throw lv=!1,t=V5,V5=null,t;return cv&1&&t.tag!==0&&F0(),a=t.pendingLanes,a&1?t===B5?Up++:(Up=0,B5=t):Up=0,Vd(),null}function F0(){if(Xu!==null){var t=eI(cv),e=Ao.transition,r=vn;try{if(Ao.transition=null,vn=16>t?16:t,Xu===null)var n=!1;else{if(t=Xu,Xu=null,cv=0,Zr&6)throw Error(Ft(331));var s=Zr;for(Zr|=4,Jt=t.current;Jt!==null;){var a=Jt,i=a.child;if(Jt.flags&16){var l=a.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(Jt=u;Jt!==null;){var d=Jt;switch(d.tag){case 0:case 11:case 15:Vp(8,d,a)}var f=d.child;if(f!==null)f.return=d,Jt=f;else for(;Jt!==null;){d=Jt;var m=d.sibling,h=d.return;if(dj(d),d===u){Jt=null;break}if(m!==null){m.return=h,Jt=m;break}Jt=h}}}var g=a.alternate;if(g!==null){var p=g.child;if(p!==null){g.child=null;do{var v=p.sibling;p.sibling=null,p=v}while(p!==null)}}Jt=a}}if(a.subtreeFlags&2064&&i!==null)i.return=a,Jt=i;else e:for(;Jt!==null;){if(a=Jt,a.flags&2048)switch(a.tag){case 0:case 11:case 15:Vp(9,a,a.return)}var b=a.sibling;if(b!==null){b.return=a.return,Jt=b;break e}Jt=a.return}}var w=t.current;for(Jt=w;Jt!==null;){i=Jt;var N=i.child;if(i.subtreeFlags&2064&&N!==null)N.return=i,Jt=N;else e:for(i=w;Jt!==null;){if(l=Jt,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:y2(9,l)}}catch(F){is(l,l.return,F)}if(l===i){Jt=null;break e}var j=l.sibling;if(j!==null){j.return=l.return,Jt=j;break e}Jt=l.return}}if(Zr=s,Vd(),Ll&&typeof Ll.onPostCommitFiberRoot=="function")try{Ll.onPostCommitFiberRoot(u2,t)}catch{}n=!0}return n}finally{vn=r,Ao.transition=e}}return!1}function eA(t,e,r){e=em(r,e),e=ej(t,e,1),t=od(t,e,1),e=ei(),t!==null&&(dx(t,1,e),Ti(t,e))}function is(t,e,r){if(t.tag===3)eA(t,t,r);else for(;e!==null;){if(e.tag===3){eA(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(ld===null||!ld.has(n))){t=em(r,t),t=tj(e,t,1),e=od(e,t,1),t=ei(),e!==null&&(dx(e,1,t),Ti(e,t));break}}e=e.return}}function dM(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=ei(),t.pingedLanes|=t.suspendedLanes&r,aa===t&&(pa&r)===r&&(zs===4||zs===3&&(pa&130023424)===pa&&500>gs()-t4?Rf(t,0):e4|=r),Ti(t,e)}function wj(t,e){e===0&&(t.mode&1?(e=_1,_1<<=1,!(_1&130023424)&&(_1=4194304)):e=1);var r=ei();t=Fc(t,e),t!==null&&(dx(t,e,r),Ti(t,r))}function fM(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),wj(t,r)}function hM(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,s=t.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(Ft(314))}n!==null&&n.delete(e),wj(t,r)}var _j;_j=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||Ni.current)vi=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return vi=!1,eM(t,e,r);vi=!!(t.flags&131072)}else vi=!1,qn&&e.flags&1048576&&AI(e,ev,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;gy(t,e),t=e.pendingProps;var s=X0(e,Ua.current);D0(e,r),s=KN(null,e,n,t,s,r);var a=YN();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Si(n)?(a=!0,Jy(e)):a=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,zN(e),s.updater=x2,e.stateNode=s,s._reactInternals=e,C5(e,n,t,r),e=j5(null,e,n,!0,a,r)):(e.tag=0,qn&&a&&LN(e),Ka(null,e,s,r),e=e.child),e;case 16:n=e.elementType;e:{switch(gy(t,e),t=e.pendingProps,s=n._init,n=s(n._payload),e.type=n,s=e.tag=pM(n),t=Ho(n,t),s){case 0:e=I5(null,e,n,t,r);break e;case 1:e=qT(null,e,n,t,r);break e;case 11:e=$T(null,e,n,t,r);break e;case 14:e=zT(null,e,n,Ho(n.type,t),r);break e}throw Error(Ft(306,n,""))}return e;case 0:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:Ho(n,s),I5(t,e,n,s,r);case 1:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:Ho(n,s),qT(t,e,n,s,r);case 3:e:{if(aj(e),t===null)throw Error(Ft(387));n=e.pendingProps,a=e.memoizedState,s=a.element,PI(t,e),nv(e,n,null,r);var i=e.memoizedState;if(n=i.element,a.isDehydrated)if(a={element:n,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},e.updateQueue.baseState=a,e.memoizedState=a,e.flags&256){s=em(Error(Ft(423)),e),e=WT(t,e,n,r,s);break e}else if(n!==s){s=em(Error(Ft(424)),e),e=WT(t,e,n,r,s);break e}else for(Hi=id(e.stateNode.containerInfo.firstChild),Qi=e,qn=!0,Xo=null,r=II(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Q0(),n===s){e=Lc(t,e,r);break e}Ka(t,e,n,r)}e=e.child}return e;case 5:return RI(e),t===null&&T5(e),n=e.type,s=e.pendingProps,a=t!==null?t.memoizedProps:null,i=s.children,b5(n,s)?i=null:a!==null&&b5(n,a)&&(e.flags|=32),sj(t,e),Ka(t,e,i,r),e.child;case 6:return t===null&&T5(e),null;case 13:return ij(t,e,r);case 4:return qN(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=J0(e,null,n,r):Ka(t,e,n,r),e.child;case 11:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:Ho(n,s),$T(t,e,n,s,r);case 7:return Ka(t,e,e.pendingProps,r),e.child;case 8:return Ka(t,e,e.pendingProps.children,r),e.child;case 12:return Ka(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,s=e.pendingProps,a=e.memoizedProps,i=s.value,In(tv,n._currentValue),n._currentValue=i,a!==null)if(il(a.value,i)){if(a.children===s.children&&!Ni.current){e=Lc(t,e,r);break e}}else for(a=e.child,a!==null&&(a.return=e);a!==null;){var l=a.dependencies;if(l!==null){i=a.child;for(var c=l.firstContext;c!==null;){if(c.context===n){if(a.tag===1){c=Ac(-1,r&-r),c.tag=2;var u=a.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}a.lanes|=r,c=a.alternate,c!==null&&(c.lanes|=r),A5(a.return,r,e),l.lanes|=r;break}c=c.next}}else if(a.tag===10)i=a.type===e.type?null:a.child;else if(a.tag===18){if(i=a.return,i===null)throw Error(Ft(341));i.lanes|=r,l=i.alternate,l!==null&&(l.lanes|=r),A5(i,r,e),i=a.sibling}else i=a.child;if(i!==null)i.return=a;else for(i=a;i!==null;){if(i===e){i=null;break}if(a=i.sibling,a!==null){a.return=i.return,i=a;break}i=i.return}a=i}Ka(t,e,s.children,r),e=e.child}return e;case 9:return s=e.type,n=e.pendingProps.children,D0(e,r),s=ko(s),n=n(s),e.flags|=1,Ka(t,e,n,r),e.child;case 14:return n=e.type,s=Ho(n,e.pendingProps),s=Ho(n.type,s),zT(t,e,n,s,r);case 15:return rj(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:Ho(n,s),gy(t,e),e.tag=1,Si(n)?(t=!0,Jy(e)):t=!1,D0(e,r),ZI(e,n,s),C5(e,n,s,r),j5(null,e,n,!0,t,r);case 19:return oj(t,e,r);case 22:return nj(t,e,r)}throw Error(Ft(156,e.tag))};function Nj(t,e){return X6(t,e)}function mM(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function No(t,e,r,n){return new mM(t,e,r,n)}function a4(t){return t=t.prototype,!(!t||!t.isReactComponent)}function pM(t){if(typeof t=="function")return a4(t)?1:0;if(t!=null){if(t=t.$$typeof,t===SN)return 11;if(t===TN)return 14}return 2}function ud(t,e){var r=t.alternate;return r===null?(r=No(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function vy(t,e,r,n,s,a){var i=2;if(n=t,typeof t=="function")a4(t)&&(i=1);else if(typeof t=="string")i=5;else e:switch(t){case g0:return Df(r.children,s,a,e);case NN:i=8,s|=8;break;case Jw:return t=No(12,r,e,s|2),t.elementType=Jw,t.lanes=a,t;case Zw:return t=No(13,r,e,s),t.elementType=Zw,t.lanes=a,t;case e5:return t=No(19,r,e,s),t.elementType=e5,t.lanes=a,t;case R6:return b2(r,s,a,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case j6:i=10;break e;case P6:i=9;break e;case SN:i=11;break e;case TN:i=14;break e;case Fu:i=16,n=null;break e}throw Error(Ft(130,t==null?t:typeof t,""))}return e=No(i,r,e,s),e.elementType=t,e.type=n,e.lanes=a,e}function Df(t,e,r,n){return t=No(7,t,n,e),t.lanes=r,t}function b2(t,e,r,n){return t=No(22,t,n,e),t.elementType=R6,t.lanes=r,t.stateNode={isHidden:!1},t}function rw(t,e,r){return t=No(6,t,null,e),t.lanes=r,t}function nw(t,e,r){return e=No(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function gM(t,e,r,n,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ob(0),this.expirationTimes=Ob(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ob(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function i4(t,e,r,n,s,a,i,l,c){return t=new gM(t,e,r,l,c),e===1?(e=1,a===!0&&(e|=8)):e=0,a=No(3,null,null,e),t.current=a,a.stateNode=t,a.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},zN(a),t}function xM(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:p0,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function Sj(t){if(!t)return wd;t=t._reactInternals;e:{if(hh(t)!==t||t.tag!==1)throw Error(Ft(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Si(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Ft(171))}if(t.tag===1){var r=t.type;if(Si(r))return SI(t,r,e)}return e}function Tj(t,e,r,n,s,a,i,l,c){return t=i4(r,n,!0,t,s,a,i,l,c),t.context=Sj(null),r=t.current,n=ei(),s=cd(r),a=Ac(n,s),a.callback=e??null,od(r,a,s),t.current.lanes=s,dx(t,s,n),Ti(t,n),t}function w2(t,e,r,n){var s=e.current,a=ei(),i=cd(s);return r=Sj(r),e.context===null?e.context=r:e.pendingContext=r,e=Ac(a,i),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=od(s,e,i),t!==null&&(nl(t,s,i,a),hy(t,s,i)),i}function dv(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function tA(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function o4(t,e){tA(t,e),(t=t.alternate)&&tA(t,e)}function yM(){return null}var Aj=typeof reportError=="function"?reportError:function(t){console.error(t)};function l4(t){this._internalRoot=t}_2.prototype.render=l4.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Ft(409));w2(t,e,null,null)};_2.prototype.unmount=l4.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Hf(function(){w2(null,t,null,null)}),e[Dc]=null}};function _2(t){this._internalRoot=t}_2.prototype.unstable_scheduleHydration=function(t){if(t){var e=nI();t={blockedOn:null,target:t,priority:e};for(var r=0;r<Mu.length&&e!==0&&e<Mu[r].priority;r++);Mu.splice(r,0,t),r===0&&aI(t)}};function c4(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function N2(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function rA(){}function vM(t,e,r,n,s){if(s){if(typeof n=="function"){var a=n;n=function(){var u=dv(i);a.call(u)}}var i=Tj(e,n,t,0,null,!1,!1,"",rA);return t._reactRootContainer=i,t[Dc]=i.current,yg(t.nodeType===8?t.parentNode:t),Hf(),i}for(;s=t.lastChild;)t.removeChild(s);if(typeof n=="function"){var l=n;n=function(){var u=dv(c);l.call(u)}}var c=i4(t,0,!1,null,null,!1,!1,"",rA);return t._reactRootContainer=c,t[Dc]=c.current,yg(t.nodeType===8?t.parentNode:t),Hf(function(){w2(e,c,r,n)}),c}function S2(t,e,r,n,s){var a=r._reactRootContainer;if(a){var i=a;if(typeof s=="function"){var l=s;s=function(){var c=dv(i);l.call(c)}}w2(e,i,t,s)}else i=vM(r,e,t,s,n);return dv(i)}tI=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=bp(e.pendingLanes);r!==0&&(CN(e,r|1),Ti(e,gs()),!(Zr&6)&&(tm=gs()+500,Vd()))}break;case 13:Hf(function(){var n=Fc(t,1);if(n!==null){var s=ei();nl(n,t,1,s)}}),o4(t,1)}};kN=function(t){if(t.tag===13){var e=Fc(t,134217728);if(e!==null){var r=ei();nl(e,t,134217728,r)}o4(t,134217728)}};rI=function(t){if(t.tag===13){var e=cd(t),r=Fc(t,e);if(r!==null){var n=ei();nl(r,t,e,n)}o4(t,e)}};nI=function(){return vn};sI=function(t,e){var r=vn;try{return vn=t,e()}finally{vn=r}};u5=function(t,e,r){switch(e){case"input":if(n5(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var s=m2(n);if(!s)throw Error(Ft(90));F6(n),n5(n,s)}}}break;case"textarea":O6(t,r);break;case"select":e=r.value,e!=null&&I0(t,!!r.multiple,e,!1)}};q6=r4;W6=Hf;var bM={usingClientEntryPoint:!1,Events:[hx,b0,m2,$6,z6,r4]},op={findFiberByHostInstance:Ef,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},wM={bundleType:op.bundleType,version:op.version,rendererPackageName:op.rendererPackageName,rendererConfig:op.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Hc.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=K6(t),t===null?null:t.stateNode},findFiberByHostInstance:op.findFiberByHostInstance||yM,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var R1=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!R1.isDisabled&&R1.supportsFiber)try{u2=R1.inject(wM),Ll=R1}catch{}}no.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=bM;no.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!c4(e))throw Error(Ft(200));return xM(t,e,null,r)};no.createRoot=function(t,e){if(!c4(t))throw Error(Ft(299));var r=!1,n="",s=Aj;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=i4(t,1,!1,null,null,r,!1,n,s),t[Dc]=e.current,yg(t.nodeType===8?t.parentNode:t),new l4(e)};no.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Ft(188)):(t=Object.keys(t).join(","),Error(Ft(268,t)));return t=K6(e),t=t===null?null:t.stateNode,t};no.flushSync=function(t){return Hf(t)};no.hydrate=function(t,e,r){if(!N2(e))throw Error(Ft(200));return S2(null,t,e,!0,r)};no.hydrateRoot=function(t,e,r){if(!c4(t))throw Error(Ft(405));var n=r!=null&&r.hydratedSources||null,s=!1,a="",i=Aj;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(a=r.identifierPrefix),r.onRecoverableError!==void 0&&(i=r.onRecoverableError)),e=Tj(e,null,t,1,r??null,s,!1,a,i),t[Dc]=e.current,yg(t),n)for(t=0;t<n.length;t++)r=n[t],s=r._getVersion,s=s(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,s]:e.mutableSourceEagerHydrationData.push(r,s);return new _2(e)};no.render=function(t,e,r){if(!N2(e))throw Error(Ft(200));return S2(null,t,e,!1,r)};no.unmountComponentAtNode=function(t){if(!N2(t))throw Error(Ft(40));return t._reactRootContainer?(Hf(function(){S2(null,null,t,!1,function(){t._reactRootContainer=null,t[Dc]=null})}),!0):!1};no.unstable_batchedUpdates=r4;no.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!N2(r))throw Error(Ft(200));if(t==null||t._reactInternals===void 0)throw Error(Ft(38));return S2(t,e,r,!1,n)};no.version="18.3.1-next-f1338f8080-20240426";function Ej(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Ej)}catch(t){console.error(t)}}Ej(),E6.exports=no;var _M=E6.exports,nA=_M;Xw.createRoot=nA.createRoot,Xw.hydrateRoot=nA.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Eg(){return Eg=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Eg.apply(this,arguments)}var Qu;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Qu||(Qu={}));const sA="popstate";function NM(t){t===void 0&&(t={});function e(n,s){let{pathname:a,search:i,hash:l}=n.location;return z5("",{pathname:a,search:i,hash:l},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(n,s){return typeof s=="string"?s:fv(s)}return TM(e,r,null,t)}function ws(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Cj(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function SM(){return Math.random().toString(36).substr(2,8)}function aA(t,e){return{usr:t.state,key:t.key,idx:e}}function z5(t,e,r,n){return r===void 0&&(r=null),Eg({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Sm(e):e,{state:r,key:e&&e.key||n||SM()})}function fv(t){let{pathname:e="/",search:r="",hash:n=""}=t;return r&&r!=="?"&&(e+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function Sm(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substr(r),t=t.substr(0,r));let n=t.indexOf("?");n>=0&&(e.search=t.substr(n),t=t.substr(0,n)),t&&(e.pathname=t)}return e}function TM(t,e,r,n){n===void 0&&(n={});let{window:s=document.defaultView,v5Compat:a=!1}=n,i=s.history,l=Qu.Pop,c=null,u=d();u==null&&(u=0,i.replaceState(Eg({},i.state,{idx:u}),""));function d(){return(i.state||{idx:null}).idx}function f(){l=Qu.Pop;let v=d(),b=v==null?null:v-u;u=v,c&&c({action:l,location:p.location,delta:b})}function m(v,b){l=Qu.Push;let w=z5(p.location,v,b);u=d()+1;let N=aA(w,u),j=p.createHref(w);try{i.pushState(N,"",j)}catch(F){if(F instanceof DOMException&&F.name==="DataCloneError")throw F;s.location.assign(j)}a&&c&&c({action:l,location:p.location,delta:1})}function h(v,b){l=Qu.Replace;let w=z5(p.location,v,b);u=d();let N=aA(w,u),j=p.createHref(w);i.replaceState(N,"",j),a&&c&&c({action:l,location:p.location,delta:0})}function g(v){let b=s.location.origin!=="null"?s.location.origin:s.location.href,w=typeof v=="string"?v:fv(v);return w=w.replace(/ $/,"%20"),ws(b,"No window.location.(origin|href) available to create URL for href: "+w),new URL(w,b)}let p={get action(){return l},get location(){return t(s,i)},listen(v){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(sA,f),c=v,()=>{s.removeEventListener(sA,f),c=null}},createHref(v){return e(s,v)},createURL:g,encodeLocation(v){let b=g(v);return{pathname:b.pathname,search:b.search,hash:b.hash}},push:m,replace:h,go(v){return i.go(v)}};return p}var iA;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(iA||(iA={}));function AM(t,e,r){return r===void 0&&(r="/"),EM(t,e,r)}function EM(t,e,r,n){let s=typeof e=="string"?Sm(e):e,a=u4(s.pathname||"/",r);if(a==null)return null;let i=kj(t);CM(i);let l=null;for(let c=0;l==null&&c<i.length;++c){let u=BM(a);l=OM(i[c],u)}return l}function kj(t,e,r,n){e===void 0&&(e=[]),r===void 0&&(r=[]),n===void 0&&(n="");let s=(a,i,l)=>{let c={relativePath:l===void 0?a.path||"":l,caseSensitive:a.caseSensitive===!0,childrenIndex:i,route:a};c.relativePath.startsWith("/")&&(ws(c.relativePath.startsWith(n),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(n.length));let u=dd([n,c.relativePath]),d=r.concat(c);a.children&&a.children.length>0&&(ws(a.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),kj(a.children,e,d,u)),!(a.path==null&&!a.index)&&e.push({path:u,score:FM(u,a.index),routesMeta:d})};return t.forEach((a,i)=>{var l;if(a.path===""||!((l=a.path)!=null&&l.includes("?")))s(a,i);else for(let c of Ij(a.path))s(a,i,c)}),e}function Ij(t){let e=t.split("/");if(e.length===0)return[];let[r,...n]=e,s=r.endsWith("?"),a=r.replace(/\?$/,"");if(n.length===0)return s?[a,""]:[a];let i=Ij(n.join("/")),l=[];return l.push(...i.map(c=>c===""?a:[a,c].join("/"))),s&&l.push(...i),l.map(c=>t.startsWith("/")&&c===""?"/":c)}function CM(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:LM(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const kM=/^:[\w-]+$/,IM=3,jM=2,PM=1,RM=10,DM=-2,oA=t=>t==="*";function FM(t,e){let r=t.split("/"),n=r.length;return r.some(oA)&&(n+=DM),e&&(n+=jM),r.filter(s=>!oA(s)).reduce((s,a)=>s+(kM.test(a)?IM:a===""?PM:RM),n)}function LM(t,e){return t.length===e.length&&t.slice(0,-1).every((n,s)=>n===e[s])?t[t.length-1]-e[e.length-1]:0}function OM(t,e,r){let{routesMeta:n}=t,s={},a="/",i=[];for(let l=0;l<n.length;++l){let c=n[l],u=l===n.length-1,d=a==="/"?e:e.slice(a.length)||"/",f=MM({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},d),m=c.route;if(!f)return null;Object.assign(s,f.params),i.push({params:s,pathname:dd([a,f.pathname]),pathnameBase:qM(dd([a,f.pathnameBase])),route:m}),f.pathnameBase!=="/"&&(a=dd([a,f.pathnameBase]))}return i}function MM(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=VM(t.path,t.caseSensitive,t.end),s=e.match(r);if(!s)return null;let a=s[0],i=a.replace(/(.)\/+$/,"$1"),l=s.slice(1);return{params:n.reduce((u,d,f)=>{let{paramName:m,isOptional:h}=d;if(m==="*"){let p=l[f]||"";i=a.slice(0,a.length-p.length).replace(/(.)\/+$/,"$1")}const g=l[f];return h&&!g?u[m]=void 0:u[m]=(g||"").replace(/%2F/g,"/"),u},{}),pathname:a,pathnameBase:i,pattern:t}}function VM(t,e,r){e===void 0&&(e=!1),r===void 0&&(r=!0),Cj(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let n=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,l,c)=>(n.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(n.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),n]}function BM(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Cj(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function u4(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}function UM(t,e){e===void 0&&(e="/");let{pathname:r,search:n="",hash:s=""}=typeof t=="string"?Sm(t):t;return{pathname:r?r.startsWith("/")?r:$M(r,e):e,search:WM(n),hash:HM(s)}}function $M(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?r.length>1&&r.pop():s!=="."&&r.push(s)}),r.length>1?r.join("/"):"/"}function sw(t,e,r,n){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function zM(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function d4(t,e){let r=zM(t);return e?r.map((n,s)=>s===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function f4(t,e,r,n){n===void 0&&(n=!1);let s;typeof t=="string"?s=Sm(t):(s=Eg({},t),ws(!s.pathname||!s.pathname.includes("?"),sw("?","pathname","search",s)),ws(!s.pathname||!s.pathname.includes("#"),sw("#","pathname","hash",s)),ws(!s.search||!s.search.includes("#"),sw("#","search","hash",s)));let a=t===""||s.pathname==="",i=a?"/":s.pathname,l;if(i==null)l=r;else{let f=e.length-1;if(!n&&i.startsWith("..")){let m=i.split("/");for(;m[0]==="..";)m.shift(),f-=1;s.pathname=m.join("/")}l=f>=0?e[f]:"/"}let c=UM(s,l),u=i&&i!=="/"&&i.endsWith("/"),d=(a||i===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(u||d)&&(c.pathname+="/"),c}const dd=t=>t.join("/").replace(/\/\/+/g,"/"),qM=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),WM=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,HM=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function GM(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const jj=["post","put","patch","delete"];new Set(jj);const KM=["get",...jj];new Set(KM);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Cg(){return Cg=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Cg.apply(this,arguments)}const h4=X.createContext(null),YM=X.createContext(null),Bd=X.createContext(null),T2=X.createContext(null),ql=X.createContext({outlet:null,matches:[],isDataRoute:!1}),Pj=X.createContext(null);function XM(t,e){let{relative:r}=e===void 0?{}:e;Tm()||ws(!1);let{basename:n,navigator:s}=X.useContext(Bd),{hash:a,pathname:i,search:l}=Dj(t,{relative:r}),c=i;return n!=="/"&&(c=i==="/"?n:dd([n,i])),s.createHref({pathname:c,search:l,hash:a})}function Tm(){return X.useContext(T2)!=null}function Ud(){return Tm()||ws(!1),X.useContext(T2).location}function Rj(t){X.useContext(Bd).static||X.useLayoutEffect(t)}function Wl(){let{isDataRoute:t}=X.useContext(ql);return t?dV():QM()}function QM(){Tm()||ws(!1);let t=X.useContext(h4),{basename:e,future:r,navigator:n}=X.useContext(Bd),{matches:s}=X.useContext(ql),{pathname:a}=Ud(),i=JSON.stringify(d4(s,r.v7_relativeSplatPath)),l=X.useRef(!1);return Rj(()=>{l.current=!0}),X.useCallback(function(u,d){if(d===void 0&&(d={}),!l.current)return;if(typeof u=="number"){n.go(u);return}let f=f4(u,JSON.parse(i),a,d.relative==="path");t==null&&e!=="/"&&(f.pathname=f.pathname==="/"?e:dd([e,f.pathname])),(d.replace?n.replace:n.push)(f,d.state,d)},[e,n,i,a,t])}const JM=X.createContext(null);function ZM(t){let e=X.useContext(ql).outlet;return e&&X.createElement(JM.Provider,{value:t},e)}function px(){let{matches:t}=X.useContext(ql),e=t[t.length-1];return e?e.params:{}}function Dj(t,e){let{relative:r}=e===void 0?{}:e,{future:n}=X.useContext(Bd),{matches:s}=X.useContext(ql),{pathname:a}=Ud(),i=JSON.stringify(d4(s,n.v7_relativeSplatPath));return X.useMemo(()=>f4(t,JSON.parse(i),a,r==="path"),[t,i,a,r])}function eV(t,e){return tV(t,e)}function tV(t,e,r,n){Tm()||ws(!1);let{navigator:s}=X.useContext(Bd),{matches:a}=X.useContext(ql),i=a[a.length-1],l=i?i.params:{};i&&i.pathname;let c=i?i.pathnameBase:"/";i&&i.route;let u=Ud(),d;if(e){var f;let v=typeof e=="string"?Sm(e):e;c==="/"||(f=v.pathname)!=null&&f.startsWith(c)||ws(!1),d=v}else d=u;let m=d.pathname||"/",h=m;if(c!=="/"){let v=c.replace(/^\//,"").split("/");h="/"+m.replace(/^\//,"").split("/").slice(v.length).join("/")}let g=AM(t,{pathname:h}),p=iV(g&&g.map(v=>Object.assign({},v,{params:Object.assign({},l,v.params),pathname:dd([c,s.encodeLocation?s.encodeLocation(v.pathname).pathname:v.pathname]),pathnameBase:v.pathnameBase==="/"?c:dd([c,s.encodeLocation?s.encodeLocation(v.pathnameBase).pathname:v.pathnameBase])})),a,r,n);return e&&p?X.createElement(T2.Provider,{value:{location:Cg({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:Qu.Pop}},p):p}function rV(){let t=uV(),e=GM(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return X.createElement(X.Fragment,null,X.createElement("h2",null,"Unexpected Application Error!"),X.createElement("h3",{style:{fontStyle:"italic"}},e),r?X.createElement("pre",{style:s},r):null,null)}const nV=X.createElement(rV,null);class sV extends X.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,r){return r.location!==e.location||r.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:r.error,location:r.location,revalidation:e.revalidation||r.revalidation}}componentDidCatch(e,r){console.error("React Router caught the following error during render",e,r)}render(){return this.state.error!==void 0?X.createElement(ql.Provider,{value:this.props.routeContext},X.createElement(Pj.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function aV(t){let{routeContext:e,match:r,children:n}=t,s=X.useContext(h4);return s&&s.static&&s.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=r.route.id),X.createElement(ql.Provider,{value:e},n)}function iV(t,e,r,n){var s;if(e===void 0&&(e=[]),r===void 0&&(r=null),n===void 0&&(n=null),t==null){var a;if(!r)return null;if(r.errors)t=r.matches;else if((a=n)!=null&&a.v7_partialHydration&&e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let i=t,l=(s=r)==null?void 0:s.errors;if(l!=null){let d=i.findIndex(f=>f.route.id&&(l==null?void 0:l[f.route.id])!==void 0);d>=0||ws(!1),i=i.slice(0,Math.min(i.length,d+1))}let c=!1,u=-1;if(r&&n&&n.v7_partialHydration)for(let d=0;d<i.length;d++){let f=i[d];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(u=d),f.route.id){let{loaderData:m,errors:h}=r,g=f.route.loader&&m[f.route.id]===void 0&&(!h||h[f.route.id]===void 0);if(f.route.lazy||g){c=!0,u>=0?i=i.slice(0,u+1):i=[i[0]];break}}}return i.reduceRight((d,f,m)=>{let h,g=!1,p=null,v=null;r&&(h=l&&f.route.id?l[f.route.id]:void 0,p=f.route.errorElement||nV,c&&(u<0&&m===0?(fV("route-fallback"),g=!0,v=null):u===m&&(g=!0,v=f.route.hydrateFallbackElement||null)));let b=e.concat(i.slice(0,m+1)),w=()=>{let N;return h?N=p:g?N=v:f.route.Component?N=X.createElement(f.route.Component,null):f.route.element?N=f.route.element:N=d,X.createElement(aV,{match:f,routeContext:{outlet:d,matches:b,isDataRoute:r!=null},children:N})};return r&&(f.route.ErrorBoundary||f.route.errorElement||m===0)?X.createElement(sV,{location:r.location,revalidation:r.revalidation,component:p,error:h,children:w(),routeContext:{outlet:null,matches:b,isDataRoute:!0}}):w()},null)}var Fj=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(Fj||{}),Lj=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(Lj||{});function oV(t){let e=X.useContext(h4);return e||ws(!1),e}function lV(t){let e=X.useContext(YM);return e||ws(!1),e}function cV(t){let e=X.useContext(ql);return e||ws(!1),e}function Oj(t){let e=cV(),r=e.matches[e.matches.length-1];return r.route.id||ws(!1),r.route.id}function uV(){var t;let e=X.useContext(Pj),r=lV(),n=Oj();return e!==void 0?e:(t=r.errors)==null?void 0:t[n]}function dV(){let{router:t}=oV(Fj.UseNavigateStable),e=Oj(Lj.UseNavigateStable),r=X.useRef(!1);return Rj(()=>{r.current=!0}),X.useCallback(function(s,a){a===void 0&&(a={}),r.current&&(typeof s=="number"?t.navigate(s):t.navigate(s,Cg({fromRouteId:e},a)))},[t,e])}const lA={};function fV(t,e,r){lA[t]||(lA[t]=!0)}function hV(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function Mj(t){let{to:e,replace:r,state:n,relative:s}=t;Tm()||ws(!1);let{future:a,static:i}=X.useContext(Bd),{matches:l}=X.useContext(ql),{pathname:c}=Ud(),u=Wl(),d=f4(e,d4(l,a.v7_relativeSplatPath),c,s==="path"),f=JSON.stringify(d);return X.useEffect(()=>u(JSON.parse(f),{replace:r,state:n,relative:s}),[u,f,s,r,n]),null}function mV(t){return ZM(t.context)}function ss(t){ws(!1)}function pV(t){let{basename:e="/",children:r=null,location:n,navigationType:s=Qu.Pop,navigator:a,static:i=!1,future:l}=t;Tm()&&ws(!1);let c=e.replace(/^\/*/,"/"),u=X.useMemo(()=>({basename:c,navigator:a,static:i,future:Cg({v7_relativeSplatPath:!1},l)}),[c,l,a,i]);typeof n=="string"&&(n=Sm(n));let{pathname:d="/",search:f="",hash:m="",state:h=null,key:g="default"}=n,p=X.useMemo(()=>{let v=u4(d,c);return v==null?null:{location:{pathname:v,search:f,hash:m,state:h,key:g},navigationType:s}},[c,d,f,m,h,g,s]);return p==null?null:X.createElement(Bd.Provider,{value:u},X.createElement(T2.Provider,{children:r,value:p}))}function cA(t){let{children:e,location:r}=t;return eV(q5(e),r)}new Promise(()=>{});function q5(t,e){e===void 0&&(e=[]);let r=[];return X.Children.forEach(t,(n,s)=>{if(!X.isValidElement(n))return;let a=[...e,s];if(n.type===X.Fragment){r.push.apply(r,q5(n.props.children,a));return}n.type!==ss&&ws(!1),!n.props.index||!n.props.children||ws(!1);let i={id:n.props.id||a.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(i.children=q5(n.props.children,a)),r.push(i)}),r}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function W5(){return W5=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},W5.apply(this,arguments)}function gV(t,e){if(t==null)return{};var r={},n=Object.keys(t),s,a;for(a=0;a<n.length;a++)s=n[a],!(e.indexOf(s)>=0)&&(r[s]=t[s]);return r}function xV(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function yV(t,e){return t.button===0&&(!e||e==="_self")&&!xV(t)}function H5(t){return t===void 0&&(t=""),new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,r)=>{let n=t[r];return e.concat(Array.isArray(n)?n.map(s=>[r,s]):[[r,n]])},[]))}function vV(t,e){let r=H5(t);return e&&e.forEach((n,s)=>{r.has(s)||e.getAll(s).forEach(a=>{r.append(s,a)})}),r}const bV=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],wV="6";try{window.__reactRouterVersion=wV}catch{}const _V="startTransition",uA=dO[_V];function NV(t){let{basename:e,children:r,future:n,window:s}=t,a=X.useRef();a.current==null&&(a.current=NM({window:s,v5Compat:!0}));let i=a.current,[l,c]=X.useState({action:i.action,location:i.location}),{v7_startTransition:u}=n||{},d=X.useCallback(f=>{u&&uA?uA(()=>c(f)):c(f)},[c,u]);return X.useLayoutEffect(()=>i.listen(d),[i,d]),X.useEffect(()=>hV(n),[n]),X.createElement(pV,{basename:e,children:r,location:l.location,navigationType:l.action,navigator:i,future:n})}const SV=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",TV=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,AV=X.forwardRef(function(e,r){let{onClick:n,relative:s,reloadDocument:a,replace:i,state:l,target:c,to:u,preventScrollReset:d,viewTransition:f}=e,m=gV(e,bV),{basename:h}=X.useContext(Bd),g,p=!1;if(typeof u=="string"&&TV.test(u)&&(g=u,SV))try{let N=new URL(window.location.href),j=u.startsWith("//")?new URL(N.protocol+u):new URL(u),F=u4(j.pathname,h);j.origin===N.origin&&F!=null?u=F+j.search+j.hash:p=!0}catch{}let v=XM(u,{relative:s}),b=EV(u,{replace:i,state:l,target:c,preventScrollReset:d,relative:s,viewTransition:f});function w(N){n&&n(N),N.defaultPrevented||b(N)}return X.createElement("a",W5({},m,{href:g||v,onClick:p||a?n:w,ref:r,target:c}))});var dA;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(dA||(dA={}));var fA;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(fA||(fA={}));function EV(t,e){let{target:r,replace:n,state:s,preventScrollReset:a,relative:i,viewTransition:l}=e===void 0?{}:e,c=Wl(),u=Ud(),d=Dj(t,{relative:i});return X.useCallback(f=>{if(yV(f,r)){f.preventDefault();let m=n!==void 0?n:fv(u)===fv(d);c(t,{replace:m,state:s,preventScrollReset:a,relative:i,viewTransition:l})}},[u,c,d,n,s,r,t,a,i,l])}function CV(t){let e=X.useRef(H5(t)),r=X.useRef(!1),n=Ud(),s=X.useMemo(()=>vV(n.search,r.current?null:e.current),[n.search]),a=Wl(),i=X.useCallback((l,c)=>{const u=H5(typeof l=="function"?l(s):l);r.current=!0,a("?"+u,c)},[a,s]);return[s,i]}let kV={data:""},IV=t=>typeof window=="object"?((t?t.querySelector("#_goober"):window._goober)||Object.assign((t||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:t||kV,jV=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,PV=/\/\*[^]*?\*\/|  +/g,hA=/\n+/g,Bu=(t,e)=>{let r="",n="",s="";for(let a in t){let i=t[a];a[0]=="@"?a[1]=="i"?r=a+" "+i+";":n+=a[1]=="f"?Bu(i,a):a+"{"+Bu(i,a[1]=="k"?"":e)+"}":typeof i=="object"?n+=Bu(i,e?e.replace(/([^,])+/g,l=>a.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,c=>/&/.test(c)?c.replace(/&/g,l):l?l+" "+c:c)):a):i!=null&&(a=/^--/.test(a)?a:a.replace(/[A-Z]/g,"-$&").toLowerCase(),s+=Bu.p?Bu.p(a,i):a+":"+i+";")}return r+(e&&s?e+"{"+s+"}":s)+n},cc={},Vj=t=>{if(typeof t=="object"){let e="";for(let r in t)e+=r+Vj(t[r]);return e}return t},RV=(t,e,r,n,s)=>{let a=Vj(t),i=cc[a]||(cc[a]=(c=>{let u=0,d=11;for(;u<c.length;)d=101*d+c.charCodeAt(u++)>>>0;return"go"+d})(a));if(!cc[i]){let c=a!==t?t:(u=>{let d,f,m=[{}];for(;d=jV.exec(u.replace(PV,""));)d[4]?m.shift():d[3]?(f=d[3].replace(hA," ").trim(),m.unshift(m[0][f]=m[0][f]||{})):m[0][d[1]]=d[2].replace(hA," ").trim();return m[0]})(t);cc[i]=Bu(s?{["@keyframes "+i]:c}:c,r?"":"."+i)}let l=r&&cc.g?cc.g:null;return r&&(cc.g=cc[i]),((c,u,d,f)=>{f?u.data=u.data.replace(f,c):u.data.indexOf(c)===-1&&(u.data=d?c+u.data:u.data+c)})(cc[i],e,n,l),i},DV=(t,e,r)=>t.reduce((n,s,a)=>{let i=e[a];if(i&&i.call){let l=i(r),c=l&&l.props&&l.props.className||/^go/.test(l)&&l;i=c?"."+c:l&&typeof l=="object"?l.props?"":Bu(l,""):l===!1?"":l}return n+s+(i??"")},"");function A2(t){let e=this||{},r=t.call?t(e.p):t;return RV(r.unshift?r.raw?DV(r,[].slice.call(arguments,1),e.p):r.reduce((n,s)=>Object.assign(n,s&&s.call?s(e.p):s),{}):r,IV(e.target),e.g,e.o,e.k)}let Bj,G5,K5;A2.bind({g:1});let Oc=A2.bind({k:1});function FV(t,e,r,n){Bu.p=e,Bj=t,G5=r,K5=n}function $d(t,e){let r=this||{};return function(){let n=arguments;function s(a,i){let l=Object.assign({},a),c=l.className||s.className;r.p=Object.assign({theme:G5&&G5()},l),r.o=/ *go\d+/.test(c),l.className=A2.apply(r,n)+(c?" "+c:"");let u=t;return t[0]&&(u=l.as||t,delete l.as),K5&&u[0]&&K5(l),Bj(u,l)}return s}}var LV=t=>typeof t=="function",hv=(t,e)=>LV(t)?t(e):t,OV=(()=>{let t=0;return()=>(++t).toString()})(),Uj=(()=>{let t;return()=>{if(t===void 0&&typeof window<"u"){let e=matchMedia("(prefers-reduced-motion: reduce)");t=!e||e.matches}return t}})(),MV=20,$j=(t,e)=>{switch(e.type){case 0:return{...t,toasts:[e.toast,...t.toasts].slice(0,MV)};case 1:return{...t,toasts:t.toasts.map(a=>a.id===e.toast.id?{...a,...e.toast}:a)};case 2:let{toast:r}=e;return $j(t,{type:t.toasts.find(a=>a.id===r.id)?1:0,toast:r});case 3:let{toastId:n}=e;return{...t,toasts:t.toasts.map(a=>a.id===n||n===void 0?{...a,dismissed:!0,visible:!1}:a)};case 4:return e.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(a=>a.id!==e.toastId)};case 5:return{...t,pausedAt:e.time};case 6:let s=e.time-(t.pausedAt||0);return{...t,pausedAt:void 0,toasts:t.toasts.map(a=>({...a,pauseDuration:a.pauseDuration+s}))}}},by=[],If={toasts:[],pausedAt:void 0},mh=t=>{If=$j(If,t),by.forEach(e=>{e(If)})},VV={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},BV=(t={})=>{let[e,r]=X.useState(If),n=X.useRef(If);X.useEffect(()=>(n.current!==If&&r(If),by.push(r),()=>{let a=by.indexOf(r);a>-1&&by.splice(a,1)}),[]);let s=e.toasts.map(a=>{var i,l,c;return{...t,...t[a.type],...a,removeDelay:a.removeDelay||((i=t[a.type])==null?void 0:i.removeDelay)||(t==null?void 0:t.removeDelay),duration:a.duration||((l=t[a.type])==null?void 0:l.duration)||(t==null?void 0:t.duration)||VV[a.type],style:{...t.style,...(c=t[a.type])==null?void 0:c.style,...a.style}}});return{...e,toasts:s}},UV=(t,e="blank",r)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:e,ariaProps:{role:"status","aria-live":"polite"},message:t,pauseDuration:0,...r,id:(r==null?void 0:r.id)||OV()}),gx=t=>(e,r)=>{let n=UV(e,t,r);return mh({type:2,toast:n}),n.id},Xr=(t,e)=>gx("blank")(t,e);Xr.error=gx("error");Xr.success=gx("success");Xr.loading=gx("loading");Xr.custom=gx("custom");Xr.dismiss=t=>{mh({type:3,toastId:t})};Xr.remove=t=>mh({type:4,toastId:t});Xr.promise=(t,e,r)=>{let n=Xr.loading(e.loading,{...r,...r==null?void 0:r.loading});return typeof t=="function"&&(t=t()),t.then(s=>{let a=e.success?hv(e.success,s):void 0;return a?Xr.success(a,{id:n,...r,...r==null?void 0:r.success}):Xr.dismiss(n),s}).catch(s=>{let a=e.error?hv(e.error,s):void 0;a?Xr.error(a,{id:n,...r,...r==null?void 0:r.error}):Xr.dismiss(n)}),t};var $V=(t,e)=>{mh({type:1,toast:{id:t,height:e}})},zV=()=>{mh({type:5,time:Date.now()})},$p=new Map,qV=1e3,WV=(t,e=qV)=>{if($p.has(t))return;let r=setTimeout(()=>{$p.delete(t),mh({type:4,toastId:t})},e);$p.set(t,r)},HV=t=>{let{toasts:e,pausedAt:r}=BV(t);X.useEffect(()=>{if(r)return;let a=Date.now(),i=e.map(l=>{if(l.duration===1/0)return;let c=(l.duration||0)+l.pauseDuration-(a-l.createdAt);if(c<0){l.visible&&Xr.dismiss(l.id);return}return setTimeout(()=>Xr.dismiss(l.id),c)});return()=>{i.forEach(l=>l&&clearTimeout(l))}},[e,r]);let n=X.useCallback(()=>{r&&mh({type:6,time:Date.now()})},[r]),s=X.useCallback((a,i)=>{let{reverseOrder:l=!1,gutter:c=8,defaultPosition:u}=i||{},d=e.filter(h=>(h.position||u)===(a.position||u)&&h.height),f=d.findIndex(h=>h.id===a.id),m=d.filter((h,g)=>g<f&&h.visible).length;return d.filter(h=>h.visible).slice(...l?[m+1]:[0,m]).reduce((h,g)=>h+(g.height||0)+c,0)},[e]);return X.useEffect(()=>{e.forEach(a=>{if(a.dismissed)WV(a.id,a.removeDelay);else{let i=$p.get(a.id);i&&(clearTimeout(i),$p.delete(a.id))}})},[e]),{toasts:e,handlers:{updateHeight:$V,startPause:zV,endPause:n,calculateOffset:s}}},GV=Oc`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,KV=Oc`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,YV=Oc`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,XV=$d("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${GV} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${KV} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${t=>t.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${YV} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,QV=Oc`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,JV=$d("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${t=>t.secondary||"#e0e0e0"};
  border-right-color: ${t=>t.primary||"#616161"};
  animation: ${QV} 1s linear infinite;
`,ZV=Oc`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,eB=Oc`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,tB=$d("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${ZV} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${eB} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${t=>t.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,rB=$d("div")`
  position: absolute;
`,nB=$d("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,sB=Oc`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,aB=$d("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${sB} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,iB=({toast:t})=>{let{icon:e,type:r,iconTheme:n}=t;return e!==void 0?typeof e=="string"?X.createElement(aB,null,e):e:r==="blank"?null:X.createElement(nB,null,X.createElement(JV,{...n}),r!=="loading"&&X.createElement(rB,null,r==="error"?X.createElement(XV,{...n}):X.createElement(tB,{...n})))},oB=t=>`
0% {transform: translate3d(0,${t*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,lB=t=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${t*-150}%,-1px) scale(.6); opacity:0;}
`,cB="0%{opacity:0;} 100%{opacity:1;}",uB="0%{opacity:1;} 100%{opacity:0;}",dB=$d("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,fB=$d("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,hB=(t,e)=>{let r=t.includes("top")?1:-1,[n,s]=Uj()?[cB,uB]:[oB(r),lB(r)];return{animation:e?`${Oc(n)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${Oc(s)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},mB=X.memo(({toast:t,position:e,style:r,children:n})=>{let s=t.height?hB(t.position||e||"top-center",t.visible):{opacity:0},a=X.createElement(iB,{toast:t}),i=X.createElement(fB,{...t.ariaProps},hv(t.message,t));return X.createElement(dB,{className:t.className,style:{...s,...r,...t.style}},typeof n=="function"?n({icon:a,message:i}):X.createElement(X.Fragment,null,a,i))});FV(X.createElement);var pB=({id:t,className:e,style:r,onHeightUpdate:n,children:s})=>{let a=X.useCallback(i=>{if(i){let l=()=>{let c=i.getBoundingClientRect().height;n(t,c)};l(),new MutationObserver(l).observe(i,{subtree:!0,childList:!0,characterData:!0})}},[t,n]);return X.createElement("div",{ref:a,className:e,style:r},s)},gB=(t,e)=>{let r=t.includes("top"),n=r?{top:0}:{bottom:0},s=t.includes("center")?{justifyContent:"center"}:t.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:Uj()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${e*(r?1:-1)}px)`,...n,...s}},xB=A2`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,D1=16,yB=({reverseOrder:t,position:e="top-center",toastOptions:r,gutter:n,children:s,containerStyle:a,containerClassName:i})=>{let{toasts:l,handlers:c}=HV(r);return X.createElement("div",{id:"_rht_toaster",style:{position:"fixed",zIndex:9999,top:D1,left:D1,right:D1,bottom:D1,pointerEvents:"none",...a},className:i,onMouseEnter:c.startPause,onMouseLeave:c.endPause},l.map(u=>{let d=u.position||e,f=c.calculateOffset(u,{reverseOrder:t,gutter:n,defaultPosition:e}),m=gB(d,f);return X.createElement(pB,{id:u.id,key:u.id,onHeightUpdate:c.updateHeight,className:u.visible?xB:"",style:m},u.type==="custom"?hv(u.message,u):s?s(u):X.createElement(mB,{toast:u,position:d}))}))},fe=Xr,mA={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zj=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let s=t.charCodeAt(n);s<128?e[r++]=s:s<2048?(e[r++]=s>>6|192,e[r++]=s&63|128):(s&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=s>>18|240,e[r++]=s>>12&63|128,e[r++]=s>>6&63|128,e[r++]=s&63|128):(e[r++]=s>>12|224,e[r++]=s>>6&63|128,e[r++]=s&63|128)}return e},vB=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const s=t[r++];if(s<128)e[n++]=String.fromCharCode(s);else if(s>191&&s<224){const a=t[r++];e[n++]=String.fromCharCode((s&31)<<6|a&63)}else if(s>239&&s<365){const a=t[r++],i=t[r++],l=t[r++],c=((s&7)<<18|(a&63)<<12|(i&63)<<6|l&63)-65536;e[n++]=String.fromCharCode(55296+(c>>10)),e[n++]=String.fromCharCode(56320+(c&1023))}else{const a=t[r++],i=t[r++];e[n++]=String.fromCharCode((s&15)<<12|(a&63)<<6|i&63)}}return e.join("")},qj={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let s=0;s<t.length;s+=3){const a=t[s],i=s+1<t.length,l=i?t[s+1]:0,c=s+2<t.length,u=c?t[s+2]:0,d=a>>2,f=(a&3)<<4|l>>4;let m=(l&15)<<2|u>>6,h=u&63;c||(h=64,i||(m=64)),n.push(r[d],r[f],r[m],r[h])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(zj(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):vB(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let s=0;s<t.length;){const a=r[t.charAt(s++)],l=s<t.length?r[t.charAt(s)]:0;++s;const u=s<t.length?r[t.charAt(s)]:64;++s;const f=s<t.length?r[t.charAt(s)]:64;if(++s,a==null||l==null||u==null||f==null)throw new bB;const m=a<<2|l>>4;if(n.push(m),u!==64){const h=l<<4&240|u>>2;if(n.push(h),f!==64){const g=u<<6&192|f;n.push(g)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class bB extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const wB=function(t){const e=zj(t);return qj.encodeByteArray(e,!0)},mv=function(t){return wB(t).replace(/\./g,"")},Wj=function(t){try{return qj.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _B(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NB=()=>_B().__FIREBASE_DEFAULTS__,SB=()=>{if(typeof process>"u"||typeof mA>"u")return;const t=mA.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},TB=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&Wj(t[1]);return e&&JSON.parse(e)},E2=()=>{try{return NB()||SB()||TB()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},Hj=t=>{var e,r;return(r=(e=E2())===null||e===void 0?void 0:e.emulatorHosts)===null||r===void 0?void 0:r[t]},Gj=t=>{const e=Hj(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},Kj=()=>{var t;return(t=E2())===null||t===void 0?void 0:t.config},Yj=t=>{var e;return(e=E2())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AB{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EB(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",s=t.iat||0,a=t.sub||t.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const i=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:s,exp:s+3600,auth_time:s,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}}},t);return[mv(JSON.stringify(r)),mv(JSON.stringify(i)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ws(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function CB(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ws())}function kB(){var t;const e=(t=E2())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function IB(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function jB(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function PB(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function RB(){const t=Ws();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function Xj(){return!kB()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Qj(){try{return typeof indexedDB=="object"}catch{return!1}}function DB(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(n);s.onsuccess=()=>{s.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},s.onupgradeneeded=()=>{r=!1},s.onerror=()=>{var a;e(((a=s.error)===null||a===void 0?void 0:a.message)||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FB="FirebaseError";class Gc extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=FB,Object.setPrototypeOf(this,Gc.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,xx.prototype.create)}}class xx{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},s=`${this.service}/${e}`,a=this.errors[e],i=a?LB(a,n):"Error",l=`${this.serviceName}: ${i} (${s}).`;return new Gc(s,l,n)}}function LB(t,e){return t.replace(OB,(r,n)=>{const s=e[n];return s!=null?String(s):`<${n}?>`})}const OB=/\{\$([^}]+)}/g;function MB(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function pv(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const s of r){if(!n.includes(s))return!1;const a=t[s],i=e[s];if(pA(a)&&pA(i)){if(!pv(a,i))return!1}else if(a!==i)return!1}for(const s of n)if(!r.includes(s))return!1;return!0}function pA(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yx(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(s=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function _p(t){const e={};return t.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[s,a]=n.split("=");e[decodeURIComponent(s)]=decodeURIComponent(a)}}),e}function Np(t){const e=t.indexOf("?");if(!e)return"";const r=t.indexOf("#",e);return t.substring(e,r>0?r:void 0)}function VB(t,e){const r=new BB(t,e);return r.subscribe.bind(r)}class BB{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let s;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");UB(e,["next","error","complete"])?s=e:s={next:e,error:r,complete:n},s.next===void 0&&(s.next=aw),s.error===void 0&&(s.error=aw),s.complete===void 0&&(s.complete=aw);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),a}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function UB(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function aw(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ds(t){return t&&t._delegate?t._delegate:t}class _d{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yf="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $B{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new AB;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:r});s&&n.resolve(s)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){var r;const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(r=e==null?void 0:e.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(a){if(s)return null;throw a}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(qB(e))try{this.getOrInitializeService({instanceIdentifier:yf})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(r);try{const a=this.getOrInitializeService({instanceIdentifier:s});n.resolve(a)}catch{}}}}clearInstance(e=yf){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=yf){return this.instances.has(e)}getOptions(e=yf){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[a,i]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(a);n===l&&i.resolve(s)}return s}onInit(e,r){var n;const s=this.normalizeInstanceIdentifier(r),a=(n=this.onInitCallbacks.get(s))!==null&&n!==void 0?n:new Set;a.add(e),this.onInitCallbacks.set(s,a);const i=this.instances.get(s);return i&&e(i,s),()=>{a.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const s of n)try{s(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:zB(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=yf){return this.component?this.component.multipleInstances?e:yf:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function zB(t){return t===yf?void 0:t}function qB(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WB{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new $B(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var $r;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})($r||($r={}));const HB={debug:$r.DEBUG,verbose:$r.VERBOSE,info:$r.INFO,warn:$r.WARN,error:$r.ERROR,silent:$r.SILENT},GB=$r.INFO,KB={[$r.DEBUG]:"log",[$r.VERBOSE]:"log",[$r.INFO]:"info",[$r.WARN]:"warn",[$r.ERROR]:"error"},YB=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),s=KB[e];if(s)console[s](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class m4{constructor(e){this.name=e,this._logLevel=GB,this._logHandler=YB,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in $r))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?HB[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,$r.DEBUG,...e),this._logHandler(this,$r.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,$r.VERBOSE,...e),this._logHandler(this,$r.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,$r.INFO,...e),this._logHandler(this,$r.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,$r.WARN,...e),this._logHandler(this,$r.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,$r.ERROR,...e),this._logHandler(this,$r.ERROR,...e)}}const XB=(t,e)=>e.some(r=>t instanceof r);let gA,xA;function QB(){return gA||(gA=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function JB(){return xA||(xA=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Jj=new WeakMap,Y5=new WeakMap,Zj=new WeakMap,iw=new WeakMap,p4=new WeakMap;function ZB(t){const e=new Promise((r,n)=>{const s=()=>{t.removeEventListener("success",a),t.removeEventListener("error",i)},a=()=>{r(fd(t.result)),s()},i=()=>{n(t.error),s()};t.addEventListener("success",a),t.addEventListener("error",i)});return e.then(r=>{r instanceof IDBCursor&&Jj.set(r,t)}).catch(()=>{}),p4.set(e,t),e}function eU(t){if(Y5.has(t))return;const e=new Promise((r,n)=>{const s=()=>{t.removeEventListener("complete",a),t.removeEventListener("error",i),t.removeEventListener("abort",i)},a=()=>{r(),s()},i=()=>{n(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",a),t.addEventListener("error",i),t.addEventListener("abort",i)});Y5.set(t,e)}let X5={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return Y5.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Zj.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return fd(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function tU(t){X5=t(X5)}function rU(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(ow(this),e,...r);return Zj.set(n,e.sort?e.sort():[e]),fd(n)}:JB().includes(t)?function(...e){return t.apply(ow(this),e),fd(Jj.get(this))}:function(...e){return fd(t.apply(ow(this),e))}}function nU(t){return typeof t=="function"?rU(t):(t instanceof IDBTransaction&&eU(t),XB(t,QB())?new Proxy(t,X5):t)}function fd(t){if(t instanceof IDBRequest)return ZB(t);if(iw.has(t))return iw.get(t);const e=nU(t);return e!==t&&(iw.set(t,e),p4.set(e,t)),e}const ow=t=>p4.get(t);function sU(t,e,{blocked:r,upgrade:n,blocking:s,terminated:a}={}){const i=indexedDB.open(t,e),l=fd(i);return n&&i.addEventListener("upgradeneeded",c=>{n(fd(i.result),c.oldVersion,c.newVersion,fd(i.transaction),c)}),r&&i.addEventListener("blocked",c=>r(c.oldVersion,c.newVersion,c)),l.then(c=>{a&&c.addEventListener("close",()=>a()),s&&c.addEventListener("versionchange",u=>s(u.oldVersion,u.newVersion,u))}).catch(()=>{}),l}const aU=["get","getKey","getAll","getAllKeys","count"],iU=["put","add","delete","clear"],lw=new Map;function yA(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(lw.get(e))return lw.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,s=iU.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(s||aU.includes(r)))return;const a=async function(i,...l){const c=this.transaction(i,s?"readwrite":"readonly");let u=c.store;return n&&(u=u.index(l.shift())),(await Promise.all([u[r](...l),s&&c.done]))[0]};return lw.set(e,a),a}tU(t=>({...t,get:(e,r,n)=>yA(e,r)||t.get(e,r,n),has:(e,r)=>!!yA(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oU{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(lU(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function lU(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Q5="@firebase/app",vA="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mc=new m4("@firebase/app"),cU="@firebase/app-compat",uU="@firebase/analytics-compat",dU="@firebase/analytics",fU="@firebase/app-check-compat",hU="@firebase/app-check",mU="@firebase/auth",pU="@firebase/auth-compat",gU="@firebase/database",xU="@firebase/data-connect",yU="@firebase/database-compat",vU="@firebase/functions",bU="@firebase/functions-compat",wU="@firebase/installations",_U="@firebase/installations-compat",NU="@firebase/messaging",SU="@firebase/messaging-compat",TU="@firebase/performance",AU="@firebase/performance-compat",EU="@firebase/remote-config",CU="@firebase/remote-config-compat",kU="@firebase/storage",IU="@firebase/storage-compat",jU="@firebase/firestore",PU="@firebase/vertexai-preview",RU="@firebase/firestore-compat",DU="firebase",FU="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J5="[DEFAULT]",LU={[Q5]:"fire-core",[cU]:"fire-core-compat",[dU]:"fire-analytics",[uU]:"fire-analytics-compat",[hU]:"fire-app-check",[fU]:"fire-app-check-compat",[mU]:"fire-auth",[pU]:"fire-auth-compat",[gU]:"fire-rtdb",[xU]:"fire-data-connect",[yU]:"fire-rtdb-compat",[vU]:"fire-fn",[bU]:"fire-fn-compat",[wU]:"fire-iid",[_U]:"fire-iid-compat",[NU]:"fire-fcm",[SU]:"fire-fcm-compat",[TU]:"fire-perf",[AU]:"fire-perf-compat",[EU]:"fire-rc",[CU]:"fire-rc-compat",[kU]:"fire-gcs",[IU]:"fire-gcs-compat",[jU]:"fire-fst",[RU]:"fire-fst-compat",[PU]:"fire-vertex","fire-js":"fire-js",[DU]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gv=new Map,OU=new Map,Z5=new Map;function bA(t,e){try{t.container.addComponent(e)}catch(r){Mc.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function Gf(t){const e=t.name;if(Z5.has(e))return Mc.debug(`There were multiple attempts to register component ${e}.`),!1;Z5.set(e,t);for(const r of gv.values())bA(r,t);for(const r of OU.values())bA(r,t);return!0}function C2(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function Il(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MU={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},hd=new xx("app","Firebase",MU);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VU{constructor(e,r,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new _d("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw hd.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Am=FU;function eP(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n=Object.assign({name:J5,automaticDataCollectionEnabled:!1},e),s=n.name;if(typeof s!="string"||!s)throw hd.create("bad-app-name",{appName:String(s)});if(r||(r=Kj()),!r)throw hd.create("no-options");const a=gv.get(s);if(a){if(pv(r,a.options)&&pv(n,a.config))return a;throw hd.create("duplicate-app",{appName:s})}const i=new WB(s);for(const c of Z5.values())i.addComponent(c);const l=new VU(r,n,i);return gv.set(s,l),l}function g4(t=J5){const e=gv.get(t);if(!e&&t===J5&&Kj())return eP();if(!e)throw hd.create("no-app",{appName:t});return e}function Ml(t,e,r){var n;let s=(n=LU[t])!==null&&n!==void 0?n:t;r&&(s+=`-${r}`);const a=s.match(/\s|\//),i=e.match(/\s|\//);if(a||i){const l=[`Unable to register library "${s}" with version "${e}":`];a&&l.push(`library name "${s}" contains illegal characters (whitespace or "/")`),a&&i&&l.push("and"),i&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Mc.warn(l.join(" "));return}Gf(new _d(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BU="firebase-heartbeat-database",UU=1,kg="firebase-heartbeat-store";let cw=null;function tP(){return cw||(cw=sU(BU,UU,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(kg)}catch(r){console.warn(r)}}}}).catch(t=>{throw hd.create("idb-open",{originalErrorMessage:t.message})})),cw}async function $U(t){try{const r=(await tP()).transaction(kg),n=await r.objectStore(kg).get(rP(t));return await r.done,n}catch(e){if(e instanceof Gc)Mc.warn(e.message);else{const r=hd.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Mc.warn(r.message)}}}async function wA(t,e){try{const n=(await tP()).transaction(kg,"readwrite");await n.objectStore(kg).put(e,rP(t)),await n.done}catch(r){if(r instanceof Gc)Mc.warn(r.message);else{const n=hd.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});Mc.warn(n.message)}}}function rP(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zU=1024,qU=30*24*60*60*1e3;class WU{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new GU(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),a=_A();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===a||this._heartbeatsCache.heartbeats.some(i=>i.date===a)?void 0:(this._heartbeatsCache.heartbeats.push({date:a,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(i=>{const l=new Date(i.date).valueOf();return Date.now()-l<=qU}),this._storage.overwrite(this._heartbeatsCache))}catch(n){Mc.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=_A(),{heartbeatsToSend:n,unsentEntries:s}=HU(this._heartbeatsCache.heartbeats),a=mv(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(r){return Mc.warn(r),""}}}function _A(){return new Date().toISOString().substring(0,10)}function HU(t,e=zU){const r=[];let n=t.slice();for(const s of t){const a=r.find(i=>i.agent===s.agent);if(a){if(a.dates.push(s.date),NA(r)>e){a.dates.pop();break}}else if(r.push({agent:s.agent,dates:[s.date]}),NA(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class GU{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Qj()?DB().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await $U(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var r;if(await this._canUseIndexedDBPromise){const s=await this.read();return wA(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var r;if(await this._canUseIndexedDBPromise){const s=await this.read();return wA(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function NA(t){return mv(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KU(t){Gf(new _d("platform-logger",e=>new oU(e),"PRIVATE")),Gf(new _d("heartbeat",e=>new WU(e),"PRIVATE")),Ml(Q5,vA,t),Ml(Q5,vA,"esm2017"),Ml("fire-js","")}KU("");var YU="firebase",XU="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ml(YU,XU,"app");function x4(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r}function nP(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const QU=nP,sP=new xx("auth","Firebase",nP());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xv=new m4("@firebase/auth");function JU(t,...e){xv.logLevel<=$r.WARN&&xv.warn(`Auth (${Am}): ${t}`,...e)}function wy(t,...e){xv.logLevel<=$r.ERROR&&xv.error(`Auth (${Am}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ol(t,...e){throw y4(t,...e)}function Vl(t,...e){return y4(t,...e)}function aP(t,e,r){const n=Object.assign(Object.assign({},QU()),{[e]:r});return new xx("auth","Firebase",n).create(e,{appName:t.name})}function Ec(t){return aP(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function y4(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return sP.create(t,...e)}function Sr(t,e,...r){if(!t)throw y4(e,...r)}function bc(t){const e="INTERNAL ASSERTION FAILED: "+t;throw wy(e),new Error(e)}function Vc(t,e){t||bc(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e_(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function ZU(){return SA()==="http:"||SA()==="https:"}function SA(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e$(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(ZU()||jB()||"connection"in navigator)?navigator.onLine:!0}function t$(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vx{constructor(e,r){this.shortDelay=e,this.longDelay=r,Vc(r>e,"Short delay should be less than long delay!"),this.isMobile=CB()||PB()}get(){return e$()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v4(t,e){Vc(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iP{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;bc("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;bc("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;bc("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r$={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n$=new vx(3e4,6e4);function zd(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function qd(t,e,r,n,s={}){return oP(t,s,async()=>{let a={},i={};n&&(e==="GET"?i=n:a={body:JSON.stringify(n)});const l=yx(Object.assign({key:t.config.apiKey},i)).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const u=Object.assign({method:e,headers:c},a);return IB()||(u.referrerPolicy="no-referrer"),iP.fetch()(lP(t,t.config.apiHost,r,l),u)})}async function oP(t,e,r){t._canInitEmulator=!1;const n=Object.assign(Object.assign({},r$),e);try{const s=new a$(t),a=await Promise.race([r(),s.promise]);s.clearNetworkTimeout();const i=await a.json();if("needConfirmation"in i)throw F1(t,"account-exists-with-different-credential",i);if(a.ok&&!("errorMessage"in i))return i;{const l=a.ok?i.errorMessage:i.error.message,[c,u]=l.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw F1(t,"credential-already-in-use",i);if(c==="EMAIL_EXISTS")throw F1(t,"email-already-in-use",i);if(c==="USER_DISABLED")throw F1(t,"user-disabled",i);const d=n[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw aP(t,d,u);ol(t,d)}}catch(s){if(s instanceof Gc)throw s;ol(t,"network-request-failed",{message:String(s)})}}async function bx(t,e,r,n,s={}){const a=await qd(t,e,r,n,s);return"mfaPendingCredential"in a&&ol(t,"multi-factor-auth-required",{_serverResponse:a}),a}function lP(t,e,r,n){const s=`${e}${r}?${n}`;return t.config.emulator?v4(t.config,s):`${t.config.apiScheme}://${s}`}function s$(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class a${constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(Vl(this.auth,"network-request-failed")),n$.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function F1(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const s=Vl(t,e,n);return s.customData._tokenResponse=r,s}function TA(t){return t!==void 0&&t.enterprise!==void 0}class i${constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const r of this.recaptchaEnforcementState)if(r.provider&&r.provider===e)return s$(r.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function o$(t,e){return qd(t,"GET","/v2/recaptchaConfig",zd(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function l$(t,e){return qd(t,"POST","/v1/accounts:delete",e)}async function cP(t,e){return qd(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zp(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function c$(t,e=!1){const r=ds(t),n=await r.getIdToken(e),s=b4(n);Sr(s&&s.exp&&s.auth_time&&s.iat,r.auth,"internal-error");const a=typeof s.firebase=="object"?s.firebase:void 0,i=a==null?void 0:a.sign_in_provider;return{claims:s,token:n,authTime:zp(uw(s.auth_time)),issuedAtTime:zp(uw(s.iat)),expirationTime:zp(uw(s.exp)),signInProvider:i||null,signInSecondFactor:(a==null?void 0:a.sign_in_second_factor)||null}}function uw(t){return Number(t)*1e3}function b4(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return wy("JWT malformed, contained fewer than 3 sections"),null;try{const s=Wj(r);return s?JSON.parse(s):(wy("Failed to decode base64 JWT payload"),null)}catch(s){return wy("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function AA(t){const e=b4(t);return Sr(e,"internal-error"),Sr(typeof e.exp<"u","internal-error"),Sr(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ig(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof Gc&&u$(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function u$({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d${constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var r;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const s=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t_{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=zp(this.lastLoginAt),this.creationTime=zp(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yv(t){var e;const r=t.auth,n=await t.getIdToken(),s=await Ig(t,cP(r,{idToken:n}));Sr(s==null?void 0:s.users.length,r,"internal-error");const a=s.users[0];t._notifyReloadListener(a);const i=!((e=a.providerUserInfo)===null||e===void 0)&&e.length?uP(a.providerUserInfo):[],l=h$(t.providerData,i),c=t.isAnonymous,u=!(t.email&&a.passwordHash)&&!(l!=null&&l.length),d=c?u:!1,f={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:l,metadata:new t_(a.createdAt,a.lastLoginAt),isAnonymous:d};Object.assign(t,f)}async function f$(t){const e=ds(t);await yv(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function h$(t,e){return[...t.filter(n=>!e.some(s=>s.providerId===n.providerId)),...e]}function uP(t){return t.map(e=>{var{providerId:r}=e,n=x4(e,["providerId"]);return{providerId:r,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function m$(t,e){const r=await oP(t,{},async()=>{const n=yx({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:a}=t.config,i=lP(t,s,"/v1/token",`key=${a}`),l=await t._getAdditionalHeaders();return l["Content-Type"]="application/x-www-form-urlencoded",iP.fetch()(i,{method:"POST",headers:l,body:n})});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function p$(t,e){return qd(t,"POST","/v2/accounts:revokeToken",zd(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L0{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Sr(e.idToken,"internal-error"),Sr(typeof e.idToken<"u","internal-error"),Sr(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):AA(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){Sr(e.length!==0,"internal-error");const r=AA(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(Sr(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:s,expiresIn:a}=await m$(e,r);this.updateTokensAndExpiration(n,s,Number(a))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:s,expirationTime:a}=r,i=new L0;return n&&(Sr(typeof n=="string","internal-error",{appName:e}),i.refreshToken=n),s&&(Sr(typeof s=="string","internal-error",{appName:e}),i.accessToken=s),a&&(Sr(typeof a=="number","internal-error",{appName:e}),i.expirationTime=a),i}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new L0,this.toJSON())}_performRefresh(){return bc("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cu(t,e){Sr(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class wc{constructor(e){var{uid:r,auth:n,stsTokenManager:s}=e,a=x4(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new d$(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=n,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?[...a.providerData]:[],this.metadata=new t_(a.createdAt||void 0,a.lastLoginAt||void 0)}async getIdToken(e){const r=await Ig(this,this.stsTokenManager.getToken(this.auth,e));return Sr(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return c$(this,e)}reload(){return f$(this)}_assign(e){this!==e&&(Sr(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>Object.assign({},r)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new wc(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(e){Sr(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await yv(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Il(this.auth.app))return Promise.reject(Ec(this.auth));const e=await this.getIdToken();return await Ig(this,l$(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){var n,s,a,i,l,c,u,d;const f=(n=r.displayName)!==null&&n!==void 0?n:void 0,m=(s=r.email)!==null&&s!==void 0?s:void 0,h=(a=r.phoneNumber)!==null&&a!==void 0?a:void 0,g=(i=r.photoURL)!==null&&i!==void 0?i:void 0,p=(l=r.tenantId)!==null&&l!==void 0?l:void 0,v=(c=r._redirectEventId)!==null&&c!==void 0?c:void 0,b=(u=r.createdAt)!==null&&u!==void 0?u:void 0,w=(d=r.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:N,emailVerified:j,isAnonymous:F,providerData:U,stsTokenManager:A}=r;Sr(N&&A,e,"internal-error");const S=L0.fromJSON(this.name,A);Sr(typeof N=="string",e,"internal-error"),Cu(f,e.name),Cu(m,e.name),Sr(typeof j=="boolean",e,"internal-error"),Sr(typeof F=="boolean",e,"internal-error"),Cu(h,e.name),Cu(g,e.name),Cu(p,e.name),Cu(v,e.name),Cu(b,e.name),Cu(w,e.name);const k=new wc({uid:N,auth:e,email:m,emailVerified:j,displayName:f,isAnonymous:F,photoURL:g,phoneNumber:h,tenantId:p,stsTokenManager:S,createdAt:b,lastLoginAt:w});return U&&Array.isArray(U)&&(k.providerData=U.map(M=>Object.assign({},M))),v&&(k._redirectEventId=v),k}static async _fromIdTokenResponse(e,r,n=!1){const s=new L0;s.updateFromServerResponse(r);const a=new wc({uid:r.localId,auth:e,stsTokenManager:s,isAnonymous:n});return await yv(a),a}static async _fromGetAccountInfoResponse(e,r,n){const s=r.users[0];Sr(s.localId!==void 0,"internal-error");const a=s.providerUserInfo!==void 0?uP(s.providerUserInfo):[],i=!(s.email&&s.passwordHash)&&!(a!=null&&a.length),l=new L0;l.updateFromIdToken(n);const c=new wc({uid:s.localId,auth:e,stsTokenManager:l,isAnonymous:i}),u={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new t_(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(a!=null&&a.length)};return Object.assign(c,u),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EA=new Map;function _c(t){Vc(t instanceof Function,"Expected a class definition");let e=EA.get(t);return e?(Vc(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,EA.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dP{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}dP.type="NONE";const CA=dP;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _y(t,e,r){return`firebase:${t}:${e}:${r}`}class O0{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:s,name:a}=this.auth;this.fullUserKey=_y(this.userKey,s.apiKey,a),this.fullPersistenceKey=_y("persistence",s.apiKey,a),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?wc._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new O0(_c(CA),e,n);const s=(await Promise.all(r.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let a=s[0]||_c(CA);const i=_y(n,e.config.apiKey,e.name);let l=null;for(const u of r)try{const d=await u._get(i);if(d){const f=wc._fromJSON(e,d);u!==a&&(l=f),a=u;break}}catch{}const c=s.filter(u=>u._shouldAllowMigration);return!a._shouldAllowMigration||!c.length?new O0(a,e,n):(a=c[0],l&&await a._set(i,l.toJSON()),await Promise.all(r.map(async u=>{if(u!==a)try{await u._remove(i)}catch{}})),new O0(a,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kA(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(pP(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(fP(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(xP(e))return"Blackberry";if(yP(e))return"Webos";if(hP(e))return"Safari";if((e.includes("chrome/")||mP(e))&&!e.includes("edge/"))return"Chrome";if(gP(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function fP(t=Ws()){return/firefox\//i.test(t)}function hP(t=Ws()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function mP(t=Ws()){return/crios\//i.test(t)}function pP(t=Ws()){return/iemobile/i.test(t)}function gP(t=Ws()){return/android/i.test(t)}function xP(t=Ws()){return/blackberry/i.test(t)}function yP(t=Ws()){return/webos/i.test(t)}function w4(t=Ws()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function g$(t=Ws()){var e;return w4(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function x$(){return RB()&&document.documentMode===10}function vP(t=Ws()){return w4(t)||gP(t)||yP(t)||xP(t)||/windows phone/i.test(t)||pP(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bP(t,e=[]){let r;switch(t){case"Browser":r=kA(Ws());break;case"Worker":r=`${kA(Ws())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${Am}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y${constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=a=>new Promise((i,l)=>{try{const c=e(a);i(c)}catch(c){l(c)}});n.onAbort=r,this.queue.push(n);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const s of r)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function v$(t,e={}){return qd(t,"GET","/v2/passwordPolicy",zd(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b$=6;class w${constructor(e){var r,n,s,a;const i=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(r=i.minPasswordLength)!==null&&r!==void 0?r:b$,i.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=i.maxPasswordLength),i.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=i.containsLowercaseCharacter),i.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=i.containsUppercaseCharacter),i.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=i.containsNumericCharacter),i.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=i.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(n=e.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(a=e.forceUpgradeOnSignin)!==null&&a!==void 0?a:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var r,n,s,a,i,l;const c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(r=c.meetsMinPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(n=c.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),c.isValid&&(c.isValid=(s=c.containsLowercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(a=c.containsUppercaseLetter)!==null&&a!==void 0?a:!0),c.isValid&&(c.isValid=(i=c.containsNumericCharacter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(l=c.containsNonAlphanumericCharacter)!==null&&l!==void 0?l:!0),c}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),s&&(r.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let s=0;s<e.length;s++)n=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,s,a){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _${constructor(e,r,n,s){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new IA(this),this.idTokenSubscription=new IA(this),this.beforeStateQueue=new y$(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=sP,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=_c(r)),this._initializationPromise=this.queue(async()=>{var n,s;if(!this._deleted&&(this.persistenceManager=await O0.create(this,e),!this._deleted)){if(!((n=this._popupRedirectResolver)===null||n===void 0)&&n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await cP(this,{idToken:e}),n=await wc._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var r;if(Il(this.app)){const i=this.app.settings.authIdToken;return i?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(i).then(l,l))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let s=n,a=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const i=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,l=s==null?void 0:s._redirectEventId,c=await this.tryRedirectSignIn(e);(!i||i===l)&&(c!=null&&c.user)&&(s=c.user,a=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(a)try{await this.beforeStateQueue.runMiddleware(s)}catch(i){s=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(i))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return Sr(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await yv(e)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=t$()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Il(this.app))return Promise.reject(Ec(this));const r=e?ds(e):null;return r&&Sr(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&Sr(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Il(this.app)?Promise.reject(Ec(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Il(this.app)?Promise.reject(Ec(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(_c(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await v$(this),r=new w$(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new xx("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await p$(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&_c(e)||this._popupRedirectResolver;Sr(r,this,"argument-error"),this.redirectPersistenceManager=await O0.create(this,[_c(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(r=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,s){if(this._deleted)return()=>{};const a=typeof r=="function"?r:r.next.bind(r);let i=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(Sr(l,this,"internal-error"),l.then(()=>{i||a(this.currentUser)}),typeof r=="function"){const c=e.addObserver(r,n,s);return()=>{i=!0,c()}}else{const c=e.addObserver(r);return()=>{i=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Sr(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=bP(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);const n=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());n&&(r["X-Firebase-Client"]=n);const s=await this._getAppCheckToken();return s&&(r["X-Firebase-AppCheck"]=s),r}async _getAppCheckToken(){var e;const r=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return r!=null&&r.error&&JU(`Error while retrieving App Check token: ${r.error}`),r==null?void 0:r.token}}function ph(t){return ds(t)}class IA{constructor(e){this.auth=e,this.observer=null,this.addObserver=VB(r=>this.observer=r)}get next(){return Sr(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let k2={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function N$(t){k2=t}function wP(t){return k2.loadJS(t)}function S$(){return k2.recaptchaEnterpriseScript}function T$(){return k2.gapiScript}function A$(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const E$="recaptcha-enterprise",C$="NO_RECAPTCHA";class k${constructor(e){this.type=E$,this.auth=ph(e)}async verify(e="verify",r=!1){async function n(a){if(!r){if(a.tenantId==null&&a._agentRecaptchaConfig!=null)return a._agentRecaptchaConfig.siteKey;if(a.tenantId!=null&&a._tenantRecaptchaConfigs[a.tenantId]!==void 0)return a._tenantRecaptchaConfigs[a.tenantId].siteKey}return new Promise(async(i,l)=>{o$(a,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)l(new Error("recaptcha Enterprise site key undefined"));else{const u=new i$(c);return a.tenantId==null?a._agentRecaptchaConfig=u:a._tenantRecaptchaConfigs[a.tenantId]=u,i(u.siteKey)}}).catch(c=>{l(c)})})}function s(a,i,l){const c=window.grecaptcha;TA(c)?c.enterprise.ready(()=>{c.enterprise.execute(a,{action:e}).then(u=>{i(u)}).catch(()=>{i(C$)})}):l(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((a,i)=>{n(this.auth).then(l=>{if(!r&&TA(window.grecaptcha))s(l,a,i);else{if(typeof window>"u"){i(new Error("RecaptchaVerifier is only supported in browser"));return}let c=S$();c.length!==0&&(c+=l),wP(c).then(()=>{s(l,a,i)}).catch(u=>{i(u)})}}).catch(l=>{i(l)})})}}async function jA(t,e,r,n=!1){const s=new k$(t);let a;try{a=await s.verify(r)}catch{a=await s.verify(r,!0)}const i=Object.assign({},e);return n?Object.assign(i,{captchaResp:a}):Object.assign(i,{captchaResponse:a}),Object.assign(i,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(i,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),i}async function r_(t,e,r,n){var s;if(!((s=t._getRecaptchaConfig())===null||s===void 0)&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await jA(t,e,r,r==="getOobCode");return n(t,a)}else return n(t,e).catch(async a=>{if(a.code==="auth/missing-recaptcha-token"){console.log(`${r} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const i=await jA(t,e,r,r==="getOobCode");return n(t,i)}else return Promise.reject(a)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I$(t,e){const r=C2(t,"auth");if(r.isInitialized()){const s=r.getImmediate(),a=r.getOptions();if(pv(a,e??{}))return s;ol(s,"already-initialized")}return r.initialize({options:e})}function j$(t,e){const r=(e==null?void 0:e.persistence)||[],n=(Array.isArray(r)?r:[r]).map(_c);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function P$(t,e,r){const n=ph(t);Sr(n._canInitEmulator,n,"emulator-config-failed"),Sr(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const s=!1,a=_P(e),{host:i,port:l}=R$(e),c=l===null?"":`:${l}`;n.config.emulator={url:`${a}//${i}${c}/`},n.settings.appVerificationDisabledForTesting=!0,n.emulatorConfig=Object.freeze({host:i,port:l,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:s})}),D$()}function _P(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function R$(t){const e=_P(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(n);if(s){const a=s[1];return{host:a,port:PA(n.substr(a.length+1))}}else{const[a,i]=n.split(":");return{host:a,port:PA(i)}}}function PA(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function D$(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _4{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return bc("not implemented")}_getIdTokenResponse(e){return bc("not implemented")}_linkToIdToken(e,r){return bc("not implemented")}_getReauthenticationResolver(e){return bc("not implemented")}}async function F$(t,e){return qd(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function L$(t,e){return bx(t,"POST","/v1/accounts:signInWithPassword",zd(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function O$(t,e){return bx(t,"POST","/v1/accounts:signInWithEmailLink",zd(t,e))}async function M$(t,e){return bx(t,"POST","/v1/accounts:signInWithEmailLink",zd(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jg extends _4{constructor(e,r,n,s=null){super("password",n),this._email=e,this._password=r,this._tenantId=s}static _fromEmailAndPassword(e,r){return new jg(e,r,"password")}static _fromEmailAndCode(e,r,n=null){return new jg(e,r,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e;if(r!=null&&r.email&&(r!=null&&r.password)){if(r.signInMethod==="password")return this._fromEmailAndPassword(r.email,r.password);if(r.signInMethod==="emailLink")return this._fromEmailAndCode(r.email,r.password,r.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const r={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return r_(e,r,"signInWithPassword",L$);case"emailLink":return O$(e,{email:this._email,oobCode:this._password});default:ol(e,"internal-error")}}async _linkToIdToken(e,r){switch(this.signInMethod){case"password":const n={idToken:r,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return r_(e,n,"signUpPassword",F$);case"emailLink":return M$(e,{idToken:r,email:this._email,oobCode:this._password});default:ol(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function M0(t,e){return bx(t,"POST","/v1/accounts:signInWithIdp",zd(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V$="http://localhost";class Kf extends _4{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new Kf(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):ol("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:s}=r,a=x4(r,["providerId","signInMethod"]);if(!n||!s)return null;const i=new Kf(n,s);return i.idToken=a.idToken||void 0,i.accessToken=a.accessToken||void 0,i.secret=a.secret,i.nonce=a.nonce,i.pendingToken=a.pendingToken||null,i}_getIdTokenResponse(e){const r=this.buildRequest();return M0(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,M0(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,M0(e,r)}buildRequest(){const e={requestUri:V$,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=yx(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B$(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function U$(t){const e=_p(Np(t)).link,r=e?_p(Np(e)).deep_link_id:null,n=_p(Np(t)).deep_link_id;return(n?_p(Np(n)).link:null)||n||r||e||t}class N4{constructor(e){var r,n,s,a,i,l;const c=_p(Np(e)),u=(r=c.apiKey)!==null&&r!==void 0?r:null,d=(n=c.oobCode)!==null&&n!==void 0?n:null,f=B$((s=c.mode)!==null&&s!==void 0?s:null);Sr(u&&d&&f,"argument-error"),this.apiKey=u,this.operation=f,this.code=d,this.continueUrl=(a=c.continueUrl)!==null&&a!==void 0?a:null,this.languageCode=(i=c.languageCode)!==null&&i!==void 0?i:null,this.tenantId=(l=c.tenantId)!==null&&l!==void 0?l:null}static parseLink(e){const r=U$(e);try{return new N4(r)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Em{constructor(){this.providerId=Em.PROVIDER_ID}static credential(e,r){return jg._fromEmailAndPassword(e,r)}static credentialWithLink(e,r){const n=N4.parseLink(r);return Sr(n,"argument-error"),jg._fromEmailAndCode(e,n.code,n.tenantId)}}Em.PROVIDER_ID="password";Em.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Em.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NP{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wx extends NP{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uu extends wx{constructor(){super("facebook.com")}static credential(e){return Kf._fromParams({providerId:Uu.PROVIDER_ID,signInMethod:Uu.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Uu.credentialFromTaggedObject(e)}static credentialFromError(e){return Uu.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Uu.credential(e.oauthAccessToken)}catch{return null}}}Uu.FACEBOOK_SIGN_IN_METHOD="facebook.com";Uu.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $u extends wx{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return Kf._fromParams({providerId:$u.PROVIDER_ID,signInMethod:$u.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return $u.credentialFromTaggedObject(e)}static credentialFromError(e){return $u.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return $u.credential(r,n)}catch{return null}}}$u.GOOGLE_SIGN_IN_METHOD="google.com";$u.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zu extends wx{constructor(){super("github.com")}static credential(e){return Kf._fromParams({providerId:zu.PROVIDER_ID,signInMethod:zu.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return zu.credentialFromTaggedObject(e)}static credentialFromError(e){return zu.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return zu.credential(e.oauthAccessToken)}catch{return null}}}zu.GITHUB_SIGN_IN_METHOD="github.com";zu.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qu extends wx{constructor(){super("twitter.com")}static credential(e,r){return Kf._fromParams({providerId:qu.PROVIDER_ID,signInMethod:qu.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return qu.credentialFromTaggedObject(e)}static credentialFromError(e){return qu.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return qu.credential(r,n)}catch{return null}}}qu.TWITTER_SIGN_IN_METHOD="twitter.com";qu.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $$(t,e){return bx(t,"POST","/v1/accounts:signUp",zd(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yf{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,s=!1){const a=await wc._fromIdTokenResponse(e,n,s),i=RA(n);return new Yf({user:a,providerId:i,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const s=RA(n);return new Yf({user:e,providerId:s,_tokenResponse:n,operationType:r})}}function RA(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vv extends Gc{constructor(e,r,n,s){var a;super(r.code,r.message),this.operationType=n,this.user=s,Object.setPrototypeOf(this,vv.prototype),this.customData={appName:e.name,tenantId:(a=e.tenantId)!==null&&a!==void 0?a:void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,s){return new vv(e,r,n,s)}}function SP(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(a=>{throw a.code==="auth/multi-factor-auth-required"?vv._fromErrorAndOperation(t,a,e,n):a})}async function z$(t,e,r=!1){const n=await Ig(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return Yf._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function q$(t,e,r=!1){const{auth:n}=t;if(Il(n.app))return Promise.reject(Ec(n));const s="reauthenticate";try{const a=await Ig(t,SP(n,s,e,t),r);Sr(a.idToken,n,"internal-error");const i=b4(a.idToken);Sr(i,n,"internal-error");const{sub:l}=i;return Sr(t.uid===l,n,"user-mismatch"),Yf._forOperation(t,s,a)}catch(a){throw(a==null?void 0:a.code)==="auth/user-not-found"&&ol(n,"user-mismatch"),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function TP(t,e,r=!1){if(Il(t.app))return Promise.reject(Ec(t));const n="signIn",s=await SP(t,n,e),a=await Yf._fromIdTokenResponse(t,n,s);return r||await t._updateCurrentUser(a.user),a}async function W$(t,e){return TP(ph(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function AP(t){const e=ph(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function EP(t,e,r){if(Il(t.app))return Promise.reject(Ec(t));const n=ph(t),i=await r_(n,{returnSecureToken:!0,email:e,password:r,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",$$).catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&AP(t),c}),l=await Yf._fromIdTokenResponse(n,"signIn",i);return await n._updateCurrentUser(l.user),l}function n_(t,e,r){return Il(t.app)?Promise.reject(Ec(t)):W$(ds(t),Em.credential(e,r)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&AP(t),n})}function H$(t,e,r,n){return ds(t).onIdTokenChanged(e,r,n)}function G$(t,e,r){return ds(t).beforeAuthStateChanged(e,r)}function Hh(t){return ds(t).signOut()}const bv="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CP{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(bv,"1"),this.storage.removeItem(bv),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K$=1e3,Y$=10;class kP extends CP{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=vP(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),s=this.localCache[r];n!==s&&e(r,s,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((i,l,c)=>{this.notifyListeners(i,c)});return}const n=e.key;r?this.detachListener():this.stopPolling();const s=()=>{const i=this.storage.getItem(n);!r&&this.localCache[n]===i||this.notifyListeners(n,i)},a=this.storage.getItem(n);x$()&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,Y$):s()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},K$)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}kP.type="LOCAL";const X$=kP;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IP extends CP{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}IP.type="SESSION";const jP=IP;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q$(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I2{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(s=>s.isListeningto(e));if(r)return r;const n=new I2(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:s,data:a}=r.data,i=this.handlersMap[s];if(!(i!=null&&i.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:s});const l=Array.from(i).map(async u=>u(r.origin,a)),c=await Q$(l);r.ports[0].postMessage({status:"done",eventId:n,eventType:s,response:c})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}I2.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S4(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J${constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let a,i;return new Promise((l,c)=>{const u=S4("",20);s.port1.start();const d=setTimeout(()=>{c(new Error("unsupported_event"))},n);i={messageChannel:s,onMessage(f){const m=f;if(m.data.eventId===u)switch(m.data.status){case"ack":clearTimeout(d),a=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),l(m.data.response);break;default:clearTimeout(d),clearTimeout(a),c(new Error("invalid_response"));break}}},this.handlers.add(i),s.port1.addEventListener("message",i.onMessage),this.target.postMessage({eventType:e,eventId:u,data:r},[s.port2])}).finally(()=>{i&&this.removeMessageHandler(i)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bl(){return window}function Z$(t){Bl().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PP(){return typeof Bl().WorkerGlobalScope<"u"&&typeof Bl().importScripts=="function"}async function ez(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function tz(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function rz(){return PP()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RP="firebaseLocalStorageDb",nz=1,wv="firebaseLocalStorage",DP="fbase_key";class _x{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function j2(t,e){return t.transaction([wv],e?"readwrite":"readonly").objectStore(wv)}function sz(){const t=indexedDB.deleteDatabase(RP);return new _x(t).toPromise()}function s_(){const t=indexedDB.open(RP,nz);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(wv,{keyPath:DP})}catch(s){r(s)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(wv)?e(n):(n.close(),await sz(),e(await s_()))})})}async function DA(t,e,r){const n=j2(t,!0).put({[DP]:e,value:r});return new _x(n).toPromise()}async function az(t,e){const r=j2(t,!1).get(e),n=await new _x(r).toPromise();return n===void 0?null:n.value}function FA(t,e){const r=j2(t,!0).delete(e);return new _x(r).toPromise()}const iz=800,oz=3;class FP{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await s_(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>oz)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return PP()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=I2._getInstance(rz()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var e,r;if(this.activeServiceWorker=await ez(),!this.activeServiceWorker)return;this.sender=new J$(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&!((e=n[0])===null||e===void 0)&&e.fulfilled&&!((r=n[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||tz()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await s_();return await DA(e,bv,"1"),await FA(e,bv),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>DA(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>az(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>FA(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const a=j2(s,!1).getAll();return new _x(a).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:s,value:a}of e)n.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(a)&&(this.notifyListeners(s,a),r.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!n.has(s)&&(this.notifyListeners(s,null),r.push(s));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),iz)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}FP.type="LOCAL";const lz=FP;new vx(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cz(t,e){return e?_c(e):(Sr(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T4 extends _4{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return M0(e,this._buildIdpRequest())}_linkToIdToken(e,r){return M0(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return M0(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function uz(t){return TP(t.auth,new T4(t),t.bypassAuthState)}function dz(t){const{auth:e,user:r}=t;return Sr(r,e,"internal-error"),q$(r,new T4(t),t.bypassAuthState)}async function fz(t){const{auth:e,user:r}=t;return Sr(r,e,"internal-error"),z$(r,new T4(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LP{constructor(e,r,n,s,a=!1){this.auth=e,this.resolver=n,this.user=s,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:s,tenantId:a,error:i,type:l}=e;if(i){this.reject(i);return}const c={auth:this.auth,requestUri:r,sessionId:n,tenantId:a||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(c))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return uz;case"linkViaPopup":case"linkViaRedirect":return fz;case"reauthViaPopup":case"reauthViaRedirect":return dz;default:ol(this.auth,"internal-error")}}resolve(e){Vc(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Vc(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hz=new vx(2e3,1e4);class E0 extends LP{constructor(e,r,n,s,a){super(e,r,s,a),this.provider=n,this.authWindow=null,this.pollId=null,E0.currentPopupAction&&E0.currentPopupAction.cancel(),E0.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Sr(e,this.auth,"internal-error"),e}async onExecution(){Vc(this.filter.length===1,"Popup operations only handle one event");const e=S4();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(Vl(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Vl(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,E0.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,n;if(!((n=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Vl(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,hz.get())};e()}}E0.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mz="pendingRedirect",Ny=new Map;class pz extends LP{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=Ny.get(this.auth._key());if(!e){try{const n=await gz(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}Ny.set(this.auth._key(),e)}return this.bypassAuthState||Ny.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function gz(t,e){const r=vz(e),n=yz(t);if(!await n._isAvailable())return!1;const s=await n._get(r)==="true";return await n._remove(r),s}function xz(t,e){Ny.set(t._key(),e)}function yz(t){return _c(t._redirectPersistence)}function vz(t){return _y(mz,t.config.apiKey,t.name)}async function bz(t,e,r=!1){if(Il(t.app))return Promise.reject(Ec(t));const n=ph(t),s=cz(n,e),i=await new pz(n,s,r).execute();return i&&!r&&(delete i.user._redirectEventId,await n._persistUserIfCurrent(i.user),await n._setRedirectUser(null,e)),i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wz=10*60*1e3;class _z{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Nz(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!OP(e)){const s=((n=e.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";r.onError(Vl(this.auth,s))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=wz&&this.cachedEventUids.clear(),this.cachedEventUids.has(LA(e))}saveEventToCache(e){this.cachedEventUids.add(LA(e)),this.lastProcessedEventTime=Date.now()}}function LA(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function OP({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function Nz(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return OP(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Sz(t,e={}){return qd(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tz=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Az=/^https?/;async function Ez(t){if(t.config.emulator)return;const{authorizedDomains:e}=await Sz(t);for(const r of e)try{if(Cz(r))return}catch{}ol(t,"unauthorized-domain")}function Cz(t){const e=e_(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const i=new URL(t);return i.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&i.hostname===n}if(!Az.test(r))return!1;if(Tz.test(t))return n===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kz=new vx(3e4,6e4);function OA(){const t=Bl().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function Iz(t){return new Promise((e,r)=>{var n,s,a;function i(){OA(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{OA(),r(Vl(t,"network-request-failed"))},timeout:kz.get()})}if(!((s=(n=Bl().gapi)===null||n===void 0?void 0:n.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((a=Bl().gapi)===null||a===void 0)&&a.load)i();else{const l=A$("iframefcb");return Bl()[l]=()=>{gapi.load?i():r(Vl(t,"network-request-failed"))},wP(`${T$()}?onload=${l}`).catch(c=>r(c))}}).catch(e=>{throw Sy=null,e})}let Sy=null;function jz(t){return Sy=Sy||Iz(t),Sy}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pz=new vx(5e3,15e3),Rz="__/auth/iframe",Dz="emulator/auth/iframe",Fz={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Lz=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Oz(t){const e=t.config;Sr(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?v4(e,Dz):`https://${t.config.authDomain}/${Rz}`,n={apiKey:e.apiKey,appName:t.name,v:Am},s=Lz.get(t.config.apiHost);s&&(n.eid=s);const a=t._getFrameworks();return a.length&&(n.fw=a.join(",")),`${r}?${yx(n).slice(1)}`}async function Mz(t){const e=await jz(t),r=Bl().gapi;return Sr(r,t,"internal-error"),e.open({where:document.body,url:Oz(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Fz,dontclear:!0},n=>new Promise(async(s,a)=>{await n.restyle({setHideOnLeave:!1});const i=Vl(t,"network-request-failed"),l=Bl().setTimeout(()=>{a(i)},Pz.get());function c(){Bl().clearTimeout(l),s(n)}n.ping(c).then(c,()=>{a(i)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vz={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Bz=500,Uz=600,$z="_blank",zz="http://localhost";class MA{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function qz(t,e,r,n=Bz,s=Uz){const a=Math.max((window.screen.availHeight-s)/2,0).toString(),i=Math.max((window.screen.availWidth-n)/2,0).toString();let l="";const c=Object.assign(Object.assign({},Vz),{width:n.toString(),height:s.toString(),top:a,left:i}),u=Ws().toLowerCase();r&&(l=mP(u)?$z:r),fP(u)&&(e=e||zz,c.scrollbars="yes");const d=Object.entries(c).reduce((m,[h,g])=>`${m}${h}=${g},`,"");if(g$(u)&&l!=="_self")return Wz(e||"",l),new MA(null);const f=window.open(e||"",l,d);Sr(f,t,"popup-blocked");try{f.focus()}catch{}return new MA(f)}function Wz(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hz="__/auth/handler",Gz="emulator/auth/handler",Kz=encodeURIComponent("fac");async function VA(t,e,r,n,s,a){Sr(t.config.authDomain,t,"auth-domain-config-required"),Sr(t.config.apiKey,t,"invalid-api-key");const i={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:Am,eventId:s};if(e instanceof NP){e.setDefaultLanguage(t.languageCode),i.providerId=e.providerId||"",MB(e.getCustomParameters())||(i.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,f]of Object.entries({}))i[d]=f}if(e instanceof wx){const d=e.getScopes().filter(f=>f!=="");d.length>0&&(i.scopes=d.join(","))}t.tenantId&&(i.tid=t.tenantId);const l=i;for(const d of Object.keys(l))l[d]===void 0&&delete l[d];const c=await t._getAppCheckToken(),u=c?`#${Kz}=${encodeURIComponent(c)}`:"";return`${Yz(t)}?${yx(l).slice(1)}${u}`}function Yz({config:t}){return t.emulator?v4(t,Gz):`https://${t.authDomain}/${Hz}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dw="webStorageSupport";class Xz{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=jP,this._completeRedirectFn=bz,this._overrideRedirectResult=xz}async _openPopup(e,r,n,s){var a;Vc((a=this.eventManagers[e._key()])===null||a===void 0?void 0:a.manager,"_initialize() not called before _openPopup()");const i=await VA(e,r,n,e_(),s);return qz(e,i,S4())}async _openRedirect(e,r,n,s){await this._originValidation(e);const a=await VA(e,r,n,e_(),s);return Z$(a),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:s,promise:a}=this.eventManagers[r];return s?Promise.resolve(s):(Vc(a,"If manager is not set, promise should be"),a)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await Mz(e),n=new _z(e);return r.register("authEvent",s=>(Sr(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:n.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(dw,{type:dw},s=>{var a;const i=(a=s==null?void 0:s[0])===null||a===void 0?void 0:a[dw];i!==void 0&&r(!!i),ol(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=Ez(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return vP()||hP()||w4()}}const Qz=Xz;var BA="@firebase/auth",UA="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jz{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){Sr(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zz(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function eq(t){Gf(new _d("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),{apiKey:i,authDomain:l}=n.options;Sr(i&&!i.includes(":"),"invalid-api-key",{appName:n.name});const c={apiKey:i,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:bP(t)},u=new _$(n,s,a,c);return j$(u,r),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),Gf(new _d("auth-internal",e=>{const r=ph(e.getProvider("auth").getImmediate());return(n=>new Jz(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ml(BA,UA,Zz(t)),Ml(BA,UA,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tq=5*60,rq=Yj("authIdTokenMaxAge")||tq;let $A=null;const nq=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>rq)return;const s=r==null?void 0:r.token;$A!==s&&($A=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function sq(t=g4()){const e=C2(t,"auth");if(e.isInitialized())return e.getImmediate();const r=I$(t,{popupRedirectResolver:Qz,persistence:[lz,X$,jP]}),n=Yj("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const a=new URL(n,location.origin);if(location.origin===a.origin){const i=nq(a.toString());G$(r,i,()=>i(r.currentUser)),H$(r,l=>i(l))}}const s=Hj("auth");return s&&P$(r,`http://${s}`),r}function aq(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}N$({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=s=>{const a=Vl("internal-error");a.customData=s,r(a)},n.type="text/javascript",n.charset="UTF-8",aq().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});eq("Browser");var zA=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ff,MP;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(A,S){function k(){}k.prototype=S.prototype,A.D=S.prototype,A.prototype=new k,A.prototype.constructor=A,A.C=function(M,I,E){for(var D=Array(arguments.length-2),G=2;G<arguments.length;G++)D[G-2]=arguments[G];return S.prototype[I].apply(M,D)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(A,S,k){k||(k=0);var M=Array(16);if(typeof S=="string")for(var I=0;16>I;++I)M[I]=S.charCodeAt(k++)|S.charCodeAt(k++)<<8|S.charCodeAt(k++)<<16|S.charCodeAt(k++)<<24;else for(I=0;16>I;++I)M[I]=S[k++]|S[k++]<<8|S[k++]<<16|S[k++]<<24;S=A.g[0],k=A.g[1],I=A.g[2];var E=A.g[3],D=S+(E^k&(I^E))+M[0]+3614090360&4294967295;S=k+(D<<7&4294967295|D>>>25),D=E+(I^S&(k^I))+M[1]+3905402710&4294967295,E=S+(D<<12&4294967295|D>>>20),D=I+(k^E&(S^k))+M[2]+606105819&4294967295,I=E+(D<<17&4294967295|D>>>15),D=k+(S^I&(E^S))+M[3]+3250441966&4294967295,k=I+(D<<22&4294967295|D>>>10),D=S+(E^k&(I^E))+M[4]+4118548399&4294967295,S=k+(D<<7&4294967295|D>>>25),D=E+(I^S&(k^I))+M[5]+1200080426&4294967295,E=S+(D<<12&4294967295|D>>>20),D=I+(k^E&(S^k))+M[6]+2821735955&4294967295,I=E+(D<<17&4294967295|D>>>15),D=k+(S^I&(E^S))+M[7]+4249261313&4294967295,k=I+(D<<22&4294967295|D>>>10),D=S+(E^k&(I^E))+M[8]+1770035416&4294967295,S=k+(D<<7&4294967295|D>>>25),D=E+(I^S&(k^I))+M[9]+2336552879&4294967295,E=S+(D<<12&4294967295|D>>>20),D=I+(k^E&(S^k))+M[10]+4294925233&4294967295,I=E+(D<<17&4294967295|D>>>15),D=k+(S^I&(E^S))+M[11]+2304563134&4294967295,k=I+(D<<22&4294967295|D>>>10),D=S+(E^k&(I^E))+M[12]+1804603682&4294967295,S=k+(D<<7&4294967295|D>>>25),D=E+(I^S&(k^I))+M[13]+4254626195&4294967295,E=S+(D<<12&4294967295|D>>>20),D=I+(k^E&(S^k))+M[14]+2792965006&4294967295,I=E+(D<<17&4294967295|D>>>15),D=k+(S^I&(E^S))+M[15]+1236535329&4294967295,k=I+(D<<22&4294967295|D>>>10),D=S+(I^E&(k^I))+M[1]+4129170786&4294967295,S=k+(D<<5&4294967295|D>>>27),D=E+(k^I&(S^k))+M[6]+3225465664&4294967295,E=S+(D<<9&4294967295|D>>>23),D=I+(S^k&(E^S))+M[11]+643717713&4294967295,I=E+(D<<14&4294967295|D>>>18),D=k+(E^S&(I^E))+M[0]+3921069994&4294967295,k=I+(D<<20&4294967295|D>>>12),D=S+(I^E&(k^I))+M[5]+3593408605&4294967295,S=k+(D<<5&4294967295|D>>>27),D=E+(k^I&(S^k))+M[10]+38016083&4294967295,E=S+(D<<9&4294967295|D>>>23),D=I+(S^k&(E^S))+M[15]+3634488961&4294967295,I=E+(D<<14&4294967295|D>>>18),D=k+(E^S&(I^E))+M[4]+3889429448&4294967295,k=I+(D<<20&4294967295|D>>>12),D=S+(I^E&(k^I))+M[9]+568446438&4294967295,S=k+(D<<5&4294967295|D>>>27),D=E+(k^I&(S^k))+M[14]+3275163606&4294967295,E=S+(D<<9&4294967295|D>>>23),D=I+(S^k&(E^S))+M[3]+4107603335&4294967295,I=E+(D<<14&4294967295|D>>>18),D=k+(E^S&(I^E))+M[8]+1163531501&4294967295,k=I+(D<<20&4294967295|D>>>12),D=S+(I^E&(k^I))+M[13]+2850285829&4294967295,S=k+(D<<5&4294967295|D>>>27),D=E+(k^I&(S^k))+M[2]+4243563512&4294967295,E=S+(D<<9&4294967295|D>>>23),D=I+(S^k&(E^S))+M[7]+1735328473&4294967295,I=E+(D<<14&4294967295|D>>>18),D=k+(E^S&(I^E))+M[12]+2368359562&4294967295,k=I+(D<<20&4294967295|D>>>12),D=S+(k^I^E)+M[5]+4294588738&4294967295,S=k+(D<<4&4294967295|D>>>28),D=E+(S^k^I)+M[8]+2272392833&4294967295,E=S+(D<<11&4294967295|D>>>21),D=I+(E^S^k)+M[11]+1839030562&4294967295,I=E+(D<<16&4294967295|D>>>16),D=k+(I^E^S)+M[14]+4259657740&4294967295,k=I+(D<<23&4294967295|D>>>9),D=S+(k^I^E)+M[1]+2763975236&4294967295,S=k+(D<<4&4294967295|D>>>28),D=E+(S^k^I)+M[4]+1272893353&4294967295,E=S+(D<<11&4294967295|D>>>21),D=I+(E^S^k)+M[7]+4139469664&4294967295,I=E+(D<<16&4294967295|D>>>16),D=k+(I^E^S)+M[10]+3200236656&4294967295,k=I+(D<<23&4294967295|D>>>9),D=S+(k^I^E)+M[13]+681279174&4294967295,S=k+(D<<4&4294967295|D>>>28),D=E+(S^k^I)+M[0]+3936430074&4294967295,E=S+(D<<11&4294967295|D>>>21),D=I+(E^S^k)+M[3]+3572445317&4294967295,I=E+(D<<16&4294967295|D>>>16),D=k+(I^E^S)+M[6]+76029189&4294967295,k=I+(D<<23&4294967295|D>>>9),D=S+(k^I^E)+M[9]+3654602809&4294967295,S=k+(D<<4&4294967295|D>>>28),D=E+(S^k^I)+M[12]+3873151461&4294967295,E=S+(D<<11&4294967295|D>>>21),D=I+(E^S^k)+M[15]+530742520&4294967295,I=E+(D<<16&4294967295|D>>>16),D=k+(I^E^S)+M[2]+3299628645&4294967295,k=I+(D<<23&4294967295|D>>>9),D=S+(I^(k|~E))+M[0]+4096336452&4294967295,S=k+(D<<6&4294967295|D>>>26),D=E+(k^(S|~I))+M[7]+1126891415&4294967295,E=S+(D<<10&4294967295|D>>>22),D=I+(S^(E|~k))+M[14]+2878612391&4294967295,I=E+(D<<15&4294967295|D>>>17),D=k+(E^(I|~S))+M[5]+4237533241&4294967295,k=I+(D<<21&4294967295|D>>>11),D=S+(I^(k|~E))+M[12]+1700485571&4294967295,S=k+(D<<6&4294967295|D>>>26),D=E+(k^(S|~I))+M[3]+2399980690&4294967295,E=S+(D<<10&4294967295|D>>>22),D=I+(S^(E|~k))+M[10]+4293915773&4294967295,I=E+(D<<15&4294967295|D>>>17),D=k+(E^(I|~S))+M[1]+2240044497&4294967295,k=I+(D<<21&4294967295|D>>>11),D=S+(I^(k|~E))+M[8]+1873313359&4294967295,S=k+(D<<6&4294967295|D>>>26),D=E+(k^(S|~I))+M[15]+4264355552&4294967295,E=S+(D<<10&4294967295|D>>>22),D=I+(S^(E|~k))+M[6]+2734768916&4294967295,I=E+(D<<15&4294967295|D>>>17),D=k+(E^(I|~S))+M[13]+1309151649&4294967295,k=I+(D<<21&4294967295|D>>>11),D=S+(I^(k|~E))+M[4]+4149444226&4294967295,S=k+(D<<6&4294967295|D>>>26),D=E+(k^(S|~I))+M[11]+3174756917&4294967295,E=S+(D<<10&4294967295|D>>>22),D=I+(S^(E|~k))+M[2]+718787259&4294967295,I=E+(D<<15&4294967295|D>>>17),D=k+(E^(I|~S))+M[9]+3951481745&4294967295,A.g[0]=A.g[0]+S&4294967295,A.g[1]=A.g[1]+(I+(D<<21&4294967295|D>>>11))&4294967295,A.g[2]=A.g[2]+I&4294967295,A.g[3]=A.g[3]+E&4294967295}n.prototype.u=function(A,S){S===void 0&&(S=A.length);for(var k=S-this.blockSize,M=this.B,I=this.h,E=0;E<S;){if(I==0)for(;E<=k;)s(this,A,E),E+=this.blockSize;if(typeof A=="string"){for(;E<S;)if(M[I++]=A.charCodeAt(E++),I==this.blockSize){s(this,M),I=0;break}}else for(;E<S;)if(M[I++]=A[E++],I==this.blockSize){s(this,M),I=0;break}}this.h=I,this.o+=S},n.prototype.v=function(){var A=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);A[0]=128;for(var S=1;S<A.length-8;++S)A[S]=0;var k=8*this.o;for(S=A.length-8;S<A.length;++S)A[S]=k&255,k/=256;for(this.u(A),A=Array(16),S=k=0;4>S;++S)for(var M=0;32>M;M+=8)A[k++]=this.g[S]>>>M&255;return A};function a(A,S){var k=l;return Object.prototype.hasOwnProperty.call(k,A)?k[A]:k[A]=S(A)}function i(A,S){this.h=S;for(var k=[],M=!0,I=A.length-1;0<=I;I--){var E=A[I]|0;M&&E==S||(k[I]=E,M=!1)}this.g=k}var l={};function c(A){return-128<=A&&128>A?a(A,function(S){return new i([S|0],0>S?-1:0)}):new i([A|0],0>A?-1:0)}function u(A){if(isNaN(A)||!isFinite(A))return f;if(0>A)return v(u(-A));for(var S=[],k=1,M=0;A>=k;M++)S[M]=A/k|0,k*=4294967296;return new i(S,0)}function d(A,S){if(A.length==0)throw Error("number format error: empty string");if(S=S||10,2>S||36<S)throw Error("radix out of range: "+S);if(A.charAt(0)=="-")return v(d(A.substring(1),S));if(0<=A.indexOf("-"))throw Error('number format error: interior "-" character');for(var k=u(Math.pow(S,8)),M=f,I=0;I<A.length;I+=8){var E=Math.min(8,A.length-I),D=parseInt(A.substring(I,I+E),S);8>E?(E=u(Math.pow(S,E)),M=M.j(E).add(u(D))):(M=M.j(k),M=M.add(u(D)))}return M}var f=c(0),m=c(1),h=c(16777216);t=i.prototype,t.m=function(){if(p(this))return-v(this).m();for(var A=0,S=1,k=0;k<this.g.length;k++){var M=this.i(k);A+=(0<=M?M:4294967296+M)*S,S*=4294967296}return A},t.toString=function(A){if(A=A||10,2>A||36<A)throw Error("radix out of range: "+A);if(g(this))return"0";if(p(this))return"-"+v(this).toString(A);for(var S=u(Math.pow(A,6)),k=this,M="";;){var I=j(k,S).g;k=b(k,I.j(S));var E=((0<k.g.length?k.g[0]:k.h)>>>0).toString(A);if(k=I,g(k))return E+M;for(;6>E.length;)E="0"+E;M=E+M}},t.i=function(A){return 0>A?0:A<this.g.length?this.g[A]:this.h};function g(A){if(A.h!=0)return!1;for(var S=0;S<A.g.length;S++)if(A.g[S]!=0)return!1;return!0}function p(A){return A.h==-1}t.l=function(A){return A=b(this,A),p(A)?-1:g(A)?0:1};function v(A){for(var S=A.g.length,k=[],M=0;M<S;M++)k[M]=~A.g[M];return new i(k,~A.h).add(m)}t.abs=function(){return p(this)?v(this):this},t.add=function(A){for(var S=Math.max(this.g.length,A.g.length),k=[],M=0,I=0;I<=S;I++){var E=M+(this.i(I)&65535)+(A.i(I)&65535),D=(E>>>16)+(this.i(I)>>>16)+(A.i(I)>>>16);M=D>>>16,E&=65535,D&=65535,k[I]=D<<16|E}return new i(k,k[k.length-1]&-2147483648?-1:0)};function b(A,S){return A.add(v(S))}t.j=function(A){if(g(this)||g(A))return f;if(p(this))return p(A)?v(this).j(v(A)):v(v(this).j(A));if(p(A))return v(this.j(v(A)));if(0>this.l(h)&&0>A.l(h))return u(this.m()*A.m());for(var S=this.g.length+A.g.length,k=[],M=0;M<2*S;M++)k[M]=0;for(M=0;M<this.g.length;M++)for(var I=0;I<A.g.length;I++){var E=this.i(M)>>>16,D=this.i(M)&65535,G=A.i(I)>>>16,Z=A.i(I)&65535;k[2*M+2*I]+=D*Z,w(k,2*M+2*I),k[2*M+2*I+1]+=E*Z,w(k,2*M+2*I+1),k[2*M+2*I+1]+=D*G,w(k,2*M+2*I+1),k[2*M+2*I+2]+=E*G,w(k,2*M+2*I+2)}for(M=0;M<S;M++)k[M]=k[2*M+1]<<16|k[2*M];for(M=S;M<2*S;M++)k[M]=0;return new i(k,0)};function w(A,S){for(;(A[S]&65535)!=A[S];)A[S+1]+=A[S]>>>16,A[S]&=65535,S++}function N(A,S){this.g=A,this.h=S}function j(A,S){if(g(S))throw Error("division by zero");if(g(A))return new N(f,f);if(p(A))return S=j(v(A),S),new N(v(S.g),v(S.h));if(p(S))return S=j(A,v(S)),new N(v(S.g),S.h);if(30<A.g.length){if(p(A)||p(S))throw Error("slowDivide_ only works with positive integers.");for(var k=m,M=S;0>=M.l(A);)k=F(k),M=F(M);var I=U(k,1),E=U(M,1);for(M=U(M,2),k=U(k,2);!g(M);){var D=E.add(M);0>=D.l(A)&&(I=I.add(k),E=D),M=U(M,1),k=U(k,1)}return S=b(A,I.j(S)),new N(I,S)}for(I=f;0<=A.l(S);){for(k=Math.max(1,Math.floor(A.m()/S.m())),M=Math.ceil(Math.log(k)/Math.LN2),M=48>=M?1:Math.pow(2,M-48),E=u(k),D=E.j(S);p(D)||0<D.l(A);)k-=M,E=u(k),D=E.j(S);g(E)&&(E=m),I=I.add(E),A=b(A,D)}return new N(I,A)}t.A=function(A){return j(this,A).h},t.and=function(A){for(var S=Math.max(this.g.length,A.g.length),k=[],M=0;M<S;M++)k[M]=this.i(M)&A.i(M);return new i(k,this.h&A.h)},t.or=function(A){for(var S=Math.max(this.g.length,A.g.length),k=[],M=0;M<S;M++)k[M]=this.i(M)|A.i(M);return new i(k,this.h|A.h)},t.xor=function(A){for(var S=Math.max(this.g.length,A.g.length),k=[],M=0;M<S;M++)k[M]=this.i(M)^A.i(M);return new i(k,this.h^A.h)};function F(A){for(var S=A.g.length+1,k=[],M=0;M<S;M++)k[M]=A.i(M)<<1|A.i(M-1)>>>31;return new i(k,A.h)}function U(A,S){var k=S>>5;S%=32;for(var M=A.g.length-k,I=[],E=0;E<M;E++)I[E]=0<S?A.i(E+k)>>>S|A.i(E+k+1)<<32-S:A.i(E+k);return new i(I,A.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,MP=n,i.prototype.add=i.prototype.add,i.prototype.multiply=i.prototype.j,i.prototype.modulo=i.prototype.A,i.prototype.compare=i.prototype.l,i.prototype.toNumber=i.prototype.m,i.prototype.toString=i.prototype.toString,i.prototype.getBits=i.prototype.i,i.fromNumber=u,i.fromString=d,Ff=i}).apply(typeof zA<"u"?zA:typeof self<"u"?self:typeof window<"u"?window:{});var L1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var VP,Sp,BP,Ty,a_,UP,$P,zP;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(y,R,W){return y==Array.prototype||y==Object.prototype||(y[R]=W.value),y};function r(y){y=[typeof globalThis=="object"&&globalThis,y,typeof window=="object"&&window,typeof self=="object"&&self,typeof L1=="object"&&L1];for(var R=0;R<y.length;++R){var W=y[R];if(W&&W.Math==Math)return W}throw Error("Cannot find global object")}var n=r(this);function s(y,R){if(R)e:{var W=n;y=y.split(".");for(var le=0;le<y.length-1;le++){var Fe=y[le];if(!(Fe in W))break e;W=W[Fe]}y=y[y.length-1],le=W[y],R=R(le),R!=le&&R!=null&&e(W,y,{configurable:!0,writable:!0,value:R})}}function a(y,R){y instanceof String&&(y+="");var W=0,le=!1,Fe={next:function(){if(!le&&W<y.length){var Qe=W++;return{value:R(Qe,y[Qe]),done:!1}}return le=!0,{done:!0,value:void 0}}};return Fe[Symbol.iterator]=function(){return Fe},Fe}s("Array.prototype.values",function(y){return y||function(){return a(this,function(R,W){return W})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var i=i||{},l=this||self;function c(y){var R=typeof y;return R=R!="object"?R:y?Array.isArray(y)?"array":R:"null",R=="array"||R=="object"&&typeof y.length=="number"}function u(y){var R=typeof y;return R=="object"&&y!=null||R=="function"}function d(y,R,W){return y.call.apply(y.bind,arguments)}function f(y,R,W){if(!y)throw Error();if(2<arguments.length){var le=Array.prototype.slice.call(arguments,2);return function(){var Fe=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(Fe,le),y.apply(R,Fe)}}return function(){return y.apply(R,arguments)}}function m(y,R,W){return m=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:f,m.apply(null,arguments)}function h(y,R){var W=Array.prototype.slice.call(arguments,1);return function(){var le=W.slice();return le.push.apply(le,arguments),y.apply(this,le)}}function g(y,R){function W(){}W.prototype=R.prototype,y.aa=R.prototype,y.prototype=new W,y.prototype.constructor=y,y.Qb=function(le,Fe,Qe){for(var Ct=Array(arguments.length-2),Ar=2;Ar<arguments.length;Ar++)Ct[Ar-2]=arguments[Ar];return R.prototype[Fe].apply(le,Ct)}}function p(y){const R=y.length;if(0<R){const W=Array(R);for(let le=0;le<R;le++)W[le]=y[le];return W}return[]}function v(y,R){for(let W=1;W<arguments.length;W++){const le=arguments[W];if(c(le)){const Fe=y.length||0,Qe=le.length||0;y.length=Fe+Qe;for(let Ct=0;Ct<Qe;Ct++)y[Fe+Ct]=le[Ct]}else y.push(le)}}class b{constructor(R,W){this.i=R,this.j=W,this.h=0,this.g=null}get(){let R;return 0<this.h?(this.h--,R=this.g,this.g=R.next,R.next=null):R=this.i(),R}}function w(y){return/^[\s\xa0]*$/.test(y)}function N(){var y=l.navigator;return y&&(y=y.userAgent)?y:""}function j(y){return j[" "](y),y}j[" "]=function(){};var F=N().indexOf("Gecko")!=-1&&!(N().toLowerCase().indexOf("webkit")!=-1&&N().indexOf("Edge")==-1)&&!(N().indexOf("Trident")!=-1||N().indexOf("MSIE")!=-1)&&N().indexOf("Edge")==-1;function U(y,R,W){for(const le in y)R.call(W,y[le],le,y)}function A(y,R){for(const W in y)R.call(void 0,y[W],W,y)}function S(y){const R={};for(const W in y)R[W]=y[W];return R}const k="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function M(y,R){let W,le;for(let Fe=1;Fe<arguments.length;Fe++){le=arguments[Fe];for(W in le)y[W]=le[W];for(let Qe=0;Qe<k.length;Qe++)W=k[Qe],Object.prototype.hasOwnProperty.call(le,W)&&(y[W]=le[W])}}function I(y){var R=1;y=y.split(":");const W=[];for(;0<R&&y.length;)W.push(y.shift()),R--;return y.length&&W.push(y.join(":")),W}function E(y){l.setTimeout(()=>{throw y},0)}function D(){var y=Y;let R=null;return y.g&&(R=y.g,y.g=y.g.next,y.g||(y.h=null),R.next=null),R}class G{constructor(){this.h=this.g=null}add(R,W){const le=Z.get();le.set(R,W),this.h?this.h.next=le:this.g=le,this.h=le}}var Z=new b(()=>new ae,y=>y.reset());class ae{constructor(){this.next=this.g=this.h=null}set(R,W){this.h=R,this.g=W,this.next=null}reset(){this.next=this.g=this.h=null}}let de,se=!1,Y=new G,ye=()=>{const y=l.Promise.resolve(void 0);de=()=>{y.then(re)}};var re=()=>{for(var y;y=D();){try{y.h.call(y.g)}catch(W){E(W)}var R=Z;R.j(y),100>R.h&&(R.h++,y.next=R.g,R.g=y)}se=!1};function C(){this.s=this.s,this.C=this.C}C.prototype.s=!1,C.prototype.ma=function(){this.s||(this.s=!0,this.N())},C.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function O(y,R){this.type=y,this.g=this.target=R,this.defaultPrevented=!1}O.prototype.h=function(){this.defaultPrevented=!0};var L=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var y=!1,R=Object.defineProperty({},"passive",{get:function(){y=!0}});try{const W=()=>{};l.addEventListener("test",W,R),l.removeEventListener("test",W,R)}catch{}return y}();function H(y,R){if(O.call(this,y?y.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,y){var W=this.type=y.type,le=y.changedTouches&&y.changedTouches.length?y.changedTouches[0]:null;if(this.target=y.target||y.srcElement,this.g=R,R=y.relatedTarget){if(F){e:{try{j(R.nodeName);var Fe=!0;break e}catch{}Fe=!1}Fe||(R=null)}}else W=="mouseover"?R=y.fromElement:W=="mouseout"&&(R=y.toElement);this.relatedTarget=R,le?(this.clientX=le.clientX!==void 0?le.clientX:le.pageX,this.clientY=le.clientY!==void 0?le.clientY:le.pageY,this.screenX=le.screenX||0,this.screenY=le.screenY||0):(this.clientX=y.clientX!==void 0?y.clientX:y.pageX,this.clientY=y.clientY!==void 0?y.clientY:y.pageY,this.screenX=y.screenX||0,this.screenY=y.screenY||0),this.button=y.button,this.key=y.key||"",this.ctrlKey=y.ctrlKey,this.altKey=y.altKey,this.shiftKey=y.shiftKey,this.metaKey=y.metaKey,this.pointerId=y.pointerId||0,this.pointerType=typeof y.pointerType=="string"?y.pointerType:K[y.pointerType]||"",this.state=y.state,this.i=y,y.defaultPrevented&&H.aa.h.call(this)}}g(H,O);var K={2:"touch",3:"pen",4:"mouse"};H.prototype.h=function(){H.aa.h.call(this);var y=this.i;y.preventDefault?y.preventDefault():y.returnValue=!1};var q="closure_listenable_"+(1e6*Math.random()|0),te=0;function oe(y,R,W,le,Fe){this.listener=y,this.proxy=null,this.src=R,this.type=W,this.capture=!!le,this.ha=Fe,this.key=++te,this.da=this.fa=!1}function V(y){y.da=!0,y.listener=null,y.proxy=null,y.src=null,y.ha=null}function xe(y){this.src=y,this.g={},this.h=0}xe.prototype.add=function(y,R,W,le,Fe){var Qe=y.toString();y=this.g[Qe],y||(y=this.g[Qe]=[],this.h++);var Ct=Ee(y,R,le,Fe);return-1<Ct?(R=y[Ct],W||(R.fa=!1)):(R=new oe(R,this.src,Qe,!!le,Fe),R.fa=W,y.push(R)),R};function B(y,R){var W=R.type;if(W in y.g){var le=y.g[W],Fe=Array.prototype.indexOf.call(le,R,void 0),Qe;(Qe=0<=Fe)&&Array.prototype.splice.call(le,Fe,1),Qe&&(V(R),y.g[W].length==0&&(delete y.g[W],y.h--))}}function Ee(y,R,W,le){for(var Fe=0;Fe<y.length;++Fe){var Qe=y[Fe];if(!Qe.da&&Qe.listener==R&&Qe.capture==!!W&&Qe.ha==le)return Fe}return-1}var Me="closure_lm_"+(1e6*Math.random()|0),Ie={};function he(y,R,W,le,Fe){if(Array.isArray(R)){for(var Qe=0;Qe<R.length;Qe++)he(y,R[Qe],W,le,Fe);return null}return W=Ce(W),y&&y[q]?y.K(R,W,u(le)?!!le.capture:!1,Fe):qe(y,R,W,!1,le,Fe)}function qe(y,R,W,le,Fe,Qe){if(!R)throw Error("Invalid event type");var Ct=u(Fe)?!!Fe.capture:!!Fe,Ar=Be(y);if(Ar||(y[Me]=Ar=new xe(y)),W=Ar.add(R,W,le,Ct,Qe),W.proxy)return W;if(le=ct(),W.proxy=le,le.src=y,le.listener=W,y.addEventListener)L||(Fe=Ct),Fe===void 0&&(Fe=!1),y.addEventListener(R.toString(),le,Fe);else if(y.attachEvent)y.attachEvent(Ne(R.toString()),le);else if(y.addListener&&y.removeListener)y.addListener(le);else throw Error("addEventListener and attachEvent are unavailable.");return W}function ct(){function y(W){return R.call(y.src,y.listener,W)}const R=Ae;return y}function lt(y,R,W,le,Fe){if(Array.isArray(R))for(var Qe=0;Qe<R.length;Qe++)lt(y,R[Qe],W,le,Fe);else le=u(le)?!!le.capture:!!le,W=Ce(W),y&&y[q]?(y=y.i,R=String(R).toString(),R in y.g&&(Qe=y.g[R],W=Ee(Qe,W,le,Fe),-1<W&&(V(Qe[W]),Array.prototype.splice.call(Qe,W,1),Qe.length==0&&(delete y.g[R],y.h--)))):y&&(y=Be(y))&&(R=y.g[R.toString()],y=-1,R&&(y=Ee(R,W,le,Fe)),(W=-1<y?R[y]:null)&&ue(W))}function ue(y){if(typeof y!="number"&&y&&!y.da){var R=y.src;if(R&&R[q])B(R.i,y);else{var W=y.type,le=y.proxy;R.removeEventListener?R.removeEventListener(W,le,y.capture):R.detachEvent?R.detachEvent(Ne(W),le):R.addListener&&R.removeListener&&R.removeListener(le),(W=Be(R))?(B(W,y),W.h==0&&(W.src=null,R[Me]=null)):V(y)}}}function Ne(y){return y in Ie?Ie[y]:Ie[y]="on"+y}function Ae(y,R){if(y.da)y=!0;else{R=new H(R,this);var W=y.listener,le=y.ha||y.src;y.fa&&ue(y),y=W.call(le,R)}return y}function Be(y){return y=y[Me],y instanceof xe?y:null}var Ue="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ce(y){return typeof y=="function"?y:(y[Ue]||(y[Ue]=function(R){return y.handleEvent(R)}),y[Ue])}function Ye(){C.call(this),this.i=new xe(this),this.M=this,this.F=null}g(Ye,C),Ye.prototype[q]=!0,Ye.prototype.removeEventListener=function(y,R,W,le){lt(this,y,R,W,le)};function It(y,R){var W,le=y.F;if(le)for(W=[];le;le=le.F)W.push(le);if(y=y.M,le=R.type||R,typeof R=="string")R=new O(R,y);else if(R instanceof O)R.target=R.target||y;else{var Fe=R;R=new O(le,y),M(R,Fe)}if(Fe=!0,W)for(var Qe=W.length-1;0<=Qe;Qe--){var Ct=R.g=W[Qe];Fe=Dt(Ct,le,!0,R)&&Fe}if(Ct=R.g=y,Fe=Dt(Ct,le,!0,R)&&Fe,Fe=Dt(Ct,le,!1,R)&&Fe,W)for(Qe=0;Qe<W.length;Qe++)Ct=R.g=W[Qe],Fe=Dt(Ct,le,!1,R)&&Fe}Ye.prototype.N=function(){if(Ye.aa.N.call(this),this.i){var y=this.i,R;for(R in y.g){for(var W=y.g[R],le=0;le<W.length;le++)V(W[le]);delete y.g[R],y.h--}}this.F=null},Ye.prototype.K=function(y,R,W,le){return this.i.add(String(y),R,!1,W,le)},Ye.prototype.L=function(y,R,W,le){return this.i.add(String(y),R,!0,W,le)};function Dt(y,R,W,le){if(R=y.i.g[String(R)],!R)return!0;R=R.concat();for(var Fe=!0,Qe=0;Qe<R.length;++Qe){var Ct=R[Qe];if(Ct&&!Ct.da&&Ct.capture==W){var Ar=Ct.listener,Br=Ct.ha||Ct.src;Ct.fa&&B(y.i,Ct),Fe=Ar.call(Br,le)!==!1&&Fe}}return Fe&&!le.defaultPrevented}function Ot(y,R,W){if(typeof y=="function")W&&(y=m(y,W));else if(y&&typeof y.handleEvent=="function")y=m(y.handleEvent,y);else throw Error("Invalid listener argument");return 2147483647<Number(R)?-1:l.setTimeout(y,R||0)}function Pt(y){y.g=Ot(()=>{y.g=null,y.i&&(y.i=!1,Pt(y))},y.l);const R=y.h;y.h=null,y.m.apply(null,R)}class ht extends C{constructor(R,W){super(),this.m=R,this.l=W,this.h=null,this.i=!1,this.g=null}j(R){this.h=arguments,this.g?this.i=!0:Pt(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function or(y){C.call(this),this.h=y,this.g={}}g(or,C);var Ve=[];function tt(y){U(y.g,function(R,W){this.g.hasOwnProperty(W)&&ue(R)},y),y.g={}}or.prototype.N=function(){or.aa.N.call(this),tt(this)},or.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var nt=l.JSON.stringify,At=l.JSON.parse,mr=class{stringify(y){return l.JSON.stringify(y,void 0)}parse(y){return l.JSON.parse(y,void 0)}};function Wt(){}Wt.prototype.h=null;function Te(y){return y.h||(y.h=y.i())}function je(){}var et={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function St(){O.call(this,"d")}g(St,O);function vt(){O.call(this,"c")}g(vt,O);var st={},zt=null;function Qt(){return zt=zt||new Ye}st.La="serverreachability";function nr(y){O.call(this,st.La,y)}g(nr,O);function dr(y){const R=Qt();It(R,new nr(R))}st.STAT_EVENT="statevent";function Vr(y,R){O.call(this,st.STAT_EVENT,y),this.stat=R}g(Vr,O);function Et(y){const R=Qt();It(R,new Vr(R,y))}st.Ma="timingevent";function qr(y,R){O.call(this,st.Ma,y),this.size=R}g(qr,O);function Qr(y,R){if(typeof y!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){y()},R)}function Wr(){this.g=!0}Wr.prototype.xa=function(){this.g=!1};function Nn(y,R,W,le,Fe,Qe){y.info(function(){if(y.g)if(Qe)for(var Ct="",Ar=Qe.split("&"),Br=0;Br<Ar.length;Br++){var Er=Ar[Br].split("=");if(1<Er.length){var ln=Er[0];Er=Er[1];var Sn=ln.split("_");Ct=2<=Sn.length&&Sn[1]=="type"?Ct+(ln+"="+Er+"&"):Ct+(ln+"=redacted&")}}else Ct=null;else Ct=Qe;return"XMLHTTP REQ ("+le+") [attempt "+Fe+"]: "+R+`
`+W+`
`+Ct})}function ir(y,R,W,le,Fe,Qe,Ct){y.info(function(){return"XMLHTTP RESP ("+le+") [ attempt "+Fe+"]: "+R+`
`+W+`
`+Qe+" "+Ct})}function ee(y,R,W,le){y.info(function(){return"XMLHTTP TEXT ("+R+"): "+pe(y,W)+(le?" "+le:"")})}function be(y,R){y.info(function(){return"TIMEOUT: "+R})}Wr.prototype.info=function(){};function pe(y,R){if(!y.g)return R;if(!R)return null;try{var W=JSON.parse(R);if(W){for(y=0;y<W.length;y++)if(Array.isArray(W[y])){var le=W[y];if(!(2>le.length)){var Fe=le[1];if(Array.isArray(Fe)&&!(1>Fe.length)){var Qe=Fe[0];if(Qe!="noop"&&Qe!="stop"&&Qe!="close")for(var Ct=1;Ct<Fe.length;Ct++)Fe[Ct]=""}}}}return nt(W)}catch{return R}}var ge={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},we={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},_e;function $e(){}g($e,Wt),$e.prototype.g=function(){return new XMLHttpRequest},$e.prototype.i=function(){return{}},_e=new $e;function rt(y,R,W,le){this.j=y,this.i=R,this.l=W,this.R=le||1,this.U=new or(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new ze}function ze(){this.i=null,this.g="",this.h=!1}var We={},Xe={};function wt(y,R,W){y.L=1,y.v=Xl(qa(R)),y.m=W,y.P=!0,Lt(y,null)}function Lt(y,R){y.F=Date.now(),$t(y),y.A=qa(y.v);var W=y.A,le=y.R;Array.isArray(le)||(le=[String(le)]),wr(W.i,"t",le),y.C=0,W=y.j.J,y.h=new ze,y.g=Q(y.j,W?R:null,!y.m),0<y.O&&(y.M=new ht(m(y.Y,y,y.g),y.O)),R=y.U,W=y.g,le=y.ca;var Fe="readystatechange";Array.isArray(Fe)||(Fe&&(Ve[0]=Fe.toString()),Fe=Ve);for(var Qe=0;Qe<Fe.length;Qe++){var Ct=he(W,Fe[Qe],le||R.handleEvent,!1,R.h||R);if(!Ct)break;R.g[Ct.key]=Ct}R=y.H?S(y.H):{},y.m?(y.u||(y.u="POST"),R["Content-Type"]="application/x-www-form-urlencoded",y.g.ea(y.A,y.u,y.m,R)):(y.u="GET",y.g.ea(y.A,y.u,null,R)),dr(),Nn(y.i,y.u,y.A,y.l,y.R,y.m)}rt.prototype.ca=function(y){y=y.target;const R=this.M;R&&Ms(y)==3?R.j():this.Y(y)},rt.prototype.Y=function(y){try{if(y==this.g)e:{const Sn=Ms(this.g);var R=this.g.Ba();const Vo=this.g.Z();if(!(3>Sn)&&(Sn!=3||this.g&&(this.h.h||this.g.oa()||Ih(this.g)))){this.J||Sn!=4||R==7||(R==8||0>=Vo?dr(3):dr(2)),mt(this);var W=this.g.Z();this.X=W;t:if(qt(this)){var le=Ih(this.g);y="";var Fe=le.length,Qe=Ms(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){_t(this),it(this);var Ct="";break t}this.h.i=new l.TextDecoder}for(R=0;R<Fe;R++)this.h.h=!0,y+=this.h.i.decode(le[R],{stream:!(Qe&&R==Fe-1)});le.length=0,this.h.g+=y,this.C=0,Ct=this.h.g}else Ct=this.g.oa();if(this.o=W==200,ir(this.i,this.u,this.A,this.l,this.R,Sn,W),this.o){if(this.T&&!this.K){t:{if(this.g){var Ar,Br=this.g;if((Ar=Br.g?Br.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!w(Ar)){var Er=Ar;break t}}Er=null}if(W=Er)ee(this.i,this.l,W,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,cr(this,W);else{this.o=!1,this.s=3,Et(12),_t(this),it(this);break e}}if(this.P){W=!0;let oa;for(;!this.J&&this.C<Ct.length;)if(oa=jt(this,Ct),oa==Xe){Sn==4&&(this.s=4,Et(14),W=!1),ee(this.i,this.l,null,"[Incomplete Response]");break}else if(oa==We){this.s=4,Et(15),ee(this.i,this.l,Ct,"[Invalid Chunk]"),W=!1;break}else ee(this.i,this.l,oa,null),cr(this,oa);if(qt(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Sn!=4||Ct.length!=0||this.h.h||(this.s=1,Et(16),W=!1),this.o=this.o&&W,!W)ee(this.i,this.l,Ct,"[Invalid Chunked Response]"),_t(this),it(this);else if(0<Ct.length&&!this.W){this.W=!0;var ln=this.j;ln.g==this&&ln.ba&&!ln.M&&(ln.j.info("Great, no buffering proxy detected. Bytes received: "+Ct.length),hu(ln),ln.M=!0,Et(11))}}else ee(this.i,this.l,Ct,null),cr(this,Ct);Sn==4&&_t(this),this.o&&!this.J&&(Sn==4?gl(this.j,this):(this.o=!1,$t(this)))}else ml(this.g),W==400&&0<Ct.indexOf("Unknown SID")?(this.s=3,Et(12)):(this.s=0,Et(13)),_t(this),it(this)}}}catch{}finally{}};function qt(y){return y.g?y.u=="GET"&&y.L!=2&&y.j.Ca:!1}function jt(y,R){var W=y.C,le=R.indexOf(`
`,W);return le==-1?Xe:(W=Number(R.substring(W,le)),isNaN(W)?We:(le+=1,le+W>R.length?Xe:(R=R.slice(le,le+W),y.C=le+W,R)))}rt.prototype.cancel=function(){this.J=!0,_t(this)};function $t(y){y.S=Date.now()+y.I,Ze(y,y.I)}function Ze(y,R){if(y.B!=null)throw Error("WatchDog timer not null");y.B=Qr(m(y.ba,y),R)}function mt(y){y.B&&(l.clearTimeout(y.B),y.B=null)}rt.prototype.ba=function(){this.B=null;const y=Date.now();0<=y-this.S?(be(this.i,this.A),this.L!=2&&(dr(),Et(17)),_t(this),this.s=2,it(this)):Ze(this,this.S-y)};function it(y){y.j.G==0||y.J||gl(y.j,y)}function _t(y){mt(y);var R=y.M;R&&typeof R.ma=="function"&&R.ma(),y.M=null,tt(y.U),y.g&&(R=y.g,y.g=null,R.abort(),R.ma())}function cr(y,R){try{var W=y.j;if(W.G!=0&&(W.g==y||ts(W.h,y))){if(!y.K&&ts(W.h,y)&&W.G==3){try{var le=W.Da.g.parse(R)}catch{le=null}if(Array.isArray(le)&&le.length==3){var Fe=le;if(Fe[0]==0){e:if(!W.u){if(W.g)if(W.g.F+3e3<y.F)Mo(W),cu(W);else break e;tc(W),Et(18)}}else W.za=Fe[1],0<W.za-W.T&&37500>Fe[2]&&W.F&&W.v==0&&!W.C&&(W.C=Qr(m(W.Za,W),6e3));if(1>=As(W.h)&&W.ca){try{W.ca()}catch{}W.ca=void 0}}else va(W,11)}else if((y.K||W.g==y)&&Mo(W),!w(R))for(Fe=W.Da.g.parse(R),R=0;R<Fe.length;R++){let Er=Fe[R];if(W.T=Er[0],Er=Er[1],W.G==2)if(Er[0]=="c"){W.K=Er[1],W.ia=Er[2];const ln=Er[3];ln!=null&&(W.la=ln,W.j.info("VER="+W.la));const Sn=Er[4];Sn!=null&&(W.Aa=Sn,W.j.info("SVER="+W.Aa));const Vo=Er[5];Vo!=null&&typeof Vo=="number"&&0<Vo&&(le=1.5*Vo,W.L=le,W.j.info("backChannelRequestTimeoutMs_="+le)),le=W;const oa=y.g;if(oa){const xl=oa.g?oa.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(xl){var Qe=le.h;Qe.g||xl.indexOf("spdy")==-1&&xl.indexOf("quic")==-1&&xl.indexOf("h2")==-1||(Qe.j=Qe.l,Qe.g=new Set,Qe.h&&(Kr(Qe,Qe.h),Qe.h=null))}if(le.D){const yl=oa.g?oa.g.getResponseHeader("X-HTTP-Session-Id"):null;yl&&(le.ya=yl,un(le.I,le.D,yl))}}W.G=3,W.l&&W.l.ua(),W.ba&&(W.R=Date.now()-y.F,W.j.info("Handshake RTT: "+W.R+"ms")),le=W;var Ct=y;if(le.qa=T(le,le.J?le.ia:null,le.W),Ct.K){En(le.h,Ct);var Ar=Ct,Br=le.L;Br&&(Ar.I=Br),Ar.B&&(mt(Ar),$t(Ar)),le.g=Ct}else fu(le);0<W.i.length&&uu(W)}else Er[0]!="stop"&&Er[0]!="close"||va(W,7);else W.G==3&&(Er[0]=="stop"||Er[0]=="close"?Er[0]=="stop"?va(W,7):Oo(W):Er[0]!="noop"&&W.l&&W.l.ta(Er),W.v=0)}}dr(4)}catch{}}var xr=class{constructor(y,R){this.g=y,this.map=R}};function Lr(y){this.l=y||10,l.PerformanceNavigationTiming?(y=l.performance.getEntriesByType("navigation"),y=0<y.length&&(y[0].nextHopProtocol=="hq"||y[0].nextHopProtocol=="h2")):y=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=y?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function an(y){return y.h?!0:y.g?y.g.size>=y.j:!1}function As(y){return y.h?1:y.g?y.g.size:0}function ts(y,R){return y.h?y.h==R:y.g?y.g.has(R):!1}function Kr(y,R){y.g?y.g.add(R):y.h=R}function En(y,R){y.h&&y.h==R?y.h=null:y.g&&y.g.has(R)&&y.g.delete(R)}Lr.prototype.cancel=function(){if(this.i=Es(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const y of this.g.values())y.cancel();this.g.clear()}};function Es(y){if(y.h!=null)return y.i.concat(y.h.D);if(y.g!=null&&y.g.size!==0){let R=y.i;for(const W of y.g.values())R=R.concat(W.D);return R}return p(y.i)}function dl(y){if(y.V&&typeof y.V=="function")return y.V();if(typeof Map<"u"&&y instanceof Map||typeof Set<"u"&&y instanceof Set)return Array.from(y.values());if(typeof y=="string")return y.split("");if(c(y)){for(var R=[],W=y.length,le=0;le<W;le++)R.push(y[le]);return R}R=[],W=0;for(le in y)R[W++]=y[le];return R}function Jd(y){if(y.na&&typeof y.na=="function")return y.na();if(!y.V||typeof y.V!="function"){if(typeof Map<"u"&&y instanceof Map)return Array.from(y.keys());if(!(typeof Set<"u"&&y instanceof Set)){if(c(y)||typeof y=="string"){var R=[];y=y.length;for(var W=0;W<y;W++)R.push(W);return R}R=[],W=0;for(const le in y)R[W++]=le;return R}}}function Th(y,R){if(y.forEach&&typeof y.forEach=="function")y.forEach(R,void 0);else if(c(y)||typeof y=="string")Array.prototype.forEach.call(y,R,void 0);else for(var W=Jd(y),le=dl(y),Fe=le.length,Qe=0;Qe<Fe;Qe++)R.call(void 0,le[Qe],W&&W[Qe],y)}var oi=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function eu(y,R){if(y){y=y.split("&");for(var W=0;W<y.length;W++){var le=y[W].indexOf("="),Fe=null;if(0<=le){var Qe=y[W].substring(0,le);Fe=y[W].substring(le+1)}else Qe=y[W];R(Qe,Fe?decodeURIComponent(Fe.replace(/\+/g," ")):"")}}}function rs(y){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,y instanceof rs){this.h=y.h,Yl(this,y.j),this.o=y.o,this.g=y.g,tu(this,y.s),this.l=y.l;var R=y.i,W=new fl;W.i=R.i,R.g&&(W.g=new Map(R.g),W.h=R.h),Zd(this,W),this.m=y.m}else y&&(R=String(y).match(oi))?(this.h=!1,Yl(this,R[1]||"",!0),this.o=Ql(R[2]||""),this.g=Ql(R[3]||"",!0),tu(this,R[4]),this.l=Ql(R[5]||"",!0),Zd(this,R[6]||"",!0),this.m=Ql(R[7]||"")):(this.h=!1,this.i=new fl(null,this.h))}rs.prototype.toString=function(){var y=[],R=this.j;R&&y.push(Ro(R,Ah,!0),":");var W=this.g;return(W||R=="file")&&(y.push("//"),(R=this.o)&&y.push(Ro(R,Ah,!0),"@"),y.push(encodeURIComponent(String(W)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),W=this.s,W!=null&&y.push(":",String(W))),(W=this.l)&&(this.g&&W.charAt(0)!="/"&&y.push("/"),y.push(Ro(W,W.charAt(0)=="/"?Do:Mm,!0))),(W=this.i.toString())&&y.push("?",W),(W=this.m)&&y.push("#",Ro(W,nu)),y.join("")};function qa(y){return new rs(y)}function Yl(y,R,W){y.j=W?Ql(R,!0):R,y.j&&(y.j=y.j.replace(/:$/,""))}function tu(y,R){if(R){if(R=Number(R),isNaN(R)||0>R)throw Error("Bad port number "+R);y.s=R}else y.s=null}function Zd(y,R,W){R instanceof fl?(y.i=R,Vm(y.i,y.h)):(W||(R=Ro(R,ru)),y.i=new fl(R,y.h))}function un(y,R,W){y.i.set(R,W)}function Xl(y){return un(y,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),y}function Ql(y,R){return y?R?decodeURI(y.replace(/%25/g,"%2525")):decodeURIComponent(y):""}function Ro(y,R,W){return typeof y=="string"?(y=encodeURI(y).replace(R,Om),W&&(y=y.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),y):null}function Om(y){return y=y.charCodeAt(0),"%"+(y>>4&15).toString(16)+(y&15).toString(16)}var Ah=/[#\/\?@]/g,Mm=/[#\?:]/g,Do=/[#\?]/g,ru=/[#\?@]/g,nu=/#/g;function fl(y,R){this.h=this.g=null,this.i=y||null,this.j=!!R}function Pn(y){y.g||(y.g=new Map,y.h=0,y.i&&eu(y.i,function(R,W){y.add(decodeURIComponent(R.replace(/\+/g," ")),W)}))}t=fl.prototype,t.add=function(y,R){Pn(this),this.i=null,y=hl(this,y);var W=this.g.get(y);return W||this.g.set(y,W=[]),W.push(R),this.h+=1,this};function Eh(y,R){Pn(y),R=hl(y,R),y.g.has(R)&&(y.i=null,y.h-=y.g.get(R).length,y.g.delete(R))}function ef(y,R){return Pn(y),R=hl(y,R),y.g.has(R)}t.forEach=function(y,R){Pn(this),this.g.forEach(function(W,le){W.forEach(function(Fe){y.call(R,Fe,le,this)},this)},this)},t.na=function(){Pn(this);const y=Array.from(this.g.values()),R=Array.from(this.g.keys()),W=[];for(let le=0;le<R.length;le++){const Fe=y[le];for(let Qe=0;Qe<Fe.length;Qe++)W.push(R[le])}return W},t.V=function(y){Pn(this);let R=[];if(typeof y=="string")ef(this,y)&&(R=R.concat(this.g.get(hl(this,y))));else{y=Array.from(this.g.values());for(let W=0;W<y.length;W++)R=R.concat(y[W])}return R},t.set=function(y,R){return Pn(this),this.i=null,y=hl(this,y),ef(this,y)&&(this.h-=this.g.get(y).length),this.g.set(y,[R]),this.h+=1,this},t.get=function(y,R){return y?(y=this.V(y),0<y.length?String(y[0]):R):R};function wr(y,R,W){Eh(y,R),0<W.length&&(y.i=null,y.g.set(hl(y,R),p(W)),y.h+=W.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const y=[],R=Array.from(this.g.keys());for(var W=0;W<R.length;W++){var le=R[W];const Qe=encodeURIComponent(String(le)),Ct=this.V(le);for(le=0;le<Ct.length;le++){var Fe=Qe;Ct[le]!==""&&(Fe+="="+encodeURIComponent(String(Ct[le]))),y.push(Fe)}}return this.i=y.join("&")};function hl(y,R){return R=String(R),y.j&&(R=R.toLowerCase()),R}function Vm(y,R){R&&!y.j&&(Pn(y),y.i=null,y.g.forEach(function(W,le){var Fe=le.toLowerCase();le!=Fe&&(Eh(this,le),wr(this,Fe,W))},y)),y.j=R}function ao(y,R){const W=new Wr;if(l.Image){const le=new Image;le.onload=h(ji,W,"TestLoadImage: loaded",!0,R,le),le.onerror=h(ji,W,"TestLoadImage: error",!1,R,le),le.onabort=h(ji,W,"TestLoadImage: abort",!1,R,le),le.ontimeout=h(ji,W,"TestLoadImage: timeout",!1,R,le),l.setTimeout(function(){le.ontimeout&&le.ontimeout()},1e4),le.src=y}else R(!1)}function Ch(y,R){const W=new Wr,le=new AbortController,Fe=setTimeout(()=>{le.abort(),ji(W,"TestPingServer: timeout",!1,R)},1e4);fetch(y,{signal:le.signal}).then(Qe=>{clearTimeout(Fe),Qe.ok?ji(W,"TestPingServer: ok",!0,R):ji(W,"TestPingServer: server error",!1,R)}).catch(()=>{clearTimeout(Fe),ji(W,"TestPingServer: error",!1,R)})}function ji(y,R,W,le,Fe){try{Fe&&(Fe.onload=null,Fe.onerror=null,Fe.onabort=null,Fe.ontimeout=null),le(W)}catch{}}function su(){this.g=new mr}function tf(y,R,W){const le=W||"";try{Th(y,function(Fe,Qe){let Ct=Fe;u(Fe)&&(Ct=nt(Fe)),R.push(le+Qe+"="+encodeURIComponent(Ct))})}catch(Fe){throw R.push(le+"type="+encodeURIComponent("_badmap")),Fe}}function au(y){this.l=y.Ub||null,this.j=y.eb||!1}g(au,Wt),au.prototype.g=function(){return new iu(this.l,this.j)},au.prototype.i=function(y){return function(){return y}}({});function iu(y,R){Ye.call(this),this.D=y,this.o=R,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}g(iu,Ye),t=iu.prototype,t.open=function(y,R){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=y,this.A=R,this.readyState=1,Pi(this)},t.send=function(y){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const R={headers:this.u,method:this.B,credentials:this.m,cache:void 0};y&&(R.body=y),(this.D||l).fetch(new Request(this.A,R)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Fo(this)),this.readyState=0},t.Sa=function(y){if(this.g&&(this.l=y,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=y.headers,this.readyState=2,Pi(this)),this.g&&(this.readyState=3,Pi(this),this.g)))if(this.responseType==="arraybuffer")y.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in y){if(this.j=y.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;kh(this)}else y.text().then(this.Ra.bind(this),this.ga.bind(this))};function kh(y){y.j.read().then(y.Pa.bind(y)).catch(y.ga.bind(y))}t.Pa=function(y){if(this.g){if(this.o&&y.value)this.response.push(y.value);else if(!this.o){var R=y.value?y.value:new Uint8Array(0);(R=this.v.decode(R,{stream:!y.done}))&&(this.response=this.responseText+=R)}y.done?Fo(this):Pi(this),this.readyState==3&&kh(this)}},t.Ra=function(y){this.g&&(this.response=this.responseText=y,Fo(this))},t.Qa=function(y){this.g&&(this.response=y,Fo(this))},t.ga=function(){this.g&&Fo(this)};function Fo(y){y.readyState=4,y.l=null,y.j=null,y.v=null,Pi(y)}t.setRequestHeader=function(y,R){this.u.append(y,R)},t.getResponseHeader=function(y){return this.h&&this.h.get(y.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const y=[],R=this.h.entries();for(var W=R.next();!W.done;)W=W.value,y.push(W[0]+": "+W[1]),W=R.next();return y.join(`\r
`)};function Pi(y){y.onreadystatechange&&y.onreadystatechange.call(y)}Object.defineProperty(iu.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(y){this.m=y?"include":"same-origin"}});function Lo(y){let R="";return U(y,function(W,le){R+=le,R+=":",R+=W,R+=`\r
`}),R}function rf(y,R,W){e:{for(le in W){var le=!1;break e}le=!0}le||(W=Lo(W),typeof y=="string"?W!=null&&encodeURIComponent(String(W)):un(y,R,W))}function on(y){Ye.call(this),this.headers=new Map,this.o=y||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}g(on,Ye);var nf=/^https?$/i,ou=["POST","PUT"];t=on.prototype,t.Ha=function(y){this.J=y},t.ea=function(y,R,W,le){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+y);R=R?R.toUpperCase():"GET",this.D=y,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():_e.g(),this.v=this.o?Te(this.o):Te(_e),this.g.onreadystatechange=m(this.Ea,this);try{this.B=!0,this.g.open(R,String(y),!0),this.B=!1}catch(Qe){sf(this,Qe);return}if(y=W||"",W=new Map(this.headers),le)if(Object.getPrototypeOf(le)===Object.prototype)for(var Fe in le)W.set(Fe,le[Fe]);else if(typeof le.keys=="function"&&typeof le.get=="function")for(const Qe of le.keys())W.set(Qe,le.get(Qe));else throw Error("Unknown input type for opt_headers: "+String(le));le=Array.from(W.keys()).find(Qe=>Qe.toLowerCase()=="content-type"),Fe=l.FormData&&y instanceof l.FormData,!(0<=Array.prototype.indexOf.call(ou,R,void 0))||le||Fe||W.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Qe,Ct]of W)this.g.setRequestHeader(Qe,Ct);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Ri(this),this.u=!0,this.g.send(y),this.u=!1}catch(Qe){sf(this,Qe)}};function sf(y,R){y.h=!1,y.g&&(y.j=!0,y.g.abort(),y.j=!1),y.l=R,y.m=5,af(y),Jl(y)}function af(y){y.A||(y.A=!0,It(y,"complete"),It(y,"error"))}t.abort=function(y){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=y||7,It(this,"complete"),It(this,"abort"),Jl(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Jl(this,!0)),on.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?of(this):this.bb())},t.bb=function(){of(this)};function of(y){if(y.h&&typeof i<"u"&&(!y.v[1]||Ms(y)!=4||y.Z()!=2)){if(y.u&&Ms(y)==4)Ot(y.Ea,0,y);else if(It(y,"readystatechange"),Ms(y)==4){y.h=!1;try{const Ct=y.Z();e:switch(Ct){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var R=!0;break e;default:R=!1}var W;if(!(W=R)){var le;if(le=Ct===0){var Fe=String(y.D).match(oi)[1]||null;!Fe&&l.self&&l.self.location&&(Fe=l.self.location.protocol.slice(0,-1)),le=!nf.test(Fe?Fe.toLowerCase():"")}W=le}if(W)It(y,"complete"),It(y,"success");else{y.m=6;try{var Qe=2<Ms(y)?y.g.statusText:""}catch{Qe=""}y.l=Qe+" ["+y.Z()+"]",af(y)}}finally{Jl(y)}}}}function Jl(y,R){if(y.g){Ri(y);const W=y.g,le=y.v[0]?()=>{}:null;y.g=null,y.v=null,R||It(y,"ready");try{W.onreadystatechange=le}catch{}}}function Ri(y){y.I&&(l.clearTimeout(y.I),y.I=null)}t.isActive=function(){return!!this.g};function Ms(y){return y.g?y.g.readyState:0}t.Z=function(){try{return 2<Ms(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(y){if(this.g){var R=this.g.responseText;return y&&R.indexOf(y)==0&&(R=R.substring(y.length)),At(R)}};function Ih(y){try{if(!y.g)return null;if("response"in y.g)return y.g.response;switch(y.H){case"":case"text":return y.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in y.g)return y.g.mozResponseArrayBuffer}return null}catch{return null}}function ml(y){const R={};y=(y.g&&2<=Ms(y)&&y.g.getAllResponseHeaders()||"").split(`\r
`);for(let le=0;le<y.length;le++){if(w(y[le]))continue;var W=I(y[le]);const Fe=W[0];if(W=W[1],typeof W!="string")continue;W=W.trim();const Qe=R[Fe]||[];R[Fe]=Qe,Qe.push(W)}A(R,function(le){return le.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function ia(y,R,W){return W&&W.internalChannelParams&&W.internalChannelParams[y]||R}function lu(y){this.Aa=0,this.i=[],this.j=new Wr,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=ia("failFast",!1,y),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=ia("baseRetryDelayMs",5e3,y),this.cb=ia("retryDelaySeedMs",1e4,y),this.Wa=ia("forwardChannelMaxRetries",2,y),this.wa=ia("forwardChannelRequestTimeoutMs",2e4,y),this.pa=y&&y.xmlHttpFactory||void 0,this.Xa=y&&y.Tb||void 0,this.Ca=y&&y.useFetchStreams||!1,this.L=void 0,this.J=y&&y.supportsCrossDomainXhr||!1,this.K="",this.h=new Lr(y&&y.concurrentRequestLimit),this.Da=new su,this.P=y&&y.fastHandshake||!1,this.O=y&&y.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=y&&y.Rb||!1,y&&y.xa&&this.j.xa(),y&&y.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&y&&y.detectBufferingProxy||!1,this.ja=void 0,y&&y.longPollingTimeout&&0<y.longPollingTimeout&&(this.ja=y.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=lu.prototype,t.la=8,t.G=1,t.connect=function(y,R,W,le){Et(0),this.W=y,this.H=R||{},W&&le!==void 0&&(this.H.OSID=W,this.H.OAID=le),this.F=this.X,this.I=T(this,null,this.W),uu(this)};function Oo(y){if(Zl(y),y.G==3){var R=y.U++,W=qa(y.I);if(un(W,"SID",y.K),un(W,"RID",R),un(W,"TYPE","terminate"),pl(y,W),R=new rt(y,y.j,R),R.L=2,R.v=Xl(qa(W)),W=!1,l.navigator&&l.navigator.sendBeacon)try{W=l.navigator.sendBeacon(R.v.toString(),"")}catch{}!W&&l.Image&&(new Image().src=R.v,W=!0),W||(R.g=Q(R.j,null),R.g.ea(R.v)),R.F=Date.now(),$t(R)}pu(y)}function cu(y){y.g&&(hu(y),y.g.cancel(),y.g=null)}function Zl(y){cu(y),y.u&&(l.clearTimeout(y.u),y.u=null),Mo(y),y.h.cancel(),y.s&&(typeof y.s=="number"&&l.clearTimeout(y.s),y.s=null)}function uu(y){if(!an(y.h)&&!y.s){y.s=!0;var R=y.Ga;de||ye(),se||(de(),se=!0),Y.add(R,y),y.B=0}}function lf(y,R){return As(y.h)>=y.h.j-(y.s?1:0)?!1:y.s?(y.i=R.D.concat(y.i),!0):y.G==1||y.G==2||y.B>=(y.Va?0:y.Wa)?!1:(y.s=Qr(m(y.Ga,y,R),mu(y,y.B)),y.B++,!0)}t.Ga=function(y){if(this.s)if(this.s=null,this.G==1){if(!y){this.U=Math.floor(1e5*Math.random()),y=this.U++;const Fe=new rt(this,this.j,y);let Qe=this.o;if(this.S&&(Qe?(Qe=S(Qe),M(Qe,this.S)):Qe=this.S),this.m!==null||this.O||(Fe.H=Qe,Qe=null),this.P)e:{for(var R=0,W=0;W<this.i.length;W++){t:{var le=this.i[W];if("__data__"in le.map&&(le=le.map.__data__,typeof le=="string")){le=le.length;break t}le=void 0}if(le===void 0)break;if(R+=le,4096<R){R=W;break e}if(R===4096||W===this.i.length-1){R=W+1;break e}}R=1e3}else R=1e3;R=ec(this,Fe,R),W=qa(this.I),un(W,"RID",y),un(W,"CVER",22),this.D&&un(W,"X-HTTP-Session-Id",this.D),pl(this,W),Qe&&(this.O?R="headers="+encodeURIComponent(String(Lo(Qe)))+"&"+R:this.m&&rf(W,this.m,Qe)),Kr(this.h,Fe),this.Ua&&un(W,"TYPE","init"),this.P?(un(W,"$req",R),un(W,"SID","null"),Fe.T=!0,wt(Fe,W,null)):wt(Fe,W,R),this.G=2}}else this.G==3&&(y?du(this,y):this.i.length==0||an(this.h)||du(this))};function du(y,R){var W;R?W=R.l:W=y.U++;const le=qa(y.I);un(le,"SID",y.K),un(le,"RID",W),un(le,"AID",y.T),pl(y,le),y.m&&y.o&&rf(le,y.m,y.o),W=new rt(y,y.j,W,y.B+1),y.m===null&&(W.H=y.o),R&&(y.i=R.D.concat(y.i)),R=ec(y,W,1e3),W.I=Math.round(.5*y.wa)+Math.round(.5*y.wa*Math.random()),Kr(y.h,W),wt(W,le,R)}function pl(y,R){y.H&&U(y.H,function(W,le){un(R,le,W)}),y.l&&Th({},function(W,le){un(R,le,W)})}function ec(y,R,W){W=Math.min(y.i.length,W);var le=y.l?m(y.l.Na,y.l,y):null;e:{var Fe=y.i;let Qe=-1;for(;;){const Ct=["count="+W];Qe==-1?0<W?(Qe=Fe[0].g,Ct.push("ofs="+Qe)):Qe=0:Ct.push("ofs="+Qe);let Ar=!0;for(let Br=0;Br<W;Br++){let Er=Fe[Br].g;const ln=Fe[Br].map;if(Er-=Qe,0>Er)Qe=Math.max(0,Fe[Br].g-100),Ar=!1;else try{tf(ln,Ct,"req"+Er+"_")}catch{le&&le(ln)}}if(Ar){le=Ct.join("&");break e}}}return y=y.i.splice(0,W),R.D=y,le}function fu(y){if(!y.g&&!y.u){y.Y=1;var R=y.Fa;de||ye(),se||(de(),se=!0),Y.add(R,y),y.v=0}}function tc(y){return y.g||y.u||3<=y.v?!1:(y.Y++,y.u=Qr(m(y.Fa,y),mu(y,y.v)),y.v++,!0)}t.Fa=function(){if(this.u=null,jh(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var y=2*this.R;this.j.info("BP detection timer enabled: "+y),this.A=Qr(m(this.ab,this),y)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Et(10),cu(this),jh(this))};function hu(y){y.A!=null&&(l.clearTimeout(y.A),y.A=null)}function jh(y){y.g=new rt(y,y.j,"rpc",y.Y),y.m===null&&(y.g.H=y.o),y.g.O=0;var R=qa(y.qa);un(R,"RID","rpc"),un(R,"SID",y.K),un(R,"AID",y.T),un(R,"CI",y.F?"0":"1"),!y.F&&y.ja&&un(R,"TO",y.ja),un(R,"TYPE","xmlhttp"),pl(y,R),y.m&&y.o&&rf(R,y.m,y.o),y.L&&(y.g.I=y.L);var W=y.g;y=y.ia,W.L=1,W.v=Xl(qa(R)),W.m=null,W.P=!0,Lt(W,y)}t.Za=function(){this.C!=null&&(this.C=null,cu(this),tc(this),Et(19))};function Mo(y){y.C!=null&&(l.clearTimeout(y.C),y.C=null)}function gl(y,R){var W=null;if(y.g==R){Mo(y),hu(y),y.g=null;var le=2}else if(ts(y.h,R))W=R.D,En(y.h,R),le=1;else return;if(y.G!=0){if(R.o)if(le==1){W=R.m?R.m.length:0,R=Date.now()-R.F;var Fe=y.B;le=Qt(),It(le,new qr(le,W)),uu(y)}else fu(y);else if(Fe=R.s,Fe==3||Fe==0&&0<R.X||!(le==1&&lf(y,R)||le==2&&tc(y)))switch(W&&0<W.length&&(R=y.h,R.i=R.i.concat(W)),Fe){case 1:va(y,5);break;case 4:va(y,10);break;case 3:va(y,6);break;default:va(y,2)}}}function mu(y,R){let W=y.Ta+Math.floor(Math.random()*y.cb);return y.isActive()||(W*=2),W*R}function va(y,R){if(y.j.info("Error code "+R),R==2){var W=m(y.fb,y),le=y.Xa;const Fe=!le;le=new rs(le||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||Yl(le,"https"),Xl(le),Fe?ao(le.toString(),W):Ch(le.toString(),W)}else Et(2);y.G=0,y.l&&y.l.sa(R),pu(y),Zl(y)}t.fb=function(y){y?(this.j.info("Successfully pinged google.com"),Et(2)):(this.j.info("Failed to ping google.com"),Et(1))};function pu(y){if(y.G=0,y.ka=[],y.l){const R=Es(y.h);(R.length!=0||y.i.length!=0)&&(v(y.ka,R),v(y.ka,y.i),y.h.i.length=0,p(y.i),y.i.length=0),y.l.ra()}}function T(y,R,W){var le=W instanceof rs?qa(W):new rs(W);if(le.g!="")R&&(le.g=R+"."+le.g),tu(le,le.s);else{var Fe=l.location;le=Fe.protocol,R=R?R+"."+Fe.hostname:Fe.hostname,Fe=+Fe.port;var Qe=new rs(null);le&&Yl(Qe,le),R&&(Qe.g=R),Fe&&tu(Qe,Fe),W&&(Qe.l=W),le=Qe}return W=y.D,R=y.ya,W&&R&&un(le,W,R),un(le,"VER",y.la),pl(y,le),le}function Q(y,R,W){if(R&&!y.J)throw Error("Can't create secondary domain capable XhrIo object.");return R=y.Ca&&!y.pa?new on(new au({eb:W})):new on(y.pa),R.Ha(y.J),R}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Se(){}t=Se.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function ke(){}ke.prototype.g=function(y,R){return new Le(y,R)};function Le(y,R){Ye.call(this),this.g=new lu(R),this.l=y,this.h=R&&R.messageUrlParams||null,y=R&&R.messageHeaders||null,R&&R.clientProtocolHeaderRequired&&(y?y["X-Client-Protocol"]="webchannel":y={"X-Client-Protocol":"webchannel"}),this.g.o=y,y=R&&R.initMessageHeaders||null,R&&R.messageContentType&&(y?y["X-WebChannel-Content-Type"]=R.messageContentType:y={"X-WebChannel-Content-Type":R.messageContentType}),R&&R.va&&(y?y["X-WebChannel-Client-Profile"]=R.va:y={"X-WebChannel-Client-Profile":R.va}),this.g.S=y,(y=R&&R.Sb)&&!w(y)&&(this.g.m=y),this.v=R&&R.supportsCrossDomainXhr||!1,this.u=R&&R.sendRawJson||!1,(R=R&&R.httpSessionIdParam)&&!w(R)&&(this.g.D=R,y=this.h,y!==null&&R in y&&(y=this.h,R in y&&delete y[R])),this.j=new Gt(this)}g(Le,Ye),Le.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Le.prototype.close=function(){Oo(this.g)},Le.prototype.o=function(y){var R=this.g;if(typeof y=="string"){var W={};W.__data__=y,y=W}else this.u&&(W={},W.__data__=nt(y),y=W);R.i.push(new xr(R.Ya++,y)),R.G==3&&uu(R)},Le.prototype.N=function(){this.g.l=null,delete this.j,Oo(this.g),delete this.g,Le.aa.N.call(this)};function ot(y){St.call(this),y.__headers__&&(this.headers=y.__headers__,this.statusCode=y.__status__,delete y.__headers__,delete y.__status__);var R=y.__sm__;if(R){e:{for(const W in R){y=W;break e}y=void 0}(this.i=y)&&(y=this.i,R=R!==null&&y in R?R[y]:void 0),this.data=R}else this.data=y}g(ot,St);function Tt(){vt.call(this),this.status=1}g(Tt,vt);function Gt(y){this.g=y}g(Gt,Se),Gt.prototype.ua=function(){It(this.g,"a")},Gt.prototype.ta=function(y){It(this.g,new ot(y))},Gt.prototype.sa=function(y){It(this.g,new Tt)},Gt.prototype.ra=function(){It(this.g,"b")},ke.prototype.createWebChannel=ke.prototype.g,Le.prototype.send=Le.prototype.o,Le.prototype.open=Le.prototype.m,Le.prototype.close=Le.prototype.close,zP=function(){return new ke},$P=function(){return Qt()},UP=st,a_={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},ge.NO_ERROR=0,ge.TIMEOUT=8,ge.HTTP_ERROR=6,Ty=ge,we.COMPLETE="complete",BP=we,je.EventType=et,et.OPEN="a",et.CLOSE="b",et.ERROR="c",et.MESSAGE="d",Ye.prototype.listen=Ye.prototype.K,Sp=je,on.prototype.listenOnce=on.prototype.L,on.prototype.getLastError=on.prototype.Ka,on.prototype.getLastErrorCode=on.prototype.Ba,on.prototype.getStatus=on.prototype.Z,on.prototype.getResponseJson=on.prototype.Oa,on.prototype.getResponseText=on.prototype.oa,on.prototype.send=on.prototype.ea,on.prototype.setWithCredentials=on.prototype.Ha,VP=on}).apply(typeof L1<"u"?L1:typeof self<"u"?self:typeof window<"u"?window:{});const qA="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ea=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};ea.UNAUTHENTICATED=new ea(null),ea.GOOGLE_CREDENTIALS=new ea("google-credentials-uid"),ea.FIRST_PARTY=new ea("first-party-uid"),ea.MOCK_USER=new ea("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Cm="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xf=new m4("@firebase/firestore");function i0(){return Xf.logLevel}function kt(t,...e){if(Xf.logLevel<=$r.DEBUG){const r=e.map(A4);Xf.debug(`Firestore (${Cm}): ${t}`,...r)}}function bs(t,...e){if(Xf.logLevel<=$r.ERROR){const r=e.map(A4);Xf.error(`Firestore (${Cm}): ${t}`,...r)}}function Qf(t,...e){if(Xf.logLevel<=$r.WARN){const r=e.map(A4);Xf.warn(`Firestore (${Cm}): ${t}`,...r)}}function A4(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tr(t="Unexpected state"){const e=`FIRESTORE (${Cm}) INTERNAL ASSERTION FAILED: `+t;throw bs(e),new Error(e)}function ar(t,e){t||tr()}function rr(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dt={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Bt extends Gc{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ul{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qP{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class iq{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(ea.UNAUTHENTICATED))}shutdown(){}}class oq{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class lq{constructor(e){this.t=e,this.currentUser=ea.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){ar(this.o===void 0);let n=this.i;const s=c=>this.i!==n?(n=this.i,r(c)):Promise.resolve();let a=new Ul;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new Ul,e.enqueueRetryable(()=>s(this.currentUser))};const i=()=>{const c=a;e.enqueueRetryable(async()=>{await c.promise,await s(this.currentUser)})},l=c=>{kt("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),i())};this.t.onInit(c=>l(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?l(c):(kt("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new Ul)}},0),i()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(kt("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(ar(typeof n.accessToken=="string"),new qP(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ar(e===null||typeof e=="string"),new ea(e)}}class cq{constructor(e,r,n){this.l=e,this.h=r,this.P=n,this.type="FirstParty",this.user=ea.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class uq{constructor(e,r,n){this.l=e,this.h=r,this.P=n}getToken(){return Promise.resolve(new cq(this.l,this.h,this.P))}start(e,r){e.enqueueRetryable(()=>r(ea.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class dq{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class fq{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,r){ar(this.o===void 0);const n=a=>{a.error!=null&&kt("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const i=a.token!==this.R;return this.R=a.token,kt("FirebaseAppCheckTokenProvider",`Received ${i?"new":"existing"} token.`),i?r(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable(()=>n(a))};const s=a=>{kt("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(a=>s(a)),setTimeout(()=>{if(!this.appCheck){const a=this.A.getImmediate({optional:!0});a?s(a):kt("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(ar(typeof r.token=="string"),this.R=r.token,new dq(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hq(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WP{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=Math.floor(256/e.length)*e.length;let n="";for(;n.length<20;){const s=hq(40);for(let a=0;a<s.length;++a)n.length<20&&s[a]<r&&(n+=e.charAt(s[a]%e.length))}return n}}function kr(t,e){return t<e?-1:t>e?1:0}function rm(t,e,r){return t.length===e.length&&t.every((n,s)=>r(n,e[s]))}function HP(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ft{constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new Bt(dt.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new Bt(dt.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<-62135596800)throw new Bt(dt.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Bt(dt.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return ft.fromMillis(Date.now())}static fromDate(e){return ft.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*r));return new ft(r,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?kr(this.nanoseconds,e.nanoseconds):kr(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ur{constructor(e){this.timestamp=e}static fromTimestamp(e){return new ur(e)}static min(){return new ur(new ft(0,0))}static max(){return new ur(new ft(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pg{constructor(e,r,n){r===void 0?r=0:r>e.length&&tr(),n===void 0?n=e.length-r:n>e.length-r&&tr(),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return Pg.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof Pg?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let s=0;s<n;s++){const a=e.get(s),i=r.get(s);if(a<i)return-1;if(a>i)return 1}return e.length<r.length?-1:e.length>r.length?1:0}}class cn extends Pg{construct(e,r,n){return new cn(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new Bt(dt.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(s=>s.length>0))}return new cn(r)}static emptyPath(){return new cn([])}}const mq=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Yn extends Pg{construct(e,r,n){return new Yn(e,r,n)}static isValidIdentifier(e){return mq.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Yn.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Yn(["__name__"])}static fromServerFormat(e){const r=[];let n="",s=0;const a=()=>{if(n.length===0)throw new Bt(dt.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let i=!1;for(;s<e.length;){const l=e[s];if(l==="\\"){if(s+1===e.length)throw new Bt(dt.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[s+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new Bt(dt.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=c,s+=2}else l==="`"?(i=!i,s++):l!=="."||i?(n+=l,s++):(a(),s++)}if(a(),i)throw new Bt(dt.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Yn(r)}static emptyPath(){return new Yn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yt{constructor(e){this.path=e}static fromPath(e){return new Yt(cn.fromString(e))}static fromName(e){return new Yt(cn.fromString(e).popFirst(5))}static empty(){return new Yt(cn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&cn.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return cn.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Yt(new cn(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _v{constructor(e,r,n,s){this.indexId=e,this.collectionGroup=r,this.fields=n,this.indexState=s}}function i_(t){return t.fields.find(e=>e.kind===2)}function vf(t){return t.fields.filter(e=>e.kind!==2)}_v.UNKNOWN_ID=-1;class Ay{constructor(e,r){this.fieldPath=e,this.kind=r}}class Rg{constructor(e,r){this.sequenceNumber=e,this.offset=r}static empty(){return new Rg(0,to.min())}}function GP(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,s=ur.fromTimestamp(n===1e9?new ft(r+1,0):new ft(r,n));return new to(s,Yt.empty(),e)}function KP(t){return new to(t.readTime,t.key,-1)}class to{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new to(ur.min(),Yt.empty(),-1)}static max(){return new to(ur.max(),Yt.empty(),-1)}}function E4(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=Yt.comparator(t.documentKey,e.documentKey),r!==0?r:kr(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YP="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class XP{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Wd(t){if(t.code!==dt.FAILED_PRECONDITION||t.message!==YP)throw t;kt("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Je{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&tr(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new Je((n,s)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(n,s)},this.catchCallback=a=>{this.wrapFailure(r,a).next(n,s)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof Je?r:Je.resolve(r)}catch(r){return Je.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):Je.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):Je.reject(r)}static resolve(e){return new Je((r,n)=>{r(e)})}static reject(e){return new Je((r,n)=>{n(e)})}static waitFor(e){return new Je((r,n)=>{let s=0,a=0,i=!1;e.forEach(l=>{++s,l.next(()=>{++a,i&&a===s&&r()},c=>n(c))}),i=!0,a===s&&r()})}static or(e){let r=Je.resolve(!1);for(const n of e)r=r.next(s=>s?Je.resolve(s):n());return r}static forEach(e,r){const n=[];return e.forEach((s,a)=>{n.push(r.call(this,s,a))}),this.waitFor(n)}static mapArray(e,r){return new Je((n,s)=>{const a=e.length,i=new Array(a);let l=0;for(let c=0;c<a;c++){const u=c;r(e[u]).next(d=>{i[u]=d,++l,l===a&&n(i)},d=>s(d))}})}static doWhile(e,r){return new Je((n,s)=>{const a=()=>{e()===!0?r().next(()=>{a()},s):n()};a()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P2{constructor(e,r){this.action=e,this.transaction=r,this.aborted=!1,this.V=new Ul,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{r.error?this.V.reject(new qp(e,r.error)):this.V.resolve()},this.transaction.onerror=n=>{const s=C4(n.target.error);this.V.reject(new qp(e,s))}}static open(e,r,n,s){try{return new P2(r,e.transaction(s,n))}catch(a){throw new qp(r,a)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(kt("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const r=this.transaction.objectStore(e);return new gq(r)}}class md{constructor(e,r,n){this.name=e,this.version=r,this.p=n,md.S(Ws())===12.2&&bs("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return kt("SimpleDb","Removing database:",e),wf(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!Qj())return!1;if(md.v())return!0;const e=Ws(),r=md.S(e),n=0<r&&r<10,s=QP(e),a=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||a)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.C)==="YES"}static F(e,r){return e.store(r)}static S(e){const r=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=r?r[1].split("_").slice(0,2).join("."):"-1";return Number(n)}async M(e){return this.db||(kt("SimpleDb","Opening database:",this.name),this.db=await new Promise((r,n)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=a=>{const i=a.target.result;r(i)},s.onblocked=()=>{n(new qp(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=a=>{const i=a.target.error;i.name==="VersionError"?n(new Bt(dt.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):i.name==="InvalidStateError"?n(new Bt(dt.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+i)):n(new qp(e,i))},s.onupgradeneeded=a=>{kt("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',a.oldVersion);const i=a.target.result;this.p.O(i,s.transaction,a.oldVersion,this.version).next(()=>{kt("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=r=>this.N(r)),this.db}L(e){this.N=e,this.db&&(this.db.onversionchange=r=>e(r))}async runTransaction(e,r,n,s){const a=r==="readonly";let i=0;for(;;){++i;try{this.db=await this.M(e);const l=P2.open(this.db,e,a?"readonly":"readwrite",n),c=s(l).next(u=>(l.g(),u)).catch(u=>(l.abort(u),Je.reject(u))).toPromise();return c.catch(()=>{}),await l.m,c}catch(l){const c=l,u=c.name!=="FirebaseError"&&i<3;if(kt("SimpleDb","Transaction failed with error:",c.message,"Retrying:",u),this.close(),!u)return Promise.reject(c)}}}close(){this.db&&this.db.close(),this.db=void 0}}function QP(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}class pq{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return wf(this.B.delete())}}class qp extends Bt{constructor(e,r){super(dt.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${r}`),this.name="IndexedDbTransactionError"}}function Hd(t){return t.name==="IndexedDbTransactionError"}class gq{constructor(e){this.store=e}put(e,r){let n;return r!==void 0?(kt("SimpleDb","PUT",this.store.name,e,r),n=this.store.put(r,e)):(kt("SimpleDb","PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),wf(n)}add(e){return kt("SimpleDb","ADD",this.store.name,e,e),wf(this.store.add(e))}get(e){return wf(this.store.get(e)).next(r=>(r===void 0&&(r=null),kt("SimpleDb","GET",this.store.name,e,r),r))}delete(e){return kt("SimpleDb","DELETE",this.store.name,e),wf(this.store.delete(e))}count(){return kt("SimpleDb","COUNT",this.store.name),wf(this.store.count())}U(e,r){const n=this.options(e,r),s=n.index?this.store.index(n.index):this.store;if(typeof s.getAll=="function"){const a=s.getAll(n.range);return new Je((i,l)=>{a.onerror=c=>{l(c.target.error)},a.onsuccess=c=>{i(c.target.result)}})}{const a=this.cursor(n),i=[];return this.W(a,(l,c)=>{i.push(c)}).next(()=>i)}}G(e,r){const n=this.store.getAll(e,r===null?void 0:r);return new Je((s,a)=>{n.onerror=i=>{a(i.target.error)},n.onsuccess=i=>{s(i.target.result)}})}j(e,r){kt("SimpleDb","DELETE ALL",this.store.name);const n=this.options(e,r);n.H=!1;const s=this.cursor(n);return this.W(s,(a,i,l)=>l.delete())}J(e,r){let n;r?n=e:(n={},r=e);const s=this.cursor(n);return this.W(s,r)}Y(e){const r=this.cursor({});return new Je((n,s)=>{r.onerror=a=>{const i=C4(a.target.error);s(i)},r.onsuccess=a=>{const i=a.target.result;i?e(i.primaryKey,i.value).next(l=>{l?i.continue():n()}):n()}})}W(e,r){const n=[];return new Je((s,a)=>{e.onerror=i=>{a(i.target.error)},e.onsuccess=i=>{const l=i.target.result;if(!l)return void s();const c=new pq(l),u=r(l.primaryKey,l.value,c);if(u instanceof Je){const d=u.catch(f=>(c.done(),Je.reject(f)));n.push(d)}c.isDone?s():c.K===null?l.continue():l.continue(c.K)}}).next(()=>Je.waitFor(n))}options(e,r){let n;return e!==void 0&&(typeof e=="string"?n=e:r=e),{index:n,range:r}}cursor(e){let r="next";if(e.reverse&&(r="prev"),e.index){const n=this.store.index(e.index);return e.H?n.openKeyCursor(e.range,r):n.openCursor(e.range,r)}return this.store.openCursor(e.range,r)}}function wf(t){return new Je((e,r)=>{t.onsuccess=n=>{const s=n.target.result;e(s)},t.onerror=n=>{const s=C4(n.target.error);r(s)}})}let WA=!1;function C4(t){const e=md.S(Ws());if(e>=12.2&&e<13){const r="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(r)>=0){const n=new Bt("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${r}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return WA||(WA=!0,setTimeout(()=>{throw n},0)),n}}return t}class xq{constructor(e,r){this.asyncQueue=e,this.Z=r,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){kt("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{kt("IndexBackfiller",`Documents written: ${await this.Z.ee()}`)}catch(r){Hd(r)?kt("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",r):await Wd(r)}await this.X(6e4)})}}class yq{constructor(e,r){this.localStore=e,this.persistence=r}async ee(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",r=>this.te(r,e))}te(e,r){const n=new Set;let s=r,a=!0;return Je.doWhile(()=>a===!0&&s>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(i=>{if(i!==null&&!n.has(i))return kt("IndexBackfiller",`Processing collection: ${i}`),this.ne(e,i,s).next(l=>{s-=l,n.add(i)});a=!1})).next(()=>r-s)}ne(e,r,n){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,r).next(s=>this.localStore.localDocuments.getNextDocuments(e,r,s,n).next(a=>{const i=a.changes;return this.localStore.indexManager.updateIndexEntries(e,i).next(()=>this.re(s,a)).next(l=>(kt("IndexBackfiller",`Updating offset: ${l}`),this.localStore.indexManager.updateCollectionGroup(e,r,l))).next(()=>i.size)}))}re(e,r){let n=e;return r.changes.forEach((s,a)=>{const i=KP(a);E4(i,n)>0&&(n=i)}),new to(n.readTime,n.documentKey,Math.max(r.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bi{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ie(n),this.se=n=>r.writeSequenceNumber(n))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}bi.oe=-1;function R2(t){return t==null}function Dg(t){return t===0&&1/t==-1/0}function JP(t){return typeof t=="number"&&Number.isInteger(t)&&!Dg(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ti(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=HA(e)),e=vq(t.get(r),e);return HA(e)}function vq(t,e){let r=e;const n=t.length;for(let s=0;s<n;s++){const a=t.charAt(s);switch(a){case"\0":r+="";break;case"":r+="";break;default:r+=a}}return r}function HA(t){return t+""}function jl(t){const e=t.length;if(ar(e>=2),e===2)return ar(t.charAt(0)===""&&t.charAt(1)===""),cn.emptyPath();const r=e-2,n=[];let s="";for(let a=0;a<e;){const i=t.indexOf("",a);switch((i<0||i>r)&&tr(),t.charAt(i+1)){case"":const l=t.substring(a,i);let c;s.length===0?c=l:(s+=l,c=s,s=""),n.push(c);break;case"":s+=t.substring(a,i),s+="\0";break;case"":s+=t.substring(a,i+1);break;default:tr()}a=i+2}return new cn(n)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GA=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ey(t,e){return[t,ti(e)]}function ZP(t,e,r){return[t,ti(e),r]}const bq={},wq=["prefixPath","collectionGroup","readTime","documentId"],_q=["prefixPath","collectionGroup","documentId"],Nq=["collectionGroup","readTime","prefixPath","documentId"],Sq=["canonicalId","targetId"],Tq=["targetId","path"],Aq=["path","targetId"],Eq=["collectionId","parent"],Cq=["indexId","uid"],kq=["uid","sequenceNumber"],Iq=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],jq=["indexId","uid","orderedDocumentKey"],Pq=["userId","collectionPath","documentId"],Rq=["userId","collectionPath","largestBatchId"],Dq=["userId","collectionGroup","largestBatchId"],e8=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],Fq=[...e8,"documentOverlays"],t8=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],r8=t8,k4=[...r8,"indexConfiguration","indexState","indexEntries"],Lq=k4,Oq=[...k4,"globals"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o_ extends XP{constructor(e,r){super(),this._e=e,this.currentSequenceNumber=r}}function Gs(t,e){const r=rr(t);return md.F(r._e,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KA(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function gh(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function n8(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jn{constructor(e,r){this.comparator=e,this.root=r||fa.EMPTY}insert(e,r){return new jn(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,fa.BLACK,null,null))}remove(e){return new jn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,fa.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const s=this.comparator(e,n.key);if(s===0)return r+n.left.size;s<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new O1(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new O1(this.root,e,this.comparator,!1)}getReverseIterator(){return new O1(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new O1(this.root,e,this.comparator,!0)}}class O1{constructor(e,r,n,s){this.isReverse=s,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=r?n(e.key,r):1,r&&s&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(a===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class fa{constructor(e,r,n,s,a){this.key=e,this.value=r,this.color=n??fa.RED,this.left=s??fa.EMPTY,this.right=a??fa.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,s,a){return new fa(e??this.key,r??this.value,n??this.color,s??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let s=this;const a=n(e,s.key);return s=a<0?s.copy(null,null,null,s.left.insert(e,r,n),null):a===0?s.copy(null,r,null,null,null):s.copy(null,null,null,null,s.right.insert(e,r,n)),s.fixUp()}removeMin(){if(this.left.isEmpty())return fa.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,s=this;if(r(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,r),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),r(e,s.key)===0){if(s.right.isEmpty())return fa.EMPTY;n=s.right.min(),s=s.copy(n.key,n.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,r))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,fa.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,fa.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw tr();const e=this.left.check();if(e!==this.right.check())throw tr();return e+(this.isRed()?0:1)}}fa.EMPTY=null,fa.RED=!0,fa.BLACK=!1;fa.EMPTY=new class{constructor(){this.size=0}get key(){throw tr()}get value(){throw tr()}get color(){throw tr()}get left(){throw tr()}get right(){throw tr()}copy(e,r,n,s,a){return this}insert(e,r,n){return new fa(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _n{constructor(e){this.comparator=e,this.data=new jn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const s=n.getNext();if(this.comparator(s.key,e[1])>=0)return;r(s.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new YA(this.data.getIterator())}getIteratorFrom(e){return new YA(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof _n)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const s=r.getNext().key,a=n.getNext().key;if(this.comparator(s,a)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new _n(this.comparator);return r.data=e,r}}class YA{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Gh(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wi{constructor(e){this.fields=e,e.sort(Yn.comparator)}static empty(){return new wi([])}unionWith(e){let r=new _n(Yn.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new wi(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return rm(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s8 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ss{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(s){try{return atob(s)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new s8("Invalid base64 string: "+a):a}}(e);return new Ss(r)}static fromUint8Array(e){const r=function(s){let a="";for(let i=0;i<s.length;++i)a+=String.fromCharCode(s[i]);return a}(e);return new Ss(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let s=0;s<r.length;s++)n[s]=r.charCodeAt(s);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return kr(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ss.EMPTY_BYTE_STRING=new Ss("");const Mq=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Bc(t){if(ar(!!t),typeof t=="string"){let e=0;const r=Mq.exec(t);if(ar(!!r),r[1]){let s=r[1];s=(s+"000000000").substr(0,9),e=Number(s)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:zn(t.seconds),nanos:zn(t.nanos)}}function zn(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Nd(t){return typeof t=="string"?Ss.fromBase64String(t):Ss.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I4(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="server_timestamp"}function j4(t){const e=t.mapValue.fields.__previous_value__;return I4(e)?j4(e):e}function Fg(t){const e=Bc(t.mapValue.fields.__local_write_time__.timestampValue);return new ft(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vq{constructor(e,r,n,s,a,i,l,c,u){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=s,this.ssl=a,this.forceLongPolling=i,this.autoDetectLongPolling=l,this.longPollingOptions=c,this.useFetchStreams=u}}class Jf{constructor(e,r){this.projectId=e,this.database=r||"(default)"}static empty(){return new Jf("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Jf&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ju={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Cy={nullValue:"NULL_VALUE"};function Zf(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?I4(t)?4:a8(t)?9007199254740991:D2(t)?10:11:tr()}function zl(t,e){if(t===e)return!0;const r=Zf(t);if(r!==Zf(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Fg(t).isEqual(Fg(e));case 3:return function(s,a){if(typeof s.timestampValue=="string"&&typeof a.timestampValue=="string"&&s.timestampValue.length===a.timestampValue.length)return s.timestampValue===a.timestampValue;const i=Bc(s.timestampValue),l=Bc(a.timestampValue);return i.seconds===l.seconds&&i.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,a){return Nd(s.bytesValue).isEqual(Nd(a.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,a){return zn(s.geoPointValue.latitude)===zn(a.geoPointValue.latitude)&&zn(s.geoPointValue.longitude)===zn(a.geoPointValue.longitude)}(t,e);case 2:return function(s,a){if("integerValue"in s&&"integerValue"in a)return zn(s.integerValue)===zn(a.integerValue);if("doubleValue"in s&&"doubleValue"in a){const i=zn(s.doubleValue),l=zn(a.doubleValue);return i===l?Dg(i)===Dg(l):isNaN(i)&&isNaN(l)}return!1}(t,e);case 9:return rm(t.arrayValue.values||[],e.arrayValue.values||[],zl);case 10:case 11:return function(s,a){const i=s.mapValue.fields||{},l=a.mapValue.fields||{};if(KA(i)!==KA(l))return!1;for(const c in i)if(i.hasOwnProperty(c)&&(l[c]===void 0||!zl(i[c],l[c])))return!1;return!0}(t,e);default:return tr()}}function Lg(t,e){return(t.values||[]).find(r=>zl(r,e))!==void 0}function Sd(t,e){if(t===e)return 0;const r=Zf(t),n=Zf(e);if(r!==n)return kr(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return kr(t.booleanValue,e.booleanValue);case 2:return function(a,i){const l=zn(a.integerValue||a.doubleValue),c=zn(i.integerValue||i.doubleValue);return l<c?-1:l>c?1:l===c?0:isNaN(l)?isNaN(c)?0:-1:1}(t,e);case 3:return XA(t.timestampValue,e.timestampValue);case 4:return XA(Fg(t),Fg(e));case 5:return kr(t.stringValue,e.stringValue);case 6:return function(a,i){const l=Nd(a),c=Nd(i);return l.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(a,i){const l=a.split("/"),c=i.split("/");for(let u=0;u<l.length&&u<c.length;u++){const d=kr(l[u],c[u]);if(d!==0)return d}return kr(l.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(a,i){const l=kr(zn(a.latitude),zn(i.latitude));return l!==0?l:kr(zn(a.longitude),zn(i.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return QA(t.arrayValue,e.arrayValue);case 10:return function(a,i){var l,c,u,d;const f=a.fields||{},m=i.fields||{},h=(l=f.value)===null||l===void 0?void 0:l.arrayValue,g=(c=m.value)===null||c===void 0?void 0:c.arrayValue,p=kr(((u=h==null?void 0:h.values)===null||u===void 0?void 0:u.length)||0,((d=g==null?void 0:g.values)===null||d===void 0?void 0:d.length)||0);return p!==0?p:QA(h,g)}(t.mapValue,e.mapValue);case 11:return function(a,i){if(a===Ju.mapValue&&i===Ju.mapValue)return 0;if(a===Ju.mapValue)return 1;if(i===Ju.mapValue)return-1;const l=a.fields||{},c=Object.keys(l),u=i.fields||{},d=Object.keys(u);c.sort(),d.sort();for(let f=0;f<c.length&&f<d.length;++f){const m=kr(c[f],d[f]);if(m!==0)return m;const h=Sd(l[c[f]],u[d[f]]);if(h!==0)return h}return kr(c.length,d.length)}(t.mapValue,e.mapValue);default:throw tr()}}function XA(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return kr(t,e);const r=Bc(t),n=Bc(e),s=kr(r.seconds,n.seconds);return s!==0?s:kr(r.nanos,n.nanos)}function QA(t,e){const r=t.values||[],n=e.values||[];for(let s=0;s<r.length&&s<n.length;++s){const a=Sd(r[s],n[s]);if(a)return a}return kr(r.length,n.length)}function nm(t){return l_(t)}function l_(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=Bc(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return Nd(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return Yt.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",s=!0;for(const a of r.values||[])s?s=!1:n+=",",n+=l_(a);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let s="{",a=!0;for(const i of n)a?a=!1:s+=",",s+=`${i}:${l_(r.fields[i])}`;return s+"}"}(t.mapValue):tr()}function Og(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function c_(t){return!!t&&"integerValue"in t}function Mg(t){return!!t&&"arrayValue"in t}function JA(t){return!!t&&"nullValue"in t}function ZA(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function ky(t){return!!t&&"mapValue"in t}function D2(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="__vector__"}function Wp(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return gh(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=Wp(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=Wp(t.arrayValue.values[r]);return e}return Object.assign({},t)}function a8(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}const i8={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function Bq(t){return"nullValue"in t?Cy:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?Og(Jf.empty(),Yt.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?D2(t)?i8:{mapValue:{}}:tr()}function Uq(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?Og(Jf.empty(),Yt.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?i8:"mapValue"in t?D2(t)?{mapValue:{}}:Ju:tr()}function eE(t,e){const r=Sd(t.value,e.value);return r!==0?r:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function tE(t,e){const r=Sd(t.value,e.value);return r!==0?r:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Da{constructor(e){this.value=e}static empty(){return new Da({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!ky(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=Wp(r)}setAll(e){let r=Yn.emptyPath(),n={},s=[];e.forEach((i,l)=>{if(!r.isImmediateParentOf(l)){const c=this.getFieldsMap(r);this.applyChanges(c,n,s),n={},s=[],r=l.popLast()}i?n[l.lastSegment()]=Wp(i):s.push(l.lastSegment())});const a=this.getFieldsMap(r);this.applyChanges(a,n,s)}delete(e){const r=this.field(e.popLast());ky(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return zl(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let s=r.mapValue.fields[e.get(n)];ky(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=s),r=s}return r.mapValue.fields}applyChanges(e,r,n){gh(r,(s,a)=>e[s]=a);for(const s of n)delete e[s]}clone(){return new Da(Wp(this.value))}}function o8(t){const e=[];return gh(t.fields,(r,n)=>{const s=new Yn([r]);if(ky(n)){const a=o8(n.mapValue).fields;if(a.length===0)e.push(s);else for(const i of a)e.push(s.child(i))}else e.push(s)}),new wi(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ls{constructor(e,r,n,s,a,i,l){this.key=e,this.documentType=r,this.version=n,this.readTime=s,this.createTime=a,this.data=i,this.documentState=l}static newInvalidDocument(e){return new ls(e,0,ur.min(),ur.min(),ur.min(),Da.empty(),0)}static newFoundDocument(e,r,n,s){return new ls(e,1,r,ur.min(),n,s,0)}static newNoDocument(e,r){return new ls(e,2,r,ur.min(),ur.min(),Da.empty(),0)}static newUnknownDocument(e,r){return new ls(e,3,r,ur.min(),ur.min(),Da.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(ur.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Da.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Da.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ur.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof ls&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new ls(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sm{constructor(e,r){this.position=e,this.inclusive=r}}function rE(t,e,r){let n=0;for(let s=0;s<t.position.length;s++){const a=e[s],i=t.position[s];if(a.field.isKeyField()?n=Yt.comparator(Yt.fromName(i.referenceValue),r.key):n=Sd(i,r.data.field(a.field)),a.dir==="desc"&&(n*=-1),n!==0)break}return n}function nE(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!zl(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vg{constructor(e,r="asc"){this.field=e,this.dir=r}}function $q(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let l8=class{};class zr extends l8{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new zq(e,r,n):r==="array-contains"?new Hq(e,n):r==="in"?new m8(e,n):r==="not-in"?new Gq(e,n):r==="array-contains-any"?new Kq(e,n):new zr(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new qq(e,n):new Wq(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&this.matchesComparison(Sd(r,this.value)):r!==null&&Zf(this.value)===Zf(r)&&this.matchesComparison(Sd(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return tr()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class gn extends l8{constructor(e,r){super(),this.filters=e,this.op=r,this.ae=null}static create(e,r){return new gn(e,r)}matches(e){return am(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function am(t){return t.op==="and"}function u_(t){return t.op==="or"}function P4(t){return c8(t)&&am(t)}function c8(t){for(const e of t.filters)if(e instanceof gn)return!1;return!0}function d_(t){if(t instanceof zr)return t.field.canonicalString()+t.op.toString()+nm(t.value);if(P4(t))return t.filters.map(e=>d_(e)).join(",");{const e=t.filters.map(r=>d_(r)).join(",");return`${t.op}(${e})`}}function u8(t,e){return t instanceof zr?function(n,s){return s instanceof zr&&n.op===s.op&&n.field.isEqual(s.field)&&zl(n.value,s.value)}(t,e):t instanceof gn?function(n,s){return s instanceof gn&&n.op===s.op&&n.filters.length===s.filters.length?n.filters.reduce((a,i,l)=>a&&u8(i,s.filters[l]),!0):!1}(t,e):void tr()}function d8(t,e){const r=t.filters.concat(e);return gn.create(r,t.op)}function f8(t){return t instanceof zr?function(r){return`${r.field.canonicalString()} ${r.op} ${nm(r.value)}`}(t):t instanceof gn?function(r){return r.op.toString()+" {"+r.getFilters().map(f8).join(" ,")+"}"}(t):"Filter"}class zq extends zr{constructor(e,r,n){super(e,r,n),this.key=Yt.fromName(n.referenceValue)}matches(e){const r=Yt.comparator(e.key,this.key);return this.matchesComparison(r)}}class qq extends zr{constructor(e,r){super(e,"in",r),this.keys=h8("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class Wq extends zr{constructor(e,r){super(e,"not-in",r),this.keys=h8("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function h8(t,e){var r;return(((r=e.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(n=>Yt.fromName(n.referenceValue))}class Hq extends zr{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return Mg(r)&&Lg(r.arrayValue,this.value)}}class m8 extends zr{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&Lg(this.value.arrayValue,r)}}class Gq extends zr{constructor(e,r){super(e,"not-in",r)}matches(e){if(Lg(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&!Lg(this.value.arrayValue,r)}}class Kq extends zr{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!Mg(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>Lg(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yq{constructor(e,r=null,n=[],s=[],a=null,i=null,l=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=s,this.limit=a,this.startAt=i,this.endAt=l,this.ue=null}}function f_(t,e=null,r=[],n=[],s=null,a=null,i=null){return new Yq(t,e,r,n,s,a,i)}function eh(t){const e=rr(t);if(e.ue===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>d_(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(a){return a.field.canonicalString()+a.dir}(n)).join(","),R2(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>nm(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>nm(n)).join(",")),e.ue=r}return e.ue}function Nx(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!$q(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!u8(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!nE(t.startAt,e.startAt)&&nE(t.endAt,e.endAt)}function Nv(t){return Yt.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function Sv(t,e){return t.filters.filter(r=>r instanceof zr&&r.field.isEqual(e))}function sE(t,e,r){let n=Cy,s=!0;for(const a of Sv(t,e)){let i=Cy,l=!0;switch(a.op){case"<":case"<=":i=Bq(a.value);break;case"==":case"in":case">=":i=a.value;break;case">":i=a.value,l=!1;break;case"!=":case"not-in":i=Cy}eE({value:n,inclusive:s},{value:i,inclusive:l})<0&&(n=i,s=l)}if(r!==null){for(let a=0;a<t.orderBy.length;++a)if(t.orderBy[a].field.isEqual(e)){const i=r.position[a];eE({value:n,inclusive:s},{value:i,inclusive:r.inclusive})<0&&(n=i,s=r.inclusive);break}}return{value:n,inclusive:s}}function aE(t,e,r){let n=Ju,s=!0;for(const a of Sv(t,e)){let i=Ju,l=!0;switch(a.op){case">=":case">":i=Uq(a.value),l=!1;break;case"==":case"in":case"<=":i=a.value;break;case"<":i=a.value,l=!1;break;case"!=":case"not-in":i=Ju}tE({value:n,inclusive:s},{value:i,inclusive:l})>0&&(n=i,s=l)}if(r!==null){for(let a=0;a<t.orderBy.length;++a)if(t.orderBy[a].field.isEqual(e)){const i=r.position[a];tE({value:n,inclusive:s},{value:i,inclusive:r.inclusive})>0&&(n=i,s=r.inclusive);break}}return{value:n,inclusive:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class km{constructor(e,r=null,n=[],s=[],a=null,i="F",l=null,c=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=s,this.limit=a,this.limitType=i,this.startAt=l,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function p8(t,e,r,n,s,a,i,l){return new km(t,e,r,n,s,a,i,l)}function Sx(t){return new km(t)}function iE(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function g8(t){return t.collectionGroup!==null}function Hp(t){const e=rr(t);if(e.ce===null){e.ce=[];const r=new Set;for(const a of e.explicitOrderBy)e.ce.push(a),r.add(a.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(i){let l=new _n(Yn.comparator);return i.filters.forEach(c=>{c.getFlattenedFilters().forEach(u=>{u.isInequality()&&(l=l.add(u.field))})}),l})(e).forEach(a=>{r.has(a.canonicalString())||a.isKeyField()||e.ce.push(new Vg(a,n))}),r.has(Yn.keyField().canonicalString())||e.ce.push(new Vg(Yn.keyField(),n))}return e.ce}function Ji(t){const e=rr(t);return e.le||(e.le=Xq(e,Hp(t))),e.le}function Xq(t,e){if(t.limitType==="F")return f_(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const a=s.dir==="desc"?"asc":"desc";return new Vg(s.field,a)});const r=t.endAt?new sm(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new sm(t.startAt.position,t.startAt.inclusive):null;return f_(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function h_(t,e){const r=t.filters.concat([e]);return new km(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function Tv(t,e,r){return new km(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function F2(t,e){return Nx(Ji(t),Ji(e))&&t.limitType===e.limitType}function x8(t){return`${eh(Ji(t))}|lt:${t.limitType}`}function o0(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(s=>f8(s)).join(", ")}]`),R2(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(s=>function(i){return`${i.field.canonicalString()} (${i.dir})`}(s)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(s=>nm(s)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(s=>nm(s)).join(",")),`Target(${n})`}(Ji(t))}; limitType=${t.limitType})`}function Tx(t,e){return e.isFoundDocument()&&function(n,s){const a=s.key.path;return n.collectionGroup!==null?s.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(a):Yt.isDocumentKey(n.path)?n.path.isEqual(a):n.path.isImmediateParentOf(a)}(t,e)&&function(n,s){for(const a of Hp(n))if(!a.field.isKeyField()&&s.data.field(a.field)===null)return!1;return!0}(t,e)&&function(n,s){for(const a of n.filters)if(!a.matches(s))return!1;return!0}(t,e)&&function(n,s){return!(n.startAt&&!function(i,l,c){const u=rE(i,l,c);return i.inclusive?u<=0:u<0}(n.startAt,Hp(n),s)||n.endAt&&!function(i,l,c){const u=rE(i,l,c);return i.inclusive?u>=0:u>0}(n.endAt,Hp(n),s))}(t,e)}function y8(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function v8(t){return(e,r)=>{let n=!1;for(const s of Hp(t)){const a=Qq(s,e,r);if(a!==0)return a;n=n||s.field.isKeyField()}return 0}}function Qq(t,e,r){const n=t.field.isKeyField()?Yt.comparator(e.key,r.key):function(a,i,l){const c=i.data.field(a),u=l.data.field(a);return c!==null&&u!==null?Sd(c,u):tr()}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return tr()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gd{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[s,a]of n)if(this.equalsFn(s,e))return a}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),s=this.inner[n];if(s===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let a=0;a<s.length;a++)if(this.equalsFn(s[a][0],e))return void(s[a]=[e,r]);s.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let s=0;s<n.length;s++)if(this.equalsFn(n[s][0],e))return n.length===1?delete this.inner[r]:n.splice(s,1),this.innerSize--,!0;return!1}forEach(e){gh(this.inner,(r,n)=>{for(const[s,a]of n)e(s,a)})}isEmpty(){return n8(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jq=new jn(Yt.comparator);function Gi(){return Jq}const b8=new jn(Yt.comparator);function Tp(...t){let e=b8;for(const r of t)e=e.insert(r.key,r);return e}function w8(t){let e=b8;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function Pl(){return Gp()}function _8(){return Gp()}function Gp(){return new Gd(t=>t.toString(),(t,e)=>t.isEqual(e))}const Zq=new jn(Yt.comparator),eW=new _n(Yt.comparator);function Fr(...t){let e=eW;for(const r of t)e=e.add(r);return e}const tW=new _n(kr);function R4(){return tW}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D4(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Dg(e)?"-0":e}}function N8(t){return{integerValue:""+t}}function S8(t,e){return JP(e)?N8(e):D4(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L2{constructor(){this._=void 0}}function rW(t,e,r){return t instanceof im?function(s,a){const i={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return a&&I4(a)&&(a=j4(a)),a&&(i.fields.__previous_value__=a),{mapValue:i}}(r,e):t instanceof om?A8(t,e):t instanceof lm?E8(t,e):function(s,a){const i=T8(s,a),l=oE(i)+oE(s.Pe);return c_(i)&&c_(s.Pe)?N8(l):D4(s.serializer,l)}(t,e)}function nW(t,e,r){return t instanceof om?A8(t,e):t instanceof lm?E8(t,e):r}function T8(t,e){return t instanceof cm?function(n){return c_(n)||function(a){return!!a&&"doubleValue"in a}(n)}(e)?e:{integerValue:0}:null}class im extends L2{}class om extends L2{constructor(e){super(),this.elements=e}}function A8(t,e){const r=C8(e);for(const n of t.elements)r.some(s=>zl(s,n))||r.push(n);return{arrayValue:{values:r}}}class lm extends L2{constructor(e){super(),this.elements=e}}function E8(t,e){let r=C8(e);for(const n of t.elements)r=r.filter(s=>!zl(s,n));return{arrayValue:{values:r}}}class cm extends L2{constructor(e,r){super(),this.serializer=e,this.Pe=r}}function oE(t){return zn(t.integerValue||t.doubleValue)}function C8(t){return Mg(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F4{constructor(e,r){this.field=e,this.transform=r}}function sW(t,e){return t.field.isEqual(e.field)&&function(n,s){return n instanceof om&&s instanceof om||n instanceof lm&&s instanceof lm?rm(n.elements,s.elements,zl):n instanceof cm&&s instanceof cm?zl(n.Pe,s.Pe):n instanceof im&&s instanceof im}(t.transform,e.transform)}class aW{constructor(e,r){this.version=e,this.transformResults=r}}class qs{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new qs}static exists(e){return new qs(void 0,e)}static updateTime(e){return new qs(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Iy(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class O2{}function k8(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Ax(t.key,qs.none()):new Im(t.key,t.data,qs.none());{const r=t.data,n=Da.empty();let s=new _n(Yn.comparator);for(let a of e.fields)if(!s.has(a)){let i=r.field(a);i===null&&a.length>1&&(a=a.popLast(),i=r.field(a)),i===null?n.delete(a):n.set(a,i),s=s.add(a)}return new Kc(t.key,n,new wi(s.toArray()),qs.none())}}function iW(t,e,r){t instanceof Im?function(s,a,i){const l=s.value.clone(),c=cE(s.fieldTransforms,a,i.transformResults);l.setAll(c),a.convertToFoundDocument(i.version,l).setHasCommittedMutations()}(t,e,r):t instanceof Kc?function(s,a,i){if(!Iy(s.precondition,a))return void a.convertToUnknownDocument(i.version);const l=cE(s.fieldTransforms,a,i.transformResults),c=a.data;c.setAll(I8(s)),c.setAll(l),a.convertToFoundDocument(i.version,c).setHasCommittedMutations()}(t,e,r):function(s,a,i){a.convertToNoDocument(i.version).setHasCommittedMutations()}(0,e,r)}function Kp(t,e,r,n){return t instanceof Im?function(a,i,l,c){if(!Iy(a.precondition,i))return l;const u=a.value.clone(),d=uE(a.fieldTransforms,c,i);return u.setAll(d),i.convertToFoundDocument(i.version,u).setHasLocalMutations(),null}(t,e,r,n):t instanceof Kc?function(a,i,l,c){if(!Iy(a.precondition,i))return l;const u=uE(a.fieldTransforms,c,i),d=i.data;return d.setAll(I8(a)),d.setAll(u),i.convertToFoundDocument(i.version,d).setHasLocalMutations(),l===null?null:l.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map(f=>f.field))}(t,e,r,n):function(a,i,l){return Iy(a.precondition,i)?(i.convertToNoDocument(i.version).setHasLocalMutations(),null):l}(t,e,r)}function oW(t,e){let r=null;for(const n of t.fieldTransforms){const s=e.data.field(n.field),a=T8(n.transform,s||null);a!=null&&(r===null&&(r=Da.empty()),r.set(n.field,a))}return r||null}function lE(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,s){return n===void 0&&s===void 0||!(!n||!s)&&rm(n,s,(a,i)=>sW(a,i))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Im extends O2{constructor(e,r,n,s=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Kc extends O2{constructor(e,r,n,s,a=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=s,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function I8(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function cE(t,e,r){const n=new Map;ar(t.length===r.length);for(let s=0;s<r.length;s++){const a=t[s],i=a.transform,l=e.data.field(a.field);n.set(a.field,nW(i,l,r[s]))}return n}function uE(t,e,r){const n=new Map;for(const s of t){const a=s.transform,i=r.data.field(s.field);n.set(s.field,rW(a,i,e))}return n}class Ax extends O2{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class j8 extends O2{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L4{constructor(e,r,n,s){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=s}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let s=0;s<this.mutations.length;s++){const a=this.mutations[s];a.key.isEqual(e.key)&&iW(a,e,n[s])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=Kp(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=Kp(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=_8();return this.mutations.forEach(s=>{const a=e.get(s.key),i=a.overlayedDocument;let l=this.applyToLocalView(i,a.mutatedFields);l=r.has(s.key)?null:l;const c=k8(i,l);c!==null&&n.set(s.key,c),i.isValidDocument()||i.convertToNoDocument(ur.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),Fr())}isEqual(e){return this.batchId===e.batchId&&rm(this.mutations,e.mutations,(r,n)=>lE(r,n))&&rm(this.baseMutations,e.baseMutations,(r,n)=>lE(r,n))}}class O4{constructor(e,r,n,s){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=s}static from(e,r,n){ar(e.mutations.length===n.length);let s=function(){return Zq}();const a=e.mutations;for(let i=0;i<a.length;i++)s=s.insert(a[i].key,n[i].version);return new O4(e,r,n,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M4{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lW{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var js,Yr;function cW(t){switch(t){default:return tr();case dt.CANCELLED:case dt.UNKNOWN:case dt.DEADLINE_EXCEEDED:case dt.RESOURCE_EXHAUSTED:case dt.INTERNAL:case dt.UNAVAILABLE:case dt.UNAUTHENTICATED:return!1;case dt.INVALID_ARGUMENT:case dt.NOT_FOUND:case dt.ALREADY_EXISTS:case dt.PERMISSION_DENIED:case dt.FAILED_PRECONDITION:case dt.ABORTED:case dt.OUT_OF_RANGE:case dt.UNIMPLEMENTED:case dt.DATA_LOSS:return!0}}function P8(t){if(t===void 0)return bs("GRPC error has no .code"),dt.UNKNOWN;switch(t){case js.OK:return dt.OK;case js.CANCELLED:return dt.CANCELLED;case js.UNKNOWN:return dt.UNKNOWN;case js.DEADLINE_EXCEEDED:return dt.DEADLINE_EXCEEDED;case js.RESOURCE_EXHAUSTED:return dt.RESOURCE_EXHAUSTED;case js.INTERNAL:return dt.INTERNAL;case js.UNAVAILABLE:return dt.UNAVAILABLE;case js.UNAUTHENTICATED:return dt.UNAUTHENTICATED;case js.INVALID_ARGUMENT:return dt.INVALID_ARGUMENT;case js.NOT_FOUND:return dt.NOT_FOUND;case js.ALREADY_EXISTS:return dt.ALREADY_EXISTS;case js.PERMISSION_DENIED:return dt.PERMISSION_DENIED;case js.FAILED_PRECONDITION:return dt.FAILED_PRECONDITION;case js.ABORTED:return dt.ABORTED;case js.OUT_OF_RANGE:return dt.OUT_OF_RANGE;case js.UNIMPLEMENTED:return dt.UNIMPLEMENTED;case js.DATA_LOSS:return dt.DATA_LOSS;default:return tr()}}(Yr=js||(js={}))[Yr.OK=0]="OK",Yr[Yr.CANCELLED=1]="CANCELLED",Yr[Yr.UNKNOWN=2]="UNKNOWN",Yr[Yr.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Yr[Yr.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Yr[Yr.NOT_FOUND=5]="NOT_FOUND",Yr[Yr.ALREADY_EXISTS=6]="ALREADY_EXISTS",Yr[Yr.PERMISSION_DENIED=7]="PERMISSION_DENIED",Yr[Yr.UNAUTHENTICATED=16]="UNAUTHENTICATED",Yr[Yr.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Yr[Yr.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Yr[Yr.ABORTED=10]="ABORTED",Yr[Yr.OUT_OF_RANGE=11]="OUT_OF_RANGE",Yr[Yr.UNIMPLEMENTED=12]="UNIMPLEMENTED",Yr[Yr.INTERNAL=13]="INTERNAL",Yr[Yr.UNAVAILABLE=14]="UNAVAILABLE",Yr[Yr.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uW(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dW=new Ff([4294967295,4294967295],0);function dE(t){const e=uW().encode(t),r=new MP;return r.update(e),new Uint8Array(r.digest())}function fE(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),s=e.getUint32(8,!0),a=e.getUint32(12,!0);return[new Ff([r,n],0),new Ff([s,a],0)]}class V4{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new Ap(`Invalid padding: ${r}`);if(n<0)throw new Ap(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Ap(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new Ap(`Invalid padding when bitmap length is 0: ${r}`);this.Ie=8*e.length-r,this.Te=Ff.fromNumber(this.Ie)}Ee(e,r,n){let s=e.add(r.multiply(Ff.fromNumber(n)));return s.compare(dW)===1&&(s=new Ff([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const r=dE(e),[n,s]=fE(r);for(let a=0;a<this.hashCount;a++){const i=this.Ee(n,s,a);if(!this.de(i))return!1}return!0}static create(e,r,n){const s=e%8==0?0:8-e%8,a=new Uint8Array(Math.ceil(e/8)),i=new V4(a,s,r);return n.forEach(l=>i.insert(l)),i}insert(e){if(this.Ie===0)return;const r=dE(e),[n,s]=fE(r);for(let a=0;a<this.hashCount;a++){const i=this.Ee(n,s,a);this.Ae(i)}}Ae(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class Ap extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ex{constructor(e,r,n,s,a){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=s,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const s=new Map;return s.set(e,Cx.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new Ex(ur.min(),s,new jn(kr),Gi(),Fr())}}class Cx{constructor(e,r,n,s,a){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=s,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new Cx(n,r,Fr(),Fr(),Fr())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jy{constructor(e,r,n,s){this.Re=e,this.removedTargetIds=r,this.key=n,this.Ve=s}}class R8{constructor(e,r){this.targetId=e,this.me=r}}class D8{constructor(e,r,n=Ss.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=s}}class hE{constructor(){this.fe=0,this.ge=pE(),this.pe=Ss.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Fr(),r=Fr(),n=Fr();return this.ge.forEach((s,a)=>{switch(a){case 0:e=e.add(s);break;case 2:r=r.add(s);break;case 1:n=n.add(s);break;default:tr()}}),new Cx(this.pe,this.ye,e,r,n)}Ce(){this.we=!1,this.ge=pE()}Fe(e,r){this.we=!0,this.ge=this.ge.insert(e,r)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,ar(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class fW{constructor(e){this.Le=e,this.Be=new Map,this.ke=Gi(),this.qe=mE(),this.Qe=new jn(kr)}Ke(e){for(const r of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(r,e.Ve):this.Ue(r,e.key,e.Ve);for(const r of e.removedTargetIds)this.Ue(r,e.key,e.Ve)}We(e){this.forEachTarget(e,r=>{const n=this.Ge(r);switch(e.state){case 0:this.ze(r)&&n.De(e.resumeToken);break;case 1:n.Oe(),n.Se||n.Ce(),n.De(e.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(r);break;case 3:this.ze(r)&&(n.Ne(),n.De(e.resumeToken));break;case 4:this.ze(r)&&(this.je(r),n.De(e.resumeToken));break;default:tr()}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.Be.forEach((n,s)=>{this.ze(s)&&r(s)})}He(e){const r=e.targetId,n=e.me.count,s=this.Je(r);if(s){const a=s.target;if(Nv(a))if(n===0){const i=new Yt(a.path);this.Ue(r,i,ls.newNoDocument(i,ur.min()))}else ar(n===1);else{const i=this.Ye(r);if(i!==n){const l=this.Ze(e),c=l?this.Xe(l,e,i):1;if(c!==0){this.je(r);const u=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(r,u)}}}}}Ze(e){const r=e.me.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:s=0},hashCount:a=0}=r;let i,l;try{i=Nd(n).toUint8Array()}catch(c){if(c instanceof s8)return Qf("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{l=new V4(i,s,a)}catch(c){return Qf(c instanceof Ap?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return l.Ie===0?null:l}Xe(e,r,n){return r.me.count===n-this.nt(e,r.targetId)?0:2}nt(e,r){const n=this.Le.getRemoteKeysForTarget(r);let s=0;return n.forEach(a=>{const i=this.Le.tt(),l=`projects/${i.projectId}/databases/${i.database}/documents/${a.path.canonicalString()}`;e.mightContain(l)||(this.Ue(r,a,null),s++)}),s}rt(e){const r=new Map;this.Be.forEach((a,i)=>{const l=this.Je(i);if(l){if(a.current&&Nv(l.target)){const c=new Yt(l.target.path);this.ke.get(c)!==null||this.it(i,c)||this.Ue(i,c,ls.newNoDocument(c,e))}a.be&&(r.set(i,a.ve()),a.Ce())}});let n=Fr();this.qe.forEach((a,i)=>{let l=!0;i.forEachWhile(c=>{const u=this.Je(c);return!u||u.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(n=n.add(a))}),this.ke.forEach((a,i)=>i.setReadTime(e));const s=new Ex(e,r,this.Qe,this.ke,n);return this.ke=Gi(),this.qe=mE(),this.Qe=new jn(kr),s}$e(e,r){if(!this.ze(e))return;const n=this.it(e,r.key)?2:0;this.Ge(e).Fe(r.key,n),this.ke=this.ke.insert(r.key,r),this.qe=this.qe.insert(r.key,this.st(r.key).add(e))}Ue(e,r,n){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,r)?s.Fe(r,1):s.Me(r),this.qe=this.qe.insert(r,this.st(r).delete(e)),n&&(this.ke=this.ke.insert(r,n))}removeTarget(e){this.Be.delete(e)}Ye(e){const r=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let r=this.Be.get(e);return r||(r=new hE,this.Be.set(e,r)),r}st(e){let r=this.qe.get(e);return r||(r=new _n(kr),this.qe=this.qe.insert(e,r)),r}ze(e){const r=this.Je(e)!==null;return r||kt("WatchChangeAggregator","Detected inactive target",e),r}Je(e){const r=this.Be.get(e);return r&&r.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new hE),this.Le.getRemoteKeysForTarget(e).forEach(r=>{this.Ue(e,r,null)})}it(e,r){return this.Le.getRemoteKeysForTarget(e).has(r)}}function mE(){return new jn(Yt.comparator)}function pE(){return new jn(Yt.comparator)}const hW={asc:"ASCENDING",desc:"DESCENDING"},mW={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},pW={and:"AND",or:"OR"};class gW{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function m_(t,e){return t.useProto3Json||R2(e)?e:{value:e}}function um(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function F8(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function xW(t,e){return um(t,e.toTimestamp())}function ri(t){return ar(!!t),ur.fromTimestamp(function(r){const n=Bc(r);return new ft(n.seconds,n.nanos)}(t))}function B4(t,e){return p_(t,e).canonicalString()}function p_(t,e){const r=function(s){return new cn(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?r:r.child(e)}function L8(t){const e=cn.fromString(t);return ar(W8(e)),e}function Av(t,e){return B4(t.databaseId,e.path)}function Lf(t,e){const r=L8(e);if(r.get(1)!==t.databaseId.projectId)throw new Bt(dt.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new Bt(dt.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new Yt(V8(r))}function O8(t,e){return B4(t.databaseId,e)}function M8(t){const e=L8(t);return e.length===4?cn.emptyPath():V8(e)}function g_(t){return new cn(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function V8(t){return ar(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function gE(t,e,r){return{name:Av(t,e),fields:r.value.mapValue.fields}}function yW(t,e,r){const n=Lf(t,e.name),s=ri(e.updateTime),a=e.createTime?ri(e.createTime):ur.min(),i=new Da({mapValue:{fields:e.fields}}),l=ls.newFoundDocument(n,s,a,i);return r&&l.setHasCommittedMutations(),r?l.setHasCommittedMutations():l}function vW(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:tr()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],a=function(u,d){return u.useProto3Json?(ar(d===void 0||typeof d=="string"),Ss.fromBase64String(d||"")):(ar(d===void 0||d instanceof Buffer||d instanceof Uint8Array),Ss.fromUint8Array(d||new Uint8Array))}(t,e.targetChange.resumeToken),i=e.targetChange.cause,l=i&&function(u){const d=u.code===void 0?dt.UNKNOWN:P8(u.code);return new Bt(d,u.message||"")}(i);r=new D8(n,s,a,l||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const s=Lf(t,n.document.name),a=ri(n.document.updateTime),i=n.document.createTime?ri(n.document.createTime):ur.min(),l=new Da({mapValue:{fields:n.document.fields}}),c=ls.newFoundDocument(s,a,i,l),u=n.targetIds||[],d=n.removedTargetIds||[];r=new jy(u,d,c.key,c)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const s=Lf(t,n.document),a=n.readTime?ri(n.readTime):ur.min(),i=ls.newNoDocument(s,a),l=n.removedTargetIds||[];r=new jy([],l,i.key,i)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const s=Lf(t,n.document),a=n.removedTargetIds||[];r=new jy([],a,s,null)}else{if(!("filter"in e))return tr();{e.filter;const n=e.filter;n.targetId;const{count:s=0,unchangedNames:a}=n,i=new lW(s,a),l=n.targetId;r=new R8(l,i)}}return r}function Ev(t,e){let r;if(e instanceof Im)r={update:gE(t,e.key,e.value)};else if(e instanceof Ax)r={delete:Av(t,e.key)};else if(e instanceof Kc)r={update:gE(t,e.key,e.data),updateMask:TW(e.fieldMask)};else{if(!(e instanceof j8))return tr();r={verify:Av(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(a,i){const l=i.transform;if(l instanceof im)return{fieldPath:i.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof om)return{fieldPath:i.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof lm)return{fieldPath:i.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof cm)return{fieldPath:i.field.canonicalString(),increment:l.Pe};throw tr()}(0,n))),e.precondition.isNone||(r.currentDocument=function(s,a){return a.updateTime!==void 0?{updateTime:xW(s,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:tr()}(t,e.precondition)),r}function x_(t,e){const r=e.currentDocument?function(a){return a.updateTime!==void 0?qs.updateTime(ri(a.updateTime)):a.exists!==void 0?qs.exists(a.exists):qs.none()}(e.currentDocument):qs.none(),n=e.updateTransforms?e.updateTransforms.map(s=>function(i,l){let c=null;if("setToServerValue"in l)ar(l.setToServerValue==="REQUEST_TIME"),c=new im;else if("appendMissingElements"in l){const d=l.appendMissingElements.values||[];c=new om(d)}else if("removeAllFromArray"in l){const d=l.removeAllFromArray.values||[];c=new lm(d)}else"increment"in l?c=new cm(i,l.increment):tr();const u=Yn.fromServerFormat(l.fieldPath);return new F4(u,c)}(t,s)):[];if(e.update){e.update.name;const s=Lf(t,e.update.name),a=new Da({mapValue:{fields:e.update.fields}});if(e.updateMask){const i=function(c){const u=c.fieldPaths||[];return new wi(u.map(d=>Yn.fromServerFormat(d)))}(e.updateMask);return new Kc(s,a,i,r,n)}return new Im(s,a,r,n)}if(e.delete){const s=Lf(t,e.delete);return new Ax(s,r)}if(e.verify){const s=Lf(t,e.verify);return new j8(s,r)}return tr()}function bW(t,e){return t&&t.length>0?(ar(e!==void 0),t.map(r=>function(s,a){let i=s.updateTime?ri(s.updateTime):ri(a);return i.isEqual(ur.min())&&(i=ri(a)),new aW(i,s.transformResults||[])}(r,e))):[]}function B8(t,e){return{documents:[O8(t,e.path)]}}function U8(t,e){const r={structuredQuery:{}},n=e.path;let s;e.collectionGroup!==null?(s=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=O8(t,s);const a=function(u){if(u.length!==0)return q8(gn.create(u,"and"))}(e.filters);a&&(r.structuredQuery.where=a);const i=function(u){if(u.length!==0)return u.map(d=>function(m){return{field:l0(m.field),direction:_W(m.dir)}}(d))}(e.orderBy);i&&(r.structuredQuery.orderBy=i);const l=m_(t,e.limit);return l!==null&&(r.structuredQuery.limit=l),e.startAt&&(r.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{_t:r,parent:s}}function $8(t){let e=M8(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let s=null;if(n>0){ar(n===1);const d=r.from[0];d.allDescendants?s=d.collectionId:e=e.child(d.collectionId)}let a=[];r.where&&(a=function(f){const m=z8(f);return m instanceof gn&&P4(m)?m.getFilters():[m]}(r.where));let i=[];r.orderBy&&(i=function(f){return f.map(m=>function(g){return new Vg(c0(g.field),function(v){switch(v){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(g.direction))}(m))}(r.orderBy));let l=null;r.limit&&(l=function(f){let m;return m=typeof f=="object"?f.value:f,R2(m)?null:m}(r.limit));let c=null;r.startAt&&(c=function(f){const m=!!f.before,h=f.values||[];return new sm(h,m)}(r.startAt));let u=null;return r.endAt&&(u=function(f){const m=!f.before,h=f.values||[];return new sm(h,m)}(r.endAt)),p8(e,s,i,a,l,"F",c,u)}function wW(t,e){const r=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return tr()}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function z8(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=c0(r.unaryFilter.field);return zr.create(n,"==",{doubleValue:NaN});case"IS_NULL":const s=c0(r.unaryFilter.field);return zr.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=c0(r.unaryFilter.field);return zr.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=c0(r.unaryFilter.field);return zr.create(i,"!=",{nullValue:"NULL_VALUE"});default:return tr()}}(t):t.fieldFilter!==void 0?function(r){return zr.create(c0(r.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return tr()}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return gn.create(r.compositeFilter.filters.map(n=>z8(n)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return tr()}}(r.compositeFilter.op))}(t):tr()}function _W(t){return hW[t]}function NW(t){return mW[t]}function SW(t){return pW[t]}function l0(t){return{fieldPath:t.canonicalString()}}function c0(t){return Yn.fromServerFormat(t.fieldPath)}function q8(t){return t instanceof zr?function(r){if(r.op==="=="){if(ZA(r.value))return{unaryFilter:{field:l0(r.field),op:"IS_NAN"}};if(JA(r.value))return{unaryFilter:{field:l0(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(ZA(r.value))return{unaryFilter:{field:l0(r.field),op:"IS_NOT_NAN"}};if(JA(r.value))return{unaryFilter:{field:l0(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:l0(r.field),op:NW(r.op),value:r.value}}}(t):t instanceof gn?function(r){const n=r.getFilters().map(s=>q8(s));return n.length===1?n[0]:{compositeFilter:{op:SW(r.op),filters:n}}}(t):tr()}function TW(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function W8(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nc{constructor(e,r,n,s,a=ur.min(),i=ur.min(),l=Ss.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=s,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=i,this.resumeToken=l,this.expectedCount=c}withSequenceNumber(e){return new Nc(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new Nc(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Nc(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Nc(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H8{constructor(e){this.ct=e}}function AW(t,e){let r;if(e.document)r=yW(t.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const n=Yt.fromSegments(e.noDocument.path),s=rh(e.noDocument.readTime);r=ls.newNoDocument(n,s),e.hasCommittedMutations&&r.setHasCommittedMutations()}else{if(!e.unknownDocument)return tr();{const n=Yt.fromSegments(e.unknownDocument.path),s=rh(e.unknownDocument.version);r=ls.newUnknownDocument(n,s)}}return e.readTime&&r.setReadTime(function(s){const a=new ft(s[0],s[1]);return ur.fromTimestamp(a)}(e.readTime)),r}function xE(t,e){const r=e.key,n={prefixPath:r.getCollectionPath().popLast().toArray(),collectionGroup:r.collectionGroup,documentId:r.path.lastSegment(),readTime:Cv(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())n.document=function(a,i){return{name:Av(a,i.key),fields:i.data.value.mapValue.fields,updateTime:um(a,i.version.toTimestamp()),createTime:um(a,i.createTime.toTimestamp())}}(t.ct,e);else if(e.isNoDocument())n.noDocument={path:r.path.toArray(),readTime:th(e.version)};else{if(!e.isUnknownDocument())return tr();n.unknownDocument={path:r.path.toArray(),version:th(e.version)}}return n}function Cv(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function th(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function rh(t){const e=new ft(t.seconds,t.nanoseconds);return ur.fromTimestamp(e)}function _f(t,e){const r=(e.baseMutations||[]).map(a=>x_(t.ct,a));for(let a=0;a<e.mutations.length-1;++a){const i=e.mutations[a];if(a+1<e.mutations.length&&e.mutations[a+1].transform!==void 0){const l=e.mutations[a+1];i.updateTransforms=l.transform.fieldTransforms,e.mutations.splice(a+1,1),++a}}const n=e.mutations.map(a=>x_(t.ct,a)),s=ft.fromMillis(e.localWriteTimeMs);return new L4(e.batchId,s,r,n)}function Ep(t){const e=rh(t.readTime),r=t.lastLimboFreeSnapshotVersion!==void 0?rh(t.lastLimboFreeSnapshotVersion):ur.min();let n;return n=function(a){return a.documents!==void 0}(t.query)?function(a){return ar(a.documents.length===1),Ji(Sx(M8(a.documents[0])))}(t.query):function(a){return Ji($8(a))}(t.query),new Nc(n,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,r,Ss.fromBase64String(t.resumeToken))}function G8(t,e){const r=th(e.snapshotVersion),n=th(e.lastLimboFreeSnapshotVersion);let s;s=Nv(e.target)?B8(t.ct,e.target):U8(t.ct,e.target)._t;const a=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:eh(e.target),readTime:r,resumeToken:a,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:n,query:s}}function K8(t){const e=$8({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Tv(e,e.limit,"L"):e}function fw(t,e){return new M4(e.largestBatchId,x_(t.ct,e.overlayMutation))}function yE(t,e){const r=e.path.lastSegment();return[t,ti(e.path.popLast()),r]}function vE(t,e,r,n){return{indexId:t,uid:e,sequenceNumber:r,readTime:th(n.readTime),documentKey:ti(n.documentKey.path),largestBatchId:n.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EW{getBundleMetadata(e,r){return bE(e).get(r).next(n=>{if(n)return function(a){return{id:a.bundleId,createTime:rh(a.createTime),version:a.version}}(n)})}saveBundleMetadata(e,r){return bE(e).put(function(s){return{bundleId:s.id,createTime:th(ri(s.createTime)),version:s.version}}(r))}getNamedQuery(e,r){return wE(e).get(r).next(n=>{if(n)return function(a){return{name:a.name,query:K8(a.bundledQuery),readTime:rh(a.readTime)}}(n)})}saveNamedQuery(e,r){return wE(e).put(function(s){return{name:s.name,readTime:th(ri(s.readTime)),bundledQuery:s.bundledQuery}}(r))}}function bE(t){return Gs(t,"bundles")}function wE(t){return Gs(t,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M2{constructor(e,r){this.serializer=e,this.userId=r}static lt(e,r){const n=r.uid||"";return new M2(e,n)}getOverlay(e,r){return lp(e).get(yE(this.userId,r)).next(n=>n?fw(this.serializer,n):null)}getOverlays(e,r){const n=Pl();return Je.forEach(r,s=>this.getOverlay(e,s).next(a=>{a!==null&&n.set(s,a)})).next(()=>n)}saveOverlays(e,r,n){const s=[];return n.forEach((a,i)=>{const l=new M4(r,i);s.push(this.ht(e,l))}),Je.waitFor(s)}removeOverlaysForBatchId(e,r,n){const s=new Set;r.forEach(i=>s.add(ti(i.getCollectionPath())));const a=[];return s.forEach(i=>{const l=IDBKeyRange.bound([this.userId,i,n],[this.userId,i,n+1],!1,!0);a.push(lp(e).j("collectionPathOverlayIndex",l))}),Je.waitFor(a)}getOverlaysForCollection(e,r,n){const s=Pl(),a=ti(r),i=IDBKeyRange.bound([this.userId,a,n],[this.userId,a,Number.POSITIVE_INFINITY],!0);return lp(e).U("collectionPathOverlayIndex",i).next(l=>{for(const c of l){const u=fw(this.serializer,c);s.set(u.getKey(),u)}return s})}getOverlaysForCollectionGroup(e,r,n,s){const a=Pl();let i;const l=IDBKeyRange.bound([this.userId,r,n],[this.userId,r,Number.POSITIVE_INFINITY],!0);return lp(e).J({index:"collectionGroupOverlayIndex",range:l},(c,u,d)=>{const f=fw(this.serializer,u);a.size()<s||f.largestBatchId===i?(a.set(f.getKey(),f),i=f.largestBatchId):d.done()}).next(()=>a)}ht(e,r){return lp(e).put(function(s,a,i){const[l,c,u]=yE(a,i.mutation.key);return{userId:a,collectionPath:c,documentId:u,collectionGroup:i.mutation.key.getCollectionGroup(),largestBatchId:i.largestBatchId,overlayMutation:Ev(s.ct,i.mutation)}}(this.serializer,this.userId,r))}}function lp(t){return Gs(t,"documentOverlays")}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CW{Pt(e){return Gs(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next(r=>{const n=r==null?void 0:r.value;return n?Ss.fromUint8Array(n):Ss.EMPTY_BYTE_STRING})}setSessionToken(e,r){return this.Pt(e).put({name:"sessionToken",value:r.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nf{constructor(){}It(e,r){this.Tt(e,r),r.Et()}Tt(e,r){if("nullValue"in e)this.dt(r,5);else if("booleanValue"in e)this.dt(r,10),r.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(r,15),r.At(zn(e.integerValue));else if("doubleValue"in e){const n=zn(e.doubleValue);isNaN(n)?this.dt(r,13):(this.dt(r,15),Dg(n)?r.At(0):r.At(n))}else if("timestampValue"in e){let n=e.timestampValue;this.dt(r,20),typeof n=="string"&&(n=Bc(n)),r.Rt(`${n.seconds||""}`),r.At(n.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,r),this.ft(r);else if("bytesValue"in e)this.dt(r,30),r.gt(Nd(e.bytesValue)),this.ft(r);else if("referenceValue"in e)this.yt(e.referenceValue,r);else if("geoPointValue"in e){const n=e.geoPointValue;this.dt(r,45),r.At(n.latitude||0),r.At(n.longitude||0)}else"mapValue"in e?a8(e)?this.dt(r,Number.MAX_SAFE_INTEGER):D2(e)?this.wt(e.mapValue,r):(this.St(e.mapValue,r),this.ft(r)):"arrayValue"in e?(this.bt(e.arrayValue,r),this.ft(r)):tr()}Vt(e,r){this.dt(r,25),this.Dt(e,r)}Dt(e,r){r.Rt(e)}St(e,r){const n=e.fields||{};this.dt(r,55);for(const s of Object.keys(n))this.Vt(s,r),this.Tt(n[s],r)}wt(e,r){var n,s;const a=e.fields||{};this.dt(r,53);const i="value",l=((s=(n=a[i].arrayValue)===null||n===void 0?void 0:n.values)===null||s===void 0?void 0:s.length)||0;this.dt(r,15),r.At(zn(l)),this.Vt(i,r),this.Tt(a[i],r)}bt(e,r){const n=e.values||[];this.dt(r,50);for(const s of n)this.Tt(s,r)}yt(e,r){this.dt(r,37),Yt.fromName(e).path.forEach(n=>{this.dt(r,60),this.Dt(n,r)})}dt(e,r){e.At(r)}ft(e){e.At(2)}}Nf.vt=new Nf;function kW(t){if(t===0)return 8;let e=0;return!(t>>4)&&(e+=4,t<<=4),!(t>>6)&&(e+=2,t<<=2),!(t>>7)&&(e+=1),e}function _E(t){const e=64-function(n){let s=0;for(let a=0;a<8;++a){const i=kW(255&n[a]);if(s+=i,i!==8)break}return s}(t);return Math.ceil(e/8)}class IW{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){const r=e[Symbol.iterator]();let n=r.next();for(;!n.done;)this.Ft(n.value),n=r.next();this.Mt()}xt(e){const r=e[Symbol.iterator]();let n=r.next();for(;!n.done;)this.Ot(n.value),n=r.next();this.Nt()}Lt(e){for(const r of e){const n=r.charCodeAt(0);if(n<128)this.Ft(n);else if(n<2048)this.Ft(960|n>>>6),this.Ft(128|63&n);else if(r<"\uD800"||"\uDBFF"<r)this.Ft(480|n>>>12),this.Ft(128|63&n>>>6),this.Ft(128|63&n);else{const s=r.codePointAt(0);this.Ft(240|s>>>18),this.Ft(128|63&s>>>12),this.Ft(128|63&s>>>6),this.Ft(128|63&s)}}this.Mt()}Bt(e){for(const r of e){const n=r.charCodeAt(0);if(n<128)this.Ot(n);else if(n<2048)this.Ot(960|n>>>6),this.Ot(128|63&n);else if(r<"\uD800"||"\uDBFF"<r)this.Ot(480|n>>>12),this.Ot(128|63&n>>>6),this.Ot(128|63&n);else{const s=r.codePointAt(0);this.Ot(240|s>>>18),this.Ot(128|63&s>>>12),this.Ot(128|63&s>>>6),this.Ot(128|63&s)}}this.Nt()}kt(e){const r=this.qt(e),n=_E(r);this.Qt(1+n),this.buffer[this.position++]=255&n;for(let s=r.length-n;s<r.length;++s)this.buffer[this.position++]=255&r[s]}Kt(e){const r=this.qt(e),n=_E(r);this.Qt(1+n),this.buffer[this.position++]=~(255&n);for(let s=r.length-n;s<r.length;++s)this.buffer[this.position++]=~(255&r[s])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){const r=function(a){const i=new DataView(new ArrayBuffer(8));return i.setFloat64(0,a,!1),new Uint8Array(i.buffer)}(e),n=(128&r[0])!=0;r[0]^=n?255:128;for(let s=1;s<r.length;++s)r[s]^=n?255:0;return r}Ft(e){const r=255&e;r===0?(this.Ut(0),this.Ut(255)):r===255?(this.Ut(255),this.Ut(0)):this.Ut(r)}Ot(e){const r=255&e;r===0?(this.Gt(0),this.Gt(255)):r===255?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){const r=e+this.position;if(r<=this.buffer.length)return;let n=2*this.buffer.length;n<r&&(n=r);const s=new Uint8Array(n);s.set(this.buffer),this.buffer=s}}class jW{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}}class PW{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}}class cp{constructor(){this.jt=new IW,this.Ht=new jW(this.jt),this.Jt=new PW(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return e===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sf{constructor(e,r,n,s){this.indexId=e,this.documentKey=r,this.arrayValue=n,this.directionalValue=s}Zt(){const e=this.directionalValue.length,r=e===0||this.directionalValue[e-1]===255?e+1:e,n=new Uint8Array(r);return n.set(this.directionalValue,0),r!==e?n.set([0],this.directionalValue.length):++n[n.length-1],new Sf(this.indexId,this.documentKey,this.arrayValue,n)}}function ku(t,e){let r=t.indexId-e.indexId;return r!==0?r:(r=NE(t.arrayValue,e.arrayValue),r!==0?r:(r=NE(t.directionalValue,e.directionalValue),r!==0?r:Yt.comparator(t.documentKey,e.documentKey)))}function NE(t,e){for(let r=0;r<t.length&&r<e.length;++r){const n=t[r]-e[r];if(n!==0)return n}return t.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SE{constructor(e){this.Xt=new _n((r,n)=>Yn.comparator(r.field,n.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(const r of e.filters){const n=r;n.isInequality()?this.Xt=this.Xt.add(n):this.tn.push(n)}}get nn(){return this.Xt.size>1}rn(e){if(ar(e.collectionGroup===this.collectionId),this.nn)return!1;const r=i_(e);if(r!==void 0&&!this.sn(r))return!1;const n=vf(e);let s=new Set,a=0,i=0;for(;a<n.length&&this.sn(n[a]);++a)s=s.add(n[a].fieldPath.canonicalString());if(a===n.length)return!0;if(this.Xt.size>0){const l=this.Xt.getIterator().getNext();if(!s.has(l.field.canonicalString())){const c=n[a];if(!this.on(l,c)||!this._n(this.en[i++],c))return!1}++a}for(;a<n.length;++a){const l=n[a];if(i>=this.en.length||!this._n(this.en[i++],l))return!1}return!0}an(){if(this.nn)return null;let e=new _n(Yn.comparator);const r=[];for(const n of this.tn)if(!n.field.isKeyField())if(n.op==="array-contains"||n.op==="array-contains-any")r.push(new Ay(n.field,2));else{if(e.has(n.field))continue;e=e.add(n.field),r.push(new Ay(n.field,0))}for(const n of this.en)n.field.isKeyField()||e.has(n.field)||(e=e.add(n.field),r.push(new Ay(n.field,n.dir==="asc"?0:1)));return new _v(_v.UNKNOWN_ID,this.collectionId,r,Rg.empty())}sn(e){for(const r of this.tn)if(this.on(r,e))return!0;return!1}on(e,r){if(e===void 0||!e.field.isEqual(r.fieldPath))return!1;const n=e.op==="array-contains"||e.op==="array-contains-any";return r.kind===2===n}_n(e,r){return!!e.field.isEqual(r.fieldPath)&&(r.kind===0&&e.dir==="asc"||r.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y8(t){var e,r;if(ar(t instanceof zr||t instanceof gn),t instanceof zr){if(t instanceof m8){const s=((r=(e=t.value.arrayValue)===null||e===void 0?void 0:e.values)===null||r===void 0?void 0:r.map(a=>zr.create(t.field,"==",a)))||[];return gn.create(s,"or")}return t}const n=t.filters.map(s=>Y8(s));return gn.create(n,t.op)}function RW(t){if(t.getFilters().length===0)return[];const e=b_(Y8(t));return ar(X8(e)),y_(e)||v_(e)?[e]:e.getFilters()}function y_(t){return t instanceof zr}function v_(t){return t instanceof gn&&P4(t)}function X8(t){return y_(t)||v_(t)||function(r){if(r instanceof gn&&u_(r)){for(const n of r.getFilters())if(!y_(n)&&!v_(n))return!1;return!0}return!1}(t)}function b_(t){if(ar(t instanceof zr||t instanceof gn),t instanceof zr)return t;if(t.filters.length===1)return b_(t.filters[0]);const e=t.filters.map(n=>b_(n));let r=gn.create(e,t.op);return r=kv(r),X8(r)?r:(ar(r instanceof gn),ar(am(r)),ar(r.filters.length>1),r.filters.reduce((n,s)=>U4(n,s)))}function U4(t,e){let r;return ar(t instanceof zr||t instanceof gn),ar(e instanceof zr||e instanceof gn),r=t instanceof zr?e instanceof zr?function(s,a){return gn.create([s,a],"and")}(t,e):TE(t,e):e instanceof zr?TE(e,t):function(s,a){if(ar(s.filters.length>0&&a.filters.length>0),am(s)&&am(a))return d8(s,a.getFilters());const i=u_(s)?s:a,l=u_(s)?a:s,c=i.filters.map(u=>U4(u,l));return gn.create(c,"or")}(t,e),kv(r)}function TE(t,e){if(am(e))return d8(e,t.getFilters());{const r=e.filters.map(n=>U4(t,n));return gn.create(r,"or")}}function kv(t){if(ar(t instanceof zr||t instanceof gn),t instanceof zr)return t;const e=t.getFilters();if(e.length===1)return kv(e[0]);if(c8(t))return t;const r=e.map(s=>kv(s)),n=[];return r.forEach(s=>{s instanceof zr?n.push(s):s instanceof gn&&(s.op===t.op?n.push(...s.filters):n.push(s))}),n.length===1?n[0]:gn.create(n,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DW{constructor(){this.un=new $4}addToCollectionParentIndex(e,r){return this.un.add(r),Je.resolve()}getCollectionParents(e,r){return Je.resolve(this.un.getEntries(r))}addFieldIndex(e,r){return Je.resolve()}deleteFieldIndex(e,r){return Je.resolve()}deleteAllFieldIndexes(e){return Je.resolve()}createTargetIndexes(e,r){return Je.resolve()}getDocumentsMatchingTarget(e,r){return Je.resolve(null)}getIndexType(e,r){return Je.resolve(0)}getFieldIndexes(e,r){return Je.resolve([])}getNextCollectionGroupToUpdate(e){return Je.resolve(null)}getMinOffset(e,r){return Je.resolve(to.min())}getMinOffsetFromCollectionGroup(e,r){return Je.resolve(to.min())}updateCollectionGroup(e,r,n){return Je.resolve()}updateIndexEntries(e,r){return Je.resolve()}}class $4{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),s=this.index[r]||new _n(cn.comparator),a=!s.has(n);return this.index[r]=s.add(n),a}has(e){const r=e.lastSegment(),n=e.popLast(),s=this.index[r];return s&&s.has(n)}getEntries(e){return(this.index[e]||new _n(cn.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M1=new Uint8Array(0);class FW{constructor(e,r){this.databaseId=r,this.cn=new $4,this.ln=new Gd(n=>eh(n),(n,s)=>Nx(n,s)),this.uid=e.uid||""}addToCollectionParentIndex(e,r){if(!this.cn.has(r)){const n=r.lastSegment(),s=r.popLast();e.addOnCommittedListener(()=>{this.cn.add(r)});const a={collectionId:n,parent:ti(s)};return AE(e).put(a)}return Je.resolve()}getCollectionParents(e,r){const n=[],s=IDBKeyRange.bound([r,""],[HP(r),""],!1,!0);return AE(e).U(s).next(a=>{for(const i of a){if(i.collectionId!==r)break;n.push(jl(i.parent))}return n})}addFieldIndex(e,r){const n=up(e),s=function(l){return{indexId:l.indexId,collectionGroup:l.collectionGroup,fields:l.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}}(r);delete s.indexId;const a=n.add(s);if(r.indexState){const i=Yh(e);return a.next(l=>{i.put(vE(l,this.uid,r.indexState.sequenceNumber,r.indexState.offset))})}return a.next()}deleteFieldIndex(e,r){const n=up(e),s=Yh(e),a=Kh(e);return n.delete(r.indexId).next(()=>s.delete(IDBKeyRange.bound([r.indexId],[r.indexId+1],!1,!0))).next(()=>a.delete(IDBKeyRange.bound([r.indexId],[r.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const r=up(e),n=Kh(e),s=Yh(e);return r.j().next(()=>n.j()).next(()=>s.j())}createTargetIndexes(e,r){return Je.forEach(this.hn(r),n=>this.getIndexType(e,n).next(s=>{if(s===0||s===1){const a=new SE(n).an();if(a!=null)return this.addFieldIndex(e,a)}}))}getDocumentsMatchingTarget(e,r){const n=Kh(e);let s=!0;const a=new Map;return Je.forEach(this.hn(r),i=>this.Pn(e,i).next(l=>{s&&(s=!!l),a.set(i,l)})).next(()=>{if(s){let i=Fr();const l=[];return Je.forEach(a,(c,u)=>{kt("IndexedDbIndexManager",`Using index ${function(N){return`id=${N.indexId}|cg=${N.collectionGroup}|f=${N.fields.map(j=>`${j.fieldPath}:${j.kind}`).join(",")}`}(c)} to execute ${eh(r)}`);const d=function(N,j){const F=i_(j);if(F===void 0)return null;for(const U of Sv(N,F.fieldPath))switch(U.op){case"array-contains-any":return U.value.arrayValue.values||[];case"array-contains":return[U.value]}return null}(u,c),f=function(N,j){const F=new Map;for(const U of vf(j))for(const A of Sv(N,U.fieldPath))switch(A.op){case"==":case"in":F.set(U.fieldPath.canonicalString(),A.value);break;case"not-in":case"!=":return F.set(U.fieldPath.canonicalString(),A.value),Array.from(F.values())}return null}(u,c),m=function(N,j){const F=[];let U=!0;for(const A of vf(j)){const S=A.kind===0?sE(N,A.fieldPath,N.startAt):aE(N,A.fieldPath,N.startAt);F.push(S.value),U&&(U=S.inclusive)}return new sm(F,U)}(u,c),h=function(N,j){const F=[];let U=!0;for(const A of vf(j)){const S=A.kind===0?aE(N,A.fieldPath,N.endAt):sE(N,A.fieldPath,N.endAt);F.push(S.value),U&&(U=S.inclusive)}return new sm(F,U)}(u,c),g=this.In(c,u,m),p=this.In(c,u,h),v=this.Tn(c,u,f),b=this.En(c.indexId,d,g,m.inclusive,p,h.inclusive,v);return Je.forEach(b,w=>n.G(w,r.limit).next(N=>{N.forEach(j=>{const F=Yt.fromSegments(j.documentKey);i.has(F)||(i=i.add(F),l.push(F))})}))}).next(()=>l)}return Je.resolve(null)})}hn(e){let r=this.ln.get(e);return r||(e.filters.length===0?r=[e]:r=RW(gn.create(e.filters,"and")).map(n=>f_(e.path,e.collectionGroup,e.orderBy,n.getFilters(),e.limit,e.startAt,e.endAt)),this.ln.set(e,r),r)}En(e,r,n,s,a,i,l){const c=(r!=null?r.length:1)*Math.max(n.length,a.length),u=c/(r!=null?r.length:1),d=[];for(let f=0;f<c;++f){const m=r?this.dn(r[f/u]):M1,h=this.An(e,m,n[f%u],s),g=this.Rn(e,m,a[f%u],i),p=l.map(v=>this.An(e,m,v,!0));d.push(...this.createRange(h,g,p))}return d}An(e,r,n,s){const a=new Sf(e,Yt.empty(),r,n);return s?a:a.Zt()}Rn(e,r,n,s){const a=new Sf(e,Yt.empty(),r,n);return s?a.Zt():a}Pn(e,r){const n=new SE(r),s=r.collectionGroup!=null?r.collectionGroup:r.path.lastSegment();return this.getFieldIndexes(e,s).next(a=>{let i=null;for(const l of a)n.rn(l)&&(!i||l.fields.length>i.fields.length)&&(i=l);return i})}getIndexType(e,r){let n=2;const s=this.hn(r);return Je.forEach(s,a=>this.Pn(e,a).next(i=>{i?n!==0&&i.fields.length<function(c){let u=new _n(Yn.comparator),d=!1;for(const f of c.filters)for(const m of f.getFlattenedFilters())m.field.isKeyField()||(m.op==="array-contains"||m.op==="array-contains-any"?d=!0:u=u.add(m.field));for(const f of c.orderBy)f.field.isKeyField()||(u=u.add(f.field));return u.size+(d?1:0)}(a)&&(n=1):n=0})).next(()=>function(i){return i.limit!==null}(r)&&s.length>1&&n===2?1:n)}Vn(e,r){const n=new cp;for(const s of vf(e)){const a=r.data.field(s.fieldPath);if(a==null)return null;const i=n.Yt(s.kind);Nf.vt.It(a,i)}return n.zt()}dn(e){const r=new cp;return Nf.vt.It(e,r.Yt(0)),r.zt()}mn(e,r){const n=new cp;return Nf.vt.It(Og(this.databaseId,r),n.Yt(function(a){const i=vf(a);return i.length===0?0:i[i.length-1].kind}(e))),n.zt()}Tn(e,r,n){if(n===null)return[];let s=[];s.push(new cp);let a=0;for(const i of vf(e)){const l=n[a++];for(const c of s)if(this.fn(r,i.fieldPath)&&Mg(l))s=this.gn(s,i,l);else{const u=c.Yt(i.kind);Nf.vt.It(l,u)}}return this.pn(s)}In(e,r,n){return this.Tn(e,r,n.position)}pn(e){const r=[];for(let n=0;n<e.length;++n)r[n]=e[n].zt();return r}gn(e,r,n){const s=[...e],a=[];for(const i of n.arrayValue.values||[])for(const l of s){const c=new cp;c.seed(l.zt()),Nf.vt.It(i,c.Yt(r.kind)),a.push(c)}return a}fn(e,r){return!!e.filters.find(n=>n instanceof zr&&n.field.isEqual(r)&&(n.op==="in"||n.op==="not-in"))}getFieldIndexes(e,r){const n=up(e),s=Yh(e);return(r?n.U("collectionGroupIndex",IDBKeyRange.bound(r,r)):n.U()).next(a=>{const i=[];return Je.forEach(a,l=>s.get([l.indexId,this.uid]).next(c=>{i.push(function(d,f){const m=f?new Rg(f.sequenceNumber,new to(rh(f.readTime),new Yt(jl(f.documentKey)),f.largestBatchId)):Rg.empty(),h=d.fields.map(([g,p])=>new Ay(Yn.fromServerFormat(g),p));return new _v(d.indexId,d.collectionGroup,h,m)}(l,c))})).next(()=>i)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(r=>r.length===0?null:(r.sort((n,s)=>{const a=n.indexState.sequenceNumber-s.indexState.sequenceNumber;return a!==0?a:kr(n.collectionGroup,s.collectionGroup)}),r[0].collectionGroup))}updateCollectionGroup(e,r,n){const s=up(e),a=Yh(e);return this.yn(e).next(i=>s.U("collectionGroupIndex",IDBKeyRange.bound(r,r)).next(l=>Je.forEach(l,c=>a.put(vE(c.indexId,this.uid,i,n)))))}updateIndexEntries(e,r){const n=new Map;return Je.forEach(r,(s,a)=>{const i=n.get(s.collectionGroup);return(i?Je.resolve(i):this.getFieldIndexes(e,s.collectionGroup)).next(l=>(n.set(s.collectionGroup,l),Je.forEach(l,c=>this.wn(e,s,c).next(u=>{const d=this.Sn(a,c);return u.isEqual(d)?Je.resolve():this.bn(e,a,c,u,d)}))))})}Dn(e,r,n,s){return Kh(e).put({indexId:s.indexId,uid:this.uid,arrayValue:s.arrayValue,directionalValue:s.directionalValue,orderedDocumentKey:this.mn(n,r.key),documentKey:r.key.path.toArray()})}vn(e,r,n,s){return Kh(e).delete([s.indexId,this.uid,s.arrayValue,s.directionalValue,this.mn(n,r.key),r.key.path.toArray()])}wn(e,r,n){const s=Kh(e);let a=new _n(ku);return s.J({index:"documentKeyIndex",range:IDBKeyRange.only([n.indexId,this.uid,this.mn(n,r)])},(i,l)=>{a=a.add(new Sf(n.indexId,r,l.arrayValue,l.directionalValue))}).next(()=>a)}Sn(e,r){let n=new _n(ku);const s=this.Vn(r,e);if(s==null)return n;const a=i_(r);if(a!=null){const i=e.data.field(a.fieldPath);if(Mg(i))for(const l of i.arrayValue.values||[])n=n.add(new Sf(r.indexId,e.key,this.dn(l),s))}else n=n.add(new Sf(r.indexId,e.key,M1,s));return n}bn(e,r,n,s,a){kt("IndexedDbIndexManager","Updating index entries for document '%s'",r.key);const i=[];return function(c,u,d,f,m){const h=c.getIterator(),g=u.getIterator();let p=Gh(h),v=Gh(g);for(;p||v;){let b=!1,w=!1;if(p&&v){const N=d(p,v);N<0?w=!0:N>0&&(b=!0)}else p!=null?w=!0:b=!0;b?(f(v),v=Gh(g)):w?(m(p),p=Gh(h)):(p=Gh(h),v=Gh(g))}}(s,a,ku,l=>{i.push(this.Dn(e,r,n,l))},l=>{i.push(this.vn(e,r,n,l))}),Je.waitFor(i)}yn(e){let r=1;return Yh(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(n,s,a)=>{a.done(),r=s.sequenceNumber+1}).next(()=>r)}createRange(e,r,n){n=n.sort((i,l)=>ku(i,l)).filter((i,l,c)=>!l||ku(i,c[l-1])!==0);const s=[];s.push(e);for(const i of n){const l=ku(i,e),c=ku(i,r);if(l===0)s[0]=e.Zt();else if(l>0&&c<0)s.push(i),s.push(i.Zt());else if(c>0)break}s.push(r);const a=[];for(let i=0;i<s.length;i+=2){if(this.Cn(s[i],s[i+1]))return[];const l=[s[i].indexId,this.uid,s[i].arrayValue,s[i].directionalValue,M1,[]],c=[s[i+1].indexId,this.uid,s[i+1].arrayValue,s[i+1].directionalValue,M1,[]];a.push(IDBKeyRange.bound(l,c))}return a}Cn(e,r){return ku(e,r)>0}getMinOffsetFromCollectionGroup(e,r){return this.getFieldIndexes(e,r).next(EE)}getMinOffset(e,r){return Je.mapArray(this.hn(r),n=>this.Pn(e,n).next(s=>s||tr())).next(EE)}}function AE(t){return Gs(t,"collectionParents")}function Kh(t){return Gs(t,"indexEntries")}function up(t){return Gs(t,"indexConfiguration")}function Yh(t){return Gs(t,"indexState")}function EE(t){ar(t.length!==0);let e=t[0].indexState.offset,r=e.largestBatchId;for(let n=1;n<t.length;n++){const s=t[n].indexState.offset;E4(s,e)<0&&(e=s),r<s.largestBatchId&&(r=s.largestBatchId)}return new to(e.readTime,e.documentKey,r)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CE={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class xi{constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new xi(e,xi.DEFAULT_COLLECTION_PERCENTILE,xi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q8(t,e,r){const n=t.store("mutations"),s=t.store("documentMutations"),a=[],i=IDBKeyRange.only(r.batchId);let l=0;const c=n.J({range:i},(d,f,m)=>(l++,m.delete()));a.push(c.next(()=>{ar(l===1)}));const u=[];for(const d of r.mutations){const f=ZP(e,d.key.path,r.batchId);a.push(s.delete(f)),u.push(d.key)}return Je.waitFor(a).next(()=>u)}function Iv(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw tr();e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */xi.DEFAULT_COLLECTION_PERCENTILE=10,xi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,xi.DEFAULT=new xi(41943040,xi.DEFAULT_COLLECTION_PERCENTILE,xi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),xi.DISABLED=new xi(-1,0,0);class V2{constructor(e,r,n,s){this.userId=e,this.serializer=r,this.indexManager=n,this.referenceDelegate=s,this.Fn={}}static lt(e,r,n,s){ar(e.uid!=="");const a=e.isAuthenticated()?e.uid:"";return new V2(a,r,n,s)}checkEmpty(e){let r=!0;const n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Iu(e).J({index:"userMutationsIndex",range:n},(s,a,i)=>{r=!1,i.done()}).next(()=>r)}addMutationBatch(e,r,n,s){const a=u0(e),i=Iu(e);return i.add({}).next(l=>{ar(typeof l=="number");const c=new L4(l,r,n,s),u=function(h,g,p){const v=p.baseMutations.map(w=>Ev(h.ct,w)),b=p.mutations.map(w=>Ev(h.ct,w));return{userId:g,batchId:p.batchId,localWriteTimeMs:p.localWriteTime.toMillis(),baseMutations:v,mutations:b}}(this.serializer,this.userId,c),d=[];let f=new _n((m,h)=>kr(m.canonicalString(),h.canonicalString()));for(const m of s){const h=ZP(this.userId,m.key.path,l);f=f.add(m.key.path.popLast()),d.push(i.put(u)),d.push(a.put(h,bq))}return f.forEach(m=>{d.push(this.indexManager.addToCollectionParentIndex(e,m))}),e.addOnCommittedListener(()=>{this.Fn[l]=c.keys()}),Je.waitFor(d).next(()=>c)})}lookupMutationBatch(e,r){return Iu(e).get(r).next(n=>n?(ar(n.userId===this.userId),_f(this.serializer,n)):null)}Mn(e,r){return this.Fn[r]?Je.resolve(this.Fn[r]):this.lookupMutationBatch(e,r).next(n=>{if(n){const s=n.keys();return this.Fn[r]=s,s}return null})}getNextMutationBatchAfterBatchId(e,r){const n=r+1,s=IDBKeyRange.lowerBound([this.userId,n]);let a=null;return Iu(e).J({index:"userMutationsIndex",range:s},(i,l,c)=>{l.userId===this.userId&&(ar(l.batchId>=n),a=_f(this.serializer,l)),c.done()}).next(()=>a)}getHighestUnacknowledgedBatchId(e){const r=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let n=-1;return Iu(e).J({index:"userMutationsIndex",range:r,reverse:!0},(s,a,i)=>{n=a.batchId,i.done()}).next(()=>n)}getAllMutationBatches(e){const r=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Iu(e).U("userMutationsIndex",r).next(n=>n.map(s=>_f(this.serializer,s)))}getAllMutationBatchesAffectingDocumentKey(e,r){const n=Ey(this.userId,r.path),s=IDBKeyRange.lowerBound(n),a=[];return u0(e).J({range:s},(i,l,c)=>{const[u,d,f]=i,m=jl(d);if(u===this.userId&&r.path.isEqual(m))return Iu(e).get(f).next(h=>{if(!h)throw tr();ar(h.userId===this.userId),a.push(_f(this.serializer,h))});c.done()}).next(()=>a)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new _n(kr);const s=[];return r.forEach(a=>{const i=Ey(this.userId,a.path),l=IDBKeyRange.lowerBound(i),c=u0(e).J({range:l},(u,d,f)=>{const[m,h,g]=u,p=jl(h);m===this.userId&&a.path.isEqual(p)?n=n.add(g):f.done()});s.push(c)}),Je.waitFor(s).next(()=>this.xn(e,n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,s=n.length+1,a=Ey(this.userId,n),i=IDBKeyRange.lowerBound(a);let l=new _n(kr);return u0(e).J({range:i},(c,u,d)=>{const[f,m,h]=c,g=jl(m);f===this.userId&&n.isPrefixOf(g)?g.length===s&&(l=l.add(h)):d.done()}).next(()=>this.xn(e,l))}xn(e,r){const n=[],s=[];return r.forEach(a=>{s.push(Iu(e).get(a).next(i=>{if(i===null)throw tr();ar(i.userId===this.userId),n.push(_f(this.serializer,i))}))}),Je.waitFor(s).next(()=>n)}removeMutationBatch(e,r){return Q8(e._e,this.userId,r).next(n=>(e.addOnCommittedListener(()=>{this.On(r.batchId)}),Je.forEach(n,s=>this.referenceDelegate.markPotentiallyOrphaned(e,s))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(r=>{if(!r)return Je.resolve();const n=IDBKeyRange.lowerBound(function(i){return[i]}(this.userId)),s=[];return u0(e).J({range:n},(a,i,l)=>{if(a[0]===this.userId){const c=jl(a[1]);s.push(c)}else l.done()}).next(()=>{ar(s.length===0)})})}containsKey(e,r){return J8(e,this.userId,r)}Nn(e){return Z8(e).get(this.userId).next(r=>r||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function J8(t,e,r){const n=Ey(e,r.path),s=n[1],a=IDBKeyRange.lowerBound(n);let i=!1;return u0(t).J({range:a,H:!0},(l,c,u)=>{const[d,f,m]=l;d===e&&f===s&&(i=!0),u.done()}).next(()=>i)}function Iu(t){return Gs(t,"mutations")}function u0(t){return Gs(t,"documentMutations")}function Z8(t){return Gs(t,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nh{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new nh(0)}static kn(){return new nh(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LW{constructor(e,r){this.referenceDelegate=e,this.serializer=r}allocateTargetId(e){return this.qn(e).next(r=>{const n=new nh(r.highestTargetId);return r.highestTargetId=n.next(),this.Qn(e,r).next(()=>r.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.qn(e).next(r=>ur.fromTimestamp(new ft(r.lastRemoteSnapshotVersion.seconds,r.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.qn(e).next(r=>r.highestListenSequenceNumber)}setTargetsMetadata(e,r,n){return this.qn(e).next(s=>(s.highestListenSequenceNumber=r,n&&(s.lastRemoteSnapshotVersion=n.toTimestamp()),r>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=r),this.Qn(e,s)))}addTargetData(e,r){return this.Kn(e,r).next(()=>this.qn(e).next(n=>(n.targetCount+=1,this.$n(r,n),this.Qn(e,n))))}updateTargetData(e,r){return this.Kn(e,r)}removeTargetData(e,r){return this.removeMatchingKeysForTargetId(e,r.targetId).next(()=>Xh(e).delete(r.targetId)).next(()=>this.qn(e)).next(n=>(ar(n.targetCount>0),n.targetCount-=1,this.Qn(e,n)))}removeTargets(e,r,n){let s=0;const a=[];return Xh(e).J((i,l)=>{const c=Ep(l);c.sequenceNumber<=r&&n.get(c.targetId)===null&&(s++,a.push(this.removeTargetData(e,c)))}).next(()=>Je.waitFor(a)).next(()=>s)}forEachTarget(e,r){return Xh(e).J((n,s)=>{const a=Ep(s);r(a)})}qn(e){return kE(e).get("targetGlobalKey").next(r=>(ar(r!==null),r))}Qn(e,r){return kE(e).put("targetGlobalKey",r)}Kn(e,r){return Xh(e).put(G8(this.serializer,r))}$n(e,r){let n=!1;return e.targetId>r.highestTargetId&&(r.highestTargetId=e.targetId,n=!0),e.sequenceNumber>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.qn(e).next(r=>r.targetCount)}getTargetData(e,r){const n=eh(r),s=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]);let a=null;return Xh(e).J({range:s,index:"queryTargetsIndex"},(i,l,c)=>{const u=Ep(l);Nx(r,u.target)&&(a=u,c.done())}).next(()=>a)}addMatchingKeys(e,r,n){const s=[],a=Wu(e);return r.forEach(i=>{const l=ti(i.path);s.push(a.put({targetId:n,path:l})),s.push(this.referenceDelegate.addReference(e,n,i))}),Je.waitFor(s)}removeMatchingKeys(e,r,n){const s=Wu(e);return Je.forEach(r,a=>{const i=ti(a.path);return Je.waitFor([s.delete([n,i]),this.referenceDelegate.removeReference(e,n,a)])})}removeMatchingKeysForTargetId(e,r){const n=Wu(e),s=IDBKeyRange.bound([r],[r+1],!1,!0);return n.delete(s)}getMatchingKeysForTargetId(e,r){const n=IDBKeyRange.bound([r],[r+1],!1,!0),s=Wu(e);let a=Fr();return s.J({range:n,H:!0},(i,l,c)=>{const u=jl(i[1]),d=new Yt(u);a=a.add(d)}).next(()=>a)}containsKey(e,r){const n=ti(r.path),s=IDBKeyRange.bound([n],[HP(n)],!1,!0);let a=0;return Wu(e).J({index:"documentTargetsIndex",H:!0,range:s},([i,l],c,u)=>{i!==0&&(a++,u.done())}).next(()=>a>0)}ot(e,r){return Xh(e).get(r).next(n=>n?Ep(n):null)}}function Xh(t){return Gs(t,"targets")}function kE(t){return Gs(t,"targetGlobal")}function Wu(t){return Gs(t,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IE([t,e],[r,n]){const s=kr(t,r);return s===0?kr(e,n):s}class OW{constructor(e){this.Un=e,this.buffer=new _n(IE),this.Wn=0}Gn(){return++this.Wn}zn(e){const r=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();IE(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class MW{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return this.jn!==null}Hn(e){kt("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){Hd(r)?kt("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",r):await Wd(r)}await this.Hn(3e5)})}}class VW{constructor(e,r){this.Jn=e,this.params=r}calculateTargetCount(e,r){return this.Jn.Yn(e).next(n=>Math.floor(r/100*n))}nthSequenceNumber(e,r){if(r===0)return Je.resolve(bi.oe);const n=new OW(r);return this.Jn.forEachTarget(e,s=>n.zn(s.sequenceNumber)).next(()=>this.Jn.Zn(e,s=>n.zn(s))).next(()=>n.maxValue)}removeTargets(e,r,n){return this.Jn.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.Jn.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(kt("LruGarbageCollector","Garbage collection skipped; disabled"),Je.resolve(CE)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(kt("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),CE):this.Xn(e,r))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,r){let n,s,a,i,l,c,u;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(kt("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),s=this.params.maximumSequenceNumbersToCollect):s=f,i=Date.now(),this.nthSequenceNumber(e,s))).next(f=>(n=f,l=Date.now(),this.removeTargets(e,n,r))).next(f=>(a=f,c=Date.now(),this.removeOrphanedDocuments(e,n))).next(f=>(u=Date.now(),i0()<=$r.DEBUG&&kt("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${i-d}ms
	Determined least recently used ${s} in `+(l-i)+`ms
	Removed ${a} targets in `+(c-l)+`ms
	Removed ${f} documents in `+(u-c)+`ms
Total Duration: ${u-d}ms`),Je.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:a,documentsRemoved:f})))}}function BW(t,e){return new VW(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UW{constructor(e,r){this.db=e,this.garbageCollector=BW(this,r)}Yn(e){const r=this.er(e);return this.db.getTargetCache().getTargetCount(e).next(n=>r.next(s=>n+s))}er(e){let r=0;return this.Zn(e,n=>{r++}).next(()=>r)}forEachTarget(e,r){return this.db.getTargetCache().forEachTarget(e,r)}Zn(e,r){return this.tr(e,(n,s)=>r(s))}addReference(e,r,n){return V1(e,n)}removeReference(e,r,n){return V1(e,n)}removeTargets(e,r,n){return this.db.getTargetCache().removeTargets(e,r,n)}markPotentiallyOrphaned(e,r){return V1(e,r)}nr(e,r){return function(s,a){let i=!1;return Z8(s).Y(l=>J8(s,l,a).next(c=>(c&&(i=!0),Je.resolve(!c)))).next(()=>i)}(e,r)}removeOrphanedDocuments(e,r){const n=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let a=0;return this.tr(e,(i,l)=>{if(l<=r){const c=this.nr(e,i).next(u=>{if(!u)return a++,n.getEntry(e,i).next(()=>(n.removeEntry(i,ur.min()),Wu(e).delete(function(f){return[0,ti(f.path)]}(i))))});s.push(c)}}).next(()=>Je.waitFor(s)).next(()=>n.apply(e)).next(()=>a)}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,r){return V1(e,r)}tr(e,r){const n=Wu(e);let s,a=bi.oe;return n.J({index:"documentTargetsIndex"},([i,l],{path:c,sequenceNumber:u})=>{i===0?(a!==bi.oe&&r(new Yt(jl(s)),a),a=u,s=c):a=bi.oe}).next(()=>{a!==bi.oe&&r(new Yt(jl(s)),a)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function V1(t,e){return Wu(t).put(function(n,s){return{targetId:0,path:ti(n.path),sequenceNumber:s}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eR{constructor(){this.changes=new Gd(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,ls.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?Je.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $W{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,r,n){return pf(e).put(n)}removeEntry(e,r,n){return pf(e).delete(function(a,i){const l=a.path.toArray();return[l.slice(0,l.length-2),l[l.length-2],Cv(i),l[l.length-1]]}(r,n))}updateMetadata(e,r){return this.getMetadata(e).next(n=>(n.byteSize+=r,this.rr(e,n)))}getEntry(e,r){let n=ls.newInvalidDocument(r);return pf(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(dp(r))},(s,a)=>{n=this.ir(r,a)}).next(()=>n)}sr(e,r){let n={size:0,document:ls.newInvalidDocument(r)};return pf(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(dp(r))},(s,a)=>{n={document:this.ir(r,a),size:Iv(a)}}).next(()=>n)}getEntries(e,r){let n=Gi();return this._r(e,r,(s,a)=>{const i=this.ir(s,a);n=n.insert(s,i)}).next(()=>n)}ar(e,r){let n=Gi(),s=new jn(Yt.comparator);return this._r(e,r,(a,i)=>{const l=this.ir(a,i);n=n.insert(a,l),s=s.insert(a,Iv(i))}).next(()=>({documents:n,ur:s}))}_r(e,r,n){if(r.isEmpty())return Je.resolve();let s=new _n(RE);r.forEach(c=>s=s.add(c));const a=IDBKeyRange.bound(dp(s.first()),dp(s.last())),i=s.getIterator();let l=i.getNext();return pf(e).J({index:"documentKeyIndex",range:a},(c,u,d)=>{const f=Yt.fromSegments([...u.prefixPath,u.collectionGroup,u.documentId]);for(;l&&RE(l,f)<0;)n(l,null),l=i.getNext();l&&l.isEqual(f)&&(n(l,u),l=i.hasNext()?i.getNext():null),l?d.$(dp(l)):d.done()}).next(()=>{for(;l;)n(l,null),l=i.hasNext()?i.getNext():null})}getDocumentsMatchingQuery(e,r,n,s,a){const i=r.path,l=[i.popLast().toArray(),i.lastSegment(),Cv(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],c=[i.popLast().toArray(),i.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return pf(e).U(IDBKeyRange.bound(l,c,!0)).next(u=>{a==null||a.incrementDocumentReadCount(u.length);let d=Gi();for(const f of u){const m=this.ir(Yt.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);m.isFoundDocument()&&(Tx(r,m)||s.has(m.key))&&(d=d.insert(m.key,m))}return d})}getAllFromCollectionGroup(e,r,n,s){let a=Gi();const i=PE(r,n),l=PE(r,to.max());return pf(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(i,l,!0)},(c,u,d)=>{const f=this.ir(Yt.fromSegments(u.prefixPath.concat(u.collectionGroup,u.documentId)),u);a=a.insert(f.key,f),a.size===s&&d.done()}).next(()=>a)}newChangeBuffer(e){return new zW(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(r=>r.byteSize)}getMetadata(e){return jE(e).get("remoteDocumentGlobalKey").next(r=>(ar(!!r),r))}rr(e,r){return jE(e).put("remoteDocumentGlobalKey",r)}ir(e,r){if(r){const n=AW(this.serializer,r);if(!(n.isNoDocument()&&n.version.isEqual(ur.min())))return n}return ls.newInvalidDocument(e)}}function tR(t){return new $W(t)}class zW extends eR{constructor(e,r){super(),this.cr=e,this.trackRemovals=r,this.lr=new Gd(n=>n.toString(),(n,s)=>n.isEqual(s))}applyChanges(e){const r=[];let n=0,s=new _n((a,i)=>kr(a.canonicalString(),i.canonicalString()));return this.changes.forEach((a,i)=>{const l=this.lr.get(a);if(r.push(this.cr.removeEntry(e,a,l.readTime)),i.isValidDocument()){const c=xE(this.cr.serializer,i);s=s.add(a.path.popLast());const u=Iv(c);n+=u-l.size,r.push(this.cr.addEntry(e,a,c))}else if(n-=l.size,this.trackRemovals){const c=xE(this.cr.serializer,i.convertToNoDocument(ur.min()));r.push(this.cr.addEntry(e,a,c))}}),s.forEach(a=>{r.push(this.cr.indexManager.addToCollectionParentIndex(e,a))}),r.push(this.cr.updateMetadata(e,n)),Je.waitFor(r)}getFromCache(e,r){return this.cr.sr(e,r).next(n=>(this.lr.set(r,{size:n.size,readTime:n.document.readTime}),n.document))}getAllFromCache(e,r){return this.cr.ar(e,r).next(({documents:n,ur:s})=>(s.forEach((a,i)=>{this.lr.set(a,{size:i,readTime:n.get(a).readTime})}),n))}}function jE(t){return Gs(t,"remoteDocumentGlobal")}function pf(t){return Gs(t,"remoteDocumentsV14")}function dp(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function PE(t,e){const r=e.documentKey.path.toArray();return[t,Cv(e.readTime),r.slice(0,r.length-2),r.length>0?r[r.length-1]:""]}function RE(t,e){const r=t.path.toArray(),n=e.path.toArray();let s=0;for(let a=0;a<r.length-2&&a<n.length-2;++a)if(s=kr(r[a],n[a]),s)return s;return s=kr(r.length,n.length),s||(s=kr(r[r.length-2],n[n.length-2]),s||kr(r[r.length-1],n[n.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qW{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rR{constructor(e,r,n,s){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=s}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(s=>(n=s,this.remoteDocumentCache.getEntry(e,r))).next(s=>(n!==null&&Kp(n.mutation,s,wi.empty(),ft.now()),s))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,Fr()).next(()=>n))}getLocalViewOfDocuments(e,r,n=Fr()){const s=Pl();return this.populateOverlays(e,s,r).next(()=>this.computeViews(e,r,s,n).next(a=>{let i=Tp();return a.forEach((l,c)=>{i=i.insert(l,c.overlayedDocument)}),i}))}getOverlayedDocuments(e,r){const n=Pl();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,Fr()))}populateOverlays(e,r,n){const s=[];return n.forEach(a=>{r.has(a)||s.push(a)}),this.documentOverlayCache.getOverlays(e,s).next(a=>{a.forEach((i,l)=>{r.set(i,l)})})}computeViews(e,r,n,s){let a=Gi();const i=Gp(),l=function(){return Gp()}();return r.forEach((c,u)=>{const d=n.get(u.key);s.has(u.key)&&(d===void 0||d.mutation instanceof Kc)?a=a.insert(u.key,u):d!==void 0?(i.set(u.key,d.mutation.getFieldMask()),Kp(d.mutation,u,d.mutation.getFieldMask(),ft.now())):i.set(u.key,wi.empty())}),this.recalculateAndSaveOverlays(e,a).next(c=>(c.forEach((u,d)=>i.set(u,d)),r.forEach((u,d)=>{var f;return l.set(u,new qW(d,(f=i.get(u))!==null&&f!==void 0?f:null))}),l))}recalculateAndSaveOverlays(e,r){const n=Gp();let s=new jn((i,l)=>i-l),a=Fr();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(i=>{for(const l of i)l.keys().forEach(c=>{const u=r.get(c);if(u===null)return;let d=n.get(c)||wi.empty();d=l.applyToLocalView(u,d),n.set(c,d);const f=(s.get(l.batchId)||Fr()).add(c);s=s.insert(l.batchId,f)})}).next(()=>{const i=[],l=s.getReverseIterator();for(;l.hasNext();){const c=l.getNext(),u=c.key,d=c.value,f=_8();d.forEach(m=>{if(!a.has(m)){const h=k8(r.get(m),n.get(m));h!==null&&f.set(m,h),a=a.add(m)}}),i.push(this.documentOverlayCache.saveOverlays(e,u,f))}return Je.waitFor(i)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,s){return function(i){return Yt.isDocumentKey(i.path)&&i.collectionGroup===null&&i.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):g8(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,s):this.getDocumentsMatchingCollectionQuery(e,r,n,s)}getNextDocuments(e,r,n,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,s).next(a=>{const i=s-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,s-a.size):Je.resolve(Pl());let l=-1,c=a;return i.next(u=>Je.forEach(u,(d,f)=>(l<f.largestBatchId&&(l=f.largestBatchId),a.get(d)?Je.resolve():this.remoteDocumentCache.getEntry(e,d).next(m=>{c=c.insert(d,m)}))).next(()=>this.populateOverlays(e,u,a)).next(()=>this.computeViews(e,c,u,Fr())).next(d=>({batchId:l,changes:w8(d)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new Yt(r)).next(n=>{let s=Tp();return n.isFoundDocument()&&(s=s.insert(n.key,n)),s})}getDocumentsMatchingCollectionGroupQuery(e,r,n,s){const a=r.collectionGroup;let i=Tp();return this.indexManager.getCollectionParents(e,a).next(l=>Je.forEach(l,c=>{const u=function(f,m){return new km(m,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(r,c.child(a));return this.getDocumentsMatchingCollectionQuery(e,u,n,s).next(d=>{d.forEach((f,m)=>{i=i.insert(f,m)})})}).next(()=>i))}getDocumentsMatchingCollectionQuery(e,r,n,s){let a;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(i=>(a=i,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,a,s))).next(i=>{a.forEach((c,u)=>{const d=u.getKey();i.get(d)===null&&(i=i.insert(d,ls.newInvalidDocument(d)))});let l=Tp();return i.forEach((c,u)=>{const d=a.get(c);d!==void 0&&Kp(d.mutation,u,wi.empty(),ft.now()),Tx(r,u)&&(l=l.insert(c,u))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WW{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,r){return Je.resolve(this.hr.get(r))}saveBundleMetadata(e,r){return this.hr.set(r.id,function(s){return{id:s.id,version:s.version,createTime:ri(s.createTime)}}(r)),Je.resolve()}getNamedQuery(e,r){return Je.resolve(this.Pr.get(r))}saveNamedQuery(e,r){return this.Pr.set(r.name,function(s){return{name:s.name,query:K8(s.bundledQuery),readTime:ri(s.readTime)}}(r)),Je.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HW{constructor(){this.overlays=new jn(Yt.comparator),this.Ir=new Map}getOverlay(e,r){return Je.resolve(this.overlays.get(r))}getOverlays(e,r){const n=Pl();return Je.forEach(r,s=>this.getOverlay(e,s).next(a=>{a!==null&&n.set(s,a)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((s,a)=>{this.ht(e,r,a)}),Je.resolve()}removeOverlaysForBatchId(e,r,n){const s=this.Ir.get(n);return s!==void 0&&(s.forEach(a=>this.overlays=this.overlays.remove(a)),this.Ir.delete(n)),Je.resolve()}getOverlaysForCollection(e,r,n){const s=Pl(),a=r.length+1,i=new Yt(r.child("")),l=this.overlays.getIteratorFrom(i);for(;l.hasNext();){const c=l.getNext().value,u=c.getKey();if(!r.isPrefixOf(u.path))break;u.path.length===a&&c.largestBatchId>n&&s.set(c.getKey(),c)}return Je.resolve(s)}getOverlaysForCollectionGroup(e,r,n,s){let a=new jn((u,d)=>u-d);const i=this.overlays.getIterator();for(;i.hasNext();){const u=i.getNext().value;if(u.getKey().getCollectionGroup()===r&&u.largestBatchId>n){let d=a.get(u.largestBatchId);d===null&&(d=Pl(),a=a.insert(u.largestBatchId,d)),d.set(u.getKey(),u)}}const l=Pl(),c=a.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((u,d)=>l.set(u,d)),!(l.size()>=s)););return Je.resolve(l)}ht(e,r,n){const s=this.overlays.get(n.key);if(s!==null){const i=this.Ir.get(s.largestBatchId).delete(n.key);this.Ir.set(s.largestBatchId,i)}this.overlays=this.overlays.insert(n.key,new M4(r,n));let a=this.Ir.get(r);a===void 0&&(a=Fr(),this.Ir.set(r,a)),this.Ir.set(r,a.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GW{constructor(){this.sessionToken=Ss.EMPTY_BYTE_STRING}getSessionToken(e){return Je.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,Je.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z4{constructor(){this.Tr=new _n(Qs.Er),this.dr=new _n(Qs.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,r){const n=new Qs(e,r);this.Tr=this.Tr.add(n),this.dr=this.dr.add(n)}Rr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Vr(new Qs(e,r))}mr(e,r){e.forEach(n=>this.removeReference(n,r))}gr(e){const r=new Yt(new cn([])),n=new Qs(r,e),s=new Qs(r,e+1),a=[];return this.dr.forEachInRange([n,s],i=>{this.Vr(i),a.push(i.key)}),a}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const r=new Yt(new cn([])),n=new Qs(r,e),s=new Qs(r,e+1);let a=Fr();return this.dr.forEachInRange([n,s],i=>{a=a.add(i.key)}),a}containsKey(e){const r=new Qs(e,0),n=this.Tr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class Qs{constructor(e,r){this.key=e,this.wr=r}static Er(e,r){return Yt.comparator(e.key,r.key)||kr(e.wr,r.wr)}static Ar(e,r){return kr(e.wr,r.wr)||Yt.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KW{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.Sr=1,this.br=new _n(Qs.Er)}checkEmpty(e){return Je.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,s){const a=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const i=new L4(a,r,n,s);this.mutationQueue.push(i);for(const l of s)this.br=this.br.add(new Qs(l.key,a)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return Je.resolve(i)}lookupMutationBatch(e,r){return Je.resolve(this.Dr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,s=this.vr(n),a=s<0?0:s;return Je.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return Je.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return Je.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new Qs(r,0),s=new Qs(r,Number.POSITIVE_INFINITY),a=[];return this.br.forEachInRange([n,s],i=>{const l=this.Dr(i.wr);a.push(l)}),Je.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new _n(kr);return r.forEach(s=>{const a=new Qs(s,0),i=new Qs(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([a,i],l=>{n=n.add(l.wr)})}),Je.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,s=n.length+1;let a=n;Yt.isDocumentKey(a)||(a=a.child(""));const i=new Qs(new Yt(a),0);let l=new _n(kr);return this.br.forEachWhile(c=>{const u=c.key.path;return!!n.isPrefixOf(u)&&(u.length===s&&(l=l.add(c.wr)),!0)},i),Je.resolve(this.Cr(l))}Cr(e){const r=[];return e.forEach(n=>{const s=this.Dr(n);s!==null&&r.push(s)}),r}removeMutationBatch(e,r){ar(this.Fr(r.batchId,"removed")===0),this.mutationQueue.shift();let n=this.br;return Je.forEach(r.mutations,s=>{const a=new Qs(s.key,r.batchId);return n=n.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.br=n})}On(e){}containsKey(e,r){const n=new Qs(r,0),s=this.br.firstAfterOrEqual(n);return Je.resolve(r.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,Je.resolve()}Fr(e,r){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const r=this.vr(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YW{constructor(e){this.Mr=e,this.docs=function(){return new jn(Yt.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,s=this.docs.get(n),a=s?s.size:0,i=this.Mr(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:i}),this.size+=i-a,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return Je.resolve(n?n.document.mutableCopy():ls.newInvalidDocument(r))}getEntries(e,r){let n=Gi();return r.forEach(s=>{const a=this.docs.get(s);n=n.insert(s,a?a.document.mutableCopy():ls.newInvalidDocument(s))}),Je.resolve(n)}getDocumentsMatchingQuery(e,r,n,s){let a=Gi();const i=r.path,l=new Yt(i.child("")),c=this.docs.getIteratorFrom(l);for(;c.hasNext();){const{key:u,value:{document:d}}=c.getNext();if(!i.isPrefixOf(u.path))break;u.path.length>i.length+1||E4(KP(d),n)<=0||(s.has(d.key)||Tx(r,d))&&(a=a.insert(d.key,d.mutableCopy()))}return Je.resolve(a)}getAllFromCollectionGroup(e,r,n,s){tr()}Or(e,r){return Je.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new XW(this)}getSize(e){return Je.resolve(this.size)}}class XW extends eR{constructor(e){super(),this.cr=e}applyChanges(e){const r=[];return this.changes.forEach((n,s)=>{s.isValidDocument()?r.push(this.cr.addEntry(e,s)):this.cr.removeEntry(n)}),Je.waitFor(r)}getFromCache(e,r){return this.cr.getEntry(e,r)}getAllFromCache(e,r){return this.cr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QW{constructor(e){this.persistence=e,this.Nr=new Gd(r=>eh(r),Nx),this.lastRemoteSnapshotVersion=ur.min(),this.highestTargetId=0,this.Lr=0,this.Br=new z4,this.targetCount=0,this.kr=nh.Bn()}forEachTarget(e,r){return this.Nr.forEach((n,s)=>r(s)),Je.resolve()}getLastRemoteSnapshotVersion(e){return Je.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Je.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),Je.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.Lr&&(this.Lr=r),Je.resolve()}Kn(e){this.Nr.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.kr=new nh(r),this.highestTargetId=r),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,r){return this.Kn(r),this.targetCount+=1,Je.resolve()}updateTargetData(e,r){return this.Kn(r),Je.resolve()}removeTargetData(e,r){return this.Nr.delete(r.target),this.Br.gr(r.targetId),this.targetCount-=1,Je.resolve()}removeTargets(e,r,n){let s=0;const a=[];return this.Nr.forEach((i,l)=>{l.sequenceNumber<=r&&n.get(l.targetId)===null&&(this.Nr.delete(i),a.push(this.removeMatchingKeysForTargetId(e,l.targetId)),s++)}),Je.waitFor(a).next(()=>s)}getTargetCount(e){return Je.resolve(this.targetCount)}getTargetData(e,r){const n=this.Nr.get(r)||null;return Je.resolve(n)}addMatchingKeys(e,r,n){return this.Br.Rr(r,n),Je.resolve()}removeMatchingKeys(e,r,n){this.Br.mr(r,n);const s=this.persistence.referenceDelegate,a=[];return s&&r.forEach(i=>{a.push(s.markPotentiallyOrphaned(e,i))}),Je.waitFor(a)}removeMatchingKeysForTargetId(e,r){return this.Br.gr(r),Je.resolve()}getMatchingKeysForTargetId(e,r){const n=this.Br.yr(r);return Je.resolve(n)}containsKey(e,r){return Je.resolve(this.Br.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nR{constructor(e,r){this.qr={},this.overlays={},this.Qr=new bi(0),this.Kr=!1,this.Kr=!0,this.$r=new GW,this.referenceDelegate=e(this),this.Ur=new QW(this),this.indexManager=new DW,this.remoteDocumentCache=function(s){return new YW(s)}(n=>this.referenceDelegate.Wr(n)),this.serializer=new H8(r),this.Gr=new WW(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new HW,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.qr[e.toKey()];return n||(n=new KW(r,this.referenceDelegate),this.qr[e.toKey()]=n),n}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,r,n){kt("MemoryPersistence","Starting transaction:",e);const s=new JW(this.Qr.next());return this.referenceDelegate.zr(),n(s).next(a=>this.referenceDelegate.jr(s).next(()=>a)).toPromise().then(a=>(s.raiseOnCommittedEvent(),a))}Hr(e,r){return Je.or(Object.values(this.qr).map(n=>()=>n.containsKey(e,r)))}}class JW extends XP{constructor(e){super(),this.currentSequenceNumber=e}}class B2{constructor(e){this.persistence=e,this.Jr=new z4,this.Yr=null}static Zr(e){return new B2(e)}get Xr(){if(this.Yr)return this.Yr;throw tr()}addReference(e,r,n){return this.Jr.addReference(n,r),this.Xr.delete(n.toString()),Je.resolve()}removeReference(e,r,n){return this.Jr.removeReference(n,r),this.Xr.add(n.toString()),Je.resolve()}markPotentiallyOrphaned(e,r){return this.Xr.add(r.toString()),Je.resolve()}removeTarget(e,r){this.Jr.gr(r.targetId).forEach(s=>this.Xr.add(s.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(s=>{s.forEach(a=>this.Xr.add(a.toString()))}).next(()=>n.removeTargetData(e,r))}zr(){this.Yr=new Set}jr(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Je.forEach(this.Xr,n=>{const s=Yt.fromPath(n);return this.ei(e,s).next(a=>{a||r.removeEntry(s,ur.min())})}).next(()=>(this.Yr=null,r.apply(e)))}updateLimboDocument(e,r){return this.ei(e,r).next(n=>{n?this.Xr.delete(r.toString()):this.Xr.add(r.toString())})}Wr(e){return 0}ei(e,r){return Je.or([()=>Je.resolve(this.Jr.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Hr(e,r)])}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZW{constructor(e){this.serializer=e}O(e,r,n,s){const a=new P2("createOrUpgrade",r);n<1&&s>=1&&(function(c){c.createObjectStore("owner")}(e),function(c){c.createObjectStore("mutationQueues",{keyPath:"userId"}),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",GA,{unique:!0}),c.createObjectStore("documentMutations")}(e),DE(e),function(c){c.createObjectStore("remoteDocuments")}(e));let i=Je.resolve();return n<3&&s>=3&&(n!==0&&(function(c){c.deleteObjectStore("targetDocuments"),c.deleteObjectStore("targets"),c.deleteObjectStore("targetGlobal")}(e),DE(e)),i=i.next(()=>function(c){const u=c.store("targetGlobal"),d={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:ur.min().toTimestamp(),targetCount:0};return u.put("targetGlobalKey",d)}(a))),n<4&&s>=4&&(n!==0&&(i=i.next(()=>function(c,u){return u.store("mutations").U().next(d=>{c.deleteObjectStore("mutations"),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",GA,{unique:!0});const f=u.store("mutations"),m=d.map(h=>f.put(h));return Je.waitFor(m)})}(e,a))),i=i.next(()=>{(function(c){c.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),n<5&&s>=5&&(i=i.next(()=>this.ni(a))),n<6&&s>=6&&(i=i.next(()=>(function(c){c.createObjectStore("remoteDocumentGlobal")}(e),this.ri(a)))),n<7&&s>=7&&(i=i.next(()=>this.ii(a))),n<8&&s>=8&&(i=i.next(()=>this.si(e,a))),n<9&&s>=9&&(i=i.next(()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)})),n<10&&s>=10&&(i=i.next(()=>this.oi(a))),n<11&&s>=11&&(i=i.next(()=>{(function(c){c.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(c){c.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),n<12&&s>=12&&(i=i.next(()=>{(function(c){const u=c.createObjectStore("documentOverlays",{keyPath:Pq});u.createIndex("collectionPathOverlayIndex",Rq,{unique:!1}),u.createIndex("collectionGroupOverlayIndex",Dq,{unique:!1})})(e)})),n<13&&s>=13&&(i=i.next(()=>function(c){const u=c.createObjectStore("remoteDocumentsV14",{keyPath:wq});u.createIndex("documentKeyIndex",_q),u.createIndex("collectionGroupIndex",Nq)}(e)).next(()=>this._i(e,a)).next(()=>e.deleteObjectStore("remoteDocuments"))),n<14&&s>=14&&(i=i.next(()=>this.ai(e,a))),n<15&&s>=15&&(i=i.next(()=>function(c){c.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),c.createObjectStore("indexState",{keyPath:Cq}).createIndex("sequenceNumberIndex",kq,{unique:!1}),c.createObjectStore("indexEntries",{keyPath:Iq}).createIndex("documentKeyIndex",jq,{unique:!1})}(e))),n<16&&s>=16&&(i=i.next(()=>{r.objectStore("indexState").clear()}).next(()=>{r.objectStore("indexEntries").clear()})),n<17&&s>=17&&(i=i.next(()=>{(function(c){c.createObjectStore("globals",{keyPath:"name"})})(e)})),i}ri(e){let r=0;return e.store("remoteDocuments").J((n,s)=>{r+=Iv(s)}).next(()=>{const n={byteSize:r};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",n)})}ni(e){const r=e.store("mutationQueues"),n=e.store("mutations");return r.U().next(s=>Je.forEach(s,a=>{const i=IDBKeyRange.bound([a.userId,-1],[a.userId,a.lastAcknowledgedBatchId]);return n.U("userMutationsIndex",i).next(l=>Je.forEach(l,c=>{ar(c.userId===a.userId);const u=_f(this.serializer,c);return Q8(e,a.userId,u).next(()=>{})}))}))}ii(e){const r=e.store("targetDocuments"),n=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(s=>{const a=[];return n.J((i,l)=>{const c=new cn(i),u=function(f){return[0,ti(f)]}(c);a.push(r.get(u).next(d=>d?Je.resolve():(f=>r.put({targetId:0,path:ti(f),sequenceNumber:s.highestListenSequenceNumber}))(c)))}).next(()=>Je.waitFor(a))})}si(e,r){e.createObjectStore("collectionParents",{keyPath:Eq});const n=r.store("collectionParents"),s=new $4,a=i=>{if(s.add(i)){const l=i.lastSegment(),c=i.popLast();return n.put({collectionId:l,parent:ti(c)})}};return r.store("remoteDocuments").J({H:!0},(i,l)=>{const c=new cn(i);return a(c.popLast())}).next(()=>r.store("documentMutations").J({H:!0},([i,l,c],u)=>{const d=jl(l);return a(d.popLast())}))}oi(e){const r=e.store("targets");return r.J((n,s)=>{const a=Ep(s),i=G8(this.serializer,a);return r.put(i)})}_i(e,r){const n=r.store("remoteDocuments"),s=[];return n.J((a,i)=>{const l=r.store("remoteDocumentsV14"),c=function(f){return f.document?new Yt(cn.fromString(f.document.name).popFirst(5)):f.noDocument?Yt.fromSegments(f.noDocument.path):f.unknownDocument?Yt.fromSegments(f.unknownDocument.path):tr()}(i).path.toArray(),u={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:i.readTime||[0,0],unknownDocument:i.unknownDocument,noDocument:i.noDocument,document:i.document,hasCommittedMutations:!!i.hasCommittedMutations};s.push(l.put(u))}).next(()=>Je.waitFor(s))}ai(e,r){const n=r.store("mutations"),s=tR(this.serializer),a=new nR(B2.Zr,this.serializer.ct);return n.U().next(i=>{const l=new Map;return i.forEach(c=>{var u;let d=(u=l.get(c.userId))!==null&&u!==void 0?u:Fr();_f(this.serializer,c).keys().forEach(f=>d=d.add(f)),l.set(c.userId,d)}),Je.forEach(l,(c,u)=>{const d=new ea(u),f=M2.lt(this.serializer,d),m=a.getIndexManager(d),h=V2.lt(d,this.serializer,m,a.referenceDelegate);return new rR(s,h,f,m).recalculateAndSaveOverlaysForDocumentKeys(new o_(r,bi.oe),c).next()})})}}function DE(t){t.createObjectStore("targetDocuments",{keyPath:Tq}).createIndex("documentTargetsIndex",Aq,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",Sq,{unique:!0}),t.createObjectStore("targetGlobal")}const hw="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class q4{constructor(e,r,n,s,a,i,l,c,u,d,f=17){if(this.allowTabSynchronization=e,this.persistenceKey=r,this.clientId=n,this.ui=a,this.window=i,this.document=l,this.ci=u,this.li=d,this.hi=f,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=m=>Promise.resolve(),!q4.D())throw new Bt(dt.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new UW(this,s),this.Ai=r+"main",this.serializer=new H8(c),this.Ri=new md(this.Ai,this.hi,new ZW(this.serializer)),this.$r=new CW,this.Ur=new LW(this.referenceDelegate,this.serializer),this.remoteDocumentCache=tR(this.serializer),this.Gr=new EW,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,d===!1&&bs("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Bt(dt.FAILED_PRECONDITION,hw);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ur.getHighestSequenceNumber(e))}).then(e=>{this.Qr=new bi(e,this.ci)}).then(()=>{this.Kr=!0}).catch(e=>(this.Ri&&this.Ri.close(),Promise.reject(e)))}yi(e){return this.di=async r=>{if(this.started)return e(r)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L(async r=>{r.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget(async()=>{this.started&&await this.mi()}))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>B1(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.wi(e).next(r=>{r||(this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)))})}).next(()=>this.Si(e)).next(r=>this.isPrimary&&!r?this.bi(e).next(()=>!1):!!r&&this.Di(e).next(()=>!0))).catch(e=>{if(Hd(e))return kt("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return kt("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ui.enqueueRetryable(()=>this.di(e)),this.isPrimary=e})}wi(e){return fp(e).get("owner").next(r=>Je.resolve(this.vi(r)))}Ci(e){return B1(e).delete(this.clientId)}async Fi(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",r=>{const n=Gs(r,"clientMetadata");return n.U().next(s=>{const a=this.xi(s,18e5),i=s.filter(l=>a.indexOf(l)===-1);return Je.forEach(i,l=>n.delete(l.clientId)).next(()=>i)})}).catch(()=>[]);if(this.Vi)for(const r of e)this.Vi.removeItem(this.Oi(r.clientId))}}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.Fi()).then(()=>this.pi()))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?Je.resolve(!0):fp(e).get("owner").next(r=>{if(r!==null&&this.Mi(r.leaseTimestampMs,5e3)&&!this.Ni(r.ownerId)){if(this.vi(r)&&this.networkEnabled)return!0;if(!this.vi(r)){if(!r.allowTabSynchronization)throw new Bt(dt.FAILED_PRECONDITION,hw);return!1}}return!(!this.networkEnabled||!this.inForeground)||B1(e).U().next(n=>this.xi(n,5e3).find(s=>{if(this.clientId!==s.clientId){const a=!this.networkEnabled&&s.networkEnabled,i=!this.inForeground&&s.inForeground,l=this.networkEnabled===s.networkEnabled;if(a||i&&l)return!0}return!1})===void 0)}).next(r=>(this.isPrimary!==r&&kt("IndexedDbPersistence",`Client ${r?"is":"is not"} eligible for a primary lease.`),r))}async shutdown(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),await this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const r=new o_(e,bi.oe);return this.bi(r).next(()=>this.Ci(r))}),this.Ri.close(),this.qi()}xi(e,r){return e.filter(n=>this.Mi(n.updateTimeMs,r)&&!this.Ni(n.clientId))}Qi(){return this.runTransaction("getActiveClients","readonly",e=>B1(e).U().next(r=>this.xi(r,18e5).map(n=>n.clientId)))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,r){return V2.lt(e,this.serializer,r,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new FW(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return M2.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,r,n){kt("IndexedDbPersistence","Starting transaction:",e);const s=r==="readonly"?"readonly":"readwrite",a=function(c){return c===17?Oq:c===16?Lq:c===15?k4:c===14?r8:c===13?t8:c===12?Fq:c===11?e8:void tr()}(this.hi);let i;return this.Ri.runTransaction(e,s,a,l=>(i=new o_(l,this.Qr?this.Qr.next():bi.oe),r==="readwrite-primary"?this.wi(i).next(c=>!!c||this.Si(i)).next(c=>{if(!c)throw bs(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)),new Bt(dt.FAILED_PRECONDITION,YP);return n(i)}).next(c=>this.Di(i).next(()=>c)):this.Ki(i).next(()=>n(i)))).then(l=>(i.raiseOnCommittedEvent(),l))}Ki(e){return fp(e).get("owner").next(r=>{if(r!==null&&this.Mi(r.leaseTimestampMs,5e3)&&!this.Ni(r.ownerId)&&!this.vi(r)&&!(this.li||this.allowTabSynchronization&&r.allowTabSynchronization))throw new Bt(dt.FAILED_PRECONDITION,hw)})}Di(e){const r={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return fp(e).put("owner",r)}static D(){return md.D()}bi(e){const r=fp(e);return r.get("owner").next(n=>this.vi(n)?(kt("IndexedDbPersistence","Releasing primary lease."),r.delete("owner")):Je.resolve())}Mi(e,r){const n=Date.now();return!(e<n-r)&&(!(e>n)||(bs(`Detected an update time that is in the future: ${e} > ${n}`),!1))}fi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ii=()=>{this.ui.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.mi()))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground=this.document.visibilityState==="visible")}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Pi=()=>{this.Li();const r=/(?:Version|Mobile)\/1[456]/;Xj()&&(navigator.appVersion.match(r)||navigator.userAgent.match(r))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var r;try{const n=((r=this.Vi)===null||r===void 0?void 0:r.getItem(this.Oi(e)))!==null;return kt("IndexedDbPersistence",`Client '${e}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(n){return bs("IndexedDbPersistence","Failed to get zombied client id.",n),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){bs("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function fp(t){return Gs(t,"owner")}function B1(t){return Gs(t,"clientMetadata")}function sR(t,e){let r=t.projectId;return t.isDefaultDatabase||(r+="."+t.database),"firestore/"+e+"/"+r+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W4{constructor(e,r,n,s){this.targetId=e,this.fromCache=r,this.$i=n,this.Ui=s}static Wi(e,r){let n=Fr(),s=Fr();for(const a of r.docChanges)switch(a.type){case 0:n=n.add(a.doc.key);break;case 1:s=s.add(a.doc.key)}return new W4(e,r.fromCache,n,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eH{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aR{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return Xj()?8:QP(Ws())>0?6:4}()}initialize(e,r){this.Ji=e,this.indexManager=r,this.Gi=!0}getDocumentsMatchingQuery(e,r,n,s){const a={result:null};return this.Yi(e,r).next(i=>{a.result=i}).next(()=>{if(!a.result)return this.Zi(e,r,s,n).next(i=>{a.result=i})}).next(()=>{if(a.result)return;const i=new eH;return this.Xi(e,r,i).next(l=>{if(a.result=l,this.zi)return this.es(e,r,i,l.size)})}).next(()=>a.result)}es(e,r,n,s){return n.documentReadCount<this.ji?(i0()<=$r.DEBUG&&kt("QueryEngine","SDK will not create cache indexes for query:",o0(r),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),Je.resolve()):(i0()<=$r.DEBUG&&kt("QueryEngine","Query:",o0(r),"scans",n.documentReadCount,"local documents and returns",s,"documents as results."),n.documentReadCount>this.Hi*s?(i0()<=$r.DEBUG&&kt("QueryEngine","The SDK decides to create cache indexes for query:",o0(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ji(r))):Je.resolve())}Yi(e,r){if(iE(r))return Je.resolve(null);let n=Ji(r);return this.indexManager.getIndexType(e,n).next(s=>s===0?null:(r.limit!==null&&s===1&&(r=Tv(r,null,"F"),n=Ji(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(a=>{const i=Fr(...a);return this.Ji.getDocuments(e,i).next(l=>this.indexManager.getMinOffset(e,n).next(c=>{const u=this.ts(r,l);return this.ns(r,u,i,c.readTime)?this.Yi(e,Tv(r,null,"F")):this.rs(e,u,r,c)}))})))}Zi(e,r,n,s){return iE(r)||s.isEqual(ur.min())?Je.resolve(null):this.Ji.getDocuments(e,n).next(a=>{const i=this.ts(r,a);return this.ns(r,i,n,s)?Je.resolve(null):(i0()<=$r.DEBUG&&kt("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),o0(r)),this.rs(e,i,r,GP(s,-1)).next(l=>l))})}ts(e,r){let n=new _n(v8(e));return r.forEach((s,a)=>{Tx(e,a)&&(n=n.add(a))}),n}ns(e,r,n,s){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const a=e.limitType==="F"?r.last():r.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(s)>0)}Xi(e,r,n){return i0()<=$r.DEBUG&&kt("QueryEngine","Using full collection scan to execute query:",o0(r)),this.Ji.getDocumentsMatchingQuery(e,r,to.min(),n)}rs(e,r,n,s){return this.Ji.getDocumentsMatchingQuery(e,n,s).next(a=>(r.forEach(i=>{a=a.insert(i.key,i)}),a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tH{constructor(e,r,n,s){this.persistence=e,this.ss=r,this.serializer=s,this.os=new jn(kr),this._s=new Gd(a=>eh(a),Nx),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(n)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new rR(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.os))}}function iR(t,e,r,n){return new tH(t,e,r,n)}async function oR(t,e){const r=rr(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let s;return r.mutationQueue.getAllMutationBatches(n).next(a=>(s=a,r.ls(e),r.mutationQueue.getAllMutationBatches(n))).next(a=>{const i=[],l=[];let c=Fr();for(const u of s){i.push(u.batchId);for(const d of u.mutations)c=c.add(d.key)}for(const u of a){l.push(u.batchId);for(const d of u.mutations)c=c.add(d.key)}return r.localDocuments.getDocuments(n,c).next(u=>({hs:u,removedBatchIds:i,addedBatchIds:l}))})})}function rH(t,e){const r=rr(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const s=e.batch.keys(),a=r.cs.newChangeBuffer({trackRemovals:!0});return function(l,c,u,d){const f=u.batch,m=f.keys();let h=Je.resolve();return m.forEach(g=>{h=h.next(()=>d.getEntry(c,g)).next(p=>{const v=u.docVersions.get(g);ar(v!==null),p.version.compareTo(v)<0&&(f.applyToRemoteDocument(p,u),p.isValidDocument()&&(p.setReadTime(u.commitVersion),d.addEntry(p)))})}),h.next(()=>l.mutationQueue.removeMutationBatch(c,f))}(r,n,e,a).next(()=>a.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,s,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(l){let c=Fr();for(let u=0;u<l.mutationResults.length;++u)l.mutationResults[u].transformResults.length>0&&(c=c.add(l.batch.mutations[u].key));return c}(e))).next(()=>r.localDocuments.getDocuments(n,s))})}function lR(t){const e=rr(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Ur.getLastRemoteSnapshotVersion(r))}function nH(t,e){const r=rr(t),n=e.snapshotVersion;let s=r.os;return r.persistence.runTransaction("Apply remote event","readwrite-primary",a=>{const i=r.cs.newChangeBuffer({trackRemovals:!0});s=r.os;const l=[];e.targetChanges.forEach((d,f)=>{const m=s.get(f);if(!m)return;l.push(r.Ur.removeMatchingKeys(a,d.removedDocuments,f).next(()=>r.Ur.addMatchingKeys(a,d.addedDocuments,f)));let h=m.withSequenceNumber(a.currentSequenceNumber);e.targetMismatches.get(f)!==null?h=h.withResumeToken(Ss.EMPTY_BYTE_STRING,ur.min()).withLastLimboFreeSnapshotVersion(ur.min()):d.resumeToken.approximateByteSize()>0&&(h=h.withResumeToken(d.resumeToken,n)),s=s.insert(f,h),function(p,v,b){return p.resumeToken.approximateByteSize()===0||v.snapshotVersion.toMicroseconds()-p.snapshotVersion.toMicroseconds()>=3e8?!0:b.addedDocuments.size+b.modifiedDocuments.size+b.removedDocuments.size>0}(m,h,d)&&l.push(r.Ur.updateTargetData(a,h))});let c=Gi(),u=Fr();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&l.push(r.persistence.referenceDelegate.updateLimboDocument(a,d))}),l.push(sH(a,i,e.documentUpdates).next(d=>{c=d.Ps,u=d.Is})),!n.isEqual(ur.min())){const d=r.Ur.getLastRemoteSnapshotVersion(a).next(f=>r.Ur.setTargetsMetadata(a,a.currentSequenceNumber,n));l.push(d)}return Je.waitFor(l).next(()=>i.apply(a)).next(()=>r.localDocuments.getLocalViewOfDocuments(a,c,u)).next(()=>c)}).then(a=>(r.os=s,a))}function sH(t,e,r){let n=Fr(),s=Fr();return r.forEach(a=>n=n.add(a)),e.getEntries(t,n).next(a=>{let i=Gi();return r.forEach((l,c)=>{const u=a.get(l);c.isFoundDocument()!==u.isFoundDocument()&&(s=s.add(l)),c.isNoDocument()&&c.version.isEqual(ur.min())?(e.removeEntry(l,c.readTime),i=i.insert(l,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(c),i=i.insert(l,c)):kt("LocalStore","Ignoring outdated watch update for ",l,". Current version:",u.version," Watch version:",c.version)}),{Ps:i,Is:s}})}function aH(t,e){const r=rr(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=-1),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function jv(t,e){const r=rr(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let s;return r.Ur.getTargetData(n,e).next(a=>a?(s=a,Je.resolve(s)):r.Ur.allocateTargetId(n).next(i=>(s=new Nc(e,i,"TargetPurposeListen",n.currentSequenceNumber),r.Ur.addTargetData(n,s).next(()=>s))))}).then(n=>{const s=r.os.get(n.targetId);return(s===null||n.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(r.os=r.os.insert(n.targetId,n),r._s.set(e,n.targetId)),n})}async function dm(t,e,r){const n=rr(t),s=n.os.get(e),a=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",a,i=>n.persistence.referenceDelegate.removeTarget(i,s))}catch(i){if(!Hd(i))throw i;kt("LocalStore",`Failed to update sequence numbers for target ${e}: ${i}`)}n.os=n.os.remove(e),n._s.delete(s.target)}function w_(t,e,r){const n=rr(t);let s=ur.min(),a=Fr();return n.persistence.runTransaction("Execute query","readwrite",i=>function(c,u,d){const f=rr(c),m=f._s.get(d);return m!==void 0?Je.resolve(f.os.get(m)):f.Ur.getTargetData(u,d)}(n,i,Ji(e)).next(l=>{if(l)return s=l.lastLimboFreeSnapshotVersion,n.Ur.getMatchingKeysForTargetId(i,l.targetId).next(c=>{a=c})}).next(()=>n.ss.getDocumentsMatchingQuery(i,e,r?s:ur.min(),r?a:Fr())).next(l=>(dR(n,y8(e),l),{documents:l,Ts:a})))}function cR(t,e){const r=rr(t),n=rr(r.Ur),s=r.os.get(e);return s?Promise.resolve(s.target):r.persistence.runTransaction("Get target data","readonly",a=>n.ot(a,e).next(i=>i?i.target:null))}function uR(t,e){const r=rr(t),n=r.us.get(e)||ur.min();return r.persistence.runTransaction("Get new document changes","readonly",s=>r.cs.getAllFromCollectionGroup(s,e,GP(n,-1),Number.MAX_SAFE_INTEGER)).then(s=>(dR(r,e,s),s))}function dR(t,e,r){let n=t.us.get(e)||ur.min();r.forEach((s,a)=>{a.readTime.compareTo(n)>0&&(n=a.readTime)}),t.us.set(e,n)}function FE(t,e){return`firestore_clients_${t}_${e}`}function LE(t,e,r){let n=`firestore_mutations_${t}_${r}`;return e.isAuthenticated()&&(n+=`_${e.uid}`),n}function mw(t,e){return`firestore_targets_${t}_${e}`}class Pv{constructor(e,r,n,s){this.user=e,this.batchId=r,this.state=n,this.error=s}static Rs(e,r,n){const s=JSON.parse(n);let a,i=typeof s=="object"&&["pending","acknowledged","rejected"].indexOf(s.state)!==-1&&(s.error===void 0||typeof s.error=="object");return i&&s.error&&(i=typeof s.error.message=="string"&&typeof s.error.code=="string",i&&(a=new Bt(s.error.code,s.error.message))),i?new Pv(e,r,s.state,a):(bs("SharedClientState",`Failed to parse mutation state for ID '${r}': ${n}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Yp{constructor(e,r,n){this.targetId=e,this.state=r,this.error=n}static Rs(e,r){const n=JSON.parse(r);let s,a=typeof n=="object"&&["not-current","current","rejected"].indexOf(n.state)!==-1&&(n.error===void 0||typeof n.error=="object");return a&&n.error&&(a=typeof n.error.message=="string"&&typeof n.error.code=="string",a&&(s=new Bt(n.error.code,n.error.message))),a?new Yp(e,n.state,s):(bs("SharedClientState",`Failed to parse target state for ID '${e}': ${r}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Rv{constructor(e,r){this.clientId=e,this.activeTargetIds=r}static Rs(e,r){const n=JSON.parse(r);let s=typeof n=="object"&&n.activeTargetIds instanceof Array,a=R4();for(let i=0;s&&i<n.activeTargetIds.length;++i)s=JP(n.activeTargetIds[i]),a=a.add(n.activeTargetIds[i]);return s?new Rv(e,a):(bs("SharedClientState",`Failed to parse client data for instance '${e}': ${r}`),null)}}class H4{constructor(e,r){this.clientId=e,this.onlineState=r}static Rs(e){const r=JSON.parse(e);return typeof r=="object"&&["Unknown","Online","Offline"].indexOf(r.onlineState)!==-1&&typeof r.clientId=="string"?new H4(r.clientId,r.onlineState):(bs("SharedClientState",`Failed to parse online state: ${e}`),null)}}class __{constructor(){this.activeTargetIds=R4()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class pw{constructor(e,r,n,s,a){this.window=e,this.ui=r,this.persistenceKey=n,this.ps=s,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ys=this.ws.bind(this),this.Ss=new jn(kr),this.started=!1,this.bs=[];const i=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=a,this.Ds=FE(this.persistenceKey,this.ps),this.vs=function(c){return`firestore_sequence_number_${c}`}(this.persistenceKey),this.Ss=this.Ss.insert(this.ps,new __),this.Cs=new RegExp(`^firestore_clients_${i}_([^_]*)$`),this.Fs=new RegExp(`^firestore_mutations_${i}_(\\d+)(?:_(.*))?$`),this.Ms=new RegExp(`^firestore_targets_${i}_(\\d+)$`),this.xs=function(c){return`firestore_online_state_${c}`}(this.persistenceKey),this.Os=function(c){return`firestore_bundle_loaded_v2_${c}`}(this.persistenceKey),this.window.addEventListener("storage",this.ys)}static D(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Qi();for(const n of e){if(n===this.ps)continue;const s=this.getItem(FE(this.persistenceKey,n));if(s){const a=Rv.Rs(n,s);a&&(this.Ss=this.Ss.insert(a.clientId,a))}}this.Ns();const r=this.storage.getItem(this.xs);if(r){const n=this.Ls(r);n&&this.Bs(n)}for(const n of this.bs)this.ws(n);this.bs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.vs,JSON.stringify(e))}getAllActiveQueryTargets(){return this.ks(this.Ss)}isActiveQueryTarget(e){let r=!1;return this.Ss.forEach((n,s)=>{s.activeTargetIds.has(e)&&(r=!0)}),r}addPendingMutation(e){this.qs(e,"pending")}updateMutationState(e,r,n){this.qs(e,r,n),this.Qs(e)}addLocalQueryTarget(e,r=!0){let n="not-current";if(this.isActiveQueryTarget(e)){const s=this.storage.getItem(mw(this.persistenceKey,e));if(s){const a=Yp.Rs(e,s);a&&(n=a.state)}}return r&&this.Ks.fs(e),this.Ns(),n}removeLocalQueryTarget(e){this.Ks.gs(e),this.Ns()}isLocalQueryTarget(e){return this.Ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(mw(this.persistenceKey,e))}updateQueryState(e,r,n){this.$s(e,r,n)}handleUserChange(e,r,n){r.forEach(s=>{this.Qs(s)}),this.currentUser=e,n.forEach(s=>{this.addPendingMutation(s)})}setOnlineState(e){this.Us(e)}notifyBundleLoaded(e){this.Ws(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ys),this.removeItem(this.Ds),this.started=!1)}getItem(e){const r=this.storage.getItem(e);return kt("SharedClientState","READ",e,r),r}setItem(e,r){kt("SharedClientState","SET",e,r),this.storage.setItem(e,r)}removeItem(e){kt("SharedClientState","REMOVE",e),this.storage.removeItem(e)}ws(e){const r=e;if(r.storageArea===this.storage){if(kt("SharedClientState","EVENT",r.key,r.newValue),r.key===this.Ds)return void bs("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ui.enqueueRetryable(async()=>{if(this.started){if(r.key!==null){if(this.Cs.test(r.key)){if(r.newValue==null){const n=this.Gs(r.key);return this.zs(n,null)}{const n=this.js(r.key,r.newValue);if(n)return this.zs(n.clientId,n)}}else if(this.Fs.test(r.key)){if(r.newValue!==null){const n=this.Hs(r.key,r.newValue);if(n)return this.Js(n)}}else if(this.Ms.test(r.key)){if(r.newValue!==null){const n=this.Ys(r.key,r.newValue);if(n)return this.Zs(n)}}else if(r.key===this.xs){if(r.newValue!==null){const n=this.Ls(r.newValue);if(n)return this.Bs(n)}}else if(r.key===this.vs){const n=function(a){let i=bi.oe;if(a!=null)try{const l=JSON.parse(a);ar(typeof l=="number"),i=l}catch(l){bs("SharedClientState","Failed to read sequence number from WebStorage",l)}return i}(r.newValue);n!==bi.oe&&this.sequenceNumberHandler(n)}else if(r.key===this.Os){const n=this.Xs(r.newValue);await Promise.all(n.map(s=>this.syncEngine.eo(s)))}}}else this.bs.push(r)})}}get Ks(){return this.Ss.get(this.ps)}Ns(){this.setItem(this.Ds,this.Ks.Vs())}qs(e,r,n){const s=new Pv(this.currentUser,e,r,n),a=LE(this.persistenceKey,this.currentUser,e);this.setItem(a,s.Vs())}Qs(e){const r=LE(this.persistenceKey,this.currentUser,e);this.removeItem(r)}Us(e){const r={clientId:this.ps,onlineState:e};this.storage.setItem(this.xs,JSON.stringify(r))}$s(e,r,n){const s=mw(this.persistenceKey,e),a=new Yp(e,r,n);this.setItem(s,a.Vs())}Ws(e){const r=JSON.stringify(Array.from(e));this.setItem(this.Os,r)}Gs(e){const r=this.Cs.exec(e);return r?r[1]:null}js(e,r){const n=this.Gs(e);return Rv.Rs(n,r)}Hs(e,r){const n=this.Fs.exec(e),s=Number(n[1]),a=n[2]!==void 0?n[2]:null;return Pv.Rs(new ea(a),s,r)}Ys(e,r){const n=this.Ms.exec(e),s=Number(n[1]);return Yp.Rs(s,r)}Ls(e){return H4.Rs(e)}Xs(e){return JSON.parse(e)}async Js(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.no(e.batchId,e.state,e.error);kt("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}Zs(e){return this.syncEngine.ro(e.targetId,e.state,e.error)}zs(e,r){const n=r?this.Ss.insert(e,r):this.Ss.remove(e),s=this.ks(this.Ss),a=this.ks(n),i=[],l=[];return a.forEach(c=>{s.has(c)||i.push(c)}),s.forEach(c=>{a.has(c)||l.push(c)}),this.syncEngine.io(i,l).then(()=>{this.Ss=n})}Bs(e){this.Ss.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}ks(e){let r=R4();return e.forEach((n,s)=>{r=r.unionWith(s.activeTargetIds)}),r}}class fR{constructor(){this.so=new __,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,r,n){this.oo[e]=r}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new __,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iH{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OE{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){kt("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){kt("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let U1=null;function gw(){return U1===null?U1=function(){return 268435456+Math.round(2147483648*Math.random())}():U1++,"0x"+U1.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oH={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lH{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _a="WebChannelConnection";class cH extends class{constructor(r){this.databaseInfo=r,this.databaseId=r.databaseId;const n=r.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.Do=n+"://"+r.host,this.vo=`projects/${s}/databases/${a}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${a}`}get Fo(){return!1}Mo(r,n,s,a,i){const l=gw(),c=this.xo(r,n.toUriEncodedString());kt("RestConnection",`Sending RPC '${r}' ${l}:`,c,s);const u={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(u,a,i),this.No(r,c,u,s).then(d=>(kt("RestConnection",`Received RPC '${r}' ${l}: `,d),d),d=>{throw Qf("RestConnection",`RPC '${r}' ${l} failed with error: `,d,"url: ",c,"request:",s),d})}Lo(r,n,s,a,i,l){return this.Mo(r,n,s,a,i)}Oo(r,n,s){r["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Cm}(),r["Content-Type"]="text/plain",this.databaseInfo.appId&&(r["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((a,i)=>r[i]=a),s&&s.headers.forEach((a,i)=>r[i]=a)}xo(r,n){const s=oH[r];return`${this.Do}/v1/${n}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,r,n,s){const a=gw();return new Promise((i,l)=>{const c=new VP;c.setWithCredentials(!0),c.listenOnce(BP.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case Ty.NO_ERROR:const d=c.getResponseJson();kt(_a,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(d)),i(d);break;case Ty.TIMEOUT:kt(_a,`RPC '${e}' ${a} timed out`),l(new Bt(dt.DEADLINE_EXCEEDED,"Request time out"));break;case Ty.HTTP_ERROR:const f=c.getStatus();if(kt(_a,`RPC '${e}' ${a} failed with status:`,f,"response text:",c.getResponseText()),f>0){let m=c.getResponseJson();Array.isArray(m)&&(m=m[0]);const h=m==null?void 0:m.error;if(h&&h.status&&h.message){const g=function(v){const b=v.toLowerCase().replace(/_/g,"-");return Object.values(dt).indexOf(b)>=0?b:dt.UNKNOWN}(h.status);l(new Bt(g,h.message))}else l(new Bt(dt.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new Bt(dt.UNAVAILABLE,"Connection failed."));break;default:tr()}}finally{kt(_a,`RPC '${e}' ${a} completed.`)}});const u=JSON.stringify(s);kt(_a,`RPC '${e}' ${a} sending request:`,s),c.send(r,"POST",u,n,15)})}Bo(e,r,n){const s=gw(),a=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=zP(),l=$P(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Oo(c.initMessageHeaders,r,n),c.encodeInitMessageHeaders=!0;const d=a.join("");kt(_a,`Creating RPC '${e}' stream ${s}: ${d}`,c);const f=i.createWebChannel(d,c);let m=!1,h=!1;const g=new lH({Io:v=>{h?kt(_a,`Not sending because RPC '${e}' stream ${s} is closed:`,v):(m||(kt(_a,`Opening RPC '${e}' stream ${s} transport.`),f.open(),m=!0),kt(_a,`RPC '${e}' stream ${s} sending:`,v),f.send(v))},To:()=>f.close()}),p=(v,b,w)=>{v.listen(b,N=>{try{w(N)}catch(j){setTimeout(()=>{throw j},0)}})};return p(f,Sp.EventType.OPEN,()=>{h||(kt(_a,`RPC '${e}' stream ${s} transport opened.`),g.yo())}),p(f,Sp.EventType.CLOSE,()=>{h||(h=!0,kt(_a,`RPC '${e}' stream ${s} transport closed`),g.So())}),p(f,Sp.EventType.ERROR,v=>{h||(h=!0,Qf(_a,`RPC '${e}' stream ${s} transport errored:`,v),g.So(new Bt(dt.UNAVAILABLE,"The operation could not be completed")))}),p(f,Sp.EventType.MESSAGE,v=>{var b;if(!h){const w=v.data[0];ar(!!w);const N=w,j=N.error||((b=N[0])===null||b===void 0?void 0:b.error);if(j){kt(_a,`RPC '${e}' stream ${s} received error:`,j);const F=j.status;let U=function(k){const M=js[k];if(M!==void 0)return P8(M)}(F),A=j.message;U===void 0&&(U=dt.INTERNAL,A="Unknown error status: "+F+" with message "+j.message),h=!0,g.So(new Bt(U,A)),f.close()}else kt(_a,`RPC '${e}' stream ${s} received:`,w),g.bo(w)}}),p(l,UP.STAT_EVENT,v=>{v.stat===a_.PROXY?kt(_a,`RPC '${e}' stream ${s} detected buffering proxy`):v.stat===a_.NOPROXY&&kt(_a,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{g.wo()},0),g}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hR(){return typeof window<"u"?window:null}function Py(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function U2(t){return new gW(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mR{constructor(e,r,n=1e3,s=1.5,a=6e4){this.ui=e,this.timerId=r,this.ko=n,this.qo=s,this.Qo=a,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const r=Math.floor(this.Ko+this.zo()),n=Math.max(0,Date.now()-this.Uo),s=Math.max(0,r-n);s>0&&kt("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pR{constructor(e,r,n,s,a,i,l,c){this.ui=e,this.Ho=n,this.Jo=s,this.connection=a,this.authCredentialsProvider=i,this.appCheckCredentialsProvider=l,this.listener=c,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new mR(e,r)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,r){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():r&&r.code===dt.RESOURCE_EXHAUSTED?(bs(r.toString()),bs("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):r&&r.code===dt.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(r)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),r=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,s])=>{this.Yo===r&&this.P_(n,s)},n=>{e(()=>{const s=new Bt(dt.UNKNOWN,"Fetching auth token failed: "+n.message);return this.I_(s)})})}P_(e,r){const n=this.h_(this.Yo);this.stream=this.T_(e,r),this.stream.Eo(()=>{n(()=>this.listener.Eo())}),this.stream.Ro(()=>{n(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{n(()=>this.I_(s))}),this.stream.onMessage(s=>{n(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return kt("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return r=>{this.ui.enqueueAndForget(()=>this.Yo===e?r():(kt("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class uH extends pR{constructor(e,r,n,s,a,i){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,s,i),this.serializer=a}T_(e,r){return this.connection.Bo("Listen",e,r)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const r=vW(this.serializer,e),n=function(a){if(!("targetChange"in a))return ur.min();const i=a.targetChange;return i.targetIds&&i.targetIds.length?ur.min():i.readTime?ri(i.readTime):ur.min()}(e);return this.listener.d_(r,n)}A_(e){const r={};r.database=g_(this.serializer),r.addTarget=function(a,i){let l;const c=i.target;if(l=Nv(c)?{documents:B8(a,c)}:{query:U8(a,c)._t},l.targetId=i.targetId,i.resumeToken.approximateByteSize()>0){l.resumeToken=F8(a,i.resumeToken);const u=m_(a,i.expectedCount);u!==null&&(l.expectedCount=u)}else if(i.snapshotVersion.compareTo(ur.min())>0){l.readTime=um(a,i.snapshotVersion.toTimestamp());const u=m_(a,i.expectedCount);u!==null&&(l.expectedCount=u)}return l}(this.serializer,e);const n=wW(this.serializer,e);n&&(r.labels=n),this.a_(r)}R_(e){const r={};r.database=g_(this.serializer),r.removeTarget=e,this.a_(r)}}class dH extends pR{constructor(e,r,n,s,a,i){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,s,i),this.serializer=a}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,r){return this.connection.Bo("Write",e,r)}E_(e){return ar(!!e.streamToken),this.lastStreamToken=e.streamToken,ar(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){ar(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const r=bW(e.writeResults,e.commitTime),n=ri(e.commitTime);return this.listener.g_(n,r)}p_(){const e={};e.database=g_(this.serializer),this.a_(e)}m_(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>Ev(this.serializer,n))};this.a_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fH extends class{}{constructor(e,r,n,s){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new Bt(dt.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,r,n,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,i])=>this.connection.Mo(e,p_(r,n),s,a,i)).catch(a=>{throw a.name==="FirebaseError"?(a.code===dt.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Bt(dt.UNKNOWN,a.toString())})}Lo(e,r,n,s,a){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,l])=>this.connection.Lo(e,p_(r,n),s,i,l,a)).catch(i=>{throw i.name==="FirebaseError"?(i.code===dt.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Bt(dt.UNKNOWN,i.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class hH{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(bs(r),this.D_=!1):kt("OnlineStateTracker",r)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mH{constructor(e,r,n,s,a){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=a,this.k_._o(i=>{n.enqueueAndForget(async()=>{xh(this)&&(kt("RemoteStore","Restarting streams for network reachability change."),await async function(c){const u=rr(c);u.L_.add(4),await kx(u),u.q_.set("Unknown"),u.L_.delete(4),await $2(u)}(this))})}),this.q_=new hH(n,s)}}async function $2(t){if(xh(t))for(const e of t.B_)await e(!0)}async function kx(t){for(const e of t.B_)await e(!1)}function z2(t,e){const r=rr(t);r.N_.has(e.targetId)||(r.N_.set(e.targetId,e),Y4(r)?K4(r):Pm(r).r_()&&G4(r,e))}function fm(t,e){const r=rr(t),n=Pm(r);r.N_.delete(e),n.r_()&&gR(r,e),r.N_.size===0&&(n.r_()?n.o_():xh(r)&&r.q_.set("Unknown"))}function G4(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ur.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}Pm(t).A_(e)}function gR(t,e){t.Q_.xe(e),Pm(t).R_(e)}function K4(t){t.Q_=new fW({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),Pm(t).start(),t.q_.v_()}function Y4(t){return xh(t)&&!Pm(t).n_()&&t.N_.size>0}function xh(t){return rr(t).L_.size===0}function xR(t){t.Q_=void 0}async function pH(t){t.q_.set("Online")}async function gH(t){t.N_.forEach((e,r)=>{G4(t,e)})}async function xH(t,e){xR(t),Y4(t)?(t.q_.M_(e),K4(t)):t.q_.set("Unknown")}async function yH(t,e,r){if(t.q_.set("Online"),e instanceof D8&&e.state===2&&e.cause)try{await async function(s,a){const i=a.cause;for(const l of a.targetIds)s.N_.has(l)&&(await s.remoteSyncer.rejectListen(l,i),s.N_.delete(l),s.Q_.removeTarget(l))}(t,e)}catch(n){kt("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),await Dv(t,n)}else if(e instanceof jy?t.Q_.Ke(e):e instanceof R8?t.Q_.He(e):t.Q_.We(e),!r.isEqual(ur.min()))try{const n=await lR(t.localStore);r.compareTo(n)>=0&&await function(a,i){const l=a.Q_.rt(i);return l.targetChanges.forEach((c,u)=>{if(c.resumeToken.approximateByteSize()>0){const d=a.N_.get(u);d&&a.N_.set(u,d.withResumeToken(c.resumeToken,i))}}),l.targetMismatches.forEach((c,u)=>{const d=a.N_.get(c);if(!d)return;a.N_.set(c,d.withResumeToken(Ss.EMPTY_BYTE_STRING,d.snapshotVersion)),gR(a,c);const f=new Nc(d.target,c,u,d.sequenceNumber);G4(a,f)}),a.remoteSyncer.applyRemoteEvent(l)}(t,r)}catch(n){kt("RemoteStore","Failed to raise snapshot:",n),await Dv(t,n)}}async function Dv(t,e,r){if(!Hd(e))throw e;t.L_.add(1),await kx(t),t.q_.set("Offline"),r||(r=()=>lR(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{kt("RemoteStore","Retrying IndexedDB access"),await r(),t.L_.delete(1),await $2(t)})}function yR(t,e){return e().catch(r=>Dv(t,r,e))}async function jm(t){const e=rr(t),r=Td(e);let n=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;vH(e);)try{const s=await aH(e.localStore,n);if(s===null){e.O_.length===0&&r.o_();break}n=s.batchId,bH(e,s)}catch(s){await Dv(e,s)}vR(e)&&bR(e)}function vH(t){return xh(t)&&t.O_.length<10}function bH(t,e){t.O_.push(e);const r=Td(t);r.r_()&&r.V_&&r.m_(e.mutations)}function vR(t){return xh(t)&&!Td(t).n_()&&t.O_.length>0}function bR(t){Td(t).start()}async function wH(t){Td(t).p_()}async function _H(t){const e=Td(t);for(const r of t.O_)e.m_(r.mutations)}async function NH(t,e,r){const n=t.O_.shift(),s=O4.from(n,e,r);await yR(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await jm(t)}async function SH(t,e){e&&Td(t).V_&&await async function(n,s){if(function(i){return cW(i)&&i!==dt.ABORTED}(s.code)){const a=n.O_.shift();Td(n).s_(),await yR(n,()=>n.remoteSyncer.rejectFailedWrite(a.batchId,s)),await jm(n)}}(t,e),vR(t)&&bR(t)}async function ME(t,e){const r=rr(t);r.asyncQueue.verifyOperationInProgress(),kt("RemoteStore","RemoteStore received new credentials");const n=xh(r);r.L_.add(3),await kx(r),n&&r.q_.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.L_.delete(3),await $2(r)}async function N_(t,e){const r=rr(t);e?(r.L_.delete(2),await $2(r)):e||(r.L_.add(2),await kx(r),r.q_.set("Unknown"))}function Pm(t){return t.K_||(t.K_=function(r,n,s){const a=rr(r);return a.w_(),new uH(n,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,s)}(t.datastore,t.asyncQueue,{Eo:pH.bind(null,t),Ro:gH.bind(null,t),mo:xH.bind(null,t),d_:yH.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),Y4(t)?K4(t):t.q_.set("Unknown")):(await t.K_.stop(),xR(t))})),t.K_}function Td(t){return t.U_||(t.U_=function(r,n,s){const a=rr(r);return a.w_(),new dH(n,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,s)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:wH.bind(null,t),mo:SH.bind(null,t),f_:_H.bind(null,t),g_:NH.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await jm(t)):(await t.U_.stop(),t.O_.length>0&&(kt("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X4{constructor(e,r,n,s,a){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=s,this.removalCallback=a,this.deferred=new Ul,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(i=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,s,a){const i=Date.now()+n,l=new X4(e,r,i,s,a);return l.start(n),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Bt(dt.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Q4(t,e){if(bs("AsyncQueue",`${e}: ${t}`),Hd(t))return new Bt(dt.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V0{constructor(e){this.comparator=e?(r,n)=>e(r,n)||Yt.comparator(r.key,n.key):(r,n)=>Yt.comparator(r.key,n.key),this.keyedMap=Tp(),this.sortedSet=new jn(this.comparator)}static emptySet(e){return new V0(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof V0)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const s=r.getNext().key,a=n.getNext().key;if(!s.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new V0;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VE{constructor(){this.W_=new jn(Yt.comparator)}track(e){const r=e.doc.key,n=this.W_.get(r);n?e.type!==0&&n.type===3?this.W_=this.W_.insert(r,e):e.type===3&&n.type!==1?this.W_=this.W_.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.W_=this.W_.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.W_=this.W_.remove(r):e.type===1&&n.type===2?this.W_=this.W_.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):tr():this.W_=this.W_.insert(r,e)}G_(){const e=[];return this.W_.inorderTraversal((r,n)=>{e.push(n)}),e}}class hm{constructor(e,r,n,s,a,i,l,c,u){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=s,this.mutatedKeys=a,this.fromCache=i,this.syncStateChanged=l,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(e,r,n,s,a){const i=[];return r.forEach(l=>{i.push({type:0,doc:l})}),new hm(e,r,V0.emptySet(r),i,n,s,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&F2(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let s=0;s<r.length;s++)if(r[s].type!==n[s].type||!r[s].doc.isEqual(n[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TH{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class AH{constructor(){this.queries=BE(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(r,n){const s=rr(r),a=s.queries;s.queries=BE(),a.forEach((i,l)=>{for(const c of l.j_)c.onError(n)})})(this,new Bt(dt.ABORTED,"Firestore shutting down"))}}function BE(){return new Gd(t=>x8(t),F2)}async function J4(t,e){const r=rr(t);let n=3;const s=e.query;let a=r.queries.get(s);a?!a.H_()&&e.J_()&&(n=2):(a=new TH,n=e.J_()?0:1);try{switch(n){case 0:a.z_=await r.onListen(s,!0);break;case 1:a.z_=await r.onListen(s,!1);break;case 2:await r.onFirstRemoteStoreListen(s)}}catch(i){const l=Q4(i,`Initialization of query '${o0(e.query)}' failed`);return void e.onError(l)}r.queries.set(s,a),a.j_.push(e),e.Z_(r.onlineState),a.z_&&e.X_(a.z_)&&eS(r)}async function Z4(t,e){const r=rr(t),n=e.query;let s=3;const a=r.queries.get(n);if(a){const i=a.j_.indexOf(e);i>=0&&(a.j_.splice(i,1),a.j_.length===0?s=e.J_()?0:1:!a.H_()&&e.J_()&&(s=2))}switch(s){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function EH(t,e){const r=rr(t);let n=!1;for(const s of e){const a=s.query,i=r.queries.get(a);if(i){for(const l of i.j_)l.X_(s)&&(n=!0);i.z_=s}}n&&eS(r)}function CH(t,e,r){const n=rr(t),s=n.queries.get(e);if(s)for(const a of s.j_)a.onError(r);n.queries.delete(e)}function eS(t){t.Y_.forEach(e=>{e.next()})}var S_,UE;(UE=S_||(S_={})).ea="default",UE.Cache="cache";class tS{constructor(e,r,n){this.query=e,this.ta=r,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=n||{}}X_(e){if(!this.options.includeMetadataChanges){const n=[];for(const s of e.docChanges)s.type!==3&&n.push(s);e=new hm(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.na?this.ia(e)&&(this.ta.next(e),r=!0):this.sa(e,this.onlineState)&&(this.oa(e),r=!0),this.ra=e,r}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let r=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),r=!0),r}sa(e,r){if(!e.fromCache||!this.J_())return!0;const n=r!=="Offline";return(!this.options._a||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const r=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}oa(e){e=hm.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==S_.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wR{constructor(e){this.key=e}}class _R{constructor(e){this.key=e}}class kH{constructor(e,r){this.query=e,this.Ta=r,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Fr(),this.mutatedKeys=Fr(),this.Aa=v8(e),this.Ra=new V0(this.Aa)}get Va(){return this.Ta}ma(e,r){const n=r?r.fa:new VE,s=r?r.Ra:this.Ra;let a=r?r.mutatedKeys:this.mutatedKeys,i=s,l=!1;const c=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,u=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((d,f)=>{const m=s.get(d),h=Tx(this.query,f)?f:null,g=!!m&&this.mutatedKeys.has(m.key),p=!!h&&(h.hasLocalMutations||this.mutatedKeys.has(h.key)&&h.hasCommittedMutations);let v=!1;m&&h?m.data.isEqual(h.data)?g!==p&&(n.track({type:3,doc:h}),v=!0):this.ga(m,h)||(n.track({type:2,doc:h}),v=!0,(c&&this.Aa(h,c)>0||u&&this.Aa(h,u)<0)&&(l=!0)):!m&&h?(n.track({type:0,doc:h}),v=!0):m&&!h&&(n.track({type:1,doc:m}),v=!0,(c||u)&&(l=!0)),v&&(h?(i=i.add(h),a=p?a.add(d):a.delete(d)):(i=i.delete(d),a=a.delete(d)))}),this.query.limit!==null)for(;i.size>this.query.limit;){const d=this.query.limitType==="F"?i.last():i.first();i=i.delete(d.key),a=a.delete(d.key),n.track({type:1,doc:d})}return{Ra:i,fa:n,ns:l,mutatedKeys:a}}ga(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,s){const a=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const i=e.fa.G_();i.sort((d,f)=>function(h,g){const p=v=>{switch(v){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return tr()}};return p(h)-p(g)}(d.type,f.type)||this.Aa(d.doc,f.doc)),this.pa(n),s=s!=null&&s;const l=r&&!s?this.ya():[],c=this.da.size===0&&this.current&&!s?1:0,u=c!==this.Ea;return this.Ea=c,i.length!==0||u?{snapshot:new hm(this.query,e.Ra,a,i,e.mutatedKeys,c===0,u,!1,!!n&&n.resumeToken.approximateByteSize()>0),wa:l}:{wa:l}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new VE,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(r=>this.Ta=this.Ta.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ta=this.Ta.delete(r)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=Fr(),this.Ra.forEach(n=>{this.Sa(n.key)&&(this.da=this.da.add(n.key))});const r=[];return e.forEach(n=>{this.da.has(n)||r.push(new _R(n))}),this.da.forEach(n=>{e.has(n)||r.push(new wR(n))}),r}ba(e){this.Ta=e.Ts,this.da=Fr();const r=this.ma(e.documents);return this.applyChanges(r,!0)}Da(){return hm.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class IH{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class jH{constructor(e){this.key=e,this.va=!1}}class PH{constructor(e,r,n,s,a,i){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=s,this.currentUser=a,this.maxConcurrentLimboResolutions=i,this.Ca={},this.Fa=new Gd(l=>x8(l),F2),this.Ma=new Map,this.xa=new Set,this.Oa=new jn(Yt.comparator),this.Na=new Map,this.La=new z4,this.Ba={},this.ka=new Map,this.qa=nh.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function RH(t,e,r=!0){const n=q2(t);let s;const a=n.Fa.get(e);return a?(n.sharedClientState.addLocalQueryTarget(a.targetId),s=a.view.Da()):s=await NR(n,e,r,!0),s}async function DH(t,e){const r=q2(t);await NR(r,e,!0,!1)}async function NR(t,e,r,n){const s=await jv(t.localStore,Ji(e)),a=s.targetId,i=t.sharedClientState.addLocalQueryTarget(a,r);let l;return n&&(l=await rS(t,e,a,i==="current",s.resumeToken)),t.isPrimaryClient&&r&&z2(t.remoteStore,s),l}async function rS(t,e,r,n,s){t.Ka=(f,m,h)=>async function(p,v,b,w){let N=v.view.ma(b);N.ns&&(N=await w_(p.localStore,v.query,!1).then(({documents:A})=>v.view.ma(A,N)));const j=w&&w.targetChanges.get(v.targetId),F=w&&w.targetMismatches.get(v.targetId)!=null,U=v.view.applyChanges(N,p.isPrimaryClient,j,F);return T_(p,v.targetId,U.wa),U.snapshot}(t,f,m,h);const a=await w_(t.localStore,e,!0),i=new kH(e,a.Ts),l=i.ma(a.documents),c=Cx.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",s),u=i.applyChanges(l,t.isPrimaryClient,c);T_(t,r,u.wa);const d=new IH(e,r,i);return t.Fa.set(e,d),t.Ma.has(r)?t.Ma.get(r).push(e):t.Ma.set(r,[e]),u.snapshot}async function FH(t,e,r){const n=rr(t),s=n.Fa.get(e),a=n.Ma.get(s.targetId);if(a.length>1)return n.Ma.set(s.targetId,a.filter(i=>!F2(i,e))),void n.Fa.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(s.targetId),n.sharedClientState.isActiveQueryTarget(s.targetId)||await dm(n.localStore,s.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(s.targetId),r&&fm(n.remoteStore,s.targetId),mm(n,s.targetId)}).catch(Wd)):(mm(n,s.targetId),await dm(n.localStore,s.targetId,!0))}async function LH(t,e){const r=rr(t),n=r.Fa.get(e),s=r.Ma.get(n.targetId);r.isPrimaryClient&&s.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),fm(r.remoteStore,n.targetId))}async function OH(t,e,r){const n=iS(t);try{const s=await function(i,l){const c=rr(i),u=ft.now(),d=l.reduce((h,g)=>h.add(g.key),Fr());let f,m;return c.persistence.runTransaction("Locally write mutations","readwrite",h=>{let g=Gi(),p=Fr();return c.cs.getEntries(h,d).next(v=>{g=v,g.forEach((b,w)=>{w.isValidDocument()||(p=p.add(b))})}).next(()=>c.localDocuments.getOverlayedDocuments(h,g)).next(v=>{f=v;const b=[];for(const w of l){const N=oW(w,f.get(w.key).overlayedDocument);N!=null&&b.push(new Kc(w.key,N,o8(N.value.mapValue),qs.exists(!0)))}return c.mutationQueue.addMutationBatch(h,u,b,l)}).next(v=>{m=v;const b=v.applyToLocalDocumentSet(f,p);return c.documentOverlayCache.saveOverlays(h,v.batchId,b)})}).then(()=>({batchId:m.batchId,changes:w8(f)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(s.batchId),function(i,l,c){let u=i.Ba[i.currentUser.toKey()];u||(u=new jn(kr)),u=u.insert(l,c),i.Ba[i.currentUser.toKey()]=u}(n,s.batchId,r),await Kd(n,s.changes),await jm(n.remoteStore)}catch(s){const a=Q4(s,"Failed to persist write");r.reject(a)}}async function SR(t,e){const r=rr(t);try{const n=await nH(r.localStore,e);e.targetChanges.forEach((s,a)=>{const i=r.Na.get(a);i&&(ar(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?i.va=!0:s.modifiedDocuments.size>0?ar(i.va):s.removedDocuments.size>0&&(ar(i.va),i.va=!1))}),await Kd(r,n,e)}catch(n){await Wd(n)}}function $E(t,e,r){const n=rr(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const s=[];n.Fa.forEach((a,i)=>{const l=i.view.Z_(e);l.snapshot&&s.push(l.snapshot)}),function(i,l){const c=rr(i);c.onlineState=l;let u=!1;c.queries.forEach((d,f)=>{for(const m of f.j_)m.Z_(l)&&(u=!0)}),u&&eS(c)}(n.eventManager,e),s.length&&n.Ca.d_(s),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function MH(t,e,r){const n=rr(t);n.sharedClientState.updateQueryState(e,"rejected",r);const s=n.Na.get(e),a=s&&s.key;if(a){let i=new jn(Yt.comparator);i=i.insert(a,ls.newNoDocument(a,ur.min()));const l=Fr().add(a),c=new Ex(ur.min(),new Map,new jn(kr),i,l);await SR(n,c),n.Oa=n.Oa.remove(a),n.Na.delete(e),aS(n)}else await dm(n.localStore,e,!1).then(()=>mm(n,e,r)).catch(Wd)}async function VH(t,e){const r=rr(t),n=e.batch.batchId;try{const s=await rH(r.localStore,e);sS(r,n,null),nS(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await Kd(r,s)}catch(s){await Wd(s)}}async function BH(t,e,r){const n=rr(t);try{const s=await function(i,l){const c=rr(i);return c.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let d;return c.mutationQueue.lookupMutationBatch(u,l).next(f=>(ar(f!==null),d=f.keys(),c.mutationQueue.removeMutationBatch(u,f))).next(()=>c.mutationQueue.performConsistencyCheck(u)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(u,d,l)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,d)).next(()=>c.localDocuments.getDocuments(u,d))})}(n.localStore,e);sS(n,e,r),nS(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await Kd(n,s)}catch(s){await Wd(s)}}function nS(t,e){(t.ka.get(e)||[]).forEach(r=>{r.resolve()}),t.ka.delete(e)}function sS(t,e,r){const n=rr(t);let s=n.Ba[n.currentUser.toKey()];if(s){const a=s.get(e);a&&(r?a.reject(r):a.resolve(),s=s.remove(e)),n.Ba[n.currentUser.toKey()]=s}}function mm(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Ma.get(e))t.Fa.delete(n),r&&t.Ca.$a(n,r);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(n=>{t.La.containsKey(n)||TR(t,n)})}function TR(t,e){t.xa.delete(e.path.canonicalString());const r=t.Oa.get(e);r!==null&&(fm(t.remoteStore,r),t.Oa=t.Oa.remove(e),t.Na.delete(r),aS(t))}function T_(t,e,r){for(const n of r)n instanceof wR?(t.La.addReference(n.key,e),UH(t,n)):n instanceof _R?(kt("SyncEngine","Document no longer in limbo: "+n.key),t.La.removeReference(n.key,e),t.La.containsKey(n.key)||TR(t,n.key)):tr()}function UH(t,e){const r=e.key,n=r.path.canonicalString();t.Oa.get(r)||t.xa.has(n)||(kt("SyncEngine","New document in limbo: "+r),t.xa.add(n),aS(t))}function aS(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const r=new Yt(cn.fromString(e)),n=t.qa.next();t.Na.set(n,new jH(r)),t.Oa=t.Oa.insert(r,n),z2(t.remoteStore,new Nc(Ji(Sx(r.path)),n,"TargetPurposeLimboResolution",bi.oe))}}async function Kd(t,e,r){const n=rr(t),s=[],a=[],i=[];n.Fa.isEmpty()||(n.Fa.forEach((l,c)=>{i.push(n.Ka(c,e,r).then(u=>{var d;if((u||r)&&n.isPrimaryClient){const f=u?!u.fromCache:(d=r==null?void 0:r.targetChanges.get(c.targetId))===null||d===void 0?void 0:d.current;n.sharedClientState.updateQueryState(c.targetId,f?"current":"not-current")}if(u){s.push(u);const f=W4.Wi(c.targetId,u);a.push(f)}}))}),await Promise.all(i),n.Ca.d_(s),await async function(c,u){const d=rr(c);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>Je.forEach(u,m=>Je.forEach(m.$i,h=>d.persistence.referenceDelegate.addReference(f,m.targetId,h)).next(()=>Je.forEach(m.Ui,h=>d.persistence.referenceDelegate.removeReference(f,m.targetId,h)))))}catch(f){if(!Hd(f))throw f;kt("LocalStore","Failed to update sequence numbers: "+f)}for(const f of u){const m=f.targetId;if(!f.fromCache){const h=d.os.get(m),g=h.snapshotVersion,p=h.withLastLimboFreeSnapshotVersion(g);d.os=d.os.insert(m,p)}}}(n.localStore,a))}async function $H(t,e){const r=rr(t);if(!r.currentUser.isEqual(e)){kt("SyncEngine","User change. New user:",e.toKey());const n=await oR(r.localStore,e);r.currentUser=e,function(a,i){a.ka.forEach(l=>{l.forEach(c=>{c.reject(new Bt(dt.CANCELLED,i))})}),a.ka.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await Kd(r,n.hs)}}function zH(t,e){const r=rr(t),n=r.Na.get(e);if(n&&n.va)return Fr().add(n.key);{let s=Fr();const a=r.Ma.get(e);if(!a)return s;for(const i of a){const l=r.Fa.get(i);s=s.unionWith(l.view.Va)}return s}}async function qH(t,e){const r=rr(t),n=await w_(r.localStore,e.query,!0),s=e.view.ba(n);return r.isPrimaryClient&&T_(r,e.targetId,s.wa),s}async function WH(t,e){const r=rr(t);return uR(r.localStore,e).then(n=>Kd(r,n))}async function HH(t,e,r,n){const s=rr(t),a=await function(l,c){const u=rr(l),d=rr(u.mutationQueue);return u.persistence.runTransaction("Lookup mutation documents","readonly",f=>d.Mn(f,c).next(m=>m?u.localDocuments.getDocuments(f,m):Je.resolve(null)))}(s.localStore,e);a!==null?(r==="pending"?await jm(s.remoteStore):r==="acknowledged"||r==="rejected"?(sS(s,e,n||null),nS(s,e),function(l,c){rr(rr(l).mutationQueue).On(c)}(s.localStore,e)):tr(),await Kd(s,a)):kt("SyncEngine","Cannot apply mutation batch with id: "+e)}async function GH(t,e){const r=rr(t);if(q2(r),iS(r),e===!0&&r.Qa!==!0){const n=r.sharedClientState.getAllActiveQueryTargets(),s=await zE(r,n.toArray());r.Qa=!0,await N_(r.remoteStore,!0);for(const a of s)z2(r.remoteStore,a)}else if(e===!1&&r.Qa!==!1){const n=[];let s=Promise.resolve();r.Ma.forEach((a,i)=>{r.sharedClientState.isLocalQueryTarget(i)?n.push(i):s=s.then(()=>(mm(r,i),dm(r.localStore,i,!0))),fm(r.remoteStore,i)}),await s,await zE(r,n),function(i){const l=rr(i);l.Na.forEach((c,u)=>{fm(l.remoteStore,u)}),l.La.pr(),l.Na=new Map,l.Oa=new jn(Yt.comparator)}(r),r.Qa=!1,await N_(r.remoteStore,!1)}}async function zE(t,e,r){const n=rr(t),s=[],a=[];for(const i of e){let l;const c=n.Ma.get(i);if(c&&c.length!==0){l=await jv(n.localStore,Ji(c[0]));for(const u of c){const d=n.Fa.get(u),f=await qH(n,d);f.snapshot&&a.push(f.snapshot)}}else{const u=await cR(n.localStore,i);l=await jv(n.localStore,u),await rS(n,AR(u),i,!1,l.resumeToken)}s.push(l)}return n.Ca.d_(a),s}function AR(t){return p8(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function KH(t){return function(r){return rr(rr(r).persistence).Qi()}(rr(t).localStore)}async function YH(t,e,r,n){const s=rr(t);if(s.Qa)return void kt("SyncEngine","Ignoring unexpected query state notification.");const a=s.Ma.get(e);if(a&&a.length>0)switch(r){case"current":case"not-current":{const i=await uR(s.localStore,y8(a[0])),l=Ex.createSynthesizedRemoteEventForCurrentChange(e,r==="current",Ss.EMPTY_BYTE_STRING);await Kd(s,i,l);break}case"rejected":await dm(s.localStore,e,!0),mm(s,e,n);break;default:tr()}}async function XH(t,e,r){const n=q2(t);if(n.Qa){for(const s of e){if(n.Ma.has(s)&&n.sharedClientState.isActiveQueryTarget(s)){kt("SyncEngine","Adding an already active target "+s);continue}const a=await cR(n.localStore,s),i=await jv(n.localStore,a);await rS(n,AR(a),i.targetId,!1,i.resumeToken),z2(n.remoteStore,i)}for(const s of r)n.Ma.has(s)&&await dm(n.localStore,s,!1).then(()=>{fm(n.remoteStore,s),mm(n,s)}).catch(Wd)}}function q2(t){const e=rr(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=SR.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=zH.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=MH.bind(null,e),e.Ca.d_=EH.bind(null,e.eventManager),e.Ca.$a=CH.bind(null,e.eventManager),e}function iS(t){const e=rr(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=VH.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=BH.bind(null,e),e}class Bg{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=U2(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,r){return null}Ha(e,r){return null}za(e){return iR(this.persistence,new aR,e.initialUser,this.serializer)}Ga(e){return new nR(B2.Zr,this.serializer)}Wa(e){return new fR}async terminate(){var e,r;(e=this.gcScheduler)===null||e===void 0||e.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Bg.provider={build:()=>new Bg};class QH extends Bg{constructor(e,r,n){super(),this.Ja=e,this.cacheSizeBytes=r,this.forceOwnership=n,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Ja.initialize(this,e),await iS(this.Ja.syncEngine),await jm(this.Ja.remoteStore),await this.persistence.yi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}za(e){return iR(this.persistence,new aR,e.initialUser,this.serializer)}ja(e,r){const n=this.persistence.referenceDelegate.garbageCollector;return new MW(n,e.asyncQueue,r)}Ha(e,r){const n=new yq(r,this.persistence);return new xq(e.asyncQueue,n)}Ga(e){const r=sR(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=this.cacheSizeBytes!==void 0?xi.withCacheSize(this.cacheSizeBytes):xi.DEFAULT;return new q4(this.synchronizeTabs,r,e.clientId,n,e.asyncQueue,hR(),Py(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Wa(e){return new fR}}class JH extends QH{constructor(e,r){super(e,r,!1),this.Ja=e,this.cacheSizeBytes=r,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const r=this.Ja.syncEngine;this.sharedClientState instanceof pw&&(this.sharedClientState.syncEngine={no:HH.bind(null,r),ro:YH.bind(null,r),io:XH.bind(null,r),Qi:KH.bind(null,r),eo:WH.bind(null,r)},await this.sharedClientState.start()),await this.persistence.yi(async n=>{await GH(this.Ja.syncEngine,n),this.gcScheduler&&(n&&!this.gcScheduler.started?this.gcScheduler.start():n||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(n&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():n||this.indexBackfillerScheduler.stop())})}Wa(e){const r=hR();if(!pw.D(r))throw new Bt(dt.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const n=sR(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new pw(r,e.asyncQueue,n,e.clientId,e.initialUser)}}class Fv{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>$E(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=$H.bind(null,this.syncEngine),await N_(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new AH}()}createDatastore(e){const r=U2(e.databaseInfo.databaseId),n=function(a){return new cH(a)}(e.databaseInfo);return function(a,i,l,c){return new fH(a,i,l,c)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,s,a,i,l){return new mH(n,s,a,i,l)}(this.localStore,this.datastore,e.asyncQueue,r=>$E(this.syncEngine,r,0),function(){return OE.D()?new OE:new iH}())}createSyncEngine(e,r){return function(s,a,i,l,c,u,d){const f=new PH(s,a,i,l,c,u);return d&&(f.Qa=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await async function(s){const a=rr(s);kt("RemoteStore","RemoteStore shutting down."),a.L_.add(5),await kx(a),a.k_.shutdown(),a.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}Fv.provider={build:()=>new Fv};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oS{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):bs("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZH{constructor(e,r,n,s,a){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=s,this.user=ea.UNAUTHENTICATED,this.clientId=WP.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(n,async i=>{kt("FirestoreClient","Received user=",i.uid),await this.authCredentialListener(i),this.user=i}),this.appCheckCredentials.start(n,i=>(kt("FirestoreClient","Received new app check token=",i),this.appCheckCredentialListener(i,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ul;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=Q4(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function xw(t,e){t.asyncQueue.verifyOperationInProgress(),kt("FirestoreClient","Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async s=>{n.isEqual(s)||(await oR(e.localStore,s),n=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function qE(t,e){t.asyncQueue.verifyOperationInProgress();const r=await eG(t);kt("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>ME(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,s)=>ME(e.remoteStore,s)),t._onlineComponents=e}async function eG(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){kt("FirestoreClient","Using user provided OfflineComponentProvider");try{await xw(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(s){return s.name==="FirebaseError"?s.code===dt.FAILED_PRECONDITION||s.code===dt.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(r))throw r;Qf("Error using user provided cache. Falling back to memory cache: "+r),await xw(t,new Bg)}}else kt("FirestoreClient","Using default OfflineComponentProvider"),await xw(t,new Bg);return t._offlineComponents}async function ER(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(kt("FirestoreClient","Using user provided OnlineComponentProvider"),await qE(t,t._uninitializedComponentsProvider._online)):(kt("FirestoreClient","Using default OnlineComponentProvider"),await qE(t,new Fv))),t._onlineComponents}function tG(t){return ER(t).then(e=>e.syncEngine)}async function Lv(t){const e=await ER(t),r=e.eventManager;return r.onListen=RH.bind(null,e.syncEngine),r.onUnlisten=FH.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=DH.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=LH.bind(null,e.syncEngine),r}function rG(t,e,r={}){const n=new Ul;return t.asyncQueue.enqueueAndForget(async()=>function(a,i,l,c,u){const d=new oS({next:m=>{d.Za(),i.enqueueAndForget(()=>Z4(a,f));const h=m.docs.has(l);!h&&m.fromCache?u.reject(new Bt(dt.UNAVAILABLE,"Failed to get document because the client is offline.")):h&&m.fromCache&&c&&c.source==="server"?u.reject(new Bt(dt.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(m)},error:m=>u.reject(m)}),f=new tS(Sx(l.path),d,{includeMetadataChanges:!0,_a:!0});return J4(a,f)}(await Lv(t),t.asyncQueue,e,r,n)),n.promise}function nG(t,e,r={}){const n=new Ul;return t.asyncQueue.enqueueAndForget(async()=>function(a,i,l,c,u){const d=new oS({next:m=>{d.Za(),i.enqueueAndForget(()=>Z4(a,f)),m.fromCache&&c.source==="server"?u.reject(new Bt(dt.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(m)},error:m=>u.reject(m)}),f=new tS(l,d,{includeMetadataChanges:!0,_a:!0});return J4(a,f)}(await Lv(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CR(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WE=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kR(t,e,r){if(!r)throw new Bt(dt.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function sG(t,e,r,n){if(e===!0&&n===!0)throw new Bt(dt.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function HE(t){if(!Yt.isDocumentKey(t))throw new Bt(dt.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function GE(t){if(Yt.isDocumentKey(t))throw new Bt(dt.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function W2(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":tr()}function Ma(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Bt(dt.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=W2(t);throw new Bt(dt.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}function aG(t,e){if(e<=0)throw new Bt(dt.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KE{constructor(e){var r,n;if(e.host===void 0){if(e.ssl!==void 0)throw new Bt(dt.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(r=e.ssl)===null||r===void 0||r;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new Bt(dt.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}sG("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=CR((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(a){if(a.timeoutSeconds!==void 0){if(isNaN(a.timeoutSeconds))throw new Bt(dt.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (must not be NaN)`);if(a.timeoutSeconds<5)throw new Bt(dt.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (minimum allowed value is 5)`);if(a.timeoutSeconds>30)throw new Bt(dt.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,s){return n.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class H2{constructor(e,r,n,s){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new KE({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Bt(dt.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Bt(dt.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new KE(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new iq;switch(n.type){case"firstParty":return new uq(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Bt(dt.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=WE.get(r);n&&(kt("ComponentProvider","Removing Datastore"),WE.delete(r),n.terminate())}(this),Promise.resolve()}}function iG(t,e,r,n={}){var s;const a=(t=Ma(t,H2))._getSettings(),i=`${e}:${r}`;if(a.host!=="firestore.googleapis.com"&&a.host!==i&&Qf("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},a),{host:i,ssl:!1})),n.mockUserToken){let l,c;if(typeof n.mockUserToken=="string")l=n.mockUserToken,c=ea.MOCK_USER;else{l=EB(n.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const u=n.mockUserToken.sub||n.mockUserToken.user_id;if(!u)throw new Bt(dt.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new ea(u)}t._authCredentials=new oq(new qP(l,c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yc{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Yc(this.firestore,e,this._query)}}class Va{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new pd(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Va(this.firestore,e,this._key)}}class pd extends Yc{constructor(e,r,n){super(e,r,Sx(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Va(this.firestore,null,new Yt(e))}withConverter(e){return new pd(this.firestore,e,this._path)}}function hr(t,e,...r){if(t=ds(t),kR("collection","path",e),t instanceof H2){const n=cn.fromString(e,...r);return GE(n),new pd(t,null,n)}{if(!(t instanceof Va||t instanceof pd))throw new Bt(dt.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(cn.fromString(e,...r));return GE(n),new pd(t.firestore,null,n)}}function Rt(t,e,...r){if(t=ds(t),arguments.length===1&&(e=WP.newId()),kR("doc","path",e),t instanceof H2){const n=cn.fromString(e,...r);return HE(n),new Va(t,null,new Yt(n))}{if(!(t instanceof Va||t instanceof pd))throw new Bt(dt.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(cn.fromString(e,...r));return HE(n),new Va(t.firestore,t instanceof pd?t.converter:null,new Yt(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YE{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new mR(this,"async_queue_retry"),this.Vu=()=>{const n=Py();n&&kt("AsyncQueue","Visibility state changed to "+n.visibilityState),this.t_.jo()},this.mu=e;const r=Py();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const r=Py();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const r=new Ul;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Hd(e))throw e;kt("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const r=this.mu.then(()=>(this.du=!0,e().catch(n=>{this.Eu=n,this.du=!1;const s=function(i){let l=i.message||"";return i.stack&&(l=i.stack.includes(i.message)?i.stack:i.message+`
`+i.stack),l}(n);throw bs("INTERNAL UNHANDLED ERROR: ",s),n}).then(n=>(this.du=!1,n))));return this.mu=r,r}enqueueAfterDelay(e,r,n){this.fu(),this.Ru.indexOf(e)>-1&&(r=0);const s=X4.createAndSchedule(this,e,r,n,a=>this.yu(a));return this.Tu.push(s),s}fu(){this.Eu&&tr()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const r of this.Tu)if(r.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.Tu)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const r=this.Tu.indexOf(e);this.Tu.splice(r,1)}}function XE(t){return function(r,n){if(typeof r!="object"||r===null)return!1;const s=r;for(const a of n)if(a in s&&typeof s[a]=="function")return!0;return!1}(t,["next","error","complete"])}class ll extends H2{constructor(e,r,n,s){super(e,r,n,s),this.type="firestore",this._queue=new YE,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new YE(e),this._firestoreClient=void 0,await e}}}function oG(t,e){const r=typeof t=="object"?t:g4(),n=typeof t=="string"?t:"(default)",s=C2(r,"firestore").getImmediate({identifier:n});if(!s._initialized){const a=Gj("firestore");a&&iG(s,...a)}return s}function Ix(t){if(t._terminated)throw new Bt(dt.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||IR(t),t._firestoreClient}function IR(t){var e,r,n;const s=t._freezeSettings(),a=function(l,c,u,d){return new Vq(l,c,u,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,CR(d.experimentalLongPollingOptions),d.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._componentsProvider||!((r=s.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((n=s.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(t._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),t._firestoreClient=new ZH(t._authCredentials,t._appCheckCredentials,t._queue,a,t._componentsProvider&&function(l){const c=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(c),_online:c}}(t._componentsProvider))}async function lG(t){Qf("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const e=t._freezeSettings();cG(t,Fv.provider,{build:r=>new JH(r,e.cacheSizeBytes)})}function cG(t,e,r){if((t=Ma(t,ll))._firestoreClient||t._terminated)throw new Bt(dt.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(t._componentsProvider||t._getSettings().localCache)throw new Bt(dt.FAILED_PRECONDITION,"SDK cache is already specified.");t._componentsProvider={_online:e,_offline:r},IR(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pm{constructor(e){this._byteString=e}static fromBase64String(e){try{return new pm(Ss.fromBase64String(e))}catch(r){throw new Bt(dt.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new pm(Ss.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jx{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new Bt(dt.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Yn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Px{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lS{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new Bt(dt.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new Bt(dt.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return kr(this._lat,e._lat)||kr(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cS{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,s){if(n.length!==s.length)return!1;for(let a=0;a<n.length;++a)if(n[a]!==s[a])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uG=/^__.*__$/;class dG{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new Kc(e,this.data,this.fieldMask,r,this.fieldTransforms):new Im(e,this.data,r,this.fieldTransforms)}}class jR{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new Kc(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function PR(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw tr()}}class uS{constructor(e,r,n,s,a,i){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=s,a===void 0&&this.vu(),this.fieldTransforms=a||[],this.fieldMask=i||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new uS(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),s=this.Fu({path:n,xu:!1});return s.Ou(e),s}Nu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),s=this.Fu({path:n,xu:!1});return s.vu(),s}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Ov(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(PR(this.Cu)&&uG.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class fG{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||U2(e)}Qu(e,r,n,s=!1){return new uS({Cu:e,methodName:r,qu:n,path:Yn.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Rx(t){const e=t._freezeSettings(),r=U2(t._databaseId);return new fG(t._databaseId,!!e.ignoreUndefinedProperties,r)}function dS(t,e,r,n,s,a={}){const i=t.Qu(a.merge||a.mergeFields?2:0,e,r,s);mS("Data must be an object, but it was:",i,n);const l=FR(n,i);let c,u;if(a.merge)c=new wi(i.fieldMask),u=i.fieldTransforms;else if(a.mergeFields){const d=[];for(const f of a.mergeFields){const m=A_(e,f,r);if(!i.contains(m))throw new Bt(dt.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);OR(d,m)||d.push(m)}c=new wi(d),u=i.fieldTransforms.filter(f=>c.covers(f.field))}else c=null,u=i.fieldTransforms;return new dG(new Da(l),c,u)}class G2 extends Px{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof G2}}class fS extends Px{_toFieldTransform(e){return new F4(e.path,new im)}isEqual(e){return e instanceof fS}}class hS extends Px{constructor(e,r){super(e),this.$u=r}_toFieldTransform(e){const r=new cm(e.serializer,S8(e.serializer,this.$u));return new F4(e.path,r)}isEqual(e){return e instanceof hS&&this.$u===e.$u}}function RR(t,e,r,n){const s=t.Qu(1,e,r);mS("Data must be an object, but it was:",s,n);const a=[],i=Da.empty();gh(n,(c,u)=>{const d=pS(e,c,r);u=ds(u);const f=s.Nu(d);if(u instanceof G2)a.push(d);else{const m=Dx(u,f);m!=null&&(a.push(d),i.set(d,m))}});const l=new wi(a);return new jR(i,l,s.fieldTransforms)}function DR(t,e,r,n,s,a){const i=t.Qu(1,e,r),l=[A_(e,n,r)],c=[s];if(a.length%2!=0)throw new Bt(dt.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<a.length;m+=2)l.push(A_(e,a[m])),c.push(a[m+1]);const u=[],d=Da.empty();for(let m=l.length-1;m>=0;--m)if(!OR(u,l[m])){const h=l[m];let g=c[m];g=ds(g);const p=i.Nu(h);if(g instanceof G2)u.push(h);else{const v=Dx(g,p);v!=null&&(u.push(h),d.set(h,v))}}const f=new wi(u);return new jR(d,f,i.fieldTransforms)}function hG(t,e,r,n=!1){return Dx(r,t.Qu(n?4:3,e))}function Dx(t,e){if(LR(t=ds(t)))return mS("Unsupported field value:",e,t),FR(t,e);if(t instanceof Px)return function(n,s){if(!PR(s.Cu))throw s.Bu(`${n._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${n._methodName}() is not currently supported inside arrays`);const a=n._toFieldTransform(s);a&&s.fieldTransforms.push(a)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(n,s){const a=[];let i=0;for(const l of n){let c=Dx(l,s.Lu(i));c==null&&(c={nullValue:"NULL_VALUE"}),a.push(c),i++}return{arrayValue:{values:a}}}(t,e)}return function(n,s){if((n=ds(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return S8(s.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const a=ft.fromDate(n);return{timestampValue:um(s.serializer,a)}}if(n instanceof ft){const a=new ft(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:um(s.serializer,a)}}if(n instanceof lS)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof pm)return{bytesValue:F8(s.serializer,n._byteString)};if(n instanceof Va){const a=s.databaseId,i=n.firestore._databaseId;if(!i.isEqual(a))throw s.Bu(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:B4(n.firestore._databaseId||s.databaseId,n._key.path)}}if(n instanceof cS)return function(i,l){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:i.toArray().map(c=>{if(typeof c!="number")throw l.Bu("VectorValues must only contain numeric values.");return D4(l.serializer,c)})}}}}}}(n,s);throw s.Bu(`Unsupported field value: ${W2(n)}`)}(t,e)}function FR(t,e){const r={};return n8(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):gh(t,(n,s)=>{const a=Dx(s,e.Mu(n));a!=null&&(r[n]=a)}),{mapValue:{fields:r}}}function LR(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof ft||t instanceof lS||t instanceof pm||t instanceof Va||t instanceof Px||t instanceof cS)}function mS(t,e,r){if(!LR(r)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(r)){const n=W2(r);throw n==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+n)}}function A_(t,e,r){if((e=ds(e))instanceof jx)return e._internalPath;if(typeof e=="string")return pS(t,e);throw Ov("Field path arguments must be of type string or ",t,!1,void 0,r)}const mG=new RegExp("[~\\*/\\[\\]]");function pS(t,e,r){if(e.search(mG)>=0)throw Ov(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new jx(...e.split("."))._internalPath}catch{throw Ov(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function Ov(t,e,r,n,s){const a=n&&!n.isEmpty(),i=s!==void 0;let l=`Function ${e}() called with invalid data`;r&&(l+=" (via `toFirestore()`)"),l+=". ";let c="";return(a||i)&&(c+=" (found",a&&(c+=` in field ${n}`),i&&(c+=` in document ${s}`),c+=")"),new Bt(dt.INVALID_ARGUMENT,l+t+c)}function OR(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MR{constructor(e,r,n,s,a){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=s,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new Va(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new pG(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(K2("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class pG extends MR{data(){return super.data()}}function K2(t,e){return typeof e=="string"?pS(t,e):e instanceof jx?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VR(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Bt(dt.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class gS{}class xS extends gS{}function br(t,e,...r){let n=[];e instanceof gS&&n.push(e),n=n.concat(r),function(a){const i=a.filter(c=>c instanceof yS).length,l=a.filter(c=>c instanceof Y2).length;if(i>1||i>0&&l>0)throw new Bt(dt.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const s of n)t=s._apply(t);return t}class Y2 extends xS{constructor(e,r,n){super(),this._field=e,this._op=r,this._value=n,this.type="where"}static _create(e,r,n){return new Y2(e,r,n)}_apply(e){const r=this._parse(e);return BR(e._query,r),new Yc(e.firestore,e.converter,h_(e._query,r))}_parse(e){const r=Rx(e.firestore);return function(a,i,l,c,u,d,f){let m;if(u.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new Bt(dt.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){JE(f,d);const h=[];for(const g of f)h.push(QE(c,a,g));m={arrayValue:{values:h}}}else m=QE(c,a,f)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||JE(f,d),m=hG(l,i,f,d==="in"||d==="not-in");return zr.create(u,d,m)}(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}function Nr(t,e,r){const n=e,s=K2("where",t);return Y2._create(s,n,r)}class yS extends gS{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new yS(e,r)}_parse(e){const r=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return r.length===1?r[0]:gn.create(r,this._getOperator())}_apply(e){const r=this._parse(e);return r.getFilters().length===0?e:(function(s,a){let i=s;const l=a.getFlattenedFilters();for(const c of l)BR(i,c),i=h_(i,c)}(e._query,r),new Yc(e.firestore,e.converter,h_(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class vS extends xS{constructor(e,r){super(),this._field=e,this._direction=r,this.type="orderBy"}static _create(e,r){return new vS(e,r)}_apply(e){const r=function(s,a,i){if(s.startAt!==null)throw new Bt(dt.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new Bt(dt.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Vg(a,i)}(e._query,this._field,this._direction);return new Yc(e.firestore,e.converter,function(s,a){const i=s.explicitOrderBy.concat([a]);return new km(s.path,s.collectionGroup,i,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,r))}}function Oa(t,e="asc"){const r=e,n=K2("orderBy",t);return vS._create(n,r)}class bS extends xS{constructor(e,r,n){super(),this.type=e,this._limit=r,this._limitType=n}static _create(e,r,n){return new bS(e,r,n)}_apply(e){return new Yc(e.firestore,e.converter,Tv(e._query,this._limit,this._limitType))}}function So(t){return aG("limit",t),bS._create("limit",t,"F")}function QE(t,e,r){if(typeof(r=ds(r))=="string"){if(r==="")throw new Bt(dt.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!g8(e)&&r.indexOf("/")!==-1)throw new Bt(dt.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=e.path.child(cn.fromString(r));if(!Yt.isDocumentKey(n))throw new Bt(dt.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return Og(t,new Yt(n))}if(r instanceof Va)return Og(t,r._key);throw new Bt(dt.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${W2(r)}.`)}function JE(t,e){if(!Array.isArray(t)||t.length===0)throw new Bt(dt.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function BR(t,e){const r=function(s,a){for(const i of s)for(const l of i.getFlattenedFilters())if(a.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(r!==null)throw r===e.op?new Bt(dt.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Bt(dt.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${r.toString()}' filters.`)}class gG{convertValue(e,r="none"){switch(Zf(e)){case 0:return null;case 1:return e.booleanValue;case 2:return zn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(Nd(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw tr()}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return gh(e,(s,a)=>{n[s]=this.convertValue(a,r)}),n}convertVectorValue(e){var r,n,s;const a=(s=(n=(r=e.fields)===null||r===void 0?void 0:r.value.arrayValue)===null||n===void 0?void 0:n.values)===null||s===void 0?void 0:s.map(i=>zn(i.doubleValue));return new cS(a)}convertGeoPoint(e){return new lS(zn(e.latitude),zn(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=j4(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(Fg(e));default:return null}}convertTimestamp(e){const r=Bc(e);return new ft(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=cn.fromString(e);ar(W8(n));const s=new Jf(n.get(1),n.get(3)),a=new Yt(n.popFirst(5));return s.isEqual(r)||bs(`Document ${a} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wS(t,e,r){let n;return n=t?r&&(r.merge||r.mergeFields)?t.toFirestore(e,r):t.toFirestore(e):e,n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cp{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class UR extends MR{constructor(e,r,n,s,a,i){super(e,r,n,s,i),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new Ry(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(K2("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}}class Ry extends UR{data(e={}){return super.data(e)}}class $R{constructor(e,r,n,s){this._firestore=e,this._userDataWriter=r,this._snapshot=s,this.metadata=new Cp(s.hasPendingWrites,s.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new Ry(this._firestore,this._userDataWriter,n.key,n,new Cp(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new Bt(dt.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(s,a){if(s._snapshot.oldDocs.isEmpty()){let i=0;return s._snapshot.docChanges.map(l=>{const c=new Ry(s._firestore,s._userDataWriter,l.doc.key,l.doc,new Cp(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);return l.doc,{type:"added",doc:c,oldIndex:-1,newIndex:i++}})}{let i=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(l=>a||l.type!==3).map(l=>{const c=new Ry(s._firestore,s._userDataWriter,l.doc.key,l.doc,new Cp(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);let u=-1,d=-1;return l.type!==0&&(u=i.indexOf(l.doc.key),i=i.delete(l.doc.key)),l.type!==1&&(i=i.add(l.doc),d=i.indexOf(l.doc.key)),{type:xG(l.type),doc:c,oldIndex:u,newIndex:d}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}}function xG(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return tr()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gr(t){t=Ma(t,Va);const e=Ma(t.firestore,ll);return rG(Ix(e),t._key).then(r=>zR(e,t,r))}class _S extends gG{constructor(e){super(),this.firestore=e}convertBytes(e){return new pm(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new Va(this.firestore,null,r)}}function Tr(t){t=Ma(t,Yc);const e=Ma(t.firestore,ll),r=Ix(e),n=new _S(e);return VR(t._query),nG(r,t._query).then(s=>new $R(e,n,t,s))}function gd(t,e,r){t=Ma(t,Va);const n=Ma(t.firestore,ll),s=wS(t.converter,e,r);return Fx(n,[dS(Rx(n),"setDoc",t._key,s,t.converter!==null,r).toMutation(t._key,qs.none())])}function nn(t,e,r,...n){t=Ma(t,Va);const s=Ma(t.firestore,ll),a=Rx(s);let i;return i=typeof(e=ds(e))=="string"||e instanceof jx?DR(a,"updateDoc",t._key,e,r,n):RR(a,"updateDoc",t._key,e),Fx(s,[i.toMutation(t._key,qs.exists(!0))])}function Uc(t){return Fx(Ma(t.firestore,ll),[new Ax(t._key,qs.none())])}function sh(t,e){const r=Ma(t.firestore,ll),n=Rt(t),s=wS(t.converter,e);return Fx(r,[dS(Rx(t.firestore),"addDoc",n._key,s,t.converter!==null,{}).toMutation(n._key,qs.exists(!1))]).then(()=>n)}function Ug(t,...e){var r,n,s;t=ds(t);let a={includeMetadataChanges:!1,source:"default"},i=0;typeof e[i]!="object"||XE(e[i])||(a=e[i],i++);const l={includeMetadataChanges:a.includeMetadataChanges,source:a.source};if(XE(e[i])){const f=e[i];e[i]=(r=f.next)===null||r===void 0?void 0:r.bind(f),e[i+1]=(n=f.error)===null||n===void 0?void 0:n.bind(f),e[i+2]=(s=f.complete)===null||s===void 0?void 0:s.bind(f)}let c,u,d;if(t instanceof Va)u=Ma(t.firestore,ll),d=Sx(t._key.path),c={next:f=>{e[i]&&e[i](zR(u,t,f))},error:e[i+1],complete:e[i+2]};else{const f=Ma(t,Yc);u=Ma(f.firestore,ll),d=f._query;const m=new _S(u);c={next:h=>{e[i]&&e[i](new $R(u,m,f,h))},error:e[i+1],complete:e[i+2]},VR(t._query)}return function(m,h,g,p){const v=new oS(p),b=new tS(h,v,g);return m.asyncQueue.enqueueAndForget(async()=>J4(await Lv(m),b)),()=>{v.Za(),m.asyncQueue.enqueueAndForget(async()=>Z4(await Lv(m),b))}}(Ix(u),d,l,c)}function Fx(t,e){return function(n,s){const a=new Ul;return n.asyncQueue.enqueueAndForget(async()=>OH(await tG(n),s,a)),a.promise}(Ix(t),e)}function zR(t,e,r){const n=r.docs.get(e._key),s=new _S(t);return new UR(t,s,e._key,n,new Cp(r.hasPendingWrites,r.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yG{constructor(e,r){this._firestore=e,this._commitHandler=r,this._mutations=[],this._committed=!1,this._dataReader=Rx(e)}set(e,r,n){this._verifyNotCommitted();const s=yw(e,this._firestore),a=wS(s.converter,r,n),i=dS(this._dataReader,"WriteBatch.set",s._key,a,s.converter!==null,n);return this._mutations.push(i.toMutation(s._key,qs.none())),this}update(e,r,n,...s){this._verifyNotCommitted();const a=yw(e,this._firestore);let i;return i=typeof(r=ds(r))=="string"||r instanceof jx?DR(this._dataReader,"WriteBatch.update",a._key,r,n,s):RR(this._dataReader,"WriteBatch.update",a._key,r),this._mutations.push(i.toMutation(a._key,qs.exists(!0))),this}delete(e){this._verifyNotCommitted();const r=yw(e,this._firestore);return this._mutations=this._mutations.concat(new Ax(r._key,qs.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Bt(dt.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function yw(t,e){if((t=ds(t)).firestore!==e)throw new Bt(dt.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}function Mi(){return new fS("serverTimestamp")}function vG(t){return new hS("increment",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ki(t){return Ix(t=Ma(t,ll)),new yG(t,e=>Fx(t,e))}(function(e,r=!0){(function(s){Cm=s})(Am),Gf(new _d("firestore",(n,{instanceIdentifier:s,options:a})=>{const i=n.getProvider("app").getImmediate(),l=new ll(new lq(n.getProvider("auth-internal")),new fq(n.getProvider("app-check-internal")),function(u,d){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new Bt(dt.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Jf(u.options.projectId,d)}(i,s),i);return a=Object.assign({useFetchStreams:r},a),l._setSettings(a),l},"PUBLIC").setMultipleInstances(!0)),Ml(qA,"4.7.3",e),Ml(qA,"4.7.3","esm2017")})();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qR="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bG{constructor(e,r,n){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=e.getImmediate({optional:!0}),this.messaging=r.getImmediate({optional:!0}),this.auth||e.get().then(s=>this.auth=s,()=>{}),this.messaging||r.get().then(s=>this.messaging=s,()=>{}),this.appCheck||n.get().then(s=>this.appCheck=s,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.appCheck){const r=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return r.error?null:r.token}return null}async getContext(e){const r=await this.getAuthToken(),n=await this.getMessagingToken(),s=await this.getAppCheckToken(e);return{authToken:r,messagingToken:n,appCheckToken:s}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E_="us-central1";class wG{constructor(e,r,n,s,a=E_,i){this.app=e,this.fetchImpl=i,this.emulatorOrigin=null,this.contextProvider=new bG(r,n,s),this.cancelAllRequests=new Promise(l=>{this.deleteService=()=>Promise.resolve(l())});try{const l=new URL(a);this.customDomain=l.origin+(l.pathname==="/"?"":l.pathname),this.region=E_}catch{this.customDomain=null,this.region=a}}_delete(){return this.deleteService()}_url(e){const r=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${r}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${r}.cloudfunctions.net/${e}`}}function _G(t,e,r){t.emulatorOrigin=`http://${e}:${r}`}const ZE="@firebase/functions",eC="0.11.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NG="auth-internal",SG="app-check-internal",TG="messaging-internal";function AG(t,e){const r=(n,{instanceIdentifier:s})=>{const a=n.getProvider("app").getImmediate(),i=n.getProvider(NG),l=n.getProvider(TG),c=n.getProvider(SG);return new wG(a,i,l,c,s,t)};Gf(new _d(qR,r,"PUBLIC").setMultipleInstances(!0)),Ml(ZE,eC,e),Ml(ZE,eC,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EG(t=g4(),e=E_){const n=C2(ds(t),qR).getImmediate({identifier:e}),s=Gj("functions");return s&&CG(n,...s),n}function CG(t,e,r){_G(ds(t),e,r)}AG(fetch.bind(self));const kG={apiKey:"AIzaSyAtFFd51DNOAZBPhGTu-TDN4QqwFHEJroU",authDomain:"testapployalty.firebaseapp.com",projectId:"testapployalty",storageBucket:"testapployalty.firebasestorage.app",appId:"1:858235839380:web:dae988cb225beed1c72581"},NS=eP(kG),$n=sq(NS),Ke=oG(NS);EG(NS);let C_=!0,WR=0;const IG=async()=>{try{return await lG(Ke),console.log(" Firebase offline persistence enabled"),!0}catch(t){return t.code==="failed-precondition"?console.log(" Multiple tabs detected - offline persistence disabled for this tab"):t.code==="unimplemented"?console.log(" Browser does not support offline persistence"):console.log(" Offline persistence not available:",t.message),!1}},jG=async()=>{try{return console.log(" Firestore connection assumed healthy (checks disabled)"),C_=!0,WR=0,!0}catch(t){return console.warn(" Firestore connection issue:",t.message),C_=!1,!1}},PG=()=>({connected:C_,retryCount:WR}),Zt=t=>{const e={"auth/user-not-found":"No account found with this email address.","auth/wrong-password":"Incorrect password. Please try again.","auth/email-already-in-use":"An account with this email already exists.","auth/weak-password":"Password should be at least 6 characters long.","auth/invalid-email":"Please enter a valid email address.","auth/too-many-requests":"Too many attempts. Please try again later.","permission-denied":"You do not have permission to perform this action.","not-found":"The requested resource was not found.","already-exists":"The resource you are trying to create already exists.","failed-precondition":"The operation was rejected due to system state.","out-of-range":"The operation was attempted past the valid range.",unauthenticated:"You must be logged in to perform this action.",unavailable:"The service is currently unavailable. Please try again.","data-loss":"Unrecoverable data loss or corruption occurred.","deadline-exceeded":"The operation took too long to complete. Please try again.","resource-exhausted":"Service quota exceeded. Please try again later.",internal:"An internal error occurred. Please try again."},r=(t==null?void 0:t.code)||(t==null?void 0:t.message)||"unknown";return r.includes("network")||r.includes("fetch")||r.includes("connection")?"Network connection issue. Please check your internet connection and try again.":e[r]||"An unexpected error occurred. Please try again."},HR=async()=>{try{await IG(),console.log(" Firebase services initialized without automatic retries")}catch(t){console.error("Failed to initialize Firebase services:",t)}};HR();function tC(t){return t.toLowerCase().trim().replace(/[^\w\s-]/g,"").replace(/[\s_-]+/g,"-").replace(/^-+|-+$/g,"")}function k_(t){return{restaurant:{businessType:"restaurant",colors:{primary:"#16a34a",secondary:"#22c55e",accent:"#4ade80",background:"#f0fdf4",surface:"#ffffff",text:"#14532d"},gradients:{primary:"linear-gradient(135deg, #16a34a 0%, #22c55e 100%)",secondary:"linear-gradient(135deg, #22c55e 0%, #4ade80 100%)"}},cafe:{businessType:"cafe",colors:{primary:"#ca8a04",secondary:"#eab308",accent:"#fde047",background:"#fefdf8",surface:"#ffffff",text:"#713f12"},gradients:{primary:"linear-gradient(135deg, #ca8a04 0%, #eab308 100%)",secondary:"linear-gradient(135deg, #eab308 0%, #fde047 100%)"}},bar:{businessType:"bar",colors:{primary:"#9333ea",secondary:"#a855f7",accent:"#c084fc",background:"#faf5ff",surface:"#ffffff",text:"#581c87"},gradients:{primary:"linear-gradient(135deg, #9333ea 0%, #a855f7 100%)",secondary:"linear-gradient(135deg, #a855f7 0%, #c084fc 100%)"}}}[t]}function pt(t,e="INR"){const r=Number(t)||0;return new Intl.NumberFormat("en-IN",{style:"currency",currency:e}).format(r)}function Fs(t,e="Asia/Kolkata"){return new Intl.DateTimeFormat("en-IN",{timeZone:e,year:"numeric",month:"short",day:"numeric"}).format(t)}function $g(t,e="Asia/Kolkata"){return new Intl.DateTimeFormat("en-IN",{timeZone:e,hour:"2-digit",minute:"2-digit",hour12:!0}).format(t)}function rC(){return Math.floor(1e3+Math.random()*9e3).toString()}function I_(t){const e=Date.now().toString().slice(-6),r=Math.floor(Math.random()*100).toString().padStart(2,"0");return`${t.slice(0,3).toUpperCase()}-${e}-${r}`}function Hr(){return Math.random().toString(36).substring(2)+Date.now().toString(36)}function Mv(t){return{restaurant:"Restaurant",cafe:"Caf",bar:"Bar & Lounge"}[t]||t}const Xs={get:(t,e)=>{try{const r=localStorage.getItem(t);return r?JSON.parse(r):e}catch{return e}},set:(t,e)=>{try{localStorage.setItem(t,JSON.stringify(e))}catch(r){console.error("Failed to save to localStorage:",r)}},remove:t=>{try{localStorage.removeItem(t)}catch(e){console.error("Failed to remove from localStorage:",e)}},clear:()=>{try{localStorage.clear()}catch(t){console.error("Failed to clear localStorage:",t)}}},fi="restaurants",RG="users",wl=new Map,DG=5*60*1e3,mo=new Map,uc=new Map,nC=50,FG=()=>{const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*";let e="";for(let r=0;r<12;r++)e+=t.charAt(Math.floor(Math.random()*t.length));return e};class To{static async createRestaurantByAdmin(e){var r,n,s;try{const a=$n.currentUser;if(!a)return{success:!1,error:"Authentication required"};console.log(" Creating restaurant with admin:",{uid:a.uid,email:a.email});const i=Ki(Ke),l=tC(e.name),c=await this.generateUniqueSlug(l),u=FG(),d=rC(),f=Hr(),m=Hr(),h=k_(e.businessType),g={id:f,name:e.name,slug:c,businessType:e.businessType,ownerId:m,isActive:!0,createdBy:a.uid,settings:{address:e.address||"",phone:e.phone||"",email:e.ownerEmail,taxRate:((r=e.settings)==null?void 0:r.taxRate)||18,currency:((n=e.settings)==null?void 0:n.currency)||"INR",timezone:((s=e.settings)==null?void 0:s.timezone)||"Asia/Kolkata",businessInfo:{gstin:"",fssaiNumber:"",businessAddress:e.address||"",city:"",state:"",pincode:"",country:"India",website:""},theme:{primaryColor:h.colors.primary,secondaryColor:h.colors.secondary},features:{tableManagement:!0,inventoryTracking:!0,kitchenDisplay:!0,customerManagement:!0,reporting:!0}},createdAt:new Date,updatedAt:new Date},p={id:m,email:e.ownerEmail,name:e.ownerName,role:"owner",restaurantId:f,pin:d,tempPassword:u,isActive:!0,isPending:!0,createdBy:a.uid,createdAt:ft.fromDate(new Date),updatedAt:ft.fromDate(new Date)},v=Rt(Ke,fi,f),b=Rt(Ke,"pendingUsers",m);return i.set(v,{...g,createdAt:ft.fromDate(g.createdAt),updatedAt:ft.fromDate(g.updatedAt)}),i.set(b,p),await i.commit(),this.cacheRestaurant(g),console.log(" Restaurant created by admin:",g.slug),{success:!0,data:{restaurantUrl:`${window.location.origin}/${c}`,ownerEmail:e.ownerEmail,ownerPassword:u,ownerPin:d,loginInstructions:`Login at: ${window.location.origin}/${c}/login
Email: ${e.ownerEmail}
Password: ${u}
PIN: ${d}

Note: You'll be asked to create your account on first login.`},message:"Restaurant created successfully"}}catch(a){return console.error(" Failed to create restaurant:",a),{success:!1,error:Zt(a)}}}static async getAllRestaurantsForAdmin(){try{const e=$n.currentUser;if(!e)return{success:!1,error:"Authentication required"};console.log(" Super admin verified, fetching restaurants:",e.email),console.log(" Current user UID:",e.uid),console.log(" Expected UID:","XWA9XWUZ19a8EFHvteyzjpkgRYG2");const r=br(hr(Ke,fi),Oa("createdAt","desc")),s=(await Tr(r)).docs.map(a=>this.convertFirestoreDoc(a.data(),a.id));return console.log(" Loaded all restaurants for admin:",s.length),console.log(" Restaurant details:",s.map(a=>({id:a.id,name:a.name,slug:a.slug,isActive:a.isActive,businessType:a.businessType}))),{success:!0,data:s}}catch(e){return console.error(" Failed to get restaurants for admin:",e),{success:!1,error:Zt(e)}}}static async toggleRestaurantStatus(e,r){try{const n=Rt(Ke,fi,e);return await nn(n,{isActive:r,updatedAt:ft.now()}),this.clearCacheForRestaurant(e),console.log(` Restaurant ${r?"activated":"deactivated"}:`,e),{success:!0,message:`Restaurant ${r?"activated":"deactivated"} successfully`}}catch(n){return console.error(" Failed to toggle restaurant status:",n),{success:!1,error:Zt(n)}}}static async createRestaurant(e){try{const r=Ki(Ke),n=tC(e.name),s=await this.generateUniqueSlug(n),a=Hr(),l=(await EP($n,e.ownerEmail,e.ownerPassword)).user.uid,c=k_(e.businessType),u={id:a,name:e.name,slug:s,businessType:e.businessType,ownerId:l,createdBy:l,isActive:!0,settings:{address:e.address||"",phone:e.phone||"",email:e.ownerEmail,taxRate:18,currency:"INR",timezone:"Asia/Kolkata",businessInfo:{gstin:"",fssaiNumber:"",businessAddress:e.address||"",city:"",state:"",pincode:"",country:"India",website:""},theme:{primaryColor:c.colors.primary,secondaryColor:c.colors.secondary},features:{tableManagement:!0,inventoryTracking:!0,kitchenDisplay:!0,customerManagement:!0,reporting:!0}},createdAt:new Date,updatedAt:new Date},d={id:l,email:e.ownerEmail,name:e.ownerName,role:"owner",restaurantId:a,pin:rC(),permissions:[{id:"1",name:"manage_all",description:"Full access",category:"settings"}],isActive:!0,createdAt:new Date,updatedAt:new Date},f=Rt(Ke,fi,a),m=Rt(Ke,RG,l);return r.set(f,{...u,createdAt:ft.fromDate(u.createdAt),updatedAt:ft.fromDate(u.updatedAt)}),r.set(m,{...d,createdAt:ft.fromDate(d.createdAt),updatedAt:ft.fromDate(d.updatedAt)}),await r.commit(),this.cacheRestaurant(u),console.log(" Restaurant created successfully:",u.slug),{success:!0,data:{restaurant:u,user:d},message:"Restaurant created successfully"}}catch(r){return console.error(" Failed to create restaurant:",r),{success:!1,error:Zt(r)}}}static async getRestaurantBySlug(e){var r;try{const n=wl.get(e);if(n&&Date.now()<n.expiresAt)return console.log(" Cache hit for restaurant slug:",e),{success:!0,data:n.restaurant};const s=`getRestaurantBySlug_${e}`,a=Date.now();for(const[l,c]of uc.entries())a-c.timestamp>nC*10&&uc.delete(l);if(uc.has(s)){const l=uc.get(s);return console.log(" Reusing existing query for restaurant:",e),await l.promise}console.log(" Fetching restaurant from Firebase:",e),console.log(" Query params:",{slug:e,isActive:!0});const i=this.executeRestaurantQuery(e);uc.set(s,{promise:i,timestamp:a});try{return await i}finally{setTimeout(()=>{uc.delete(s)},nC)}}catch(n){console.error(" Failed to get restaurant by slug:",n);let s="Failed to load restaurant";return n.code==="unavailable"||(r=n.message)!=null&&r.includes("network")?s="Network connection issue. Please check your internet connection and try again.":n.code==="permission-denied"?s="Access denied. Please check your permissions.":n.code==="quota-exceeded"&&(s="Service temporarily unavailable. Please try again later."),{success:!1,error:s}}}static async executeRestaurantQuery(e){var s,a;let n;for(let i=1;i<=3;i++)try{console.log(` Attempt ${i}/3 to fetch restaurant:`,e);const l=`${Date.now()}_${Math.random().toString(36).substr(2,9)}`;console.log(` Query ID: ${l}`),await new Promise(m=>setTimeout(m,Math.random()*20));const c=br(hr(Ke,fi),Nr("slug","==",e),Nr("isActive","==",!0),So(1)),u=await Tr(c);if(console.log(" Query result:",{empty:u.empty,size:u.size,docs:u.docs.map(m=>({id:m.id,slug:m.data().slug,name:m.data().name,isActive:m.data().isActive}))}),u.empty){console.log(" Restaurant not found with active filter, checking all restaurants with this slug..."),await new Promise(g=>setTimeout(g,10));const m=br(hr(Ke,fi),Nr("slug","==",e),So(1)),h=await Tr(m);return console.log(" Broad query result:",{empty:h.empty,size:h.size,docs:h.docs.map(g=>({id:g.id,slug:g.data().slug,name:g.data().name,isActive:g.data().isActive}))}),{success:!1,error:"Restaurant not found"}}const d=u.docs[0],f=this.convertFirestoreDoc(d.data(),d.id);return this.cacheRestaurant(f),console.log(" Restaurant loaded successfully:",e),{success:!0,data:f}}catch(l){if(n=l,console.warn(` Attempt ${i} failed for restaurant ${e}:`,l.message),(s=l.message)!=null&&s.includes("Target ID already exists")&&(console.log(" Target ID conflict detected, waiting longer before retry..."),await new Promise(c=>setTimeout(c,100+i*50))),i<3&&this.isRetryableError(l)){const c=(a=l.message)!=null&&a.includes("Target ID already exists")?200+i*100:Math.min(1e3*Math.pow(2,i-1),5e3);console.log(` Waiting ${c}ms before retry...`),await new Promise(u=>setTimeout(u,c));continue}break}throw n}static async getRestaurantById(e){try{const r=Array.from(wl.values()).find(i=>i.restaurant.id===e&&Date.now()<i.expiresAt);if(r)return console.log(" Cache hit for restaurant ID:",e),{success:!0,data:r.restaurant};console.log(" Fetching restaurant by ID from Firebase:",e);const n=Rt(Ke,fi,e),s=await Gr(n);if(!s.exists())return{success:!1,error:"Restaurant not found"};const a=this.convertFirestoreDoc(s.data(),s.id);return this.cacheRestaurant(a),console.log(" Restaurant loaded by ID successfully:",e),{success:!0,data:a}}catch(r){return console.error(" Failed to get restaurant by ID:",r),{success:!1,error:Zt(r)}}}static async updateRestaurant(e,r){try{const n=Rt(Ke,fi,e),s={...r,updatedAt:ft.now()};await nn(n,s);const a=await this.getRestaurantById(e);return a.success&&a.data&&this.cacheRestaurant(a.data),a}catch(n){return{success:!1,error:Zt(n)}}}static async getAllRestaurants(){try{const e=br(hr(Ke,fi),Oa("createdAt","desc"));return{success:!0,data:(await Tr(e)).docs.map(s=>this.convertFirestoreDoc(s.data(),s.id))}}catch(e){return{success:!1,error:Zt(e)}}}static async getAllActiveRestaurants(){try{const e=br(hr(Ke,fi),Nr("isActive","==",!0),Oa("name"));return{success:!0,data:(await Tr(e)).docs.map(s=>this.convertFirestoreDoc(s.data(),s.id))}}catch(e){return{success:!1,error:Zt(e)}}}static async getRestaurantsByType(e){try{const r=br(hr(Ke,fi),Nr("businessType","==",e),Nr("isActive","==",!0),Oa("name"));return{success:!0,data:(await Tr(r)).docs.map(a=>this.convertFirestoreDoc(a.data(),a.id))}}catch(r){return{success:!1,error:Zt(r)}}}static subscribeToRestaurant(e,r){const n=`restaurant_${e}`;if(mo.has(n)){console.log(" Adding callback to existing subscription for restaurant:",e);const c=mo.get(n);return c.callbacks.add(r),()=>{console.log(" Removing callback from restaurant subscription:",e),c.callbacks.delete(r),c.callbacks.size===0&&(console.log(" No more callbacks, cleaning up subscription for:",e),c.unsubscribe(),mo.delete(n))}}console.log(" Creating new subscription for restaurant:",e);const s=br(hr(Ke,fi),Nr("slug","==",e),Nr("isActive","==",!0),So(1)),a=new Set([r]),i=Ug(s,c=>{let u=null;if(!c.empty){const d=c.docs[0];u=this.convertFirestoreDoc(d.data(),d.id),this.cacheRestaurant(u)}a.forEach(d=>d(u))},c=>{console.error("Restaurant subscription error:",c),a.forEach(u=>u(null)),mo.delete(n)}),l={unsubscribe:()=>{console.log(" Cleaning up Firestore subscription for restaurant:",e),i()},callbacks:a};return mo.set(n,l),()=>{console.log(" Removing callback from restaurant subscription:",e),a.delete(r),a.size===0&&(console.log(" No more callbacks, cleaning up subscription for:",e),l.unsubscribe(),mo.delete(n))}}static async deactivateRestaurant(e){try{const r=Rt(Ke,fi,e);return await nn(r,{isActive:!1,updatedAt:ft.now()}),wl.forEach((n,s)=>{n.restaurant.id===e&&wl.delete(s)}),{success:!0,message:"Restaurant deactivated successfully"}}catch(r){return{success:!1,error:Zt(r)}}}static async isSlugAvailable(e){try{const r=br(hr(Ke,fi),Nr("slug","==",e),So(1));return(await Tr(r)).empty}catch(r){return console.error("Error checking slug availability:",r),!1}}static async generateUniqueSlug(e){let r=e,n=1;for(;!await this.isSlugAvailable(r);)r=`${e}-${n}`,n++;return r}static convertFirestoreDoc(e,r){var n,s;return{id:r,name:e.name,slug:e.slug,businessType:e.businessType,ownerId:e.ownerId,isActive:e.isActive,settings:e.settings,createdBy:e.createdBy||"system",createdAt:((n=e.createdAt)==null?void 0:n.toDate())||new Date,updatedAt:((s=e.updatedAt)==null?void 0:s.toDate())||new Date}}static cacheRestaurant(e){wl.set(e.slug,{restaurant:e,timestamp:Date.now(),expiresAt:Date.now()+DG})}static clearCache(){wl.clear()}static clearAllSubscriptions(){console.log(" Clearing all active restaurant subscriptions"),mo.forEach((e,r)=>{console.log(" Cleaning up subscription:",r),e.unsubscribe()}),mo.clear()}static clearAllQueries(){console.log(" Clearing all active restaurant queries"),uc.clear()}static getCacheStats(){return{size:wl.size,entries:Array.from(wl.keys())}}static getSubscriptionStats(){return{count:mo.size,subscriptions:Array.from(mo.keys())}}static getQueryStats(){return{count:uc.size,queries:Array.from(uc.keys())}}static debugSubscriptions(){console.log(" Debug: Current subscription status:"),console.log(` Active subscriptions: ${mo.size}`),mo.forEach((e,r)=>{console.log(`   ${r}: ${e.callbacks.size} callbacks`)})}static clearCacheForRestaurant(e){wl.forEach((r,n)=>{r.restaurant.id===e&&wl.delete(n)})}static isRetryableError(e){const r=["unavailable","deadline-exceeded","internal","resource-exhausted"],n=["network","connection","timeout","fetch","channel","target id already exists"];return r.includes(e.code)||n.some(s=>{var a;return(a=e.message)==null?void 0:a.toLowerCase().includes(s)})}}const GR=X.createContext(void 0);function LG({children:t}){const[e,r]=X.useState(null),[n,s]=X.useState(!0),[a,i]=X.useState(null),[l,c]=X.useState(!1),u=X.useRef(null),d=Wl(),f=Ud(),m=X.useCallback(()=>{const w=f.pathname.split("/").filter(Boolean);return w.length>0&&!["admin","auth","create-restaurant"].includes(w[0])?w[0]:null},[f.pathname]),h=X.useCallback(w=>{const N=k_(w),j=document.documentElement;j.style.setProperty("--color-primary",N.colors.primary),j.style.setProperty("--color-secondary",N.colors.secondary),j.style.setProperty("--color-accent",N.colors.accent),j.style.setProperty("--color-background",N.colors.background),j.style.setProperty("--color-surface",N.colors.surface),j.style.setProperty("--color-text",N.colors.text),j.style.setProperty("--gradient-primary",N.gradients.primary),j.style.setProperty("--gradient-secondary",N.gradients.secondary);const F=document.querySelector('meta[name="theme-color"]');F&&F.setAttribute("content",N.colors.primary)},[]),g=X.useCallback(async w=>{try{s(!0),i(null),c(!1);const N=await To.getRestaurantBySlug(w);N.success&&N.data?(r(N.data),h(N.data.businessType),(!f.pathname.startsWith(`/${w}`)||f.pathname===`/${w}/spin-wheel`)&&!f.pathname.startsWith(`/${w}/login`)&&f.pathname!==`/${w}/spin-wheel`&&d(`/${w}`)):(i(N.error||"Restaurant not found"),r(null),console.error("Restaurant not found:",w,N.error))}catch(N){i(N.message||"Failed to load restaurant"),r(null),console.error("Error loading restaurant:",N)}finally{s(!1)}},[d,f.pathname,h]),p=X.useCallback(async w=>{if(!e)throw new Error("No restaurant loaded");try{const N=await To.updateRestaurant(e.id,w);if(N.success&&N.data)r(N.data),w.businessType&&h(w.businessType),fe.success("Restaurant updated successfully");else throw new Error(N.error||"Failed to update restaurant")}catch(N){throw i(N.message),fe.error(N.message),N}},[e,h]),v=X.useCallback(async()=>{if(e)try{const w=await To.getRestaurantBySlug(e.slug);w.success&&w.data&&r(w.data)}catch(w){console.error("Failed to refresh restaurant:",w)}},[e]);X.useEffect(()=>{const w=m();if(w)(!e||e.slug!==w)&&g(w);else{r(null),s(!1),i(null),c(!1);const N=document.documentElement;N.style.removeProperty("--color-primary"),N.style.removeProperty("--color-secondary"),N.style.removeProperty("--color-accent"),N.style.removeProperty("--color-background"),N.style.removeProperty("--color-surface"),N.style.removeProperty("--color-text"),N.style.removeProperty("--gradient-primary"),N.style.removeProperty("--gradient-secondary")}},[f.pathname]),X.useEffect(()=>{if(!e||l)return;u.current&&clearTimeout(u.current);let w=null;return u.current=setTimeout(()=>{console.log(" Setting up restaurant subscription for:",e.slug),c(!0),w=To.subscribeToRestaurant(e.slug,N=>{N?(r(N),h(N.businessType)):(r(null),i("Restaurant not found or has been deactivated"),console.error("Restaurant subscription lost:",e.slug),c(!1))}),u.current=null},100),()=>{u.current&&(clearTimeout(u.current),u.current=null),w&&(console.log(" Cleaning up restaurant subscription for:",e.slug),w(),c(!1))}},[e==null?void 0:e.slug]);const b={restaurant:e,loading:n,error:a,switchRestaurant:g,updateRestaurant:p,refreshRestaurant:v};return o.jsx(GR.Provider,{value:b,children:t})}function ya(){const t=X.useContext(GR);if(t===void 0)throw new Error("useRestaurant must be used within a RestaurantProvider");return t}class $1{static async loginWithEmail(e,r,n){var s,a,i,l;try{console.log(" Starting email login:",{email:e,restaurantSlug:n});const c=br(hr(Ke,"pendingUsers"),Nr("email","==",e)),u=await Tr(c);if(console.log(" Pending users check:",{empty:u.empty,size:u.size}),!u.empty)return console.log(" Found pending user, handling first-time signup"),await this.handleFirstTimeSignup(e,r,n,u.docs[0]);console.log(" No pending user found, attempting regular login");try{console.log(" Attempting Firebase Auth login...");const f=(await n_($n,e,r)).user;if(console.log(" Firebase Auth successful:",f.uid),!(f!=null&&f.email))return console.log(" No Firebase user email"),{success:!1,error:"Authentication failed"};console.log(" Looking for user document in Firestore...");const m=await Gr(Rt(Ke,"users",f.uid));if(console.log(" User document exists:",m.exists()),!m.exists())return console.log(" User document not found in Firestore"),await Hh($n),{success:!1,error:"User account not found. Please contact your administrator."};const h=m.data(),g={id:m.id,email:h.email,name:h.name,role:h.role,restaurantId:h.restaurantId,pin:h.pin,permissions:h.permissions||[],isActive:h.isActive,lastLoginAt:(s=h.lastLoginAt)==null?void 0:s.toDate(),createdAt:((a=h.createdAt)==null?void 0:a.toDate())||new Date,updatedAt:((i=h.updatedAt)==null?void 0:i.toDate())||new Date,createdBy:h.createdBy};if(!g.restaurantId)return await Hh($n),{success:!1,error:"User not associated with any restaurant"};const p=await Gr(Rt(Ke,"restaurants",g.restaurantId));if(!p)throw new Error("Failed to retrieve restaurant data");if(p.exists()){const v=p.data();console.log(" Restaurant data:",{name:v==null?void 0:v.name,id:h.restaurantId})}else return console.log(" Restaurant document not found:",h.restaurantId),await Hh($n),{success:!1,error:"Restaurant not found"};return g.isActive?(l=p.data())!=null&&l.isActive?(await nn(Rt(Ke,"users",g.id),{lastLoginAt:Mi(),updatedAt:Mi()}),{success:!0,user:{...g,lastLoginAt:new Date}}):(await Hh($n),{success:!1,error:"This restaurant is currently inactive"}):(await Hh($n),{success:!1,error:"Your account has been deactivated. Contact your manager."})}catch(d){if(d.code==="auth/user-not-found"||d.code==="auth/wrong-password")return{success:!1,error:"Invalid email or password"};throw d}}catch(c){return{success:!1,error:Zt(c)}}}static async handleFirstTimeSignup(e,r,n,s){var a,i,l,c,u;try{const d=s.data();if(console.log(" First-time signup data:",{email:d.email,restaurantId:d.restaurantId,tempPassword:((a=d.tempPassword)==null?void 0:a.substring(0,3))+"***"}),r!==d.tempPassword)return console.log(" Password mismatch"),{success:!1,error:"Invalid password. Please use the password provided by your admin."};console.log(" Password verified, checking restaurant...");const f=await Gr(Rt(Ke,"restaurants",d.restaurantId));if(!f.exists())return console.log(" Restaurant not found"),{success:!1,error:"Restaurant not found"};const m=f.data();if(console.log(" Restaurant data:",{slug:m.slug,expectedSlug:n,isActive:m.isActive}),m.slug!==n)return console.log(" Restaurant slug mismatch"),{success:!1,error:"User does not belong to this restaurant"};console.log(" Restaurant verified, creating Firebase Auth account...");let h,g;try{h=await EP($n,e,r),g=h.user,console.log(" Firebase Auth account created:",g.uid)}catch(F){if(console.log(" Firebase Auth error:",F.code,F.message),F.code==="auth/email-already-in-use"){console.log(" Email already in use, attempting to sign in...");try{h=await n_($n,e,r),g=h.user,console.log(" Firebase Auth sign in successful:",g.uid)}catch(U){return console.log(" Sign in failed:",U.code,U.message),{success:!1,error:"Account setup error. Please contact your administrator."}}}else return console.log(" Failed to create Firebase Auth account:",F.message),{success:!1,error:`Account creation failed: ${F.message}`}}const p={id:g.uid,email:d.email,name:d.name,role:d.role,restaurantId:d.restaurantId,pin:d.pin,permissions:d.permissions||[{id:"1",name:"manage_all",description:"Full restaurant access",category:"settings"}],isActive:d.isActive,lastLoginAt:new Date,createdAt:((i=d.createdAt)==null?void 0:i.toDate())||new Date,updatedAt:new Date,createdBy:d.createdBy},v=await Gr(Rt(Ke,"users",g.uid));if(v.exists()){console.log(" User document already exists, proceeding with login..."),await Uc(Rt(Ke,"pendingUsers",s.id)),console.log(" Deleted pending user document");const F=v.data(),U={id:v.id,email:F.email,name:F.name,role:F.role,restaurantId:F.restaurantId,pin:F.pin,permissions:F.permissions||[],isActive:F.isActive,lastLoginAt:(l=F.lastLoginAt)==null?void 0:l.toDate(),createdAt:((c=F.createdAt)==null?void 0:c.toDate())||new Date,updatedAt:((u=F.updatedAt)==null?void 0:u.toDate())||new Date,createdBy:F.createdBy};return await nn(Rt(Ke,"users",g.uid),{lastLoginAt:Mi(),updatedAt:Mi()}),{success:!0,user:{...U,lastLoginAt:new Date}}}const b=Ki(Ke);console.log(" Creating batch write operations...");const w=Rt(Ke,"users",g.uid);b.set(w,{...p,createdAt:d.createdAt,updatedAt:Mi(),lastLoginAt:Mi()}),console.log(" Added user creation to batch");const N=Rt(Ke,"restaurants",d.restaurantId);b.update(N,{ownerId:g.uid,updatedAt:Mi()}),console.log(" Added restaurant update to batch");const j=Rt(Ke,"pendingUsers",s.id);return b.delete(j),console.log(" Added pending user deletion to batch"),console.log(" Committing batch write..."),await b.commit(),console.log(" Batch write completed successfully"),{success:!0,user:{...p,lastLoginAt:new Date}}}catch(d){return{success:!1,error:Zt(d)}}}static async loginWithPin(e,r){var n,s,a,i,l,c,u;try{console.log(" Starting PIN login:",{pin:e.substring(0,2)+"**",restaurantSlug:r});const d=br(hr(Ke,"users"),Nr("pin","==",e));console.log(" Searching for users with PIN...");let f;try{f=await Tr(d)}catch(h){throw(n=h.message)!=null&&n.includes("INTERNAL ASSERTION FAILED")||(s=h.message)!=null&&s.includes("Unexpected state")?(console.error(" Firestore internal assertion failure detected. Please refresh the page."),new Error("Database connection error. Please refresh the page and try again.")):h}if(console.log(" Found users with PIN:",f.size),f.empty)return console.log(" No users found with PIN"),{success:!1,error:"Invalid PIN"};let m=null;console.log(" Checking users for restaurant match...");for(const h of f.docs){const g=h.data();if(console.log(" Checking user:",{id:h.id,email:g.email,restaurantId:g.restaurantId}),g.restaurantId){console.log(" Fetching restaurant data for:",g.restaurantId);let p;try{p=await Gr(Rt(Ke,"restaurants",g.restaurantId))}catch(v){throw((a=v.message)!=null&&a.includes("INTERNAL ASSERTION FAILED")||(i=v.message)!=null&&i.includes("Unexpected state"))&&console.error(" Firestore assertion failure in restaurant fetch"),v}if(p.exists()){const v=p.data();if(console.log(" Restaurant data:",{slug:v.slug,expectedSlug:r,match:v.slug===r}),v.slug===r){console.log(" Found matching user for restaurant"),m={id:h.id,email:g.email,name:g.name,role:g.role,restaurantId:g.restaurantId,pin:g.pin,permissions:g.permissions||[],isActive:g.isActive,lastLoginAt:(l=g.lastLoginAt)==null?void 0:l.toDate(),createdAt:((c=g.createdAt)==null?void 0:c.toDate())||new Date,updatedAt:((u=g.updatedAt)==null?void 0:u.toDate())||new Date,createdBy:g.createdBy};break}}else console.log(" Restaurant document not found:",g.restaurantId)}else console.log(" User has no restaurantId:",h.id)}return m?m.isActive?(console.log(" PIN authentication successful for user:",m.name),console.log(" Updating last login time..."),await nn(Rt(Ke,"users",m.id),{lastLoginAt:Mi(),updatedAt:Mi()}),console.log(" PIN login completed successfully"),{success:!0,user:{...m,lastLoginAt:new Date}}):(console.log(" User is not active"),{success:!1,error:"Your account has been deactivated. Contact your manager."}):(console.log(" No valid user found for restaurant"),{success:!1,error:"Invalid PIN for this restaurant"})}catch(d){return console.error(" PIN login error:",d),{success:!1,error:Zt(d)}}}static async logout(){try{await Hh($n)}catch(e){throw new Error(Zt(e))}}static getCurrentFirebaseUser(){return $n.currentUser}static isFirebaseAuthenticated(){return $n.currentUser!==null}}const KR=X.createContext(void 0),dc="restaurant_auth_user",fc="restaurant_auth_pin_mode";function OG({children:t}){const[e,r]=X.useState(null),[n,s]=X.useState(!0),[a,i]=X.useState(!1),l=X.useRef(null),c=X.useRef(!1);X.useEffect(()=>{l.current=e},[e]),X.useEffect(()=>{c.current=a},[a]),X.useEffect(()=>{console.log(" RestaurantAuthContext: Initializing from localStorage");try{const h=Xs.get(dc,null),g=Xs.get(fc,!1);h&&g?(console.log(" Restored PIN authenticated user from localStorage:",h.name),r(h),i(!0)):h&&!g&&(console.log(" Found stored user (Firebase auth mode)"),r(h),i(!1))}catch(h){console.error("Failed to restore auth state from localStorage:",h),Xs.remove(dc),Xs.remove(fc)}},[]),X.useEffect(()=>{console.log(" RestaurantAuthContext: Setting up Firebase auth listener");const h=$n.onAuthStateChanged(async g=>{var p,v,b,w;try{if(console.log(" Firebase auth state changed:",{hasFirebaseUser:!!g,firebaseUserId:g==null?void 0:g.uid,currentUserId:(p=l.current)==null?void 0:p.id,isPinAuthenticated:c.current}),g){if(l.current&&l.current.id===g.uid&&!c.current){console.log(" Firebase user matches current user, no action needed"),s(!1);return}if(c.current){console.log(" Ignoring Firebase auth change - user is PIN authenticated"),s(!1);return}console.log(" Processing Firebase authenticated user..."),await new Promise(j=>setTimeout(j,1e3));const N=await Gr(Rt(Ke,"users",g.uid));if(N.exists()){console.log(" Found user document for Firebase user");const j=N.data(),F={id:N.id,email:j.email,name:j.name,role:j.role,restaurantId:j.restaurantId,pin:j.pin,permissions:j.permissions||[],isActive:j.isActive,lastLoginAt:(v=j.lastLoginAt)==null?void 0:v.toDate(),createdAt:((b=j.createdAt)==null?void 0:b.toDate())||new Date,updatedAt:((w=j.updatedAt)==null?void 0:w.toDate())||new Date,createdBy:j.createdBy};console.log(" Setting Firebase authenticated user:",{name:F.name,email:F.email}),r(F),i(!1),Xs.set(dc,F),Xs.set(fc,!1)}else console.warn("Firebase user exists but no Firestore user document found after waiting"),await $1.logout(),r(null),i(!1),Xs.remove(dc),Xs.remove(fc)}else c.current?console.log(" Firebase user signed out but keeping PIN authenticated user"):(console.log(" Firebase user signed out, clearing user state"),r(null),Xs.remove(dc),Xs.remove(fc))}catch(N){console.error("Auth state change error:",N),c.current?console.log(" Error handling auth state, keeping PIN authenticated user"):(console.log(" Error handling auth state, clearing user (not PIN authenticated)"),r(null),Xs.remove(dc),Xs.remove(fc))}finally{s(!1)}});return()=>{console.log(" RestaurantAuthContext: Cleaning up Firebase auth listener"),h()}},[]);const m={user:e,loading:n,isAuthenticated:!!e,isPinAuthenticated:a,login:async(h,g,p)=>{try{console.log(" Email login attempt:",{email:h,restaurantSlug:p}),s(!0);const v=await $1.loginWithEmail(h,g,p);if(v.success&&v.user)console.log(" Email login successful:",{name:v.user.name}),r(v.user),i(!1),Xs.set(dc,v.user),Xs.set(fc,!1),fe.success(`Welcome back, ${v.user.name}!`);else throw new Error(v.error||"Login failed")}catch(v){throw console.error(" Email login failed:",v.message),fe.error(v.message||"Login failed"),v}finally{s(!1)}},loginWithPin:async(h,g)=>{try{console.log(" PIN login attempt:",{pin:h.substring(0,2)+"**",restaurantSlug:g}),s(!0);const p=await $1.loginWithPin(h,g);if(p.success&&p.user)console.log(" PIN login successful:",{name:p.user.name}),r(p.user),i(!0),Xs.set(dc,p.user),Xs.set(fc,!0),fe.success(`Welcome back, ${p.user.name}!`);else throw new Error(p.error||"PIN login failed")}catch(p){throw console.error(" PIN login failed:",p.message),fe.error(p.message||"PIN login failed"),p}finally{s(!1)}},logout:async()=>{try{console.log(" Logout attempt:",{isPinAuthenticated:c.current}),c.current?console.log(" PIN authenticated user logout (no Firebase signout)"):(console.log(" Signing out from Firebase Auth"),await $1.logout()),r(null),i(!1),Xs.remove(dc),Xs.remove(fc),fe.success("Logged out successfully")}catch(h){throw console.error(" Logout failed:",h),fe.error("Logout failed"),h}}};return o.jsx(KR.Provider,{value:m,children:t})}function Xc(){const t=X.useContext(KR);if(t===void 0)throw new Error("useRestaurantAuth must be used within a RestaurantAuthProvider");return t}class Yo{static storeContext(e,r){try{const n={command:e.command,missingFields:e.missingFields,contextualMessage:e.contextualMessage,transcript:e.transcript,timestamp:Date.now(),restaurantId:r};localStorage.setItem(this.CONTEXT_KEY,JSON.stringify(n)),console.log(" Voice context stored:",n)}catch(n){console.error("Failed to store voice context:",n)}}static getContext(e){try{const r=localStorage.getItem(this.CONTEXT_KEY);if(!r)return null;const n=JSON.parse(r);return Date.now()-n.timestamp>this.CONTEXT_EXPIRY?(this.clearContext(),console.log(" Voice context expired and cleared"),null):n.restaurantId!==e?(console.log(" Voice context for different restaurant, ignoring"),null):(console.log(" Voice context retrieved:",n),{command:n.command,missingFields:n.missingFields,contextualMessage:n.contextualMessage,transcript:n.transcript})}catch(r){return console.error("Failed to get voice context:",r),this.clearContext(),null}}static clearContext(){try{localStorage.removeItem(this.CONTEXT_KEY),console.log(" Voice context cleared")}catch(e){console.error("Failed to clear voice context:",e)}}static hasContext(e){return this.getContext(e)!==null}static mergeContextWithNewInput(e,r){try{const n=r.toLowerCase().trim(),s={...e.command};let a=!1,i="";if(e.missingFields.includes("tableNumber")){const l=n.match(/(?:table\s*)?(\d+)/);if(l)s.tableNumber=parseInt(l[1]),a=!0,i=`Table ${s.tableNumber} selected`;else if(n.includes("table"))return{success:!1,message:'Please specify a table number (e.g., "table 5")'}}if(e.missingFields.includes("targetTableNumber")){const l=n.match(/(?:table\s*)?(\d+)/);l&&(s.targetTableNumber=parseInt(l[1]),a=!0,i=`Target table ${s.targetTableNumber} selected`)}if((!s.type||s.type==="UNKNOWN")&&(n.includes("kot")||n.includes("kitchen")?(s.type="KOT_PRINT",a=!0,i="KOT print command selected"):n.includes("order")||n.includes("place")?(s.type="PLACE_ORDER",a=!0,i="Place order command selected"):(n.includes("payment")||n.includes("bill")||n.includes("pay"))&&(s.type="PAYMENT",a=!0,i="Payment command selected")),e.missingFields.includes("paymentMethod")&&(n.includes("upi")?(s.paymentMethod="UPI",a=!0,i="UPI payment selected"):n.includes("cash")?(s.paymentMethod="CASH",a=!0,i="Cash payment selected"):(n.includes("bank")||n.includes("card"))&&(s.paymentMethod="BANK",a=!0,i="Bank payment selected")),e.missingFields.includes("menuItems")){const l=this.parseMultipleMenuItemsFromInput(n);if(l.length>0)s.menuItems=l,a=!0,i=`Added ${l.map(u=>`${u.quantity}x ${u.name}`).join(", ")} to order`;else{const c=n.replace(/^\d+\s*/,"").replace(/\b(x|times|pieces?|items?)\b/g,"").trim();if(c.length>2){const u={name:c.split(" ").map(d=>d.charAt(0).toUpperCase()+d.slice(1)).join(" "),quantity:1,category:"Unknown"};s.menuItems=[u],a=!0,i=`Added 1x ${u.name} to order`}}}if(e.missingFields.includes("customerName")){const l=["customer","add","create","register","new","name","is","the"],c=n.split(" ").filter(u=>u.length>1&&!l.includes(u)&&!/^\d+$/.test(u));c.length>0&&(s.customerName=c.map(u=>u.charAt(0).toUpperCase()+u.slice(1)).join(" "),a=!0,i=`Customer name set to ${s.customerName}`)}if(a){const l={type:s.type||"UNKNOWN",tableNumber:s.tableNumber,targetTableNumber:s.targetTableNumber,menuItems:s.menuItems,paymentMethod:s.paymentMethod,customerName:s.customerName,customerPhone:s.customerPhone,customerEmail:s.customerEmail,customerAddress:s.customerAddress,confidence:.9,originalText:`${e.transcript} + ${r}`,isIncomplete:!1};return console.log(" Successfully merged voice context:",l),{success:!0,command:l,message:i}}return{success:!1,message:"Could not understand the additional information provided"}}catch(n){return console.error("Error merging voice context:",n),{success:!1,message:"Error processing voice context"}}}static parseMultipleMenuItemsFromInput(e){try{const r=[],n=/\s+(?:and|,|&|\+)\s+/gi;let s=e.split(n);if(s.length===1){const a=/(\d+\s+[a-zA-Z\s]+?)(?=\d+\s+[a-zA-Z]|$)/g,i=e.match(a);i&&i.length>1&&(s=i)}for(let a of s){if(a=a.trim(),a.length<2)continue;const i=this.parseMenuItemFromInput(a);i&&r.push(i)}return r}catch(r){return console.error("Error parsing multiple menu items from input:",r),[]}}static parseMenuItemFromInput(e){try{const r=[/^(\d+)\s*x?\s*(.+)$/i,/^(\w+)\s+(.+)$/i];let n=1,s=e.trim();for(const a of r){const i=e.match(a);if(i){const l=i[1].toLowerCase(),c={one:1,two:2,three:3,four:4,five:5,six:6,seven:7,eight:8,nine:9,ten:10};c[l]?(n=c[l],s=i[2]):/^\d+$/.test(l)&&(n=parseInt(l),s=i[2]);break}}return s=s.replace(/\b(x|times|pieces?|items?|orders?)\b/gi,"").replace(/^\s*[-,]\s*/,"").trim(),s.length>2?{name:s.split(" ").map(i=>i.charAt(0).toUpperCase()+i.slice(1).toLowerCase()).join(" "),quantity:Math.max(1,n),category:"Voice Order"}:null}catch(r){return console.error("Error parsing menu item from input:",r),null}}static generateContextualPrompt(e){const r=e.missingFields,n=e.command;return r.includes("tableNumber")?n.type==="KOT_PRINT"?'Which table do you want to print KOT for? (e.g., "table 5")':n.type==="PLACE_ORDER"?'Which table do you want to place order for? (e.g., "table 3")':n.type==="PAYMENT"?'Which table do you want to process payment for? (e.g., "table 2")':'Which table number? (e.g., "table 4")':r.includes("targetTableNumber")?'Which table do you want to transfer/merge to? (e.g., "table 8")':!n.type||n.type==="UNKNOWN"?n.tableNumber?`What action for table ${n.tableNumber}? Say "KOT", "Order", or "Payment"`:'What do you want to do? Say "KOT", "Order", or "Payment"':r.includes("paymentMethod")?'Which payment method? Say "UPI", "Cash", or "Bank"':r.includes("customerName")?"What is the customer name?":r.includes("menuItems")?n.tableNumber?`What items would you like to order for table ${n.tableNumber}? (e.g., "chicken wings", "2 burgers and 3 pizzas", "chicken, burger, pizza")`:'What items would you like to order? (e.g., "chicken wings", "2 burgers and 3 pizzas", "chicken, burger, pizza")':"Please provide the missing information to complete your command"}}Rr(Yo,"CONTEXT_KEY","tenverse_voice_context"),Rr(Yo,"CONTEXT_EXPIRY",5*60*1e3);const Un={success:t=>Xr.success(t,{duration:1800,style:{background:"rgba(16, 185, 129, 0.9)",color:"#fff",fontSize:"13px",padding:"8px 12px",borderRadius:"8px",maxWidth:"280px",backdropFilter:"blur(6px)"}}),error:t=>Xr.error(t,{duration:2200,style:{background:"rgba(239, 68, 68, 0.9)",color:"#fff",fontSize:"13px",padding:"8px 12px",borderRadius:"8px",maxWidth:"280px",backdropFilter:"blur(6px)"}}),info:(t,e)=>Xr(t,{icon:e||"",duration:1500,style:{background:"rgba(99, 102, 241, 0.9)",color:"#fff",fontSize:"13px",padding:"8px 12px",borderRadius:"8px",maxWidth:"280px",backdropFilter:"blur(6px)"}})},MG="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",VG="https://api.groq.com/openai/v1/chat/completions",Ou=class Ou{constructor(){Rr(this,"recognition",null);Rr(this,"isListening",!1);Rr(this,"hasPermission",!1);Rr(this,"isContinuousMode",!1);Rr(this,"shouldRestart",!1);Rr(this,"restaurantContext");Rr(this,"onStateChange");Rr(this,"onTranscriptChange");Rr(this,"onCommandDetected");Rr(this,"onIncompleteCommand");this.initializeRecognition()}initializeRecognition(){if(!("webkitSpeechRecognition"in window)&&!("SpeechRecognition"in window)){console.error("Speech recognition not supported in this browser");return}const e=window.SpeechRecognition||window.webkitSpeechRecognition;this.recognition=new e,this.recognition.continuous=!0,this.recognition.interimResults=!0,this.recognition.lang="en-US",this.recognition.maxAlternatives=1,this.recognition.onstart=()=>{console.log(" Voice recognition started"),this.isListening=!0,this.setState("listening")},this.recognition.onend=()=>{console.log(" Voice recognition ended"),this.isListening=!1,this.isContinuousMode&&this.shouldRestart?(console.log(" Restarting voice recognition for continuous mode"),setTimeout(()=>{this.shouldRestart&&this.isContinuousMode&&this.startListening()},100)):setTimeout(()=>{!this.isListening&&!this.shouldRestart&&this.setState("idle")},100)},this.recognition.onresult=r=>{var a;let n="",s=!1;for(let i=r.resultIndex;i<r.results.length;i++){const l=r.results[i];n+=l[0].transcript,l.isFinal&&(s=!0)}if(n=n.trim(),n&&(console.log(" Transcript:",n,"Final:",s),(a=this.onTranscriptChange)==null||a.call(this,n),s)){const i=r.results[r.resultIndex][0].confidence;console.log(" Processing final transcript with confidence:",i),this.processVoiceCommand(n,this.restaurantContext)}},this.recognition.onerror=r=>{switch(console.error(" Speech recognition error:",r.error),r.error){case"no-speech":this.isContinuousMode||(Un.error("No speech detected. Please try again."),this.setState("error"));break;case"audio-capture":Un.error("Microphone not accessible."),this.setState("error"),this.shouldRestart=!1;break;case"not-allowed":Un.error("Microphone permission denied."),this.setState("error"),this.shouldRestart=!1;break;case"network":this.isContinuousMode&&this.shouldRestart?console.log(" Network error, will retry..."):(Un.error("Network error. Please try again."),this.setState("error"));break;default:console.warn(" Other speech error:",r.error),this.isContinuousMode||(Un.error("Voice recognition error. Please try again."),this.setState("error"))}}}async processVoiceCommand(e,r){var n,s,a,i;try{console.log(" Processing voice command:",e),this.setState("processing");const l=(r==null?void 0:r.id)||"",c=Yo.getContext(l);if(c){console.log(" Found stored voice context, attempting to merge:",c);const f=Yo.mergeContextWithNewInput(c,e);if(f.success&&f.command){console.log(" Successfully merged voice context into complete command:",f.command),Yo.clearContext(),Un.success(f.message||"Command completed!"),this.setState("executing"),(n=this.onCommandDetected)==null||n.call(this,f.command),setTimeout(()=>{this.setState("idle")},1e3);return}else console.log(" Failed to merge voice context:",f.message),Un.error(f.message||"Could not understand the additional information"),Yo.clearContext()}let u;try{u=await this.analyzeWithGroq(e,r),console.log(" AI Command Analysis:",u)}catch(f){console.warn(" AI analysis failed, using fallback:",f),u=this.parseCommandFallback(e),console.log(" Fallback Command Analysis:",u)}const d=this.checkCommandCompleteness(u);if(!d.isComplete){const f={command:u,missingFields:d.missingFields,contextualMessage:d.contextualMessage,transcript:e};Yo.storeContext(f,l);const m=Yo.generateContextualPrompt(f);(s=this.onIncompleteCommand)==null||s.call(this,f),this.setState("idle"),Un.info(m,""),console.log(" Stored incomplete command context:",f);return}switch(Yo.clearContext(),u.type){case"ORDER":const f=((a=u.menuItems)==null?void 0:a.map(h=>`${h.quantity}x ${h.name}`).join(", "))||"items";Un.success(` Adding: ${f} ${u.tableNumber?`table ${u.tableNumber}`:""}`);break;case"PLACE_ORDER":Un.success(` Placing order ${u.tableNumber?`table ${u.tableNumber}`:""}`);break;case"PAYMENT":Un.success(` Payment ${u.tableNumber?`table ${u.tableNumber}`:""}${u.paymentMethod?` via ${u.paymentMethod}`:""}`);break;case"KOT_PRINT":Un.success(` Printing KOT${u.tableNumber?` table ${u.tableNumber}`:""}`);break;case"ORDER_CANCEL":Un.success(` Canceling order${u.tableNumber?` table ${u.tableNumber}`:""}`);break;case"TABLE_MERGE":Un.success(` Merging table ${u.tableNumber}  ${u.targetTableNumber}`);break;case"TABLE_TRANSFER":Un.success(` Transfer table ${u.tableNumber}  ${u.targetTableNumber}`);break;case"TABLE_STATUS":Un.success(` Table ${u.tableNumber} status updated`);break;case"CUSTOMER":const m=u.customerName?`${u.customerName}`:"customer";Un.success(` Adding ${m} to CRM`);break;case"MENU_INQUIRY":Un.info(" Menu inquiry","");break;default:Un.info(`Processing: ${u.type}`)}this.setState("executing"),(i=this.onCommandDetected)==null||i.call(this,u),setTimeout(()=>{this.setState("idle")},1e3)}catch(l){console.error(" Voice command processing failed:",l),this.setState("error"),Un.error("Sorry, I couldn't understand that command"),setTimeout(()=>{this.setState("idle")},2e3)}}checkCommandCompleteness(e){const r=[];let n="";if(e.type==="UNKNOWN"&&e.tableNumber)return n=`Table ${e.tableNumber} selected - what would you like to do? Say "KOT", "Order", or "Payment"`,{isComplete:!1,missingFields:[],contextualMessage:n};const s=e.originalText.toLowerCase();switch(e.tableNumber||(s.includes("kot")||s.includes("kitchen")?(e.type="KOT_PRINT",r.push("tableNumber"),n="KOT print command detected - which table number?"):s.includes("order")||s.includes("place")?(e.type="PLACE_ORDER",r.push("tableNumber"),n="Place order command detected - which table number?"):(s.includes("payment")||s.includes("bill")||s.includes("pay"))&&(e.type="PAYMENT",r.push("tableNumber"),n="Payment command detected - which table number?")),e.type){case"ORDER":case"PLACE_ORDER":e.tableNumber||r.push("tableNumber"),(!e.menuItems||e.menuItems.length===0)&&r.push("menuItems");break;case"PAYMENT":case"KOT_PRINT":case"ORDER_CANCEL":case"TABLE_STATUS":e.tableNumber||r.push("tableNumber");break;case"TABLE_MERGE":case"TABLE_TRANSFER":e.tableNumber||r.push("tableNumber"),e.targetTableNumber||r.push("targetTableNumber");break;case"CUSTOMER":!e.customerName&&!e.customerPhone&&r.push("customerName");break}if(r.length>0&&!n)if(r.includes("tableNumber"))switch(e.type){case"KOT_PRINT":n="Which table do you want to print KOT for?";break;case"PLACE_ORDER":n="Which table do you want to place order for?";break;case"PAYMENT":n="Which table do you want to process payment for?";break;default:n="Please specify the table number."}else r.includes("paymentMethod")?n=`Payment for table ${e.tableNumber} - which method? Say "UPI", "Cash", or "Bank"`:r.includes("customerName")?n="What is the customer name?":r.includes("targetTableNumber")?n=`${e.type} from table ${e.tableNumber} - to which table?`:r.includes("menuItems")&&(n="Which menu items do you want to order?");return{isComplete:r.length===0,missingFields:r,contextualMessage:n}}parseCommandFallback(e){const r=e.toLowerCase(),n=w=>{let N=w;const j={koti:"kot",cot:"kot",cott:"kot","k o t":"kot","kitchen order":"kot","kitchen ticket":"kot",ordr:"order",oder:"order","place order":"order","take order":"order","make order":"order",paymnt:"payment","pay bill":"payment","settle bill":"payment","complete payment":"payment","process payment":"payment","u p i":"upi",tabel:"table",tabl:"table",tabol:"table",custmr:"customer",client:"customer",guest:"customer",numbr:"number",phon:"phone",mobil:"mobile",contct:"contact",cancl:"cancel",delet:"delete",remov:"remove",transferr:"transfer",mov:"move",shft:"shift",swch:"switch",merg:"merge",combin:"combine",joi:"join"};for(const[F,U]of Object.entries(j))N=N.replace(new RegExp(`\\b${F}\\b`,"g"),U);return N=N.replace(/(\d)\s+(\d)/g,"$1$2"),N=N.replace(/number\s*(\d+)/g,"$1"),N},s=w=>{const N={zero:"0",one:"1",two:"2",three:"3",four:"4",five:"5",six:"6",seven:"7",eight:"8",nine:"9",ten:"10",eleven:"11",twelve:"12",thirteen:"13",fourteen:"14",fifteen:"15"};let j=w;for(const[F,U]of Object.entries(N))j=j.replace(new RegExp(`\\b${F}\\b`,"g"),U);return j},a=n(r),i=s(a),l=[/(?:table|tabel|tabl|tabol)\s+(?:number\s+)?(\d+)/,/(\d+)\s+(?:table|tabel|tabl|tabol)/,/(?:number\s+)?(\d+)/];let c=null;for(const w of l){const N=i.match(w);if(N){c=parseInt(N[1]);break}}if(console.log(" Enhanced fallback parsing for:",r),console.log(" Normalized:",a,"| Processed:",i,"| Table:",c),["kot","koti","cot","cott","kitchen order","kitchen ticket","k o t","print kot","print kitchen"].some(w=>i.includes(w)))return console.log(" KOT command detected with variation:",r),{type:"KOT_PRINT",tableNumber:c||void 0,confidence:.85,originalText:e};if(["customer","custmr","client","guest","new customer","add customer","register customer","create customer"].some(w=>i.includes(w))){console.log(" Customer command detected with variation:",r);let w="";const N=[/(?:customer|custmr|client|guest|name)\s+(?:name\s+)?([a-zA-Z]+(?:\s+[a-zA-Z]+)*)/,/(?:add|new|create|register)\s+(?:customer|custmr|client|guest)\s+([a-zA-Z]+(?:\s+[a-zA-Z]+)*)/,/(?:customer|custmr|client|guest)\s+([a-zA-Z]+(?:\s+[a-zA-Z]+)*)\s+(?:phone|number|mobile)/];for(const S of N){const k=i.match(S);if(k&&k[1]){w=k[1].trim().split(" ").map(M=>M.charAt(0).toUpperCase()+M.slice(1)).join(" ");break}}let j="";const F=[/(?:phone|number|mobile|contact)(?:\s+number)?\s*[:\s]*(\d{10})/,/(?:phone|number|mobile|contact)(?:\s+number)?\s*[:\s]*(\d{4}\s*\d{3}\s*\d{3})/,/(?:phone|number|mobile|contact)(?:\s+number)?\s*[:\s]*(\d{3}\s*\d{3}\s*\d{4})/,/(\d{10})/,/(\d{4}\s*\d{3}\s*\d{3})/,/(\d{3}\s*\d{3}\s*\d{4})/];for(const S of F){const k=i.match(S);if(k&&k[1]&&(j=k[1].replace(/\s+/g,""),j.length===10))break}let U="";const A=i.match(/([a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,})/);return A&&(U=A[1]),console.log(" Extracted customer data:",{customerName:w,customerPhone:j,customerEmail:U}),{type:"CUSTOMER",customerName:w||void 0,customerPhone:j||void 0,customerEmail:U||void 0,confidence:.85,originalText:e}}if(["order","ordr","oder","place order","take order","make order"].some(w=>i.includes(w))){console.log(" Place order command detected with variation:",r,"| Table:",c);const w=[],N=["chicken wings","buffalo wings","hot wings","chicken wing","wing","beef burger","chicken burger","cheese burger","burger","margherita pizza","cheese pizza","pepperoni pizza","pizza","caesar salad","garden salad","greek salad","salad","grilled chicken","fried chicken","chicken breast","chicken","grilled fish","fried fish","fish fillet","fish","spaghetti","penne pasta","pasta marinara","pasta","fresh orange juice","orange juice","apple juice","grape juice","juice","french fries","fries","sandwich","rice","dal","curry","bread","naan","roti","biryani","paneer","mutton","beef","pork","prawns","crab","lobster","noodles","momos","samosa","pakora","dosa","idli","vada","uttapam","lassi","water","coke","coffee","tea","soup"],F=(U=>{const A=[];let S=U.replace(/\b(?:table|tabel|tabl|number)\s*\d+\b/gi,"").replace(/\b(?:order|ordr|oder|place|take|make)\b/gi,"").trim();console.log(" Clean text for parsing:",S);const k=/\s+(?:and|,|&|\+)\s+/gi;let M=S.split(k);if(M.length===1){const I=/(\d+\s+[a-zA-Z\s]+?)(?=\d+\s+[a-zA-Z]|$)/g,E=S.match(I);E&&E.length>1&&(M=E)}console.log(" Segments to process:",M);for(let I of M){if(I=I.trim(),I.length<2)continue;let E=1,D=I;const G=[/^(\d+)\s*x?\s*(.+)$/i,/^(one|two|three|four|five|six|seven|eight|nine|ten)\s+(.+)$/i,/(.+?)\s+(\d+)$/i];for(const ae of G){const de=I.match(ae);if(de){const[,se,Y]=de;if(/^\d+$/.test(se))E=parseInt(se),D=Y;else if(/^\d+$/.test(Y))E=parseInt(Y),D=se;else{const ye={one:1,two:2,three:3,four:4,five:5,six:6,seven:7,eight:8,nine:9,ten:10};ye[se.toLowerCase()]&&(E=ye[se.toLowerCase()],D=Y)}break}}D=D.replace(/\b(x|times|pieces?|items?|orders?)\b/gi,"").replace(/^\s*[-,]\s*/,"").trim();const Z=N.filter(ae=>{const de=D.toLowerCase(),se=ae.toLowerCase();return de===se||de.includes(se)||se.includes(de)||ae.includes(" ")&&ae.split(" ").every(Y=>de.includes(Y.toLowerCase()))}).sort((ae,de)=>de.length-ae.length);if(Z.length>0){const de=Z[0].split(" ").map(se=>se.charAt(0).toUpperCase()+se.slice(1).toLowerCase()).join(" ");A.push({name:de,quantity:Math.max(1,E)}),console.log(` Parsed item: ${E}x ${de} from "${I}"`)}else if(D.length>2){const ae=D.split(" ").map(de=>de.charAt(0).toUpperCase()+de.slice(1).toLowerCase()).join(" ");A.push({name:ae,quantity:Math.max(1,E)}),console.log(` Added generic item: ${E}x ${ae} from "${I}"`)}}return A})(i);return w.push(...F),console.log(" Final parsed menu items:",w),{type:"PLACE_ORDER",tableNumber:c||void 0,menuItems:w.length>0?w:void 0,confidence:.8,originalText:e}}if(["payment","pay","bill","paymnt","pay bill","complete payment","process payment","settle","settle bill"].some(w=>i.includes(w))){console.log(" Payment command detected with variation:",r);let w;return i.includes("upi")||i.includes("u p i")?w="UPI":i.includes("cash")||i.includes("cash payment")?w="CASH":(i.includes("bank")||i.includes("card")||i.includes("debit")||i.includes("credit"))&&(w="BANK"),{type:"PAYMENT",tableNumber:c||void 0,paymentMethod:w,confidence:.8,originalText:e}}if(["cancel","delete","remove","cancel order","delete order","remove order"].some(w=>i.includes(w)))return console.log(" Cancel order command detected:",r),{type:"ORDER_CANCEL",tableNumber:c||void 0,confidence:.8,originalText:e};if(["make table","set table","table ready","table available","table occupied","ready table","available table"].some(w=>i.includes(w)))return console.log(" Table status command detected:",r),{type:"TABLE_STATUS",tableNumber:c||void 0,confidence:.7,originalText:e};if(["merge","combine","join","merge table","combine table","join table"].some(w=>i.includes(w))){console.log(" Table merge command detected:",r);const w=i.match(/(\d+)/g);if(w&&w.length>=2)return{type:"TABLE_MERGE",tableNumber:parseInt(w[0]),targetTableNumber:parseInt(w[1]),confidence:.7,originalText:e}}if(["transfer","move","shift","switch","transfer table","move table"].some(w=>i.includes(w))){console.log(" Table transfer command detected:",r);const w=i.match(/(\d+)/g);if(w&&w.length>=2)return{type:"TABLE_TRANSFER",tableNumber:parseInt(w[0]),targetTableNumber:parseInt(w[1]),confidence:.7,originalText:e}}return["menu","what's available","show menu","food items","what do you have","available items"].some(w=>i.includes(w))?(console.log(" Menu inquiry command detected:",r),{type:"MENU_INQUIRY",confidence:.7,originalText:e}):(console.log(" Unknown command, could not parse:",r),{type:"UNKNOWN",confidence:.3,originalText:e})}static getInstance(){return Ou.instance||(Ou.instance=new Ou),Ou.instance}static isSupported(){return"webkitSpeechRecognition"in window||"SpeechRecognition"in window}async requestPermission(){try{return(await navigator.mediaDevices.getUserMedia({audio:!0})).getTracks().forEach(r=>r.stop()),this.hasPermission=!0,!0}catch(e){return console.error(" Microphone permission denied:",e),this.hasPermission=!1,!1}}startListening(){if(!this.recognition){Un.error("Voice recognition not initialized");return}if(this.isListening){console.warn(" Already listening");return}try{this.shouldRestart=!1,this.recognition.start()}catch(e){console.error(" Failed to start voice recognition:",e),this.setState("error")}}startContinuousListening(){if(!this.recognition){Un.error("Voice recognition not initialized");return}if(console.log(" Starting continuous listening mode"),this.isContinuousMode=!0,this.shouldRestart=!0,Un.info(" Continuous listening enabled. Press again to stop.",""),this.isListening){console.log(" Already listening, switching to continuous mode");return}try{this.recognition.start()}catch(e){console.error(" Failed to start continuous voice recognition:",e),this.setState("error"),this.isContinuousMode=!1,this.shouldRestart=!1}}stopListening(){if(!this.isListening||!this.recognition){this.isContinuousMode=!1,this.shouldRestart=!1,this.setState("idle");return}console.log(" Stopping voice recognition"),this.isContinuousMode=!1,this.shouldRestart=!1,this.isContinuousMode&&Un.info(" Continuous listening stopped","");try{this.recognition.stop()}catch(e){console.error(" Failed to stop voice recognition:",e)}}toggleListening(){this.isListening?this.stopListening():this.startContinuousListening()}getIsListening(){return this.isListening}getIsContinuousMode(){return this.isContinuousMode}getHasPermission(){return this.hasPermission}setRestaurantContext(e){this.restaurantContext=e,console.log(" Restaurant context set:",e)}clearRestaurantContext(){this.restaurantContext=void 0,console.log(" Restaurant context cleared")}setOnStateChange(e){this.onStateChange=e}setOnTranscriptChange(e){this.onTranscriptChange=e}setOnCommandDetected(e){this.onCommandDetected=e}setOnIncompleteCommand(e){this.onIncompleteCommand=e}isVoiceSupported(){return Ou.isSupported()}testVoiceCommand(e){console.log(" Testing voice command:",e);const r=this.parseCommandFallback(e);return console.log(" Test result:",r),r}setState(e){var r;(r=this.onStateChange)==null||r.call(this,e)}async mergeIncompleteCommand(e,r){try{if(e.missingFields.includes("tableNumber")&&r.toLowerCase().includes("table")){const i=r.match(/table\s+(\d+)/i);if(i){const l=parseInt(i[1]),c={...e.command,tableNumber:l,originalText:`${e.transcript} ${r}`,confidence:Math.min(e.command.confidence,.9),isIncomplete:!1};if(this.checkCommandCompleteness(c).isComplete)return console.log(" Successfully merged incomplete command with table number:",c),c}}const n=`${e.transcript} ${r}`;console.log(" Attempting to merge commands:",{original:e.transcript,new:r,merged:n});const s=await this.analyzeWithGroq(n,this.restaurantContext);return this.checkCommandCompleteness(s).isComplete?(console.log(" Successfully merged incomplete command:",s),s):null}catch(n){return console.error(" Failed to merge commands:",n),null}}async analyzeWithGroq(e,r){var a,i,l;const s=`${r?`Restaurant: ${r.name} (${r.slug}). `:""} Extract info from voice commands and respond with JSON ONLY.

SPEECH FLEXIBILITY RULES:
1. PHONETIC VARIATIONS - Accept common pronunciation mistakes and variations:
   - KOT: "koti", "kot", "cot", "cott", "kitchen order", "kitchen ticket", "k o t"
   - ORDER: "order", "ordr", "oder", "place order", "take order", "make order"
   - PAYMENT: "payment", "pay", "bill", "paymnt", "pay bill", "complete payment", "process payment"
   - TABLE: "table", "tabel", "tabl", "table number", "tabol"
   - CUSTOMER: "customer", "custmr", "client", "guest", "new customer", "add customer"

2. CASUAL SPEECH PATTERNS - Handle informal language:
   - "koti table 2"  KOT_PRINT for table 2
   - "pay table 5"  PAYMENT for table 5  
   - "order pizza table 3"  PLACE_ORDER
   - "customer john 9123456789"  CUSTOMER registration
   - "cancel table 4"  ORDER_CANCEL for table 4

3. FLEXIBLE WORD ORDER - Commands can be in any order:
   - "table 2 koti" = "koti table 2" = "print kot table number 2"
   - "pizza order table 1" = "table 1 order pizza" = "order table 1 pizza"

COMMAND TYPES:
- PLACE_ORDER: ANY mention of "order" + food items + table (e.g., "order chicken table 1", "pizza order table 2", "table 3 burger order")
- PAYMENT: "payment", "pay", "bill", "settle", "complete" + table number + optional method (UPI/CASH/BANK)
- KOT_PRINT: "kot", "koti", "cot", "kitchen order", "print kot", "kitchen ticket" + table number
- ORDER_CANCEL: "cancel", "delete", "remove", "cancel order" + table number
- TABLE_MERGE: "merge", "combine", "join" + two table numbers
- TABLE_TRANSFER: "transfer", "move", "shift", "switch" + source table + target table  
- TABLE_STATUS: "make table", "set table", "table ready", "table available", "table occupied" + table number
- CUSTOMER: "customer", "add customer", "new customer", "register" + name + phone (required) + optional email/address
- MENU_INQUIRY: "menu", "what's available", "show menu", "food items", "what do you have"

IMPORTANT RULES:
1. ALWAYS prioritize PLACE_ORDER if the word "order" appears anywhere in the command
2. For KOT commands, any variation of "kot"/"koti"/"cot" should be KOT_PRINT
3. Handle numbers written as words: "one", "two", "three", etc.
4. Extract table numbers from anywhere in the sentence: "table 5", "table number 5", "5 table", "number 5"
5. For CUSTOMER commands, extract name and phone carefully. Phone can have spaces: "9135036 551"
6. Be very lenient with pronunciation - focus on intent rather than exact words
7. MULTIPLE ITEMS: Detect multiple menu items with individual quantities in a single order command

MULTIPLE ITEM PARSING RULES:
- Handle lists: "order 2 chicken wings and 3 burgers table 5"
- Handle comma separation: "order chicken wings, 2 burgers, pizza table 3"
- Handle "and" separation: "order chicken and fish and rice table 2"
- Individual quantities: "order 2 chicken wings 3 burgers 1 pizza table 4"
- Mixed patterns: "order 2 chicken wings and burger and 3 pizzas table 1"
- Default quantity: If no quantity specified, assume 1

CASUAL SPEECH EXAMPLES:
"koti table two"  {"type":"KOT_PRINT","tableNumber":2,"confidence":0.9}
"pay table five upi"  {"type":"PAYMENT","tableNumber":5,"paymentMethod":"UPI","confidence":0.9}  
"order chicken wings table one"  {"type":"PLACE_ORDER","tableNumber":1,"menuItems":[{"name":"chicken wings","quantity":1}],"confidence":0.9}
"order 2 chicken wings and 3 burgers table 5"  {"type":"PLACE_ORDER","tableNumber":5,"menuItems":[{"name":"chicken wings","quantity":2},{"name":"burgers","quantity":3}],"confidence":0.9}
"order chicken wings, 2 burgers, pizza table 3"  {"type":"PLACE_ORDER","tableNumber":3,"menuItems":[{"name":"chicken wings","quantity":1},{"name":"burgers","quantity":2},{"name":"pizza","quantity":1}],"confidence":0.9}
"customer rahul nine one three five zero three six five five one"  {"type":"CUSTOMER","customerName":"Rahul","customerPhone":"9135036551","confidence":0.9}
"cancel table three"  {"type":"ORDER_CANCEL","tableNumber":3,"confidence":0.9}

Example JSON responses:
{"type":"KOT_PRINT","tableNumber":2,"confidence":0.9,"originalText":"koti table number 2"}
{"type":"PLACE_ORDER","tableNumber":1,"menuItems":[{"name":"pizza","quantity":2}],"confidence":0.9,"originalText":"two pizza table one order"}
{"type":"PAYMENT","tableNumber":4,"paymentMethod":"CASH","confidence":0.8,"originalText":"pay table 4 cash"}
{"type":"CUSTOMER","customerName":"John Smith","customerPhone":"9876543210","confidence":0.9,"originalText":"customer john smith nine eight seven six five four three two one zero"}`;try{const c=await fetch(VG,{method:"POST",headers:{Authorization:`Bearer ${MG}`,"Content-Type":"application/json"},body:JSON.stringify({model:"llama-3.3-70b-versatile",messages:[{role:"system",content:s},{role:"user",content:e}],temperature:.1,max_tokens:500})});if(!c.ok)throw new Error(`Groq API error: ${c.status}`);const d=(l=(i=(a=(await c.json()).choices[0])==null?void 0:a.message)==null?void 0:i.content)==null?void 0:l.trim();if(!d)throw new Error("No response from Groq");console.log(" Groq response:",d);try{const f=JSON.parse(d);return f.originalText=e,f}catch{throw console.warn(" Failed to parse Groq JSON response:",d),new Error("Invalid JSON response from AI")}}catch(c){throw console.error(" Groq AI analysis failed:",c),c}}};Rr(Ou,"instance",null);let zg=Ou;const hi=zg.getInstance();/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var BG={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UG=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Mt=(t,e)=>{const r=X.forwardRef(({color:n="currentColor",size:s=24,strokeWidth:a=2,absoluteStrokeWidth:i,className:l="",children:c,...u},d)=>X.createElement("svg",{ref:d,...BG,width:s,height:s,stroke:n,strokeWidth:i?Number(a)*24/Number(s):a,className:["lucide",`lucide-${UG(t)}`,l].join(" "),...u},[...e.map(([f,m])=>X.createElement(f,m)),...Array.isArray(c)?c:[c]]));return r.displayName=`${t}`,r};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $c=Mt("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qg=Mt("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $G=Mt("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gm=Mt("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j_=Mt("ArrowRightLeft",[["path",{d:"m16 3 4 4-4 4",key:"1x1c3m"}],["path",{d:"M20 7H4",key:"zbl0bi"}],["path",{d:"m8 21-4-4 4-4",key:"h9nckh"}],["path",{d:"M4 17h16",key:"g4d7ey"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zG=Mt("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kp=Mt("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xd=Mt("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qG=Mt("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WG=Mt("Brain",[["path",{d:"M9.5 2A2.5 2.5 0 0 1 12 4.5v15a2.5 2.5 0 0 1-4.96.44 2.5 2.5 0 0 1-2.96-3.08 3 3 0 0 1-.34-5.58 2.5 2.5 0 0 1 1.32-4.24 2.5 2.5 0 0 1 1.98-3A2.5 2.5 0 0 1 9.5 2Z",key:"1mhkh5"}],["path",{d:"M14.5 2A2.5 2.5 0 0 0 12 4.5v15a2.5 2.5 0 0 0 4.96.44 2.5 2.5 0 0 0 2.96-3.08 3 3 0 0 0 .34-5.58 2.5 2.5 0 0 0-1.32-4.24 2.5 2.5 0 0 0-1.98-3A2.5 2.5 0 0 0 14.5 2Z",key:"1d6s00"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vv=Mt("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HG=Mt("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X2=Mt("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ai=Mt("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z1=Mt("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YR=Mt("ChefHat",[["path",{d:"M6 13.87A4 4 0 0 1 7.41 6a5.11 5.11 0 0 1 1.05-1.54 5 5 0 0 1 7.08 0A5.11 5.11 0 0 1 16.59 6 4 4 0 0 1 18 13.87V21H6Z",key:"z3ra2g"}],["line",{x1:"6",x2:"18",y1:"17",y2:"17",key:"12q60k"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GG=Mt("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KG=Mt("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YG=Mt("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ad=Mt("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hu=Mt("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P_=Mt("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XG=Mt("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yi=Mt("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ah=Mt("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q2=Mt("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zc=Mt("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ci=Mt("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xm=Mt("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wg=Mt("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ia=Mt("Gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sC=Mt("GitMerge",[["circle",{cx:"18",cy:"18",r:"3",key:"1xkwt0"}],["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M6 21V9a9 9 0 0 0 9 9",key:"7kw0sc"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QG=Mt("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yd=Mt("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R_=Mt("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JG=Mt("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J2=Mt("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XR=Mt("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZG=Mt("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ed=Mt("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aC=Mt("Loader",[["line",{x1:"12",x2:"12",y1:"2",y2:"6",key:"gza1u7"}],["line",{x1:"12",x2:"12",y1:"18",y2:"22",key:"1qhbu9"}],["line",{x1:"4.93",x2:"7.76",y1:"4.93",y2:"7.76",key:"xae44r"}],["line",{x1:"16.24",x2:"19.07",y1:"16.24",y2:"19.07",key:"bxnmvf"}],["line",{x1:"2",x2:"6",y1:"12",y2:"12",key:"89khin"}],["line",{x1:"18",x2:"22",y1:"12",y2:"12",key:"pb8tfm"}],["line",{x1:"4.93",x2:"7.76",y1:"19.07",y2:"16.24",key:"1uxjnu"}],["line",{x1:"16.24",x2:"19.07",y1:"7.76",y2:"4.93",key:"6duxfx"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QR=Mt("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eK=Mt("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D_=Mt("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z2=Mt("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vd=Mt("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tK=Mt("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rK=Mt("MicOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M18.89 13.23A7.12 7.12 0 0 0 19 12v-2",key:"80xlxr"}],["path",{d:"M5 10v2a7 7 0 0 0 12 5",key:"p2k8kg"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xp=Mt("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nK=Mt("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sK=Mt("MoreVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zi=Mt("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hg=Mt("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cd=Mt("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dy=Mt("Percent",[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lx=Mt("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aK=Mt("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wn=Mt("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iK=Mt("PowerOff",[["path",{d:"M18.36 6.64A9 9 0 0 1 20.77 15",key:"dxknvb"}],["path",{d:"M6.16 6.16a9 9 0 1 0 12.68 12.68",key:"1x7qb5"}],["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oK=Mt("Power",[["path",{d:"M12 2v10",key:"mnfbl"}],["path",{d:"M18.4 6.6a9 9 0 1 1-12.77.04",key:"obofu9"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JR=Mt("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lK=Mt("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1-2-1Z",key:"wqdwcb"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17V7",key:"pyj7ub"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ox=Mt("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fy=Mt("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kd=Mt("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eo=Mt("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Id=Mt("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F_=Mt("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gg=Mt("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vw=Mt("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZR=Mt("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cK=Mt("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cc=Mt("Store",[["path",{d:"m2 7 4.41-4.41A2 2 0 0 1 7.83 2h8.34a2 2 0 0 1 1.42.59L22 7",key:"ztvudi"}],["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["path",{d:"M15 22v-4a2 2 0 0 0-2-2h-2a2 2 0 0 0-2 2v4",key:"2ebpfo"}],["path",{d:"M2 7h20",key:"1fcdvo"}],["path",{d:"M22 7v3a2 2 0 0 1-2 2v0a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 16 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 12 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 8 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 4 12v0a2 2 0 0 1-2-2V7",key:"jon5kx"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bv=Mt("Tag",[["path",{d:"M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2Z",key:"14b2ls"}],["path",{d:"M7 7h.01",key:"7u93v4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qh=Mt("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qp=Mt("Ticket",[["path",{d:"M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"qn84l0"}],["path",{d:"M13 5v2",key:"dyzc3o"}],["path",{d:"M13 17v2",key:"1ont0d"}],["path",{d:"M13 11v2",key:"1wjjxi"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ga=Mt("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L_=Mt("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _i=Mt("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uv=Mt("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O_=Mt("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bw=Mt("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kc=Mt("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ni=Mt("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iC=Mt("Utensils",[["path",{d:"M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2",key:"cjf0a3"}],["path",{d:"M7 2v20",key:"1473qp"}],["path",{d:"M21 15V2v0a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7",key:"1ogz0v"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uK=Mt("WifiOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M8.5 16.5a5 5 0 0 1 7 0",key:"sej527"}],["path",{d:"M2 8.82a15 15 0 0 1 4.17-2.65",key:"11utq1"}],["path",{d:"M10.66 5c4.01-.36 8.14.9 11.34 3.76",key:"hxefdu"}],["path",{d:"M16.85 11.25a10 10 0 0 1 2.22 1.68",key:"q734kn"}],["path",{d:"M5 13a10 10 0 0 1 5.24-2.76",key:"piq4yl"}],["line",{x1:"12",x2:"12.01",y1:"20",y2:"20",key:"of4bc4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M_=Mt("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zn=Mt("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dK=Mt("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]),fK=({isVisible:t,context:e,onClose:r,onRetryVoice:n})=>{if(!t||!e)return null;const a=(()=>{const i=e.command,l=e.missingFields;return l.includes("tableNumber")?i.type==="KOT_PRINT"?['"Table 5"','"5"','"Table number 3"']:i.type==="PLACE_ORDER"?['"Table 2"','"2"','"Table number 7"']:i.type==="PAYMENT"?['"Table 4"','"4"','"Table number 1"']:['"Table 3"','"3"','"Table number 6"']:!i.type||i.type==="UNKNOWN"?i.tableNumber?['"KOT"','"Order"','"Payment"']:['"KOT"','"Order"','"Payment"']:l.includes("paymentMethod")?['"UPI"','"Cash"','"Bank"']:l.includes("customerName")?['"John Smith"','"Sarah Wilson"','"Customer name"']:l.includes("targetTableNumber")?['"Table 8"','"8"','"Table number 10"']:l.includes("menuItems")?['"Chicken wings"','"2 burgers"','"Pizza margherita"']:['"Continue"','"Complete"','"Finish"']})();return o.jsx("div",{className:"fixed bottom-36 right-4 z-50 max-w-sm sm:right-6",children:o.jsxs("div",{className:"bg-white border-2 border-orange-200 rounded-lg shadow-xl p-4 animate-in slide-in-from-bottom-4 fade-in duration-300 mx-2 sm:mx-0 relative backdrop-blur-sm",children:[o.jsx("div",{className:"absolute -bottom-2 right-6 w-4 h-4 bg-white border-r-2 border-b-2 border-orange-200 transform rotate-45 sm:right-8"}),o.jsxs("div",{className:"flex items-start justify-between gap-3",children:[o.jsxs("div",{className:"flex-1",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[o.jsx("div",{className:"w-3 h-3 bg-orange-500 rounded-full animate-pulse"}),o.jsx("span",{className:"text-sm font-semibold text-orange-700",children:"Voice Command Incomplete"})]}),o.jsx("p",{className:"text-sm text-gray-700 leading-relaxed mb-3",children:e.contextualMessage}),o.jsxs("div",{className:"bg-gray-50 rounded-md p-3 mb-3",children:[o.jsx("p",{className:"text-xs font-medium text-gray-600 mb-2",children:"Examples:"}),o.jsx("div",{className:"space-y-1",children:a.map((i,l)=>o.jsx("div",{className:"text-xs text-gray-600 font-mono bg-white px-2 py-1 rounded border",children:i},l))})]}),n&&o.jsxs("button",{onClick:n,className:"w-full flex items-center justify-center gap-2 bg-orange-500 hover:bg-orange-600 text-white text-sm font-medium py-2.5 px-3 rounded-md transition-all duration-200 hover:shadow-md active:scale-95",children:[o.jsx(Xp,{className:"w-4 h-4 animate-pulse"}),"Press to continue"]})]}),o.jsx("button",{onClick:r,className:"flex-shrink-0 p-1 hover:bg-gray-100 rounded-md transition-colors","aria-label":"Close dialog",children:o.jsx(Zn,{className:"w-4 h-4 text-gray-400"})})]})]})})},eD=X.createContext(void 0),hK=({children:t})=>{const[e]=X.useState(zg.isSupported()),[r,n]=X.useState(!1),[s,a]=X.useState(!1),[i,l]=X.useState(!1),[c,u]=X.useState("idle"),[d,f]=X.useState(""),[m,h]=X.useState(null),[g,p]=X.useState(null),{user:v}=Xc(),{restaurant:b}=ya();X.useEffect(()=>{if(!e){Xr.error("Voice commands are not supported in this browser.");return}hi.setOnStateChange(re=>{u(re),a(hi.getIsListening()),l(hi.getIsContinuousMode())}),hi.setOnTranscriptChange(re=>{f(re)}),hi.setOnCommandDetected(async re=>{h(re),k(re)}),hi.setOnIncompleteCommand(re=>{p(re)}),w()},[]),X.useEffect(()=>{if(b!=null&&b.id){const re=Yo.getContext(b.id);re&&(console.log(" VoiceContext: Found stored context on restaurant load:",re),p(re))}},[b==null?void 0:b.id]),X.useEffect(()=>{console.log(" VoiceContext: Restaurant changed, updating voice service context:",b==null?void 0:b.slug),b?hi.setRestaurantContext({name:b.name,slug:b.slug,id:b.id}):hi.clearRestaurantContext()},[b]);const w=async()=>{try{const re=await navigator.permissions.query({name:"microphone"});n(re.state==="granted")}catch{console.log("Could not check microphone permission")}},N=async()=>{const re=await hi.requestPermission();return n(re),re},j=()=>{if(!r){Xr.error("Please grant microphone permission first.");return}hi.startListening()},F=()=>{if(!r){Xr.error("Please grant microphone permission first.");return}hi.startContinuousListening()},U=()=>{hi.stopListening()},A=()=>{hi.toggleListening()},S=()=>{p(null),b!=null&&b.id&&Yo.clearContext()},k=async re=>{try{if(g&&!re.isIncomplete){const C=await hi.mergeIncompleteCommand(g,re.originalText);if(C){p(null),u("executing"),console.log(" VoiceContext: Executing merged command:",C),await M(C);return}p(null)}u("executing"),console.log(" VoiceContext: Executing command:",re),await M(re)}catch(C){console.error("Error executing voice command:",C),Xr.error("Failed to execute command."),u("error"),setTimeout(()=>u("idle"),2e3)}},M=async re=>{switch(re.type){case"ORDER":await I(re);break;case"PLACE_ORDER":await E(re);break;case"PAYMENT":await D(re);break;case"KOT_PRINT":await G(re);break;case"ORDER_CANCEL":await Z(re);break;case"TABLE_MERGE":await ae(re);break;case"TABLE_TRANSFER":await de(re);break;case"TABLE_STATUS":await se(re);break;case"CUSTOMER":await Y(re);break;case"MENU_INQUIRY":await ye(re);break;default:Xr.error("Command not recognized. Please try again.")}u("idle")},I=async re=>{const{tableNumber:C,menuItems:O}=re;if(console.log(" VoiceContext: Executing order command:",{tableNumber:C,menuItems:O,hasUser:!!v}),!C||!O||O.length===0){Xr.error("Please specify table number and menu items.");return}const L=new CustomEvent("voiceOrderCommand",{detail:{command:re}});window.dispatchEvent(L),console.log(" VoiceContext: Dispatched voiceOrderCommand event")},E=async re=>{const{tableNumber:C,menuItems:O}=re;if(console.log(" VoiceContext: Executing place order command:",{tableNumber:C,menuItems:O,hasUser:!!v}),!C){Xr.error("Please specify table number for placing order.");return}if(O&&O.length>0){console.log(" VoiceContext: Place order has menu items, executing as order command");const L=new CustomEvent("voiceOrderCommand",{detail:{command:{...re,type:"ORDER"}}});window.dispatchEvent(L),console.log(" VoiceContext: Dispatched voiceOrderCommand event with menu items")}else{const L=new CustomEvent("voicePlaceOrderCommand",{detail:{command:re}});window.dispatchEvent(L),console.log(" VoiceContext: Dispatched voicePlaceOrderCommand event")}},D=async re=>{const{tableNumber:C,paymentMethod:O}=re;if(console.log(" VoiceContext: Executing payment command:",{tableNumber:C,paymentMethod:O,hasUser:!!v}),!C){Xr.error("Please specify table number for payment.");return}const L=new CustomEvent("voicePaymentCommand",{detail:{command:re}});window.dispatchEvent(L),console.log(" VoiceContext: Dispatched voicePaymentCommand event")},G=async re=>{const{tableNumber:C}=re;if(console.log(" VoiceContext: Executing KOT print command:",{tableNumber:C,hasUser:!!v}),!C){Xr.error("Please specify table number for KOT printing.");return}const O=new CustomEvent("voiceKotPrintCommand",{detail:{command:re}});window.dispatchEvent(O),console.log(" VoiceContext: Dispatched voiceKotPrintCommand event")},Z=async re=>{const{tableNumber:C}=re;if(console.log(" VoiceContext: Executing order cancel command:",{tableNumber:C,hasUser:!!v}),!C){Xr.error("Please specify table number for order cancellation.");return}const O=new CustomEvent("voiceOrderCancelCommand",{detail:{command:re}});window.dispatchEvent(O),console.log(" VoiceContext: Dispatched voiceOrderCancelCommand event")},ae=async re=>{const{tableNumber:C,targetTableNumber:O}=re;if(console.log(" VoiceContext: Executing table merge command:",{tableNumber:C,targetTableNumber:O,hasUser:!!v}),!C||!O){Xr.error("Please specify both source and target table numbers for merging.");return}const L=new CustomEvent("voiceTableMergeCommand",{detail:{command:re}});window.dispatchEvent(L),console.log(" VoiceContext: Dispatched voiceTableMergeCommand event")},de=async re=>{const{tableNumber:C,targetTableNumber:O}=re;if(console.log(" VoiceContext: Executing table transfer command:",{tableNumber:C,targetTableNumber:O,hasUser:!!v}),!C||!O){Xr.error("Please specify both source and target table numbers for transfer.");return}const L=new CustomEvent("voiceTableTransferCommand",{detail:{command:re}});window.dispatchEvent(L),console.log(" VoiceContext: Dispatched voiceTableTransferCommand event")},se=async re=>{const{tableNumber:C}=re;if(console.log(" VoiceContext: Executing table status command:",{tableNumber:C,hasUser:!!v}),!C){Xr.error("Please specify table number for status update.");return}const O=new CustomEvent("voiceTableStatusCommand",{detail:{command:re}});window.dispatchEvent(O),console.log(" VoiceContext: Dispatched voiceTableStatusCommand event")},Y=async re=>{const{customerName:C,customerPhone:O}=re;if(console.log(" VoiceContext: Executing customer command:",{customerName:C,customerPhone:O,hasUser:!!v}),!C&&!O){Xr.error("Please specify customer name or phone number.");return}const L=new CustomEvent("voiceCustomerCommand",{detail:{command:re}});window.dispatchEvent(L),console.log(" VoiceContext: Dispatched voiceCustomerCommand event")},ye=async re=>{console.log(" VoiceContext: Executing menu inquiry command:",{hasUser:!!v});const C=new CustomEvent("voiceMenuInquiryCommand",{detail:{command:re}});window.dispatchEvent(C),console.log(" VoiceContext: Dispatched voiceMenuInquiryCommand event")};return o.jsxs(eD.Provider,{value:{isSupported:e,hasPermission:r,isListening:s,isContinuousMode:i,state:c,transcript:d,lastCommand:m,incompleteCommandContext:g,requestPermission:N,startListening:j,startContinuousListening:F,stopListening:U,toggleListening:A,executeCommand:k,clearIncompleteCommand:S},children:[t,o.jsx(fK,{isVisible:!!g,context:g||void 0,onClose:S,onRetryVoice:j})]})},mK=()=>{const t=X.useContext(eD);if(t===void 0)throw new Error("useVoice must be used within a VoiceProvider");return t};var Mx=t=>t.type==="checkbox",jf=t=>t instanceof Date,Ya=t=>t==null;const tD=t=>typeof t=="object";var _s=t=>!Ya(t)&&!Array.isArray(t)&&tD(t)&&!jf(t),pK=t=>_s(t)&&t.target?Mx(t.target)?t.target.checked:t.target.value:t,gK=t=>t.substring(0,t.search(/\.\d+(\.|$)/))||t,xK=(t,e)=>t.has(gK(e)),yK=t=>{const e=t.constructor&&t.constructor.prototype;return _s(e)&&e.hasOwnProperty("isPrototypeOf")},SS=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function Ca(t){let e;const r=Array.isArray(t),n=typeof FileList<"u"?t instanceof FileList:!1;if(t instanceof Date)e=new Date(t);else if(t instanceof Set)e=new Set(t);else if(!(SS&&(t instanceof Blob||n))&&(r||_s(t)))if(e=r?[]:{},!r&&!yK(t))e=t;else for(const s in t)t.hasOwnProperty(s)&&(e[s]=Ca(t[s]));else return t;return e}var eb=t=>Array.isArray(t)?t.filter(Boolean):[],Ls=t=>t===void 0,sr=(t,e,r)=>{if(!e||!_s(t))return r;const n=eb(e.split(/[,[\].]+?/)).reduce((s,a)=>Ya(s)?s:s[a],t);return Ls(n)||n===t?Ls(t[e])?r:t[e]:n},El=t=>typeof t=="boolean",TS=t=>/^\w*$/.test(t),rD=t=>eb(t.replace(/["|']|\]/g,"").split(/\.|\[/)),Dn=(t,e,r)=>{let n=-1;const s=TS(e)?[e]:rD(e),a=s.length,i=a-1;for(;++n<a;){const l=s[n];let c=r;if(n!==i){const u=t[l];c=_s(u)||Array.isArray(u)?u:isNaN(+s[n+1])?{}:[]}if(l==="__proto__"||l==="constructor"||l==="prototype")return;t[l]=c,t=t[l]}};const oC={BLUR:"blur",FOCUS_OUT:"focusout"},Qo={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},hc={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"};mi.createContext(null);var vK=(t,e,r,n=!0)=>{const s={defaultValues:e._defaultValues};for(const a in t)Object.defineProperty(s,a,{get:()=>{const i=a;return e._proxyFormState[i]!==Qo.all&&(e._proxyFormState[i]=!n||Qo.all),t[i]}});return s};const bK=typeof window<"u"?X.useLayoutEffect:X.useEffect;var Rl=t=>typeof t=="string",wK=(t,e,r,n,s)=>Rl(t)?(n&&e.watch.add(t),sr(r,t,s)):Array.isArray(t)?t.map(a=>(n&&e.watch.add(a),sr(r,a))):(n&&(e.watchAll=!0),r),_K=(t,e,r,n,s)=>e?{...r[t],types:{...r[t]&&r[t].types?r[t].types:{},[n]:s||!0}}:{},Jp=t=>Array.isArray(t)?t:[t],lC=()=>{let t=[];return{get observers(){return t},next:s=>{for(const a of t)a.next&&a.next(s)},subscribe:s=>(t.push(s),{unsubscribe:()=>{t=t.filter(a=>a!==s)}}),unsubscribe:()=>{t=[]}}},V_=t=>Ya(t)||!tD(t);function Gu(t,e){if(V_(t)||V_(e))return t===e;if(jf(t)&&jf(e))return t.getTime()===e.getTime();const r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(const s of r){const a=t[s];if(!n.includes(s))return!1;if(s!=="ref"){const i=e[s];if(jf(a)&&jf(i)||_s(a)&&_s(i)||Array.isArray(a)&&Array.isArray(i)?!Gu(a,i):a!==i)return!1}}return!0}var pi=t=>_s(t)&&!Object.keys(t).length,AS=t=>t.type==="file",Jo=t=>typeof t=="function",$v=t=>{if(!SS)return!1;const e=t?t.ownerDocument:0;return t instanceof(e&&e.defaultView?e.defaultView.HTMLElement:HTMLElement)},nD=t=>t.type==="select-multiple",ES=t=>t.type==="radio",NK=t=>ES(t)||Mx(t),ww=t=>$v(t)&&t.isConnected;function SK(t,e){const r=e.slice(0,-1).length;let n=0;for(;n<r;)t=Ls(t)?n++:t[e[n++]];return t}function TK(t){for(const e in t)if(t.hasOwnProperty(e)&&!Ls(t[e]))return!1;return!0}function Bs(t,e){const r=Array.isArray(e)?e:TS(e)?[e]:rD(e),n=r.length===1?t:SK(t,r),s=r.length-1,a=r[s];return n&&delete n[a],s!==0&&(_s(n)&&pi(n)||Array.isArray(n)&&TK(n))&&Bs(t,r.slice(0,-1)),t}var sD=t=>{for(const e in t)if(Jo(t[e]))return!0;return!1};function zv(t,e={}){const r=Array.isArray(t);if(_s(t)||r)for(const n in t)Array.isArray(t[n])||_s(t[n])&&!sD(t[n])?(e[n]=Array.isArray(t[n])?[]:{},zv(t[n],e[n])):Ya(t[n])||(e[n]=!0);return e}function aD(t,e,r){const n=Array.isArray(t);if(_s(t)||n)for(const s in t)Array.isArray(t[s])||_s(t[s])&&!sD(t[s])?Ls(e)||V_(r[s])?r[s]=Array.isArray(t[s])?zv(t[s],[]):{...zv(t[s])}:aD(t[s],Ya(e)?{}:e[s],r[s]):r[s]=!Gu(t[s],e[s]);return r}var hp=(t,e)=>aD(t,e,zv(e));const cC={value:!1,isValid:!1},uC={value:!0,isValid:!0};var iD=t=>{if(Array.isArray(t)){if(t.length>1){const e=t.filter(r=>r&&r.checked&&!r.disabled).map(r=>r.value);return{value:e,isValid:!!e.length}}return t[0].checked&&!t[0].disabled?t[0].attributes&&!Ls(t[0].attributes.value)?Ls(t[0].value)||t[0].value===""?uC:{value:t[0].value,isValid:!0}:uC:cC}return cC},oD=(t,{valueAsNumber:e,valueAsDate:r,setValueAs:n})=>Ls(t)?t:e?t===""?NaN:t&&+t:r&&Rl(t)?new Date(t):n?n(t):t;const dC={isValid:!1,value:null};var lD=t=>Array.isArray(t)?t.reduce((e,r)=>r&&r.checked&&!r.disabled?{isValid:!0,value:r.value}:e,dC):dC;function fC(t){const e=t.ref;return AS(e)?e.files:ES(e)?lD(t.refs).value:nD(e)?[...e.selectedOptions].map(({value:r})=>r):Mx(e)?iD(t.refs).value:oD(Ls(e.value)?t.ref.value:e.value,t)}var AK=(t,e,r,n)=>{const s={};for(const a of t){const i=sr(e,a);i&&Dn(s,a,i._f)}return{criteriaMode:r,names:[...t],fields:s,shouldUseNativeValidation:n}},qv=t=>t instanceof RegExp,mp=t=>Ls(t)?t:qv(t)?t.source:_s(t)?qv(t.value)?t.value.source:t.value:t,hC=t=>({isOnSubmit:!t||t===Qo.onSubmit,isOnBlur:t===Qo.onBlur,isOnChange:t===Qo.onChange,isOnAll:t===Qo.all,isOnTouch:t===Qo.onTouched});const mC="AsyncFunction";var EK=t=>!!t&&!!t.validate&&!!(Jo(t.validate)&&t.validate.constructor.name===mC||_s(t.validate)&&Object.values(t.validate).find(e=>e.constructor.name===mC)),CK=t=>t.mount&&(t.required||t.min||t.max||t.maxLength||t.minLength||t.pattern||t.validate),pC=(t,e,r)=>!r&&(e.watchAll||e.watch.has(t)||[...e.watch].some(n=>t.startsWith(n)&&/^\.\w+/.test(t.slice(n.length))));const Zp=(t,e,r,n)=>{for(const s of r||Object.keys(t)){const a=sr(t,s);if(a){const{_f:i,...l}=a;if(i){if(i.refs&&i.refs[0]&&e(i.refs[0],s)&&!n)return!0;if(i.ref&&e(i.ref,i.name)&&!n)return!0;if(Zp(l,e))break}else if(_s(l)&&Zp(l,e))break}}};function gC(t,e,r){const n=sr(t,r);if(n||TS(r))return{error:n,name:r};const s=r.split(".");for(;s.length;){const a=s.join("."),i=sr(e,a),l=sr(t,a);if(i&&!Array.isArray(i)&&r!==a)return{name:r};if(l&&l.type)return{name:a,error:l};if(l&&l.root&&l.root.type)return{name:`${a}.root`,error:l.root};s.pop()}return{name:r}}var kK=(t,e,r,n)=>{r(t);const{name:s,...a}=t;return pi(a)||Object.keys(a).length>=Object.keys(e).length||Object.keys(a).find(i=>e[i]===(!n||Qo.all))},IK=(t,e,r)=>!t||!e||t===e||Jp(t).some(n=>n&&(r?n===e:n.startsWith(e)||e.startsWith(n))),jK=(t,e,r,n,s)=>s.isOnAll?!1:!r&&s.isOnTouch?!(e||t):(r?n.isOnBlur:s.isOnBlur)?!t:(r?n.isOnChange:s.isOnChange)?t:!0,PK=(t,e)=>!eb(sr(t,e)).length&&Bs(t,e),RK=(t,e,r)=>{const n=Jp(sr(t,r));return Dn(n,"root",e[r]),Dn(t,r,n),t},Ly=t=>Rl(t);function xC(t,e,r="validate"){if(Ly(t)||Array.isArray(t)&&t.every(Ly)||El(t)&&!t)return{type:r,message:Ly(t)?t:"",ref:e}}var Jh=t=>_s(t)&&!qv(t)?t:{value:t,message:""},yC=async(t,e,r,n,s,a)=>{const{ref:i,refs:l,required:c,maxLength:u,minLength:d,min:f,max:m,pattern:h,validate:g,name:p,valueAsNumber:v,mount:b}=t._f,w=sr(r,p);if(!b||e.has(p))return{};const N=l?l[0]:i,j=E=>{s&&N.reportValidity&&(N.setCustomValidity(El(E)?"":E||""),N.reportValidity())},F={},U=ES(i),A=Mx(i),S=U||A,k=(v||AS(i))&&Ls(i.value)&&Ls(w)||$v(i)&&i.value===""||w===""||Array.isArray(w)&&!w.length,M=_K.bind(null,p,n,F),I=(E,D,G,Z=hc.maxLength,ae=hc.minLength)=>{const de=E?D:G;F[p]={type:E?Z:ae,message:de,ref:i,...M(E?Z:ae,de)}};if(a?!Array.isArray(w)||!w.length:c&&(!S&&(k||Ya(w))||El(w)&&!w||A&&!iD(l).isValid||U&&!lD(l).isValid)){const{value:E,message:D}=Ly(c)?{value:!!c,message:c}:Jh(c);if(E&&(F[p]={type:hc.required,message:D,ref:N,...M(hc.required,D)},!n))return j(D),F}if(!k&&(!Ya(f)||!Ya(m))){let E,D;const G=Jh(m),Z=Jh(f);if(!Ya(w)&&!isNaN(w)){const ae=i.valueAsNumber||w&&+w;Ya(G.value)||(E=ae>G.value),Ya(Z.value)||(D=ae<Z.value)}else{const ae=i.valueAsDate||new Date(w),de=ye=>new Date(new Date().toDateString()+" "+ye),se=i.type=="time",Y=i.type=="week";Rl(G.value)&&w&&(E=se?de(w)>de(G.value):Y?w>G.value:ae>new Date(G.value)),Rl(Z.value)&&w&&(D=se?de(w)<de(Z.value):Y?w<Z.value:ae<new Date(Z.value))}if((E||D)&&(I(!!E,G.message,Z.message,hc.max,hc.min),!n))return j(F[p].message),F}if((u||d)&&!k&&(Rl(w)||a&&Array.isArray(w))){const E=Jh(u),D=Jh(d),G=!Ya(E.value)&&w.length>+E.value,Z=!Ya(D.value)&&w.length<+D.value;if((G||Z)&&(I(G,E.message,D.message),!n))return j(F[p].message),F}if(h&&!k&&Rl(w)){const{value:E,message:D}=Jh(h);if(qv(E)&&!w.match(E)&&(F[p]={type:hc.pattern,message:D,ref:i,...M(hc.pattern,D)},!n))return j(D),F}if(g){if(Jo(g)){const E=await g(w,r),D=xC(E,N);if(D&&(F[p]={...D,...M(hc.validate,D.message)},!n))return j(D.message),F}else if(_s(g)){let E={};for(const D in g){if(!pi(E)&&!n)break;const G=xC(await g[D](w,r),N,D);G&&(E={...G,...M(D,G.message)},j(G.message),n&&(F[p]=E))}if(!pi(E)&&(F[p]={ref:N,...E},!n))return F}}return j(!0),F};const DK={mode:Qo.onSubmit,reValidateMode:Qo.onChange,shouldFocusError:!0};function FK(t={}){let e={...DK,...t},r={submitCount:0,isDirty:!1,isReady:!1,isLoading:Jo(e.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1};const n={};let s=_s(e.defaultValues)||_s(e.values)?Ca(e.defaultValues||e.values)||{}:{},a=e.shouldUnregister?{}:Ca(s),i={action:!1,mount:!1,watch:!1},l={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},c,u=0;const d={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let f={...d};const m={array:lC(),state:lC()},h=e.criteriaMode===Qo.all,g=ue=>Ne=>{clearTimeout(u),u=setTimeout(ue,Ne)},p=async ue=>{if(!e.disabled&&(d.isValid||f.isValid||ue)){const Ne=e.resolver?pi((await A()).errors):await k(n,!0);Ne!==r.isValid&&m.state.next({isValid:Ne})}},v=(ue,Ne)=>{!e.disabled&&(d.isValidating||d.validatingFields||f.isValidating||f.validatingFields)&&((ue||Array.from(l.mount)).forEach(Ae=>{Ae&&(Ne?Dn(r.validatingFields,Ae,Ne):Bs(r.validatingFields,Ae))}),m.state.next({validatingFields:r.validatingFields,isValidating:!pi(r.validatingFields)}))},b=(ue,Ne=[],Ae,Be,Ue=!0,Ce=!0)=>{if(Be&&Ae&&!e.disabled){if(i.action=!0,Ce&&Array.isArray(sr(n,ue))){const Ye=Ae(sr(n,ue),Be.argA,Be.argB);Ue&&Dn(n,ue,Ye)}if(Ce&&Array.isArray(sr(r.errors,ue))){const Ye=Ae(sr(r.errors,ue),Be.argA,Be.argB);Ue&&Dn(r.errors,ue,Ye),PK(r.errors,ue)}if((d.touchedFields||f.touchedFields)&&Ce&&Array.isArray(sr(r.touchedFields,ue))){const Ye=Ae(sr(r.touchedFields,ue),Be.argA,Be.argB);Ue&&Dn(r.touchedFields,ue,Ye)}(d.dirtyFields||f.dirtyFields)&&(r.dirtyFields=hp(s,a)),m.state.next({name:ue,isDirty:I(ue,Ne),dirtyFields:r.dirtyFields,errors:r.errors,isValid:r.isValid})}else Dn(a,ue,Ne)},w=(ue,Ne)=>{Dn(r.errors,ue,Ne),m.state.next({errors:r.errors})},N=ue=>{r.errors=ue,m.state.next({errors:r.errors,isValid:!1})},j=(ue,Ne,Ae,Be)=>{const Ue=sr(n,ue);if(Ue){const Ce=sr(a,ue,Ls(Ae)?sr(s,ue):Ae);Ls(Ce)||Be&&Be.defaultChecked||Ne?Dn(a,ue,Ne?Ce:fC(Ue._f)):G(ue,Ce),i.mount&&p()}},F=(ue,Ne,Ae,Be,Ue)=>{let Ce=!1,Ye=!1;const It={name:ue};if(!e.disabled){if(!Ae||Be){(d.isDirty||f.isDirty)&&(Ye=r.isDirty,r.isDirty=It.isDirty=I(),Ce=Ye!==It.isDirty);const Dt=Gu(sr(s,ue),Ne);Ye=!!sr(r.dirtyFields,ue),Dt?Bs(r.dirtyFields,ue):Dn(r.dirtyFields,ue,!0),It.dirtyFields=r.dirtyFields,Ce=Ce||(d.dirtyFields||f.dirtyFields)&&Ye!==!Dt}if(Ae){const Dt=sr(r.touchedFields,ue);Dt||(Dn(r.touchedFields,ue,Ae),It.touchedFields=r.touchedFields,Ce=Ce||(d.touchedFields||f.touchedFields)&&Dt!==Ae)}Ce&&Ue&&m.state.next(It)}return Ce?It:{}},U=(ue,Ne,Ae,Be)=>{const Ue=sr(r.errors,ue),Ce=(d.isValid||f.isValid)&&El(Ne)&&r.isValid!==Ne;if(e.delayError&&Ae?(c=g(()=>w(ue,Ae)),c(e.delayError)):(clearTimeout(u),c=null,Ae?Dn(r.errors,ue,Ae):Bs(r.errors,ue)),(Ae?!Gu(Ue,Ae):Ue)||!pi(Be)||Ce){const Ye={...Be,...Ce&&El(Ne)?{isValid:Ne}:{},errors:r.errors,name:ue};r={...r,...Ye},m.state.next(Ye)}},A=async ue=>{v(ue,!0);const Ne=await e.resolver(a,e.context,AK(ue||l.mount,n,e.criteriaMode,e.shouldUseNativeValidation));return v(ue),Ne},S=async ue=>{const{errors:Ne}=await A(ue);if(ue)for(const Ae of ue){const Be=sr(Ne,Ae);Be?Dn(r.errors,Ae,Be):Bs(r.errors,Ae)}else r.errors=Ne;return Ne},k=async(ue,Ne,Ae={valid:!0})=>{for(const Be in ue){const Ue=ue[Be];if(Ue){const{_f:Ce,...Ye}=Ue;if(Ce){const It=l.array.has(Ce.name),Dt=Ue._f&&EK(Ue._f);Dt&&d.validatingFields&&v([Be],!0);const Ot=await yC(Ue,l.disabled,a,h,e.shouldUseNativeValidation&&!Ne,It);if(Dt&&d.validatingFields&&v([Be]),Ot[Ce.name]&&(Ae.valid=!1,Ne))break;!Ne&&(sr(Ot,Ce.name)?It?RK(r.errors,Ot,Ce.name):Dn(r.errors,Ce.name,Ot[Ce.name]):Bs(r.errors,Ce.name))}!pi(Ye)&&await k(Ye,Ne,Ae)}}return Ae.valid},M=()=>{for(const ue of l.unMount){const Ne=sr(n,ue);Ne&&(Ne._f.refs?Ne._f.refs.every(Ae=>!ww(Ae)):!ww(Ne._f.ref))&&q(ue)}l.unMount=new Set},I=(ue,Ne)=>!e.disabled&&(ue&&Ne&&Dn(a,ue,Ne),!Gu(ye(),s)),E=(ue,Ne,Ae)=>wK(ue,l,{...i.mount?a:Ls(Ne)?s:Rl(ue)?{[ue]:Ne}:Ne},Ae,Ne),D=ue=>eb(sr(i.mount?a:s,ue,e.shouldUnregister?sr(s,ue,[]):[])),G=(ue,Ne,Ae={})=>{const Be=sr(n,ue);let Ue=Ne;if(Be){const Ce=Be._f;Ce&&(!Ce.disabled&&Dn(a,ue,oD(Ne,Ce)),Ue=$v(Ce.ref)&&Ya(Ne)?"":Ne,nD(Ce.ref)?[...Ce.ref.options].forEach(Ye=>Ye.selected=Ue.includes(Ye.value)):Ce.refs?Mx(Ce.ref)?Ce.refs.forEach(Ye=>{(!Ye.defaultChecked||!Ye.disabled)&&(Array.isArray(Ue)?Ye.checked=!!Ue.find(It=>It===Ye.value):Ye.checked=Ue===Ye.value||!!Ue)}):Ce.refs.forEach(Ye=>Ye.checked=Ye.value===Ue):AS(Ce.ref)?Ce.ref.value="":(Ce.ref.value=Ue,Ce.ref.type||m.state.next({name:ue,values:Ca(a)})))}(Ae.shouldDirty||Ae.shouldTouch)&&F(ue,Ue,Ae.shouldTouch,Ae.shouldDirty,!0),Ae.shouldValidate&&Y(ue)},Z=(ue,Ne,Ae)=>{for(const Be in Ne){if(!Ne.hasOwnProperty(Be))return;const Ue=Ne[Be],Ce=ue+"."+Be,Ye=sr(n,Ce);(l.array.has(ue)||_s(Ue)||Ye&&!Ye._f)&&!jf(Ue)?Z(Ce,Ue,Ae):G(Ce,Ue,Ae)}},ae=(ue,Ne,Ae={})=>{const Be=sr(n,ue),Ue=l.array.has(ue),Ce=Ca(Ne);Dn(a,ue,Ce),Ue?(m.array.next({name:ue,values:Ca(a)}),(d.isDirty||d.dirtyFields||f.isDirty||f.dirtyFields)&&Ae.shouldDirty&&m.state.next({name:ue,dirtyFields:hp(s,a),isDirty:I(ue,Ce)})):Be&&!Be._f&&!Ya(Ce)?Z(ue,Ce,Ae):G(ue,Ce,Ae),pC(ue,l)&&m.state.next({...r}),m.state.next({name:i.mount?ue:void 0,values:Ca(a)})},de=async ue=>{i.mount=!0;const Ne=ue.target;let Ae=Ne.name,Be=!0;const Ue=sr(n,Ae),Ce=Dt=>{Be=Number.isNaN(Dt)||jf(Dt)&&isNaN(Dt.getTime())||Gu(Dt,sr(a,Ae,Dt))},Ye=hC(e.mode),It=hC(e.reValidateMode);if(Ue){let Dt,Ot;const Pt=Ne.type?fC(Ue._f):pK(ue),ht=ue.type===oC.BLUR||ue.type===oC.FOCUS_OUT,or=!CK(Ue._f)&&!e.resolver&&!sr(r.errors,Ae)&&!Ue._f.deps||jK(ht,sr(r.touchedFields,Ae),r.isSubmitted,It,Ye),Ve=pC(Ae,l,ht);Dn(a,Ae,Pt),ht?(Ue._f.onBlur&&Ue._f.onBlur(ue),c&&c(0)):Ue._f.onChange&&Ue._f.onChange(ue);const tt=F(Ae,Pt,ht),nt=!pi(tt)||Ve;if(!ht&&m.state.next({name:Ae,type:ue.type,values:Ca(a)}),or)return(d.isValid||f.isValid)&&(e.mode==="onBlur"?ht&&p():ht||p()),nt&&m.state.next({name:Ae,...Ve?{}:tt});if(!ht&&Ve&&m.state.next({...r}),e.resolver){const{errors:At}=await A([Ae]);if(Ce(Pt),Be){const mr=gC(r.errors,n,Ae),Wt=gC(At,n,mr.name||Ae);Dt=Wt.error,Ae=Wt.name,Ot=pi(At)}}else v([Ae],!0),Dt=(await yC(Ue,l.disabled,a,h,e.shouldUseNativeValidation))[Ae],v([Ae]),Ce(Pt),Be&&(Dt?Ot=!1:(d.isValid||f.isValid)&&(Ot=await k(n,!0)));Be&&(Ue._f.deps&&Y(Ue._f.deps),U(Ae,Ot,Dt,tt))}},se=(ue,Ne)=>{if(sr(r.errors,Ne)&&ue.focus)return ue.focus(),1},Y=async(ue,Ne={})=>{let Ae,Be;const Ue=Jp(ue);if(e.resolver){const Ce=await S(Ls(ue)?ue:Ue);Ae=pi(Ce),Be=ue?!Ue.some(Ye=>sr(Ce,Ye)):Ae}else ue?(Be=(await Promise.all(Ue.map(async Ce=>{const Ye=sr(n,Ce);return await k(Ye&&Ye._f?{[Ce]:Ye}:Ye)}))).every(Boolean),!(!Be&&!r.isValid)&&p()):Be=Ae=await k(n);return m.state.next({...!Rl(ue)||(d.isValid||f.isValid)&&Ae!==r.isValid?{}:{name:ue},...e.resolver||!ue?{isValid:Ae}:{},errors:r.errors}),Ne.shouldFocus&&!Be&&Zp(n,se,ue?Ue:l.mount),Be},ye=ue=>{const Ne={...i.mount?a:s};return Ls(ue)?Ne:Rl(ue)?sr(Ne,ue):ue.map(Ae=>sr(Ne,Ae))},re=(ue,Ne)=>({invalid:!!sr((Ne||r).errors,ue),isDirty:!!sr((Ne||r).dirtyFields,ue),error:sr((Ne||r).errors,ue),isValidating:!!sr(r.validatingFields,ue),isTouched:!!sr((Ne||r).touchedFields,ue)}),C=ue=>{ue&&Jp(ue).forEach(Ne=>Bs(r.errors,Ne)),m.state.next({errors:ue?r.errors:{}})},O=(ue,Ne,Ae)=>{const Be=(sr(n,ue,{_f:{}})._f||{}).ref,Ue=sr(r.errors,ue)||{},{ref:Ce,message:Ye,type:It,...Dt}=Ue;Dn(r.errors,ue,{...Dt,...Ne,ref:Be}),m.state.next({name:ue,errors:r.errors,isValid:!1}),Ae&&Ae.shouldFocus&&Be&&Be.focus&&Be.focus()},L=(ue,Ne)=>Jo(ue)?m.state.subscribe({next:Ae=>ue(E(void 0,Ne),Ae)}):E(ue,Ne,!0),H=ue=>m.state.subscribe({next:Ne=>{IK(ue.name,Ne.name,ue.exact)&&kK(Ne,ue.formState||d,qe,ue.reRenderRoot)&&ue.callback({values:{...a},...r,...Ne})}}).unsubscribe,K=ue=>(i.mount=!0,f={...f,...ue.formState},H({...ue,formState:f})),q=(ue,Ne={})=>{for(const Ae of ue?Jp(ue):l.mount)l.mount.delete(Ae),l.array.delete(Ae),Ne.keepValue||(Bs(n,Ae),Bs(a,Ae)),!Ne.keepError&&Bs(r.errors,Ae),!Ne.keepDirty&&Bs(r.dirtyFields,Ae),!Ne.keepTouched&&Bs(r.touchedFields,Ae),!Ne.keepIsValidating&&Bs(r.validatingFields,Ae),!e.shouldUnregister&&!Ne.keepDefaultValue&&Bs(s,Ae);m.state.next({values:Ca(a)}),m.state.next({...r,...Ne.keepDirty?{isDirty:I()}:{}}),!Ne.keepIsValid&&p()},te=({disabled:ue,name:Ne})=>{(El(ue)&&i.mount||ue||l.disabled.has(Ne))&&(ue?l.disabled.add(Ne):l.disabled.delete(Ne))},oe=(ue,Ne={})=>{let Ae=sr(n,ue);const Be=El(Ne.disabled)||El(e.disabled);return Dn(n,ue,{...Ae||{},_f:{...Ae&&Ae._f?Ae._f:{ref:{name:ue}},name:ue,mount:!0,...Ne}}),l.mount.add(ue),Ae?te({disabled:El(Ne.disabled)?Ne.disabled:e.disabled,name:ue}):j(ue,!0,Ne.value),{...Be?{disabled:Ne.disabled||e.disabled}:{},...e.progressive?{required:!!Ne.required,min:mp(Ne.min),max:mp(Ne.max),minLength:mp(Ne.minLength),maxLength:mp(Ne.maxLength),pattern:mp(Ne.pattern)}:{},name:ue,onChange:de,onBlur:de,ref:Ue=>{if(Ue){oe(ue,Ne),Ae=sr(n,ue);const Ce=Ls(Ue.value)&&Ue.querySelectorAll&&Ue.querySelectorAll("input,select,textarea")[0]||Ue,Ye=NK(Ce),It=Ae._f.refs||[];if(Ye?It.find(Dt=>Dt===Ce):Ce===Ae._f.ref)return;Dn(n,ue,{_f:{...Ae._f,...Ye?{refs:[...It.filter(ww),Ce,...Array.isArray(sr(s,ue))?[{}]:[]],ref:{type:Ce.type,name:ue}}:{ref:Ce}}}),j(ue,!1,void 0,Ce)}else Ae=sr(n,ue,{}),Ae._f&&(Ae._f.mount=!1),(e.shouldUnregister||Ne.shouldUnregister)&&!(xK(l.array,ue)&&i.action)&&l.unMount.add(ue)}}},V=()=>e.shouldFocusError&&Zp(n,se,l.mount),xe=ue=>{El(ue)&&(m.state.next({disabled:ue}),Zp(n,(Ne,Ae)=>{const Be=sr(n,Ae);Be&&(Ne.disabled=Be._f.disabled||ue,Array.isArray(Be._f.refs)&&Be._f.refs.forEach(Ue=>{Ue.disabled=Be._f.disabled||ue}))},0,!1))},B=(ue,Ne)=>async Ae=>{let Be;Ae&&(Ae.preventDefault&&Ae.preventDefault(),Ae.persist&&Ae.persist());let Ue=Ca(a);if(m.state.next({isSubmitting:!0}),e.resolver){const{errors:Ce,values:Ye}=await A();r.errors=Ce,Ue=Ye}else await k(n);if(l.disabled.size)for(const Ce of l.disabled)Dn(Ue,Ce,void 0);if(Bs(r.errors,"root"),pi(r.errors)){m.state.next({errors:{}});try{await ue(Ue,Ae)}catch(Ce){Be=Ce}}else Ne&&await Ne({...r.errors},Ae),V(),setTimeout(V);if(m.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:pi(r.errors)&&!Be,submitCount:r.submitCount+1,errors:r.errors}),Be)throw Be},Ee=(ue,Ne={})=>{sr(n,ue)&&(Ls(Ne.defaultValue)?ae(ue,Ca(sr(s,ue))):(ae(ue,Ne.defaultValue),Dn(s,ue,Ca(Ne.defaultValue))),Ne.keepTouched||Bs(r.touchedFields,ue),Ne.keepDirty||(Bs(r.dirtyFields,ue),r.isDirty=Ne.defaultValue?I(ue,Ca(sr(s,ue))):I()),Ne.keepError||(Bs(r.errors,ue),d.isValid&&p()),m.state.next({...r}))},Me=(ue,Ne={})=>{const Ae=ue?Ca(ue):s,Be=Ca(Ae),Ue=pi(ue),Ce=Ue?s:Be;if(Ne.keepDefaultValues||(s=Ae),!Ne.keepValues){if(Ne.keepDirtyValues){const Ye=new Set([...l.mount,...Object.keys(hp(s,a))]);for(const It of Array.from(Ye))sr(r.dirtyFields,It)?Dn(Ce,It,sr(a,It)):ae(It,sr(Ce,It))}else{if(SS&&Ls(ue))for(const Ye of l.mount){const It=sr(n,Ye);if(It&&It._f){const Dt=Array.isArray(It._f.refs)?It._f.refs[0]:It._f.ref;if($v(Dt)){const Ot=Dt.closest("form");if(Ot){Ot.reset();break}}}}for(const Ye of l.mount)ae(Ye,sr(Ce,Ye))}a=Ca(Ce),m.array.next({values:{...Ce}}),m.state.next({values:{...Ce}})}l={mount:Ne.keepDirtyValues?l.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},i.mount=!d.isValid||!!Ne.keepIsValid||!!Ne.keepDirtyValues,i.watch=!!e.shouldUnregister,m.state.next({submitCount:Ne.keepSubmitCount?r.submitCount:0,isDirty:Ue?!1:Ne.keepDirty?r.isDirty:!!(Ne.keepDefaultValues&&!Gu(ue,s)),isSubmitted:Ne.keepIsSubmitted?r.isSubmitted:!1,dirtyFields:Ue?{}:Ne.keepDirtyValues?Ne.keepDefaultValues&&a?hp(s,a):r.dirtyFields:Ne.keepDefaultValues&&ue?hp(s,ue):Ne.keepDirty?r.dirtyFields:{},touchedFields:Ne.keepTouched?r.touchedFields:{},errors:Ne.keepErrors?r.errors:{},isSubmitSuccessful:Ne.keepIsSubmitSuccessful?r.isSubmitSuccessful:!1,isSubmitting:!1})},Ie=(ue,Ne)=>Me(Jo(ue)?ue(a):ue,Ne),he=(ue,Ne={})=>{const Ae=sr(n,ue),Be=Ae&&Ae._f;if(Be){const Ue=Be.refs?Be.refs[0]:Be.ref;Ue.focus&&(Ue.focus(),Ne.shouldSelect&&Jo(Ue.select)&&Ue.select())}},qe=ue=>{r={...r,...ue}},lt={control:{register:oe,unregister:q,getFieldState:re,handleSubmit:B,setError:O,_subscribe:H,_runSchema:A,_focusError:V,_getWatch:E,_getDirty:I,_setValid:p,_setFieldArray:b,_setDisabledField:te,_setErrors:N,_getFieldArray:D,_reset:Me,_resetDefaultValues:()=>Jo(e.defaultValues)&&e.defaultValues().then(ue=>{Ie(ue,e.resetOptions),m.state.next({isLoading:!1})}),_removeUnmounted:M,_disableForm:xe,_subjects:m,_proxyFormState:d,get _fields(){return n},get _formValues(){return a},get _state(){return i},set _state(ue){i=ue},get _defaultValues(){return s},get _names(){return l},set _names(ue){l=ue},get _formState(){return r},get _options(){return e},set _options(ue){e={...e,...ue}}},subscribe:K,trigger:Y,register:oe,handleSubmit:B,watch:L,setValue:ae,getValues:ye,reset:Ie,resetField:Ee,clearErrors:C,unregister:q,setError:O,setFocus:he,getFieldState:re};return{...lt,formControl:lt}}function Hn(t={}){const e=mi.useRef(void 0),r=mi.useRef(void 0),[n,s]=mi.useState({isDirty:!1,isValidating:!1,isLoading:Jo(t.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:t.errors||{},disabled:t.disabled||!1,isReady:!1,defaultValues:Jo(t.defaultValues)?void 0:t.defaultValues});e.current||(e.current={...t.formControl?t.formControl:FK(t),formState:n},t.formControl&&t.defaultValues&&!Jo(t.defaultValues)&&t.formControl.reset(t.defaultValues,t.resetOptions));const a=e.current.control;return a._options=t,bK(()=>{const i=a._subscribe({formState:a._proxyFormState,callback:()=>s({...a._formState}),reRenderRoot:!0});return s(l=>({...l,isReady:!0})),a._formState.isReady=!0,i},[a]),mi.useEffect(()=>a._disableForm(t.disabled),[a,t.disabled]),mi.useEffect(()=>{t.mode&&(a._options.mode=t.mode),t.reValidateMode&&(a._options.reValidateMode=t.reValidateMode)},[a,t.mode,t.reValidateMode]),mi.useEffect(()=>{t.errors&&(a._setErrors(t.errors),a._focusError())},[a,t.errors]),mi.useEffect(()=>{t.shouldUnregister&&a._subjects.state.next({values:a._getWatch()})},[a,t.shouldUnregister]),mi.useEffect(()=>{if(a._proxyFormState.isDirty){const i=a._getDirty();i!==n.isDirty&&a._subjects.state.next({isDirty:i})}},[a,n.isDirty]),mi.useEffect(()=>{t.values&&!Gu(t.values,r.current)?(a._reset(t.values,a._options.resetOptions),r.current=t.values,s(i=>({...i}))):a._resetDefaultValues()},[a,t.values]),mi.useEffect(()=>{a._state.mount||(a._setValid(),a._state.mount=!0),a._state.watch&&(a._state.watch=!1,a._subjects.state.next({...a._formState})),a._removeUnmounted()}),e.current.formState=vK(n,a),e.current}class cD{static async loginAdmin(e,r){try{const s=(await n_($n,e,r)).user;return s!=null&&s.email?await this.verifySuperAdmin(s.email)?(await this.logAdminActivity(s.uid,"login",{email:s.email,timestamp:new Date().toISOString()}),{success:!0,user:{uid:s.uid,email:s.email,role:"super_admin"}}):(await $n.signOut(),{success:!1,error:"Insufficient privileges"}):{success:!1,error:"Authentication failed"}}catch(n){return{success:!1,error:Zt(n)}}}static async verifySuperAdmin(e){var r;try{const n=await Gr(Rt(Ke,"superAdmins",e));return n.exists()&&((r=n.data())==null?void 0:r.active)===!0}catch{return!1}}static async getAllRestaurants(){var e,r;try{const n=hr(Ke,"restaurants"),s=await Tr(n),a=[];for(const i of s.docs){const l=i.data();let c="Unknown";if(l.ownerId)try{const u=await Gr(Rt(Ke,"users",l.ownerId));if(u.exists()){const d=u.data();c=d.name||d.email||"Unknown"}}catch{}a.push({id:i.id,name:l.name||"Unnamed Restaurant",slug:l.slug||"",businessType:l.businessType||"restaurant",status:l.status||"inactive",ownerId:l.ownerId||"",ownerName:c,createdAt:((e=l.createdAt)==null?void 0:e.toDate())||new Date,lastActivity:((r=l.lastActivity)==null?void 0:r.toDate())||new Date,settings:l.settings||{},stats:{totalOrders:0,totalRevenue:0,activeUsers:0}})}return a.sort((i,l)=>l.createdAt.getTime()-i.createdAt.getTime()),a}catch(n){throw new Error(Zt(n))}}static async updateRestaurantStatus(e,r){try{const n=Rt(Ke,"restaurants",e);await nn(n,{status:r,lastActivity:Mi()}),$n.currentUser&&await this.logAdminActivity($n.currentUser.uid,"restaurant_status_update",{restaurantId:e,newStatus:r,timestamp:new Date().toISOString()})}catch(n){throw new Error(Zt(n))}}static async deleteRestaurant(e){try{const r=Rt(Ke,"restaurants",e);await nn(r,{status:"deleted",deletedAt:Mi(),lastActivity:Mi()}),$n.currentUser&&await this.logAdminActivity($n.currentUser.uid,"restaurant_delete",{restaurantId:e,timestamp:new Date().toISOString()})}catch(r){throw new Error(Zt(r))}}static async getDashboardStats(){try{const e=await this.getAllRestaurants();return{totalRestaurants:e.length,activeRestaurants:e.filter(n=>n.status==="active").length,inactiveRestaurants:e.filter(n=>n.status==="inactive").length,businessTypes:{restaurants:e.filter(n=>n.businessType==="restaurant").length,cafes:e.filter(n=>n.businessType==="cafe").length,bars:e.filter(n=>n.businessType==="bar").length},totalRevenue:e.reduce((n,s)=>{var a;return n+(((a=s.stats)==null?void 0:a.totalRevenue)||0)},0),totalOrders:e.reduce((n,s)=>{var a;return n+(((a=s.stats)==null?void 0:a.totalOrders)||0)},0)}}catch(e){throw new Error(Zt(e))}}static async logAdminActivity(e,r,n){try{await sh(hr(Ke,"adminLogs"),{adminId:e,action:r,details:n,timestamp:Mi(),ipAddress:"unknown"})}catch{}}static async logoutAdmin(){try{$n.currentUser&&await this.logAdminActivity($n.currentUser.uid,"logout",{timestamp:new Date().toISOString()}),await $n.signOut()}catch(e){throw new Error(Zt(e))}}}function LK(){const t=Wl(),[e,r]=X.useState(!1),[n,s]=X.useState(!1),{register:a,handleSubmit:i,formState:{errors:l,isValid:c}}=Hn({mode:"onChange"}),u=async d=>{try{s(!0);const f=await cD.loginAdmin(d.email,d.password);f.success?(fe.success("Welcome back, Super Admin!"),t("/admin/dashboard")):fe.error(f.error||"Invalid admin credentials")}catch(f){console.error("Admin login error:",f),fe.error("Login failed. Please try again.")}finally{s(!1)}};return o.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 flex items-center justify-center p-4",children:[o.jsx("div",{className:"absolute inset-0 bg-grid-white/[0.02] bg-[size:60px_60px]"}),o.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-500/10 via-purple-500/10 to-cyan-500/10"}),o.jsxs("div",{className:"relative w-full max-w-md",children:[o.jsxs("div",{className:"text-center mb-8",children:[o.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-r from-blue-600 to-purple-600 rounded-2xl mb-6 shadow-lg",children:o.jsx(F_,{className:"w-8 h-8 text-white"})}),o.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Admin Portal"}),o.jsx("p",{className:"text-slate-400",children:"TenVerse POS Management System"})]}),o.jsxs("div",{className:"bg-white/10 backdrop-blur-md rounded-2xl border border-white/20 p-8 shadow-2xl",children:[o.jsxs("form",{onSubmit:i(u),className:"space-y-6",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"block text-sm font-medium text-white",children:"Admin Email"}),o.jsxs("div",{className:"relative",children:[o.jsx(kc,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-slate-400"}),o.jsx("input",{...a("email",{required:"Email is required",pattern:{value:/^[^\s@]+@[^\s@]+\.[^\s@]+$/,message:"Please enter a valid email address"}}),type:"email",className:`w-full pl-10 pr-4 py-3 bg-white/10 border border-white/20 rounded-xl text-white placeholder-slate-400 focus:border-blue-400 focus:ring-2 focus:ring-blue-400/20 transition-all ${l.email?"border-red-400":""}`,placeholder:"admin@tenversepos.com"})]}),l.email&&o.jsx("p",{className:"text-red-400 text-sm",children:l.email.message})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"block text-sm font-medium text-white",children:"Password"}),o.jsxs("div",{className:"relative",children:[o.jsx(QR,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-slate-400"}),o.jsx("input",{...a("password",{required:"Password is required"}),type:e?"text":"password",className:`w-full pl-10 pr-12 py-3 bg-white/10 border border-white/20 rounded-xl text-white placeholder-slate-400 focus:border-blue-400 focus:ring-2 focus:ring-blue-400/20 transition-all ${l.password?"border-red-400":""}`,placeholder:"Enter admin password"}),o.jsx("button",{type:"button",onClick:()=>r(!e),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-slate-400 hover:text-white transition-colors",children:e?o.jsx(zc,{className:"w-5 h-5"}):o.jsx(Ci,{className:"w-5 h-5"})})]}),l.password&&o.jsx("p",{className:"text-red-400 text-sm",children:l.password.message})]}),o.jsx("button",{type:"submit",disabled:!c||n,className:"w-full bg-gradient-to-r from-blue-600 to-purple-600 text-white py-3 px-4 rounded-xl font-semibold hover:from-blue-700 hover:to-purple-700 focus:ring-2 focus:ring-blue-400/20 disabled:opacity-50 disabled:cursor-not-allowed transition-all transform hover:scale-105 shadow-lg",children:n?o.jsxs(o.Fragment,{children:[o.jsx(Ed,{className:"w-5 h-5 mr-2 animate-spin inline"}),"Signing In..."]}):o.jsxs(o.Fragment,{children:[o.jsx(F_,{className:"w-5 h-5 mr-2 inline"}),"Sign In as Admin"]})})]}),o.jsx("div",{className:"mt-6 p-4 bg-blue-500/10 border border-blue-400/20 rounded-xl",children:o.jsxs("div",{className:"flex items-start space-x-3",children:[o.jsx(Vv,{className:"w-5 h-5 text-blue-400 flex-shrink-0 mt-0.5"}),o.jsxs("div",{children:[o.jsx("h4",{className:"text-blue-400 font-medium text-sm",children:"Admin Access"}),o.jsx("p",{className:"text-slate-300 text-xs mt-1",children:"Only authorized administrators can access this portal to manage restaurant POS systems."})]})]})})]}),o.jsx("div",{className:"text-center mt-8",children:o.jsx("p",{className:"text-slate-500 text-sm",children:" 2024 TenVerse POS - Enterprise Management System"})})]})]})}function OK(){const[t,e]=X.useState([]),[r,n]=X.useState(!0),[s,a]=X.useState(!1),[i,l]=X.useState(""),[c,u]=X.useState("all"),[d,f]=X.useState(null),{register:m,handleSubmit:h,reset:g,formState:{errors:p,isValid:v}}=Hn({mode:"onChange"});X.useEffect(()=>{b()},[]);const b=async()=>{try{console.log(" Loading restaurants for admin dashboard...");const S=await To.getAllRestaurantsForAdmin();console.log(" Load restaurants result:",S),S.success&&S.data?(console.log(" Successfully loaded restaurants:",S.data.length),e(S.data)):(console.error(" Failed to load restaurants:",S.error),fe.error(S.error||"Failed to load restaurants"))}catch(S){console.error(" Exception loading restaurants:",S),fe.error("Failed to load restaurants")}finally{n(!1)}},w=async S=>{try{const k=await To.createRestaurantByAdmin(S);k.success&&k.data?(fe.success("Restaurant created successfully!"),f(k.data),a(!1),g(),b()):fe.error(k.error||"Failed to create restaurant")}catch{fe.error("Failed to create restaurant")}},N=async S=>{try{const k=await To.toggleRestaurantStatus(S.id,!S.isActive);k.success?(fe.success(`Restaurant ${S.isActive?"deactivated":"activated"}`),b()):fe.error(k.error||"Failed to update restaurant")}catch{fe.error("Failed to update restaurant")}},j=async()=>{try{await cD.logoutAdmin(),window.location.href="/admin/login"}catch{fe.error("Logout failed")}},F=S=>{navigator.clipboard.writeText(S),fe.success("Copied to clipboard!")},U=t.filter(S=>{const k=S.name.toLowerCase().includes(i.toLowerCase())||S.slug.toLowerCase().includes(i.toLowerCase()),M=c==="all"||S.businessType===c;return k&&M}),A={total:t.length,active:t.filter(S=>S.isActive).length,inactive:t.filter(S=>!S.isActive).length,restaurants:t.filter(S=>S.businessType==="restaurant").length,cafes:t.filter(S=>S.businessType==="cafe").length,bars:t.filter(S=>S.businessType==="bar").length};return o.jsxs("div",{className:"min-h-screen bg-gray-50",children:[o.jsx("header",{className:"bg-white border-b border-gray-200 shadow-sm",children:o.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:o.jsxs("div",{className:"flex items-center justify-between h-16",children:[o.jsx("div",{className:"flex items-center space-x-4",children:o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-600 to-purple-600 rounded-xl flex items-center justify-center",children:o.jsx(F_,{className:"w-6 h-6 text-white"})}),o.jsxs("div",{children:[o.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Admin Dashboard"}),o.jsx("p",{className:"text-sm text-gray-500",children:"TenVerse POS Management"})]})]})}),o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsxs("button",{onClick:()=>a(!0),className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white px-4 py-2 rounded-lg font-medium hover:from-blue-700 hover:to-purple-700 transition-all transform hover:scale-105 shadow-lg",children:[o.jsx(Wn,{className:"w-4 h-4 mr-2 inline"}),"New Restaurant"]}),o.jsx("button",{onClick:j,className:"text-gray-600 hover:text-gray-900 p-2 rounded-lg hover:bg-gray-100 transition-colors",children:o.jsx(D_,{className:"w-5 h-5"})})]})]})})}),o.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[o.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Restaurants"}),o.jsx("p",{className:"text-3xl font-bold text-gray-900",children:A.total})]}),o.jsx(Vv,{className:"w-8 h-8 text-blue-600"})]})}),o.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Active"}),o.jsx("p",{className:"text-3xl font-bold text-green-600",children:A.active})]}),o.jsx(Ai,{className:"w-8 h-8 text-green-600"})]})}),o.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Inactive"}),o.jsx("p",{className:"text-3xl font-bold text-red-600",children:A.inactive})]}),o.jsx($c,{className:"w-8 h-8 text-red-600"})]})}),o.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Business Types"}),o.jsxs("p",{className:"text-xl font-bold text-gray-900",children:[A.restaurants,"R  ",A.cafes,"C  ",A.bars,"B"]})]}),o.jsx(_i,{className:"w-8 h-8 text-purple-600"})]})})]}),o.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6",children:o.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[o.jsxs("div",{className:"relative flex-1",children:[o.jsx(Eo,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),o.jsx("input",{type:"text",placeholder:"Search restaurants...",value:i,onChange:S=>l(S.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),o.jsxs("select",{value:c,onChange:S=>u(S.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[o.jsx("option",{value:"all",children:"All Types"}),o.jsx("option",{value:"restaurant",children:"Restaurants"}),o.jsx("option",{value:"cafe",children:"Cafs"}),o.jsx("option",{value:"bar",children:"Bars"})]})]})}),o.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:r?o.jsxs("div",{className:"p-8 text-center",children:[o.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),o.jsx("p",{className:"mt-2 text-gray-600",children:"Loading restaurants..."})]}):U.length===0?o.jsxs("div",{className:"p-8 text-center",children:[o.jsx(Vv,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),o.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No restaurants found"}),o.jsx("p",{className:"text-gray-600",children:i||c!=="all"?"Try adjusting your search or filter criteria.":"Create your first restaurant to get started."})]}):o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full",children:[o.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Restaurant"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:U.map(S=>o.jsxs("tr",{className:"hover:bg-gray-50",children:[o.jsx("td",{className:"px-6 py-4",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center mr-3 ${S.businessType==="restaurant"?"bg-green-100":S.businessType==="cafe"?"bg-yellow-100":"bg-purple-100"}`,children:o.jsx(Cc,{className:`w-5 h-5 ${S.businessType==="restaurant"?"text-green-600":S.businessType==="cafe"?"text-yellow-600":"text-purple-600"}`})}),o.jsxs("div",{children:[o.jsx("div",{className:"text-sm font-medium text-gray-900",children:S.name}),o.jsxs("div",{className:"text-sm text-gray-500",children:["/",S.slug]})]})]})}),o.jsx("td",{className:"px-6 py-4",children:o.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${S.businessType==="restaurant"?"bg-green-100 text-green-800":S.businessType==="cafe"?"bg-yellow-100 text-yellow-800":"bg-purple-100 text-purple-800"}`,children:Mv(S.businessType)})}),o.jsx("td",{className:"px-6 py-4",children:o.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${S.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:S.isActive?"Active":"Inactive"})}),o.jsx("td",{className:"px-6 py-4 text-sm text-gray-500",children:Fs(S.createdAt)}),o.jsx("td",{className:"px-6 py-4",children:o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("button",{onClick:()=>window.open(`/${S.slug}`,"_blank"),className:"text-blue-600 hover:text-blue-900 p-1 rounded hover:bg-blue-50",title:"View Restaurant",children:o.jsx(Q2,{className:"w-4 h-4"})}),o.jsx("button",{onClick:()=>F(`${window.location.origin}/${S.slug}`),className:"text-gray-600 hover:text-gray-900 p-1 rounded hover:bg-gray-50",title:"Copy URL",children:o.jsx(Hu,{className:"w-4 h-4"})}),o.jsx("button",{onClick:()=>N(S),className:`p-1 rounded hover:bg-gray-50 ${S.isActive?"text-red-600 hover:text-red-900":"text-green-600 hover:text-green-900"}`,title:S.isActive?"Deactivate":"Activate",children:S.isActive?o.jsx(iK,{className:"w-4 h-4"}):o.jsx(oK,{className:"w-4 h-4"})})]})})]},S.id))})]})})})]}),s&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:o.jsxs("div",{className:"bg-white rounded-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[o.jsxs("div",{className:"p-6 border-b border-gray-200",children:[o.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Create New Restaurant"}),o.jsx("p",{className:"text-gray-600",children:"Set up a new POS system for a restaurant"})]}),o.jsxs("form",{onSubmit:h(w),className:"p-6 space-y-6",children:[o.jsxs("div",{className:"space-y-3",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Business Type"}),o.jsx("div",{className:"grid grid-cols-3 gap-3",children:["restaurant","cafe","bar"].map(S=>o.jsxs("label",{className:"relative",children:[o.jsx("input",{...m("businessType",{required:!0}),type:"radio",value:S,className:"sr-only"}),o.jsx("div",{className:"border-2 border-gray-200 rounded-lg p-3 text-center cursor-pointer hover:border-blue-300 peer-checked:border-blue-500 peer-checked:bg-blue-50",children:o.jsx("div",{className:"text-sm font-medium",children:Mv(S)})})]},S))})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Restaurant Name"}),o.jsx("input",{...m("name",{required:"Name is required"}),type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Pizza Palace"}),p.name&&o.jsx("p",{className:"text-red-500 text-sm mt-1",children:p.name.message})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Owner Name"}),o.jsx("input",{...m("ownerName",{required:"Owner name is required"}),type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"John Doe"}),p.ownerName&&o.jsx("p",{className:"text-red-500 text-sm mt-1",children:p.ownerName.message})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Owner Email"}),o.jsx("input",{...m("ownerEmail",{required:"Email is required",pattern:{value:/^\S+@\S+$/i,message:"Invalid email"}}),type:"email",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"owner@restaurant.com"}),p.ownerEmail&&o.jsx("p",{className:"text-red-500 text-sm mt-1",children:p.ownerEmail.message})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),o.jsx("input",{...m("phone"),type:"tel",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"+1 (555) 123-4567"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address"}),o.jsx("input",{...m("address"),type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"123 Main St, City, State 12345"})]}),o.jsxs("div",{className:"flex justify-end space-x-3 pt-6 border-t border-gray-200",children:[o.jsx("button",{type:"button",onClick:()=>{a(!1),g()},className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Cancel"}),o.jsx("button",{type:"submit",disabled:!v,className:"px-6 py-2 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg hover:from-blue-700 hover:to-purple-700 disabled:opacity-50 transition-all",children:"Create Restaurant"})]})]})]})}),d&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:o.jsx("div",{className:"bg-white rounded-2xl max-w-md w-full",children:o.jsxs("div",{className:"p-6",children:[o.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Restaurant Created Successfully! "}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[o.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Login Credentials"}),o.jsxs("div",{className:"space-y-2 text-sm",children:[o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-gray-600",children:"URL:"}),o.jsxs("button",{onClick:()=>F(d.restaurantUrl),className:"text-blue-600 hover:text-blue-800 flex items-center",children:[o.jsx(Hu,{className:"w-3 h-3 mr-1"}),"Copy"]})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-gray-600",children:"Email:"}),o.jsxs("button",{onClick:()=>F(d.ownerEmail),className:"text-blue-600 hover:text-blue-800 flex items-center",children:[o.jsx(Hu,{className:"w-3 h-3 mr-1"}),"Copy"]})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-gray-600",children:"Password:"}),o.jsxs("button",{onClick:()=>F(d.ownerPassword),className:"text-blue-600 hover:text-blue-800 flex items-center",children:[o.jsx(Hu,{className:"w-3 h-3 mr-1"}),"Copy"]})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-gray-600",children:"PIN:"}),o.jsxs("button",{onClick:()=>F(d.ownerPin),className:"text-blue-600 hover:text-blue-800 flex items-center",children:[o.jsx(Hu,{className:"w-3 h-3 mr-1"}),"Copy"]})]})]})]}),o.jsx("button",{onClick:()=>F(d.loginInstructions),className:"w-full bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Copy All Instructions"})]}),o.jsx("button",{onClick:()=>f(null),className:"w-full mt-4 px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Close"})]})})})]})}class Cl{static async createInventoryItem(e){try{const r=Hr(),n={id:r,...e,createdAt:new Date,updatedAt:new Date},s=Rt(Ke,"restaurants",e.restaurantId,this.INVENTORY_COLLECTION,r);return await gd(s,{...n,createdAt:ft.fromDate(n.createdAt),updatedAt:ft.fromDate(n.updatedAt),lastRestockedAt:n.lastRestockedAt?ft.fromDate(n.lastRestockedAt):null}),console.log(" Inventory item created:",n.id),{success:!0,data:n,message:"Inventory item created successfully"}}catch(r){return console.error(" Failed to create inventory item:",r),{success:!1,error:Zt(r)}}}static async getInventoryByMenuItemId(e,r){try{const n=br(hr(Ke,"restaurants",r,this.INVENTORY_COLLECTION),Nr("menuItemId","==",e)),s=await Tr(n);return s.empty?{success:!0,data:null}:{success:!0,data:this.convertFirestoreInventoryItem(s.docs[0].data(),s.docs[0].id)}}catch(n){return console.error(" Failed to get inventory by menu item ID:",n),{success:!1,error:Zt(n)}}}static async getInventoryForRestaurant(e){try{const r=br(hr(Ke,"restaurants",e,this.INVENTORY_COLLECTION),Oa("createdAt","desc"));return{success:!0,data:(await Tr(r)).docs.map(a=>this.convertFirestoreInventoryItem(a.data(),a.id))}}catch(r){return console.error(" Failed to get inventory for restaurant:",r),{success:!1,error:Zt(r)}}}static async updateInventoryItem(e,r,n){try{const s=Rt(Ke,"restaurants",r,this.INVENTORY_COLLECTION,e),a={...n,updatedAt:ft.now()};n.lastRestockedAt&&(a.lastRestockedAt=ft.fromDate(n.lastRestockedAt)),await nn(s,a);const i=await this.getInventoryById(e,r);return i.success&&i.data?(console.log(" Inventory item updated:",e),i):{success:!1,error:"Failed to get updated inventory item"}}catch(s){return console.error(" Failed to update inventory item:",s),{success:!1,error:Zt(s)}}}static async getInventoryById(e,r){try{const n=Rt(Ke,"restaurants",r,this.INVENTORY_COLLECTION,e),s=await Gr(n);return s.exists()?{success:!0,data:this.convertFirestoreInventoryItem(s.data(),s.id)}:{success:!1,error:"Inventory item not found"}}catch(n){return console.error(" Failed to get inventory by ID:",n),{success:!1,error:Zt(n)}}}static async deleteInventoryItem(e,r){try{const n=Rt(Ke,"restaurants",r,this.INVENTORY_COLLECTION,e);return await Uc(n),console.log(" Inventory item deleted:",e),{success:!0,message:"Inventory item deleted successfully"}}catch(n){return console.error(" Failed to delete inventory item:",n),{success:!1,error:Zt(n)}}}static async recordTransaction(e){try{const r=Hr(),n={id:r,...e,createdAt:new Date},s=Rt(Ke,"restaurants",e.restaurantId,this.TRANSACTIONS_COLLECTION,r);return await gd(s,{...n,createdAt:ft.fromDate(n.createdAt)}),console.log(" Inventory transaction recorded:",n.type,n.quantityChanged),{success:!0,data:n,message:"Transaction recorded successfully"}}catch(r){return console.error(" Failed to record inventory transaction:",r),{success:!1,error:Zt(r)}}}static async adjustInventoryQuantity(e,r,n,s,a,i,l){try{const c=await this.getInventoryById(e,r);if(!c.success||!c.data)return{success:!1,error:c.error||"Inventory item not found"};const u=c.data,d=n-u.currentQuantity,f={currentQuantity:n};s==="restock"&&(f.lastRestockedAt=new Date,f.lastRestockedQuantity=d);const m=await this.updateInventoryItem(e,r,f);if(!m.success||!m.data)return{success:!1,error:m.error||"Failed to update inventory"};const h=await this.recordTransaction({inventoryItemId:e,menuItemId:u.menuItemId,restaurantId:r,type:s,quantityChanged:d,previousQuantity:u.currentQuantity,newQuantity:n,reason:i,notes:l,staffId:a});return!h.success||!h.data?{success:!1,error:h.error||"Failed to record transaction"}:(await this.checkAndCreateAlerts(m.data),{success:!0,data:{inventory:m.data,transaction:h.data},message:"Inventory adjusted successfully"})}catch(c){return console.error(" Failed to adjust inventory quantity:",c),{success:!1,error:Zt(c)}}}static async deductInventoryForOrder(e,r,n,s){try{const a=[],i=Ki(Ke);for(const l of r){const c=await this.getInventoryByMenuItemId(l.menuItemId,n);if(!c.success||!c.data){console.log(" No inventory tracking for menu item:",l.menuItemId);continue}const u=c.data;if(!u.autoDeduct||!u.isTracked)continue;const d=u.consumptionPerOrder*l.quantity,f=Math.max(0,u.currentQuantity-d),m=Rt(Ke,"restaurants",n,this.INVENTORY_COLLECTION,u.id);i.update(m,{currentQuantity:f,updatedAt:ft.now()});const h=Hr(),g={id:h,inventoryItemId:u.id,menuItemId:l.menuItemId,restaurantId:n,type:"order_deduction",quantityChanged:-d,previousQuantity:u.currentQuantity,newQuantity:f,orderId:e,staffId:s,createdAt:new Date},p=Rt(Ke,"restaurants",n,this.TRANSACTIONS_COLLECTION,h);i.set(p,{...g,createdAt:ft.fromDate(g.createdAt)}),a.push(g)}return await i.commit(),console.log(" Inventory deducted for order:",e,a.length,"items"),{success:!0,data:a,message:"Inventory deducted successfully"}}catch(a){return console.error(" Failed to deduct inventory for order:",a),{success:!1,error:Zt(a)}}}static async getTransactionHistory(e,r){try{const n=br(hr(Ke,"restaurants",r,this.TRANSACTIONS_COLLECTION),Nr("inventoryItemId","==",e),Oa("createdAt","desc"),So(50));return{success:!0,data:(await Tr(n)).docs.map(i=>this.convertFirestoreTransaction(i.data(),i.id))}}catch(n){return console.error(" Failed to get transaction history:",n),{success:!1,error:Zt(n)}}}static async getLowStockItems(e){try{const r=await this.getInventoryForRestaurant(e);return!r.success||!r.data?r:{success:!0,data:r.data.filter(s=>s.isTracked&&s.currentQuantity<=s.minimumThreshold)}}catch(r){return console.error(" Failed to get low stock items:",r),{success:!1,error:Zt(r)}}}static async checkAndCreateAlerts(e){try{if(!e.isTracked)return;let r=null,n="low",s="";if(e.currentQuantity===0?(r="out_of_stock",n="critical",s=`${e.menuItemId} is out of stock`):e.currentQuantity<=e.minimumThreshold?(r="low_stock",n=e.currentQuantity<=e.minimumThreshold*.5?"high":"medium",s=`${e.menuItemId} is running low (${e.currentQuantity} ${e.unit} remaining)`):e.maxCapacity&&e.currentQuantity>e.maxCapacity&&(r="overstocked",n="low",s=`${e.menuItemId} is overstocked`),r){const a=Hr(),i={id:a,inventoryItemId:e.id,menuItemId:e.menuItemId,restaurantId:e.restaurantId,type:r,message:s,severity:n,isRead:!1,createdAt:new Date},l=Rt(Ke,"restaurants",e.restaurantId,this.ALERTS_COLLECTION,a);await gd(l,{...i,createdAt:ft.fromDate(i.createdAt)})}}catch(r){console.error("Failed to create inventory alert:",r)}}static convertFirestoreInventoryItem(e,r){var n,s,a;return{id:r,menuItemId:e.menuItemId,restaurantId:e.restaurantId,currentQuantity:e.currentQuantity,unit:e.unit,customUnit:e.customUnit,minimumThreshold:e.minimumThreshold,consumptionPerOrder:e.consumptionPerOrder,maxCapacity:e.maxCapacity,costPerUnit:e.costPerUnit,supplier:e.supplier,lastRestockedAt:(n=e.lastRestockedAt)==null?void 0:n.toDate(),lastRestockedQuantity:e.lastRestockedQuantity,isTracked:e.isTracked,autoDeduct:e.autoDeduct,createdAt:((s=e.createdAt)==null?void 0:s.toDate())||new Date,updatedAt:((a=e.updatedAt)==null?void 0:a.toDate())||new Date}}static convertFirestoreTransaction(e,r){var n;return{id:r,inventoryItemId:e.inventoryItemId,menuItemId:e.menuItemId,restaurantId:e.restaurantId,type:e.type,quantityChanged:e.quantityChanged,previousQuantity:e.previousQuantity,newQuantity:e.newQuantity,reason:e.reason,notes:e.notes,orderId:e.orderId,staffId:e.staffId,createdAt:((n=e.createdAt)==null?void 0:n.toDate())||new Date}}}Rr(Cl,"INVENTORY_COLLECTION","inventory"),Rr(Cl,"TRANSACTIONS_COLLECTION","inventoryTransactions"),Rr(Cl,"ALERTS_COLLECTION","inventoryAlerts");class Oi{static getOrders(e){try{const r=`${this.ORDERS_CACHE_KEY}_${e}`,n=`${this.CACHE_EXPIRY_KEY}_${e}`,s=localStorage.getItem(r),a=localStorage.getItem(n);return s&&a&&Date.now()<parseInt(a)?(console.log(" Orders cache hit for restaurant:",e),JSON.parse(s).map(this.parseOrderDates)):[]}catch(r){return console.error("Failed to get orders from cache:",r),[]}}static setOrders(e,r){try{const n=`${this.ORDERS_CACHE_KEY}_${e}`,s=`${this.CACHE_EXPIRY_KEY}_${e}`;localStorage.setItem(n,JSON.stringify(r)),localStorage.setItem(s,(Date.now()+this.CACHE_DURATION).toString()),console.log(" Orders cached for restaurant:",e,"Count:",r.length)}catch(n){console.error("Failed to cache orders:",n)}}static addOrder(e,r){const n=this.getOrders(e);n.unshift(r),this.setOrders(e,n)}static updateOrder(e,r){const n=this.getOrders(e),s=n.findIndex(a=>a.id===r.id);s!==-1&&(n[s]=r,this.setOrders(e,n))}static clearCache(e){const r=`${this.ORDERS_CACHE_KEY}_${e}`,n=`${this.CACHE_EXPIRY_KEY}_${e}`;localStorage.removeItem(r),localStorage.removeItem(n)}static isCacheFresh(e){const r=`${this.CACHE_EXPIRY_KEY}_${e}`,n=localStorage.getItem(r);return n?Date.now()<parseInt(n):!1}static parseOrderDates(e){return{...e,createdAt:new Date(e.createdAt),updatedAt:new Date(e.updatedAt)}}}Rr(Oi,"ORDERS_CACHE_KEY","tenverse_pos_orders"),Rr(Oi,"CACHE_EXPIRY_KEY","tenverse_pos_orders_expiry"),Rr(Oi,"CACHE_DURATION",30*60*1e3);class Gn{static getCartItems(e,r){try{const n=`${this.CART_KEY}_${e}_${r||"general"}`,s=localStorage.getItem(n);return s?JSON.parse(s):[]}catch(n){return console.error("Failed to get cart items:",n),[]}}static addToCart(e,r,n){const s=`${this.CART_KEY}_${e}_${n||"general"}`,a=this.getCartItems(e,n),i=a.findIndex(l=>l.menuItemId===r.menuItemId&&JSON.stringify(l.customizations)===JSON.stringify(r.customizations)&&JSON.stringify(l.variants)===JSON.stringify(r.variants));return i!==-1?(a[i].quantity+=r.quantity,a[i].total=a[i].quantity*a[i].price):a.push(r),localStorage.setItem(s,JSON.stringify(a)),a}static updateCartItemQuantity(e,r,n,s){const a=`${this.CART_KEY}_${e}_${s||"general"}`,i=this.getCartItems(e,s),l=i.findIndex(c=>c.menuItemId===r);return l!==-1&&(n<=0?i.splice(l,1):(i[l].quantity=n,i[l].total=n*i[l].price)),localStorage.setItem(a,JSON.stringify(i)),i}static removeFromCart(e,r,n){return this.updateCartItemQuantity(e,r,0,n)}static clearCart(e,r){const n=`${this.CART_KEY}_${e}_${r||"general"}`;localStorage.removeItem(n)}static getCartTotal(e,r){const n=this.getCartItems(e,r),s=n.reduce((i,l)=>i+l.total,0),a=n.reduce((i,l)=>i+l.quantity,0);return{subtotal:s,items:a}}static convertCartToOrderItems(e){return e.map(r=>{const n={id:Hr(),menuItemId:r.menuItemId,name:r.name,price:r.price,quantity:r.quantity,total:r.total};return r.customizations&&r.customizations.length>0&&(n.customizations=r.customizations),r.variants&&r.variants.length>0&&(n.variants=r.variants),r.notes&&r.notes.trim()!==""&&(n.notes=r.notes.trim()),n})}}Rr(Gn,"CART_KEY","tenverse_pos_cart");class Za{static async getOrdersForRestaurant(e,r=50){try{const n=Oi.getOrders(e);if(n.length>0&&Oi.isCacheFresh(e))return{success:!0,data:n.slice(0,r)};console.log(" Fetching orders from Firebase for restaurant:",e);const s=br(hr(Ke,"restaurants",e,this.ORDERS_COLLECTION),Oa("createdAt","desc"),So(r)),i=(await Tr(s)).docs.map(l=>this.convertFirestoreOrder(l.data(),l.id));return Oi.setOrders(e,i),console.log(" Orders loaded and cached:",i.length),{success:!0,data:i}}catch(n){return console.error(" Failed to get orders:",n),{success:!1,error:Zt(n)}}}static async createOrder(e,r,n,s,a=8.5,i){try{if(s.length===0)return{success:!1,error:"Cart is empty"};const l=Hr(),c=I_(e),u=Gn.convertCartToOrderItems(s),d=u.reduce((v,b)=>v+b.total,0),f=d*a/100,m=d+f,h={id:l,restaurantId:e,orderNumber:c,tableId:r,type:"dine_in",status:"placed",items:u,subtotal:d,tax:f,discount:0,total:m,paymentStatus:"pending",notes:i,staffId:n,createdAt:new Date,updatedAt:new Date},g=Rt(Ke,"restaurants",e,this.ORDERS_COLLECTION,l),p={id:l,restaurantId:e,orderNumber:c,tableId:r,type:"dine_in",status:"placed",items:u,subtotal:d,tax:f,discount:0,total:m,paymentStatus:"pending",staffId:n,createdAt:ft.fromDate(h.createdAt),updatedAt:ft.fromDate(h.updatedAt)};i&&i.trim()!==""&&(p.notes=i.trim()),await gd(g,p);try{const v=u.map(w=>({menuItemId:w.menuItemId,quantity:w.quantity})),b=await Cl.deductInventoryForOrder(l,v,e,n);b.success?console.log(" Inventory deducted for order:",l):console.warn(" Failed to deduct inventory for order:",b.error)}catch(v){console.warn(" Inventory deduction error (order still created):",v)}return Oi.addOrder(e,h),Gn.clearCart(e,r),console.log(" Order created and cached:",h.orderNumber),{success:!0,data:h,message:`Order ${h.orderNumber} placed successfully`}}catch(l){return console.error(" Failed to create order:",l),{success:!1,error:Zt(l)}}}static async updateOrderStatus(e,r,n,s){try{const a=Rt(Ke,"restaurants",r,this.ORDERS_COLLECTION,e),i={status:n,updatedAt:ft.now(),...s};n==="completed"&&(i.paymentStatus="paid"),await nn(a,i);const l=Oi.getOrders(r),c=l.findIndex(d=>d.id===e);if(c!==-1){const d={...l[c],status:n,updatedAt:new Date,...s};return n==="completed"&&(d.paymentStatus="paid"),Oi.updateOrder(r,d),{success:!0,data:d,message:"Order status updated successfully"}}return await this.getOrderById(e,r)}catch(a){return console.error(" Failed to update order status:",a),{success:!1,error:Zt(a)}}}static async getOrderById(e,r){try{const s=Oi.getOrders(r).find(c=>c.id===e);if(s)return{success:!0,data:s};const a=Rt(Ke,"restaurants",r,this.ORDERS_COLLECTION,e),i=await Gr(a);return i.exists()?{success:!0,data:this.convertFirestoreOrder(i.data(),i.id)}:{success:!1,error:"Order not found"}}catch(n){return console.error(" Failed to get order by ID:",n),{success:!1,error:Zt(n)}}}static async getOrdersByIds(e,r){try{if(!e||e.length===0)return{success:!0,data:[]};const n=Oi.getOrders(r),s=[],a=[];e.forEach(i=>{const l=n.find(c=>c.id===i);l?s.push(l):a.push(i)});for(const i of a)try{const l=Rt(Ke,"restaurants",r,this.ORDERS_COLLECTION,i),c=await Gr(l);if(c.exists()){const u=this.convertFirestoreOrder(c.data(),c.id);s.push(u)}}catch(l){console.warn(`Failed to fetch order ${i}:`,l)}return s.sort((i,l)=>l.createdAt.getTime()-i.createdAt.getTime()),{success:!0,data:s}}catch(n){return console.error(" Failed to get orders by IDs:",n),{success:!1,error:Zt(n)}}}static async getOrdersByTable(e,r){try{const n=br(hr(Ke,"restaurants",e,this.ORDERS_COLLECTION),Nr("tableId","==",r)),a=(await Tr(n)).docs.map(i=>this.convertFirestoreOrder(i.data(),i.id));return a.sort((i,l)=>l.createdAt.getTime()-i.createdAt.getTime()),{success:!0,data:a}}catch(n){return console.error(" Failed to get orders by table:",n),{success:!1,error:Zt(n)}}}static async getActiveOrders(e){try{const r=br(hr(Ke,"restaurants",e,this.ORDERS_COLLECTION),Nr("status","in",["placed","confirmed","preparing","ready"])),s=(await Tr(r)).docs.map(a=>this.convertFirestoreOrder(a.data(),a.id));return s.sort((a,i)=>a.createdAt.getTime()-i.createdAt.getTime()),{success:!0,data:s}}catch(r){return console.error(" Failed to get active orders:",r),{success:!1,error:Zt(r)}}}static subscribeToOrders(e,r,n=50){const s=br(hr(Ke,"restaurants",e,this.ORDERS_COLLECTION),Oa("createdAt","desc"),So(n));return Ug(s,a=>{const i=a.docs.map(l=>this.convertFirestoreOrder(l.data(),l.id));Oi.setOrders(e,i),r(i)},a=>{console.error("Orders subscription error:",a)})}static subscribeToActiveOrders(e,r){const n=br(hr(Ke,"restaurants",e,this.ORDERS_COLLECTION),Nr("status","in",["placed","confirmed","preparing","ready"]));return Ug(n,s=>{const a=s.docs.map(i=>this.convertFirestoreOrder(i.data(),i.id));a.sort((i,l)=>i.createdAt.getTime()-l.createdAt.getTime()),r(a)},s=>{console.error("Active orders subscription error:",s)})}static async transferOrders(e,r,n){try{const s=await this.getOrdersByTable(n,e);if(!s.success||!s.data)return{success:!1,error:"Failed to get source table orders"};const a=s.data.filter(i=>["placed","confirmed","preparing","ready"].includes(i.status));for(const i of a)await nn(Rt(Ke,"restaurants",n,this.ORDERS_COLLECTION,i.id),{tableId:r,updatedAt:ft.now()});return this.clearCache(n),{success:!0,message:`${a.length} orders transferred successfully`}}catch(s){return console.error(" Failed to transfer orders:",s),{success:!1,error:Zt(s)}}}static async getMergedOrders(e,r){try{const n=[];for(const s of e){const a=await this.getOrdersByTable(r,s);if(a.success&&a.data){const i=a.data.filter(l=>["placed","confirmed","preparing","ready"].includes(l.status));n.push(...i)}}return n.sort((s,a)=>s.createdAt.getTime()-a.createdAt.getTime()),{success:!0,data:n}}catch(n){return console.error(" Failed to get merged orders:",n),{success:!1,error:Zt(n)}}}static async updateOrderForMerge(e,r,n){try{const s=Rt(Ke,"restaurants",r,this.ORDERS_COLLECTION,e),a=`Merged tables: ${n.join(", ")}`;return await nn(s,{notes:a,updatedAt:ft.now()}),await this.getOrderById(e,r)}catch(s){return console.error(" Failed to update order for merge:",s),{success:!1,error:Zt(s)}}}static clearCache(e){Oi.clearCache(e)}static convertFirestoreOrder(e,r){var n,s;return{id:r,restaurantId:e.restaurantId,orderNumber:e.orderNumber,tableId:e.tableId,customerId:e.customerId,type:e.type,status:e.status,items:e.items||[],subtotal:e.subtotal,tax:e.tax,discount:e.discount,total:e.total,paymentStatus:e.paymentStatus,notes:e.notes,staffId:e.staffId,createdAt:((n=e.createdAt)==null?void 0:n.toDate())||new Date,updatedAt:((s=e.updatedAt)==null?void 0:s.toDate())||new Date}}}Rr(Za,"ORDERS_COLLECTION","orders");const vC=Object.freeze(Object.defineProperty({__proto__:null,CartManager:Gn,OrderService:Za},Symbol.toStringTag,{value:"Module"}));class Ku{static async getTableAreasForRestaurant(e){try{const r=br(hr(Ke,"restaurants",e,this.COLLECTION),Oa("sortOrder","asc"));return{success:!0,data:(await Tr(r)).docs.map(a=>this.convertFirestoreTableArea(a.data(),a.id))}}catch(r){return console.error(" Failed to get table areas:",r),{success:!1,error:Zt(r)}}}static async createTableArea(e,r){try{const n=Hr(),s=new Date,a={id:n,restaurantId:e,...r,createdAt:s,updatedAt:s},i=Rt(Ke,"restaurants",e,this.COLLECTION,n);return await gd(i,{...a,createdAt:ft.fromDate(a.createdAt),updatedAt:ft.fromDate(a.updatedAt)}),console.log(" Table area created:",a.name),{success:!0,data:a,message:"Table area created successfully"}}catch(n){return console.error(" Failed to create table area:",n),{success:!1,error:Zt(n)}}}static async updateTableArea(e,r,n){try{const s=Rt(Ke,"restaurants",e,this.COLLECTION,r),a={...n,updatedAt:ft.now()};await nn(s,a);const i=await Gr(s);if(!i.exists())return{success:!1,error:"Table area not found after update"};const l=this.convertFirestoreTableArea(i.data(),i.id);return console.log(" Table area updated:",l.name),{success:!0,data:l,message:"Table area updated successfully"}}catch(s){return console.error(" Failed to update table area:",s),{success:!1,error:Zt(s)}}}static async deleteTableArea(e,r){try{const n=Rt(Ke,"restaurants",e,this.COLLECTION,r);return await Uc(n),console.log(" Table area deleted:",r),{success:!0,message:"Table area deleted successfully"}}catch(n){return console.error(" Failed to delete table area:",n),{success:!1,error:Zt(n)}}}static async getTableAreaById(e,r){try{const n=Rt(Ke,"restaurants",e,this.COLLECTION,r),s=await Gr(n);return s.exists()?{success:!0,data:this.convertFirestoreTableArea(s.data(),s.id)}:{success:!1,error:"Table area not found"}}catch(n){return console.error(" Failed to get table area:",n),{success:!1,error:Zt(n)}}}static async createDefaultAreas(e){try{const r=[{name:"Main Dining",description:"Main dining area",isActive:!0,sortOrder:1},{name:"Bar Area",description:"Bar and lounge area",isActive:!0,sortOrder:2},{name:"Patio",description:"Outdoor seating area",isActive:!0,sortOrder:3},{name:"VIP Room",description:"Private dining area",isActive:!0,sortOrder:4}],n=[];for(const s of r){const a=await this.createTableArea(e,s);a.success&&a.data&&n.push(a.data)}return{success:!0,data:n,message:"Default table areas created successfully"}}catch(r){return console.error(" Failed to create default areas:",r),{success:!1,error:Zt(r)}}}static convertFirestoreTableArea(e,r){var n,s;return{id:r,restaurantId:e.restaurantId,name:e.name,description:e.description,isActive:e.isActive,sortOrder:e.sortOrder,createdAt:((n=e.createdAt)==null?void 0:n.toDate())||new Date,updatedAt:((s=e.updatedAt)==null?void 0:s.toDate())||new Date}}}Rr(Ku,"COLLECTION","tableAreas");class Ps{static getTables(e){try{const r=`${this.CACHE_KEY}_${e}`,n=`${this.CACHE_EXPIRY_KEY}_${e}`,s=localStorage.getItem(r),a=localStorage.getItem(n);if(s&&a){const i=JSON.parse(s).map(this.parseTableDates),l=Date.now()>=parseInt(a);return l?console.log(" Table cache hit for restaurant:",e,"- Stale data, will refresh"):console.log(" Table cache hit for restaurant:",e,"- Fresh data"),{tables:i,isStale:l}}return{tables:[],isStale:!0}}catch(r){return console.error("Failed to get tables from cache:",r),{tables:[],isStale:!0}}}static setTables(e,r,n){try{const s=`${this.CACHE_KEY}_${e}`,a=`${this.CACHE_EXPIRY_KEY}_${e}`,i=`${this.CACHE_VERSION_KEY}_${e}`;localStorage.setItem(s,JSON.stringify(r)),localStorage.setItem(a,(Date.now()+this.CACHE_DURATION).toString()),n&&localStorage.setItem(i,n),console.log(" Tables cached for restaurant:",e,"Count:",r.length)}catch(s){console.error("Failed to cache tables:",s)}}static addTable(e,r){const{tables:n}=this.getTables(e),s=[...n,r];return this.setTables(e,s),console.log(" Table added to cache:",r.number),s}static updateTable(e,r){const{tables:n}=this.getTables(e),s=n.map(a=>a.id===r.id?r:a);return this.setTables(e,s),console.log(" Table updated in cache:",r.number),s}static removeTable(e,r){const{tables:n}=this.getTables(e),s=n.filter(a=>a.id!==r);return this.setTables(e,s),console.log(" Table removed from cache:",r),s}static bulkUpdateTables(e,r){const{tables:n}=this.getTables(e),s=n.map(a=>{const i=r.find(l=>l.id===a.id);return i?{...a,...i}:a});return this.setTables(e,s),console.log(" Bulk table updates applied to cache:",r.length,"updates"),s}static getAreas(e){const{tables:r}=this.getTables(e);return[...new Set(r.map(n=>n.area))].sort()}static clearCache(e){const r=`${this.CACHE_KEY}_${e}`,n=`${this.CACHE_EXPIRY_KEY}_${e}`,s=`${this.CACHE_VERSION_KEY}_${e}`;localStorage.removeItem(r),localStorage.removeItem(n),localStorage.removeItem(s),console.log(" Table cache cleared for restaurant:",e)}static needsRefresh(e){const{isStale:r}=this.getTables(e);return r}static parseTableDates(e){return{...e,createdAt:new Date(e.createdAt),updatedAt:new Date(e.updatedAt),reservedAt:e.reservedAt?new Date(e.reservedAt):void 0,areaId:e.areaId||e.area||"default-area",isActive:e.isActive!==void 0?e.isActive:!0}}static getCacheStats(e){const{tables:r,isStale:n}=this.getTables(e);return{cached:r.length>0,count:r.length,isStale:n,areas:this.getAreas(e)}}}Rr(Ps,"CACHE_KEY","tenverse_pos_tables"),Rr(Ps,"CACHE_EXPIRY_KEY","tenverse_pos_tables_expiry"),Rr(Ps,"CACHE_VERSION_KEY","tenverse_pos_tables_version"),Rr(Ps,"CACHE_DURATION",24*60*60*1e3);class pn{static async getTablesForRestaurant(e){try{const{tables:r,isStale:n}=Ps.getTables(e);if(r.length>0&&!n)return{success:!0,data:r};console.log(" Fetching tables from Firebase for restaurant:",e);const s=br(hr(Ke,"restaurants",e,this.TABLES_COLLECTION)),i=(await Tr(s)).docs.map(l=>this.convertFirestoreDoc(l.data(),l.id));return i.sort((l,c)=>{if(l.area!==c.area)return l.area.localeCompare(c.area);const u=parseInt(l.number),d=parseInt(c.number);return!isNaN(u)&&!isNaN(d)?u-d:l.number.localeCompare(c.number)}),Ps.setTables(e,i),console.log(" Tables loaded, sorted, and cached:",i.length),{success:!0,data:i}}catch(r){return console.error(" Failed to get tables:",r),{success:!1,error:Zt(r)}}}static async initializeDefaultTables(e){try{const r=await this.getTablesForRestaurant(e);if(r.success&&r.data&&r.data.length>0)return r;console.log(" Creating default tables and areas for restaurant:",e);const n=await Ku.createTableArea(e,{name:"Main Dining",description:"Main dining area",isActive:!0,sortOrder:1});if(!n.success||!n.data)throw new Error("Failed to create default table area");const s=n.data,a=Ki(Ke),i=[{restaurantId:e,number:"1",area:s.name,areaId:s.id,capacity:4,status:"available",isActive:!0,createdAt:new Date,updatedAt:new Date},{restaurantId:e,number:"2",area:s.name,areaId:s.id,capacity:4,status:"available",isActive:!0,createdAt:new Date,updatedAt:new Date},{restaurantId:e,number:"3",area:s.name,areaId:s.id,capacity:6,status:"available",isActive:!0,createdAt:new Date,updatedAt:new Date},{restaurantId:e,number:"4",area:s.name,areaId:s.id,capacity:2,status:"available",isActive:!0,createdAt:new Date,updatedAt:new Date}],l=[];for(const c of i){const u=Hr(),d={id:u,...c},f=Rt(Ke,"restaurants",e,this.TABLES_COLLECTION,u);a.set(f,{...d,createdAt:ft.fromDate(d.createdAt),updatedAt:ft.fromDate(d.updatedAt)}),l.push(d)}return await a.commit(),Ps.setTables(e,l),console.log(" Default tables and areas created and cached"),{success:!0,data:l,message:"Default tables and areas created successfully"}}catch(r){return console.error(" Failed to create default tables:",r),{success:!1,error:Zt(r)}}}static async createTable(e){try{const r=Hr(),n={id:r,...e,createdAt:new Date,updatedAt:new Date},s=Rt(Ke,"restaurants",e.restaurantId,this.TABLES_COLLECTION,r);return await gd(s,{...n,createdAt:ft.fromDate(n.createdAt),updatedAt:ft.fromDate(n.updatedAt)}),Ps.addTable(e.restaurantId,n),console.log(" Table created and cached:",n.number),{success:!0,data:n,message:"Table created successfully"}}catch(r){return console.error(" Failed to create table:",r),{success:!1,error:Zt(r)}}}static async updateTable(e,r,n){try{const s=Rt(Ke,"restaurants",r,this.TABLES_COLLECTION,e),a={...n,updatedAt:ft.now()};await nn(s,a);const{tables:i}=Ps.getTables(r),l=i.findIndex(u=>u.id===e);if(l!==-1){const u={...i[l],...n,updatedAt:new Date};return Ps.updateTable(r,u),{success:!0,data:u,message:"Table updated successfully"}}return await this.getTableById(e,r)}catch(s){return console.error(" Failed to update table:",s),{success:!1,error:Zt(s)}}}static async deleteTable(e,r){try{const n=Rt(Ke,"restaurants",r,this.TABLES_COLLECTION,e);return await Uc(n),Ps.removeTable(r,e),console.log(" Table deleted and removed from cache"),{success:!0,message:"Table deleted successfully"}}catch(n){return console.error(" Failed to delete table:",n),{success:!1,error:Zt(n)}}}static async getTableById(e,r){try{const{tables:n}=Ps.getTables(r),s=n.find(c=>c.id===e);if(s)return{success:!0,data:s};const a=Rt(Ke,"restaurants",r,this.TABLES_COLLECTION,e),i=await Gr(a);return i.exists()?{success:!0,data:this.convertFirestoreDoc(i.data(),i.id)}:{success:!1,error:"Table not found"}}catch(n){return console.error(" Failed to get table by ID:",n),{success:!1,error:Zt(n)}}}static async getAvailableTables(e){const r=await this.getTablesForRestaurant(e);return r.success&&r.data?{success:!0,data:r.data.filter(s=>s.status==="available")}:r}static async getTableAreas(e){const r=await this.getTablesForRestaurant(e);return r.success&&r.data?{success:!0,data:[...new Set(r.data.map(s=>s.area))]}:{success:!1,error:r.error}}static subscribeToTables(e,r){const n=br(hr(Ke,"restaurants",e,this.TABLES_COLLECTION));return Ug(n,s=>{const a=s.docs.map(i=>this.convertFirestoreDoc(i.data(),i.id));a.sort((i,l)=>{if(i.area!==l.area)return i.area.localeCompare(l.area);const c=parseInt(i.number),u=parseInt(l.number);return!isNaN(c)&&!isNaN(u)?c-u:i.number.localeCompare(l.number)}),Ps.setTables(e,a),r(a)},s=>{console.error("Table subscription error:",s)})}static async transferTable(e,r,n){try{const s=Ki(Ke),a=Rt(Ke,"restaurants",n,this.TABLES_COLLECTION,e),i=Rt(Ke,"restaurants",n,this.TABLES_COLLECTION,r);s.update(a,{status:"available",currentOrderId:null,updatedAt:ft.now()}),s.update(i,{status:"occupied",updatedAt:ft.now()}),await s.commit();const{tables:l}=Ps.getTables(n),c=l.map(u=>u.id===e?{...u,status:"available",currentOrderId:void 0}:u.id===r?{...u,status:"occupied"}:u);return Ps.setTables(n,c),{success:!0,message:"Table transfer completed successfully"}}catch(s){return console.error(" Failed to transfer table:",s),{success:!1,error:Zt(s)}}}static async mergeTables(e,r){try{const n=Ki(Ke);e.forEach(i=>{const l=Rt(Ke,"restaurants",r,this.TABLES_COLLECTION,i);n.update(l,{status:"occupied",updatedAt:ft.now()})}),await n.commit();const{tables:s}=Ps.getTables(r),a=s.map(i=>e.includes(i.id)?{...i,status:"occupied"}:i);return Ps.setTables(r,a),{success:!0,data:{mergedTableId:e[0]},message:"Tables merged successfully"}}catch(n){return console.error(" Failed to merge tables:",n),{success:!1,error:Zt(n)}}}static async unmergeTables(e,r){try{const n=Ki(Ke);e.forEach(i=>{const l=Rt(Ke,"restaurants",r,this.TABLES_COLLECTION,i);n.update(l,{status:"available",currentOrderId:null,updatedAt:ft.now()})}),await n.commit();const{tables:s}=Ps.getTables(r),a=s.map(i=>e.includes(i.id)?{...i,status:"available",currentOrderId:void 0}:i);return Ps.setTables(r,a),{success:!0,message:"Tables unmerged and made available"}}catch(n){return console.error(" Failed to unmerge tables:",n),{success:!1,error:Zt(n)}}}static clearCache(e){Ps.clearCache(e)}static convertFirestoreDoc(e,r){var n,s,a;return{id:r,restaurantId:e.restaurantId,number:e.number,area:e.area,areaId:e.areaId||e.area||"default-area",capacity:e.capacity,status:e.status,currentOrderId:e.currentOrderId,reservedAt:(n=e.reservedAt)==null?void 0:n.toDate(),reservedFor:e.reservedFor,description:e.description,isActive:e.isActive!==void 0?e.isActive:!0,createdAt:((s=e.createdAt)==null?void 0:s.toDate())||new Date,updatedAt:((a=e.updatedAt)==null?void 0:a.toDate())||new Date}}}Rr(pn,"TABLES_COLLECTION","tables");const bC=Object.freeze(Object.defineProperty({__proto__:null,TableService:pn},Symbol.toStringTag,{value:"Module"}));class MK{static async seedRestaurantData(e,r){try{console.log(" Starting data seeding for restaurant:",e);const n=Ki(Ke),s=this.createSampleCategories(e);s.forEach(u=>{const d=Rt(Ke,"restaurants",e,"categories",u.id);n.set(d,{...u,createdAt:ft.fromDate(u.createdAt),updatedAt:ft.fromDate(u.updatedAt)})});const a=this.createSampleMenuItems(e,s);a.forEach(u=>{const d=Rt(Ke,"restaurants",e,"menuItems",u.id);n.set(d,{...u,createdAt:ft.fromDate(u.createdAt),updatedAt:ft.fromDate(u.updatedAt)})});const i=this.createSampleTables(e,r);i.forEach(u=>{const d=Rt(Ke,"restaurants",e,"tables",u.id);n.set(d,{...u,createdAt:ft.fromDate(u.createdAt),updatedAt:ft.fromDate(u.updatedAt)})}),await n.commit(),console.log(" Committed categories, menu items, and tables");const l=this.createSampleOrders(e,r,a,i),c=Ki(Ke);return l.forEach(u=>{const d=Rt(Ke,"restaurants",e,"orders",u.id);c.set(d,{...u,createdAt:ft.fromDate(u.createdAt),updatedAt:ft.fromDate(u.updatedAt)})}),await c.commit(),console.log(" Committed sample orders"),{success:!0,message:`Sample data created successfully! Added ${s.length} categories, ${a.length} menu items, ${i.length} tables, and ${l.length} orders.`}}catch(n){return console.error(" Failed to seed restaurant data:",n),{success:!1,error:n.message||"Failed to create sample data"}}}static createSampleCategories(e){const r=new Date;return[{id:Hr(),restaurantId:e,name:"Starters",description:"Appetizers and small plates",isActive:!0,sortOrder:1,createdAt:r,updatedAt:r},{id:Hr(),restaurantId:e,name:"Main Course",description:"Main dishes and entrees",isActive:!0,sortOrder:2,createdAt:r,updatedAt:r},{id:Hr(),restaurantId:e,name:"Beverages",description:"Hot and cold drinks",isActive:!0,sortOrder:3,createdAt:r,updatedAt:r},{id:Hr(),restaurantId:e,name:"Desserts",description:"Sweet treats and desserts",isActive:!0,sortOrder:4,createdAt:r,updatedAt:r}]}static createSampleMenuItems(e,r){const n=new Date,s=r.find(c=>c.name==="Starters"),a=r.find(c=>c.name==="Main Course"),i=r.find(c=>c.name==="Beverages"),l=r.find(c=>c.name==="Desserts");return[{id:Hr(),restaurantId:e,name:"Caesar Salad",description:"Fresh romaine lettuce with caesar dressing, croutons, and parmesan",price:180,category:s.name,categoryId:s.id,categoryName:s.name,isAvailable:!0,isVeg:!0,spiceLevel:"mild",preparationTime:10,ingredients:["lettuce","caesar dressing","croutons","parmesan"],allergens:["dairy"],createdAt:n,updatedAt:n},{id:Hr(),restaurantId:e,name:"Chicken Wings",description:"Crispy chicken wings with buffalo sauce",price:250,category:s.name,categoryId:s.id,categoryName:s.name,isAvailable:!0,isVeg:!1,spiceLevel:"medium",preparationTime:15,ingredients:["chicken wings","buffalo sauce","celery"],allergens:[],createdAt:n,updatedAt:n},{id:Hr(),restaurantId:e,name:"Grilled Chicken Breast",description:"Juicy grilled chicken breast with herbs and vegetables",price:450,category:a.name,categoryId:a.id,categoryName:a.name,isAvailable:!0,isVeg:!1,spiceLevel:"mild",preparationTime:25,ingredients:["chicken breast","herbs","vegetables"],allergens:[],createdAt:n,updatedAt:n},{id:Hr(),restaurantId:e,name:"Paneer Butter Masala",description:"Cottage cheese in rich tomato and butter gravy",price:380,category:a.name,categoryId:a.id,categoryName:a.name,isAvailable:!0,isVeg:!0,spiceLevel:"medium",preparationTime:20,ingredients:["paneer","tomatoes","butter","spices"],allergens:["dairy"],createdAt:n,updatedAt:n},{id:Hr(),restaurantId:e,name:"Fresh Lime Soda",description:"Refreshing lime soda with mint",price:80,category:i.name,categoryId:i.id,categoryName:i.name,isAvailable:!0,isVeg:!0,spiceLevel:"mild",preparationTime:5,ingredients:["lime","soda","mint"],allergens:[],createdAt:n,updatedAt:n},{id:Hr(),restaurantId:e,name:"Chocolate Brownie",description:"Rich chocolate brownie with vanilla ice cream",price:220,category:l.name,categoryId:l.id,categoryName:l.name,isAvailable:!0,isVeg:!0,spiceLevel:"mild",preparationTime:12,ingredients:["chocolate","brownie","ice cream"],allergens:["dairy","eggs"],createdAt:n,updatedAt:n}]}static createSampleTables(e,r){const n=new Date;return[{id:Hr(),restaurantId:e,number:"1",capacity:2,area:"Main Hall",areaId:"main-hall",status:"available",isActive:!0,createdBy:r,createdAt:n,updatedAt:n},{id:Hr(),restaurantId:e,number:"2",capacity:4,area:"Main Hall",areaId:"main-hall",status:"occupied",isActive:!0,createdBy:r,createdAt:n,updatedAt:n},{id:Hr(),restaurantId:e,number:"3",capacity:4,area:"Main Hall",areaId:"main-hall",status:"available",isActive:!0,createdBy:r,createdAt:n,updatedAt:n},{id:Hr(),restaurantId:e,number:"4",capacity:6,area:"VIP Section",areaId:"vip-section",status:"occupied",isActive:!0,createdBy:r,createdAt:n,updatedAt:n}]}static createSampleOrders(e,r,n,s){const a=[],i=new Date,l=new Date(i.getFullYear(),i.getMonth(),i.getDate()),c=new Date(l.getTime()-24*60*60*1e3);for(let u=0;u<8;u++){const d=s[Math.floor(Math.random()*s.length)],f=this.generateRandomOrderItems(n),m=f.reduce((p,v)=>p+v.total,0),h=m*.18,g=m+h;a.push({id:Hr(),restaurantId:e,orderNumber:I_(e),tableId:d.id,type:"dine_in",status:["completed","delivered","ready","preparing"][Math.floor(Math.random()*4)],items:f,subtotal:m,tax:h,discount:0,total:g,paymentStatus:"paid",staffId:r,createdAt:new Date(l.getTime()+Math.random()*16*60*60*1e3),updatedAt:i})}for(let u=0;u<5;u++){const d=s[Math.floor(Math.random()*s.length)],f=this.generateRandomOrderItems(n),m=f.reduce((p,v)=>p+v.total,0),h=m*.18,g=m+h;a.push({id:Hr(),restaurantId:e,orderNumber:I_(e),tableId:d.id,type:"dine_in",status:"completed",items:f,subtotal:m,tax:h,discount:0,total:g,paymentStatus:"paid",staffId:r,createdAt:new Date(c.getTime()+Math.random()*16*60*60*1e3),updatedAt:c})}return a}static generateRandomOrderItems(e){const r=[],n=Math.floor(Math.random()*3)+1;for(let s=0;s<n;s++){const a=e[Math.floor(Math.random()*e.length)],i=Math.floor(Math.random()*2)+1;r.push({id:Hr(),menuItemId:a.id,name:a.name,price:a.price,quantity:i,total:a.price*i})}return r}}function wC(){const{restaurant:t}=ya(),{user:e}=Xc(),[r,n]=X.useState(null),[s,a]=X.useState(!0),[i,l]=X.useState(!1);X.useEffect(()=>{if(!t)return;(async()=>{try{a(!0);const p=new Date,v=new Date(p.getFullYear(),p.getMonth(),p.getDate()),b=new Date(v.getTime()+24*60*60*1e3),w=new Date(p.getTime()-24*60*60*1e3),N=new Date(w.getFullYear(),w.getMonth(),w.getDate()),j=new Date(N.getTime()+24*60*60*1e3),[F,U]=await Promise.all([Za.getOrdersForRestaurant(t.id),pn.getTablesForRestaurant(t.id)]),A=F.success?F.data||[]:[],S=U.success?U.data||[]:[],k=A.filter(Z=>{const ae=Z.createdAt,de=ae instanceof Date?ae:new Date(ae);return de>=v&&de<b}),M=A.filter(Z=>{const ae=Z.createdAt,de=ae instanceof Date?ae:new Date(ae);return de>=N&&de<j}),I=k.reduce((Z,ae)=>Z+(ae.total||0),0),E=M.reduce((Z,ae)=>Z+(ae.total||0),0),D=S.filter(Z=>Z.status==="occupied").length,G=E>0?(I-E)/E*100:I>0?100:0;n({totalOrdersToday:k.length,revenueToday:I,activeTables:D,totalTables:S.length,ordersYesterday:M.length,revenueYesterday:E,growth:G})}catch(p){console.error("Error fetching dashboard data:",p)}finally{a(!1)}})()},[t]);const c=async()=>{if(!(!t||!e)){l(!0);try{const g=await MK.seedRestaurantData(t.id,e.id);g.success?(fe.success(g.message||"Sample data loaded successfully!"),window.location.reload()):fe.error(g.error||"Failed to load sample data")}catch(g){console.error("Error seeding data:",g),fe.error("Failed to load sample data")}finally{l(!1)}}};if(!t)return null;const u=()=>{if(!r||r.ordersYesterday===0)return"+0%";const g=(r.totalOrdersToday-r.ordersYesterday)/r.ordersYesterday*100;return`${g>=0?"+":""}${g.toFixed(1)}%`},d=()=>{if(!r||r.revenueYesterday===0)return"+0%";const g=(r.revenueToday-r.revenueYesterday)/r.revenueYesterday*100;return`${g>=0?"+":""}${g.toFixed(1)}%`},f=()=>!r||r.totalTables===0?"0%":`${Math.round(r.activeTables/r.totalTables*100)}%`,m=[{title:"Total Orders Today",value:s?"...":(r==null?void 0:r.totalOrdersToday.toString())||"0",change:s?"...":u(),icon:Gg,color:"text-blue-600",bgColor:"bg-blue-50",isPositive:!s&&r?r.totalOrdersToday>=r.ordersYesterday:!0},{title:"Revenue Today",value:s?"...":pt((r==null?void 0:r.revenueToday)||0),change:s?"...":d(),icon:Yi,color:"text-green-600",bgColor:"bg-green-50",isPositive:!s&&r?r.revenueToday>=r.revenueYesterday:!0},{title:"Active Tables",value:s?"...":`${(r==null?void 0:r.activeTables)||0}/${(r==null?void 0:r.totalTables)||0}`,change:s?"...":f(),icon:ni,color:"text-purple-600",bgColor:"bg-purple-50",isPositive:!0},{title:"Revenue Growth",value:s?"...":`${(r==null?void 0:r.growth.toFixed(1))||"0"}%`,change:s?"...":"vs yesterday",icon:_i,color:"text-orange-600",bgColor:"bg-orange-50",isPositive:!s&&r?r.growth>=0:!0}],h=[{title:"Manage Tables",description:"View and manage tables",icon:ni,href:`/${t.slug}/tables`,color:"from-blue-500 to-blue-600"},{title:"Orders Dashboard",description:"View and analyze orders",icon:Gg,href:`/${t.slug}/orders`,color:"from-indigo-500 to-indigo-600"},{title:"Menu Management",description:"Manage menu items & categories",icon:YR,href:`/${t.slug}/menu`,color:"from-orange-500 to-orange-600"},{title:"Inventory Management",description:"Track stock & inventory",icon:Zi,href:`/${t.slug}/inventory`,color:"from-green-500 to-green-600"},{title:"Kitchen Display",description:"View kitchen orders",icon:Cc,href:`/${t.slug}/kitchen`,color:"from-purple-500 to-purple-600"},{title:"Customer Management",description:"Manage customer database",icon:ni,href:`/${t.slug}/customers`,color:"from-teal-500 to-teal-600"},{title:"Coupon Dashboard",description:"Manage coupons & promotions",icon:Ia,href:`/${t.slug}/coupons`,color:"from-pink-500 to-pink-600"},{title:"Gamification Tools",description:"Spin wheel & customer engagement",icon:yd,href:`/${t.slug}/gamification`,color:"from-indigo-500 to-purple-600"},{title:"Settings",description:"Restaurant settings",icon:Id,href:`/${t.slug}/settings`,color:"from-gray-500 to-gray-600"}];return o.jsx("div",{className:"min-h-screen",style:{background:"var(--color-background)"},children:o.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[o.jsx("div",{className:"mb-8",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Dashboard"}),o.jsx("p",{className:"text-gray-600 mt-1",children:"Welcome back! Here's an overview of your restaurant operations."})]}),o.jsxs("div",{className:"text-right",children:[o.jsx("div",{className:"text-sm text-gray-500",children:"Your Restaurant URL"}),o.jsxs("code",{className:"text-sm font-mono bg-gray-100 px-2 py-1 rounded",children:[window.location.origin,"/",t.slug]})]})]})}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:m.map((g,p)=>{const v=g.icon;return o.jsx("div",{className:"card p-6",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-gray-600",children:g.title}),o.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[o.jsx("p",{className:"text-2xl font-bold text-gray-900",children:g.value}),s&&o.jsx(Ed,{className:"w-4 h-4 animate-spin text-gray-400"})]}),o.jsxs("p",{className:`text-sm mt-1 ${g.isPositive?"text-green-600":"text-red-600"}`,children:[g.change," ",g.title!=="Active Tables"&&g.title!=="Revenue Growth"?"from yesterday":""]})]}),o.jsx("div",{className:`w-12 h-12 ${g.bgColor} rounded-lg flex items-center justify-center`,children:o.jsx(v,{className:`w-6 h-6 ${g.color}`})})]})},p)})}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[o.jsxs("div",{className:"lg:col-span-2",children:[o.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Quick Actions"}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:h.map((g,p)=>{const v=g.icon;return o.jsx("div",{className:"card card-hover p-6 cursor-pointer group",onClick:()=>window.location.href=g.href,children:o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsx("div",{className:`w-12 h-12 bg-gradient-to-r ${g.color} rounded-xl flex items-center justify-center group-hover:scale-110 transition-transform`,children:o.jsx(v,{className:"w-6 h-6 text-white"})}),o.jsxs("div",{children:[o.jsx("h3",{className:"font-semibold text-gray-900",children:g.title}),o.jsx("p",{className:"text-sm text-gray-600",children:g.description})]})]})},p)})})]}),o.jsxs("div",{children:[o.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Restaurant Information"}),o.jsxs("div",{className:"card p-6 space-y-4",children:[o.jsxs("div",{className:"text-center pb-4 border-b border-gray-200",children:[o.jsx("div",{className:"w-16 h-16 mx-auto rounded-2xl flex items-center justify-center text-white mb-3",style:{background:"var(--gradient-primary)"},children:o.jsx(Cc,{className:"w-8 h-8"})}),o.jsx("h3",{className:"font-semibold text-gray-900",children:t.name}),o.jsx("p",{className:"text-sm text-gray-600",children:Mv(t.businessType)})]}),o.jsxs("div",{className:"space-y-3",children:[t.settings.address&&o.jsxs("div",{className:"flex items-start space-x-3",children:[o.jsx(vd,{className:"w-4 h-4 text-gray-400 mt-0.5 flex-shrink-0"}),o.jsx("span",{className:"text-sm text-gray-600",children:t.settings.address})]}),t.settings.phone&&o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(Lx,{className:"w-4 h-4 text-gray-400 flex-shrink-0"}),o.jsx("span",{className:"text-sm text-gray-600",children:t.settings.phone})]}),t.settings.email&&o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(Z2,{className:"w-4 h-4 text-gray-400 flex-shrink-0"}),o.jsx("span",{className:"text-sm text-gray-600",children:t.settings.email})]}),o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(X2,{className:"w-4 h-4 text-gray-400 flex-shrink-0"}),o.jsxs("span",{className:"text-sm text-gray-600",children:["Created ",new Date(t.createdAt).toLocaleDateString()]})]})]}),o.jsx("div",{className:"pt-4 border-t border-gray-200",children:o.jsxs("button",{className:"w-full btn btn-theme-primary",onClick:()=>window.location.href=`/${t.slug}/settings`,children:[o.jsx(Id,{className:"w-4 h-4 mr-2"}),"Manage Settings"]})})]})]})]}),o.jsx("div",{className:"mt-8 card p-6 bg-gradient-to-r from-blue-50 to-blue-100 border-blue-200",children:o.jsxs("div",{className:"flex items-start space-x-4",children:[o.jsx("div",{className:"w-12 h-12 bg-blue-500 rounded-xl flex items-center justify-center flex-shrink-0",children:o.jsx(Cc,{className:"w-6 h-6 text-white"})}),o.jsxs("div",{className:"flex-1",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Welcome to TenVerse POS!"}),o.jsx("p",{className:"text-gray-600 mb-4",children:"Your restaurant is now set up and ready to go. Start by creating your menu, setting up tables, and adding staff members. Need help getting started?"}),o.jsxs("div",{className:"flex flex-wrap gap-3",children:[o.jsx("button",{className:"btn btn-primary",children:"Setup Menu"}),o.jsx("button",{className:"btn btn-secondary",children:"Add Tables"}),o.jsx("button",{className:"btn btn-secondary",children:"Invite Staff"})]})]})]})}),o.jsx("div",{className:"mt-8 card p-6 bg-gradient-to-r from-green-50 to-green-100 border-green-200",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Load Sample Data"}),o.jsx("p",{className:"text-sm text-gray-600",children:"Load sample data to test the application"})]}),o.jsx("div",{className:"text-right",children:o.jsxs("button",{className:"btn btn-theme-primary",onClick:c,disabled:i,children:[i?o.jsx(Ed,{className:"w-4 h-4 animate-spin"}):o.jsx(XG,{className:"w-4 h-4 mr-2"}),i?"Loading...":"Load Sample Data"]})})]})})]})})}function CS({message:t="Loading...",fullScreen:e=!0}){const r=e?"fixed inset-0 z-50 bg-gradient-to-br from-blue-50 to-blue-100":"w-full h-32";return o.jsx("div",{className:`${r} flex items-center justify-center`,children:o.jsxs("div",{className:"text-center space-y-4 animate-fade-in",children:[o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:"w-16 h-16 mx-auto bg-gradient-primary rounded-2xl flex items-center justify-center shadow-lg",children:o.jsx(Ed,{className:"w-8 h-8 text-white animate-spin"})}),o.jsx("div",{className:"absolute inset-0 w-16 h-16 mx-auto border-4 border-blue-200 rounded-2xl animate-ping opacity-20"})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:e?"TenVerse POS":""}),o.jsx("p",{className:"text-sm text-gray-600 font-medium",children:t})]}),o.jsx("div",{className:"w-48 h-1 bg-gray-200 rounded-full overflow-hidden mx-auto",children:o.jsx("div",{className:"h-full bg-gradient-primary rounded-full animate-pulse"})})]})})}function VK(){const{restaurant:t,loading:e}=ya(),{login:r,loginWithPin:n,loading:s}=Xc(),a=Wl(),{slug:i}=px(),[l,c]=X.useState("email"),[u,d]=X.useState(!1),{register:f,handleSubmit:m,formState:{errors:h,isValid:g}}=Hn({mode:"onChange"}),{register:p,handleSubmit:v,formState:{errors:b,isValid:w}}=Hn({mode:"onChange"});if(e)return o.jsx(CS,{});if(!t||!i)return o.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:o.jsxs("div",{className:"text-center",children:[o.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Restaurant Not Found"}),o.jsx("p",{className:"text-gray-600",children:"Please check the URL and try again."})]})});const N=async F=>{try{await r(F.email,F.password,i),a(`/${i}`)}catch{}},j=async F=>{try{await n(F.pin,i),a(`/${i}`)}catch{}};return o.jsx("div",{className:"min-h-screen flex items-center justify-center",style:{background:"var(--color-background)"},children:o.jsxs("div",{className:"max-w-md w-full space-y-8 p-8",children:[o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"w-16 h-16 mx-auto rounded-2xl flex items-center justify-center text-white mb-6",style:{background:"var(--gradient-primary)"},children:o.jsx(Cc,{className:"w-8 h-8"})}),o.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:t.name}),o.jsxs("p",{className:"text-gray-600 mb-8",children:[Mv(t.businessType)," Staff Login"]})]}),o.jsxs("div",{className:"flex rounded-lg bg-gray-100 p-1 mb-6",children:[o.jsxs("button",{type:"button",onClick:()=>c("email"),className:`flex-1 flex items-center justify-center px-4 py-2 rounded-md text-sm font-medium transition-colors ${l==="email"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:[o.jsx(Z2,{className:"w-4 h-4 mr-2"}),"Email"]}),o.jsxs("button",{type:"button",onClick:()=>c("pin"),className:`flex-1 flex items-center justify-center px-4 py-2 rounded-md text-sm font-medium transition-colors ${l==="pin"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:[o.jsx(R_,{className:"w-4 h-4 mr-2"}),"PIN"]})]}),l==="email"&&o.jsxs("form",{onSubmit:m(N),className:"space-y-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:"form-label",children:"Email Address"}),o.jsx("input",{...f("email",{required:"Email is required",pattern:{value:/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i,message:"Please enter a valid email address"}}),type:"email",className:`input ${h.email?"border-red-300":""}`,placeholder:"Enter your email address",disabled:s}),h.email&&o.jsx("p",{className:"mt-1 text-sm text-red-600",children:h.email.message})]}),o.jsxs("div",{children:[o.jsx("label",{className:"form-label",children:"Password"}),o.jsxs("div",{className:"relative",children:[o.jsx("input",{...f("password",{required:"Password is required",minLength:{value:6,message:"Password must be at least 6 characters"}}),type:u?"text":"password",className:`input pr-10 ${h.password?"border-red-300":""}`,placeholder:"Enter your password",disabled:s}),o.jsx("button",{type:"button",onClick:()=>d(!u),className:"absolute inset-y-0 right-0 pr-3 flex items-center",disabled:s,children:u?o.jsx(zc,{className:"h-4 w-4 text-gray-400"}):o.jsx(Ci,{className:"h-4 w-4 text-gray-400"})})]}),h.password&&o.jsx("p",{className:"mt-1 text-sm text-red-600",children:h.password.message})]}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("label",{className:"flex items-center",children:[o.jsx("input",{type:"checkbox",className:"rounded border-gray-300"}),o.jsx("span",{className:"ml-2 text-sm text-gray-600",children:"Remember me"})]}),o.jsx("a",{href:"#",className:"text-sm font-medium",style:{color:"var(--color-primary)"},children:"Forgot password?"})]}),o.jsxs("button",{type:"submit",disabled:!g||s,className:"w-full btn btn-theme-primary disabled:opacity-50 disabled:cursor-not-allowed",children:[s?o.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}):o.jsx(eK,{className:"w-4 h-4 mr-2"}),s?"Signing In...":"Sign In"]})]}),l==="pin"&&o.jsxs("form",{onSubmit:v(j),className:"space-y-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:"form-label",children:"4-Digit PIN"}),o.jsx("input",{...p("pin",{required:"PIN is required",pattern:{value:/^\d{4}$/,message:"PIN must be exactly 4 digits"}}),type:"text",inputMode:"numeric",maxLength:4,className:`input text-center text-2xl tracking-widest ${b.pin?"border-red-300":""}`,placeholder:"",disabled:s}),b.pin&&o.jsx("p",{className:"mt-1 text-sm text-red-600",children:b.pin.message})]}),o.jsxs("button",{type:"submit",disabled:!w||s,className:"w-full btn btn-theme-primary disabled:opacity-50 disabled:cursor-not-allowed",children:[s?o.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}):o.jsx(R_,{className:"w-4 h-4 mr-2"}),s?"Signing In...":"Sign In with PIN"]})]}),o.jsx("div",{className:"mt-6 pt-6 border-t border-gray-200 text-center",children:o.jsx("p",{className:"text-sm text-gray-600",children:"Need access? Contact your manager or restaurant owner."})})]})})}const BK="modulepreload",UK=function(t){return"/"+t},_C={},Bi=function(e,r,n){let s=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),l=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));s=Promise.allSettled(r.map(c=>{if(c=UK(c),c in _C)return;_C[c]=!0;const u=c.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const f=document.createElement("link");if(f.rel=u?"stylesheet":BK,u||(f.as="script"),f.crossOrigin="",f.href=c,l&&f.setAttribute("nonce",l),document.head.appendChild(f),u)return new Promise((m,h)=>{f.addEventListener("load",m),f.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${c}`)))})}))}function a(i){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=i,window.dispatchEvent(l),!l.defaultPrevented)throw i}return s.then(i=>{for(const l of i||[])l.status==="rejected"&&a(l.reason);return e().catch(a)})};class NC{static async checkAndFixTableStatuses(e){try{console.log(" TableStatusService: Starting table status audit for restaurant:",e);const r=await pn.getTablesForRestaurant(e);if(!r.success||!r.data)return{success:!1,fixed:[],errors:["Failed to fetch tables"]};const n=r.data,s=[],a=[];for(const i of n)if(i.status==="occupied")try{const l=await Za.getOrdersByTable(e,i.id);if(l.success&&l.data){const c=l.data.filter(u=>["placed","confirmed","preparing","ready"].includes(u.status));if(c.length===0){console.log(` Fixing table ${i.number}: occupied -> available (no active orders)`);const u=await pn.updateTable(i.id,e,{status:"available"});u.success?s.push({tableId:i.id,tableNumber:i.number,currentStatus:"occupied",correctStatus:"available",reason:"No active orders found"}):a.push(`Failed to update table ${i.number}: ${u.error}`)}else console.log(` Table ${i.number} correctly shows occupied (${c.length} active orders)`)}else{console.log(` Fixing table ${i.number}: occupied -> available (failed to fetch orders)`);const c=await pn.updateTable(i.id,e,{status:"available"});c.success?s.push({tableId:i.id,tableNumber:i.number,currentStatus:"occupied",correctStatus:"available",reason:"Could not verify orders"}):a.push(`Failed to update table ${i.number}: ${c.error}`)}}catch(l){console.error(`Error checking table ${i.number}:`,l),a.push(`Error checking table ${i.number}: ${l}`)}return console.log(" TableStatusService: Audit complete",{tablesChecked:n.length,fixesApplied:s.length,errors:a.length}),{success:!0,fixed:s,errors:a}}catch(r){return console.error(" TableStatusService: Audit failed:",r),{success:!1,fixed:[],errors:[String(r)]}}}static async autoFixWithNotification(e){try{fe(" Checking table statuses...",{icon:"",duration:1500,style:{fontSize:"12px",padding:"6px 10px",maxWidth:"200px",background:"rgba(59, 130, 246, 0.85)",color:"#fff",borderRadius:"6px"}});const r=await this.checkAndFixTableStatuses(e);if(r.success){if(r.fixed.length>0){const n=r.fixed.map(s=>s.tableNumber).join(", ");fe.success(` Fixed ${r.fixed.length} table status(es): Tables ${n}`),r.fixed.forEach(s=>{console.log(` Fixed Table ${s.tableNumber}: ${s.currentStatus}  ${s.correctStatus} (${s.reason})`)})}else fe.success(" All table statuses are correct");r.errors.length>0&&(console.warn(" Some tables had errors:",r.errors),fe(` ${r.errors.length} table(s) had errors - check console`,{icon:""}))}else fe.error(" Failed to check table statuses"),console.error(" Table status check failed:",r.errors)}catch(r){console.error(" Auto-fix error:",r),fe.error(" Error checking table statuses")}}}const uD=({isVisible:t,stage:e,message:r})=>{if(!t)return null;const s=(()=>{switch(e){case"processing":return{icon:o.jsx(Xp,{className:"w-8 h-8 text-blue-500 animate-pulse"}),title:"Processing Voice Command",description:r||"Analyzing your order...",bgColor:"from-blue-50 to-blue-100",borderColor:"border-blue-200"};case"placing":return{icon:o.jsx(Ad,{className:"w-8 h-8 text-orange-500 animate-spin"}),title:"Placing Order",description:r||"Adding items and creating order...",bgColor:"from-orange-50 to-orange-100",borderColor:"border-orange-200"};case"completed":return{icon:o.jsx(Ai,{className:"w-8 h-8 text-green-500"}),title:"Order Placed Successfully",description:r||"Preparing KOT...",bgColor:"from-green-50 to-green-100",borderColor:"border-green-200"}}})();return o.jsxs("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-[60] flex items-center justify-center",children:[o.jsx("div",{className:`bg-gradient-to-br ${s.bgColor} ${s.borderColor} border-2 rounded-2xl p-8 max-w-md w-full mx-4 shadow-2xl`,children:o.jsxs("div",{className:"text-center space-y-6",children:[o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:"w-20 h-20 mx-auto bg-white rounded-full flex items-center justify-center shadow-lg",children:s.icon}),(e==="processing"||e==="placing")&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"absolute inset-0 w-20 h-20 mx-auto border-4 border-blue-200 rounded-full animate-ping opacity-20"}),o.jsx("div",{className:"absolute inset-0 w-20 h-20 mx-auto border-4 border-blue-300 rounded-full animate-ping opacity-30 animation-delay-300"})]})]}),o.jsxs("div",{className:"space-y-3",children:[o.jsx("h3",{className:"text-xl font-bold text-gray-800",children:s.title}),o.jsx("p",{className:"text-gray-600 font-medium",children:s.description})]}),o.jsx("div",{className:"w-full h-2 bg-gray-200 rounded-full overflow-hidden",children:o.jsx("div",{className:`h-full rounded-full transition-all duration-1000 ${e==="processing"?"w-1/3 bg-blue-500":e==="placing"?"w-2/3 bg-orange-500":"w-full bg-green-500"}`})}),e==="processing"&&o.jsxs("div",{className:"flex justify-center space-x-2",children:[o.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full animate-bounce"}),o.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full animate-bounce animation-delay-150"}),o.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full animate-bounce animation-delay-300"})]})]})}),o.jsx("style",{children:`
        .animation-delay-150 { animation-delay: 150ms; }
        .animation-delay-300 { animation-delay: 300ms; }
      `})]})},dD=({isVisible:t,onClose:e,onPrintKOT:r,orderDetails:n})=>{if(X.useEffect(()=>{if(t&&n){const a=setTimeout(()=>{r(),setTimeout(()=>{e()},100)},300);return()=>clearTimeout(a)}},[t,n,r,e]),!t)return null;const s=()=>{r(),e()};return o.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-[70] flex items-center justify-center",children:o.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full mx-4 overflow-hidden",children:[o.jsx("div",{className:"bg-gradient-to-r from-green-500 to-green-600 text-white p-6",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:"w-10 h-10 bg-white/20 rounded-full flex items-center justify-center",children:o.jsx(Ai,{className:"w-6 h-6"})}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-bold",children:"Order Placed!"}),o.jsx("p",{className:"text-sm text-green-100",children:"Voice command completed"})]})]}),o.jsx("button",{onClick:e,className:"w-8 h-8 bg-white/20 rounded-full flex items-center justify-center hover:bg-white/30 transition-colors",children:o.jsx(Zn,{className:"w-5 h-5"})})]})}),o.jsxs("div",{className:"p-6",children:[n&&o.jsx("div",{className:"mb-6",children:o.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-3",children:[o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Order Number"}),o.jsx("span",{className:"font-bold text-gray-900",children:n.orderNumber})]}),o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Table"}),o.jsx("span",{className:"font-bold text-gray-900",children:n.tableNumber})]}),o.jsxs("div",{className:"border-t pt-3",children:[o.jsx("span",{className:"text-sm font-medium text-gray-600 block mb-2",children:"Items Ordered"}),o.jsx("div",{className:"space-y-1",children:n.items.map((a,i)=>o.jsxs("div",{className:"flex justify-between text-sm",children:[o.jsx("span",{className:"text-gray-700",children:a.name}),o.jsxs("span",{className:"text-gray-900 font-medium",children:["x",a.quantity]})]},i))})]})]})}),o.jsxs("div",{className:"text-center mb-6",children:[o.jsx("p",{className:"text-gray-700 mb-2",children:"Your order has been placed successfully via voice command."}),o.jsx("p",{className:"text-sm text-green-600 font-medium",children:" KOT is being sent to kitchen automatically..."})]}),o.jsxs("div",{className:"flex space-x-3",children:[o.jsx("button",{onClick:e,className:"flex-1 px-4 py-3 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors font-medium",children:"Skip"}),o.jsxs("button",{onClick:s,className:"flex-1 px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium flex items-center justify-center space-x-2",autoFocus:!0,children:[o.jsx(JR,{className:"w-4 h-4"}),o.jsx("span",{children:"Print KOT"})]})]})]})]})})};function $K(){const{restaurant:t}=ya(),{user:e}=Xc(),r=(Ve,tt,nt)=>`
      <!DOCTYPE html>
      <html>
      <head>
        <title>KOT - ${Ve.orderNumber}</title>
        <style>
          body { 
            font-family: 'Courier New', monospace; 
            margin: 0; 
            padding: 0 10px; 
            width: 100%;
            background: #fff;
          }
          .kot-container {
            width: 100%;
            padding: 15px 5px;
            min-height: 100vh;
          }
          .header { 
            text-align: center; 
            border-bottom: 2px solid #000; 
            padding-bottom: 10px; 
            margin-bottom: 15px; 
          }
          .restaurant-name { 
            font-size: 18px; 
            font-weight: bold; 
            margin-bottom: 5px;
          }
          .order-info { 
            margin-bottom: 15px; 
            line-height: 1.4;
          }
          .items { 
            border-collapse: collapse; 
            width: 100%; 
            margin: 15px 0;
          }
          .items th, .items td { 
            border: 1px solid #000; 
            padding: 8px; 
            text-align: left; 
            font-size: 13px;
          }
          .items th { 
            background-color: #f0f0f0; 
            font-weight: bold;
          }
          .footer { 
            margin-top: 20px; 
            text-align: center; 
            font-size: 12px; 
            border-top: 1px dashed #000;
            padding-top: 15px;
          }
          .order-notes {
            margin-top: 15px; 
            padding: 10px; 
            border: 1px solid #000;
            background: #f9f9f9;
          }
          @media print {
            body { 
              margin: 0; 
              padding: 0 8px;
              width: 100%;
            }
            .kot-container {
              padding: 10px 0;
              width: 100%;
              min-height: auto;
            }
            .no-print { display: none; }
            .header, .order-info, .items, .order-notes, .footer {
              page-break-inside: avoid;
            }
          }
        </style>
      </head>
      <body>
        <div class="kot-container">
        <div class="header">
          <div class="restaurant-name">${tt.name}</div>
          <div>KITCHEN ORDER TICKET</div>
        </div>
        
        <div class="order-info">
          <p><strong>Order #:</strong> ${Ve.orderNumber}</p>
          <p><strong>Table:</strong> ${nt.number} (${nt.area})</p>
          <p><strong>Date/Time:</strong> ${Ve.createdAt.toLocaleString()}</p>
          <p><strong>Staff:</strong> ${Ve.staffId}</p>
        </div>
        
        <table class="items">
          <thead>
            <tr>
              <th>Qty</th>
              <th>Item</th>
              <th>Notes</th>
            </tr>
          </thead>
          <tbody>
            ${Ve.items.map(At=>`
              <tr>
                <td>${At.quantity}</td>
                <td>${At.name}</td>
                <td>${At.notes||""}</td>
              </tr>
            `).join("")}
          </tbody>
        </table>
        
        ${Ve.notes?`
            <div class="order-notes">
            <strong>Order Notes:</strong><br>
            ${Ve.notes}
          </div>
        `:""}
        
        <div class="footer">
          <p>*** KITCHEN COPY ***</p>
          <p>Printed at: ${new Date().toLocaleString()}</p>
          </div>
        </div>
      </body>
      </html>
    `,n=()=>{if(Y&&t){const Ve=a.find(tt=>tt.number===Y.tableNumber);if(Ve){const tt={orderNumber:Y.orderNumber,items:Y.items,createdAt:new Date,staffId:(e==null?void 0:e.name)||"Voice Order",notes:`Voice order placed at ${new Date().toLocaleTimeString()}`},nt=r(tt,t,Ve),At=window.open("","_blank");At&&(At.document.write(nt),At.document.close(),At.focus(),At.print(),At.close()),fe.success("KOT sent to kitchen")}}},s=Wl(),[a,i]=X.useState([]),[l,c]=X.useState([]),[u,d]=X.useState(!0),[f,m]=X.useState(!1),[h,g]=X.useState(null),[p,v]=X.useState(!1),[b,w]=X.useState(!1),[N,j]=X.useState(!1),[F,U]=X.useState(null),[A,S]=X.useState("all"),[k,M]=X.useState("all"),[I,E]=X.useState(!1),[D,G]=X.useState("processing"),[Z,ae]=X.useState(""),[de,se]=X.useState(!1),[Y,ye]=X.useState(null),{register:re,handleSubmit:C,reset:O,setValue:L,formState:{errors:H,isValid:K}}=Hn({mode:"onChange"}),{register:q,handleSubmit:te,reset:oe,formState:{errors:V,isValid:xe}}=Hn({mode:"onChange"}),B=X.useCallback(async(Ve=!1)=>{var tt;if(t)try{d(!0),Ve&&(pn.clearCache(t.id),m(!0));const[nt,At]=await Promise.all([pn.getTablesForRestaurant(t.id),Ku.getTableAreasForRestaurant(t.id)]);if(nt.success&&nt.data){i(nt.data);const mr=[...new Set(nt.data.map(Wt=>Wt.area))].sort();c(mr),g(new Date),console.log(`Debug: tables.length = ${nt.data.length}, tableAreas.length = ${((tt=At.data)==null?void 0:tt.length)||0}, isLoading = false`),Ve&&fe.success("Tables synchronized successfully")}else fe.error(nt.error||"Failed to load tables")}catch{fe.error("Failed to load tables")}finally{d(!1),m(!1)}},[t]),Ee=X.useCallback(async()=>{if(t)try{if(a.length===0){console.log(" No tables found, initializing default tables...");const Ve=await pn.initializeDefaultTables(t.id);if(Ve.success&&Ve.data){i(Ve.data);const tt=[...new Set(Ve.data.map(nt=>nt.area))].sort();c(tt),g(new Date),fe.success("Welcome! Default tables have been created for you.")}}}catch(Ve){console.error("Failed to initialize default tables:",Ve)}},[t]);X.useEffect(()=>{t&&(B(),setTimeout(()=>{NC.autoFixWithNotification(t.id)},3e3))},[t]),X.useEffect(()=>{t&&a.length===0&&!u&&Ee()},[t,a.length,u,Ee]),X.useEffect(()=>{const Ve=()=>{!document.hidden&&t&&B(!0)};return document.addEventListener("visibilitychange",Ve),()=>document.removeEventListener("visibilitychange",Ve)},[t]);const Me=Ve=>{Ve.status==="available"&&s(`/${t==null?void 0:t.slug}/order/${Ve.id}`)};X.useEffect(()=>{const Ve=tt=>{const{tableId:nt,newStatus:At}=tt.detail;console.log(" Tables: Received table status update:",{tableId:nt,newStatus:At}),i(mr=>mr.map(Wt=>Wt.id===nt?{...Wt,status:At}:Wt)),setTimeout(()=>{B(!0)},2e3)};return window.addEventListener("tableStatusUpdated",Ve),()=>{window.removeEventListener("tableStatusUpdated",Ve)}},[]);const Ie=async Ve=>{if(t)try{const tt=await pn.createTable({restaurantId:t.id,number:Ve.number,area:Ve.area,areaId:Ve.area.toLowerCase().replace(/\s+/g,"-"),capacity:Ve.capacity,status:"available",isActive:!0});tt.success&&tt.data?(i(nt=>[...nt,tt.data]),l.includes(Ve.area)||c(nt=>[...nt,Ve.area].sort()),fe.success(`Table ${Ve.number} created successfully!`),v(!1),O()):fe.error(tt.error||"Failed to create table")}catch{fe.error("Failed to create table")}},he=async Ve=>{l.includes(Ve.areaName)?fe.error("Area already exists"):(c(tt=>[...tt,Ve.areaName].sort()),fe.success(`Area "${Ve.areaName}" added successfully!`),w(!1),oe())},qe=async(Ve,tt)=>{if(t)try{const nt=await pn.updateTable(Ve.id,t.id,{status:tt});nt.success&&nt.data?(i(At=>At.map(mr=>mr.id===Ve.id?nt.data:mr)),fe.success(`Table ${Ve.number} ${tt}`)):fe.error(nt.error||"Failed to update table")}catch{fe.error("Failed to update table")}},ct=Ve=>{U(Ve),L("number",Ve.number),L("area",Ve.area),L("capacity",Ve.capacity),j(!0)},lt=async Ve=>{if(!(!t||!F))try{const tt=await pn.updateTable(F.id,t.id,{number:Ve.number,area:Ve.area,areaId:Ve.area.toLowerCase().replace(/\s+/g,"-"),capacity:Ve.capacity});tt.success&&tt.data?(i(nt=>nt.map(At=>At.id===F.id?tt.data:At)),l.includes(Ve.area)||c(nt=>[...nt,Ve.area].sort()),fe.success(`Table ${Ve.number} updated successfully!`),j(!1),U(null),O()):fe.error(tt.error||"Failed to update table")}catch{fe.error("Failed to update table")}},ue=async Ve=>{if(!(!t||!confirm(`Delete Table ${Ve.number}?`)))try{const tt=await pn.deleteTable(Ve.id,t.id);tt.success?(i(nt=>nt.filter(At=>At.id!==Ve.id)),fe.success("Table deleted successfully")):fe.error(tt.error||"Failed to delete table")}catch{fe.error("Failed to delete table")}},Ne=X.useCallback(Ve=>{const{command:tt}=Ve.detail;if(console.log(" Tables: Voice table status command received:",tt),!tt.tableNumber){fe.error(" Please specify table number for status update");return}const nt=a.find(Te=>parseInt(Te.number)===tt.tableNumber);if(!nt){fe.error(` Table ${tt.tableNumber} not found`);return}const At={occupied:"occupied",available:"available",reserved:"reserved",cleaning:"cleaning",busy:"occupied",free:"available",empty:"available",clean:"cleaning"},mr=tt.originalText.toLowerCase();let Wt=null;for(const[Te,je]of Object.entries(At))if(mr.includes(Te)){Wt=je,console.log(` Detected status keyword: ${Te} -> ${je}`);break}Wt?(console.log(` Updating table ${nt.number} from ${nt.status} to ${Wt}`),qe(nt,Wt),fe.success(` Table ${nt.number} status changed to ${Wt}`)):(console.log(` No status keyword found in: "${mr}"`),fe.error(` Please specify status for table ${nt.number}: available, occupied, reserved, or cleaning`))},[a,qe]),Ae=X.useCallback(Ve=>{const{command:tt}=Ve.detail;if(console.log(" Tables: Voice order command received:",tt),tt.tableNumber){const nt=a.find(At=>parseInt(At.number)===tt.tableNumber);if(nt)if(console.log(" Tables: Found table:",{id:nt.id,number:nt.number,status:nt.status}),tt.menuItems&&tt.menuItems.length>0){console.log(" Tables: Processing voice order on current page"),E(!0),G("processing"),ae("Processing voice command..."),fe.dismiss();try{G("placing"),ae("Creating your order..."),setTimeout(async()=>{var At;try{if(!t||!e)throw new Error("Restaurant or user not available");const{MenuService:mr}=await Bi(async()=>{const{MenuService:st}=await Promise.resolve().then(()=>SC);return{MenuService:st}},void 0),{OrderService:Wt}=await Bi(async()=>{const{OrderService:st}=await Promise.resolve().then(()=>vC);return{OrderService:st}},void 0),{TableService:Te}=await Bi(async()=>{const{TableService:st}=await Promise.resolve().then(()=>bC);return{TableService:st}},void 0),je=await mr.getMenuItemsForRestaurant(t.id);if(!je.success||!je.data)throw new Error("Failed to load menu items");const et=je.data,St=[];for(const st of tt.menuItems){const Qt=(nr=>{const dr=Et=>Et.toLowerCase().replace(/s$/,"").replace(/ies$/,"y").replace(/es$/,"").trim(),Vr=nr.toLowerCase().split(" ").map(dr);return et.find(Et=>{const qr=Et.name.toLowerCase().split(" ").map(dr);return Vr.every(Qr=>qr.some(Wr=>Wr.includes(Qr)||Qr.includes(Wr)))})})(st.name);if(Qt){console.log(` Tables: Found menu item: ${Qt.name} for voice item: ${st.name}`);const nr={id:Qt.id,menuItemId:Qt.id,name:Qt.name,price:Qt.price,quantity:st.quantity,total:Qt.price*st.quantity,variants:[],notes:`Voice order placed from Tables page at ${new Date().toLocaleTimeString()}`};St.push(nr)}}if(St.length===0)throw new Error("No valid menu items found");await Te.updateTable(nt.id,t.id,{status:"occupied"});const vt=await Wt.createOrder(t.id,nt.id,e.id,St,((At=t.settings)==null?void 0:At.taxRate)||8.5,`Voice order: ${tt.menuItems.map(st=>`${st.quantity}x ${st.name}`).join(", ")} - placed at ${new Date().toLocaleTimeString()}`);if(vt.success&&vt.data){const st=vt.data;console.log(" Tables: Voice order created successfully:",{orderId:st.id,orderNumber:st.orderNumber}),G("completed"),ae("Order placed successfully!"),ye({orderNumber:st.orderNumber,tableNumber:nt.number,items:tt.menuItems.map(zt=>({name:zt.name,quantity:zt.quantity}))}),await B(!0),setTimeout(()=>{E(!1),n()},1e3)}else throw new Error(vt.error||"Failed to create order")}catch(mr){console.error(" Tables: Voice ordering failed:",mr),E(!1),fe.error(" Failed to place order. Please try manually.")}},500)}catch(At){console.error(" Tables: Voice command processing failed:",At),E(!1),fe.error(" Failed to process voice command.")}}else console.log(" Tables: No menu items, just navigating to order page"),s(`/${t==null?void 0:t.slug}/order/${nt.id}`),fe.success(` Navigating to place order for table ${nt.number}`);else console.log(" Tables: Table not found:",tt.tableNumber),fe.error(`Table ${tt.tableNumber} not found.`)}},[a,s,t]),Be=X.useCallback(async Ve=>{const{command:tt}=Ve.detail;if(console.log(" Tables: Voice payment command received:",tt),!tt.tableNumber){fe.error(" Please specify table number for payment");return}const nt=a.find(At=>parseInt(At.number)===tt.tableNumber);if(!nt){fe.error(` Table ${tt.tableNumber} not found`);return}if(nt.status!=="occupied"){fe.error(` Table ${tt.tableNumber} is ${nt.status}, no orders to pay for`);return}console.log(" Tables: Navigating to order page for payment processing"),s(`/${t==null?void 0:t.slug}/order/${nt.id}`),setTimeout(()=>{console.log(" Tables: Re-dispatching payment command for TakeOrder component");const At=new CustomEvent("voicePaymentCommand",{detail:{command:tt}});window.dispatchEvent(At)},1500),fe.success(` Opening payment for table ${nt.number}...`)},[a,s,t]),Ue=X.useCallback(async Ve=>{const{command:tt}=Ve.detail;if(console.log(" Tables: Voice KOT print command received:",tt),!tt.tableNumber){fe.error(" Please specify table number for KOT printing");return}const nt=a.find(At=>parseInt(At.number)===tt.tableNumber);if(!nt){fe.error(` Table ${tt.tableNumber} not found`);return}if(nt.status!=="occupied"){fe.error(` Table ${tt.tableNumber} is ${nt.status}, no orders to print KOT for`);return}console.log(" Tables: Navigating to order page for KOT printing"),s(`/${t==null?void 0:t.slug}/order/${nt.id}`),setTimeout(()=>{console.log(" Tables: Re-dispatching KOT print command for TakeOrder component");const At=new CustomEvent("voiceKotPrintCommand",{detail:{command:tt}});window.dispatchEvent(At)},1500),fe.success(` Opening KOT printing for table ${nt.number}...`)},[a,s,t]),Ce=X.useCallback(async Ve=>{const{command:tt}=Ve.detail;if(console.log(" Tables: Voice order cancel command received:",tt),!tt.tableNumber){fe.error(" Please specify table number for order cancellation");return}const nt=a.find(At=>parseInt(At.number)===tt.tableNumber);if(!nt){fe.error(` Table ${tt.tableNumber} not found`);return}if(nt.status!=="occupied"){fe.error(` Table ${tt.tableNumber} is ${nt.status}, no orders to cancel`);return}console.log(" Tables: Navigating to order page for order cancellation"),s(`/${t==null?void 0:t.slug}/order/${nt.id}`),setTimeout(()=>{console.log(" Tables: Re-dispatching order cancel command for TakeOrder component");const At=new CustomEvent("voiceOrderCancelCommand",{detail:{command:tt}});window.dispatchEvent(At)},1500),fe.success(` Opening order cancellation for table ${nt.number}...`)},[a,s,t]),Ye=X.useCallback(async Ve=>{const{command:tt}=Ve.detail;if(console.log(" Tables: Voice table merge command received:",tt),!tt.tableNumber||!tt.targetTableNumber){fe.error(" Please specify both source and target table numbers for merging");return}const nt=a.find(Wt=>parseInt(Wt.number)===tt.tableNumber),At=a.find(Wt=>parseInt(Wt.number)===tt.targetTableNumber);if(!nt){fe.error(` Source table ${tt.tableNumber} not found`);return}if(!At){fe.error(` Target table ${tt.targetTableNumber} not found`);return}if(nt.status!=="occupied"){fe.error(` Source table ${tt.tableNumber} has no orders to merge`);return}confirm(`Merge all orders from Table ${nt.number} to Table ${At.number}?`)&&(await qe(nt,"available"),await qe(At,"occupied"),fe.success(` Orders merged from table ${nt.number} to table ${At.number}`))},[a,qe]),It=X.useCallback(async Ve=>{const{command:tt}=Ve.detail;if(console.log(" Tables: Voice table transfer command received:",tt),!tt.tableNumber||!tt.targetTableNumber){fe.error(" Please specify both source and target table numbers for transfer");return}const nt=a.find(Wt=>parseInt(Wt.number)===tt.tableNumber),At=a.find(Wt=>parseInt(Wt.number)===tt.targetTableNumber);if(!nt){fe.error(` Source table ${tt.tableNumber} not found`);return}if(!At){fe.error(` Target table ${tt.targetTableNumber} not found`);return}if(nt.status!=="occupied"){fe.error(` Source table ${tt.tableNumber} has no orders to transfer`);return}if(At.status!=="available"){fe.error(` Target table ${tt.targetTableNumber} is not available`);return}confirm(`Transfer all orders from Table ${nt.number} to Table ${At.number}?`)&&(await qe(nt,"available"),await qe(At,"occupied"),fe.success(` Orders transferred from table ${nt.number} to table ${At.number}`))},[a,qe]),Dt=X.useCallback(async Ve=>{var Wt,Te;const{command:tt}=Ve.detail;if(console.log(" Tables: Voice customer command received:",tt),!t){fe.error(" Restaurant context not available");return}const{customerName:nt,customerPhone:At,customerEmail:mr}=tt;if(!nt&&!At){fe.error(" Please specify customer name or phone number");return}try{const je={name:nt||"",phone:At||"",email:mr||"",address:"",preferences:["voice_added"]};console.log(" Creating customer via voice:",je);const{CustomerService:et}=await Bi(async()=>{const{CustomerService:vt}=await Promise.resolve().then(()=>fD);return{CustomerService:vt}},void 0),St=await et.createCustomer(t.id,je);if(St.success){const vt=nt||`Customer with phone ${At}`;fe.success(` Successfully added ${vt} to CRM!`),mr&&fe.success(` Email ${mr} saved for ${vt}`),console.log(" Customer created successfully:",St.data)}else console.error(" Customer creation failed:",St.error),(Wt=St.error)!=null&&Wt.includes("already exists")||(Te=St.error)!=null&&Te.includes("duplicate")?fe.error(" Customer with this information already exists in CRM"):fe.error(` Failed to add customer: ${St.error||"Unknown error"}`)}catch(je){console.error(" Error creating customer:",je),fe.error(" Failed to add customer to CRM")}},[t]),Ot=X.useCallback(async Ve=>{var At;const{command:tt}=Ve.detail;if(console.log(" Tables: Voice place order command received (ghost ordering):",tt),!t||!e){fe.error(" Unable to place order at this time");return}if(!tt.tableNumber){fe.error(" Please specify table number for placing order");return}const nt=a.find(mr=>parseInt(mr.number)===tt.tableNumber);if(!nt){fe.error(` Table ${tt.tableNumber} not found`);return}if(!tt.menuItems||tt.menuItems.length===0){console.log(" Tables: No menu items, navigating to order page instead"),s(`/${t.slug}/order/${nt.id}`);return}try{console.log(" Tables: Starting ghost ordering process...");const{MenuService:mr}=await Bi(async()=>{const{MenuService:st}=await Promise.resolve().then(()=>SC);return{MenuService:st}},void 0),{OrderService:Wt}=await Bi(async()=>{const{OrderService:st}=await Promise.resolve().then(()=>vC);return{OrderService:st}},void 0),{TableService:Te}=await Bi(async()=>{const{TableService:st}=await Promise.resolve().then(()=>bC);return{TableService:st}},void 0),je=await mr.getMenuItemsForRestaurant(t.id);if(!je.success||!je.data)throw new Error("Failed to load menu items");const et=je.data;console.log(" Tables: Loaded menu items for matching");const St=[];for(const st of tt.menuItems){const Qt=(nr=>{const dr=Et=>Et.toLowerCase().replace(/s$/,"").replace(/ies$/,"y").replace(/es$/,"").trim(),Vr=nr.toLowerCase().split(" ").map(dr);return et.find(Et=>{const qr=Et.name.toLowerCase().split(" ").map(dr);return Vr.every(Qr=>qr.some(Wr=>Wr.includes(Qr)||Qr.includes(Wr)))})})(st.name);if(Qt){console.log(` Tables: Found menu item: ${Qt.name} for voice item: ${st.name}`);const nr={id:Qt.id,menuItemId:Qt.id,name:Qt.name,price:Qt.price,quantity:st.quantity,total:Qt.price*st.quantity,variants:[],notes:`Voice order placed from Tables page at ${new Date().toLocaleTimeString()}`};St.push(nr)}else console.warn(` Tables: Menu item not found: ${st.name}`),fe.error(`Menu item "${st.name}" not found`)}if(St.length===0){fe.error(" No valid menu items found to place order");return}console.log(" Tables: Creating order directly in background...",{cartItems:St}),await Te.updateTable(nt.id,t.id,{status:"occupied"});const vt=await Wt.createOrder(t.id,nt.id,e.id,St,((At=t.settings)==null?void 0:At.taxRate)||8.5,`Voice order: ${tt.menuItems.map(st=>`${st.quantity}x ${st.name}`).join(", ")} - placed at ${new Date().toLocaleTimeString()}`);if(vt.success&&vt.data){const st=vt.data;console.log(" Tables: Ghost order created successfully:",{orderId:st.id,orderNumber:st.orderNumber}),await B(!0);const zt=tt.menuItems.map(Qt=>`${Qt.quantity}x ${Qt.name}`).join(", ");fe.success(` Order placed successfully: ${zt} for table ${nt.number}!`),setTimeout(()=>{console.log(" Tables: Generating KOT for ghost order...");const Qt=`
            <!DOCTYPE html>
            <html>
            <head>
              <title>KOT - ${st.orderNumber}</title>
              <style>
                body { 
                  font-family: 'Courier New', monospace; 
                  margin: 0; 
                  padding: 0 10px; 
                  width: 100%;
                  background: #fff;
                }
                .kot-container {
                  width: 100%;
                  padding: 15px 5px;
                  min-height: 100vh;
                }
                .header { 
                  text-align: center; 
                  border-bottom: 2px solid #000; 
                  padding-bottom: 10px; 
                  margin-bottom: 15px; 
                }
                .restaurant-name { 
                  font-size: 18px; 
                  font-weight: bold; 
                  margin-bottom: 5px;
                }
                .order-info { 
                  margin-bottom: 15px; 
                  line-height: 1.4;
                }
                .items { 
                  border-collapse: collapse; 
                  width: 100%; 
                  margin: 15px 0;
                }
                .items th, .items td { 
                  border: 1px solid #000; 
                  padding: 8px; 
                  text-align: left; 
                  font-size: 13px;
                }
                .items th { 
                  background-color: #f0f0f0; 
                  font-weight: bold;
                }
                .footer { 
                  margin-top: 20px; 
                  text-align: center; 
                  font-size: 12px; 
                  border-top: 1px dashed #000;
                  padding-top: 15px;
                }
                .order-notes {
                  margin-top: 15px; 
                  padding: 10px; 
                  border: 1px solid #000;
                  background: #f9f9f9;
                }
                @media print {
                  body { 
                    margin: 0; 
                    padding: 0 8px;
                    width: 100%;
                  }
                  .kot-container {
                    padding: 10px 0;
                    width: 100%;
                    min-height: auto;
                  }
                  .no-print { display: none; }
                  .header, .order-info, .items, .order-notes, .footer {
                    page-break-inside: avoid;
                  }
                }
              </style>
            </head>
            <body>
              <div class="kot-container">
              <div class="header">
                <div class="restaurant-name">${t.name}</div>
                <div>KITCHEN ORDER TICKET</div>
              </div>
              
              <div class="order-info">
                <p><strong>Order #:</strong> ${st.orderNumber}</p>
                <p><strong>Table:</strong> ${nt.number} (${nt.area})</p>
                <p><strong>Date/Time:</strong> ${st.createdAt.toLocaleString()}</p>
                <p><strong>Staff:</strong> ${st.staffId}</p>
              </div>
              
              <table class="items">
                <thead>
                  <tr>
                    <th>Qty</th>
                    <th>Item</th>
                    <th>Notes</th>
                  </tr>
                </thead>
                <tbody>
                  ${st.items.map(dr=>`
                    <tr>
                      <td>${dr.quantity}</td>
                      <td>${dr.name}</td>
                      <td>${dr.notes||""}</td>
                    </tr>
                  `).join("")}
                </tbody>
              </table>
              
              ${st.notes?`
                  <div class="order-notes">
                  <strong>Order Notes:</strong><br>
                  ${st.notes}
                </div>
              `:""}
              
              <div class="footer">
                <p>*** KITCHEN COPY ***</p>
                <p>Printed at: ${new Date().toLocaleString()}</p>
                </div>
              </div>
            </body>
            </html>
          `,nr=window.open("","_blank");nr&&(nr.document.write(Qt),nr.document.close(),nr.focus(),nr.print(),nr.close(),fe.success(" KOT sent to kitchen!"),console.log(" Tables: KOT generated and sent to kitchen"))},500)}else throw new Error(vt.error||"Failed to create order")}catch(mr){console.error(" Tables: Ghost ordering failed:",mr),fe.error(" Failed to place order. Please try manually.")}},[t,e,a,s,B]);X.useEffect(()=>(window.addEventListener("voiceTableStatusCommand",Ne),window.addEventListener("voiceOrderCommand",Ae),window.addEventListener("voicePlaceOrderCommand",Ot),window.addEventListener("voicePaymentCommand",Be),window.addEventListener("voiceKotPrintCommand",Ue),window.addEventListener("voiceOrderCancelCommand",Ce),window.addEventListener("voiceTableMergeCommand",Ye),window.addEventListener("voiceTableTransferCommand",It),window.addEventListener("voiceCustomerCommand",Dt),()=>{window.removeEventListener("voiceTableStatusCommand",Ne),window.removeEventListener("voiceOrderCommand",Ae),window.removeEventListener("voicePlaceOrderCommand",Ot),window.removeEventListener("voicePaymentCommand",Be),window.removeEventListener("voiceKotPrintCommand",Ue),window.removeEventListener("voiceOrderCancelCommand",Ce),window.removeEventListener("voiceTableMergeCommand",Ye),window.removeEventListener("voiceTableTransferCommand",It),window.removeEventListener("voiceCustomerCommand",Dt)}),[Ne,Ae,Ot,Be,Ue,Ce,Ye,It,Dt]);const Pt=a.filter(Ve=>{const tt=A==="all"||Ve.area===A,nt=k==="all"||Ve.status===k;return tt&&nt}),or={total:a.length,available:a.filter(Ve=>Ve.status==="available").length,occupied:a.filter(Ve=>Ve.status==="occupied").length,reserved:a.filter(Ve=>Ve.status==="reserved").length,cleaning:a.filter(Ve=>Ve.status==="cleaning").length};return t?o.jsxs("div",{className:"min-h-screen",style:{background:"var(--color-background)"},children:[o.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[o.jsx("div",{className:"mb-8",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Table Management"}),o.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-600 mt-2",children:[o.jsxs("span",{children:[or.total," total tables"]}),o.jsxs("span",{className:"text-green-600",children:[or.available," available"]}),o.jsxs("span",{className:"text-red-600",children:[or.occupied," occupied"]}),h&&o.jsxs("span",{className:"text-gray-500",children:["Last sync: ",h.toLocaleTimeString()]})]})]}),o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("button",{onClick:async()=>{await B(!0)},disabled:f,className:"p-2 text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",title:"Sync with server and fix areas",children:o.jsx(Ox,{className:`w-5 h-5 ${f?"animate-spin":""}`})}),o.jsx("button",{onClick:async()=>{t&&(await NC.autoFixWithNotification(t.id),setTimeout(()=>{B(!0)},1e3))},className:"p-2 text-blue-600 hover:bg-blue-100 rounded-lg transition-colors",title:"Fix table statuses (occupied tables without orders)",children:o.jsx(Id,{className:"w-5 h-5"})}),o.jsxs("button",{onClick:()=>s("settings"),className:"btn btn-secondary",title:"Manage table areas and settings",children:[o.jsx(Id,{className:"w-4 h-4 mr-2"}),"Settings"]}),o.jsxs("button",{onClick:()=>w(!0),className:"btn btn-secondary",children:[o.jsx(vd,{className:"w-4 h-4 mr-2"}),"Add Area"]}),o.jsxs("button",{onClick:()=>v(!0),className:"btn btn-theme-primary",children:[o.jsx(Wn,{className:"w-4 h-4 mr-2"}),"Add Table"]})]})]})}),o.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-5 gap-4 mb-8",children:[o.jsxs("div",{className:"card p-4 text-center",children:[o.jsx("div",{className:"text-2xl font-bold text-gray-900",children:or.total}),o.jsx("div",{className:"text-sm text-gray-600",children:"Total Tables"})]}),o.jsxs("div",{className:"card p-4 text-center",children:[o.jsx("div",{className:"text-2xl font-bold text-green-600",children:or.available}),o.jsx("div",{className:"text-sm text-gray-600",children:"Available"})]}),o.jsxs("div",{className:"card p-4 text-center",children:[o.jsx("div",{className:"text-2xl font-bold text-red-600",children:or.occupied}),o.jsx("div",{className:"text-sm text-gray-600",children:"Occupied"})]}),o.jsxs("div",{className:"card p-4 text-center",children:[o.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:or.reserved}),o.jsx("div",{className:"text-sm text-gray-600",children:"Reserved"})]}),o.jsxs("div",{className:"card p-4 text-center",children:[o.jsx("div",{className:"text-2xl font-bold text-blue-600",children:or.cleaning}),o.jsx("div",{className:"text-sm text-gray-600",children:"Cleaning"})]})]}),o.jsx("div",{className:"card p-4 mb-6",children:o.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[o.jsxs("div",{className:"flex-1",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Filter by Area"}),o.jsxs("select",{value:A,onChange:Ve=>S(Ve.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[o.jsxs("option",{value:"all",children:["All Areas (",a.length,")"]}),l.map(Ve=>o.jsxs("option",{value:Ve,children:[Ve," (",a.filter(tt=>tt.area===Ve).length,")"]},Ve))]})]}),o.jsxs("div",{className:"flex-1",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Filter by Status"}),o.jsxs("select",{value:k,onChange:Ve=>M(Ve.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[o.jsx("option",{value:"all",children:"All Status"}),o.jsx("option",{value:"available",children:"Available"}),o.jsx("option",{value:"occupied",children:"Occupied"}),o.jsx("option",{value:"reserved",children:"Reserved"}),o.jsx("option",{value:"cleaning",children:"Cleaning"}),o.jsx("option",{value:"out_of_service",children:"Out of Service"})]})]})]})}),u?o.jsxs("div",{className:"text-center py-12",children:[o.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mb-4"}),o.jsx("p",{className:"text-gray-600",children:"Loading tables..."})]}):a.length===0?o.jsxs("div",{className:"text-center py-12",children:[o.jsx(yd,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),o.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No tables yet"}),o.jsx("p",{className:"text-gray-600 mb-6",children:"Get started by creating your first table or area."}),o.jsxs("div",{className:"flex justify-center space-x-3",children:[o.jsxs("button",{onClick:()=>w(!0),className:"btn btn-secondary",children:[o.jsx(vd,{className:"w-4 h-4 mr-2"}),"Create Area"]}),o.jsxs("button",{onClick:()=>v(!0),className:"btn btn-theme-primary",children:[o.jsx(Wn,{className:"w-4 h-4 mr-2"}),"Create Table"]})]})]}):o.jsx("div",{className:"space-y-8",children:l.map(Ve=>{const tt=Pt.filter(nt=>nt.area===Ve);return tt.length===0?null:o.jsxs("div",{children:[o.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[o.jsx(vd,{className:"w-5 h-5 mr-2"}),Ve," (",tt.length,")"]}),o.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-6 gap-4",children:tt.map(nt=>o.jsx(zK,{table:nt,onUpdateStatus:qe,onEdit:ct,onDelete:ue,onClick:Me},nt.id))})]},Ve)})}),b&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:o.jsxs("div",{className:"bg-white rounded-2xl max-w-md w-full",children:[o.jsxs("div",{className:"p-6 border-b border-gray-200",children:[o.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Create New Area"}),o.jsx("p",{className:"text-gray-600 mt-1",children:"Add a new dining area to organize your tables"})]}),o.jsxs("form",{onSubmit:te(he),className:"p-6 space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Area Name"}),o.jsx("input",{...q("areaName",{required:"Area name is required"}),type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., Main Dining, Patio, VIP Section"}),V.areaName&&o.jsx("p",{className:"text-red-500 text-sm mt-1",children:V.areaName.message})]}),o.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[o.jsx("button",{type:"button",onClick:()=>{w(!1),oe()},className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Cancel"}),o.jsx("button",{type:"submit",disabled:!xe,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-colors",children:"Create Area"})]})]})]})}),p&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:o.jsxs("div",{className:"bg-white rounded-2xl max-w-md w-full",children:[o.jsxs("div",{className:"p-6 border-b border-gray-200",children:[o.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Create New Table"}),o.jsx("p",{className:"text-gray-600 mt-1",children:"Add a new table to your restaurant"})]}),o.jsxs("form",{onSubmit:C(Ie),className:"p-6 space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Table Number"}),o.jsx("input",{...re("number",{required:"Table number is required"}),type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., 1, A1, T01"}),H.number&&o.jsx("p",{className:"text-red-500 text-sm mt-1",children:H.number.message})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Area"}),o.jsxs("select",{...re("area",{required:"Area is required"}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[o.jsx("option",{value:"",children:"Select an area"}),l.map(Ve=>o.jsx("option",{value:Ve,children:Ve},Ve))]}),H.area&&o.jsx("p",{className:"text-red-500 text-sm mt-1",children:H.area.message})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Capacity"}),o.jsx("input",{...re("capacity",{required:"Capacity is required",min:{value:1,message:"Capacity must be at least 1"},max:{value:20,message:"Capacity cannot exceed 20"}}),type:"number",min:"1",max:"20",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Number of seats"}),H.capacity&&o.jsx("p",{className:"text-red-500 text-sm mt-1",children:H.capacity.message})]}),o.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[o.jsx("button",{type:"button",onClick:()=>{v(!1),O()},className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Cancel"}),o.jsx("button",{type:"submit",disabled:!K,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-colors",children:"Create Table"})]})]})]})}),N&&F&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:o.jsxs("div",{className:"bg-white rounded-2xl max-w-md w-full",children:[o.jsxs("div",{className:"p-6 border-b border-gray-200",children:[o.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Edit Table"}),o.jsx("p",{className:"text-gray-600 mt-1",children:"Update table information"})]}),o.jsxs("form",{onSubmit:C(lt),className:"p-6 space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Table Number"}),o.jsx("input",{...re("number",{required:"Table number is required"}),type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., 1, A1, T01"}),H.number&&o.jsx("p",{className:"text-red-500 text-sm mt-1",children:H.number.message})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Area"}),o.jsxs("select",{...re("area",{required:"Area is required"}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[o.jsx("option",{value:"",children:"Select an area"}),l.map(Ve=>o.jsx("option",{value:Ve,children:Ve},Ve))]}),H.area&&o.jsx("p",{className:"text-red-500 text-sm mt-1",children:H.area.message})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Capacity"}),o.jsx("input",{...re("capacity",{required:"Capacity is required",min:{value:1,message:"Capacity must be at least 1"},max:{value:20,message:"Capacity cannot exceed 20"}}),type:"number",min:"1",max:"20",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Number of seats"}),H.capacity&&o.jsx("p",{className:"text-red-500 text-sm mt-1",children:H.capacity.message})]}),o.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[o.jsx("button",{type:"button",onClick:()=>{j(!1),U(null),O()},className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Cancel"}),o.jsx("button",{type:"submit",disabled:!K,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-colors",children:"Update Table"})]})]})]})})]}),o.jsx(uD,{isVisible:I,stage:D,message:Z}),o.jsx(dD,{isVisible:de,onClose:()=>se(!1),onPrintKOT:n,orderDetails:Y})]}):null}function zK({table:t,onUpdateStatus:e,onEdit:r,onDelete:n}){const[s,a]=X.useState(!1),{restaurant:i}=ya(),l=f=>{switch(f){case"available":return o.jsx(Ai,{className:"w-4 h-4 text-green-500"});case"occupied":return o.jsx(kc,{className:"w-4 h-4 text-red-500"});case"reserved":return o.jsx(Ad,{className:"w-4 h-4 text-yellow-500"});case"cleaning":return o.jsx(Id,{className:"w-4 h-4 text-blue-500"});case"out_of_service":return o.jsx($c,{className:"w-4 h-4 text-gray-500"});default:return null}},c=f=>{switch(f){case"available":return"bg-green-50 border-green-200";case"occupied":return"bg-red-50 border-red-200";case"reserved":return"bg-yellow-50 border-yellow-200";case"cleaning":return"bg-blue-50 border-blue-200";case"out_of_service":return"bg-gray-50 border-gray-200";default:return"bg-gray-50 border-gray-200"}},u=()=>{i&&(t.status==="available"||t.status==="occupied")&&(window.location.href=`/${i.slug}/order/${t.id}`)},d=t.status==="available"||t.status==="occupied";return o.jsx("div",{className:`card border-2 ${c(t.status)} relative ${d?"cursor-pointer hover:shadow-lg transition-all duration-200 hover:-translate-y-1":""}`,onClick:d?u:void 0,children:o.jsxs("div",{className:"p-4",children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsxs("h3",{className:"font-semibold text-gray-900",children:["Table ",t.number]}),o.jsxs("div",{className:"relative",children:[o.jsx("button",{onClick:f=>{f.stopPropagation(),a(!s)},className:"p-1 hover:bg-gray-100 rounded",children:o.jsx(sK,{className:"w-4 h-4 text-gray-500"})}),s&&o.jsxs("div",{className:"absolute right-0 top-8 bg-white border border-gray-200 rounded-lg shadow-lg z-10 min-w-[160px]",children:[o.jsxs("button",{onClick:f=>{f.stopPropagation(),e(t,"available"),a(!1)},className:"w-full px-3 py-2 text-left text-sm hover:bg-gray-50 flex items-center space-x-2",children:[o.jsx(Ai,{className:"w-4 h-4 text-green-500"}),o.jsx("span",{children:"Available"})]}),o.jsxs("button",{onClick:f=>{f.stopPropagation(),e(t,"occupied"),a(!1)},className:"w-full px-3 py-2 text-left text-sm hover:bg-gray-50 flex items-center space-x-2",children:[o.jsx(kc,{className:"w-4 h-4 text-red-500"}),o.jsx("span",{children:"Occupied"})]}),o.jsxs("button",{onClick:f=>{f.stopPropagation(),e(t,"reserved"),a(!1)},className:"w-full px-3 py-2 text-left text-sm hover:bg-gray-50 flex items-center space-x-2",children:[o.jsx(Ad,{className:"w-4 h-4 text-yellow-500"}),o.jsx("span",{children:"Reserved"})]}),o.jsxs("button",{onClick:f=>{f.stopPropagation(),e(t,"cleaning"),a(!1)},className:"w-full px-3 py-2 text-left text-sm hover:bg-gray-50 flex items-center space-x-2",children:[o.jsx(Id,{className:"w-4 h-4 text-blue-500"}),o.jsx("span",{children:"Cleaning"})]}),o.jsxs("button",{onClick:f=>{f.stopPropagation(),e(t,"out_of_service"),a(!1)},className:"w-full px-3 py-2 text-left text-sm hover:bg-gray-50 flex items-center space-x-2",children:[o.jsx($c,{className:"w-4 h-4 text-gray-500"}),o.jsx("span",{children:"Out of Service"})]}),o.jsxs("div",{className:"border-t border-gray-200",children:[o.jsxs("button",{onClick:f=>{f.stopPropagation(),r(t),a(!1)},className:"w-full px-3 py-2 text-left text-sm hover:bg-gray-50 flex items-center space-x-2",children:[o.jsx(Hg,{className:"w-4 h-4 text-blue-500"}),o.jsx("span",{children:"Edit Table"})]}),o.jsxs("button",{onClick:f=>{f.stopPropagation(),n(t),a(!1)},className:"w-full px-3 py-2 text-left text-sm text-red-600 hover:bg-red-50 flex items-center space-x-2",children:[o.jsx(ga,{className:"w-4 h-4"}),o.jsx("span",{children:"Delete"})]})]})]})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex items-center justify-between text-sm",children:[o.jsx("span",{className:"text-gray-600",children:"Status:"}),o.jsxs("div",{className:"flex items-center space-x-1",children:[l(t.status),o.jsx("span",{className:"capitalize text-gray-700",children:t.status.replace("_"," ")})]})]}),o.jsxs("div",{className:"flex items-center justify-between text-sm",children:[o.jsx("span",{className:"text-gray-600",children:"Capacity:"}),o.jsxs("div",{className:"flex items-center space-x-1",children:[o.jsx(ni,{className:"w-3 h-3 text-gray-500"}),o.jsx("span",{className:"text-gray-700",children:t.capacity})]})]}),o.jsxs("div",{className:"flex items-center justify-between text-sm",children:[o.jsx("span",{className:"text-gray-600",children:"Area:"}),o.jsx("span",{className:"text-gray-700",children:t.area})]}),d&&o.jsx("div",{className:"mt-3 pt-3 border-t border-gray-200",children:o.jsx("p",{className:"text-xs text-center font-medium",style:{color:"var(--color-primary)"},children:" Click to take order"})})]})]})})}class Fn{static getMenuItems(e){try{const r=`${this.MENU_CACHE_KEY}_${e}`,n=`${this.CACHE_EXPIRY_KEY}_${e}`,s=localStorage.getItem(r),a=localStorage.getItem(n);return s&&a&&Date.now()<parseInt(a)?(console.log(" Menu cache hit for restaurant:",e),JSON.parse(s).map(this.parseItemDates)):[]}catch(r){return console.error("Failed to get menu from cache:",r),[]}}static setMenuItems(e,r){try{const n=`${this.MENU_CACHE_KEY}_${e}`,s=`${this.CACHE_EXPIRY_KEY}_${e}`;localStorage.setItem(n,JSON.stringify(r)),localStorage.setItem(s,(Date.now()+this.CACHE_DURATION).toString()),console.log(" Menu items cached for restaurant:",e,"Count:",r.length)}catch(n){console.error("Failed to cache menu items:",n)}}static getCategories(e){try{const r=`${this.CATEGORIES_CACHE_KEY}_${e}`,n=`${this.CACHE_EXPIRY_KEY}_${e}`,s=localStorage.getItem(r),a=localStorage.getItem(n);return s&&a&&Date.now()<parseInt(a)?(console.log(" Categories cache hit for restaurant:",e),JSON.parse(s).map(this.parseCategoryDates)):[]}catch(r){return console.error("Failed to get categories from cache:",r),[]}}static setCategories(e,r){try{const n=`${this.CATEGORIES_CACHE_KEY}_${e}`,s=`${this.CACHE_EXPIRY_KEY}_${e}`;localStorage.setItem(n,JSON.stringify(r)),localStorage.setItem(s,(Date.now()+this.CACHE_DURATION).toString()),console.log(" Categories cached for restaurant:",e,"Count:",r.length)}catch(n){console.error("Failed to cache categories:",n)}}static addMenuItem(e,r){const n=this.getMenuItems(e);n.push(r),this.setMenuItems(e,n)}static updateMenuItem(e,r){const n=this.getMenuItems(e),s=n.findIndex(a=>a.id===r.id);s!==-1&&(n[s]=r,this.setMenuItems(e,n))}static removeMenuItem(e,r){const s=this.getMenuItems(e).filter(a=>a.id!==r);this.setMenuItems(e,s)}static clearCache(e){const r=`${this.MENU_CACHE_KEY}_${e}`,n=`${this.CATEGORIES_CACHE_KEY}_${e}`,s=`${this.CACHE_EXPIRY_KEY}_${e}`;localStorage.removeItem(r),localStorage.removeItem(n),localStorage.removeItem(s)}static isCacheFresh(e){const r=`${this.CACHE_EXPIRY_KEY}_${e}`,n=localStorage.getItem(r);return n?Date.now()<parseInt(n):!1}static parseItemDates(e){return{...e,createdAt:new Date(e.createdAt),updatedAt:new Date(e.updatedAt)}}static parseCategoryDates(e){return{...e,createdAt:new Date(e.createdAt),updatedAt:new Date(e.updatedAt)}}}Rr(Fn,"MENU_CACHE_KEY","tenverse_pos_menu"),Rr(Fn,"CATEGORIES_CACHE_KEY","tenverse_pos_categories"),Rr(Fn,"CACHE_EXPIRY_KEY","tenverse_pos_menu_expiry"),Rr(Fn,"CACHE_DURATION",30*60*1e3);class cs{static async getMenuItemsForRestaurant(e){try{const r=Fn.getMenuItems(e);if(r.length>0&&Fn.isCacheFresh(e))return{success:!0,data:r};console.log(" Fetching menu items from Firebase for restaurant:",e);let n=[];try{const s=br(hr(Ke,"restaurants",e,this.MENU_ITEMS_COLLECTION),Oa("category"),Oa("name"));n=(await Tr(s)).docs.map(i=>this.convertFirestoreMenuItem(i.data(),i.id))}catch(s){if(s.code==="failed-precondition"&&s.message.includes("index")){console.log(" Index building, using fallback query with client-side sorting");const a=br(hr(Ke,"restaurants",e,this.MENU_ITEMS_COLLECTION));n=(await Tr(a)).docs.map(l=>this.convertFirestoreMenuItem(l.data(),l.id)),n.sort((l,c)=>l.category!==c.category?l.category.localeCompare(c.category):l.name.localeCompare(c.name))}else throw s}return Fn.setMenuItems(e,n),console.log(" Menu items loaded and cached:",n.length),{success:!0,data:n}}catch(r){return console.error(" Failed to get menu items:",r),{success:!1,error:Zt(r)}}}static async getCategoriesForRestaurant(e){try{const r=Fn.getCategories(e);if(r.length>0&&Fn.isCacheFresh(e))return{success:!0,data:r};console.log(" Fetching categories from Firebase for restaurant:",e);let n=[];try{const s=br(hr(Ke,"restaurants",e,this.CATEGORIES_COLLECTION),Nr("isActive","==",!0));n=(await Tr(s)).docs.map(i=>this.convertFirestoreCategory(i.data(),i.id)).sort((i,l)=>(i.sortOrder||0)-(l.sortOrder||0))}catch(s){console.warn(" Optimized query failed, trying fallback approach:",s.message);try{const a=hr(Ke,"restaurants",e,this.CATEGORIES_COLLECTION);n=(await Tr(a)).docs.map(l=>this.convertFirestoreCategory(l.data(),l.id)).filter(l=>l.isActive).sort((l,c)=>(l.sortOrder||0)-(c.sortOrder||0)),console.log(" Fallback query succeeded")}catch(a){throw console.error(" Fallback query also failed:",a),a}}return Fn.setCategories(e,n),console.log(" Categories loaded and cached:",n.length),{success:!0,data:n}}catch(r){return console.error(" Failed to get categories:",r),{success:!0,data:[]}}}static async initializeDefaultMenu(e){try{const r=await this.getMenuItemsForRestaurant(e);if(r.success&&r.data&&r.data.length>0){const m=await this.getCategoriesForRestaurant(e);return{success:!0,data:{items:r.data,categories:m.data||[]}}}console.log(" Creating default menu for restaurant:",e);const n=Ki(Ke),s=[{restaurantId:e,name:"Appetizers",description:"Start your meal with these delicious options",sortOrder:1,isActive:!0,createdAt:new Date,updatedAt:new Date},{restaurantId:e,name:"Main Courses",description:"Our signature dishes and hearty meals",sortOrder:2,isActive:!0,createdAt:new Date,updatedAt:new Date},{restaurantId:e,name:"Beverages",description:"Refreshing drinks and specialty beverages",sortOrder:3,isActive:!0,createdAt:new Date,updatedAt:new Date},{restaurantId:e,name:"Desserts",description:"Sweet endings to your perfect meal",sortOrder:4,isActive:!0,createdAt:new Date,updatedAt:new Date}],a=[];for(const m of s){const h=Hr(),g={id:h,...m},p=Rt(Ke,"restaurants",e,this.CATEGORIES_COLLECTION,h);n.set(p,{...g,createdAt:ft.fromDate(g.createdAt),updatedAt:ft.fromDate(g.updatedAt)}),a.push(g)}const i=a.find(m=>m.name==="Appetizers"),l=a.find(m=>m.name==="Main Courses"),c=a.find(m=>m.name==="Beverages"),u=a.find(m=>m.name==="Desserts"),d=[{restaurantId:e,name:"Caesar Salad",description:"Fresh romaine lettuce with parmesan cheese and croutons",price:12.99,category:"Appetizers",categoryId:i.id,categoryName:i.name,isAvailable:!0,ingredients:["romaine lettuce","parmesan cheese","croutons","caesar dressing"],createdAt:new Date,updatedAt:new Date},{restaurantId:e,name:"Chicken Wings",description:"Crispy wings with your choice of sauce",price:14.99,category:"Appetizers",categoryId:i.id,categoryName:i.name,isAvailable:!0,ingredients:["chicken wings","buffalo sauce","celery","blue cheese"],createdAt:new Date,updatedAt:new Date},{restaurantId:e,name:"Grilled Chicken",description:"Tender grilled chicken breast with seasonal vegetables",price:18.99,category:"Main Courses",categoryId:l.id,categoryName:l.name,isAvailable:!0,ingredients:["chicken breast","seasonal vegetables","herbs","olive oil"],createdAt:new Date,updatedAt:new Date},{restaurantId:e,name:"Beef Burger",description:"Juicy beef patty with lettuce, tomato, and fries",price:16.99,category:"Main Courses",categoryId:l.id,categoryName:l.name,isAvailable:!0,ingredients:["beef patty","lettuce","tomato","onion","pickles","fries"],createdAt:new Date,updatedAt:new Date},{restaurantId:e,name:"Fresh Orange Juice",description:"Freshly squeezed orange juice",price:4.99,category:"Beverages",categoryId:c.id,categoryName:c.name,isAvailable:!0,ingredients:["fresh oranges"],createdAt:new Date,updatedAt:new Date},{restaurantId:e,name:"Coffee",description:"Premium roasted coffee",price:3.99,category:"Beverages",categoryId:c.id,categoryName:c.name,isAvailable:!0,ingredients:["coffee beans","water"],createdAt:new Date,updatedAt:new Date},{restaurantId:e,name:"Chocolate Cake",description:"Rich chocolate cake with chocolate frosting",price:7.99,category:"Desserts",categoryId:u.id,categoryName:u.name,isAvailable:!0,ingredients:["chocolate","flour","eggs","butter","sugar"],createdAt:new Date,updatedAt:new Date}],f=[];for(const m of d){const h=Hr(),g={id:h,...m},p=Rt(Ke,"restaurants",e,this.MENU_ITEMS_COLLECTION,h);n.set(p,{...g,createdAt:ft.fromDate(g.createdAt),updatedAt:ft.fromDate(g.updatedAt)}),f.push(g)}return await n.commit(),Fn.setMenuItems(e,f),Fn.setCategories(e,a),console.log(" Default menu created and cached"),{success:!0,data:{items:f,categories:a},message:"Default menu created successfully"}}catch(r){return console.error(" Failed to create default menu:",r),{success:!1,error:Zt(r)}}}static async getAvailableItemsByCategory(e,r){const n=await this.getMenuItemsForRestaurant(e);if(n.success&&n.data){let s=n.data.filter(a=>a.isAvailable);return r&&(s=s.filter(a=>a.category===r)),{success:!0,data:s}}return n}static async searchMenuItems(e,r){const n=await this.getMenuItemsForRestaurant(e);return n.success&&n.data?{success:!0,data:n.data.filter(a=>{var i,l;return a.isAvailable&&(a.name.toLowerCase().includes(r.toLowerCase())||((i=a.description)==null?void 0:i.toLowerCase().includes(r.toLowerCase()))||((l=a.ingredients)==null?void 0:l.some(c=>c.toLowerCase().includes(r.toLowerCase()))))})}:n}static async createMenuItem(e){try{const r=Hr(),n={id:r,...e,createdAt:new Date,updatedAt:new Date},s=Rt(Ke,"restaurants",e.restaurantId,this.MENU_ITEMS_COLLECTION,r);return await gd(s,{...n,createdAt:ft.fromDate(n.createdAt),updatedAt:ft.fromDate(n.updatedAt)}),Fn.addMenuItem(e.restaurantId,n),console.log(" Menu item created and cached:",n.name),{success:!0,data:n,message:"Menu item created successfully"}}catch(r){return console.error(" Failed to create menu item:",r),{success:!1,error:Zt(r)}}}static async updateMenuItem(e,r,n){try{const s=Rt(Ke,"restaurants",r,this.MENU_ITEMS_COLLECTION,e),a={...n,updatedAt:ft.now()};await nn(s,a);const i=Fn.getMenuItems(r),l=i.findIndex(u=>u.id===e);if(l!==-1){const u={...i[l],...n,updatedAt:new Date};return Fn.updateMenuItem(r,u),{success:!0,data:u,message:"Menu item updated successfully"}}return await this.getMenuItemById(e,r)}catch(s){return console.error(" Failed to update menu item:",s),{success:!1,error:Zt(s)}}}static async deleteMenuItem(e,r){try{const n=Rt(Ke,"restaurants",r,this.MENU_ITEMS_COLLECTION,e);return await Uc(n),Fn.removeMenuItem(r,e),console.log(" Menu item deleted and removed from cache:",e),{success:!0,message:"Menu item deleted successfully"}}catch(n){return console.error(" Failed to delete menu item:",n),{success:!1,error:Zt(n)}}}static async getMenuItemById(e,r){try{const s=Fn.getMenuItems(r).find(c=>c.id===e);if(s)return{success:!0,data:s};const a=Rt(Ke,"restaurants",r,this.MENU_ITEMS_COLLECTION,e),i=await Gr(a);return i.exists()?{success:!0,data:this.convertFirestoreMenuItem(i.data(),i.id)}:{success:!1,error:"Menu item not found"}}catch(n){return console.error(" Failed to get menu item by ID:",n),{success:!1,error:Zt(n)}}}static clearCache(e){Fn.clearCache(e)}static subscribeToMenuItems(e,r){const n=br(hr(Ke,"restaurants",e,this.MENU_ITEMS_COLLECTION),Oa("category"),Oa("name"));return Ug(n,s=>{const a=s.docs.map(i=>this.convertFirestoreMenuItem(i.data(),i.id));Fn.setMenuItems(e,a),r(a)},s=>{console.error("Menu subscription error:",s)})}static convertFirestoreMenuItem(e,r){var n,s;return{id:r,restaurantId:e.restaurantId,name:e.name,description:e.description,price:e.price,category:e.category,categoryId:e.categoryId,categoryName:e.categoryName,image:e.image,isAvailable:e.isAvailable,ingredients:e.ingredients||[],allergens:e.allergens||[],nutritionInfo:e.nutritionInfo,customizations:e.customizations||[],variants:e.variants||[],preparationTime:e.preparationTime,spiceLevel:e.spiceLevel,isVeg:e.isVeg,isVegetarian:e.isVegetarian,isVegan:e.isVegan,isGlutenFree:e.isGlutenFree,tags:e.tags||[],createdAt:((n=e.createdAt)==null?void 0:n.toDate())||new Date,updatedAt:((s=e.updatedAt)==null?void 0:s.toDate())||new Date}}static convertFirestoreCategory(e,r){var n,s;return{id:r,restaurantId:e.restaurantId,name:e.name,description:e.description,sortOrder:e.sortOrder,isActive:e.isActive,createdAt:((n=e.createdAt)==null?void 0:n.toDate())||new Date,updatedAt:((s=e.updatedAt)==null?void 0:s.toDate())||new Date}}static async createCategory(e){try{const r=Hr(),n={id:r,...e,createdAt:new Date,updatedAt:new Date},s=Rt(Ke,"restaurants",e.restaurantId,this.CATEGORIES_COLLECTION,r);await gd(s,{...n,createdAt:ft.fromDate(n.createdAt),updatedAt:ft.fromDate(n.updatedAt)});const a=Fn.getCategories(e.restaurantId);return a.push(n),Fn.setCategories(e.restaurantId,a),console.log(" Category created and cached:",n.name),{success:!0,data:n,message:"Category created successfully"}}catch(r){return console.error(" Failed to create category:",r),{success:!1,error:Zt(r)}}}static async updateCategory(e,r,n){try{const s=Rt(Ke,"restaurants",r,this.CATEGORIES_COLLECTION,e),a={...n,updatedAt:ft.now()};await nn(s,a);const i=Fn.getCategories(r),l=i.findIndex(u=>u.id===e);if(l!==-1){const u={...i[l],...n,updatedAt:new Date};return i[l]=u,Fn.setCategories(r,i),{success:!0,data:u,message:"Category updated successfully"}}const c=await this.getCategoriesForRestaurant(r);if(c.success&&c.data){const u=c.data.find(d=>d.id===e);if(u)return{success:!0,data:u,message:"Category updated successfully"}}return{success:!1,error:"Failed to find updated category"}}catch(s){return console.error(" Failed to update category:",s),{success:!1,error:Zt(s)}}}static async deleteCategory(e,r){try{const n=Rt(Ke,"restaurants",r,this.CATEGORIES_COLLECTION,e);await Uc(n);const a=Fn.getCategories(r).filter(i=>i.id!==e);return Fn.setCategories(r,a),console.log(" Category deleted and removed from cache:",e),{success:!0,message:"Category deleted successfully"}}catch(n){return console.error(" Failed to delete category:",n),{success:!1,error:Zt(n)}}}}Rr(cs,"MENU_ITEMS_COLLECTION","menuItems"),Rr(cs,"CATEGORIES_COLLECTION","categories");const SC=Object.freeze(Object.defineProperty({__proto__:null,MenuService:cs},Symbol.toStringTag,{value:"Module"}));class ra{static getCollection(e){return hr(Ke,`restaurants/${e}/customers`)}static async createCustomer(e,r){try{if(r.phone){const i=await this.searchCustomers(e,r.phone);if(i.success&&i.data&&i.data.length>0){const l=i.data[0];return{success:!1,error:`Customer with phone ${r.phone} already exists as "${l.name||"Unnamed Customer"}"`,data:l}}}const n={restaurantId:e,name:r.name||"",email:r.email||"",phone:r.phone||"",address:r.address||"",orderHistory:[],totalSpent:0,visitCount:0,lastVisit:void 0,preferences:r.preferences||[],createdAt:new Date,updatedAt:new Date},s=await sh(this.getCollection(e),{...n,createdAt:ft.fromDate(n.createdAt),updatedAt:ft.fromDate(n.updatedAt),lastVisit:n.lastVisit?ft.fromDate(n.lastVisit):null});return{success:!0,data:{...n,id:s.id},message:"Customer created successfully"}}catch(n){return console.error("Error creating customer:",n),{success:!1,error:"Failed to create customer"}}}static async updateCustomer(e,r,n){var s,a,i;try{const l=Rt(Ke,`restaurants/${r}/customers`,e);if(!(await Gr(l)).exists())return{success:!1,error:"Customer not found"};const u={...n,updatedAt:ft.fromDate(new Date)};n.lastVisit&&n.lastVisit instanceof Date&&(u.lastVisit=ft.fromDate(n.lastVisit)),await nn(l,u);const d=await Gr(l),f=d.data();return f?{success:!0,data:{id:d.id,restaurantId:f.restaurantId,name:f.name||"",email:f.email||"",phone:f.phone||"",address:f.address||"",orderHistory:f.orderHistory||[],totalSpent:f.totalSpent||0,visitCount:f.visitCount||0,lastVisit:(s=f.lastVisit)==null?void 0:s.toDate(),preferences:f.preferences||[],createdAt:((a=f.createdAt)==null?void 0:a.toDate())||new Date,updatedAt:((i=f.updatedAt)==null?void 0:i.toDate())||new Date},message:"Customer updated successfully"}:{success:!1,error:"Customer data not found"}}catch(l){return console.error("Error updating customer:",l),{success:!1,error:"Failed to update customer"}}}static async deleteCustomer(e,r){try{const n=Rt(Ke,`restaurants/${r}/customers`,e);return(await Gr(n)).exists()?(await Uc(n),{success:!0,message:"Customer deleted successfully"}):{success:!1,error:"Customer not found"}}catch(n){return console.error("Error deleting customer:",n),{success:!1,error:"Failed to delete customer"}}}static async getCustomerById(e,r){var n,s,a;try{const i=Rt(Ke,`restaurants/${r}/customers`,e),l=await Gr(i);if(!l.exists())return{success:!1,error:"Customer not found"};const c=l.data();return{success:!0,data:{id:l.id,restaurantId:c.restaurantId,name:c.name||"",email:c.email||"",phone:c.phone||"",address:c.address||"",orderHistory:c.orderHistory||[],totalSpent:c.totalSpent||0,visitCount:c.visitCount||0,lastVisit:(n=c.lastVisit)==null?void 0:n.toDate(),preferences:c.preferences||[],createdAt:((s=c.createdAt)==null?void 0:s.toDate())||new Date,updatedAt:((a=c.updatedAt)==null?void 0:a.toDate())||new Date}}}catch(i){return console.error("Error fetching customer:",i),{success:!1,error:"Failed to fetch customer"}}}static async getCustomersForRestaurant(e,r={page:1,limit:50}){try{const n=br(this.getCollection(e),So(r.limit)),s=await Tr(n),a=[];return s.forEach(i=>{var c,u,d;const l=i.data();a.push({id:i.id,restaurantId:l.restaurantId,name:l.name||"",email:l.email||"",phone:l.phone||"",address:l.address||"",orderHistory:l.orderHistory||[],totalSpent:l.totalSpent||0,visitCount:l.visitCount||0,lastVisit:(c=l.lastVisit)==null?void 0:c.toDate(),preferences:l.preferences||[],createdAt:((u=l.createdAt)==null?void 0:u.toDate())||new Date,updatedAt:((d=l.updatedAt)==null?void 0:d.toDate())||new Date})}),{success:!0,data:a}}catch(n){return console.error("Error fetching customers:",n),{success:!1,error:"Failed to fetch customers"}}}static async searchCustomers(e,r){try{const n=await this.getCustomersForRestaurant(e);return!n.success||!n.data?n:{success:!0,data:n.data.filter(a=>{var i,l,c;return((i=a.name)==null?void 0:i.toLowerCase().includes(r.toLowerCase()))||((l=a.email)==null?void 0:l.toLowerCase().includes(r.toLowerCase()))||((c=a.phone)==null?void 0:c.includes(r))})}}catch(n){return console.error("Error searching customers:",n),{success:!1,error:"Failed to search customers"}}}static async addOrderToCustomer(e,r,n,s){try{const a=Rt(Ke,`restaurants/${r}/customers`,e),i=await Gr(a);if(!i.exists())return{success:!1,error:"Customer not found"};const l=i.data(),c=l.orderHistory||[],u=l.totalSpent||0,d=l.visitCount||0;return await nn(a,{orderHistory:[...c,n],totalSpent:u+s,visitCount:d+1,lastVisit:ft.fromDate(new Date),updatedAt:ft.fromDate(new Date)}),{success:!0,message:"Customer order updated successfully"}}catch(a){return console.error("Error adding order to customer:",a),{success:!1,error:"Failed to add order to customer"}}}static async getCustomerOrderHistory(e,r){try{const n=Rt(Ke,`restaurants/${r}/customers`,e),s=await Gr(n);return s.exists()?{success:!0,data:s.data().orderHistory||[]}:{success:!1,error:"Customer not found"}}catch(n){return console.error("Error fetching customer order history:",n),{success:!1,error:"Failed to fetch customer order history"}}}}const fD=Object.freeze(Object.defineProperty({__proto__:null,CustomerService:ra},Symbol.toStringTag,{value:"Module"}));class Ui{static getCouponsCollection(e){return hr(Ke,`restaurants/${e}/coupons`)}static async createCoupon(e,r){try{const n={...r,restaurantId:e,usageCount:0,createdAt:new Date,updatedAt:new Date},s=await sh(this.getCouponsCollection(e),{...n,createdAt:ft.fromDate(n.createdAt),updatedAt:ft.fromDate(n.updatedAt),validity:{...n.validity,startDate:ft.fromDate(n.validity.startDate),endDate:ft.fromDate(n.validity.endDate)}});return{success:!0,data:{...n,id:s.id},message:"Coupon created successfully"}}catch(n){return console.error("Error creating coupon:",n),{success:!1,error:"Failed to create coupon"}}}static async getCouponsForRestaurant(e){try{const r=await Tr(this.getCouponsCollection(e)),n=[];return r.forEach(s=>{var i,l,c,u;const a=s.data();n.push({id:s.id,...a,createdAt:((i=a.createdAt)==null?void 0:i.toDate())||new Date,updatedAt:((l=a.updatedAt)==null?void 0:l.toDate())||new Date,validity:{...a.validity,startDate:((c=a.validity.startDate)==null?void 0:c.toDate())||new Date,endDate:((u=a.validity.endDate)==null?void 0:u.toDate())||new Date}})}),{success:!0,data:n}}catch(r){return console.error("Error fetching coupons:",r),{success:!1,error:"Failed to fetch coupons"}}}static async updateCoupon(e,r,n){try{const s=Rt(Ke,`restaurants/${r}/coupons`,e),a={...n,updatedAt:ft.fromDate(new Date)};return n.validity&&(a.validity={...n.validity,startDate:n.validity.startDate?ft.fromDate(n.validity.startDate):void 0,endDate:n.validity.endDate?ft.fromDate(n.validity.endDate):void 0}),await nn(s,a),{success:!0,message:"Coupon updated successfully"}}catch(s){return console.error("Error updating coupon:",s),{success:!1,error:"Failed to update coupon"}}}static async deleteCoupon(e,r){try{return await Uc(Rt(Ke,`restaurants/${r}/coupons`,e)),{success:!0,message:"Coupon deleted successfully"}}catch(n){return console.error("Error deleting coupon:",n),{success:!1,error:"Failed to delete coupon"}}}static async validateCoupon(e,r,n,s,a,i){var l,c,u,d;try{const f=br(this.getCouponsCollection(r),Nr("code","==",e.toUpperCase())),m=await Tr(f);if(m.empty)return{isValid:!1,error:"Invalid coupon code"};const h=m.docs[0],g=h.data(),p={id:h.id,...g,createdAt:((l=g.createdAt)==null?void 0:l.toDate())||new Date,updatedAt:((c=g.updatedAt)==null?void 0:c.toDate())||new Date,validity:{...g.validity,startDate:((u=g.validity.startDate)==null?void 0:u.toDate())||new Date,endDate:((d=g.validity.endDate)==null?void 0:d.toDate())||new Date}};return await this.performCouponValidation(p,n,s,a,i)}catch(f){return console.error("Error validating coupon:",f),{isValid:!1,error:"Failed to validate coupon"}}}static async performCouponValidation(e,r,n,s,a){if(e.status!=="active")return{isValid:!1,error:"This coupon is not active"};const i=new Date;if(i<e.validity.startDate)return{isValid:!1,error:"This coupon is not yet valid"};if(i>e.validity.endDate)return{isValid:!1,error:"This coupon has expired"};if(e.validity.startTime&&e.validity.endTime){const d=i.getHours()*100+i.getMinutes(),f=parseInt(e.validity.startTime.replace(":","")),m=parseInt(e.validity.endTime.replace(":",""));if(d<f||d>m)return{isValid:!1,error:`This coupon is only valid between ${e.validity.startTime} and ${e.validity.endTime}`}}if(e.validity.validDays.length>0){const f=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"][i.getDay()];if(!e.validity.validDays.includes(f))return{isValid:!1,error:"This coupon is not valid today"}}if(e.validity.usageLimit&&e.usageCount>=e.validity.usageLimit)return{isValid:!1,error:"This coupon has reached its usage limit"};if(e.validity.perCustomerLimit&&s&&await this.getCustomerCouponUsage(e.id,s)>=e.validity.perCustomerLimit)return{isValid:!1,error:"You have already used this coupon the maximum number of times"};if(a&&e.targeting.paymentMethodRestriction!=="all"&&!this.isPaymentMethodAllowed(a,e.targeting.paymentMethodRestriction))return{isValid:!1,error:`This coupon is not valid for ${a} payments`};const l=r.reduce((d,f)=>d+f.total,0);if(e.targeting.minOrderValue&&l<e.targeting.minOrderValue)return{isValid:!1,error:`Minimum order value of ${e.targeting.minOrderValue} required`};const c=await this.validateCouponType(e,r,n);if(!c.isValid)return c;const u=this.calculateCouponApplication(e,r,n);return{isValid:!0,coupon:e,applicableItems:u.applicableItems,discountAmount:u.discountAmount,freeItems:u.freeItems}}static async validateCouponType(e,r,n){switch(e.type){case"buy_x_get_y":return this.validateBuyXGetY(e,r,n);case"free_item":return this.validateFreeItem(e,r,n);case"category_specific":return this.validateCategorySpecific(e,r,n);case"minimum_order":return r.reduce((a,i)=>a+i.total,0)<(e.config.minimumOrderValue||0)?{isValid:!1,error:`Minimum order of ${e.config.minimumOrderValue} required`}:{isValid:!0};default:return{isValid:!0}}}static validateBuyXGetY(e,r,n){const s=e.config.buyXGetY;if(!s)return{isValid:!1,error:"Invalid coupon configuration"};let a=0;if(s.buyItemId){const i=r.find(l=>l.menuItemId===s.buyItemId);a=(i==null?void 0:i.quantity)||0}else s.buyCategoryId?a=r.filter(i=>{const l=n.find(c=>c.id===i.menuItemId);return(l==null?void 0:l.categoryId)===s.buyCategoryId}).reduce((i,l)=>i+l.quantity,0):a=r.reduce((i,l)=>i+l.quantity,0);return a<s.buyQuantity?{isValid:!1,error:`You need to buy ${s.buyQuantity} eligible items to use this coupon`}:{isValid:!0}}static validateFreeItem(e,r,n){const s=e.config.freeItemId;if(s){const a=n.find(i=>i.id===s);if(!a||!a.isAvailable)return{isValid:!1,error:"The free item is currently not available"}}return{isValid:!0}}static validateCategorySpecific(e,r,n){const s=e.config.targetCategoryId;return s?r.some(i=>{const l=n.find(c=>c.id===i.menuItemId);return(l==null?void 0:l.categoryId)===s})?{isValid:!0}:{isValid:!1,error:"No eligible items in cart for this coupon"}:{isValid:!1,error:"Invalid coupon configuration"}}static calculateCouponApplication(e,r,n){let s=0;const a=[];let i=[];switch(e.type){case"percentage_discount":s=r.reduce((m,h)=>m+h.total,0)*(e.config.percentage||0)/100,i=r.map(m=>m.menuItemId);break;case"fixed_amount":s=e.config.discountAmount||0,i=r.map(m=>m.menuItemId);break;case"minimum_order":s=e.config.discountAmount||0,i=r.map(m=>m.menuItemId);break;case"category_specific":const c=r.filter(m=>{const h=n.find(g=>g.id===m.menuItemId);return(h==null?void 0:h.categoryId)===e.config.targetCategoryId});s=c.reduce((m,h)=>m+h.total,0)*(e.config.categoryDiscountPercentage||0)/100,i=c.map(m=>m.menuItemId);break;case"buy_x_get_y":const d=this.calculateBuyXGetY(e,r,n);s=d.discountAmount,a.push(...d.freeItems),i=d.applicableItems;break;case"free_item":const f=this.calculateFreeItem(e,n);f&&a.push(f);break}return{coupon:e,discountAmount:s,freeItems:a,applicableItems:i}}static calculateBuyXGetY(e,r,n){const s=e.config.buyXGetY;let a=0;const i=[],l=[];let c=0;if(s.buyItemId){const d=r.find(f=>f.menuItemId===s.buyItemId);c=(d==null?void 0:d.quantity)||0,d&&l.push(d.menuItemId)}else if(s.buyCategoryId){const d=r.filter(f=>{const m=n.find(h=>h.id===f.menuItemId);return(m==null?void 0:m.categoryId)===s.buyCategoryId});c=d.reduce((f,m)=>f+m.quantity,0),l.push(...d.map(f=>f.menuItemId))}const u=Math.floor(c/s.buyQuantity)*s.getQuantity;if(u>0){const d=s.getItemId||s.buyItemId;if(d){const f=n.find(m=>m.id===d);f&&(s.getDiscountPercentage&&s.getDiscountPercentage<100?a=f.price*u*s.getDiscountPercentage/100:i.push({menuItemId:d,quantity:u,name:f.name,price:f.price}))}}return{discountAmount:a,freeItems:i,applicableItems:l}}static calculateFreeItem(e,r){const n=e.config.freeItemId;if(n){const s=r.find(a=>a.id===n);if(s&&s.isAvailable)return{menuItemId:n,quantity:1,name:s.name,price:s.price}}return null}static isPaymentMethodAllowed(e,r){switch(r){case"all":return!0;case"cash_only":return e==="cash";case"upi_only":return e==="upi";case"bank_only":return e==="bank";case"exclude_cash":return e!=="cash";default:return!0}}static async getCustomerCouponUsage(e,r){try{const n=br(hr(Ke,this.usageCollection),Nr("couponId","==",e),Nr("customerId","==",r));return(await Tr(n)).size}catch(n){return console.error("Error fetching customer coupon usage:",n),0}}static async recordCouponUsage(e,r,n,s,a,i,l){try{const c=Ki(Ke),u=Rt(Ke,`restaurants/${r}/coupons`,e),d=await Gr(u);if(d.exists()){const h=d.data().usageCount||0;c.update(u,{usageCount:h+1,updatedAt:ft.fromDate(new Date)})}const f={couponId:e,restaurantId:r,orderId:n,customerId:l,discountAmount:s,originalAmount:a,finalAmount:i,usedAt:new Date},m=Rt(hr(Ke,this.usageCollection));return c.set(m,{...f,usedAt:ft.fromDate(f.usedAt)}),await c.commit(),{success:!0,message:"Coupon usage recorded successfully"}}catch(c){return console.error("Error recording coupon usage:",c),{success:!1,error:"Failed to record coupon usage"}}}static generateCouponCode(e=""){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let n=e;for(let s=0;s<8-e.length;s++)n+=r.charAt(Math.floor(Math.random()*r.length));return n}static async getCouponAnalytics(e,r=30){try{const n=new Date;n.setDate(n.getDate()-r);const s=await this.getCouponsForRestaurant(e);if(!s.success||!s.data)return{success:!1,error:"Failed to fetch coupons"};const a=s.data,i=br(hr(Ke,this.usageCollection),Nr("restaurantId","==",e),Nr("usedAt",">=",ft.fromDate(n))),c=(await Tr(i)).docs.map(g=>{var p;return{id:g.id,...g.data(),usedAt:((p=g.data().usedAt)==null?void 0:p.toDate())||new Date}}),u=a.length,d=c.length,f=c.reduce((g,p)=>g+p.discountAmount,0),m=d>0?f/d:0,h=this.getTopCoupons(c);return{success:!0,data:{totalCouponsCreated:u,totalCouponsUsed:d,totalDiscountGiven:f,averageDiscountPerUsage:m,redemptionRate:u>0?d/u*100:0,topCoupons:h,usageHistory:c}}}catch(n){return console.error("Error fetching coupon analytics:",n),{success:!1,error:"Failed to fetch coupon analytics"}}}static getTopCoupons(e){const r={};return e.forEach(n=>{r[n.couponId]||(r[n.couponId]={count:0,totalDiscount:0}),r[n.couponId].count++,r[n.couponId].totalDiscount+=n.discountAmount}),Object.entries(r).map(([n,s])=>({couponId:n,...s})).sort((n,s)=>s.count-n.count).slice(0,5)}static async markCouponAsUsed(e,r){try{const n=Rt(Ke,`restaurants/${r}/coupons`,e),s=await Gr(n);if(!s.exists())return{success:!1,error:"Coupon not found"};const a=s.data().usageCount||0;return await nn(n,{usageCount:a+1,updatedAt:ft.fromDate(new Date)}),{success:!0,message:"Coupon marked as used"}}catch(n){return console.error("Error marking coupon as used:",n),{success:!1,error:"Failed to mark coupon as used"}}}}Rr(Ui,"usageCollection","coupon_usage");function qK({isOpen:t,onClose:e,menuItem:r,onConfirm:n}){const[s,a]=X.useState([]),[i,l]=X.useState([]);if(!t)return null;const c=r.variants||[],u=()=>{let b=Number(r.price)||0;return s.forEach(w=>{const N=Number(w.priceModifier)||0;(w.pricingType||"additive")==="standalone"?b=N:b+=N}),b},d=(v,b)=>{const w=v.options.find(N=>N.id===b);if(w)if(v.type==="single"){const N=s.filter(j=>j.variantId!==v.id);N.push({variantId:v.id,variantName:v.name,optionId:w.id,optionName:w.name,priceModifier:Number(w.priceModifier)||0,pricingType:w.pricingType||"additive"}),a(N)}else{const N=s.findIndex(j=>j.variantId===v.id&&j.optionId===b);if(N>=0){const j=[...s];j.splice(N,1),a(j)}else{const j=s.filter(F=>F.variantId===v.id).length;(!v.maxSelections||j<v.maxSelections)&&a([...s,{variantId:v.id,variantName:v.name,optionId:w.id,optionName:w.name,priceModifier:Number(w.priceModifier)||0,pricingType:w.pricingType||"additive"}])}}},f=(v,b)=>s.some(w=>w.variantId===v&&w.optionId===b),m=()=>{const v=[];return c.forEach(b=>{b.required&&(s.some(N=>N.variantId===b.id)||v.push(`Please select an option for ${b.name}`))}),l(v),v.length===0},h=()=>{if(m()){const v=u();n(s,v),e()}},g=()=>{a([]),l([]),e()};mi.useEffect(()=>{if(c.length>0&&s.length===0){const v=[];c.forEach(b=>{if(b.type==="single"){const w=b.options.find(N=>N.isDefault)||b.options[0];w&&v.push({variantId:b.id,variantName:b.name,optionId:w.id,optionName:w.name,priceModifier:w.priceModifier,pricingType:w.pricingType||"additive"})}}),a(v)}},[c,s.length]);const p=u();return o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:o.jsxs("div",{className:"bg-white rounded-2xl max-w-lg w-full max-h-[90vh] overflow-y-auto",children:[o.jsx("div",{className:"p-6 border-b border-gray-200",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("h2",{className:"text-xl font-semibold text-gray-900",children:["Customize ",r.name]}),o.jsx("button",{onClick:g,className:"p-1 text-gray-400 hover:text-gray-600",children:o.jsx(Zn,{className:"w-5 h-5"})})]})}),o.jsxs("div",{className:"p-6",children:[o.jsxs("div",{className:"mb-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("span",{className:"text-lg font-medium text-gray-900",children:r.name}),o.jsx("span",{className:"text-lg font-bold text-blue-600",children:pt(p)})]}),r.description&&o.jsx("p",{className:"text-gray-600 text-sm",children:r.description})]}),c.map(v=>o.jsxs("div",{className:"mb-6",children:[o.jsxs("div",{className:"flex items-center mb-3",children:[o.jsx("h3",{className:"text-md font-medium text-gray-900",children:v.name}),v.required&&o.jsx("span",{className:"ml-2 text-red-500 text-sm",children:"*"}),v.type==="multiple"&&v.maxSelections&&o.jsxs("span",{className:"ml-2 text-gray-500 text-sm",children:["(Max ",v.maxSelections,")"]})]}),o.jsx("div",{className:"space-y-2",children:v.options.map(b=>{const w=f(v.id,b.id),N=s.filter(F=>F.variantId===v.id).length,j=v.maxSelections&&N>=v.maxSelections&&!w;return o.jsx("div",{onClick:()=>!j&&d(v,b.id),className:`
                        p-3 border rounded-lg cursor-pointer transition-colors
                        ${w?"border-blue-500 bg-blue-50":j?"border-gray-200 bg-gray-50 cursor-not-allowed opacity-50":"border-gray-200 hover:border-gray-300"}
                      `,children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[v.type==="single"?o.jsx("input",{type:"radio",checked:w,onChange:()=>{},className:"text-blue-600 focus:ring-blue-500"}):o.jsx("input",{type:"checkbox",checked:w,onChange:()=>{},disabled:!!j,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),o.jsx("span",{className:"text-gray-900",children:b.name})]}),o.jsxs("div",{className:"flex flex-col items-end",children:[o.jsxs("span",{className:"text-gray-600",children:[b.pricingType==="standalone"?"":b.priceModifier>0&&"+",b.priceModifier!==0&&pt(b.priceModifier)]}),b.pricingType==="standalone"&&o.jsx("span",{className:"text-xs text-blue-600",children:"Standalone"})]})]})},b.id)})})]},v.id)),i.length>0&&o.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:o.jsx("ul",{className:"text-red-600 text-sm space-y-1",children:i.map((v,b)=>o.jsx("li",{children:v},b))})}),s.length>0&&o.jsxs("div",{className:"mb-6 p-3 bg-gray-50 rounded-lg",children:[o.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Selected Options:"}),o.jsx("div",{className:"space-y-1",children:s.map((v,b)=>o.jsxs("div",{className:"flex justify-between text-sm",children:[o.jsxs("span",{className:"text-gray-700",children:[v.variantName,": ",v.optionName]}),o.jsxs("div",{className:"flex flex-col items-end",children:[o.jsxs("span",{className:"text-gray-600",children:[v.pricingType==="standalone"?"":v.priceModifier>0&&"+",v.priceModifier!==0&&pt(v.priceModifier)]}),v.pricingType==="standalone"&&o.jsx("span",{className:"text-xs text-blue-600",children:"Standalone"})]})]},b))})]}),o.jsxs("div",{className:"flex space-x-3",children:[o.jsx("button",{onClick:g,className:"flex-1 px-4 py-3 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Cancel"}),o.jsxs("button",{onClick:h,className:"flex-1 px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium",children:["Add to Order - ",pt(p)]})]})]})]})})}function WK({isOpen:t,onClose:e,restaurant:r,table:n,onPayment:s,isProcessing:a,cartItems:i,menuItems:l}){var Ae,Be,Ue;const[c,u]=X.useState("cash"),[d,f]=X.useState(0),[m,h]=X.useState(""),[g,p]=X.useState(null),[v,b]=X.useState(!1),[w,N]=X.useState(""),[j,F]=X.useState([]),[U,A]=X.useState(""),[S,k]=X.useState(""),[M,I]=X.useState(!1),[E,D]=X.useState({type:"percentage",value:0,reason:""}),[G,Z]=X.useState(0),[ae,de]=X.useState("");X.useEffect(()=>{r!=null&&r.id&&se()},[r==null?void 0:r.id]);const se=async()=>{if(r!=null&&r.id)try{const Ce=await ra.getCustomersForRestaurant(r.id);Ce.success&&Ce.data&&F(Ce.data)}catch(Ce){console.error("Failed to load customers:",Ce)}};if(!t)return null;const Y=i.reduce((Ce,Ye)=>Ce+Ye.total,0),ye=Y*(((Ae=r==null?void 0:r.settings)==null?void 0:Ae.taxRate)||8.5)/100,re=Y+ye;let C=0,O=0,L=[];g&&(C=g.discountAmount||0,L=g.freeItems||[],O=L.reduce((Ce,Ye)=>Ce+Ye.price*Ye.quantity,0));let H=0;E.value>0&&(E.type==="percentage"?H=Y*E.value/100:H=E.value,H=Math.min(H,Y));const K=C+H,q=Math.max(0,Y-K),te=q*(((Be=r==null?void 0:r.settings)==null?void 0:Be.taxRate)||8.5)/100,oe=q+te,V=oe+G,xe=K+O,B=async()=>{if(m.trim()){b(!0),N("");try{const Ce=await Ui.validateCoupon(m,r.id,i,l,c);Ce.isValid?(p(Ce),fe.success(`Coupon applied! You saved ${pt(Ce.discountAmount||0)}`),h(""),Ce.freeItems&&Ce.freeItems.length>0&&fe.success(`Free items added: ${Ce.freeItems.map(Ye=>`${Ye.quantity}x ${Ye.name}`).join(", ")}`)):(N(Ce.error||"Invalid coupon"),fe.error(Ce.error||"Invalid coupon"))}catch{N("Failed to validate coupon"),fe.error("Failed to validate coupon")}finally{b(!1)}}},Ee=()=>{p(null),N(""),fe.success("Coupon removed")},Me=Ce=>{k(Ce),I(!0)},Ie=Ce=>{A(Ce.id),k(Ce.name||Ce.phone||""),I(!1)},he=()=>{A(""),k(""),I(!1)},qe=Ce=>{Z(Ce),de("")},ct=Ce=>{de(Ce);const Ye=parseFloat(Ce)||0;Z(Ye)},lt=j.filter(Ce=>{var Ye,It,Dt;return((Ye=Ce.name)==null?void 0:Ye.toLowerCase().includes(S.toLowerCase()))||((It=Ce.phone)==null?void 0:It.includes(S))||((Dt=Ce.email)==null?void 0:Dt.toLowerCase().includes(S.toLowerCase()))}),ue=j.find(Ce=>Ce.id===U),Ne=()=>{const Ce={method:c,amountReceived:c==="cash"?d:V,appliedCoupon:g,manualDiscount:E.value>0?E:null,customerId:U||null,tip:G>0?G:null,finalTotal:V,originalTotal:re,subtotalWithTax:oe,totalSavings:xe,freeItems:L,couponDiscountAmount:C,manualDiscountAmount:H};s(Ce)};return o.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:o.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[o.jsx("div",{className:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75",onClick:()=>{I(!1),e()}}),o.jsxs("div",{className:"inline-block w-full max-w-2xl my-8 overflow-hidden text-left align-middle transition-all transform bg-white shadow-xl rounded-2xl",children:[o.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Process Payment"}),o.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600",children:o.jsx(Zn,{className:"w-6 h-6"})})]}),o.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Table ",n.number," - Enhanced with Coupon Support"]})]}),o.jsxs("div",{className:"px-6 py-4 max-h-96 overflow-y-auto space-y-6",children:[o.jsxs("div",{children:[o.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Order Summary"}),o.jsx("div",{className:"bg-gray-50 rounded-lg p-4 space-y-2",children:i.map((Ce,Ye)=>o.jsxs("div",{className:"flex justify-between text-sm",children:[o.jsxs("span",{children:[Ce.quantity,"x ",Ce.name]}),o.jsx("span",{children:pt(Ce.total)})]},Ye))})]}),o.jsxs("div",{className:"border-t pt-4",children:[o.jsxs("h4",{className:"font-medium text-gray-900 mb-3 flex items-center",children:[o.jsx(kc,{className:"w-4 h-4 mr-2 text-purple-600"}),"Customer"]}),o.jsxs("div",{className:"relative",children:[o.jsx("input",{type:"text",value:S,onChange:Ce=>Me(Ce.target.value),onFocus:()=>I(!0),placeholder:"Search customer by name, phone, or email...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500"}),ue&&o.jsxs("div",{className:"mt-2 p-3 bg-purple-50 border border-purple-200 rounded-lg flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("div",{className:"font-medium text-purple-900",children:ue.name}),o.jsxs("div",{className:"text-sm text-purple-600",children:[ue.phone,"  ",ue.visitCount," visits  Total spent: ",pt(ue.totalSpent)]})]}),o.jsx("button",{onClick:he,className:"text-purple-600 hover:text-purple-800 p-1 rounded",title:"Remove customer",children:o.jsx(Zn,{className:"w-4 h-4"})})]}),M&&S&&!ue&&o.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-48 overflow-y-auto",children:lt.length>0?lt.slice(0,10).map(Ce=>o.jsxs("button",{onClick:()=>Ie(Ce),className:"w-full text-left px-3 py-2 hover:bg-gray-50 border-b border-gray-100 last:border-b-0",children:[o.jsx("div",{className:"font-medium",children:Ce.name||"Unknown"}),o.jsxs("div",{className:"text-sm text-gray-600",children:[Ce.phone,"  ",Ce.visitCount," visits"]})]},Ce.id)):o.jsx("div",{className:"px-3 py-2 text-gray-500 text-sm",children:"No customers found"})})]})]}),o.jsxs("div",{className:"border-t pt-4",children:[o.jsxs("h4",{className:"font-medium text-gray-900 mb-3 flex items-center",children:[o.jsx(Dy,{className:"w-4 h-4 mr-2 text-orange-600"}),"Manual Discount"]}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"flex space-x-2",children:[o.jsxs("select",{value:E.type,onChange:Ce=>D(Ye=>({...Ye,type:Ce.target.value})),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500",children:[o.jsx("option",{value:"percentage",children:"Percentage (%)"}),o.jsx("option",{value:"fixed",children:"Fixed Amount ()"})]}),o.jsx("input",{type:"number",value:E.value||"",onChange:Ce=>D(Ye=>({...Ye,value:parseFloat(Ce.target.value)||0})),placeholder:E.type==="percentage"?"Enter %":"Enter amount",min:"0",max:E.type==="percentage"?100:Y,step:E.type==="percentage"?1:.01,className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"})]}),o.jsx("input",{type:"text",value:E.reason,onChange:Ce=>D(Ye=>({...Ye,reason:Ce.target.value})),placeholder:"Discount reason (optional)",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"}),H>0&&o.jsx("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-3",children:o.jsxs("div",{className:"text-sm text-orange-700",children:["Manual discount: ",pt(H),E.reason&&o.jsxs("span",{className:"block text-orange-600",children:["Reason: ",E.reason]})]})})]})]}),o.jsxs("div",{className:"border-t pt-4",children:[o.jsxs("h4",{className:"font-medium text-gray-900 mb-3 flex items-center",children:[o.jsx(Bv,{className:"w-4 h-4 mr-2 text-blue-600"}),"Apply Coupon"]}),g?o.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(Ia,{className:"w-5 h-5 text-green-600"}),o.jsxs("div",{children:[o.jsx("div",{className:"font-medium text-green-800",children:g.coupon.name}),o.jsxs("div",{className:"text-sm text-green-600",children:["Code: ",g.coupon.code]}),C>0&&o.jsxs("div",{className:"text-sm text-green-600",children:["Discount: ",pt(C)]}),L.length>0&&o.jsxs("div",{className:"text-sm text-green-600",children:["Free: ",L.map(Ce=>`${Ce.quantity}x ${Ce.name}`).join(", ")]})]})]}),o.jsx("button",{onClick:Ee,className:"text-green-600 hover:text-green-800 p-1 rounded",title:"Remove coupon",children:o.jsx(Zn,{className:"w-4 h-4"})})]})}):o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"flex space-x-2",children:[o.jsx("input",{type:"text",value:m,onChange:Ce=>h(Ce.target.value.toUpperCase()),placeholder:"Enter coupon code (e.g., SAVE20)",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),o.jsx("button",{type:"button",onClick:B,disabled:!m.trim()||v,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:v?"Validating...":"Apply"})]}),w&&o.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 flex items-center space-x-2",children:[o.jsx($c,{className:"w-4 h-4 text-red-600"}),o.jsx("span",{className:"text-sm text-red-700",children:w})]})]})]}),o.jsx("div",{className:"border-t pt-4",children:o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex justify-between text-sm",children:[o.jsx("span",{children:"Subtotal:"}),o.jsx("span",{className:g?"line-through text-gray-500":"",children:pt(Y)})]}),C>0&&o.jsxs("div",{className:"flex justify-between text-sm text-green-600",children:[o.jsx("span",{children:"Coupon Discount:"}),o.jsxs("span",{children:["-",pt(C)]})]}),H>0&&o.jsxs("div",{className:"flex justify-between text-sm text-orange-600",children:[o.jsxs("span",{children:["Manual Discount (",E.type==="percentage"?`${E.value}%`:"Fixed","):"]}),o.jsxs("span",{children:["-",pt(H)]})]}),K>0&&o.jsxs("div",{className:"flex justify-between text-sm",children:[o.jsx("span",{children:"Discounted Subtotal:"}),o.jsx("span",{children:pt(q)})]}),o.jsxs("div",{className:"flex justify-between text-sm",children:[o.jsxs("span",{children:["Tax (",((Ue=r==null?void 0:r.settings)==null?void 0:Ue.taxRate)||8.5,"%):"]}),o.jsx("span",{children:pt(te)})]}),L.length>0&&o.jsxs("div",{className:"flex justify-between text-sm text-green-600",children:[o.jsx("span",{children:"Free Items Value:"}),o.jsxs("span",{children:[pt(O)," (FREE)"]})]}),G>0&&o.jsxs("div",{className:"flex justify-between text-sm text-blue-600",children:[o.jsx("span",{children:"Tip/Gratuity:"}),o.jsxs("span",{children:["+",pt(G)]})]}),o.jsxs("div",{className:"flex justify-between text-lg font-bold border-t pt-2",children:[o.jsx("span",{children:"Final Total:"}),o.jsx("span",{children:pt(V)})]}),xe>0&&o.jsxs("div",{className:"flex justify-between text-sm text-green-600 font-medium",children:[o.jsx("span",{children:"Total Savings:"}),o.jsx("span",{children:pt(xe)})]})]})}),o.jsxs("div",{className:"border-t pt-4",children:[o.jsxs("h4",{className:"font-medium text-gray-900 mb-3 flex items-center",children:[o.jsx(Yi,{className:"w-4 h-4 mr-2 text-green-600"}),"Tip / Gratuity"]}),o.jsxs("div",{className:"space-y-3",children:[o.jsx("div",{className:"grid grid-cols-4 gap-2",children:[10,15,20,25].map(Ce=>{const Ye=oe*Ce/100;return o.jsxs("button",{onClick:()=>qe(Ye),className:`p-2 border rounded-lg text-center text-sm ${Math.abs(G-Ye)<.01?"border-green-500 bg-green-50 text-green-700":"border-gray-300 hover:border-gray-400"}`,children:[Ce,"%",o.jsx("br",{}),o.jsx("span",{className:"text-xs",children:pt(Ye)})]},Ce)})}),o.jsxs("div",{className:"flex space-x-2",children:[o.jsx("input",{type:"number",value:ae,onChange:Ce=>ct(Ce.target.value),placeholder:"Custom tip amount",min:"0",step:"0.01",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"}),o.jsx("button",{onClick:()=>qe(0),className:`px-4 py-2 border rounded-lg text-sm ${G===0?"border-gray-500 bg-gray-50 text-gray-700":"border-gray-300 hover:border-gray-400"}`,children:"No Tip"})]})]})]}),o.jsxs("div",{className:"border-t pt-4",children:[o.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Payment Method"}),o.jsx("div",{className:"grid grid-cols-3 gap-3",children:["cash","upi","bank"].map(Ce=>o.jsx("button",{onClick:()=>u(Ce),className:`p-3 border rounded-lg text-center capitalize ${c===Ce?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-300 hover:border-gray-400"}`,children:Ce},Ce))})]}),c==="cash"&&o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Amount Received"}),o.jsx("input",{type:"number",value:d,onChange:Ce=>f(Number(Ce.target.value)),min:V,step:"0.01",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:V.toString()}),d>V&&o.jsxs("div",{className:"mt-2 text-sm text-gray-600",children:["Change: ",pt(d-V)]})]})]}),o.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 flex justify-between items-center",children:[o.jsx("div",{className:"text-sm text-gray-600",children:g&&o.jsxs("span",{className:"text-green-600 font-medium",children:[" Coupon applied! You saved ",pt(xe)]})}),o.jsxs("div",{className:"flex space-x-3",children:[o.jsx("button",{onClick:e,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200",children:"Cancel"}),o.jsx("button",{onClick:Ne,disabled:a||c==="cash"&&d<V,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:a?"Processing...":`Pay ${pt(V)}`})]})]})]})]})})}function HK({isOpen:t,onClose:e,currentTable:r,restaurantId:n,currentOrders:s,onOperationComplete:a}){const[i,l]=X.useState([]),[c,u]=X.useState([]),[d,f]=X.useState("transfer"),[m,h]=X.useState(!1),[g,p]=X.useState(!0);X.useEffect(()=>{t&&v()},[t,n]);const v=async()=>{p(!0);try{const A=await pn.getTablesForRestaurant(n);if(A.success&&A.data){const S=A.data.filter(k=>k.id===r.id?!1:d==="transfer"?k.status==="available":k.status==="available"||k.status==="occupied");l(S)}}catch(A){console.error("Failed to load tables:",A),fe.error("Failed to load available tables")}finally{p(!1)}},b=A=>{f(A),u([]),v()},w=A=>{u(d==="transfer"?[A]:S=>S.includes(A)?S.filter(k=>k!==A):[...S,A])},N=async()=>{if(c.length!==1){fe.error("Please select one table to transfer to");return}h(!0);try{const A=await Za.transferOrders(r.id,c[0],n);if(!A.success)throw new Error(A.error||"Failed to transfer orders");const S=await pn.transferTable(r.id,c[0],n);if(!S.success)throw new Error(S.error||"Failed to update table status");const k=i.find(M=>M.id===c[0]);fe.success(`Orders transferred to Table ${k==null?void 0:k.number}`),a(),e()}catch(A){console.error("Transfer failed:",A),fe.error(A instanceof Error?A.message:"Transfer failed")}finally{h(!1)}},j=async()=>{if(c.length===0){fe.error("Please select at least one table to merge");return}h(!0);try{const A=[r.id,...c],S=await pn.mergeTables(A,n);if(!S.success)throw new Error(S.error||"Failed to merge tables");const k=[r.number,...c.map(M=>{const I=i.find(E=>E.id===M);return(I==null?void 0:I.number)||"Unknown"})];for(const M of s)await Za.updateOrderForMerge(M.id,n,k);fe.success(`Tables ${k.join(", ")} merged successfully`),a(),e()}catch(A){console.error("Merge failed:",A),fe.error(A instanceof Error?A.message:"Merge failed")}finally{h(!1)}},F=()=>s.reduce((A,S)=>A+S.total,0),U=()=>c.map(A=>{const S=i.find(k=>k.id===A);return S?`Table ${S.number}`:"Unknown"}).join(", ");return t?o.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:o.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[o.jsx("div",{className:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75",onClick:e}),o.jsxs("div",{className:"inline-block w-full max-w-2xl my-8 overflow-hidden text-left align-middle transition-all transform bg-white shadow-xl rounded-2xl",children:[o.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Table Management"}),o.jsxs("p",{className:"text-sm text-gray-600",children:["Current Table: ",r.number," | ",s.length," orders | ",pt(F())]})]}),o.jsx("button",{onClick:e,className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100",children:o.jsx(Zn,{className:"w-5 h-5"})})]})}),o.jsxs("div",{className:"px-6 py-4",children:[o.jsxs("div",{className:"mb-6",children:[o.jsxs("div",{className:"flex space-x-4",children:[o.jsxs("button",{onClick:()=>b("transfer"),className:`flex items-center px-4 py-2 rounded-lg transition-colors ${d==="transfer"?"bg-blue-100 text-blue-800 border-2 border-blue-300":"bg-gray-100 text-gray-600 border-2 border-gray-200 hover:bg-gray-200"}`,children:[o.jsx(j_,{className:"w-4 h-4 mr-2"}),"Transfer Table"]}),o.jsxs("button",{onClick:()=>b("merge"),className:`flex items-center px-4 py-2 rounded-lg transition-colors ${d==="merge"?"bg-purple-100 text-purple-800 border-2 border-purple-300":"bg-gray-100 text-gray-600 border-2 border-gray-200 hover:bg-gray-200"}`,children:[o.jsx(sC,{className:"w-4 h-4 mr-2"}),"Merge Tables"]})]}),o.jsxs("div",{className:"mt-2",children:[d==="transfer"&&o.jsx("p",{className:"text-sm text-gray-600",children:"Move all orders from this table to another available table"}),d==="merge"&&o.jsx("p",{className:"text-sm text-gray-600",children:"Combine orders from multiple tables into one bill"})]})]}),o.jsxs("div",{className:"mb-6",children:[o.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:d==="transfer"?"Select Target Table":"Select Tables to Merge"}),g?o.jsxs("div",{className:"text-center py-4",children:[o.jsx("div",{className:"inline-block animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),o.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"Loading tables..."})]}):o.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3 max-h-48 overflow-y-auto",children:i.map(A=>o.jsxs("button",{onClick:()=>w(A.id),className:`p-3 border-2 rounded-lg text-center transition-colors ${c.includes(A.id)?"border-blue-500 bg-blue-50 text-blue-800":"border-gray-200 hover:border-gray-300 text-gray-700"}`,children:[o.jsxs("div",{className:"font-medium",children:["Table ",A.number]}),o.jsx("div",{className:"text-xs text-gray-500",children:A.area}),o.jsx("div",{className:`text-xs mt-1 px-2 py-1 rounded-full ${A.status==="available"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:A.status})]},A.id))}),i.length===0&&!g&&o.jsxs("div",{className:"text-center py-8",children:[o.jsx($c,{className:"w-8 h-8 text-gray-400 mx-auto mb-2"}),o.jsx("p",{className:"text-gray-600",children:d==="transfer"?"No available tables for transfer":"No tables available for merging"})]})]}),c.length>0&&o.jsxs("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[o.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Operation Summary"}),d==="transfer"&&o.jsxs("p",{className:"text-sm text-gray-600",children:["Transfer ",s.length," orders from Table ",r.number," to ",U()]}),d==="merge"&&o.jsxs("p",{className:"text-sm text-gray-600",children:["Merge Table ",r.number," with ",U()]}),o.jsxs("p",{className:"text-sm font-medium text-gray-900 mt-1",children:["Total Amount: ",pt(F())]})]})]}),o.jsx("div",{className:"px-6 py-4 border-t border-gray-200 bg-gray-50",children:o.jsxs("div",{className:"flex items-center justify-end space-x-3",children:[o.jsx("button",{onClick:e,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",disabled:m,children:"Cancel"}),o.jsx("button",{onClick:d==="transfer"?N:j,disabled:c.length===0||m,className:`px-4 py-2 text-sm font-medium text-white rounded-lg transition-colors ${c.length===0||m?"bg-gray-400 cursor-not-allowed":d==="transfer"?"bg-blue-600 hover:bg-blue-700":"bg-purple-600 hover:bg-purple-700"}`,children:m?o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Processing..."]}):o.jsx("div",{className:"flex items-center",children:d==="transfer"?o.jsxs(o.Fragment,{children:[o.jsx(j_,{className:"w-4 h-4 mr-1"}),"Transfer"]}):o.jsxs(o.Fragment,{children:[o.jsx(sC,{className:"w-4 h-4 mr-1"}),"Merge"]})})})]})})]})]})}):null}function GK(){const{tableId:t}=px(),e=Wl(),{restaurant:r}=ya(),{user:n}=Xc(),[s,a]=X.useState(null),[i,l]=X.useState([]),[c,u]=X.useState([]),[d,f]=X.useState([]),[,m]=X.useState(null),[h,g]=X.useState([]),[p,v]=X.useState("cart"),[b,w]=X.useState("all"),[N,j]=X.useState(""),[F,U]=X.useState(!0),[A,S]=X.useState(!1),[k,M]=X.useState(!1),[I,E]=X.useState(!1),[D,G]=X.useState(!1),[Z,ae]=X.useState(!1),[de,se]=X.useState(null),[Y,ye]=X.useState(!1),[re,C]=X.useState(!1),[O,L]=X.useState("processing"),[H,K]=X.useState(""),[q,te]=X.useState(!1),[oe,V]=X.useState(null),{register:xe,handleSubmit:B,reset:Ee}=Hn(),{setValue:Me}=Hn({defaultValues:{method:"cash"}});X.useEffect(()=>{console.log(" TakeOrder: Auth state changed:",{hasUser:!!n,userId:n==null?void 0:n.id,userName:n==null?void 0:n.name,userRole:n==null?void 0:n.role,loading:!1})},[n]);const Ie=async()=>{if(!(!r||!t))try{U(!0);const Te=await pn.getTableById(t,r.id);Te.success&&Te.data&&a(Te.data),console.log(" Initializing default menu for restaurant:",r.id);const je=await cs.initializeDefaultMenu(r.id);je.success?console.log(" Default menu initialization successful"):console.error(" Default menu initialization failed:",je.error);const[et,St]=await Promise.all([cs.getMenuItemsForRestaurant(r.id),cs.getCategoriesForRestaurant(r.id)]);et.success&&et.data&&l(et.data.filter(vt=>vt.isAvailable)),St.success&&St.data&&u(St.data)}catch{fe.error("Failed to load menu data")}finally{U(!1)}},he=()=>{if(r&&t){const Te=Gn.getCartItems(r.id,t);f(Te)}},qe=async()=>{if(!(!r||!t))try{const Te=await Za.getOrdersByTable(r.id,t);if(Te.success&&Te.data){const je=Te.data.filter(et=>["placed","confirmed","preparing","ready"].includes(et.status));if(g(je),je.length>0){const et=je.sort((St,vt)=>new Date(vt.createdAt).getTime()-new Date(St.createdAt).getTime())[0];m(et),v("placed"),Gn.clearCart(r.id,t),f([])}}}catch(Te){console.error("Failed to check existing order:",Te)}},ct=(Te,je=1,et=!1)=>{if(console.log(" addToCart called:",{itemName:Te.name,quantity:je,forceAdd:et,orderState:p,hasRestaurant:!!r,hasTableId:!!t}),!r||!t){console.error(` Missing required data: restaurant=${!!r}, tableId=${!!t}`);return}if(!et&&!["cart","adding_more"].includes(p)){console.log(` Order state ${p} not allowed for manual add, skipping`);return}if(Te.variants&&Te.variants.length>0&&!et){se(Te),ae(!0);return}const St={menuItemId:Te.id,name:Te.name,price:Te.price,quantity:je,total:Te.price*je};console.log(" Adding cart item:",St);const vt=Gn.addToCart(r.id,St,t);console.log(` Cart updated, new length: ${vt.length}`),f(vt),fe.success(`${Te.name} added to order`)},lt=(Te,je)=>{if(!r||!t||!de)return;const et=Number(je)||Number(de.price)||0,St=Te.map(Qt=>`${Qt.variantName}: ${Qt.optionName}`),vt=St.length>0?`${de.name} (${St.join(", ")})`:de.name,st={menuItemId:de.id,name:vt,price:et,quantity:1,total:et,variants:Te},zt=Gn.addToCart(r.id,st,t);f(zt),fe.success(`${de.name} added to order`),se(null),ae(!1)},ue=(Te,je)=>{if(!r||!t||!["cart","adding_more"].includes(p))return;const et=Gn.updateCartItemQuantity(r.id,Te,je,t);f(et)},Ne=Te=>{if(!r||!t||!["cart","adding_more"].includes(p))return;const je=Gn.removeFromCart(r.id,Te,t);f(je)},Ae=()=>{v("adding_more"),G(!0),r&&Gn.clearCart(r.id,t),f([]),Ee()},Be=async(Te,je)=>{if(console.log(" handlePlaceOrderWithCart called with:",{restaurant:r==null?void 0:r.name,tableId:t,cartItemsCount:Te.length,user:n==null?void 0:n.name,userId:n==null?void 0:n.id,orderNotes:je.orderNotes}),!r||!t||Te.length===0||!n){const et=[];r||et.push("restaurant"),t||et.push("tableId"),Te.length===0&&et.push("cartItems"),n||et.push("user");const St=`Unable to place order. Missing: ${et.join(", ")}`;return console.error(" Order placement failed:",St),re||fe.error(St),null}try{S(!0),console.log(" Starting order placement process..."),p==="cart"&&(console.log(" Updating table status to occupied..."),await pn.updateTable(t,r.id,{status:"occupied"})),console.log(" Creating order in Firebase...",{restaurantId:r.id,tableId:t,staffId:n.id,itemCount:Te.length,taxRate:r.settings.taxRate});const et=await Za.createOrder(r.id,t,n.id,Te,r.settings.taxRate,je.orderNotes||void 0);if(et.success&&et.data){const St=et.data;console.log(" Order created successfully:",{orderId:St.id,orderNumber:St.orderNumber,total:St.total,itemCount:St.items.length}),m(St),p==="adding_more"?(g(st=>[...st,St]),v("placed"),G(!1)):(g([St]),v("placed")),Gn.clearCart(r.id,t),f([]),Ee();const vt=p==="adding_more"?"Additional order placed successfully!":"Order placed successfully!";return fe.success(vt),console.log(" Order placement completed successfully"),setTimeout(()=>{if(s){const st=_w(St,r,s),zt=window.open("","_blank");zt&&(zt.document.write(st),zt.document.close(),zt.focus(),zt.print(),zt.close()),re||fe.success("KOT sent to kitchen")}},500),St}else return console.error(" Order creation failed:",et.error),re||fe.error(et.error||"Failed to place order"),null}catch(et){return console.error(" Order placement exception:",et),re||fe.error("Failed to place order"),null}finally{S(!1)}},Ue=async Te=>{if(console.log(" handlePlaceOrder called with:",{restaurant:r==null?void 0:r.name,tableId:t,cartItemsCount:d.length,user:n==null?void 0:n.name,userId:n==null?void 0:n.id,orderNotes:Te.orderNotes}),!r||!t||d.length===0||!n){const je=[];r||je.push("restaurant"),t||je.push("tableId"),d.length===0&&je.push("cartItems"),n||je.push("user");const et=`Unable to place order. Missing: ${je.join(", ")}`;console.error(" Order placement failed:",et),fe.error(et);return}try{S(!0),console.log(" Starting order placement process..."),p==="cart"&&(console.log(" Updating table status to occupied..."),await pn.updateTable(t,r.id,{status:"occupied"})),console.log(" Creating order in Firebase...",{restaurantId:r.id,tableId:t,staffId:n.id,itemCount:d.length,taxRate:r.settings.taxRate});const je=await Za.createOrder(r.id,t,n.id,d,r.settings.taxRate,Te.orderNotes||void 0);if(je.success&&je.data){const et=je.data;console.log(" Order created successfully:",{orderId:et.id,orderNumber:et.orderNumber,total:et.total,itemCount:et.items.length}),m(et),p==="adding_more"?(g(vt=>[...vt,et]),v("placed"),G(!1)):(g([et]),v("placed"),G(!1)),Gn.clearCart(r.id,t),f([]),Ee();const St=p==="adding_more"?"Additional order placed successfully!":"Order placed successfully!";fe.success(St),console.log(" Order placement completed successfully"),setTimeout(()=>{if(s){const vt=_w(et,r,s),st=window.open("","_blank");st&&(st.document.write(vt),st.document.close(),st.focus(),st.print(),st.close()),fe.success("KOT sent to kitchen")}},500)}else console.error(" Order creation failed:",je.error),fe.error(je.error||"Failed to place order")}catch(je){console.error(" Order placement exception:",je),fe.error("Failed to place order")}finally{S(!1)}},Ce=()=>{if(!r||!s||h.length===0)return;const Te=h[h.length-1],je=_w(Te,r,s),et=window.open("","_blank");et&&(et.document.write(je),et.document.close(),et.focus(),et.print(),et.close()),fe.success("KOT sent to printer")},Ye=async Te=>{if(!(!r||!t||h.length===0))try{if(M(!0),Te.appliedCoupon)try{await Ui.markCouponAsUsed(Te.appliedCoupon.coupon.id,r.id),fe.success(`Coupon "${Te.appliedCoupon.coupon.code}" has been redeemed!`)}catch(vt){console.error("Failed to mark coupon as used:",vt)}const je=h.map(async vt=>{const st={status:"completed",paymentMethod:Te.method,amountReceived:Te.amountReceived,finalTotal:Te.finalTotal,originalTotal:Te.originalTotal};return Te.appliedCoupon&&(st.appliedCoupon={code:Te.appliedCoupon.coupon.code,name:Te.appliedCoupon.coupon.name,discountAmount:Te.appliedCoupon.discountAmount||0,freeItems:Te.appliedCoupon.freeItems||[],totalSavings:Te.totalSavings||0}),Te.customerId&&(st.customerId=Te.customerId),Za.updateOrderStatus(vt.id,r.id,"completed",st)});if((await Promise.all(je)).every(vt=>vt.success)){Te.customerId&&await ra.addOrderToCustomer(Te.customerId,r.id,h.map(st=>st.id).join(","),Te.finalTotal),await pn.updateTable(t,r.id,{status:"available"}),v("completed"),E(!1);const vt=Te.totalSavings>0?`Payment processed! Customer saved ${pt(Te.totalSavings)} with coupon!`:"Payment processed successfully!";fe.success(vt),setTimeout(()=>{It(h,Te)},500)}else fe.error("Failed to complete payment for some orders")}catch(je){fe.error("Failed to process payment"),console.error("Payment error:",je)}finally{M(!1)}},It=(Te,je)=>{if(!Te.length||!r||!s)return;const et=KK(Te,r,s,je),St=window.open("","_blank");St&&(St.document.write(et),St.document.close(),St.focus(),St.print(),St.close()),fe.success("Combined bill sent to printer")},Dt=()=>{!r||!t||!["cart","adding_more"].includes(p)||(Gn.clearCart(r.id,t),f([]),p==="adding_more"&&(v("placed"),G(!1)),fe.success("Order cleared"))},Ot=X.useCallback(async Te=>{const{command:je}=Te.detail;if(console.log(" TakeOrder: Voice order command received:",je),!n){console.log(" User not authenticated, retrying in 2 seconds..."),fe.error(" Authentication loading... Please try again in a moment."),setTimeout(()=>{const et=new CustomEvent("voiceOrderCommand",{detail:{command:je}});window.dispatchEvent(et)},2e3);return}if(C(!0),L("processing"),K("Analyzing your voice command..."),fe.dismiss(),je.menuItems&&je.menuItems.length>0){let et=0;if(await(async()=>{for(const vt of je.menuItems||[]){console.log(` Searching for menu item: "${vt.name}" in ${i.length} available items`);const zt=(Qt=>{const nr=Qt.toLowerCase().trim();console.log(` Searching for: "${nr}"`);const dr=ir=>ir.endsWith("s")&&ir.length>3&&!ir.endsWith("ss")?ir.slice(0,-1):ir,Vr=ir=>ir.endsWith("s")||ir.endsWith("x")||ir.endsWith("sh")||ir.endsWith("ch")?ir+"es":ir.endsWith("y")&&ir.length>1?ir.slice(0,-1)+"ies":ir+"s";let Et=i.find(ir=>ir.name.toLowerCase()===nr);if(Et)return console.log(` Exact match found: ${Et.name}`),Et;const qr=nr.split(" "),Qr=[[...qr.slice(0,-1),Vr(qr[qr.length-1])].join(" "),[...qr.slice(0,-1),dr(qr[qr.length-1])].join(" "),qr.map(dr).join(" "),qr.map(Vr).join(" ")];for(const ir of Qr)if(Et=i.find(ee=>ee.name.toLowerCase()===ir||ee.name.toLowerCase().includes(ir)||ir.includes(ee.name.toLowerCase())),Et)return console.log(` Variation match found: "${ir}"  ${Et.name}`),Et;const Wr=nr.split(" ").filter(ir=>ir.length>2);if(Et=i.find(ir=>{const ee=ir.name.toLowerCase().split(" ");return Wr.every(be=>{const pe=dr(be);return ee.some(ge=>{const we=dr(ge);return we.includes(pe)||pe.includes(we)||ge.includes(be)||be.includes(ge)})})}),Et)return console.log(` Fuzzy match found: ${Et.name}`),Et;const Nn={wings:["chicken wings","buffalo wings","hot wings"],"chicken wing":["chicken wings","buffalo wings"],wing:["chicken wings","buffalo wings","hot wings"],burger:["beef burger","chicken burger","cheese burger"],juice:["fresh orange juice","apple juice","grape juice"],orange:["fresh orange juice","orange juice"],salad:["caesar salad","garden salad","greek salad"],caesar:["caesar salad"],chicken:["grilled chicken","fried chicken","chicken breast"],fish:["grilled fish","fried fish","fish fillet"],pasta:["spaghetti","penne pasta","pasta marinara"],pizza:["margherita pizza","cheese pizza","pepperoni pizza"]};for(const[ir,ee]of Object.entries(Nn))if(nr.includes(ir)||dr(nr).includes(dr(ir))){for(const be of ee)if(Et=i.find(pe=>pe.name.toLowerCase().includes(be.toLowerCase())||be.toLowerCase().includes(pe.name.toLowerCase())),Et)return console.log(` Alias match found: "${ir}"  ${Et.name}`),Et}return console.log(` No match found for: "${nr}"`),null})(vt.name);if(zt){const Qt=r&&t?Gn.getCartItems(r.id,t):[];console.log(` Current orderState: ${p}, attempting to add ${zt.name}`),console.log(` Adding ${zt.name} to cart with force=true (orderState: ${p})`),K(`Adding ${zt.name} to order...`),(p==="placed"||p==="completed")&&(console.log(" Setting orderState to 'adding_more' for voice command"),v("adding_more")),ct(zt,vt.quantity,!0),await new Promise(dr=>setTimeout(dr,200));const nr=r&&t?Gn.getCartItems(r.id,t):[];if(nr.length>Qt.length)et++,console.log(` Verified: Added ${vt.quantity}x ${zt.name} to cart (${Qt.length}  ${nr.length})`);else if(console.error(` Failed to add ${zt.name} to cart - orderState: ${p}`),console.error(` Cart verification: before=${Qt.length}, after=${nr.length}`),r&&t){console.log(" Attempting direct cart addition as fallback");const dr={menuItemId:zt.id,name:zt.name,price:zt.price,quantity:vt.quantity,total:zt.price*vt.quantity},Vr=Gn.addToCart(r.id,dr,t);f(Vr);const Et=Gn.getCartItems(r.id,t);Et.length>Qt.length?(et++,fe.success(` Added ${vt.quantity}x ${zt.name} to order (direct)`),console.log(` Direct addition successful: ${Qt.length}  ${Et.length}`)):(fe.error(` Failed to add ${zt.name} to cart`),console.error(" Direct addition also failed"))}}else{fe.error(` Menu item "${vt.name}" not found`),console.log(` Menu item not found: "${vt.name}"`);const Qt=i.filter(nr=>{const dr=nr.name.toLowerCase(),Vr=vt.name.toLowerCase(),Et=dr.split(" "),qr=Vr.split(" ");return Et.some(Qr=>qr.some(Wr=>Qr.includes(Wr)||Wr.includes(Qr)))}).slice(0,3).map(nr=>nr.name);Qt.length>0&&(console.log(` Did you mean: ${Qt.join(", ")}?`),fe(` Did you mean: ${Qt.join(", ")}?`,{duration:4e3}))}}return et})(),et>0){if(console.log(` Voice cart update complete. Added ${et} items.`),L("placing"),K("Creating your order..."),r&&t){const vt=Gn.getCartItems(r.id,t);f(vt),console.log(` Cart updated: ${vt.length} items total`),vt.length>0?setTimeout(async()=>{var zt;console.log(" Auto-placing order after voice command");const st=Gn.getCartItems(r.id,t);if(console.log(` Final cart check before placing: ${st.length} items`),st.length>0)try{await Be(st,{orderNotes:`Voice order: ${(zt=je.menuItems)==null?void 0:zt.map(Qt=>`${Qt.quantity}x ${Qt.name}`).join(", ")} - placed at ${new Date().toLocaleTimeString()}`}),L("completed"),K("Order placed successfully!"),s&&je.menuItems&&V({orderNumber:`ORD-${Date.now()}`,tableNumber:s.number,items:je.menuItems.map(Qt=>({name:Qt.name,quantity:Qt.quantity}))}),setTimeout(()=>{C(!1),Ce()},1e3)}catch(Qt){console.error(" Voice order placement failed:",Qt),C(!1),fe.error(" Failed to place order. Please try manually.")}else console.error(" Cart is empty during auto-place, cannot proceed"),C(!1),fe.error(" Failed to place order - cart appears to be empty")},500):(console.error(" No items in cart after voice command processing"),C(!1),fe.error(" Failed to add items to cart"))}}else C(!1),fe.error(" Please specify menu items to add to the order")}else fe(" Please specify menu items to add to the order")},[i,ct,Ue,s,r,n]),Pt=X.useCallback(async Te=>{const{command:je}=Te.detail;if(console.log(" Voice payment command received:",{command:je,currentTable:s==null?void 0:s.number,ordersCount:h.length,cartItemsCount:d.length}),je.tableNumber&&s&&parseInt(s.number)!==je.tableNumber){fe.error(` This is table ${s.number}, but payment was requested for table ${je.tableNumber}`);return}if(h.length===0&&d.length===0){fe.error(` No orders found for payment on table ${s==null?void 0:s.number}`);return}if(d.length>0){fe.error(" Please place the current order first before making payment"),console.log(" Cart has items, cannot process payment yet");return}const et={UPI:"upi",CASH:"cash",BANK:"bank",CARD:"bank",CREDIT:"bank",DEBIT:"bank",MONEY:"cash",GPAY:"upi",PAYTM:"upi",PHONEPE:"upi"},St=je.paymentMethod?et[je.paymentMethod]:"cash";if(console.log(" Payment method mapping:",{originalMethod:je.paymentMethod,mappedMethod:St}),!St){fe.error(` Invalid payment method: ${je.paymentMethod}`);return}const vt=h.reduce((st,zt)=>st+zt.total,0);console.log(" Processing voice payment:",{method:St,combinedTotal:vt,ordersCount:h.length,tableNumber:s==null?void 0:s.number});try{fe.success(` Processing ${St.toUpperCase()} payment for table ${s==null?void 0:s.number}...`),fe(` Total amount: ${vt.toFixed(2)}`);const st={method:St,amountReceived:vt,originalTotal:vt,finalTotal:vt,tip:0,reference:`Voice payment - ${new Date().toLocaleTimeString()}`,customerId:void 0,appliedCoupon:void 0,totalSavings:0,printBill:!0};console.log(" Payment data prepared:",st),fe(" Finalizing payment and updating order status..."),await Ye(st),fe.success(` Payment of ${vt.toFixed(2)} completed via ${St.toUpperCase()}!`),fe.success(` Table ${s==null?void 0:s.number} is now available for new customers`),console.log(" Voice payment completed successfully"),setTimeout(()=>{e(`/${r==null?void 0:r.slug}/tables`)},3e3)}catch(st){console.error(" Voice payment failed:",st),fe.error(" Voice payment failed. Please process manually."),E(!0),fe(" Opening payment window for manual processing...")}},[s,h,d,Ye,r,e]),ht=X.useCallback(async Te=>{const{command:je}=Te.detail;if(console.log(" TakeOrder: Voice KOT print command received:",je),!r||!s||h.length===0){console.log(" Missing requirements for KOT printing:",{hasRestaurant:!!r,hasTable:!!s,orderCount:h.length}),h.length===0?fe.error(" No orders to print KOT for"):fe.error(" Unable to print KOT at this time");return}console.log(" Triggering KOT print for table:",s.number),Ce(),fe.success(` KOT printed for table ${s.number}`)},[r,s,h,Ce]),or=X.useCallback(async Te=>{const{command:je}=Te.detail;if(console.log(" TakeOrder: Voice order cancel command received:",je),!r||!s||h.length===0){console.log(" Missing requirements for order cancellation:",{hasRestaurant:!!r,hasTable:!!s,orderCount:h.length}),h.length===0?fe.error(" No orders to cancel"):fe.error(" Unable to cancel orders at this time");return}if(confirm(`Cancel all orders for table ${s.number}? This action cannot be undone.`))try{console.log(" Canceling orders for table:",s.number);const St=h.map(async zt=>Za.updateOrderStatus(zt.id,r.id,"cancelled",{notes:"Voice command cancellation - "+new Date().toLocaleString()}));(await Promise.all(St)).every(zt=>zt.success)?(await pn.updateTable(s.id,r.id,{status:"available"}),g([]),m(null),v("cart"),Gn.clearCart(r.id,s.id),f([]),fe.success(" All orders cancelled successfully"),setTimeout(()=>{e(`/${r.slug}/tables`)},1500)):fe.error(" Failed to cancel some orders")}catch(St){console.error(" Error canceling orders:",St),fe.error(" Failed to cancel orders")}else fe(" Order cancellation cancelled")},[r,s,h,e,Za,pn,Gn]),Ve=X.useCallback(async Te=>{var st,zt;const{command:je}=Te.detail;if(console.log(" TakeOrder: Voice customer command received:",je),!r){fe.error(" Restaurant context not available");return}const{customerName:et,customerPhone:St,customerEmail:vt}=je;if(!et&&!St){fe.error(" Please specify customer name or phone number");return}try{const Qt={name:et||"",phone:St||"",email:vt||"",address:"",preferences:["voice_added"]};console.log(" Creating customer via voice:",Qt);const{CustomerService:nr}=await Bi(async()=>{const{CustomerService:Vr}=await Promise.resolve().then(()=>fD);return{CustomerService:Vr}},void 0),dr=await nr.createCustomer(r.id,Qt);if(dr.success){const Vr=et||`Customer with phone ${St}`;fe.success(` Successfully added ${Vr} to CRM!`),vt&&fe.success(` Email ${vt} saved for ${Vr}`),console.log(" Customer created successfully:",dr.data)}else console.error(" Customer creation failed:",dr.error),(st=dr.error)!=null&&st.includes("already exists")||(zt=dr.error)!=null&&zt.includes("duplicate")?fe.error(" Customer with this information already exists in CRM"):fe.error(` Failed to add customer: ${dr.error||"Unknown error"}`)}catch(Qt){console.error(" Error creating customer:",Qt),fe.error(" Failed to add customer to CRM")}},[r]),tt=X.useCallback(async Te=>{const{command:je}=Te.detail;if(console.log(" TakeOrder: Voice place order command received:",{command:je,currentTable:s==null?void 0:s.number,commandTableNumber:je.tableNumber,commandMenuItems:je.menuItems,cartItemsLength:d.length,restaurantExists:!!r}),!r||!s){console.error(" Missing restaurant or table:",{restaurant:!!r,table:!!s}),fe.error(" Unable to place order at this time");return}if(je.tableNumber&&parseInt(s.number)!==je.tableNumber){console.warn(` Table mismatch: current=${s.number}, requested=${je.tableNumber}`),fe.error(` This is table ${s.number}, but order was requested for table ${je.tableNumber}`);return}try{if(je.menuItems&&je.menuItems.length>0){console.log(" Processing voice menu items directly:",je.menuItems);for(const et of je.menuItems){const vt=(st=>{const zt=nr=>nr.toLowerCase().replace(/s$/,"").replace(/ies$/,"y").replace(/es$/,"").trim(),Qt=st.toLowerCase().split(" ").map(zt);return i.find(nr=>{const dr=nr.name.toLowerCase().split(" ").map(zt);return Qt.every(Vr=>dr.some(Et=>Et.includes(Vr)||Vr.includes(Et)))})})(et.name);vt?(console.log(` Found menu item: ${vt.name} for voice item: ${et.name}`),ct(vt,et.quantity,!0)):(console.warn(` Menu item not found: ${et.name}`),fe.error(`Menu item "${et.name}" not found`))}setTimeout(async()=>{var et;console.log(" Placing order after adding voice items to cart"),await Ue({orderNotes:`Voice order: ${(et=je.menuItems)==null?void 0:et.map(St=>`${St.quantity}x ${St.name}`).join(", ")} - placed at ${new Date().toLocaleTimeString()}`}),fe.success(` Order placed successfully for table ${s.number}!`)},100)}else{if(d.length===0){console.warn(" No items in cart and no voice menu items"),fe.error(` No items to place order for table ${s.number}`);return}await Ue({orderNotes:`Voice order placed at ${new Date().toLocaleTimeString()}`}),fe.success(` Order placed successfully for table ${s.number}!`)}console.log(" Voice place order completed successfully")}catch(et){console.error(" Voice place order failed:",et),fe.error(" Failed to place order. Please try manually.")}},[r,s,d,Ue,p,i,ct]);X.useEffect(()=>(console.log(" TakeOrder: Setting up voice command event listeners"),window.addEventListener("voiceOrderCommand",Ot),window.addEventListener("voicePlaceOrderCommand",tt),window.addEventListener("voicePaymentCommand",Pt),window.addEventListener("voiceKotPrintCommand",ht),window.addEventListener("voiceOrderCancelCommand",or),window.addEventListener("voiceCustomerCommand",Ve),()=>{console.log(" TakeOrder: Cleaning up voice command event listeners"),window.removeEventListener("voiceOrderCommand",Ot),window.removeEventListener("voicePlaceOrderCommand",tt),window.removeEventListener("voicePaymentCommand",Pt),window.removeEventListener("voiceKotPrintCommand",ht),window.removeEventListener("voiceOrderCancelCommand",or),window.removeEventListener("voiceCustomerCommand",Ve)}),[Ot,tt,Pt,ht,or,Ve]),X.useEffect(()=>{console.log(" TakeOrder: Component mounting/loading data...",{tableId:t,restaurantSlug:r==null?void 0:r.slug,hasUser:!!n}),r&&t&&(Ie(),he(),qe())},[r,t]),X.useEffect(()=>{if(h.length>0&&I){const Te=h.reduce((je,et)=>je+et.total,0);Me("amountReceived",Te)}},[h,I,Me]);const nt=i.filter(Te=>{var St;const je=b==="all"||Te.category===b,et=N===""||Te.name.toLowerCase().includes(N.toLowerCase())||((St=Te.description)==null?void 0:St.toLowerCase().includes(N.toLowerCase()));return je&&et}),At=d.reduce((Te,je)=>Te+je.total,0),mr=At*((r==null?void 0:r.settings.taxRate)||8.5)/100,Wt=At+mr;return!r||!s?o.jsx("div",{className:"min-h-screen flex items-center justify-center",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),o.jsx("p",{className:"text-gray-600",children:"Loading..."})]})}):o.jsxs("div",{className:"min-h-screen",style:{background:"var(--color-background)"},children:[o.jsx("header",{className:"bg-white/80 backdrop-blur-md border-b border-gray-200 sticky top-0 z-40",children:o.jsx("div",{className:"max-w-full mx-auto px-4 sm:px-6 lg:px-8 py-4",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsx("button",{onClick:()=>e(`/${r.slug}/tables`),className:"p-2 text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:o.jsx(gm,{className:"w-5 h-5"})}),o.jsxs("div",{children:[o.jsxs("h1",{className:"text-xl font-bold text-gray-900",children:["Table ",s.number," - ",s.area]}),o.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-600",children:[o.jsxs("span",{children:["Capacity: ",s.capacity," guests"]}),o.jsxs("span",{className:"capitalize",children:["Status: ",s.status.replace("_"," ")]}),p==="placed"&&h.length>0&&o.jsxs("span",{className:"text-blue-600 font-medium",children:[h.length," Active Order",h.length>1?"s":""]})]})]})]}),o.jsxs("div",{className:"flex items-center space-x-3",children:[p==="placed"&&h.length>0&&d.length===0&&o.jsxs("div",{className:"hidden sm:flex items-center space-x-2",children:[o.jsxs("button",{onClick:Ae,className:"btn btn-theme-primary text-sm px-3 py-1.5",children:[o.jsx(Wn,{className:"w-4 h-4 mr-1"}),"Add More"]}),o.jsxs("button",{onClick:Ce,className:"btn btn-secondary text-sm px-3 py-1.5",children:[o.jsx(JR,{className:"w-4 h-4 mr-1"}),"KOT"]}),o.jsxs("button",{onClick:()=>E(!0),className:"btn bg-green-600 text-white hover:bg-green-700 text-sm px-3 py-1.5",children:[o.jsx(P_,{className:"w-4 h-4 mr-1"}),"Payment"]}),o.jsxs("button",{onClick:()=>ye(!0),className:"btn bg-blue-600 text-white hover:bg-blue-700 text-sm px-3 py-1.5",children:[o.jsx(j_,{className:"w-4 h-4 mr-1"}),"Manage"]})]}),p==="placed"&&h.length>0&&d.length===0&&o.jsx("div",{className:"sm:hidden",children:o.jsx("button",{onClick:()=>E(!0),className:"btn bg-green-600 text-white hover:bg-green-700 text-sm px-3 py-1.5",children:o.jsx(P_,{className:"w-4 h-4"})})}),["cart","adding_more"].includes(p)&&d.length>0&&o.jsxs("button",{onClick:Dt,className:"btn btn-secondary text-sm px-3 py-1.5",children:[o.jsx(ga,{className:"w-4 h-4 mr-1"}),"Clear"]}),p==="completed"&&o.jsxs("div",{className:"flex items-center space-x-2 text-green-600",children:[o.jsx(z1,{className:"w-5 h-5"}),o.jsx("span",{className:"font-medium",children:"Order Completed"})]})]})]})})}),o.jsx("div",{className:"h-[calc(100vh-80px)]",children:o.jsx("div",{className:"h-full overflow-hidden",children:o.jsxs("main",{className:"h-full px-4 sm:px-6 lg:px-8 py-6",children:[D&&p==="adding_more"&&o.jsx("div",{className:"fixed inset-y-0 right-0 w-96 bg-white shadow-xl z-50 border-l border-gray-200",children:o.jsxs("div",{className:"h-full flex flex-col",children:[o.jsxs("div",{className:"p-4 border-b border-gray-200",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Order Summary"}),o.jsx("button",{onClick:()=>G(!1),className:"p-2 text-gray-400 hover:text-gray-600",children:o.jsx(Zn,{className:"w-5 h-5"})})]}),o.jsxs("p",{className:"text-sm text-gray-600",children:["Existing orders on Table ",s.number]})]}),o.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:h.map(Te=>o.jsxs("div",{className:"mb-4 bg-gray-50 rounded-lg p-3",children:[o.jsxs("div",{className:"flex justify-between items-center mb-2",children:[o.jsxs("span",{className:"font-medium text-gray-900",children:["Order #",Te.orderNumber]}),o.jsx("span",{className:"text-gray-600",children:pt(Te.total)})]}),o.jsx("div",{className:"space-y-1",children:Te.items.map(je=>o.jsxs("div",{className:"flex justify-between text-sm",children:[o.jsxs("span",{className:"text-gray-600",children:[je.quantity,"x ",je.name]}),o.jsx("span",{className:"text-gray-600",children:pt(je.total)})]},je.id))})]},Te.id))}),o.jsx("div",{className:"border-t border-gray-200 p-4",children:o.jsx("button",{onClick:()=>{G(!1),v("placed")},className:"w-full btn btn-secondary",children:"Back to Orders"})})]})}),(p==="cart"||p==="adding_more")&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"hidden lg:flex gap-6 h-[calc(100vh-200px)]",children:[o.jsxs("div",{className:"flex-1 overflow-hidden",children:[o.jsx("div",{className:"card p-4 mb-6",children:o.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[o.jsxs("div",{className:"flex-1 relative",children:[o.jsx(Eo,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),o.jsx("input",{type:"text",placeholder:"Search menu items...",value:N,onChange:Te=>j(Te.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(Wg,{className:"w-4 h-4 text-gray-600"}),o.jsxs("select",{value:b,onChange:Te=>w(Te.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[o.jsx("option",{value:"all",children:"All Categories"}),c.map(Te=>o.jsx("option",{value:Te.name,children:Te.name},Te.id))]})]})]})}),o.jsx("div",{className:"overflow-y-auto h-full",children:F?o.jsxs("div",{className:"text-center py-12",children:[o.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mb-4"}),o.jsx("p",{className:"text-gray-600",children:"Loading menu..."})]}):o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 2xl:grid-cols-5 gap-4 pb-6",children:nt.map(Te=>{const je=d.find(et=>et.menuItemId===Te.id);return o.jsx(TC,{item:Te,onAddToCart:ct,cartQuantity:(je==null?void 0:je.quantity)||0},Te.id)})})})]}),o.jsx("div",{className:"w-80 lg:w-96 flex flex-col",children:o.jsxs("div",{className:"card h-full flex flex-col",children:[o.jsxs("div",{className:"p-4 border-b border-gray-200",children:[o.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Current Order"}),o.jsxs("p",{className:"text-sm text-gray-600",children:["Table ",s.number]})]}),o.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:d.length===0?o.jsxs("div",{className:"text-center py-8",children:[o.jsx(iC,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),o.jsx("p",{className:"text-gray-600",children:"No items added yet"}),o.jsx("p",{className:"text-sm text-gray-500",children:"Select items from the menu to start building the order"})]}):o.jsx("div",{className:"space-y-3",children:d.map(Te=>o.jsx(AC,{item:Te,onUpdateQuantity:ue,onRemove:Ne},Te.menuItemId))})}),d.length>0&&o.jsxs("div",{className:"border-t border-gray-200 p-4",children:[o.jsxs("div",{className:"space-y-2 mb-4",children:[o.jsxs("div",{className:"flex justify-between text-sm",children:[o.jsx("span",{children:"Subtotal:"}),o.jsx("span",{children:pt(At)})]}),o.jsxs("div",{className:"flex justify-between text-sm",children:[o.jsxs("span",{children:["Tax (",(r==null?void 0:r.settings.taxRate)||8.5,"%):"]}),o.jsx("span",{children:pt(mr)})]}),o.jsxs("div",{className:"flex justify-between text-lg font-bold border-t pt-2",children:[o.jsx("span",{children:"Total:"}),o.jsx("span",{children:pt(Wt)})]})]}),o.jsxs("form",{onSubmit:B(Ue),className:"space-y-3",children:[o.jsx("textarea",{...xe("orderNotes"),rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",placeholder:"Order notes (optional)"}),o.jsxs("div",{className:"flex space-x-2",children:[o.jsxs("button",{type:"button",onClick:Dt,className:"flex-1 btn btn-secondary",children:[o.jsx(ga,{className:"w-4 h-4 mr-2"}),"Clear"]}),o.jsx("button",{type:"submit",disabled:A,className:"flex-2 btn btn-theme-primary",children:A?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Placing..."]}):o.jsxs(o.Fragment,{children:[o.jsx(z1,{className:"w-4 h-4 mr-2"}),"Place Order"]})})]})]})]})]})})]}),o.jsxs("div",{className:"lg:hidden",children:[o.jsx("div",{className:"card p-4 mb-4",children:o.jsxs("div",{className:"flex flex-col gap-3",children:[o.jsxs("div",{className:"relative",children:[o.jsx(Eo,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),o.jsx("input",{type:"text",placeholder:"Search menu items...",value:N,onChange:Te=>j(Te.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(Wg,{className:"w-4 h-4 text-gray-600"}),o.jsxs("select",{value:b,onChange:Te=>w(Te.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[o.jsx("option",{value:"all",children:"All Categories"}),c.map(Te=>o.jsx("option",{value:Te.name,children:Te.name},Te.id))]})]})]})}),d.length>0&&o.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 p-4 z-40",children:o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsxs("div",{children:[o.jsxs("div",{className:"text-sm text-gray-600",children:[d.length," items"]}),o.jsx("div",{className:"font-bold text-lg",children:pt(Wt)})]}),o.jsx("button",{onClick:()=>G(!0),className:"btn btn-theme-primary",children:"View Cart"})]})}),o.jsx("div",{className:`${d.length>0?"pb-24":"pb-6"}`,children:F?o.jsxs("div",{className:"text-center py-12",children:[o.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mb-4"}),o.jsx("p",{className:"text-gray-600",children:"Loading menu..."})]}):o.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:nt.map(Te=>{const je=d.find(et=>et.menuItemId===Te.id);return o.jsx(TC,{item:Te,onAddToCart:ct,cartQuantity:(je==null?void 0:je.quantity)||0},Te.id)})})}),D&&o.jsxs("div",{className:"fixed inset-0 z-50 lg:hidden",children:[o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50",onClick:()=>G(!1)}),o.jsx("div",{className:"fixed right-0 top-0 h-full w-full max-w-sm bg-white shadow-xl",children:o.jsxs("div",{className:"flex flex-col h-full",children:[o.jsx("div",{className:"p-4 border-b border-gray-200",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Current Order"}),o.jsxs("p",{className:"text-sm text-gray-600",children:["Table ",s.number]})]}),o.jsx("button",{onClick:()=>G(!1),className:"p-2 hover:bg-gray-100 rounded-lg",children:o.jsx(Zn,{className:"w-5 h-5"})})]})}),o.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:d.length===0?o.jsxs("div",{className:"text-center py-8",children:[o.jsx(iC,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),o.jsx("p",{className:"text-gray-600",children:"No items added yet"}),o.jsx("p",{className:"text-sm text-gray-500",children:"Select items from the menu to start building the order"})]}):o.jsx("div",{className:"space-y-3",children:d.map(Te=>o.jsx(AC,{item:Te,onUpdateQuantity:ue,onRemove:Ne},Te.menuItemId))})}),d.length>0&&o.jsxs("div",{className:"border-t border-gray-200 p-4",children:[o.jsxs("div",{className:"space-y-2 mb-4",children:[o.jsxs("div",{className:"flex justify-between text-sm",children:[o.jsx("span",{children:"Subtotal:"}),o.jsx("span",{children:pt(At)})]}),o.jsxs("div",{className:"flex justify-between text-sm",children:[o.jsxs("span",{children:["Tax (",(r==null?void 0:r.settings.taxRate)||8.5,"%):"]}),o.jsx("span",{children:pt(mr)})]}),o.jsxs("div",{className:"flex justify-between text-lg font-bold border-t pt-2",children:[o.jsx("span",{children:"Total:"}),o.jsx("span",{children:pt(Wt)})]})]}),o.jsxs("form",{onSubmit:B(Ue),className:"space-y-3",children:[o.jsx("textarea",{...xe("orderNotes"),rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",placeholder:"Order notes (optional)"}),o.jsxs("div",{className:"flex space-x-2",children:[o.jsxs("button",{type:"button",onClick:Dt,className:"flex-1 btn btn-secondary",children:[o.jsx(ga,{className:"w-4 h-4 mr-2"}),"Clear"]}),o.jsx("button",{type:"submit",disabled:A,className:"flex-2 btn btn-theme-primary",children:A?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Placing..."]}):o.jsxs(o.Fragment,{children:[o.jsx(z1,{className:"w-4 h-4 mr-2"}),"Place Order"]})})]})]})]})]})})]})]})]}),p==="placed"&&h.length>0&&o.jsxs("div",{className:"max-w-4xl mx-auto",children:[o.jsxs("div",{className:"text-center mb-6",children:[o.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",children:o.jsx(lK,{className:"w-8 h-8 text-blue-600"})}),o.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Orders Placed!"}),o.jsxs("p",{className:"text-gray-600",children:[h.length," active order",h.length>1?"s":""," for Table ",s.number]})]}),o.jsx("div",{className:"grid gap-6",children:h.map(Te=>o.jsxs("div",{className:"card p-6",children:[o.jsxs("div",{className:"flex justify-between items-center mb-4",children:[o.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Order #",Te.orderNumber]}),o.jsx("span",{className:"text-gray-600 text-sm",children:new Date(Te.createdAt).toLocaleTimeString()})]}),o.jsx("div",{className:"space-y-3 mb-4",children:Te.items.map(je=>o.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded-lg",children:[o.jsxs("div",{children:[o.jsx("h4",{className:"font-medium text-gray-900",children:je.name}),o.jsxs("p",{className:"text-sm text-gray-600",children:[je.quantity,"  ",pt(je.price)]})]}),o.jsx("div",{className:"font-medium text-gray-900",children:pt(je.total)})]},je.id))}),o.jsx("div",{className:"border-t border-gray-200 pt-3",children:o.jsxs("div",{className:"flex justify-between text-lg font-bold",children:[o.jsx("span",{children:"Order Total:"}),o.jsx("span",{children:pt(Te.total)})]})})]},Te.id))})]}),p==="completed"&&o.jsx("div",{className:"max-w-2xl mx-auto text-center",children:o.jsxs("div",{className:"card p-8",children:[o.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:o.jsx(z1,{className:"w-8 h-8 text-green-600"})}),o.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Payment Completed!"}),o.jsxs("p",{className:"text-gray-600 mb-6",children:["All orders for Table ",s.number," have been paid and completed."]}),o.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[o.jsxs("button",{onClick:()=>{v("cart"),g([]),m(null),f([]),Gn.clearCart(r.id,t)},className:"btn btn-theme-primary",children:[o.jsx(Wn,{className:"w-4 h-4 mr-2"}),"Start New Order"]}),o.jsxs("button",{onClick:()=>e(`/${r.slug}/tables`),className:"btn btn-secondary",children:[o.jsx(gm,{className:"w-4 h-4 mr-2"}),"Back to Tables"]})]})]})})]})})}),I&&h.length>0&&o.jsx(WK,{isOpen:I,onClose:()=>E(!1),restaurant:r,table:s,onPayment:Ye,isProcessing:k,cartItems:h.flatMap(Te=>Te.items.map(je=>({menuItemId:je.id,name:je.name,price:je.price,quantity:je.quantity,total:je.total,variants:je.variants}))),menuItems:i}),de&&o.jsx(qK,{isOpen:Z,onClose:()=>{ae(!1),se(null)},menuItem:de,onConfirm:lt}),Y&&s&&r&&o.jsx(HK,{isOpen:Y,onClose:()=>ye(!1),currentTable:s,restaurantId:r.id,currentOrders:h,onOperationComplete:()=>{qe(),e(`/${r.slug}/tables`)}}),o.jsx(uD,{isVisible:re,stage:O,message:H}),o.jsx(dD,{isVisible:q,onClose:()=>te(!1),onPrintKOT:Ce,orderDetails:oe})]})}function TC({item:t,onAddToCart:e,cartQuantity:r}){return o.jsxs("div",{className:"card hover:shadow-lg transition-all duration-200 cursor-pointer",onClick:()=>e(t,1),children:[t.image&&o.jsx("div",{className:"h-32 bg-gray-200 rounded-t-xl overflow-hidden",children:o.jsx("img",{src:t.image,alt:t.name,className:"w-full h-full object-cover"})}),o.jsxs("div",{className:"p-3",children:[o.jsxs("div",{className:"flex items-start justify-between mb-2",children:[o.jsx("h3",{className:"font-semibold text-gray-900 text-sm",children:t.name}),o.jsxs("div",{className:"text-right",children:[o.jsx("div",{className:"text-sm font-bold",style:{color:"var(--color-primary)"},children:pt(t.price)}),r>0&&o.jsxs("div",{className:"text-xs text-green-600 font-medium",children:[r," in order"]})]})]}),t.description&&o.jsx("p",{className:"text-gray-600 text-xs mb-2 line-clamp-2",children:t.description}),o.jsx("div",{className:"flex items-center justify-center",children:o.jsxs("button",{onClick:n=>{n.stopPropagation(),e(t,1)},className:"btn btn-theme-primary btn-sm w-full",children:[o.jsx(Wn,{className:"w-3 h-3 mr-1"}),"Add to Order"]})})]})]})}function AC({item:t,onUpdateQuantity:e,onRemove:r}){return o.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[o.jsxs("div",{className:"flex-1",children:[o.jsx("h4",{className:"font-medium text-gray-900 text-sm",children:t.name}),o.jsxs("p",{className:"text-xs text-gray-600",children:[pt(t.price)," each"]}),t.variants&&t.variants.length>0&&o.jsx("div",{className:"text-xs text-gray-500 mt-1",children:t.variants.map((n,s)=>o.jsxs("span",{children:[n.variantName,": ",n.optionName,s<t.variants.length-1&&", "]},s))})]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsxs("div",{className:"flex items-center space-x-1",children:[o.jsx("button",{onClick:()=>e(t.menuItemId,t.quantity-1),className:"w-6 h-6 rounded-full border border-gray-300 flex items-center justify-center hover:bg-gray-100",children:o.jsx(nK,{className:"w-3 h-3"})}),o.jsx("span",{className:"w-6 text-center text-sm font-medium",children:t.quantity}),o.jsx("button",{onClick:()=>e(t.menuItemId,t.quantity+1),className:"w-6 h-6 rounded-full border border-gray-300 flex items-center justify-center hover:bg-gray-100",children:o.jsx(Wn,{className:"w-3 h-3"})})]}),o.jsx("div",{className:"text-right min-w-[60px]",children:o.jsx("div",{className:"font-medium text-gray-900 text-sm",children:pt(t.total)})}),o.jsx("button",{onClick:()=>r(t.menuItemId),className:"p-1 text-gray-400 hover:text-red-600",children:o.jsx(ga,{className:"w-3 h-3"})})]})]})}function _w(t,e,r){return`
    <!DOCTYPE html>
    <html>
    <head>
      <title>KOT - ${t.orderNumber}</title>
      <style>
        body { 
          font-family: 'Courier New', monospace; 
          margin: 0; 
          padding: 0 10px; 
          width: 100%;
          background: #fff;
        }
        .kot-container {
          width: 100%;
          padding: 15px 5px;
          min-height: 100vh;
        }
        .header { 
          text-align: center; 
          border-bottom: 2px solid #000; 
          padding-bottom: 10px; 
          margin-bottom: 15px; 
        }
        .restaurant-name { 
          font-size: 18px; 
          font-weight: bold; 
          margin-bottom: 5px;
        }
        .order-info { 
          margin-bottom: 15px; 
          line-height: 1.4;
        }
        .items { 
          border-collapse: collapse; 
          width: 100%; 
          margin: 15px 0;
        }
        .items th, .items td { 
          border: 1px solid #000; 
          padding: 8px; 
          text-align: left; 
          font-size: 13px;
        }
        .items th { 
          background-color: #f0f0f0; 
          font-weight: bold;
        }
        .footer { 
          margin-top: 20px; 
          text-align: center; 
          font-size: 12px; 
          border-top: 1px dashed #000;
          padding-top: 15px;
        }
        .order-notes {
          margin-top: 15px; 
          padding: 10px; 
          border: 1px solid #000;
          background: #f9f9f9;
        }
        @media print {
          body { 
            margin: 0; 
            padding: 0 8px;
            width: 100%;
          }
          .kot-container {
            padding: 10px 0;
            width: 100%;
            min-height: auto;
          }
          .no-print { display: none; }
          .header, .order-info, .items, .order-notes, .footer {
            page-break-inside: avoid;
          }
        }
      </style>
    </head>
    <body>
      <div class="kot-container">
      <div class="header">
        <div class="restaurant-name">${e.name}</div>
        <div>KITCHEN ORDER TICKET</div>
      </div>
      
      <div class="order-info">
        <p><strong>Order #:</strong> ${t.orderNumber}</p>
        <p><strong>Table:</strong> ${r.number} (${r.area})</p>
        <p><strong>Date/Time:</strong> ${t.createdAt.toLocaleString()}</p>
        <p><strong>Staff:</strong> ${t.staffId}</p>
      </div>
      
      <table class="items">
        <thead>
          <tr>
            <th>Qty</th>
            <th>Item</th>
            <th>Notes</th>
          </tr>
        </thead>
        <tbody>
          ${t.items.map(n=>`
            <tr>
              <td>${n.quantity}</td>
              <td>${n.name}</td>
              <td>${n.notes||""}</td>
            </tr>
          `).join("")}
        </tbody>
      </table>
      
      ${t.notes?`
          <div class="order-notes">
          <strong>Order Notes:</strong><br>
          ${t.notes}
        </div>
      `:""}
      
      <div class="footer">
        <p>*** KITCHEN COPY ***</p>
        <p>Printed at: ${new Date().toLocaleString()}</p>
        </div>
      </div>
    </body>
    </html>
  `}function KK(t,e,r,n){var b,w,N,j,F,U,A,S,k,M,I,E,D,G,Z,ae,de,se,Y,ye,re,C;const s=t.reduce((O,L)=>O+L.subtotal,0);let a=0,i=null;const l=t.find(O=>{var L;return(L=O.notes)==null?void 0:L.includes("Merged tables:")}),c=l!==void 0,u=c?l.notes:null;n.appliedCoupon?(a=n.appliedCoupon.discountAmount||0,i=n.appliedCoupon):n.discount&&(n.discount.type==="percentage"?a=s*n.discount.value/100:a=n.discount.value);const d=s-a,f=d*(((b=e==null?void 0:e.settings)==null?void 0:b.taxRate)||8.5)/100,m=d+f,h=n.tip||0,g=n.finalTotal||m+h,p={};t.forEach(O=>{O.items.forEach(L=>{const H=`${L.name}-${L.price}`;p[H]?(p[H].quantity+=L.quantity,p[H].total+=L.total):p[H]={name:L.name,price:L.price,quantity:L.quantity,total:L.total}})});const v=Object.values(p);return`
    <!DOCTYPE html>
    <html>
    <head>
      <title>Bill - Table ${r.number}</title>
      <meta charset="UTF-8">
      <style>
        * {
          margin: 0;
          padding: 0;
          box-sizing: border-box;
        }
        
        body {
          font-family: 'Courier New', monospace;
          font-size: 13px;
          line-height: 1.3;
          width: 100%;
          margin: 0;
          padding: 0 10px;
          background: #fff;
          color: #000;
        }
        
        .receipt {
          width: 100%;
          padding: 15px 5px;
          background: #fff;
          min-height: 100vh;
        }
        
        .header {
          text-align: center;
          margin-bottom: 20px;
          border-bottom: 2px solid #000;
          padding-bottom: 15px;
        }
        
        .restaurant-name {
          font-size: 20px;
          font-weight: bold;
          letter-spacing: 1px;
          margin-bottom: 8px;
          text-transform: uppercase;
        }
        
        .contact-info {
          font-size: 11px;
          line-height: 1.4;
          color: #333;
          margin-bottom: 5px;
        }
        
        .separator {
          text-align: center;
          margin: 10px 0;
          font-size: 14px;
          letter-spacing: 2px;
        }
        
        .bill-header {
          text-align: center;
          margin: 15px 0;
          padding: 10px 0;
          border-top: 1px dashed #000;
          border-bottom: 1px dashed #000;
        }
        
        .bill-title {
          font-size: 16px;
          font-weight: bold;
          margin-bottom: 8px;
          letter-spacing: 1px;
        }
        
        .bill-info {
          font-size: 12px;
          line-height: 1.5;
        }
        
        .order-details {
          margin: 15px 0;
          padding: 10px 0;
          border-bottom: 1px dashed #000;
        }
        
        .section-title {
          font-weight: bold;
          margin-bottom: 8px;
          text-transform: uppercase;
          letter-spacing: 0.5px;
        }
        
        .order-line {
          margin: 3px 0;
          font-size: 11px;
          color: #555;
        }
        
        .items-section {
          margin: 15px 0;
        }
        
        .items-header {
          display: flex;
          justify-content: space-between;
          border-bottom: 1px solid #000;
          padding-bottom: 5px;
          margin-bottom: 10px;
          font-weight: bold;
          font-size: 12px;
        }
        
        .item-row {
          display: flex;
          justify-content: space-between;
          margin: 8px 0;
          padding: 3px 0;
        }
        
        .item-details {
          flex: 1;
          padding-right: 10px;
        }
        
        .item-name {
          font-weight: bold;
          margin-bottom: 2px;
        }
        
        .item-qty-price {
          font-size: 11px;
          color: #666;
        }
        
        .item-total {
          font-weight: bold;
          min-width: 60px;
          text-align: right;
        }
        
        .totals-section {
          margin-top: 20px;
          border-top: 1px solid #000;
          padding-top: 15px;
        }
        
        .total-row {
          display: flex;
          justify-content: space-between;
          margin: 5px 0;
          padding: 2px 0;
        }
        
        .total-row.subtotal {
          border-bottom: 1px dotted #666;
          padding-bottom: 8px;
          margin-bottom: 8px;
        }
        
        .total-row.discount {
          color: #d32f2f;
          font-weight: bold;
        }
        
        .total-row.savings {
          color: #388e3c;
          font-weight: bold;
          background: #f8f8f8;
          padding: 5px;
          margin: 5px -5px;
          border-radius: 3px;
        }
        
        .total-row.final {
          border-top: 2px solid #000;
          border-bottom: 2px solid #000;
          padding: 8px 0;
          margin-top: 10px;
          font-size: 16px;
          font-weight: bold;
        }
        
        .coupon-section {
          background: #e8f5e8;
          margin: 10px -5px;
          padding: 8px;
          border-radius: 3px;
          border: 1px dashed #4caf50;
        }
        
        .coupon-title {
          color: #2e7d32;
          font-weight: bold;
          margin-bottom: 3px;
        }
        
        .coupon-code {
          font-size: 11px;
          color: #666;
          font-style: italic;
        }
        
        .free-items {
          color: #ff6f00;
          font-weight: bold;
          font-size: 11px;
        }
        
        .payment-section {
          margin: 20px 0;
          padding: 15px 0;
          border-top: 1px dashed #000;
          border-bottom: 1px dashed #000;
        }
        
        .payment-title {
          font-weight: bold;
          margin-bottom: 8px;
          text-transform: uppercase;
          letter-spacing: 0.5px;
        }
        
        .payment-details {
          font-size: 12px;
          line-height: 1.6;
        }
        
        .payment-method {
          background: #f5f5f5;
          padding: 5px;
          border-radius: 3px;
          display: inline-block;
          font-weight: bold;
        }
        
        .footer {
          text-align: center;
          margin-top: 20px;
          padding-top: 15px;
          border-top: 2px solid #000;
        }
        
        .thank-you {
          font-size: 14px;
          font-weight: bold;
          margin-bottom: 10px;
          letter-spacing: 1px;
        }
        
        .footer-info {
          font-size: 10px;
          color: #666;
          line-height: 1.4;
        }
        
        .timestamp {
          text-align: center;
          margin-top: 15px;
          font-size: 10px;
          color: #888;
          font-style: italic;
        }
        
        @media print {
          body {
            padding: 0 8px;
            font-size: 12px;
            width: 100%;
            margin: 0;
          }
          .receipt {
            padding: 10px 0;
            width: 100%;
            min-height: auto;
          }
          .header, .bill-header, .items-section, .totals-section, .payment-section, .footer {
            page-break-inside: avoid;
          }
        }
      </style>
    </head>
    <body>
      <div class="receipt">
        <!-- Header Section -->
      <div class="header">
        <div class="restaurant-name">${e.name}</div>
        <div class="contact-info">
            ${((N=(w=e.settings)==null?void 0:w.businessInfo)==null?void 0:N.businessAddress)||((j=e.settings)==null?void 0:j.address)||"Restaurant Address"}
          ${(U=(F=e.settings)==null?void 0:F.businessInfo)!=null&&U.city?`, ${e.settings.businessInfo.city}`:""}
          ${(S=(A=e.settings)==null?void 0:A.businessInfo)!=null&&S.state?`, ${e.settings.businessInfo.state}`:""}
          ${(M=(k=e.settings)==null?void 0:k.businessInfo)!=null&&M.pincode?` - ${e.settings.businessInfo.pincode}`:""}
          <br>
            ${(I=e.settings)!=null&&I.phone?` ${e.settings.phone}`:""}
          ${(D=(E=e.settings)==null?void 0:E.businessInfo)!=null&&D.gstin?`<br>GSTIN: ${e.settings.businessInfo.gstin}`:""}
          ${(Z=(G=e.settings)==null?void 0:G.businessInfo)!=null&&Z.fssaiNumber?`<br>FSSAI: ${e.settings.businessInfo.fssaiNumber}`:""}
        </div>
      </div>

        <!-- Bill Header -->
        <div class="bill-header">
          <div class="bill-title">BILL RECEIPT</div>
      <div class="bill-info">
            <strong>Table:</strong> ${c?u:`${r.number} (${r.area})`}<br>
            <strong>Date:</strong> ${new Date().toLocaleDateString("en-IN")}<br>
            <strong>Time:</strong> ${new Date().toLocaleTimeString("en-IN")}<br>
            ${t.length>1?`<strong>Combined Bill:</strong> ${t.length} Orders<br>`:""}
            ${c?"<strong>Billing Type:</strong> Merged Tables<br>":""}
            ${n.customerId?`<strong>Customer:</strong> ${n.customerId}<br>`:""}
          </div>
      </div>

        <!-- Order Details -->
        ${t.length>1?`
        <div class="order-details">
          <div class="section-title">Order Numbers</div>
          ${t.map(O=>`
            <div class="order-line"># ${O.orderNumber} - ${pt(O.total)}</div>
          `).join("")}
      </div>
        `:""}

        <!-- Items Section -->
        <div class="items-section">
          <div class="items-header">
            <span>ITEM</span>
            <span>TOTAL</span>
          </div>
          
        ${v.map(O=>`
            <div class="item-row">
              <div class="item-details">
                <div class="item-name">${O.name}</div>
                <div class="item-qty-price">${O.quantity}  ${pt(O.price)}</div>
              </div>
              <div class="item-total">${pt(O.total)}</div>
          </div>
        `).join("")}
      </div>

        <!-- Totals Section -->
        <div class="totals-section">
          <div class="total-row subtotal">
            <span>Subtotal</span>
          <span>${pt(s)}</span>
        </div>
          
          ${i?`
          <div class="coupon-section">
            <div class="coupon-title"> COUPON APPLIED</div>
            <div class="total-row discount">
              <span>${i.coupon.name}</span>
              <span>-${pt(a)}</span>
            </div>
            <div class="coupon-code">Code: ${i.coupon.code}</div>
            ${i.freeItems&&i.freeItems.length>0?`
            <div class="free-items">
               Free: ${i.freeItems.map(O=>`${O.quantity} ${O.name}`).join(", ")}
            </div>
            `:""}
          </div>
          ${n.totalSavings>0?`
          <div class="total-row savings">
            <span> Total Savings</span>
            <span>-${pt(n.totalSavings)}</span>
          </div>
          `:""}
          `:a>0?`
          <div class="total-row discount">
            <span>Discount ${((ae=n.discount)==null?void 0:ae.type)==="percentage"?`(${n.discount.value}%)`:""}</span>
          <span>-${pt(a)}</span>
        </div>
        ${(de=n.discount)!=null&&de.reason?`
          <div class="total-row">
            <span style="font-size: 11px; color: #666;">${n.discount.reason}</span>
          <span></span>
        </div>
        `:""}
        `:""}
          
          <div class="total-row">
            <span>Tax (${((se=e==null?void 0:e.settings)==null?void 0:se.taxRate)||8.5}%)</span>
          <span>${pt(f)}</span>
        </div>
          
        ${h>0?`
          <div class="total-row">
            <span>Tip</span>
          <span>${pt(h)}</span>
        </div>
        `:""}
          
          <div class="total-row final">
            <span>TOTAL AMOUNT</span>
          <span>${pt(g)}</span>
        </div>
      </div>

        <!-- Payment Section -->
        <div class="payment-section">
          <div class="payment-title">Payment Details</div>
          <div class="payment-details">
            <strong>Method:</strong> <span class="payment-method">${n.method.toUpperCase()}</span><br>
        ${n.method==="cash"?`
              <strong>Amount Received:</strong> ${pt(n.amountReceived||g)}<br>
              <strong>Change Given:</strong> ${pt(Math.max(0,(n.amountReceived||g)-g))}
        `:""}
            ${n.reference?`<strong>Reference:</strong> ${n.reference}`:""}
          </div>
      </div>

        <!-- Footer -->
      <div class="footer">
          <div class="thank-you"> THANK YOU! </div>
          <div class="footer-info">
            Please visit us again!<br>
            ${(ye=(Y=e.settings)==null?void 0:Y.businessInfo)!=null&&ye.website?` ${e.settings.businessInfo.website}<br>`:""}
            ${(C=(re=e.settings)==null?void 0:re.businessInfo)!=null&&C.email?` ${e.settings.businessInfo.email}`:""}
          </div>
          
          <div class="timestamp">
            Generated on ${new Date().toLocaleString("en-IN")}
          </div>
        </div>

        <div class="separator"></div>
      </div>
    </body>
    </html>
  `}function YK({categories:t,onCategoriesUpdated:e}){const{restaurant:r}=ya(),[n,s]=X.useState(!1),[a,i]=X.useState(null),[l,c]=X.useState(!1),{register:u,handleSubmit:d,reset:f,setValue:m}=Hn(),h=()=>{i(null),f({name:"",description:"",isActive:!0}),s(!0)},g=N=>{i(N),m("name",N.name),m("description",N.description||""),m("isActive",N.isActive),s(!0)},p=async N=>{if(r)try{if(c(!0),a){const j=await cs.updateCategory(a.id,r.id,{name:N.name,description:N.description,isActive:N.isActive});j.success?(fe.success("Category updated successfully"),e()):fe.error(j.error||"Failed to update category")}else{const j=await cs.createCategory({restaurantId:r.id,name:N.name,description:N.description,sortOrder:t.length,isActive:N.isActive});j.success?(fe.success("Category created successfully"),e()):fe.error(j.error||"Failed to create category")}s(!1),i(null)}catch{fe.error("Failed to save category")}finally{c(!1)}},v=async N=>{if(!(!r||!confirm(`Are you sure you want to delete "${N.name}"?`)))try{const j=await cs.deleteCategory(N.id,r.id);j.success?(fe.success("Category deleted successfully"),e()):fe.error(j.error||"Failed to delete category")}catch{fe.error("Failed to delete category")}},b=async N=>{if(r)try{const j=await cs.updateCategory(N.id,r.id,{isActive:!N.isActive});j.success?(fe.success(`Category ${N.isActive?"disabled":"enabled"}`),e()):fe.error(j.error||"Failed to update category")}catch{fe.error("Failed to update category")}},w=async(N,j)=>{if(!r)return;const F=t.findIndex(A=>A.id===N.id),U=j==="up"?F-1:F+1;if(!(U<0||U>=t.length))try{const A=[cs.updateCategory(N.id,r.id,{sortOrder:U}),cs.updateCategory(t[U].id,r.id,{sortOrder:F})];await Promise.all(A),fe.success("Category order updated"),e()}catch{fe.error("Failed to reorder categories")}};return o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Categories"}),o.jsx("p",{className:"text-sm text-gray-600",children:"Organize your menu into categories"})]}),o.jsxs("button",{onClick:h,className:"btn btn-theme-primary",children:[o.jsx(Wn,{className:"w-4 h-4 mr-2"}),"Add Category"]})]}),o.jsx("div",{className:"space-y-3",children:t.length===0?o.jsxs("div",{className:"text-center py-8 border-2 border-dashed border-gray-300 rounded-lg",children:[o.jsx(Bv,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),o.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No categories yet"}),o.jsx("p",{className:"text-gray-600 mb-4",children:"Create your first category to organize your menu"}),o.jsxs("button",{onClick:h,className:"btn btn-theme-primary",children:[o.jsx(Wn,{className:"w-4 h-4 mr-2"}),"Create First Category"]})]}):t.map((N,j)=>o.jsx("div",{className:`card p-4 ${N.isActive?"":"opacity-60"}`,children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsxs("div",{className:"flex flex-col space-y-1",children:[o.jsx("button",{onClick:()=>w(N,"up"),disabled:j===0,className:"p-1 text-gray-400 hover:text-gray-600 disabled:opacity-30",children:o.jsx(zG,{className:"w-3 h-3"})}),o.jsx("button",{onClick:()=>w(N,"down"),disabled:j===t.length-1,className:"p-1 text-gray-400 hover:text-gray-600 disabled:opacity-30",children:o.jsx($G,{className:"w-3 h-3"})})]}),o.jsxs("div",{className:"flex-1",children:[o.jsx("h4",{className:"font-medium text-gray-900",children:N.name}),N.description&&o.jsx("p",{className:"text-sm text-gray-600",children:N.description}),o.jsxs("div",{className:"flex items-center space-x-3 mt-1",children:[o.jsxs("span",{className:"text-xs text-gray-500",children:["Order: ",N.sortOrder]}),o.jsx("span",{className:`text-xs ${N.isActive?"text-green-600":"text-red-600"}`,children:N.isActive?"Active":"Inactive"})]})]})]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("button",{onClick:()=>b(N),className:`p-2 rounded-lg ${N.isActive?"bg-green-100 text-green-600 hover:bg-green-200":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:N.isActive?o.jsx(Ci,{className:"w-4 h-4"}):o.jsx(zc,{className:"w-4 h-4"})}),o.jsx("button",{onClick:()=>g(N),className:"p-2 bg-blue-100 text-blue-600 hover:bg-blue-200 rounded-lg",children:o.jsx(Cd,{className:"w-4 h-4"})}),o.jsx("button",{onClick:()=>v(N),className:"p-2 bg-red-100 text-red-600 hover:bg-red-200 rounded-lg",children:o.jsx(ga,{className:"w-4 h-4"})})]})]})},N.id))}),n&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:o.jsxs("div",{className:"bg-white rounded-2xl max-w-md w-full",children:[o.jsx("div",{className:"p-6 border-b border-gray-200",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:a?"Edit Category":"Add Category"}),o.jsx("button",{onClick:()=>s(!1),className:"p-1 text-gray-400 hover:text-gray-600",children:o.jsx(Zn,{className:"w-5 h-5"})})]})}),o.jsxs("form",{onSubmit:d(p),className:"p-6 space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category Name *"}),o.jsx("input",{...u("name",{required:"Category name is required"}),type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter category name"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),o.jsx("textarea",{...u("description"),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Describe this category (optional)"})]}),o.jsxs("div",{className:"flex items-center",children:[o.jsx("input",{...u("isActive"),type:"checkbox",className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),o.jsx("label",{className:"ml-2 text-sm text-gray-700",children:"Active (visible in menu)"})]}),o.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[o.jsx("button",{type:"button",onClick:()=>s(!1),className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Cancel"}),o.jsx("button",{type:"submit",disabled:l,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-colors",children:l?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2 inline-block"}),"Saving..."]}):o.jsxs(o.Fragment,{children:[o.jsx(kd,{className:"w-4 h-4 mr-2 inline"}),a?"Update Category":"Create Category"]})})]})]})]})})]})}function XK({variants:t,onChange:e}){const[r,n]=X.useState(null),[s,a]=X.useState(null),i=()=>{const h={id:Hr(),name:"",type:"single",required:!1,options:[]};e([...t,h]),n(h.id)},l=(h,g)=>{const p=t.map(v=>v.id===h?{...v,...g}:v);e(p)},c=h=>{e(t.filter(g=>g.id!==h))},u=h=>{var p;const g={id:Hr(),name:"",priceModifier:0,isDefault:!1};l(h,{options:[...((p=t.find(v=>v.id===h))==null?void 0:p.options)||[],g]}),a(g.id)},d=(h,g,p)=>{const v=t.find(w=>w.id===h);if(!v)return;const b=v.options.map(w=>w.id===g?{...w,...p}:w);l(h,{options:b})},f=(h,g)=>{const p=t.find(v=>v.id===h);p&&l(h,{options:p.options.filter(v=>v.id!==g)})},m=(h,g)=>{const p=t.find(b=>b.id===h);if(!p||p.type!=="single")return;const v=p.options.map(b=>({...b,isDefault:b.id===g}));l(h,{options:v})};return o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Menu Item Variants"}),o.jsxs("button",{type:"button",onClick:i,className:"flex items-center px-3 py-2 text-sm bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[o.jsx(Wn,{className:"w-4 h-4 mr-2"}),"Add Variant"]})]}),t.length===0?o.jsx("div",{className:"text-center py-8 text-gray-500",children:o.jsx("p",{children:"No variants configured. Add variants like size, spice level, or toppings to give customers more options."})}):o.jsx("div",{className:"space-y-4",children:t.map(h=>o.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[o.jsxs("div",{className:"flex items-start justify-between mb-4",children:[o.jsx("div",{className:"flex-1 grid grid-cols-1 md:grid-cols-3 gap-4",children:r===h.id?o.jsxs(o.Fragment,{children:[o.jsx("input",{type:"text",value:h.name,onChange:g=>l(h.id,{name:g.target.value}),placeholder:"Variant name (e.g., Size, Spice Level)",className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",autoFocus:!0}),o.jsxs("select",{value:h.type,onChange:g=>l(h.id,{type:g.target.value}),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[o.jsx("option",{value:"single",children:"Single Choice"}),o.jsx("option",{value:"multiple",children:"Multiple Choice"})]}),o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsxs("label",{className:"flex items-center space-x-2",children:[o.jsx("input",{type:"checkbox",checked:h.required,onChange:g=>l(h.id,{required:g.target.checked}),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),o.jsx("span",{className:"text-sm text-gray-700",children:"Required"})]}),h.type==="multiple"&&o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Max selections"}),o.jsx("input",{type:"number",min:"1",value:h.maxSelections||"",onChange:g=>l(h.id,{maxSelections:parseInt(g.target.value)||void 0}),className:"w-20 px-2 py-1 border border-gray-300 rounded text-sm",placeholder:""})]})]})]}):o.jsx(o.Fragment,{children:o.jsxs("div",{children:[o.jsx("h4",{className:"font-medium text-gray-900",children:h.name||"Unnamed Variant"}),o.jsxs("p",{className:"text-sm text-gray-600",children:[h.type==="single"?"Single Choice":"Multiple Choice",h.required?"  Required":"  Optional",h.type==="multiple"&&h.maxSelections&&`  Max ${h.maxSelections}`]})]})})}),o.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[r===h.id?o.jsx("button",{type:"button",onClick:()=>n(null),className:"p-1 text-green-600 hover:text-green-700",children:o.jsx(kd,{className:"w-4 h-4"})}):o.jsx("button",{type:"button",onClick:()=>n(h.id),className:"p-1 text-gray-400 hover:text-gray-600",children:o.jsx(Cd,{className:"w-4 h-4"})}),o.jsx("button",{type:"button",onClick:()=>c(h.id),className:"p-1 text-red-400 hover:text-red-600",children:o.jsx(ga,{className:"w-4 h-4"})})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("h5",{className:"text-sm font-medium text-gray-700",children:"Options"}),o.jsxs("button",{type:"button",onClick:()=>u(h.id),className:"flex items-center px-2 py-1 text-xs bg-gray-100 text-gray-700 rounded hover:bg-gray-200 transition-colors",children:[o.jsx(Wn,{className:"w-3 h-3 mr-1"}),"Add Option"]})]}),h.options.length===0?o.jsx("p",{className:"text-sm text-gray-500 italic",children:"No options configured"}):o.jsx("div",{className:"space-y-2",children:h.options.map(g=>o.jsx("div",{className:"flex items-center space-x-3 p-2 bg-gray-50 rounded-lg",children:s===g.id?o.jsxs(o.Fragment,{children:[o.jsx("input",{type:"text",value:g.name,onChange:p=>d(h.id,g.id,{name:p.target.value}),placeholder:"Option name",className:"flex-1 px-2 py-1 border border-gray-300 rounded text-sm",autoFocus:!0}),o.jsxs("div",{className:"flex items-center space-x-1",children:[o.jsx("span",{className:"text-xs text-gray-600",children:""}),o.jsx("input",{type:"number",step:"0.01",value:g.priceModifier,onChange:p=>d(h.id,g.id,{priceModifier:parseFloat(p.target.value)||0}),className:"w-20 px-2 py-1 border border-gray-300 rounded text-sm",placeholder:"0.00"})]}),o.jsxs("select",{value:g.pricingType||"additive",onChange:p=>d(h.id,g.id,{pricingType:p.target.value}),className:"px-2 py-1 border border-gray-300 rounded text-xs",children:[o.jsx("option",{value:"additive",children:"Add to base"}),o.jsx("option",{value:"standalone",children:"Replace base"})]}),h.type==="single"&&o.jsxs("label",{className:"flex items-center space-x-1",children:[o.jsx("input",{type:"radio",name:`default-${h.id}`,checked:g.isDefault,onChange:()=>m(h.id,g.id),className:"text-blue-600 focus:ring-blue-500"}),o.jsx("span",{className:"text-xs text-gray-600",children:"Default"})]}),o.jsx("button",{type:"button",onClick:()=>a(null),className:"p-1 text-green-600 hover:text-green-700",children:o.jsx(kd,{className:"w-3 h-3"})})]}):o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"flex-1 text-sm text-gray-900",children:g.name||"Unnamed Option"}),o.jsxs("div",{className:"flex flex-col items-end",children:[o.jsxs("span",{className:"text-sm text-gray-600",children:[g.pricingType==="standalone"?"":g.priceModifier>0&&"+","",g.priceModifier.toFixed(2)]}),o.jsx("span",{className:"text-xs text-gray-500",children:g.pricingType==="standalone"?"Standalone":"Additive"})]}),g.isDefault&&h.type==="single"&&o.jsx("span",{className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded",children:"Default"}),o.jsx("button",{type:"button",onClick:()=>a(g.id),className:"p-1 text-gray-400 hover:text-gray-600",children:o.jsx(Cd,{className:"w-3 h-3"})}),o.jsx("button",{type:"button",onClick:()=>f(h.id,g.id),className:"p-1 text-red-400 hover:text-red-600",children:o.jsx(ga,{className:"w-3 h-3"})})]})},g.id))})]})]},h.id))})]})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Wv={};Wv.version="0.18.5";var hD=1252,QK=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],kS={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},IS=function(t){QK.indexOf(t)!=-1&&(hD=kS[0]=t)};function JK(){IS(1252)}var Zo=function(t){IS(t)};function jS(){Zo(1200),JK()}function EC(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function ZK(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function mD(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var Ip=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?ZK(t.slice(2)):e==254&&r==255?mD(t.slice(2)):e==65279?t.slice(1):t},q1=function(e){return String.fromCharCode(e)},CC=function(e){return String.fromCharCode(e)},B_,Zu="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Kg(t){for(var e="",r=0,n=0,s=0,a=0,i=0,l=0,c=0,u=0;u<t.length;)r=t.charCodeAt(u++),a=r>>2,n=t.charCodeAt(u++),i=(r&3)<<4|n>>4,s=t.charCodeAt(u++),l=(n&15)<<2|s>>6,c=s&63,isNaN(n)?l=c=64:isNaN(s)&&(c=64),e+=Zu.charAt(a)+Zu.charAt(i)+Zu.charAt(l)+Zu.charAt(c);return e}function ro(t){var e="",r=0,n=0,s=0,a=0,i=0,l=0,c=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<t.length;)a=Zu.indexOf(t.charAt(u++)),i=Zu.indexOf(t.charAt(u++)),r=a<<2|i>>4,e+=String.fromCharCode(r),l=Zu.indexOf(t.charAt(u++)),n=(i&15)<<4|l>>2,l!==64&&(e+=String.fromCharCode(n)),c=Zu.indexOf(t.charAt(u++)),s=(l&3)<<6|c,c!==64&&(e+=String.fromCharCode(s));return e}var Dr=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Qc=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function jd(t){return Dr?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function kC(t){return Dr?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var qi=function(e){return Dr?Qc(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function tb(t){if(typeof ArrayBuffer>"u")return qi(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),n=0;n!=t.length;++n)r[n]=t.charCodeAt(n)&255;return e}function Yd(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function eY(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}function PS(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return PS(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var na=Dr?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:Qc(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),s=0;for(e=0,r=0;e<t.length;r+=s,++e)if(s=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function tY(t){for(var e=[],r=0,n=t.length+250,s=jd(t.length+255),a=0;a<t.length;++a){var i=t.charCodeAt(a);if(i<128)s[r++]=i;else if(i<2048)s[r++]=192|i>>6&31,s[r++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var l=t.charCodeAt(++a)&1023;s[r++]=240|i>>8&7,s[r++]=128|i>>2&63,s[r++]=128|l>>6&15|(i&3)<<4,s[r++]=128|l&63}else s[r++]=224|i>>12&15,s[r++]=128|i>>6&63,s[r++]=128|i&63;r>n&&(e.push(s.slice(0,r)),r=0,s=jd(65535),n=65530)}return e.push(s.slice(0,r)),na(e)}var si=/\u0000/g,jp=/[\u0001-\u0006]/g;function B0(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function el(t,e){var r=""+t;return r.length>=e?r:os("0",e-r.length)+r}function RS(t,e){var r=""+t;return r.length>=e?r:os(" ",e-r.length)+r}function Hv(t,e){var r=""+t;return r.length>=e?r:r+os(" ",e-r.length)}function rY(t,e){var r=""+Math.round(t);return r.length>=e?r:os("0",e-r.length)+r}function nY(t,e){var r=""+t;return r.length>=e?r:os("0",e-r.length)+r}var IC=Math.pow(2,32);function Zh(t,e){if(t>IC||t<-IC)return rY(t,e);var r=Math.round(t);return nY(r,e)}function Gv(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var jC=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Nw=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function sY(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var gr={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},PC={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},aY={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Kv(t,e,r){for(var n=t<0?-1:1,s=t*n,a=0,i=1,l=0,c=1,u=0,d=0,f=Math.floor(s);u<e&&(f=Math.floor(s),l=f*i+a,d=f*u+c,!(s-f<5e-8));)s=1/(s-f),a=i,i=l,c=u,u=d;if(d>e&&(u>e?(d=c,l=a):(d=u,l=i)),!r)return[0,n*l,d];var m=Math.floor(n*l/d);return[m,n*l-m*d,d]}function Pf(t,e,r){if(t>2958465||t<0)return null;var n=t|0,s=Math.floor(86400*(t-n)),a=0,i=[],l={D:n,T:s,u:86400*(t-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),e&&e.date1904&&(n+=1462),l.u>.9999&&(l.u=0,++s==86400&&(l.T=s=0,++n,++l.D)),n===60)i=r?[1317,10,29]:[1900,2,29],a=3;else if(n===0)i=r?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),i=[c.getFullYear(),c.getMonth()+1,c.getDate()],a=c.getDay(),n<60&&(a=(a+6)%7),r&&(a=dY(c,i))}return l.y=i[0],l.m=i[1],l.d=i[2],l.S=s%60,s=Math.floor(s/60),l.M=s%60,s=Math.floor(s/60),l.H=s,l.q=a,l}var pD=new Date(1899,11,31,0,0,0),iY=pD.getTime(),oY=new Date(1900,2,1,0,0,0);function gD(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=oY&&(r+=24*60*60*1e3),(r-(iY+(t.getTimezoneOffset()-pD.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function DS(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function lY(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function cY(t){var e=t<0?12:11,r=DS(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function uY(t){var e=DS(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function Yg(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=cY(t):e===10?r=t.toFixed(10).substr(0,12):r=uY(t),DS(lY(r.toUpperCase()))}function ih(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):Yg(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return jo(14,gD(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function dY(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function fY(t,e,r,n){var s="",a=0,i=0,l=r.y,c,u=0;switch(t){case 98:l=r.y+543;case 121:switch(e.length){case 1:case 2:c=l%100,u=2;break;default:c=l%1e4,u=4;break}break;case 109:switch(e.length){case 1:case 2:c=r.m,u=e.length;break;case 3:return Nw[r.m-1][1];case 5:return Nw[r.m-1][0];default:return Nw[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:c=r.d,u=e.length;break;case 3:return jC[r.q][0];default:return jC[r.q][1]}break;case 104:switch(e.length){case 1:case 2:c=1+(r.H+11)%12,u=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:c=r.H,u=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:c=r.M,u=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?el(r.S,e.length):(n>=2?i=n===3?1e3:100:i=n===1?10:1,a=Math.round(i*(r.S+r.u)),a>=60*i&&(a=0),e==="s"?a===0?"0":""+a/i:(s=el(a,2+n),e==="ss"?s.substr(0,2):"."+s.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}u=e.length===3?1:2;break;case 101:c=l,u=1;break}var d=u>0?el(c,u):"";return d}function ed(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var xD=/%/g;function hY(t,e,r){var n=e.replace(xD,""),s=e.length-n.length;return Ic(t,n,r*Math.pow(10,2*s))+os("%",s)}function mY(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Ic(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function yD(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+yD(t,-e);var s=t.indexOf(".");s===-1&&(s=t.indexOf("E"));var a=Math.floor(Math.log(e)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(e/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),r.indexOf("e")===-1){var i=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,u,d){return c+u+d.substr(0,(s+a)%s)+"."+d.substr(a)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var vD=/# (\?+)( ?)\/( ?)(\d+)/;function pY(t,e,r){var n=parseInt(t[4],10),s=Math.round(e*n),a=Math.floor(s/n),i=s-a*n,l=n;return r+(a===0?"":""+a)+" "+(i===0?os(" ",t[1].length+1+t[4].length):RS(i,t[1].length)+t[2]+"/"+t[3]+el(l,t[4].length))}function gY(t,e,r){return r+(e===0?"":""+e)+os(" ",t[1].length+2+t[4].length)}var bD=/^#*0*\.([0#]+)/,wD=/\).*[0#]/,_D=/\(###\) ###\\?-####/;function Xa(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function RC(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function DC(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function xY(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function yY(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function go(t,e,r){if(t.charCodeAt(0)===40&&!e.match(wD)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?go("n",n,r):"("+go("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return mY(t,e,r);if(e.indexOf("%")!==-1)return hY(t,e,r);if(e.indexOf("E")!==-1)return yD(e,r);if(e.charCodeAt(0)===36)return"$"+go(t,e.substr(e.charAt(1)==" "?2:1),r);var s,a,i,l,c=Math.abs(r),u=r<0?"-":"";if(e.match(/^00+$/))return u+Zh(c,e.length);if(e.match(/^[#?]+$/))return s=Zh(r,0),s==="0"&&(s=""),s.length>e.length?s:Xa(e.substr(0,e.length-s.length))+s;if(a=e.match(vD))return pY(a,c,u);if(e.match(/^#+0+$/))return u+Zh(c,e.length-e.indexOf("0"));if(a=e.match(bD))return s=RC(r,a[1].length).replace(/^([^\.]+)$/,"$1."+Xa(a[1])).replace(/\.$/,"."+Xa(a[1])).replace(/\.(\d*)$/,function(g,p){return"."+p+os("0",Xa(a[1]).length-p.length)}),e.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),a=e.match(/^(0*)\.(#*)$/))return u+RC(c,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=e.match(/^#{1,3},##0(\.?)$/))return u+ed(Zh(c,0));if(a=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+go(t,e,-r):ed(""+(Math.floor(r)+xY(r,a[1].length)))+"."+el(DC(r,a[1].length),a[1].length);if(a=e.match(/^#,#*,#0/))return go(t,e.replace(/^#,#*,/,""),r);if(a=e.match(/^([0#]+)(\\?-([0#]+))+$/))return s=B0(go(t,e.replace(/[\\-]/g,""),r)),i=0,B0(B0(e.replace(/\\/g,"")).replace(/[0#]/g,function(g){return i<s.length?s.charAt(i++):g==="0"?"0":""}));if(e.match(_D))return s=go(t,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var d="";if(a=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),l=Kv(c,Math.pow(10,i)-1,!1),s=""+u,d=Ic("n",a[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),s+=d+a[2]+"/"+a[3],d=Hv(l[2],i),d.length<a[4].length&&(d=Xa(a[4].substr(a[4].length-d.length))+d),s+=d,s;if(a=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),l=Kv(c,Math.pow(10,i)-1,!0),u+(l[0]||(l[1]?"":"0"))+" "+(l[1]?RS(l[1],i)+a[2]+"/"+a[3]+Hv(l[2],i):os(" ",2*i+1+a[2].length+a[3].length));if(a=e.match(/^[#0?]+$/))return s=Zh(r,0),e.length<=s.length?s:Xa(e.substr(0,e.length-s.length))+s;if(a=e.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var f=e.indexOf(".")-i,m=e.length-s.length-f;return Xa(e.substr(0,f)+s+e.substr(e.length-m))}if(a=e.match(/^00,000\.([#0]*0)$/))return i=DC(r,a[1].length),r<0?"-"+go(t,e,-r):ed(yY(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?el(0,3-g.length):"")+g})+"."+el(i,a[1].length);switch(e){case"###,##0.00":return go(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var h=ed(Zh(c,0));return h!=="0"?u+h:"";case"###,###.00":return go(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return go(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function vY(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Ic(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function bY(t,e,r){var n=e.replace(xD,""),s=e.length-n.length;return Ic(t,n,r*Math.pow(10,2*s))+os("%",s)}function ND(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+ND(t,-e);var s=t.indexOf(".");s===-1&&(s=t.indexOf("E"));var a=Math.floor(Math.log(e)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(e/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),!r.match(/[Ee]/)){var i=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,u,d){return c+u+d.substr(0,(s+a)%s)+"."+d.substr(a)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Nl(t,e,r){if(t.charCodeAt(0)===40&&!e.match(wD)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Nl("n",n,r):"("+Nl("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return vY(t,e,r);if(e.indexOf("%")!==-1)return bY(t,e,r);if(e.indexOf("E")!==-1)return ND(e,r);if(e.charCodeAt(0)===36)return"$"+Nl(t,e.substr(e.charAt(1)==" "?2:1),r);var s,a,i,l,c=Math.abs(r),u=r<0?"-":"";if(e.match(/^00+$/))return u+el(c,e.length);if(e.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>e.length?s:Xa(e.substr(0,e.length-s.length))+s;if(a=e.match(vD))return gY(a,c,u);if(e.match(/^#+0+$/))return u+el(c,e.length-e.indexOf("0"));if(a=e.match(bD))return s=(""+r).replace(/^([^\.]+)$/,"$1."+Xa(a[1])).replace(/\.$/,"."+Xa(a[1])),s=s.replace(/\.(\d*)$/,function(g,p){return"."+p+os("0",Xa(a[1]).length-p.length)}),e.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),a=e.match(/^(0*)\.(#*)$/))return u+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=e.match(/^#{1,3},##0(\.?)$/))return u+ed(""+c);if(a=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Nl(t,e,-r):ed(""+r)+"."+os("0",a[1].length);if(a=e.match(/^#,#*,#0/))return Nl(t,e.replace(/^#,#*,/,""),r);if(a=e.match(/^([0#]+)(\\?-([0#]+))+$/))return s=B0(Nl(t,e.replace(/[\\-]/g,""),r)),i=0,B0(B0(e.replace(/\\/g,"")).replace(/[0#]/g,function(g){return i<s.length?s.charAt(i++):g==="0"?"0":""}));if(e.match(_D))return s=Nl(t,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var d="";if(a=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),l=Kv(c,Math.pow(10,i)-1,!1),s=""+u,d=Ic("n",a[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),s+=d+a[2]+"/"+a[3],d=Hv(l[2],i),d.length<a[4].length&&(d=Xa(a[4].substr(a[4].length-d.length))+d),s+=d,s;if(a=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),l=Kv(c,Math.pow(10,i)-1,!0),u+(l[0]||(l[1]?"":"0"))+" "+(l[1]?RS(l[1],i)+a[2]+"/"+a[3]+Hv(l[2],i):os(" ",2*i+1+a[2].length+a[3].length));if(a=e.match(/^[#0?]+$/))return s=""+r,e.length<=s.length?s:Xa(e.substr(0,e.length-s.length))+s;if(a=e.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var f=e.indexOf(".")-i,m=e.length-s.length-f;return Xa(e.substr(0,f)+s+e.substr(e.length-m))}if(a=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Nl(t,e,-r):ed(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?el(0,3-g.length):"")+g})+"."+el(0,a[1].length);switch(e){case"###,###":case"##,###":case"#,###":var h=ed(""+c);return h!=="0"?u+h:"";default:if(e.match(/\.[0#?]*$/))return Nl(t,e.slice(0,e.lastIndexOf(".")),r)+Xa(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Ic(t,e,r){return(r|0)===r?Nl(t,e,r):go(t,e,r)}function wY(t){for(var e=[],r=!1,n=0,s=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(s,n-s),s=n+1}if(e[e.length]=t.substr(s),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var SD=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Rm(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":Gv(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(SD))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function _Y(t,e,r,n){for(var s=[],a="",i=0,l="",c="t",u,d,f,m="H";i<t.length;)switch(l=t.charAt(i)){case"G":if(!Gv(t,i))throw new Error("unrecognized character "+l+" in "+t);s[s.length]={t:"G",v:"General"},i+=7;break;case'"':for(a="";(f=t.charCodeAt(++i))!==34&&i<t.length;)a+=String.fromCharCode(f);s[s.length]={t:"t",v:a},++i;break;case"\\":var h=t.charAt(++i),g=h==="("||h===")"?h:"t";s[s.length]={t:g,v:h},++i;break;case"_":s[s.length]={t:"t",v:" "},i+=2;break;case"@":s[s.length]={t:"T",v:e},++i;break;case"B":case"b":if(t.charAt(i+1)==="1"||t.charAt(i+1)==="2"){if(u==null&&(u=Pf(e,r,t.charAt(i+1)==="2"),u==null))return"";s[s.length]={t:"X",v:t.substr(i,2)},c=l,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||u==null&&(u=Pf(e,r),u==null))return"";for(a=l;++i<t.length&&t.charAt(i).toLowerCase()===l;)a+=l;l==="m"&&c.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=m),s[s.length]={t:l,v:a},c=l;break;case"A":case"a":case"":var p={t:l,v:l};if(u==null&&(u=Pf(e,r)),t.substr(i,3).toUpperCase()==="A/P"?(u!=null&&(p.v=u.H>=12?"P":"A"),p.t="T",m="h",i+=3):t.substr(i,5).toUpperCase()==="AM/PM"?(u!=null&&(p.v=u.H>=12?"PM":"AM"),p.t="T",i+=5,m="h"):t.substr(i,5).toUpperCase()==="/"?(u!=null&&(p.v=u.H>=12?"":""),p.t="T",i+=5,m="h"):(p.t="t",++i),u==null&&p.t==="T")return"";s[s.length]=p,c=l;break;case"[":for(a=l;t.charAt(i++)!=="]"&&i<t.length;)a+=t.charAt(i);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(SD)){if(u==null&&(u=Pf(e,r),u==null))return"";s[s.length]={t:"Z",v:a.toLowerCase()},c=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",Rm(t)||(s[s.length]={t:"t",v:a}));break;case".":if(u!=null){for(a=l;++i<t.length&&(l=t.charAt(i))==="0";)a+=l;s[s.length]={t:"s",v:a};break}case"0":case"#":for(a=l;++i<t.length&&"0#?.,E+-%".indexOf(l=t.charAt(i))>-1;)a+=l;s[s.length]={t:"n",v:a};break;case"?":for(a=l;t.charAt(++i)===l;)a+=l;s[s.length]={t:l,v:a},c=l;break;case"*":++i,(t.charAt(i)==" "||t.charAt(i)=="*")&&++i;break;case"(":case")":s[s.length]={t:n===1?"t":l,v:l},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=l;i<t.length&&"0123456789".indexOf(t.charAt(++i))>-1;)a+=t.charAt(i);s[s.length]={t:"D",v:a};break;case" ":s[s.length]={t:l,v:l},++i;break;case"$":s[s.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+t);s[s.length]={t:"t",v:l},++i;break}var v=0,b=0,w;for(i=s.length-1,c="t";i>=0;--i)switch(s[i].t){case"h":case"H":s[i].t=m,c="h",v<1&&(v=1);break;case"s":(w=s[i].v.match(/\.0+$/))&&(b=Math.max(b,w[0].length-1)),v<3&&(v=3);case"d":case"y":case"M":case"e":c=s[i].t;break;case"m":c==="s"&&(s[i].t="M",v<2&&(v=2));break;case"X":break;case"Z":v<1&&s[i].v.match(/[Hh]/)&&(v=1),v<2&&s[i].v.match(/[Mm]/)&&(v=2),v<3&&s[i].v.match(/[Ss]/)&&(v=3)}switch(v){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var N="",j;for(i=0;i<s.length;++i)switch(s[i].t){case"t":case"T":case" ":case"D":break;case"X":s[i].v="",s[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[i].v=fY(s[i].t.charCodeAt(0),s[i].v,u,b),s[i].t="t";break;case"n":case"?":for(j=i+1;s[j]!=null&&((l=s[j].t)==="?"||l==="D"||(l===" "||l==="t")&&s[j+1]!=null&&(s[j+1].t==="?"||s[j+1].t==="t"&&s[j+1].v==="/")||s[i].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(s[j].v==="/"||s[j].v===" "&&s[j+1]!=null&&s[j+1].t=="?"));)s[i].v+=s[j].v,s[j]={v:"",t:";"},++j;N+=s[i].v,i=j-1;break;case"G":s[i].t="t",s[i].v=ih(e,r);break}var F="",U,A;if(N.length>0){N.charCodeAt(0)==40?(U=e<0&&N.charCodeAt(0)===45?-e:e,A=Ic("n",N,U)):(U=e<0&&n>1?-e:e,A=Ic("n",N,U),U<0&&s[0]&&s[0].t=="t"&&(A=A.substr(1),s[0].v="-"+s[0].v)),j=A.length-1;var S=s.length;for(i=0;i<s.length;++i)if(s[i]!=null&&s[i].t!="t"&&s[i].v.indexOf(".")>-1){S=i;break}var k=s.length;if(S===s.length&&A.indexOf("E")===-1){for(i=s.length-1;i>=0;--i)s[i]==null||"n?".indexOf(s[i].t)===-1||(j>=s[i].v.length-1?(j-=s[i].v.length,s[i].v=A.substr(j+1,s[i].v.length)):j<0?s[i].v="":(s[i].v=A.substr(0,j+1),j=-1),s[i].t="t",k=i);j>=0&&k<s.length&&(s[k].v=A.substr(0,j+1)+s[k].v)}else if(S!==s.length&&A.indexOf("E")===-1){for(j=A.indexOf(".")-1,i=S;i>=0;--i)if(!(s[i]==null||"n?".indexOf(s[i].t)===-1)){for(d=s[i].v.indexOf(".")>-1&&i===S?s[i].v.indexOf(".")-1:s[i].v.length-1,F=s[i].v.substr(d+1);d>=0;--d)j>=0&&(s[i].v.charAt(d)==="0"||s[i].v.charAt(d)==="#")&&(F=A.charAt(j--)+F);s[i].v=F,s[i].t="t",k=i}for(j>=0&&k<s.length&&(s[k].v=A.substr(0,j+1)+s[k].v),j=A.indexOf(".")+1,i=S;i<s.length;++i)if(!(s[i]==null||"n?(".indexOf(s[i].t)===-1&&i!==S)){for(d=s[i].v.indexOf(".")>-1&&i===S?s[i].v.indexOf(".")+1:0,F=s[i].v.substr(0,d);d<s[i].v.length;++d)j<A.length&&(F+=A.charAt(j++));s[i].v=F,s[i].t="t",k=i}}}for(i=0;i<s.length;++i)s[i]!=null&&"n?".indexOf(s[i].t)>-1&&(U=n>1&&e<0&&i>0&&s[i-1].v==="-"?-e:e,s[i].v=Ic(s[i].t,s[i].v,U),s[i].t="t");var M="";for(i=0;i!==s.length;++i)s[i]!=null&&(M+=s[i].v);return M}var FC=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function LC(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function NY(t,e){var r=wY(t),n=r.length,s=r[n-1].indexOf("@");if(n<4&&s>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var a=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,a];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var i=r[0].match(FC),l=r[1].match(FC);return LC(e,i)?[n,r[0]]:LC(e,l)?[n,r[1]]:[n,r[i!=null&&l!=null?2:1]]}return[n,a]}function jo(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:gr)[t],n==null&&(n=r.table&&r.table[PC[t]]||gr[PC[t]]),n==null&&(n=aY[t]||"General");break}if(Gv(n,0))return ih(e,r);e instanceof Date&&(e=gD(e,r.date1904));var s=NY(n,e);if(Gv(s[1]))return ih(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return _Y(s[1],e,r,s[0])}function jc(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(gr[r]==null){e<0&&(e=r);continue}if(gr[r]==t){e=r;break}}e<0&&(e=391)}return gr[e]=t,e}function rb(t){for(var e=0;e!=392;++e)t[e]!==void 0&&jc(t[e],e)}function Dm(){gr=sY()}var SY={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},TD=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function TY(t){var e=typeof t=="number"?gr[t]:t;return e=e.replace(TD,"(\\d+)"),new RegExp("^"+e+"$")}function AY(t,e,r){var n=-1,s=-1,a=-1,i=-1,l=-1,c=-1;(e.match(TD)||[]).forEach(function(f,m){var h=parseInt(r[m+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=h;break;case"d":a=h;break;case"h":i=h;break;case"s":c=h;break;case"m":i>=0?l=h:s=h;break}}),c>=0&&l==-1&&s>=0&&(l=s,s=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var d=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return i==-1&&l==-1&&c==-1?u:n==-1&&s==-1&&a==-1?d:u+"T"+d}var EY=function(){var t={};t.version="1.2.0";function e(){for(var A=0,S=new Array(256),k=0;k!=256;++k)A=k,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,S[k]=A;return typeof Int32Array<"u"?new Int32Array(S):S}var r=e();function n(A){var S=0,k=0,M=0,I=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(M=0;M!=256;++M)I[M]=A[M];for(M=0;M!=256;++M)for(k=A[M],S=256+M;S<4096;S+=256)k=I[S]=k>>>8^A[k&255];var E=[];for(M=1;M!=16;++M)E[M-1]=typeof Int32Array<"u"?I.subarray(M*256,M*256+256):I.slice(M*256,M*256+256);return E}var s=n(r),a=s[0],i=s[1],l=s[2],c=s[3],u=s[4],d=s[5],f=s[6],m=s[7],h=s[8],g=s[9],p=s[10],v=s[11],b=s[12],w=s[13],N=s[14];function j(A,S){for(var k=S^-1,M=0,I=A.length;M<I;)k=k>>>8^r[(k^A.charCodeAt(M++))&255];return~k}function F(A,S){for(var k=S^-1,M=A.length-15,I=0;I<M;)k=N[A[I++]^k&255]^w[A[I++]^k>>8&255]^b[A[I++]^k>>16&255]^v[A[I++]^k>>>24]^p[A[I++]]^g[A[I++]]^h[A[I++]]^m[A[I++]]^f[A[I++]]^d[A[I++]]^u[A[I++]]^c[A[I++]]^l[A[I++]]^i[A[I++]]^a[A[I++]]^r[A[I++]];for(M+=15;I<M;)k=k>>>8^r[(k^A[I++])&255];return~k}function U(A,S){for(var k=S^-1,M=0,I=A.length,E=0,D=0;M<I;)E=A.charCodeAt(M++),E<128?k=k>>>8^r[(k^E)&255]:E<2048?(k=k>>>8^r[(k^(192|E>>6&31))&255],k=k>>>8^r[(k^(128|E&63))&255]):E>=55296&&E<57344?(E=(E&1023)+64,D=A.charCodeAt(M++)&1023,k=k>>>8^r[(k^(240|E>>8&7))&255],k=k>>>8^r[(k^(128|E>>2&63))&255],k=k>>>8^r[(k^(128|D>>6&15|(E&3)<<4))&255],k=k>>>8^r[(k^(128|D&63))&255]):(k=k>>>8^r[(k^(224|E>>12&15))&255],k=k>>>8^r[(k^(128|E>>6&63))&255],k=k>>>8^r[(k^(128|E&63))&255]);return~k}return t.table=r,t.bstr=j,t.buf=F,t.str=U,t}(),lr=function(){var e={};e.version="1.2.1";function r(ee,be){for(var pe=ee.split("/"),ge=be.split("/"),we=0,_e=0,$e=Math.min(pe.length,ge.length);we<$e;++we){if(_e=pe[we].length-ge[we].length)return _e;if(pe[we]!=ge[we])return pe[we]<ge[we]?-1:1}return pe.length-ge.length}function n(ee){if(ee.charAt(ee.length-1)=="/")return ee.slice(0,-1).indexOf("/")===-1?ee:n(ee.slice(0,-1));var be=ee.lastIndexOf("/");return be===-1?ee:ee.slice(0,be+1)}function s(ee){if(ee.charAt(ee.length-1)=="/")return s(ee.slice(0,-1));var be=ee.lastIndexOf("/");return be===-1?ee:ee.slice(be+1)}function a(ee,be){typeof be=="string"&&(be=new Date(be));var pe=be.getHours();pe=pe<<6|be.getMinutes(),pe=pe<<5|be.getSeconds()>>>1,ee.write_shift(2,pe);var ge=be.getFullYear()-1980;ge=ge<<4|be.getMonth()+1,ge=ge<<5|be.getDate(),ee.write_shift(2,ge)}function i(ee){var be=ee.read_shift(2)&65535,pe=ee.read_shift(2)&65535,ge=new Date,we=pe&31;pe>>>=5;var _e=pe&15;pe>>>=4,ge.setMilliseconds(0),ge.setFullYear(pe+1980),ge.setMonth(_e-1),ge.setDate(we);var $e=be&31;be>>>=5;var rt=be&63;return be>>>=6,ge.setHours(be),ge.setMinutes(rt),ge.setSeconds($e<<1),ge}function l(ee){ha(ee,0);for(var be={},pe=0;ee.l<=ee.length-4;){var ge=ee.read_shift(2),we=ee.read_shift(2),_e=ee.l+we,$e={};switch(ge){case 21589:pe=ee.read_shift(1),pe&1&&($e.mtime=ee.read_shift(4)),we>5&&(pe&2&&($e.atime=ee.read_shift(4)),pe&4&&($e.ctime=ee.read_shift(4))),$e.mtime&&($e.mt=new Date($e.mtime*1e3));break}ee.l=_e,be[ge]=$e}return be}var c;function u(){return c||(c={})}function d(ee,be){if(ee[0]==80&&ee[1]==75)return je(ee,be);if((ee[0]|32)==109&&(ee[1]|32)==105)return Vr(ee,be);if(ee.length<512)throw new Error("CFB file size "+ee.length+" < 512");var pe=3,ge=512,we=0,_e=0,$e=0,rt=0,ze=0,We=[],Xe=ee.slice(0,512);ha(Xe,0);var wt=f(Xe);switch(pe=wt[0],pe){case 3:ge=512;break;case 4:ge=4096;break;case 0:if(wt[1]==0)return je(ee,be);default:throw new Error("Major Version: Expected 3 or 4 saw "+pe)}ge!==512&&(Xe=ee.slice(0,ge),ha(Xe,28));var Lt=ee.slice(0,ge);m(Xe,pe);var qt=Xe.read_shift(4,"i");if(pe===3&&qt!==0)throw new Error("# Directory Sectors: Expected 0 saw "+qt);Xe.l+=4,$e=Xe.read_shift(4,"i"),Xe.l+=4,Xe.chk("00100000","Mini Stream Cutoff Size: "),rt=Xe.read_shift(4,"i"),we=Xe.read_shift(4,"i"),ze=Xe.read_shift(4,"i"),_e=Xe.read_shift(4,"i");for(var jt=-1,$t=0;$t<109&&(jt=Xe.read_shift(4,"i"),!(jt<0));++$t)We[$t]=jt;var Ze=h(ee,ge);v(ze,_e,Ze,ge,We);var mt=w(Ze,$e,We,ge);mt[$e].name="!Directory",we>0&&rt!==D&&(mt[rt].name="!MiniFAT"),mt[We[0]].name="!FAT",mt.fat_addrs=We,mt.ssz=ge;var it={},_t=[],cr=[],xr=[];N($e,mt,Ze,_t,we,it,cr,rt),g(cr,xr,_t),_t.shift();var Lr={FileIndex:cr,FullPaths:xr};return be&&be.raw&&(Lr.raw={header:Lt,sectors:Ze}),Lr}function f(ee){if(ee[ee.l]==80&&ee[ee.l+1]==75)return[0,0];ee.chk(G,"Header Signature: "),ee.l+=16;var be=ee.read_shift(2,"u");return[ee.read_shift(2,"u"),be]}function m(ee,be){var pe=9;switch(ee.l+=2,pe=ee.read_shift(2)){case 9:if(be!=3)throw new Error("Sector Shift: Expected 9 saw "+pe);break;case 12:if(be!=4)throw new Error("Sector Shift: Expected 12 saw "+pe);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+pe)}ee.chk("0600","Mini Sector Shift: "),ee.chk("000000000000","Reserved: ")}function h(ee,be){for(var pe=Math.ceil(ee.length/be)-1,ge=[],we=1;we<pe;++we)ge[we-1]=ee.slice(we*be,(we+1)*be);return ge[pe-1]=ee.slice(pe*be),ge}function g(ee,be,pe){for(var ge=0,we=0,_e=0,$e=0,rt=0,ze=pe.length,We=[],Xe=[];ge<ze;++ge)We[ge]=Xe[ge]=ge,be[ge]=pe[ge];for(;rt<Xe.length;++rt)ge=Xe[rt],we=ee[ge].L,_e=ee[ge].R,$e=ee[ge].C,We[ge]===ge&&(we!==-1&&We[we]!==we&&(We[ge]=We[we]),_e!==-1&&We[_e]!==_e&&(We[ge]=We[_e])),$e!==-1&&(We[$e]=ge),we!==-1&&ge!=We[ge]&&(We[we]=We[ge],Xe.lastIndexOf(we)<rt&&Xe.push(we)),_e!==-1&&ge!=We[ge]&&(We[_e]=We[ge],Xe.lastIndexOf(_e)<rt&&Xe.push(_e));for(ge=1;ge<ze;++ge)We[ge]===ge&&(_e!==-1&&We[_e]!==_e?We[ge]=We[_e]:we!==-1&&We[we]!==we&&(We[ge]=We[we]));for(ge=1;ge<ze;++ge)if(ee[ge].type!==0){if(rt=ge,rt!=We[rt])do rt=We[rt],be[ge]=be[rt]+"/"+be[ge];while(rt!==0&&We[rt]!==-1&&rt!=We[rt]);We[ge]=-1}for(be[0]+="/",ge=1;ge<ze;++ge)ee[ge].type!==2&&(be[ge]+="/")}function p(ee,be,pe){for(var ge=ee.start,we=ee.size,_e=[],$e=ge;pe&&we>0&&$e>=0;)_e.push(be.slice($e*E,$e*E+E)),we-=E,$e=Tf(pe,$e*4);return _e.length===0?ut(0):na(_e).slice(0,ee.size)}function v(ee,be,pe,ge,we){var _e=D;if(ee===D){if(be!==0)throw new Error("DIFAT chain shorter than expected")}else if(ee!==-1){var $e=pe[ee],rt=(ge>>>2)-1;if(!$e)return;for(var ze=0;ze<rt&&(_e=Tf($e,ze*4))!==D;++ze)we.push(_e);v(Tf($e,ge-4),be-1,pe,ge,we)}}function b(ee,be,pe,ge,we){var _e=[],$e=[];we||(we=[]);var rt=ge-1,ze=0,We=0;for(ze=be;ze>=0;){we[ze]=!0,_e[_e.length]=ze,$e.push(ee[ze]);var Xe=pe[Math.floor(ze*4/ge)];if(We=ze*4&rt,ge<4+We)throw new Error("FAT boundary crossed: "+ze+" 4 "+ge);if(!ee[Xe])break;ze=Tf(ee[Xe],We)}return{nodes:_e,data:KC([$e])}}function w(ee,be,pe,ge){var we=ee.length,_e=[],$e=[],rt=[],ze=[],We=ge-1,Xe=0,wt=0,Lt=0,qt=0;for(Xe=0;Xe<we;++Xe)if(rt=[],Lt=Xe+be,Lt>=we&&(Lt-=we),!$e[Lt]){ze=[];var jt=[];for(wt=Lt;wt>=0;){jt[wt]=!0,$e[wt]=!0,rt[rt.length]=wt,ze.push(ee[wt]);var $t=pe[Math.floor(wt*4/ge)];if(qt=wt*4&We,ge<4+qt)throw new Error("FAT boundary crossed: "+wt+" 4 "+ge);if(!ee[$t]||(wt=Tf(ee[$t],qt),jt[wt]))break}_e[Lt]={nodes:rt,data:KC([ze])}}return _e}function N(ee,be,pe,ge,we,_e,$e,rt){for(var ze=0,We=ge.length?2:0,Xe=be[ee].data,wt=0,Lt=0,qt;wt<Xe.length;wt+=128){var jt=Xe.slice(wt,wt+128);ha(jt,64),Lt=jt.read_shift(2),qt=US(jt,0,Lt-We),ge.push(qt);var $t={name:qt,type:jt.read_shift(1),color:jt.read_shift(1),L:jt.read_shift(4,"i"),R:jt.read_shift(4,"i"),C:jt.read_shift(4,"i"),clsid:jt.read_shift(16),state:jt.read_shift(4,"i"),start:0,size:0},Ze=jt.read_shift(2)+jt.read_shift(2)+jt.read_shift(2)+jt.read_shift(2);Ze!==0&&($t.ct=j(jt,jt.l-8));var mt=jt.read_shift(2)+jt.read_shift(2)+jt.read_shift(2)+jt.read_shift(2);mt!==0&&($t.mt=j(jt,jt.l-8)),$t.start=jt.read_shift(4,"i"),$t.size=jt.read_shift(4,"i"),$t.size<0&&$t.start<0&&($t.size=$t.type=0,$t.start=D,$t.name=""),$t.type===5?(ze=$t.start,we>0&&ze!==D&&(be[ze].name="!StreamData")):$t.size>=4096?($t.storage="fat",be[$t.start]===void 0&&(be[$t.start]=b(pe,$t.start,be.fat_addrs,be.ssz)),be[$t.start].name=$t.name,$t.content=be[$t.start].data.slice(0,$t.size)):($t.storage="minifat",$t.size<0?$t.size=0:ze!==D&&$t.start!==D&&be[ze]&&($t.content=p($t,be[ze].data,(be[rt]||{}).data))),$t.content&&ha($t.content,0),_e[qt]=$t,$e.push($t)}}function j(ee,be){return new Date((zi(ee,be+4)/1e7*Math.pow(2,32)+zi(ee,be)/1e7-11644473600)*1e3)}function F(ee,be){return u(),d(c.readFileSync(ee),be)}function U(ee,be){var pe=be&&be.type;switch(pe||Dr&&Buffer.isBuffer(ee)&&(pe="buffer"),pe||"base64"){case"file":return F(ee,be);case"base64":return d(qi(ro(ee)),be);case"binary":return d(qi(ee),be)}return d(ee,be)}function A(ee,be){var pe=be||{},ge=pe.root||"Root Entry";if(ee.FullPaths||(ee.FullPaths=[]),ee.FileIndex||(ee.FileIndex=[]),ee.FullPaths.length!==ee.FileIndex.length)throw new Error("inconsistent CFB structure");ee.FullPaths.length===0&&(ee.FullPaths[0]=ge+"/",ee.FileIndex[0]={name:ge,type:5}),pe.CLSID&&(ee.FileIndex[0].clsid=pe.CLSID),S(ee)}function S(ee){var be="Sh33tJ5";if(!lr.find(ee,"/"+be)){var pe=ut(4);pe[0]=55,pe[1]=pe[3]=50,pe[2]=54,ee.FileIndex.push({name:be,type:2,content:pe,size:4,L:69,R:69,C:69}),ee.FullPaths.push(ee.FullPaths[0]+be),k(ee)}}function k(ee,be){A(ee);for(var pe=!1,ge=!1,we=ee.FullPaths.length-1;we>=0;--we){var _e=ee.FileIndex[we];switch(_e.type){case 0:ge?pe=!0:(ee.FileIndex.pop(),ee.FullPaths.pop());break;case 1:case 2:case 5:ge=!0,isNaN(_e.R*_e.L*_e.C)&&(pe=!0),_e.R>-1&&_e.L>-1&&_e.R==_e.L&&(pe=!0);break;default:pe=!0;break}}if(!(!pe&&!be)){var $e=new Date(1987,1,19),rt=0,ze=Object.create?Object.create(null):{},We=[];for(we=0;we<ee.FullPaths.length;++we)ze[ee.FullPaths[we]]=!0,ee.FileIndex[we].type!==0&&We.push([ee.FullPaths[we],ee.FileIndex[we]]);for(we=0;we<We.length;++we){var Xe=n(We[we][0]);ge=ze[Xe],ge||(We.push([Xe,{name:s(Xe).replace("/",""),type:1,clsid:ae,ct:$e,mt:$e,content:null}]),ze[Xe]=!0)}for(We.sort(function(qt,jt){return r(qt[0],jt[0])}),ee.FullPaths=[],ee.FileIndex=[],we=0;we<We.length;++we)ee.FullPaths[we]=We[we][0],ee.FileIndex[we]=We[we][1];for(we=0;we<We.length;++we){var wt=ee.FileIndex[we],Lt=ee.FullPaths[we];if(wt.name=s(Lt).replace("/",""),wt.L=wt.R=wt.C=-(wt.color=1),wt.size=wt.content?wt.content.length:0,wt.start=0,wt.clsid=wt.clsid||ae,we===0)wt.C=We.length>1?1:-1,wt.size=0,wt.type=5;else if(Lt.slice(-1)=="/"){for(rt=we+1;rt<We.length&&n(ee.FullPaths[rt])!=Lt;++rt);for(wt.C=rt>=We.length?-1:rt,rt=we+1;rt<We.length&&n(ee.FullPaths[rt])!=n(Lt);++rt);wt.R=rt>=We.length?-1:rt,wt.type=1}else n(ee.FullPaths[we+1]||"")==n(Lt)&&(wt.R=we+1),wt.type=2}}}function M(ee,be){var pe=be||{};if(pe.fileType=="mad")return Et(ee,pe);switch(k(ee),pe.fileType){case"zip":return St(ee,pe)}var ge=function(qt){for(var jt=0,$t=0,Ze=0;Ze<qt.FileIndex.length;++Ze){var mt=qt.FileIndex[Ze];if(mt.content){var it=mt.content.length;it>0&&(it<4096?jt+=it+63>>6:$t+=it+511>>9)}}for(var _t=qt.FullPaths.length+3>>2,cr=jt+7>>3,xr=jt+127>>7,Lr=cr+$t+_t+xr,an=Lr+127>>7,As=an<=109?0:Math.ceil((an-109)/127);Lr+an+As+127>>7>an;)As=++an<=109?0:Math.ceil((an-109)/127);var ts=[1,As,an,xr,_t,$t,jt,0];return qt.FileIndex[0].size=jt<<6,ts[7]=(qt.FileIndex[0].start=ts[0]+ts[1]+ts[2]+ts[3]+ts[4]+ts[5])+(ts[6]+7>>3),ts}(ee),we=ut(ge[7]<<9),_e=0,$e=0;{for(_e=0;_e<8;++_e)we.write_shift(1,Z[_e]);for(_e=0;_e<8;++_e)we.write_shift(2,0);for(we.write_shift(2,62),we.write_shift(2,3),we.write_shift(2,65534),we.write_shift(2,9),we.write_shift(2,6),_e=0;_e<3;++_e)we.write_shift(2,0);for(we.write_shift(4,0),we.write_shift(4,ge[2]),we.write_shift(4,ge[0]+ge[1]+ge[2]+ge[3]-1),we.write_shift(4,0),we.write_shift(4,4096),we.write_shift(4,ge[3]?ge[0]+ge[1]+ge[2]-1:D),we.write_shift(4,ge[3]),we.write_shift(-4,ge[1]?ge[0]-1:D),we.write_shift(4,ge[1]),_e=0;_e<109;++_e)we.write_shift(-4,_e<ge[2]?ge[1]+_e:-1)}if(ge[1])for($e=0;$e<ge[1];++$e){for(;_e<236+$e*127;++_e)we.write_shift(-4,_e<ge[2]?ge[1]+_e:-1);we.write_shift(-4,$e===ge[1]-1?D:$e+1)}var rt=function(qt){for($e+=qt;_e<$e-1;++_e)we.write_shift(-4,_e+1);qt&&(++_e,we.write_shift(-4,D))};for($e=_e=0,$e+=ge[1];_e<$e;++_e)we.write_shift(-4,de.DIFSECT);for($e+=ge[2];_e<$e;++_e)we.write_shift(-4,de.FATSECT);rt(ge[3]),rt(ge[4]);for(var ze=0,We=0,Xe=ee.FileIndex[0];ze<ee.FileIndex.length;++ze)Xe=ee.FileIndex[ze],Xe.content&&(We=Xe.content.length,!(We<4096)&&(Xe.start=$e,rt(We+511>>9)));for(rt(ge[6]+7>>3);we.l&511;)we.write_shift(-4,de.ENDOFCHAIN);for($e=_e=0,ze=0;ze<ee.FileIndex.length;++ze)Xe=ee.FileIndex[ze],Xe.content&&(We=Xe.content.length,!(!We||We>=4096)&&(Xe.start=$e,rt(We+63>>6)));for(;we.l&511;)we.write_shift(-4,de.ENDOFCHAIN);for(_e=0;_e<ge[4]<<2;++_e){var wt=ee.FullPaths[_e];if(!wt||wt.length===0){for(ze=0;ze<17;++ze)we.write_shift(4,0);for(ze=0;ze<3;++ze)we.write_shift(4,-1);for(ze=0;ze<12;++ze)we.write_shift(4,0);continue}Xe=ee.FileIndex[_e],_e===0&&(Xe.start=Xe.size?Xe.start-1:D);var Lt=_e===0&&pe.root||Xe.name;if(We=2*(Lt.length+1),we.write_shift(64,Lt,"utf16le"),we.write_shift(2,We),we.write_shift(1,Xe.type),we.write_shift(1,Xe.color),we.write_shift(-4,Xe.L),we.write_shift(-4,Xe.R),we.write_shift(-4,Xe.C),Xe.clsid)we.write_shift(16,Xe.clsid,"hex");else for(ze=0;ze<4;++ze)we.write_shift(4,0);we.write_shift(4,Xe.state||0),we.write_shift(4,0),we.write_shift(4,0),we.write_shift(4,0),we.write_shift(4,0),we.write_shift(4,Xe.start),we.write_shift(4,Xe.size),we.write_shift(4,0)}for(_e=1;_e<ee.FileIndex.length;++_e)if(Xe=ee.FileIndex[_e],Xe.size>=4096)if(we.l=Xe.start+1<<9,Dr&&Buffer.isBuffer(Xe.content))Xe.content.copy(we,we.l,0,Xe.size),we.l+=Xe.size+511&-512;else{for(ze=0;ze<Xe.size;++ze)we.write_shift(1,Xe.content[ze]);for(;ze&511;++ze)we.write_shift(1,0)}for(_e=1;_e<ee.FileIndex.length;++_e)if(Xe=ee.FileIndex[_e],Xe.size>0&&Xe.size<4096)if(Dr&&Buffer.isBuffer(Xe.content))Xe.content.copy(we,we.l,0,Xe.size),we.l+=Xe.size+63&-64;else{for(ze=0;ze<Xe.size;++ze)we.write_shift(1,Xe.content[ze]);for(;ze&63;++ze)we.write_shift(1,0)}if(Dr)we.l=we.length;else for(;we.l<we.length;)we.write_shift(1,0);return we}function I(ee,be){var pe=ee.FullPaths.map(function(ze){return ze.toUpperCase()}),ge=pe.map(function(ze){var We=ze.split("/");return We[We.length-(ze.slice(-1)=="/"?2:1)]}),we=!1;be.charCodeAt(0)===47?(we=!0,be=pe[0].slice(0,-1)+be):we=be.indexOf("/")!==-1;var _e=be.toUpperCase(),$e=we===!0?pe.indexOf(_e):ge.indexOf(_e);if($e!==-1)return ee.FileIndex[$e];var rt=!_e.match(jp);for(_e=_e.replace(si,""),rt&&(_e=_e.replace(jp,"!")),$e=0;$e<pe.length;++$e)if((rt?pe[$e].replace(jp,"!"):pe[$e]).replace(si,"")==_e||(rt?ge[$e].replace(jp,"!"):ge[$e]).replace(si,"")==_e)return ee.FileIndex[$e];return null}var E=64,D=-2,G="d0cf11e0a1b11ae1",Z=[208,207,17,224,161,177,26,225],ae="00000000000000000000000000000000",de={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:D,FREESECT:-1,HEADER_SIGNATURE:G,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ae,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function se(ee,be,pe){u();var ge=M(ee,pe);c.writeFileSync(be,ge)}function Y(ee){for(var be=new Array(ee.length),pe=0;pe<ee.length;++pe)be[pe]=String.fromCharCode(ee[pe]);return be.join("")}function ye(ee,be){var pe=M(ee,be);switch(be&&be.type||"buffer"){case"file":return u(),c.writeFileSync(be.filename,pe),pe;case"binary":return typeof pe=="string"?pe:Y(pe);case"base64":return Kg(typeof pe=="string"?pe:Y(pe));case"buffer":if(Dr)return Buffer.isBuffer(pe)?pe:Qc(pe);case"array":return typeof pe=="string"?qi(pe):pe}return pe}var re;function C(ee){try{var be=ee.InflateRaw,pe=new be;if(pe._processChunk(new Uint8Array([3,0]),pe._finishFlushFlag),pe.bytesRead)re=ee;else throw new Error("zlib does not expose bytesRead")}catch(ge){console.error("cannot use native zlib: "+(ge.message||ge))}}function O(ee,be){if(!re)return Wt(ee,be);var pe=re.InflateRaw,ge=new pe,we=ge._processChunk(ee.slice(ee.l),ge._finishFlushFlag);return ee.l+=ge.bytesRead,we}function L(ee){return re?re.deflateRawSync(ee):Pt(ee)}var H=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],K=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],q=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function te(ee){var be=(ee<<1|ee<<11)&139536|(ee<<5|ee<<15)&558144;return(be>>16|be>>8|be)&255}for(var oe=typeof Uint8Array<"u",V=oe?new Uint8Array(256):[],xe=0;xe<256;++xe)V[xe]=te(xe);function B(ee,be){var pe=V[ee&255];return be<=8?pe>>>8-be:(pe=pe<<8|V[ee>>8&255],be<=16?pe>>>16-be:(pe=pe<<8|V[ee>>16&255],pe>>>24-be))}function Ee(ee,be){var pe=be&7,ge=be>>>3;return(ee[ge]|(pe<=6?0:ee[ge+1]<<8))>>>pe&3}function Me(ee,be){var pe=be&7,ge=be>>>3;return(ee[ge]|(pe<=5?0:ee[ge+1]<<8))>>>pe&7}function Ie(ee,be){var pe=be&7,ge=be>>>3;return(ee[ge]|(pe<=4?0:ee[ge+1]<<8))>>>pe&15}function he(ee,be){var pe=be&7,ge=be>>>3;return(ee[ge]|(pe<=3?0:ee[ge+1]<<8))>>>pe&31}function qe(ee,be){var pe=be&7,ge=be>>>3;return(ee[ge]|(pe<=1?0:ee[ge+1]<<8))>>>pe&127}function ct(ee,be,pe){var ge=be&7,we=be>>>3,_e=(1<<pe)-1,$e=ee[we]>>>ge;return pe<8-ge||($e|=ee[we+1]<<8-ge,pe<16-ge)||($e|=ee[we+2]<<16-ge,pe<24-ge)||($e|=ee[we+3]<<24-ge),$e&_e}function lt(ee,be,pe){var ge=be&7,we=be>>>3;return ge<=5?ee[we]|=(pe&7)<<ge:(ee[we]|=pe<<ge&255,ee[we+1]=(pe&7)>>8-ge),be+3}function ue(ee,be,pe){var ge=be&7,we=be>>>3;return pe=(pe&1)<<ge,ee[we]|=pe,be+1}function Ne(ee,be,pe){var ge=be&7,we=be>>>3;return pe<<=ge,ee[we]|=pe&255,pe>>>=8,ee[we+1]=pe,be+8}function Ae(ee,be,pe){var ge=be&7,we=be>>>3;return pe<<=ge,ee[we]|=pe&255,pe>>>=8,ee[we+1]=pe&255,ee[we+2]=pe>>>8,be+16}function Be(ee,be){var pe=ee.length,ge=2*pe>be?2*pe:be+5,we=0;if(pe>=be)return ee;if(Dr){var _e=kC(ge);if(ee.copy)ee.copy(_e);else for(;we<ee.length;++we)_e[we]=ee[we];return _e}else if(oe){var $e=new Uint8Array(ge);if($e.set)$e.set(ee);else for(;we<pe;++we)$e[we]=ee[we];return $e}return ee.length=ge,ee}function Ue(ee){for(var be=new Array(ee),pe=0;pe<ee;++pe)be[pe]=0;return be}function Ce(ee,be,pe){var ge=1,we=0,_e=0,$e=0,rt=0,ze=ee.length,We=oe?new Uint16Array(32):Ue(32);for(_e=0;_e<32;++_e)We[_e]=0;for(_e=ze;_e<pe;++_e)ee[_e]=0;ze=ee.length;var Xe=oe?new Uint16Array(ze):Ue(ze);for(_e=0;_e<ze;++_e)We[we=ee[_e]]++,ge<we&&(ge=we),Xe[_e]=0;for(We[0]=0,_e=1;_e<=ge;++_e)We[_e+16]=rt=rt+We[_e-1]<<1;for(_e=0;_e<ze;++_e)rt=ee[_e],rt!=0&&(Xe[_e]=We[rt+16]++);var wt=0;for(_e=0;_e<ze;++_e)if(wt=ee[_e],wt!=0)for(rt=B(Xe[_e],ge)>>ge-wt,$e=(1<<ge+4-wt)-1;$e>=0;--$e)be[rt|$e<<wt]=wt&15|_e<<4;return ge}var Ye=oe?new Uint16Array(512):Ue(512),It=oe?new Uint16Array(32):Ue(32);if(!oe){for(var Dt=0;Dt<512;++Dt)Ye[Dt]=0;for(Dt=0;Dt<32;++Dt)It[Dt]=0}(function(){for(var ee=[],be=0;be<32;be++)ee.push(5);Ce(ee,It,32);var pe=[];for(be=0;be<=143;be++)pe.push(8);for(;be<=255;be++)pe.push(9);for(;be<=279;be++)pe.push(7);for(;be<=287;be++)pe.push(8);Ce(pe,Ye,288)})();var Ot=function(){for(var be=oe?new Uint8Array(32768):[],pe=0,ge=0;pe<q.length-1;++pe)for(;ge<q[pe+1];++ge)be[ge]=pe;for(;ge<32768;++ge)be[ge]=29;var we=oe?new Uint8Array(259):[];for(pe=0,ge=0;pe<K.length-1;++pe)for(;ge<K[pe+1];++ge)we[ge]=pe;function _e(rt,ze){for(var We=0;We<rt.length;){var Xe=Math.min(65535,rt.length-We),wt=We+Xe==rt.length;for(ze.write_shift(1,+wt),ze.write_shift(2,Xe),ze.write_shift(2,~Xe&65535);Xe-- >0;)ze[ze.l++]=rt[We++]}return ze.l}function $e(rt,ze){for(var We=0,Xe=0,wt=oe?new Uint16Array(32768):[];Xe<rt.length;){var Lt=Math.min(65535,rt.length-Xe);if(Lt<10){for(We=lt(ze,We,+(Xe+Lt==rt.length)),We&7&&(We+=8-(We&7)),ze.l=We/8|0,ze.write_shift(2,Lt),ze.write_shift(2,~Lt&65535);Lt-- >0;)ze[ze.l++]=rt[Xe++];We=ze.l*8;continue}We=lt(ze,We,+(Xe+Lt==rt.length)+2);for(var qt=0;Lt-- >0;){var jt=rt[Xe];qt=(qt<<5^jt)&32767;var $t=-1,Ze=0;if(($t=wt[qt])&&($t|=Xe&-32768,$t>Xe&&($t-=32768),$t<Xe))for(;rt[$t+Ze]==rt[Xe+Ze]&&Ze<250;)++Ze;if(Ze>2){jt=we[Ze],jt<=22?We=Ne(ze,We,V[jt+1]>>1)-1:(Ne(ze,We,3),We+=5,Ne(ze,We,V[jt-23]>>5),We+=3);var mt=jt<8?0:jt-4>>2;mt>0&&(Ae(ze,We,Ze-K[jt]),We+=mt),jt=be[Xe-$t],We=Ne(ze,We,V[jt]>>3),We-=3;var it=jt<4?0:jt-2>>1;it>0&&(Ae(ze,We,Xe-$t-q[jt]),We+=it);for(var _t=0;_t<Ze;++_t)wt[qt]=Xe&32767,qt=(qt<<5^rt[Xe])&32767,++Xe;Lt-=Ze-1}else jt<=143?jt=jt+48:We=ue(ze,We,1),We=Ne(ze,We,V[jt]),wt[qt]=Xe&32767,++Xe}We=Ne(ze,We,0)-1}return ze.l=(We+7)/8|0,ze.l}return function(ze,We){return ze.length<8?_e(ze,We):$e(ze,We)}}();function Pt(ee){var be=ut(50+Math.floor(ee.length*1.1)),pe=Ot(ee,be);return be.slice(0,pe)}var ht=oe?new Uint16Array(32768):Ue(32768),or=oe?new Uint16Array(32768):Ue(32768),Ve=oe?new Uint16Array(128):Ue(128),tt=1,nt=1;function At(ee,be){var pe=he(ee,be)+257;be+=5;var ge=he(ee,be)+1;be+=5;var we=Ie(ee,be)+4;be+=4;for(var _e=0,$e=oe?new Uint8Array(19):Ue(19),rt=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ze=1,We=oe?new Uint8Array(8):Ue(8),Xe=oe?new Uint8Array(8):Ue(8),wt=$e.length,Lt=0;Lt<we;++Lt)$e[H[Lt]]=_e=Me(ee,be),ze<_e&&(ze=_e),We[_e]++,be+=3;var qt=0;for(We[0]=0,Lt=1;Lt<=ze;++Lt)Xe[Lt]=qt=qt+We[Lt-1]<<1;for(Lt=0;Lt<wt;++Lt)(qt=$e[Lt])!=0&&(rt[Lt]=Xe[qt]++);var jt=0;for(Lt=0;Lt<wt;++Lt)if(jt=$e[Lt],jt!=0){qt=V[rt[Lt]]>>8-jt;for(var $t=(1<<7-jt)-1;$t>=0;--$t)Ve[qt|$t<<jt]=jt&7|Lt<<3}var Ze=[];for(ze=1;Ze.length<pe+ge;)switch(qt=Ve[qe(ee,be)],be+=qt&7,qt>>>=3){case 16:for(_e=3+Ee(ee,be),be+=2,qt=Ze[Ze.length-1];_e-- >0;)Ze.push(qt);break;case 17:for(_e=3+Me(ee,be),be+=3;_e-- >0;)Ze.push(0);break;case 18:for(_e=11+qe(ee,be),be+=7;_e-- >0;)Ze.push(0);break;default:Ze.push(qt),ze<qt&&(ze=qt);break}var mt=Ze.slice(0,pe),it=Ze.slice(pe);for(Lt=pe;Lt<286;++Lt)mt[Lt]=0;for(Lt=ge;Lt<30;++Lt)it[Lt]=0;return tt=Ce(mt,ht,286),nt=Ce(it,or,30),be}function mr(ee,be){if(ee[0]==3&&!(ee[1]&3))return[jd(be),2];for(var pe=0,ge=0,we=kC(be||1<<18),_e=0,$e=we.length>>>0,rt=0,ze=0;!(ge&1);){if(ge=Me(ee,pe),pe+=3,ge>>>1)ge>>1==1?(rt=9,ze=5):(pe=At(ee,pe),rt=tt,ze=nt);else{pe&7&&(pe+=8-(pe&7));var We=ee[pe>>>3]|ee[(pe>>>3)+1]<<8;if(pe+=32,We>0)for(!be&&$e<_e+We&&(we=Be(we,_e+We),$e=we.length);We-- >0;)we[_e++]=ee[pe>>>3],pe+=8;continue}for(;;){!be&&$e<_e+32767&&(we=Be(we,_e+32767),$e=we.length);var Xe=ct(ee,pe,rt),wt=ge>>>1==1?Ye[Xe]:ht[Xe];if(pe+=wt&15,wt>>>=4,!(wt>>>8&255))we[_e++]=wt;else{if(wt==256)break;wt-=257;var Lt=wt<8?0:wt-4>>2;Lt>5&&(Lt=0);var qt=_e+K[wt];Lt>0&&(qt+=ct(ee,pe,Lt),pe+=Lt),Xe=ct(ee,pe,ze),wt=ge>>>1==1?It[Xe]:or[Xe],pe+=wt&15,wt>>>=4;var jt=wt<4?0:wt-2>>1,$t=q[wt];for(jt>0&&($t+=ct(ee,pe,jt),pe+=jt),!be&&$e<qt&&(we=Be(we,qt+100),$e=we.length);_e<qt;)we[_e]=we[_e-$t],++_e}}}return be?[we,pe+7>>>3]:[we.slice(0,_e),pe+7>>>3]}function Wt(ee,be){var pe=ee.slice(ee.l||0),ge=mr(pe,be);return ee.l+=ge[1],ge[0]}function Te(ee,be){if(ee)typeof console<"u"&&console.error(be);else throw new Error(be)}function je(ee,be){var pe=ee;ha(pe,0);var ge=[],we=[],_e={FileIndex:ge,FullPaths:we};A(_e,{root:be.root});for(var $e=pe.length-4;(pe[$e]!=80||pe[$e+1]!=75||pe[$e+2]!=5||pe[$e+3]!=6)&&$e>=0;)--$e;pe.l=$e+4,pe.l+=4;var rt=pe.read_shift(2);pe.l+=6;var ze=pe.read_shift(4);for(pe.l=ze,$e=0;$e<rt;++$e){pe.l+=20;var We=pe.read_shift(4),Xe=pe.read_shift(4),wt=pe.read_shift(2),Lt=pe.read_shift(2),qt=pe.read_shift(2);pe.l+=8;var jt=pe.read_shift(4),$t=l(pe.slice(pe.l+wt,pe.l+wt+Lt));pe.l+=wt+Lt+qt;var Ze=pe.l;pe.l=jt+4,et(pe,We,Xe,_e,$t),pe.l=Ze}return _e}function et(ee,be,pe,ge,we){ee.l+=2;var _e=ee.read_shift(2),$e=ee.read_shift(2),rt=i(ee);if(_e&8257)throw new Error("Unsupported ZIP encryption");for(var ze=ee.read_shift(4),We=ee.read_shift(4),Xe=ee.read_shift(4),wt=ee.read_shift(2),Lt=ee.read_shift(2),qt="",jt=0;jt<wt;++jt)qt+=String.fromCharCode(ee[ee.l++]);if(Lt){var $t=l(ee.slice(ee.l,ee.l+Lt));($t[21589]||{}).mt&&(rt=$t[21589].mt),((we||{})[21589]||{}).mt&&(rt=we[21589].mt)}ee.l+=Lt;var Ze=ee.slice(ee.l,ee.l+We);switch($e){case 8:Ze=O(ee,Xe);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+$e)}var mt=!1;_e&8&&(ze=ee.read_shift(4),ze==134695760&&(ze=ee.read_shift(4),mt=!0),We=ee.read_shift(4),Xe=ee.read_shift(4)),We!=be&&Te(mt,"Bad compressed size: "+be+" != "+We),Xe!=pe&&Te(mt,"Bad uncompressed size: "+pe+" != "+Xe),Qr(ge,qt,Ze,{unsafe:!0,mt:rt})}function St(ee,be){var pe=be||{},ge=[],we=[],_e=ut(1),$e=pe.compression?8:0,rt=0,ze=0,We=0,Xe=0,wt=0,Lt=ee.FullPaths[0],qt=Lt,jt=ee.FileIndex[0],$t=[],Ze=0;for(ze=1;ze<ee.FullPaths.length;++ze)if(qt=ee.FullPaths[ze].slice(Lt.length),jt=ee.FileIndex[ze],!(!jt.size||!jt.content||qt=="Sh33tJ5")){var mt=Xe,it=ut(qt.length);for(We=0;We<qt.length;++We)it.write_shift(1,qt.charCodeAt(We)&127);it=it.slice(0,it.l),$t[wt]=EY.buf(jt.content,0);var _t=jt.content;$e==8&&(_t=L(_t)),_e=ut(30),_e.write_shift(4,67324752),_e.write_shift(2,20),_e.write_shift(2,rt),_e.write_shift(2,$e),jt.mt?a(_e,jt.mt):_e.write_shift(4,0),_e.write_shift(-4,$t[wt]),_e.write_shift(4,_t.length),_e.write_shift(4,jt.content.length),_e.write_shift(2,it.length),_e.write_shift(2,0),Xe+=_e.length,ge.push(_e),Xe+=it.length,ge.push(it),Xe+=_t.length,ge.push(_t),_e=ut(46),_e.write_shift(4,33639248),_e.write_shift(2,0),_e.write_shift(2,20),_e.write_shift(2,rt),_e.write_shift(2,$e),_e.write_shift(4,0),_e.write_shift(-4,$t[wt]),_e.write_shift(4,_t.length),_e.write_shift(4,jt.content.length),_e.write_shift(2,it.length),_e.write_shift(2,0),_e.write_shift(2,0),_e.write_shift(2,0),_e.write_shift(2,0),_e.write_shift(4,0),_e.write_shift(4,mt),Ze+=_e.l,we.push(_e),Ze+=it.length,we.push(it),++wt}return _e=ut(22),_e.write_shift(4,101010256),_e.write_shift(2,0),_e.write_shift(2,0),_e.write_shift(2,wt),_e.write_shift(2,wt),_e.write_shift(4,Ze),_e.write_shift(4,Xe),_e.write_shift(2,0),na([na(ge),na(we),_e])}var vt={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function st(ee,be){if(ee.ctype)return ee.ctype;var pe=ee.name||"",ge=pe.match(/\.([^\.]+)$/);return ge&&vt[ge[1]]||be&&(ge=(pe=be).match(/[\.\\]([^\.\\])+$/),ge&&vt[ge[1]])?vt[ge[1]]:"application/octet-stream"}function zt(ee){for(var be=Kg(ee),pe=[],ge=0;ge<be.length;ge+=76)pe.push(be.slice(ge,ge+76));return pe.join(`\r
`)+`\r
`}function Qt(ee){var be=ee.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(We){var Xe=We.charCodeAt(0).toString(16).toUpperCase();return"="+(Xe.length==1?"0"+Xe:Xe)});be=be.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),be.charAt(0)==`
`&&(be="=0D"+be.slice(1)),be=be.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var pe=[],ge=be.split(`\r
`),we=0;we<ge.length;++we){var _e=ge[we];if(_e.length==0){pe.push("");continue}for(var $e=0;$e<_e.length;){var rt=76,ze=_e.slice($e,$e+rt);ze.charAt(rt-1)=="="?rt--:ze.charAt(rt-2)=="="?rt-=2:ze.charAt(rt-3)=="="&&(rt-=3),ze=_e.slice($e,$e+rt),$e+=rt,$e<_e.length&&(ze+="="),pe.push(ze)}}return pe.join(`\r
`)}function nr(ee){for(var be=[],pe=0;pe<ee.length;++pe){for(var ge=ee[pe];pe<=ee.length&&ge.charAt(ge.length-1)=="=";)ge=ge.slice(0,ge.length-1)+ee[++pe];be.push(ge)}for(var we=0;we<be.length;++we)be[we]=be[we].replace(/[=][0-9A-Fa-f]{2}/g,function(_e){return String.fromCharCode(parseInt(_e.slice(1),16))});return qi(be.join(`\r
`))}function dr(ee,be,pe){for(var ge="",we="",_e="",$e,rt=0;rt<10;++rt){var ze=be[rt];if(!ze||ze.match(/^\s*$/))break;var We=ze.match(/^(.*?):\s*([^\s].*)$/);if(We)switch(We[1].toLowerCase()){case"content-location":ge=We[2].trim();break;case"content-type":_e=We[2].trim();break;case"content-transfer-encoding":we=We[2].trim();break}}switch(++rt,we.toLowerCase()){case"base64":$e=qi(ro(be.slice(rt).join("")));break;case"quoted-printable":$e=nr(be.slice(rt));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+we)}var Xe=Qr(ee,ge.slice(pe.length),$e,{unsafe:!0});_e&&(Xe.ctype=_e)}function Vr(ee,be){if(Y(ee.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var pe=be&&be.root||"",ge=(Dr&&Buffer.isBuffer(ee)?ee.toString("binary"):Y(ee)).split(`\r
`),we=0,_e="";for(we=0;we<ge.length;++we)if(_e=ge[we],!!/^Content-Location:/i.test(_e)&&(_e=_e.slice(_e.indexOf("file")),pe||(pe=_e.slice(0,_e.lastIndexOf("/")+1)),_e.slice(0,pe.length)!=pe))for(;pe.length>0&&(pe=pe.slice(0,pe.length-1),pe=pe.slice(0,pe.lastIndexOf("/")+1),_e.slice(0,pe.length)!=pe););var $e=(ge[1]||"").match(/boundary="(.*?)"/);if(!$e)throw new Error("MAD cannot find boundary");var rt="--"+($e[1]||""),ze=[],We=[],Xe={FileIndex:ze,FullPaths:We};A(Xe);var wt,Lt=0;for(we=0;we<ge.length;++we){var qt=ge[we];qt!==rt&&qt!==rt+"--"||(Lt++&&dr(Xe,ge.slice(wt,we),pe),wt=we)}return Xe}function Et(ee,be){var pe=be||{},ge=pe.boundary||"SheetJS";ge="------="+ge;for(var we=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+ge.slice(2)+'"',"","",""],_e=ee.FullPaths[0],$e=_e,rt=ee.FileIndex[0],ze=1;ze<ee.FullPaths.length;++ze)if($e=ee.FullPaths[ze].slice(_e.length),rt=ee.FileIndex[ze],!(!rt.size||!rt.content||$e=="Sh33tJ5")){$e=$e.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ze){return"_x"+Ze.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ze){return"_u"+Ze.charCodeAt(0).toString(16)+"_"});for(var We=rt.content,Xe=Dr&&Buffer.isBuffer(We)?We.toString("binary"):Y(We),wt=0,Lt=Math.min(1024,Xe.length),qt=0,jt=0;jt<=Lt;++jt)(qt=Xe.charCodeAt(jt))>=32&&qt<128&&++wt;var $t=wt>=Lt*4/5;we.push(ge),we.push("Content-Location: "+(pe.root||"file:///C:/SheetJS/")+$e),we.push("Content-Transfer-Encoding: "+($t?"quoted-printable":"base64")),we.push("Content-Type: "+st(rt,$e)),we.push(""),we.push($t?Qt(Xe):zt(Xe))}return we.push(ge+`--\r
`),we.join(`\r
`)}function qr(ee){var be={};return A(be,ee),be}function Qr(ee,be,pe,ge){var we=ge&&ge.unsafe;we||A(ee);var _e=!we&&lr.find(ee,be);if(!_e){var $e=ee.FullPaths[0];be.slice(0,$e.length)==$e?$e=be:($e.slice(-1)!="/"&&($e+="/"),$e=($e+be).replace("//","/")),_e={name:s(be),type:2},ee.FileIndex.push(_e),ee.FullPaths.push($e),we||lr.utils.cfb_gc(ee)}return _e.content=pe,_e.size=pe?pe.length:0,ge&&(ge.CLSID&&(_e.clsid=ge.CLSID),ge.mt&&(_e.mt=ge.mt),ge.ct&&(_e.ct=ge.ct)),_e}function Wr(ee,be){A(ee);var pe=lr.find(ee,be);if(pe){for(var ge=0;ge<ee.FileIndex.length;++ge)if(ee.FileIndex[ge]==pe)return ee.FileIndex.splice(ge,1),ee.FullPaths.splice(ge,1),!0}return!1}function Nn(ee,be,pe){A(ee);var ge=lr.find(ee,be);if(ge){for(var we=0;we<ee.FileIndex.length;++we)if(ee.FileIndex[we]==ge)return ee.FileIndex[we].name=s(pe),ee.FullPaths[we]=pe,!0}return!1}function ir(ee){k(ee,!0)}return e.find=I,e.read=U,e.parse=d,e.write=ye,e.writeFile=se,e.utils={cfb_new:qr,cfb_add:Qr,cfb_del:Wr,cfb_mov:Nn,cfb_gc:ir,ReadShift:eg,CheckField:GD,prep_blob:ha,bconcat:na,use_zlib:C,_deflateRaw:Pt,_inflateRaw:Wt,consts:de},e}();function CY(t){return typeof t=="string"?tb(t):Array.isArray(t)?eY(t):t}function Vx(t,e,r){if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=tb(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var n=r=="utf8"?Dl(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var s=new Blob([CY(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,t);if(typeof saveAs<"u")return saveAs(s,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var a=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),chrome.downloads.download({url:a,filename:t,saveAs:!0});var i=document.createElement("a");if(i.download!=null)return i.download=t,i.href=a,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),a}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var l=File(t);return l.open("w"),l.encoding="binary",Array.isArray(e)&&(e=Yd(e)),l.write(e),l.close(),e}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+t)}function kY(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function fs(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function OC(t,e){for(var r=[],n=fs(t),s=0;s!==n.length;++s)r[t[n[s]][e]]==null&&(r[t[n[s]][e]]=n[s]);return r}function nb(t){for(var e=[],r=fs(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}function sb(t){for(var e=[],r=fs(t),n=0;n!==r.length;++n)e[t[r[n]]]=parseInt(r[n],10);return e}function IY(t){for(var e=[],r=fs(t),n=0;n!==r.length;++n)e[t[r[n]]]==null&&(e[t[r[n]]]=[]),e[t[r[n]]].push(r[n]);return e}var Yv=new Date(1899,11,30,0,0,0);function Hs(t,e){var r=t.getTime(),n=Yv.getTime()+(t.getTimezoneOffset()-Yv.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var AD=new Date,jY=Yv.getTime()+(AD.getTimezoneOffset()-Yv.getTimezoneOffset())*6e4,MC=AD.getTimezoneOffset();function ab(t){var e=new Date;return e.setTime(t*24*60*60*1e3+jY),e.getTimezoneOffset()!==MC&&e.setTime(e.getTime()+(e.getTimezoneOffset()-MC)*6e4),e}function PY(t){var e=0,r=0,n=!1,s=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var a=1;a!=s.length;++a)if(s[a]){switch(r=1,a>3&&(n=!0),s[a].slice(s[a].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[a].slice(s[a].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(s[a],10)}return e}var VC=new Date("2017-02-19T19:06:09.000Z"),ED=isNaN(VC.getFullYear())?new Date("2/19/17"):VC,RY=ED.getFullYear()==2017;function Vn(t,e){var r=new Date(t);if(RY)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(ED.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var s=t.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return t.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function oh(t,e){if(Dr&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return Dl(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return Dl(mD(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return Dl(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return Dl(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(a){return r[a]||a})}catch{}for(var n=[],s=0;s!=t.length;++s)n.push(String.fromCharCode(t[s]));return n.join("")}function Bn(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=Bn(t[r]));return e}function os(t,e){for(var r="";r.length<e;)r+=t;return r}function sl(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,a){return r=-r,a}),!isNaN(e=Number(n)))?e/r:e}var DY=["january","february","march","april","may","june","july","august","september","october","november","december"];function ym(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),s=e.getMonth(),a=e.getDate();if(isNaN(a))return r;var i=t.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),i.length>3&&DY.indexOf(i)==-1)return r}else if(i.match(/[a-z]/))return r;return n<0||n>8099?r:(s>0||a>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var FY=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,s){if(t||typeof n=="string")return r.split(n);for(var a=r.split(n),i=[a[0]],l=1;l<a.length;++l)i.push(s),i.push(a[l]);return i}}();function CD(t){return t?t.content&&t.type?oh(t.content,!0):t.data?Ip(t.data):t.asNodeBuffer&&Dr?Ip(t.asNodeBuffer().toString("binary")):t.asBinary?Ip(t.asBinary()):t._data&&t._data.getContent?Ip(oh(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function kD(t){if(!t)return null;if(t.data)return EC(t.data);if(t.asNodeBuffer&&Dr)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?EC(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function LY(t){return t&&t.name.slice(-4)===".bin"?kD(t):CD(t)}function vo(t,e){for(var r=t.FullPaths||fs(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),s=n.replace(/\\/g,"/"),a=0;a<r.length;++a){var i=r[a].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==i||s==i)return t.files?t.files[r[a]]:t.FileIndex[a]}return null}function FS(t,e){var r=vo(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function Rs(t,e,r){if(!r)return LY(FS(t,e));if(!e)return null;try{return Rs(t,e)}catch{return null}}function Wi(t,e,r){if(!r)return CD(FS(t,e));if(!e)return null;try{return Wi(t,e)}catch{return null}}function OY(t,e,r){return kD(FS(t,e))}function BC(t){for(var e=t.FullPaths||fs(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function Pr(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return Dr?n=Qc(r):n=tY(r),lr.utils.cfb_add(t,e,n)}lr.utils.cfb_add(t,e,r)}else t.file(e,r)}function LS(){return lr.utils.cfb_new()}function ID(t,e){switch(e.type){case"base64":return lr.read(t,{type:"base64"});case"binary":return lr.read(t,{type:"binary"});case"buffer":case"array":return lr.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function Pp(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var s=n.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var Ts=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,MY=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,UC=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,VY=/<[^>]*>/g,za=Ts.match(UC)?UC:VY,BY=/<\w*:/,UY=/<(\/?)\w+:/;function _r(t,e,r){for(var n={},s=0,a=0;s!==t.length&&!((a=t.charCodeAt(s))===32||a===10||a===13);++s);if(e||(n[0]=t.slice(0,s)),s===t.length)return n;var i=t.match(MY),l=0,c="",u=0,d="",f="",m=1;if(i)for(u=0;u!=i.length;++u){for(f=i[u],a=0;a!=f.length&&f.charCodeAt(a)!==61;++a);for(d=f.slice(0,a).trim();f.charCodeAt(a+1)==32;)++a;for(m=(s=f.charCodeAt(a+1))==34||s==39?1:0,c=f.slice(a+1+m,f.length-m),l=0;l!=d.length&&d.charCodeAt(l)!==58;++l);if(l===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),n[d]=c,n[d.toLowerCase()]=c;else{var h=(l===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(l+1);if(n[h]&&d.slice(l-3,l)=="ext")continue;n[h]=c,n[h.toLowerCase()]=c}}return n}function Hl(t){return t.replace(UY,"<$1")}var jD={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},OS=nb(jD),en=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var s=n+"",a=s.indexOf("<![CDATA[");if(a==-1)return s.replace(t,function(l,c){return jD[l]||String.fromCharCode(parseInt(c,l.indexOf("x")>-1?16:10))||l}).replace(e,function(l,c){return String.fromCharCode(parseInt(c,16))});var i=s.indexOf("]]>");return r(s.slice(0,a))+s.slice(a+9,i)+r(s.slice(i+3))}}(),MS=/[&<>'"]/g,$Y=/[\u0000-\u0008\u000b-\u001f]/g;function xn(t){var e=t+"";return e.replace(MS,function(r){return OS[r]}).replace($Y,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function $C(t){return xn(t).replace(/ /g,"_x0020_")}var PD=/[\u0000-\u001f]/g;function VS(t){var e=t+"";return e.replace(MS,function(r){return OS[r]}).replace(/\n/g,"<br/>").replace(PD,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function zY(t){var e=t+"";return e.replace(MS,function(r){return OS[r]}).replace(PD,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var zC=function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}}();function qY(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function Ln(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Sw(t){for(var e="",r=0,n=0,s=0,a=0,i=0,l=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(s=t.charCodeAt(r++),n>191&&n<224){i=(n&31)<<6,i|=s&63,e+=String.fromCharCode(i);continue}if(a=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(s&63)<<6|a&63);continue}i=t.charCodeAt(r++),l=((n&7)<<18|(s&63)<<12|(a&63)<<6|i&63)-65536,e+=String.fromCharCode(55296+(l>>>10&1023)),e+=String.fromCharCode(56320+(l&1023))}return e}function qC(t){var e=jd(2*t.length),r,n,s=1,a=0,i=0,l;for(n=0;n<t.length;n+=s)s=1,(l=t.charCodeAt(n))<128?r=l:l<224?(r=(l&31)*64+(t.charCodeAt(n+1)&63),s=2):l<240?(r=(l&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),s=3):(s=4,r=(l&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,i=55296+(r>>>10&1023),r=56320+(r&1023)),i!==0&&(e[a++]=i&255,e[a++]=i>>>8,i=0),e[a++]=r%256,e[a++]=r>>>8;return e.slice(0,a).toString("ucs2")}function WC(t){return Qc(t,"binary").toString("utf8")}var W1="foo bar baz",wn=Dr&&(WC(W1)==Sw(W1)&&WC||qC(W1)==Sw(W1)&&qC)||Sw,Dl=Dr?function(t){return Qc(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,s=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(s>>18&7))),e.push(String.fromCharCode(144+(s>>12&63))),e.push(String.fromCharCode(128+(s>>6&63))),e.push(String.fromCharCode(128+(s&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},Xg=function(){var t={};return function(r,n){var s=r+"|"+(n||"");return t[s]?t[s]:t[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),RD=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<t.length;++s)n=n.replace(t[s][0],t[s][1]);return n}}(),WY=function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),HY=/<\/?(?:vt:)?variant>/g,GY=/<(?:vt:)([^>]*)>([\s\S]*)</;function HC(t,e){var r=_r(t),n=t.match(WY(r.baseType))||[],s=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return s}return n.forEach(function(a){var i=a.replace(HY,"").match(GY);i&&s.push({v:wn(i[2]),t:i[1]})}),s}var DD=/(^\s|\s$|\n)/;function ma(t,e){return"<"+t+(e.match(DD)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function Qg(t){return fs(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function Vt(t,e,r){return"<"+t+(r!=null?Qg(r):"")+(e!=null?(e.match(DD)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function U_(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function KY(t,e){switch(typeof t){case"string":var r=Vt("vt:lpwstr",xn(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Vt((t|0)==t?"vt:i4":"vt:r8",xn(String(t)));case"boolean":return Vt("vt:bool",t?"true":"false")}if(t instanceof Date)return Vt("vt:filetime",U_(t));throw new Error("Unable to serialize "+t)}function BS(t){if(Dr&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return wn(Yd(PS(t)));throw new Error("Bad input format: expected Buffer or string")}var Jg=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,$s={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},yh=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],$i={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function YY(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),s=t[e+6]&15,a=5;a>=0;--a)s=s*256+t[e+a];return n==2047?s==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),r*Math.pow(2,n-52)*s)}function XY(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,s=0,a=0,i=n?-e:e;isFinite(i)?i==0?s=a=0:(s=Math.floor(Math.log(i)/Math.LN2),a=i*Math.pow(2,52-s),s<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?s=-1022:(a-=Math.pow(2,52),s+=1023)):(s=2047,a=isNaN(e)?26985:0);for(var l=0;l<=5;++l,a/=256)t[r+l]=a&255;t[r+6]=(s&15)<<4|a&15,t[r+7]=s>>4|n}var GC=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var s=0,a=t[0][n].length;s<a;s+=r)e.push.apply(e,t[0][n].slice(s,s+r));return e},KC=Dr?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:Qc(e)})):GC(t)}:GC,YC=function(t,e,r){for(var n=[],s=e;s<r;s+=2)n.push(String.fromCharCode(Sc(t,s)));return n.join("").replace(si,"")},US=Dr?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(si,""):YC(t,e,r)}:YC,XC=function(t,e,r){for(var n=[],s=e;s<e+r;++s)n.push(("0"+t[s].toString(16)).slice(-2));return n.join("")},FD=Dr?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):XC(t,e,r)}:XC,QC=function(t,e,r){for(var n=[],s=e;s<r;s++)n.push(String.fromCharCode(d0(t,s)));return n.join("")},Bx=Dr?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):QC(e,r,n)}:QC,LD=function(t,e){var r=zi(t,e);return r>0?Bx(t,e+4,e+4+r-1):""},OD=LD,MD=function(t,e){var r=zi(t,e);return r>0?Bx(t,e+4,e+4+r-1):""},VD=MD,BD=function(t,e){var r=2*zi(t,e);return r>0?Bx(t,e+4,e+4+r-1):""},UD=BD,$D=function(e,r){var n=zi(e,r);return n>0?US(e,r+4,r+4+n):""},zD=$D,qD=function(t,e){var r=zi(t,e);return r>0?Bx(t,e+4,e+4+r):""},WD=qD,HD=function(t,e){return YY(t,e)},Xv=HD,$S=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Dr&&(OD=function(e,r){if(!Buffer.isBuffer(e))return LD(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},VD=function(e,r){if(!Buffer.isBuffer(e))return MD(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},UD=function(e,r){if(!Buffer.isBuffer(e))return BD(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},zD=function(e,r){if(!Buffer.isBuffer(e))return $D(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},WD=function(e,r){if(!Buffer.isBuffer(e))return qD(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},Xv=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):HD(e,r)},$S=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var d0=function(t,e){return t[e]},Sc=function(t,e){return t[e+1]*256+t[e]},QY=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},zi=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},Tf=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},JY=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function eg(t,e){var r="",n,s,a=[],i,l,c,u;switch(e){case"dbcs":if(u=this.l,Dr&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(c=0;c<t;++c)r+=String.fromCharCode(Sc(this,u)),u+=2;t*=2;break;case"utf8":r=Bx(this,this.l,this.l+t);break;case"utf16le":t*=2,r=US(this,this.l,this.l+t);break;case"wstr":return eg.call(this,t,"dbcs");case"lpstr-ansi":r=OD(this,this.l),t=4+zi(this,this.l);break;case"lpstr-cp":r=VD(this,this.l),t=4+zi(this,this.l);break;case"lpwstr":r=UD(this,this.l),t=4+2*zi(this,this.l);break;case"lpp4":t=4+zi(this,this.l),r=zD(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+zi(this,this.l),r=WD(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(i=d0(this,this.l+t++))!==0;)a.push(q1(i));r=a.join("");break;case"_wstr":for(t=0,r="";(i=Sc(this,this.l+t))!==0;)a.push(q1(i)),t+=2;t+=2,r=a.join("");break;case"dbcs-cont":for(r="",u=this.l,c=0;c<t;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return i=d0(this,u),this.l=u+1,l=eg.call(this,t-c,i?"dbcs-cont":"sbcs-cont"),a.join("")+l;a.push(q1(Sc(this,u))),u+=2}r=a.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,c=0;c!=t;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return i=d0(this,u),this.l=u+1,l=eg.call(this,t-c,i?"dbcs-cont":"sbcs-cont"),a.join("")+l;a.push(q1(d0(this,u))),u+=1}r=a.join("");break;default:switch(t){case 1:return n=d0(this,this.l),this.l++,n;case 2:return n=(e==="i"?QY:Sc)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(n=(t>0?Tf:JY)(this,this.l),this.l+=4,n):(s=zi(this,this.l),this.l+=4,s);case 8:case-8:if(e==="f")return t==8?s=Xv(this,this.l):s=Xv([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;t=8;case 16:r=FD(this,this.l,t);break}}return this.l+=t,r}var ZY=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},eX=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},tX=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function rX(t,e,r){var n=0,s=0;if(r==="dbcs"){for(s=0;s!=e.length;++s)tX(this,e.charCodeAt(s),this.l+2*s);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=e.length;++s)this[this.l+s]=e.charCodeAt(s)&255;n=e.length}else if(r==="hex"){for(;s<t;++s)this[this.l++]=parseInt(e.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var a=Math.min(this.l+t,this.length);for(s=0;s<Math.min(e.length,t);++s){var i=e.charCodeAt(s);this[this.l++]=i&255,this[this.l++]=i>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,ZY(this,e,this.l);break;case 8:if(n=8,r==="f"){XY(this,e,this.l);break}case 16:break;case-4:n=4,eX(this,e,this.l);break}return this.l+=n,this}function GD(t,e){var r=FD(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function ha(t,e){t.l=e,t.read_shift=eg,t.chk=GD,t.write_shift=rX}function $a(t,e){t.l+=e}function ut(t){var e=jd(t);return ha(e,0),e}function Jc(t,e,r){if(t){var n,s,a;ha(t,t.l||0);for(var i=t.length,l=0,c=0;t.l<i;){l=t.read_shift(1),l&128&&(l=(l&127)+((t.read_shift(1)&127)<<7));var u=sx[l]||sx[65535];for(n=t.read_shift(1),a=n&127,s=1;s<4&&n&128;++s)a+=((n=t.read_shift(1))&127)<<7*s;c=t.l+a;var d=u.f&&u.f(t,a,r);if(t.l=c,e(d,u,l))return}}}function Ei(){var t=[],e=Dr?256:2048,r=function(u){var d=ut(u);return ha(d,0),d},n=r(e),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},a=function(u){return n&&u<n.length-n.l?n:(s(),n=r(Math.max(u+1,e)))},i=function(){return s(),na(t)},l=function(u){s(),n=u,n.l==null&&(n.l=n.length),a(e)};return{next:a,push:l,end:i,_bufs:t}}function bt(t,e,r,n){var s=+e,a;if(!isNaN(s)){n||(n=sx[s].p||(r||[]).length||0),a=1+(s>=128?1:0)+1,n>=128&&++a,n>=16384&&++a,n>=2097152&&++a;var i=t.next(a);s<=127?i.write_shift(1,s):(i.write_shift(1,(s&127)+128),i.write_shift(1,s>>7));for(var l=0;l!=4;++l)if(n>=128)i.write_shift(1,(n&127)+128),n>>=7;else{i.write_shift(1,n);break}n>0&&$S(r)&&t.push(r)}}function tg(t,e,r){var n=Bn(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function JC(t,e,r){var n=Bn(t);return n.s=tg(n.s,e.s,r),n.e=tg(n.e,e.s,r),n}function rg(t,e){if(t.cRel&&t.c<0)for(t=Bn(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=Bn(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=vr(t);return!t.cRel&&t.cRel!=null&&(r=aX(r)),!t.rRel&&t.rRel!=null&&(r=nX(r)),r}function Tw(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+Xn(t.s.c)+":"+(t.e.cRel?"":"$")+Xn(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+Ns(t.s.r)+":"+(t.e.rRel?"":"$")+Ns(t.e.r):rg(t.s,e.biff)+":"+rg(t.e,e.biff)}function zS(t){return parseInt(sX(t),10)-1}function Ns(t){return""+(t+1)}function nX(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function sX(t){return t.replace(/\$(\d+)$/,"$1")}function qS(t){for(var e=iX(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function Xn(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function aX(t){return t.replace(/^([A-Z])/,"$$$1")}function iX(t){return t.replace(/^\$([A-Z])/,"$1")}function oX(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Qn(t){for(var e=0,r=0,n=0;n<t.length;++n){var s=t.charCodeAt(n);s>=48&&s<=57?e=10*e+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:e-1}}function vr(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function ki(t){var e=t.indexOf(":");return e==-1?{s:Qn(t),e:Qn(t)}:{s:Qn(t.slice(0,e)),e:Qn(t.slice(e+1))}}function jr(t,e){return typeof e>"u"||typeof e=="number"?jr(t.s,t.e):(typeof t!="string"&&(t=vr(t)),typeof e!="string"&&(e=vr(e)),t==e?t:t+":"+e)}function tn(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,s=0,a=t.length;for(r=0;n<a&&!((s=t.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(e.s.c=--r,r=0;n<a&&!((s=t.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;if(e.s.r=--r,n===a||s!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=a&&!((s=t.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(e.e.c=--r,r=0;n!=a&&!((s=t.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;return e.e.r=--r,e}function ZC(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=jo(t.z,r?Hs(e):e)}catch{}try{return t.w=jo((t.XF||{}).numFmtId||(r?14:0),r?Hs(e):e)}catch{return""+e}}function qc(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?Zc[t.v]||t.v:e==null?ZC(t,t.v):ZC(t,e))}function Xd(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function KD(t,e,r){var n=r||{},s=t?Array.isArray(t):n.dense,a=t||(s?[]:{}),i=0,l=0;if(a&&n.origin!=null){if(typeof n.origin=="number")i=n.origin;else{var c=typeof n.origin=="string"?Qn(n.origin):n.origin;i=c.r,l=c.c}a["!ref"]||(a["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var d=tn(a["!ref"]);u.s.c=d.s.c,u.s.r=d.s.r,u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),i==-1&&(u.e.r=i=d.e.r+1)}for(var f=0;f!=e.length;++f)if(e[f]){if(!Array.isArray(e[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var m=0;m!=e[f].length;++m)if(!(typeof e[f][m]>"u")){var h={v:e[f][m]},g=i+f,p=l+m;if(u.s.r>g&&(u.s.r=g),u.s.c>p&&(u.s.c=p),u.e.r<g&&(u.e.r=g),u.e.c<p&&(u.e.c=p),e[f][m]&&typeof e[f][m]=="object"&&!Array.isArray(e[f][m])&&!(e[f][m]instanceof Date))h=e[f][m];else if(Array.isArray(h.v)&&(h.f=e[f][m][1],h.v=h.v[0]),h.v===null)if(h.f)h.t="n";else if(n.nullError)h.t="e",h.v=0;else if(n.sheetStubs)h.t="z";else continue;else typeof h.v=="number"?h.t="n":typeof h.v=="boolean"?h.t="b":h.v instanceof Date?(h.z=n.dateNF||gr[14],n.cellDates?(h.t="d",h.w=jo(h.z,Hs(h.v))):(h.t="n",h.v=Hs(h.v),h.w=jo(h.z,h.v))):h.t="s";if(s)a[g]||(a[g]=[]),a[g][p]&&a[g][p].z&&(h.z=a[g][p].z),a[g][p]=h;else{var v=vr({c:p,r:g});a[v]&&a[v].z&&(h.z=a[v].z),a[v]=h}}}return u.s.c<1e7&&(a["!ref"]=jr(u)),a}function Fm(t,e){return KD(null,t,e)}function lX(t){return t.read_shift(4,"i")}function al(t,e){return e||(e=ut(4)),e.write_shift(4,t),e}function Ba(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function sa(t,e){var r=!1;return e==null&&(r=!0,e=ut(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function cX(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function uX(t,e){return e||(e=ut(4)),e.write_shift(2,0),e.write_shift(2,0),e}function WS(t,e){var r=t.l,n=t.read_shift(1),s=Ba(t),a=[],i={t:s,h:s};if(n&1){for(var l=t.read_shift(4),c=0;c!=l;++c)a.push(cX(t));i.r=a}else i.r=[{ich:0,ifnt:0}];return t.l=r+e,i}function dX(t,e){var r=!1;return e==null&&(r=!0,e=ut(15+4*t.t.length)),e.write_shift(1,0),sa(t.t,e),r?e.slice(0,e.l):e}var fX=WS;function hX(t,e){var r=!1;return e==null&&(r=!0,e=ut(23+4*t.t.length)),e.write_shift(1,1),sa(t.t,e),e.write_shift(4,1),uX({},e),r?e.slice(0,e.l):e}function Po(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function vh(t,e){return e==null&&(e=ut(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function bh(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function wh(t,e){return e==null&&(e=ut(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var mX=Ba,YD=sa;function HS(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function Qv(t,e){var r=!1;return e==null&&(r=!0,e=ut(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var pX=Ba,$_=HS,GS=Qv;function KS(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var s=n===0?Xv([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):Tf(e,0)>>2;return r?s/100:s}function XD(t,e){e==null&&(e=ut(4));var r=0,n=0,s=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?n=1:s==(s|0)&&s>=-536870912&&s<1<<29&&(n=1,r=1),n)e.write_shift(-4,((r?s:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function QD(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function gX(t,e){return e||(e=ut(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var _h=QD,Lm=gX;function Fa(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function lh(t,e){return(e||ut(8)).write_shift(8,t,"f")}function xX(t){var e={},r=t.read_shift(1),n=r>>>1,s=t.read_shift(1),a=t.read_shift(2,"i"),i=t.read_shift(1),l=t.read_shift(1),c=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=s;var u=Of[s];u&&(e.rgb=ex(u));break;case 2:e.rgb=ex([i,l,c]);break;case 3:e.theme=s;break}return a!=0&&(e.tint=a>0?a/32767:a/32768),e}function Jv(t,e){if(e||(e=ut(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function yX(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function vX(t,e){e||(e=ut(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}function JD(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function bX(t){return JD(t,1)}function wX(t){return JD(t,2)}var YS=2,gi=3,H1=11,ek=12,Zv=19,G1=64,_X=65,NX=71,SX=4108,TX=4126,Js=80,ZD=81,AX=[Js,ZD],z_={1:{n:"CodePage",t:YS},2:{n:"Category",t:Js},3:{n:"PresentationFormat",t:Js},4:{n:"ByteCount",t:gi},5:{n:"LineCount",t:gi},6:{n:"ParagraphCount",t:gi},7:{n:"SlideCount",t:gi},8:{n:"NoteCount",t:gi},9:{n:"HiddenCount",t:gi},10:{n:"MultimediaClipCount",t:gi},11:{n:"ScaleCrop",t:H1},12:{n:"HeadingPairs",t:SX},13:{n:"TitlesOfParts",t:TX},14:{n:"Manager",t:Js},15:{n:"Company",t:Js},16:{n:"LinksUpToDate",t:H1},17:{n:"CharacterCount",t:gi},19:{n:"SharedDoc",t:H1},22:{n:"HyperlinksChanged",t:H1},23:{n:"AppVersion",t:gi,p:"version"},24:{n:"DigSig",t:_X},26:{n:"ContentType",t:Js},27:{n:"ContentStatus",t:Js},28:{n:"Language",t:Js},29:{n:"Version",t:Js},255:{},2147483648:{n:"Locale",t:Zv},2147483651:{n:"Behavior",t:Zv},1919054434:{}},q_={1:{n:"CodePage",t:YS},2:{n:"Title",t:Js},3:{n:"Subject",t:Js},4:{n:"Author",t:Js},5:{n:"Keywords",t:Js},6:{n:"Comments",t:Js},7:{n:"Template",t:Js},8:{n:"LastAuthor",t:Js},9:{n:"RevNumber",t:Js},10:{n:"EditTime",t:G1},11:{n:"LastPrinted",t:G1},12:{n:"CreatedDate",t:G1},13:{n:"ModifiedDate",t:G1},14:{n:"PageCount",t:gi},15:{n:"WordCount",t:gi},16:{n:"CharCount",t:gi},17:{n:"Thumbnail",t:NX},18:{n:"Application",t:Js},19:{n:"DocSecurity",t:gi},255:{},2147483648:{n:"Locale",t:Zv},2147483651:{n:"Behavior",t:Zv},1919054434:{}},tk={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},EX=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function CX(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var kX=CX([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Of=Bn(kX),Zc={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},eF={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},W_={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},K1={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function XS(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function IX(t){var e=XS();if(!t||!t.match)return e;var r={};if((t.match(za)||[]).forEach(function(n){var s=_r(n);switch(s[0].replace(BY,"<")){case"<?xml":break;case"<Types":e.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":e[W_[s.ContentType]]!==void 0&&e[W_[s.ContentType]].push(s.PartName);break}}),e.xmlns!==$s.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}function tF(t,e){var r=IY(W_),n=[],s;n[n.length]=Ts,n[n.length]=Vt("Types",null,{xmlns:$s.CT,"xmlns:xsd":$s.xsd,"xmlns:xsi":$s.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return Vt("Default",null,{Extension:c[0],ContentType:c[1]})}));var a=function(c){t[c]&&t[c].length>0&&(s=t[c][0],n[n.length]=Vt("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:K1[c][e.bookType]||K1[c].xlsx}))},i=function(c){(t[c]||[]).forEach(function(u){n[n.length]=Vt("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:K1[c][e.bookType]||K1[c].xlsx})})},l=function(c){(t[c]||[]).forEach(function(u){n[n.length]=Vt("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[c][0]})})};return a("workbooks"),i("sheets"),i("charts"),l("themes"),["strs","styles"].forEach(a),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),i("metadata"),l("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Or={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Zg(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function ng(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(za)||[]).forEach(function(s){var a=_r(s);if(a[0]==="<Relationship"){var i={};i.Type=a.Type,i.Target=a.Target,i.Id=a.Id,a.TargetMode&&(i.TargetMode=a.TargetMode);var l=a.TargetMode==="External"?a.Target:Pp(a.Target,e);r[l]=i,n[a.Id]=i}}),r["!id"]=n,r}function U0(t){var e=[Ts,Vt("Relationships",null,{xmlns:$s.RELS})];return fs(t["!id"]).forEach(function(r){e[e.length]=Vt("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function mn(t,e,r,n,s,a){if(s||(s={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,s.Id="rId"+e,s.Type=n,s.Target=r,[Or.HLINK,Or.XPATH,Or.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),t["!id"][s.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][s.Id]=s,t[("/"+s.Target).replace("//","/")]=s,e}var jX="application/vnd.oasis.opendocument.spreadsheet";function PX(t,e){for(var r=BS(t),n,s;n=Jg.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(s=_r(n[0],!1),s.path=="/"&&s.type!==jX)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}function RX(t){var e=[Ts];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function rk(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function DX(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function FX(t){var e=[Ts];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(rk(t[r][0],t[r][1])),e.push(DX("",t[r][0]));return e.push(rk("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function rF(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Wv.version+"</meta:generator></office:meta></office:document-meta>"}var Co=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],LX=function(){for(var t=new Array(Co.length),e=0;e<Co.length;++e){var r=Co[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t}();function nF(t){var e={};t=wn(t);for(var r=0;r<Co.length;++r){var n=Co[r],s=t.match(LX[r]);s!=null&&s.length>0&&(e[n[1]]=en(s[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=Vn(e[n[1]]))}return e}function Aw(t,e,r,n,s){s[t]!=null||e==null||e===""||(s[t]=e,e=xn(e),n[n.length]=r?Vt(t,e,r):ma(t,e))}function sF(t,e){var r=e||{},n=[Ts,Vt("cp:coreProperties",null,{"xmlns:cp":$s.CORE_PROPS,"xmlns:dc":$s.dc,"xmlns:dcterms":$s.dcterms,"xmlns:dcmitype":$s.dcmitype,"xmlns:xsi":$s.xsi})],s={};if(!t&&!r.Props)return n.join("");t&&(t.CreatedDate!=null&&Aw("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:U_(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s),t.ModifiedDate!=null&&Aw("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:U_(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s));for(var a=0;a!=Co.length;++a){var i=Co[a],l=r.Props&&r.Props[i[1]]!=null?r.Props[i[1]]:t?t[i[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&Aw(i[0],l,null,n,s)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Mf=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],aF=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function iF(t,e,r,n){var s=[];if(typeof t=="string")s=HC(t,n);else for(var a=0;a<t.length;++a)s=s.concat(t[a].map(function(d){return{v:d}}));var i=typeof e=="string"?HC(e,n).map(function(d){return d.v}):e,l=0,c=0;if(i.length>0)for(var u=0;u!==s.length;u+=2){switch(c=+s[u+1].v,s[u].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=i.slice(l,l+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=c,r.DefinedNames=i.slice(l,l+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=i.slice(l,l+c);break}l+=c}}function OX(t,e,r){var n={};return e||(e={}),t=wn(t),Mf.forEach(function(s){var a=(t.match(Xg(s[0]))||[])[1];switch(s[2]){case"string":a&&(e[s[1]]=en(a));break;case"bool":e[s[1]]=a==="true";break;case"raw":var i=t.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));i&&i.length>0&&(n[s[1]]=i[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&iF(n.HeadingPairs,n.TitlesOfParts,e,r),e}function oF(t){var e=[],r=Vt;return t||(t={}),t.Application="SheetJS",e[e.length]=Ts,e[e.length]=Vt("Properties",null,{xmlns:$s.EXT_PROPS,"xmlns:vt":$s.vt}),Mf.forEach(function(n){if(t[n[1]]!==void 0){var s;switch(n[2]){case"string":s=xn(String(t[n[1]]));break;case"bool":s=t[n[1]]?"true":"false";break}s!==void 0&&(e[e.length]=r(n[0],s))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+xn(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var MX=/<[^>]+>[^<]*/g;function VX(t,e){var r={},n="",s=t.match(MX);if(s)for(var a=0;a!=s.length;++a){var i=s[a],l=_r(i);switch(l[0]){case"<?xml":break;case"<Properties":break;case"<property":n=en(l.name);break;case"</property>":n=null;break;default:if(i.indexOf("<vt:")===0){var c=i.split(">"),u=c[0].slice(4),d=c[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[n]=en(d);break;case"bool":r[n]=Ln(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(d);break;case"filetime":case"date":r[n]=Vn(d);break;case"cy":case"error":r[n]=en(d);break;default:if(u.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",i,u,c)}}else if(i.slice(0,2)!=="</"){if(e.WTF)throw new Error(i)}}}return r}function lF(t){var e=[Ts,Vt("Properties",null,{xmlns:$s.CUST_PROPS,"xmlns:vt":$s.vt})];if(!t)return e.join("");var r=1;return fs(t).forEach(function(s){++r,e[e.length]=Vt("property",KY(t[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:xn(s)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var H_={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Ew;function BX(t,e,r){Ew||(Ew=nb(H_)),e=Ew[e]||e,t[e]=r}function UX(t,e){var r=[];return fs(H_).map(function(n){for(var s=0;s<Co.length;++s)if(Co[s][1]==n)return Co[s];for(s=0;s<Mf.length;++s)if(Mf[s][1]==n)return Mf[s];throw n}).forEach(function(n){if(t[n[1]]!=null){var s=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:t[n[1]];switch(n[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),r.push(ma(H_[n[1]]||n[1],s))}}),Vt("DocumentProperties",r.join(""),{xmlns:$i.o})}function $X(t,e){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",s=[];return t&&fs(t).forEach(function(a){if(Object.prototype.hasOwnProperty.call(t,a)){for(var i=0;i<Co.length;++i)if(a==Co[i][1])return;for(i=0;i<Mf.length;++i)if(a==Mf[i][1])return;for(i=0;i<r.length;++i)if(a==r[i])return;var l=t[a],c="string";typeof l=="number"?(c="float",l=String(l)):l===!0||l===!1?(c="boolean",l=l?"1":"0"):l=String(l),s.push(Vt($C(a),l,{"dt:dt":c}))}}),e&&fs(e).forEach(function(a){if(Object.prototype.hasOwnProperty.call(e,a)&&!(t&&Object.prototype.hasOwnProperty.call(t,a))){var i=e[a],l="string";typeof i=="number"?(l="float",i=String(i)):i===!0||i===!1?(l="boolean",i=i?"1":"0"):i instanceof Date?(l="dateTime.tz",i=i.toISOString()):i=String(i),s.push(Vt($C(a),i,{"dt:dt":l}))}}),"<"+n+' xmlns="'+$i.o+'">'+s.join("")+"</"+n+">"}function QS(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function zX(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,n=r%Math.pow(2,32),s=(r-n)/Math.pow(2,32);n*=1e7,s*=1e7;var a=n/Math.pow(2,32)|0;a>0&&(n=n%Math.pow(2,32),s+=a);var i=ut(8);return i.write_shift(4,n),i.write_shift(4,s),i}function cF(t,e,r){var n=t.l,s=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return s}function uF(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function dF(t,e,r){return e===31?uF(t):cF(t,e,r)}function G_(t,e,r){return dF(t,e,r===!1?0:4)}function qX(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return dF(t,e,0)}function WX(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var s=t.l;r[n]=t.read_shift(0,"lpwstr").replace(si,""),t.l-s&2&&(t.l+=2)}return r}function HX(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(si,"");return r}function GX(t){var e=t.l,r=e2(t,ZD);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=e2(t,gi);return[r,n]}function KX(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(GX(t));return r}function nk(t,e){for(var r=t.read_shift(4),n={},s=0;s!=r;++s){var a=t.read_shift(4),i=t.read_shift(4);n[a]=t.read_shift(i,e===1200?"utf16le":"utf8").replace(si,"").replace(jp,"!"),e===1200&&i%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function fF(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function YX(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function e2(t,e,r){var n=t.read_shift(2),s,a=r||{};if(t.l+=2,e!==ek&&n!==e&&AX.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===ek?n:e){case 2:return s=t.read_shift(2,"i"),a.raw||(t.l+=2),s;case 3:return s=t.read_shift(4,"i"),s;case 11:return t.read_shift(4)!==0;case 19:return s=t.read_shift(4),s;case 30:return cF(t,n,4).replace(si,"");case 31:return uF(t);case 64:return QS(t);case 65:return fF(t);case 71:return YX(t);case 80:return G_(t,n,!a.raw).replace(si,"");case 81:return qX(t,n).replace(si,"");case 4108:return KX(t);case 4126:case 4127:return n==4127?WX(t):HX(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function sk(t,e){var r=ut(4),n=ut(4);switch(r.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,e);break;case 5:n=ut(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=zX(e);break;case 31:case 80:for(n=ut(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return na([r,n])}function ak(t,e){var r=t.l,n=t.read_shift(4),s=t.read_shift(4),a=[],i=0,l=0,c=-1,u={};for(i=0;i!=s;++i){var d=t.read_shift(4),f=t.read_shift(4);a[i]=[d,f+r]}a.sort(function(w,N){return w[1]-N[1]});var m={};for(i=0;i!=s;++i){if(t.l!==a[i][1]){var h=!0;if(i>0&&e)switch(e[a[i-1][0]].t){case 2:t.l+2===a[i][1]&&(t.l+=2,h=!1);break;case 80:t.l<=a[i][1]&&(t.l=a[i][1],h=!1);break;case 4108:t.l<=a[i][1]&&(t.l=a[i][1],h=!1);break}if((!e||i==0)&&t.l<=a[i][1]&&(h=!1,t.l=a[i][1]),h)throw new Error("Read Error: Expected address "+a[i][1]+" at "+t.l+" :"+i)}if(e){var g=e[a[i][0]];if(m[g.n]=e2(t,g.t,{raw:!0}),g.p==="version"&&(m[g.n]=String(m[g.n]>>16)+"."+("0000"+String(m[g.n]&65535)).slice(-4)),g.n=="CodePage")switch(m[g.n]){case 0:m[g.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Zo(l=m[g.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+m[g.n])}}else if(a[i][0]===1){if(l=m.CodePage=e2(t,YS),Zo(l),c!==-1){var p=t.l;t.l=a[c][1],u=nk(t,l),t.l=p}}else if(a[i][0]===0){if(l===0){c=i,t.l=a[i+1][1];continue}u=nk(t,l)}else{var v=u[a[i][0]],b;switch(t[t.l]){case 65:t.l+=4,b=fF(t);break;case 30:t.l+=4,b=G_(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,b=G_(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,b=t.read_shift(4,"i");break;case 19:t.l+=4,b=t.read_shift(4);break;case 5:t.l+=4,b=t.read_shift(8,"f");break;case 11:t.l+=4,b=ps(t,4);break;case 64:t.l+=4,b=Vn(QS(t));break;default:throw new Error("unparsed value: "+t[t.l])}m[v]=b}}return t.l=r+n,m}var hF=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function XX(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function ik(t,e,r){var n=ut(8),s=[],a=[],i=8,l=0,c=ut(8),u=ut(8);if(c.write_shift(4,2),c.write_shift(4,1200),u.write_shift(4,1),a.push(c),s.push(u),i+=8+c.length,!e){u=ut(8),u.write_shift(4,0),s.unshift(u);var d=[ut(4)];for(d[0].write_shift(4,t.length),l=0;l<t.length;++l){var f=t[l][0];for(c=ut(8+2*(f.length+1)+(f.length%2?0:2)),c.write_shift(4,l+2),c.write_shift(4,f.length+1),c.write_shift(0,f,"dbcs");c.l!=c.length;)c.write_shift(1,0);d.push(c)}c=na(d),a.unshift(c),i+=8+c.length}for(l=0;l<t.length;++l)if(!(e&&!e[t[l][0]])&&!(hF.indexOf(t[l][0])>-1||aF.indexOf(t[l][0])>-1)&&t[l][1]!=null){var m=t[l][1],h=0;if(e){h=+e[t[l][0]];var g=r[h];if(g.p=="version"&&typeof m=="string"){var p=m.split(".");m=(+p[0]<<16)+(+p[1]||0)}c=sk(g.t,m)}else{var v=XX(m);v==-1&&(v=31,m=String(m)),c=sk(v,m)}a.push(c),u=ut(8),u.write_shift(4,e?h:2+l),s.push(u),i+=8+c.length}var b=8*(a.length+1);for(l=0;l<a.length;++l)s[l].write_shift(4,b),b+=a[l].length;return n.write_shift(4,i),n.write_shift(4,a.length),na([n].concat(s).concat(a))}function ok(t,e,r){var n=t.content;if(!n)return{};ha(n,0);var s,a,i,l,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var u=n.read_shift(4),d=n.read_shift(16);if(d!==lr.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(s=n.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(a=n.read_shift(16),l=n.read_shift(4),s===1&&l!==n.l)throw new Error("Length mismatch: "+l+" !== "+n.l);s===2&&(i=n.read_shift(16),c=n.read_shift(4));var f=ak(n,e),m={SystemIdentifier:u};for(var h in f)m[h]=f[h];if(m.FMTID=a,s===1)return m;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);var g;try{g=ak(n,null)}catch{}for(h in g)m[h]=g[h];return m.FMTID=[a,i],m}function lk(t,e,r,n,s,a){var i=ut(s?68:48),l=[i];i.write_shift(2,65534),i.write_shift(2,0),i.write_shift(4,842412599),i.write_shift(16,lr.utils.consts.HEADER_CLSID,"hex"),i.write_shift(4,s?2:1),i.write_shift(16,e,"hex"),i.write_shift(4,s?68:48);var c=ik(t,r,n);if(l.push(c),s){var u=ik(s,null,null);i.write_shift(16,a,"hex"),i.write_shift(4,68+c.length),l.push(u)}return na(l)}function ju(t,e){return t.read_shift(e),null}function QX(t,e){e||(e=ut(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function JX(t,e,r){for(var n=[],s=t.l+e;t.l<s;)n.push(r(t,s-t.l));if(s!==t.l)throw new Error("Slurp error");return n}function ps(t,e){return t.read_shift(e)===1}function Qa(t,e){return e||(e=ut(2)),e.write_shift(2,+!!t),e}function Ds(t){return t.read_shift(2,"u")}function bo(t,e){return e||(e=ut(2)),e.write_shift(2,t),e}function mF(t,e){return JX(t,e,Ds)}function ZX(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function pF(t,e,r){return r||(r=ut(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function Ux(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var a=t.read_shift(1);a&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var i=n?t.read_shift(n,s):"";return i}function eQ(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,s=r&8,a=1+(r&1),i=0,l,c={};s&&(i=t.read_shift(2)),n&&(l=t.read_shift(4));var u=a==2?"dbcs-cont":"sbcs-cont",d=e===0?"":t.read_shift(e,u);return s&&(t.l+=4*i),n&&(t.l+=l),c.t=d,s||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function tQ(t){var e=t.t||"",r=ut(3);r.write_shift(2,e.length),r.write_shift(1,1);var n=ut(2*e.length);n.write_shift(2*e.length,e,"utf16le");var s=[r,n];return na(s)}function ch(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var s=t.read_shift(1);return s===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function $x(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):ch(t,n,r)}function Nh(t,e,r){if(r.biff>5)return $x(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function gF(t,e,r){return r||(r=ut(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function rQ(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function nQ(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var s=t.read_shift((n?e-24:e)>>1,"utf16le").replace(si,"");return n&&(t.l+=24),s}function sQ(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=t.read_shift(4);if(s===0)return r+n.replace(/\\/g,"/");var a=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var i=t.read_shift(a>>1,"utf16le").replace(si,"");return r+i}function aQ(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return nQ(t);case"0303000000000000c000000000000046":return sQ(t);default:throw new Error("Unsupported Moniker "+r)}}function Y1(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(si,""):"";return r}function ck(t,e){e||(e=ut(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function iQ(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var s=t.read_shift(2);t.l+=2;var a,i,l,c,u="",d,f;s&16&&(a=Y1(t,r-t.l)),s&128&&(i=Y1(t,r-t.l)),(s&257)===257&&(l=Y1(t,r-t.l)),(s&257)===1&&(c=aQ(t,r-t.l)),s&8&&(u=Y1(t,r-t.l)),s&32&&(d=t.read_shift(16)),s&64&&(f=QS(t)),t.l=r;var m=i||l||c||"";m&&u&&(m+="#"+u),m||(m="#"+u),s&2&&m.charAt(0)=="/"&&m.charAt(1)!="/"&&(m="file://"+m);var h={Target:m};return d&&(h.guid=d),f&&(h.time=f),a&&(h.Tooltip=a),h}function oQ(t){var e=ut(512),r=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var s=n.indexOf("#"),a=s>-1?31:23;switch(n.charAt(0)){case"#":a=28;break;case".":a&=-3;break}e.write_shift(4,2),e.write_shift(4,a);var i=[8,6815827,6619237,4849780,83];for(r=0;r<i.length;++r)e.write_shift(4,i[r]);if(a==28)n=n.slice(1),ck(n,e);else if(a&2){for(i="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<i.length;++r)e.write_shift(1,parseInt(i[r],16));var l=s>-1?n.slice(0,s):n;for(e.write_shift(4,2*(l.length+1)),r=0;r<l.length;++r)e.write_shift(2,l.charCodeAt(r));e.write_shift(2,0),a&8&&ck(s>-1?n.slice(s+1):"",e)}else{for(i="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<i.length;++r)e.write_shift(1,parseInt(i[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(e.write_shift(2,c),e.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)e.write_shift(1,n.charCodeAt(r+3*c)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function xF(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),s=t.read_shift(1);return[e,r,n,s]}function yF(t,e){var r=xF(t);return r[3]=0,r}function Gl(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function uh(t,e,r,n){return n||(n=ut(6)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r||0),n}function lQ(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function cQ(t,e,r){return e===0?"":Nh(t,e,r)}function uQ(t,e,r){var n=r.biff>8?4:2,s=t.read_shift(n),a=t.read_shift(n,"i"),i=t.read_shift(n,"i");return[s,a,i]}function vF(t){var e=t.read_shift(2),r=KS(t);return[e,r]}function dQ(t,e,r){t.l+=4,e-=4;var n=t.l+e,s=Ux(t,e,r),a=t.read_shift(2);if(n-=t.l,a!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+a);return t.l+=a,s}function ib(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2);return{s:{c:n,r:e},e:{c:s,r}}}function bF(t,e){return e||(e=ut(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function wF(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),s=t.read_shift(1);return{s:{c:n,r:e},e:{c:s,r}}}var fQ=wF;function _F(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function hQ(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function mQ(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function Na(t){t.l+=2,t.l+=t.read_shift(2)}var pQ={0:Na,4:Na,5:Na,6:Na,7:mQ,8:Na,9:Na,10:Na,11:Na,12:Na,13:hQ,14:Na,15:Na,16:Na,17:Na,18:Na,19:Na,20:Na,21:_F};function gQ(t,e){for(var r=t.l+e,n=[];t.l<r;){var s=t.read_shift(2);t.l-=2;try{n.push(pQ[s](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function X1(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function JS(t,e,r){var n=1536,s=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,s=8;break;case"biff4":n=4,s=6;break;case"biff3":n=3,s=6;break;case"biff2":n=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var a=ut(s);return a.write_shift(2,n),a.write_shift(2,e),s>4&&a.write_shift(2,29282),s>6&&a.write_shift(2,1997),s>8&&(a.write_shift(2,49161),a.write_shift(2,1),a.write_shift(2,1798),a.write_shift(2,0)),a}function xQ(t,e){return e===0||t.read_shift(2),1200}function yQ(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,s=Nh(t,0,r);return t.read_shift(e+n-t.l),s}function vQ(t,e){var r=!e||e.biff==8,n=ut(r?112:54);for(n.write_shift(e.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function bQ(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function wQ(t,e,r){var n=t.read_shift(4),s=t.read_shift(1)&3,a=t.read_shift(1);switch(a){case 0:a="Worksheet";break;case 1:a="Macrosheet";break;case 2:a="Chartsheet";break;case 6:a="VBAModule";break}var i=Ux(t,0,r);return i.length===0&&(i="Sheet1"),{pos:n,hs:s,dt:a,name:i}}function _Q(t,e){var r=!e||e.biff>=8?2:1,n=ut(8+r*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var s=n.slice(0,n.l);return s.l=n.l,s}function NQ(t,e){for(var r=t.l+e,n=t.read_shift(4),s=t.read_shift(4),a=[],i=0;i!=s&&t.l<r;++i)a.push(eQ(t));return a.Count=n,a.Unique=s,a}function SQ(t,e){var r=ut(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var n=[],s=0;s<t.length;++s)n[s]=tQ(t[s]);var a=na([r].concat(n));return a.parts=[r.length].concat(n.map(function(i){return i.length})),a}function TQ(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function AQ(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function EQ(t){var e=lQ(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function CQ(t){return t.read_shift(2),t.read_shift(4)}function uk(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var s=t.read_shift(2);r&&r.biff==2&&(n=1-(s>>15),s&=32767);var a={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[a,s]}function kQ(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),i=t.read_shift(2),l=t.read_shift(2),c=t.read_shift(2),u=t.read_shift(2);return{Pos:[e,r],Dim:[n,s],Flags:a,CurTab:i,FirstTab:l,Selected:c,TabRatio:u}}function IQ(){var t=ut(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function jQ(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function PQ(t){var e=ut(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function RQ(){}function DQ(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=Ux(t,0,r),n}function FQ(t,e){var r=t.name||"Arial",n=e&&e.biff==5,s=n?15+r.length:16+2*r.length,a=ut(s);return a.write_shift(2,t.sz*20),a.write_shift(4,0),a.write_shift(2,400),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(1,r.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),a}function LQ(t){var e=Gl(t);return e.isst=t.read_shift(4),e}function OQ(t,e,r,n){var s=ut(10);return uh(t,e,n,s),s.write_shift(4,r),s}function MQ(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,s=Gl(t);r.biff==2&&t.l++;var a=$x(t,n-t.l,r);return s.val=a,s}function VQ(t,e,r,n,s){var a=!s||s.biff==8,i=ut(8+ +a+(1+a)*r.length);return uh(t,e,n,i),i.write_shift(2,r.length),a&&i.write_shift(1,1),i.write_shift((1+a)*r.length,r,a?"utf16le":"sbcs"),i}function BQ(t,e,r){var n=t.read_shift(2),s=Nh(t,0,r);return[n,s]}function UQ(t,e,r,n){var s=r&&r.biff==5;n||(n=ut(s?3+e.length:5+2*e.length)),n.write_shift(2,t),n.write_shift(s?1:2,e.length),s||n.write_shift(1,1),n.write_shift((s?1:2)*e.length,e,s?"sbcs":"utf16le");var a=n.length>n.l?n.slice(0,n.l):n;return a.l==null&&(a.l=a.length),a}var $Q=Nh;function dk(t,e,r){var n=t.l+e,s=r.biff==8||!r.biff?4:2,a=t.read_shift(s),i=t.read_shift(s),l=t.read_shift(2),c=t.read_shift(2);return t.l=n,{s:{r:a,c:l},e:{r:i,c}}}function zQ(t,e){var r=e.biff==8||!e.biff?4:2,n=ut(2*r+6);return n.write_shift(r,t.s.r),n.write_shift(r,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function qQ(t){var e=t.read_shift(2),r=t.read_shift(2),n=vF(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function WQ(t,e){for(var r=t.l+e-2,n=t.read_shift(2),s=t.read_shift(2),a=[];t.l<r;)a.push(vF(t));if(t.l!==r)throw new Error("MulRK read error");var i=t.read_shift(2);if(a.length!=i-s+1)throw new Error("MulRK length mismatch");return{r:n,c:s,C:i,rkrec:a}}function HQ(t,e){for(var r=t.l+e-2,n=t.read_shift(2),s=t.read_shift(2),a=[];t.l<r;)a.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var i=t.read_shift(2);if(a.length!=i-s+1)throw new Error("MulBlank length mismatch");return{r:n,c:s,C:i,ixfe:a}}function GQ(t,e,r,n){var s={},a=t.read_shift(4),i=t.read_shift(4),l=t.read_shift(4),c=t.read_shift(2);return s.patternType=EX[l>>26],n.cellStyles&&(s.alc=a&7,s.fWrap=a>>3&1,s.alcV=a>>4&7,s.fJustLast=a>>7&1,s.trot=a>>8&255,s.cIndent=a>>16&15,s.fShrinkToFit=a>>20&1,s.iReadOrder=a>>22&2,s.fAtrNum=a>>26&1,s.fAtrFnt=a>>27&1,s.fAtrAlc=a>>28&1,s.fAtrBdr=a>>29&1,s.fAtrPat=a>>30&1,s.fAtrProt=a>>31&1,s.dgLeft=i&15,s.dgRight=i>>4&15,s.dgTop=i>>8&15,s.dgBottom=i>>12&15,s.icvLeft=i>>16&127,s.icvRight=i>>23&127,s.grbitDiag=i>>30&3,s.icvTop=l&127,s.icvBottom=l>>7&127,s.icvDiag=l>>14&127,s.dgDiag=l>>21&15,s.icvFore=c&127,s.icvBack=c>>7&127,s.fsxButton=c>>14&1),s}function KQ(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=GQ(t,e,n.fStyle,r),n}function fk(t,e,r,n){var s=r&&r.biff==5;n||(n=ut(s?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,e<<4));var a=0;return t.numFmtId>0&&s&&(a|=1024),n.write_shift(4,a),n.write_shift(4,0),s||n.write_shift(4,0),n.write_shift(2,0),n}function YQ(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function XQ(t){var e=ut(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function hk(t,e,r){var n=Gl(t);(r.biff==2||e==9)&&++t.l;var s=ZX(t);return n.val=s,n.t=s===!0||s===!1?"b":"e",n}function QQ(t,e,r,n,s,a){var i=ut(8);return uh(t,e,n,i),pF(r,a,i),i}function JQ(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Gl(t),s=Fa(t);return n.val=s,n}function ZQ(t,e,r,n){var s=ut(14);return uh(t,e,n,s),lh(r,s),s}var mk=cQ;function eJ(t,e,r){var n=t.l+e,s=t.read_shift(2),a=t.read_shift(2);if(r.sbcch=a,a==1025||a==14849)return[a,s];if(a<1||a>255)throw new Error("Unexpected SupBook type: "+a);for(var i=ch(t,a),l=[];n>t.l;)l.push($x(t));return[a,s,i,l]}function pk(t,e,r){var n=t.read_shift(2),s,a={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(s=dQ(t,e-2,r)),a.body=s||t.read_shift(e-2),typeof s=="string"&&(a.Name=s),a}var tJ=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function gk(t,e,r){var n=t.l+e,s=t.read_shift(2),a=t.read_shift(1),i=t.read_shift(1),l=t.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),c=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var u=ch(t,i,r);s&32&&(u=tJ[u.charCodeAt(0)]);var d=n-t.l;r&&r.biff==2&&--d;var f=n==t.l||l===0||!(d>0)?[]:gre(t,d,r,l);return{chKey:a,Name:u,itab:c,rgce:f}}function NF(t,e,r){if(r.biff<8)return rJ(t,e,r);for(var n=[],s=t.l+e,a=t.read_shift(r.biff>8?4:2);a--!==0;)n.push(uQ(t,r.biff>8?12:6,r));if(t.l!=s)throw new Error("Bad ExternSheet: "+t.l+" != "+s);return n}function rJ(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=Ux(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function nJ(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),s=t.read_shift(2),a=ch(t,n,r),i=ch(t,s,r);return[a,i]}function sJ(t,e,r){var n=wF(t);t.l++;var s=t.read_shift(1);return e-=8,[xre(t,e,r),s,n]}function xk(t,e,r){var n=fQ(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,mre(t,e,r)]}function aJ(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function iJ(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),i=t.read_shift(2),l=Nh(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:s},l,i,a]}}function oJ(t,e,r){return iJ(t,e,r)}function lJ(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(ib(t));return r}function cJ(t){var e=ut(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)bF(t[r],e);return e}function uJ(t,e,r){if(r&&r.biff<8)return fJ(t,e,r);var n=_F(t),s=gQ(t,e-22,n[1]);return{cmo:n,ft:s}}var dJ={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var s=t.read_shift(1);return t.l+=s,t.l=r,{fmt:n}}};function fJ(t,e,r){t.l+=4;var n=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var i=[];return i.push((dJ[n]||$a)(t,e,r)),{cmo:[s,n,a],ft:i}}function hJ(t,e,r){var n=t.l,s="";try{t.l+=4;var a=(r.lastobj||{cmo:[0,0]}).cmo[1],i;[0,5,7,11,12,14].indexOf(a)==-1?t.l+=6:i=rQ(t,6,r);var l=t.read_shift(2);t.read_shift(2),Ds(t,2);var c=t.read_shift(2);t.l+=c;for(var u=1;u<t.lens.length-1;++u){if(t.l-n!=t.lens[u])throw new Error("TxO: bad continue record");var d=t[t.l],f=ch(t,t.lens[u+1]-t.lens[u]-1);if(s+=f,s.length>=(d?l:2*l))break}if(s.length!==l&&s.length!==l*2)throw new Error("cchText: "+l+" != "+s.length);return t.l=n+e,{t:s}}catch{return t.l=n+e,{t:s}}}function mJ(t,e){var r=ib(t);t.l+=16;var n=iQ(t,e-24);return[r,n]}function pJ(t){var e=ut(24),r=Qn(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)e.write_shift(1,parseInt(n[s],16));return na([e,oQ(t[1])])}function gJ(t,e){t.read_shift(2);var r=ib(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(si,""),[r,n]}function xJ(t){var e=t[1].Tooltip,r=ut(10+2*(e.length+1));r.write_shift(2,2048);var n=Qn(t[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var s=0;s<e.length;++s)r.write_shift(2,e.charCodeAt(s));return r.write_shift(2,0),r}function yJ(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=tk[r]||r,r=t.read_shift(2),e[1]=tk[r]||r,e}function vJ(t){return t||(t=ut(4)),t.write_shift(2,1),t.write_shift(2,1),t}function bJ(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(yF(t));return r}function wJ(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(yF(t));return r}function _J(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function SF(t,e,r){if(!r.cellStyles)return $a(t,e);var n=r&&r.biff>=12?4:2,s=t.read_shift(n),a=t.read_shift(n),i=t.read_shift(n),l=t.read_shift(n),c=t.read_shift(2);n==2&&(t.l+=2);var u={s,e:a,w:i,ixfe:l,flags:c};return(r.biff>=5||!r.biff)&&(u.level=c>>8&7),u}function NJ(t,e){var r=ut(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var n=0;return t.hidden&&(n|=1),r.write_shift(1,n),n=t.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function SJ(t,e){var r={};return e<32||(t.l+=16,r.header=Fa(t),r.footer=Fa(t),t.l+=2),r}function TJ(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var s=t.read_shift(1);return t.l+=3,s&16&&(n.area=!0),n}function AJ(t){for(var e=ut(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}var EJ=Gl,CJ=mF,kJ=$x;function IJ(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),s={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,s}function jJ(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Gl(t);++t.l;var s=Nh(t,e-7,r);return n.t="str",n.val=s,n}function PJ(t){var e=Gl(t);++t.l;var r=Fa(t);return e.t="n",e.val=r,e}function RJ(t,e,r){var n=ut(15);return Hx(n,t,e),n.write_shift(8,r,"f"),n}function DJ(t){var e=Gl(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function FJ(t,e,r){var n=ut(9);return Hx(n,t,e),n.write_shift(2,r),n}function LJ(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function OJ(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function MJ(t,e,r){var n=t.l+e,s=Gl(t),a=t.read_shift(2),i=ch(t,a,r);return t.l=n,s.t="str",s.val=i,s}var VJ=[2,3,48,49,131,139,140,245],K_=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=nb({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,c){var u=[],d=jd(1);switch(c.type){case"base64":d=qi(ro(l));break;case"binary":d=qi(l);break;case"buffer":case"array":d=l;break}ha(d,0);var f=d.read_shift(1),m=!!(f&136),h=!1,g=!1;switch(f){case 2:break;case 3:break;case 48:h=!0,m=!0;break;case 49:h=!0,m=!0;break;case 131:break;case 139:break;case 140:g=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var p=0,v=521;f==2&&(p=d.read_shift(2)),d.l+=3,f!=2&&(p=d.read_shift(4)),p>1048576&&(p=1e6),f!=2&&(v=d.read_shift(2));var b=d.read_shift(2),w=c.codepage||1252;f!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(w=t[d[d.l]]),d.l+=1,d.l+=2),g&&(d.l+=36);for(var N=[],j={},F=Math.min(d.length,f==2?521:v-10-(h?264:0)),U=g?32:11;d.l<F&&d[d.l]!=13;)switch(j={},j.name=B_.utils.decode(w,d.slice(d.l,d.l+U)).replace(/[\u0000\r\n].*$/g,""),d.l+=U,j.type=String.fromCharCode(d.read_shift(1)),f!=2&&!g&&(j.offset=d.read_shift(4)),j.len=d.read_shift(1),f==2&&(j.offset=d.read_shift(2)),j.dec=d.read_shift(1),j.name.length&&N.push(j),f!=2&&(d.l+=g?13:14),j.type){case"B":(!h||j.len!=8)&&c.WTF&&console.log("Skipping "+j.name+":"+j.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+j.name+":"+j.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+j.type)}if(d[d.l]!==13&&(d.l=v-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=v;var A=0,S=0;for(u[0]=[],S=0;S!=N.length;++S)u[0][S]=N[S].name;for(;p-- >0;){if(d[d.l]===42){d.l+=b;continue}for(++d.l,u[++A]=[],S=0,S=0;S!=N.length;++S){var k=d.slice(d.l,d.l+N[S].len);d.l+=N[S].len,ha(k,0);var M=B_.utils.decode(w,k);switch(N[S].type){case"C":M.trim().length&&(u[A][S]=M.replace(/\s+$/,""));break;case"D":M.length===8?u[A][S]=new Date(+M.slice(0,4),+M.slice(4,6)-1,+M.slice(6,8)):u[A][S]=M;break;case"F":u[A][S]=parseFloat(M.trim());break;case"+":case"I":u[A][S]=g?k.read_shift(-4,"i")^2147483648:k.read_shift(4,"i");break;case"L":switch(M.trim().toUpperCase()){case"Y":case"T":u[A][S]=!0;break;case"N":case"F":u[A][S]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+M+"|")}break;case"M":if(!m)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));u[A][S]="##MEMO##"+(g?parseInt(M.trim(),10):k.read_shift(4));break;case"N":M=M.replace(/\u0000/g,"").trim(),M&&M!="."&&(u[A][S]=+M||0);break;case"@":u[A][S]=new Date(k.read_shift(-8,"f")-621356832e5);break;case"T":u[A][S]=new Date((k.read_shift(4)-2440588)*864e5+k.read_shift(4));break;case"Y":u[A][S]=k.read_shift(4,"i")/1e4+k.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[A][S]=-k.read_shift(-8,"f");break;case"B":if(h&&N[S].len==8){u[A][S]=k.read_shift(8,"f");break}case"G":case"P":k.l+=N[S].len;break;case"0":if(N[S].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+N[S].type)}}}if(f!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return c&&c.sheetRows&&(u=u.slice(0,c.sheetRows)),c.DBF=N,u}function n(l,c){var u=c||{};u.dateNF||(u.dateNF="yyyymmdd");var d=Fm(r(l,u),u);return d["!cols"]=u.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete u.DBF,d}function s(l,c){try{return Xd(n(l,c),c)}catch(u){if(c&&c.WTF)throw u}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function i(l,c){var u=c||{};if(+u.codepage>=0&&Zo(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var d=Ei(),f=n2(l,{header:1,raw:!0,cellDates:!0}),m=f[0],h=f.slice(1),g=l["!cols"]||[],p=0,v=0,b=0,w=1;for(p=0;p<m.length;++p){if(((g[p]||{}).DBF||{}).name){m[p]=g[p].DBF.name,++b;continue}if(m[p]!=null){if(++b,typeof m[p]=="number"&&(m[p]=m[p].toString(10)),typeof m[p]!="string")throw new Error("DBF Invalid column name "+m[p]+" |"+typeof m[p]+"|");if(m.indexOf(m[p])!==p){for(v=0;v<1024;++v)if(m.indexOf(m[p]+"_"+v)==-1){m[p]+="_"+v;break}}}}var N=tn(l["!ref"]),j=[],F=[],U=[];for(p=0;p<=N.e.c-N.s.c;++p){var A="",S="",k=0,M=[];for(v=0;v<h.length;++v)h[v][p]!=null&&M.push(h[v][p]);if(M.length==0||m[p]==null){j[p]="?";continue}for(v=0;v<M.length;++v){switch(typeof M[v]){case"number":S="B";break;case"string":S="C";break;case"boolean":S="L";break;case"object":S=M[v]instanceof Date?"D":"C";break;default:S="C"}k=Math.max(k,String(M[v]).length),A=A&&A!=S?"C":S}k>250&&(k=250),S=((g[p]||{}).DBF||{}).type,S=="C"&&g[p].DBF.len>k&&(k=g[p].DBF.len),A=="B"&&S=="N"&&(A="N",U[p]=g[p].DBF.dec,k=g[p].DBF.len),F[p]=A=="C"||S=="N"?k:a[A]||0,w+=F[p],j[p]=A}var I=d.next(32);for(I.write_shift(4,318902576),I.write_shift(4,h.length),I.write_shift(2,296+32*b),I.write_shift(2,w),p=0;p<4;++p)I.write_shift(4,0);for(I.write_shift(4,0|(+e[hD]||3)<<8),p=0,v=0;p<m.length;++p)if(m[p]!=null){var E=d.next(32),D=(m[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);E.write_shift(1,D,"sbcs"),E.write_shift(1,j[p]=="?"?"C":j[p],"sbcs"),E.write_shift(4,v),E.write_shift(1,F[p]||a[j[p]]||0),E.write_shift(1,U[p]||0),E.write_shift(1,2),E.write_shift(4,0),E.write_shift(1,0),E.write_shift(4,0),E.write_shift(4,0),v+=F[p]||a[j[p]]||0}var G=d.next(264);for(G.write_shift(4,13),p=0;p<65;++p)G.write_shift(4,0);for(p=0;p<h.length;++p){var Z=d.next(w);for(Z.write_shift(1,0),v=0;v<m.length;++v)if(m[v]!=null)switch(j[v]){case"L":Z.write_shift(1,h[p][v]==null?63:h[p][v]?84:70);break;case"B":Z.write_shift(8,h[p][v]||0,"f");break;case"N":var ae="0";for(typeof h[p][v]=="number"&&(ae=h[p][v].toFixed(U[v]||0)),b=0;b<F[v]-ae.length;++b)Z.write_shift(1,32);Z.write_shift(1,ae,"sbcs");break;case"D":h[p][v]?(Z.write_shift(4,("0000"+h[p][v].getFullYear()).slice(-4),"sbcs"),Z.write_shift(2,("00"+(h[p][v].getMonth()+1)).slice(-2),"sbcs"),Z.write_shift(2,("00"+h[p][v].getDate()).slice(-2),"sbcs")):Z.write_shift(8,"00000000","sbcs");break;case"C":var de=String(h[p][v]!=null?h[p][v]:"").slice(0,F[v]);for(Z.write_shift(1,de,"sbcs"),b=0;b<F[v]-de.length;++b)Z.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:s,to_sheet:n,from_sheet:i}}(),TF=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+fs(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(m,h){var g=t[h];return typeof g=="number"?CC(g):g},n=function(m,h,g){var p=h.charCodeAt(0)-32<<4|g.charCodeAt(0)-48;return p==59?m:CC(p)};t["|"]=254;function s(m,h){switch(h.type){case"base64":return a(ro(m),h);case"binary":return a(m,h);case"buffer":return a(Dr&&Buffer.isBuffer(m)?m.toString("binary"):Yd(m),h);case"array":return a(oh(m),h)}throw new Error("Unrecognized type "+h.type)}function a(m,h){var g=m.split(/[\n\r]+/),p=-1,v=-1,b=0,w=0,N=[],j=[],F=null,U={},A=[],S=[],k=[],M=0,I;for(+h.codepage>=0&&Zo(+h.codepage);b!==g.length;++b){M=0;var E=g[b].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),D=E.replace(/;;/g,"\0").split(";").map(function(H){return H.replace(/\u0000/g,";")}),G=D[0],Z;if(E.length>0)switch(G){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":D[1].charAt(0)=="P"&&j.push(E.slice(3).replace(/;;/g,";"));break;case"C":var ae=!1,de=!1,se=!1,Y=!1,ye=-1,re=-1;for(w=1;w<D.length;++w)switch(D[w].charAt(0)){case"A":break;case"X":v=parseInt(D[w].slice(1))-1,de=!0;break;case"Y":for(p=parseInt(D[w].slice(1))-1,de||(v=0),I=N.length;I<=p;++I)N[I]=[];break;case"K":Z=D[w].slice(1),Z.charAt(0)==='"'?Z=Z.slice(1,Z.length-1):Z==="TRUE"?Z=!0:Z==="FALSE"?Z=!1:isNaN(sl(Z))?isNaN(ym(Z).getDate())||(Z=Vn(Z)):(Z=sl(Z),F!==null&&Rm(F)&&(Z=ab(Z))),ae=!0;break;case"E":Y=!0;var C=$0(D[w].slice(1),{r:p,c:v});N[p][v]=[N[p][v],C];break;case"S":se=!0,N[p][v]=[N[p][v],"S5S"];break;case"G":break;case"R":ye=parseInt(D[w].slice(1))-1;break;case"C":re=parseInt(D[w].slice(1))-1;break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+E)}if(ae&&(N[p][v]&&N[p][v].length==2?N[p][v][0]=Z:N[p][v]=Z,F=null),se){if(Y)throw new Error("SYLK shared formula cannot have own formula");var O=ye>-1&&N[ye][re];if(!O||!O[1])throw new Error("SYLK shared formula cannot find base");N[p][v][1]=zF(O[1],{r:p-ye,c:v-re})}break;case"F":var L=0;for(w=1;w<D.length;++w)switch(D[w].charAt(0)){case"X":v=parseInt(D[w].slice(1))-1,++L;break;case"Y":for(p=parseInt(D[w].slice(1))-1,I=N.length;I<=p;++I)N[I]=[];break;case"M":M=parseInt(D[w].slice(1))/20;break;case"F":break;case"G":break;case"P":F=j[parseInt(D[w].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(k=D[w].slice(1).split(" "),I=parseInt(k[0],10);I<=parseInt(k[1],10);++I)M=parseInt(k[2],10),S[I-1]=M===0?{hidden:!0}:{wch:M},Pd(S[I-1]);break;case"C":v=parseInt(D[w].slice(1))-1,S[v]||(S[v]={});break;case"R":p=parseInt(D[w].slice(1))-1,A[p]||(A[p]={}),M>0?(A[p].hpt=M,A[p].hpx=bm(M)):M===0&&(A[p].hidden=!0);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+E)}L<1&&(F=null);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+E)}}return A.length>0&&(U["!rows"]=A),S.length>0&&(U["!cols"]=S),h&&h.sheetRows&&(N=N.slice(0,h.sheetRows)),[N,U]}function i(m,h){var g=s(m,h),p=g[0],v=g[1],b=Fm(p,h);return fs(v).forEach(function(w){b[w]=v[w]}),b}function l(m,h){return Xd(i(m,h),h)}function c(m,h,g,p){var v="C;Y"+(g+1)+";X"+(p+1)+";K";switch(m.t){case"n":v+=m.v||0,m.f&&!m.F&&(v+=";E"+s3(m.f,{r:g,c:p}));break;case"b":v+=m.v?"TRUE":"FALSE";break;case"e":v+=m.w||m.v;break;case"d":v+='"'+(m.w||m.v)+'"';break;case"s":v+='"'+m.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return v}function u(m,h){h.forEach(function(g,p){var v="F;W"+(p+1)+" "+(p+1)+" ";g.hidden?v+="0":(typeof g.width=="number"&&!g.wpx&&(g.wpx=tx(g.width)),typeof g.wpx=="number"&&!g.wch&&(g.wch=rx(g.wpx)),typeof g.wch=="number"&&(v+=Math.round(g.wch))),v.charAt(v.length-1)!=" "&&m.push(v)})}function d(m,h){h.forEach(function(g,p){var v="F;";g.hidden?v+="M0;":g.hpt?v+="M"+20*g.hpt+";":g.hpx&&(v+="M"+20*nx(g.hpx)+";"),v.length>2&&m.push(v+"R"+(p+1))})}function f(m,h){var g=["ID;PWXL;N;E"],p=[],v=tn(m["!ref"]),b,w=Array.isArray(m),N=`\r
`;g.push("P;PGeneral"),g.push("F;P0;DG0G8;M255"),m["!cols"]&&u(g,m["!cols"]),m["!rows"]&&d(g,m["!rows"]),g.push("B;Y"+(v.e.r-v.s.r+1)+";X"+(v.e.c-v.s.c+1)+";D"+[v.s.c,v.s.r,v.e.c,v.e.r].join(" "));for(var j=v.s.r;j<=v.e.r;++j)for(var F=v.s.c;F<=v.e.c;++F){var U=vr({r:j,c:F});b=w?(m[j]||[])[F]:m[U],!(!b||b.v==null&&(!b.f||b.F))&&p.push(c(b,m,j,F))}return g.join(N)+N+p.join(N)+N+"E"+N}return{to_workbook:l,to_sheet:i,from_sheet:f}}(),AF=function(){function t(a,i){switch(i.type){case"base64":return e(ro(a),i);case"binary":return e(a,i);case"buffer":return e(Dr&&Buffer.isBuffer(a)?a.toString("binary"):Yd(a),i);case"array":return e(oh(a),i)}throw new Error("Unrecognized type "+i.type)}function e(a,i){for(var l=a.split(`
`),c=-1,u=-1,d=0,f=[];d!==l.length;++d){if(l[d].trim()==="BOT"){f[++c]=[],u=0;continue}if(!(c<0)){var m=l[d].trim().split(","),h=m[0],g=m[1];++d;for(var p=l[d]||"";(p.match(/["]/g)||[]).length&1&&d<l.length-1;)p+=`
`+l[++d];switch(p=p.trim(),+h){case-1:if(p==="BOT"){f[++c]=[],u=0;continue}else if(p!=="EOD")throw new Error("Unrecognized DIF special command "+p);break;case 0:p==="TRUE"?f[c][u]=!0:p==="FALSE"?f[c][u]=!1:isNaN(sl(g))?isNaN(ym(g).getDate())?f[c][u]=g:f[c][u]=Vn(g):f[c][u]=sl(g),++u;break;case 1:p=p.slice(1,p.length-1),p=p.replace(/""/g,'"'),p&&p.match(/^=".*"$/)&&(p=p.slice(2,-1)),f[c][u++]=p!==""?p:null;break}if(p==="EOD")break}}return i&&i.sheetRows&&(f=f.slice(0,i.sheetRows)),f}function r(a,i){return Fm(t(a,i),i)}function n(a,i){return Xd(r(a,i),i)}var s=function(){var a=function(c,u,d,f,m){c.push(u),c.push(d+","+f),c.push('"'+m.replace(/"/g,'""')+'"')},i=function(c,u,d,f){c.push(u+","+d),c.push(u==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(c){var u=[],d=tn(c["!ref"]),f,m=Array.isArray(c);a(u,"TABLE",0,1,"sheetjs"),a(u,"VECTORS",0,d.e.r-d.s.r+1,""),a(u,"TUPLES",0,d.e.c-d.s.c+1,""),a(u,"DATA",0,0,"");for(var h=d.s.r;h<=d.e.r;++h){i(u,-1,0,"BOT");for(var g=d.s.c;g<=d.e.c;++g){var p=vr({r:h,c:g});if(f=m?(c[h]||[])[g]:c[p],!f){i(u,1,0,"");continue}switch(f.t){case"n":var v=f.w;!v&&f.v!=null&&(v=f.v),v==null?f.f&&!f.F?i(u,1,0,"="+f.f):i(u,1,0,""):i(u,0,v,"V");break;case"b":i(u,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":i(u,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=jo(f.z||gr[14],Hs(Vn(f.v)))),i(u,0,f.w,"V");break;default:i(u,1,0,"")}}}i(u,-1,0,"EOD");var b=`\r
`,w=u.join(b);return w}}();return{to_workbook:n,to_sheet:r,from_sheet:s}}(),EF=function(){function t(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,m){for(var h=f.split(`
`),g=-1,p=-1,v=0,b=[];v!==h.length;++v){var w=h[v].trim().split(":");if(w[0]==="cell"){var N=Qn(w[1]);if(b.length<=N.r)for(g=b.length;g<=N.r;++g)b[g]||(b[g]=[]);switch(g=N.r,p=N.c,w[2]){case"t":b[g][p]=t(w[3]);break;case"v":b[g][p]=+w[3];break;case"vtf":var j=w[w.length-1];case"vtc":switch(w[3]){case"nl":b[g][p]=!!+w[4];break;default:b[g][p]=+w[4];break}w[2]=="vtf"&&(b[g][p]=[b[g][p],j])}}}return m&&m.sheetRows&&(b=b.slice(0,m.sheetRows)),b}function n(f,m){return Fm(r(f,m),m)}function s(f,m){return Xd(n(f,m),m)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function u(f){if(!f||!f["!ref"])return"";for(var m=[],h=[],g,p="",v=ki(f["!ref"]),b=Array.isArray(f),w=v.s.r;w<=v.e.r;++w)for(var N=v.s.c;N<=v.e.c;++N)if(p=vr({r:w,c:N}),g=b?(f[w]||[])[N]:f[p],!(!g||g.v==null||g.t==="z")){switch(h=["cell",p,"t"],g.t){case"s":case"str":h.push(e(g.v));break;case"n":g.f?(h[2]="vtf",h[3]="n",h[4]=g.v,h[5]=e(g.f)):(h[2]="v",h[3]=g.v);break;case"b":h[2]="vt"+(g.f?"f":"c"),h[3]="nl",h[4]=g.v?"1":"0",h[5]=e(g.f||(g.v?"TRUE":"FALSE"));break;case"d":var j=Hs(Vn(g.v));h[2]="vtc",h[3]="nd",h[4]=""+j,h[5]=g.w||jo(g.z||gr[14],j);break;case"e":continue}m.push(h.join(":"))}return m.push("sheet:c:"+(v.e.c-v.s.c+1)+":r:"+(v.e.r-v.s.r+1)+":tvf:1"),m.push("valueformat:1:text-wiki"),m.join(`
`)}function d(f){return[a,i,l,i,u(f),c].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:d}}(),vm=function(){function t(d,f,m,h,g){g.raw?f[m][h]=d:d===""||(d==="TRUE"?f[m][h]=!0:d==="FALSE"?f[m][h]=!1:isNaN(sl(d))?isNaN(ym(d).getDate())?f[m][h]=d:f[m][h]=Vn(d):f[m][h]=sl(d))}function e(d,f){var m=f||{},h=[];if(!d||d.length===0)return h;for(var g=d.split(/[\r\n]/),p=g.length-1;p>=0&&g[p].length===0;)--p;for(var v=10,b=0,w=0;w<=p;++w)b=g[w].indexOf(" "),b==-1?b=g[w].length:b++,v=Math.max(v,b);for(w=0;w<=p;++w){h[w]=[];var N=0;for(t(g[w].slice(0,v).trim(),h,w,N,m),N=1;N<=(g[w].length-v)/10+1;++N)t(g[w].slice(v+(N-1)*10,v+N*10).trim(),h,w,N,m)}return m.sheetRows&&(h=h.slice(0,m.sheetRows)),h}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(d){for(var f={},m=!1,h=0,g=0;h<d.length;++h)(g=d.charCodeAt(h))==34?m=!m:!m&&g in r&&(f[g]=(f[g]||0)+1);g=[];for(h in f)Object.prototype.hasOwnProperty.call(f,h)&&g.push([f[h],h]);if(!g.length){f=n;for(h in f)Object.prototype.hasOwnProperty.call(f,h)&&g.push([f[h],h])}return g.sort(function(p,v){return p[0]-v[0]||n[p[1]]-n[v[1]]}),r[g.pop()[1]]||44}function a(d,f){var m=f||{},h="",g=m.dense?[]:{},p={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(h=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(h=d.charAt(4),d=d.slice(6)):h=s(d.slice(0,1024)):m&&m.FS?h=m.FS:h=s(d.slice(0,1024));var v=0,b=0,w=0,N=0,j=0,F=h.charCodeAt(0),U=!1,A=0,S=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var k=m.dateNF!=null?TY(m.dateNF):null;function M(){var I=d.slice(N,j),E={};if(I.charAt(0)=='"'&&I.charAt(I.length-1)=='"'&&(I=I.slice(1,-1).replace(/""/g,'"')),I.length===0)E.t="z";else if(m.raw)E.t="s",E.v=I;else if(I.trim().length===0)E.t="s",E.v=I;else if(I.charCodeAt(0)==61)I.charCodeAt(1)==34&&I.charCodeAt(I.length-1)==34?(E.t="s",E.v=I.slice(2,-1).replace(/""/g,'"')):ete(I)?(E.t="n",E.f=I.slice(1)):(E.t="s",E.v=I);else if(I=="TRUE")E.t="b",E.v=!0;else if(I=="FALSE")E.t="b",E.v=!1;else if(!isNaN(w=sl(I)))E.t="n",m.cellText!==!1&&(E.w=I),E.v=w;else if(!isNaN(ym(I).getDate())||k&&I.match(k)){E.z=m.dateNF||gr[14];var D=0;k&&I.match(k)&&(I=AY(I,m.dateNF,I.match(k)||[]),D=1),m.cellDates?(E.t="d",E.v=Vn(I,D)):(E.t="n",E.v=Hs(Vn(I,D))),m.cellText!==!1&&(E.w=jo(E.z,E.v instanceof Date?Hs(E.v):E.v)),m.cellNF||delete E.z}else E.t="s",E.v=I;if(E.t=="z"||(m.dense?(g[v]||(g[v]=[]),g[v][b]=E):g[vr({c:b,r:v})]=E),N=j+1,S=d.charCodeAt(N),p.e.c<b&&(p.e.c=b),p.e.r<v&&(p.e.r=v),A==F)++b;else if(b=0,++v,m.sheetRows&&m.sheetRows<=v)return!0}e:for(;j<d.length;++j)switch(A=d.charCodeAt(j)){case 34:S===34&&(U=!U);break;case F:case 10:case 13:if(!U&&M())break e;break}return j-N>0&&M(),g["!ref"]=jr(p),g}function i(d,f){return!(f&&f.PRN)||f.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?a(d,f):Fm(e(d,f),f)}function l(d,f){var m="",h=f.type=="string"?[0,0,0,0]:f3(d,f);switch(f.type){case"base64":m=ro(d);break;case"binary":m=d;break;case"buffer":f.codepage==65001?m=d.toString("utf8"):(f.codepage,m=Dr&&Buffer.isBuffer(d)?d.toString("binary"):Yd(d));break;case"array":m=oh(d);break;case"string":m=d;break;default:throw new Error("Unrecognized type "+f.type)}return h[0]==239&&h[1]==187&&h[2]==191?m=wn(m.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?m=wn(m):f.type=="binary",m.slice(0,19)=="socialcalc:version:"?EF.to_sheet(f.type=="string"?m:wn(m),f):i(m,f)}function c(d,f){return Xd(l(d,f),f)}function u(d){for(var f=[],m=tn(d["!ref"]),h,g=Array.isArray(d),p=m.s.r;p<=m.e.r;++p){for(var v=[],b=m.s.c;b<=m.e.c;++b){var w=vr({r:p,c:b});if(h=g?(d[p]||[])[b]:d[w],!h||h.v==null){v.push("          ");continue}for(var N=(h.w||(qc(h),h.w)||"").slice(0,10);N.length<10;)N+=" ";v.push(N+(b===0?" ":""))}f.push(v.join(""))}return f.join(`
`)}return{to_workbook:c,to_sheet:l,from_sheet:u}}();function BJ(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var s=TF.to_workbook(t,r);return r.WTF=n,s}catch(a){if(r.WTF=n,!a.message.match(/SYLK bad record ID/)&&n)throw a;return vm.to_workbook(t,e)}}var Vf=function(){function t(C,O,L){if(C){ha(C,C.l||0);for(var H=L.Enum||ye;C.l<C.length;){var K=C.read_shift(2),q=H[K]||H[65535],te=C.read_shift(2),oe=C.l+te,V=q.f&&q.f(C,te,L);if(C.l=oe,O(V,q,K))return}}}function e(C,O){switch(O.type){case"base64":return r(qi(ro(C)),O);case"binary":return r(qi(C),O);case"buffer":case"array":return r(C,O)}throw"Unsupported type "+O.type}function r(C,O){if(!C)return C;var L=O||{},H=L.dense?[]:{},K="Sheet1",q="",te=0,oe={},V=[],xe=[],B={s:{r:0,c:0},e:{r:0,c:0}},Ee=L.sheetRows||0;if(C[2]==0&&(C[3]==8||C[3]==9)&&C.length>=16&&C[14]==5&&C[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(C[2]==2)L.Enum=ye,t(C,function(qe,ct,lt){switch(lt){case 0:L.vers=qe,qe>=4096&&(L.qpro=!0);break;case 6:B=qe;break;case 204:qe&&(q=qe);break;case 222:q=qe;break;case 15:case 51:L.qpro||(qe[1].v=qe[1].v.slice(1));case 13:case 14:case 16:lt==14&&(qe[2]&112)==112&&(qe[2]&15)>1&&(qe[2]&15)<15&&(qe[1].z=L.dateNF||gr[14],L.cellDates&&(qe[1].t="d",qe[1].v=ab(qe[1].v))),L.qpro&&qe[3]>te&&(H["!ref"]=jr(B),oe[K]=H,V.push(K),H=L.dense?[]:{},B={s:{r:0,c:0},e:{r:0,c:0}},te=qe[3],K=q||"Sheet"+(te+1),q="");var ue=L.dense?(H[qe[0].r]||[])[qe[0].c]:H[vr(qe[0])];if(ue){ue.t=qe[1].t,ue.v=qe[1].v,qe[1].z!=null&&(ue.z=qe[1].z),qe[1].f!=null&&(ue.f=qe[1].f);break}L.dense?(H[qe[0].r]||(H[qe[0].r]=[]),H[qe[0].r][qe[0].c]=qe[1]):H[vr(qe[0])]=qe[1];break}},L);else if(C[2]==26||C[2]==14)L.Enum=re,C[2]==14&&(L.qpro=!0,C.l=0),t(C,function(qe,ct,lt){switch(lt){case 204:K=qe;break;case 22:qe[1].v=qe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(qe[3]>te&&(H["!ref"]=jr(B),oe[K]=H,V.push(K),H=L.dense?[]:{},B={s:{r:0,c:0},e:{r:0,c:0}},te=qe[3],K="Sheet"+(te+1)),Ee>0&&qe[0].r>=Ee)break;L.dense?(H[qe[0].r]||(H[qe[0].r]=[]),H[qe[0].r][qe[0].c]=qe[1]):H[vr(qe[0])]=qe[1],B.e.c<qe[0].c&&(B.e.c=qe[0].c),B.e.r<qe[0].r&&(B.e.r=qe[0].r);break;case 27:qe[14e3]&&(xe[qe[14e3][0]]=qe[14e3][1]);break;case 1537:xe[qe[0]]=qe[1],qe[0]==te&&(K=qe[1]);break}},L);else throw new Error("Unrecognized LOTUS BOF "+C[2]);if(H["!ref"]=jr(B),oe[q||K]=H,V.push(q||K),!xe.length)return{SheetNames:V,Sheets:oe};for(var Me={},Ie=[],he=0;he<xe.length;++he)oe[V[he]]?(Ie.push(xe[he]||V[he]),Me[xe[he]]=oe[xe[he]]||oe[V[he]]):(Ie.push(xe[he]),Me[xe[he]]={"!ref":"A1"});return{SheetNames:Ie,Sheets:Me}}function n(C,O){var L=O||{};if(+L.codepage>=0&&Zo(+L.codepage),L.type=="string")throw new Error("Cannot write WK1 to JS string");var H=Ei(),K=tn(C["!ref"]),q=Array.isArray(C),te=[];Ut(H,0,a(1030)),Ut(H,6,c(K));for(var oe=Math.min(K.e.r,8191),V=K.s.r;V<=oe;++V)for(var xe=Ns(V),B=K.s.c;B<=K.e.c;++B){V===K.s.r&&(te[B]=Xn(B));var Ee=te[B]+xe,Me=q?(C[V]||[])[B]:C[Ee];if(!(!Me||Me.t=="z"))if(Me.t=="n")(Me.v|0)==Me.v&&Me.v>=-32768&&Me.v<=32767?Ut(H,13,h(V,B,Me.v)):Ut(H,14,p(V,B,Me.v));else{var Ie=qc(Me);Ut(H,15,f(V,B,Ie.slice(0,239)))}}return Ut(H,1),H.end()}function s(C,O){var L=O||{};if(+L.codepage>=0&&Zo(+L.codepage),L.type=="string")throw new Error("Cannot write WK3 to JS string");var H=Ei();Ut(H,0,i(C));for(var K=0,q=0;K<C.SheetNames.length;++K)(C.Sheets[C.SheetNames[K]]||{})["!ref"]&&Ut(H,27,Y(C.SheetNames[K],q++));var te=0;for(K=0;K<C.SheetNames.length;++K){var oe=C.Sheets[C.SheetNames[K]];if(!(!oe||!oe["!ref"])){for(var V=tn(oe["!ref"]),xe=Array.isArray(oe),B=[],Ee=Math.min(V.e.r,8191),Me=V.s.r;Me<=Ee;++Me)for(var Ie=Ns(Me),he=V.s.c;he<=V.e.c;++he){Me===V.s.r&&(B[he]=Xn(he));var qe=B[he]+Ie,ct=xe?(oe[Me]||[])[he]:oe[qe];if(!(!ct||ct.t=="z"))if(ct.t=="n")Ut(H,23,M(Me,he,te,ct.v));else{var lt=qc(ct);Ut(H,22,A(Me,he,te,lt.slice(0,239)))}}++te}}return Ut(H,1),H.end()}function a(C){var O=ut(2);return O.write_shift(2,C),O}function i(C){var O=ut(26);O.write_shift(2,4096),O.write_shift(2,4),O.write_shift(4,0);for(var L=0,H=0,K=0,q=0;q<C.SheetNames.length;++q){var te=C.SheetNames[q],oe=C.Sheets[te];if(!(!oe||!oe["!ref"])){++K;var V=ki(oe["!ref"]);L<V.e.r&&(L=V.e.r),H<V.e.c&&(H=V.e.c)}}return L>8191&&(L=8191),O.write_shift(2,L),O.write_shift(1,K),O.write_shift(1,H),O.write_shift(2,0),O.write_shift(2,0),O.write_shift(1,1),O.write_shift(1,2),O.write_shift(4,0),O.write_shift(4,0),O}function l(C,O,L){var H={s:{c:0,r:0},e:{c:0,r:0}};return O==8&&L.qpro?(H.s.c=C.read_shift(1),C.l++,H.s.r=C.read_shift(2),H.e.c=C.read_shift(1),C.l++,H.e.r=C.read_shift(2),H):(H.s.c=C.read_shift(2),H.s.r=C.read_shift(2),O==12&&L.qpro&&(C.l+=2),H.e.c=C.read_shift(2),H.e.r=C.read_shift(2),O==12&&L.qpro&&(C.l+=2),H.s.c==65535&&(H.s.c=H.e.c=H.s.r=H.e.r=0),H)}function c(C){var O=ut(8);return O.write_shift(2,C.s.c),O.write_shift(2,C.s.r),O.write_shift(2,C.e.c),O.write_shift(2,C.e.r),O}function u(C,O,L){var H=[{c:0,r:0},{t:"n",v:0},0,0];return L.qpro&&L.vers!=20768?(H[0].c=C.read_shift(1),H[3]=C.read_shift(1),H[0].r=C.read_shift(2),C.l+=2):(H[2]=C.read_shift(1),H[0].c=C.read_shift(2),H[0].r=C.read_shift(2)),H}function d(C,O,L){var H=C.l+O,K=u(C,O,L);if(K[1].t="s",L.vers==20768){C.l++;var q=C.read_shift(1);return K[1].v=C.read_shift(q,"utf8"),K}return L.qpro&&C.l++,K[1].v=C.read_shift(H-C.l,"cstr"),K}function f(C,O,L){var H=ut(7+L.length);H.write_shift(1,255),H.write_shift(2,O),H.write_shift(2,C),H.write_shift(1,39);for(var K=0;K<H.length;++K){var q=L.charCodeAt(K);H.write_shift(1,q>=128?95:q)}return H.write_shift(1,0),H}function m(C,O,L){var H=u(C,O,L);return H[1].v=C.read_shift(2,"i"),H}function h(C,O,L){var H=ut(7);return H.write_shift(1,255),H.write_shift(2,O),H.write_shift(2,C),H.write_shift(2,L,"i"),H}function g(C,O,L){var H=u(C,O,L);return H[1].v=C.read_shift(8,"f"),H}function p(C,O,L){var H=ut(13);return H.write_shift(1,255),H.write_shift(2,O),H.write_shift(2,C),H.write_shift(8,L,"f"),H}function v(C,O,L){var H=C.l+O,K=u(C,O,L);if(K[1].v=C.read_shift(8,"f"),L.qpro)C.l=H;else{var q=C.read_shift(2);j(C.slice(C.l,C.l+q),K),C.l+=q}return K}function b(C,O,L){var H=O&32768;return O&=-32769,O=(H?C:0)+(O>=8192?O-16384:O),(H?"":"$")+(L?Xn(O):Ns(O))}var w={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},N=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function j(C,O){ha(C,0);for(var L=[],H=0,K="",q="",te="",oe="";C.l<C.length;){var V=C[C.l++];switch(V){case 0:L.push(C.read_shift(8,"f"));break;case 1:q=b(O[0].c,C.read_shift(2),!0),K=b(O[0].r,C.read_shift(2),!1),L.push(q+K);break;case 2:{var xe=b(O[0].c,C.read_shift(2),!0),B=b(O[0].r,C.read_shift(2),!1);q=b(O[0].c,C.read_shift(2),!0),K=b(O[0].r,C.read_shift(2),!1),L.push(xe+B+":"+q+K)}break;case 3:if(C.l<C.length){console.error("WK1 premature formula end");return}break;case 4:L.push("("+L.pop()+")");break;case 5:L.push(C.read_shift(2));break;case 6:{for(var Ee="";V=C[C.l++];)Ee+=String.fromCharCode(V);L.push('"'+Ee.replace(/"/g,'""')+'"')}break;case 8:L.push("-"+L.pop());break;case 23:L.push("+"+L.pop());break;case 22:L.push("NOT("+L.pop()+")");break;case 20:case 21:oe=L.pop(),te=L.pop(),L.push(["AND","OR"][V-20]+"("+te+","+oe+")");break;default:if(V<32&&N[V])oe=L.pop(),te=L.pop(),L.push(te+N[V]+oe);else if(w[V]){if(H=w[V][1],H==69&&(H=C[C.l++]),H>L.length){console.error("WK1 bad formula parse 0x"+V.toString(16)+":|"+L.join("|")+"|");return}var Me=L.slice(-H);L.length-=H,L.push(w[V][0]+"("+Me.join(",")+")")}else return V<=7?console.error("WK1 invalid opcode "+V.toString(16)):V<=24?console.error("WK1 unsupported op "+V.toString(16)):V<=30?console.error("WK1 invalid opcode "+V.toString(16)):V<=115?console.error("WK1 unsupported function opcode "+V.toString(16)):console.error("WK1 unrecognized opcode "+V.toString(16))}}L.length==1?O[1].f=""+L[0]:console.error("WK1 bad formula parse |"+L.join("|")+"|")}function F(C){var O=[{c:0,r:0},{t:"n",v:0},0];return O[0].r=C.read_shift(2),O[3]=C[C.l++],O[0].c=C[C.l++],O}function U(C,O){var L=F(C);return L[1].t="s",L[1].v=C.read_shift(O-4,"cstr"),L}function A(C,O,L,H){var K=ut(6+H.length);K.write_shift(2,C),K.write_shift(1,L),K.write_shift(1,O),K.write_shift(1,39);for(var q=0;q<H.length;++q){var te=H.charCodeAt(q);K.write_shift(1,te>=128?95:te)}return K.write_shift(1,0),K}function S(C,O){var L=F(C);L[1].v=C.read_shift(2);var H=L[1].v>>1;if(L[1].v&1)switch(H&7){case 0:H=(H>>3)*5e3;break;case 1:H=(H>>3)*500;break;case 2:H=(H>>3)/20;break;case 3:H=(H>>3)/200;break;case 4:H=(H>>3)/2e3;break;case 5:H=(H>>3)/2e4;break;case 6:H=(H>>3)/16;break;case 7:H=(H>>3)/64;break}return L[1].v=H,L}function k(C,O){var L=F(C),H=C.read_shift(4),K=C.read_shift(4),q=C.read_shift(2);if(q==65535)return H===0&&K===3221225472?(L[1].t="e",L[1].v=15):H===0&&K===3489660928?(L[1].t="e",L[1].v=42):L[1].v=0,L;var te=q&32768;return q=(q&32767)-16446,L[1].v=(1-te*2)*(K*Math.pow(2,q+32)+H*Math.pow(2,q)),L}function M(C,O,L,H){var K=ut(14);if(K.write_shift(2,C),K.write_shift(1,L),K.write_shift(1,O),H==0)return K.write_shift(4,0),K.write_shift(4,0),K.write_shift(2,65535),K;var q=0,te=0,oe=0,V=0;return H<0&&(q=1,H=-H),te=Math.log2(H)|0,H/=Math.pow(2,te-31),V=H>>>0,V&2147483648||(H/=2,++te,V=H>>>0),H-=V,V|=2147483648,V>>>=0,H*=Math.pow(2,32),oe=H>>>0,K.write_shift(4,oe),K.write_shift(4,V),te+=16383+(q?32768:0),K.write_shift(2,te),K}function I(C,O){var L=k(C);return C.l+=O-14,L}function E(C,O){var L=F(C),H=C.read_shift(4);return L[1].v=H>>6,L}function D(C,O){var L=F(C),H=C.read_shift(8,"f");return L[1].v=H,L}function G(C,O){var L=D(C);return C.l+=O-10,L}function Z(C,O){return C[C.l+O-1]==0?C.read_shift(O,"cstr"):""}function ae(C,O){var L=C[C.l++];L>O-1&&(L=O-1);for(var H="";H.length<L;)H+=String.fromCharCode(C[C.l++]);return H}function de(C,O,L){if(!(!L.qpro||O<21)){var H=C.read_shift(1);C.l+=17,C.l+=1,C.l+=2;var K=C.read_shift(O-21,"cstr");return[H,K]}}function se(C,O){for(var L={},H=C.l+O;C.l<H;){var K=C.read_shift(2);if(K==14e3){for(L[K]=[0,""],L[K][0]=C.read_shift(2);C[C.l];)L[K][1]+=String.fromCharCode(C[C.l]),C.l++;C.l++}}return L}function Y(C,O){var L=ut(5+C.length);L.write_shift(2,14e3),L.write_shift(2,O);for(var H=0;H<C.length;++H){var K=C.charCodeAt(H);L[L.l++]=K>127?95:K}return L[L.l++]=0,L}var ye={0:{n:"BOF",f:Ds},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:m},14:{n:"NUMBER",f:g},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:v},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Z},222:{n:"SHEETNAMELP",f:ae},65535:{n:""}},re={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:U},23:{n:"NUMBER17",f:k},24:{n:"NUMBER18",f:S},25:{n:"FORMULA19",f:I},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:se},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:E},38:{n:"??"},39:{n:"NUMBER27",f:D},40:{n:"FORMULA28",f:G},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Z},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:de},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:e}}();function UJ(t){var e={},r=t.match(za),n=0,s=!1;if(r)for(;n!=r.length;++n){var a=_r(r[n]);switch(a[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!a.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(a.val=="1")break;e.cp=kS[parseInt(a.val,10)];break;case"<outline":if(!a.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=a.val;break;case"<sz":e.sz=a.val;break;case"<strike":if(!a.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!a.val)break;switch(a.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(a.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(a.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":a.rgb&&(e.color=a.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=a.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=a.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+a[0])}}return e}var $J=function(){var t=Xg("t"),e=Xg("rPr");function r(a){var i=a.match(t);if(!i)return{t:"s",v:""};var l={t:"s",v:en(i[1])},c=a.match(e);return c&&(l.s=UJ(c[1])),l}var n=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(i){return i.replace(n,"").split(s).map(r).filter(function(l){return l.v})}}(),zJ=function(){var e=/(\r\n|\n)/g;function r(s,a,i){var l=[];s.u&&l.push("text-decoration: underline;"),s.uval&&l.push("text-underline-style:"+s.uval+";"),s.sz&&l.push("font-size:"+s.sz+"pt;"),s.outline&&l.push("text-effect: outline;"),s.shadow&&l.push("text-shadow: auto;"),a.push('<span style="'+l.join("")+'">'),s.b&&(a.push("<b>"),i.push("</b>")),s.i&&(a.push("<i>"),i.push("</i>")),s.strike&&(a.push("<s>"),i.push("</s>"));var c=s.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(a.push("<"+c+">"),i.push("</"+c+">")),i.push("</span>"),s}function n(s){var a=[[],s.v,[]];return s.v?(s.s&&r(s.s,a[0],a[2]),a[0].join("")+a[1].replace(e,"<br/>")+a[2].join("")):""}return function(a){return a.map(n).join("")}}(),qJ=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,WJ=/<(?:\w+:)?r>/,HJ=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function ZS(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=en(wn(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=wn(t),r&&(n.h=VS(n.t))):t.match(WJ)&&(n.r=wn(t),n.t=en(wn((t.replace(HJ,"").match(qJ)||[]).join("").replace(za,""))),r&&(n.h=zJ($J(n.r)))),n):{t:""}}var GJ=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,KJ=/<(?:\w+:)?(?:si|sstItem)>/g,YJ=/<\/(?:\w+:)?(?:si|sstItem)>/;function XJ(t,e){var r=[],n="";if(!t)return r;var s=t.match(GJ);if(s){n=s[2].replace(KJ,"").split(YJ);for(var a=0;a!=n.length;++a){var i=ZS(n[a].trim(),e);i!=null&&(r[r.length]=i)}s=_r(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}var QJ=/^\s|\s$|[\t\n\r]/;function CF(t,e){if(!e.bookSST)return"";var r=[Ts];r[r.length]=Vt("sst",null,{xmlns:yh[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var s=t[n],a="<si>";s.r?a+=s.r:(a+="<t",s.t||(s.t=""),s.t.match(QJ)&&(a+=' xml:space="preserve"'),a+=">"+xn(s.t)+"</t>"),a+="</si>",r[r.length]=a}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function JJ(t){return[t.read_shift(4),t.read_shift(4)]}function ZJ(t,e){var r=[],n=!1;return Jc(t,function(a,i,l){switch(l){case 159:r.Count=a[0],r.Unique=a[1];break;case 19:r.push(a);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(i.T,!n||e.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),r}function eZ(t,e){return e||(e=ut(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var tZ=dX;function rZ(t){var e=Ei();bt(e,159,eZ(t));for(var r=0;r<t.length;++r)bt(e,19,tZ(t[r]));return bt(e,160),e.end()}function kF(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function Pc(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function nZ(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=Pc(t,4),e.U=Pc(t,4),e.W=Pc(t,4),e}function sZ(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},s=t.read_shift(4),a=[];s-- >0;)a.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=a,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function aZ(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(sZ(t));return e}function iZ(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function oZ(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=Pc(t,4),e.U=Pc(t,4),e.W=Pc(t,4),e}function lZ(t){var e=oZ(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function IF(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var s=!1;switch(n.AlgID){case 26126:case 26127:case 26128:s=n.Flags==36;break;case 26625:s=n.Flags==4;break;case 0:s=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function jF(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function cZ(t){var e=Pc(t);switch(e.Minor){case 2:return[e.Minor,uZ(t)];case 3:return[e.Minor,dZ()];case 4:return[e.Minor,fZ(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function uZ(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=IF(t,r),s=jF(t,t.length-t.l);return{t:"Std",h:n,v:s}}function dZ(){throw new Error("File is password-protected: ECMA-376 Extensible")}function fZ(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(za,function(a){var i=_r(a);switch(Hl(i[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(l){n[l]=i[l]});break;case"<dataIntegrity":n.encryptedHmacKey=i.encryptedHmacKey,n.encryptedHmacValue=i.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=i.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(i);break;default:throw i[0]}}),n}function hZ(t,e){var r={},n=r.EncryptionVersionInfo=Pc(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var s=t.read_shift(4);return e-=4,r.EncryptionHeader=IF(t,s),e-=s,r.EncryptionVerifier=jF(t,e),r}function mZ(t){var e={},r=e.EncryptionVersionInfo=Pc(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function e3(t){var e=0,r,n=kF(t),s=n.length+1,a,i,l,c,u;for(r=jd(s),r[0]=n.length,a=1;a!=s;++a)r[a]=n[a-1];for(a=s-1;a>=0;--a)i=r[a],l=e&16384?1:0,c=e<<1&32767,u=l|c,e=u^i;return e^52811}var PF=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(i){return(i/2|i*128)&255},s=function(i,l){return n(i^l)},a=function(i){for(var l=e[i.length-1],c=104,u=i.length-1;u>=0;--u)for(var d=i[u],f=0;f!=7;++f)d&64&&(l^=r[c]),d*=2,--c;return l};return function(i){for(var l=kF(i),c=a(l),u=l.length,d=jd(16),f=0;f!=16;++f)d[f]=0;var m,h,g;for((u&1)===1&&(m=c>>8,d[u]=s(t[0],m),--u,m=c&255,h=l[l.length-1],d[u]=s(h,m));u>0;)--u,m=c>>8,d[u]=s(l[u],m),--u,m=c&255,d[u]=s(l[u],m);for(u=15,g=15-l.length;g>0;)m=c>>8,d[u]=s(t[g],m),--u,--g,m=c&255,d[u]=s(l[u],m),--u,--g;return d}}(),pZ=function(t,e,r,n,s){s||(s=e),n||(n=PF(t));var a,i;for(a=0;a!=e.length;++a)i=e[a],i^=n[r],i=(i>>5|i<<3)&255,s[a]=i,++r;return[s,r,n]},gZ=function(t){var e=0,r=PF(t);return function(n){var s=pZ("",n,e,r);return e=s[1],s[0]}};function xZ(t,e,r,n){var s={key:Ds(t),verificationBytes:Ds(t)};return r.password&&(s.verifier=e3(r.password)),n.valid=s.verificationBytes===s.verifier,n.valid&&(n.insitu=gZ(r.password)),s}function yZ(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=mZ(t):n.Data=hZ(t,e),n}function vZ(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?yZ(t,e-2,n):xZ(t,r.biff>=8?e:e-2,r,n),n}var RF=function(){function t(s,a){switch(a.type){case"base64":return e(ro(s),a);case"binary":return e(s,a);case"buffer":return e(Dr&&Buffer.isBuffer(s)?s.toString("binary"):Yd(s),a);case"array":return e(oh(s),a)}throw new Error("Unrecognized type "+a.type)}function e(s,a){var i=a||{},l=i.dense?[]:{},c=s.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(d,f){Array.isArray(l)&&(l[f]=[]);for(var m=/\\\w+\b/g,h=0,g,p=-1;g=m.exec(d);){switch(g[0]){case"\\cell":var v=d.slice(h,m.lastIndex-g[0].length);if(v[0]==" "&&(v=v.slice(1)),++p,v.length){var b={v,t:"s"};Array.isArray(l)?l[f][p]=b:l[vr({r:f,c:p})]=b}break}h=m.lastIndex}p>u.e.c&&(u.e.c=p)}),l["!ref"]=jr(u),l}function r(s,a){return Xd(t(s,a),a)}function n(s){for(var a=["{\\rtf1\\ansi"],i=tn(s["!ref"]),l,c=Array.isArray(s),u=i.s.r;u<=i.e.r;++u){a.push("\\trowd\\trautofit1");for(var d=i.s.c;d<=i.e.c;++d)a.push("\\cellx"+(d+1));for(a.push("\\pard\\intbl"),d=i.s.c;d<=i.e.c;++d){var f=vr({r:u,c:d});l=c?(s[u]||[])[d]:s[f],!(!l||l.v==null&&(!l.f||l.F))&&(a.push(" "+(l.w||(qc(l),l.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function bZ(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function ex(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function wZ(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,s=Math.max(e,r,n),a=Math.min(e,r,n),i=s-a;if(i===0)return[0,0,e];var l=0,c=0,u=s+a;switch(c=i/(u>1?2-u:u),s){case e:l=((r-n)/i+6)%6;break;case r:l=(n-e)/i+2;break;case n:l=(e-r)/i+4;break}return[l/6,c,u/2]}function _Z(t){var e=t[0],r=t[1],n=t[2],s=r*2*(n<.5?n:1-n),a=n-s/2,i=[a,a,a],l=6*e,c;if(r!==0)switch(l|0){case 0:case 6:c=s*l,i[0]+=s,i[1]+=c;break;case 1:c=s*(2-l),i[0]+=c,i[1]+=s;break;case 2:c=s*(l-2),i[1]+=s,i[2]+=c;break;case 3:c=s*(4-l),i[1]+=c,i[2]+=s;break;case 4:c=s*(l-4),i[2]+=s,i[0]+=c;break;case 5:c=s*(6-l),i[2]+=c,i[0]+=s;break}for(var u=0;u!=3;++u)i[u]=Math.round(i[u]*255);return i}function t2(t,e){if(e===0)return t;var r=wZ(bZ(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),ex(_Z(r))}var DF=6,NZ=15,SZ=1,Ra=DF;function tx(t){return Math.floor((t+Math.round(128/Ra)/256)*Ra)}function rx(t){return Math.floor((t-5)/Ra*100+.5)/100}function r2(t){return Math.round((t*Ra+5)/Ra*256)/256}function Cw(t){return r2(rx(tx(t)))}function t3(t){var e=Math.abs(t-Cw(t)),r=Ra;if(e>.005)for(Ra=SZ;Ra<NZ;++Ra)Math.abs(t-Cw(t))<=e&&(e=Math.abs(t-Cw(t)),r=Ra);Ra=r}function Pd(t){t.width?(t.wpx=tx(t.width),t.wch=rx(t.wpx),t.MDW=Ra):t.wpx?(t.wch=rx(t.wpx),t.width=r2(t.wch),t.MDW=Ra):typeof t.wch=="number"&&(t.width=r2(t.wch),t.wpx=tx(t.width),t.MDW=Ra),t.customWidth&&delete t.customWidth}var TZ=96,FF=TZ;function nx(t){return t*96/FF}function bm(t){return t*FF/96}var AZ={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function EZ(t,e,r,n){e.Borders=[];var s={},a=!1;(t[0].match(za)||[]).forEach(function(i){var l=_r(i);switch(Hl(l[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},l.diagonalUp&&(s.diagonalUp=Ln(l.diagonalUp)),l.diagonalDown&&(s.diagonalDown=Ln(l.diagonalDown)),e.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+l[0]+" in borders")}})}function CZ(t,e,r,n){e.Fills=[];var s={},a=!1;(t[0].match(za)||[]).forEach(function(i){var l=_r(i);switch(Hl(l[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},e.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":l.patternType&&(s.patternType=l.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),l.indexed&&(s.bgColor.indexed=parseInt(l.indexed,10)),l.theme&&(s.bgColor.theme=parseInt(l.theme,10)),l.tint&&(s.bgColor.tint=parseFloat(l.tint)),l.rgb&&(s.bgColor.rgb=l.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),l.theme&&(s.fgColor.theme=parseInt(l.theme,10)),l.tint&&(s.fgColor.tint=parseFloat(l.tint)),l.rgb!=null&&(s.fgColor.rgb=l.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+l[0]+" in fills")}})}function kZ(t,e,r,n){e.Fonts=[];var s={},a=!1;(t[0].match(za)||[]).forEach(function(i){var l=_r(i);switch(Hl(l[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(s),s={};break;case"<name":l.val&&(s.name=wn(l.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=l.val?Ln(l.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=l.val?Ln(l.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(l.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=l.val?Ln(l.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=l.val?Ln(l.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=l.val?Ln(l.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=l.val?Ln(l.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=l.val?Ln(l.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":l.val&&(s.sz=+l.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":l.val&&(s.vertAlign=l.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":l.val&&(s.family=parseInt(l.val,10));break;case"<family/>":case"</family>":break;case"<scheme":l.val&&(s.scheme=l.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(l.val=="1")break;l.codepage=kS[parseInt(l.val,10)];break;case"<color":if(s.color||(s.color={}),l.auto&&(s.color.auto=Ln(l.auto)),l.rgb)s.color.rgb=l.rgb.slice(-6);else if(l.indexed){s.color.index=parseInt(l.indexed,10);var c=Of[s.color.index];s.color.index==81&&(c=Of[1]),c||(c=Of[1]),s.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else l.theme&&(s.color.theme=parseInt(l.theme,10),l.tint&&(s.color.tint=parseFloat(l.tint)),l.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=t2(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+l[0]+" in fonts")}})}function IZ(t,e,r){e.NumberFmt=[];for(var n=fs(gr),s=0;s<n.length;++s)e.NumberFmt[n[s]]=gr[n[s]];var a=t[0].match(za);if(a)for(s=0;s<a.length;++s){var i=_r(a[s]);switch(Hl(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var l=en(wn(i.formatCode)),c=parseInt(i.numFmtId,10);if(e.NumberFmt[c]=l,c>0){if(c>392){for(c=392;c>60&&e.NumberFmt[c]!=null;--c);e.NumberFmt[c]=l}jc(l,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}function jZ(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)t[n]!=null&&(e[e.length]=Vt("numFmt",null,{numFmtId:n,formatCode:xn(t[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=Vt("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var Q1=["numFmtId","fillId","fontId","borderId","xfId"],J1=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function PZ(t,e,r){e.CellXf=[];var n,s=!1;(t[0].match(za)||[]).forEach(function(a){var i=_r(a),l=0;switch(Hl(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=i,delete n[0],l=0;l<Q1.length;++l)n[Q1[l]]&&(n[Q1[l]]=parseInt(n[Q1[l]],10));for(l=0;l<J1.length;++l)n[J1[l]]&&(n[J1[l]]=Ln(n[J1[l]]));if(e.NumberFmt&&n.numFmtId>392){for(l=392;l>60;--l)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[l]){n.numFmtId=l;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};i.vertical&&(c.vertical=i.vertical),i.horizontal&&(c.horizontal=i.horizontal),i.textRotation!=null&&(c.textRotation=i.textRotation),i.indent&&(c.indent=i.indent),i.wrapText&&(c.wrapText=Ln(i.wrapText)),n.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+i[0]+" in cellXfs")}})}function RZ(t){var e=[];return e[e.length]=Vt("cellXfs",null),t.forEach(function(r){e[e.length]=Vt("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=Vt("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var DZ=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(l,c,u){var d={};if(!l)return d;l=l.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=l.match(e))&&IZ(f,d,u),(f=l.match(s))&&kZ(f,d,c,u),(f=l.match(n))&&CZ(f,d,c,u),(f=l.match(a))&&EZ(f,d,c,u),(f=l.match(r))&&PZ(f,d,u),d}}();function LF(t,e){var r=[Ts,Vt("styleSheet",null,{xmlns:yh[0],"xmlns:vt":$s.vt})],n;return t.SSF&&(n=jZ(t.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=RZ(e.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function FZ(t,e){var r=t.read_shift(2),n=Ba(t);return[r,n]}function LZ(t,e,r){r||(r=ut(6+4*e.length)),r.write_shift(2,t),sa(e,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function OZ(t,e,r){var n={};n.sz=t.read_shift(2)/20;var s=yX(t);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var a=t.read_shift(2);switch(a===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var i=t.read_shift(1);i!=0&&(n.underline=i);var l=t.read_shift(1);l>0&&(n.family=l);var c=t.read_shift(1);switch(c>0&&(n.charset=c),t.l++,n.color=xX(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Ba(t),n}function MZ(t,e){e||(e=ut(25+4*32)),e.write_shift(2,t.sz*20),vX(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),Jv(t.color,e);var n=0;return n=2,e.write_shift(1,n),sa(t.name,e),e.length>e.l?e.slice(0,e.l):e}var VZ=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],kw,BZ=$a;function yk(t,e){e||(e=ut(4*3+8*7+16*1)),kw||(kw=nb(VZ));var r=kw[t.patternType];r==null&&(r=40),e.write_shift(4,r);var n=0;if(r!=40)for(Jv({auto:1},e),Jv({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function UZ(t,e){var r=t.l+e,n=t.read_shift(2),s=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:s}}function OF(t,e,r){r||(r=ut(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function pp(t,e){return e||(e=ut(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var $Z=$a;function zZ(t,e){return e||(e=ut(51)),e.write_shift(1,0),pp(null,e),pp(null,e),pp(null,e),pp(null,e),pp(null,e),e.length>e.l?e.slice(0,e.l):e}function qZ(t,e){return e||(e=ut(12+4*10)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),Qv(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function WZ(t,e,r){var n=ut(2052);return n.write_shift(4,t),Qv(e,n),Qv(r,n),n.length>n.l?n.slice(0,n.l):n}function HZ(t,e,r){var n={};n.NumberFmt=[];for(var s in gr)n.NumberFmt[s]=gr[s];n.CellXf=[],n.Fonts=[];var a=[],i=!1;return Jc(t,function(c,u,d){switch(d){case 44:n.NumberFmt[c[0]]=c[1],jc(c[1],c[0]);break;case 43:n.Fonts.push(c),c.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(c.color.rgb=t2(e.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:a[a.length-1]==617&&n.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:a.push(d),i=!0;break;case 38:a.pop(),i=!1;break;default:if(u.T>0)a.push(d);else if(u.T<0)a.pop();else if(!i||r.WTF&&a[a.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),n}function GZ(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)e[s]!=null&&++r}),r!=0&&(bt(t,615,al(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)e[s]!=null&&bt(t,44,LZ(s,e[s]))}),bt(t,616))}}function KZ(t){var e=1;bt(t,611,al(e)),bt(t,43,MZ({sz:12,color:{theme:1},name:"Calibri",family:2})),bt(t,612)}function YZ(t){var e=2;bt(t,603,al(e)),bt(t,45,yk({patternType:"none"})),bt(t,45,yk({patternType:"gray125"})),bt(t,604)}function XZ(t){var e=1;bt(t,613,al(e)),bt(t,46,zZ()),bt(t,614)}function QZ(t){var e=1;bt(t,626,al(e)),bt(t,47,OF({numFmtId:0},65535)),bt(t,627)}function JZ(t,e){bt(t,617,al(e.length)),e.forEach(function(r){bt(t,47,OF(r,0))}),bt(t,618)}function ZZ(t){var e=1;bt(t,619,al(e)),bt(t,48,qZ({xfId:0,name:"Normal"})),bt(t,620)}function eee(t){var e=0;bt(t,505,al(e)),bt(t,506)}function tee(t){var e=0;bt(t,508,WZ(e,"TableStyleMedium9","PivotStyleMedium4")),bt(t,509)}function ree(t,e){var r=Ei();return bt(r,278),GZ(r,t.SSF),KZ(r),YZ(r),XZ(r),QZ(r),JZ(r,e.cellXfs),ZZ(r),eee(r),tee(r),bt(r,279),r.end()}var nee=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function see(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(za)||[]).forEach(function(s){var a=_r(s);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=a.val;break;case"<a:sysClr":n.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":a[0].charAt(1)==="/"?(e.themeElements.clrScheme[nee.indexOf(a[0])]=n,n={}):n.name=a[0].slice(3,a[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}})}function aee(){}function iee(){}var oee=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,lee=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,cee=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function uee(t,e,r){e.themeElements={};var n;[["clrScheme",oee,see],["fontScheme",lee,aee],["fmtScheme",cee,iee]].forEach(function(s){if(!(n=t.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](n,e,r)})}var dee=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function MF(t,e){(!t||t.length===0)&&(t=r3());var r,n={};if(!(r=t.match(dee)))throw new Error("themeElements not found in theme");return uee(r[0],n,e),n.raw=t,n}function r3(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[Ts];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function fee(t,e,r){var n=t.l+e,s=t.read_shift(4);if(s!==124226){if(!r.cellStyles){t.l=n;return}var a=t.slice(t.l);t.l=n;var i;try{i=ID(a,{type:"array"})}catch{return}var l=Wi(i,"theme/theme/theme1.xml",!0);if(l)return MF(l,r)}}function hee(t){return t.read_shift(4)}function mee(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=pee(t,4);break;case 2:e.xclrValue=xF(t);break;case 3:e.xclrValue=hee(t);break;case 4:t.l+=4;break}return t.l+=8,e}function pee(t,e){return $a(t,e)}function gee(t,e){return $a(t,e)}function xee(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=mee(t);break;case 6:n[1]=gee(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function yee(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var s=t.read_shift(2),a=[];s-- >0;)a.push(xee(t,r-t.l));return{ixfe:n,ext:a}}function vee(t,e){e.forEach(function(r){switch(r[0]){}})}function bee(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:Ba(t)}}function wee(t){var e=ut(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),sa(t.name,e),e.slice(0,e.l)}function _ee(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function Nee(t){var e=ut(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function See(t,e){var r=ut(8+2*e.length);return r.write_shift(4,t),sa(e,r),r.slice(0,r.l)}function Tee(t){return t.l+=4,t.read_shift(4)!=0}function Aee(t,e){var r=ut(8);return r.write_shift(4,t),r.write_shift(4,1),r}function Eee(t,e,r){var n={Types:[],Cell:[],Value:[]},s=r||{},a=[],i=!1,l=2;return Jc(t,function(c,u,d){switch(d){case 335:n.Types.push({name:c.name});break;case 51:c.forEach(function(f){l==1?n.Cell.push({type:n.Types[f[0]-1].name,index:f[1]}):l==0&&n.Value.push({type:n.Types[f[0]-1].name,index:f[1]})});break;case 337:l=c?1:0;break;case 338:l=2;break;case 35:a.push(d),i=!0;break;case 36:a.pop(),i=!1;break;default:if(!u.T){if(!i||s.WTF&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),n}function Cee(){var t=Ei();return bt(t,332),bt(t,334,al(1)),bt(t,335,wee({name:"XLDAPR",version:12e4,flags:3496657072})),bt(t,336),bt(t,339,See(1,"XLDAPR")),bt(t,52),bt(t,35,al(514)),bt(t,4096,al(0)),bt(t,4097,bo(1)),bt(t,36),bt(t,53),bt(t,340),bt(t,337,Aee(1)),bt(t,51,Nee([[1,0]])),bt(t,338),bt(t,333),t.end()}function kee(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var s=!1,a=2,i;return t.replace(za,function(l){var c=_r(l);switch(Hl(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<n.Types.length;++u)n.Types[u].name==c.name&&(i=n.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":a==1?n.Cell.push({type:n.Types[c.t-1].name,index:+c.v}):a==0&&n.Value.push({type:n.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":a=1;break;case"</cellMetadata>":a=2;break;case"<valueMetadata":a=0;break;case"</valueMetadata>":a=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+c.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return l}),n}function VF(){var t=[Ts];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function Iee(t){var e=[];if(!t)return e;var r=1;return(t.match(za)||[]).forEach(function(n){var s=_r(n);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,e.push(s);break}}),e}function jee(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=vr(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function Pee(t,e,r){var n=[];return Jc(t,function(a,i,l){switch(l){case 63:n.push(a);break;default:if(!i.T)throw new Error("Unexpected record 0x"+l.toString(16))}}),n}function Ree(t,e,r,n){if(!t)return t;var s=n||{},a=!1;Jc(t,function(l,c,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:a=!0;break;case 36:a=!1;break;default:if(!c.T){if(!a||s.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},s)}function Dee(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}var C0=1024;function BF(t,e){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),s=[Vt("xml",null,{"xmlns:v":$i.v,"xmlns:o":$i.o,"xmlns:x":$i.x,"xmlns:mv":$i.mv}).replace(/\/>/,">"),Vt("o:shapelayout",Vt("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),Vt("v:shapetype",[Vt("v:stroke",null,{joinstyle:"miter"}),Vt("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];C0<t*1e3;)C0+=1e3;return e.forEach(function(a){var i=Qn(a[0]),l={color2:"#BEFF82",type:"gradient"};l.type=="gradient"&&(l.angle="-180");var c=l.type=="gradient"?Vt("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=Vt("v:fill",c,l),d={on:"t",obscured:"t"};++C0,s=s.concat(["<v:shape"+Qg({id:"_x0000_s"+C0,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(a[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,Vt("v:shadow",null,d),Vt("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",ma("x:Anchor",[i.c+1,0,i.r+1,0,i.c+3,20,i.r+5,20].join(",")),ma("x:AutoFill","False"),ma("x:Row",String(i.r)),ma("x:Column",String(i.c)),a[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function vk(t,e,r,n){var s=Array.isArray(t),a;e.forEach(function(i){var l=Qn(i.ref);if(s?(t[l.r]||(t[l.r]=[]),a=t[l.r][l.c]):a=t[i.ref],!a){a={t:"z"},s?t[l.r][l.c]=a:t[i.ref]=a;var c=tn(t["!ref"]||"BDWGO1000001:A1");c.s.r>l.r&&(c.s.r=l.r),c.e.r<l.r&&(c.e.r=l.r),c.s.c>l.c&&(c.s.c=l.c),c.e.c<l.c&&(c.e.c=l.c);var u=jr(c);u!==t["!ref"]&&(t["!ref"]=u)}a.c||(a.c=[]);var d={a:i.author,t:i.t,r:i.r,T:r};i.h&&(d.h=i.h);for(var f=a.c.length-1;f>=0;--f){if(!r&&a.c[f].T)return;r&&!a.c[f].T&&a.c.splice(f,1)}if(r&&n){for(f=0;f<n.length;++f)if(d.a==n[f].id){d.a=n[f].name||d.a;break}}a.c.push(d)})}function Fee(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],s=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(i){if(!(i===""||i.trim()==="")){var l=i.match(/<(?:\w+:)?author[^>]*>(.*)/);l&&r.push(l[1])}});var a=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return a&&a[1]&&a[1].split(/<\/\w*:?comment>/).forEach(function(i){if(!(i===""||i.trim()==="")){var l=i.match(/<(?:\w+:)?comment[^>]*>/);if(l){var c=_r(l[0]),u={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},d=Qn(c.ref);if(!(e.sheetRows&&e.sheetRows<=d.r)){var f=i.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),m=!!f&&!!f[1]&&ZS(f[1])||{r:"",t:"",h:""};u.r=m.r,m.r=="<t></t>"&&(m.t=m.h=""),u.t=(m.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(u.h=m.h),n.push(u)}}}}),n}function UF(t){var e=[Ts,Vt("comments",null,{xmlns:yh[0]})],r=[];return e.push("<authors>"),t.forEach(function(n){n[1].forEach(function(s){var a=xn(s.a);r.indexOf(a)==-1&&(r.push(a),e.push("<author>"+a+"</author>")),s.T&&s.ID&&r.indexOf("tc="+s.ID)==-1&&(r.push("tc="+s.ID),e.push("<author>tc="+s.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(n){var s=0,a=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?s=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(s=r.indexOf(xn(c.a))),a.push(c.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+s+'"><text>'),a.length<=1)e.push(ma("t",xn(a[0]||"")));else{for(var i=`Comment:
    `+a[0]+`
`,l=1;l<a.length;++l)i+=`Reply:
    `+a[l]+`
`;e.push(ma("t",xn(i)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function Lee(t,e){var r=[],n=!1,s={},a=0;return t.replace(za,function(l,c){var u=_r(l);switch(Hl(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":a=c+l.length;break;case"</text>":s.t=t.slice(a,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return l}),r}function Oee(t,e,r){var n=[Ts,Vt("ThreadedComments",null,{xmlns:$s.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(s){var a="";(s[1]||[]).forEach(function(i,l){if(!i.T){delete i.ID;return}i.a&&e.indexOf(i.a)==-1&&e.push(i.a);var c={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};l==0?a=c.id:c.parentId=a,i.ID=c.id,i.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(i.a)).slice(-12)+"}"),n.push(Vt("threadedComment",ma("text",i.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function Mee(t,e){var r=[],n=!1;return t.replace(za,function(a){var i=_r(a);switch(Hl(i[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:i.displayname,id:i.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return a}),r}function Vee(t){var e=[Ts,Vt("personList",null,{xmlns:$s.TCMNT,"xmlns:x":yh[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,n){e.push(Vt("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function Bee(t){var e={};e.iauthor=t.read_shift(4);var r=_h(t);return e.rfx=r.s,e.ref=vr(r.s),t.l+=16,e}function Uee(t,e){return e==null&&(e=ut(36)),e.write_shift(4,t[1].iauthor),Lm(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var $ee=Ba;function zee(t){return sa(t.slice(0,54))}function qee(t,e){var r=[],n=[],s={},a=!1;return Jc(t,function(l,c,u){switch(u){case 632:n.push(l);break;case 635:s=l;break;case 637:s.t=l.t,s.h=l.h,s.r=l.r;break;case 636:if(s.author=n[s.iauthor],delete s.iauthor,e.sheetRows&&s.rfx&&e.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!a||e.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}function Wee(t){var e=Ei(),r=[];return bt(e,628),bt(e,630),t.forEach(function(n){n[1].forEach(function(s){r.indexOf(s.a)>-1||(r.push(s.a.slice(0,54)),bt(e,632,zee(s.a)))})}),bt(e,631),bt(e,633),t.forEach(function(n){n[1].forEach(function(s){s.iauthor=r.indexOf(s.a);var a={s:Qn(n[0]),e:Qn(n[0])};bt(e,635,Uee([a,s])),s.t&&s.t.length>0&&bt(e,637,hX(s)),bt(e,636),delete s.iauthor})}),bt(e,634),bt(e,629),e.end()}var Hee="application/vnd.ms-office.vbaProject";function Gee(t){var e=lr.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");lr.utils.cfb_add(e,s,t.FileIndex[n].content)}}),lr.write(e)}function Kee(t,e){e.FullPaths.forEach(function(r,n){if(n!=0){var s=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&lr.utils.cfb_add(t,s,e.FileIndex[n].content)}})}var $F=["xlsb","xlsm","xlam","biff8","xla"];function Yee(){return{"!type":"dialog"}}function Xee(){return{"!type":"dialog"}}function Qee(){return{"!type":"macro"}}function Jee(){return{"!type":"macro"}}var $0=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,s,a,i){var l=!1,c=!1;a.length==0?c=!0:a.charAt(0)=="["&&(c=!0,a=a.slice(1,-1)),i.length==0?l=!0:i.charAt(0)=="["&&(l=!0,i=i.slice(1,-1));var u=a.length>0?parseInt(a,10)|0:0,d=i.length>0?parseInt(i,10)|0:0;return l?d+=e.c:--d,c?u+=e.r:--u,s+(l?"":"$")+Xn(d)+(c?"":"$")+Ns(u)}return function(s,a){return e=a,s.replace(t,r)}}(),n3=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,s3=function(){return function(e,r){return e.replace(n3,function(n,s,a,i,l,c){var u=qS(i)-(a?0:r.c),d=zS(c)-(l?0:r.r),f=d==0?"":l?d+1:"["+d+"]",m=u==0?"":a?u+1:"["+u+"]";return s+"R"+f+"C"+m})}}();function zF(t,e){return t.replace(n3,function(r,n,s,a,i,l){return n+(s=="$"?s+a:Xn(qS(a)+e.c))+(i=="$"?i+l:Ns(zS(l)+e.r))})}function Zee(t,e,r){var n=ki(e),s=n.s,a=Qn(r),i={r:a.r-s.r,c:a.c-s.c};return zF(t,i)}function ete(t){return t.length!=1}function bk(t){return t.replace(/_xlfn\./g,"")}function Is(t){t.l+=1}function Rd(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function qF(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return WF(t);r.biff==12&&(n=4)}var s=t.read_shift(n),a=t.read_shift(n),i=Rd(t),l=Rd(t);return{s:{r:s,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:l[0],cRel:l[1],rRel:l[2]}}}function WF(t){var e=Rd(t),r=Rd(t),n=t.read_shift(1),s=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function tte(t,e,r){if(r.biff<8)return WF(t);var n=t.read_shift(r.biff==12?4:2),s=t.read_shift(r.biff==12?4:2),a=Rd(t),i=Rd(t);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:i[0],cRel:i[1],rRel:i[2]}}}function HF(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return rte(t);var n=t.read_shift(r&&r.biff==12?4:2),s=Rd(t);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function rte(t){var e=Rd(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function nte(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function ste(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return ate(t);var s=t.read_shift(n>=12?4:2),a=t.read_shift(2),i=(a&16384)>>14,l=(a&32768)>>15;if(a&=16383,l==1)for(;s>524287;)s-=1048576;if(i==1)for(;a>8191;)a=a-16384;return{r:s,c:a,cRel:i,rRel:l}}function ate(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,s=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),s==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:s,rRel:n}}function ite(t,e,r){var n=(t[t.l++]&96)>>5,s=qF(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,s]}function ote(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2,"i"),a=8;if(r)switch(r.biff){case 5:t.l+=12,a=6;break;case 12:a=12;break}var i=qF(t,a,r);return[n,s,i]}function lte(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function cte(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2),a=8;if(r)switch(r.biff){case 5:t.l+=12,a=6;break;case 12:a=12;break}return t.l+=a,[n,s]}function ute(t,e,r){var n=(t[t.l++]&96)>>5,s=tte(t,e-1,r);return[n,s]}function dte(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function wk(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function fte(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),s=[],a=0;a<=n;++a)s.push(t.read_shift(r&&r.biff==2?1:2));return s}function hte(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function mte(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function pte(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function gte(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function GF(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function xte(t){return t.read_shift(2),GF(t)}function yte(t){return t.read_shift(2),GF(t)}function vte(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=HF(t,0,r);return[n,s]}function bte(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=ste(t,0,r);return[n,s]}function wte(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var a=HF(t,0,r);return[n,s,a]}function _te(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=t.read_shift(r&&r.biff<=3?1:2);return[Tre[s],XF[s],n]}function Nte(t,e,r){var n=t[t.l++],s=t.read_shift(1),a=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:Ste(t);return[s,(a[0]===0?XF:Sre)[a[1]]]}function Ste(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function Tte(t,e,r){t.l+=r&&r.biff==2?3:4}function Ate(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function Ete(t){return t.l++,Zc[t.read_shift(1)]}function Cte(t){return t.l++,t.read_shift(2)}function kte(t){return t.l++,t.read_shift(1)!==0}function Ite(t){return t.l++,Fa(t)}function jte(t,e,r){return t.l++,Ux(t,e-1,r)}function Pte(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=ps(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=Zc[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=Fa(t);break;case 2:r[1]=Nh(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function Rte(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),s=[],a=0;a!=n;++a)s.push((r.biff==12?_h:ib)(t));return s}function Dte(t,e,r){var n=0,s=0;r.biff==12?(n=t.read_shift(4),s=t.read_shift(4)):(s=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--s==0&&(s=256));for(var a=0,i=[];a!=n&&(i[a]=[]);++a)for(var l=0;l!=s;++l)i[a][l]=Pte(t,r.biff);return i}function Fte(t,e,r){var n=t.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,a=t.read_shift(s);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,a]}function Lte(t,e,r){if(r.biff==5)return Ote(t);var n=t.read_shift(1)>>>5&3,s=t.read_shift(2),a=t.read_shift(4);return[n,s,a]}function Ote(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function Mte(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function Vte(t,e,r){var n=t.read_shift(1)>>>5&3,s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function Bte(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function Ute(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2),a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6;break}return t.l+=a,[n,s]}var $te=$a,zte=$a,qte=$a;function zx(t,e,r){return t.l+=2,[nte(t)]}function a3(t){return t.l+=6,[]}var Wte=zx,Hte=a3,Gte=a3,Kte=zx;function KF(t){return t.l+=2,[Ds(t),t.read_shift(2)&1]}var Yte=zx,Xte=KF,Qte=a3,Jte=zx,Zte=zx,ere=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function tre(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),s=t.read_shift(2),a=t.read_shift(2),i=ere[r>>2&31];return{ixti:e,coltype:r&3,rt:i,idx:n,c:s,C:a}}function rre(t){return t.l+=2,[t.read_shift(4)]}function nre(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function sre(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function are(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function ire(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function ore(t){return t.l+=4,[0,0]}var _k={1:{n:"PtgExp",f:Ate},2:{n:"PtgTbl",f:qte},3:{n:"PtgAdd",f:Is},4:{n:"PtgSub",f:Is},5:{n:"PtgMul",f:Is},6:{n:"PtgDiv",f:Is},7:{n:"PtgPower",f:Is},8:{n:"PtgConcat",f:Is},9:{n:"PtgLt",f:Is},10:{n:"PtgLe",f:Is},11:{n:"PtgEq",f:Is},12:{n:"PtgGe",f:Is},13:{n:"PtgGt",f:Is},14:{n:"PtgNe",f:Is},15:{n:"PtgIsect",f:Is},16:{n:"PtgUnion",f:Is},17:{n:"PtgRange",f:Is},18:{n:"PtgUplus",f:Is},19:{n:"PtgUminus",f:Is},20:{n:"PtgPercent",f:Is},21:{n:"PtgParen",f:Is},22:{n:"PtgMissArg",f:Is},23:{n:"PtgStr",f:jte},26:{n:"PtgSheet",f:nre},27:{n:"PtgEndSheet",f:sre},28:{n:"PtgErr",f:Ete},29:{n:"PtgBool",f:kte},30:{n:"PtgInt",f:Cte},31:{n:"PtgNum",f:Ite},32:{n:"PtgArray",f:dte},33:{n:"PtgFunc",f:_te},34:{n:"PtgFuncVar",f:Nte},35:{n:"PtgName",f:Fte},36:{n:"PtgRef",f:vte},37:{n:"PtgArea",f:ite},38:{n:"PtgMemArea",f:Mte},39:{n:"PtgMemErr",f:$te},40:{n:"PtgMemNoMem",f:zte},41:{n:"PtgMemFunc",f:Vte},42:{n:"PtgRefErr",f:Bte},43:{n:"PtgAreaErr",f:lte},44:{n:"PtgRefN",f:bte},45:{n:"PtgAreaN",f:ute},46:{n:"PtgMemAreaN",f:are},47:{n:"PtgMemNoMemN",f:ire},57:{n:"PtgNameX",f:Lte},58:{n:"PtgRef3d",f:wte},59:{n:"PtgArea3d",f:ote},60:{n:"PtgRefErr3d",f:Ute},61:{n:"PtgAreaErr3d",f:cte},255:{}},lre={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},cre={1:{n:"PtgElfLel",f:KF},2:{n:"PtgElfRw",f:Jte},3:{n:"PtgElfCol",f:Wte},6:{n:"PtgElfRwV",f:Zte},7:{n:"PtgElfColV",f:Kte},10:{n:"PtgElfRadical",f:Yte},11:{n:"PtgElfRadicalS",f:Qte},13:{n:"PtgElfColS",f:Hte},15:{n:"PtgElfColSV",f:Gte},16:{n:"PtgElfRadicalLel",f:Xte},25:{n:"PtgList",f:tre},29:{n:"PtgSxName",f:rre},255:{}},ure={0:{n:"PtgAttrNoop",f:ore},1:{n:"PtgAttrSemi",f:gte},2:{n:"PtgAttrIf",f:mte},4:{n:"PtgAttrChoose",f:fte},8:{n:"PtgAttrGoto",f:hte},16:{n:"PtgAttrSum",f:Tte},32:{n:"PtgAttrBaxcel",f:wk},33:{n:"PtgAttrBaxcel",f:wk},64:{n:"PtgAttrSpace",f:xte},65:{n:"PtgAttrSpaceSemi",f:yte},128:{n:"PtgAttrIfError",f:pte},255:{}};function qx(t,e,r,n){if(n.biff<8)return $a(t,e);for(var s=t.l+e,a=[],i=0;i!==r.length;++i)switch(r[i][0]){case"PtgArray":r[i][1]=Dte(t,0,n),a.push(r[i][1]);break;case"PtgMemArea":r[i][2]=Rte(t,r[i][1],n),a.push(r[i][2]);break;case"PtgExp":n&&n.biff==12&&(r[i][1][1]=t.read_shift(4),a.push(r[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[i][0]}return e=s-t.l,e!==0&&a.push($a(t,e)),a}function Wx(t,e,r){for(var n=t.l+e,s,a,i=[];n!=t.l;)e=n-t.l,a=t[t.l],s=_k[a]||_k[lre[a]],(a===24||a===25)&&(s=(a===24?cre:ure)[t[t.l+1]]),!s||!s.f?$a(t,e):i.push([s.n,s.f(t,e,r)]);return i}function dre(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],s=[],a=0;a<n.length;++a){var i=n[a];if(i)switch(i[0]){case 2:s.push('"'+i[1].replace(/"/g,'""')+'"');break;default:s.push(i[1])}else s.push("")}e.push(s.join(","))}return e.join(";")}var fre={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function hre(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function YF(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var s="";if(r.biff>8)switch(t[n[0]][0]){case 357:return s=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?s:s+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return t[n[0]][0][3]?(s=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Nk(t,e,r){var n=YF(t,e,r);return n=="#REF"?n:hre(n,r)}function ja(t,e,r,n,s){var a=s&&s.biff||8,i={s:{c:0,r:0}},l=[],c,u,d,f=0,m=0,h,g="";if(!t[0]||!t[0][0])return"";for(var p=-1,v="",b=0,w=t[0].length;b<w;++b){var N=t[0][b];switch(N[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=l.pop(),u=l.pop(),p>=0){switch(t[0][p][1][0]){case 0:v=os(" ",t[0][p][1][1]);break;case 1:v=os("\r",t[0][p][1][1]);break;default:if(v="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][p][1][0])}u=u+v,p=-1}l.push(u+fre[N[0]]+c);break;case"PtgIsect":c=l.pop(),u=l.pop(),l.push(u+" "+c);break;case"PtgUnion":c=l.pop(),u=l.pop(),l.push(u+","+c);break;case"PtgRange":c=l.pop(),u=l.pop(),l.push(u+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=tg(N[1][1],i,s),l.push(rg(d,a));break;case"PtgRefN":d=r?tg(N[1][1],r,s):N[1][1],l.push(rg(d,a));break;case"PtgRef3d":f=N[1][1],d=tg(N[1][2],i,s),g=Nk(n,f,s),l.push(g+"!"+rg(d,a));break;case"PtgFunc":case"PtgFuncVar":var j=N[1][0],F=N[1][1];j||(j=0),j&=127;var U=j==0?[]:l.slice(-j);l.length-=j,F==="User"&&(F=U.shift()),l.push(F+"("+U.join(",")+")");break;case"PtgBool":l.push(N[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(N[1]);break;case"PtgNum":l.push(String(N[1]));break;case"PtgStr":l.push('"'+N[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(N[1]);break;case"PtgAreaN":h=JC(N[1][1],r?{s:r}:i,s),l.push(Tw(h,s));break;case"PtgArea":h=JC(N[1][1],i,s),l.push(Tw(h,s));break;case"PtgArea3d":f=N[1][1],h=N[1][2],g=Nk(n,f,s),l.push(g+"!"+Tw(h,s));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":m=N[1][2];var A=(n.names||[])[m-1]||(n[0]||[])[m],S=A?A.Name:"SH33TJSNAME"+String(m);S&&S.slice(0,6)=="_xlfn."&&!s.xlfn&&(S=S.slice(6)),l.push(S);break;case"PtgNameX":var k=N[1][1];m=N[1][2];var M;if(s.biff<=5)k<0&&(k=-k),n[k]&&(M=n[k][m]);else{var I="";if(((n[k]||[])[0]||[])[0]==14849||(((n[k]||[])[0]||[])[0]==1025?n[k][m]&&n[k][m].itab>0&&(I=n.SheetNames[n[k][m].itab-1]+"!"):I=n.SheetNames[m-1]+"!"),n[k]&&n[k][m])I+=n[k][m].Name;else if(n[0]&&n[0][m])I+=n[0][m].Name;else{var E=(YF(n,k,s)||"").split(";;");E[m-1]?I=E[m-1]:I+="SH33TJSERRX"}l.push(I);break}M||(M={Name:"SH33TJSERRY"}),l.push(M.Name);break;case"PtgParen":var D="(",G=")";if(p>=0){switch(v="",t[0][p][1][0]){case 2:D=os(" ",t[0][p][1][1])+D;break;case 3:D=os("\r",t[0][p][1][1])+D;break;case 4:G=os(" ",t[0][p][1][1])+G;break;case 5:G=os("\r",t[0][p][1][1])+G;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][p][1][0])}p=-1}l.push(D+l.pop()+G);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":d={c:N[1][1],r:N[1][0]};var Z={c:r.c,r:r.r};if(n.sharedf[vr(d)]){var ae=n.sharedf[vr(d)];l.push(ja(ae,i,Z,n,s))}else{var de=!1;for(c=0;c!=n.arrayf.length;++c)if(u=n.arrayf[c],!(d.c<u[0].s.c||d.c>u[0].e.c)&&!(d.r<u[0].s.r||d.r>u[0].e.r)){l.push(ja(u[1],i,Z,n,s)),de=!0;break}de||l.push(N[1])}break;case"PtgArray":l.push("{"+dre(N[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=b;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+N[1].idx+"[#"+N[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(N));default:throw new Error("Unrecognized Formula Token: "+String(N))}var se=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&p>=0&&se.indexOf(t[0][b][0])==-1){N=t[0][p];var Y=!0;switch(N[1][0]){case 4:Y=!1;case 0:v=os(" ",N[1][1]);break;case 5:Y=!1;case 1:v=os("\r",N[1][1]);break;default:if(v="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+N[1][0])}l.push((Y?v:"")+l.pop()+(Y?"":v)),p=-1}}if(l.length>1&&s.WTF)throw new Error("bad formula stack");return l[0]}function mre(t,e,r){var n=t.l+e,s=r.biff==2?1:2,a,i=t.read_shift(s);if(i==65535)return[[],$a(t,e-2)];var l=Wx(t,i,r);return e!==i+s&&(a=qx(t,e-i-s,l,r)),t.l=n,[l,a]}function pre(t,e,r){var n=t.l+e,s=r.biff==2?1:2,a,i=t.read_shift(s);if(i==65535)return[[],$a(t,e-2)];var l=Wx(t,i,r);return e!==i+s&&(a=qx(t,e-i-s,l,r)),t.l=n,[l,a]}function gre(t,e,r,n){var s=t.l+e,a=Wx(t,n,r),i;return s!==t.l&&(i=qx(t,s-t.l,a,r)),[a,i]}function xre(t,e,r){var n=t.l+e,s,a=t.read_shift(2),i=Wx(t,a,r);return a==65535?[[],$a(t,e-2)]:(e!==a+2&&(s=qx(t,n-a-2,i,r)),[i,s])}function yre(t){var e;if(Sc(t,t.l+6)!==65535)return[Fa(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function vre(t){if(t==null){var e=ut(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return lh(t);return lh(0)}function Iw(t,e,r){var n=t.l+e,s=Gl(t);r.biff==2&&++t.l;var a=yre(t),i=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var l=pre(t,n-t.l,r);return{cell:s,val:a[0],formula:l,shared:i>>3&1,tt:a[1]}}function bre(t,e,r,n,s){var a=uh(e,r,s),i=vre(t.v),l=ut(6),c=33;l.write_shift(2,c),l.write_shift(4,0);for(var u=ut(t.bf.length),d=0;d<t.bf.length;++d)u[d]=t.bf[d];var f=na([a,i,l,u]);return f}function ob(t,e,r){var n=t.read_shift(4),s=Wx(t,n,r),a=t.read_shift(4),i=a>0?qx(t,a,s,r):null;return[s,i]}var wre=ob,lb=ob,_re=ob,Nre=ob,Sre={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},XF={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Tre={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Sk(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function Are(t){var e="of:="+t.replace(n3,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function jw(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function Ere(t){return t.replace(/\./,"!")}var sg={},z0={},ag=typeof Map<"u";function i3(t,e,r){var n=0,s=t.length;if(r){if(ag?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var a=ag?r.get(e):r[e];n<a.length;++n)if(t[a[n]].t===e)return t.Count++,a[n]}}else for(;n<s;++n)if(t[n].t===e)return t.Count++,n;return t[s]={t:e},t.Count++,t.Unique++,r&&(ag?(r.has(e)||r.set(e,[]),r.get(e).push(s)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(s))),s}function cb(t,e){var r={min:t+1,max:t+1},n=-1;return e.MDW&&(Ra=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?n=rx(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(r.width=r2(n),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function Bf(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function Qd(t,e,r){var n=r.revssf[e.z!=null?e.z:"General"],s=60,a=t.length;if(n==null&&r.ssf){for(;s<392;++s)if(r.ssf[s]==null){jc(e.z,s),r.ssf[s]=e.z,r.revssf[e.z]=n=s;break}}for(s=0;s!=a;++s)if(t[s].numFmtId===n)return s;return t[a]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},a}function QF(t,e,r,n,s,a){try{n.cellNF&&(t.z=gr[e])}catch(l){if(n.WTF)throw l}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=Vn(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(gr[e]==null&&jc(SY[e]||"General",e),t.t==="e")t.w=t.w||Zc[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Yg(t.v);else if(t.t==="d"){var i=Hs(t.v);(i|0)===i?t.w=i.toString(10):t.w=Yg(i)}else{if(t.v===void 0)return"";t.w=ih(t.v,z0)}else t.t==="d"?t.w=jo(e,Hs(t.v),z0):t.w=jo(e,t.v,z0)}catch(l){if(n.WTF)throw l}if(n.cellStyles&&r!=null)try{t.s=a.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=t2(s.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=s.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=t2(s.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=s.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(l){if(n.WTF&&a.Fills)throw l}}}function Cre(t,e,r){if(t&&t["!ref"]){var n=tn(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function kre(t,e){var r=tn(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=jr(r))}var Ire=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,jre=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,Pre=/<(?:\w:)?hyperlink [^>]*>/mg,Rre=/"(\w*:\w*)"/,Dre=/<(?:\w:)?col\b[^>]*[\/]?>/g,Fre=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,Lre=/<(?:\w:)?pageMargins[^>]*\/>/g,JF=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,Ore=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,Mre=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function Vre(t,e,r,n,s,a,i){if(!t)return t;n||(n={"!id":{}});var l=e.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",d="",f=t.match(jre);f?(u=t.slice(0,f.index),d=t.slice(f.index+f[0].length)):u=d=t;var m=u.match(JF);m?o3(m[0],l,s,r):(m=u.match(Ore))&&Ure(m[0],m[1]||"",l,s,r);var h=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(h>0){var g=u.slice(h,h+50).match(Rre);g&&kre(l,g[1])}var p=u.match(Mre);p&&p[1]&&ene(p[1],s);var v=[];if(e.cellStyles){var b=u.match(Dre);b&&Yre(v,b)}f&&nne(f[1],l,e,c,a,i);var w=d.match(Fre);w&&(l["!autofilter"]=Qre(w[0]));var N=[],j=d.match(Ire);if(j)for(h=0;h!=j.length;++h)N[h]=tn(j[h].slice(j[h].indexOf('"')+1));var F=d.match(Pre);F&&Hre(l,F,n);var U=d.match(Lre);if(U&&(l["!margins"]=Gre(_r(U[0]))),!l["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(l["!ref"]=jr(c)),e.sheetRows>0&&l["!ref"]){var A=tn(l["!ref"]);e.sheetRows<=+A.e.r&&(A.e.r=e.sheetRows-1,A.e.r>c.e.r&&(A.e.r=c.e.r),A.e.r<A.s.r&&(A.s.r=A.e.r),A.e.c>c.e.c&&(A.e.c=c.e.c),A.e.c<A.s.c&&(A.s.c=A.e.c),l["!fullref"]=l["!ref"],l["!ref"]=jr(A))}return v.length>0&&(l["!cols"]=v),N.length>0&&(l["!merges"]=N),l}function Bre(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+jr(t[r])+'"/>';return e+"</mergeCells>"}function o3(t,e,r,n){var s=_r(t);r.Sheets[n]||(r.Sheets[n]={}),s.codeName&&(r.Sheets[n].CodeName=en(wn(s.codeName)))}function Ure(t,e,r,n,s){o3(t.slice(0,t.indexOf(">")),r,n,s)}function $re(t,e,r,n,s){var a=!1,i={},l=null;if(n.bookType!=="xlsx"&&e.vbaraw){var c=e.SheetNames[r];try{e.Workbook&&(c=e.Workbook.Sheets[r].CodeName||c)}catch{}a=!0,i.codeName=Dl(xn(c))}if(t&&t["!outline"]){var u={summaryBelow:1,summaryRight:1};t["!outline"].above&&(u.summaryBelow=0),t["!outline"].left&&(u.summaryRight=0),l=(l||"")+Vt("outlinePr",null,u)}!a&&!l||(s[s.length]=Vt("sheetPr",l,i))}var zre=["objects","scenarios","selectLockedCells","selectUnlockedCells"],qre=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function Wre(t){var e={sheet:1};return zre.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),qre.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=e3(t.password).toString(16).toUpperCase()),Vt("sheetProtection",null,e)}function Hre(t,e,r){for(var n=Array.isArray(t),s=0;s!=e.length;++s){var a=_r(wn(e[s]),!0);if(!a.ref)return;var i=((r||{})["!id"]||[])[a.id];i?(a.Target=i.Target,a.location&&(a.Target+="#"+en(a.location))):(a.Target="#"+en(a.location),i={Target:a.Target,TargetMode:"Internal"}),a.Rel=i,a.tooltip&&(a.Tooltip=a.tooltip,delete a.tooltip);for(var l=tn(a.ref),c=l.s.r;c<=l.e.r;++c)for(var u=l.s.c;u<=l.e.c;++u){var d=vr({c:u,r:c});n?(t[c]||(t[c]=[]),t[c][u]||(t[c][u]={t:"z",v:void 0}),t[c][u].l=a):(t[d]||(t[d]={t:"z",v:void 0}),t[d].l=a)}}}function Gre(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function Kre(t){return Bf(t),Vt("pageMargins",null,t)}function Yre(t,e){for(var r=!1,n=0;n!=e.length;++n){var s=_r(e[n],!0);s.hidden&&(s.hidden=Ln(s.hidden));var a=parseInt(s.min,10)-1,i=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,t3(s.width)),Pd(s);a<=i;)t[a++]=Bn(s)}}function Xre(t,e){for(var r=["<cols>"],n,s=0;s!=e.length;++s)(n=e[s])&&(r[r.length]=Vt("col",null,cb(s,n)));return r[r.length]="</cols>",r.join("")}function Qre(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}function Jre(t,e,r,n){var s=typeof t.ref=="string"?t.ref:jr(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,i=ki(s);i.s.r==i.e.r&&(i.e.r=ki(e["!ref"]).e.r,s=jr(i));for(var l=0;l<a.length;++l){var c=a[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+s;break}}return l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),Vt("autoFilter",null,{ref:s})}var Zre=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function ene(t,e){e.Views||(e.Views=[{}]),(t.match(Zre)||[]).forEach(function(r,n){var s=_r(r);e.Views[n]||(e.Views[n]={}),+s.zoomScale&&(e.Views[n].zoom=+s.zoomScale),Ln(s.rightToLeft)&&(e.Views[n].RTL=!0)})}function tne(t,e,r,n){var s={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Vt("sheetViews",Vt("sheetView",null,s),{})}function rne(t,e,r,n){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var s="",a=t.t,i=t.v;if(t.t!=="z")switch(t.t){case"b":s=t.v?"1":"0";break;case"n":s=""+t.v;break;case"e":s=Zc[t.v];break;case"d":n&&n.cellDates?s=Vn(t.v,-1).toISOString():(t=Bn(t),t.t="n",s=""+(t.v=Hs(Vn(t.v)))),typeof t.z>"u"&&(t.z=gr[14]);break;default:s=t.v;break}var l=ma("v",xn(s)),c={r:e},u=Qd(n.cellXfs,t,n);switch(u!==0&&(c.s=u),t.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){l=ma("v",""+i3(n.Strings,t.v,n.revStrings)),c.t="s";break}c.t="str";break}if(t.t!=a&&(t.t=a,t.v=i),typeof t.f=="string"&&t.f){var d=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;l=Vt("f",xn(t.f),d)+(t.v!=null?l:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(c.cm=1),Vt("c",l,c)}var nne=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,a=Xg("v"),i=Xg("f");return function(c,u,d,f,m,h){for(var g=0,p="",v=[],b=[],w=0,N=0,j=0,F="",U,A,S=0,k=0,M,I,E=0,D=0,G=Array.isArray(h.CellXf),Z,ae=[],de=[],se=Array.isArray(u),Y=[],ye={},re=!1,C=!!d.sheetStubs,O=c.split(e),L=0,H=O.length;L!=H;++L){p=O[L].trim();var K=p.length;if(K!==0){var q=0;e:for(g=0;g<K;++g)switch(p[g]){case">":if(p[g-1]!="/"){++g;break e}if(d&&d.cellStyles){if(A=_r(p.slice(q,g),!0),S=A.r!=null?parseInt(A.r,10):S+1,k=-1,d.sheetRows&&d.sheetRows<S)continue;ye={},re=!1,A.ht&&(re=!0,ye.hpt=parseFloat(A.ht),ye.hpx=bm(ye.hpt)),A.hidden=="1"&&(re=!0,ye.hidden=!0),A.outlineLevel!=null&&(re=!0,ye.level=+A.outlineLevel),re&&(Y[S-1]=ye)}break;case"<":q=g;break}if(q>=g)break;if(A=_r(p.slice(q,g),!0),S=A.r!=null?parseInt(A.r,10):S+1,k=-1,!(d.sheetRows&&d.sheetRows<S)){f.s.r>S-1&&(f.s.r=S-1),f.e.r<S-1&&(f.e.r=S-1),d&&d.cellStyles&&(ye={},re=!1,A.ht&&(re=!0,ye.hpt=parseFloat(A.ht),ye.hpx=bm(ye.hpt)),A.hidden=="1"&&(re=!0,ye.hidden=!0),A.outlineLevel!=null&&(re=!0,ye.level=+A.outlineLevel),re&&(Y[S-1]=ye)),v=p.slice(g).split(t);for(var te=0;te!=v.length&&v[te].trim().charAt(0)=="<";++te);for(v=v.slice(te),g=0;g!=v.length;++g)if(p=v[g].trim(),p.length!==0){if(b=p.match(r),w=g,N=0,j=0,p="<c "+(p.slice(0,1)=="<"?">":"")+p,b!=null&&b.length===2){for(w=0,F=b[1],N=0;N!=F.length&&!((j=F.charCodeAt(N)-64)<1||j>26);++N)w=26*w+j;--w,k=w}else++k;for(N=0;N!=p.length&&p.charCodeAt(N)!==62;++N);if(++N,A=_r(p.slice(0,N),!0),A.r||(A.r=vr({r:S-1,c:k})),F=p.slice(N),U={t:""},(b=F.match(a))!=null&&b[1]!==""&&(U.v=en(b[1])),d.cellFormula){if((b=F.match(i))!=null&&b[1]!==""){if(U.f=en(wn(b[1])).replace(/\r\n/g,`
`),d.xlfn||(U.f=bk(U.f)),b[0].indexOf('t="array"')>-1)U.F=(F.match(s)||[])[1],U.F.indexOf(":")>-1&&ae.push([tn(U.F),U.F]);else if(b[0].indexOf('t="shared"')>-1){I=_r(b[0]);var oe=en(wn(b[1]));d.xlfn||(oe=bk(oe)),de[parseInt(I.si,10)]=[I,oe,A.r]}}else(b=F.match(/<f[^>]*\/>/))&&(I=_r(b[0]),de[I.si]&&(U.f=Zee(de[I.si][1],de[I.si][2],A.r)));var V=Qn(A.r);for(N=0;N<ae.length;++N)V.r>=ae[N][0].s.r&&V.r<=ae[N][0].e.r&&V.c>=ae[N][0].s.c&&V.c<=ae[N][0].e.c&&(U.F=ae[N][1])}if(A.t==null&&U.v===void 0)if(U.f||U.F)U.v=0,U.t="n";else if(C)U.t="z";else continue;else U.t=A.t||"n";switch(f.s.c>k&&(f.s.c=k),f.e.c<k&&(f.e.c=k),U.t){case"n":if(U.v==""||U.v==null){if(!C)continue;U.t="z"}else U.v=parseFloat(U.v);break;case"s":if(typeof U.v>"u"){if(!C)continue;U.t="z"}else M=sg[parseInt(U.v,10)],U.v=M.t,U.r=M.r,d.cellHTML&&(U.h=M.h);break;case"str":U.t="s",U.v=U.v!=null?wn(U.v):"",d.cellHTML&&(U.h=VS(U.v));break;case"inlineStr":b=F.match(n),U.t="s",b!=null&&(M=ZS(b[1]))?(U.v=M.t,d.cellHTML&&(U.h=M.h)):U.v="";break;case"b":U.v=Ln(U.v);break;case"d":d.cellDates?U.v=Vn(U.v,1):(U.v=Hs(Vn(U.v,1)),U.t="n");break;case"e":(!d||d.cellText!==!1)&&(U.w=U.v),U.v=eF[U.v];break}if(E=D=0,Z=null,G&&A.s!==void 0&&(Z=h.CellXf[A.s],Z!=null&&(Z.numFmtId!=null&&(E=Z.numFmtId),d.cellStyles&&Z.fillId!=null&&(D=Z.fillId))),QF(U,E,D,d,m,h),d.cellDates&&G&&U.t=="n"&&Rm(gr[E])&&(U.t="d",U.v=ab(U.v)),A.cm&&d.xlmeta){var xe=(d.xlmeta.Cell||[])[+A.cm-1];xe&&xe.type=="XLDAPR"&&(U.D=!0)}if(se){var B=Qn(A.r);u[B.r]||(u[B.r]=[]),u[B.r][B.c]=U}else u[A.r]=U}}}}Y.length>0&&(u["!rows"]=Y)}}();function sne(t,e,r,n){var s=[],a=[],i=tn(t["!ref"]),l="",c,u="",d=[],f=0,m=0,h=t["!rows"],g=Array.isArray(t),p={r:u},v,b=-1;for(m=i.s.c;m<=i.e.c;++m)d[m]=Xn(m);for(f=i.s.r;f<=i.e.r;++f){for(a=[],u=Ns(f),m=i.s.c;m<=i.e.c;++m){c=d[m]+u;var w=g?(t[f]||[])[m]:t[c];w!==void 0&&(l=rne(w,c,t,e))!=null&&a.push(l)}(a.length>0||h&&h[f])&&(p={r:u},h&&h[f]&&(v=h[f],v.hidden&&(p.hidden=1),b=-1,v.hpx?b=nx(v.hpx):v.hpt&&(b=v.hpt),b>-1&&(p.ht=b,p.customHeight=1),v.level&&(p.outlineLevel=v.level)),s[s.length]=Vt("row",a.join(""),p))}if(h)for(;f<h.length;++f)h&&h[f]&&(p={r:f+1},v=h[f],v.hidden&&(p.hidden=1),b=-1,v.hpx?b=nx(v.hpx):v.hpt&&(b=v.hpt),b>-1&&(p.ht=b,p.customHeight=1),v.level&&(p.outlineLevel=v.level),s[s.length]=Vt("row","",p));return s.join("")}function ZF(t,e,r,n){var s=[Ts,Vt("worksheet",null,{xmlns:yh[0],"xmlns:r":$s.r})],a=r.SheetNames[t],i=0,l="",c=r.Sheets[a];c==null&&(c={});var u=c["!ref"]||"A1",d=tn(u);if(d.e.c>16383||d.e.r>1048575){if(e.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),u=jr(d)}n||(n={}),c["!comments"]=[];var f=[];$re(c,r,t,e,s),s[s.length]=Vt("dimension",null,{ref:u}),s[s.length]=tne(c,e,t,r),e.sheetFormat&&(s[s.length]=Vt("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(s[s.length]=Xre(c,c["!cols"])),s[i=s.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(l=sne(c,e),l.length>0&&(s[s.length]=l)),s.length>i+1&&(s[s.length]="</sheetData>",s[i]=s[i].replace("/>",">")),c["!protect"]&&(s[s.length]=Wre(c["!protect"])),c["!autofilter"]!=null&&(s[s.length]=Jre(c["!autofilter"],c,r,t)),c["!merges"]!=null&&c["!merges"].length>0&&(s[s.length]=Bre(c["!merges"]));var m=-1,h,g=-1;return c["!links"].length>0&&(s[s.length]="<hyperlinks>",c["!links"].forEach(function(p){p[1].Target&&(h={ref:p[0]},p[1].Target.charAt(0)!="#"&&(g=mn(n,-1,xn(p[1].Target).replace(/#.*$/,""),Or.HLINK),h["r:id"]="rId"+g),(m=p[1].Target.indexOf("#"))>-1&&(h.location=xn(p[1].Target.slice(m+1))),p[1].Tooltip&&(h.tooltip=xn(p[1].Tooltip)),s[s.length]=Vt("hyperlink",null,h))}),s[s.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(s[s.length]=Kre(c["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(s[s.length]=ma("ignoredErrors",Vt("ignoredError",null,{numberStoredAsText:1,sqref:u}))),f.length>0&&(g=mn(n,-1,"../drawings/drawing"+(t+1)+".xml",Or.DRAW),s[s.length]=Vt("drawing",null,{"r:id":"rId"+g}),c["!drawing"]=f),c["!comments"].length>0&&(g=mn(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",Or.VML),s[s.length]=Vt("legacyDrawing",null,{"r:id":"rId"+g}),c["!legacy"]=g),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function ane(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var s=t.read_shift(2);t.l+=1;var a=t.read_shift(1);return t.l=n,a&7&&(r.level=a&7),a&16&&(r.hidden=!0),a&32&&(r.hpt=s/20),r}function ine(t,e,r){var n=ut(145),s=(r["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var a=320;s.hpx?a=nx(s.hpx)*20:s.hpt&&(a=s.hpt*20),n.write_shift(2,a),n.write_shift(1,0);var i=0;s.level&&(i|=s.level),s.hidden&&(i|=16),(s.hpx||s.hpt)&&(i|=32),n.write_shift(1,i),n.write_shift(1,0);var l=0,c=n.l;n.l+=4;for(var u={r:t,c:0},d=0;d<16;++d)if(!(e.s.c>d+1<<10||e.e.c<d<<10)){for(var f=-1,m=-1,h=d<<10;h<d+1<<10;++h){u.c=h;var g=Array.isArray(r)?(r[u.r]||[])[u.c]:r[vr(u)];g&&(f<0&&(f=h),m=h)}f<0||(++l,n.write_shift(4,f),n.write_shift(4,m))}var p=n.l;return n.l=c,n.write_shift(4,l),n.l=p,n.length>n.l?n.slice(0,n.l):n}function one(t,e,r,n){var s=ine(n,r,e);(s.length>17||(e["!rows"]||[])[n])&&bt(t,0,s)}var lne=_h,cne=Lm;function une(){}function dne(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=mX(t),r}function fne(t,e,r){r==null&&(r=ut(84+4*t.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),r.write_shift(1,n);for(var s=1;s<3;++s)r.write_shift(1,0);return Jv({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),YD(t,r),r.slice(0,r.l)}function hne(t){var e=Po(t);return[e]}function mne(t,e,r){return r==null&&(r=ut(8)),vh(e,r)}function pne(t){var e=bh(t);return[e]}function gne(t,e,r){return r==null&&(r=ut(4)),wh(e,r)}function xne(t){var e=Po(t),r=t.read_shift(1);return[e,r,"b"]}function yne(t,e,r){return r==null&&(r=ut(9)),vh(e,r),r.write_shift(1,t.v?1:0),r}function vne(t){var e=bh(t),r=t.read_shift(1);return[e,r,"b"]}function bne(t,e,r){return r==null&&(r=ut(5)),wh(e,r),r.write_shift(1,t.v?1:0),r}function wne(t){var e=Po(t),r=t.read_shift(1);return[e,r,"e"]}function _ne(t,e,r){return r==null&&(r=ut(9)),vh(e,r),r.write_shift(1,t.v),r}function Nne(t){var e=bh(t),r=t.read_shift(1);return[e,r,"e"]}function Sne(t,e,r){return r==null&&(r=ut(8)),wh(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function Tne(t){var e=Po(t),r=t.read_shift(4);return[e,r,"s"]}function Ane(t,e,r){return r==null&&(r=ut(12)),vh(e,r),r.write_shift(4,e.v),r}function Ene(t){var e=bh(t),r=t.read_shift(4);return[e,r,"s"]}function Cne(t,e,r){return r==null&&(r=ut(8)),wh(e,r),r.write_shift(4,e.v),r}function kne(t){var e=Po(t),r=Fa(t);return[e,r,"n"]}function Ine(t,e,r){return r==null&&(r=ut(16)),vh(e,r),lh(t.v,r),r}function eL(t){var e=bh(t),r=Fa(t);return[e,r,"n"]}function jne(t,e,r){return r==null&&(r=ut(12)),wh(e,r),lh(t.v,r),r}function Pne(t){var e=Po(t),r=KS(t);return[e,r,"n"]}function Rne(t,e,r){return r==null&&(r=ut(12)),vh(e,r),XD(t.v,r),r}function Dne(t){var e=bh(t),r=KS(t);return[e,r,"n"]}function Fne(t,e,r){return r==null&&(r=ut(8)),wh(e,r),XD(t.v,r),r}function Lne(t){var e=Po(t),r=WS(t);return[e,r,"is"]}function One(t){var e=Po(t),r=Ba(t);return[e,r,"str"]}function Mne(t,e,r){return r==null&&(r=ut(12+4*t.v.length)),vh(e,r),sa(t.v,r),r.length>r.l?r.slice(0,r.l):r}function Vne(t){var e=bh(t),r=Ba(t);return[e,r,"str"]}function Bne(t,e,r){return r==null&&(r=ut(8+4*t.v.length)),wh(e,r),sa(t.v,r),r.length>r.l?r.slice(0,r.l):r}function Une(t,e,r){var n=t.l+e,s=Po(t);s.r=r["!row"];var a=t.read_shift(1),i=[s,a,"b"];if(r.cellFormula){t.l+=2;var l=lb(t,n-t.l,r);i[3]=ja(l,null,s,r.supbooks,r)}else t.l=n;return i}function $ne(t,e,r){var n=t.l+e,s=Po(t);s.r=r["!row"];var a=t.read_shift(1),i=[s,a,"e"];if(r.cellFormula){t.l+=2;var l=lb(t,n-t.l,r);i[3]=ja(l,null,s,r.supbooks,r)}else t.l=n;return i}function zne(t,e,r){var n=t.l+e,s=Po(t);s.r=r["!row"];var a=Fa(t),i=[s,a,"n"];if(r.cellFormula){t.l+=2;var l=lb(t,n-t.l,r);i[3]=ja(l,null,s,r.supbooks,r)}else t.l=n;return i}function qne(t,e,r){var n=t.l+e,s=Po(t);s.r=r["!row"];var a=Ba(t),i=[s,a,"str"];if(r.cellFormula){t.l+=2;var l=lb(t,n-t.l,r);i[3]=ja(l,null,s,r.supbooks,r)}else t.l=n;return i}var Wne=_h,Hne=Lm;function Gne(t,e){return e==null&&(e=ut(4)),e.write_shift(4,t),e}function Kne(t,e){var r=t.l+e,n=_h(t),s=HS(t),a=Ba(t),i=Ba(t),l=Ba(t);t.l=r;var c={rfx:n,relId:s,loc:a,display:l};return i&&(c.Tooltip=i),c}function Yne(t,e){var r=ut(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));Lm({s:Qn(t[0]),e:Qn(t[0])},r),GS("rId"+e,r);var n=t[1].Target.indexOf("#"),s=n==-1?"":t[1].Target.slice(n+1);return sa(s||"",r),sa(t[1].Tooltip||"",r),sa("",r),r.slice(0,r.l)}function Xne(){}function Qne(t,e,r){var n=t.l+e,s=QD(t),a=t.read_shift(1),i=[s];if(i[2]=a,r.cellFormula){var l=wre(t,n-t.l,r);i[1]=l}else t.l=n;return i}function Jne(t,e,r){var n=t.l+e,s=_h(t),a=[s];if(r.cellFormula){var i=Nre(t,n-t.l,r);a[1]=i,t.l=n}else t.l=n;return a}function Zne(t,e,r){r==null&&(r=ut(18));var n=cb(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var s=0;return e.hidden&&(s|=1),typeof n.width=="number"&&(s|=2),e.level&&(s|=e.level<<8),r.write_shift(2,s),r}var tL=["left","right","top","bottom","header","footer"];function ese(t){var e={};return tL.forEach(function(r){e[r]=Fa(t)}),e}function tse(t,e){return e==null&&(e=ut(6*8)),Bf(t),tL.forEach(function(r){lh(t[r],e)}),e}function rse(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function nse(t,e,r){r==null&&(r=ut(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function sse(t){var e=ut(24);return e.write_shift(4,4),e.write_shift(4,1),Lm(t,e),e}function ase(t,e){return e==null&&(e=ut(16*4+2)),e.write_shift(2,t.password?e3(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function ise(){}function ose(){}function lse(t,e,r,n,s,a,i){if(!t)return t;var l=e||{};n||(n={"!id":{}});var c=l.dense?[]:{},u,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,m=!1,h,g,p,v,b,w,N,j,F,U=[];l.biff=12,l["!row"]=0;var A=0,S=!1,k=[],M={},I=l.supbooks||s.supbooks||[[]];if(I.sharedf=M,I.arrayf=k,I.SheetNames=s.SheetNames||s.Sheets.map(function(se){return se.name}),!l.supbooks&&(l.supbooks=I,s.Names))for(var E=0;E<s.Names.length;++E)I[0][E+1]=s.Names[E];var D=[],G=[],Z=!1;sx[16]={n:"BrtShortReal",f:eL};var ae;if(Jc(t,function(Y,ye,re){if(!m)switch(re){case 148:u=Y;break;case 0:h=Y,l.sheetRows&&l.sheetRows<=h.r&&(m=!0),j=Ns(v=h.r),l["!row"]=h.r,(Y.hidden||Y.hpt||Y.level!=null)&&(Y.hpt&&(Y.hpx=bm(Y.hpt)),G[Y.r]=Y);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(g={t:Y[2]},Y[2]){case"n":g.v=Y[1];break;case"s":N=sg[Y[1]],g.v=N.t,g.r=N.r;break;case"b":g.v=!!Y[1];break;case"e":g.v=Y[1],l.cellText!==!1&&(g.w=Zc[g.v]);break;case"str":g.t="s",g.v=Y[1];break;case"is":g.t="s",g.v=Y[1].t;break}if((p=i.CellXf[Y[0].iStyleRef])&&QF(g,p.numFmtId,null,l,a,i),b=Y[0].c==-1?b+1:Y[0].c,l.dense?(c[v]||(c[v]=[]),c[v][b]=g):c[Xn(b)+j]=g,l.cellFormula){for(S=!1,A=0;A<k.length;++A){var C=k[A];h.r>=C[0].s.r&&h.r<=C[0].e.r&&b>=C[0].s.c&&b<=C[0].e.c&&(g.F=jr(C[0]),S=!0)}!S&&Y.length>3&&(g.f=Y[3])}if(d.s.r>h.r&&(d.s.r=h.r),d.s.c>b&&(d.s.c=b),d.e.r<h.r&&(d.e.r=h.r),d.e.c<b&&(d.e.c=b),l.cellDates&&p&&g.t=="n"&&Rm(gr[p.numFmtId])){var O=Pf(g.v);O&&(g.t="d",g.v=new Date(O.y,O.m-1,O.d,O.H,O.M,O.S,O.u))}ae&&(ae.type=="XLDAPR"&&(g.D=!0),ae=void 0);break;case 1:case 12:if(!l.sheetStubs||f)break;g={t:"z",v:void 0},b=Y[0].c==-1?b+1:Y[0].c,l.dense?(c[v]||(c[v]=[]),c[v][b]=g):c[Xn(b)+j]=g,d.s.r>h.r&&(d.s.r=h.r),d.s.c>b&&(d.s.c=b),d.e.r<h.r&&(d.e.r=h.r),d.e.c<b&&(d.e.c=b),ae&&(ae.type=="XLDAPR"&&(g.D=!0),ae=void 0);break;case 176:U.push(Y);break;case 49:ae=((l.xlmeta||{}).Cell||[])[Y-1];break;case 494:var L=n["!id"][Y.relId];for(L?(Y.Target=L.Target,Y.loc&&(Y.Target+="#"+Y.loc),Y.Rel=L):Y.relId==""&&(Y.Target="#"+Y.loc),v=Y.rfx.s.r;v<=Y.rfx.e.r;++v)for(b=Y.rfx.s.c;b<=Y.rfx.e.c;++b)l.dense?(c[v]||(c[v]=[]),c[v][b]||(c[v][b]={t:"z",v:void 0}),c[v][b].l=Y):(w=vr({c:b,r:v}),c[w]||(c[w]={t:"z",v:void 0}),c[w].l=Y);break;case 426:if(!l.cellFormula)break;k.push(Y),F=l.dense?c[v][b]:c[Xn(b)+j],F.f=ja(Y[1],d,{r:h.r,c:b},I,l),F.F=jr(Y[0]);break;case 427:if(!l.cellFormula)break;M[vr(Y[0].s)]=Y[1],F=l.dense?c[v][b]:c[Xn(b)+j],F.f=ja(Y[1],d,{r:h.r,c:b},I,l);break;case 60:if(!l.cellStyles)break;for(;Y.e>=Y.s;)D[Y.e--]={width:Y.w/256,hidden:!!(Y.flags&1),level:Y.level},Z||(Z=!0,t3(Y.w/256)),Pd(D[Y.e+1]);break;case 161:c["!autofilter"]={ref:jr(Y)};break;case 476:c["!margins"]=Y;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),Y.name&&(s.Sheets[r].CodeName=Y.name),(Y.above||Y.left)&&(c["!outline"]={above:Y.above,left:Y.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),Y.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!ye.T){if(!f||l.WTF)throw new Error("Unexpected record 0x"+re.toString(16))}}},l),delete l.supbooks,delete l["!row"],!c["!ref"]&&(d.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(c["!ref"]=jr(u||d)),l.sheetRows&&c["!ref"]){var de=tn(c["!ref"]);l.sheetRows<=+de.e.r&&(de.e.r=l.sheetRows-1,de.e.r>d.e.r&&(de.e.r=d.e.r),de.e.r<de.s.r&&(de.s.r=de.e.r),de.e.c>d.e.c&&(de.e.c=d.e.c),de.e.c<de.s.c&&(de.s.c=de.e.c),c["!fullref"]=c["!ref"],c["!ref"]=jr(de))}return U.length>0&&(c["!merges"]=U),D.length>0&&(c["!cols"]=D),G.length>0&&(c["!rows"]=G),c}function cse(t,e,r,n,s,a,i){if(e.v===void 0)return!1;var l="";switch(e.t){case"b":l=e.v?"1":"0";break;case"d":e=Bn(e),e.z=e.z||gr[14],e.v=Hs(Vn(e.v)),e.t="n";break;case"n":case"e":l=""+e.v;break;default:l=e.v;break}var c={r,c:n};switch(c.s=Qd(s.cellXfs,e,s),e.l&&a["!links"].push([vr(c),e.l]),e.c&&a["!comments"].push([vr(c),e.c]),e.t){case"s":case"str":return s.bookSST?(l=i3(s.Strings,e.v,s.revStrings),c.t="s",c.v=l,i?bt(t,18,Cne(e,c)):bt(t,7,Ane(e,c))):(c.t="str",i?bt(t,17,Bne(e,c)):bt(t,6,Mne(e,c))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?i?bt(t,13,Fne(e,c)):bt(t,2,Rne(e,c)):i?bt(t,16,jne(e,c)):bt(t,5,Ine(e,c)),!0;case"b":return c.t="b",i?bt(t,15,bne(e,c)):bt(t,4,yne(e,c)),!0;case"e":return c.t="e",i?bt(t,14,Sne(e,c)):bt(t,3,_ne(e,c)),!0}return i?bt(t,12,gne(e,c)):bt(t,1,mne(e,c)),!0}function use(t,e,r,n){var s=tn(e["!ref"]||"A1"),a,i="",l=[];bt(t,145);var c=Array.isArray(e),u=s.e.r;e["!rows"]&&(u=Math.max(s.e.r,e["!rows"].length-1));for(var d=s.s.r;d<=u;++d){i=Ns(d),one(t,e,s,d);var f=!1;if(d<=s.e.r)for(var m=s.s.c;m<=s.e.c;++m){d===s.s.r&&(l[m]=Xn(m)),a=l[m]+i;var h=c?(e[d]||[])[m]:e[a];if(!h){f=!1;continue}f=cse(t,h,d,m,n,e,f)}}bt(t,146)}function dse(t,e){!e||!e["!merges"]||(bt(t,177,Gne(e["!merges"].length)),e["!merges"].forEach(function(r){bt(t,176,Hne(r))}),bt(t,178))}function fse(t,e){!e||!e["!cols"]||(bt(t,390),e["!cols"].forEach(function(r,n){r&&bt(t,60,Zne(n,r))}),bt(t,391))}function hse(t,e){!e||!e["!ref"]||(bt(t,648),bt(t,649,sse(tn(e["!ref"]))),bt(t,650))}function mse(t,e,r){e["!links"].forEach(function(n){if(n[1].Target){var s=mn(r,-1,n[1].Target.replace(/#.*$/,""),Or.HLINK);bt(t,494,Yne(n,s))}}),delete e["!links"]}function pse(t,e,r,n){if(e["!comments"].length>0){var s=mn(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Or.VML);bt(t,551,GS("rId"+s)),e["!legacy"]=s}}function gse(t,e,r,n){if(e["!autofilter"]){var s=e["!autofilter"],a=typeof s.ref=="string"?s.ref:jr(s.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,l=ki(a);l.s.r==l.e.r&&(l.e.r=ki(e["!ref"]).e.r,a=jr(l));for(var c=0;c<i.length;++c){var u=i[c];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+a;break}}c==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),bt(t,161,Lm(tn(a))),bt(t,162)}}function xse(t,e,r){bt(t,133),bt(t,137,nse(e,r)),bt(t,138),bt(t,134)}function yse(t,e){e["!protect"]&&bt(t,535,ase(e["!protect"]))}function vse(t,e,r,n){var s=Ei(),a=r.SheetNames[t],i=r.Sheets[a]||{},l=a;try{r&&r.Workbook&&(l=r.Workbook.Sheets[t].CodeName||l)}catch{}var c=tn(i["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(e.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return i["!links"]=[],i["!comments"]=[],bt(s,129),(r.vbaraw||i["!outline"])&&bt(s,147,fne(l,i["!outline"])),bt(s,148,cne(c)),xse(s,i,r.Workbook),fse(s,i),use(s,i,t,e),yse(s,i),gse(s,i,r,t),dse(s,i),mse(s,i,n),i["!margins"]&&bt(s,476,tse(i["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&hse(s,i),pse(s,i,t,n),bt(s,130),s.end()}function bse(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(a){var i=a.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);i&&(e[+i[1]]=r?+i[2]:i[2])});var s=en((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(a){n=a.replace(/<.*?>/g,"")}),[e,s,n]}function wse(t,e,r,n,s,a){var i=a||{"!type":"chart"};if(!t)return a;var l=0,c=0,u="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var m=bse(f);d.s.r=d.s.c=0,d.e.c=l,u=Xn(l),m[0].forEach(function(h,g){i[u+Ns(g)]={t:"n",v:h,z:m[1]},c=g}),d.e.r<c&&(d.e.r=c),++l}),l>0&&(i["!ref"]=jr(d)),i}function _se(t,e,r,n,s){if(!t)return t;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},i,l=t.match(JF);return l&&o3(l[0],a,s,r),(i=t.match(/drawing r:id="(.*?)"/))&&(a["!rel"]=i[1]),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}function Nse(t,e){t.l+=10;var r=Ba(t);return{name:r}}function Sse(t,e,r,n,s){if(!t)return t;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},i=!1;return Jc(t,function(c,u,d){switch(d){case 550:a["!rel"]=c;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),c.name&&(s.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!i||e.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},e),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}var l3=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],Tse=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],Ase=[],Ese=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Tk(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],s=0;s!=e.length;++s){var a=e[s];if(n[a[0]]==null)n[a[0]]=a[1];else switch(a[2]){case"bool":typeof n[a[0]]=="string"&&(n[a[0]]=Ln(n[a[0]]));break;case"int":typeof n[a[0]]=="string"&&(n[a[0]]=parseInt(n[a[0]],10));break}}}function Ak(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=Ln(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function rL(t){Ak(t.WBProps,l3),Ak(t.CalcPr,Ese),Tk(t.WBView,Tse),Tk(t.Sheets,Ase),z0.date1904=Ln(t.WBProps.date1904)}function Cse(t){return!t.Workbook||!t.Workbook.WBProps?"false":Ln(t.Workbook.WBProps.date1904)?"true":"false"}var kse="][*?/\\".split("");function nL(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return kse.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function Ise(t,e,r){t.forEach(function(n,s){nL(n);for(var a=0;a<s;++a)if(n==t[a])throw new Error("Duplicate Sheet Name: "+n);if(r){var i=e&&e[s]&&e[s].CodeName||n;if(i.charCodeAt(0)==95&&i.length>22)throw new Error("Bad Code Name: Worksheet"+i)}})}function jse(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];Ise(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)Cre(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}var Pse=/<\w+:workbook/;function Rse(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,s="xmlns",a={},i=0;if(t.replace(za,function(c,u){var d=_r(c);switch(Hl(d[0])){case"<?xml":break;case"<workbook":c.match(Pse)&&(s="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=d[s];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":l3.forEach(function(f){if(d[f[0]]!=null)switch(f[2]){case"bool":r.WBProps[f[0]]=Ln(d[f[0]]);break;case"int":r.WBProps[f[0]]=parseInt(d[f[0]],10);break;default:r.WBProps[f[0]]=d[f[0]]}}),d.codeName&&(r.WBProps.CodeName=wn(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=en(wn(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":a={},a.Name=wn(d.name),d.comment&&(a.Comment=d.comment),d.localSheetId&&(a.Sheet=+d.localSheetId),Ln(d.hidden||"0")&&(a.Hidden=!0),i=u+c.length;break;case"</definedName>":a.Ref=en(wn(t.slice(i,u))),r.Names.push(a);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return c}),yh.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return rL(r),r}function sL(t){var e=[Ts];e[e.length]=Vt("workbook",null,{xmlns:yh[0],"xmlns:r":$s.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(l3.forEach(function(l){t.Workbook.WBProps[l[0]]!=null&&t.Workbook.WBProps[l[0]]!=l[1]&&(n[l[0]]=t.Workbook.WBProps[l[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=Vt("workbookPr",null,n);var s=t.Workbook&&t.Workbook.Sheets||[],a=0;if(s&&s[0]&&s[0].Hidden){for(e[e.length]="<bookViews>",a=0;a!=t.SheetNames.length&&!(!s[a]||!s[a].Hidden);++a);a==t.SheetNames.length&&(a=0),e[e.length]='<workbookView firstSheet="'+a+'" activeTab="'+a+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",a=0;a!=t.SheetNames.length;++a){var i={name:xn(t.SheetNames[a].slice(0,31))};if(i.sheetId=""+(a+1),i["r:id"]="rId"+(a+1),s[a])switch(s[a].Hidden){case 1:i.state="hidden";break;case 2:i.state="veryHidden";break}e[e.length]=Vt("sheet",null,i)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(l){var c={name:l.Name};l.Comment&&(c.comment=l.Comment),l.Sheet!=null&&(c.localSheetId=""+l.Sheet),l.Hidden&&(c.hidden="1"),l.Ref&&(e[e.length]=Vt("definedName",xn(l.Ref),c))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function Dse(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=$_(t),r.name=Ba(t),r}function Fse(t,e){return e||(e=ut(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),GS(t.strRelID,e),sa(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function Lse(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var s=e>8?Ba(t):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function Ose(t,e){e||(e=ut(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),YD(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function Mse(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function Vse(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var s=t.read_shift(4),a=pX(t),i=_re(t,0,r),l=HS(t);t.l=n;var c={Name:a,Ptg:i};return s<268435455&&(c.Sheet=s),l&&(c.Comment=l),c}function Bse(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],s=!1;e||(e={}),e.biff=12;var a=[],i=[[]];return i.SheetNames=[],i.XTI=[],sx[16]={n:"BrtFRTArchID$",f:Mse},Jc(t,function(c,u,d){switch(d){case 156:i.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(e.SID=c.Sheet),c.Ref=ja(c.Ptg,null,null,i,e),delete e.SID,delete c.Ptg,a.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:i[0].length?i.push([d,c]):i[0]=[d,c],i[i.length-1].XTI=[];break;case 362:i.length===0&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(c),i.XTI=i.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(d),s=!0;break;case 36:n.pop(),s=!1;break;case 37:n.push(d),s=!0;break;case 38:n.pop(),s=!1;break;case 16:break;default:if(!u.T){if(!s||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},e),rL(r),r.Names=a,r.supbooks=i,r}function Use(t,e){bt(t,143);for(var r=0;r!=e.SheetNames.length;++r){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,s={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};bt(t,156,Fse(s))}bt(t,144)}function $se(t,e){e||(e=ut(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return sa("SheetJS",e),sa(Wv.version,e),sa(Wv.version,e),sa("7262",e),e.length>e.l?e.slice(0,e.l):e}function zse(t,e){e||(e=ut(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function qse(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,n=0,s=-1,a=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&s==-1?s=n:r[n].Hidden==1&&a==-1&&(a=n);a>s||(bt(t,135),bt(t,158,zse(s)),bt(t,136))}}function Wse(t,e){var r=Ei();return bt(r,131),bt(r,128,$se()),bt(r,153,Ose(t.Workbook&&t.Workbook.WBProps||null)),qse(r,t),Use(r,t),bt(r,132),r.end()}function Hse(t,e,r){return e.slice(-4)===".bin"?Bse(t,r):Rse(t,r)}function Gse(t,e,r,n,s,a,i,l){return e.slice(-4)===".bin"?lse(t,n,r,s,a,i,l):Vre(t,n,r,s,a,i,l)}function Kse(t,e,r,n,s,a,i,l){return e.slice(-4)===".bin"?Sse(t,n,r,s,a):_se(t,n,r,s,a)}function Yse(t,e,r,n,s,a,i,l){return e.slice(-4)===".bin"?Qee():Jee()}function Xse(t,e,r,n,s,a,i,l){return e.slice(-4)===".bin"?Yee():Xee()}function Qse(t,e,r,n){return e.slice(-4)===".bin"?HZ(t,r,n):DZ(t,r,n)}function Jse(t,e,r){return MF(t,r)}function Zse(t,e,r){return e.slice(-4)===".bin"?ZJ(t,r):XJ(t,r)}function eae(t,e,r){return e.slice(-4)===".bin"?qee(t,r):Fee(t,r)}function tae(t,e,r){return e.slice(-4)===".bin"?Pee(t):Iee(t)}function rae(t,e,r,n){return r.slice(-4)===".bin"?Ree(t,e,r,n):void 0}function nae(t,e,r){return e.slice(-4)===".bin"?Eee(t,e,r):kee(t,e,r)}function sae(t,e,r){return(e.slice(-4)===".bin"?Wse:sL)(t)}function aae(t,e,r,n,s){return(e.slice(-4)===".bin"?vse:ZF)(t,r,n,s)}function iae(t,e,r){return(e.slice(-4)===".bin"?ree:LF)(t,r)}function oae(t,e,r){return(e.slice(-4)===".bin"?rZ:CF)(t,r)}function lae(t,e,r){return(e.slice(-4)===".bin"?Wee:UF)(t)}function cae(t){return(t.slice(-4)===".bin"?Cee:VF)()}var aL=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,iL=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function zo(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var s=t.match(aL),a,i,l,c;if(s)for(c=0;c!=s.length;++c)a=s[c].match(iL),(i=a[1].indexOf(":"))===-1?n[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?l="xmlns"+a[1].slice(6):l=a[1].slice(i+1),n[l]=a[2].slice(1,a[2].length-1));return n}function uae(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(aL),s,a,i,l;if(n)for(l=0;l!=n.length;++l)s=n[l].match(iL),(a=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?i="xmlns"+s[1].slice(6):i=s[1].slice(a+1),r[i]=s[2].slice(1,s[2].length-1));return r}var ig;function dae(t,e){var r=ig[t]||en(t);return r==="General"?ih(e):jo(r,e)}function fae(t,e,r,n){var s=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=Ln(n);break;case"i2":case"int":s=parseInt(n,10);break;case"r4":case"float":s=parseFloat(n);break;case"date":case"dateTime.tz":s=Vn(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[en(e)]=s}function hae(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||Zc[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Yg(t.v):t.w=ih(t.v):t.w=dae(e||"General",t.v)}catch(a){if(r.WTF)throw a}try{var n=ig[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&Rm(n)){var s=Pf(t.v);s&&(t.t="d",t.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(a){if(r.WTF)throw a}}}function mae(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=AZ[n.Pattern]||n.Pattern)}t[e.ID]=e}function pae(t,e,r,n,s,a,i,l,c,u){var d="General",f=n.StyleID,m={};u=u||{};var h=[],g=0;for(f===void 0&&l&&(f=l.StyleID),f===void 0&&i&&(f=i.StyleID);a[f]!==void 0&&(a[f].nf&&(d=a[f].nf),a[f].Interior&&h.push(a[f].Interior),!!a[f].Parent);)f=a[f].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Ln(t);break;case"String":n.t="s",n.r=zC(en(t)),n.v=t.indexOf("<")>-1?en(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(Vn(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=en(t):n.v<60&&(n.v=n.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=eF[t],u.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=zC(e||t));break}if(hae(n,d,u),u.cellFormula!==!1)if(n.Formula){var p=en(n.Formula);p.charCodeAt(0)==61&&(p=p.slice(1)),n.f=$0(p,s),delete n.Formula,n.ArrayRange=="RC"?n.F=$0("RC:RC",s):n.ArrayRange&&(n.F=$0(n.ArrayRange,s),c.push([tn(n.F),n.F]))}else for(g=0;g<c.length;++g)s.r>=c[g][0].s.r&&s.r<=c[g][0].e.r&&s.c>=c[g][0].s.c&&s.c<=c[g][0].e.c&&(n.F=c[g][1]);u.cellStyles&&(h.forEach(function(v){!m.patternType&&v.patternType&&(m.patternType=v.patternType)}),n.s=m),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function gae(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function Pw(t,e){var r=e||{};Dm();var n=Ip(BS(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=wn(n));var s=n.slice(0,1024).toLowerCase(),a=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var i=Bn(r);return i.type="string",vm.to_workbook(n,i)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(ct){s.indexOf("<"+ct)>=0&&(a=!0)}),a)return tie(n,r);ig={"General Number":"General","General Date":gr[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":gr[15],"Short Date":gr[14],"Long Time":gr[19],"Medium Time":gr[18],"Short Time":gr[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:gr[2],Standard:gr[4],Percent:gr[10],Scientific:gr[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,c=[],u,d={},f=[],m=r.dense?[]:{},h="",g={},p={},v=zo('<Data ss:Type="String">'),b=0,w=0,N=0,j={s:{r:2e6,c:2e6},e:{r:0,c:0}},F={},U={},A="",S=0,k=[],M={},I={},E=0,D=[],G=[],Z={},ae=[],de,se=!1,Y=[],ye=[],re={},C=0,O=0,L={Sheets:[],WBProps:{date1904:!1}},H={};Jg.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var K="";l=Jg.exec(n);)switch(l[3]=(K=l[3]).toLowerCase()){case"data":if(K=="data"){if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break}if(c[c.length-1][1])break;l[1]==="/"?pae(n.slice(b,l.index),A,v,c[c.length-1][0]=="comment"?Z:g,{c:w,r:N},F,ae[w],p,Y,r):(A="",v=zo(l[0]),b=l.index+l[0].length);break;case"cell":if(l[1]==="/")if(G.length>0&&(g.c=G),(!r.sheetRows||r.sheetRows>N)&&g.v!==void 0&&(r.dense?(m[N]||(m[N]=[]),m[N][w]=g):m[Xn(w)+Ns(N)]=g),g.HRef&&(g.l={Target:en(g.HRef)},g.HRefScreenTip&&(g.l.Tooltip=g.HRefScreenTip),delete g.HRef,delete g.HRefScreenTip),(g.MergeAcross||g.MergeDown)&&(C=w+(parseInt(g.MergeAcross,10)|0),O=N+(parseInt(g.MergeDown,10)|0),k.push({s:{c:w,r:N},e:{c:C,r:O}})),!r.sheetStubs)g.MergeAcross?w=C+1:++w;else if(g.MergeAcross||g.MergeDown){for(var q=w;q<=C;++q)for(var te=N;te<=O;++te)(q>w||te>N)&&(r.dense?(m[te]||(m[te]=[]),m[te][q]={t:"z"}):m[Xn(q)+Ns(te)]={t:"z"});w=C+1}else++w;else g=uae(l[0]),g.Index&&(w=+g.Index-1),w<j.s.c&&(j.s.c=w),w>j.e.c&&(j.e.c=w),l[0].slice(-2)==="/>"&&++w,G=[];break;case"row":l[1]==="/"||l[0].slice(-2)==="/>"?(N<j.s.r&&(j.s.r=N),N>j.e.r&&(j.e.r=N),l[0].slice(-2)==="/>"&&(p=zo(l[0]),p.Index&&(N=+p.Index-1)),w=0,++N):(p=zo(l[0]),p.Index&&(N=+p.Index-1),re={},(p.AutoFitHeight=="0"||p.Height)&&(re.hpx=parseInt(p.Height,10),re.hpt=nx(re.hpx),ye[N]=re),p.Hidden=="1"&&(re.hidden=!0,ye[N]=re));break;case"worksheet":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"));f.push(h),j.s.r<=j.e.r&&j.s.c<=j.e.c&&(m["!ref"]=jr(j),r.sheetRows&&r.sheetRows<=j.e.r&&(m["!fullref"]=m["!ref"],j.e.r=r.sheetRows-1,m["!ref"]=jr(j))),k.length&&(m["!merges"]=k),ae.length>0&&(m["!cols"]=ae),ye.length>0&&(m["!rows"]=ye),d[h]=m}else j={s:{r:2e6,c:2e6},e:{r:0,c:0}},N=w=0,c.push([l[3],!1]),u=zo(l[0]),h=en(u.Name),m=r.dense?[]:{},k=[],Y=[],ye=[],H={name:h,Hidden:0},L.Sheets.push(H);break;case"table":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else{if(l[0].slice(-2)=="/>")break;c.push([l[3],!1]),ae=[],se=!1}break;case"style":l[1]==="/"?mae(F,U,r):U=zo(l[0]);break;case"numberformat":U.nf=en(zo(l[0]).Format||"General"),ig[U.nf]&&(U.nf=ig[U.nf]);for(var oe=0;oe!=392&&gr[oe]!=U.nf;++oe);if(oe==392){for(oe=57;oe!=392;++oe)if(gr[oe]==null){jc(U.nf,oe);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(de=zo(l[0]),de.Hidden&&(de.hidden=!0,delete de.Hidden),de.Width&&(de.wpx=parseInt(de.Width,10)),!se&&de.wpx>10){se=!0,Ra=DF;for(var V=0;V<ae.length;++V)ae[V]&&Pd(ae[V])}se&&Pd(de),ae[de.Index-1||ae.length]=de;for(var xe=0;xe<+de.Span;++xe)ae[ae.length]=Bn(de);break;case"namedrange":if(l[1]==="/")break;L.Names||(L.Names=[]);var B=_r(l[0]),Ee={Name:B.Name,Ref:$0(B.RefersTo.slice(1),{r:0,c:0})};L.Sheets.length>0&&(Ee.Sheet=L.Sheets.length-1),L.Names.push(Ee);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(l[0].slice(-2)==="/>")break;l[1]==="/"?A+=n.slice(S,l.index):S=l.index+l[0].length;break;case"interior":if(!r.cellStyles)break;U.Interior=zo(l[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(l[0].slice(-2)==="/>")break;l[1]==="/"?BX(M,K,n.slice(E,l.index)):E=l.index+l[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else c.push([l[3],!1]);break;case"comment":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"));gae(Z),G.push(Z)}else c.push([l[3],!1]),u=zo(l[0]),Z={a:u.Author};break;case"autofilter":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else if(l[0].charAt(l[0].length-2)!=="/"){var Me=zo(l[0]);m["!autofilter"]={ref:$0(Me.Range).replace(/\$/g,"")},c.push([l[3],!0])}break;case"name":break;case"datavalidation":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"null":break;default:if(c.length==0&&l[3]=="document"||c.length==0&&l[3]=="uof")return jk(n,r);var Ie=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(l[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Ie=!1}break;case"componentoptions":switch(l[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Ie=!1}break;case"excelworkbook":switch(l[3]){case"date1904":L.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Ie=!1}break;case"workbookoptions":switch(l[3]){case"owcversion":break;case"height":break;case"width":break;default:Ie=!1}break;case"worksheetoptions":switch(l[3]){case"visible":if(l[0].slice(-2)!=="/>")if(l[1]==="/")switch(n.slice(E,l.index)){case"SheetHidden":H.Hidden=1;break;case"SheetVeryHidden":H.Hidden=2;break}else E=l.index+l[0].length;break;case"header":m["!margins"]||Bf(m["!margins"]={},"xlml"),isNaN(+_r(l[0]).Margin)||(m["!margins"].header=+_r(l[0]).Margin);break;case"footer":m["!margins"]||Bf(m["!margins"]={},"xlml"),isNaN(+_r(l[0]).Margin)||(m["!margins"].footer=+_r(l[0]).Margin);break;case"pagemargins":var he=_r(l[0]);m["!margins"]||Bf(m["!margins"]={},"xlml"),isNaN(+he.Top)||(m["!margins"].top=+he.Top),isNaN(+he.Left)||(m["!margins"].left=+he.Left),isNaN(+he.Right)||(m["!margins"].right=+he.Right),isNaN(+he.Bottom)||(m["!margins"].bottom=+he.Bottom);break;case"displayrighttoleft":L.Views||(L.Views=[]),L.Views[0]||(L.Views[0]={}),L.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Ie=!1}break;case"pivottable":case"pivotcache":switch(l[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Ie=!1}break;case"pagebreaks":switch(l[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Ie=!1}break;case"autofilter":switch(l[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Ie=!1}break;case"querytable":switch(l[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Ie=!1}break;case"datavalidation":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Ie=!1}break;case"sorting":case"conditionalformatting":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Ie=!1}break;case"mapinfo":case"schema":case"data":switch(l[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Ie=!1}break;case"smarttags":break;default:Ie=!1;break}if(Ie||l[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+l[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(l[0].slice(-2)==="/>")break;l[1]==="/"?fae(I,K,D,n.slice(E,l.index)):(D=l,E=l.index+l[0].length);break}if(r.WTF)throw"Unrecognized tag: "+l[3]+"|"+c.join("|")}var qe={};return!r.bookSheets&&!r.bookProps&&(qe.Sheets=d),qe.SheetNames=f,qe.Workbook=L,qe.SSF=Bn(gr),qe.Props=M,qe.Custprops=I,qe}function Y_(t,e){switch(u3(e=e||{}),e.type||"base64"){case"base64":return Pw(ro(t),e);case"binary":case"buffer":case"file":return Pw(t,e);case"array":return Pw(Yd(t),e)}}function xae(t,e){var r=[];return t.Props&&r.push(UX(t.Props,e)),t.Custprops&&r.push($X(t.Props,t.Custprops)),r.join("")}function yae(){return""}function vae(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,s){var a=[];a.push(Vt("NumberFormat",null,{"ss:Format":xn(gr[n.numFmtId])}));var i={"ss:ID":"s"+(21+s)};r.push(Vt("Style",a.join(""),i))}),Vt("Styles",r.join(""))}function oL(t){return Vt("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+s3(t.Ref,{r:0,c:0})})}function bae(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],n=0;n<e.length;++n){var s=e[n];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||r.push(oL(s)))}return Vt("Names",r.join(""))}function wae(t,e,r,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var s=n.Workbook.Names,a=[],i=0;i<s.length;++i){var l=s[i];l.Sheet==r&&(l.Name.match(/^_xlfn\./)||a.push(oL(l)))}return a.join("")}function _ae(t,e,r,n){if(!t)return"";var s=[];if(t["!margins"]&&(s.push("<PageSetup>"),t["!margins"].header&&s.push(Vt("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&s.push(Vt("Footer",null,{"x:Margin":t["!margins"].footer})),s.push(Vt("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),s.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)s.push(Vt("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var a=0;a<r&&!(n.Workbook.Sheets[a]&&!n.Workbook.Sheets[a].Hidden);++a);a==r&&s.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),t["!protect"]&&(s.push(ma("ProtectContents","True")),t["!protect"].objects&&s.push(ma("ProtectObjects","True")),t["!protect"].scenarios&&s.push(ma("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?s.push(ma("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&s.push(ma("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(i){t["!protect"][i[0]]&&s.push("<"+i[1]+"/>")})),s.length==0?"":Vt("WorksheetOptions",s.join(""),{xmlns:$i.x})}function Nae(t){return t.map(function(e){var r=qY(e.t||""),n=Vt("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Vt("Comment",n,{"ss:Author":e.a})}).join("")}function Sae(t,e,r,n,s,a,i){if(!t||t.v==null&&t.f==null)return"";var l={};if(t.f&&(l["ss:Formula"]="="+xn(s3(t.f,i))),t.F&&t.F.slice(0,e.length)==e){var c=Qn(t.F.slice(e.length+1));l["ss:ArrayRange"]="RC:R"+(c.r==i.r?"":"["+(c.r-i.r)+"]")+"C"+(c.c==i.c?"":"["+(c.c-i.c)+"]")}if(t.l&&t.l.Target&&(l["ss:HRef"]=xn(t.l.Target),t.l.Tooltip&&(l["x:HRefScreenTip"]=xn(t.l.Tooltip))),r["!merges"])for(var u=r["!merges"],d=0;d!=u.length;++d)u[d].s.c!=i.c||u[d].s.r!=i.r||(u[d].e.c>u[d].s.c&&(l["ss:MergeAcross"]=u[d].e.c-u[d].s.c),u[d].e.r>u[d].s.r&&(l["ss:MergeDown"]=u[d].e.r-u[d].s.r));var f="",m="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":f="Number",m=String(t.v);break;case"b":f="Boolean",m=t.v?"1":"0";break;case"e":f="Error",m=Zc[t.v];break;case"d":f="DateTime",m=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||gr[14]);break;case"s":f="String",m=zY(t.v||"");break}var h=Qd(n.cellXfs,t,n);l["ss:StyleID"]="s"+(21+h),l["ss:Index"]=i.c+1;var g=t.v!=null?m:"",p=t.t=="z"?"":'<Data ss:Type="'+f+'">'+g+"</Data>";return(t.c||[]).length>0&&(p+=Nae(t.c)),Vt("Cell",p,l)}function Tae(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=bm(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function Aae(t,e,r,n){if(!t["!ref"])return"";var s=tn(t["!ref"]),a=t["!merges"]||[],i=0,l=[];t["!cols"]&&t["!cols"].forEach(function(v,b){Pd(v);var w=!!v.width,N=cb(b,v),j={"ss:Index":b+1};w&&(j["ss:Width"]=tx(N.width)),v.hidden&&(j["ss:Hidden"]="1"),l.push(Vt("Column",null,j))});for(var c=Array.isArray(t),u=s.s.r;u<=s.e.r;++u){for(var d=[Tae(u,(t["!rows"]||[])[u])],f=s.s.c;f<=s.e.c;++f){var m=!1;for(i=0;i!=a.length;++i)if(!(a[i].s.c>f)&&!(a[i].s.r>u)&&!(a[i].e.c<f)&&!(a[i].e.r<u)){(a[i].s.c!=f||a[i].s.r!=u)&&(m=!0);break}if(!m){var h={r:u,c:f},g=vr(h),p=c?(t[u]||[])[f]:t[g];d.push(Sae(p,g,t,e,r,n,h))}}d.push("</Row>"),d.length>2&&l.push(d.join(""))}return l.join("")}function Eae(t,e,r){var n=[],s=r.SheetNames[t],a=r.Sheets[s],i=a?wae(a,e,t,r):"";return i.length>0&&n.push("<Names>"+i+"</Names>"),i=a?Aae(a,e,t,r):"",i.length>0&&n.push("<Table>"+i+"</Table>"),n.push(_ae(a,e,t,r)),n.join("")}function Cae(t,e){e||(e={}),t.SSF||(t.SSF=Bn(gr)),t.SSF&&(Dm(),rb(t.SSF),e.revssf=sb(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],Qd(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(xae(t,e)),r.push(yae()),r.push(""),r.push("");for(var n=0;n<t.SheetNames.length;++n)r.push(Vt("Worksheet",Eae(n,e,t),{"ss:Name":xn(t.SheetNames[n])}));return r[2]=vae(t,e),r[3]=bae(t),Ts+Vt("Workbook",r.join(""),{xmlns:$i.ss,"xmlns:o":$i.o,"xmlns:x":$i.x,"xmlns:ss":$i.ss,"xmlns:dt":$i.dt,"xmlns:html":$i.html})}function kae(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=bX(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=wX(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var Iae=[60,1084,2066,2165,2175];function jae(t,e,r,n,s){var a=n,i=[],l=r.slice(r.l,r.l+a);if(s&&s.enc&&s.enc.insitu&&l.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(l)}i.push(l),r.l+=a;for(var c=Sc(r,r.l),u=X_[c],d=0;u!=null&&Iae.indexOf(c)>-1;)a=Sc(r,r.l+2),d=r.l+4,c==2066?d+=4:(c==2165||c==2175)&&(d+=12),l=r.slice(d,r.l+4+a),i.push(l),r.l+=4+a,u=X_[c=Sc(r,r.l)];var f=na(i);ha(f,0);var m=0;f.lens=[];for(var h=0;h<i.length;++h)f.lens.push(m),m+=i[h].length;if(f.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+f.length+" < "+n;return e.f(f,f.length,s)}function _l(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=gr[n])}catch(a){if(e.WTF)throw a}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||Zc[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Yg(t.v):t.w=ih(t.v):t.w=jo(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(a){if(e.WTF)throw a}if(e.cellDates&&n&&t.t=="n"&&Rm(gr[n]||String(n))){var s=Pf(t.v);s&&(t.t="d",t.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function Z1(t,e,r){return{v:t,ixfe:e,t:r}}function Pae(t,e){var r={opts:{}},n={},s=e.dense?[]:{},a={},i={},l=null,c=[],u="",d={},f,m="",h,g,p,v,b={},w=[],N,j,F=[],U=[],A={Sheets:[],WBProps:{date1904:!1},Views:[{}]},S={},k=function(Pt){return Pt<8?Of[Pt]:Pt<64&&U[Pt-8]||Of[Pt]},M=function(Pt,ht,or){var Ve=ht.XF.data;if(!(!Ve||!Ve.patternType||!or||!or.cellStyles)){ht.s={},ht.s.patternType=Ve.patternType;var tt;(tt=ex(k(Ve.icvFore)))&&(ht.s.fgColor={rgb:tt}),(tt=ex(k(Ve.icvBack)))&&(ht.s.bgColor={rgb:tt})}},I=function(Pt,ht,or){if(!(re>1)&&!(or.sheetRows&&Pt.r>=or.sheetRows)){if(or.cellStyles&&ht.XF&&ht.XF.data&&M(Pt,ht,or),delete ht.ixfe,delete ht.XF,f=Pt,m=vr(Pt),(!i||!i.s||!i.e)&&(i={s:{r:0,c:0},e:{r:0,c:0}}),Pt.r<i.s.r&&(i.s.r=Pt.r),Pt.c<i.s.c&&(i.s.c=Pt.c),Pt.r+1>i.e.r&&(i.e.r=Pt.r+1),Pt.c+1>i.e.c&&(i.e.c=Pt.c+1),or.cellFormula&&ht.f){for(var Ve=0;Ve<w.length;++Ve)if(!(w[Ve][0].s.c>Pt.c||w[Ve][0].s.r>Pt.r)&&!(w[Ve][0].e.c<Pt.c||w[Ve][0].e.r<Pt.r)){ht.F=jr(w[Ve][0]),(w[Ve][0].s.c!=Pt.c||w[Ve][0].s.r!=Pt.r)&&delete ht.f,ht.f&&(ht.f=""+ja(w[Ve][1],i,Pt,Y,E));break}}or.dense?(s[Pt.r]||(s[Pt.r]=[]),s[Pt.r][Pt.c]=ht):s[m]=ht}},E={enc:!1,sbcch:0,snames:[],sharedf:b,arrayf:w,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(E.password=e.password);var D,G=[],Z=[],ae=[],de=[],se=!1,Y=[];Y.SheetNames=E.snames,Y.sharedf=E.sharedf,Y.arrayf=E.arrayf,Y.names=[],Y.XTI=[];var ye=0,re=0,C=0,O=[],L=[],H;E.codepage=1200,Zo(1200);for(var K=!1;t.l<t.length-1;){var q=t.l,te=t.read_shift(2);if(te===0&&ye===10)break;var oe=t.l===t.length?0:t.read_shift(2),V=X_[te];if(V&&V.f){if(e.bookSheets&&ye===133&&te!==133)break;if(ye=te,V.r===2||V.r==12){var xe=t.read_shift(2);if(oe-=2,!E.enc&&xe!==te&&((xe&255)<<8|xe>>8)!==te)throw new Error("rt mismatch: "+xe+"!="+te);V.r==12&&(t.l+=10,oe-=10)}var B={};if(te===10?B=V.f(t,oe,E):B=jae(te,V,t,oe,E),re==0&&[9,521,1033,2057].indexOf(ye)===-1)continue;switch(te){case 34:r.opts.Date1904=A.WBProps.date1904=B;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(E.enc||(t.l=0),E.enc=B,!e.password)throw new Error("File is password-protected");if(B.valid==null)throw new Error("Encryption scheme unsupported");if(!B.valid)throw new Error("Password is incorrect");break;case 92:E.lastuser=B;break;case 66:var Ee=Number(B);switch(Ee){case 21010:Ee=1200;break;case 32768:Ee=1e4;break;case 32769:Ee=1252;break}Zo(E.codepage=Ee),K=!0;break;case 317:E.rrtabid=B;break;case 25:E.winlocked=B;break;case 439:r.opts.RefreshAll=B;break;case 12:r.opts.CalcCount=B;break;case 16:r.opts.CalcDelta=B;break;case 17:r.opts.CalcIter=B;break;case 13:r.opts.CalcMode=B;break;case 14:r.opts.CalcPrecision=B;break;case 95:r.opts.CalcSaveRecalc=B;break;case 15:E.CalcRefMode=B;break;case 2211:r.opts.FullCalc=B;break;case 129:B.fDialog&&(s["!type"]="dialog"),B.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),B.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:F.push(B);break;case 430:Y.push([B]),Y[Y.length-1].XTI=[];break;case 35:case 547:Y[Y.length-1].push(B);break;case 24:case 536:H={Name:B.Name,Ref:ja(B.rgce,i,null,Y,E)},B.itab>0&&(H.Sheet=B.itab-1),Y.names.push(H),Y[0]||(Y[0]=[],Y[0].XTI=[]),Y[Y.length-1].push(B),B.Name=="_xlnm._FilterDatabase"&&B.itab>0&&B.rgce&&B.rgce[0]&&B.rgce[0][0]&&B.rgce[0][0][0]=="PtgArea3d"&&(L[B.itab-1]={ref:jr(B.rgce[0][0][1][2])});break;case 22:E.ExternCount=B;break;case 23:Y.length==0&&(Y[0]=[],Y[0].XTI=[]),Y[Y.length-1].XTI=Y[Y.length-1].XTI.concat(B),Y.XTI=Y.XTI.concat(B);break;case 2196:if(E.biff<8)break;H!=null&&(H.Comment=B[1]);break;case 18:s["!protect"]=B;break;case 19:B!==0&&E.WTF&&console.error("Password verifier: "+B);break;case 133:a[B.pos]=B,E.snames.push(B.name);break;case 10:{if(--re)break;if(i.e){if(i.e.r>0&&i.e.c>0){if(i.e.r--,i.e.c--,s["!ref"]=jr(i),e.sheetRows&&e.sheetRows<=i.e.r){var Me=i.e.r;i.e.r=e.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=jr(i),i.e.r=Me}i.e.r++,i.e.c++}G.length>0&&(s["!merges"]=G),Z.length>0&&(s["!objects"]=Z),ae.length>0&&(s["!cols"]=ae),de.length>0&&(s["!rows"]=de),A.Sheets.push(S)}u===""?d=s:n[u]=s,s=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(E.biff===8&&(E.biff={9:2,521:3,1033:4}[te]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[B.BIFFVer]||8),E.biffguess=B.BIFFVer==0,B.BIFFVer==0&&B.dt==4096&&(E.biff=5,K=!0,Zo(E.codepage=28591)),E.biff==8&&B.BIFFVer==0&&B.dt==16&&(E.biff=2),re++)break;if(s=e.dense?[]:{},E.biff<8&&!K&&(K=!0,Zo(E.codepage=e.codepage||1252)),E.biff<5||B.BIFFVer==0&&B.dt==4096){u===""&&(u="Sheet1"),i={s:{r:0,c:0},e:{r:0,c:0}};var Ie={pos:t.l-oe,name:u};a[Ie.pos]=Ie,E.snames.push(u)}else u=(a[q]||{name:""}).name;B.dt==32&&(s["!type"]="chart"),B.dt==64&&(s["!type"]="macro"),G=[],Z=[],E.arrayf=w=[],ae=[],de=[],se=!1,S={Hidden:(a[q]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(e.dense?(s[B.r]||[])[B.c]:s[vr({c:B.c,r:B.r})])&&++B.c,N={ixfe:B.ixfe,XF:F[B.ixfe]||{},v:B.val,t:"n"},C>0&&(N.z=O[N.ixfe>>8&63]),_l(N,e,r.opts.Date1904),I({c:B.c,r:B.r},N,e);break;case 5:case 517:N={ixfe:B.ixfe,XF:F[B.ixfe],v:B.val,t:B.t},C>0&&(N.z=O[N.ixfe>>8&63]),_l(N,e,r.opts.Date1904),I({c:B.c,r:B.r},N,e);break;case 638:N={ixfe:B.ixfe,XF:F[B.ixfe],v:B.rknum,t:"n"},C>0&&(N.z=O[N.ixfe>>8&63]),_l(N,e,r.opts.Date1904),I({c:B.c,r:B.r},N,e);break;case 189:for(var he=B.c;he<=B.C;++he){var qe=B.rkrec[he-B.c][0];N={ixfe:qe,XF:F[qe],v:B.rkrec[he-B.c][1],t:"n"},C>0&&(N.z=O[N.ixfe>>8&63]),_l(N,e,r.opts.Date1904),I({c:he,r:B.r},N,e)}break;case 6:case 518:case 1030:{if(B.val=="String"){l=B;break}if(N=Z1(B.val,B.cell.ixfe,B.tt),N.XF=F[N.ixfe],e.cellFormula){var ct=B.formula;if(ct&&ct[0]&&ct[0][0]&&ct[0][0][0]=="PtgExp"){var lt=ct[0][0][1][0],ue=ct[0][0][1][1],Ne=vr({r:lt,c:ue});b[Ne]?N.f=""+ja(B.formula,i,B.cell,Y,E):N.F=((e.dense?(s[lt]||[])[ue]:s[Ne])||{}).F}else N.f=""+ja(B.formula,i,B.cell,Y,E)}C>0&&(N.z=O[N.ixfe>>8&63]),_l(N,e,r.opts.Date1904),I(B.cell,N,e),l=B}break;case 7:case 519:if(l)l.val=B,N=Z1(B,l.cell.ixfe,"s"),N.XF=F[N.ixfe],e.cellFormula&&(N.f=""+ja(l.formula,i,l.cell,Y,E)),C>0&&(N.z=O[N.ixfe>>8&63]),_l(N,e,r.opts.Date1904),I(l.cell,N,e),l=null;else throw new Error("String record expects Formula");break;case 33:case 545:{w.push(B);var Ae=vr(B[0].s);if(h=e.dense?(s[B[0].s.r]||[])[B[0].s.c]:s[Ae],e.cellFormula&&h){if(!l||!Ae||!h)break;h.f=""+ja(B[1],i,B[0],Y,E),h.F=jr(B[0])}}break;case 1212:{if(!e.cellFormula)break;if(m){if(!l)break;b[vr(l.cell)]=B[0],h=e.dense?(s[l.cell.r]||[])[l.cell.c]:s[vr(l.cell)],(h||{}).f=""+ja(B[0],i,f,Y,E)}}break;case 253:N=Z1(c[B.isst].t,B.ixfe,"s"),c[B.isst].h&&(N.h=c[B.isst].h),N.XF=F[N.ixfe],C>0&&(N.z=O[N.ixfe>>8&63]),_l(N,e,r.opts.Date1904),I({c:B.c,r:B.r},N,e);break;case 513:e.sheetStubs&&(N={ixfe:B.ixfe,XF:F[B.ixfe],t:"z"},C>0&&(N.z=O[N.ixfe>>8&63]),_l(N,e,r.opts.Date1904),I({c:B.c,r:B.r},N,e));break;case 190:if(e.sheetStubs)for(var Be=B.c;Be<=B.C;++Be){var Ue=B.ixfe[Be-B.c];N={ixfe:Ue,XF:F[Ue],t:"z"},C>0&&(N.z=O[N.ixfe>>8&63]),_l(N,e,r.opts.Date1904),I({c:Be,r:B.r},N,e)}break;case 214:case 516:case 4:N=Z1(B.val,B.ixfe,"s"),N.XF=F[N.ixfe],C>0&&(N.z=O[N.ixfe>>8&63]),_l(N,e,r.opts.Date1904),I({c:B.c,r:B.r},N,e);break;case 0:case 512:re===1&&(i=B);break;case 252:c=B;break;case 1054:if(E.biff==4){O[C++]=B[1];for(var Ce=0;Ce<C+163&&gr[Ce]!=B[1];++Ce);Ce>=163&&jc(B[1],C+163)}else jc(B[1],B[0]);break;case 30:{O[C++]=B;for(var Ye=0;Ye<C+163&&gr[Ye]!=B;++Ye);Ye>=163&&jc(B,C+163)}break;case 229:G=G.concat(B);break;case 93:Z[B.cmo[0]]=E.lastobj=B;break;case 438:E.lastobj.TxO=B;break;case 127:E.lastobj.ImData=B;break;case 440:for(v=B[0].s.r;v<=B[0].e.r;++v)for(p=B[0].s.c;p<=B[0].e.c;++p)h=e.dense?(s[v]||[])[p]:s[vr({c:p,r:v})],h&&(h.l=B[1]);break;case 2048:for(v=B[0].s.r;v<=B[0].e.r;++v)for(p=B[0].s.c;p<=B[0].e.c;++p)h=e.dense?(s[v]||[])[p]:s[vr({c:p,r:v})],h&&h.l&&(h.l.Tooltip=B[1]);break;case 28:{if(E.biff<=5&&E.biff>=2)break;h=e.dense?(s[B[0].r]||[])[B[0].c]:s[vr(B[0])];var It=Z[B[2]];h||(e.dense?(s[B[0].r]||(s[B[0].r]=[]),h=s[B[0].r][B[0].c]={t:"z"}):h=s[vr(B[0])]={t:"z"},i.e.r=Math.max(i.e.r,B[0].r),i.s.r=Math.min(i.s.r,B[0].r),i.e.c=Math.max(i.e.c,B[0].c),i.s.c=Math.min(i.s.c,B[0].c)),h.c||(h.c=[]),g={a:B[1],t:It.TxO.t},h.c.push(g)}break;case 2173:vee(F[B.ixfe],B.ext);break;case 125:{if(!E.cellStyles)break;for(;B.e>=B.s;)ae[B.e--]={width:B.w/256,level:B.level||0,hidden:!!(B.flags&1)},se||(se=!0,t3(B.w/256)),Pd(ae[B.e+1])}break;case 520:{var Dt={};B.level!=null&&(de[B.r]=Dt,Dt.level=B.level),B.hidden&&(de[B.r]=Dt,Dt.hidden=!0),B.hpt&&(de[B.r]=Dt,Dt.hpt=B.hpt,Dt.hpx=bm(B.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||Bf(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[te]]=B;break;case 161:s["!margins"]||Bf(s["!margins"]={}),s["!margins"].header=B.header,s["!margins"].footer=B.footer;break;case 574:B.RTL&&(A.Views[0].RTL=!0);break;case 146:U=B;break;case 2198:D=B;break;case 140:j=B;break;case 442:u?S.CodeName=B||S.name:A.WBProps.CodeName=B||"ThisWorkbook";break}}else V||console.error("Missing Info for XLS Record 0x"+te.toString(16)),t.l+=oe}return r.SheetNames=fs(a).sort(function(Ot,Pt){return Number(Ot)-Number(Pt)}).map(function(Ot){return a[Ot].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&L.forEach(function(Ot,Pt){r.Sheets[r.SheetNames[Pt]]["!autofilter"]=Ot}),r.Strings=c,r.SSF=Bn(gr),E.enc&&(r.Encryption=E.enc),D&&(r.Themes=D),r.Metadata={},j!==void 0&&(r.Metadata.Country=j),Y.names.length>0&&(A.Names=Y.names),r.Workbook=A,r}var og={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function Rae(t,e,r){var n=lr.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var s=ok(n,z_,og.DSI);for(var a in s)e[a]=s[a]}catch(u){if(r.WTF)throw u}var i=lr.find(t,"/!SummaryInformation");if(i&&i.size>0)try{var l=ok(i,q_,og.SI);for(var c in l)e[c]==null&&(e[c]=l[c])}catch(u){if(r.WTF)throw u}e.HeadingPairs&&e.TitlesOfParts&&(iF(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function Dae(t,e){var r=[],n=[],s=[],a=0,i,l=OC(z_,"n"),c=OC(q_,"n");if(t.Props)for(i=fs(t.Props),a=0;a<i.length;++a)(Object.prototype.hasOwnProperty.call(l,i[a])?r:Object.prototype.hasOwnProperty.call(c,i[a])?n:s).push([i[a],t.Props[i[a]]]);if(t.Custprops)for(i=fs(t.Custprops),a=0;a<i.length;++a)Object.prototype.hasOwnProperty.call(t.Props||{},i[a])||(Object.prototype.hasOwnProperty.call(l,i[a])?r:Object.prototype.hasOwnProperty.call(c,i[a])?n:s).push([i[a],t.Custprops[i[a]]]);var u=[];for(a=0;a<s.length;++a)hF.indexOf(s[a][0])>-1||aF.indexOf(s[a][0])>-1||s[a][1]!=null&&u.push(s[a]);n.length&&lr.utils.cfb_add(e,"/SummaryInformation",lk(n,og.SI,c,q_)),(r.length||u.length)&&lr.utils.cfb_add(e,"/DocumentSummaryInformation",lk(r,og.DSI,l,z_,u.length?u:null,og.UDI))}function lL(t,e){e||(e={}),u3(e),jS(),e.codepage&&IS(e.codepage);var r,n;if(t.FullPaths){if(lr.find(t,"/encryption"))throw new Error("File is password-protected");r=lr.find(t,"!CompObj"),n=lr.find(t,"/Workbook")||lr.find(t,"/Book")}else{switch(e.type){case"base64":t=qi(ro(t));break;case"binary":t=qi(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}ha(t,0),n={content:t}}var s,a;if(r&&kae(r),e.bookProps&&!e.bookSheets)s={};else{var i=Dr?"buffer":"array";if(n&&n.content)s=Pae(n.content,e);else if((a=lr.find(t,"PerfectOffice_MAIN"))&&a.content)s=Vf.to_workbook(a.content,(e.type=i,e));else if((a=lr.find(t,"NativeContent_MAIN"))&&a.content)s=Vf.to_workbook(a.content,(e.type=i,e));else throw(a=lr.find(t,"MN0"))&&a.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&lr.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=Gee(t))}var l={};return t.FullPaths&&Rae(t,l,e),s.Props=s.Custprops=l,e.bookFiles&&(s.cfb=t),s}function Fae(t,e){var r=e||{},n=lr.utils.cfb_new({root:"R"}),s="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":s="/Workbook",r.biff=8;break;case"biff5":s="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return lr.utils.cfb_add(n,s,cL(t,r)),r.biff==8&&(t.Props||t.Custprops)&&Dae(t,n),r.biff==8&&t.vbaraw&&Kee(n,lr.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var sx={0:{f:ane},1:{f:hne},2:{f:Pne},3:{f:wne},4:{f:xne},5:{f:kne},6:{f:One},7:{f:Tne},8:{f:qne},9:{f:zne},10:{f:Une},11:{f:$ne},12:{f:pne},13:{f:Dne},14:{f:Nne},15:{f:vne},16:{f:eL},17:{f:Vne},18:{f:Ene},19:{f:WS},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:Vse},40:{},42:{},43:{f:OZ},44:{f:FZ},45:{f:BZ},46:{f:$Z},47:{f:UZ},48:{},49:{f:lX},50:{},51:{f:_ee},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:SF},62:{f:Lne},63:{f:jee},64:{f:ise},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:$a,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:rse},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:dne},148:{f:lne,p:16},151:{f:Xne},152:{},153:{f:Lse},154:{},155:{},156:{f:Dse},157:{},158:{},159:{T:1,f:JJ},160:{T:-1},161:{T:1,f:_h},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Wne},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:bee},336:{T:-1},337:{f:Tee,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:$_},357:{},358:{},359:{},360:{T:1},361:{},362:{f:NF},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:Qne},427:{f:Jne},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:ese},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:une},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:Kne},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:$_},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:$ee},633:{T:1},634:{T:-1},635:{T:1,f:Bee},636:{T:-1},637:{f:fX},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Nse},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:ose},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},X_={6:{f:Iw},10:{f:ju},12:{f:Ds},13:{f:Ds},14:{f:ps},15:{f:ps},16:{f:Fa},17:{f:ps},18:{f:ps},19:{f:Ds},20:{f:mk},21:{f:mk},23:{f:NF},24:{f:gk},25:{f:ps},26:{},27:{},28:{f:oJ},29:{},34:{f:ps},35:{f:pk},38:{f:Fa},39:{f:Fa},40:{f:Fa},41:{f:Fa},42:{f:ps},43:{f:ps},47:{f:vZ},49:{f:DQ},51:{f:Ds},60:{},61:{f:kQ},64:{f:ps},65:{f:RQ},66:{f:Ds},77:{},80:{},81:{},82:{},85:{f:Ds},89:{},90:{},91:{},92:{f:yQ},93:{f:uJ},94:{},95:{f:ps},96:{},97:{},99:{f:ps},125:{f:SF},128:{f:YQ},129:{f:bQ},130:{f:Ds},131:{f:ps},132:{f:ps},133:{f:wQ},134:{},140:{f:yJ},141:{f:Ds},144:{},146:{f:wJ},151:{},152:{},153:{},154:{},155:{},156:{f:Ds},157:{},158:{},160:{f:CJ},161:{f:SJ},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:WQ},190:{f:HQ},193:{f:ju},197:{},198:{},199:{},200:{},201:{},202:{f:ps},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Ds},220:{},221:{f:ps},222:{},224:{f:KQ},225:{f:xQ},226:{f:ju},227:{},229:{f:lJ},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:NQ},253:{f:LQ},255:{f:TQ},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:mF},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:ps},353:{f:ju},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:eJ},431:{f:ps},432:{},433:{},434:{},437:{},438:{f:hJ},439:{f:ps},440:{f:mJ},441:{},442:{f:$x},443:{},444:{f:Ds},445:{},446:{},448:{f:ju},449:{f:CQ,r:2},450:{f:ju},512:{f:dk},513:{f:EJ},515:{f:JQ},516:{f:MQ},517:{f:hk},519:{f:kJ},520:{f:AQ},523:{},545:{f:xk},549:{f:uk},566:{},574:{f:jQ},638:{f:qQ},659:{},1048:{},1054:{f:BQ},1084:{},1212:{f:sJ},2048:{f:gJ},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:X1},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:ju},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:_J,r:12},2173:{f:yee,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:ps,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:nJ,r:12},2197:{},2198:{f:fee,r:12},2199:{},2200:{},2201:{},2202:{f:aJ,r:12},2203:{f:ju},2204:{},2205:{},2206:{},2207:{},2211:{f:EQ},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Ds},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:TJ},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:bJ},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:dk},1:{},2:{f:DJ},3:{f:PJ},4:{f:jJ},5:{f:hk},7:{f:LJ},8:{},9:{f:X1},11:{},22:{f:Ds},30:{f:$Q},31:{},32:{},33:{f:xk},36:{},37:{f:uk},50:{f:OJ},62:{},52:{},67:{},68:{f:Ds},69:{},86:{},126:{},127:{f:IJ},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:MJ},223:{},234:{},354:{},421:{},518:{f:Iw},521:{f:X1},536:{f:gk},547:{f:pk},561:{},579:{},1030:{f:Iw},1033:{f:X1},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Ut(t,e,r,n){var s=e;if(!isNaN(s)){var a=n||(r||[]).length||0,i=t.next(4);i.write_shift(2,s),i.write_shift(2,a),a>0&&$S(r)&&t.push(r)}}function Lae(t,e,r,n){var s=(r||[]).length||0;if(s<=8224)return Ut(t,e,r,s);var a=e;if(!isNaN(a)){for(var i=r.parts||[],l=0,c=0,u=0;u+(i[l]||8224)<=8224;)u+=i[l]||8224,l++;var d=t.next(4);for(d.write_shift(2,a),d.write_shift(2,u),t.push(r.slice(c,c+u)),c+=u;c<s;){for(d=t.next(4),d.write_shift(2,60),u=0;u+(i[l]||8224)<=8224;)u+=i[l]||8224,l++;d.write_shift(2,u),t.push(r.slice(c,c+u)),c+=u}}}function Hx(t,e,r){return t||(t=ut(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function Oae(t,e,r,n){var s=ut(9);return Hx(s,t,e),pF(r,n||"b",s),s}function Mae(t,e,r){var n=ut(8+2*r.length);return Hx(n,t,e),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function Vae(t,e,r,n){if(e.v!=null)switch(e.t){case"d":case"n":var s=e.t=="d"?Hs(Vn(e.v)):e.v;s==(s|0)&&s>=0&&s<65536?Ut(t,2,FJ(r,n,s)):Ut(t,3,RJ(r,n,s));return;case"b":case"e":Ut(t,5,Oae(r,n,e.v,e.t));return;case"s":case"str":Ut(t,4,Mae(r,n,(e.v||"").slice(0,255)));return}Ut(t,1,Hx(null,r,n))}function Bae(t,e,r,n){var s=Array.isArray(e),a=tn(e["!ref"]||"A1"),i,l="",c=[];if(a.e.c>255||a.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");a.e.c=Math.min(a.e.c,255),a.e.r=Math.min(a.e.c,16383),i=jr(a)}for(var u=a.s.r;u<=a.e.r;++u){l=Ns(u);for(var d=a.s.c;d<=a.e.c;++d){u===a.s.r&&(c[d]=Xn(d)),i=c[d]+l;var f=s?(e[u]||[])[d]:e[i];f&&Vae(t,f,u,d)}}}function Uae(t,e){for(var r=e||{},n=Ei(),s=0,a=0;a<t.SheetNames.length;++a)t.SheetNames[a]==r.sheet&&(s=a);if(s==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Ut(n,r.biff==4?1033:r.biff==3?521:9,JS(t,16,r)),Bae(n,t.Sheets[t.SheetNames[s]],s,r),Ut(n,10),n.end()}function $ae(t,e,r){Ut(t,49,FQ({sz:12,name:"Arial"},r))}function zae(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)e[s]!=null&&Ut(t,1054,UQ(s,e[s],r))})}function qae(t,e){var r=ut(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Ut(t,2151,r),r=ut(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),bF(tn(e["!ref"]||"A1"),r),r.write_shift(4,4),Ut(t,2152,r)}function Wae(t,e){for(var r=0;r<16;++r)Ut(t,224,fk({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){Ut(t,224,fk(n,0,e))})}function Hae(t,e){for(var r=0;r<e["!links"].length;++r){var n=e["!links"][r];Ut(t,440,pJ(n)),n[1].Tooltip&&Ut(t,2048,xJ(n))}delete e["!links"]}function Gae(t,e){if(e){var r=0;e.forEach(function(n,s){++r<=256&&n&&Ut(t,125,NJ(cb(s,n),s))})}}function Kae(t,e,r,n,s){var a=16+Qd(s.cellXfs,e,s);if(e.v==null&&!e.bf){Ut(t,513,uh(r,n,a));return}if(e.bf)Ut(t,6,bre(e,r,n,s,a));else switch(e.t){case"d":case"n":var i=e.t=="d"?Hs(Vn(e.v)):e.v;Ut(t,515,ZQ(r,n,i,a));break;case"b":case"e":Ut(t,517,QQ(r,n,e.v,a,s,e.t));break;case"s":case"str":if(s.bookSST){var l=i3(s.Strings,e.v,s.revStrings);Ut(t,253,OQ(r,n,l,a))}else Ut(t,516,VQ(r,n,(e.v||"").slice(0,255),a,s));break;default:Ut(t,513,uh(r,n,a))}}function Yae(t,e,r){var n=Ei(),s=r.SheetNames[t],a=r.Sheets[s]||{},i=(r||{}).Workbook||{},l=(i.Sheets||[])[t]||{},c=Array.isArray(a),u=e.biff==8,d,f="",m=[],h=tn(a["!ref"]||"A1"),g=u?65536:16384;if(h.e.c>255||h.e.r>=g){if(e.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:IV16384");h.e.c=Math.min(h.e.c,255),h.e.r=Math.min(h.e.c,g-1)}Ut(n,2057,JS(r,16,e)),Ut(n,13,bo(1)),Ut(n,12,bo(100)),Ut(n,15,Qa(!0)),Ut(n,17,Qa(!1)),Ut(n,16,lh(.001)),Ut(n,95,Qa(!0)),Ut(n,42,Qa(!1)),Ut(n,43,Qa(!1)),Ut(n,130,bo(1)),Ut(n,128,XQ()),Ut(n,131,Qa(!1)),Ut(n,132,Qa(!1)),u&&Gae(n,a["!cols"]),Ut(n,512,zQ(h,e)),u&&(a["!links"]=[]);for(var p=h.s.r;p<=h.e.r;++p){f=Ns(p);for(var v=h.s.c;v<=h.e.c;++v){p===h.s.r&&(m[v]=Xn(v)),d=m[v]+f;var b=c?(a[p]||[])[v]:a[d];b&&(Kae(n,b,p,v,e),u&&b.l&&a["!links"].push([d,b.l]))}}var w=l.CodeName||l.name||s;return u&&Ut(n,574,PQ((i.Views||[])[0])),u&&(a["!merges"]||[]).length&&Ut(n,229,cJ(a["!merges"])),u&&Hae(n,a),Ut(n,442,gF(w)),u&&qae(n,a),Ut(n,10),n.end()}function Xae(t,e,r){var n=Ei(),s=(t||{}).Workbook||{},a=s.Sheets||[],i=s.WBProps||{},l=r.biff==8,c=r.biff==5;if(Ut(n,2057,JS(t,5,r)),r.bookType=="xla"&&Ut(n,135),Ut(n,225,l?bo(1200):null),Ut(n,193,QX(2)),c&&Ut(n,191),c&&Ut(n,192),Ut(n,226),Ut(n,92,vQ("SheetJS",r)),Ut(n,66,bo(l?1200:1252)),l&&Ut(n,353,bo(0)),l&&Ut(n,448),Ut(n,317,AJ(t.SheetNames.length)),l&&t.vbaraw&&Ut(n,211),l&&t.vbaraw){var u=i.CodeName||"ThisWorkbook";Ut(n,442,gF(u))}Ut(n,156,bo(17)),Ut(n,25,Qa(!1)),Ut(n,18,Qa(!1)),Ut(n,19,bo(0)),l&&Ut(n,431,Qa(!1)),l&&Ut(n,444,bo(0)),Ut(n,61,IQ()),Ut(n,64,Qa(!1)),Ut(n,141,bo(0)),Ut(n,34,Qa(Cse(t)=="true")),Ut(n,14,Qa(!0)),l&&Ut(n,439,Qa(!1)),Ut(n,218,bo(0)),$ae(n,t,r),zae(n,t.SSF,r),Wae(n,r),l&&Ut(n,352,Qa(!1));var d=n.end(),f=Ei();l&&Ut(f,140,vJ()),l&&r.Strings&&Lae(f,252,SQ(r.Strings)),Ut(f,10);var m=f.end(),h=Ei(),g=0,p=0;for(p=0;p<t.SheetNames.length;++p)g+=(l?12:11)+(l?2:1)*t.SheetNames[p].length;var v=d.length+g+m.length;for(p=0;p<t.SheetNames.length;++p){var b=a[p]||{};Ut(h,133,_Q({pos:v,hs:b.Hidden||0,dt:0,name:t.SheetNames[p]},r)),v+=e[p].length}var w=h.end();if(g!=w.length)throw new Error("BS8 "+g+" != "+w.length);var N=[];return d.length&&N.push(d),w.length&&N.push(w),m.length&&N.push(m),na(N)}function Qae(t,e){var r=e||{},n=[];t&&!t.SSF&&(t.SSF=Bn(gr)),t&&t.SSF&&(Dm(),rb(t.SSF),r.revssf=sb(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,d3(r),r.cellXfs=[],Qd(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var s=0;s<t.SheetNames.length;++s)n[n.length]=Yae(s,r,t);return n.unshift(Xae(t,n,r)),na(n)}function cL(t,e){for(var r=0;r<=t.SheetNames.length;++r){var n=t.Sheets[t.SheetNames[r]];if(!(!n||!n["!ref"])){var s=ki(n["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var a=e||{};switch(a.biff||2){case 8:case 5:return Qae(t,e);case 4:case 3:case 2:return Uae(t,e)}throw new Error("invalid type "+a.bookType+" for BIFF")}function Ek(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var s=t.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var a=t.match(/<\/table/i),i=s.index,l=a&&a.index||t.length,c=FY(t.slice(i,l),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,d=0,f=0,m=0,h={s:{r:1e7,c:1e7},e:{r:0,c:0}},g=[];for(i=0;i<c.length;++i){var p=c[i].trim(),v=p.slice(0,3).toLowerCase();if(v=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}d=0;continue}if(!(v!="<td"&&v!="<th")){var b=p.split(/<\/t[dh]>/i);for(l=0;l<b.length;++l){var w=b[l].trim();if(w.match(/<t[dh]/i)){for(var N=w,j=0;N.charAt(0)=="<"&&(j=N.indexOf(">"))>-1;)N=N.slice(j+1);for(var F=0;F<g.length;++F){var U=g[F];U.s.c==d&&U.s.r<u&&u<=U.e.r&&(d=U.e.c+1,F=-1)}var A=_r(w.slice(0,w.indexOf(">")));m=A.colspan?+A.colspan:1,((f=+A.rowspan)>1||m>1)&&g.push({s:{r:u,c:d},e:{r:u+(f||1)-1,c:d+m-1}});var S=A.t||A["data-t"]||"";if(!N.length){d+=m;continue}if(N=RD(N),h.s.r>u&&(h.s.r=u),h.e.r<u&&(h.e.r=u),h.s.c>d&&(h.s.c=d),h.e.c<d&&(h.e.c=d),!N.length){d+=m;continue}var k={t:"s",v:N};r.raw||!N.trim().length||S=="s"||(N==="TRUE"?k={t:"b",v:!0}:N==="FALSE"?k={t:"b",v:!1}:isNaN(sl(N))?isNaN(ym(N).getDate())||(k={t:"d",v:Vn(N)},r.cellDates||(k={t:"n",v:Hs(k.v)}),k.z=r.dateNF||gr[14]):k={t:"n",v:sl(N)}),r.dense?(n[u]||(n[u]=[]),n[u][d]=k):n[vr({r:u,c:d})]=k,d+=m}}}}return n["!ref"]=jr(h),g.length&&(n["!merges"]=g),n}function Jae(t,e,r,n){for(var s=t["!merges"]||[],a=[],i=e.s.c;i<=e.e.c;++i){for(var l=0,c=0,u=0;u<s.length;++u)if(!(s[u].s.r>r||s[u].s.c>i)&&!(s[u].e.r<r||s[u].e.c<i)){if(s[u].s.r<r||s[u].s.c<i){l=-1;break}l=s[u].e.r-s[u].s.r+1,c=s[u].e.c-s[u].s.c+1;break}if(!(l<0)){var d=vr({r,c:i}),f=n.dense?(t[r]||[])[i]:t[d],m=f&&f.v!=null&&(f.h||VS(f.w||(qc(f),f.w)||""))||"",h={};l>1&&(h.rowspan=l),c>1&&(h.colspan=c),n.editable?m='<span contenteditable="true">'+m+"</span>":f&&(h["data-t"]=f&&f.t||"z",f.v!=null&&(h["data-v"]=f.v),f.z!=null&&(h["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(m='<a href="'+f.l.Target+'">'+m+"</a>")),h.id=(n.id||"sjs")+"-"+d,a.push(Vt("td",m,h))}}var g="<tr>";return g+a.join("")+"</tr>"}var Zae='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',eie="</body></html>";function tie(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Xd(Ek(r[0],e),e);var n=m3();return r.forEach(function(s,a){p3(n,Ek(s,e),"Sheet"+(a+1))}),n}function rie(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function uL(t,e){var r=e||{},n=r.header!=null?r.header:Zae,s=r.footer!=null?r.footer:eie,a=[n],i=ki(t["!ref"]);r.dense=Array.isArray(t),a.push(rie(t,i,r));for(var l=i.s.r;l<=i.e.r;++l)a.push(Jae(t,i,l,r));return a.push("</table>"+s),a.join("")}function dL(t,e,r){var n=r||{},s=0,a=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var i=typeof n.origin=="string"?Qn(n.origin):n.origin;s=i.r,a=i.c}var l=e.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,l.length),u={s:{r:0,c:0},e:{r:s,c:a}};if(t["!ref"]){var d=ki(t["!ref"]);u.s.r=Math.min(u.s.r,d.s.r),u.s.c=Math.min(u.s.c,d.s.c),u.e.r=Math.max(u.e.r,d.e.r),u.e.c=Math.max(u.e.c,d.e.c),s==-1&&(u.e.r=s=d.e.r+1)}var f=[],m=0,h=t["!rows"]||(t["!rows"]=[]),g=0,p=0,v=0,b=0,w=0,N=0;for(t["!cols"]||(t["!cols"]=[]);g<l.length&&p<c;++g){var j=l[g];if(Ck(j)){if(n.display)continue;h[p]={hidden:!0}}var F=j.children;for(v=b=0;v<F.length;++v){var U=F[v];if(!(n.display&&Ck(U))){var A=U.hasAttribute("data-v")?U.getAttribute("data-v"):U.hasAttribute("v")?U.getAttribute("v"):RD(U.innerHTML),S=U.getAttribute("data-z")||U.getAttribute("z");for(m=0;m<f.length;++m){var k=f[m];k.s.c==b+a&&k.s.r<p+s&&p+s<=k.e.r&&(b=k.e.c+1-a,m=-1)}N=+U.getAttribute("colspan")||1,((w=+U.getAttribute("rowspan")||1)>1||N>1)&&f.push({s:{r:p+s,c:b+a},e:{r:p+s+(w||1)-1,c:b+a+(N||1)-1}});var M={t:"s",v:A},I=U.getAttribute("data-t")||U.getAttribute("t")||"";A!=null&&(A.length==0?M.t=I||"z":n.raw||A.trim().length==0||I=="s"||(A==="TRUE"?M={t:"b",v:!0}:A==="FALSE"?M={t:"b",v:!1}:isNaN(sl(A))?isNaN(ym(A).getDate())||(M={t:"d",v:Vn(A)},n.cellDates||(M={t:"n",v:Hs(M.v)}),M.z=n.dateNF||gr[14]):M={t:"n",v:sl(A)})),M.z===void 0&&S!=null&&(M.z=S);var E="",D=U.getElementsByTagName("A");if(D&&D.length)for(var G=0;G<D.length&&!(D[G].hasAttribute("href")&&(E=D[G].getAttribute("href"),E.charAt(0)!="#"));++G);E&&E.charAt(0)!="#"&&(M.l={Target:E}),n.dense?(t[p+s]||(t[p+s]=[]),t[p+s][b+a]=M):t[vr({c:b+a,r:p+s})]=M,u.e.c<b+a&&(u.e.c=b+a),b+=N}}++p}return f.length&&(t["!merges"]=(t["!merges"]||[]).concat(f)),u.e.r=Math.max(u.e.r,p-1+s),t["!ref"]=jr(u),p>=c&&(t["!fullref"]=jr((u.e.r=l.length-g+p-1+s,u))),t}function fL(t,e){var r=e||{},n=r.dense?[]:{};return dL(n,t,e)}function nie(t,e){return Xd(fL(t,e),e)}function Ck(t){var e="",r=sie(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function sie(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function aie(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=en(e.replace(/<[^>]*>/g,""));return[r]}var kk={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function hL(t,e){var r=e||{},n=BS(t),s=[],a,i,l={name:""},c="",u=0,d,f,m={},h=[],g=r.dense?[]:{},p,v,b={value:""},w="",N=0,j=[],F=-1,U=-1,A={s:{r:1e6,c:1e7},e:{r:0,c:0}},S=0,k={},M=[],I={},E=0,D=0,G=[],Z=1,ae=1,de=[],se={Names:[]},Y={},ye=["",""],re=[],C={},O="",L=0,H=!1,K=!1,q=0;for(Jg.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");p=Jg.exec(n);)switch(p[3]=p[3].replace(/_.*$/,"")){case"table":case"":p[1]==="/"?(A.e.c>=A.s.c&&A.e.r>=A.s.r?g["!ref"]=jr(A):g["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=A.e.r&&(g["!fullref"]=g["!ref"],A.e.r=r.sheetRows-1,g["!ref"]=jr(A)),M.length&&(g["!merges"]=M),G.length&&(g["!rows"]=G),d.name=d.||d.name,typeof JSON<"u"&&JSON.stringify(d),h.push(d.name),m[d.name]=g,K=!1):p[0].charAt(p[0].length-2)!=="/"&&(d=_r(p[0],!1),F=U=-1,A.s.r=A.s.c=1e7,A.e.r=A.e.c=0,g=r.dense?[]:{},M=[],G=[],K=!0);break;case"table-row-group":p[1]==="/"?--S:++S;break;case"table-row":case"":if(p[1]==="/"){F+=Z,Z=1;break}if(f=_r(p[0],!1),f.?F=f.-1:F==-1&&(F=0),Z=+f["number-rows-repeated"]||1,Z<10)for(q=0;q<Z;++q)S>0&&(G[F+q]={level:S});U=-1;break;case"covered-table-cell":p[1]!=="/"&&++U,r.sheetStubs&&(r.dense?(g[F]||(g[F]=[]),g[F][U]={t:"z"}):g[vr({r:F,c:U})]={t:"z"}),w="",j=[];break;case"table-cell":case"":if(p[0].charAt(p[0].length-2)==="/")++U,b=_r(p[0],!1),ae=parseInt(b["number-columns-repeated"]||"1",10),v={t:"z",v:null},b.formula&&r.cellFormula!=!1&&(v.f=Sk(en(b.formula))),(b.||b["value-type"])=="string"&&(v.t="s",v.v=en(b["string-value"]||""),r.dense?(g[F]||(g[F]=[]),g[F][U]=v):g[vr({r:F,c:U})]=v),U+=ae-1;else if(p[1]!=="/"){++U,w="",N=0,j=[],ae=1;var te=Z?F+Z-1:F;if(U>A.e.c&&(A.e.c=U),U<A.s.c&&(A.s.c=U),F<A.s.r&&(A.s.r=F),te>A.e.r&&(A.e.r=te),b=_r(p[0],!1),re=[],C={},v={t:b.||b["value-type"],v:null},r.cellFormula)if(b.formula&&(b.formula=en(b.formula)),b["number-matrix-columns-spanned"]&&b["number-matrix-rows-spanned"]&&(E=parseInt(b["number-matrix-rows-spanned"],10)||0,D=parseInt(b["number-matrix-columns-spanned"],10)||0,I={s:{r:F,c:U},e:{r:F+E-1,c:U+D-1}},v.F=jr(I),de.push([I,v.F])),b.formula)v.f=Sk(b.formula);else for(q=0;q<de.length;++q)F>=de[q][0].s.r&&F<=de[q][0].e.r&&U>=de[q][0].s.c&&U<=de[q][0].e.c&&(v.F=de[q][1]);switch((b["number-columns-spanned"]||b["number-rows-spanned"])&&(E=parseInt(b["number-rows-spanned"],10)||0,D=parseInt(b["number-columns-spanned"],10)||0,I={s:{r:F,c:U},e:{r:F+E-1,c:U+D-1}},M.push(I)),b["number-columns-repeated"]&&(ae=parseInt(b["number-columns-repeated"],10)),v.t){case"boolean":v.t="b",v.v=Ln(b["boolean-value"]);break;case"float":v.t="n",v.v=parseFloat(b.value);break;case"percentage":v.t="n",v.v=parseFloat(b.value);break;case"currency":v.t="n",v.v=parseFloat(b.value);break;case"date":v.t="d",v.v=Vn(b["date-value"]),r.cellDates||(v.t="n",v.v=Hs(v.v)),v.z="m/d/yy";break;case"time":v.t="n",v.v=PY(b["time-value"])/86400,r.cellDates&&(v.t="d",v.v=ab(v.v)),v.z="HH:MM:SS";break;case"number":v.t="n",v.v=parseFloat(b.);break;default:if(v.t==="string"||v.t==="text"||!v.t)v.t="s",b["string-value"]!=null&&(w=en(b["string-value"]),j=[]);else throw new Error("Unsupported value type "+v.t)}}else{if(H=!1,v.t==="s"&&(v.v=w||"",j.length&&(v.R=j),H=N==0),Y.Target&&(v.l=Y),re.length>0&&(v.c=re,re=[]),w&&r.cellText!==!1&&(v.w=w),H&&(v.t="z",delete v.v),(!H||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=F))for(var oe=0;oe<Z;++oe){if(ae=parseInt(b["number-columns-repeated"]||"1",10),r.dense)for(g[F+oe]||(g[F+oe]=[]),g[F+oe][U]=oe==0?v:Bn(v);--ae>0;)g[F+oe][U+ae]=Bn(v);else for(g[vr({r:F+oe,c:U})]=v;--ae>0;)g[vr({r:F+oe,c:U+ae})]=Bn(v);A.e.c<=U&&(A.e.c=U)}ae=parseInt(b["number-columns-repeated"]||"1",10),U+=ae-1,ae=0,v={},w="",j=[]}Y={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(p[1]==="/"){if((a=s.pop())[0]!==p[3])throw"Bad state: "+a}else p[0].charAt(p[0].length-2)!=="/"&&s.push([p[3],!0]);break;case"annotation":if(p[1]==="/"){if((a=s.pop())[0]!==p[3])throw"Bad state: "+a;C.t=w,j.length&&(C.R=j),C.a=O,re.push(C)}else p[0].charAt(p[0].length-2)!=="/"&&s.push([p[3],!1]);O="",L=0,w="",N=0,j=[];break;case"creator":p[1]==="/"?O=n.slice(L,p.index):L=p.index+p[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(p[1]==="/"){if((a=s.pop())[0]!==p[3])throw"Bad state: "+a}else p[0].charAt(p[0].length-2)!=="/"&&s.push([p[3],!1]);w="",N=0,j=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(p[1]==="/"){if(k[l.name]=c,(a=s.pop())[0]!==p[3])throw"Bad state: "+a}else p[0].charAt(p[0].length-2)!=="/"&&(c="",l=_r(p[0],!1),s.push([p[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":i=_r(p[0],!1),c+=kk[p[3]][i.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":i=_r(p[0],!1),c+=kk[p[3]][i.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(p[0].slice(-2)==="/>")break;if(p[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":c+=n.slice(u,p.index);break}else u=p.index+p[0].length;break;case"named-range":i=_r(p[0],!1),ye=jw(i["cell-range-address"]);var V={Name:i.name,Ref:ye[0]+"!"+ye[1]};K&&(V.Sheet=h.length),se.Names.push(V);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(p[1]==="/"&&(!b||!b["string-value"])){var xe=aie(n.slice(N,p.index));w=(w.length>0?w+`
`:"")+xe[0]}else _r(p[0],!1),N=p.index+p[0].length;break;case"s":break;case"database-range":if(p[1]==="/")break;try{ye=jw(_r(p[0])["target-range-address"]),m[ye[0]]["!autofilter"]={ref:ye[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(p[1]!=="/"){if(Y=_r(p[0],!1),!Y.href)break;Y.Target=en(Y.href),delete Y.href,Y.Target.charAt(0)=="#"&&Y.Target.indexOf(".")>-1?(ye=jw(Y.Target.slice(1)),Y.Target="#"+ye[0]+"!"+ye[1]):Y.Target.match(/^\.\.[\\\/]/)&&(Y.Target=Y.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(p[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(p)}}var B={Sheets:m,SheetNames:h,Workbook:se};return r.bookSheets&&delete B.Sheets,B}function Ik(t,e){e=e||{},vo(t,"META-INF/manifest.xml")&&PX(Rs(t,"META-INF/manifest.xml"),e);var r=Wi(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=hL(wn(r),e);return vo(t,"meta.xml")&&(n.Props=nF(Rs(t,"meta.xml"))),n}function jk(t,e){return hL(t,e)}var iie=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+Qg({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return Ts+e}}(),Pk=function(){var t=function(a){return xn(a).replace(/  +/g,function(i){return'<text:s text:c="'+i.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(a,i,l){var c=[];c.push('      <table:table table:name="'+xn(i.SheetNames[l])+`" table:style-name="ta1">
`);var u=0,d=0,f=ki(a["!ref"]||"A1"),m=a["!merges"]||[],h=0,g=Array.isArray(a);if(a["!cols"])for(d=0;d<=f.e.c;++d)c.push("        <table:table-column"+(a["!cols"][d]?' table:style-name="co'+a["!cols"][d].ods+'"':"")+`></table:table-column>
`);var p="",v=a["!rows"]||[];for(u=0;u<f.s.r;++u)p=v[u]?' table:style-name="ro'+v[u].ods+'"':"",c.push("        <table:table-row"+p+`></table:table-row>
`);for(;u<=f.e.r;++u){for(p=v[u]?' table:style-name="ro'+v[u].ods+'"':"",c.push("        <table:table-row"+p+`>
`),d=0;d<f.s.c;++d)c.push(e);for(;d<=f.e.c;++d){var b=!1,w={},N="";for(h=0;h!=m.length;++h)if(!(m[h].s.c>d)&&!(m[h].s.r>u)&&!(m[h].e.c<d)&&!(m[h].e.r<u)){(m[h].s.c!=d||m[h].s.r!=u)&&(b=!0),w["table:number-columns-spanned"]=m[h].e.c-m[h].s.c+1,w["table:number-rows-spanned"]=m[h].e.r-m[h].s.r+1;break}if(b){c.push(r);continue}var j=vr({r:u,c:d}),F=g?(a[u]||[])[d]:a[j];if(F&&F.f&&(w["table:formula"]=xn(Are(F.f)),F.F&&F.F.slice(0,j.length)==j)){var U=ki(F.F);w["table:number-matrix-columns-spanned"]=U.e.c-U.s.c+1,w["table:number-matrix-rows-spanned"]=U.e.r-U.s.r+1}if(!F){c.push(e);continue}switch(F.t){case"b":N=F.v?"TRUE":"FALSE",w["office:value-type"]="boolean",w["office:boolean-value"]=F.v?"true":"false";break;case"n":N=F.w||String(F.v||0),w["office:value-type"]="float",w["office:value"]=F.v||0;break;case"s":case"str":N=F.v==null?"":F.v,w["office:value-type"]="string";break;case"d":N=F.w||Vn(F.v).toISOString(),w["office:value-type"]="date",w["office:date-value"]=Vn(F.v).toISOString(),w["table:style-name"]="ce1";break;default:c.push(e);continue}var A=t(N);if(F.l&&F.l.Target){var S=F.l.Target;S=S.charAt(0)=="#"?"#"+Ere(S.slice(1)):S,S.charAt(0)!="#"&&!S.match(/^\w+:/)&&(S="../"+S),A=Vt("text:a",A,{"xlink:href":S.replace(/&/g,"&amp;")})}c.push("          "+Vt("table:table-cell",Vt("text:p",A,{}),w)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},s=function(a,i){a.push(` <office:automatic-styles>
`),a.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),a.push(`   <number:month number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:day number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:year/>
`),a.push(`  </number:date-style>
`);var l=0;i.SheetNames.map(function(u){return i.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var d=0;d<u["!cols"].length;++d)if(u["!cols"][d]){var f=u["!cols"][d];if(f.width==null&&f.wpx==null&&f.wch==null)continue;Pd(f),f.ods=l;var m=u["!cols"][d].wpx+"px";a.push('  <style:style style:name="co'+l+`" style:family="table-column">
`),a.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+m+`"/>
`),a.push(`  </style:style>
`),++l}}});var c=0;i.SheetNames.map(function(u){return i.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var d=0;d<u["!rows"].length;++d)if(u["!rows"][d]){u["!rows"][d].ods=c;var f=u["!rows"][d].hpx+"px";a.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),a.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),a.push(`  </style:style>
`),++c}}}),a.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),a.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),a.push(`  </style:style>
`),a.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),a.push(` </office:automatic-styles>
`)};return function(i,l){var c=[Ts],u=Qg({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=Qg({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});l.bookType=="fods"?(c.push("<office:document"+u+d+`>
`),c.push(rF().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+u+`>
`),s(c,i),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var f=0;f!=i.SheetNames.length;++f)c.push(n(i.Sheets[i.SheetNames[f]],i,f));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),l.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function mL(t,e){if(e.bookType=="fods")return Pk(t,e);var r=LS(),n="",s=[],a=[];return n="mimetype",Pr(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Pr(r,n,Pk(t,e)),s.push([n,"text/xml"]),a.push([n,"ContentFile"]),n="styles.xml",Pr(r,n,iie(t,e)),s.push([n,"text/xml"]),a.push([n,"StylesFile"]),n="meta.xml",Pr(r,n,Ts+rF()),s.push([n,"text/xml"]),a.push([n,"MetadataFile"]),n="manifest.rdf",Pr(r,n,FX(a)),s.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Pr(r,n,RX(s)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function dh(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Q_(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):wn(Yd(t))}function oie(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):qi(Dl(t))}function lie(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var n=0;n<e.length;++n)if(t[r+n]!=e[n])continue e;return!0}return!1}function Dd(t){var e=t.reduce(function(s,a){return s+a.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(s){r.set(s,n),n+=s.length}),r}function Rk(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function cie(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,s=e+13;s>=e;--s)n=n*256+t[s];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function uie(t,e,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,s=r/Math.pow(10,n-6176);t[e+15]|=n>>7,t[e+14]|=(n&127)<<1;for(var a=0;s>=1;++a,s/=256)t[e+a]=s&255;t[e+15]|=r>=0?0:128}function ax(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function hn(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function us(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function rn(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],s=ax(t,r),a=s&7;s=Math.floor(s/8);var i=0,l;if(s==0)break;switch(a){case 0:{for(var c=r[0];t[r[0]++]>=128;);l=t.slice(c,r[0])}break;case 5:i=4,l=t.slice(r[0],r[0]+i),r[0]+=i;break;case 1:i=8,l=t.slice(r[0],r[0]+i),r[0]+=i;break;case 2:i=ax(t,r),l=t.slice(r[0],r[0]+i),r[0]+=i;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(s," at offset ").concat(n))}var u={data:l,type:a};e[s]==null?e[s]=[u]:e[s].push(u)}return e}function ua(t){var e=[];return t.forEach(function(r,n){r.forEach(function(s){s.data&&(e.push(hn(n*8+s.type)),s.type==2&&e.push(hn(s.data.length)),e.push(s.data))})}),Dd(e)}function c3(t,e){return(t==null?void 0:t.map(function(r){return e(r.data)}))||[]}function xo(t){for(var e,r=[],n=[0];n[0]<t.length;){var s=ax(t,n),a=rn(t.slice(n[0],n[0]+s));n[0]+=s;var i={id:us(a[1][0].data),messages:[]};a[2].forEach(function(l){var c=rn(l.data),u=us(c[3][0].data);i.messages.push({meta:c,data:t.slice(n[0],n[0]+u)}),n[0]+=u}),(e=a[3])!=null&&e[0]&&(i.merge=us(a[3][0].data)>>>0>0),r.push(i)}return r}function e0(t){var e=[];return t.forEach(function(r){var n=[];n[1]=[{data:hn(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:hn(+!!r.merge),type:0}]);var s=[];r.messages.forEach(function(i){s.push(i.data),i.meta[3]=[{type:0,data:hn(i.data.length)}],n[2].push({data:ua(i.meta),type:2})});var a=ua(n);e.push(hn(a.length)),e.push(a),s.forEach(function(i){return e.push(i)})}),Dd(e)}function die(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=ax(e,r),s=[];r[0]<e.length;){var a=e[r[0]]&3;if(a==0){var i=e[r[0]++]>>2;if(i<60)++i;else{var l=i-59;i=e[r[0]],l>1&&(i|=e[r[0]+1]<<8),l>2&&(i|=e[r[0]+2]<<16),l>3&&(i|=e[r[0]+3]<<24),i>>>=0,i++,r[0]+=l}s.push(e.slice(r[0],r[0]+i)),r[0]+=i;continue}else{var c=0,u=0;if(a==1?(u=(e[r[0]]>>2&7)+4,c=(e[r[0]++]&224)<<3,c|=e[r[0]++]):(u=(e[r[0]++]>>2)+1,a==2?(c=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(c=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),s=[Dd(s)],c==0)throw new Error("Invalid offset 0");if(c>s[0].length)throw new Error("Invalid offset beyond length");if(u>=c)for(s.push(s[0].slice(-c)),u-=c;u>=s[s.length-1].length;)s.push(s[s.length-1]),u-=s[s.length-1].length;s.push(s[0].slice(-c,-c+u))}}var d=Dd(s);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function yo(t){for(var e=[],r=0;r<t.length;){var n=t[r++],s=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(die(n,t.slice(r,r+s))),r+=s}if(r!==t.length)throw new Error("data is not a valid framed stream!");return Dd(e)}function t0(t){for(var e=[],r=0;r<t.length;){var n=Math.min(t.length-r,268435455),s=new Uint8Array(4);e.push(s);var a=hn(n),i=a.length;e.push(a),n<=60?(i++,e.push(new Uint8Array([n-1<<2]))):n<=256?(i+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(i+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(i+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(i+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(t.slice(r,r+n)),i+=n,s[0]=0,s[1]=i&255,s[2]=i>>8&255,s[3]=i>>16&255,r+=n}return Dd(e)}function fie(t,e,r,n){var s=dh(t),a=s.getUint32(4,!0),i=(n>1?12:8)+Rk(a&(n>1?3470:398))*4,l=-1,c=-1,u=NaN,d=new Date(2001,0,1);a&512&&(l=s.getUint32(i,!0),i+=4),i+=Rk(a&(n>1?12288:4096))*4,a&16&&(c=s.getUint32(i,!0),i+=4),a&32&&(u=s.getFloat64(i,!0),i+=8),a&64&&(d.setTime(d.getTime()+s.getFloat64(i,!0)*1e3),i+=8);var f;switch(t[2]){case 0:break;case 2:f={t:"n",v:u};break;case 3:f={t:"s",v:e[c]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(l>-1)f={t:"s",v:r[l]};else if(c>-1)f={t:"s",v:e[c]};else if(!isNaN(u))f={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return f}function hie(t,e,r){var n=dh(t),s=n.getUint32(8,!0),a=12,i=-1,l=-1,c=NaN,u=NaN,d=new Date(2001,0,1);s&1&&(c=cie(t,a),a+=16),s&2&&(u=n.getFloat64(a,!0),a+=8),s&4&&(d.setTime(d.getTime()+n.getFloat64(a,!0)*1e3),a+=8),s&8&&(l=n.getUint32(a,!0),a+=4),s&16&&(i=n.getUint32(a,!0),a+=4);var f;switch(t[1]){case 0:break;case 2:f={t:"n",v:c};break;case 3:f={t:"s",v:e[l]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(i>-1)f={t:"s",v:r[i]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(s&31," : ").concat(t.slice(0,4)));break;case 10:f={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(s&31," : ").concat(t.slice(0,4)))}return f}function Rw(t,e){var r=new Uint8Array(32),n=dh(r),s=12,a=0;switch(r[0]=5,t.t){case"n":r[1]=2,uie(r,s,t.v),a|=1,s+=16;break;case"b":r[1]=6,n.setFloat64(s,t.v?1:0,!0),a|=2,s+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,n.setUint32(s,e.indexOf(t.v),!0),a|=8,s+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,a,!0),r.slice(0,s)}function Dw(t,e){var r=new Uint8Array(32),n=dh(r),s=12,a=0;switch(r[0]=3,t.t){case"n":r[2]=2,n.setFloat64(s,t.v,!0),a|=32,s+=8;break;case"b":r[2]=6,n.setFloat64(s,t.v?1:0,!0),a|=32,s+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,n.setUint32(s,e.indexOf(t.v),!0),a|=16,s+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,a,!0),r.slice(0,s)}function mie(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return fie(t,e,r,t[0]);case 5:return hie(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function ka(t){var e=rn(t);return ax(e[1][0].data)}function Dk(t,e){var r=rn(e.data),n=us(r[1][0].data),s=r[3],a=[];return(s||[]).forEach(function(i){var l=rn(i.data),c=us(l[1][0].data)>>>0;switch(n){case 1:a[c]=Q_(l[3][0].data);break;case 8:{var u=t[ka(l[9][0].data)][0],d=rn(u.data),f=t[ka(d[1][0].data)][0],m=us(f.meta[1][0].data);if(m!=2001)throw new Error("2000 unexpected reference to ".concat(m));var h=rn(f.data);a[c]=h[3].map(function(g){return Q_(g.data)}).join("")}break}}),a}function pie(t,e){var r,n,s,a,i,l,c,u,d,f,m,h,g,p,v=rn(t),b=us(v[1][0].data)>>>0,w=us(v[2][0].data)>>>0,N=((n=(r=v[8])==null?void 0:r[0])==null?void 0:n.data)&&us(v[8][0].data)>0||!1,j,F;if((a=(s=v[7])==null?void 0:s[0])!=null&&a.data&&e!=0)j=(l=(i=v[7])==null?void 0:i[0])==null?void 0:l.data,F=(u=(c=v[6])==null?void 0:c[0])==null?void 0:u.data;else if((f=(d=v[4])==null?void 0:d[0])!=null&&f.data&&e!=1)j=(h=(m=v[4])==null?void 0:m[0])==null?void 0:h.data,F=(p=(g=v[3])==null?void 0:g[0])==null?void 0:p.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var U=N?4:1,A=dh(j),S=[],k=0;k<j.length/2;++k){var M=A.getUint16(k*2,!0);M<65535&&S.push([k,M])}if(S.length!=w)throw"Expected ".concat(w," cells, found ").concat(S.length);var I=[];for(k=0;k<S.length-1;++k)I[S[k][0]]=F.subarray(S[k][1]*U,S[k+1][1]*U);return S.length>=1&&(I[S[S.length-1][0]]=F.subarray(S[S.length-1][1]*U)),{R:b,cells:I}}function gie(t,e){var r,n=rn(e.data),s=(r=n==null?void 0:n[7])!=null&&r[0]?us(n[7][0].data)>>>0>0?1:0:-1,a=c3(n[5],function(i){return pie(i,s)});return{nrows:us(n[4][0].data)>>>0,data:a.reduce(function(i,l){return i[l.R]||(i[l.R]=[]),l.cells.forEach(function(c,u){if(i[l.R][u])throw new Error("Duplicate cell r=".concat(l.R," c=").concat(u));i[l.R][u]=c}),i},[])}}function xie(t,e,r){var n,s=rn(e.data),a={s:{r:0,c:0},e:{r:0,c:0}};if(a.e.r=(us(s[6][0].data)>>>0)-1,a.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(a.e.c=(us(s[7][0].data)>>>0)-1,a.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=jr(a);var i=rn(s[4][0].data),l=Dk(t,t[ka(i[4][0].data)][0]),c=(n=i[17])!=null&&n[0]?Dk(t,t[ka(i[17][0].data)][0]):[],u=rn(i[3][0].data),d=0;u[1].forEach(function(f){var m=rn(f.data),h=t[ka(m[2][0].data)][0],g=us(h.meta[1][0].data);if(g!=6002)throw new Error("6001 unexpected reference to ".concat(g));var p=gie(t,h);p.data.forEach(function(v,b){v.forEach(function(w,N){var j=vr({r:d+b,c:N}),F=mie(w,l,c);F&&(r[j]=F)})}),d+=p.nrows})}function yie(t,e){var r=rn(e.data),n={"!ref":"A1"},s=t[ka(r[2][0].data)],a=us(s[0].meta[1][0].data);if(a!=6001)throw new Error("6000 unexpected reference to ".concat(a));return xie(t,s[0],n),n}function vie(t,e){var r,n=rn(e.data),s={name:(r=n[1])!=null&&r[0]?Q_(n[1][0].data):"",sheets:[]},a=c3(n[2],ka);return a.forEach(function(i){t[i].forEach(function(l){var c=us(l.meta[1][0].data);c==6e3&&s.sheets.push(yie(t,l))})}),s}function bie(t,e){var r=m3(),n=rn(e.data),s=c3(n[1],ka);if(s.forEach(function(a){t[a].forEach(function(i){var l=us(i.meta[1][0].data);if(l==2){var c=vie(t,i);c.sheets.forEach(function(u,d){p3(r,u,d==0?c.name:c.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Fw(t){var e,r,n,s,a={},i=[];if(t.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var u;try{u=yo(c.content)}catch(f){return console.log("?? "+c.content.length+" "+(f.message||f))}var d;try{d=xo(u)}catch(f){return console.log("## "+(f.message||f))}d.forEach(function(f){a[f.id]=f.messages,i.push(f.id)})}}),!i.length)throw new Error("File has no messages");var l=((s=(n=(r=(e=a==null?void 0:a[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:s[0].data)&&us(a[1][0].meta[1][0].data)==1&&a[1][0];if(l||i.forEach(function(c){a[c].forEach(function(u){var d=us(u.meta[1][0].data)>>>0;if(d==1)if(!l)l=u;else throw new Error("Document has multiple roots")})}),!l)throw new Error("Cannot find Document root");return bie(a,l)}function wie(t,e,r){var n,s,a,i;if(!((n=t[6])!=null&&n[0])||!((s=t[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var l=((i=(a=t[8])==null?void 0:a[0])==null?void 0:i.data)&&us(t[8][0].data)>0||!1;if(l)throw"Math only works with normal offsets";for(var c=0,u=dh(t[7][0].data),d=0,f=[],m=dh(t[4][0].data),h=0,g=[],p=0;p<e.length;++p){if(e[p]==null){u.setUint16(p*2,65535,!0),m.setUint16(p*2,65535);continue}u.setUint16(p*2,d,!0),m.setUint16(p*2,h,!0);var v,b;switch(typeof e[p]){case"string":v=Rw({t:"s",v:e[p]},r),b=Dw({t:"s",v:e[p]},r);break;case"number":v=Rw({t:"n",v:e[p]},r),b=Dw({t:"n",v:e[p]},r);break;case"boolean":v=Rw({t:"b",v:e[p]},r),b=Dw({t:"b",v:e[p]},r);break;default:throw new Error("Unsupported value "+e[p])}f.push(v),d+=v.length,g.push(b),h+=b.length,++c}for(t[2][0].data=hn(c);p<t[7][0].data.length/2;++p)u.setUint16(p*2,65535,!0),m.setUint16(p*2,65535,!0);return t[6][0].data=Dd(f),t[3][0].data=Dd(g),c}function _ie(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=ki(r["!ref"]);n.s.r=n.s.c=0;var s=!1;n.e.c>9&&(s=!0,n.e.c=9),n.e.r>49&&(s=!0,n.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(jr(n)));var a=n2(r,{range:n,header:1}),i=["~Sh33tJ5~"];a.forEach(function(O){return O.forEach(function(L){typeof L=="string"&&i.push(L)})});var l={},c=[],u=lr.read(e.numbers,{type:"base64"});u.FileIndex.map(function(O,L){return[O,u.FullPaths[L]]}).forEach(function(O){var L=O[0],H=O[1];if(L.type==2&&L.name.match(/\.iwa/)){var K=L.content,q=yo(K),te=xo(q);te.forEach(function(oe){c.push(oe.id),l[oe.id]={deps:[],location:H,type:us(oe.messages[0].meta[1][0].data)}})}}),c.sort(function(O,L){return O-L});var d=c.filter(function(O){return O>1}).map(function(O){return[O,hn(O)]});u.FileIndex.map(function(O,L){return[O,u.FullPaths[L]]}).forEach(function(O){var L=O[0];if(O[1],!!L.name.match(/\.iwa/)){var H=xo(yo(L.content));H.forEach(function(K){K.messages.forEach(function(q){d.forEach(function(te){K.messages.some(function(oe){return us(oe.meta[1][0].data)!=11006&&lie(oe.data,te[1])})&&l[te[0]].deps.push(K.id)})})})}});for(var f=lr.find(u,l[1].location),m=xo(yo(f.content)),h,g=0;g<m.length;++g){var p=m[g];p.id==1&&(h=p)}var v=ka(rn(h.messages[0].data)[1][0].data);for(f=lr.find(u,l[v].location),m=xo(yo(f.content)),g=0;g<m.length;++g)p=m[g],p.id==v&&(h=p);for(v=ka(rn(h.messages[0].data)[2][0].data),f=lr.find(u,l[v].location),m=xo(yo(f.content)),g=0;g<m.length;++g)p=m[g],p.id==v&&(h=p);for(v=ka(rn(h.messages[0].data)[2][0].data),f=lr.find(u,l[v].location),m=xo(yo(f.content)),g=0;g<m.length;++g)p=m[g],p.id==v&&(h=p);var b=rn(h.messages[0].data);{b[6][0].data=hn(n.e.r+1),b[7][0].data=hn(n.e.c+1);var w=ka(b[46][0].data),N=lr.find(u,l[w].location),j=xo(yo(N.content));{for(var F=0;F<j.length&&j[F].id!=w;++F);if(j[F].id!=w)throw"Bad ColumnRowUIDMapArchive";var U=rn(j[F].messages[0].data);U[1]=[],U[2]=[],U[3]=[];for(var A=0;A<=n.e.c;++A){var S=[];S[1]=S[2]=[{type:0,data:hn(A+420690)}],U[1].push({type:2,data:ua(S)}),U[2].push({type:0,data:hn(A)}),U[3].push({type:0,data:hn(A)})}U[4]=[],U[5]=[],U[6]=[];for(var k=0;k<=n.e.r;++k)S=[],S[1]=S[2]=[{type:0,data:hn(k+726270)}],U[4].push({type:2,data:ua(S)}),U[5].push({type:0,data:hn(k)}),U[6].push({type:0,data:hn(k)});j[F].messages[0].data=ua(U)}N.content=t0(e0(j)),N.size=N.content.length,delete b[46];var M=rn(b[4][0].data);{M[7][0].data=hn(n.e.r+1);var I=rn(M[1][0].data),E=ka(I[2][0].data);N=lr.find(u,l[E].location),j=xo(yo(N.content));{if(j[0].id!=E)throw"Bad HeaderStorageBucket";var D=rn(j[0].messages[0].data);for(k=0;k<a.length;++k){var G=rn(D[2][0].data);G[1][0].data=hn(k),G[4][0].data=hn(a[k].length),D[2][k]={type:D[2][0].type,data:ua(G)}}j[0].messages[0].data=ua(D)}N.content=t0(e0(j)),N.size=N.content.length;var Z=ka(M[2][0].data);N=lr.find(u,l[Z].location),j=xo(yo(N.content));{if(j[0].id!=Z)throw"Bad HeaderStorageBucket";for(D=rn(j[0].messages[0].data),A=0;A<=n.e.c;++A)G=rn(D[2][0].data),G[1][0].data=hn(A),G[4][0].data=hn(n.e.r+1),D[2][A]={type:D[2][0].type,data:ua(G)};j[0].messages[0].data=ua(D)}N.content=t0(e0(j)),N.size=N.content.length;var ae=ka(M[4][0].data);(function(){for(var O=lr.find(u,l[ae].location),L=xo(yo(O.content)),H,K=0;K<L.length;++K){var q=L[K];q.id==ae&&(H=q)}var te=rn(H.messages[0].data);{te[3]=[];var oe=[];i.forEach(function(B,Ee){oe[1]=[{type:0,data:hn(Ee)}],oe[2]=[{type:0,data:hn(1)}],oe[3]=[{type:2,data:oie(B)}],te[3].push({type:2,data:ua(oe)})})}H.messages[0].data=ua(te);var V=e0(L),xe=t0(V);O.content=xe,O.size=O.content.length})();var de=rn(M[3][0].data);{var se=de[1][0];delete de[2];var Y=rn(se.data);{var ye=ka(Y[2][0].data);(function(){for(var O=lr.find(u,l[ye].location),L=xo(yo(O.content)),H,K=0;K<L.length;++K){var q=L[K];q.id==ye&&(H=q)}var te=rn(H.messages[0].data);{delete te[6],delete de[7];var oe=new Uint8Array(te[5][0].data);te[5]=[];for(var V=0,xe=0;xe<=n.e.r;++xe){var B=rn(oe);V+=wie(B,a[xe],i),B[1][0].data=hn(xe),te[5].push({data:ua(B),type:2})}te[1]=[{type:0,data:hn(n.e.c+1)}],te[2]=[{type:0,data:hn(n.e.r+1)}],te[3]=[{type:0,data:hn(V)}],te[4]=[{type:0,data:hn(n.e.r+1)}]}H.messages[0].data=ua(te);var Ee=e0(L),Me=t0(Ee);O.content=Me,O.size=O.content.length})()}se.data=ua(Y)}M[3][0].data=ua(de)}b[4][0].data=ua(M)}h.messages[0].data=ua(b);var re=e0(m),C=t0(re);return f.content=C,f.size=f.content.length,u}function pL(t){return function(r){for(var n=0;n!=t.length;++n){var s=t[n];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function u3(t){pL([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function d3(t){pL([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function Nie(t){return Or.WS.indexOf(t)>-1?"sheet":t==Or.CS?"chart":t==Or.DS?"dialog":t==Or.MS?"macro":t&&t.length?t:"sheet"}function Sie(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,Nie(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function Tie(t,e,r,n,s,a,i,l,c,u,d,f){try{a[n]=ng(Wi(t,r,!0),e);var m=Rs(t,e),h;switch(l){case"sheet":h=Gse(m,e,s,c,a[n],u,d,f);break;case"chart":if(h=Kse(m,e,s,c,a[n],u,d,f),!h||!h["!drawel"])break;var g=Pp(h["!drawel"].Target,e),p=Zg(g),v=Dee(Wi(t,g,!0),ng(Wi(t,p,!0),g)),b=Pp(v,g),w=Zg(b);h=wse(Wi(t,b,!0),b,c,ng(Wi(t,w,!0),b),u,h);break;case"macro":h=Yse(m,e,s,c,a[n],u,d,f);break;case"dialog":h=Xse(m,e,s,c,a[n],u,d,f);break;default:throw new Error("Unrecognized sheet type "+l)}i[n]=h;var N=[];a&&a[n]&&fs(a[n]).forEach(function(j){var F="";if(a[n][j].Type==Or.CMNT){F=Pp(a[n][j].Target,e);var U=eae(Rs(t,F,!0),F,c);if(!U||!U.length)return;vk(h,U,!1)}a[n][j].Type==Or.TCMNT&&(F=Pp(a[n][j].Target,e),N=N.concat(Lee(Rs(t,F,!0),c)))}),N&&N.length&&vk(h,N,!0,c.people||[])}catch(j){if(c.WTF)throw j}}function po(t){return t.charAt(0)=="/"?t.slice(1):t}function Aie(t,e){if(Dm(),e=e||{},u3(e),vo(t,"META-INF/manifest.xml")||vo(t,"objectdata.xml"))return Ik(t,e);if(vo(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Fw<"u"){if(t.FileIndex)return Fw(t);var r=lr.utils.cfb_new();return BC(t).forEach(function(G){Pr(r,G,OY(t,G))}),Fw(r)}throw new Error("Unsupported NUMBERS file")}if(!vo(t,"[Content_Types].xml"))throw vo(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):vo(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=BC(t),s=IX(Wi(t,"[Content_Types].xml")),a=!1,i,l;if(s.workbooks.length===0&&(l="xl/workbook.xml",Rs(t,l,!0)&&s.workbooks.push(l)),s.workbooks.length===0){if(l="xl/workbook.bin",!Rs(t,l,!0))throw new Error("Could not find workbook");s.workbooks.push(l),a=!0}s.workbooks[0].slice(-3)=="bin"&&(a=!0);var c={},u={};if(!e.bookSheets&&!e.bookProps){if(sg=[],s.sst)try{sg=Zse(Rs(t,po(s.sst)),s.sst,e)}catch(G){if(e.WTF)throw G}e.cellStyles&&s.themes.length&&(c=Jse(Wi(t,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],e)),s.style&&(u=Qse(Rs(t,po(s.style)),s.style,c,e))}s.links.map(function(G){try{var Z=ng(Wi(t,Zg(po(G))),G);return rae(Rs(t,po(G)),Z,G,e)}catch{}});var d=Hse(Rs(t,po(s.workbooks[0])),s.workbooks[0],e),f={},m="";s.coreprops.length&&(m=Rs(t,po(s.coreprops[0]),!0),m&&(f=nF(m)),s.extprops.length!==0&&(m=Rs(t,po(s.extprops[0]),!0),m&&OX(m,f,e)));var h={};(!e.bookSheets||e.bookProps)&&s.custprops.length!==0&&(m=Wi(t,po(s.custprops[0]),!0),m&&(h=VX(m,e)));var g={};if((e.bookSheets||e.bookProps)&&(d.Sheets?i=d.Sheets.map(function(Z){return Z.name}):f.Worksheets&&f.SheetNames.length>0&&(i=f.SheetNames),e.bookProps&&(g.Props=f,g.Custprops=h),e.bookSheets&&typeof i<"u"&&(g.SheetNames=i),e.bookSheets?g.SheetNames:e.bookProps))return g;i={};var p={};e.bookDeps&&s.calcchain&&(p=tae(Rs(t,po(s.calcchain)),s.calcchain));var v=0,b={},w,N;{var j=d.Sheets;f.Worksheets=j.length,f.SheetNames=[];for(var F=0;F!=j.length;++F)f.SheetNames[F]=j[F].name}var U=a?"bin":"xml",A=s.workbooks[0].lastIndexOf("/"),S=(s.workbooks[0].slice(0,A+1)+"_rels/"+s.workbooks[0].slice(A+1)+".rels").replace(/^\//,"");vo(t,S)||(S="xl/_rels/workbook."+U+".rels");var k=ng(Wi(t,S,!0),S.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(e.xlmeta=nae(Rs(t,po(s.metadata[0])),s.metadata[0],e)),(s.people||[]).length>=1&&(e.people=Mee(Rs(t,po(s.people[0])),e)),k&&(k=Sie(k,d.Sheets));var M=Rs(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(v=0;v!=f.Worksheets;++v){var I="sheet";if(k&&k[v]?(w="xl/"+k[v][1].replace(/[\/]?xl\//,""),vo(t,w)||(w=k[v][1]),vo(t,w)||(w=S.replace(/_rels\/.*$/,"")+k[v][1]),I=k[v][2]):(w="xl/worksheets/sheet"+(v+1-M)+"."+U,w=w.replace(/sheet0\./,"sheet.")),N=w.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(v!=e.sheets)continue e;break;case"string":if(f.SheetNames[v].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var E=!1,D=0;D!=e.sheets.length;++D)typeof e.sheets[D]=="number"&&e.sheets[D]==v&&(E=1),typeof e.sheets[D]=="string"&&e.sheets[D].toLowerCase()==f.SheetNames[v].toLowerCase()&&(E=1);if(!E)continue e}}Tie(t,w,N,f.SheetNames[v],v,b,i,I,e,d,c,u)}return g={Directory:s,Workbook:d,Props:f,Custprops:h,Deps:p,Sheets:i,SheetNames:f.SheetNames,Strings:sg,Styles:u,Themes:c,SSF:Bn(gr)},e&&e.bookFiles&&(t.files?(g.keys=n,g.files=t.files):(g.keys=[],g.files={},t.FullPaths.forEach(function(G,Z){G=G.replace(/^Root Entry[\/]/,""),g.keys.push(G),g.files[G]=t.FileIndex[Z]}))),e&&e.bookVBA&&(s.vba.length>0?g.vbaraw=Rs(t,po(s.vba[0]),!0):s.defaults&&s.defaults.bin===Hee&&(g.vbaraw=Rs(t,"xl/vbaProject.bin",!0))),g}function Eie(t,e){var r=e||{},n="Workbook",s=lr.find(t,n);try{if(n="/!DataSpaces/Version",s=lr.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(nZ(s.content),n="/!DataSpaces/DataSpaceMap",s=lr.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=aZ(s.content);if(a.length!==1||a[0].comps.length!==1||a[0].comps[0].t!==0||a[0].name!=="StrongEncryptionDataSpace"||a[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=lr.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=iZ(s.content);if(i.length!=1||i[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=lr.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);lZ(s.content)}catch{}if(n="/EncryptionInfo",s=lr.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=cZ(s.content);if(n="/EncryptedPackage",s=lr.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(l[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(l[1],s.content,r.password||"",r);if(l[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(l[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function Cie(t,e){return e.bookType=="ods"?mL(t,e):e.bookType=="numbers"?_ie(t,e):e.bookType=="xlsb"?kie(t,e):Iie(t,e)}function kie(t,e){C0=1024,t&&!t.SSF&&(t.SSF=Bn(gr)),t&&t.SSF&&(Dm(),rb(t.SSF),e.revssf=sb(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,ag?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",n=$F.indexOf(e.bookType)>-1,s=XS();d3(e=e||{});var a=LS(),i="",l=0;if(e.cellXfs=[],Qd(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),i="docProps/core.xml",Pr(a,i,sF(t.Props,e)),s.coreprops.push(i),mn(e.rels,2,i,Or.CORE_PROPS),i="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var c=[],u=0;u<t.SheetNames.length;++u)(t.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(t.SheetNames[u]);t.Props.SheetNames=c}for(t.Props.Worksheets=t.Props.SheetNames.length,Pr(a,i,oF(t.Props)),s.extprops.push(i),mn(e.rels,3,i,Or.EXT_PROPS),t.Custprops!==t.Props&&fs(t.Custprops||{}).length>0&&(i="docProps/custom.xml",Pr(a,i,lF(t.Custprops)),s.custprops.push(i),mn(e.rels,4,i,Or.CUST_PROPS)),l=1;l<=t.SheetNames.length;++l){var d={"!id":{}},f=t.Sheets[t.SheetNames[l-1]],m=(f||{})["!type"]||"sheet";switch(m){case"chart":default:i="xl/worksheets/sheet"+l+"."+r,Pr(a,i,aae(l-1,i,e,t,d)),s.sheets.push(i),mn(e.wbrels,-1,"worksheets/sheet"+l+"."+r,Or.WS[0])}if(f){var h=f["!comments"],g=!1,p="";h&&h.length>0&&(p="xl/comments"+l+"."+r,Pr(a,p,lae(h,p)),s.comments.push(p),mn(d,-1,"../comments"+l+"."+r,Or.CMNT),g=!0),f["!legacy"]&&g&&Pr(a,"xl/drawings/vmlDrawing"+l+".vml",BF(l,f["!comments"])),delete f["!comments"],delete f["!legacy"]}d["!id"].rId1&&Pr(a,Zg(i),U0(d))}return e.Strings!=null&&e.Strings.length>0&&(i="xl/sharedStrings."+r,Pr(a,i,oae(e.Strings,i,e)),s.strs.push(i),mn(e.wbrels,-1,"sharedStrings."+r,Or.SST)),i="xl/workbook."+r,Pr(a,i,sae(t,i)),s.workbooks.push(i),mn(e.rels,1,i,Or.WB),i="xl/theme/theme1.xml",Pr(a,i,r3(t.Themes,e)),s.themes.push(i),mn(e.wbrels,-1,"theme/theme1.xml",Or.THEME),i="xl/styles."+r,Pr(a,i,iae(t,i,e)),s.styles.push(i),mn(e.wbrels,-1,"styles."+r,Or.STY),t.vbaraw&&n&&(i="xl/vbaProject.bin",Pr(a,i,t.vbaraw),s.vba.push(i),mn(e.wbrels,-1,"vbaProject.bin",Or.VBA)),i="xl/metadata."+r,Pr(a,i,cae(i)),s.metadata.push(i),mn(e.wbrels,-1,"metadata."+r,Or.XLMETA),Pr(a,"[Content_Types].xml",tF(s,e)),Pr(a,"_rels/.rels",U0(e.rels)),Pr(a,"xl/_rels/workbook."+r+".rels",U0(e.wbrels)),delete e.revssf,delete e.ssf,a}function Iie(t,e){C0=1024,t&&!t.SSF&&(t.SSF=Bn(gr)),t&&t.SSF&&(Dm(),rb(t.SSF),e.revssf=sb(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,ag?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",n=$F.indexOf(e.bookType)>-1,s=XS();d3(e=e||{});var a=LS(),i="",l=0;if(e.cellXfs=[],Qd(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),i="docProps/core.xml",Pr(a,i,sF(t.Props,e)),s.coreprops.push(i),mn(e.rels,2,i,Or.CORE_PROPS),i="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var c=[],u=0;u<t.SheetNames.length;++u)(t.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(t.SheetNames[u]);t.Props.SheetNames=c}t.Props.Worksheets=t.Props.SheetNames.length,Pr(a,i,oF(t.Props)),s.extprops.push(i),mn(e.rels,3,i,Or.EXT_PROPS),t.Custprops!==t.Props&&fs(t.Custprops||{}).length>0&&(i="docProps/custom.xml",Pr(a,i,lF(t.Custprops)),s.custprops.push(i),mn(e.rels,4,i,Or.CUST_PROPS));var d=["SheetJ5"];for(e.tcid=0,l=1;l<=t.SheetNames.length;++l){var f={"!id":{}},m=t.Sheets[t.SheetNames[l-1]],h=(m||{})["!type"]||"sheet";switch(h){case"chart":default:i="xl/worksheets/sheet"+l+"."+r,Pr(a,i,ZF(l-1,e,t,f)),s.sheets.push(i),mn(e.wbrels,-1,"worksheets/sheet"+l+"."+r,Or.WS[0])}if(m){var g=m["!comments"],p=!1,v="";if(g&&g.length>0){var b=!1;g.forEach(function(w){w[1].forEach(function(N){N.T==!0&&(b=!0)})}),b&&(v="xl/threadedComments/threadedComment"+l+"."+r,Pr(a,v,Oee(g,d,e)),s.threadedcomments.push(v),mn(f,-1,"../threadedComments/threadedComment"+l+"."+r,Or.TCMNT)),v="xl/comments"+l+"."+r,Pr(a,v,UF(g)),s.comments.push(v),mn(f,-1,"../comments"+l+"."+r,Or.CMNT),p=!0}m["!legacy"]&&p&&Pr(a,"xl/drawings/vmlDrawing"+l+".vml",BF(l,m["!comments"])),delete m["!comments"],delete m["!legacy"]}f["!id"].rId1&&Pr(a,Zg(i),U0(f))}return e.Strings!=null&&e.Strings.length>0&&(i="xl/sharedStrings."+r,Pr(a,i,CF(e.Strings,e)),s.strs.push(i),mn(e.wbrels,-1,"sharedStrings."+r,Or.SST)),i="xl/workbook."+r,Pr(a,i,sL(t)),s.workbooks.push(i),mn(e.rels,1,i,Or.WB),i="xl/theme/theme1.xml",Pr(a,i,r3(t.Themes,e)),s.themes.push(i),mn(e.wbrels,-1,"theme/theme1.xml",Or.THEME),i="xl/styles."+r,Pr(a,i,LF(t,e)),s.styles.push(i),mn(e.wbrels,-1,"styles."+r,Or.STY),t.vbaraw&&n&&(i="xl/vbaProject.bin",Pr(a,i,t.vbaraw),s.vba.push(i),mn(e.wbrels,-1,"vbaProject.bin",Or.VBA)),i="xl/metadata."+r,Pr(a,i,VF()),s.metadata.push(i),mn(e.wbrels,-1,"metadata."+r,Or.XLMETA),d.length>1&&(i="xl/persons/person.xml",Pr(a,i,Vee(d)),s.people.push(i),mn(e.wbrels,-1,"persons/person.xml",Or.PEOPLE)),Pr(a,"[Content_Types].xml",tF(s,e)),Pr(a,"_rels/.rels",U0(e.rels)),Pr(a,"xl/_rels/workbook."+r+".rels",U0(e.wbrels)),delete e.revssf,delete e.ssf,a}function f3(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=ro(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function jie(t,e){return lr.find(t,"EncryptedPackage")?Eie(t,e):lL(t,e)}function Pie(t,e){var r,n=t,s=e||{};return s.type||(s.type=Dr&&Buffer.isBuffer(t)?"buffer":"base64"),r=ID(n,s),Aie(r,s)}function gL(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Y_(t.slice(r),e);default:break e}return vm.to_workbook(t,e)}function Rie(t,e){var r="",n=f3(t,e);switch(e.type){case"base64":r=ro(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=oh(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=wn(r)),e.type="binary",gL(r,e)}function Die(t,e){var r=t;return e.type=="base64"&&(r=ro(r)),r=B_.utils.decode(1200,r.slice(2),"str"),e.type="binary",gL(r,e)}function Fie(t){return t.match(/[^\x00-\x7F]/)?Dl(t):t}function Lw(t,e,r,n){return n?(r.type="string",vm.to_workbook(t,r)):vm.to_workbook(e,r)}function J_(t,e){jS();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return J_(new Uint8Array(t),(r=Bn(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,s=[0,0,0,0],a=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),z0={},r.dateNF&&(z0.dateNF=r.dateNF),r.type||(r.type=Dr&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=Dr?"buffer":"binary",n=kY(t),typeof Uint8Array<"u"&&!Dr&&(r.type="array")),r.type=="string"&&(a=!0,r.type="binary",r.codepage=65001,n=Fie(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var i=new ArrayBuffer(3),l=new Uint8Array(i);if(l.foo="bar",!l.foo)return r=Bn(r),r.type="array",J_(PS(n),r)}switch((s=f3(n,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return jie(lr.read(n,r),r);break;case 9:if(s[1]<=8)return lL(n,r);break;case 60:return Y_(n,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return BJ(n,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return AF.to_workbook(n,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?Pie(n,r):Lw(t,n,r,a);case 239:return s[3]===60?Y_(n,r):Lw(t,n,r,a);case 255:if(s[1]===254)return Die(n,r);if(s[1]===0&&s[2]===2&&s[3]===0)return Vf.to_workbook(n,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return Vf.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return K_.to_workbook(n,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return RF.to_workbook(n,r);break;case 10:case 13:case 32:return Rie(n,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return VJ.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?K_.to_workbook(n,r):Lw(t,n,r,a)}function xL(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return Vx(e.file,lr.write(t,{type:Dr?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return lr.write(t,e)}function Lie(t,e){var r=Bn(e||{}),n=Cie(t,r);return Oie(n,r)}function Oie(t,e){var r={},n=Dr?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=n;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var s=t.FullPaths?lr.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof s=="string"){if(e.type=="binary"||e.type=="base64")return s;s=new Uint8Array(tb(s))}return e.password&&typeof encrypt_agile<"u"?xL(encrypt_agile(s,e.password),e):e.type==="file"?Vx(e.file,s):e.type=="string"?wn(s):s}function Mie(t,e){var r=e||{},n=Fae(t,r);return xL(n,r)}function Sl(t,e,r){r||(r="");var n=r+t;switch(e.type){case"base64":return Kg(Dl(n));case"binary":return Dl(n);case"string":return t;case"file":return Vx(e.file,n,"utf8");case"buffer":return Dr?Qc(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Sl(n,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function Vie(t,e){switch(e.type){case"base64":return Kg(t);case"binary":return t;case"string":return t;case"file":return Vx(e.file,t,"binary");case"buffer":return Dr?Qc(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function ey(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",n=0;n<t.length;++n)r+=String.fromCharCode(t[n]);return e.type=="base64"?Kg(r):e.type=="string"?wn(r):r;case"file":return Vx(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function yL(t,e){jS(),jse(t);var r=Bn(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=yL(t,r);return r.type="array",tb(n)}var s=0;if(r.sheet&&(typeof r.sheet=="number"?s=r.sheet:s=t.SheetNames.indexOf(r.sheet),!t.SheetNames[s]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Sl(Cae(t,r),r);case"slk":case"sylk":return Sl(TF.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"htm":case"html":return Sl(uL(t.Sheets[t.SheetNames[s]],r),r);case"txt":return Vie(vL(t.Sheets[t.SheetNames[s]],r),r);case"csv":return Sl(h3(t.Sheets[t.SheetNames[s]],r),r,"\uFEFF");case"dif":return Sl(AF.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"dbf":return ey(K_.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"prn":return Sl(vm.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"rtf":return Sl(RF.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"eth":return Sl(EF.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"fods":return Sl(mL(t,r),r);case"wk1":return ey(Vf.sheet_to_wk1(t.Sheets[t.SheetNames[s]],r),r);case"wk3":return ey(Vf.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),ey(cL(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),Mie(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return Lie(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function Bie(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(t.bookType=r.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function Uie(t,e,r){var n={};return n.type="file",n.file=e,Bie(n),yL(t,n)}function $ie(t,e,r,n,s,a,i,l){var c=Ns(r),u=l.defval,d=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),f=!0,m=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(m,"__rowNum__",{value:r,enumerable:!1})}catch{m.__rowNum__=r}else m.__rowNum__=r;if(!i||t[r])for(var h=e.s.c;h<=e.e.c;++h){var g=i?t[r][h]:t[n[h]+c];if(g===void 0||g.t===void 0){if(u===void 0)continue;a[h]!=null&&(m[a[h]]=u);continue}var p=g.v;switch(g.t){case"z":if(p==null)break;continue;case"e":p=p==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+g.t)}if(a[h]!=null){if(p==null)if(g.t=="e"&&p===null)m[a[h]]=null;else if(u!==void 0)m[a[h]]=u;else if(d&&p===null)m[a[h]]=null;else continue;else m[a[h]]=d&&(g.t!=="n"||g.t==="n"&&l.rawNumbers!==!1)?p:qc(g,p,l);p!=null&&(f=!1)}}return{row:m,isempty:f}}function n2(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,s=1,a=[],i=0,l="",c={s:{r:0,c:0},e:{r:0,c:0}},u=e||{},d=u.range!=null?u.range:t["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof d){case"string":c=tn(d);break;case"number":c=tn(t["!ref"]),c.s.r=d;break;default:c=d}n>0&&(s=0);var f=Ns(c.s.r),m=[],h=[],g=0,p=0,v=Array.isArray(t),b=c.s.r,w=0,N={};v&&!t[b]&&(t[b]=[]);var j=u.skipHidden&&t["!cols"]||[],F=u.skipHidden&&t["!rows"]||[];for(w=c.s.c;w<=c.e.c;++w)if(!(j[w]||{}).hidden)switch(m[w]=Xn(w),r=v?t[b][w]:t[m[w]+f],n){case 1:a[w]=w-c.s.c;break;case 2:a[w]=m[w];break;case 3:a[w]=u.header[w-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=i=qc(r,null,u),p=N[i]||0,!p)N[i]=1;else{do l=i+"_"+p++;while(N[l]);N[i]=p,N[l]=1}a[w]=l}for(b=c.s.r+s;b<=c.e.r;++b)if(!(F[b]||{}).hidden){var U=$ie(t,c,b,m,n,a,v,u);(U.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(h[g++]=U.row)}return h.length=g,h}var Fk=/"/g;function zie(t,e,r,n,s,a,i,l){for(var c=!0,u=[],d="",f=Ns(r),m=e.s.c;m<=e.e.c;++m)if(n[m]){var h=l.dense?(t[r]||[])[m]:t[n[m]+f];if(h==null)d="";else if(h.v!=null){c=!1,d=""+(l.rawNumbers&&h.t=="n"?h.v:qc(h,null,l));for(var g=0,p=0;g!==d.length;++g)if((p=d.charCodeAt(g))===s||p===a||p===34||l.forceQuotes){d='"'+d.replace(Fk,'""')+'"';break}d=="ID"&&(d='"ID"')}else h.f!=null&&!h.F?(c=!1,d="="+h.f,d.indexOf(",")>=0&&(d='"'+d.replace(Fk,'""')+'"')):d="";u.push(d)}return l.blankrows===!1&&c?null:u.join(i)}function h3(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var s=tn(t["!ref"]),a=n.FS!==void 0?n.FS:",",i=a.charCodeAt(0),l=n.RS!==void 0?n.RS:`
`,c=l.charCodeAt(0),u=new RegExp((a=="|"?"\\|":a)+"+$"),d="",f=[];n.dense=Array.isArray(t);for(var m=n.skipHidden&&t["!cols"]||[],h=n.skipHidden&&t["!rows"]||[],g=s.s.c;g<=s.e.c;++g)(m[g]||{}).hidden||(f[g]=Xn(g));for(var p=0,v=s.s.r;v<=s.e.r;++v)(h[v]||{}).hidden||(d=zie(t,s,v,f,i,c,a,n),d!=null&&(n.strip&&(d=d.replace(u,"")),(d||n.blankrows!==!1)&&r.push((p++?l:"")+d)));return delete n.dense,r.join("")}function vL(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=h3(t,e);return r}function qie(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var s=tn(t["!ref"]),a="",i=[],l,c=[],u=Array.isArray(t);for(l=s.s.c;l<=s.e.c;++l)i[l]=Xn(l);for(var d=s.s.r;d<=s.e.r;++d)for(a=Ns(d),l=s.s.c;l<=s.e.c;++l)if(e=i[l]+a,r=u?(t[d]||[])[l]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=e+"="+n}return c}function bL(t,e,r){var n=r||{},s=+!n.skipHeader,a=t||{},i=0,l=0;if(a&&n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var c=typeof n.origin=="string"?Qn(n.origin):n.origin;i=c.r,l=c.c}var u,d={s:{c:0,r:0},e:{c:l,r:i+e.length-1+s}};if(a["!ref"]){var f=tn(a["!ref"]);d.e.c=Math.max(d.e.c,f.e.c),d.e.r=Math.max(d.e.r,f.e.r),i==-1&&(i=f.e.r+1,d.e.r=i+e.length-1+s)}else i==-1&&(i=0,d.e.r=e.length-1+s);var m=n.header||[],h=0;e.forEach(function(p,v){fs(p).forEach(function(b){(h=m.indexOf(b))==-1&&(m[h=m.length]=b);var w=p[b],N="z",j="",F=vr({c:l+h,r:i+v+s});u=ix(a,F),w&&typeof w=="object"&&!(w instanceof Date)?a[F]=w:(typeof w=="number"?N="n":typeof w=="boolean"?N="b":typeof w=="string"?N="s":w instanceof Date?(N="d",n.cellDates||(N="n",w=Hs(w)),j=n.dateNF||gr[14]):w===null&&n.nullError&&(N="e",w=0),u?(u.t=N,u.v=w,delete u.w,delete u.R,j&&(u.z=j)):a[F]=u={t:N,v:w},j&&(u.z=j))})}),d.e.c=Math.max(d.e.c,l+m.length-1);var g=Ns(i);if(s)for(h=0;h<m.length;++h)a[Xn(h+l)+g]={t:"s",v:m[h]};return a["!ref"]=jr(d),a}function Wie(t,e){return bL(null,t,e)}function ix(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=Qn(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?ix(t,vr(e)):ix(t,vr({r:e,c:r||0}))}function Hie(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function m3(){return{SheetNames:[],Sheets:{}}}function p3(t,e,r,n){var s=1;if(!r)for(;s<=65535&&t.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var a=r.match(/(^.*?)(\d+)$/);s=a&&+a[2]||0;var i=a&&a[1]||r;for(++s;s<=65535&&t.SheetNames.indexOf(r=i+s)!=-1;++s);}if(nL(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function Gie(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=Hie(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function Kie(t,e){return t.z=e,t}function wL(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function Yie(t,e,r){return wL(t,"#"+e,r)}function Xie(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function Qie(t,e,r,n){for(var s=typeof e!="string"?e:tn(e),a=typeof e=="string"?e:jr(e),i=s.s.r;i<=s.e.r;++i)for(var l=s.s.c;l<=s.e.c;++l){var c=ix(t,i,l);c.t="n",c.F=a,delete c.v,i==s.s.r&&l==s.s.c&&(c.f=r,n&&(c.D=!0))}return t}var ty={encode_col:Xn,encode_row:Ns,encode_cell:vr,encode_range:jr,decode_col:qS,decode_row:zS,split_cell:oX,decode_cell:Qn,decode_range:ki,format_cell:qc,sheet_add_aoa:KD,sheet_add_json:bL,sheet_add_dom:dL,aoa_to_sheet:Fm,json_to_sheet:Wie,table_to_sheet:fL,table_to_book:nie,sheet_to_csv:h3,sheet_to_txt:vL,sheet_to_json:n2,sheet_to_html:uL,sheet_to_formulae:qie,sheet_to_row_object_array:n2,sheet_get_cell:ix,book_new:m3,book_append_sheet:p3,book_set_sheet_visibility:Gie,cell_set_number_format:Kie,cell_set_hyperlink:wL,cell_set_internal_link:Yie,cell_add_comment:Xie,sheet_set_array_formula:Qie,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const Lk=[{name:"Margherita Pizza",description:"Classic pizza with fresh mozzarella, tomatoes, and basil",category:"Main Course",price:299,image:"",isAvailable:!0,preparationTime:20,allergens:"Gluten, Dairy",spiceLevel:"none",isVegetarian:!0,isVegan:!1,isGlutenFree:!1,tags:"Pizza, Italian, Popular",variantName1:"Size",variantOptions1:"Small:249:standalone,Medium:299:standalone,Large:349:standalone",variantName2:"Crust",variantOptions2:"Thin:0:additive,Thick:25:additive,Stuffed:50:additive",variantName3:"",variantOptions3:""},{name:"Chicken Biryani",description:"Aromatic basmati rice with tender chicken and spices",category:"Main Course",price:249,image:"",isAvailable:!0,preparationTime:30,allergens:"",spiceLevel:"medium",isVegetarian:!1,isVegan:!1,isGlutenFree:!0,tags:"Biryani, Chicken, Spicy",variantName1:"Portion",variantOptions1:"Half:199:standalone,Full:249:standalone,Jumbo:299:standalone",variantName2:"",variantOptions2:"",variantName3:"",variantOptions3:""},{name:"Caesar Salad",description:"Fresh romaine lettuce with Caesar dressing and croutons",category:"Appetizers",price:149,image:"",isAvailable:!0,preparationTime:10,allergens:"Dairy",spiceLevel:"none",isVegetarian:!0,isVegan:!1,isGlutenFree:!1,tags:"Salad, Healthy, Light",variantName1:"",variantOptions1:"",variantName2:"",variantOptions2:"",variantName3:"",variantOptions3:""}];function Jie({isOpen:t,onClose:e,onSuccess:r,restaurantId:n,categories:s}){const[a,i]=X.useState(!1),[l,c]=X.useState([]),[u,d]=X.useState(null),[f,m]=X.useState("upload"),[h,g]=X.useState(!1),p=X.useRef(null);if(!t)return null;const v=Z=>{var de,se;const ae=(de=Z.target.files)==null?void 0:de[0];if(ae){const Y=(se=ae.name.split(".").pop())==null?void 0:se.toLowerCase();if(!["csv","xlsx","xls"].includes(Y||"")){fe.error("Please select a CSV or Excel file");return}j(ae)}},b=Z=>{Z.preventDefault(),Z.stopPropagation(),g(!0)},w=Z=>{Z.preventDefault(),Z.stopPropagation(),g(!1)},N=Z=>{var de;Z.preventDefault(),Z.stopPropagation(),g(!1);const ae=Z.dataTransfer.files;if(ae.length>0){const se=ae[0],Y=(de=se.name.split(".").pop())==null?void 0:de.toLowerCase();if(!["csv","xlsx","xls"].includes(Y||"")){fe.error("Please drop a CSV or Excel file");return}j(se)}},j=async Z=>{var ae;i(!0);try{const de=(ae=Z.name.split(".").pop())==null?void 0:ae.toLowerCase();let se=[];de==="csv"?se=await F(Z):(de==="xlsx"||de==="xls")&&(se=await A(Z)),c(se),m("preview")}catch(de){fe.error("Failed to process file. Please check the format."),console.error("File processing error:",de)}finally{i(!1)}},F=async Z=>new Promise((ae,de)=>{const se=new FileReader;se.onload=Y=>{var ye;try{const C=((ye=Y.target)==null?void 0:ye.result).split(`
`),O=C[0].split(",").map(H=>H.trim().replace(/"/g,"")),L=[];for(let H=1;H<C.length;H++)if(C[H].trim()){const K=U(C[H]),q={};O.forEach((te,oe)=>{q[te]=K[oe]||""}),L.push(q)}ae(L)}catch(re){de(re)}},se.readAsText(Z)}),U=Z=>{const ae=[];let de="",se=!1;for(let Y=0;Y<Z.length;Y++){const ye=Z[Y];ye==='"'?se=!se:ye===","&&!se?(ae.push(de.trim()),de=""):de+=ye}return ae.push(de.trim()),ae},A=async Z=>new Promise((ae,de)=>{const se=new FileReader;se.onload=Y=>{var ye;try{const re=new Uint8Array((ye=Y.target)==null?void 0:ye.result),C=J_(re,{type:"array"}),O=C.SheetNames[0],L=C.Sheets[O],H=ty.sheet_to_json(L,{header:1}),K=H[0],q=[];for(let te=1;te<H.length;te++){const oe=H[te];if(oe&&oe.some(V=>V!==void 0&&V!=="")){const V={};K.forEach((xe,B)=>{V[xe]=oe[B]||""}),q.push(V)}}ae(q)}catch(re){de(re)}},se.readAsArrayBuffer(Z)}),S=Z=>{const ae=[],de=[];return Z.forEach((se,Y)=>{var C,O;const ye=Y+2;if(!((C=se.name)!=null&&C.trim())){de.push(`Row ${ye}: Name is required`);return}if(!((O=se.category)!=null&&O.trim())){de.push(`Row ${ye}: Category is required`);return}if(!se.price||isNaN(Number(se.price))||Number(se.price)<=0){de.push(`Row ${ye}: Valid price is required`);return}if(!s.some(L=>L.name.toLowerCase()===se.category.toLowerCase())){de.push(`Row ${ye}: Category "${se.category}" does not exist`);return}ae.push(se)}),{valid:ae,errors:de}},k=Z=>Z.map(ae=>{var Y,ye;const de=[];for(let re=1;re<=3;re++){const C=`variantName${re}`,O=`variantOptions${re}`,L=(Y=ae[C])==null?void 0:Y.toString().trim(),H=(ye=ae[O])==null?void 0:ye.toString().trim();if(L&&H){const K=H.split(",").map(q=>{var Ee,Me,Ie,he;const te=q.split(":"),oe=(Ee=te[0])==null?void 0:Ee.trim(),V=(Me=te[1])==null?void 0:Me.trim(),xe=(he=(Ie=te[2])==null?void 0:Ie.trim())==null?void 0:he.toLowerCase();let B="additive";return xe==="standalone"||xe==="s"?B="standalone":(xe==="additive"||xe==="a")&&(B="additive"),{id:`${L}-${oe}`.toLowerCase().replace(/\s+/g,"-"),name:oe,priceModifier:Number(V)||0,pricingType:B}}).filter(q=>q.name);K.length>0&&de.push({id:L.toLowerCase().replace(/\s+/g,"-"),name:L,type:"single",required:!0,options:K})}}const se=s.find(re=>re.name.toLowerCase()===ae.category.toLowerCase());return{id:"",restaurantId:n,name:ae.name,description:ae.description||"",category:ae.category,categoryId:(se==null?void 0:se.id)||"",categoryName:(se==null?void 0:se.name)||ae.category,price:Number(ae.price),image:ae.image||"",isAvailable:ae.isAvailable!==!1&&String(ae.isAvailable)!=="false",preparationTime:Number(ae.preparationTime)||0,allergens:ae.allergens?ae.allergens.split(",").map(re=>re.trim()):[],spiceLevel:ae.spiceLevel||"none",isVegetarian:ae.isVegetarian===!0||String(ae.isVegetarian)==="true",isVegan:ae.isVegan===!0||String(ae.isVegan)==="true",isGlutenFree:ae.isGlutenFree===!0||String(ae.isGlutenFree)==="true",tags:ae.tags?ae.tags.split(",").map(re=>re.trim()):[],variants:de.length>0?de:void 0,createdAt:new Date,updatedAt:new Date}}),M=async()=>{i(!0);try{const{valid:Z,errors:ae}=S(l);if(ae.length>0){d({success:!1,errors:ae}),m("result");return}const de=k(Z),se=[],Y=[];for(const ye of de)try{const re=await cs.createMenuItem(ye);re.success&&re.data?se.push(re.data):Y.push(`Failed to create "${ye.name}": ${re.error}`)}catch(re){Y.push(`Failed to create "${ye.name}": ${re}`)}d({success:Y.length===0,data:se,errors:Y,warnings:[]}),m("result"),Y.length===0?(fe.success(`Successfully imported ${se.length} menu items!`),r()):se.length>0?fe.success(`Imported ${se.length} items with ${Y.length} errors`):fe.error("Import failed. Please check the errors.")}catch{d({success:!1,errors:["Import failed due to an unexpected error"]}),m("result"),fe.error("Import failed")}finally{i(!1)}},I=Z=>{Z==="csv"?E():D()},E=()=>{const Z=["name","description","category","price","image","isAvailable","preparationTime","allergens","spiceLevel","isVegetarian","isVegan","isGlutenFree","tags","variantName1","variantOptions1","variantName2","variantOptions2","variantName3","variantOptions3"],ae=[Z.join(","),...Lk.map(ye=>Z.map(re=>{const C=ye[re]||"";return typeof C=="string"&&C.includes(",")?`"${C}"`:C}).join(","))].join(`
`),de=new Blob([ae],{type:"text/csv"}),se=URL.createObjectURL(de),Y=document.createElement("a");Y.href=se,Y.download="menu_import_sample.csv",Y.click(),URL.revokeObjectURL(se)},D=()=>{const Z=ty.json_to_sheet(Lk),ae=ty.book_new();ty.book_append_sheet(ae,Z,"Menu Items"),Uie(ae,"menu_import_sample.xlsx")},G=()=>{c([]),d(null),m("upload"),p.current&&(p.current.value="")};return o.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:o.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[o.jsx("div",{className:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75",onClick:e}),o.jsxs("div",{className:"inline-block w-full max-w-4xl my-8 overflow-hidden text-left align-middle transition-all transform bg-white shadow-xl rounded-2xl",children:[o.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Bulk Menu Import"}),o.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600",children:o.jsx(Zn,{className:"w-6 h-6"})})]}),o.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Import multiple menu items from CSV or Excel files"})]}),o.jsxs("div",{className:"p-6",children:[f==="upload"&&o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[o.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:" Download Sample File"}),o.jsx("p",{className:"text-sm text-blue-700 mb-3",children:"Download a sample file to see the required format and columns"}),o.jsxs("div",{className:"flex space-x-3",children:[o.jsxs("button",{onClick:()=>I("csv"),className:"btn btn-sm bg-blue-600 text-white hover:bg-blue-700",children:[o.jsx(ah,{className:"w-4 h-4 mr-2"}),"Sample CSV"]}),o.jsxs("button",{onClick:()=>I("excel"),className:"btn btn-sm bg-green-600 text-white hover:bg-green-700",children:[o.jsx(ah,{className:"w-4 h-4 mr-2"}),"Sample Excel"]})]})]}),o.jsxs("div",{className:`border-2 border-dashed rounded-lg p-8 text-center transition-colors ${h?"border-blue-400 bg-blue-50":"border-gray-300 hover:border-gray-400"}`,onDragOver:b,onDragLeave:w,onDrop:N,children:[o.jsx(O_,{className:`w-12 h-12 mx-auto mb-4 ${h?"text-blue-500":"text-gray-400"}`}),o.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"Upload Your Menu File"}),o.jsx("p",{className:"text-gray-600 mb-4",children:h?"Drop your CSV or Excel file here":"Drag and drop a CSV or Excel file here, or click to select"}),o.jsx("input",{ref:p,type:"file",accept:".csv,.xlsx,.xls",onChange:v,className:"hidden"}),o.jsx("button",{onClick:()=>{var Z;return(Z=p.current)==null?void 0:Z.click()},disabled:a,className:"btn btn-theme-primary",children:a?o.jsxs(o.Fragment,{children:[o.jsx(aC,{className:"w-4 h-4 mr-2 animate-spin"}),"Processing..."]}):o.jsxs(o.Fragment,{children:[o.jsx(xm,{className:"w-4 h-4 mr-2"}),"Choose File"]})})]}),o.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[o.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:" File Format Guidelines"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-gray-700",children:[o.jsxs("div",{children:[o.jsx("h5",{className:"font-medium mb-2",children:"Required Columns:"}),o.jsxs("ul",{className:"space-y-1",children:[o.jsxs("li",{children:[" ",o.jsx("strong",{children:"name"})," - Item name"]}),o.jsxs("li",{children:[" ",o.jsx("strong",{children:"category"})," - Menu category"]}),o.jsxs("li",{children:[" ",o.jsx("strong",{children:"price"})," - Base price (number)"]})]})]}),o.jsxs("div",{children:[o.jsx("h5",{className:"font-medium mb-2",children:"Optional Columns:"}),o.jsxs("ul",{className:"space-y-1",children:[o.jsxs("li",{children:[" ",o.jsx("strong",{children:"description"})," - Item description"]}),o.jsxs("li",{children:[" ",o.jsx("strong",{children:"image"})," - Image URL"]}),o.jsxs("li",{children:[" ",o.jsx("strong",{children:"isAvailable"})," - true/false"]}),o.jsxs("li",{children:[" ",o.jsx("strong",{children:"preparationTime"})," - Minutes"]}),o.jsxs("li",{children:[" ",o.jsx("strong",{children:"allergens"})," - Comma separated"]}),o.jsxs("li",{children:[" ",o.jsx("strong",{children:"spiceLevel"})," - none/mild/medium/hot/very_hot"]}),o.jsxs("li",{children:[" ",o.jsx("strong",{children:"isVegetarian/isVegan/isGlutenFree"})," - true/false"]}),o.jsxs("li",{children:[" ",o.jsx("strong",{children:"tags"})," - Comma separated"]})]})]})]}),o.jsxs("div",{className:"mt-4 pt-3 border-t border-gray-200",children:[o.jsx("h5",{className:"font-medium mb-2",children:"Variant Columns (Optional):"}),o.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Add up to 3 variants per item using these column pairs:"}),o.jsxs("ul",{className:"text-sm text-gray-700 space-y-1",children:[o.jsxs("li",{children:[" ",o.jsx("strong",{children:"variantName1, variantOptions1"}),' - e.g., "Size", "Small:249:standalone,Medium:299:standalone,Large:349:standalone"']}),o.jsxs("li",{children:[" ",o.jsx("strong",{children:"variantName2, variantOptions2"}),' - e.g., "Crust", "Thin:0:additive,Thick:25:additive"']}),o.jsxs("li",{children:[" ",o.jsx("strong",{children:"variantName3, variantOptions3"})," - Additional variant if needed"]})]}),o.jsx("p",{className:"text-xs text-gray-500 mt-2",children:'Format: "OptionName:Price:PricingType" where PricingType is "additive" (adds to base price) or "standalone" (replaces base price). You can use "s" for standalone and "a" for additive as shortcuts.'})]})]})]}),f==="preview"&&o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("h4",{className:"text-lg font-medium text-gray-900",children:"Preview Import Data"}),o.jsxs("div",{className:"text-sm text-gray-600",children:[l.length," items found"]})]}),o.jsx("div",{className:"max-h-96 overflow-y-auto border border-gray-200 rounded-lg",children:o.jsxs("table",{className:"w-full text-sm",children:[o.jsx("thead",{className:"bg-gray-50 sticky top-0",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-900",children:"Name"}),o.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-900",children:"Category"}),o.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-900",children:"Price"}),o.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-900",children:"Available"}),o.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-900",children:"Variants"})]})}),o.jsx("tbody",{className:"divide-y divide-gray-200",children:l.slice(0,100).map((Z,ae)=>o.jsxs("tr",{className:ae%2===0?"bg-white":"bg-gray-50",children:[o.jsx("td",{className:"px-4 py-2 font-medium",children:Z.name}),o.jsx("td",{className:"px-4 py-2",children:Z.category}),o.jsx("td",{className:"px-4 py-2",children:pt(Number(Z.price)||0)}),o.jsx("td",{className:"px-4 py-2",children:o.jsx("span",{className:`inline-flex px-2 py-1 text-xs rounded-full ${Z.isAvailable!==!1&&String(Z.isAvailable)!=="false"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:Z.isAvailable!==!1&&String(Z.isAvailable)!=="false"?"Yes":"No"})}),o.jsx("td",{className:"px-4 py-2",children:[1,2,3].map(de=>{const se=Z[`variantName${de}`];return se?o.jsx("div",{className:"text-xs text-gray-600",children:se},de):null})})]},ae))})]})}),l.length>100&&o.jsxs("p",{className:"text-sm text-gray-600 text-center",children:["Showing first 100 items. Total: ",l.length," items"]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("button",{onClick:G,className:"btn btn-secondary",children:"Back"}),o.jsx("button",{onClick:M,disabled:a||l.length===0,className:"btn btn-theme-primary",children:a?o.jsxs(o.Fragment,{children:[o.jsx(aC,{className:"w-4 h-4 mr-2 animate-spin"}),"Importing..."]}):o.jsxs(o.Fragment,{children:[o.jsx(O_,{className:"w-4 h-4 mr-2"}),"Import ",l.length," Items"]})})]})]}),f==="result"&&u&&o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"text-center",children:[u.success?o.jsx(Ai,{className:"w-16 h-16 text-green-500 mx-auto mb-4"}):o.jsx($c,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),o.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:u.success?"Import Successful!":"Import Completed with Issues"}),u.data&&o.jsxs("p",{className:"text-gray-600",children:["Successfully imported ",u.data.length," menu items"]})]}),u.errors&&u.errors.length>0&&o.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[o.jsx("h5",{className:"font-medium text-red-900 mb-2",children:"Errors:"}),o.jsx("ul",{className:"text-sm text-red-700 space-y-1",children:u.errors.slice(0,10).map((Z,ae)=>o.jsxs("li",{children:[" ",Z]},ae))}),u.errors.length>10&&o.jsxs("p",{className:"text-sm text-red-600 mt-2",children:["...and ",u.errors.length-10," more errors"]})]}),u.warnings&&u.warnings.length>0&&o.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[o.jsx("h5",{className:"font-medium text-yellow-900 mb-2",children:"Warnings:"}),o.jsx("ul",{className:"text-sm text-yellow-700 space-y-1",children:u.warnings.map((Z,ae)=>o.jsxs("li",{children:[" ",Z]},ae))})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("button",{onClick:G,className:"btn btn-secondary",children:"Import More"}),o.jsx("button",{onClick:e,className:"btn btn-theme-primary",children:"Done"})]})]})]})]})]})})}function Zie(){const{restaurant:t}=ya(),[e,r]=X.useState("items"),[n,s]=X.useState([]),[a,i]=X.useState([]),[l,c]=X.useState([]),[u,d]=X.useState("all"),[f,m]=X.useState(""),[h,g]=X.useState("grid"),[p,v]=X.useState(!1),[b,w]=X.useState(!0),[N,j]=X.useState(null),[F,U]=X.useState(null),[A,S]=X.useState(null),{register:k,handleSubmit:M,reset:I,setValue:E,watch:D}=Hn();X.useEffect(()=>{t&&G()},[t]),X.useEffect(()=>{let re=n;u!=="all"&&(re=re.filter(C=>C.category===u)),f&&(re=re.filter(C=>{var O;return C.name.toLowerCase().includes(f.toLowerCase())||((O=C.description)==null?void 0:O.toLowerCase().includes(f.toLowerCase()))||C.category.toLowerCase().includes(f.toLowerCase())})),p&&(re=re.filter(C=>C.isAvailable)),c(re)},[n,u,f,p]);const G=async()=>{if(t)try{w(!0);const[re,C]=await Promise.all([cs.getMenuItemsForRestaurant(t.id),cs.getCategoriesForRestaurant(t.id)]);re.success&&re.data&&s(re.data),C.success&&C.data&&i(C.data)}catch{fe.error("Failed to load menu data")}finally{w(!1)}},Z=()=>{var re;U(null),I({name:"",description:"",category:((re=a[0])==null?void 0:re.name)||"",price:0,isAvailable:!0,preparationTime:0,allergens:[],spiceLevel:"none",isVegetarian:!1,isVegan:!1,isGlutenFree:!1,tags:[],variants:[]}),j("item")},ae=re=>{U(re),E("name",re.name),E("description",re.description||""),E("category",re.category),E("price",re.price),E("image",re.image||""),E("isAvailable",re.isAvailable),E("preparationTime",re.preparationTime||0),E("allergens",re.allergens||[]),E("spiceLevel",re.spiceLevel||"none"),E("isVegetarian",re.isVegetarian||!1),E("isVegan",re.isVegan||!1),E("isGlutenFree",re.isGlutenFree||!1),E("tags",re.tags||[]),E("variants",re.variants||[]),j("item")},de=re=>{S(re),j("view")},se=async re=>{if(t)try{if(F){const C=await cs.updateMenuItem(F.id,t.id,{name:re.name,description:re.description,category:re.category,price:re.price,image:re.image,isAvailable:re.isAvailable,preparationTime:re.preparationTime,allergens:re.allergens,spiceLevel:re.spiceLevel,isVegetarian:re.isVegetarian,isVegan:re.isVegan,isGlutenFree:re.isGlutenFree,tags:re.tags,variants:re.variants});C.success?(fe.success("Menu item updated successfully"),await G()):fe.error(C.error||"Failed to update menu item")}else{const C=a.find(L=>L.name===re.category),O=await cs.createMenuItem({restaurantId:t.id,name:re.name,description:re.description,category:re.category,categoryId:(C==null?void 0:C.id)||"",categoryName:(C==null?void 0:C.name)||re.category,price:re.price,image:re.image,isAvailable:re.isAvailable,preparationTime:re.preparationTime,allergens:re.allergens,spiceLevel:re.spiceLevel,isVegetarian:re.isVegetarian,isVegan:re.isVegan,isGlutenFree:re.isGlutenFree,tags:re.tags,variants:re.variants});O.success?(fe.success("Menu item created successfully"),await G()):fe.error(O.error||"Failed to create menu item")}j(null),U(null)}catch{fe.error("Failed to save menu item")}},Y=async re=>{if(!(!t||!confirm(`Are you sure you want to delete "${re.name}"?`)))try{const C=await cs.deleteMenuItem(re.id,t.id);C.success?(fe.success("Menu item deleted successfully"),await G()):fe.error(C.error||"Failed to delete menu item")}catch{fe.error("Failed to delete menu item")}},ye=async re=>{if(t)try{const C=await cs.updateMenuItem(re.id,t.id,{isAvailable:!re.isAvailable});C.success?(fe.success(`${re.name} ${re.isAvailable?"disabled":"enabled"}`),await G()):fe.error(C.error||"Failed to update availability")}catch{fe.error("Failed to update availability")}};return t?o.jsxs("div",{className:"min-h-screen",style:{background:"var(--color-background)"},children:[o.jsx("header",{className:"bg-white/80 backdrop-blur-md border-b border-gray-200 sticky top-0 z-40",children:o.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:o.jsx("div",{className:"flex items-center justify-between",children:o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Menu Management"}),o.jsx("p",{className:"text-gray-600",children:"Manage your restaurant's menu items and categories"})]})})})}),o.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-6",children:[o.jsx("div",{className:"card p-6",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:o.jsx(Zi,{className:"w-6 h-6 text-blue-600"})}),o.jsxs("div",{className:"ml-4",children:[o.jsx("p",{className:"text-sm text-gray-600",children:"Total Items"}),o.jsx("p",{className:"text-2xl font-bold text-gray-900",children:n.length})]})]})}),o.jsx("div",{className:"card p-6",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"p-3 bg-green-100 rounded-lg",children:o.jsx(Ci,{className:"w-6 h-6 text-green-600"})}),o.jsxs("div",{className:"ml-4",children:[o.jsx("p",{className:"text-sm text-gray-600",children:"Available"}),o.jsx("p",{className:"text-2xl font-bold text-gray-900",children:n.filter(re=>re.isAvailable).length})]})]})}),o.jsx("div",{className:"card p-6",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"p-3 bg-yellow-100 rounded-lg",children:o.jsx(Bv,{className:"w-6 h-6 text-yellow-600"})}),o.jsxs("div",{className:"ml-4",children:[o.jsx("p",{className:"text-sm text-gray-600",children:"Categories"}),o.jsx("p",{className:"text-2xl font-bold text-gray-900",children:a.length})]})]})}),o.jsx("div",{className:"card p-6",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"p-3 bg-purple-100 rounded-lg",children:o.jsx(Yi,{className:"w-6 h-6 text-purple-600"})}),o.jsxs("div",{className:"ml-4",children:[o.jsx("p",{className:"text-sm text-gray-600",children:"Avg. Price"}),o.jsx("p",{className:"text-2xl font-bold text-gray-900",children:n.length>0?pt(n.reduce((re,C)=>re+C.price,0)/n.length):pt(0)})]})]})})]}),o.jsx("div",{className:"card mb-6",children:o.jsx("div",{className:"border-b border-gray-200",children:o.jsxs("nav",{className:"-mb-px flex space-x-8 px-6",children:[o.jsxs("button",{onClick:()=>r("items"),className:`py-4 px-1 border-b-2 font-medium text-sm ${e==="items"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[o.jsx(Zi,{className:"w-4 h-4 mr-2 inline"}),"Menu Items (",n.length,")"]}),o.jsxs("button",{onClick:()=>r("categories"),className:`py-4 px-1 border-b-2 font-medium text-sm ${e==="categories"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[o.jsx(Bv,{className:"w-4 h-4 mr-2 inline"}),"Categories (",a.length,")"]})]})})}),e==="items"&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"card p-6 mb-6",children:o.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[o.jsxs("div",{className:"flex-1 relative",children:[o.jsx(Eo,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),o.jsx("input",{type:"text",placeholder:"Search menu items...",value:f,onChange:re=>m(re.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(Wg,{className:"w-5 h-5 text-gray-600"}),o.jsxs("select",{value:u,onChange:re=>d(re.target.value),className:"px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[o.jsx("option",{value:"all",children:"All Categories"}),a.map(re=>o.jsx("option",{value:re.name,children:re.name},re.id))]})]}),o.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[o.jsx("input",{type:"checkbox",checked:p,onChange:re=>v(re.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),o.jsx("span",{className:"text-sm text-gray-700",children:"Available only"})]}),o.jsxs("div",{className:"flex items-center bg-white rounded-lg border border-gray-200",children:[o.jsx("button",{onClick:()=>g("grid"),className:`p-2 ${h==="grid"?"bg-blue-50 text-blue-600":"text-gray-600"}`,children:o.jsx(yd,{className:"w-4 h-4"})}),o.jsx("button",{onClick:()=>g("list"),className:`p-2 ${h==="list"?"bg-blue-50 text-blue-600":"text-gray-600"}`,children:o.jsx(ZG,{className:"w-4 h-4"})})]}),o.jsxs("button",{onClick:()=>j("bulk-import"),className:"btn btn-secondary",children:[o.jsx(O_,{className:"w-4 h-4 mr-2"}),"Bulk Import"]}),o.jsxs("button",{onClick:Z,className:"btn btn-theme-primary",children:[o.jsx(Wn,{className:"w-4 h-4 mr-2"}),"Add Item"]})]})]})}),b?o.jsxs("div",{className:"text-center py-12",children:[o.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mb-4"}),o.jsx("p",{className:"text-gray-600",children:"Loading menu items..."})]}):o.jsxs(o.Fragment,{children:[h==="grid"?o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:l.map(re=>o.jsx(eoe,{item:re,onEdit:ae,onDelete:Y,onView:de,onToggleAvailability:ye},re.id))}):o.jsx("div",{className:"space-y-4",children:l.map(re=>o.jsx(toe,{item:re,onEdit:ae,onDelete:Y,onView:de,onToggleAvailability:ye},re.id))}),l.length===0&&o.jsxs("div",{className:"text-center py-12",children:[o.jsx(Zi,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),o.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No menu items found"}),o.jsx("p",{className:"text-gray-600 mb-4",children:f||u!=="all"||p?"Try adjusting your filters or search terms":"Get started by adding your first menu item"}),!f&&u==="all"&&!p&&o.jsxs("button",{onClick:Z,className:"btn btn-theme-primary",children:[o.jsx(Wn,{className:"w-4 h-4 mr-2"}),"Add First Menu Item"]})]})]})]}),e==="categories"&&o.jsx(YK,{categories:a,onCategoriesUpdated:G})]}),N==="item"&&o.jsx(roe,{isOpen:!0,onClose:()=>j(null),onSave:se,item:F,categories:a,register:k,handleSubmit:M,watch:D,setValue:E}),N==="view"&&A&&o.jsx(noe,{isOpen:!0,onClose:()=>j(null),item:A,onEdit:()=>{ae(A),S(null)}}),N==="bulk-import"&&t&&o.jsx(Jie,{isOpen:!0,onClose:()=>j(null),onSuccess:()=>{j(null),G()},restaurantId:t.id,categories:a.map(re=>({id:re.id,name:re.name}))})]}):o.jsx("div",{className:"min-h-screen flex items-center justify-center",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),o.jsx("p",{className:"text-gray-600",children:"Loading..."})]})})}function eoe({item:t,onEdit:e,onDelete:r,onView:n,onToggleAvailability:s}){const a=t.spiceLevel?g3(t.spiceLevel):null;return o.jsxs("div",{className:`card hover:shadow-lg transition-all duration-200 ${t.isAvailable?"":"opacity-60"}`,children:[o.jsxs("div",{className:"relative",children:[t.image?o.jsx("img",{src:t.image,alt:t.name,className:"w-full h-48 object-cover rounded-t-xl"}):o.jsx("div",{className:"w-full h-48 bg-gray-200 rounded-t-xl flex items-center justify-center",children:o.jsx(XR,{className:"w-12 h-12 text-gray-400"})}),o.jsx("div",{className:"absolute top-3 right-3",children:o.jsx("button",{onClick:()=>s(t),className:`p-2 rounded-full ${t.isAvailable?"bg-green-600":"bg-gray-600"} text-white`,children:t.isAvailable?o.jsx(Ci,{className:"w-4 h-4"}):o.jsx(zc,{className:"w-4 h-4"})})}),!t.isAvailable&&o.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50 rounded-t-xl flex items-center justify-center",children:o.jsx("span",{className:"text-white font-medium",children:"Unavailable"})})]}),o.jsxs("div",{className:"p-4",children:[o.jsxs("div",{className:"flex items-start justify-between mb-2",children:[o.jsx("h3",{className:"font-semibold text-gray-900 text-lg",children:t.name}),o.jsx("div",{className:"text-lg font-bold",style:{color:"var(--color-primary)"},children:pt(t.price)})]}),o.jsx("p",{className:"text-gray-600 text-sm mb-3 line-clamp-2",children:t.description||"No description provided"}),o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:t.category}),a&&o.jsxs("span",{className:"inline-flex items-center text-xs text-gray-600",children:[o.jsx("span",{className:"mr-1",children:a.icon}),a.label]})]}),o.jsxs("div",{className:"flex items-center space-x-1 mb-4",children:[t.isVegetarian&&o.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-xs rounded",children:" Veg"}),t.isVegan&&o.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-xs rounded",children:" Vegan"}),t.isGlutenFree&&o.jsx("span",{className:"px-2 py-1 bg-yellow-100 text-yellow-800 text-xs rounded",children:" GF"})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[o.jsxs("button",{onClick:()=>n(t),className:"btn btn-secondary btn-sm text-xs",children:[o.jsx(Ci,{className:"w-3 h-3 mr-1"}),"View"]}),o.jsxs("button",{onClick:()=>window.location.href=`/${window.location.pathname.split("/")[1]}/inventory?item=${t.id}`,className:"btn bg-green-600 text-white hover:bg-green-700 btn-sm text-xs",title:"Manage Inventory",children:[o.jsx(Zi,{className:"w-3 h-3 mr-1"}),"Stock"]}),o.jsxs("button",{onClick:()=>e(t),className:"btn btn-theme-primary btn-sm text-xs",children:[o.jsx(Cd,{className:"w-3 h-3 mr-1"}),"Edit"]}),o.jsxs("button",{onClick:()=>r(t),className:"btn bg-red-600 text-white hover:bg-red-700 btn-sm text-xs",title:"Delete Item",children:[o.jsx(ga,{className:"w-3 h-3 mr-1"}),"Delete"]})]})]})]})}function toe({item:t,onEdit:e,onDelete:r,onView:n,onToggleAvailability:s}){const a=t.spiceLevel?g3(t.spiceLevel):null;return o.jsx("div",{className:`card p-4 ${t.isAvailable?"":"opacity-60"}`,children:o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsx("div",{className:"w-16 h-16 flex-shrink-0",children:t.image?o.jsx("img",{src:t.image,alt:t.name,className:"w-full h-full object-cover rounded-lg"}):o.jsx("div",{className:"w-full h-full bg-gray-200 rounded-lg flex items-center justify-center",children:o.jsx(XR,{className:"w-6 h-6 text-gray-400"})})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-center space-x-3 mb-1",children:[o.jsx("h3",{className:"font-semibold text-gray-900",children:t.name}),o.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:t.category}),a&&o.jsxs("span",{className:"inline-flex items-center text-xs text-gray-600",children:[o.jsx("span",{className:"mr-1",children:a.icon}),a.label]})]}),o.jsx("p",{className:"text-gray-600 text-sm mb-2 truncate",children:t.description||"No description provided"}),o.jsxs("div",{className:"flex items-center space-x-2",children:[t.isVegetarian&&o.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-xs rounded",children:" Veg"}),t.isVegan&&o.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-xs rounded",children:" Vegan"}),t.isGlutenFree&&o.jsx("span",{className:"px-2 py-1 bg-yellow-100 text-yellow-800 text-xs rounded",children:" GF"})]})]}),o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsxs("div",{className:"text-right",children:[o.jsx("div",{className:"text-lg font-bold",style:{color:"var(--color-primary)"},children:pt(t.price)}),o.jsx("div",{className:`text-sm ${t.isAvailable?"text-green-600":"text-red-600"}`,children:t.isAvailable?"Available":"Unavailable"})]}),o.jsxs("div",{className:"flex space-x-2",children:[o.jsx("button",{onClick:()=>s(t),className:`p-2 rounded-lg ${t.isAvailable?"bg-green-100 text-green-600 hover:bg-green-200":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:t.isAvailable?o.jsx(Ci,{className:"w-4 h-4"}):o.jsx(zc,{className:"w-4 h-4"})}),o.jsx("button",{onClick:()=>n(t),className:"p-2 bg-blue-100 text-blue-600 hover:bg-blue-200 rounded-lg",children:o.jsx(Ci,{className:"w-4 h-4"})}),o.jsx("button",{onClick:()=>window.location.href=`/${window.location.pathname.split("/")[1]}/inventory?item=${t.id}`,className:"p-2 bg-green-100 text-green-600 hover:bg-green-200 rounded-lg",title:"Manage Inventory",children:o.jsx(Zi,{className:"w-4 h-4"})}),o.jsx("button",{onClick:()=>e(t),className:"p-2 bg-yellow-100 text-yellow-600 hover:bg-yellow-200 rounded-lg",children:o.jsx(Cd,{className:"w-4 h-4"})}),o.jsx("button",{onClick:()=>r(t),className:"p-2 bg-red-100 text-red-600 hover:bg-red-200 rounded-lg",children:o.jsx(ga,{className:"w-4 h-4"})})]})]})]})})}function roe({isOpen:t,onClose:e,onSave:r,item:n,categories:s,register:a,handleSubmit:i,watch:l,setValue:c}){if(!t)return null;const u=l("variants")||[],d=f=>{c("variants",f)};return o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:o.jsxs("div",{className:"bg-white rounded-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[o.jsx("div",{className:"p-6 border-b border-gray-200",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:n?"Edit Menu Item":"Add Menu Item"}),o.jsx("button",{onClick:e,className:"p-1 text-gray-400 hover:text-gray-600",children:o.jsx(Zn,{className:"w-5 h-5"})})]})}),o.jsxs("form",{onSubmit:i(r),className:"p-6 space-y-6",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Item Name *"}),o.jsx("input",{...a("name",{required:"Item name is required"}),type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter item name"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category *"}),o.jsx("select",{...a("category",{required:"Category is required"}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:s.map(f=>o.jsx("option",{value:f.name,children:f.name},f.id))})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Price *"}),o.jsx("input",{...a("price",{required:"Price is required",min:{value:0,message:"Price must be positive"}}),type:"number",step:"0.01",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"0.00"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Preparation Time (minutes)"}),o.jsx("input",{...a("preparationTime"),type:"number",min:"0",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"0"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),o.jsx("textarea",{...a("description"),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Describe this menu item..."})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Image URL"}),o.jsx("input",{...a("image"),type:"url",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"https://example.com/image.jpg"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Spice Level"}),o.jsxs("select",{...a("spiceLevel"),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[o.jsx("option",{value:"none",children:" No Spice"}),o.jsx("option",{value:"mild",children:" Mild"}),o.jsx("option",{value:"medium",children:" Medium"}),o.jsx("option",{value:"hot",children:" Hot"}),o.jsx("option",{value:"very_hot",children:" Very Hot"})]})]}),o.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[o.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[o.jsx("input",{...a("isAvailable"),type:"checkbox",className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),o.jsx("span",{className:"text-sm text-gray-700",children:"Available"})]}),o.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[o.jsx("input",{...a("isVegetarian"),type:"checkbox",className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),o.jsx("span",{className:"text-sm text-gray-700",children:" Vegetarian"})]}),o.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[o.jsx("input",{...a("isVegan"),type:"checkbox",className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),o.jsx("span",{className:"text-sm text-gray-700",children:" Vegan"})]}),o.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[o.jsx("input",{...a("isGlutenFree"),type:"checkbox",className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),o.jsx("span",{className:"text-sm text-gray-700",children:" Gluten Free"})]})]}),o.jsx("div",{className:"border-t pt-6",children:o.jsx(XK,{variants:u,onChange:d})}),o.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[o.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Cancel"}),o.jsxs("button",{type:"submit",className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[o.jsx(kd,{className:"w-4 h-4 mr-2 inline"}),n?"Update Item":"Create Item"]})]})]})]})})}function noe({isOpen:t,onClose:e,item:r,onEdit:n}){if(!t)return null;const s=r.spiceLevel?g3(r.spiceLevel):null;return o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:o.jsxs("div",{className:"bg-white rounded-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[o.jsx("div",{className:"p-6 border-b border-gray-200",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:r.name}),o.jsx("button",{onClick:e,className:"p-1 text-gray-400 hover:text-gray-600",children:o.jsx(Zn,{className:"w-5 h-5"})})]})}),o.jsxs("div",{className:"p-6",children:[r.image&&o.jsx("img",{src:r.image,alt:r.name,className:"w-full h-64 object-cover rounded-lg mb-6"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Basic Information"}),o.jsxs("div",{className:"space-y-2 text-sm",children:[o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-gray-600",children:"Price:"}),o.jsx("span",{className:"font-medium",children:pt(r.price)})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-gray-600",children:"Category:"}),o.jsx("span",{className:"font-medium",children:r.category})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-gray-600",children:"Status:"}),o.jsx("span",{className:`font-medium ${r.isAvailable?"text-green-600":"text-red-600"}`,children:r.isAvailable?"Available":"Unavailable"})]}),r.preparationTime&&o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-gray-600",children:"Prep Time:"}),o.jsxs("span",{className:"font-medium",children:[r.preparationTime," min"]})]})]})]}),o.jsxs("div",{children:[o.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Dietary Information"}),o.jsxs("div",{className:"flex flex-wrap gap-2",children:[r.isVegetarian&&o.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-xs rounded",children:" Vegetarian"}),r.isVegan&&o.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-xs rounded",children:" Vegan"}),r.isGlutenFree&&o.jsx("span",{className:"px-2 py-1 bg-yellow-100 text-yellow-800 text-xs rounded",children:" Gluten Free"}),s&&o.jsxs("span",{className:"px-2 py-1 bg-red-100 text-red-800 text-xs rounded",children:[s.icon," ",s.label]})]})]})]}),r.description&&o.jsxs("div",{className:"mb-6",children:[o.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Description"}),o.jsx("p",{className:"text-gray-600",children:r.description})]}),r.allergens&&r.allergens.length>0&&o.jsxs("div",{className:"mb-6",children:[o.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Allergens"}),o.jsx("div",{className:"flex flex-wrap gap-2",children:r.allergens.map((a,i)=>o.jsx("span",{className:"px-2 py-1 bg-orange-100 text-orange-800 text-xs rounded",children:a},i))})]}),r.variants&&r.variants.length>0&&o.jsxs("div",{className:"mb-6",children:[o.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Available Variants"}),o.jsx("div",{className:"space-y-3",children:r.variants.map(a=>o.jsxs("div",{className:"border border-gray-200 rounded-lg p-3",children:[o.jsxs("h4",{className:"font-medium text-gray-900 mb-2",children:[a.name,a.required&&o.jsx("span",{className:"text-red-500 ml-1",children:"*"}),o.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:["(",a.type==="single"?"Single Choice":"Multiple Choice",")"]})]}),o.jsx("div",{className:"grid grid-cols-2 gap-2",children:a.options.map(i=>o.jsxs("div",{className:"flex justify-between items-center text-sm",children:[o.jsxs("span",{className:"text-gray-700",children:[i.name,i.isDefault&&a.type==="single"&&o.jsx("span",{className:"text-blue-600 ml-1",children:"(Default)"})]}),o.jsxs("div",{className:"flex flex-col items-end",children:[o.jsxs("span",{className:"text-gray-600",children:[i.pricingType==="standalone"?"":i.priceModifier>0&&"+",i.priceModifier!==0&&pt(i.priceModifier)]}),o.jsx("span",{className:"text-xs text-gray-500",children:i.pricingType==="standalone"?"Standalone":"Additive"})]})]},i.id))})]},a.id))})]}),o.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[o.jsx("button",{onClick:e,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Close"}),o.jsxs("button",{onClick:n,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[o.jsx(Cd,{className:"w-4 h-4 mr-2 inline"}),"Edit Item"]})]})]})]})})}function g3(t){const e={none:{label:"No Spice",icon:""},mild:{label:"Mild",icon:""},medium:{label:"Medium",icon:""},hot:{label:"Hot",icon:""},very_hot:{label:"Very Hot",icon:""}};return e[t]||e.none}function soe({isOpen:t,onClose:e,onSave:r,inventory:n,menuItems:s,existingInventory:a,register:i,handleSubmit:l,selectedUnit:c,isSubmitting:u}){if(!t)return null;const d=n?s.filter(m=>m.id===n.menuItemId||!a.some(h=>h.menuItemId===m.id)):s.filter(m=>!a.some(h=>h.menuItemId===m.id)),f=[{value:"pieces",label:"Pieces"},{value:"ml",label:"Milliliters (ml)"},{value:"liters",label:"Liters"},{value:"grams",label:"Grams (g)"},{value:"kg",label:"Kilograms (kg)"},{value:"cups",label:"Cups"},{value:"portions",label:"Portions"},{value:"bottles",label:"Bottles"},{value:"cans",label:"Cans"},{value:"custom",label:"Custom Unit"}];return o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:o.jsxs("div",{className:"bg-white rounded-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[o.jsx("div",{className:"p-6 border-b border-gray-200",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:n?"Edit Inventory":"Add Inventory"}),o.jsx("button",{onClick:e,className:"p-1 text-gray-400 hover:text-gray-600",children:o.jsx(Zn,{className:"w-5 h-5"})})]})}),o.jsxs("form",{onSubmit:l(r),className:"p-6 space-y-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Menu Item *"}),o.jsx("select",{...i("menuItemId",{required:"Menu item is required"}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",disabled:!!n,children:d.map(m=>o.jsxs("option",{value:m.id,children:[m.name," - ",pt(m.price)]},m.id))}),d.length===0&&o.jsx("p",{className:"text-sm text-yellow-600 mt-1",children:"All menu items already have inventory setup"})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Current Quantity *"}),o.jsx("input",{...i("currentQuantity",{required:"Quantity is required",min:{value:0,message:"Quantity cannot be negative"}}),type:"number",step:"0.1",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"0"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Unit *"}),o.jsx("select",{...i("unit",{required:"Unit is required"}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:f.map(m=>o.jsx("option",{value:m.value,children:m.label},m.value))})]})]}),c==="custom"&&o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Custom Unit Name *"}),o.jsx("input",{...i("customUnit",{required:c==="custom"?"Custom unit name is required":!1}),type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., servings, batches, etc."})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Minimum Threshold *"}),o.jsx("input",{...i("minimumThreshold",{required:"Minimum threshold is required",min:{value:0,message:"Threshold cannot be negative"}}),type:"number",step:"0.1",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Alert when below this level"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Consumption Per Order *"}),o.jsx("input",{...i("consumptionPerOrder",{required:"Consumption per order is required",min:{value:0,message:"Consumption cannot be negative"}}),type:"number",step:"0.1",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"How much is used per order"})]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Maximum Capacity"}),o.jsx("input",{...i("maxCapacity"),type:"number",step:"0.1",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Storage capacity (optional)"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cost Per Unit"}),o.jsx("input",{...i("costPerUnit"),type:"number",step:"0.01",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Cost price per unit"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Supplier"}),o.jsx("input",{...i("supplier"),type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Supplier name (optional)"})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[o.jsx("input",{...i("isTracked"),type:"checkbox",className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),o.jsx("span",{className:"text-sm text-gray-700",children:"Track inventory"})]}),o.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[o.jsx("input",{...i("autoDeduct"),type:"checkbox",className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),o.jsx("span",{className:"text-sm text-gray-700",children:"Auto-deduct on orders"})]})]}),o.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[o.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Cancel"}),o.jsx("button",{type:"submit",disabled:u||d.length===0,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-colors",children:u?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2 inline-block"}),"Saving..."]}):o.jsxs(o.Fragment,{children:[o.jsx(kd,{className:"w-4 h-4 mr-2 inline"}),n?"Update Inventory":"Create Inventory"]})})]})]})]})})}function aoe({isOpen:t,onClose:e,onSave:r,inventory:n,menuItemName:s,register:a,handleSubmit:i,isSubmitting:l}){if(!t)return null;const c=(u,d)=>u==="custom"&&d?d:u;return o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:o.jsxs("div",{className:"bg-white rounded-2xl max-w-md w-full",children:[o.jsx("div",{className:"p-6 border-b border-gray-200",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Adjust Inventory"}),o.jsx("button",{onClick:e,className:"p-1 text-gray-400 hover:text-gray-600",children:o.jsx(Zn,{className:"w-5 h-5"})})]})}),o.jsxs("div",{className:"p-6",children:[o.jsxs("div",{className:"mb-6",children:[o.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:s}),o.jsxs("p",{className:"text-sm text-gray-600",children:["Current Stock: ",n.currentQuantity," ",c(n.unit,n.customUnit)]})]}),o.jsxs("form",{onSubmit:i(r),className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"New Quantity *"}),o.jsx("input",{...a("newQuantity",{required:"New quantity is required",min:{value:0,message:"Quantity cannot be negative"}}),type:"number",step:"0.1",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:`Enter quantity in ${c(n.unit,n.customUnit)}`})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Adjustment Type *"}),o.jsxs("select",{...a("type",{required:"Type is required"}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[o.jsx("option",{value:"restock",children:" Restock"}),o.jsx("option",{value:"manual_adjustment",children:" Manual Adjustment"}),o.jsx("option",{value:"waste",children:" Waste/Loss"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Reason"}),o.jsx("input",{...a("reason"),type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Brief reason for adjustment"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes"}),o.jsx("textarea",{...a("notes"),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Additional notes (optional)"})]}),o.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[o.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Cancel"}),o.jsx("button",{type:"submit",disabled:l,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-colors",children:l?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2 inline-block"}),"Adjusting..."]}):o.jsxs(o.Fragment,{children:[o.jsx(kd,{className:"w-4 h-4 mr-2 inline"}),"Adjust Inventory"]})})]})]})]})]})})}function ioe({isOpen:t,onClose:e,inventory:r,menuItemName:n,transactions:s}){if(!t)return null;const a=(c,u)=>c==="custom"&&u?u:c,i=c=>{switch(c){case"restock":return o.jsx(_i,{className:"w-4 h-4 text-green-600"});case"order_deduction":return o.jsx(L_,{className:"w-4 h-4 text-red-600"});case"manual_adjustment":return o.jsx(Fy,{className:"w-4 h-4 text-blue-600"});case"waste":return o.jsx(qg,{className:"w-4 h-4 text-yellow-600"});default:return o.jsx(Zi,{className:"w-4 h-4 text-gray-600"})}},l=c=>{switch(c){case"restock":return"Restock";case"order_deduction":return"Order Deduction";case"manual_adjustment":return"Manual Adjustment";case"waste":return"Waste/Loss";case"return":return"Return";default:return c}};return o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:o.jsxs("div",{className:"bg-white rounded-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[o.jsx("div",{className:"p-6 border-b border-gray-200",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Inventory History"}),o.jsx("p",{className:"text-gray-600",children:n})]}),o.jsx("button",{onClick:e,className:"p-1 text-gray-400 hover:text-gray-600",children:o.jsx(Zn,{className:"w-5 h-5"})})]})}),o.jsxs("div",{className:"p-6",children:[o.jsxs("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[o.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Current Status"}),o.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[o.jsxs("div",{children:[o.jsx("span",{className:"text-gray-600",children:"Current Stock:"}),o.jsxs("p",{className:"font-medium",children:[r.currentQuantity," ",a(r.unit,r.customUnit)]})]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-gray-600",children:"Minimum Threshold:"}),o.jsxs("p",{className:"font-medium",children:[r.minimumThreshold," ",a(r.unit,r.customUnit)]})]})]})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsx("h3",{className:"font-medium text-gray-900",children:"Transaction History"}),s.length===0?o.jsxs("div",{className:"text-center py-8 text-gray-500",children:[o.jsx(Ad,{className:"w-12 h-12 mx-auto mb-4 text-gray-400"}),o.jsx("p",{children:"No transaction history available"})]}):o.jsx("div",{className:"space-y-3",children:s.map(c=>o.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[i(c.type),o.jsx("span",{className:"font-medium text-gray-900",children:l(c.type)})]}),o.jsxs("span",{className:"text-sm text-gray-500",children:[new Date(c.createdAt).toLocaleDateString()," ",new Date(c.createdAt).toLocaleTimeString()]})]}),o.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[o.jsxs("div",{children:[o.jsx("span",{className:"text-gray-600",children:"Change:"}),o.jsxs("p",{className:`font-medium ${c.quantityChanged>=0?"text-green-600":"text-red-600"}`,children:[c.quantityChanged>=0?"+":"",c.quantityChanged," ",a(r.unit,r.customUnit)]})]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-gray-600",children:"Previous:"}),o.jsxs("p",{className:"font-medium",children:[c.previousQuantity," ",a(r.unit,r.customUnit)]})]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-gray-600",children:"New:"}),o.jsxs("p",{className:"font-medium",children:[c.newQuantity," ",a(r.unit,r.customUnit)]})]})]}),c.reason&&o.jsxs("div",{className:"mt-2",children:[o.jsx("span",{className:"text-gray-600 text-sm",children:"Reason:"}),o.jsx("p",{className:"text-sm",children:c.reason})]}),c.notes&&o.jsxs("div",{className:"mt-2",children:[o.jsx("span",{className:"text-gray-600 text-sm",children:"Notes:"}),o.jsx("p",{className:"text-sm",children:c.notes})]}),c.orderId&&o.jsxs("div",{className:"mt-2",children:[o.jsx("span",{className:"text-gray-600 text-sm",children:"Order ID:"}),o.jsx("p",{className:"text-sm font-mono",children:c.orderId})]})]},c.id))})]}),o.jsx("div",{className:"flex justify-end pt-6",children:o.jsx("button",{onClick:e,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Close"})})]})]})})}function ooe(){const{restaurant:t}=ya(),{user:e}=Xc(),[r]=CV(),[n,s]=X.useState([]),[a,i]=X.useState([]),[l,c]=X.useState([]),[u,d]=X.useState(""),[f,m]=X.useState("all"),[h,g]=X.useState(!1),[p,v]=X.useState("create"),[b,w]=X.useState(null),[N,j]=X.useState([]),[F,U]=X.useState(!0),[A,S]=X.useState(!1),{register:k,handleSubmit:M,reset:I,setValue:E,watch:D}=Hn(),{register:G,handleSubmit:Z,reset:ae}=Hn(),de=D("unit");X.useEffect(()=>{t&&se()},[t]),X.useEffect(()=>{Y()},[a,u,f]),X.useEffect(()=>{const V=r.get("item");if(V&&n.length>0&&a.length>=0){const xe=a.find(B=>B.menuItemId===V);xe?re(xe):n.find(Ee=>Ee.id===V)&&(w(null),v("create"),I({menuItemId:V,currentQuantity:0,unit:"pieces",minimumThreshold:5,consumptionPerOrder:1,isTracked:!0,autoDeduct:!0}),g(!0))}},[r,n,a]);const se=async()=>{if(t)try{U(!0);const[V,xe]=await Promise.all([cs.getMenuItemsForRestaurant(t.id),Cl.getInventoryForRestaurant(t.id)]);V.success&&V.data&&s(V.data),xe.success&&xe.data&&i(xe.data)}catch{fe.error("Failed to load inventory data")}finally{U(!1)}},Y=()=>{let V=a;switch(u&&(V=V.filter(xe=>{var Me;const B=n.find(Ie=>Ie.id===xe.menuItemId);return((B==null?void 0:B.name)||"").toLowerCase().includes(u.toLowerCase())||((Me=xe.supplier)==null?void 0:Me.toLowerCase().includes(u.toLowerCase()))})),f){case"tracked":V=V.filter(xe=>xe.isTracked);break;case"low_stock":V=V.filter(xe=>xe.isTracked&&xe.currentQuantity<=xe.minimumThreshold);break;case"out_of_stock":V=V.filter(xe=>xe.isTracked&&xe.currentQuantity===0);break}c(V)},ye=()=>{var xe;const V=n.filter(B=>!a.some(Ee=>Ee.menuItemId===B.id));if(V.length===0){fe.error("All menu items already have inventory setup");return}w(null),v("create"),I({menuItemId:((xe=V[0])==null?void 0:xe.id)||"",currentQuantity:0,unit:"pieces",minimumThreshold:5,consumptionPerOrder:1,isTracked:!0,autoDeduct:!0}),g(!0)},re=V=>{w(V),v("edit"),E("menuItemId",V.menuItemId),E("currentQuantity",V.currentQuantity),E("unit",V.unit),E("customUnit",V.customUnit),E("minimumThreshold",V.minimumThreshold),E("consumptionPerOrder",V.consumptionPerOrder),E("maxCapacity",V.maxCapacity),E("costPerUnit",V.costPerUnit),E("supplier",V.supplier),E("isTracked",V.isTracked),E("autoDeduct",V.autoDeduct),g(!0)},C=V=>{w(V),v("adjust"),ae({newQuantity:V.currentQuantity,type:"manual_adjustment"}),g(!0)},O=async V=>{if(t)try{w(V),v("history");const xe=await Cl.getTransactionHistory(V.id,t.id);xe.success&&xe.data?j(xe.data):(j([]),fe.error("Failed to load transaction history")),g(!0)}catch{fe.error("Failed to load transaction history")}},L=async V=>{if(!(!t||!e))try{if(S(!0),b){const xe=await Cl.updateInventoryItem(b.id,t.id,V);xe.success?(fe.success("Inventory updated successfully"),await se()):fe.error(xe.error||"Failed to update inventory")}else{const xe=await Cl.createInventoryItem({...V,restaurantId:t.id});xe.success?(fe.success("Inventory created successfully"),await se()):fe.error(xe.error||"Failed to create inventory")}g(!1),w(null)}catch{fe.error("Failed to save inventory")}finally{S(!1)}},H=async V=>{if(!(!t||!e||!b))try{S(!0);const xe=await Cl.adjustInventoryQuantity(b.id,t.id,V.newQuantity,V.type,e.id,V.reason,V.notes);xe.success?(fe.success("Inventory adjusted successfully"),await se(),g(!1),w(null)):fe.error(xe.error||"Failed to adjust inventory")}catch{fe.error("Failed to adjust inventory")}finally{S(!1)}},K=async V=>{if(!(!t||!confirm("Are you sure you want to delete this inventory item?")))try{const xe=await Cl.deleteInventoryItem(V.id,t.id);xe.success?(fe.success("Inventory deleted successfully"),await se()):fe.error(xe.error||"Failed to delete inventory")}catch{fe.error("Failed to delete inventory")}},q=V=>{const xe=n.find(B=>B.id===V);return(xe==null?void 0:xe.name)||"Unknown Item"},te=V=>V.isTracked?V.currentQuantity===0?{status:"Out of Stock",color:"text-red-600",icon:o.jsx(qg,{className:"w-4 h-4"})}:V.currentQuantity<=V.minimumThreshold?{status:"Low Stock",color:"text-yellow-600",icon:o.jsx(L_,{className:"w-4 h-4"})}:{status:"In Stock",color:"text-green-600",icon:o.jsx(_i,{className:"w-4 h-4"})}:{status:"Not Tracked",color:"text-gray-500",icon:o.jsx(zc,{className:"w-4 h-4"})},oe={totalItems:a.length,trackedItems:a.filter(V=>V.isTracked).length,lowStockItems:a.filter(V=>V.isTracked&&V.currentQuantity<=V.minimumThreshold).length,outOfStockItems:a.filter(V=>V.isTracked&&V.currentQuantity===0).length};return t?o.jsxs("div",{className:"min-h-screen",style:{background:"var(--color-background)"},children:[o.jsx("header",{className:"bg-white/80 backdrop-blur-md border-b border-gray-200 sticky top-0 z-40",children:o.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Inventory Management"}),o.jsx("p",{className:"text-gray-600",children:"Track and manage your restaurant inventory"})]}),o.jsxs("button",{onClick:ye,className:"btn btn-theme-primary",disabled:n.filter(V=>!a.some(xe=>xe.menuItemId===V.id)).length===0,children:[o.jsx(Wn,{className:"w-4 h-4 mr-2"}),"Add Inventory"]})]})})}),o.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-6",children:[o.jsx("div",{className:"card p-6",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:o.jsx(Zi,{className:"w-6 h-6 text-blue-600"})}),o.jsxs("div",{className:"ml-4",children:[o.jsx("p",{className:"text-sm text-gray-600",children:"Total Items"}),o.jsx("p",{className:"text-2xl font-bold text-gray-900",children:oe.totalItems})]})]})}),o.jsx("div",{className:"card p-6",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"p-3 bg-green-100 rounded-lg",children:o.jsx(Ci,{className:"w-6 h-6 text-green-600"})}),o.jsxs("div",{className:"ml-4",children:[o.jsx("p",{className:"text-sm text-gray-600",children:"Tracked"}),o.jsx("p",{className:"text-2xl font-bold text-gray-900",children:oe.trackedItems})]})]})}),o.jsx("div",{className:"card p-6",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"p-3 bg-yellow-100 rounded-lg",children:o.jsx(L_,{className:"w-6 h-6 text-yellow-600"})}),o.jsxs("div",{className:"ml-4",children:[o.jsx("p",{className:"text-sm text-gray-600",children:"Low Stock"}),o.jsx("p",{className:"text-2xl font-bold text-gray-900",children:oe.lowStockItems})]})]})}),o.jsx("div",{className:"card p-6",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"p-3 bg-red-100 rounded-lg",children:o.jsx(qg,{className:"w-6 h-6 text-red-600"})}),o.jsxs("div",{className:"ml-4",children:[o.jsx("p",{className:"text-sm text-gray-600",children:"Out of Stock"}),o.jsx("p",{className:"text-2xl font-bold text-gray-900",children:oe.outOfStockItems})]})]})})]}),o.jsx("div",{className:"card p-6 mb-6",children:o.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[o.jsxs("div",{className:"flex-1 relative",children:[o.jsx(Eo,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),o.jsx("input",{type:"text",placeholder:"Search inventory items...",value:u,onChange:V=>d(V.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(Wg,{className:"w-5 h-5 text-gray-600"}),o.jsxs("select",{value:f,onChange:V=>m(V.target.value),className:"px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[o.jsx("option",{value:"all",children:"All Items"}),o.jsx("option",{value:"tracked",children:"Tracked Only"}),o.jsx("option",{value:"low_stock",children:"Low Stock"}),o.jsx("option",{value:"out_of_stock",children:"Out of Stock"})]})]}),o.jsxs("button",{onClick:se,className:"btn btn-secondary",children:[o.jsx(Ox,{className:"w-4 h-4 mr-2"}),"Refresh"]})]})]})}),F?o.jsxs("div",{className:"text-center py-12",children:[o.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mb-4"}),o.jsx("p",{className:"text-gray-600",children:"Loading inventory..."})]}):o.jsx("div",{className:"space-y-4",children:l.length===0?o.jsxs("div",{className:"text-center py-12",children:[o.jsx(Zi,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),o.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No inventory items found"}),o.jsx("p",{className:"text-gray-600 mb-4",children:a.length===0?"Start by adding inventory tracking for your menu items":"Try adjusting your search or filter settings"}),a.length===0&&o.jsxs("button",{onClick:ye,className:"btn btn-theme-primary",children:[o.jsx(Wn,{className:"w-4 h-4 mr-2"}),"Add First Inventory Item"]})]}):l.map(V=>o.jsx(loe,{inventory:V,menuItemName:q(V.menuItemId),stockStatus:te(V),onEdit:re,onAdjust:C,onHistory:O,onDelete:K},V.id))})]}),h&&(p==="create"||p==="edit")&&o.jsx(soe,{isOpen:!0,onClose:()=>g(!1),onSave:L,inventory:b,menuItems:n,existingInventory:a,register:k,handleSubmit:M,selectedUnit:de,isSubmitting:A}),h&&p==="adjust"&&b&&o.jsx(aoe,{isOpen:!0,onClose:()=>g(!1),onSave:H,inventory:b,menuItemName:q(b.menuItemId),register:G,handleSubmit:Z,isSubmitting:A}),h&&p==="history"&&b&&o.jsx(ioe,{isOpen:!0,onClose:()=>g(!1),inventory:b,menuItemName:q(b.menuItemId),transactions:N})]}):o.jsx("div",{className:"min-h-screen flex items-center justify-center",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),o.jsx("p",{className:"text-gray-600",children:"Loading..."})]})})}function loe({inventory:t,menuItemName:e,stockStatus:r,onEdit:n,onAdjust:s,onHistory:a,onDelete:i}){const l=(c,u)=>c==="custom"&&u?u:c;return o.jsx("div",{className:"card p-6",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex-1",children:[o.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[o.jsx("h3",{className:"font-semibold text-gray-900 text-lg",children:e}),o.jsxs("div",{className:`flex items-center space-x-1 ${r.color}`,children:[r.icon,o.jsx("span",{className:"text-sm font-medium",children:r.status})]})]}),o.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[o.jsxs("div",{children:[o.jsx("span",{className:"text-gray-600",children:"Current Stock:"}),o.jsxs("p",{className:"font-medium",children:[t.currentQuantity," ",l(t.unit,t.customUnit)]})]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-gray-600",children:"Minimum:"}),o.jsxs("p",{className:"font-medium",children:[t.minimumThreshold," ",l(t.unit,t.customUnit)]})]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-gray-600",children:"Per Order:"}),o.jsxs("p",{className:"font-medium",children:[t.consumptionPerOrder," ",l(t.unit,t.customUnit)]})]}),t.supplier&&o.jsxs("div",{children:[o.jsx("span",{className:"text-gray-600",children:"Supplier:"}),o.jsx("p",{className:"font-medium",children:t.supplier})]})]}),o.jsxs("div",{className:"flex items-center space-x-4 mt-3",children:[t.isTracked?o.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[o.jsx(Ci,{className:"w-3 h-3 mr-1"}),"Tracked"]}):o.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:[o.jsx(zc,{className:"w-3 h-3 mr-1"}),"Not Tracked"]}),t.autoDeduct&&o.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:"Auto Deduct"}),t.lastRestockedAt&&o.jsxs("span",{className:"text-xs text-gray-500",children:["Last restocked: ",new Date(t.lastRestockedAt).toLocaleDateString()]})]})]}),o.jsxs("div",{className:"flex space-x-2 ml-4",children:[o.jsx("button",{onClick:()=>a(t),className:"p-2 bg-gray-100 text-gray-600 hover:bg-gray-200 rounded-lg",title:"View History",children:o.jsx(JG,{className:"w-4 h-4"})}),o.jsx("button",{onClick:()=>s(t),className:"p-2 bg-blue-100 text-blue-600 hover:bg-blue-200 rounded-lg",title:"Adjust Quantity",children:o.jsx(xd,{className:"w-4 h-4"})}),o.jsx("button",{onClick:()=>n(t),className:"p-2 bg-yellow-100 text-yellow-600 hover:bg-yellow-200 rounded-lg",title:"Edit",children:o.jsx(Cd,{className:"w-4 h-4"})}),o.jsx("button",{onClick:()=>i(t),className:"p-2 bg-red-100 text-red-600 hover:bg-red-200 rounded-lg",title:"Delete",children:o.jsx(ga,{className:"w-4 h-4"})})]})]})})}function yn(t){"@babel/helpers - typeof";return yn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},yn(t)}var La=Uint8Array,Xi=Uint16Array,x3=Int32Array,ub=new La([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),db=new La([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Z_=new La([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),_L=function(t,e){for(var r=new Xi(31),n=0;n<31;++n)r[n]=e+=1<<t[n-1];for(var s=new x3(r[30]),n=1;n<30;++n)for(var a=r[n];a<r[n+1];++a)s[a]=a-r[n]<<5|n;return{b:r,r:s}},NL=_L(ub,2),SL=NL.b,eN=NL.r;SL[28]=258,eN[258]=28;var TL=_L(db,0),coe=TL.b,Ok=TL.r,tN=new Xi(32768);for(var On=0;On<32768;++On){var Pu=(On&43690)>>1|(On&21845)<<1;Pu=(Pu&52428)>>2|(Pu&13107)<<2,Pu=(Pu&61680)>>4|(Pu&3855)<<4,tN[On]=((Pu&65280)>>8|(Pu&255)<<8)>>1}var $l=function(t,e,r){for(var n=t.length,s=0,a=new Xi(e);s<n;++s)t[s]&&++a[t[s]-1];var i=new Xi(e);for(s=1;s<e;++s)i[s]=i[s-1]+a[s-1]<<1;var l;if(r){l=new Xi(1<<e);var c=15-e;for(s=0;s<n;++s)if(t[s])for(var u=s<<4|t[s],d=e-t[s],f=i[t[s]-1]++<<d,m=f|(1<<d)-1;f<=m;++f)l[tN[f]>>c]=u}else for(l=new Xi(n),s=0;s<n;++s)t[s]&&(l[s]=tN[i[t[s]-1]++]>>15-t[s]);return l},Fd=new La(288);for(var On=0;On<144;++On)Fd[On]=8;for(var On=144;On<256;++On)Fd[On]=9;for(var On=256;On<280;++On)Fd[On]=7;for(var On=280;On<288;++On)Fd[On]=8;var ox=new La(32);for(var On=0;On<32;++On)ox[On]=5;var uoe=$l(Fd,9,0),doe=$l(Fd,9,1),foe=$l(ox,5,0),hoe=$l(ox,5,1),Ow=function(t){for(var e=t[0],r=1;r<t.length;++r)t[r]>e&&(e=t[r]);return e},qo=function(t,e,r){var n=e/8|0;return(t[n]|t[n+1]<<8)>>(e&7)&r},Mw=function(t,e){var r=e/8|0;return(t[r]|t[r+1]<<8|t[r+2]<<16)>>(e&7)},y3=function(t){return(t+7)/8|0},AL=function(t,e,r){return(r==null||r>t.length)&&(r=t.length),new La(t.subarray(e,r))},moe=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Go=function(t,e,r){var n=new Error(e||moe[t]);if(n.code=t,Error.captureStackTrace&&Error.captureStackTrace(n,Go),!r)throw n;return n},poe=function(t,e,r,n){var s=t.length,a=0;if(!s||e.f&&!e.l)return r||new La(0);var i=!r,l=i||e.i!=2,c=e.i;i&&(r=new La(s*3));var u=function(xe){var B=r.length;if(xe>B){var Ee=new La(Math.max(B*2,xe));Ee.set(r),r=Ee}},d=e.f||0,f=e.p||0,m=e.b||0,h=e.l,g=e.d,p=e.m,v=e.n,b=s*8;do{if(!h){d=qo(t,f,1);var w=qo(t,f+1,3);if(f+=3,w)if(w==1)h=doe,g=hoe,p=9,v=5;else if(w==2){var U=qo(t,f,31)+257,A=qo(t,f+10,15)+4,S=U+qo(t,f+5,31)+1;f+=14;for(var k=new La(S),M=new La(19),I=0;I<A;++I)M[Z_[I]]=qo(t,f+I*3,7);f+=A*3;for(var E=Ow(M),D=(1<<E)-1,G=$l(M,E,1),I=0;I<S;){var Z=G[qo(t,f,D)];f+=Z&15;var N=Z>>4;if(N<16)k[I++]=N;else{var ae=0,de=0;for(N==16?(de=3+qo(t,f,3),f+=2,ae=k[I-1]):N==17?(de=3+qo(t,f,7),f+=3):N==18&&(de=11+qo(t,f,127),f+=7);de--;)k[I++]=ae}}var se=k.subarray(0,U),Y=k.subarray(U);p=Ow(se),v=Ow(Y),h=$l(se,p,1),g=$l(Y,v,1)}else Go(1);else{var N=y3(f)+4,j=t[N-4]|t[N-3]<<8,F=N+j;if(F>s){c&&Go(0);break}l&&u(m+j),r.set(t.subarray(N,F),m),e.b=m+=j,e.p=f=F*8,e.f=d;continue}if(f>b){c&&Go(0);break}}l&&u(m+131072);for(var ye=(1<<p)-1,re=(1<<v)-1,C=f;;C=f){var ae=h[Mw(t,f)&ye],O=ae>>4;if(f+=ae&15,f>b){c&&Go(0);break}if(ae||Go(2),O<256)r[m++]=O;else if(O==256){C=f,h=null;break}else{var L=O-254;if(O>264){var I=O-257,H=ub[I];L=qo(t,f,(1<<H)-1)+SL[I],f+=H}var K=g[Mw(t,f)&re],q=K>>4;K||Go(3),f+=K&15;var Y=coe[q];if(q>3){var H=db[q];Y+=Mw(t,f)&(1<<H)-1,f+=H}if(f>b){c&&Go(0);break}l&&u(m+131072);var te=m+L;if(m<Y){var oe=a-Y,V=Math.min(Y,te);for(oe+m<0&&Go(3);m<V;++m)r[m]=n[oe+m]}for(;m<te;++m)r[m]=r[m-Y]}}e.l=h,e.p=C,e.b=m,e.f=d,h&&(d=1,e.m=p,e.d=g,e.n=v)}while(!d);return m!=r.length&&i?AL(r,0,m):r.subarray(0,m)},mc=function(t,e,r){r<<=e&7;var n=e/8|0;t[n]|=r,t[n+1]|=r>>8},gp=function(t,e,r){r<<=e&7;var n=e/8|0;t[n]|=r,t[n+1]|=r>>8,t[n+2]|=r>>16},Vw=function(t,e){for(var r=[],n=0;n<t.length;++n)t[n]&&r.push({s:n,f:t[n]});var s=r.length,a=r.slice();if(!s)return{t:CL,l:0};if(s==1){var i=new La(r[0].s+1);return i[r[0].s]=1,{t:i,l:1}}r.sort(function(F,U){return F.f-U.f}),r.push({s:-1,f:25001});var l=r[0],c=r[1],u=0,d=1,f=2;for(r[0]={s:-1,f:l.f+c.f,l,r:c};d!=s-1;)l=r[r[u].f<r[f].f?u++:f++],c=r[u!=d&&r[u].f<r[f].f?u++:f++],r[d++]={s:-1,f:l.f+c.f,l,r:c};for(var m=a[0].s,n=1;n<s;++n)a[n].s>m&&(m=a[n].s);var h=new Xi(m+1),g=rN(r[d-1],h,0);if(g>e){var n=0,p=0,v=g-e,b=1<<v;for(a.sort(function(U,A){return h[A.s]-h[U.s]||U.f-A.f});n<s;++n){var w=a[n].s;if(h[w]>e)p+=b-(1<<g-h[w]),h[w]=e;else break}for(p>>=v;p>0;){var N=a[n].s;h[N]<e?p-=1<<e-h[N]++-1:++n}for(;n>=0&&p;--n){var j=a[n].s;h[j]==e&&(--h[j],++p)}g=e}return{t:new La(h),l:g}},rN=function(t,e,r){return t.s==-1?Math.max(rN(t.l,e,r+1),rN(t.r,e,r+1)):e[t.s]=r},Mk=function(t){for(var e=t.length;e&&!t[--e];);for(var r=new Xi(++e),n=0,s=t[0],a=1,i=function(c){r[n++]=c},l=1;l<=e;++l)if(t[l]==s&&l!=e)++a;else{if(!s&&a>2){for(;a>138;a-=138)i(32754);a>2&&(i(a>10?a-11<<5|28690:a-3<<5|12305),a=0)}else if(a>3){for(i(s),--a;a>6;a-=6)i(8304);a>2&&(i(a-3<<5|8208),a=0)}for(;a--;)i(s);a=1,s=t[l]}return{c:r.subarray(0,n),n:e}},xp=function(t,e){for(var r=0,n=0;n<e.length;++n)r+=t[n]*e[n];return r},EL=function(t,e,r){var n=r.length,s=y3(e+2);t[s]=n&255,t[s+1]=n>>8,t[s+2]=t[s]^255,t[s+3]=t[s+1]^255;for(var a=0;a<n;++a)t[s+a+4]=r[a];return(s+4+n)*8},Vk=function(t,e,r,n,s,a,i,l,c,u,d){mc(e,d++,r),++s[256];for(var f=Vw(s,15),m=f.t,h=f.l,g=Vw(a,15),p=g.t,v=g.l,b=Mk(m),w=b.c,N=b.n,j=Mk(p),F=j.c,U=j.n,A=new Xi(19),S=0;S<w.length;++S)++A[w[S]&31];for(var S=0;S<F.length;++S)++A[F[S]&31];for(var k=Vw(A,7),M=k.t,I=k.l,E=19;E>4&&!M[Z_[E-1]];--E);var D=u+5<<3,G=xp(s,Fd)+xp(a,ox)+i,Z=xp(s,m)+xp(a,p)+i+14+3*E+xp(A,M)+2*A[16]+3*A[17]+7*A[18];if(c>=0&&D<=G&&D<=Z)return EL(e,d,t.subarray(c,c+u));var ae,de,se,Y;if(mc(e,d,1+(Z<G)),d+=2,Z<G){ae=$l(m,h,0),de=m,se=$l(p,v,0),Y=p;var ye=$l(M,I,0);mc(e,d,N-257),mc(e,d+5,U-1),mc(e,d+10,E-4),d+=14;for(var S=0;S<E;++S)mc(e,d+3*S,M[Z_[S]]);d+=3*E;for(var re=[w,F],C=0;C<2;++C)for(var O=re[C],S=0;S<O.length;++S){var L=O[S]&31;mc(e,d,ye[L]),d+=M[L],L>15&&(mc(e,d,O[S]>>5&127),d+=O[S]>>12)}}else ae=uoe,de=Fd,se=foe,Y=ox;for(var S=0;S<l;++S){var H=n[S];if(H>255){var L=H>>18&31;gp(e,d,ae[L+257]),d+=de[L+257],L>7&&(mc(e,d,H>>23&31),d+=ub[L]);var K=H&31;gp(e,d,se[K]),d+=Y[K],K>3&&(gp(e,d,H>>5&8191),d+=db[K])}else gp(e,d,ae[H]),d+=de[H]}return gp(e,d,ae[256]),d+de[256]},goe=new x3([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),CL=new La(0),xoe=function(t,e,r,n,s,a){var i=a.z||t.length,l=new La(n+i+5*(1+Math.ceil(i/7e3))+s),c=l.subarray(n,l.length-s),u=a.l,d=(a.r||0)&7;if(e){d&&(c[0]=a.r>>3);for(var f=goe[e-1],m=f>>13,h=f&8191,g=(1<<r)-1,p=a.p||new Xi(32768),v=a.h||new Xi(g+1),b=Math.ceil(r/3),w=2*b,N=function(Me){return(t[Me]^t[Me+1]<<b^t[Me+2]<<w)&g},j=new x3(25e3),F=new Xi(288),U=new Xi(32),A=0,S=0,k=a.i||0,M=0,I=a.w||0,E=0;k+2<i;++k){var D=N(k),G=k&32767,Z=v[D];if(p[G]=Z,v[D]=G,I<=k){var ae=i-k;if((A>7e3||M>24576)&&(ae>423||!u)){d=Vk(t,c,0,j,F,U,S,M,E,k-E,d),M=A=S=0,E=k;for(var de=0;de<286;++de)F[de]=0;for(var de=0;de<30;++de)U[de]=0}var se=2,Y=0,ye=h,re=G-Z&32767;if(ae>2&&D==N(k-re))for(var C=Math.min(m,ae)-1,O=Math.min(32767,k),L=Math.min(258,ae);re<=O&&--ye&&G!=Z;){if(t[k+se]==t[k+se-re]){for(var H=0;H<L&&t[k+H]==t[k+H-re];++H);if(H>se){if(se=H,Y=re,H>C)break;for(var K=Math.min(re,H-2),q=0,de=0;de<K;++de){var te=k-re+de&32767,oe=p[te],V=te-oe&32767;V>q&&(q=V,Z=te)}}}G=Z,Z=p[G],re+=G-Z&32767}if(Y){j[M++]=268435456|eN[se]<<18|Ok[Y];var xe=eN[se]&31,B=Ok[Y]&31;S+=ub[xe]+db[B],++F[257+xe],++U[B],I=k+se,++A}else j[M++]=t[k],++F[t[k]]}}for(k=Math.max(k,I);k<i;++k)j[M++]=t[k],++F[t[k]];d=Vk(t,c,u,j,F,U,S,M,E,k-E,d),u||(a.r=d&7|c[d/8|0]<<3,d-=7,a.h=v,a.p=p,a.i=k,a.w=I)}else{for(var k=a.w||0;k<i+u;k+=65535){var Ee=k+65535;Ee>=i&&(c[d/8|0]=u,Ee=i),d=EL(c,d+1,t.subarray(k,Ee))}a.i=i}return AL(l,0,n+y3(d)+s)},kL=function(){var t=1,e=0;return{p:function(r){for(var n=t,s=e,a=r.length|0,i=0;i!=a;){for(var l=Math.min(i+2655,a);i<l;++i)s+=n+=r[i];n=(n&65535)+15*(n>>16),s=(s&65535)+15*(s>>16)}t=n,e=s},d:function(){return t%=65521,e%=65521,(t&255)<<24|(t&65280)<<8|(e&255)<<8|e>>8}}},yoe=function(t,e,r,n,s){if(!s&&(s={l:1},e.dictionary)){var a=e.dictionary.subarray(-32768),i=new La(a.length+t.length);i.set(a),i.set(t,a.length),t=i,s.w=a.length}return xoe(t,e.level==null?6:e.level,e.mem==null?s.l?Math.ceil(Math.max(8,Math.min(13,Math.log(t.length)))*1.5):20:12+e.mem,r,n,s)},IL=function(t,e,r){for(;r;++e)t[e]=r,r>>>=8},voe=function(t,e){var r=e.level,n=r==0?0:r<6?1:r==9?3:2;if(t[0]=120,t[1]=n<<6|(e.dictionary&&32),t[1]|=31-(t[0]<<8|t[1])%31,e.dictionary){var s=kL();s.p(e.dictionary),IL(t,2,s.d())}},boe=function(t,e){return((t[0]&15)!=8||t[0]>>4>7||(t[0]<<8|t[1])%31)&&Go(6,"invalid zlib data"),(t[1]>>5&1)==1&&Go(6,"invalid zlib data: "+(t[1]&32?"need":"unexpected")+" dictionary"),(t[1]>>3&4)+2};function nN(t,e){e||(e={});var r=kL();r.p(t);var n=yoe(t,e,e.dictionary?6:2,4);return voe(n,e),IL(n,n.length-4,r.d()),n}function woe(t,e){return poe(t.subarray(boe(t),-4),{i:2},e,e)}var _oe=typeof TextDecoder<"u"&&new TextDecoder,Noe=0;try{_oe.decode(CL,{stream:!0}),Noe=1}catch{}var yr=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function Bw(){yr.console&&typeof yr.console.log=="function"&&yr.console.log.apply(yr.console,arguments)}var An={log:Bw,warn:function(t){yr.console&&(typeof yr.console.warn=="function"?yr.console.warn.apply(yr.console,arguments):Bw.call(null,arguments))},error:function(t){yr.console&&(typeof yr.console.error=="function"?yr.console.error.apply(yr.console,arguments):Bw(t))}};function Uw(t,e,r){var n=new XMLHttpRequest;n.open("GET",t),n.responseType="blob",n.onload=function(){bf(n.response,e,r)},n.onerror=function(){An.error("could not download file")},n.send()}function Bk(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function ry(t){try{t.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var lg,sN,bf=yr.saveAs||((typeof window>"u"?"undefined":yn(window))!=="object"||window!==yr?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(t,e,r){var n=yr.URL||yr.webkitURL,s=document.createElement("a");e=e||t.name||"download",s.download=e,s.rel="noopener",typeof t=="string"?(s.href=t,s.origin!==location.origin?Bk(s.href)?Uw(t,e,r):ry(s,s.target="_blank"):ry(s)):(s.href=n.createObjectURL(t),setTimeout(function(){n.revokeObjectURL(s.href)},4e4),setTimeout(function(){ry(s)},0))}:"msSaveOrOpenBlob"in navigator?function(t,e,r){if(e=e||t.name||"download",typeof t=="string")if(Bk(t))Uw(t,e,r);else{var n=document.createElement("a");n.href=t,n.target="_blank",setTimeout(function(){ry(n)})}else navigator.msSaveOrOpenBlob(function(s,a){return a===void 0?a={autoBom:!1}:yn(a)!=="object"&&(An.warn("Deprecated: Expected third argument to be a object"),a={autoBom:!a}),a.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(s.type)?new Blob(["\uFEFF",s],{type:s.type}):s}(t,r),e)}:function(t,e,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof t=="string")return Uw(t,e,r);var s=t.type==="application/octet-stream",a=/constructor/i.test(yr.HTMLElement)||yr.safari,i=/CriOS\/[\d]+/.test(navigator.userAgent);if((i||s&&a)&&(typeof FileReader>"u"?"undefined":yn(FileReader))==="object"){var l=new FileReader;l.onloadend=function(){var d=l.result;d=i?d:d.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=d:location=d,n=null},l.readAsDataURL(t)}else{var c=yr.URL||yr.webkitURL,u=c.createObjectURL(t);n?n.location=u:location.href=u,n=null,setTimeout(function(){c.revokeObjectURL(u)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function jL(t){var e;t=t||"",this.ok=!1,t.charAt(0)=="#"&&(t=t.substr(1,6)),t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[t=(t=t.replace(/ /g,"")).toLowerCase()]||t;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(l){return[parseInt(l[1]),parseInt(l[2]),parseInt(l[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(l){return[parseInt(l[1],16),parseInt(l[2],16),parseInt(l[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(l){return[parseInt(l[1]+l[1],16),parseInt(l[2]+l[2],16),parseInt(l[3]+l[3],16)]}}],n=0;n<r.length;n++){var s=r[n].re,a=r[n].process,i=s.exec(t);i&&(e=a(i),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var l=this.r.toString(16),c=this.g.toString(16),u=this.b.toString(16);return l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),u.length==1&&(u="0"+u),"#"+l+c+u}}/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function $w(t,e){var r=t[0],n=t[1],s=t[2],a=t[3];r=Sa(r,n,s,a,e[0],7,-680876936),a=Sa(a,r,n,s,e[1],12,-389564586),s=Sa(s,a,r,n,e[2],17,606105819),n=Sa(n,s,a,r,e[3],22,-1044525330),r=Sa(r,n,s,a,e[4],7,-176418897),a=Sa(a,r,n,s,e[5],12,1200080426),s=Sa(s,a,r,n,e[6],17,-1473231341),n=Sa(n,s,a,r,e[7],22,-45705983),r=Sa(r,n,s,a,e[8],7,1770035416),a=Sa(a,r,n,s,e[9],12,-1958414417),s=Sa(s,a,r,n,e[10],17,-42063),n=Sa(n,s,a,r,e[11],22,-1990404162),r=Sa(r,n,s,a,e[12],7,1804603682),a=Sa(a,r,n,s,e[13],12,-40341101),s=Sa(s,a,r,n,e[14],17,-1502002290),r=Ta(r,n=Sa(n,s,a,r,e[15],22,1236535329),s,a,e[1],5,-165796510),a=Ta(a,r,n,s,e[6],9,-1069501632),s=Ta(s,a,r,n,e[11],14,643717713),n=Ta(n,s,a,r,e[0],20,-373897302),r=Ta(r,n,s,a,e[5],5,-701558691),a=Ta(a,r,n,s,e[10],9,38016083),s=Ta(s,a,r,n,e[15],14,-660478335),n=Ta(n,s,a,r,e[4],20,-405537848),r=Ta(r,n,s,a,e[9],5,568446438),a=Ta(a,r,n,s,e[14],9,-1019803690),s=Ta(s,a,r,n,e[3],14,-187363961),n=Ta(n,s,a,r,e[8],20,1163531501),r=Ta(r,n,s,a,e[13],5,-1444681467),a=Ta(a,r,n,s,e[2],9,-51403784),s=Ta(s,a,r,n,e[7],14,1735328473),r=Aa(r,n=Ta(n,s,a,r,e[12],20,-1926607734),s,a,e[5],4,-378558),a=Aa(a,r,n,s,e[8],11,-2022574463),s=Aa(s,a,r,n,e[11],16,1839030562),n=Aa(n,s,a,r,e[14],23,-35309556),r=Aa(r,n,s,a,e[1],4,-1530992060),a=Aa(a,r,n,s,e[4],11,1272893353),s=Aa(s,a,r,n,e[7],16,-155497632),n=Aa(n,s,a,r,e[10],23,-1094730640),r=Aa(r,n,s,a,e[13],4,681279174),a=Aa(a,r,n,s,e[0],11,-358537222),s=Aa(s,a,r,n,e[3],16,-722521979),n=Aa(n,s,a,r,e[6],23,76029189),r=Aa(r,n,s,a,e[9],4,-640364487),a=Aa(a,r,n,s,e[12],11,-421815835),s=Aa(s,a,r,n,e[15],16,530742520),r=Ea(r,n=Aa(n,s,a,r,e[2],23,-995338651),s,a,e[0],6,-198630844),a=Ea(a,r,n,s,e[7],10,1126891415),s=Ea(s,a,r,n,e[14],15,-1416354905),n=Ea(n,s,a,r,e[5],21,-57434055),r=Ea(r,n,s,a,e[12],6,1700485571),a=Ea(a,r,n,s,e[3],10,-1894986606),s=Ea(s,a,r,n,e[10],15,-1051523),n=Ea(n,s,a,r,e[1],21,-2054922799),r=Ea(r,n,s,a,e[8],6,1873313359),a=Ea(a,r,n,s,e[15],10,-30611744),s=Ea(s,a,r,n,e[6],15,-1560198380),n=Ea(n,s,a,r,e[13],21,1309151649),r=Ea(r,n,s,a,e[4],6,-145523070),a=Ea(a,r,n,s,e[11],10,-1120210379),s=Ea(s,a,r,n,e[2],15,718787259),n=Ea(n,s,a,r,e[9],21,-343485551),t[0]=td(r,t[0]),t[1]=td(n,t[1]),t[2]=td(s,t[2]),t[3]=td(a,t[3])}function fb(t,e,r,n,s,a){return e=td(td(e,t),td(n,a)),td(e<<s|e>>>32-s,r)}function Sa(t,e,r,n,s,a,i){return fb(e&r|~e&n,t,e,s,a,i)}function Ta(t,e,r,n,s,a,i){return fb(e&n|r&~n,t,e,s,a,i)}function Aa(t,e,r,n,s,a,i){return fb(e^r^n,t,e,s,a,i)}function Ea(t,e,r,n,s,a,i){return fb(r^(e|~n),t,e,s,a,i)}function PL(t){var e,r=t.length,n=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=t.length;e+=64)$w(n,Soe(t.substring(e-64,e)));t=t.substring(e-64);var s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<t.length;e++)s[e>>2]|=t.charCodeAt(e)<<(e%4<<3);if(s[e>>2]|=128<<(e%4<<3),e>55)for($w(n,s),e=0;e<16;e++)s[e]=0;return s[14]=8*r,$w(n,s),n}function Soe(t){var e,r=[];for(e=0;e<64;e+=4)r[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return r}lg=yr.atob.bind(yr),sN=yr.btoa.bind(yr);var Uk="0123456789abcdef".split("");function Toe(t){for(var e="",r=0;r<4;r++)e+=Uk[t>>8*r+4&15]+Uk[t>>8*r&15];return e}function Aoe(t){return String.fromCharCode((255&t)>>0,(65280&t)>>8,(16711680&t)>>16,(4278190080&t)>>24)}function aN(t){return PL(t).map(Aoe).join("")}var Eoe=function(t){for(var e=0;e<t.length;e++)t[e]=Toe(t[e]);return t.join("")}(PL("hello"))!="5d41402abc4b2a76b9719d911017c592";function td(t,e){if(Eoe){var r=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(r>>16)<<16|65535&r}return t+e&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function iN(t,e){var r,n,s,a;if(t!==r){for(var i=(s=t,a=1+(256/t.length>>0),new Array(a+1).join(s)),l=[],c=0;c<256;c++)l[c]=c;var u=0;for(c=0;c<256;c++){var d=l[c];u=(u+d+i.charCodeAt(c))%256,l[c]=l[u],l[u]=d}r=t,n=l}else l=n;var f=e.length,m=0,h=0,g="";for(c=0;c<f;c++)h=(h+(d=l[m=(m+1)%256]))%256,l[m]=l[h],l[h]=d,i=l[(l[m]+l[h])%256],g+=String.fromCharCode(e.charCodeAt(c)^i);return g}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var $k={print:4,modify:8,copy:16,"annot-forms":32};function f0(t,e,r,n){this.v=1,this.r=2;var s=192;t.forEach(function(l){if($k.perm!==void 0)throw new Error("Invalid permission: "+l);s+=$k[l]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var a=(e+this.padding).substr(0,32),i=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(a,i),this.P=-(1+(255^s)),this.encryptionKey=aN(a+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=iN(this.encryptionKey,this.padding)}function h0(t){if(/[^\u0000-\u00ff]/.test(t))throw new Error("Invalid PDF Name Object: "+t+", Only accept ASCII characters.");for(var e="",r=t.length,n=0;n<r;n++){var s=t.charCodeAt(n);s<33||s===35||s===37||s===40||s===41||s===47||s===60||s===62||s===91||s===93||s===123||s===125||s>126?e+="#"+("0"+s.toString(16)).slice(-2):e+=t[n]}return e}function zk(t){if(yn(t)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(r,n,s){if(s=s||!1,typeof r!="string"||typeof n!="function"||typeof s!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(r)||(e[r]={});var a=Math.random().toString(35);return e[r][a]=[n,!!s],a},this.unsubscribe=function(r){for(var n in e)if(e[n][r])return delete e[n][r],Object.keys(e[n]).length===0&&delete e[n],!0;return!1},this.publish=function(r){if(e.hasOwnProperty(r)){var n=Array.prototype.slice.call(arguments,1),s=[];for(var a in e[r]){var i=e[r][a];try{i[0].apply(t,n)}catch(l){yr.console&&An.error("jsPDF PubSub Error",l.message,l)}i[1]&&s.push(a)}s.length&&s.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function s2(t){if(!(this instanceof s2))return new s2(t);var e="opacity,stroke-opacity".split(",");for(var r in t)t.hasOwnProperty(r)&&e.indexOf(r)>=0&&(this[r]=t[r]);this.id="",this.objectNumber=-1}function RL(t,e){this.gState=t,this.matrix=e,this.id="",this.objectNumber=-1}function Af(t,e,r,n,s){if(!(this instanceof Af))return new Af(t,e,r,n,s);this.type=t==="axial"?2:3,this.coords=e,this.colors=r,RL.call(this,n,s)}function k0(t,e,r,n,s){if(!(this instanceof k0))return new k0(t,e,r,n,s);this.boundingBox=t,this.xStep=e,this.yStep=r,this.stream="",this.cloneIndex=0,RL.call(this,n,s)}function pr(t){var e,r=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],s=arguments[2],a=arguments[3],i=[],l=1,c=16,u="S",d=null;yn(t=t||{})==="object"&&(r=t.orientation,n=t.unit||n,s=t.format||s,a=t.compress||t.compressPdf||a,(d=t.encryption||null)!==null&&(d.userPassword=d.userPassword||"",d.ownerPassword=d.ownerPassword||"",d.userPermissions=d.userPermissions||[]),l=typeof t.userUnit=="number"?Math.abs(t.userUnit):1,t.precision!==void 0&&(e=t.precision),t.floatPrecision!==void 0&&(c=t.floatPrecision),u=t.defaultPathOperation||"S"),i=t.filters||(a===!0?["FlateEncode"]:i),n=n||"mm",r=(""+(r||"P")).toLowerCase();var f=t.putOnlyUsedFonts||!1,m={},h={internal:{},__private__:{}};h.__private__.PubSub=zk;var g="1.3",p=h.__private__.getPdfVersion=function(){return g};h.__private__.setPdfVersion=function(T){g=T};var v={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};h.__private__.getPageFormats=function(){return v};var b=h.__private__.getPageFormat=function(T){return v[T]};s=s||"a4";var w={COMPAT:"compat",ADVANCED:"advanced"},N=w.COMPAT;function j(){this.saveGraphicsState(),he(new Et(ht,0,0,-ht,0,va()*ht).toString()+" cm"),this.setFontSize(this.getFontSize()/ht),u="n",N=w.ADVANCED}function F(){this.restoreGraphicsState(),u="S",N=w.COMPAT}var U=h.__private__.combineFontStyleAndFontWeight=function(T,Q){if(T=="bold"&&Q=="normal"||T=="bold"&&Q==400||T=="normal"&&Q=="italic"||T=="bold"&&Q=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return Q&&(T=Q==400||Q==="normal"?T==="italic"?"italic":"normal":Q!=700&&Q!=="bold"||T!=="normal"?(Q==700?"bold":Q)+""+T:"bold"),T};h.advancedAPI=function(T){var Q=N===w.COMPAT;return Q&&j.call(this),typeof T!="function"||(T(this),Q&&F.call(this)),this},h.compatAPI=function(T){var Q=N===w.ADVANCED;return Q&&F.call(this),typeof T!="function"||(T(this),Q&&j.call(this)),this},h.isAdvancedAPI=function(){return N===w.ADVANCED};var A,S=function(T){if(N!==w.ADVANCED)throw new Error(T+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},k=h.roundToPrecision=h.__private__.roundToPrecision=function(T,Q){var Se=e||Q;if(isNaN(T)||isNaN(Se))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return T.toFixed(Se).replace(/0+$/,"")};A=h.hpf=h.__private__.hpf=typeof c=="number"?function(T){if(isNaN(T))throw new Error("Invalid argument passed to jsPDF.hpf");return k(T,c)}:c==="smart"?function(T){if(isNaN(T))throw new Error("Invalid argument passed to jsPDF.hpf");return k(T,T>-1&&T<1?16:5)}:function(T){if(isNaN(T))throw new Error("Invalid argument passed to jsPDF.hpf");return k(T,16)};var M=h.f2=h.__private__.f2=function(T){if(isNaN(T))throw new Error("Invalid argument passed to jsPDF.f2");return k(T,2)},I=h.__private__.f3=function(T){if(isNaN(T))throw new Error("Invalid argument passed to jsPDF.f3");return k(T,3)},E=h.scale=h.__private__.scale=function(T){if(isNaN(T))throw new Error("Invalid argument passed to jsPDF.scale");return N===w.COMPAT?T*ht:N===w.ADVANCED?T:void 0},D=function(T){return N===w.COMPAT?va()-T:N===w.ADVANCED?T:void 0},G=function(T){return E(D(T))};h.__private__.setPrecision=h.setPrecision=function(T){typeof parseInt(T,10)=="number"&&(e=parseInt(T,10))};var Z,ae="00000000000000000000000000000000",de=h.__private__.getFileId=function(){return ae},se=h.__private__.setFileId=function(T){return ae=T!==void 0&&/^[a-fA-F0-9]{32}$/.test(T)?T.toUpperCase():ae.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),d!==null&&(Pn=new f0(d.userPermissions,d.userPassword,d.ownerPassword,ae)),ae};h.setFileId=function(T){return se(T),this},h.getFileId=function(){return de()};var Y=h.__private__.convertDateToPDFDate=function(T){var Q=T.getTimezoneOffset(),Se=Q<0?"+":"-",ke=Math.floor(Math.abs(Q/60)),Le=Math.abs(Q%60),ot=[Se,L(ke),"'",L(Le),"'"].join("");return["D:",T.getFullYear(),L(T.getMonth()+1),L(T.getDate()),L(T.getHours()),L(T.getMinutes()),L(T.getSeconds()),ot].join("")},ye=h.__private__.convertPDFDateToDate=function(T){var Q=parseInt(T.substr(2,4),10),Se=parseInt(T.substr(6,2),10)-1,ke=parseInt(T.substr(8,2),10),Le=parseInt(T.substr(10,2),10),ot=parseInt(T.substr(12,2),10),Tt=parseInt(T.substr(14,2),10);return new Date(Q,Se,ke,Le,ot,Tt,0)},re=h.__private__.setCreationDate=function(T){var Q;if(T===void 0&&(T=new Date),T instanceof Date)Q=Y(T);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(T))throw new Error("Invalid argument passed to jsPDF.setCreationDate");Q=T}return Z=Q},C=h.__private__.getCreationDate=function(T){var Q=Z;return T==="jsDate"&&(Q=ye(Z)),Q};h.setCreationDate=function(T){return re(T),this},h.getCreationDate=function(T){return C(T)};var O,L=h.__private__.padd2=function(T){return("0"+parseInt(T)).slice(-2)},H=h.__private__.padd2Hex=function(T){return("00"+(T=T.toString())).substr(T.length)},K=0,q=[],te=[],oe=0,V=[],xe=[],B=!1,Ee=te,Me=function(){K=0,oe=0,te=[],q=[],V=[],pe=ir(),ge=ir()};h.__private__.setCustomOutputDestination=function(T){B=!0,Ee=T};var Ie=function(T){B||(Ee=T)};h.__private__.resetCustomOutputDestination=function(){B=!1,Ee=te};var he=h.__private__.out=function(T){return T=T.toString(),oe+=T.length+1,Ee.push(T),Ee},qe=h.__private__.write=function(T){return he(arguments.length===1?T.toString():Array.prototype.join.call(arguments," "))},ct=h.__private__.getArrayBuffer=function(T){for(var Q=T.length,Se=new ArrayBuffer(Q),ke=new Uint8Array(Se);Q--;)ke[Q]=T.charCodeAt(Q);return Se},lt=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];h.__private__.getStandardFonts=function(){return lt};var ue=t.fontSize||16;h.__private__.setFontSize=h.setFontSize=function(T){return ue=N===w.ADVANCED?T/ht:T,this};var Ne,Ae=h.__private__.getFontSize=h.getFontSize=function(){return N===w.COMPAT?ue:ue*ht},Be=t.R2L||!1;h.__private__.setR2L=h.setR2L=function(T){return Be=T,this},h.__private__.getR2L=h.getR2L=function(){return Be};var Ue,Ce=h.__private__.setZoomMode=function(T){var Q=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(T))Ne=T;else if(isNaN(T)){if(Q.indexOf(T)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+T+'" is not recognized.');Ne=T}else Ne=parseInt(T,10)};h.__private__.getZoomMode=function(){return Ne};var Ye,It=h.__private__.setPageMode=function(T){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(T)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+T+'" is not recognized.');Ue=T};h.__private__.getPageMode=function(){return Ue};var Dt=h.__private__.setLayoutMode=function(T){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(T)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+T+'" is not recognized.');Ye=T};h.__private__.getLayoutMode=function(){return Ye},h.__private__.setDisplayMode=h.setDisplayMode=function(T,Q,Se){return Ce(T),Dt(Q),It(Se),this};var Ot={title:"",subject:"",author:"",keywords:"",creator:""};h.__private__.getDocumentProperty=function(T){if(Object.keys(Ot).indexOf(T)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Ot[T]},h.__private__.getDocumentProperties=function(){return Ot},h.__private__.setDocumentProperties=h.setProperties=h.setDocumentProperties=function(T){for(var Q in Ot)Ot.hasOwnProperty(Q)&&T[Q]&&(Ot[Q]=T[Q]);return this},h.__private__.setDocumentProperty=function(T,Q){if(Object.keys(Ot).indexOf(T)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Ot[T]=Q};var Pt,ht,or,Ve,tt,nt={},At={},mr=[],Wt={},Te={},je={},et={},St=null,vt=0,st=[],zt=new zk(h),Qt=t.hotfixes||[],nr={},dr={},Vr=[],Et=function T(Q,Se,ke,Le,ot,Tt){if(!(this instanceof T))return new T(Q,Se,ke,Le,ot,Tt);isNaN(Q)&&(Q=1),isNaN(Se)&&(Se=0),isNaN(ke)&&(ke=0),isNaN(Le)&&(Le=1),isNaN(ot)&&(ot=0),isNaN(Tt)&&(Tt=0),this._matrix=[Q,Se,ke,Le,ot,Tt]};Object.defineProperty(Et.prototype,"sx",{get:function(){return this._matrix[0]},set:function(T){this._matrix[0]=T}}),Object.defineProperty(Et.prototype,"shy",{get:function(){return this._matrix[1]},set:function(T){this._matrix[1]=T}}),Object.defineProperty(Et.prototype,"shx",{get:function(){return this._matrix[2]},set:function(T){this._matrix[2]=T}}),Object.defineProperty(Et.prototype,"sy",{get:function(){return this._matrix[3]},set:function(T){this._matrix[3]=T}}),Object.defineProperty(Et.prototype,"tx",{get:function(){return this._matrix[4]},set:function(T){this._matrix[4]=T}}),Object.defineProperty(Et.prototype,"ty",{get:function(){return this._matrix[5]},set:function(T){this._matrix[5]=T}}),Object.defineProperty(Et.prototype,"a",{get:function(){return this._matrix[0]},set:function(T){this._matrix[0]=T}}),Object.defineProperty(Et.prototype,"b",{get:function(){return this._matrix[1]},set:function(T){this._matrix[1]=T}}),Object.defineProperty(Et.prototype,"c",{get:function(){return this._matrix[2]},set:function(T){this._matrix[2]=T}}),Object.defineProperty(Et.prototype,"d",{get:function(){return this._matrix[3]},set:function(T){this._matrix[3]=T}}),Object.defineProperty(Et.prototype,"e",{get:function(){return this._matrix[4]},set:function(T){this._matrix[4]=T}}),Object.defineProperty(Et.prototype,"f",{get:function(){return this._matrix[5]},set:function(T){this._matrix[5]=T}}),Object.defineProperty(Et.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Et.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Et.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Et.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Et.prototype.join=function(T){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(A).join(T)},Et.prototype.multiply=function(T){var Q=T.sx*this.sx+T.shy*this.shx,Se=T.sx*this.shy+T.shy*this.sy,ke=T.shx*this.sx+T.sy*this.shx,Le=T.shx*this.shy+T.sy*this.sy,ot=T.tx*this.sx+T.ty*this.shx+this.tx,Tt=T.tx*this.shy+T.ty*this.sy+this.ty;return new Et(Q,Se,ke,Le,ot,Tt)},Et.prototype.decompose=function(){var T=this.sx,Q=this.shy,Se=this.shx,ke=this.sy,Le=this.tx,ot=this.ty,Tt=Math.sqrt(T*T+Q*Q),Gt=(T/=Tt)*Se+(Q/=Tt)*ke;Se-=T*Gt,ke-=Q*Gt;var y=Math.sqrt(Se*Se+ke*ke);return Gt/=y,T*(ke/=y)<Q*(Se/=y)&&(T=-T,Q=-Q,Gt=-Gt,Tt=-Tt),{scale:new Et(Tt,0,0,y,0,0),translate:new Et(1,0,0,1,Le,ot),rotate:new Et(T,Q,-Q,T,0,0),skew:new Et(1,0,Gt,1,0,0)}},Et.prototype.toString=function(T){return this.join(" ")},Et.prototype.inversed=function(){var T=this.sx,Q=this.shy,Se=this.shx,ke=this.sy,Le=this.tx,ot=this.ty,Tt=1/(T*ke-Q*Se),Gt=ke*Tt,y=-Q*Tt,R=-Se*Tt,W=T*Tt;return new Et(Gt,y,R,W,-Gt*Le-R*ot,-y*Le-W*ot)},Et.prototype.applyToPoint=function(T){var Q=T.x*this.sx+T.y*this.shx+this.tx,Se=T.x*this.shy+T.y*this.sy+this.ty;return new ec(Q,Se)},Et.prototype.applyToRectangle=function(T){var Q=this.applyToPoint(T),Se=this.applyToPoint(new ec(T.x+T.w,T.y+T.h));return new fu(Q.x,Q.y,Se.x-Q.x,Se.y-Q.y)},Et.prototype.clone=function(){var T=this.sx,Q=this.shy,Se=this.shx,ke=this.sy,Le=this.tx,ot=this.ty;return new Et(T,Q,Se,ke,Le,ot)},h.Matrix=Et;var qr=h.matrixMult=function(T,Q){return Q.multiply(T)},Qr=new Et(1,0,0,1,0,0);h.unitMatrix=h.identityMatrix=Qr;var Wr=function(T,Q){if(!Te[T]){var Se=(Q instanceof Af?"Sh":"P")+(Object.keys(Wt).length+1).toString(10);Q.id=Se,Te[T]=Se,Wt[Se]=Q,zt.publish("addPattern",Q)}};h.ShadingPattern=Af,h.TilingPattern=k0,h.addShadingPattern=function(T,Q){return S("addShadingPattern()"),Wr(T,Q),this},h.beginTilingPattern=function(T){S("beginTilingPattern()"),hu(T.boundingBox[0],T.boundingBox[1],T.boundingBox[2]-T.boundingBox[0],T.boundingBox[3]-T.boundingBox[1],T.matrix)},h.endTilingPattern=function(T,Q){S("endTilingPattern()"),Q.stream=xe[O].join(`
`),Wr(T,Q),zt.publish("endTilingPattern",Q),Vr.pop().restore()};var Nn=h.__private__.newObject=function(){var T=ir();return ee(T,!0),T},ir=h.__private__.newObjectDeferred=function(){return K++,q[K]=function(){return oe},K},ee=function(T,Q){return Q=typeof Q=="boolean"&&Q,q[T]=oe,Q&&he(T+" 0 obj"),T},be=h.__private__.newAdditionalObject=function(){var T={objId:ir(),content:""};return V.push(T),T},pe=ir(),ge=ir(),we=h.__private__.decodeColorString=function(T){var Q=T.split(" ");if(Q.length!==2||Q[1]!=="g"&&Q[1]!=="G")Q.length===5&&(Q[4]==="k"||Q[4]==="K")&&(Q=[(1-Q[0])*(1-Q[3]),(1-Q[1])*(1-Q[3]),(1-Q[2])*(1-Q[3]),"r"]);else{var Se=parseFloat(Q[0]);Q=[Se,Se,Se,"r"]}for(var ke="#",Le=0;Le<3;Le++)ke+=("0"+Math.floor(255*parseFloat(Q[Le])).toString(16)).slice(-2);return ke},_e=h.__private__.encodeColorString=function(T){var Q;typeof T=="string"&&(T={ch1:T});var Se=T.ch1,ke=T.ch2,Le=T.ch3,ot=T.ch4,Tt=T.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof Se=="string"&&Se.charAt(0)!=="#"){var Gt=new jL(Se);if(Gt.ok)Se=Gt.toHex();else if(!/^\d*\.?\d*$/.test(Se))throw new Error('Invalid color "'+Se+'" passed to jsPDF.encodeColorString.')}if(typeof Se=="string"&&/^#[0-9A-Fa-f]{3}$/.test(Se)&&(Se="#"+Se[1]+Se[1]+Se[2]+Se[2]+Se[3]+Se[3]),typeof Se=="string"&&/^#[0-9A-Fa-f]{6}$/.test(Se)){var y=parseInt(Se.substr(1),16);Se=y>>16&255,ke=y>>8&255,Le=255&y}if(ke===void 0||ot===void 0&&Se===ke&&ke===Le)if(typeof Se=="string")Q=Se+" "+Tt[0];else switch(T.precision){case 2:Q=M(Se/255)+" "+Tt[0];break;case 3:default:Q=I(Se/255)+" "+Tt[0]}else if(ot===void 0||yn(ot)==="object"){if(ot&&!isNaN(ot.a)&&ot.a===0)return Q=["1.","1.","1.",Tt[1]].join(" ");if(typeof Se=="string")Q=[Se,ke,Le,Tt[1]].join(" ");else switch(T.precision){case 2:Q=[M(Se/255),M(ke/255),M(Le/255),Tt[1]].join(" ");break;default:case 3:Q=[I(Se/255),I(ke/255),I(Le/255),Tt[1]].join(" ")}}else if(typeof Se=="string")Q=[Se,ke,Le,ot,Tt[2]].join(" ");else switch(T.precision){case 2:Q=[M(Se),M(ke),M(Le),M(ot),Tt[2]].join(" ");break;case 3:default:Q=[I(Se),I(ke),I(Le),I(ot),Tt[2]].join(" ")}return Q},$e=h.__private__.getFilters=function(){return i},rt=h.__private__.putStream=function(T){var Q=(T=T||{}).data||"",Se=T.filters||$e(),ke=T.alreadyAppliedFilters||[],Le=T.addLength1||!1,ot=Q.length,Tt=T.objectId,Gt=function(Ar){return Ar};if(d!==null&&Tt===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");d!==null&&(Gt=Pn.encryptor(Tt,0));var y={};Se===!0&&(Se=["FlateEncode"]);var R=T.additionalKeyValues||[],W=(y=pr.API.processDataByFilters!==void 0?pr.API.processDataByFilters(Q,Se):{data:Q,reverseChain:[]}).reverseChain+(Array.isArray(ke)?ke.join(" "):ke.toString());if(y.data.length!==0&&(R.push({key:"Length",value:y.data.length}),Le===!0&&R.push({key:"Length1",value:ot})),W.length!=0)if(W.split("/").length-1==1)R.push({key:"Filter",value:W});else{R.push({key:"Filter",value:"["+W+"]"});for(var le=0;le<R.length;le+=1)if(R[le].key==="DecodeParms"){for(var Fe=[],Qe=0;Qe<y.reverseChain.split("/").length-1;Qe+=1)Fe.push("null");Fe.push(R[le].value),R[le].value="["+Fe.join(" ")+"]"}}he("<<");for(var Ct=0;Ct<R.length;Ct++)he("/"+R[Ct].key+" "+R[Ct].value);he(">>"),y.data.length!==0&&(he("stream"),he(Gt(y.data)),he("endstream"))},ze=h.__private__.putPage=function(T){var Q=T.number,Se=T.data,ke=T.objId,Le=T.contentsObjId;ee(ke,!0),he("<</Type /Page"),he("/Parent "+T.rootDictionaryObjId+" 0 R"),he("/Resources "+T.resourceDictionaryObjId+" 0 R"),he("/MediaBox ["+parseFloat(A(T.mediaBox.bottomLeftX))+" "+parseFloat(A(T.mediaBox.bottomLeftY))+" "+A(T.mediaBox.topRightX)+" "+A(T.mediaBox.topRightY)+"]"),T.cropBox!==null&&he("/CropBox ["+A(T.cropBox.bottomLeftX)+" "+A(T.cropBox.bottomLeftY)+" "+A(T.cropBox.topRightX)+" "+A(T.cropBox.topRightY)+"]"),T.bleedBox!==null&&he("/BleedBox ["+A(T.bleedBox.bottomLeftX)+" "+A(T.bleedBox.bottomLeftY)+" "+A(T.bleedBox.topRightX)+" "+A(T.bleedBox.topRightY)+"]"),T.trimBox!==null&&he("/TrimBox ["+A(T.trimBox.bottomLeftX)+" "+A(T.trimBox.bottomLeftY)+" "+A(T.trimBox.topRightX)+" "+A(T.trimBox.topRightY)+"]"),T.artBox!==null&&he("/ArtBox ["+A(T.artBox.bottomLeftX)+" "+A(T.artBox.bottomLeftY)+" "+A(T.artBox.topRightX)+" "+A(T.artBox.topRightY)+"]"),typeof T.userUnit=="number"&&T.userUnit!==1&&he("/UserUnit "+T.userUnit),zt.publish("putPage",{objId:ke,pageContext:st[Q],pageNumber:Q,page:Se}),he("/Contents "+Le+" 0 R"),he(">>"),he("endobj");var ot=Se.join(`
`);return N===w.ADVANCED&&(ot+=`
Q`),ee(Le,!0),rt({data:ot,filters:$e(),objectId:Le}),he("endobj"),ke},We=h.__private__.putPages=function(){var T,Q,Se=[];for(T=1;T<=vt;T++)st[T].objId=ir(),st[T].contentsObjId=ir();for(T=1;T<=vt;T++)Se.push(ze({number:T,data:xe[T],objId:st[T].objId,contentsObjId:st[T].contentsObjId,mediaBox:st[T].mediaBox,cropBox:st[T].cropBox,bleedBox:st[T].bleedBox,trimBox:st[T].trimBox,artBox:st[T].artBox,userUnit:st[T].userUnit,rootDictionaryObjId:pe,resourceDictionaryObjId:ge}));ee(pe,!0),he("<</Type /Pages");var ke="/Kids [";for(Q=0;Q<vt;Q++)ke+=Se[Q]+" 0 R ";he(ke+"]"),he("/Count "+vt),he(">>"),he("endobj"),zt.publish("postPutPages")},Xe=function(T){zt.publish("putFont",{font:T,out:he,newObject:Nn,putStream:rt}),T.isAlreadyPutted!==!0&&(T.objectNumber=Nn(),he("<<"),he("/Type /Font"),he("/BaseFont /"+h0(T.postScriptName)),he("/Subtype /Type1"),typeof T.encoding=="string"&&he("/Encoding /"+T.encoding),he("/FirstChar 32"),he("/LastChar 255"),he(">>"),he("endobj"))},wt=function(){for(var T in nt)nt.hasOwnProperty(T)&&(f===!1||f===!0&&m.hasOwnProperty(T))&&Xe(nt[T])},Lt=function(T){T.objectNumber=Nn();var Q=[];Q.push({key:"Type",value:"/XObject"}),Q.push({key:"Subtype",value:"/Form"}),Q.push({key:"BBox",value:"["+[A(T.x),A(T.y),A(T.x+T.width),A(T.y+T.height)].join(" ")+"]"}),Q.push({key:"Matrix",value:"["+T.matrix.toString()+"]"});var Se=T.pages[1].join(`
`);rt({data:Se,additionalKeyValues:Q,objectId:T.objectNumber}),he("endobj")},qt=function(){for(var T in nr)nr.hasOwnProperty(T)&&Lt(nr[T])},jt=function(T,Q){var Se,ke=[],Le=1/(Q-1);for(Se=0;Se<1;Se+=Le)ke.push(Se);if(ke.push(1),T[0].offset!=0){var ot={offset:0,color:T[0].color};T.unshift(ot)}if(T[T.length-1].offset!=1){var Tt={offset:1,color:T[T.length-1].color};T.push(Tt)}for(var Gt="",y=0,R=0;R<ke.length;R++){for(Se=ke[R];Se>T[y+1].offset;)y++;var W=T[y].offset,le=(Se-W)/(T[y+1].offset-W),Fe=T[y].color,Qe=T[y+1].color;Gt+=H(Math.round((1-le)*Fe[0]+le*Qe[0]).toString(16))+H(Math.round((1-le)*Fe[1]+le*Qe[1]).toString(16))+H(Math.round((1-le)*Fe[2]+le*Qe[2]).toString(16))}return Gt.trim()},$t=function(T,Q){Q||(Q=21);var Se=Nn(),ke=jt(T.colors,Q),Le=[];Le.push({key:"FunctionType",value:"0"}),Le.push({key:"Domain",value:"[0.0 1.0]"}),Le.push({key:"Size",value:"["+Q+"]"}),Le.push({key:"BitsPerSample",value:"8"}),Le.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Le.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),rt({data:ke,additionalKeyValues:Le,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:Se}),he("endobj"),T.objectNumber=Nn(),he("<< /ShadingType "+T.type),he("/ColorSpace /DeviceRGB");var ot="/Coords ["+A(parseFloat(T.coords[0]))+" "+A(parseFloat(T.coords[1]))+" ";T.type===2?ot+=A(parseFloat(T.coords[2]))+" "+A(parseFloat(T.coords[3])):ot+=A(parseFloat(T.coords[2]))+" "+A(parseFloat(T.coords[3]))+" "+A(parseFloat(T.coords[4]))+" "+A(parseFloat(T.coords[5])),he(ot+="]"),T.matrix&&he("/Matrix ["+T.matrix.toString()+"]"),he("/Function "+Se+" 0 R"),he("/Extend [true true]"),he(">>"),he("endobj")},Ze=function(T,Q){var Se=ir(),ke=Nn();Q.push({resourcesOid:Se,objectOid:ke}),T.objectNumber=ke;var Le=[];Le.push({key:"Type",value:"/Pattern"}),Le.push({key:"PatternType",value:"1"}),Le.push({key:"PaintType",value:"1"}),Le.push({key:"TilingType",value:"1"}),Le.push({key:"BBox",value:"["+T.boundingBox.map(A).join(" ")+"]"}),Le.push({key:"XStep",value:A(T.xStep)}),Le.push({key:"YStep",value:A(T.yStep)}),Le.push({key:"Resources",value:Se+" 0 R"}),T.matrix&&Le.push({key:"Matrix",value:"["+T.matrix.toString()+"]"}),rt({data:T.stream,additionalKeyValues:Le,objectId:T.objectNumber}),he("endobj")},mt=function(T){var Q;for(Q in Wt)Wt.hasOwnProperty(Q)&&(Wt[Q]instanceof Af?$t(Wt[Q]):Wt[Q]instanceof k0&&Ze(Wt[Q],T))},it=function(T){for(var Q in T.objectNumber=Nn(),he("<<"),T)switch(Q){case"opacity":he("/ca "+M(T[Q]));break;case"stroke-opacity":he("/CA "+M(T[Q]))}he(">>"),he("endobj")},_t=function(){var T;for(T in je)je.hasOwnProperty(T)&&it(je[T])},cr=function(){for(var T in he("/XObject <<"),nr)nr.hasOwnProperty(T)&&nr[T].objectNumber>=0&&he("/"+T+" "+nr[T].objectNumber+" 0 R");zt.publish("putXobjectDict"),he(">>")},xr=function(){Pn.oid=Nn(),he("<<"),he("/Filter /Standard"),he("/V "+Pn.v),he("/R "+Pn.r),he("/U <"+Pn.toHexString(Pn.U)+">"),he("/O <"+Pn.toHexString(Pn.O)+">"),he("/P "+Pn.P),he(">>"),he("endobj")},Lr=function(){for(var T in he("/Font <<"),nt)nt.hasOwnProperty(T)&&(f===!1||f===!0&&m.hasOwnProperty(T))&&he("/"+T+" "+nt[T].objectNumber+" 0 R");he(">>")},an=function(){if(Object.keys(Wt).length>0){for(var T in he("/Shading <<"),Wt)Wt.hasOwnProperty(T)&&Wt[T]instanceof Af&&Wt[T].objectNumber>=0&&he("/"+T+" "+Wt[T].objectNumber+" 0 R");zt.publish("putShadingPatternDict"),he(">>")}},As=function(T){if(Object.keys(Wt).length>0){for(var Q in he("/Pattern <<"),Wt)Wt.hasOwnProperty(Q)&&Wt[Q]instanceof h.TilingPattern&&Wt[Q].objectNumber>=0&&Wt[Q].objectNumber<T&&he("/"+Q+" "+Wt[Q].objectNumber+" 0 R");zt.publish("putTilingPatternDict"),he(">>")}},ts=function(){if(Object.keys(je).length>0){var T;for(T in he("/ExtGState <<"),je)je.hasOwnProperty(T)&&je[T].objectNumber>=0&&he("/"+T+" "+je[T].objectNumber+" 0 R");zt.publish("putGStateDict"),he(">>")}},Kr=function(T){ee(T.resourcesOid,!0),he("<<"),he("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),Lr(),an(),As(T.objectOid),ts(),cr(),he(">>"),he("endobj")},En=function(){var T=[];wt(),_t(),qt(),mt(T),zt.publish("putResources"),T.forEach(Kr),Kr({resourcesOid:ge,objectOid:Number.MAX_SAFE_INTEGER}),zt.publish("postPutResources")},Es=function(){zt.publish("putAdditionalObjects");for(var T=0;T<V.length;T++){var Q=V[T];ee(Q.objId,!0),he(Q.content),he("endobj")}zt.publish("postPutAdditionalObjects")},dl=function(T){At[T.fontName]=At[T.fontName]||{},At[T.fontName][T.fontStyle]=T.id},Jd=function(T,Q,Se,ke,Le){var ot={id:"F"+(Object.keys(nt).length+1).toString(10),postScriptName:T,fontName:Q,fontStyle:Se,encoding:ke,isStandardFont:Le||!1,metadata:{}};return zt.publish("addFont",{font:ot,instance:this}),nt[ot.id]=ot,dl(ot),ot.id},Th=function(T){for(var Q=0,Se=lt.length;Q<Se;Q++){var ke=Jd.call(this,T[Q][0],T[Q][1],T[Q][2],lt[Q][3],!0);f===!1&&(m[ke]=!0);var Le=T[Q][0].split("-");dl({id:ke,fontName:Le[0],fontStyle:Le[1]||""})}zt.publish("addFonts",{fonts:nt,dictionary:At})},oi=function(T){return T.foo=function(){try{return T.apply(this,arguments)}catch(ke){var Q=ke.stack||"";~Q.indexOf(" at ")&&(Q=Q.split(" at ")[1]);var Se="Error in function "+Q.split(`
`)[0].split("<")[0]+": "+ke.message;if(!yr.console)throw new Error(Se);yr.console.error(Se,ke),yr.alert&&alert(Se)}},T.foo.bar=T,T.foo},eu=function(T,Q){var Se,ke,Le,ot,Tt,Gt,y,R,W;if(Le=(Q=Q||{}).sourceEncoding||"Unicode",Tt=Q.outputEncoding,(Q.autoencode||Tt)&&nt[Pt].metadata&&nt[Pt].metadata[Le]&&nt[Pt].metadata[Le].encoding&&(ot=nt[Pt].metadata[Le].encoding,!Tt&&nt[Pt].encoding&&(Tt=nt[Pt].encoding),!Tt&&ot.codePages&&(Tt=ot.codePages[0]),typeof Tt=="string"&&(Tt=ot[Tt]),Tt)){for(y=!1,Gt=[],Se=0,ke=T.length;Se<ke;Se++)(R=Tt[T.charCodeAt(Se)])?Gt.push(String.fromCharCode(R)):Gt.push(T[Se]),Gt[Se].charCodeAt(0)>>8&&(y=!0);T=Gt.join("")}for(Se=T.length;y===void 0&&Se!==0;)T.charCodeAt(Se-1)>>8&&(y=!0),Se--;if(!y)return T;for(Gt=Q.noBOM?[]:[254,255],Se=0,ke=T.length;Se<ke;Se++){if((W=(R=T.charCodeAt(Se))>>8)>>8)throw new Error("Character at position "+Se+" of string '"+T+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Gt.push(W),Gt.push(R-(W<<8))}return String.fromCharCode.apply(void 0,Gt)},rs=h.__private__.pdfEscape=h.pdfEscape=function(T,Q){return eu(T,Q).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},qa=h.__private__.beginPage=function(T){xe[++vt]=[],st[vt]={objId:0,contentsObjId:0,userUnit:Number(l),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(T[0]),topRightY:Number(T[1])}},Zd(vt),Ie(xe[O])},Yl=function(T,Q){var Se,ke,Le;switch(r=Q||r,typeof T=="string"&&(Se=b(T.toLowerCase()),Array.isArray(Se)&&(ke=Se[0],Le=Se[1])),Array.isArray(T)&&(ke=T[0]*ht,Le=T[1]*ht),isNaN(ke)&&(ke=s[0],Le=s[1]),(ke>14400||Le>14400)&&(An.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),ke=Math.min(14400,ke),Le=Math.min(14400,Le)),s=[ke,Le],r.substr(0,1)){case"l":Le>ke&&(s=[Le,ke]);break;case"p":ke>Le&&(s=[Le,ke])}qa(s),sf(nf),he(ia),lf!==0&&he(lf+" J"),du!==0&&he(du+" j"),zt.publish("addPage",{pageNumber:vt})},tu=function(T){T>0&&T<=vt&&(xe.splice(T,1),st.splice(T,1),vt--,O>vt&&(O=vt),this.setPage(O))},Zd=function(T){T>0&&T<=vt&&(O=T)},un=h.__private__.getNumberOfPages=h.getNumberOfPages=function(){return xe.length-1},Xl=function(T,Q,Se){var ke,Le=void 0;return Se=Se||{},T=T!==void 0?T:nt[Pt].fontName,Q=Q!==void 0?Q:nt[Pt].fontStyle,ke=T.toLowerCase(),At[ke]!==void 0&&At[ke][Q]!==void 0?Le=At[ke][Q]:At[T]!==void 0&&At[T][Q]!==void 0?Le=At[T][Q]:Se.disableWarning===!1&&An.warn("Unable to look up font label for font '"+T+"', '"+Q+"'. Refer to getFontList() for available fonts."),Le||Se.noFallback||(Le=At.times[Q])==null&&(Le=At.times.normal),Le},Ql=h.__private__.putInfo=function(){var T=Nn(),Q=function(ke){return ke};for(var Se in d!==null&&(Q=Pn.encryptor(T,0)),he("<<"),he("/Producer ("+rs(Q("jsPDF "+pr.version))+")"),Ot)Ot.hasOwnProperty(Se)&&Ot[Se]&&he("/"+Se.substr(0,1).toUpperCase()+Se.substr(1)+" ("+rs(Q(Ot[Se]))+")");he("/CreationDate ("+rs(Q(Z))+")"),he(">>"),he("endobj")},Ro=h.__private__.putCatalog=function(T){var Q=(T=T||{}).rootDictionaryObjId||pe;switch(Nn(),he("<<"),he("/Type /Catalog"),he("/Pages "+Q+" 0 R"),Ne||(Ne="fullwidth"),Ne){case"fullwidth":he("/OpenAction [3 0 R /FitH null]");break;case"fullheight":he("/OpenAction [3 0 R /FitV null]");break;case"fullpage":he("/OpenAction [3 0 R /Fit]");break;case"original":he("/OpenAction [3 0 R /XYZ null null 1]");break;default:var Se=""+Ne;Se.substr(Se.length-1)==="%"&&(Ne=parseInt(Ne)/100),typeof Ne=="number"&&he("/OpenAction [3 0 R /XYZ null null "+M(Ne)+"]")}switch(Ye||(Ye="continuous"),Ye){case"continuous":he("/PageLayout /OneColumn");break;case"single":he("/PageLayout /SinglePage");break;case"two":case"twoleft":he("/PageLayout /TwoColumnLeft");break;case"tworight":he("/PageLayout /TwoColumnRight")}Ue&&he("/PageMode /"+Ue),zt.publish("putCatalog"),he(">>"),he("endobj")},Om=h.__private__.putTrailer=function(){he("trailer"),he("<<"),he("/Size "+(K+1)),he("/Root "+K+" 0 R"),he("/Info "+(K-1)+" 0 R"),d!==null&&he("/Encrypt "+Pn.oid+" 0 R"),he("/ID [ <"+ae+"> <"+ae+"> ]"),he(">>")},Ah=h.__private__.putHeader=function(){he("%PDF-"+g),he("%")},Mm=h.__private__.putXRef=function(){var T="0000000000";he("xref"),he("0 "+(K+1)),he("0000000000 65535 f ");for(var Q=1;Q<=K;Q++)typeof q[Q]=="function"?he((T+q[Q]()).slice(-10)+" 00000 n "):q[Q]!==void 0?he((T+q[Q]).slice(-10)+" 00000 n "):he("0000000000 00000 n ")},Do=h.__private__.buildDocument=function(){Me(),Ie(te),zt.publish("buildDocument"),Ah(),We(),Es(),En(),d!==null&&xr(),Ql(),Ro();var T=oe;return Mm(),Om(),he("startxref"),he(""+T),he("%%EOF"),Ie(xe[O]),te.join(`
`)},ru=h.__private__.getBlob=function(T){return new Blob([ct(T)],{type:"application/pdf"})},nu=h.output=h.__private__.output=oi(function(T,Q){switch(typeof(Q=Q||{})=="string"?Q={filename:Q}:Q.filename=Q.filename||"generated.pdf",T){case void 0:return Do();case"save":h.save(Q.filename);break;case"arraybuffer":return ct(Do());case"blob":return ru(Do());case"bloburi":case"bloburl":if(yr.URL!==void 0&&typeof yr.URL.createObjectURL=="function")return yr.URL&&yr.URL.createObjectURL(ru(Do()))||void 0;An.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var Se="",ke=Do();try{Se=sN(ke)}catch{Se=sN(unescape(encodeURIComponent(ke)))}return"data:application/pdf;filename="+Q.filename+";base64,"+Se;case"pdfobjectnewwindow":if(Object.prototype.toString.call(yr)==="[object Window]"){var Le="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",ot=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';Q.pdfObjectUrl&&(Le=Q.pdfObjectUrl,ot="");var Tt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+Le+'"'+ot+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(Q)+");<\/script></body></html>",Gt=yr.open();return Gt!==null&&Gt.document.write(Tt),Gt}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(yr)==="[object Window]"){var y='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(Q.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+Q.filename+'" width="500px" height="400px" /></body></html>',R=yr.open();if(R!==null){R.document.write(y);var W=this;R.document.documentElement.querySelector("#pdfViewer").onload=function(){R.document.title=Q.filename,R.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(W.output("bloburl"))}}return R}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(yr)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var le='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",Q)+'"></iframe></body></html>',Fe=yr.open();if(Fe!==null&&(Fe.document.write(le),Fe.document.title=Q.filename),Fe||typeof safari>"u")return Fe;break;case"datauri":case"dataurl":return yr.document.location.href=this.output("datauristring",Q);default:return null}}),fl=function(T){return Array.isArray(Qt)===!0&&Qt.indexOf(T)>-1};switch(n){case"pt":ht=1;break;case"mm":ht=72/25.4;break;case"cm":ht=72/2.54;break;case"in":ht=72;break;case"px":ht=fl("px_scaling")==1?.75:96/72;break;case"pc":case"em":ht=12;break;case"ex":ht=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);ht=n}var Pn=null;re(),se();var Eh=function(T){return d!==null?Pn.encryptor(T,0):function(Q){return Q}},ef=h.__private__.getPageInfo=h.getPageInfo=function(T){if(isNaN(T)||T%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:st[T].objId,pageNumber:T,pageContext:st[T]}},wr=h.__private__.getPageInfoByObjId=function(T){if(isNaN(T)||T%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var Q in st)if(st[Q].objId===T)break;return ef(Q)},hl=h.__private__.getCurrentPageInfo=h.getCurrentPageInfo=function(){return{objId:st[O].objId,pageNumber:O,pageContext:st[O]}};h.addPage=function(){return Yl.apply(this,arguments),this},h.setPage=function(){return Zd.apply(this,arguments),Ie.call(this,xe[O]),this},h.insertPage=function(T){return this.addPage(),this.movePage(O,T),this},h.movePage=function(T,Q){var Se,ke;if(T>Q){Se=xe[T],ke=st[T];for(var Le=T;Le>Q;Le--)xe[Le]=xe[Le-1],st[Le]=st[Le-1];xe[Q]=Se,st[Q]=ke,this.setPage(Q)}else if(T<Q){Se=xe[T],ke=st[T];for(var ot=T;ot<Q;ot++)xe[ot]=xe[ot+1],st[ot]=st[ot+1];xe[Q]=Se,st[Q]=ke,this.setPage(Q)}return this},h.deletePage=function(){return tu.apply(this,arguments),this},h.__private__.text=h.text=function(T,Q,Se,ke,Le){var ot,Tt,Gt,y,R,W,le,Fe,Qe,Ct=(ke=ke||{}).scope||this;if(typeof T=="number"&&typeof Q=="number"&&(typeof Se=="string"||Array.isArray(Se))){var Ar=Se;Se=Q,Q=T,T=Ar}if(arguments[3]instanceof Et?(S("The transform parameter of text() with a Matrix value"),Qe=Le):(Gt=arguments[4],y=arguments[5],yn(le=arguments[3])==="object"&&le!==null||(typeof Gt=="string"&&(y=Gt,Gt=null),typeof le=="string"&&(y=le,le=null),typeof le=="number"&&(Gt=le,le=null),ke={flags:le,angle:Gt,align:y})),isNaN(Q)||isNaN(Se)||T==null)throw new Error("Invalid arguments passed to jsPDF.text");if(T.length===0)return Ct;var Br="",Er=!1,ln=typeof ke.lineHeightFactor=="number"?ke.lineHeightFactor:on,Sn=Ct.internal.scaleFactor;function Vo(Cn){return Cn=Cn.split("	").join(Array(ke.TabLen||9).join(" ")),rs(Cn,le)}function oa(Cn){for(var kn,ms=Cn.concat(),Vs=[],ac=ms.length;ac--;)typeof(kn=ms.shift())=="string"?Vs.push(kn):Array.isArray(Cn)&&(kn.length===1||kn[1]===void 0&&kn[2]===void 0)?Vs.push(kn[0]):Vs.push([kn[0],kn[1],kn[2]]);return Vs}function xl(Cn,kn){var ms;if(typeof Cn=="string")ms=kn(Cn)[0];else if(Array.isArray(Cn)){for(var Vs,ac,Gm=Cn.concat(),Bh=[],Qx=Gm.length;Qx--;)typeof(Vs=Gm.shift())=="string"?Bh.push(kn(Vs)[0]):Array.isArray(Vs)&&typeof Vs[0]=="string"&&(ac=kn(Vs[0],Vs[1],Vs[2]),Bh.push([ac[0],ac[1],ac[2]]));ms=Bh}return ms}var yl=!1,Bm=!0;if(typeof T=="string")yl=!0;else if(Array.isArray(T)){var Um=T.concat();Tt=[];for(var Ph,la=Um.length;la--;)(typeof(Ph=Um.shift())!="string"||Array.isArray(Ph)&&typeof Ph[0]!="string")&&(Bm=!1);yl=Bm}if(yl===!1)throw new Error('Type of text must be string or Array. "'+T+'" is not recognized.');typeof T=="string"&&(T=T.match(/[\r?\n]/)?T.split(/\r\n|\r|\n/g):[T]);var Rh=ue/Ct.internal.scaleFactor,Dh=Rh*(ln-1);switch(ke.baseline){case"bottom":Se-=Dh;break;case"top":Se+=Rh-Dh;break;case"hanging":Se+=Rh-2*Dh;break;case"middle":Se+=Rh/2-Dh}if((W=ke.maxWidth||0)>0&&(typeof T=="string"?T=Ct.splitTextToSize(T,W):Object.prototype.toString.call(T)==="[object Array]"&&(T=T.reduce(function(Cn,kn){return Cn.concat(Ct.splitTextToSize(kn,W))},[]))),ot={text:T,x:Q,y:Se,options:ke,mutex:{pdfEscape:rs,activeFontKey:Pt,fonts:nt,activeFontSize:ue}},zt.publish("preProcessText",ot),T=ot.text,Gt=(ke=ot.options).angle,!(Qe instanceof Et)&&Gt&&typeof Gt=="number"){Gt*=Math.PI/180,ke.rotationDirection===0&&(Gt=-Gt),N===w.ADVANCED&&(Gt=-Gt);var Fh=Math.cos(Gt),$m=Math.sin(Gt);Qe=new Et(Fh,$m,-$m,Fh,0,0)}else Gt&&Gt instanceof Et&&(Qe=Gt);N!==w.ADVANCED||Qe||(Qe=Qr),(R=ke.charSpace||Zl)!==void 0&&(Br+=A(E(R))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Fe=ke.horizontalScale)!==void 0&&(Br+=A(100*Fe)+` Tz
`),ke.lang;var li=-1,mb=ke.renderingMode!==void 0?ke.renderingMode:ke.stroke,zm=Ct.internal.getCurrentPageInfo().pageContext;switch(mb){case 0:case!1:case"fill":li=0;break;case 1:case!0:case"stroke":li=1;break;case 2:case"fillThenStroke":li=2;break;case 3:case"invisible":li=3;break;case 4:case"fillAndAddForClipping":li=4;break;case 5:case"strokeAndAddPathForClipping":li=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":li=6;break;case 7:case"addToPathForClipping":li=7}var Gx=zm.usedRenderingMode!==void 0?zm.usedRenderingMode:-1;li!==-1?Br+=li+` Tr
`:Gx!==-1&&(Br+=`0 Tr
`),li!==-1&&(zm.usedRenderingMode=li),y=ke.align||"left";var io,Lh=ue*ln,Kx=Ct.internal.pageSize.getWidth(),Yx=nt[Pt];R=ke.charSpace||Zl,W=ke.maxWidth||0,le=Object.assign({autoencode:!0,noBOM:!0},ke.flags);var gu=[],cf=function(Cn){return Ct.getStringUnitWidth(Cn,{font:Yx,charSpace:R,fontSize:ue,doKerning:!1})*ue/Sn};if(Object.prototype.toString.call(T)==="[object Array]"){var ci;Tt=oa(T),y!=="left"&&(io=Tt.map(cf));var Wa,xu=0;if(y==="right"){Q-=io[0],T=[],la=Tt.length;for(var rc=0;rc<la;rc++)rc===0?(Wa=Ri(Q),ci=Ms(Se)):(Wa=E(xu-io[rc]),ci=-Lh),T.push([Tt[rc],Wa,ci]),xu=io[rc]}else if(y==="center"){Q-=io[0]/2,T=[],la=Tt.length;for(var nc=0;nc<la;nc++)nc===0?(Wa=Ri(Q),ci=Ms(Se)):(Wa=E((xu-io[nc])/2),ci=-Lh),T.push([Tt[nc],Wa,ci]),xu=io[nc]}else if(y==="left"){T=[],la=Tt.length;for(var Oh=0;Oh<la;Oh++)T.push(Tt[Oh])}else if(y==="justify"&&Yx.encoding==="Identity-H"){T=[],la=Tt.length,W=W!==0?W:Kx;for(var sc=0,hs=0;hs<la;hs++)if(ci=hs===0?Ms(Se):-Lh,Wa=hs===0?Ri(Q):sc,hs<la-1){var qm=E((W-io[hs])/(Tt[hs].split(" ").length-1)),Ha=Tt[hs].split(" ");T.push([Ha[0]+" ",Wa,ci]),sc=0;for(var oo=1;oo<Ha.length;oo++){var Mh=(cf(Ha[oo-1]+" "+Ha[oo])-cf(Ha[oo]))*Sn+qm;oo==Ha.length-1?T.push([Ha[oo],Mh,0]):T.push([Ha[oo]+" ",Mh,0]),sc-=Mh}}else T.push([Tt[hs],Wa,ci]);T.push(["",sc,0])}else{if(y!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(T=[],la=Tt.length,W=W!==0?W:Kx,hs=0;hs<la;hs++)ci=hs===0?Ms(Se):-Lh,Wa=hs===0?Ri(Q):0,hs<la-1?gu.push(A(E((W-io[hs])/(Tt[hs].split(" ").length-1)))):gu.push(0),T.push([Tt[hs],Wa,ci])}}var Xx=typeof ke.R2L=="boolean"?ke.R2L:Be;Xx===!0&&(T=xl(T,function(Cn,kn,ms){return[Cn.split("").reverse().join(""),kn,ms]})),ot={text:T,x:Q,y:Se,options:ke,mutex:{pdfEscape:rs,activeFontKey:Pt,fonts:nt,activeFontSize:ue}},zt.publish("postProcessText",ot),T=ot.text,Er=ot.mutex.isHex||!1;var Wm=nt[Pt].encoding;Wm!=="WinAnsiEncoding"&&Wm!=="StandardEncoding"||(T=xl(T,function(Cn,kn,ms){return[Vo(Cn),kn,ms]})),Tt=oa(T),T=[];for(var uf,df,yu,ff=0,Vh=1,hf=Array.isArray(Tt[0])?Vh:ff,vu="",Hm=function(Cn,kn,ms){var Vs="";return ms instanceof Et?(ms=typeof ke.angle=="number"?qr(ms,new Et(1,0,0,1,Cn,kn)):qr(new Et(1,0,0,1,Cn,kn),ms),N===w.ADVANCED&&(ms=qr(new Et(1,0,0,-1,0,0),ms)),Vs=ms.join(" ")+` Tm
`):Vs=A(Cn)+" "+A(kn)+` Td
`,Vs},lo=0;lo<Tt.length;lo++){switch(vu="",hf){case Vh:yu=(Er?"<":"(")+Tt[lo][0]+(Er?">":")"),uf=parseFloat(Tt[lo][1]),df=parseFloat(Tt[lo][2]);break;case ff:yu=(Er?"<":"(")+Tt[lo]+(Er?">":")"),uf=Ri(Q),df=Ms(Se)}gu!==void 0&&gu[lo]!==void 0&&(vu=gu[lo]+` Tw
`),lo===0?T.push(vu+Hm(uf,df,Qe)+yu):hf===ff?T.push(vu+yu):hf===Vh&&T.push(vu+Hm(uf,df,Qe)+yu)}T=hf===ff?T.join(` Tj
T* `):T.join(` Tj
`),T+=` Tj
`;var co=`BT
/`;return co+=Pt+" "+ue+` Tf
`,co+=A(ue*ln)+` TL
`,co+=Oo+`
`,co+=Br,co+=T,he(co+="ET"),m[Pt]=!0,Ct};var Vm=h.__private__.clip=h.clip=function(T){return he(T==="evenodd"?"W*":"W"),this};h.clipEvenOdd=function(){return Vm("evenodd")},h.__private__.discardPath=h.discardPath=function(){return he("n"),this};var ao=h.__private__.isValidStyle=function(T){var Q=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(T)!==-1&&(Q=!0),Q};h.__private__.setDefaultPathOperation=h.setDefaultPathOperation=function(T){return ao(T)&&(u=T),this};var Ch=h.__private__.getStyle=h.getStyle=function(T){var Q=u;switch(T){case"D":case"S":Q="S";break;case"F":Q="f";break;case"FD":case"DF":Q="B";break;case"f":case"f*":case"B":case"B*":Q=T}return Q},ji=h.close=function(){return he("h"),this};h.stroke=function(){return he("S"),this},h.fill=function(T){return su("f",T),this},h.fillEvenOdd=function(T){return su("f*",T),this},h.fillStroke=function(T){return su("B",T),this},h.fillStrokeEvenOdd=function(T){return su("B*",T),this};var su=function(T,Q){yn(Q)==="object"?iu(Q,T):he(T)},tf=function(T){T===null||N===w.ADVANCED&&T===void 0||(T=Ch(T),he(T))};function au(T,Q,Se,ke,Le){var ot=new k0(Q||this.boundingBox,Se||this.xStep,ke||this.yStep,this.gState,Le||this.matrix);ot.stream=this.stream;var Tt=T+"$$"+this.cloneIndex+++"$$";return Wr(Tt,ot),ot}var iu=function(T,Q){var Se=Te[T.key],ke=Wt[Se];if(ke instanceof Af)he("q"),he(kh(Q)),ke.gState&&h.setGState(ke.gState),he(T.matrix.toString()+" cm"),he("/"+Se+" sh"),he("Q");else if(ke instanceof k0){var Le=new Et(1,0,0,-1,0,va());T.matrix&&(Le=Le.multiply(T.matrix||Qr),Se=au.call(ke,T.key,T.boundingBox,T.xStep,T.yStep,Le).id),he("q"),he("/Pattern cs"),he("/"+Se+" scn"),ke.gState&&h.setGState(ke.gState),he(Q),he("Q")}},kh=function(T){switch(T){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},Fo=h.moveTo=function(T,Q){return he(A(E(T))+" "+A(G(Q))+" m"),this},Pi=h.lineTo=function(T,Q){return he(A(E(T))+" "+A(G(Q))+" l"),this},Lo=h.curveTo=function(T,Q,Se,ke,Le,ot){return he([A(E(T)),A(G(Q)),A(E(Se)),A(G(ke)),A(E(Le)),A(G(ot)),"c"].join(" ")),this};h.__private__.line=h.line=function(T,Q,Se,ke,Le){if(isNaN(T)||isNaN(Q)||isNaN(Se)||isNaN(ke)||!ao(Le))throw new Error("Invalid arguments passed to jsPDF.line");return N===w.COMPAT?this.lines([[Se-T,ke-Q]],T,Q,[1,1],Le||"S"):this.lines([[Se-T,ke-Q]],T,Q,[1,1]).stroke()},h.__private__.lines=h.lines=function(T,Q,Se,ke,Le,ot){var Tt,Gt,y,R,W,le,Fe,Qe,Ct,Ar,Br,Er;if(typeof T=="number"&&(Er=Se,Se=Q,Q=T,T=Er),ke=ke||[1,1],ot=ot||!1,isNaN(Q)||isNaN(Se)||!Array.isArray(T)||!Array.isArray(ke)||!ao(Le)||typeof ot!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Fo(Q,Se),Tt=ke[0],Gt=ke[1],R=T.length,Ar=Q,Br=Se,y=0;y<R;y++)(W=T[y]).length===2?(Ar=W[0]*Tt+Ar,Br=W[1]*Gt+Br,Pi(Ar,Br)):(le=W[0]*Tt+Ar,Fe=W[1]*Gt+Br,Qe=W[2]*Tt+Ar,Ct=W[3]*Gt+Br,Ar=W[4]*Tt+Ar,Br=W[5]*Gt+Br,Lo(le,Fe,Qe,Ct,Ar,Br));return ot&&ji(),tf(Le),this},h.path=function(T){for(var Q=0;Q<T.length;Q++){var Se=T[Q],ke=Se.c;switch(Se.op){case"m":Fo(ke[0],ke[1]);break;case"l":Pi(ke[0],ke[1]);break;case"c":Lo.apply(this,ke);break;case"h":ji()}}return this},h.__private__.rect=h.rect=function(T,Q,Se,ke,Le){if(isNaN(T)||isNaN(Q)||isNaN(Se)||isNaN(ke)||!ao(Le))throw new Error("Invalid arguments passed to jsPDF.rect");return N===w.COMPAT&&(ke=-ke),he([A(E(T)),A(G(Q)),A(E(Se)),A(E(ke)),"re"].join(" ")),tf(Le),this},h.__private__.triangle=h.triangle=function(T,Q,Se,ke,Le,ot,Tt){if(isNaN(T)||isNaN(Q)||isNaN(Se)||isNaN(ke)||isNaN(Le)||isNaN(ot)||!ao(Tt))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[Se-T,ke-Q],[Le-Se,ot-ke],[T-Le,Q-ot]],T,Q,[1,1],Tt,!0),this},h.__private__.roundedRect=h.roundedRect=function(T,Q,Se,ke,Le,ot,Tt){if(isNaN(T)||isNaN(Q)||isNaN(Se)||isNaN(ke)||isNaN(Le)||isNaN(ot)||!ao(Tt))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Gt=4/3*(Math.SQRT2-1);return Le=Math.min(Le,.5*Se),ot=Math.min(ot,.5*ke),this.lines([[Se-2*Le,0],[Le*Gt,0,Le,ot-ot*Gt,Le,ot],[0,ke-2*ot],[0,ot*Gt,-Le*Gt,ot,-Le,ot],[2*Le-Se,0],[-Le*Gt,0,-Le,-ot*Gt,-Le,-ot],[0,2*ot-ke],[0,-ot*Gt,Le*Gt,-ot,Le,-ot]],T+Le,Q,[1,1],Tt,!0),this},h.__private__.ellipse=h.ellipse=function(T,Q,Se,ke,Le){if(isNaN(T)||isNaN(Q)||isNaN(Se)||isNaN(ke)||!ao(Le))throw new Error("Invalid arguments passed to jsPDF.ellipse");var ot=4/3*(Math.SQRT2-1)*Se,Tt=4/3*(Math.SQRT2-1)*ke;return Fo(T+Se,Q),Lo(T+Se,Q-Tt,T+ot,Q-ke,T,Q-ke),Lo(T-ot,Q-ke,T-Se,Q-Tt,T-Se,Q),Lo(T-Se,Q+Tt,T-ot,Q+ke,T,Q+ke),Lo(T+ot,Q+ke,T+Se,Q+Tt,T+Se,Q),tf(Le),this},h.__private__.circle=h.circle=function(T,Q,Se,ke){if(isNaN(T)||isNaN(Q)||isNaN(Se)||!ao(ke))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(T,Q,Se,Se,ke)},h.setFont=function(T,Q,Se){return Se&&(Q=U(Q,Se)),Pt=Xl(T,Q,{disableWarning:!1}),this};var rf=h.__private__.getFont=h.getFont=function(){return nt[Xl.apply(h,arguments)]};h.__private__.getFontList=h.getFontList=function(){var T,Q,Se={};for(T in At)if(At.hasOwnProperty(T))for(Q in Se[T]=[],At[T])At[T].hasOwnProperty(Q)&&Se[T].push(Q);return Se},h.addFont=function(T,Q,Se,ke,Le){var ot=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&ot.indexOf(arguments[3])!==-1?Le=arguments[3]:arguments[3]&&ot.indexOf(arguments[3])==-1&&(Se=U(Se,ke)),Le=Le||"Identity-H",Jd.call(this,T,Q,Se,Le)};var on,nf=t.lineWidth||.200025,ou=h.__private__.getLineWidth=h.getLineWidth=function(){return nf},sf=h.__private__.setLineWidth=h.setLineWidth=function(T){return nf=T,he(A(E(T))+" w"),this};h.__private__.setLineDash=pr.API.setLineDash=pr.API.setLineDashPattern=function(T,Q){if(T=T||[],Q=Q||0,isNaN(Q)||!Array.isArray(T))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return T=T.map(function(Se){return A(E(Se))}).join(" "),Q=A(E(Q)),he("["+T+"] "+Q+" d"),this};var af=h.__private__.getLineHeight=h.getLineHeight=function(){return ue*on};h.__private__.getLineHeight=h.getLineHeight=function(){return ue*on};var of=h.__private__.setLineHeightFactor=h.setLineHeightFactor=function(T){return typeof(T=T||1.15)=="number"&&(on=T),this},Jl=h.__private__.getLineHeightFactor=h.getLineHeightFactor=function(){return on};of(t.lineHeight);var Ri=h.__private__.getHorizontalCoordinate=function(T){return E(T)},Ms=h.__private__.getVerticalCoordinate=function(T){return N===w.ADVANCED?T:st[O].mediaBox.topRightY-st[O].mediaBox.bottomLeftY-E(T)},Ih=h.__private__.getHorizontalCoordinateString=h.getHorizontalCoordinateString=function(T){return A(Ri(T))},ml=h.__private__.getVerticalCoordinateString=h.getVerticalCoordinateString=function(T){return A(Ms(T))},ia=t.strokeColor||"0 G";h.__private__.getStrokeColor=h.getDrawColor=function(){return we(ia)},h.__private__.setStrokeColor=h.setDrawColor=function(T,Q,Se,ke){return ia=_e({ch1:T,ch2:Q,ch3:Se,ch4:ke,pdfColorType:"draw",precision:2}),he(ia),this};var lu=t.fillColor||"0 g";h.__private__.getFillColor=h.getFillColor=function(){return we(lu)},h.__private__.setFillColor=h.setFillColor=function(T,Q,Se,ke){return lu=_e({ch1:T,ch2:Q,ch3:Se,ch4:ke,pdfColorType:"fill",precision:2}),he(lu),this};var Oo=t.textColor||"0 g",cu=h.__private__.getTextColor=h.getTextColor=function(){return we(Oo)};h.__private__.setTextColor=h.setTextColor=function(T,Q,Se,ke){return Oo=_e({ch1:T,ch2:Q,ch3:Se,ch4:ke,pdfColorType:"text",precision:3}),this};var Zl=t.charSpace,uu=h.__private__.getCharSpace=h.getCharSpace=function(){return parseFloat(Zl||0)};h.__private__.setCharSpace=h.setCharSpace=function(T){if(isNaN(T))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Zl=T,this};var lf=0;h.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},h.__private__.setLineCap=h.setLineCap=function(T){var Q=h.CapJoinStyles[T];if(Q===void 0)throw new Error("Line cap style of '"+T+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return lf=Q,he(Q+" J"),this};var du=0;h.__private__.setLineJoin=h.setLineJoin=function(T){var Q=h.CapJoinStyles[T];if(Q===void 0)throw new Error("Line join style of '"+T+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return du=Q,he(Q+" j"),this},h.__private__.setLineMiterLimit=h.__private__.setMiterLimit=h.setLineMiterLimit=h.setMiterLimit=function(T){if(T=T||0,isNaN(T))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return he(A(E(T))+" M"),this},h.GState=s2,h.setGState=function(T){(T=typeof T=="string"?je[et[T]]:pl(null,T)).equals(St)||(he("/"+T.id+" gs"),St=T)};var pl=function(T,Q){if(!T||!et[T]){var Se=!1;for(var ke in je)if(je.hasOwnProperty(ke)&&je[ke].equals(Q)){Se=!0;break}if(Se)Q=je[ke];else{var Le="GS"+(Object.keys(je).length+1).toString(10);je[Le]=Q,Q.id=Le}return T&&(et[T]=Q.id),zt.publish("addGState",Q),Q}};h.addGState=function(T,Q){return pl(T,Q),this},h.saveGraphicsState=function(){return he("q"),mr.push({key:Pt,size:ue,color:Oo}),this},h.restoreGraphicsState=function(){he("Q");var T=mr.pop();return Pt=T.key,ue=T.size,Oo=T.color,St=null,this},h.setCurrentTransformationMatrix=function(T){return he(T.toString()+" cm"),this},h.comment=function(T){return he("#"+T),this};var ec=function(T,Q){var Se=T||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return Se},set:function(ot){isNaN(ot)||(Se=parseFloat(ot))}});var ke=Q||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return ke},set:function(ot){isNaN(ot)||(ke=parseFloat(ot))}});var Le="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return Le},set:function(ot){Le=ot.toString()}}),this},fu=function(T,Q,Se,ke){ec.call(this,T,Q),this.type="rect";var Le=Se||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return Le},set:function(Tt){isNaN(Tt)||(Le=parseFloat(Tt))}});var ot=ke||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return ot},set:function(Tt){isNaN(Tt)||(ot=parseFloat(Tt))}}),this},tc=function(){this.page=vt,this.currentPage=O,this.pages=xe.slice(0),this.pagesContext=st.slice(0),this.x=or,this.y=Ve,this.matrix=tt,this.width=gl(O),this.height=va(O),this.outputDestination=Ee,this.id="",this.objectNumber=-1};tc.prototype.restore=function(){vt=this.page,O=this.currentPage,st=this.pagesContext,xe=this.pages,or=this.x,Ve=this.y,tt=this.matrix,mu(O,this.width),pu(O,this.height),Ee=this.outputDestination};var hu=function(T,Q,Se,ke,Le){Vr.push(new tc),vt=O=0,xe=[],or=T,Ve=Q,tt=Le,qa([Se,ke])},jh=function(T){if(dr[T])Vr.pop().restore();else{var Q=new tc,Se="Xo"+(Object.keys(nr).length+1).toString(10);Q.id=Se,dr[T]=Se,nr[Se]=Q,zt.publish("addFormObject",Q),Vr.pop().restore()}};for(var Mo in h.beginFormObject=function(T,Q,Se,ke,Le){return hu(T,Q,Se,ke,Le),this},h.endFormObject=function(T){return jh(T),this},h.doFormObject=function(T,Q){var Se=nr[dr[T]];return he("q"),he(Q.toString()+" cm"),he("/"+Se.id+" Do"),he("Q"),this},h.getFormObject=function(T){var Q=nr[dr[T]];return{x:Q.x,y:Q.y,width:Q.width,height:Q.height,matrix:Q.matrix}},h.save=function(T,Q){return T=T||"generated.pdf",(Q=Q||{}).returnPromise=Q.returnPromise||!1,Q.returnPromise===!1?(bf(ru(Do()),T),typeof bf.unload=="function"&&yr.setTimeout&&setTimeout(bf.unload,911),this):new Promise(function(Se,ke){try{var Le=bf(ru(Do()),T);typeof bf.unload=="function"&&yr.setTimeout&&setTimeout(bf.unload,911),Se(Le)}catch(ot){ke(ot.message)}})},pr.API)pr.API.hasOwnProperty(Mo)&&(Mo==="events"&&pr.API.events.length?function(T,Q){var Se,ke,Le;for(Le=Q.length-1;Le!==-1;Le--)Se=Q[Le][0],ke=Q[Le][1],T.subscribe.apply(T,[Se].concat(typeof ke=="function"?[ke]:ke))}(zt,pr.API.events):h[Mo]=pr.API[Mo]);var gl=h.getPageWidth=function(T){return(st[T=T||O].mediaBox.topRightX-st[T].mediaBox.bottomLeftX)/ht},mu=h.setPageWidth=function(T,Q){st[T].mediaBox.topRightX=Q*ht+st[T].mediaBox.bottomLeftX},va=h.getPageHeight=function(T){return(st[T=T||O].mediaBox.topRightY-st[T].mediaBox.bottomLeftY)/ht},pu=h.setPageHeight=function(T,Q){st[T].mediaBox.topRightY=Q*ht+st[T].mediaBox.bottomLeftY};return h.internal={pdfEscape:rs,getStyle:Ch,getFont:rf,getFontSize:Ae,getCharSpace:uu,getTextColor:cu,getLineHeight:af,getLineHeightFactor:Jl,getLineWidth:ou,write:qe,getHorizontalCoordinate:Ri,getVerticalCoordinate:Ms,getCoordinateString:Ih,getVerticalCoordinateString:ml,collections:{},newObject:Nn,newAdditionalObject:be,newObjectDeferred:ir,newObjectDeferredBegin:ee,getFilters:$e,putStream:rt,events:zt,scaleFactor:ht,pageSize:{getWidth:function(){return gl(O)},setWidth:function(T){mu(O,T)},getHeight:function(){return va(O)},setHeight:function(T){pu(O,T)}},encryptionOptions:d,encryption:Pn,getEncryptor:Eh,output:nu,getNumberOfPages:un,pages:xe,out:he,f2:M,f3:I,getPageInfo:ef,getPageInfoByObjId:wr,getCurrentPageInfo:hl,getPDFVersion:p,Point:ec,Rectangle:fu,Matrix:Et,hasHotfix:fl},Object.defineProperty(h.internal.pageSize,"width",{get:function(){return gl(O)},set:function(T){mu(O,T)},enumerable:!0,configurable:!0}),Object.defineProperty(h.internal.pageSize,"height",{get:function(){return va(O)},set:function(T){pu(O,T)},enumerable:!0,configurable:!0}),Th.call(h,lt),Pt="F1",Yl(s,r),zt.publish("initialized"),h}f0.prototype.lsbFirstWord=function(t){return String.fromCharCode(t>>0&255,t>>8&255,t>>16&255,t>>24&255)},f0.prototype.toHexString=function(t){return t.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},f0.prototype.hexToBytes=function(t){for(var e=[],r=0;r<t.length;r+=2)e.push(String.fromCharCode(parseInt(t.substr(r,2),16)));return e.join("")},f0.prototype.processOwnerPassword=function(t,e){return iN(aN(e).substr(0,5),t)},f0.prototype.encryptor=function(t,e){var r=aN(this.encryptionKey+String.fromCharCode(255&t,t>>8&255,t>>16&255,255&e,e>>8&255)).substr(0,10);return function(n){return iN(r,n)}},s2.prototype.equals=function(t){var e,r="id,objectNumber,equals";if(!t||yn(t)!==yn(this))return!1;var n=0;for(e in this)if(!(r.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!t.hasOwnProperty(e)||this[e]!==t[e])return!1;n++}for(e in t)t.hasOwnProperty(e)&&r.indexOf(e)<0&&n--;return n===0},pr.API={events:[]},pr.version="3.0.1";var as=pr.API,v3=1,Sh=function(t){return t.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},r0=function(t){return t.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Cr=function(t){return t.toFixed(2)},Ru=function(t){return t.toFixed(5)};as.__acroform__={};var Ii=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t},qk=function(t){return t*v3},Tl=function(t){var e=new FL,r=er.internal.getHeight(t)||0,n=er.internal.getWidth(t)||0;return e.BBox=[0,0,Number(Cr(n)),Number(Cr(r))],e},Coe=as.__acroform__.setBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return t|=1<<e},koe=as.__acroform__.clearBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return t&=~(1<<e)},Ioe=as.__acroform__.getBit=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return t&1<<e?1:0},xs=as.__acroform__.getBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return Ioe(t,e-1)},ys=as.__acroform__.setBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return Coe(t,e-1)},vs=as.__acroform__.clearBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return koe(t,e-1)},joe=as.__acroform__.calculateCoordinates=function(t,e){var r=e.internal.getHorizontalCoordinate,n=e.internal.getVerticalCoordinate,s=t[0],a=t[1],i=t[2],l=t[3],c={};return c.lowerLeft_X=r(s)||0,c.lowerLeft_Y=n(a+l)||0,c.upperRight_X=r(s+i)||0,c.upperRight_Y=n(a)||0,[Number(Cr(c.lowerLeft_X)),Number(Cr(c.lowerLeft_Y)),Number(Cr(c.upperRight_X)),Number(Cr(c.upperRight_Y))]},Poe=function(t){if(t.appearanceStreamContent)return t.appearanceStreamContent;if(t.V||t.DV){var e=[],r=t._V||t.DV,n=oN(t,r),s=t.scope.internal.getFont(t.fontName,t.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(t.scope.__private__.encodeColorString(t.color)),e.push("/"+s+" "+Cr(n.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(n.text),e.push("ET"),e.push("Q"),e.push("EMC");var a=Tl(t);return a.scope=t.scope,a.stream=e.join(`
`),a}},oN=function(t,e){var r=t.fontSize===0?t.maxFontSize:t.fontSize,n={text:"",fontSize:""},s=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");s=t.multiline?s.map(function(I){return I.split(`
`)}):s.map(function(I){return[I]});var a=r,i=er.internal.getHeight(t)||0;i=i<0?-i:i;var l=er.internal.getWidth(t)||0;l=l<0?-l:l;var c=function(I,E,D){if(I+1<s.length){var G=E+" "+s[I+1][0];return ny(G,t,D).width<=l-4}return!1};a++;e:for(;a>0;){e="",a--;var u,d,f=ny("3",t,a).height,m=t.multiline?i-a:(i-f)/2,h=m+=2,g=0,p=0,v=0;if(a<=0){e=`(...) Tj
`,e+="% Width of Text: "+ny(e,t,a=12).width+", FieldWidth:"+l+`
`;break}for(var b="",w=0,N=0;N<s.length;N++)if(s.hasOwnProperty(N)){var j=!1;if(s[N].length!==1&&v!==s[N].length-1){if((f+2)*(w+2)+2>i)continue e;b+=s[N][v],j=!0,p=N,N--}else{b=(b+=s[N][v]+" ").substr(b.length-1)==" "?b.substr(0,b.length-1):b;var F=parseInt(N),U=c(F,b,a),A=N>=s.length-1;if(U&&!A){b+=" ",v=0;continue}if(U||A){if(A)p=F;else if(t.multiline&&(f+2)*(w+2)+2>i)continue e}else{if(!t.multiline||(f+2)*(w+2)+2>i)continue e;p=F}}for(var S="",k=g;k<=p;k++){var M=s[k];if(t.multiline){if(k===p){S+=M[v]+" ",v=(v+1)%M.length;continue}if(k===g){S+=M[M.length-1]+" ";continue}}S+=M[0]+" "}switch(S=S.substr(S.length-1)==" "?S.substr(0,S.length-1):S,d=ny(S,t,a).width,t.textAlign){case"right":u=l-d-2;break;case"center":u=(l-d)/2;break;case"left":default:u=2}e+=Cr(u)+" "+Cr(h)+` Td
`,e+="("+Sh(S)+`) Tj
`,e+=-Cr(u)+` 0 Td
`,h=-(a+2),d=0,g=j?p:p+1,w++,b=""}break}return n.text=e,n.fontSize=a,n},ny=function(t,e,r){var n=e.scope.internal.getFont(e.fontName,e.fontStyle),s=e.scope.getStringUnitWidth(t,{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:e.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:s}},Roe={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},Doe=function(t,e){var r={type:"reference",object:t};e.internal.getPageInfo(t.page).pageContext.annotations.find(function(n){return n.type===r.type&&n.object===r.object})===void 0&&e.internal.getPageInfo(t.page).pageContext.annotations.push(r)},Foe=function(t,e){for(var r in t)if(t.hasOwnProperty(r)){var n=r,s=t[r];e.internal.newObjectDeferredBegin(s.objId,!0),yn(s)==="object"&&typeof s.putStream=="function"&&s.putStream(),delete t[n]}},Loe=function(t,e){if(e.scope=t,t.internal!==void 0&&(t.internal.acroformPlugin===void 0||t.internal.acroformPlugin.isInitialized===!1)){if(cl.FieldNum=0,t.internal.acroformPlugin=JSON.parse(JSON.stringify(Roe)),t.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");v3=t.internal.scaleFactor,t.internal.acroformPlugin.acroFormDictionaryRoot=new LL,t.internal.acroformPlugin.acroFormDictionaryRoot.scope=t,t.internal.acroformPlugin.acroFormDictionaryRoot._eventID=t.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(t)}),t.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var s in n)if(n.hasOwnProperty(s)){var a=n[s];a.objId=void 0,a.hasAnnotation&&Doe(a,r)}})(t)}),t.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(t)}),t.internal.events.subscribe("postPutPages",function(r){(function(n,s){var a=!n;for(var i in n||(s.internal.newObjectDeferredBegin(s.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),s.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||s.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(i)){var l=n[i],c=[],u=l.Rect;if(l.Rect&&(l.Rect=joe(l.Rect,s)),s.internal.newObjectDeferredBegin(l.objId,!0),l.DA=er.createDefaultAppearanceStream(l),yn(l)==="object"&&typeof l.getKeyValueListForStream=="function"&&(c=l.getKeyValueListForStream()),l.Rect=u,l.hasAppearanceStream&&!l.appearanceStreamContent){var d=Poe(l);c.push({key:"AP",value:"<</N "+d+">>"}),s.internal.acroformPlugin.xForms.push(d)}if(l.appearanceStreamContent){var f="";for(var m in l.appearanceStreamContent)if(l.appearanceStreamContent.hasOwnProperty(m)){var h=l.appearanceStreamContent[m];if(f+="/"+m+" ",f+="<<",Object.keys(h).length>=1||Array.isArray(h)){for(var i in h)if(h.hasOwnProperty(i)){var g=h[i];typeof g=="function"&&(g=g.call(s,l)),f+="/"+i+" "+g+" ",s.internal.acroformPlugin.xForms.indexOf(g)>=0||s.internal.acroformPlugin.xForms.push(g)}}else typeof(g=h)=="function"&&(g=g.call(s,l)),f+="/"+i+" "+g,s.internal.acroformPlugin.xForms.indexOf(g)>=0||s.internal.acroformPlugin.xForms.push(g);f+=">>"}c.push({key:"AP",value:`<<
`+f+">>"})}s.internal.putStream({additionalKeyValues:c,objectId:l.objId}),s.internal.out("endobj")}a&&Foe(s.internal.acroformPlugin.xForms,s)})(r,t)}),t.internal.acroformPlugin.isInitialized=!0}},DL=as.__acroform__.arrayToPdfArray=function(t,e,r){var n=function(i){return i};if(Array.isArray(t)){for(var s="[",a=0;a<t.length;a++)switch(a!==0&&(s+=" "),yn(t[a])){case"boolean":case"number":case"object":s+=t[a].toString();break;case"string":t[a].substr(0,1)!=="/"?(e!==void 0&&r&&(n=r.internal.getEncryptor(e)),s+="("+Sh(n(t[a].toString()))+")"):s+=t[a].toString()}return s+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},zw=function(t,e,r){var n=function(s){return s};return e!==void 0&&r&&(n=r.internal.getEncryptor(e)),(t=t||"").toString(),t="("+Sh(n(t))+")"},Fl=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(t){this._objId=t}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Fl.prototype.toString=function(){return this.objId+" 0 R"},Fl.prototype.putStream=function(){var t=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:t,objectId:this.objId}),this.scope.internal.out("endobj")},Fl.prototype.getKeyValueListForStream=function(){var t=[],e=Object.getOwnPropertyNames(this).filter(function(a){return a!="content"&&a!="appearanceStreamContent"&&a!="scope"&&a!="objId"&&a.substring(0,1)!="_"});for(var r in e)if(Object.getOwnPropertyDescriptor(this,e[r]).configurable===!1){var n=e[r],s=this[n];s&&(Array.isArray(s)?t.push({key:n,value:DL(s,this.objId,this.scope)}):s instanceof Fl?(s.scope=this.scope,t.push({key:n,value:s.objId+" 0 R"})):typeof s!="function"&&t.push({key:n,value:s}))}return t};var FL=function(){Fl.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var t,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){t=r.trim()},get:function(){return t||null}})};Ii(FL,Fl);var LL=function(){Fl.call(this);var t,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(t){var r=function(n){return n};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+Sh(r(t))+")"}},set:function(r){t=r}})};Ii(LL,Fl);var cl=function t(){Fl.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(b){if(isNaN(b))throw new Error('Invalid value "'+b+'" for attribute F supplied.');e=b}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!xs(e,3)},set:function(b){b?this.F=ys(e,3):this.F=vs(e,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(b){if(isNaN(b))throw new Error('Invalid value "'+b+'" for attribute Ff supplied.');r=b}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(b){n=b!==void 0?b:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(b){n[0]=b}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(b){n[1]=b}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(b){n[2]=b}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(b){n[3]=b}});var s="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return s},set:function(b){switch(b){case"/Btn":case"/Tx":case"/Ch":case"/Sig":s=b;break;default:throw new Error('Invalid value "'+b+'" for attribute FT supplied.')}}});var a=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!a||a.length<1){if(this instanceof a2)return;a="FieldObject"+t.FieldNum++}var b=function(w){return w};return this.scope&&(b=this.scope.internal.getEncryptor(this.objId)),"("+Sh(b(a))+")"},set:function(b){a=b.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return a},set:function(b){a=b}});var i="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return i},set:function(b){i=b}});var l="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return l},set:function(b){l=b}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(b){c=b}});var u=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return u===void 0?50/v3:u},set:function(b){u=b}});var d="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return d},set:function(b){d=b}});var f="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!f||this instanceof a2||this instanceof Uf))return zw(f,this.objId,this.scope)},set:function(b){b=b.toString(),f=b}});var m=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(m)return this instanceof ta?m:zw(m,this.objId,this.scope)},set:function(b){b=b.toString(),m=this instanceof ta?b:b.substr(0,1)==="("?r0(b.substr(1,b.length-2)):r0(b)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof ta?r0(m.substr(1,m.length-1)):m},set:function(b){b=b.toString(),m=this instanceof ta?"/"+b:b}});var h=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(h)return h},set:function(b){this.V=b}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(h)return this instanceof ta?h:zw(h,this.objId,this.scope)},set:function(b){b=b.toString(),h=this instanceof ta?b:b.substr(0,1)==="("?r0(b.substr(1,b.length-2)):r0(b)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof ta?r0(h.substr(1,h.length-1)):h},set:function(b){b=b.toString(),h=this instanceof ta?"/"+b:b}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var g,p=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return p},set:function(b){b=!!b,p=b}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(g)return g},set:function(b){g=b}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!xs(this.Ff,1)},set:function(b){b?this.Ff=ys(this.Ff,1):this.Ff=vs(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!xs(this.Ff,2)},set:function(b){b?this.Ff=ys(this.Ff,2):this.Ff=vs(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!xs(this.Ff,3)},set:function(b){b?this.Ff=ys(this.Ff,3):this.Ff=vs(this.Ff,3)}});var v=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(v!==null)return v},set:function(b){if([0,1,2].indexOf(b)===-1)throw new Error('Invalid value "'+b+'" for attribute Q supplied.');v=b}}),Object.defineProperty(this,"textAlign",{get:function(){var b;switch(v){case 0:default:b="left";break;case 1:b="center";break;case 2:b="right"}return b},configurable:!0,enumerable:!0,set:function(b){switch(b){case"right":case 2:v=2;break;case"center":case 1:v=1;break;case"left":case 0:default:v=0}}})};Ii(cl,Fl);var q0=function(){cl.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var t=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return t},set:function(r){t=r}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return DL(e,this.objId,this.scope)},set:function(r){var n,s;s=[],typeof(n=r)=="string"&&(s=function(a,i,l){l||(l=1);for(var c,u=[];c=i.exec(a);)u.push(c[l]);return u}(n,/\((.*?)\)/g)),e=s}}),this.getOptions=function(){return e},this.setOptions=function(r){e=r,this.sort&&e.sort()},this.addOption=function(r){r=(r=r||"").toString(),e.push(r),this.sort&&e.sort()},this.removeOption=function(r,n){for(n=n||!1,r=(r=r||"").toString();e.indexOf(r)!==-1&&(e.splice(e.indexOf(r),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!xs(this.Ff,18)},set:function(r){r?this.Ff=ys(this.Ff,18):this.Ff=vs(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!xs(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=ys(this.Ff,19):this.Ff=vs(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!xs(this.Ff,20)},set:function(r){r?(this.Ff=ys(this.Ff,20),e.sort()):this.Ff=vs(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!xs(this.Ff,22)},set:function(r){r?this.Ff=ys(this.Ff,22):this.Ff=vs(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!xs(this.Ff,23)},set:function(r){r?this.Ff=ys(this.Ff,23):this.Ff=vs(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!xs(this.Ff,27)},set:function(r){r?this.Ff=ys(this.Ff,27):this.Ff=vs(this.Ff,27)}}),this.hasAppearanceStream=!1};Ii(q0,cl);var W0=function(){q0.call(this),this.fontName="helvetica",this.combo=!1};Ii(W0,q0);var H0=function(){W0.call(this),this.combo=!0};Ii(H0,W0);var Oy=function(){H0.call(this),this.edit=!0};Ii(Oy,H0);var ta=function(){cl.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!xs(this.Ff,15)},set:function(r){r?this.Ff=ys(this.Ff,15):this.Ff=vs(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!xs(this.Ff,16)},set:function(r){r?this.Ff=ys(this.Ff,16):this.Ff=vs(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!xs(this.Ff,17)},set:function(r){r?this.Ff=ys(this.Ff,17):this.Ff=vs(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!xs(this.Ff,26)},set:function(r){r?this.Ff=ys(this.Ff,26):this.Ff=vs(this.Ff,26)}});var t,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(a){return a};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var n,s=[];for(n in s.push("<<"),e)s.push("/"+n+" ("+Sh(r(e[n]))+")");return s.push(">>"),s.join(`
`)}},set:function(r){yn(r)==="object"&&(e=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(r){typeof r=="string"&&(e.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(r){t="/"+r}})};Ii(ta,cl);var My=function(){ta.call(this),this.pushButton=!0};Ii(My,ta);var G0=function(){ta.call(this),this.radio=!0,this.pushButton=!1;var t=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e!==void 0?e:[]}})};Ii(G0,ta);var a2=function(){var t,e;cl.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return t},set:function(s){t=s}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(s){e=s}});var r,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var s=function(l){return l};this.scope&&(s=this.scope.internal.getEncryptor(this.objId));var a,i=[];for(a in i.push("<<"),n)i.push("/"+a+" ("+Sh(s(n[a]))+")");return i.push(">>"),i.join(`
`)},set:function(s){yn(s)==="object"&&(n=s)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(s){typeof s=="string"&&(n.CA=s)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(s){r=s}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(s){r="/"+s}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=er.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Ii(a2,cl),G0.prototype.setAppearance=function(t){if(!("createAppearanceStream"in t)||!("getCA"in t))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var r=this.Kids[e];r.appearanceStreamContent=t.createAppearanceStream(r.optionName),r.caption=t.getCA()}},G0.prototype.createOption=function(t){var e=new a2;return e.Parent=this,e.optionName=t,this.Kids.push(e),Ooe.call(this.scope,e),e};var Vy=function(){ta.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=er.CheckBox.createAppearanceStream()};Ii(Vy,ta);var Uf=function(){cl.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!xs(this.Ff,13)},set:function(e){e?this.Ff=ys(this.Ff,13):this.Ff=vs(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!xs(this.Ff,21)},set:function(e){e?this.Ff=ys(this.Ff,21):this.Ff=vs(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!xs(this.Ff,23)},set:function(e){e?this.Ff=ys(this.Ff,23):this.Ff=vs(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!xs(this.Ff,24)},set:function(e){e?this.Ff=ys(this.Ff,24):this.Ff=vs(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!xs(this.Ff,25)},set:function(e){e?this.Ff=ys(this.Ff,25):this.Ff=vs(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!xs(this.Ff,26)},set:function(e){e?this.Ff=ys(this.Ff,26):this.Ff=vs(this.Ff,26)}});var t=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return t},set:function(e){Number.isInteger(e)&&(t=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Ii(Uf,cl);var By=function(){Uf.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!xs(this.Ff,14)},set:function(t){t?this.Ff=ys(this.Ff,14):this.Ff=vs(this.Ff,14)}}),this.password=!0};Ii(By,Uf);var er={CheckBox:{createAppearanceStream:function(){return{N:{On:er.CheckBox.YesNormal},D:{On:er.CheckBox.YesPushDown,Off:er.CheckBox.OffPushDown}}},YesPushDown:function(t){var e=Tl(t);e.scope=t.scope;var r=[],n=t.scope.internal.getFont(t.fontName,t.fontStyle).id,s=t.scope.__private__.encodeColorString(t.color),a=oN(t,t.caption);return r.push("0.749023 g"),r.push("0 0 "+Cr(er.internal.getWidth(t))+" "+Cr(er.internal.getHeight(t))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+n+" "+Cr(a.fontSize)+" Tf "+s),r.push("BT"),r.push(a.text),r.push("ET"),r.push("Q"),r.push("EMC"),e.stream=r.join(`
`),e},YesNormal:function(t){var e=Tl(t);e.scope=t.scope;var r=t.scope.internal.getFont(t.fontName,t.fontStyle).id,n=t.scope.__private__.encodeColorString(t.color),s=[],a=er.internal.getHeight(t),i=er.internal.getWidth(t),l=oN(t,t.caption);return s.push("1 g"),s.push("0 0 "+Cr(i)+" "+Cr(a)+" re"),s.push("f"),s.push("q"),s.push("0 0 1 rg"),s.push("0 0 "+Cr(i-1)+" "+Cr(a-1)+" re"),s.push("W"),s.push("n"),s.push("0 g"),s.push("BT"),s.push("/"+r+" "+Cr(l.fontSize)+" Tf "+n),s.push(l.text),s.push("ET"),s.push("Q"),e.stream=s.join(`
`),e},OffPushDown:function(t){var e=Tl(t);e.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Cr(er.internal.getWidth(t))+" "+Cr(er.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(t){var e={D:{Off:er.RadioButton.Circle.OffPushDown},N:{}};return e.N[t]=er.RadioButton.Circle.YesNormal,e.D[t]=er.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(t){var e=Tl(t);e.scope=t.scope;var r=[],n=er.internal.getWidth(t)<=er.internal.getHeight(t)?er.internal.getWidth(t)/4:er.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var s=er.internal.Bezier_C,a=Number((n*s).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+Ru(er.internal.getWidth(t)/2)+" "+Ru(er.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+a+" "+a+" "+n+" 0 "+n+" c"),r.push("-"+a+" "+n+" -"+n+" "+a+" -"+n+" 0 c"),r.push("-"+n+" -"+a+" -"+a+" -"+n+" 0 -"+n+" c"),r.push(a+" -"+n+" "+n+" -"+a+" "+n+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e},YesPushDown:function(t){var e=Tl(t);e.scope=t.scope;var r=[],n=er.internal.getWidth(t)<=er.internal.getHeight(t)?er.internal.getWidth(t)/4:er.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var s=Number((2*n).toFixed(5)),a=Number((s*er.internal.Bezier_C).toFixed(5)),i=Number((n*er.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Ru(er.internal.getWidth(t)/2)+" "+Ru(er.internal.getHeight(t)/2)+" cm"),r.push(s+" 0 m"),r.push(s+" "+a+" "+a+" "+s+" 0 "+s+" c"),r.push("-"+a+" "+s+" -"+s+" "+a+" -"+s+" 0 c"),r.push("-"+s+" -"+a+" -"+a+" -"+s+" 0 -"+s+" c"),r.push(a+" -"+s+" "+s+" -"+a+" "+s+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+Ru(er.internal.getWidth(t)/2)+" "+Ru(er.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+i+" "+i+" "+n+" 0 "+n+" c"),r.push("-"+i+" "+n+" -"+n+" "+i+" -"+n+" 0 c"),r.push("-"+n+" -"+i+" -"+i+" -"+n+" 0 -"+n+" c"),r.push(i+" -"+n+" "+n+" -"+i+" "+n+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e},OffPushDown:function(t){var e=Tl(t);e.scope=t.scope;var r=[],n=er.internal.getWidth(t)<=er.internal.getHeight(t)?er.internal.getWidth(t)/4:er.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var s=Number((2*n).toFixed(5)),a=Number((s*er.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Ru(er.internal.getWidth(t)/2)+" "+Ru(er.internal.getHeight(t)/2)+" cm"),r.push(s+" 0 m"),r.push(s+" "+a+" "+a+" "+s+" 0 "+s+" c"),r.push("-"+a+" "+s+" -"+s+" "+a+" -"+s+" 0 c"),r.push("-"+s+" -"+a+" -"+a+" -"+s+" 0 -"+s+" c"),r.push(a+" -"+s+" "+s+" -"+a+" "+s+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e}},Cross:{createAppearanceStream:function(t){var e={D:{Off:er.RadioButton.Cross.OffPushDown},N:{}};return e.N[t]=er.RadioButton.Cross.YesNormal,e.D[t]=er.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(t){var e=Tl(t);e.scope=t.scope;var r=[],n=er.internal.calculateCross(t);return r.push("q"),r.push("1 1 "+Cr(er.internal.getWidth(t)-2)+" "+Cr(er.internal.getHeight(t)-2)+" re"),r.push("W"),r.push("n"),r.push(Cr(n.x1.x)+" "+Cr(n.x1.y)+" m"),r.push(Cr(n.x2.x)+" "+Cr(n.x2.y)+" l"),r.push(Cr(n.x4.x)+" "+Cr(n.x4.y)+" m"),r.push(Cr(n.x3.x)+" "+Cr(n.x3.y)+" l"),r.push("s"),r.push("Q"),e.stream=r.join(`
`),e},YesPushDown:function(t){var e=Tl(t);e.scope=t.scope;var r=er.internal.calculateCross(t),n=[];return n.push("0.749023 g"),n.push("0 0 "+Cr(er.internal.getWidth(t))+" "+Cr(er.internal.getHeight(t))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+Cr(er.internal.getWidth(t)-2)+" "+Cr(er.internal.getHeight(t)-2)+" re"),n.push("W"),n.push("n"),n.push(Cr(r.x1.x)+" "+Cr(r.x1.y)+" m"),n.push(Cr(r.x2.x)+" "+Cr(r.x2.y)+" l"),n.push(Cr(r.x4.x)+" "+Cr(r.x4.y)+" m"),n.push(Cr(r.x3.x)+" "+Cr(r.x3.y)+" l"),n.push("s"),n.push("Q"),e.stream=n.join(`
`),e},OffPushDown:function(t){var e=Tl(t);e.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Cr(er.internal.getWidth(t))+" "+Cr(er.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join(`
`),e}}},createDefaultAppearanceStream:function(t){var e=t.scope.internal.getFont(t.fontName,t.fontStyle).id,r=t.scope.__private__.encodeColorString(t.color);return"/"+e+" "+t.fontSize+" Tf "+r}};er.internal={Bezier_C:.551915024494,calculateCross:function(t){var e=er.internal.getWidth(t),r=er.internal.getHeight(t),n=Math.min(e,r);return{x1:{x:(e-n)/2,y:(r-n)/2+n},x2:{x:(e-n)/2+n,y:(r-n)/2},x3:{x:(e-n)/2,y:(r-n)/2},x4:{x:(e-n)/2+n,y:(r-n)/2+n}}}},er.internal.getWidth=function(t){var e=0;return yn(t)==="object"&&(e=qk(t.Rect[2])),e},er.internal.getHeight=function(t){var e=0;return yn(t)==="object"&&(e=qk(t.Rect[3])),e};var Ooe=as.addField=function(t){if(Loe(this,t),!(t instanceof cl))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=t).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),t.page=t.scope.internal.getCurrentPageInfo().pageNumber,this};as.AcroFormChoiceField=q0,as.AcroFormListBox=W0,as.AcroFormComboBox=H0,as.AcroFormEditBox=Oy,as.AcroFormButton=ta,as.AcroFormPushButton=My,as.AcroFormRadioButton=G0,as.AcroFormCheckBox=Vy,as.AcroFormTextField=Uf,as.AcroFormPasswordField=By,as.AcroFormAppearance=er,as.AcroForm={ChoiceField:q0,ListBox:W0,ComboBox:H0,EditBox:Oy,Button:ta,PushButton:My,RadioButton:G0,CheckBox:Vy,TextField:Uf,PasswordField:By,Appearance:er},pr.AcroForm={ChoiceField:q0,ListBox:W0,ComboBox:H0,EditBox:Oy,Button:ta,PushButton:My,RadioButton:G0,CheckBox:Vy,TextField:Uf,PasswordField:By,Appearance:er};pr.AcroForm;function OL(t){return t.reduce(function(e,r,n){return e[r]=n,e},{})}(function(t){t.__addimage__={};var e="UNKNOWN",r={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},n=t.__addimage__.getImageFileTypeByImageData=function(I,E){var D,G,Z,ae,de,se=e;if((E=E||e)==="RGBA"||I.data!==void 0&&I.data instanceof Uint8ClampedArray&&"height"in I&&"width"in I)return"RGBA";if(U(I))for(de in r)for(Z=r[de],D=0;D<Z.length;D+=1){for(ae=!0,G=0;G<Z[D].length;G+=1)if(Z[D][G]!==void 0&&Z[D][G]!==I[G]){ae=!1;break}if(ae===!0){se=de;break}}else for(de in r)for(Z=r[de],D=0;D<Z.length;D+=1){for(ae=!0,G=0;G<Z[D].length;G+=1)if(Z[D][G]!==void 0&&Z[D][G]!==I.charCodeAt(G)){ae=!1;break}if(ae===!0){se=de;break}}return se===e&&E!==e&&(se=E),se},s=function I(E){for(var D=this.internal.write,G=this.internal.putStream,Z=(0,this.internal.getFilters)();Z.indexOf("FlateEncode")!==-1;)Z.splice(Z.indexOf("FlateEncode"),1);E.objectId=this.internal.newObject();var ae=[];if(ae.push({key:"Type",value:"/XObject"}),ae.push({key:"Subtype",value:"/Image"}),ae.push({key:"Width",value:E.width}),ae.push({key:"Height",value:E.height}),E.colorSpace===v.INDEXED?ae.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(E.palette.length/3-1)+" "+("sMask"in E&&E.sMask!==void 0?E.objectId+2:E.objectId+1)+" 0 R]"}):(ae.push({key:"ColorSpace",value:"/"+E.colorSpace}),E.colorSpace===v.DEVICE_CMYK&&ae.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),ae.push({key:"BitsPerComponent",value:E.bitsPerComponent}),"decodeParameters"in E&&E.decodeParameters!==void 0&&ae.push({key:"DecodeParms",value:"<<"+E.decodeParameters+">>"}),"transparency"in E&&Array.isArray(E.transparency)){for(var de="",se=0,Y=E.transparency.length;se<Y;se++)de+=E.transparency[se]+" "+E.transparency[se]+" ";ae.push({key:"Mask",value:"["+de+"]"})}E.sMask!==void 0&&ae.push({key:"SMask",value:E.objectId+1+" 0 R"});var ye=E.filter!==void 0?["/"+E.filter]:void 0;if(G({data:E.data,additionalKeyValues:ae,alreadyAppliedFilters:ye,objectId:E.objectId}),D("endobj"),"sMask"in E&&E.sMask!==void 0){var re="/Predictor "+E.predictor+" /Colors 1 /BitsPerComponent "+E.bitsPerComponent+" /Columns "+E.width,C={width:E.width,height:E.height,colorSpace:"DeviceGray",bitsPerComponent:E.bitsPerComponent,decodeParameters:re,data:E.sMask};"filter"in E&&(C.filter=E.filter),I.call(this,C)}if(E.colorSpace===v.INDEXED){var O=this.internal.newObject();G({data:S(new Uint8Array(E.palette)),objectId:O}),D("endobj")}},a=function(){var I=this.internal.collections.addImage_images;for(var E in I)s.call(this,I[E])},i=function(){var I,E=this.internal.collections.addImage_images,D=this.internal.write;for(var G in E)D("/I"+(I=E[G]).index,I.objectId,"0","R")},l=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",a),this.internal.events.subscribe("putXobjectDict",i))},c=function(){var I=this.internal.collections.addImage_images;return l.call(this),I},u=function(){return Object.keys(this.internal.collections.addImage_images).length},d=function(I){return typeof t["process"+I.toUpperCase()]=="function"},f=function(I){return yn(I)==="object"&&I.nodeType===1},m=function(I,E){if(I.nodeName==="IMG"&&I.hasAttribute("src")){var D=""+I.getAttribute("src");if(D.indexOf("data:image/")===0)return lg(unescape(D).split("base64,").pop());var G=t.loadFile(D,!0);if(G!==void 0)return G}if(I.nodeName==="CANVAS"){if(I.width===0||I.height===0)throw new Error("Given canvas must have data. Canvas width: "+I.width+", height: "+I.height);var Z;switch(E){case"PNG":Z="image/png";break;case"WEBP":Z="image/webp";break;case"JPEG":case"JPG":default:Z="image/jpeg"}return lg(I.toDataURL(Z,1).split("base64,").pop())}},h=function(I){var E=this.internal.collections.addImage_images;if(E){for(var D in E)if(I===E[D].alias)return E[D]}},g=function(I,E,D){return I||E||(I=-96,E=-96),I<0&&(I=-1*D.width*72/I/this.internal.scaleFactor),E<0&&(E=-1*D.height*72/E/this.internal.scaleFactor),I===0&&(I=E*D.width/D.height),E===0&&(E=I*D.height/D.width),[I,E]},p=function(I,E,D,G,Z,ae){var de=g.call(this,D,G,Z),se=this.internal.getCoordinateString,Y=this.internal.getVerticalCoordinateString,ye=c.call(this);if(D=de[0],G=de[1],ye[Z.index]=Z,ae){ae*=Math.PI/180;var re=Math.cos(ae),C=Math.sin(ae),O=function(H){return H.toFixed(4)},L=[O(re),O(C),O(-1*C),O(re),0,0,"cm"]}this.internal.write("q"),ae?(this.internal.write([1,"0","0",1,se(I),Y(E+G),"cm"].join(" ")),this.internal.write(L.join(" ")),this.internal.write([se(D),"0","0",se(G),"0","0","cm"].join(" "))):this.internal.write([se(D),"0","0",se(G),se(I),Y(E+G),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+Z.index+" Do"),this.internal.write("Q")},v=t.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};t.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var b=t.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},w=t.__addimage__.sHashCode=function(I){var E,D,G=0;if(typeof I=="string")for(D=I.length,E=0;E<D;E++)G=(G<<5)-G+I.charCodeAt(E),G|=0;else if(U(I))for(D=I.byteLength/2,E=0;E<D;E++)G=(G<<5)-G+I[E],G|=0;return G},N=t.__addimage__.validateStringAsBase64=function(I){(I=I||"").toString().trim();var E=!0;return I.length===0&&(E=!1),I.length%4!=0&&(E=!1),/^[A-Za-z0-9+/]+$/.test(I.substr(0,I.length-2))===!1&&(E=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(I.substr(-2))===!1&&(E=!1),E},j=t.__addimage__.extractImageFromDataUrl=function(I){if(I==null||!(I=I.trim()).startsWith("data:"))return null;var E=I.indexOf(",");return E<0?null:I.substring(0,E).trim().endsWith("base64")?I.substring(E+1):null},F=t.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};t.__addimage__.isArrayBuffer=function(I){return F()&&I instanceof ArrayBuffer};var U=t.__addimage__.isArrayBufferView=function(I){return F()&&typeof Uint32Array<"u"&&(I instanceof Int8Array||I instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&I instanceof Uint8ClampedArray||I instanceof Int16Array||I instanceof Uint16Array||I instanceof Int32Array||I instanceof Uint32Array||I instanceof Float32Array||I instanceof Float64Array)},A=t.__addimage__.binaryStringToUint8Array=function(I){for(var E=I.length,D=new Uint8Array(E),G=0;G<E;G++)D[G]=I.charCodeAt(G);return D},S=t.__addimage__.arrayBufferToBinaryString=function(I){for(var E="",D=U(I)?I:new Uint8Array(I),G=0;G<D.length;G+=8192)E+=String.fromCharCode.apply(null,D.subarray(G,G+8192));return E};t.addImage=function(){var I,E,D,G,Z,ae,de,se,Y;if(typeof arguments[1]=="number"?(E=e,D=arguments[1],G=arguments[2],Z=arguments[3],ae=arguments[4],de=arguments[5],se=arguments[6],Y=arguments[7]):(E=arguments[1],D=arguments[2],G=arguments[3],Z=arguments[4],ae=arguments[5],de=arguments[6],se=arguments[7],Y=arguments[8]),yn(I=arguments[0])==="object"&&!f(I)&&"imageData"in I){var ye=I;I=ye.imageData,E=ye.format||E||e,D=ye.x||D||0,G=ye.y||G||0,Z=ye.w||ye.width||Z,ae=ye.h||ye.height||ae,de=ye.alias||de,se=ye.compression||se,Y=ye.rotation||ye.angle||Y}var re=this.internal.getFilters();if(se===void 0&&re.indexOf("FlateEncode")!==-1&&(se="SLOW"),isNaN(D)||isNaN(G))throw new Error("Invalid coordinates passed to jsPDF.addImage");l.call(this);var C=k.call(this,I,E,de,se);return p.call(this,D,G,Z,ae,C,Y),this};var k=function(I,E,D,G){var Z,ae,de;if(typeof I=="string"&&n(I)===e){I=unescape(I);var se=M(I,!1);(se!==""||(se=t.loadFile(I,!0))!==void 0)&&(I=se)}if(f(I)&&(I=m(I,E)),E=n(I,E),!d(E))throw new Error("addImage does not support files of type '"+E+"', please ensure that a plugin for '"+E+"' support is added.");if(((de=D)==null||de.length===0)&&(D=function(Y){return typeof Y=="string"||U(Y)?w(Y):U(Y.data)?w(Y.data):null}(I)),(Z=h.call(this,D))||(F()&&(I instanceof Uint8Array||E==="RGBA"||(ae=I,I=A(I))),Z=this["process"+E.toUpperCase()](I,u.call(this),D,function(Y){return Y&&typeof Y=="string"&&(Y=Y.toUpperCase()),Y in t.image_compression?Y:b.NONE}(G),ae)),!Z)throw new Error("An unknown error occurred whilst processing the image.");return Z},M=t.__addimage__.convertBase64ToBinaryString=function(I,E){E=typeof E!="boolean"||E;var D,G="";if(typeof I=="string"){var Z;D=(Z=j(I))!==null&&Z!==void 0?Z:I;try{G=lg(D)}catch(ae){if(E)throw N(D)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+ae.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return G};t.getImageProperties=function(I){var E,D,G="";if(f(I)&&(I=m(I)),typeof I=="string"&&n(I)===e&&((G=M(I,!1))===""&&(G=t.loadFile(I)||""),I=G),D=n(I),!d(D))throw new Error("addImage does not support files of type '"+D+"', please ensure that a plugin for '"+D+"' support is added.");if(!F()||I instanceof Uint8Array||(I=A(I)),!(E=this["process"+D.toUpperCase()](I)))throw new Error("An unknown error occurred whilst processing the image");return E.fileType=D,E}})(pr.API),function(t){var e=function(r){if(r!==void 0&&r!="")return!0};pr.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),t.events.push(["putPage",function(r){for(var n,s,a,i=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(r.objId),u=r.pageContext.annotations,d=!1,f=0;f<u.length&&!d;f++)switch((n=u[f]).type){case"link":(e(n.options.url)||e(n.options.pageNumber))&&(d=!0);break;case"reference":case"text":case"freetext":d=!0}if(d!=0){this.internal.write("/Annots [");for(var m=0;m<u.length;m++){n=u[m];var h=this.internal.pdfEscape,g=this.internal.getEncryptor(r.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var p=this.internal.newAdditionalObject(),v=this.internal.newAdditionalObject(),b=this.internal.getEncryptor(p.objId),w=n.title||"Note";a="<</Type /Annot /Subtype /Text "+(s="/Rect ["+i(n.bounds.x)+" "+l(n.bounds.y+n.bounds.h)+" "+i(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y)+"] ")+"/Contents ("+h(b(n.contents))+")",a+=" /Popup "+v.objId+" 0 R",a+=" /P "+c.objId+" 0 R",a+=" /T ("+h(b(w))+") >>",p.content=a;var N=p.objId+" 0 R";a="<</Type /Annot /Subtype /Popup "+(s="/Rect ["+i(n.bounds.x+30)+" "+l(n.bounds.y+n.bounds.h)+" "+i(n.bounds.x+n.bounds.w+30)+" "+l(n.bounds.y)+"] ")+" /Parent "+N,n.open&&(a+=" /Open true"),a+=" >>",v.content=a,this.internal.write(p.objId,"0 R",v.objId,"0 R");break;case"freetext":s="/Rect ["+i(n.bounds.x)+" "+l(n.bounds.y)+" "+i(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y+n.bounds.h)+"] ";var j=n.color||"#000000";a="<</Type /Annot /Subtype /FreeText "+s+"/Contents ("+h(g(n.contents))+")",a+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+j+")",a+=" /Border [0 0 0]",a+=" >>",this.internal.write(a);break;case"link":if(n.options.name){var F=this.annotations._nameMap[n.options.name];n.options.pageNumber=F.page,n.options.top=F.y}else n.options.top||(n.options.top=0);if(s="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",a="",n.options.url)a="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /A <</S /URI /URI ("+h(g(n.options.url))+") >>";else if(n.options.pageNumber)switch(a="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":a+=" /Fit]";break;case"FitH":a+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,a+=" /FitV "+n.options.left+"]";break;case"XYZ":default:var U=l(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),a+=" /XYZ "+n.options.left+" "+U+" "+n.options.zoom+"]"}a!=""&&(a+=" >>",this.internal.write(a))}}this.internal.write("]")}}]),t.createAnnotation=function(r){var n=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":n.pageContext.annotations.push(r)}},t.link=function(r,n,s,a,i){var l=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,u=this.internal.getVerticalCoordinateString;l.pageContext.annotations.push({finalBounds:{x:c(r),y:u(n),w:c(r+s),h:u(n+a)},options:i,type:"link"})},t.textWithLink=function(r,n,s,a){var i,l,c=this.getTextWidth(r),u=this.internal.getLineHeight()/this.internal.scaleFactor;if(a.maxWidth!==void 0){l=a.maxWidth;var d=this.splitTextToSize(r,l).length;i=Math.ceil(u*d)}else l=c,i=u;return this.text(r,n,s,a),s+=.2*u,a.align==="center"&&(n-=c/2),a.align==="right"&&(n-=c),this.link(n,s-u,l,i,a),c},t.getTextWidth=function(r){var n=this.internal.getFontSize();return this.getStringUnitWidth(r)*n/this.internal.scaleFactor}}(pr.API),function(t){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},s=[1570,1571,1573,1575];t.__arabicParser__={};var a=t.__arabicParser__.isInArabicSubstitutionA=function(p){return e[p.charCodeAt(0)]!==void 0},i=t.__arabicParser__.isArabicLetter=function(p){return typeof p=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(p)},l=t.__arabicParser__.isArabicEndLetter=function(p){return i(p)&&a(p)&&e[p.charCodeAt(0)].length<=2},c=t.__arabicParser__.isArabicAlfLetter=function(p){return i(p)&&s.indexOf(p.charCodeAt(0))>=0};t.__arabicParser__.arabicLetterHasIsolatedForm=function(p){return i(p)&&a(p)&&e[p.charCodeAt(0)].length>=1};var u=t.__arabicParser__.arabicLetterHasFinalForm=function(p){return i(p)&&a(p)&&e[p.charCodeAt(0)].length>=2};t.__arabicParser__.arabicLetterHasInitialForm=function(p){return i(p)&&a(p)&&e[p.charCodeAt(0)].length>=3};var d=t.__arabicParser__.arabicLetterHasMedialForm=function(p){return i(p)&&a(p)&&e[p.charCodeAt(0)].length==4},f=t.__arabicParser__.resolveLigatures=function(p){var v=0,b=r,w="",N=0;for(v=0;v<p.length;v+=1)b[p.charCodeAt(v)]!==void 0?(N++,typeof(b=b[p.charCodeAt(v)])=="number"&&(w+=String.fromCharCode(b),b=r,N=0),v===p.length-1&&(b=r,w+=p.charAt(v-(N-1)),v-=N-1,N=0)):(b=r,w+=p.charAt(v-N),v-=N,N=0);return w};t.__arabicParser__.isArabicDiacritic=function(p){return p!==void 0&&n[p.charCodeAt(0)]!==void 0};var m=t.__arabicParser__.getCorrectForm=function(p,v,b){return i(p)?a(p)===!1?-1:!u(p)||!i(v)&&!i(b)||!i(b)&&l(v)||l(p)&&!i(v)||l(p)&&c(v)||l(p)&&l(v)?0:d(p)&&i(v)&&!l(v)&&i(b)&&u(b)?3:l(p)||!i(b)?1:2:-1},h=function(p){var v=0,b=0,w=0,N="",j="",F="",U=(p=p||"").split("\\s+"),A=[];for(v=0;v<U.length;v+=1){for(A.push(""),b=0;b<U[v].length;b+=1)N=U[v][b],j=U[v][b-1],F=U[v][b+1],i(N)?(w=m(N,j,F),A[v]+=w!==-1?String.fromCharCode(e[N.charCodeAt(0)][w]):N):A[v]+=N;A[v]=f(A[v])}return A.join(" ")},g=t.__arabicParser__.processArabic=t.processArabic=function(){var p,v=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,b=[];if(Array.isArray(v)){var w=0;for(b=[],w=0;w<v.length;w+=1)Array.isArray(v[w])?b.push([h(v[w][0]),v[w][1],v[w][2]]):b.push([h(v[w])]);p=b}else p=h(v);return typeof arguments[0]=="string"?p:(arguments[0].text=p,arguments[0])};t.events.push(["preProcessText",g])}(pr.API),pr.API.autoPrint=function(t){var e;switch((t=t||{}).variant=t.variant||"non-conform",t.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})}return this},function(t){var e=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(l){r=l}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(l){n=isNaN(l)||Number.isInteger(l)===!1||l<0?150:l,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var s=300;Object.defineProperty(this,"height",{get:function(){return s},set:function(l){s=isNaN(l)||Number.isInteger(l)===!1||l<0?300:l,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=s+1)}});var a=[];Object.defineProperty(this,"childNodes",{get:function(){return a},set:function(l){a=l}});var i={};Object.defineProperty(this,"style",{get:function(){return i},set:function(l){i=l}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(r,n){var s;if((r=r||"2d")!=="2d")return null;for(s in n)this.pdf.context2d.hasOwnProperty(s)&&(this.pdf.context2d[s]=n[s]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},t.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])}(pr.API),function(t){var e={left:0,top:0,bottom:0,right:0},r=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),s.call(this))},s=function(){this.internal.__cell__.lastCell=new a,this.internal.__cell__.pages=1},a=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(p){c=p}});var u=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return u},set:function(p){u=p}});var d=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return d},set:function(p){d=p}});var f=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return f},set:function(p){f=p}});var m=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return m},set:function(p){m=p}});var h=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return h},set:function(p){h=p}});var g=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return g},set:function(p){g=p}}),this};a.prototype.clone=function(){return new a(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},a.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},t.setHeaderFunction=function(c){return n.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},t.getTextDimensions=function(c,u){n.call(this);var d=(u=u||{}).fontSize||this.getFontSize(),f=u.font||this.getFont(),m=u.scaleFactor||this.internal.scaleFactor,h=0,g=0,p=0,v=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var b=u.maxWidth;b>0?typeof c=="string"?c=this.splitTextToSize(c,b):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce(function(N,j){return N.concat(v.splitTextToSize(j,b))},[])):c=Array.isArray(c)?c:[c];for(var w=0;w<c.length;w++)h<(p=this.getStringUnitWidth(c[w],{font:f})*d)&&(h=p);return h!==0&&(g=c.length),{w:h/=m,h:Math.max((g*d*this.getLineHeightFactor()-d*(this.getLineHeightFactor()-1))/m,0)}},t.cellAddPage=function(){n.call(this),this.addPage();var c=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new a(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var i=t.cell=function(){var c;c=arguments[0]instanceof a?arguments[0]:new a(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),n.call(this);var u=this.internal.__cell__.lastCell,d=this.internal.__cell__.padding,f=this.internal.__cell__.margins||e,m=this.internal.__cell__.tableHeaderRow,h=this.internal.__cell__.printHeaders;return u.lineNumber!==void 0&&(u.lineNumber===c.lineNumber?(c.x=(u.x||0)+(u.width||0),c.y=u.y||0):u.y+u.height+c.height+f.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=f.top,h&&m&&(this.printHeaderRow(c.lineNumber,!0),c.y+=m[0].height)):c.y=u.y+u.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,r===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-d,c.y+d,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+d,{align:"center",baseline:"top",maxWidth:c.width-d-d}):this.text(c.text,c.x+d,c.y+d,{align:"left",baseline:"top",maxWidth:c.width-d-d})),this.internal.__cell__.lastCell=c,this};t.table=function(c,u,d,f,m){if(n.call(this),!d)throw new Error("No data for PDF table.");var h,g,p,v,b=[],w=[],N=[],j={},F={},U=[],A=[],S=(m=m||{}).autoSize||!1,k=m.printHeaders!==!1,M=m.css&&m.css["font-size"]!==void 0?16*m.css["font-size"]:m.fontSize||12,I=m.margins||Object.assign({width:this.getPageWidth()},e),E=typeof m.padding=="number"?m.padding:3,D=m.headerBackgroundColor||"#c8c8c8",G=m.headerTextColor||"#000";if(s.call(this),this.internal.__cell__.printHeaders=k,this.internal.__cell__.margins=I,this.internal.__cell__.table_font_size=M,this.internal.__cell__.padding=E,this.internal.__cell__.headerBackgroundColor=D,this.internal.__cell__.headerTextColor=G,this.setFontSize(M),f==null)w=b=Object.keys(d[0]),N=b.map(function(){return"left"});else if(Array.isArray(f)&&yn(f[0])==="object")for(b=f.map(function(ye){return ye.name}),w=f.map(function(ye){return ye.prompt||ye.name||""}),N=f.map(function(ye){return ye.align||"left"}),h=0;h<f.length;h+=1)F[f[h].name]=f[h].width*(19.049976/25.4);else Array.isArray(f)&&typeof f[0]=="string"&&(w=b=f,N=b.map(function(){return"left"}));if(S||Array.isArray(f)&&typeof f[0]=="string")for(h=0;h<b.length;h+=1){for(j[v=b[h]]=d.map(function(ye){return ye[v]}),this.setFont(void 0,"bold"),U.push(this.getTextDimensions(w[h],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),g=j[v],this.setFont(void 0,"normal"),p=0;p<g.length;p+=1)U.push(this.getTextDimensions(g[p],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);F[v]=Math.max.apply(null,U)+E+E,U=[]}if(k){var Z={};for(h=0;h<b.length;h+=1)Z[b[h]]={},Z[b[h]].text=w[h],Z[b[h]].align=N[h];var ae=l.call(this,Z,F);A=b.map(function(ye){return new a(c,u,F[ye],ae,Z[ye].text,void 0,Z[ye].align)}),this.setTableHeaderRow(A),this.printHeaderRow(1,!1)}var de=f.reduce(function(ye,re){return ye[re.name]=re.align,ye},{});for(h=0;h<d.length;h+=1){"rowStart"in m&&m.rowStart instanceof Function&&m.rowStart({row:h,data:d[h]},this);var se=l.call(this,d[h],F);for(p=0;p<b.length;p+=1){var Y=d[h][b[p]];"cellStart"in m&&m.cellStart instanceof Function&&m.cellStart({row:h,col:p,data:Y},this),i.call(this,new a(c,u,F[b[p]],se,Y,h+2,de[b[p]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=u,this};var l=function(c,u){var d=this.internal.__cell__.padding,f=this.internal.__cell__.table_font_size,m=this.internal.scaleFactor;return Object.keys(c).map(function(h){var g=c[h];return this.splitTextToSize(g.hasOwnProperty("text")?g.text:g,u[h]-d-d)},this).map(function(h){return this.getLineHeightFactor()*h.length*f/m+d+d},this).reduce(function(h,g){return Math.max(h,g)},0)};t.setTableHeaderRow=function(c){n.call(this),this.internal.__cell__.tableHeaderRow=c},t.printHeaderRow=function(c,u){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var d;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var f=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new a(f[0],f[1],f[2],f[3],void 0,-1)}this.setFont(void 0,"bold");for(var m=[],h=0;h<this.internal.__cell__.tableHeaderRow.length;h+=1){d=this.internal.__cell__.tableHeaderRow[h].clone(),u&&(d.y=this.internal.__cell__.margins.top||0,m.push(d)),d.lineNumber=c;var g=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),i.call(this,d),this.setTextColor(g)}m.length>0&&this.setTableHeaderRow(m),this.setFont(void 0,"normal"),r=!1}}(pr.API);var ML={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},VL=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],lN=OL(VL),BL=[100,200,300,400,500,600,700,800,900],Moe=OL(BL);function cN(t){var e=t.family.replace(/"|'/g,"").toLowerCase(),r=function(a){return ML[a=a||"normal"]?a:"normal"}(t.style),n=function(a){if(!a)return 400;if(typeof a=="number")return a>=100&&a<=900&&a%100==0?a:400;if(/^\d00$/.test(a))return parseInt(a);switch(a){case"bold":return 700;case"normal":default:return 400}}(t.weight),s=function(a){return typeof lN[a=a||"normal"]=="number"?a:"normal"}(t.stretch);return{family:e,style:r,weight:n,stretch:s,src:t.src||[],ref:t.ref||{name:e,style:[s,r,n].join(" ")}}}function Wk(t,e,r,n){var s;for(s=r;s>=0&&s<e.length;s+=n)if(t[e[s]])return t[e[s]];for(s=r;s>=0&&s<e.length;s-=n)if(t[e[s]])return t[e[s]]}var Voe={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},Hk={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function Gk(t){return[t.stretch,t.style,t.weight,t.family].join(" ")}function Boe(t,e,r){for(var n=(r=r||{}).defaultFontFamily||"times",s=Object.assign({},Voe,r.genericFontFamilies||{}),a=null,i=null,l=0;l<e.length;++l)if(s[(a=cN(e[l])).family]&&(a.family=s[a.family]),t.hasOwnProperty(a.family)){i=t[a.family];break}if(!(i=i||t[n]))throw new Error("Could not find a font-family for the rule '"+Gk(a)+"' and default family '"+n+"'.");if(i=function(c,u){if(u[c])return u[c];var d=lN[c],f=d<=lN.normal?-1:1,m=Wk(u,VL,d,f);if(!m)throw new Error("Could not find a matching font-stretch value for "+c);return m}(a.stretch,i),i=function(c,u){if(u[c])return u[c];for(var d=ML[c],f=0;f<d.length;++f)if(u[d[f]])return u[d[f]];throw new Error("Could not find a matching font-style for "+c)}(a.style,i),!(i=function(c,u){if(u[c])return u[c];if(c===400&&u[500])return u[500];if(c===500&&u[400])return u[400];var d=Moe[c],f=Wk(u,BL,d,c<400?-1:1);if(!f)throw new Error("Could not find a matching font-weight for value "+c);return f}(a.weight,i)))throw new Error("Failed to resolve a font for the rule '"+Gk(a)+"'.");return i}function Kk(t){return t.trimLeft()}function Uoe(t,e){for(var r=0;r<t.length;){if(t.charAt(r)===e)return[t.substring(0,r),t.substring(r+1)];r+=1}return null}function $oe(t){var e=t.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],t.substring(e[0].length)]}var sy,Yk,Xk,qw=["times"];(function(t){var e,r,n,s,a,i,l,c,u,d=function(C){return C=C||{},this.isStrokeTransparent=C.isStrokeTransparent||!1,this.strokeOpacity=C.strokeOpacity||1,this.strokeStyle=C.strokeStyle||"#000000",this.fillStyle=C.fillStyle||"#000000",this.isFillTransparent=C.isFillTransparent||!1,this.fillOpacity=C.fillOpacity||1,this.font=C.font||"10px sans-serif",this.textBaseline=C.textBaseline||"alphabetic",this.textAlign=C.textAlign||"left",this.lineWidth=C.lineWidth||1,this.lineJoin=C.lineJoin||"miter",this.lineCap=C.lineCap||"butt",this.path=C.path||[],this.transform=C.transform!==void 0?C.transform.clone():new c,this.globalCompositeOperation=C.globalCompositeOperation||"normal",this.globalAlpha=C.globalAlpha||1,this.clip_path=C.clip_path||[],this.currentPoint=C.currentPoint||new i,this.miterLimit=C.miterLimit||10,this.lastPoint=C.lastPoint||new i,this.lineDashOffset=C.lineDashOffset||0,this.lineDash=C.lineDash||[],this.margin=C.margin||[0,0,0,0],this.prevPageLastElemOffset=C.prevPageLastElemOffset||0,this.ignoreClearRect=typeof C.ignoreClearRect!="boolean"||C.ignoreClearRect,this};t.events.push(["initialized",function(){this.context2d=new f(this),e=this.internal.f2,r=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,s=this.internal.getHorizontalCoordinate,a=this.internal.getVerticalCoordinate,i=this.internal.Point,l=this.internal.Rectangle,c=this.internal.Matrix,u=new d}]);var f=function(C){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var O=C;Object.defineProperty(this,"pdf",{get:function(){return O}});var L=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return L},set:function(Ie){L=!!Ie}});var H=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return H},set:function(Ie){H=!!Ie}});var K=0;Object.defineProperty(this,"posX",{get:function(){return K},set:function(Ie){isNaN(Ie)||(K=Ie)}});var q=0;Object.defineProperty(this,"posY",{get:function(){return q},set:function(Ie){isNaN(Ie)||(q=Ie)}}),Object.defineProperty(this,"margin",{get:function(){return u.margin},set:function(Ie){var he;typeof Ie=="number"?he=[Ie,Ie,Ie,Ie]:((he=new Array(4))[0]=Ie[0],he[1]=Ie.length>=2?Ie[1]:he[0],he[2]=Ie.length>=3?Ie[2]:he[0],he[3]=Ie.length>=4?Ie[3]:he[1]),u.margin=he}});var te=!1;Object.defineProperty(this,"autoPaging",{get:function(){return te},set:function(Ie){te=Ie}});var oe=0;Object.defineProperty(this,"lastBreak",{get:function(){return oe},set:function(Ie){oe=Ie}});var V=[];Object.defineProperty(this,"pageBreaks",{get:function(){return V},set:function(Ie){V=Ie}}),Object.defineProperty(this,"ctx",{get:function(){return u},set:function(Ie){Ie instanceof d&&(u=Ie)}}),Object.defineProperty(this,"path",{get:function(){return u.path},set:function(Ie){u.path=Ie}});var xe=[];Object.defineProperty(this,"ctxStack",{get:function(){return xe},set:function(Ie){xe=Ie}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(Ie){var he;he=m(Ie),this.ctx.fillStyle=he.style,this.ctx.isFillTransparent=he.a===0,this.ctx.fillOpacity=he.a,this.pdf.setFillColor(he.r,he.g,he.b,{a:he.a}),this.pdf.setTextColor(he.r,he.g,he.b,{a:he.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(Ie){var he=m(Ie);this.ctx.strokeStyle=he.style,this.ctx.isStrokeTransparent=he.a===0,this.ctx.strokeOpacity=he.a,he.a===0?this.pdf.setDrawColor(255,255,255):(he.a,this.pdf.setDrawColor(he.r,he.g,he.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(Ie){["butt","round","square"].indexOf(Ie)!==-1&&(this.ctx.lineCap=Ie,this.pdf.setLineCap(Ie))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(Ie){isNaN(Ie)||(this.ctx.lineWidth=Ie,this.pdf.setLineWidth(Ie))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(Ie){["bevel","round","miter"].indexOf(Ie)!==-1&&(this.ctx.lineJoin=Ie,this.pdf.setLineJoin(Ie))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(Ie){isNaN(Ie)||(this.ctx.miterLimit=Ie,this.pdf.setMiterLimit(Ie))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(Ie){this.ctx.textBaseline=Ie}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(Ie){["right","end","center","left","start"].indexOf(Ie)!==-1&&(this.ctx.textAlign=Ie)}});var B=null;function Ee(Ie,he){if(B===null){var qe=function(ct){var lt=[];return Object.keys(ct).forEach(function(ue){ct[ue].forEach(function(Ne){var Ae=null;switch(Ne){case"bold":Ae={family:ue,weight:"bold"};break;case"italic":Ae={family:ue,style:"italic"};break;case"bolditalic":Ae={family:ue,weight:"bold",style:"italic"};break;case"":case"normal":Ae={family:ue}}Ae!==null&&(Ae.ref={name:ue,style:Ne},lt.push(Ae))})}),lt}(Ie.getFontList());B=function(ct){for(var lt={},ue=0;ue<ct.length;++ue){var Ne=cN(ct[ue]),Ae=Ne.family,Be=Ne.stretch,Ue=Ne.style,Ce=Ne.weight;lt[Ae]=lt[Ae]||{},lt[Ae][Be]=lt[Ae][Be]||{},lt[Ae][Be][Ue]=lt[Ae][Be][Ue]||{},lt[Ae][Be][Ue][Ce]=Ne}return lt}(qe.concat(he))}return B}var Me=null;Object.defineProperty(this,"fontFaces",{get:function(){return Me},set:function(Ie){B=null,Me=Ie}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(Ie){var he;if(this.ctx.font=Ie,(he=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(Ie))!==null){var qe=he[1];he[2];var ct=he[3],lt=he[4];he[5];var ue=he[6],Ne=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(lt)[2];lt=Math.floor(Ne==="px"?parseFloat(lt)*this.pdf.internal.scaleFactor:Ne==="em"?parseFloat(lt)*this.pdf.getFontSize():parseFloat(lt)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(lt);var Ae=function(Ot){var Pt,ht,or=[],Ve=Ot.trim();if(Ve==="")return qw;if(Ve in Hk)return[Hk[Ve]];for(;Ve!=="";){switch(ht=null,Pt=(Ve=Kk(Ve)).charAt(0)){case'"':case"'":ht=Uoe(Ve.substring(1),Pt);break;default:ht=$oe(Ve)}if(ht===null||(or.push(ht[0]),(Ve=Kk(ht[1]))!==""&&Ve.charAt(0)!==","))return qw;Ve=Ve.replace(/^,/,"")}return or}(ue);if(this.fontFaces){var Be=Boe(Ee(this.pdf,this.fontFaces),Ae.map(function(Ot){return{family:Ot,stretch:"normal",weight:ct,style:qe}}));this.pdf.setFont(Be.ref.name,Be.ref.style)}else{var Ue="";(ct==="bold"||parseInt(ct,10)>=700||qe==="bold")&&(Ue="bold"),qe==="italic"&&(Ue+="italic"),Ue.length===0&&(Ue="normal");for(var Ce="",Ye={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},It=0;It<Ae.length;It++){if(this.pdf.internal.getFont(Ae[It],Ue,{noFallback:!0,disableWarning:!0})!==void 0){Ce=Ae[It];break}if(Ue==="bolditalic"&&this.pdf.internal.getFont(Ae[It],"bold",{noFallback:!0,disableWarning:!0})!==void 0)Ce=Ae[It],Ue="bold";else if(this.pdf.internal.getFont(Ae[It],"normal",{noFallback:!0,disableWarning:!0})!==void 0){Ce=Ae[It],Ue="normal";break}}if(Ce===""){for(var Dt=0;Dt<Ae.length;Dt++)if(Ye[Ae[Dt]]){Ce=Ye[Ae[Dt]];break}}Ce=Ce===""?"Times":Ce,this.pdf.setFont(Ce,Ue)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(Ie){this.ctx.globalCompositeOperation=Ie}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(Ie){this.ctx.globalAlpha=Ie}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(Ie){this.ctx.lineDashOffset=Ie,re.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(Ie){this.ctx.lineDash=Ie,re.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(Ie){this.ctx.ignoreClearRect=!!Ie}})};f.prototype.setLineDash=function(C){this.lineDash=C},f.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},f.prototype.fill=function(){j.call(this,"fill",!1)},f.prototype.stroke=function(){j.call(this,"stroke",!1)},f.prototype.beginPath=function(){this.path=[{type:"begin"}]},f.prototype.moveTo=function(C,O){if(isNaN(C)||isNaN(O))throw An.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var L=this.ctx.transform.applyToPoint(new i(C,O));this.path.push({type:"mt",x:L.x,y:L.y}),this.ctx.lastPoint=new i(C,O)},f.prototype.closePath=function(){var C=new i(0,0),O=0;for(O=this.path.length-1;O!==-1;O--)if(this.path[O].type==="begin"&&yn(this.path[O+1])==="object"&&typeof this.path[O+1].x=="number"){C=new i(this.path[O+1].x,this.path[O+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new i(C.x,C.y)},f.prototype.lineTo=function(C,O){if(isNaN(C)||isNaN(O))throw An.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var L=this.ctx.transform.applyToPoint(new i(C,O));this.path.push({type:"lt",x:L.x,y:L.y}),this.ctx.lastPoint=new i(L.x,L.y)},f.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),j.call(this,null,!0)},f.prototype.quadraticCurveTo=function(C,O,L,H){if(isNaN(L)||isNaN(H)||isNaN(C)||isNaN(O))throw An.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var K=this.ctx.transform.applyToPoint(new i(L,H)),q=this.ctx.transform.applyToPoint(new i(C,O));this.path.push({type:"qct",x1:q.x,y1:q.y,x:K.x,y:K.y}),this.ctx.lastPoint=new i(K.x,K.y)},f.prototype.bezierCurveTo=function(C,O,L,H,K,q){if(isNaN(K)||isNaN(q)||isNaN(C)||isNaN(O)||isNaN(L)||isNaN(H))throw An.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var te=this.ctx.transform.applyToPoint(new i(K,q)),oe=this.ctx.transform.applyToPoint(new i(C,O)),V=this.ctx.transform.applyToPoint(new i(L,H));this.path.push({type:"bct",x1:oe.x,y1:oe.y,x2:V.x,y2:V.y,x:te.x,y:te.y}),this.ctx.lastPoint=new i(te.x,te.y)},f.prototype.arc=function(C,O,L,H,K,q){if(isNaN(C)||isNaN(O)||isNaN(L)||isNaN(H)||isNaN(K))throw An.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(q=!!q,!this.ctx.transform.isIdentity){var te=this.ctx.transform.applyToPoint(new i(C,O));C=te.x,O=te.y;var oe=this.ctx.transform.applyToPoint(new i(0,L)),V=this.ctx.transform.applyToPoint(new i(0,0));L=Math.sqrt(Math.pow(oe.x-V.x,2)+Math.pow(oe.y-V.y,2))}Math.abs(K-H)>=2*Math.PI&&(H=0,K=2*Math.PI),this.path.push({type:"arc",x:C,y:O,radius:L,startAngle:H,endAngle:K,counterclockwise:q})},f.prototype.arcTo=function(C,O,L,H,K){throw new Error("arcTo not implemented.")},f.prototype.rect=function(C,O,L,H){if(isNaN(C)||isNaN(O)||isNaN(L)||isNaN(H))throw An.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(C,O),this.lineTo(C+L,O),this.lineTo(C+L,O+H),this.lineTo(C,O+H),this.lineTo(C,O),this.lineTo(C+L,O),this.lineTo(C,O)},f.prototype.fillRect=function(C,O,L,H){if(isNaN(C)||isNaN(O)||isNaN(L)||isNaN(H))throw An.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!h.call(this)){var K={};this.lineCap!=="butt"&&(K.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(K.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(C,O,L,H),this.fill(),K.hasOwnProperty("lineCap")&&(this.lineCap=K.lineCap),K.hasOwnProperty("lineJoin")&&(this.lineJoin=K.lineJoin)}},f.prototype.strokeRect=function(C,O,L,H){if(isNaN(C)||isNaN(O)||isNaN(L)||isNaN(H))throw An.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");g.call(this)||(this.beginPath(),this.rect(C,O,L,H),this.stroke())},f.prototype.clearRect=function(C,O,L,H){if(isNaN(C)||isNaN(O)||isNaN(L)||isNaN(H))throw An.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(C,O,L,H))},f.prototype.save=function(C){C=typeof C!="boolean"||C;for(var O=this.pdf.internal.getCurrentPageInfo().pageNumber,L=0;L<this.pdf.internal.getNumberOfPages();L++)this.pdf.setPage(L+1),this.pdf.internal.out("q");if(this.pdf.setPage(O),C){this.ctx.fontSize=this.pdf.internal.getFontSize();var H=new d(this.ctx);this.ctxStack.push(this.ctx),this.ctx=H}},f.prototype.restore=function(C){C=typeof C!="boolean"||C;for(var O=this.pdf.internal.getCurrentPageInfo().pageNumber,L=0;L<this.pdf.internal.getNumberOfPages();L++)this.pdf.setPage(L+1),this.pdf.internal.out("Q");this.pdf.setPage(O),C&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},f.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var m=function(C){var O,L,H,K;if(C.isCanvasGradient===!0&&(C=C.getColor()),!C)return{r:0,g:0,b:0,a:0,style:C};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(C))O=0,L=0,H=0,K=0;else{var q=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(C);if(q!==null)O=parseInt(q[1]),L=parseInt(q[2]),H=parseInt(q[3]),K=1;else if((q=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(C))!==null)O=parseInt(q[1]),L=parseInt(q[2]),H=parseInt(q[3]),K=parseFloat(q[4]);else{if(K=1,typeof C=="string"&&C.charAt(0)!=="#"){var te=new jL(C);C=te.ok?te.toHex():"#000000"}C.length===4?(O=C.substring(1,2),O+=O,L=C.substring(2,3),L+=L,H=C.substring(3,4),H+=H):(O=C.substring(1,3),L=C.substring(3,5),H=C.substring(5,7)),O=parseInt(O,16),L=parseInt(L,16),H=parseInt(H,16)}}return{r:O,g:L,b:H,a:K,style:C}},h=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},g=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};f.prototype.fillText=function(C,O,L,H){if(isNaN(O)||isNaN(L)||typeof C!="string")throw An.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(H=isNaN(H)?void 0:H,!h.call(this)){var K=se(this.ctx.transform.rotation),q=this.ctx.transform.scaleX;E.call(this,{text:C,x:O,y:L,scale:q,angle:K,align:this.textAlign,maxWidth:H})}},f.prototype.strokeText=function(C,O,L,H){if(isNaN(O)||isNaN(L)||typeof C!="string")throw An.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!g.call(this)){H=isNaN(H)?void 0:H;var K=se(this.ctx.transform.rotation),q=this.ctx.transform.scaleX;E.call(this,{text:C,x:O,y:L,scale:q,renderingMode:"stroke",angle:K,align:this.textAlign,maxWidth:H})}},f.prototype.measureText=function(C){if(typeof C!="string")throw An.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var O=this.pdf,L=this.pdf.internal.scaleFactor,H=O.internal.getFontSize(),K=O.getStringUnitWidth(C)*H/O.internal.scaleFactor,q=function(te){var oe=(te=te||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return oe}}),this};return new q({width:K*=Math.round(96*L/72*1e4)/1e4})},f.prototype.scale=function(C,O){if(isNaN(C)||isNaN(O))throw An.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var L=new c(C,0,0,O,0,0);this.ctx.transform=this.ctx.transform.multiply(L)},f.prototype.rotate=function(C){if(isNaN(C))throw An.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var O=new c(Math.cos(C),Math.sin(C),-Math.sin(C),Math.cos(C),0,0);this.ctx.transform=this.ctx.transform.multiply(O)},f.prototype.translate=function(C,O){if(isNaN(C)||isNaN(O))throw An.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var L=new c(1,0,0,1,C,O);this.ctx.transform=this.ctx.transform.multiply(L)},f.prototype.transform=function(C,O,L,H,K,q){if(isNaN(C)||isNaN(O)||isNaN(L)||isNaN(H)||isNaN(K)||isNaN(q))throw An.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var te=new c(C,O,L,H,K,q);this.ctx.transform=this.ctx.transform.multiply(te)},f.prototype.setTransform=function(C,O,L,H,K,q){C=isNaN(C)?1:C,O=isNaN(O)?0:O,L=isNaN(L)?0:L,H=isNaN(H)?1:H,K=isNaN(K)?0:K,q=isNaN(q)?0:q,this.ctx.transform=new c(C,O,L,H,K,q)};var p=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};f.prototype.drawImage=function(C,O,L,H,K,q,te,oe,V){var xe=this.pdf.getImageProperties(C),B=1,Ee=1,Me=1,Ie=1;H!==void 0&&oe!==void 0&&(Me=oe/H,Ie=V/K,B=xe.width/H*oe/H,Ee=xe.height/K*V/K),q===void 0&&(q=O,te=L,O=0,L=0),H!==void 0&&oe===void 0&&(oe=H,V=K),H===void 0&&oe===void 0&&(oe=xe.width,V=xe.height);for(var he,qe=this.ctx.transform.decompose(),ct=se(qe.rotate.shx),lt=new c,ue=(lt=(lt=(lt=lt.multiply(qe.translate)).multiply(qe.skew)).multiply(qe.scale)).applyToRectangle(new l(q-O*Me,te-L*Ie,H*B,K*Ee)),Ne=v.call(this,ue),Ae=[],Be=0;Be<Ne.length;Be+=1)Ae.indexOf(Ne[Be])===-1&&Ae.push(Ne[Be]);if(N(Ae),this.autoPaging)for(var Ue=Ae[0],Ce=Ae[Ae.length-1],Ye=Ue;Ye<Ce+1;Ye++){this.pdf.setPage(Ye);var It=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Dt=Ye===1?this.posY+this.margin[0]:this.margin[0],Ot=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Pt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],ht=Ye===1?0:Ot+(Ye-2)*Pt;if(this.ctx.clip_path.length!==0){var or=this.path;he=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=w(he,this.posX+this.margin[3],-ht+Dt+this.ctx.prevPageLastElemOffset),F.call(this,"fill",!0),this.path=or}var Ve=JSON.parse(JSON.stringify(ue));Ve=w([Ve],this.posX+this.margin[3],-ht+Dt+this.ctx.prevPageLastElemOffset)[0];var tt=(Ye>Ue||Ye<Ce)&&p.call(this);tt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],It,Pt,null).clip().discardPath()),this.pdf.addImage(C,"JPEG",Ve.x,Ve.y,Ve.w,Ve.h,null,null,ct),tt&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(C,"JPEG",ue.x,ue.y,ue.w,ue.h,null,null,ct)};var v=function(C,O,L){var H=[];O=O||this.pdf.internal.pageSize.width,L=L||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var K=this.posY+this.ctx.prevPageLastElemOffset;switch(C.type){default:case"mt":case"lt":H.push(Math.floor((C.y+K)/L)+1);break;case"arc":H.push(Math.floor((C.y+K-C.radius)/L)+1),H.push(Math.floor((C.y+K+C.radius)/L)+1);break;case"qct":var q=Y(this.ctx.lastPoint.x,this.ctx.lastPoint.y,C.x1,C.y1,C.x,C.y);H.push(Math.floor((q.y+K)/L)+1),H.push(Math.floor((q.y+q.h+K)/L)+1);break;case"bct":var te=ye(this.ctx.lastPoint.x,this.ctx.lastPoint.y,C.x1,C.y1,C.x2,C.y2,C.x,C.y);H.push(Math.floor((te.y+K)/L)+1),H.push(Math.floor((te.y+te.h+K)/L)+1);break;case"rect":H.push(Math.floor((C.y+K)/L)+1),H.push(Math.floor((C.y+C.h+K)/L)+1)}for(var oe=0;oe<H.length;oe+=1)for(;this.pdf.internal.getNumberOfPages()<H[oe];)b.call(this);return H},b=function(){var C=this.fillStyle,O=this.strokeStyle,L=this.font,H=this.lineCap,K=this.lineWidth,q=this.lineJoin;this.pdf.addPage(),this.fillStyle=C,this.strokeStyle=O,this.font=L,this.lineCap=H,this.lineWidth=K,this.lineJoin=q},w=function(C,O,L){for(var H=0;H<C.length;H++)switch(C[H].type){case"bct":C[H].x2+=O,C[H].y2+=L;case"qct":C[H].x1+=O,C[H].y1+=L;case"mt":case"lt":case"arc":default:C[H].x+=O,C[H].y+=L}return C},N=function(C){return C.sort(function(O,L){return O-L})},j=function(C,O){for(var L,H,K=this.fillStyle,q=this.strokeStyle,te=this.lineCap,oe=this.lineWidth,V=Math.abs(oe*this.ctx.transform.scaleX),xe=this.lineJoin,B=JSON.parse(JSON.stringify(this.path)),Ee=JSON.parse(JSON.stringify(this.path)),Me=[],Ie=0;Ie<Ee.length;Ie++)if(Ee[Ie].x!==void 0)for(var he=v.call(this,Ee[Ie]),qe=0;qe<he.length;qe+=1)Me.indexOf(he[qe])===-1&&Me.push(he[qe]);for(var ct=0;ct<Me.length;ct++)for(;this.pdf.internal.getNumberOfPages()<Me[ct];)b.call(this);if(N(Me),this.autoPaging)for(var lt=Me[0],ue=Me[Me.length-1],Ne=lt;Ne<ue+1;Ne++){this.pdf.setPage(Ne),this.fillStyle=K,this.strokeStyle=q,this.lineCap=te,this.lineWidth=V,this.lineJoin=xe;var Ae=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Be=Ne===1?this.posY+this.margin[0]:this.margin[0],Ue=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Ce=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Ye=Ne===1?0:Ue+(Ne-2)*Ce;if(this.ctx.clip_path.length!==0){var It=this.path;L=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=w(L,this.posX+this.margin[3],-Ye+Be+this.ctx.prevPageLastElemOffset),F.call(this,C,!0),this.path=It}if(H=JSON.parse(JSON.stringify(B)),this.path=w(H,this.posX+this.margin[3],-Ye+Be+this.ctx.prevPageLastElemOffset),O===!1||Ne===0){var Dt=(Ne>lt||Ne<ue)&&p.call(this);Dt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ae,Ce,null).clip().discardPath()),F.call(this,C,O),Dt&&this.pdf.restoreGraphicsState()}this.lineWidth=oe}else this.lineWidth=V,F.call(this,C,O),this.lineWidth=oe;this.path=B},F=function(C,O){if((C!=="stroke"||O||!g.call(this))&&(C==="stroke"||O||!h.call(this))){for(var L,H,K=[],q=this.path,te=0;te<q.length;te++){var oe=q[te];switch(oe.type){case"begin":K.push({begin:!0});break;case"close":K.push({close:!0});break;case"mt":K.push({start:oe,deltas:[],abs:[]});break;case"lt":var V=K.length;if(q[te-1]&&!isNaN(q[te-1].x)&&(L=[oe.x-q[te-1].x,oe.y-q[te-1].y],V>0)){for(;V>=0;V--)if(K[V-1].close!==!0&&K[V-1].begin!==!0){K[V-1].deltas.push(L),K[V-1].abs.push(oe);break}}break;case"bct":L=[oe.x1-q[te-1].x,oe.y1-q[te-1].y,oe.x2-q[te-1].x,oe.y2-q[te-1].y,oe.x-q[te-1].x,oe.y-q[te-1].y],K[K.length-1].deltas.push(L);break;case"qct":var xe=q[te-1].x+2/3*(oe.x1-q[te-1].x),B=q[te-1].y+2/3*(oe.y1-q[te-1].y),Ee=oe.x+2/3*(oe.x1-oe.x),Me=oe.y+2/3*(oe.y1-oe.y),Ie=oe.x,he=oe.y;L=[xe-q[te-1].x,B-q[te-1].y,Ee-q[te-1].x,Me-q[te-1].y,Ie-q[te-1].x,he-q[te-1].y],K[K.length-1].deltas.push(L);break;case"arc":K.push({deltas:[],abs:[],arc:!0}),Array.isArray(K[K.length-1].abs)&&K[K.length-1].abs.push(oe)}}H=O?null:C==="stroke"?"stroke":"fill";for(var qe=!1,ct=0;ct<K.length;ct++)if(K[ct].arc)for(var lt=K[ct].abs,ue=0;ue<lt.length;ue++){var Ne=lt[ue];Ne.type==="arc"?S.call(this,Ne.x,Ne.y,Ne.radius,Ne.startAngle,Ne.endAngle,Ne.counterclockwise,void 0,O,!qe):D.call(this,Ne.x,Ne.y),qe=!0}else if(K[ct].close===!0)this.pdf.internal.out("h"),qe=!1;else if(K[ct].begin!==!0){var Ae=K[ct].start.x,Be=K[ct].start.y;G.call(this,K[ct].deltas,Ae,Be),qe=!0}H&&k.call(this,H),O&&M.call(this)}},U=function(C){var O=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,L=O*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return C-L;case"top":return C+O-L;case"hanging":return C+O-2*L;case"middle":return C+O/2-L;case"ideographic":return C;case"alphabetic":default:return C}},A=function(C){return C+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};f.prototype.createLinearGradient=function(){var C=function(){};return C.colorStops=[],C.addColorStop=function(O,L){this.colorStops.push([O,L])},C.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},C.isCanvasGradient=!0,C},f.prototype.createPattern=function(){return this.createLinearGradient()},f.prototype.createRadialGradient=function(){return this.createLinearGradient()};var S=function(C,O,L,H,K,q,te,oe,V){for(var xe=ae.call(this,L,H,K,q),B=0;B<xe.length;B++){var Ee=xe[B];B===0&&(V?I.call(this,Ee.x1+C,Ee.y1+O):D.call(this,Ee.x1+C,Ee.y1+O)),Z.call(this,C,O,Ee.x2,Ee.y2,Ee.x3,Ee.y3,Ee.x4,Ee.y4)}oe?M.call(this):k.call(this,te)},k=function(C){switch(C){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},M=function(){this.pdf.clip(),this.pdf.discardPath()},I=function(C,O){this.pdf.internal.out(r(C)+" "+n(O)+" m")},E=function(C){var O;switch(C.align){case"right":case"end":O="right";break;case"center":O="center";break;case"left":case"start":default:O="left"}var L=this.pdf.getTextDimensions(C.text),H=U.call(this,C.y),K=A.call(this,H)-L.h,q=this.ctx.transform.applyToPoint(new i(C.x,H)),te=this.ctx.transform.decompose(),oe=new c;oe=(oe=(oe=oe.multiply(te.translate)).multiply(te.skew)).multiply(te.scale);for(var V,xe,B,Ee=this.ctx.transform.applyToRectangle(new l(C.x,H,L.w,L.h)),Me=oe.applyToRectangle(new l(C.x,K,L.w,L.h)),Ie=v.call(this,Me),he=[],qe=0;qe<Ie.length;qe+=1)he.indexOf(Ie[qe])===-1&&he.push(Ie[qe]);if(N(he),this.autoPaging)for(var ct=he[0],lt=he[he.length-1],ue=ct;ue<lt+1;ue++){this.pdf.setPage(ue);var Ne=ue===1?this.posY+this.margin[0]:this.margin[0],Ae=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Be=this.pdf.internal.pageSize.height-this.margin[2],Ue=Be-this.margin[0],Ce=this.pdf.internal.pageSize.width-this.margin[1],Ye=Ce-this.margin[3],It=ue===1?0:Ae+(ue-2)*Ue;if(this.ctx.clip_path.length!==0){var Dt=this.path;V=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=w(V,this.posX+this.margin[3],-1*It+Ne),F.call(this,"fill",!0),this.path=Dt}var Ot=w([JSON.parse(JSON.stringify(Me))],this.posX+this.margin[3],-It+Ne+this.ctx.prevPageLastElemOffset)[0];C.scale>=.01&&(xe=this.pdf.internal.getFontSize(),this.pdf.setFontSize(xe*C.scale),B=this.lineWidth,this.lineWidth=B*C.scale);var Pt=this.autoPaging!=="text";if(Pt||Ot.y+Ot.h<=Be){if(Pt||Ot.y>=Ne&&Ot.x<=Ce){var ht=Pt?C.text:this.pdf.splitTextToSize(C.text,C.maxWidth||Ce-Ot.x)[0],or=w([JSON.parse(JSON.stringify(Ee))],this.posX+this.margin[3],-It+Ne+this.ctx.prevPageLastElemOffset)[0],Ve=Pt&&(ue>ct||ue<lt)&&p.call(this);Ve&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ye,Ue,null).clip().discardPath()),this.pdf.text(ht,or.x,or.y,{angle:C.angle,align:O,renderingMode:C.renderingMode}),Ve&&this.pdf.restoreGraphicsState()}}else Ot.y<Be&&(this.ctx.prevPageLastElemOffset+=Be-Ot.y);C.scale>=.01&&(this.pdf.setFontSize(xe),this.lineWidth=B)}else C.scale>=.01&&(xe=this.pdf.internal.getFontSize(),this.pdf.setFontSize(xe*C.scale),B=this.lineWidth,this.lineWidth=B*C.scale),this.pdf.text(C.text,q.x+this.posX,q.y+this.posY,{angle:C.angle,align:O,renderingMode:C.renderingMode,maxWidth:C.maxWidth}),C.scale>=.01&&(this.pdf.setFontSize(xe),this.lineWidth=B)},D=function(C,O,L,H){L=L||0,H=H||0,this.pdf.internal.out(r(C+L)+" "+n(O+H)+" l")},G=function(C,O,L){return this.pdf.lines(C,O,L,null,null)},Z=function(C,O,L,H,K,q,te,oe){this.pdf.internal.out([e(s(L+C)),e(a(H+O)),e(s(K+C)),e(a(q+O)),e(s(te+C)),e(a(oe+O)),"c"].join(" "))},ae=function(C,O,L,H){for(var K=2*Math.PI,q=Math.PI/2;O>L;)O-=K;var te=Math.abs(L-O);te<K&&H&&(te=K-te);for(var oe=[],V=H?-1:1,xe=O;te>1e-5;){var B=xe+V*Math.min(te,q);oe.push(de.call(this,C,xe,B)),te-=Math.abs(B-xe),xe=B}return oe},de=function(C,O,L){var H=(L-O)/2,K=C*Math.cos(H),q=C*Math.sin(H),te=K,oe=-q,V=te*te+oe*oe,xe=V+te*K+oe*q,B=4/3*(Math.sqrt(2*V*xe)-xe)/(te*q-oe*K),Ee=te-B*oe,Me=oe+B*te,Ie=Ee,he=-Me,qe=H+O,ct=Math.cos(qe),lt=Math.sin(qe);return{x1:C*Math.cos(O),y1:C*Math.sin(O),x2:Ee*ct-Me*lt,y2:Ee*lt+Me*ct,x3:Ie*ct-he*lt,y3:Ie*lt+he*ct,x4:C*Math.cos(L),y4:C*Math.sin(L)}},se=function(C){return 180*C/Math.PI},Y=function(C,O,L,H,K,q){var te=C+.5*(L-C),oe=O+.5*(H-O),V=K+.5*(L-K),xe=q+.5*(H-q),B=Math.min(C,K,te,V),Ee=Math.max(C,K,te,V),Me=Math.min(O,q,oe,xe),Ie=Math.max(O,q,oe,xe);return new l(B,Me,Ee-B,Ie-Me)},ye=function(C,O,L,H,K,q,te,oe){var V,xe,B,Ee,Me,Ie,he,qe,ct,lt,ue,Ne,Ae,Be,Ue=L-C,Ce=H-O,Ye=K-L,It=q-H,Dt=te-K,Ot=oe-q;for(xe=0;xe<41;xe++)ct=(he=(B=C+(V=xe/40)*Ue)+V*((Me=L+V*Ye)-B))+V*(Me+V*(K+V*Dt-Me)-he),lt=(qe=(Ee=O+V*Ce)+V*((Ie=H+V*It)-Ee))+V*(Ie+V*(q+V*Ot-Ie)-qe),xe==0?(ue=ct,Ne=lt,Ae=ct,Be=lt):(ue=Math.min(ue,ct),Ne=Math.min(Ne,lt),Ae=Math.max(Ae,ct),Be=Math.max(Be,lt));return new l(Math.round(ue),Math.round(Ne),Math.round(Ae-ue),Math.round(Be-Ne))},re=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var C,O,L=(C=this.ctx.lineDash,O=this.ctx.lineDashOffset,JSON.stringify({lineDash:C,lineDashOffset:O}));this.prevLineDash!==L&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=L)}}})(pr.API),function(t){var e=function(a){var i,l,c,u,d,f,m,h,g,p;for(l=[],c=0,u=(a+=i="\0\0\0\0".slice(a.length%4||4)).length;u>c;c+=4)(d=(a.charCodeAt(c)<<24)+(a.charCodeAt(c+1)<<16)+(a.charCodeAt(c+2)<<8)+a.charCodeAt(c+3))!==0?(f=(d=((d=((d=((d=(d-(p=d%85))/85)-(g=d%85))/85)-(h=d%85))/85)-(m=d%85))/85)%85,l.push(f+33,m+33,h+33,g+33,p+33)):l.push(122);return function(v,b){for(var w=b;w>0;w--)v.pop()}(l,i.length),String.fromCharCode.apply(String,l)+"~>"},r=function(a){var i,l,c,u,d,f=String,m="length",h=255,g="charCodeAt",p="slice",v="replace";for(a[p](-2),a=a[p](0,-2)[v](/\s/g,"")[v]("z","!!!!!"),c=[],u=0,d=(a+=i="uuuuu"[p](a[m]%5||5))[m];d>u;u+=5)l=52200625*(a[g](u)-33)+614125*(a[g](u+1)-33)+7225*(a[g](u+2)-33)+85*(a[g](u+3)-33)+(a[g](u+4)-33),c.push(h&l>>24,h&l>>16,h&l>>8,h&l);return function(b,w){for(var N=w;N>0;N--)b.pop()}(c,i[m]),f.fromCharCode.apply(f,c)},n=function(a){var i=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((a=a.replace(/\s/g,"")).indexOf(">")!==-1&&(a=a.substr(0,a.indexOf(">"))),a.length%2&&(a+="0"),i.test(a)===!1)return"";for(var l="",c=0;c<a.length;c+=2)l+=String.fromCharCode("0x"+(a[c]+a[c+1]));return l},s=function(a){for(var i=new Uint8Array(a.length),l=a.length;l--;)i[l]=a.charCodeAt(l);return a=(i=nN(i)).reduce(function(c,u){return c+String.fromCharCode(u)},"")};t.processDataByFilters=function(a,i){var l=0,c=a||"",u=[];for(typeof(i=i||[])=="string"&&(i=[i]),l=0;l<i.length;l+=1)switch(i[l]){case"ASCII85Decode":case"/ASCII85Decode":c=r(c),u.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":c=e(c),u.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":c=n(c),u.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":c=c.split("").map(function(d){return("0"+d.charCodeAt().toString(16)).slice(-2)}).join("")+">",u.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":c=s(c),u.push("/FlateDecode");break;default:throw new Error('The filter: "'+i[l]+'" is not implemented')}return{data:c,reverseChain:u.reverse().join(" ")}}}(pr.API),function(t){t.loadFile=function(e,r,n){return function(s,a,i){a=a!==!1,i=typeof i=="function"?i:function(){};var l=void 0;try{l=function(c,u,d){var f=new XMLHttpRequest,m=0,h=function(g){var p=g.length,v=[],b=String.fromCharCode;for(m=0;m<p;m+=1)v.push(b(255&g.charCodeAt(m)));return v.join("")};if(f.open("GET",c,!u),f.overrideMimeType("text/plain; charset=x-user-defined"),u===!1&&(f.onload=function(){f.status===200?d(h(this.responseText)):d(void 0)}),f.send(null),u&&f.status===200)return h(f.responseText)}(s,a,i)}catch{}return l}(e,r,n)},t.loadImageFile=t.loadFile}(pr.API),function(t){function e(){return(yr.html2canvas?Promise.resolve(yr.html2canvas):Bi(()=>import("./html2canvas.esm-CBrSDip1.js"),[])).catch(function(i){return Promise.reject(new Error("Could not load html2canvas: "+i))}).then(function(i){return i.default?i.default:i})}function r(){return(yr.DOMPurify?Promise.resolve(yr.DOMPurify):Bi(()=>import("./purify.es-CQJ0hv7W.js"),[])).catch(function(i){return Promise.reject(new Error("Could not load dompurify: "+i))}).then(function(i){return i.default?i.default:i})}var n=function(i){var l=yn(i);return l==="undefined"?"undefined":l==="string"||i instanceof String?"string":l==="number"||i instanceof Number?"number":l==="function"||i instanceof Function?"function":i&&i.constructor===Array?"array":i&&i.nodeType===1?"element":l==="object"?"object":"unknown"},s=function(i,l){var c=document.createElement(i);for(var u in l.className&&(c.className=l.className),l.innerHTML&&l.dompurify&&(c.innerHTML=l.dompurify.sanitize(l.innerHTML)),l.style)c.style[u]=l.style[u];return c},a=function i(l){var c=Object.assign(i.convert(Promise.resolve()),JSON.parse(JSON.stringify(i.template))),u=i.convert(Promise.resolve(),c);return u=(u=u.setProgress(1,i,1,[i])).set(l)};(a.prototype=Object.create(Promise.prototype)).constructor=a,a.convert=function(i,l){return i.__proto__=l||a.prototype,i},a.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},a.prototype.from=function(i,l){return this.then(function(){switch(l=l||function(c){switch(n(c)){case"string":return"string";case"element":return c.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(i)){case"string":return this.then(r).then(function(c){return this.set({src:s("div",{innerHTML:i,dompurify:c})})});case"element":return this.set({src:i});case"canvas":return this.set({canvas:i});case"img":return this.set({img:i});default:return this.error("Unknown source type.")}})},a.prototype.to=function(i){switch(i){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},a.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var i={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},l=function c(u,d){for(var f=u.nodeType===3?document.createTextNode(u.nodeValue):u.cloneNode(!1),m=u.firstChild;m;m=m.nextSibling)d!==!0&&m.nodeType===1&&m.nodeName==="SCRIPT"||f.appendChild(c(m,d));return u.nodeType===1&&(u.nodeName==="CANVAS"?(f.width=u.width,f.height=u.height,f.getContext("2d").drawImage(u,0,0)):u.nodeName!=="TEXTAREA"&&u.nodeName!=="SELECT"||(f.value=u.value),f.addEventListener("load",function(){f.scrollTop=u.scrollTop,f.scrollLeft=u.scrollLeft},!0)),f}(this.prop.src,this.opt.html2canvas.javascriptEnabled);l.tagName==="BODY"&&(i.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=s("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=s("div",{className:"html2pdf__container",style:i}),this.prop.container.appendChild(l),this.prop.container.firstChild.appendChild(s("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},a.prototype.toCanvas=function(){var i=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(i).then(e).then(function(l){var c=Object.assign({},this.opt.html2canvas);return delete c.onrendered,l(this.prop.container,c)}).then(function(l){(this.opt.html2canvas.onrendered||function(){})(l),this.prop.canvas=l,document.body.removeChild(this.prop.overlay)})},a.prototype.toContext2d=function(){var i=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(i).then(e).then(function(l){var c=this.opt.jsPDF,u=this.opt.fontFaces,d=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,f=Object.assign({async:!0,allowTaint:!0,scale:d,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete f.onrendered,c.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,c.context2d.posX=this.opt.x,c.context2d.posY=this.opt.y,c.context2d.margin=this.opt.margin,c.context2d.fontFaces=u,u)for(var m=0;m<u.length;++m){var h=u[m],g=h.src.find(function(p){return p.format==="truetype"});g&&c.addFont(g.url,h.ref.name,h.ref.style)}return f.windowHeight=f.windowHeight||0,f.windowHeight=f.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):f.windowHeight,c.context2d.save(!0),l(this.prop.container,f)}).then(function(l){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(l),this.prop.canvas=l,document.body.removeChild(this.prop.overlay)})},a.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var i=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=i})},a.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},a.prototype.output=function(i,l,c){return(c=c||"pdf").toLowerCase()==="img"||c.toLowerCase()==="image"?this.outputImg(i,l):this.outputPdf(i,l)},a.prototype.outputPdf=function(i,l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(i,l)})},a.prototype.outputImg=function(i){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(i){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+i+'" is not supported.'}})},a.prototype.save=function(i){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(i?{filename:i}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},a.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},a.prototype.set=function(i){if(n(i)!=="object")return this;var l=Object.keys(i||{}).map(function(c){if(c in a.template.prop)return function(){this.prop[c]=i[c]};switch(c){case"margin":return this.setMargin.bind(this,i.margin);case"jsPDF":return function(){return this.opt.jsPDF=i.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,i.pageSize);default:return function(){this.opt[c]=i[c]}}},this);return this.then(function(){return this.thenList(l)})},a.prototype.get=function(i,l){return this.then(function(){var c=i in a.template.prop?this.prop[i]:this.opt[i];return l?l(c):c})},a.prototype.setMargin=function(i){return this.then(function(){switch(n(i)){case"number":i=[i,i,i,i];case"array":if(i.length===2&&(i=[i[0],i[1],i[0],i[1]]),i.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=i}).then(this.setPageSize)},a.prototype.setPageSize=function(i){function l(c,u){return Math.floor(c*u/72*96)}return this.then(function(){(i=i||pr.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(i.inner={width:i.width-this.opt.margin[1]-this.opt.margin[3],height:i.height-this.opt.margin[0]-this.opt.margin[2]},i.inner.px={width:l(i.inner.width,i.k),height:l(i.inner.height,i.k)},i.inner.ratio=i.inner.height/i.inner.width),this.prop.pageSize=i})},a.prototype.setProgress=function(i,l,c,u){return i!=null&&(this.progress.val=i),l!=null&&(this.progress.state=l),c!=null&&(this.progress.n=c),u!=null&&(this.progress.stack=u),this.progress.ratio=this.progress.val/this.progress.state,this},a.prototype.updateProgress=function(i,l,c,u){return this.setProgress(i?this.progress.val+i:null,l||null,c?this.progress.n+c:null,u?this.progress.stack.concat(u):null)},a.prototype.then=function(i,l){var c=this;return this.thenCore(i,l,function(u,d){return c.updateProgress(null,null,1,[u]),Promise.prototype.then.call(this,function(f){return c.updateProgress(null,u),f}).then(u,d).then(function(f){return c.updateProgress(1),f})})},a.prototype.thenCore=function(i,l,c){c=c||Promise.prototype.then,i&&(i=i.bind(this)),l&&(l=l.bind(this));var u=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:a.convert(Object.assign({},this),Promise.prototype),d=c.call(u,i,l);return a.convert(d,this.__proto__)},a.prototype.thenExternal=function(i,l){return Promise.prototype.then.call(this,i,l)},a.prototype.thenList=function(i){var l=this;return i.forEach(function(c){l=l.thenCore(c)}),l},a.prototype.catch=function(i){i&&(i=i.bind(this));var l=Promise.prototype.catch.call(this,i);return a.convert(l,this)},a.prototype.catchExternal=function(i){return Promise.prototype.catch.call(this,i)},a.prototype.error=function(i){return this.then(function(){throw new Error(i)})},a.prototype.using=a.prototype.set,a.prototype.saveAs=a.prototype.save,a.prototype.export=a.prototype.output,a.prototype.run=a.prototype.then,pr.getPageSize=function(i,l,c){if(yn(i)==="object"){var u=i;i=u.orientation,l=u.unit||l,c=u.format||c}l=l||"mm",c=c||"a4",i=(""+(i||"P")).toLowerCase();var d,f=(""+c).toLowerCase(),m={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(l){case"pt":d=1;break;case"mm":d=72/25.4;break;case"cm":d=72/2.54;break;case"in":d=72;break;case"px":d=.75;break;case"pc":case"em":d=12;break;case"ex":d=6;break;default:throw"Invalid unit: "+l}var h,g=0,p=0;if(m.hasOwnProperty(f))g=m[f][1]/d,p=m[f][0]/d;else try{g=c[1],p=c[0]}catch{throw new Error("Invalid format: "+c)}if(i==="p"||i==="portrait")i="p",p>g&&(h=p,p=g,g=h);else{if(i!=="l"&&i!=="landscape")throw"Invalid orientation: "+i;i="l",g>p&&(h=p,p=g,g=h)}return{width:p,height:g,unit:l,k:d,orientation:i}},t.html=function(i,l){(l=l||{}).callback=l.callback||function(){},l.html2canvas=l.html2canvas||{},l.html2canvas.canvas=l.html2canvas.canvas||this.canvas,l.jsPDF=l.jsPDF||this,l.fontFaces=l.fontFaces?l.fontFaces.map(cN):null;var c=new a(l);return l.worker?c:c.from(i).doCallback()}}(pr.API),pr.API.addJS=function(t){return Xk=t,this.internal.events.subscribe("postPutResources",function(){sy=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(sy+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),Yk=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+Xk+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){sy!==void 0&&Yk!==void 0&&this.internal.out("/Names <</JavaScript "+sy+" 0 R>>")}),this},function(t){var e;t.events.push(["postPutResources",function(){var r=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var s=r.outline.render().split(/\r\n/),a=0;a<s.length;a++){var i=s[a],l=n.exec(i);if(l!=null){var c=l[1];r.internal.newObjectDeferredBegin(c,!1)}r.internal.write(i)}if(this.outline.createNamedDestinations){var u=this.internal.pages.length,d=[];for(a=0;a<u;a++){var f=r.internal.newObject();d.push(f);var m=r.internal.getPageInfo(a+1);r.internal.write("<< /D["+m.objId+" 0 R /XYZ null null null]>> endobj")}var h=r.internal.newObject();for(r.internal.write("<< /Names [ "),a=0;a<d.length;a++)r.internal.write("(page_"+(a+1)+")"+d[a]+" 0 R");r.internal.write(" ] >>","endobj"),e=r.internal.newObject(),r.internal.write("<< /Dests "+h+" 0 R"),r.internal.write(">>","endobj")}}]),t.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+e+" 0 R"))}]),t.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(n,s,a){var i={title:s,options:a,children:[]};return n==null&&(n=this.root),n.children.push(i),i},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(n){n.id=r.internal.newObjectDeferred();for(var s=0;s<n.children.length;s++)this.genIds_r(n.children[s])},r.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},r.outline.renderItems=function(n){for(var s=this.ctx.pdf.internal.getVerticalCoordinateString,a=0;a<n.children.length;a++){var i=n.children[a];this.objStart(i),this.line("/Title "+this.makeString(i.title)),this.line("/Parent "+this.makeRef(n)),a>0&&this.line("/Prev "+this.makeRef(n.children[a-1])),a<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[a+1])),i.children.length>0&&(this.line("/First "+this.makeRef(i.children[0])),this.line("/Last "+this.makeRef(i.children[i.children.length-1])));var l=this.count=this.count_r({count:0},i);if(l>0&&this.line("/Count "+l),i.options&&i.options.pageNumber){var c=r.internal.getPageInfo(i.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+s(0)+" 0]")}this.objEnd()}for(var u=0;u<n.children.length;u++)this.renderItems(n.children[u])},r.outline.line=function(n){this.ctx.val+=n+`\r
`},r.outline.makeRef=function(n){return n.id+" 0 R"},r.outline.makeString=function(n){return"("+r.internal.pdfEscape(n)+")"},r.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(n,s){for(var a=0;a<s.children.length;a++)n.count++,this.count_r(n,s.children[a]);return n.count}}])}(pr.API),function(t){var e=[192,193,194,195,196,197,198,199];t.processJPEG=function(r,n,s,a,i,l){var c,u=this.decode.DCT_DECODE,d=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=i||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,(c=function(f){for(var m,h=256*f.charCodeAt(4)+f.charCodeAt(5),g=f.length,p={width:0,height:0,numcomponents:1},v=4;v<g;v+=2){if(v+=h,e.indexOf(f.charCodeAt(v+1))!==-1){m=256*f.charCodeAt(v+5)+f.charCodeAt(v+6),p={width:256*f.charCodeAt(v+7)+f.charCodeAt(v+8),height:m,numcomponents:f.charCodeAt(v+9)};break}h=256*f.charCodeAt(v+2)+f.charCodeAt(v+3)}return p}(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r)).numcomponents){case 1:l=this.color_spaces.DEVICE_GRAY;break;case 4:l=this.color_spaces.DEVICE_CMYK;break;case 3:l=this.color_spaces.DEVICE_RGB}d={data:r,width:c.width,height:c.height,colorSpace:l,bitsPerComponent:8,filter:u,index:n,alias:s}}return d}}(pr.API);var n0,ay,Qk,Jk,Zk,zoe=function(){var t,e,r;function n(a){var i,l,c,u,d,f,m,h,g,p,v,b,w,N;for(this.data=a,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},f=null;;){switch(i=this.readUInt32(),g=(function(){var j,F;for(F=[],j=0;j<4;++j)F.push(String.fromCharCode(this.data[this.pos++]));return F}).call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(i);break;case"fcTL":f&&this.animation.frames.push(f),this.pos+=4,f={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},d=this.readUInt16(),u=this.readUInt16()||100,f.delay=1e3*d/u,f.disposeOp=this.data[this.pos++],f.blendOp=this.data[this.pos++],f.data=[];break;case"IDAT":case"fdAT":for(g==="fdAT"&&(this.pos+=4,i-=4),a=(f!=null?f.data:void 0)||this.imgData,b=0;0<=i?b<i:b>i;0<=i?++b:--b)a.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(c=this.palette.length/3,this.transparency.indexed=this.read(i),this.transparency.indexed.length>c)throw new Error("More transparent colors than palette size");if((p=c-this.transparency.indexed.length)>0)for(w=0;0<=p?w<p:w>p;0<=p?++w:--w)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(i)[0];break;case 2:this.transparency.rgb=this.read(i)}break;case"tEXt":m=(v=this.read(i)).indexOf(0),h=String.fromCharCode.apply(String,v.slice(0,m)),this.text[h]=String.fromCharCode.apply(String,v.slice(m+1));break;case"IEND":return f&&this.animation.frames.push(f),this.colors=(function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}).call(this),this.hasAlphaChannel=(N=this.colorType)===4||N===6,l=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*l,this.colorSpace=(function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}).call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=i}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}n.prototype.read=function(a){var i,l;for(l=[],i=0;0<=a?i<a:i>a;0<=a?++i:--i)l.push(this.data[this.pos++]);return l},n.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.decodePixels=function(a){var i=this.pixelBitlength/8,l=new Uint8Array(this.width*this.height*i),c=0,u=this;if(a==null&&(a=this.imgData),a.length===0)return new Uint8Array(0);function d(f,m,h,g){var p,v,b,w,N,j,F,U,A,S,k,M,I,E,D,G,Z,ae,de,se,Y,ye=Math.ceil((u.width-f)/h),re=Math.ceil((u.height-m)/g),C=u.width==ye&&u.height==re;for(E=i*ye,M=C?l:new Uint8Array(E*re),j=a.length,I=0,v=0;I<re&&c<j;){switch(a[c++]){case 0:for(w=Z=0;Z<E;w=Z+=1)M[v++]=a[c++];break;case 1:for(w=ae=0;ae<E;w=ae+=1)p=a[c++],N=w<i?0:M[v-i],M[v++]=(p+N)%256;break;case 2:for(w=de=0;de<E;w=de+=1)p=a[c++],b=(w-w%i)/i,D=I&&M[(I-1)*E+b*i+w%i],M[v++]=(D+p)%256;break;case 3:for(w=se=0;se<E;w=se+=1)p=a[c++],b=(w-w%i)/i,N=w<i?0:M[v-i],D=I&&M[(I-1)*E+b*i+w%i],M[v++]=(p+Math.floor((N+D)/2))%256;break;case 4:for(w=Y=0;Y<E;w=Y+=1)p=a[c++],b=(w-w%i)/i,N=w<i?0:M[v-i],I===0?D=G=0:(D=M[(I-1)*E+b*i+w%i],G=b&&M[(I-1)*E+(b-1)*i+w%i]),F=N+D-G,U=Math.abs(F-N),S=Math.abs(F-D),k=Math.abs(F-G),A=U<=S&&U<=k?N:S<=k?D:G,M[v++]=(p+A)%256;break;default:throw new Error("Invalid filter algorithm: "+a[c-1])}if(!C){var O=((m+I*g)*u.width+f)*i,L=I*E;for(w=0;w<ye;w+=1){for(var H=0;H<i;H+=1)l[O++]=M[L++];O+=(h-1)*i}}I++}}return a=woe(a),u.interlaceMethod==1?(d(0,0,8,8),d(4,0,8,8),d(0,4,4,8),d(2,0,4,4),d(0,2,2,4),d(1,0,2,2),d(0,1,1,2)):d(0,0,1,1),l},n.prototype.decodePalette=function(){var a,i,l,c,u,d,f,m,h;for(l=this.palette,d=this.transparency.indexed||[],u=new Uint8Array((d.length||0)+l.length),c=0,a=0,i=f=0,m=l.length;f<m;i=f+=3)u[c++]=l[i],u[c++]=l[i+1],u[c++]=l[i+2],u[c++]=(h=d[a++])!=null?h:255;return u},n.prototype.copyToImageData=function(a,i){var l,c,u,d,f,m,h,g,p,v,b;if(c=this.colors,p=null,l=this.hasAlphaChannel,this.palette.length&&(p=(b=this._decodedPalette)!=null?b:this._decodedPalette=this.decodePalette(),c=4,l=!0),g=(u=a.data||a).length,f=p||i,d=m=0,c===1)for(;d<g;)h=p?4*i[d/4]:m,v=f[h++],u[d++]=v,u[d++]=v,u[d++]=v,u[d++]=l?f[h++]:255,m=h;else for(;d<g;)h=p?4*i[d/4]:m,u[d++]=f[h++],u[d++]=f[h++],u[d++]=f[h++],u[d++]=l?f[h++]:255,m=h},n.prototype.decode=function(){var a;return a=new Uint8Array(this.width*this.height*4),this.copyToImageData(a,this.decodePixels()),a};var s=function(){if(Object.prototype.toString.call(yr)==="[object Window]"){try{e=yr.document.createElement("canvas"),r=e.getContext("2d")}catch{return!1}return!0}return!1};return s(),t=function(a){var i;if(s()===!0)return r.width=a.width,r.height=a.height,r.clearRect(0,0,a.width,a.height),r.putImageData(a,0,0),(i=new Image).src=e.toDataURL(),i;throw new Error("This method requires a Browser with Canvas-capability.")},n.prototype.decodeFrames=function(a){var i,l,c,u,d,f,m,h;if(this.animation){for(h=[],l=d=0,f=(m=this.animation.frames).length;d<f;l=++d)i=m[l],c=a.createImageData(i.width,i.height),u=this.decodePixels(new Uint8Array(i.data)),this.copyToImageData(c,u),i.imageData=c,h.push(i.image=t(c));return h}},n.prototype.renderFrame=function(a,i){var l,c,u;return l=(c=this.animation.frames)[i],u=c[i-1],i===0&&a.clearRect(0,0,this.width,this.height),(u!=null?u.disposeOp:void 0)===1?a.clearRect(u.xOffset,u.yOffset,u.width,u.height):(u!=null?u.disposeOp:void 0)===2&&a.putImageData(u.imageData,u.xOffset,u.yOffset),l.blendOp===0&&a.clearRect(l.xOffset,l.yOffset,l.width,l.height),a.drawImage(l.image,l.xOffset,l.yOffset)},n.prototype.animate=function(a){var i,l,c,u,d,f,m=this;return l=0,f=this.animation,u=f.numFrames,c=f.frames,d=f.numPlays,(i=function(){var h,g;if(h=l++%u,g=c[h],m.renderFrame(a,h),u>1&&l/u<d)return m.animation._timeout=setTimeout(i,g.delay)})()},n.prototype.stopAnimation=function(){var a;return clearTimeout((a=this.animation)!=null?a._timeout:void 0)},n.prototype.render=function(a){var i,l;return a._png&&a._png.stopAnimation(),a._png=this,a.width=this.width,a.height=this.height,i=a.getContext("2d"),this.animation?(this.decodeFrames(i),this.animate(i)):(l=i.createImageData(this.width,this.height),this.copyToImageData(l,this.decodePixels()),i.putImageData(l,0,0))},n}();/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 *//**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */function qoe(t){var e=0;if(t[e++]!==71||t[e++]!==73||t[e++]!==70||t[e++]!==56||(t[e++]+1&253)!=56||t[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=t[e++]|t[e++]<<8,n=t[e++]|t[e++]<<8,s=t[e++],a=s>>7,i=1<<(7&s)+1;t[e++],t[e++];var l=null,c=null;a&&(l=e,c=i,e+=3*i);var u=!0,d=[],f=0,m=null,h=0,g=null;for(this.width=r,this.height=n;u&&e<t.length;)switch(t[e++]){case 33:switch(t[e++]){case 255:if(t[e]!==11||t[e+1]==78&&t[e+2]==69&&t[e+3]==84&&t[e+4]==83&&t[e+5]==67&&t[e+6]==65&&t[e+7]==80&&t[e+8]==69&&t[e+9]==50&&t[e+10]==46&&t[e+11]==48&&t[e+12]==3&&t[e+13]==1&&t[e+16]==0)e+=14,g=t[e++]|t[e++]<<8,e++;else for(e+=12;;){if(!((I=t[e++])>=0))throw Error("Invalid block size");if(I===0)break;e+=I}break;case 249:if(t[e++]!==4||t[e+4]!==0)throw new Error("Invalid graphics extension block.");var p=t[e++];f=t[e++]|t[e++]<<8,m=t[e++],!(1&p)&&(m=null),h=p>>2&7,e++;break;case 254:for(;;){if(!((I=t[e++])>=0))throw Error("Invalid block size");if(I===0)break;e+=I}break;default:throw new Error("Unknown graphic control label: 0x"+t[e-1].toString(16))}break;case 44:var v=t[e++]|t[e++]<<8,b=t[e++]|t[e++]<<8,w=t[e++]|t[e++]<<8,N=t[e++]|t[e++]<<8,j=t[e++],F=j>>6&1,U=1<<(7&j)+1,A=l,S=c,k=!1;j>>7&&(k=!0,A=e,S=U,e+=3*U);var M=e;for(e++;;){var I;if(!((I=t[e++])>=0))throw Error("Invalid block size");if(I===0)break;e+=I}d.push({x:v,y:b,width:w,height:N,has_local_palette:k,palette_offset:A,palette_size:S,data_offset:M,data_length:e-M,transparent_index:m,interlaced:!!F,delay:f,disposal:h});break;case 59:u=!1;break;default:throw new Error("Unknown gif block: 0x"+t[e-1].toString(16))}this.numFrames=function(){return d.length},this.loopCount=function(){return g},this.frameInfo=function(E){if(E<0||E>=d.length)throw new Error("Frame index out of range.");return d[E]},this.decodeAndBlitFrameBGRA=function(E,D){var G=this.frameInfo(E),Z=G.width*G.height,ae=new Uint8Array(Z);e6(t,G.data_offset,ae,Z);var de=G.palette_offset,se=G.transparent_index;se===null&&(se=256);var Y=G.width,ye=r-Y,re=Y,C=4*(G.y*r+G.x),O=4*((G.y+G.height)*r+G.x),L=C,H=4*ye;G.interlaced===!0&&(H+=4*r*7);for(var K=8,q=0,te=ae.length;q<te;++q){var oe=ae[q];if(re===0&&(re=Y,(L+=H)>=O&&(H=4*ye+4*r*(K-1),L=C+(Y+ye)*(K<<1),K>>=1)),oe===se)L+=4;else{var V=t[de+3*oe],xe=t[de+3*oe+1],B=t[de+3*oe+2];D[L++]=B,D[L++]=xe,D[L++]=V,D[L++]=255}--re}},this.decodeAndBlitFrameRGBA=function(E,D){var G=this.frameInfo(E),Z=G.width*G.height,ae=new Uint8Array(Z);e6(t,G.data_offset,ae,Z);var de=G.palette_offset,se=G.transparent_index;se===null&&(se=256);var Y=G.width,ye=r-Y,re=Y,C=4*(G.y*r+G.x),O=4*((G.y+G.height)*r+G.x),L=C,H=4*ye;G.interlaced===!0&&(H+=4*r*7);for(var K=8,q=0,te=ae.length;q<te;++q){var oe=ae[q];if(re===0&&(re=Y,(L+=H)>=O&&(H=4*ye+4*r*(K-1),L=C+(Y+ye)*(K<<1),K>>=1)),oe===se)L+=4;else{var V=t[de+3*oe],xe=t[de+3*oe+1],B=t[de+3*oe+2];D[L++]=V,D[L++]=xe,D[L++]=B,D[L++]=255}--re}}}function e6(t,e,r,n){for(var s=t[e++],a=1<<s,i=a+1,l=i+1,c=s+1,u=(1<<c)-1,d=0,f=0,m=0,h=t[e++],g=new Int32Array(4096),p=null;;){for(;d<16&&h!==0;)f|=t[e++]<<d,d+=8,h===1?h=t[e++]:--h;if(d<c)break;var v=f&u;if(f>>=c,d-=c,v!==a){if(v===i)break;for(var b=v<l?v:p,w=0,N=b;N>a;)N=g[N]>>8,++w;var j=N;if(m+w+(b!==v?1:0)>n)return void An.log("Warning, gif stream longer than expected.");r[m++]=j;var F=m+=w;for(b!==v&&(r[m++]=j),N=b;w--;)N=g[N],r[--F]=255&N,N>>=8;p!==null&&l<4096&&(g[l++]=p<<8|j,l>=u+1&&c<12&&(++c,u=u<<1|1)),p=v}else l=i+1,u=(1<<(c=s+1))-1,p=null}return m!==n&&An.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function Ww(t){var e,r,n,s,a,i=Math.floor,l=new Array(64),c=new Array(64),u=new Array(64),d=new Array(64),f=new Array(65535),m=new Array(65535),h=new Array(64),g=new Array(64),p=[],v=0,b=7,w=new Array(64),N=new Array(64),j=new Array(64),F=new Array(256),U=new Array(2048),A=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],S=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],k=[0,1,2,3,4,5,6,7,8,9,10,11],M=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],I=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],E=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],D=[0,1,2,3,4,5,6,7,8,9,10,11],G=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],Z=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function ae(C,O){for(var L=0,H=0,K=new Array,q=1;q<=16;q++){for(var te=1;te<=C[q];te++)K[O[H]]=[],K[O[H]][0]=L,K[O[H]][1]=q,H++,L++;L*=2}return K}function de(C){for(var O=C[0],L=C[1]-1;L>=0;)O&1<<L&&(v|=1<<b),L--,--b<0&&(v==255?(se(255),se(0)):se(v),b=7,v=0)}function se(C){p.push(C)}function Y(C){se(C>>8&255),se(255&C)}function ye(C,O,L,H,K){for(var q,te=K[0],oe=K[240],V=function(lt,ue){var Ne,Ae,Be,Ue,Ce,Ye,It,Dt,Ot,Pt,ht=0;for(Ot=0;Ot<8;++Ot){Ne=lt[ht],Ae=lt[ht+1],Be=lt[ht+2],Ue=lt[ht+3],Ce=lt[ht+4],Ye=lt[ht+5],It=lt[ht+6];var or=Ne+(Dt=lt[ht+7]),Ve=Ne-Dt,tt=Ae+It,nt=Ae-It,At=Be+Ye,mr=Be-Ye,Wt=Ue+Ce,Te=Ue-Ce,je=or+Wt,et=or-Wt,St=tt+At,vt=tt-At;lt[ht]=je+St,lt[ht+4]=je-St;var st=.707106781*(vt+et);lt[ht+2]=et+st,lt[ht+6]=et-st;var zt=.382683433*((je=Te+mr)-(vt=nt+Ve)),Qt=.5411961*je+zt,nr=1.306562965*vt+zt,dr=.707106781*(St=mr+nt),Vr=Ve+dr,Et=Ve-dr;lt[ht+5]=Et+Qt,lt[ht+3]=Et-Qt,lt[ht+1]=Vr+nr,lt[ht+7]=Vr-nr,ht+=8}for(ht=0,Ot=0;Ot<8;++Ot){Ne=lt[ht],Ae=lt[ht+8],Be=lt[ht+16],Ue=lt[ht+24],Ce=lt[ht+32],Ye=lt[ht+40],It=lt[ht+48];var qr=Ne+(Dt=lt[ht+56]),Qr=Ne-Dt,Wr=Ae+It,Nn=Ae-It,ir=Be+Ye,ee=Be-Ye,be=Ue+Ce,pe=Ue-Ce,ge=qr+be,we=qr-be,_e=Wr+ir,$e=Wr-ir;lt[ht]=ge+_e,lt[ht+32]=ge-_e;var rt=.707106781*($e+we);lt[ht+16]=we+rt,lt[ht+48]=we-rt;var ze=.382683433*((ge=pe+ee)-($e=Nn+Qr)),We=.5411961*ge+ze,Xe=1.306562965*$e+ze,wt=.707106781*(_e=ee+Nn),Lt=Qr+wt,qt=Qr-wt;lt[ht+40]=qt+We,lt[ht+24]=qt-We,lt[ht+8]=Lt+Xe,lt[ht+56]=Lt-Xe,ht++}for(Ot=0;Ot<64;++Ot)Pt=lt[Ot]*ue[Ot],h[Ot]=Pt>0?Pt+.5|0:Pt-.5|0;return h}(C,O),xe=0;xe<64;++xe)g[A[xe]]=V[xe];var B=g[0]-L;L=g[0],B==0?de(H[0]):(de(H[m[q=32767+B]]),de(f[q]));for(var Ee=63;Ee>0&&g[Ee]==0;)Ee--;if(Ee==0)return de(te),L;for(var Me,Ie=1;Ie<=Ee;){for(var he=Ie;g[Ie]==0&&Ie<=Ee;)++Ie;var qe=Ie-he;if(qe>=16){Me=qe>>4;for(var ct=1;ct<=Me;++ct)de(oe);qe&=15}q=32767+g[Ie],de(K[(qe<<4)+m[q]]),de(f[q]),Ie++}return Ee!=63&&de(te),L}function re(C){C=Math.min(Math.max(C,1),100),a!=C&&(function(O){for(var L=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],H=0;H<64;H++){var K=i((L[H]*O+50)/100);K=Math.min(Math.max(K,1),255),l[A[H]]=K}for(var q=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],te=0;te<64;te++){var oe=i((q[te]*O+50)/100);oe=Math.min(Math.max(oe,1),255),c[A[te]]=oe}for(var V=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],xe=0,B=0;B<8;B++)for(var Ee=0;Ee<8;Ee++)u[xe]=1/(l[A[xe]]*V[B]*V[Ee]*8),d[xe]=1/(c[A[xe]]*V[B]*V[Ee]*8),xe++}(C<50?Math.floor(5e3/C):Math.floor(200-2*C)),a=C)}this.encode=function(C,O){O&&re(O),p=new Array,v=0,b=7,Y(65496),Y(65504),Y(16),se(74),se(70),se(73),se(70),se(0),se(1),se(1),se(0),Y(1),Y(1),se(0),se(0),function(){Y(65499),Y(132),se(0);for(var Ae=0;Ae<64;Ae++)se(l[Ae]);se(1);for(var Be=0;Be<64;Be++)se(c[Be])}(),function(Ae,Be){Y(65472),Y(17),se(8),Y(Be),Y(Ae),se(3),se(1),se(17),se(0),se(2),se(17),se(1),se(3),se(17),se(1)}(C.width,C.height),function(){Y(65476),Y(418),se(0);for(var Ae=0;Ae<16;Ae++)se(S[Ae+1]);for(var Be=0;Be<=11;Be++)se(k[Be]);se(16);for(var Ue=0;Ue<16;Ue++)se(M[Ue+1]);for(var Ce=0;Ce<=161;Ce++)se(I[Ce]);se(1);for(var Ye=0;Ye<16;Ye++)se(E[Ye+1]);for(var It=0;It<=11;It++)se(D[It]);se(17);for(var Dt=0;Dt<16;Dt++)se(G[Dt+1]);for(var Ot=0;Ot<=161;Ot++)se(Z[Ot])}(),Y(65498),Y(12),se(3),se(1),se(0),se(2),se(17),se(3),se(17),se(0),se(63),se(0);var L=0,H=0,K=0;v=0,b=7,this.encode.displayName="_encode_";for(var q,te,oe,V,xe,B,Ee,Me,Ie,he=C.data,qe=C.width,ct=C.height,lt=4*qe,ue=0;ue<ct;){for(q=0;q<lt;){for(xe=lt*ue+q,Ee=-1,Me=0,Ie=0;Ie<64;Ie++)B=xe+(Me=Ie>>3)*lt+(Ee=4*(7&Ie)),ue+Me>=ct&&(B-=lt*(ue+1+Me-ct)),q+Ee>=lt&&(B-=q+Ee-lt+4),te=he[B++],oe=he[B++],V=he[B++],w[Ie]=(U[te]+U[oe+256>>0]+U[V+512>>0]>>16)-128,N[Ie]=(U[te+768>>0]+U[oe+1024>>0]+U[V+1280>>0]>>16)-128,j[Ie]=(U[te+1280>>0]+U[oe+1536>>0]+U[V+1792>>0]>>16)-128;L=ye(w,u,L,e,n),H=ye(N,d,H,r,s),K=ye(j,d,K,r,s),q+=32}ue+=8}if(b>=0){var Ne=[];Ne[1]=b+1,Ne[0]=(1<<b+1)-1,de(Ne)}return Y(65497),new Uint8Array(p)},t=t||50,function(){for(var C=String.fromCharCode,O=0;O<256;O++)F[O]=C(O)}(),e=ae(S,k),r=ae(E,D),n=ae(M,I),s=ae(G,Z),function(){for(var C=1,O=2,L=1;L<=15;L++){for(var H=C;H<O;H++)m[32767+H]=L,f[32767+H]=[],f[32767+H][1]=L,f[32767+H][0]=H;for(var K=-(O-1);K<=-C;K++)m[32767+K]=L,f[32767+K]=[],f[32767+K][1]=L,f[32767+K][0]=O-1+K;C<<=1,O<<=1}}(),function(){for(var C=0;C<256;C++)U[C]=19595*C,U[C+256>>0]=38470*C,U[C+512>>0]=7471*C+32768,U[C+768>>0]=-11059*C,U[C+1024>>0]=-21709*C,U[C+1280>>0]=32768*C+8421375,U[C+1536>>0]=-27439*C,U[C+1792>>0]=-5329*C}(),re(t)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function Wo(t,e){if(this.pos=0,this.buffer=t,this.datav=new DataView(t.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function t6(t){function e(S){if(!S)throw Error("assert :P")}function r(S,k,M){for(var I=0;4>I;I++)if(S[k+I]!=M.charCodeAt(I))return!0;return!1}function n(S,k,M,I,E){for(var D=0;D<E;D++)S[k+D]=M[I+D]}function s(S,k,M,I){for(var E=0;E<I;E++)S[k+E]=M}function a(S){return new Int32Array(S)}function i(S,k){for(var M=[],I=0;I<S;I++)M.push(new k);return M}function l(S,k){var M=[];return function I(E,D,G){for(var Z=G[D],ae=0;ae<Z&&(E.push(G.length>D+1?[]:new k),!(G.length<D+1));ae++)I(E[ae],D+1,G)}(M,0,S),M}var c=function(){var S=this;function k(x,_){for(var P=1<<_-1>>>0;x&P;)P>>>=1;return P?(x&P-1)+P:x}function M(x,_,P,z,J){e(!(z%P));do x[_+(z-=P)]=J;while(0<z)}function I(x,_,P,z,J){if(e(2328>=J),512>=J)var ne=a(512);else if((ne=a(J))==null)return 0;return function(ie,ce,me,ve,Pe,He){var Ge,Oe,yt=ce,at=1<<me,Re=a(16),De=a(16);for(e(Pe!=0),e(ve!=null),e(ie!=null),e(0<me),Oe=0;Oe<Pe;++Oe){if(15<ve[Oe])return 0;++Re[ve[Oe]]}if(Re[0]==Pe)return 0;for(De[1]=0,Ge=1;15>Ge;++Ge){if(Re[Ge]>1<<Ge)return 0;De[Ge+1]=De[Ge]+Re[Ge]}for(Oe=0;Oe<Pe;++Oe)Ge=ve[Oe],0<ve[Oe]&&(He[De[Ge]++]=Oe);if(De[15]==1)return(ve=new E).g=0,ve.value=He[0],M(ie,yt,1,at,ve),at;var gt,Nt=-1,xt=at-1,Xt=0,Ht=1,fr=1,Kt=1<<me;for(Oe=0,Ge=1,Pe=2;Ge<=me;++Ge,Pe<<=1){if(Ht+=fr<<=1,0>(fr-=Re[Ge]))return 0;for(;0<Re[Ge];--Re[Ge])(ve=new E).g=Ge,ve.value=He[Oe++],M(ie,yt+Xt,Pe,Kt,ve),Xt=k(Xt,Ge)}for(Ge=me+1,Pe=2;15>=Ge;++Ge,Pe<<=1){if(Ht+=fr<<=1,0>(fr-=Re[Ge]))return 0;for(;0<Re[Ge];--Re[Ge]){if(ve=new E,(Xt&xt)!=Nt){for(yt+=Kt,gt=1<<(Nt=Ge)-me;15>Nt&&!(0>=(gt-=Re[Nt]));)++Nt,gt<<=1;at+=Kt=1<<(gt=Nt-me),ie[ce+(Nt=Xt&xt)].g=gt+me,ie[ce+Nt].value=yt-ce-Nt}ve.g=Ge-me,ve.value=He[Oe++],M(ie,yt+(Xt>>me),Pe,Kt,ve),Xt=k(Xt,Ge)}}return Ht!=2*De[15]-1?0:at}(x,_,P,z,J,ne)}function E(){this.value=this.g=0}function D(){this.value=this.g=0}function G(){this.G=i(5,E),this.H=a(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=i(la,D)}function Z(x,_,P,z){e(x!=null),e(_!=null),e(2147483648>z),x.Ca=254,x.I=0,x.b=-8,x.Ka=0,x.oa=_,x.pa=P,x.Jd=_,x.Yc=P+z,x.Zc=4<=z?P+z-4+1:P,q(x)}function ae(x,_){for(var P=0;0<_--;)P|=oe(x,128)<<_;return P}function de(x,_){var P=ae(x,_);return te(x)?-P:P}function se(x,_,P,z){var J,ne=0;for(e(x!=null),e(_!=null),e(4294967288>z),x.Sb=z,x.Ra=0,x.u=0,x.h=0,4<z&&(z=4),J=0;J<z;++J)ne+=_[P+J]<<8*J;x.Ra=ne,x.bb=z,x.oa=_,x.pa=P}function Y(x){for(;8<=x.u&&x.bb<x.Sb;)x.Ra>>>=8,x.Ra+=x.oa[x.pa+x.bb]<<Fh-8>>>0,++x.bb,x.u-=8;L(x)&&(x.h=1,x.u=0)}function ye(x,_){if(e(0<=_),!x.h&&_<=Dh){var P=O(x)&Rh[_];return x.u+=_,Y(x),P}return x.h=1,x.u=0}function re(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function C(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function O(x){return x.Ra>>>(x.u&Fh-1)>>>0}function L(x){return e(x.bb<=x.Sb),x.h||x.bb==x.Sb&&x.u>Fh}function H(x,_){x.u=_,x.h=L(x)}function K(x){x.u>=$m&&(e(x.u>=$m),Y(x))}function q(x){e(x!=null&&x.oa!=null),x.pa<x.Zc?(x.I=(x.oa[x.pa++]|x.I<<8)>>>0,x.b+=8):(e(x!=null&&x.oa!=null),x.pa<x.Yc?(x.b+=8,x.I=x.oa[x.pa++]|x.I<<8):x.Ka?x.b=0:(x.I<<=8,x.b+=8,x.Ka=1))}function te(x){return ae(x,1)}function oe(x,_){var P=x.Ca;0>x.b&&q(x);var z=x.b,J=P*_>>>8,ne=(x.I>>>z>J)+0;for(ne?(P-=J,x.I-=J+1<<z>>>0):P=J+1,z=P,J=0;256<=z;)J+=8,z>>=8;return z=7^J+li[z],x.b-=z,x.Ca=(P<<z)-1,ne}function V(x,_,P){x[_+0]=P>>24&255,x[_+1]=P>>16&255,x[_+2]=P>>8&255,x[_+3]=P>>0&255}function xe(x,_){return x[_+0]<<0|x[_+1]<<8}function B(x,_){return xe(x,_)|x[_+2]<<16}function Ee(x,_){return xe(x,_)|xe(x,_+2)<<16}function Me(x,_){var P=1<<_;return e(x!=null),e(0<_),x.X=a(P),x.X==null?0:(x.Mb=32-_,x.Xa=_,1)}function Ie(x,_){e(x!=null),e(_!=null),e(x.Xa==_.Xa),n(_.X,0,x.X,0,1<<_.Xa)}function he(){this.X=[],this.Xa=this.Mb=0}function qe(x,_,P,z){e(P!=null),e(z!=null);var J=P[0],ne=z[0];return J==0&&(J=(x*ne+_/2)/_),ne==0&&(ne=(_*J+x/2)/x),0>=J||0>=ne?0:(P[0]=J,z[0]=ne,1)}function ct(x,_){return x+(1<<_)-1>>>_}function lt(x,_){return((4278255360&x)+(4278255360&_)>>>0&4278255360)+((16711935&x)+(16711935&_)>>>0&16711935)>>>0}function ue(x,_){S[_]=function(P,z,J,ne,ie,ce,me){var ve;for(ve=0;ve<ie;++ve){var Pe=S[x](ce[me+ve-1],J,ne+ve);ce[me+ve]=lt(P[z+ve],Pe)}}}function Ne(){this.ud=this.hd=this.jd=0}function Ae(x,_){return((4278124286&(x^_))>>>1)+(x&_)>>>0}function Be(x){return 0<=x&&256>x?x:0>x?0:255<x?255:void 0}function Ue(x,_){return Be(x+(x-_+.5>>1))}function Ce(x,_,P){return Math.abs(_-P)-Math.abs(x-P)}function Ye(x,_,P,z,J,ne,ie){for(z=ne[ie-1],P=0;P<J;++P)ne[ie+P]=z=lt(x[_+P],z)}function It(x,_,P,z,J){var ne;for(ne=0;ne<P;++ne){var ie=x[_+ne],ce=ie>>8&255,me=16711935&(me=(me=16711935&ie)+((ce<<16)+ce));z[J+ne]=(4278255360&ie)+me>>>0}}function Dt(x,_){_.jd=x>>0&255,_.hd=x>>8&255,_.ud=x>>16&255}function Ot(x,_,P,z,J,ne){var ie;for(ie=0;ie<z;++ie){var ce=_[P+ie],me=ce>>>8,ve=ce,Pe=255&(Pe=(Pe=ce>>>16)+((x.jd<<24>>24)*(me<<24>>24)>>>5));ve=255&(ve=(ve=ve+((x.hd<<24>>24)*(me<<24>>24)>>>5))+((x.ud<<24>>24)*(Pe<<24>>24)>>>5)),J[ne+ie]=(4278255360&ce)+(Pe<<16)+ve}}function Pt(x,_,P,z,J){S[_]=function(ne,ie,ce,me,ve,Pe,He,Ge,Oe){for(me=He;me<Ge;++me)for(He=0;He<Oe;++He)ve[Pe++]=J(ce[z(ne[ie++])])},S[x]=function(ne,ie,ce,me,ve,Pe,He){var Ge=8>>ne.b,Oe=ne.Ea,yt=ne.K[0],at=ne.w;if(8>Ge)for(ne=(1<<ne.b)-1,at=(1<<Ge)-1;ie<ce;++ie){var Re,De=0;for(Re=0;Re<Oe;++Re)Re&ne||(De=z(me[ve++])),Pe[He++]=J(yt[De&at]),De>>=Ge}else S["VP8LMapColor"+P](me,ve,yt,at,Pe,He,ie,ce,Oe)}}function ht(x,_,P,z,J){for(P=_+P;_<P;){var ne=x[_++];z[J++]=ne>>16&255,z[J++]=ne>>8&255,z[J++]=ne>>0&255}}function or(x,_,P,z,J){for(P=_+P;_<P;){var ne=x[_++];z[J++]=ne>>16&255,z[J++]=ne>>8&255,z[J++]=ne>>0&255,z[J++]=ne>>24&255}}function Ve(x,_,P,z,J){for(P=_+P;_<P;){var ne=(ie=x[_++])>>16&240|ie>>12&15,ie=ie>>0&240|ie>>28&15;z[J++]=ne,z[J++]=ie}}function tt(x,_,P,z,J){for(P=_+P;_<P;){var ne=(ie=x[_++])>>16&248|ie>>13&7,ie=ie>>5&224|ie>>3&31;z[J++]=ne,z[J++]=ie}}function nt(x,_,P,z,J){for(P=_+P;_<P;){var ne=x[_++];z[J++]=ne>>0&255,z[J++]=ne>>8&255,z[J++]=ne>>16&255}}function At(x,_,P,z,J,ne){if(ne==0)for(P=_+P;_<P;)V(z,((ne=x[_++])[0]>>24|ne[1]>>8&65280|ne[2]<<8&16711680|ne[3]<<24)>>>0),J+=32;else n(z,J,x,_,P)}function mr(x,_){S[_][0]=S[x+"0"],S[_][1]=S[x+"1"],S[_][2]=S[x+"2"],S[_][3]=S[x+"3"],S[_][4]=S[x+"4"],S[_][5]=S[x+"5"],S[_][6]=S[x+"6"],S[_][7]=S[x+"7"],S[_][8]=S[x+"8"],S[_][9]=S[x+"9"],S[_][10]=S[x+"10"],S[_][11]=S[x+"11"],S[_][12]=S[x+"12"],S[_][13]=S[x+"13"],S[_][14]=S[x+"0"],S[_][15]=S[x+"0"]}function Wt(x){return x==xb||x==yb||x==n1||x==vb}function Te(){this.eb=[],this.size=this.A=this.fb=0}function je(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function et(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new Te,this.f.kb=new je,this.sd=null}function St(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function vt(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function st(x){return alert("todo:WebPSamplerProcessPlane"),x.T}function zt(x,_){var P=x.T,z=_.ba.f.RGBA,J=z.eb,ne=z.fb+x.ka*z.A,ie=fo[_.ba.S],ce=x.y,me=x.O,ve=x.f,Pe=x.N,He=x.ea,Ge=x.W,Oe=_.cc,yt=_.dc,at=_.Mc,Re=_.Nc,De=x.ka,gt=x.ka+x.T,Nt=x.U,xt=Nt+1>>1;for(De==0?ie(ce,me,null,null,ve,Pe,He,Ge,ve,Pe,He,Ge,J,ne,null,null,Nt):(ie(_.ec,_.fc,ce,me,Oe,yt,at,Re,ve,Pe,He,Ge,J,ne-z.A,J,ne,Nt),++P);De+2<gt;De+=2)Oe=ve,yt=Pe,at=He,Re=Ge,Pe+=x.Rc,Ge+=x.Rc,ne+=2*z.A,ie(ce,(me+=2*x.fa)-x.fa,ce,me,Oe,yt,at,Re,ve,Pe,He,Ge,J,ne-z.A,J,ne,Nt);return me+=x.fa,x.j+gt<x.o?(n(_.ec,_.fc,ce,me,Nt),n(_.cc,_.dc,ve,Pe,xt),n(_.Mc,_.Nc,He,Ge,xt),P--):1&gt||ie(ce,me,null,null,ve,Pe,He,Ge,ve,Pe,He,Ge,J,ne+z.A,null,null,Nt),P}function Qt(x,_,P){var z=x.F,J=[x.J];if(z!=null){var ne=x.U,ie=_.ba.S,ce=ie==r1||ie==n1;_=_.ba.f.RGBA;var me=[0],ve=x.ka;me[0]=x.T,x.Kb&&(ve==0?--me[0]:(--ve,J[0]-=x.width),x.j+x.ka+x.T==x.o&&(me[0]=x.o-x.j-ve));var Pe=_.eb;ve=_.fb+ve*_.A,x=kn(z,J[0],x.width,ne,me,Pe,ve+(ce?0:3),_.A),e(P==me),x&&Wt(ie)&&co(Pe,ve,ce,ne,me,_.A)}return 0}function nr(x){var _=x.ma,P=_.ba.S,z=11>P,J=P==e1||P==t1||P==r1||P==gb||P==12||Wt(P);if(_.memory=null,_.Ib=null,_.Jb=null,_.Nd=null,!Bm(_.Oa,x,J?11:12))return 0;if(J&&Wt(P)&&Tt(),x.da)alert("todo:use_scaling");else{if(z){if(_.Ib=st,x.Kb){if(P=x.U+1>>1,_.memory=a(x.U+2*P),_.memory==null)return 0;_.ec=_.memory,_.fc=0,_.cc=_.ec,_.dc=_.fc+x.U,_.Mc=_.cc,_.Nc=_.dc+P,_.Ib=zt,Tt()}}else alert("todo:EmitYUV");J&&(_.Jb=Qt,z&&Le())}if(z&&!j3){for(x=0;256>x;++x)E7[x]=89858*(x-128)+a1>>s1,I7[x]=-22014*(x-128)+a1,k7[x]=-45773*(x-128),C7[x]=113618*(x-128)+a1>>s1;for(x=Ym;x<_b;++x)_=76283*(x-16)+a1>>s1,j7[x-Ym]=ln(_,255),P7[x-Ym]=ln(_+8>>4,15);j3=1}return 1}function dr(x){var _=x.ma,P=x.U,z=x.T;return e(!(1&x.ka)),0>=P||0>=z?0:(P=_.Ib(x,_),_.Jb!=null&&_.Jb(x,_,P),_.Dc+=P,1)}function Vr(x){x.ma.memory=null}function Et(x,_,P,z){return ye(x,8)!=47?0:(_[0]=ye(x,14)+1,P[0]=ye(x,14)+1,z[0]=ye(x,1),ye(x,3)!=0?0:!x.h)}function qr(x,_){if(4>x)return x+1;var P=x-2>>1;return(2+(1&x)<<P)+ye(_,P)+1}function Qr(x,_){return 120<_?_-120:1<=(P=((P=h7[_-1])>>4)*x+(8-(15&P)))?P:1;var P}function Wr(x,_,P){var z=O(P),J=x[_+=255&z].g-8;return 0<J&&(H(P,P.u+8),z=O(P),_+=x[_].value,_+=z&(1<<J)-1),H(P,P.u+x[_].g),x[_].value}function Nn(x,_,P){return P.g+=x.g,P.value+=x.value<<_>>>0,e(8>=P.g),x.g}function ir(x,_,P){var z=x.xc;return e((_=z==0?0:x.vc[x.md*(P>>z)+(_>>z)])<x.Wb),x.Ya[_]}function ee(x,_,P,z){var J=x.ab,ne=x.c*_,ie=x.C;_=ie+_;var ce=P,me=z;for(z=x.Ta,P=x.Ua;0<J--;){var ve=x.gc[J],Pe=ie,He=_,Ge=ce,Oe=me,yt=(me=z,ce=P,ve.Ea);switch(e(Pe<He),e(He<=ve.nc),ve.hc){case 2:Gx(Ge,Oe,(He-Pe)*yt,me,ce);break;case 0:var at=Pe,Re=He,De=me,gt=ce,Nt=(Kt=ve).Ea;at==0&&(mb(Ge,Oe,null,null,1,De,gt),Ye(Ge,Oe+1,0,0,Nt-1,De,gt+1),Oe+=Nt,gt+=Nt,++at);for(var xt=1<<Kt.b,Xt=xt-1,Ht=ct(Nt,Kt.b),fr=Kt.K,Kt=Kt.w+(at>>Kt.b)*Ht;at<Re;){var sn=fr,dn=Kt,Jr=1;for(zm(Ge,Oe,De,gt-Nt,1,De,gt);Jr<Nt;){var Ur=(Jr&~Xt)+xt;Ur>Nt&&(Ur=Nt),(0,gu[sn[dn++]>>8&15])(Ge,Oe+ +Jr,De,gt+Jr-Nt,Ur-Jr,De,gt+Jr),Jr=Ur}Oe+=Nt,gt+=Nt,++at&Xt||(Kt+=Ht)}He!=ve.nc&&n(me,ce-yt,me,ce+(He-Pe-1)*yt,yt);break;case 1:for(yt=Ge,Re=Oe,Nt=(Ge=ve.Ea)-(gt=Ge&~(De=(Oe=1<<ve.b)-1)),at=ct(Ge,ve.b),xt=ve.K,ve=ve.w+(Pe>>ve.b)*at;Pe<He;){for(Xt=xt,Ht=ve,fr=new Ne,Kt=Re+gt,sn=Re+Ge;Re<Kt;)Dt(Xt[Ht++],fr),cf(fr,yt,Re,Oe,me,ce),Re+=Oe,ce+=Oe;Re<sn&&(Dt(Xt[Ht++],fr),cf(fr,yt,Re,Nt,me,ce),Re+=Nt,ce+=Nt),++Pe&De||(ve+=at)}break;case 3:if(Ge==me&&Oe==ce&&0<ve.b){for(Re=me,Ge=yt=ce+(He-Pe)*yt-(gt=(He-Pe)*ct(ve.Ea,ve.b)),Oe=me,De=ce,at=[],gt=(Nt=gt)-1;0<=gt;--gt)at[gt]=Oe[De+gt];for(gt=Nt-1;0<=gt;--gt)Re[Ge+gt]=at[gt];io(ve,Pe,He,me,yt,me,ce)}else io(ve,Pe,He,Ge,Oe,me,ce)}ce=z,me=P}me!=P&&n(z,P,ce,me,ne)}function be(x,_){var P=x.V,z=x.Ba+x.c*x.C,J=_-x.C;if(e(_<=x.l.o),e(16>=J),0<J){var ne=x.l,ie=x.Ta,ce=x.Ua,me=ne.width;if(ee(x,J,P,z),J=ce=[ce],e((P=x.C)<(z=_)),e(ne.v<ne.va),z>ne.o&&(z=ne.o),P<ne.j){var ve=ne.j-P;P=ne.j,J[0]+=ve*me}if(P>=z?P=0:(J[0]+=4*ne.v,ne.ka=P-ne.j,ne.U=ne.va-ne.v,ne.T=z-P,P=1),P){if(ce=ce[0],11>(P=x.ca).S){var Pe=P.f.RGBA,He=(z=P.S,J=ne.U,ne=ne.T,ve=Pe.eb,Pe.A),Ge=ne;for(Pe=Pe.fb+x.Ma*Pe.A;0<Ge--;){var Oe=ie,yt=ce,at=J,Re=ve,De=Pe;switch(z){case Zx:ci(Oe,yt,at,Re,De);break;case e1:Wa(Oe,yt,at,Re,De);break;case xb:Wa(Oe,yt,at,Re,De),co(Re,De,0,at,1,0);break;case _3:nc(Oe,yt,at,Re,De);break;case t1:At(Oe,yt,at,Re,De,1);break;case yb:At(Oe,yt,at,Re,De,1),co(Re,De,0,at,1,0);break;case r1:At(Oe,yt,at,Re,De,0);break;case n1:At(Oe,yt,at,Re,De,0),co(Re,De,1,at,1,0);break;case gb:xu(Oe,yt,at,Re,De);break;case vb:xu(Oe,yt,at,Re,De),Cn(Re,De,at,1,0);break;case N3:rc(Oe,yt,at,Re,De);break;default:e(0)}ce+=me,Pe+=He}x.Ma+=ne}else alert("todo:EmitRescaledRowsYUVA");e(x.Ma<=P.height)}}x.C=_,e(x.C<=x.i)}function pe(x){var _;if(0<x.ua)return 0;for(_=0;_<x.Wb;++_){var P=x.Ya[_].G,z=x.Ya[_].H;if(0<P[1][z[1]+0].g||0<P[2][z[2]+0].g||0<P[3][z[3]+0].g)return 0}return 1}function ge(x,_,P,z,J,ne){if(x.Z!=0){var ie=x.qd,ce=x.rd;for(e(wu[x.Z]!=null);_<P;++_)wu[x.Z](ie,ce,z,J,z,J,ne),ie=z,ce=J,J+=ne;x.qd=ie,x.rd=ce}}function we(x,_){var P=x.l.ma,z=P.Z==0||P.Z==1?x.l.j:x.C;if(z=x.C<z?z:x.C,e(_<=x.l.o),_>z){var J=x.l.width,ne=P.ca,ie=P.tb+J*z,ce=x.V,me=x.Ba+x.c*z,ve=x.gc;e(x.ab==1),e(ve[0].hc==3),Kx(ve[0],z,_,ce,me,ne,ie),ge(P,z,_,ne,ie,J)}x.C=x.Ma=_}function _e(x,_,P,z,J,ne,ie){var ce=x.$/z,me=x.$%z,ve=x.m,Pe=x.s,He=P+x.$,Ge=He;J=P+z*J;var Oe=P+z*ne,yt=280+Pe.ua,at=x.Pb?ce:16777216,Re=0<Pe.ua?Pe.Wa:null,De=Pe.wc,gt=He<Oe?ir(Pe,me,ce):null;e(x.C<ne),e(Oe<=J);var Nt=!1;e:for(;;){for(;Nt||He<Oe;){var xt=0;if(ce>=at){var Xt=He-P;e((at=x).Pb),at.wd=at.m,at.xd=Xt,0<at.s.ua&&Ie(at.s.Wa,at.s.vb),at=ce+p7}if(me&De||(gt=ir(Pe,me,ce)),e(gt!=null),gt.Qb&&(_[He]=gt.qb,Nt=!0),!Nt)if(K(ve),gt.jc){xt=ve,Xt=_;var Ht=He,fr=gt.pd[O(xt)&la-1];e(gt.jc),256>fr.g?(H(xt,xt.u+fr.g),Xt[Ht]=fr.value,xt=0):(H(xt,xt.u+fr.g-256),e(256<=fr.value),xt=fr.value),xt==0&&(Nt=!0)}else xt=Wr(gt.G[0],gt.H[0],ve);if(ve.h)break;if(Nt||256>xt){if(!Nt)if(gt.nd)_[He]=(gt.qb|xt<<8)>>>0;else{if(K(ve),Nt=Wr(gt.G[1],gt.H[1],ve),K(ve),Xt=Wr(gt.G[2],gt.H[2],ve),Ht=Wr(gt.G[3],gt.H[3],ve),ve.h)break;_[He]=(Ht<<24|Nt<<16|xt<<8|Xt)>>>0}if(Nt=!1,++He,++me>=z&&(me=0,++ce,ie!=null&&ce<=ne&&!(ce%16)&&ie(x,ce),Re!=null))for(;Ge<He;)xt=_[Ge++],Re.X[(506832829*xt&4294967295)>>>Re.Mb]=xt}else if(280>xt){if(xt=qr(xt-256,ve),Xt=Wr(gt.G[4],gt.H[4],ve),K(ve),Xt=Qr(z,Xt=qr(Xt,ve)),ve.h)break;if(He-P<Xt||J-He<xt)break e;for(Ht=0;Ht<xt;++Ht)_[He+Ht]=_[He+Ht-Xt];for(He+=xt,me+=xt;me>=z;)me-=z,++ce,ie!=null&&ce<=ne&&!(ce%16)&&ie(x,ce);if(e(He<=J),me&De&&(gt=ir(Pe,me,ce)),Re!=null)for(;Ge<He;)xt=_[Ge++],Re.X[(506832829*xt&4294967295)>>>Re.Mb]=xt}else{if(!(xt<yt))break e;for(Nt=xt-280,e(Re!=null);Ge<He;)xt=_[Ge++],Re.X[(506832829*xt&4294967295)>>>Re.Mb]=xt;xt=He,e(!(Nt>>>(Xt=Re).Xa)),_[xt]=Xt.X[Nt],Nt=!0}Nt||e(ve.h==L(ve))}if(x.Pb&&ve.h&&He<J)e(x.m.h),x.a=5,x.m=x.wd,x.$=x.xd,0<x.s.ua&&Ie(x.s.vb,x.s.Wa);else{if(ve.h)break e;ie!=null&&ie(x,ce>ne?ne:ce),x.a=0,x.$=He-P}return 1}return x.a=3,0}function $e(x){e(x!=null),x.vc=null,x.yc=null,x.Ya=null;var _=x.Wa;_!=null&&(_.X=null),x.vb=null,e(x!=null)}function rt(){var x=new jh;return x==null?null:(x.a=0,x.xb=A3,mr("Predictor","VP8LPredictors"),mr("Predictor","VP8LPredictors_C"),mr("PredictorAdd","VP8LPredictorsAdd"),mr("PredictorAdd","VP8LPredictorsAdd_C"),Gx=It,cf=Ot,ci=ht,Wa=or,xu=Ve,rc=tt,nc=nt,S.VP8LMapColor32b=Lh,S.VP8LMapColor8b=Yx,x)}function ze(x,_,P,z,J){var ne=1,ie=[x],ce=[_],me=z.m,ve=z.s,Pe=null,He=0;e:for(;;){if(P)for(;ne&&ye(me,1);){var Ge=ie,Oe=ce,yt=z,at=1,Re=yt.m,De=yt.gc[yt.ab],gt=ye(Re,2);if(yt.Oc&1<<gt)ne=0;else{switch(yt.Oc|=1<<gt,De.hc=gt,De.Ea=Ge[0],De.nc=Oe[0],De.K=[null],++yt.ab,e(4>=yt.ab),gt){case 0:case 1:De.b=ye(Re,3)+2,at=ze(ct(De.Ea,De.b),ct(De.nc,De.b),0,yt,De.K),De.K=De.K[0];break;case 3:var Nt,xt=ye(Re,8)+1,Xt=16<xt?0:4<xt?1:2<xt?2:3;if(Ge[0]=ct(De.Ea,Xt),De.b=Xt,Nt=at=ze(xt,1,0,yt,De.K)){var Ht,fr=xt,Kt=De,sn=1<<(8>>Kt.b),dn=a(sn);if(dn==null)Nt=0;else{var Jr=Kt.K[0],Ur=Kt.w;for(dn[0]=Kt.K[0][0],Ht=1;Ht<1*fr;++Ht)dn[Ht]=lt(Jr[Ur+Ht],dn[Ht-1]);for(;Ht<4*sn;++Ht)dn[Ht]=0;Kt.K[0]=null,Kt.K[0]=dn,Nt=1}}at=Nt;break;case 2:break;default:e(0)}ne=at}}if(ie=ie[0],ce=ce[0],ne&&ye(me,1)&&!(ne=1<=(He=ye(me,4))&&11>=He)){z.a=3;break e}var Tn;if(Tn=ne)t:{var bn,Ir,Cs,ui=z,ks=ie,di=ce,fn=He,Fi=P,Li=ui.m,Ks=ui.s,ca=[null],Ga=1,ho=0,vl=m7[fn];r:for(;;){if(Fi&&ye(Li,1)){var Ys=ye(Li,3)+2,oc=ct(ks,Ys),mf=ct(di,Ys),Uh=oc*mf;if(!ze(oc,mf,0,ui,ca))break r;for(ca=ca[0],Ks.xc=Ys,bn=0;bn<Uh;++bn){var _u=ca[bn]>>8&65535;ca[bn]=_u,_u>=Ga&&(Ga=_u+1)}}if(Li.h)break r;for(Ir=0;5>Ir;++Ir){var ns=S3[Ir];!Ir&&0<fn&&(ns+=1<<fn),ho<ns&&(ho=ns)}var Nb=i(Ga*vl,E),D3=Ga,F3=i(D3,G);if(F3==null)var o1=null;else e(65536>=D3),o1=F3;var Xm=a(ho);if(o1==null||Xm==null||Nb==null){ui.a=1;break r}var l1=Nb;for(bn=Cs=0;bn<Ga;++bn){var Uo=o1[bn],$h=Uo.G,zh=Uo.H,L3=0,c1=1,O3=0;for(Ir=0;5>Ir;++Ir){ns=S3[Ir],$h[Ir]=l1,zh[Ir]=Cs,!Ir&&0<fn&&(ns+=1<<fn);s:{var u1,Sb=ns,d1=ui,Qm=Xm,F7=l1,L7=Cs,Tb=0,Nu=d1.m,O7=ye(Nu,1);if(s(Qm,0,0,Sb),O7){var M7=ye(Nu,1)+1,V7=ye(Nu,1),M3=ye(Nu,V7==0?1:8);Qm[M3]=1,M7==2&&(Qm[M3=ye(Nu,8)]=1);var f1=1}else{var V3=a(19),B3=ye(Nu,4)+4;if(19<B3){d1.a=3;var h1=0;break s}for(u1=0;u1<B3;++u1)V3[f7[u1]]=ye(Nu,3);var Ab=void 0,Jm=void 0,U3=d1,B7=V3,m1=Sb,$3=Qm,Eb=0,Su=U3.m,z3=8,q3=i(128,E);n:for(;I(q3,0,7,B7,19);){if(ye(Su,1)){var U7=2+2*ye(Su,3);if((Ab=2+ye(Su,U7))>m1)break n}else Ab=m1;for(Jm=0;Jm<m1&&Ab--;){K(Su);var W3=q3[0+(127&O(Su))];H(Su,Su.u+W3.g);var qh=W3.value;if(16>qh)$3[Jm++]=qh,qh!=0&&(z3=qh);else{var $7=qh==16,H3=qh-16,z7=u7[H3],G3=ye(Su,c7[H3])+z7;if(Jm+G3>m1)break n;for(var q7=$7?z3:0;0<G3--;)$3[Jm++]=q7}}Eb=1;break n}Eb||(U3.a=3),f1=Eb}(f1=f1&&!Nu.h)&&(Tb=I(F7,L7,8,Qm,Sb)),f1&&Tb!=0?h1=Tb:(d1.a=3,h1=0)}if(h1==0)break r;if(c1&&d7[Ir]==1&&(c1=l1[Cs].g==0),L3+=l1[Cs].g,Cs+=h1,3>=Ir){var Zm,Cb=Xm[0];for(Zm=1;Zm<ns;++Zm)Xm[Zm]>Cb&&(Cb=Xm[Zm]);O3+=Cb}}if(Uo.nd=c1,Uo.Qb=0,c1&&(Uo.qb=($h[3][zh[3]+0].value<<24|$h[1][zh[1]+0].value<<16|$h[2][zh[2]+0].value)>>>0,L3==0&&256>$h[0][zh[0]+0].value&&(Uo.Qb=1,Uo.qb+=$h[0][zh[0]+0].value<<8)),Uo.jc=!Uo.Qb&&6>O3,Uo.jc){var p1,lc=Uo;for(p1=0;p1<la;++p1){var Tu=p1,Au=lc.pd[Tu],g1=lc.G[0][lc.H[0]+Tu];256<=g1.value?(Au.g=g1.g+256,Au.value=g1.value):(Au.g=0,Au.value=0,Tu>>=Nn(g1,8,Au),Tu>>=Nn(lc.G[1][lc.H[1]+Tu],16,Au),Tu>>=Nn(lc.G[2][lc.H[2]+Tu],0,Au),Nn(lc.G[3][lc.H[3]+Tu],24,Au))}}}Ks.vc=ca,Ks.Wb=Ga,Ks.Ya=o1,Ks.yc=Nb,Tn=1;break t}Tn=0}if(!(ne=Tn)){z.a=3;break e}if(0<He){if(ve.ua=1<<He,!Me(ve.Wa,He)){z.a=1,ne=0;break e}}else ve.ua=0;var kb=z,K3=ie,W7=ce,Ib=kb.s,jb=Ib.xc;if(kb.c=K3,kb.i=W7,Ib.md=ct(K3,jb),Ib.wc=jb==0?-1:(1<<jb)-1,P){z.xb=_7;break e}if((Pe=a(ie*ce))==null){z.a=1,ne=0;break e}ne=(ne=_e(z,Pe,0,ie,ce,ce,null))&&!me.h;break e}return ne?(J!=null?J[0]=Pe:(e(Pe==null),e(P)),z.$=0,P||$e(ve)):$e(ve),ne}function We(x,_){var P=x.c*x.i,z=P+_+16*_;return e(x.c<=_),x.V=a(z),x.V==null?(x.Ta=null,x.Ua=0,x.a=1,0):(x.Ta=x.V,x.Ua=x.Ba+P+_,1)}function Xe(x,_){var P=x.C,z=_-P,J=x.V,ne=x.Ba+x.c*P;for(e(_<=x.l.o);0<z;){var ie=16<z?16:z,ce=x.l.ma,me=x.l.width,ve=me*ie,Pe=ce.ca,He=ce.tb+me*P,Ge=x.Ta,Oe=x.Ua;ee(x,ie,J,ne),ms(Ge,Oe,Pe,He,ve),ge(ce,P,P+ie,Pe,He,me),z-=ie,J+=ie*x.c,P+=ie}e(P==_),x.C=x.Ma=_}function wt(){this.ub=this.yd=this.td=this.Rb=0}function Lt(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function qt(){this.Fb=this.Bb=this.Cb=0,this.Zb=a(4),this.Lb=a(4)}function jt(){this.Yb=function(){var x=[];return function _(P,z,J){for(var ne=J[z],ie=0;ie<ne&&(P.push(J.length>z+1?[]:0),!(J.length<z+1));ie++)_(P[ie],z+1,J)}(x,0,[3,11]),x}()}function $t(){this.jb=a(3),this.Wc=l([4,8],jt),this.Xc=l([4,17],jt)}function Ze(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new a(4),this.od=new a(4)}function mt(){this.ld=this.La=this.dd=this.tc=0}function it(){this.Na=this.la=0}function _t(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function cr(){this.ad=a(384),this.Za=0,this.Ob=a(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function xr(){this.uc=this.M=this.Nb=0,this.wa=Array(new mt),this.Y=0,this.ya=Array(new cr),this.aa=0,this.l=new As}function Lr(){this.y=a(16),this.f=a(8),this.ea=a(8)}function an(){this.cb=this.a=0,this.sc="",this.m=new re,this.Od=new wt,this.Kc=new Lt,this.ed=new Ze,this.Qa=new qt,this.Ic=this.$c=this.Aa=0,this.D=new xr,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=i(8,re),this.ia=0,this.pb=i(4,_t),this.Pa=new $t,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Lr),this.Hd=0,this.rb=Array(new it),this.sb=0,this.wa=Array(new mt),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new cr),this.L=this.aa=0,this.gd=l([4,2],mt),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function As(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function ts(){var x=new an;return x!=null&&(x.a=0,x.sc="OK",x.cb=0,x.Xb=0,Km||(Km=dl)),x}function Kr(x,_,P){return x.a==0&&(x.a=_,x.sc=P,x.cb=0),0}function En(x,_,P){return 3<=P&&x[_+0]==157&&x[_+1]==1&&x[_+2]==42}function Es(x,_){if(x==null)return 0;if(x.a=0,x.sc="OK",_==null)return Kr(x,2,"null VP8Io passed to VP8GetHeaders()");var P=_.data,z=_.w,J=_.ha;if(4>J)return Kr(x,7,"Truncated header.");var ne=P[z+0]|P[z+1]<<8|P[z+2]<<16,ie=x.Od;if(ie.Rb=!(1&ne),ie.td=ne>>1&7,ie.yd=ne>>4&1,ie.ub=ne>>5,3<ie.td)return Kr(x,3,"Incorrect keyframe parameters.");if(!ie.yd)return Kr(x,4,"Frame not displayable.");z+=3,J-=3;var ce=x.Kc;if(ie.Rb){if(7>J)return Kr(x,7,"cannot parse picture header");if(!En(P,z,J))return Kr(x,3,"Bad code word");ce.c=16383&(P[z+4]<<8|P[z+3]),ce.Td=P[z+4]>>6,ce.i=16383&(P[z+6]<<8|P[z+5]),ce.Ud=P[z+6]>>6,z+=7,J-=7,x.za=ce.c+15>>4,x.Ub=ce.i+15>>4,_.width=ce.c,_.height=ce.i,_.Da=0,_.j=0,_.v=0,_.va=_.width,_.o=_.height,_.da=0,_.ib=_.width,_.hb=_.height,_.U=_.width,_.T=_.height,s((ne=x.Pa).jb,0,255,ne.jb.length),e((ne=x.Qa)!=null),ne.Cb=0,ne.Bb=0,ne.Fb=1,s(ne.Zb,0,0,ne.Zb.length),s(ne.Lb,0,0,ne.Lb)}if(ie.ub>J)return Kr(x,7,"bad partition length");Z(ne=x.m,P,z,ie.ub),z+=ie.ub,J-=ie.ub,ie.Rb&&(ce.Ld=te(ne),ce.Kd=te(ne)),ce=x.Qa;var me,ve=x.Pa;if(e(ne!=null),e(ce!=null),ce.Cb=te(ne),ce.Cb){if(ce.Bb=te(ne),te(ne)){for(ce.Fb=te(ne),me=0;4>me;++me)ce.Zb[me]=te(ne)?de(ne,7):0;for(me=0;4>me;++me)ce.Lb[me]=te(ne)?de(ne,6):0}if(ce.Bb)for(me=0;3>me;++me)ve.jb[me]=te(ne)?ae(ne,8):255}else ce.Bb=0;if(ne.Ka)return Kr(x,3,"cannot parse segment header");if((ce=x.ed).zd=te(ne),ce.Tb=ae(ne,6),ce.wb=ae(ne,3),ce.Pc=te(ne),ce.Pc&&te(ne)){for(ve=0;4>ve;++ve)te(ne)&&(ce.vd[ve]=de(ne,6));for(ve=0;4>ve;++ve)te(ne)&&(ce.od[ve]=de(ne,6))}if(x.L=ce.Tb==0?0:ce.zd?1:2,ne.Ka)return Kr(x,3,"cannot parse filter header");var Pe=J;if(J=me=z,z=me+Pe,ce=Pe,x.Xb=(1<<ae(x.m,2))-1,Pe<3*(ve=x.Xb))P=7;else{for(me+=3*ve,ce-=3*ve,Pe=0;Pe<ve;++Pe){var He=P[J+0]|P[J+1]<<8|P[J+2]<<16;He>ce&&(He=ce),Z(x.Jc[+Pe],P,me,He),me+=He,ce-=He,J+=3}Z(x.Jc[+ve],P,me,ce),P=me<z?0:5}if(P!=0)return Kr(x,P,"cannot parse partitions");for(P=ae(me=x.m,7),J=te(me)?de(me,4):0,z=te(me)?de(me,4):0,ce=te(me)?de(me,4):0,ve=te(me)?de(me,4):0,me=te(me)?de(me,4):0,Pe=x.Qa,He=0;4>He;++He){if(Pe.Cb){var Ge=Pe.Zb[He];Pe.Fb||(Ge+=P)}else{if(0<He){x.pb[He]=x.pb[0];continue}Ge=P}var Oe=x.pb[He];Oe.Sc[0]=bb[ln(Ge+J,127)],Oe.Sc[1]=wb[ln(Ge+0,127)],Oe.Eb[0]=2*bb[ln(Ge+z,127)],Oe.Eb[1]=101581*wb[ln(Ge+ce,127)]>>16,8>Oe.Eb[1]&&(Oe.Eb[1]=8),Oe.Qc[0]=bb[ln(Ge+ve,117)],Oe.Qc[1]=wb[ln(Ge+me,127)],Oe.lc=Ge+me}if(!ie.Rb)return Kr(x,4,"Not a key frame.");for(te(ne),ie=x.Pa,P=0;4>P;++P){for(J=0;8>J;++J)for(z=0;3>z;++z)for(ce=0;11>ce;++ce)ve=oe(ne,b7[P][J][z][ce])?ae(ne,8):y7[P][J][z][ce],ie.Wc[P][J].Yb[z][ce]=ve;for(J=0;17>J;++J)ie.Xc[P][J]=ie.Wc[P][w7[J]]}return x.kc=te(ne),x.kc&&(x.Bd=ae(ne,8)),x.cb=1}function dl(x,_,P,z,J,ne,ie){var ce=_[J].Yb[P];for(P=0;16>J;++J){if(!oe(x,ce[P+0]))return J;for(;!oe(x,ce[P+1]);)if(ce=_[++J].Yb[0],P=0,J==16)return 16;var me=_[J+1].Yb;if(oe(x,ce[P+2])){var ve=x,Pe=0;if(oe(ve,(Ge=ce)[(He=P)+3]))if(oe(ve,Ge[He+6])){for(ce=0,He=2*(Pe=oe(ve,Ge[He+8]))+(Ge=oe(ve,Ge[He+9+Pe])),Pe=0,Ge=g7[He];Ge[ce];++ce)Pe+=Pe+oe(ve,Ge[ce]);Pe+=3+(8<<He)}else oe(ve,Ge[He+7])?(Pe=7+2*oe(ve,165),Pe+=oe(ve,145)):Pe=5+oe(ve,159);else Pe=oe(ve,Ge[He+4])?3+oe(ve,Ge[He+5]):2;ce=me[2]}else Pe=1,ce=me[1];me=ie+x7[J],0>(ve=x).b&&q(ve);var He,Ge=ve.b,Oe=(He=ve.Ca>>1)-(ve.I>>Ge)>>31;--ve.b,ve.Ca+=Oe,ve.Ca|=1,ve.I-=(He+1&Oe)<<Ge,ne[me]=((Pe^Oe)-Oe)*z[(0<J)+0]}return 16}function Jd(x){var _=x.rb[x.sb-1];_.la=0,_.Na=0,s(x.zc,0,0,x.zc.length),x.ja=0}function Th(x,_){if(x==null)return 0;if(_==null)return Kr(x,2,"NULL VP8Io parameter in VP8Decode().");if(!x.cb&&!Es(x,_))return 0;if(e(x.cb),_.ac==null||_.ac(_)){_.ob&&(x.L=0);var P=i1[x.L];if(x.L==2?(x.yb=0,x.zb=0):(x.yb=_.v-P>>4,x.zb=_.j-P>>4,0>x.yb&&(x.yb=0),0>x.zb&&(x.zb=0)),x.Va=_.o+15+P>>4,x.Hb=_.va+15+P>>4,x.Hb>x.za&&(x.Hb=x.za),x.Va>x.Ub&&(x.Va=x.Ub),0<x.L){var z=x.ed;for(P=0;4>P;++P){var J;if(x.Qa.Cb){var ne=x.Qa.Lb[P];x.Qa.Fb||(ne+=z.Tb)}else ne=z.Tb;for(J=0;1>=J;++J){var ie=x.gd[P][J],ce=ne;if(z.Pc&&(ce+=z.vd[0],J&&(ce+=z.od[0])),0<(ce=0>ce?0:63<ce?63:ce)){var me=ce;0<z.wb&&(me=4<z.wb?me>>2:me>>1)>9-z.wb&&(me=9-z.wb),1>me&&(me=1),ie.dd=me,ie.tc=2*ce+me,ie.ld=40<=ce?2:15<=ce?1:0}else ie.tc=0;ie.La=J}}}P=0}else Kr(x,6,"Frame setup failed"),P=x.a;if(P=P==0){if(P){x.$c=0,0<x.Aa||(x.Ic=D7);e:{P=x.Ic,z=4*(me=x.za);var ve=32*me,Pe=me+1,He=0<x.L?me*(0<x.Aa?2:1):0,Ge=(x.Aa==2?2:1)*me;if((ie=z+832+(J=3*(16*P+i1[x.L])/2*ve)+(ne=x.Fa!=null&&0<x.Fa.length?x.Kc.c*x.Kc.i:0))!=ie)P=0;else{if(ie>x.Vb){if(x.Vb=0,x.Ec=a(ie),x.Fc=0,x.Ec==null){P=Kr(x,1,"no memory during frame initialization.");break e}x.Vb=ie}ie=x.Ec,ce=x.Fc,x.Ac=ie,x.Bc=ce,ce+=z,x.Gd=i(ve,Lr),x.Hd=0,x.rb=i(Pe+1,it),x.sb=1,x.wa=He?i(He,mt):null,x.Y=0,x.D.Nb=0,x.D.wa=x.wa,x.D.Y=x.Y,0<x.Aa&&(x.D.Y+=me),e(!0),x.oc=ie,x.pc=ce,ce+=832,x.ya=i(Ge,cr),x.aa=0,x.D.ya=x.ya,x.D.aa=x.aa,x.Aa==2&&(x.D.aa+=me),x.R=16*me,x.B=8*me,me=(ve=i1[x.L])*x.R,ve=ve/2*x.B,x.sa=ie,x.ta=ce+me,x.qa=x.sa,x.ra=x.ta+16*P*x.R+ve,x.Ha=x.qa,x.Ia=x.ra+8*P*x.B+ve,x.$c=0,ce+=J,x.mb=ne?ie:null,x.nb=ne?ce:null,e(ce+ne<=x.Fc+x.Vb),Jd(x),s(x.Ac,x.Bc,0,z),P=1}}if(P){if(_.ka=0,_.y=x.sa,_.O=x.ta,_.f=x.qa,_.N=x.ra,_.ea=x.Ha,_.Vd=x.Ia,_.fa=x.R,_.Rc=x.B,_.F=null,_.J=0,!Qx){for(P=-255;255>=P;++P)Vs[255+P]=0>P?-P:P;for(P=-1020;1020>=P;++P)ac[1020+P]=-128>P?-128:127<P?127:P;for(P=-112;112>=P;++P)Gm[112+P]=-16>P?-16:15<P?15:P;for(P=-255;510>=P;++P)Bh[255+P]=0>P?0:255<P?255:P;Qx=1}Oh=Ql,sc=tu,qm=Zd,Ha=un,oo=Xl,hs=Yl,Mh=lu,Xx=Oo,Wm=uu,uf=lf,df=cu,yu=Zl,ff=du,Vh=pl,hf=Jl,vu=Ri,Hm=Ms,lo=Ih,Bo[0]=ao,Bo[1]=Om,Bo[2]=hl,Bo[3]=Vm,Bo[4]=Ch,Bo[5]=su,Bo[6]=ji,Bo[7]=tf,Bo[8]=iu,Bo[9]=au,bu[0]=fl,bu[1]=Mm,bu[2]=Do,bu[3]=ru,bu[4]=Pn,bu[5]=Eh,bu[6]=ef,ic[0]=Lo,ic[1]=Ah,ic[2]=kh,ic[3]=Fo,ic[4]=on,ic[5]=rf,ic[6]=nf,P=1}else P=0}P&&(P=function(Oe,yt){for(Oe.M=0;Oe.M<Oe.Va;++Oe.M){var at,Re=Oe.Jc[Oe.M&Oe.Xb],De=Oe.m,gt=Oe;for(at=0;at<gt.za;++at){var Nt=De,xt=gt,Xt=xt.Ac,Ht=xt.Bc+4*at,fr=xt.zc,Kt=xt.ya[xt.aa+at];if(xt.Qa.Bb?Kt.$b=oe(Nt,xt.Pa.jb[0])?2+oe(Nt,xt.Pa.jb[2]):oe(Nt,xt.Pa.jb[1]):Kt.$b=0,xt.kc&&(Kt.Ad=oe(Nt,xt.Bd)),Kt.Za=!oe(Nt,145)+0,Kt.Za){var sn=Kt.Ob,dn=0;for(xt=0;4>xt;++xt){var Jr,Ur=fr[0+xt];for(Jr=0;4>Jr;++Jr){Ur=v7[Xt[Ht+Jr]][Ur];for(var Tn=T3[oe(Nt,Ur[0])];0<Tn;)Tn=T3[2*Tn+oe(Nt,Ur[Tn])];Ur=-Tn,Xt[Ht+Jr]=Ur}n(sn,dn,Xt,Ht,4),dn+=4,fr[0+xt]=Ur}}else Ur=oe(Nt,156)?oe(Nt,128)?1:3:oe(Nt,163)?2:0,Kt.Ob[0]=Ur,s(Xt,Ht,Ur,4),s(fr,0,Ur,4);Kt.Dd=oe(Nt,142)?oe(Nt,114)?oe(Nt,183)?1:3:2:0}if(gt.m.Ka)return Kr(Oe,7,"Premature end-of-partition0 encountered.");for(;Oe.ja<Oe.za;++Oe.ja){if(gt=Re,Nt=(De=Oe).rb[De.sb-1],Xt=De.rb[De.sb+De.ja],at=De.ya[De.aa+De.ja],Ht=De.kc?at.Ad:0)Nt.la=Xt.la=0,at.Za||(Nt.Na=Xt.Na=0),at.Hc=0,at.Gc=0,at.ia=0;else{var bn,Ir;if(Nt=Xt,Xt=gt,Ht=De.Pa.Xc,fr=De.ya[De.aa+De.ja],Kt=De.pb[fr.$b],xt=fr.ad,sn=0,dn=De.rb[De.sb-1],Ur=Jr=0,s(xt,sn,0,384),fr.Za)var Cs=0,ui=Ht[3];else{Tn=a(16);var ks=Nt.Na+dn.Na;if(ks=Km(Xt,Ht[1],ks,Kt.Eb,0,Tn,0),Nt.Na=dn.Na=(0<ks)+0,1<ks)Oh(Tn,0,xt,sn);else{var di=Tn[0]+3>>3;for(Tn=0;256>Tn;Tn+=16)xt[sn+Tn]=di}Cs=1,ui=Ht[0]}var fn=15&Nt.la,Fi=15&dn.la;for(Tn=0;4>Tn;++Tn){var Li=1&Fi;for(di=Ir=0;4>di;++di)fn=fn>>1|(Li=(ks=Km(Xt,ui,ks=Li+(1&fn),Kt.Sc,Cs,xt,sn))>Cs)<<7,Ir=Ir<<2|(3<ks?3:1<ks?2:xt[sn+0]!=0),sn+=16;fn>>=4,Fi=Fi>>1|Li<<7,Jr=(Jr<<8|Ir)>>>0}for(ui=fn,Cs=Fi>>4,bn=0;4>bn;bn+=2){for(Ir=0,fn=Nt.la>>4+bn,Fi=dn.la>>4+bn,Tn=0;2>Tn;++Tn){for(Li=1&Fi,di=0;2>di;++di)ks=Li+(1&fn),fn=fn>>1|(Li=0<(ks=Km(Xt,Ht[2],ks,Kt.Qc,0,xt,sn)))<<3,Ir=Ir<<2|(3<ks?3:1<ks?2:xt[sn+0]!=0),sn+=16;fn>>=2,Fi=Fi>>1|Li<<5}Ur|=Ir<<4*bn,ui|=fn<<4<<bn,Cs|=(240&Fi)<<bn}Nt.la=ui,dn.la=Cs,fr.Hc=Jr,fr.Gc=Ur,fr.ia=43690&Ur?0:Kt.ia,Ht=!(Jr|Ur)}if(0<De.L&&(De.wa[De.Y+De.ja]=De.gd[at.$b][at.Za],De.wa[De.Y+De.ja].La|=!Ht),gt.Ka)return Kr(Oe,7,"Premature end-of-file encountered.")}if(Jd(Oe),De=yt,gt=1,at=(Re=Oe).D,Nt=0<Re.L&&Re.M>=Re.zb&&Re.M<=Re.Va,Re.Aa==0)e:{if(at.M=Re.M,at.uc=Nt,xl(Re,at),gt=1,at=(Ir=Re.D).Nb,Nt=(Ur=i1[Re.L])*Re.R,Xt=Ur/2*Re.B,Tn=16*at*Re.R,di=8*at*Re.B,Ht=Re.sa,fr=Re.ta-Nt+Tn,Kt=Re.qa,xt=Re.ra-Xt+di,sn=Re.Ha,dn=Re.Ia-Xt+di,Fi=(fn=Ir.M)==0,Jr=fn>=Re.Va-1,Re.Aa==2&&xl(Re,Ir),Ir.uc)for(Li=(ks=Re).D.M,e(ks.D.uc),Ir=ks.yb;Ir<ks.Hb;++Ir){Cs=Ir,ui=Li;var Ks=(ca=(ns=ks).D).Nb;bn=ns.R;var ca=ca.wa[ca.Y+Cs],Ga=ns.sa,ho=ns.ta+16*Ks*bn+16*Cs,vl=ca.dd,Ys=ca.tc;if(Ys!=0)if(e(3<=Ys),ns.L==1)0<Cs&&vu(Ga,ho,bn,Ys+4),ca.La&&lo(Ga,ho,bn,Ys),0<ui&&hf(Ga,ho,bn,Ys+4),ca.La&&Hm(Ga,ho,bn,Ys);else{var oc=ns.B,mf=ns.qa,Uh=ns.ra+8*Ks*oc+8*Cs,_u=ns.Ha,ns=ns.Ia+8*Ks*oc+8*Cs;Ks=ca.ld,0<Cs&&(Xx(Ga,ho,bn,Ys+4,vl,Ks),uf(mf,Uh,_u,ns,oc,Ys+4,vl,Ks)),ca.La&&(yu(Ga,ho,bn,Ys,vl,Ks),Vh(mf,Uh,_u,ns,oc,Ys,vl,Ks)),0<ui&&(Mh(Ga,ho,bn,Ys+4,vl,Ks),Wm(mf,Uh,_u,ns,oc,Ys+4,vl,Ks)),ca.La&&(df(Ga,ho,bn,Ys,vl,Ks),ff(mf,Uh,_u,ns,oc,Ys,vl,Ks))}}if(Re.ia&&alert("todo:DitherRow"),De.put!=null){if(Ir=16*fn,fn=16*(fn+1),Fi?(De.y=Re.sa,De.O=Re.ta+Tn,De.f=Re.qa,De.N=Re.ra+di,De.ea=Re.Ha,De.W=Re.Ia+di):(Ir-=Ur,De.y=Ht,De.O=fr,De.f=Kt,De.N=xt,De.ea=sn,De.W=dn),Jr||(fn-=Ur),fn>De.o&&(fn=De.o),De.F=null,De.J=null,Re.Fa!=null&&0<Re.Fa.length&&Ir<fn&&(De.J=pu(Re,De,Ir,fn-Ir),De.F=Re.mb,De.F==null&&De.F.length==0)){gt=Kr(Re,3,"Could not decode alpha data.");break e}Ir<De.j&&(Ur=De.j-Ir,Ir=De.j,e(!(1&Ur)),De.O+=Re.R*Ur,De.N+=Re.B*(Ur>>1),De.W+=Re.B*(Ur>>1),De.F!=null&&(De.J+=De.width*Ur)),Ir<fn&&(De.O+=De.v,De.N+=De.v>>1,De.W+=De.v>>1,De.F!=null&&(De.J+=De.v),De.ka=Ir-De.j,De.U=De.va-De.v,De.T=fn-Ir,gt=De.put(De))}at+1!=Re.Ic||Jr||(n(Re.sa,Re.ta-Nt,Ht,fr+16*Re.R,Nt),n(Re.qa,Re.ra-Xt,Kt,xt+8*Re.B,Xt),n(Re.Ha,Re.Ia-Xt,sn,dn+8*Re.B,Xt))}if(!gt)return Kr(Oe,6,"Output aborted.")}return 1}(x,_)),_.bc!=null&&_.bc(_),P&=1}return P?(x.cb=0,P):0}function oi(x,_,P,z,J){J=x[_+P+32*z]+(J>>3),x[_+P+32*z]=-256&J?0>J?0:255:J}function eu(x,_,P,z,J,ne){oi(x,_,0,P,z+J),oi(x,_,1,P,z+ne),oi(x,_,2,P,z-ne),oi(x,_,3,P,z-J)}function rs(x){return(20091*x>>16)+x}function qa(x,_,P,z){var J,ne=0,ie=a(16);for(J=0;4>J;++J){var ce=x[_+0]+x[_+8],me=x[_+0]-x[_+8],ve=(35468*x[_+4]>>16)-rs(x[_+12]),Pe=rs(x[_+4])+(35468*x[_+12]>>16);ie[ne+0]=ce+Pe,ie[ne+1]=me+ve,ie[ne+2]=me-ve,ie[ne+3]=ce-Pe,ne+=4,_++}for(J=ne=0;4>J;++J)ce=(x=ie[ne+0]+4)+ie[ne+8],me=x-ie[ne+8],ve=(35468*ie[ne+4]>>16)-rs(ie[ne+12]),oi(P,z,0,0,ce+(Pe=rs(ie[ne+4])+(35468*ie[ne+12]>>16))),oi(P,z,1,0,me+ve),oi(P,z,2,0,me-ve),oi(P,z,3,0,ce-Pe),ne++,z+=32}function Yl(x,_,P,z){var J=x[_+0]+4,ne=35468*x[_+4]>>16,ie=rs(x[_+4]),ce=35468*x[_+1]>>16;eu(P,z,0,J+ie,x=rs(x[_+1]),ce),eu(P,z,1,J+ne,x,ce),eu(P,z,2,J-ne,x,ce),eu(P,z,3,J-ie,x,ce)}function tu(x,_,P,z,J){qa(x,_,P,z),J&&qa(x,_+16,P,z+4)}function Zd(x,_,P,z){sc(x,_+0,P,z,1),sc(x,_+32,P,z+128,1)}function un(x,_,P,z){var J;for(x=x[_+0]+4,J=0;4>J;++J)for(_=0;4>_;++_)oi(P,z,_,J,x)}function Xl(x,_,P,z){x[_+0]&&Ha(x,_+0,P,z),x[_+16]&&Ha(x,_+16,P,z+4),x[_+32]&&Ha(x,_+32,P,z+128),x[_+48]&&Ha(x,_+48,P,z+128+4)}function Ql(x,_,P,z){var J,ne=a(16);for(J=0;4>J;++J){var ie=x[_+0+J]+x[_+12+J],ce=x[_+4+J]+x[_+8+J],me=x[_+4+J]-x[_+8+J],ve=x[_+0+J]-x[_+12+J];ne[0+J]=ie+ce,ne[8+J]=ie-ce,ne[4+J]=ve+me,ne[12+J]=ve-me}for(J=0;4>J;++J)ie=(x=ne[0+4*J]+3)+ne[3+4*J],ce=ne[1+4*J]+ne[2+4*J],me=ne[1+4*J]-ne[2+4*J],ve=x-ne[3+4*J],P[z+0]=ie+ce>>3,P[z+16]=ve+me>>3,P[z+32]=ie-ce>>3,P[z+48]=ve-me>>3,z+=64}function Ro(x,_,P){var z,J=_-32,ne=Di,ie=255-x[J-1];for(z=0;z<P;++z){var ce,me=ne,ve=ie+x[_-1];for(ce=0;ce<P;++ce)x[_+ce]=me[ve+x[J+ce]];_+=32}}function Om(x,_){Ro(x,_,4)}function Ah(x,_){Ro(x,_,8)}function Mm(x,_){Ro(x,_,16)}function Do(x,_){var P;for(P=0;16>P;++P)n(x,_+32*P,x,_-32,16)}function ru(x,_){var P;for(P=16;0<P;--P)s(x,_,x[_-1],16),_+=32}function nu(x,_,P){var z;for(z=0;16>z;++z)s(_,P+32*z,x,16)}function fl(x,_){var P,z=16;for(P=0;16>P;++P)z+=x[_-1+32*P]+x[_+P-32];nu(z>>5,x,_)}function Pn(x,_){var P,z=8;for(P=0;16>P;++P)z+=x[_-1+32*P];nu(z>>4,x,_)}function Eh(x,_){var P,z=8;for(P=0;16>P;++P)z+=x[_+P-32];nu(z>>4,x,_)}function ef(x,_){nu(128,x,_)}function wr(x,_,P){return x+2*_+P+2>>2}function hl(x,_){var P,z=_-32;for(z=new Uint8Array([wr(x[z-1],x[z+0],x[z+1]),wr(x[z+0],x[z+1],x[z+2]),wr(x[z+1],x[z+2],x[z+3]),wr(x[z+2],x[z+3],x[z+4])]),P=0;4>P;++P)n(x,_+32*P,z,0,z.length)}function Vm(x,_){var P=x[_-1],z=x[_-1+32],J=x[_-1+64],ne=x[_-1+96];V(x,_+0,16843009*wr(x[_-1-32],P,z)),V(x,_+32,16843009*wr(P,z,J)),V(x,_+64,16843009*wr(z,J,ne)),V(x,_+96,16843009*wr(J,ne,ne))}function ao(x,_){var P,z=4;for(P=0;4>P;++P)z+=x[_+P-32]+x[_-1+32*P];for(z>>=3,P=0;4>P;++P)s(x,_+32*P,z,4)}function Ch(x,_){var P=x[_-1+0],z=x[_-1+32],J=x[_-1+64],ne=x[_-1-32],ie=x[_+0-32],ce=x[_+1-32],me=x[_+2-32],ve=x[_+3-32];x[_+0+96]=wr(z,J,x[_-1+96]),x[_+1+96]=x[_+0+64]=wr(P,z,J),x[_+2+96]=x[_+1+64]=x[_+0+32]=wr(ne,P,z),x[_+3+96]=x[_+2+64]=x[_+1+32]=x[_+0+0]=wr(ie,ne,P),x[_+3+64]=x[_+2+32]=x[_+1+0]=wr(ce,ie,ne),x[_+3+32]=x[_+2+0]=wr(me,ce,ie),x[_+3+0]=wr(ve,me,ce)}function ji(x,_){var P=x[_+1-32],z=x[_+2-32],J=x[_+3-32],ne=x[_+4-32],ie=x[_+5-32],ce=x[_+6-32],me=x[_+7-32];x[_+0+0]=wr(x[_+0-32],P,z),x[_+1+0]=x[_+0+32]=wr(P,z,J),x[_+2+0]=x[_+1+32]=x[_+0+64]=wr(z,J,ne),x[_+3+0]=x[_+2+32]=x[_+1+64]=x[_+0+96]=wr(J,ne,ie),x[_+3+32]=x[_+2+64]=x[_+1+96]=wr(ne,ie,ce),x[_+3+64]=x[_+2+96]=wr(ie,ce,me),x[_+3+96]=wr(ce,me,me)}function su(x,_){var P=x[_-1+0],z=x[_-1+32],J=x[_-1+64],ne=x[_-1-32],ie=x[_+0-32],ce=x[_+1-32],me=x[_+2-32],ve=x[_+3-32];x[_+0+0]=x[_+1+64]=ne+ie+1>>1,x[_+1+0]=x[_+2+64]=ie+ce+1>>1,x[_+2+0]=x[_+3+64]=ce+me+1>>1,x[_+3+0]=me+ve+1>>1,x[_+0+96]=wr(J,z,P),x[_+0+64]=wr(z,P,ne),x[_+0+32]=x[_+1+96]=wr(P,ne,ie),x[_+1+32]=x[_+2+96]=wr(ne,ie,ce),x[_+2+32]=x[_+3+96]=wr(ie,ce,me),x[_+3+32]=wr(ce,me,ve)}function tf(x,_){var P=x[_+0-32],z=x[_+1-32],J=x[_+2-32],ne=x[_+3-32],ie=x[_+4-32],ce=x[_+5-32],me=x[_+6-32],ve=x[_+7-32];x[_+0+0]=P+z+1>>1,x[_+1+0]=x[_+0+64]=z+J+1>>1,x[_+2+0]=x[_+1+64]=J+ne+1>>1,x[_+3+0]=x[_+2+64]=ne+ie+1>>1,x[_+0+32]=wr(P,z,J),x[_+1+32]=x[_+0+96]=wr(z,J,ne),x[_+2+32]=x[_+1+96]=wr(J,ne,ie),x[_+3+32]=x[_+2+96]=wr(ne,ie,ce),x[_+3+64]=wr(ie,ce,me),x[_+3+96]=wr(ce,me,ve)}function au(x,_){var P=x[_-1+0],z=x[_-1+32],J=x[_-1+64],ne=x[_-1+96];x[_+0+0]=P+z+1>>1,x[_+2+0]=x[_+0+32]=z+J+1>>1,x[_+2+32]=x[_+0+64]=J+ne+1>>1,x[_+1+0]=wr(P,z,J),x[_+3+0]=x[_+1+32]=wr(z,J,ne),x[_+3+32]=x[_+1+64]=wr(J,ne,ne),x[_+3+64]=x[_+2+64]=x[_+0+96]=x[_+1+96]=x[_+2+96]=x[_+3+96]=ne}function iu(x,_){var P=x[_-1+0],z=x[_-1+32],J=x[_-1+64],ne=x[_-1+96],ie=x[_-1-32],ce=x[_+0-32],me=x[_+1-32],ve=x[_+2-32];x[_+0+0]=x[_+2+32]=P+ie+1>>1,x[_+0+32]=x[_+2+64]=z+P+1>>1,x[_+0+64]=x[_+2+96]=J+z+1>>1,x[_+0+96]=ne+J+1>>1,x[_+3+0]=wr(ce,me,ve),x[_+2+0]=wr(ie,ce,me),x[_+1+0]=x[_+3+32]=wr(P,ie,ce),x[_+1+32]=x[_+3+64]=wr(z,P,ie),x[_+1+64]=x[_+3+96]=wr(J,z,P),x[_+1+96]=wr(ne,J,z)}function kh(x,_){var P;for(P=0;8>P;++P)n(x,_+32*P,x,_-32,8)}function Fo(x,_){var P;for(P=0;8>P;++P)s(x,_,x[_-1],8),_+=32}function Pi(x,_,P){var z;for(z=0;8>z;++z)s(_,P+32*z,x,8)}function Lo(x,_){var P,z=8;for(P=0;8>P;++P)z+=x[_+P-32]+x[_-1+32*P];Pi(z>>4,x,_)}function rf(x,_){var P,z=4;for(P=0;8>P;++P)z+=x[_+P-32];Pi(z>>3,x,_)}function on(x,_){var P,z=4;for(P=0;8>P;++P)z+=x[_-1+32*P];Pi(z>>3,x,_)}function nf(x,_){Pi(128,x,_)}function ou(x,_,P){var z=x[_-P],J=x[_+0],ne=3*(J-z)+pb[1020+x[_-2*P]-x[_+P]],ie=Jx[112+(ne+4>>3)];x[_-P]=Di[255+z+Jx[112+(ne+3>>3)]],x[_+0]=Di[255+J-ie]}function sf(x,_,P,z){var J=x[_+0],ne=x[_+P];return uo[255+x[_-2*P]-x[_-P]]>z||uo[255+ne-J]>z}function af(x,_,P,z){return 4*uo[255+x[_-P]-x[_+0]]+uo[255+x[_-2*P]-x[_+P]]<=z}function of(x,_,P,z,J){var ne=x[_-3*P],ie=x[_-2*P],ce=x[_-P],me=x[_+0],ve=x[_+P],Pe=x[_+2*P],He=x[_+3*P];return 4*uo[255+ce-me]+uo[255+ie-ve]>z?0:uo[255+x[_-4*P]-ne]<=J&&uo[255+ne-ie]<=J&&uo[255+ie-ce]<=J&&uo[255+He-Pe]<=J&&uo[255+Pe-ve]<=J&&uo[255+ve-me]<=J}function Jl(x,_,P,z){var J=2*z+1;for(z=0;16>z;++z)af(x,_+z,P,J)&&ou(x,_+z,P)}function Ri(x,_,P,z){var J=2*z+1;for(z=0;16>z;++z)af(x,_+z*P,1,J)&&ou(x,_+z*P,1)}function Ms(x,_,P,z){var J;for(J=3;0<J;--J)Jl(x,_+=4*P,P,z)}function Ih(x,_,P,z){var J;for(J=3;0<J;--J)Ri(x,_+=4,P,z)}function ml(x,_,P,z,J,ne,ie,ce){for(ne=2*ne+1;0<J--;){if(of(x,_,P,ne,ie))if(sf(x,_,P,ce))ou(x,_,P);else{var me=x,ve=_,Pe=P,He=me[ve-2*Pe],Ge=me[ve-Pe],Oe=me[ve+0],yt=me[ve+Pe],at=me[ve+2*Pe],Re=27*(gt=pb[1020+3*(Oe-Ge)+pb[1020+He-yt]])+63>>7,De=18*gt+63>>7,gt=9*gt+63>>7;me[ve-3*Pe]=Di[255+me[ve-3*Pe]+gt],me[ve-2*Pe]=Di[255+He+De],me[ve-Pe]=Di[255+Ge+Re],me[ve+0]=Di[255+Oe-Re],me[ve+Pe]=Di[255+yt-De],me[ve+2*Pe]=Di[255+at-gt]}_+=z}}function ia(x,_,P,z,J,ne,ie,ce){for(ne=2*ne+1;0<J--;){if(of(x,_,P,ne,ie))if(sf(x,_,P,ce))ou(x,_,P);else{var me=x,ve=_,Pe=P,He=me[ve-Pe],Ge=me[ve+0],Oe=me[ve+Pe],yt=Jx[112+((at=3*(Ge-He))+4>>3)],at=Jx[112+(at+3>>3)],Re=yt+1>>1;me[ve-2*Pe]=Di[255+me[ve-2*Pe]+Re],me[ve-Pe]=Di[255+He+at],me[ve+0]=Di[255+Ge-yt],me[ve+Pe]=Di[255+Oe-Re]}_+=z}}function lu(x,_,P,z,J,ne){ml(x,_,P,1,16,z,J,ne)}function Oo(x,_,P,z,J,ne){ml(x,_,1,P,16,z,J,ne)}function cu(x,_,P,z,J,ne){var ie;for(ie=3;0<ie;--ie)ia(x,_+=4*P,P,1,16,z,J,ne)}function Zl(x,_,P,z,J,ne){var ie;for(ie=3;0<ie;--ie)ia(x,_+=4,1,P,16,z,J,ne)}function uu(x,_,P,z,J,ne,ie,ce){ml(x,_,J,1,8,ne,ie,ce),ml(P,z,J,1,8,ne,ie,ce)}function lf(x,_,P,z,J,ne,ie,ce){ml(x,_,1,J,8,ne,ie,ce),ml(P,z,1,J,8,ne,ie,ce)}function du(x,_,P,z,J,ne,ie,ce){ia(x,_+4*J,J,1,8,ne,ie,ce),ia(P,z+4*J,J,1,8,ne,ie,ce)}function pl(x,_,P,z,J,ne,ie,ce){ia(x,_+4,1,J,8,ne,ie,ce),ia(P,z+4,1,J,8,ne,ie,ce)}function ec(){this.ba=new et,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new vt,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function fu(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function tc(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function hu(){this.ua=0,this.Wa=new he,this.vb=new he,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new G,this.yc=new E}function jh(){this.xb=this.a=0,this.l=new As,this.ca=new et,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new C,this.Pb=0,this.wd=new C,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new hu,this.ab=0,this.gc=i(4,tc),this.Oc=0}function Mo(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new As,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function gl(x,_,P,z,J,ne,ie){for(x=x==null?0:x[_+0],_=0;_<ie;++_)J[ne+_]=x+P[z+_]&255,x=J[ne+_]}function mu(x,_,P,z,J,ne,ie){var ce;if(x==null)gl(null,null,P,z,J,ne,ie);else for(ce=0;ce<ie;++ce)J[ne+ce]=x[_+ce]+P[z+ce]&255}function va(x,_,P,z,J,ne,ie){if(x==null)gl(null,null,P,z,J,ne,ie);else{var ce,me=x[_+0],ve=me,Pe=me;for(ce=0;ce<ie;++ce)ve=Pe+(me=x[_+ce])-ve,Pe=P[z+ce]+(-256&ve?0>ve?0:255:ve)&255,ve=me,J[ne+ce]=Pe}}function pu(x,_,P,z){var J=_.width,ne=_.o;if(e(x!=null&&_!=null),0>P||0>=z||P+z>ne)return null;if(!x.Cc){if(x.ga==null){var ie;if(x.ga=new Mo,(ie=x.ga==null)||(ie=_.width*_.o,e(x.Gb.length==0),x.Gb=a(ie),x.Uc=0,x.Gb==null?ie=0:(x.mb=x.Gb,x.nb=x.Uc,x.rc=null,ie=1),ie=!ie),!ie){ie=x.ga;var ce=x.Fa,me=x.P,ve=x.qc,Pe=x.mb,He=x.nb,Ge=me+1,Oe=ve-1,yt=ie.l;if(e(ce!=null&&Pe!=null&&_!=null),wu[0]=null,wu[1]=gl,wu[2]=mu,wu[3]=va,ie.ca=Pe,ie.tb=He,ie.c=_.width,ie.i=_.height,e(0<ie.c&&0<ie.i),1>=ve)_=0;else if(ie.$a=ce[me+0]>>0&3,ie.Z=ce[me+0]>>2&3,ie.Lc=ce[me+0]>>4&3,me=ce[me+0]>>6&3,0>ie.$a||1<ie.$a||4<=ie.Z||1<ie.Lc||me)_=0;else if(yt.put=dr,yt.ac=nr,yt.bc=Vr,yt.ma=ie,yt.width=_.width,yt.height=_.height,yt.Da=_.Da,yt.v=_.v,yt.va=_.va,yt.j=_.j,yt.o=_.o,ie.$a)e:{e(ie.$a==1),_=rt();t:for(;;){if(_==null){_=0;break e}if(e(ie!=null),ie.mc=_,_.c=ie.c,_.i=ie.i,_.l=ie.l,_.l.ma=ie,_.l.width=ie.c,_.l.height=ie.i,_.a=0,se(_.m,ce,Ge,Oe),!ze(ie.c,ie.i,1,_,null)||(_.ab==1&&_.gc[0].hc==3&&pe(_.s)?(ie.ic=1,ce=_.c*_.i,_.Ta=null,_.Ua=0,_.V=a(ce),_.Ba=0,_.V==null?(_.a=1,_=0):_=1):(ie.ic=0,_=We(_,ie.c)),!_))break t;_=1;break e}ie.mc=null,_=0}else _=Oe>=ie.c*ie.i;ie=!_}if(ie)return null;x.ga.Lc!=1?x.Ga=0:z=ne-P}e(x.ga!=null),e(P+z<=ne);e:{if(_=(ce=x.ga).c,ne=ce.l.o,ce.$a==0){if(Ge=x.rc,Oe=x.Vc,yt=x.Fa,me=x.P+1+P*_,ve=x.mb,Pe=x.nb+P*_,e(me<=x.P+x.qc),ce.Z!=0)for(e(wu[ce.Z]!=null),ie=0;ie<z;++ie)wu[ce.Z](Ge,Oe,yt,me,ve,Pe,_),Ge=ve,Oe=Pe,Pe+=_,me+=_;else for(ie=0;ie<z;++ie)n(ve,Pe,yt,me,_),Ge=ve,Oe=Pe,Pe+=_,me+=_;x.rc=Ge,x.Vc=Oe}else{if(e(ce.mc!=null),_=P+z,e((ie=ce.mc)!=null),e(_<=ie.i),ie.C>=_)_=1;else if(ce.ic||Le(),ce.ic){ce=ie.V,Ge=ie.Ba,Oe=ie.c;var at=ie.i,Re=(yt=1,me=ie.$/Oe,ve=ie.$%Oe,Pe=ie.m,He=ie.s,ie.$),De=Oe*at,gt=Oe*_,Nt=He.wc,xt=Re<gt?ir(He,ve,me):null;e(Re<=De),e(_<=at),e(pe(He));t:for(;;){for(;!Pe.h&&Re<gt;){if(ve&Nt||(xt=ir(He,ve,me)),e(xt!=null),K(Pe),256>(at=Wr(xt.G[0],xt.H[0],Pe)))ce[Ge+Re]=at,++Re,++ve>=Oe&&(ve=0,++me<=_&&!(me%16)&&we(ie,me));else{if(!(280>at)){yt=0;break t}at=qr(at-256,Pe);var Xt,Ht=Wr(xt.G[4],xt.H[4],Pe);if(K(Pe),!(Re>=(Ht=Qr(Oe,Ht=qr(Ht,Pe)))&&De-Re>=at)){yt=0;break t}for(Xt=0;Xt<at;++Xt)ce[Ge+Re+Xt]=ce[Ge+Re+Xt-Ht];for(Re+=at,ve+=at;ve>=Oe;)ve-=Oe,++me<=_&&!(me%16)&&we(ie,me);Re<gt&&ve&Nt&&(xt=ir(He,ve,me))}e(Pe.h==L(Pe))}we(ie,me>_?_:me);break t}!yt||Pe.h&&Re<De?(yt=0,ie.a=Pe.h?5:3):ie.$=Re,_=yt}else _=_e(ie,ie.V,ie.Ba,ie.c,ie.i,_,Xe);if(!_){z=0;break e}}P+z>=ne&&(x.Cc=1),z=1}if(!z)return null;if(x.Cc&&((z=x.ga)!=null&&(z.mc=null),x.ga=null,0<x.Ga))return alert("todo:WebPDequantizeLevels"),null}return x.nb+P*J}function T(x,_,P,z,J,ne){for(;0<J--;){var ie,ce=x,me=_+(P?1:0),ve=x,Pe=_+(P?0:3);for(ie=0;ie<z;++ie){var He=ve[Pe+4*ie];He!=255&&(He*=32897,ce[me+4*ie+0]=ce[me+4*ie+0]*He>>23,ce[me+4*ie+1]=ce[me+4*ie+1]*He>>23,ce[me+4*ie+2]=ce[me+4*ie+2]*He>>23)}_+=ne}}function Q(x,_,P,z,J){for(;0<z--;){var ne;for(ne=0;ne<P;++ne){var ie=x[_+2*ne+0],ce=15&(ve=x[_+2*ne+1]),me=4369*ce,ve=(240&ve|ve>>4)*me>>16;x[_+2*ne+0]=(240&ie|ie>>4)*me>>16&240|(15&ie|ie<<4)*me>>16>>4&15,x[_+2*ne+1]=240&ve|ce}_+=J}}function Se(x,_,P,z,J,ne,ie,ce){var me,ve,Pe=255;for(ve=0;ve<J;++ve){for(me=0;me<z;++me){var He=x[_+me];ne[ie+4*me]=He,Pe&=He}_+=P,ie+=ce}return Pe!=255}function ke(x,_,P,z,J){var ne;for(ne=0;ne<J;++ne)P[z+ne]=x[_+ne]>>8}function Le(){co=T,Cn=Q,kn=Se,ms=ke}function ot(x,_,P){S[x]=function(z,J,ne,ie,ce,me,ve,Pe,He,Ge,Oe,yt,at,Re,De,gt,Nt){var xt,Xt=Nt-1>>1,Ht=ce[me+0]|ve[Pe+0]<<16,fr=He[Ge+0]|Oe[yt+0]<<16;e(z!=null);var Kt=3*Ht+fr+131074>>2;for(_(z[J+0],255&Kt,Kt>>16,at,Re),ne!=null&&(Kt=3*fr+Ht+131074>>2,_(ne[ie+0],255&Kt,Kt>>16,De,gt)),xt=1;xt<=Xt;++xt){var sn=ce[me+xt]|ve[Pe+xt]<<16,dn=He[Ge+xt]|Oe[yt+xt]<<16,Jr=Ht+sn+fr+dn+524296,Ur=Jr+2*(sn+fr)>>3;Kt=Ur+Ht>>1,Ht=(Jr=Jr+2*(Ht+dn)>>3)+sn>>1,_(z[J+2*xt-1],255&Kt,Kt>>16,at,Re+(2*xt-1)*P),_(z[J+2*xt-0],255&Ht,Ht>>16,at,Re+(2*xt-0)*P),ne!=null&&(Kt=Jr+fr>>1,Ht=Ur+dn>>1,_(ne[ie+2*xt-1],255&Kt,Kt>>16,De,gt+(2*xt-1)*P),_(ne[ie+2*xt+0],255&Ht,Ht>>16,De,gt+(2*xt+0)*P)),Ht=sn,fr=dn}1&Nt||(Kt=3*Ht+fr+131074>>2,_(z[J+Nt-1],255&Kt,Kt>>16,at,Re+(Nt-1)*P),ne!=null&&(Kt=3*fr+Ht+131074>>2,_(ne[ie+Nt-1],255&Kt,Kt>>16,De,gt+(Nt-1)*P)))}}function Tt(){fo[Zx]=N7,fo[e1]=E3,fo[_3]=S7,fo[t1]=C3,fo[r1]=k3,fo[gb]=I3,fo[N3]=T7,fo[xb]=E3,fo[yb]=C3,fo[n1]=k3,fo[vb]=I3}function Gt(x){return x&-16384?0>x?0:255:x>>A7}function y(x,_){return Gt((19077*x>>8)+(26149*_>>8)-14234)}function R(x,_,P){return Gt((19077*x>>8)-(6419*_>>8)-(13320*P>>8)+8708)}function W(x,_){return Gt((19077*x>>8)+(33050*_>>8)-17685)}function le(x,_,P,z,J){z[J+0]=y(x,P),z[J+1]=R(x,_,P),z[J+2]=W(x,_)}function Fe(x,_,P,z,J){z[J+0]=W(x,_),z[J+1]=R(x,_,P),z[J+2]=y(x,P)}function Qe(x,_,P,z,J){var ne=R(x,_,P);_=ne<<3&224|W(x,_)>>3,z[J+0]=248&y(x,P)|ne>>5,z[J+1]=_}function Ct(x,_,P,z,J){var ne=240&W(x,_)|15;z[J+0]=240&y(x,P)|R(x,_,P)>>4,z[J+1]=ne}function Ar(x,_,P,z,J){z[J+0]=255,le(x,_,P,z,J+1)}function Br(x,_,P,z,J){Fe(x,_,P,z,J),z[J+3]=255}function Er(x,_,P,z,J){le(x,_,P,z,J),z[J+3]=255}function ln(x,_){return 0>x?0:x>_?_:x}function Sn(x,_,P){S[x]=function(z,J,ne,ie,ce,me,ve,Pe,He){for(var Ge=Pe+(-2&He)*P;Pe!=Ge;)_(z[J+0],ne[ie+0],ce[me+0],ve,Pe),_(z[J+1],ne[ie+0],ce[me+0],ve,Pe+P),J+=2,++ie,++me,Pe+=2*P;1&He&&_(z[J+0],ne[ie+0],ce[me+0],ve,Pe)}}function Vo(x,_,P){return P==0?x==0?_==0?6:5:_==0?4:0:P}function oa(x,_,P,z,J){switch(x>>>30){case 3:sc(_,P,z,J,0);break;case 2:hs(_,P,z,J);break;case 1:Ha(_,P,z,J)}}function xl(x,_){var P,z,J=_.M,ne=_.Nb,ie=x.oc,ce=x.pc+40,me=x.oc,ve=x.pc+584,Pe=x.oc,He=x.pc+600;for(P=0;16>P;++P)ie[ce+32*P-1]=129;for(P=0;8>P;++P)me[ve+32*P-1]=129,Pe[He+32*P-1]=129;for(0<J?ie[ce-1-32]=me[ve-1-32]=Pe[He-1-32]=129:(s(ie,ce-32-1,127,21),s(me,ve-32-1,127,9),s(Pe,He-32-1,127,9)),z=0;z<x.za;++z){var Ge=_.ya[_.aa+z];if(0<z){for(P=-1;16>P;++P)n(ie,ce+32*P-4,ie,ce+32*P+12,4);for(P=-1;8>P;++P)n(me,ve+32*P-4,me,ve+32*P+4,4),n(Pe,He+32*P-4,Pe,He+32*P+4,4)}var Oe=x.Gd,yt=x.Hd+z,at=Ge.ad,Re=Ge.Hc;if(0<J&&(n(ie,ce-32,Oe[yt].y,0,16),n(me,ve-32,Oe[yt].f,0,8),n(Pe,He-32,Oe[yt].ea,0,8)),Ge.Za){var De=ie,gt=ce-32+16;for(0<J&&(z>=x.za-1?s(De,gt,Oe[yt].y[15],4):n(De,gt,Oe[yt+1].y,0,4)),P=0;4>P;P++)De[gt+128+P]=De[gt+256+P]=De[gt+384+P]=De[gt+0+P];for(P=0;16>P;++P,Re<<=2)De=ie,gt=ce+P3[P],Bo[Ge.Ob[P]](De,gt),oa(Re,at,16*+P,De,gt)}else if(De=Vo(z,J,Ge.Ob[0]),bu[De](ie,ce),Re!=0)for(P=0;16>P;++P,Re<<=2)oa(Re,at,16*+P,ie,ce+P3[P]);for(P=Ge.Gc,De=Vo(z,J,Ge.Dd),ic[De](me,ve),ic[De](Pe,He),Re=at,De=me,gt=ve,255&(Ge=P>>0)&&(170&Ge?qm(Re,256,De,gt):oo(Re,256,De,gt)),Ge=Pe,Re=He,255&(P>>=8)&&(170&P?qm(at,320,Ge,Re):oo(at,320,Ge,Re)),J<x.Ub-1&&(n(Oe[yt].y,0,ie,ce+480,16),n(Oe[yt].f,0,me,ve+224,8),n(Oe[yt].ea,0,Pe,He+224,8)),P=8*ne*x.B,Oe=x.sa,yt=x.ta+16*z+16*ne*x.R,at=x.qa,Ge=x.ra+8*z+P,Re=x.Ha,De=x.Ia+8*z+P,P=0;16>P;++P)n(Oe,yt+P*x.R,ie,ce+32*P,16);for(P=0;8>P;++P)n(at,Ge+P*x.B,me,ve+32*P,8),n(Re,De+P*x.B,Pe,He+32*P,8)}}function yl(x,_,P,z,J,ne,ie,ce,me){var ve=[0],Pe=[0],He=0,Ge=me!=null?me.kd:0,Oe=me??new fu;if(x==null||12>P)return 7;Oe.data=x,Oe.w=_,Oe.ha=P,_=[_],P=[P],Oe.gb=[Oe.gb];e:{var yt=_,at=P,Re=Oe.gb;if(e(x!=null),e(at!=null),e(Re!=null),Re[0]=0,12<=at[0]&&!r(x,yt[0],"RIFF")){if(r(x,yt[0]+8,"WEBP")){Re=3;break e}var De=Ee(x,yt[0]+4);if(12>De||4294967286<De){Re=3;break e}if(Ge&&De>at[0]-8){Re=7;break e}Re[0]=De,yt[0]+=12,at[0]-=12}Re=0}if(Re!=0)return Re;for(De=0<Oe.gb[0],P=P[0];;){e:{var gt=x;at=_,Re=P;var Nt=ve,xt=Pe,Xt=yt=[0];if((Kt=He=[He])[0]=0,8>Re[0])Re=7;else{if(!r(gt,at[0],"VP8X")){if(Ee(gt,at[0]+4)!=10){Re=3;break e}if(18>Re[0]){Re=7;break e}var Ht=Ee(gt,at[0]+8),fr=1+B(gt,at[0]+12);if(2147483648<=fr*(gt=1+B(gt,at[0]+15))){Re=3;break e}Xt!=null&&(Xt[0]=Ht),Nt!=null&&(Nt[0]=fr),xt!=null&&(xt[0]=gt),at[0]+=18,Re[0]-=18,Kt[0]=1}Re=0}}if(He=He[0],yt=yt[0],Re!=0)return Re;if(at=!!(2&yt),!De&&He)return 3;if(ne!=null&&(ne[0]=!!(16&yt)),ie!=null&&(ie[0]=at),ce!=null&&(ce[0]=0),ie=ve[0],yt=Pe[0],He&&at&&me==null){Re=0;break}if(4>P){Re=7;break}if(De&&He||!De&&!He&&!r(x,_[0],"ALPH")){P=[P],Oe.na=[Oe.na],Oe.P=[Oe.P],Oe.Sa=[Oe.Sa];e:{Ht=x,Re=_,De=P;var Kt=Oe.gb;Nt=Oe.na,xt=Oe.P,Xt=Oe.Sa,fr=22,e(Ht!=null),e(De!=null),gt=Re[0];var sn=De[0];for(e(Nt!=null),e(Xt!=null),Nt[0]=null,xt[0]=null,Xt[0]=0;;){if(Re[0]=gt,De[0]=sn,8>sn){Re=7;break e}var dn=Ee(Ht,gt+4);if(4294967286<dn){Re=3;break e}var Jr=8+dn+1&-2;if(fr+=Jr,0<Kt&&fr>Kt){Re=3;break e}if(!r(Ht,gt,"VP8 ")||!r(Ht,gt,"VP8L")){Re=0;break e}if(sn[0]<Jr){Re=7;break e}r(Ht,gt,"ALPH")||(Nt[0]=Ht,xt[0]=gt+8,Xt[0]=dn),gt+=Jr,sn-=Jr}}if(P=P[0],Oe.na=Oe.na[0],Oe.P=Oe.P[0],Oe.Sa=Oe.Sa[0],Re!=0)break}P=[P],Oe.Ja=[Oe.Ja],Oe.xa=[Oe.xa];e:if(Kt=x,Re=_,De=P,Nt=Oe.gb[0],xt=Oe.Ja,Xt=Oe.xa,Ht=Re[0],gt=!r(Kt,Ht,"VP8 "),fr=!r(Kt,Ht,"VP8L"),e(Kt!=null),e(De!=null),e(xt!=null),e(Xt!=null),8>De[0])Re=7;else{if(gt||fr){if(Kt=Ee(Kt,Ht+4),12<=Nt&&Kt>Nt-12){Re=3;break e}if(Ge&&Kt>De[0]-8){Re=7;break e}xt[0]=Kt,Re[0]+=8,De[0]-=8,Xt[0]=fr}else Xt[0]=5<=De[0]&&Kt[Ht+0]==47&&!(Kt[Ht+4]>>5),xt[0]=De[0];Re=0}if(P=P[0],Oe.Ja=Oe.Ja[0],Oe.xa=Oe.xa[0],_=_[0],Re!=0)break;if(4294967286<Oe.Ja)return 3;if(ce==null||at||(ce[0]=Oe.xa?2:1),ie=[ie],yt=[yt],Oe.xa){if(5>P){Re=7;break}ce=ie,Ge=yt,at=ne,x==null||5>P?x=0:5<=P&&x[_+0]==47&&!(x[_+4]>>5)?(De=[0],Kt=[0],Nt=[0],se(xt=new C,x,_,P),Et(xt,De,Kt,Nt)?(ce!=null&&(ce[0]=De[0]),Ge!=null&&(Ge[0]=Kt[0]),at!=null&&(at[0]=Nt[0]),x=1):x=0):x=0}else{if(10>P){Re=7;break}ce=yt,x==null||10>P||!En(x,_+3,P-3)?x=0:(Ge=x[_+0]|x[_+1]<<8|x[_+2]<<16,at=16383&(x[_+7]<<8|x[_+6]),x=16383&(x[_+9]<<8|x[_+8]),1&Ge||3<(Ge>>1&7)||!(Ge>>4&1)||Ge>>5>=Oe.Ja||!at||!x?x=0:(ie&&(ie[0]=at),ce&&(ce[0]=x),x=1))}if(!x||(ie=ie[0],yt=yt[0],He&&(ve[0]!=ie||Pe[0]!=yt)))return 3;me!=null&&(me[0]=Oe,me.offset=_-me.w,e(4294967286>_-me.w),e(me.offset==me.ha-P));break}return Re==0||Re==7&&He&&me==null?(ne!=null&&(ne[0]|=Oe.na!=null&&0<Oe.na.length),z!=null&&(z[0]=ie),J!=null&&(J[0]=yt),0):Re}function Bm(x,_,P){var z=_.width,J=_.height,ne=0,ie=0,ce=z,me=J;if(_.Da=x!=null&&0<x.Da,_.Da&&(ce=x.cd,me=x.bd,ne=x.v,ie=x.j,11>P||(ne&=-2,ie&=-2),0>ne||0>ie||0>=ce||0>=me||ne+ce>z||ie+me>J))return 0;if(_.v=ne,_.j=ie,_.va=ne+ce,_.o=ie+me,_.U=ce,_.T=me,_.da=x!=null&&0<x.da,_.da){if(!qe(ce,me,P=[x.ib],ne=[x.hb]))return 0;_.ib=P[0],_.hb=ne[0]}return _.ob=x!=null&&x.ob,_.Kb=x==null||!x.Sd,_.da&&(_.ob=_.ib<3*z/4&&_.hb<3*J/4,_.Kb=0),1}function Um(x){if(x==null)return 2;if(11>x.S){var _=x.f.RGBA;_.fb+=(x.height-1)*_.A,_.A=-_.A}else _=x.f.kb,x=x.height,_.O+=(x-1)*_.fa,_.fa=-_.fa,_.N+=(x-1>>1)*_.Ab,_.Ab=-_.Ab,_.W+=(x-1>>1)*_.Db,_.Db=-_.Db,_.F!=null&&(_.J+=(x-1)*_.lb,_.lb=-_.lb);return 0}function Ph(x,_,P,z){if(z==null||0>=x||0>=_)return 2;if(P!=null){if(P.Da){var J=P.cd,ne=P.bd,ie=-2&P.v,ce=-2&P.j;if(0>ie||0>ce||0>=J||0>=ne||ie+J>x||ce+ne>_)return 2;x=J,_=ne}if(P.da){if(!qe(x,_,J=[P.ib],ne=[P.hb]))return 2;x=J[0],_=ne[0]}}z.width=x,z.height=_;e:{var me=z.width,ve=z.height;if(x=z.S,0>=me||0>=ve||!(x>=Zx&&13>x))x=2;else{if(0>=z.Rd&&z.sd==null){ie=ne=J=_=0;var Pe=(ce=me*R3[x])*ve;if(11>x||(ne=(ve+1)/2*(_=(me+1)/2),x==12&&(ie=(J=me)*ve)),(ve=a(Pe+2*ne+ie))==null){x=1;break e}z.sd=ve,11>x?((me=z.f.RGBA).eb=ve,me.fb=0,me.A=ce,me.size=Pe):((me=z.f.kb).y=ve,me.O=0,me.fa=ce,me.Fd=Pe,me.f=ve,me.N=0+Pe,me.Ab=_,me.Cd=ne,me.ea=ve,me.W=0+Pe+ne,me.Db=_,me.Ed=ne,x==12&&(me.F=ve,me.J=0+Pe+2*ne),me.Tc=ie,me.lb=J)}if(_=1,J=z.S,ne=z.width,ie=z.height,J>=Zx&&13>J)if(11>J)x=z.f.RGBA,_&=(ce=Math.abs(x.A))*(ie-1)+ne<=x.size,_&=ce>=ne*R3[J],_&=x.eb!=null;else{x=z.f.kb,ce=(ne+1)/2,Pe=(ie+1)/2,me=Math.abs(x.fa),ve=Math.abs(x.Ab);var He=Math.abs(x.Db),Ge=Math.abs(x.lb),Oe=Ge*(ie-1)+ne;_&=me*(ie-1)+ne<=x.Fd,_&=ve*(Pe-1)+ce<=x.Cd,_=(_&=He*(Pe-1)+ce<=x.Ed)&me>=ne&ve>=ce&He>=ce,_&=x.y!=null,_&=x.f!=null,_&=x.ea!=null,J==12&&(_&=Ge>=ne,_&=Oe<=x.Tc,_&=x.F!=null)}else _=0;x=_?0:2}}return x!=0||P!=null&&P.fd&&(x=Um(z)),x}var la=64,Rh=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Dh=24,Fh=32,$m=8,li=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];ue("Predictor0","PredictorAdd0"),S.Predictor0=function(){return 4278190080},S.Predictor1=function(x){return x},S.Predictor2=function(x,_,P){return _[P+0]},S.Predictor3=function(x,_,P){return _[P+1]},S.Predictor4=function(x,_,P){return _[P-1]},S.Predictor5=function(x,_,P){return Ae(Ae(x,_[P+1]),_[P+0])},S.Predictor6=function(x,_,P){return Ae(x,_[P-1])},S.Predictor7=function(x,_,P){return Ae(x,_[P+0])},S.Predictor8=function(x,_,P){return Ae(_[P-1],_[P+0])},S.Predictor9=function(x,_,P){return Ae(_[P+0],_[P+1])},S.Predictor10=function(x,_,P){return Ae(Ae(x,_[P-1]),Ae(_[P+0],_[P+1]))},S.Predictor11=function(x,_,P){var z=_[P+0];return 0>=Ce(z>>24&255,x>>24&255,(_=_[P-1])>>24&255)+Ce(z>>16&255,x>>16&255,_>>16&255)+Ce(z>>8&255,x>>8&255,_>>8&255)+Ce(255&z,255&x,255&_)?z:x},S.Predictor12=function(x,_,P){var z=_[P+0];return(Be((x>>24&255)+(z>>24&255)-((_=_[P-1])>>24&255))<<24|Be((x>>16&255)+(z>>16&255)-(_>>16&255))<<16|Be((x>>8&255)+(z>>8&255)-(_>>8&255))<<8|Be((255&x)+(255&z)-(255&_)))>>>0},S.Predictor13=function(x,_,P){var z=_[P-1];return(Ue((x=Ae(x,_[P+0]))>>24&255,z>>24&255)<<24|Ue(x>>16&255,z>>16&255)<<16|Ue(x>>8&255,z>>8&255)<<8|Ue(x>>0&255,z>>0&255))>>>0};var mb=S.PredictorAdd0;S.PredictorAdd1=Ye,ue("Predictor2","PredictorAdd2"),ue("Predictor3","PredictorAdd3"),ue("Predictor4","PredictorAdd4"),ue("Predictor5","PredictorAdd5"),ue("Predictor6","PredictorAdd6"),ue("Predictor7","PredictorAdd7"),ue("Predictor8","PredictorAdd8"),ue("Predictor9","PredictorAdd9"),ue("Predictor10","PredictorAdd10"),ue("Predictor11","PredictorAdd11"),ue("Predictor12","PredictorAdd12"),ue("Predictor13","PredictorAdd13");var zm=S.PredictorAdd2;Pt("ColorIndexInverseTransform","MapARGB","32b",function(x){return x>>8&255},function(x){return x}),Pt("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(x){return x},function(x){return x>>8&255});var Gx,io=S.ColorIndexInverseTransform,Lh=S.MapARGB,Kx=S.VP8LColorIndexInverseTransformAlpha,Yx=S.MapAlpha,gu=S.VP8LPredictorsAdd=[];gu.length=16,(S.VP8LPredictors=[]).length=16,(S.VP8LPredictorsAdd_C=[]).length=16,(S.VP8LPredictors_C=[]).length=16;var cf,ci,Wa,xu,rc,nc,Oh,sc,hs,qm,Ha,oo,Mh,Xx,Wm,uf,df,yu,ff,Vh,hf,vu,Hm,lo,co,Cn,kn,ms,Vs=a(511),ac=a(2041),Gm=a(225),Bh=a(767),Qx=0,pb=ac,Jx=Gm,Di=Bh,uo=Vs,Zx=0,e1=1,_3=2,t1=3,r1=4,gb=5,N3=6,xb=7,yb=8,n1=9,vb=10,c7=[2,3,7],u7=[3,3,11],S3=[280,256,256,256,40],d7=[0,1,1,1,0],f7=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],h7=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],m7=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],p7=8,bb=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],wb=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Km=null,g7=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],x7=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],T3=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],y7=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],v7=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],b7=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],w7=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],bu=[],Bo=[],ic=[],_7=1,A3=2,wu=[],fo=[];ot("UpsampleRgbLinePair",le,3),ot("UpsampleBgrLinePair",Fe,3),ot("UpsampleRgbaLinePair",Er,4),ot("UpsampleBgraLinePair",Br,4),ot("UpsampleArgbLinePair",Ar,4),ot("UpsampleRgba4444LinePair",Ct,2),ot("UpsampleRgb565LinePair",Qe,2);var N7=S.UpsampleRgbLinePair,S7=S.UpsampleBgrLinePair,E3=S.UpsampleRgbaLinePair,C3=S.UpsampleBgraLinePair,k3=S.UpsampleArgbLinePair,I3=S.UpsampleRgba4444LinePair,T7=S.UpsampleRgb565LinePair,s1=16,a1=1<<s1-1,Ym=-227,_b=482,A7=6,j3=0,E7=a(256),C7=a(256),k7=a(256),I7=a(256),j7=a(_b-Ym),P7=a(_b-Ym);Sn("YuvToRgbRow",le,3),Sn("YuvToBgrRow",Fe,3),Sn("YuvToRgbaRow",Er,4),Sn("YuvToBgraRow",Br,4),Sn("YuvToArgbRow",Ar,4),Sn("YuvToRgba4444Row",Ct,2),Sn("YuvToRgb565Row",Qe,2);var P3=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],i1=[0,2,8],R7=[8,7,6,4,4,2,2,2,1,1,1,1],D7=1;this.WebPDecodeRGBA=function(x,_,P,z,J){var ne=e1,ie=new ec,ce=new et;ie.ba=ce,ce.S=ne,ce.width=[ce.width],ce.height=[ce.height];var me=ce.width,ve=ce.height,Pe=new St;if(Pe==null||x==null)var He=2;else e(Pe!=null),He=yl(x,_,P,Pe.width,Pe.height,Pe.Pd,Pe.Qd,Pe.format,null);if(He!=0?me=0:(me!=null&&(me[0]=Pe.width[0]),ve!=null&&(ve[0]=Pe.height[0]),me=1),me){ce.width=ce.width[0],ce.height=ce.height[0],z!=null&&(z[0]=ce.width),J!=null&&(J[0]=ce.height);e:{if(z=new As,(J=new fu).data=x,J.w=_,J.ha=P,J.kd=1,_=[0],e(J!=null),((x=yl(J.data,J.w,J.ha,null,null,null,_,null,J))==0||x==7)&&_[0]&&(x=4),(_=x)==0){if(e(ie!=null),z.data=J.data,z.w=J.w+J.offset,z.ha=J.ha-J.offset,z.put=dr,z.ac=nr,z.bc=Vr,z.ma=ie,J.xa){if((x=rt())==null){ie=1;break e}if(function(Ge,Oe){var yt=[0],at=[0],Re=[0];t:for(;;){if(Ge==null)return 0;if(Oe==null)return Ge.a=2,0;if(Ge.l=Oe,Ge.a=0,se(Ge.m,Oe.data,Oe.w,Oe.ha),!Et(Ge.m,yt,at,Re)){Ge.a=3;break t}if(Ge.xb=A3,Oe.width=yt[0],Oe.height=at[0],!ze(yt[0],at[0],1,Ge,null))break t;return 1}return e(Ge.a!=0),0}(x,z)){if(z=(_=Ph(z.width,z.height,ie.Oa,ie.ba))==0){t:{z=x;r:for(;;){if(z==null){z=0;break t}if(e(z.s.yc!=null),e(z.s.Ya!=null),e(0<z.s.Wb),e((P=z.l)!=null),e((J=P.ma)!=null),z.xb!=0){if(z.ca=J.ba,z.tb=J.tb,e(z.ca!=null),!Bm(J.Oa,P,t1)){z.a=2;break r}if(!We(z,P.width)||P.da)break r;if((P.da||Wt(z.ca.S))&&Le(),11>z.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),z.ca.f.kb.F!=null&&Le()),z.Pb&&0<z.s.ua&&z.s.vb.X==null&&!Me(z.s.vb,z.s.Wa.Xa)){z.a=1;break r}z.xb=0}if(!_e(z,z.V,z.Ba,z.c,z.i,P.o,be))break r;J.Dc=z.Ma,z=1;break t}e(z.a!=0),z=0}z=!z}z&&(_=x.a)}else _=x.a}else{if((x=new ts)==null){ie=1;break e}if(x.Fa=J.na,x.P=J.P,x.qc=J.Sa,Es(x,z)){if((_=Ph(z.width,z.height,ie.Oa,ie.ba))==0){if(x.Aa=0,P=ie.Oa,e((J=x)!=null),P!=null){if(0<(me=0>(me=P.Md)?0:100<me?255:255*me/100)){for(ve=Pe=0;4>ve;++ve)12>(He=J.pb[ve]).lc&&(He.ia=me*R7[0>He.lc?0:He.lc]>>3),Pe|=He.ia;Pe&&(alert("todo:VP8InitRandom"),J.ia=1)}J.Ga=P.Id,100<J.Ga?J.Ga=100:0>J.Ga&&(J.Ga=0)}Th(x,z)||(_=x.a)}}else _=x.a}_==0&&ie.Oa!=null&&ie.Oa.fd&&(_=Um(ie.ba))}ie=_}ne=ie!=0?null:11>ne?ce.f.RGBA.eb:ce.f.kb.y}else ne=null;return ne};var R3=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function u(S,k){for(var M="",I=0;I<4;I++)M+=String.fromCharCode(S[k++]);return M}function d(S,k){return(S[k+0]<<0|S[k+1]<<8|S[k+2]<<16)>>>0}function f(S,k){return(S[k+0]<<0|S[k+1]<<8|S[k+2]<<16|S[k+3]<<24)>>>0}new c;var m=[0],h=[0],g=[],p=new c,v=t,b=function(S,k){var M={},I=0,E=!1,D=0,G=0;if(M.frames=[],!function(O,L,H,K){for(var q=0;q<K;q++)if(O[L+q]!=H.charCodeAt(q))return!0;return!1}(S,k,"RIFF",4)){for(f(S,k+=4),k+=8;k<S.length;){var Z=u(S,k),ae=f(S,k+=4);k+=4;var de=ae+(1&ae);switch(Z){case"VP8 ":case"VP8L":M.frames[I]===void 0&&(M.frames[I]={}),(ye=M.frames[I]).src_off=E?G:k-8,ye.src_size=D+ae+8,I++,E&&(E=!1,D=0,G=0);break;case"VP8X":(ye=M.header={}).feature_flags=S[k];var se=k+4;ye.canvas_width=1+d(S,se),se+=3,ye.canvas_height=1+d(S,se),se+=3;break;case"ALPH":E=!0,D=de+8,G=k-8;break;case"ANIM":(ye=M.header).bgcolor=f(S,k),se=k+4,ye.loop_count=(re=S)[(C=se)+0]<<0|re[C+1]<<8,se+=2;break;case"ANMF":var Y,ye;(ye=M.frames[I]={}).offset_x=2*d(S,k),k+=3,ye.offset_y=2*d(S,k),k+=3,ye.width=1+d(S,k),k+=3,ye.height=1+d(S,k),k+=3,ye.duration=d(S,k),k+=3,Y=S[k++],ye.dispose=1&Y,ye.blend=Y>>1&1}Z!="ANMF"&&(k+=de)}var re,C;return M}}(v,0);b.response=v,b.rgbaoutput=!0,b.dataurl=!1;var w=b.header?b.header:null,N=b.frames?b.frames:null;if(w){w.loop_counter=w.loop_count,m=[w.canvas_height],h=[w.canvas_width];for(var j=0;j<N.length&&N[j].blend!=0;j++);}var F=N[0],U=p.WebPDecodeRGBA(v,F.src_off,F.src_size,h,m);F.rgba=U,F.imgwidth=h[0],F.imgheight=m[0];for(var A=0;A<h[0]*m[0]*4;A++)g[A]=U[A];return this.width=h,this.height=m,this.data=g,this}(function(t){var e=function(){return typeof nN=="function"},r=function(m,h,g,p){var v=4,b=i;switch(p){case t.image_compression.FAST:v=1,b=a;break;case t.image_compression.MEDIUM:v=6,b=l;break;case t.image_compression.SLOW:v=9,b=c}m=n(m,h,g,b);var w=nN(m,{level:v});return t.__addimage__.arrayBufferToBinaryString(w)},n=function(m,h,g,p){for(var v,b,w,N=m.length/h,j=new Uint8Array(m.length+N),F=d(),U=0;U<N;U+=1){if(w=U*h,v=m.subarray(w,w+h),p)j.set(p(v,g,b),w+U);else{for(var A,S=F.length,k=[];A<S;A+=1)k[A]=F[A](v,g,b);var M=f(k.concat());j.set(k[M],w+U)}b=v}return j},s=function(m){var h=Array.apply([],m);return h.unshift(0),h},a=function(m,h){var g,p=[],v=m.length;p[0]=1;for(var b=0;b<v;b+=1)g=m[b-h]||0,p[b+1]=m[b]-g+256&255;return p},i=function(m,h,g){var p,v=[],b=m.length;v[0]=2;for(var w=0;w<b;w+=1)p=g&&g[w]||0,v[w+1]=m[w]-p+256&255;return v},l=function(m,h,g){var p,v,b=[],w=m.length;b[0]=3;for(var N=0;N<w;N+=1)p=m[N-h]||0,v=g&&g[N]||0,b[N+1]=m[N]+256-(p+v>>>1)&255;return b},c=function(m,h,g){var p,v,b,w,N=[],j=m.length;N[0]=4;for(var F=0;F<j;F+=1)p=m[F-h]||0,v=g&&g[F]||0,b=g&&g[F-h]||0,w=u(p,v,b),N[F+1]=m[F]-w+256&255;return N},u=function(m,h,g){if(m===h&&h===g)return m;var p=Math.abs(h-g),v=Math.abs(m-g),b=Math.abs(m+h-g-g);return p<=v&&p<=b?m:v<=b?h:g},d=function(){return[s,a,i,l,c]},f=function(m){var h=m.map(function(g){return g.reduce(function(p,v){return p+Math.abs(v)},0)});return h.indexOf(Math.min.apply(null,h))};t.processPNG=function(m,h,g,p){var v,b,w,N,j,F,U,A,S,k,M,I,E,D,G,Z=this.decode.FLATE_DECODE,ae="";if(this.__addimage__.isArrayBuffer(m)&&(m=new Uint8Array(m)),this.__addimage__.isArrayBufferView(m)){if(m=(w=new zoe(m)).imgData,b=w.bits,v=w.colorSpace,j=w.colors,[4,6].indexOf(w.colorType)!==-1){if(w.bits===8){S=(A=w.pixelBitlength==32?new Uint32Array(w.decodePixels().buffer):w.pixelBitlength==16?new Uint16Array(w.decodePixels().buffer):new Uint8Array(w.decodePixels().buffer)).length,M=new Uint8Array(S*w.colors),k=new Uint8Array(S);var de,se=w.pixelBitlength-w.bits;for(D=0,G=0;D<S;D++){for(E=A[D],de=0;de<se;)M[G++]=E>>>de&255,de+=w.bits;k[D]=E>>>de&255}}if(w.bits===16){S=(A=new Uint32Array(w.decodePixels().buffer)).length,M=new Uint8Array(S*(32/w.pixelBitlength)*w.colors),k=new Uint8Array(S*(32/w.pixelBitlength)),I=w.colors>1,D=0,G=0;for(var Y=0;D<S;)E=A[D++],M[G++]=E>>>0&255,I&&(M[G++]=E>>>16&255,E=A[D++],M[G++]=E>>>0&255),k[Y++]=E>>>16&255;b=8}p!==t.image_compression.NONE&&e()?(m=r(M,w.width*w.colors,w.colors,p),U=r(k,w.width,1,p)):(m=M,U=k,Z=void 0)}if(w.colorType===3&&(v=this.color_spaces.INDEXED,F=w.palette,w.transparency.indexed)){var ye=w.transparency.indexed,re=0;for(D=0,S=ye.length;D<S;++D)re+=ye[D];if((re/=255)===S-1&&ye.indexOf(0)!==-1)N=[ye.indexOf(0)];else if(re!==S){for(A=w.decodePixels(),k=new Uint8Array(A.length),D=0,S=A.length;D<S;D++)k[D]=ye[A[D]];U=r(k,w.width,1)}}var C=function(O){var L;switch(O){case t.image_compression.FAST:L=11;break;case t.image_compression.MEDIUM:L=13;break;case t.image_compression.SLOW:L=14;break;default:L=12}return L}(p);return Z===this.decode.FLATE_DECODE&&(ae="/Predictor "+C+" "),ae+="/Colors "+j+" /BitsPerComponent "+b+" /Columns "+w.width,(this.__addimage__.isArrayBuffer(m)||this.__addimage__.isArrayBufferView(m))&&(m=this.__addimage__.arrayBufferToBinaryString(m)),(U&&this.__addimage__.isArrayBuffer(U)||this.__addimage__.isArrayBufferView(U))&&(U=this.__addimage__.arrayBufferToBinaryString(U)),{alias:g,data:m,index:h,filter:Z,decodeParameters:ae,transparency:N,palette:F,sMask:U,predictor:C,width:w.width,height:w.height,bitsPerComponent:b,colorSpace:v}}}})(pr.API),function(t){t.processGIF89A=function(e,r,n,s){var a=new qoe(e),i=a.width,l=a.height,c=[];a.decodeAndBlitFrameRGBA(0,c);var u={data:c,width:i,height:l},d=new Ww(100).encode(u,100);return t.processJPEG.call(this,d,r,n,s)},t.processGIF87A=t.processGIF89A}(pr.API),Wo.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var t=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(t);for(var e=0;e<t;e++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:s,green:n,blue:r,quad:a}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Wo.prototype.parseBGR=function(){this.pos=this.offset;try{var t="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[t]()}catch(r){An.log("bit decode error:"+r)}},Wo.prototype.bit1=function(){var t,e=Math.ceil(this.width/8),r=e%4;for(t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,s=0;s<e;s++)for(var a=this.datav.getUint8(this.pos++,!0),i=n*this.width*4+8*s*4,l=0;l<8&&8*s+l<this.width;l++){var c=this.palette[a>>7-l&1];this.data[i+4*l]=c.blue,this.data[i+4*l+1]=c.green,this.data[i+4*l+2]=c.red,this.data[i+4*l+3]=255}r!==0&&(this.pos+=4-r)}},Wo.prototype.bit4=function(){for(var t=Math.ceil(this.width/2),e=t%4,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,s=0;s<t;s++){var a=this.datav.getUint8(this.pos++,!0),i=n*this.width*4+2*s*4,l=a>>4,c=15&a,u=this.palette[l];if(this.data[i]=u.blue,this.data[i+1]=u.green,this.data[i+2]=u.red,this.data[i+3]=255,2*s+1>=this.width)break;u=this.palette[c],this.data[i+4]=u.blue,this.data[i+4+1]=u.green,this.data[i+4+2]=u.red,this.data[i+4+3]=255}e!==0&&(this.pos+=4-e)}},Wo.prototype.bit8=function(){for(var t=this.width%4,e=this.height-1;e>=0;e--){for(var r=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var s=this.datav.getUint8(this.pos++,!0),a=r*this.width*4+4*n;if(s<this.palette.length){var i=this.palette[s];this.data[a]=i.red,this.data[a+1]=i.green,this.data[a+2]=i.blue,this.data[a+3]=255}else this.data[a]=255,this.data[a+1]=255,this.data[a+2]=255,this.data[a+3]=255}t!==0&&(this.pos+=4-t)}},Wo.prototype.bit15=function(){for(var t=this.width%3,e=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,s=0;s<this.width;s++){var a=this.datav.getUint16(this.pos,!0);this.pos+=2;var i=(a&e)/e*255|0,l=(a>>5&e)/e*255|0,c=(a>>10&e)/e*255|0,u=a>>15?255:0,d=n*this.width*4+4*s;this.data[d]=c,this.data[d+1]=l,this.data[d+2]=i,this.data[d+3]=u}this.pos+=t}},Wo.prototype.bit16=function(){for(var t=this.width%3,e=parseInt("11111",2),r=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var s=this.bottom_up?n:this.height-1-n,a=0;a<this.width;a++){var i=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(i&e)/e*255|0,c=(i>>5&r)/r*255|0,u=(i>>11)/e*255|0,d=s*this.width*4+4*a;this.data[d]=u,this.data[d+1]=c,this.data[d+2]=l,this.data[d+3]=255}this.pos+=t}},Wo.prototype.bit24=function(){for(var t=this.height-1;t>=0;t--){for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=e*this.width*4+4*r;this.data[i]=a,this.data[i+1]=s,this.data[i+2]=n,this.data[i+3]=255}this.pos+=this.width%4}},Wo.prototype.bit32=function(){for(var t=this.height-1;t>=0;t--)for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),l=e*this.width*4+4*r;this.data[l]=a,this.data[l+1]=s,this.data[l+2]=n,this.data[l+3]=i}},Wo.prototype.getData=function(){return this.data},function(t){t.processBMP=function(e,r,n,s){var a=new Wo(e,!1),i=a.width,l=a.height,c={data:a.getData(),width:i,height:l},u=new Ww(100).encode(c,100);return t.processJPEG.call(this,u,r,n,s)}}(pr.API),t6.prototype.getData=function(){return this.data},function(t){t.processWEBP=function(e,r,n,s){var a=new t6(e),i=a.width,l=a.height,c={data:a.getData(),width:i,height:l},u=new Ww(100).encode(c,100);return t.processJPEG.call(this,u,r,n,s)}}(pr.API),pr.API.processRGBA=function(t,e,r){for(var n=t.data,s=n.length,a=new Uint8Array(s/4*3),i=new Uint8Array(s/4),l=0,c=0,u=0;u<s;u+=4){var d=n[u],f=n[u+1],m=n[u+2],h=n[u+3];a[l++]=d,a[l++]=f,a[l++]=m,i[c++]=h}var g=this.__addimage__.arrayBufferToBinaryString(a);return{alpha:this.__addimage__.arrayBufferToBinaryString(i),data:g,index:e,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:t.width,height:t.height}},pr.API.setLanguage=function(t){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[t]!==void 0&&(this.internal.languageSettings.languageCode=t,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},n0=pr.API,ay=n0.getCharWidthsArray=function(t,e){var r,n,s=(e=e||{}).font||this.internal.getFont(),a=e.fontSize||this.internal.getFontSize(),i=e.charSpace||this.internal.getCharSpace(),l=e.widths?e.widths:s.metadata.Unicode.widths,c=l.fof?l.fof:1,u=e.kerning?e.kerning:s.metadata.Unicode.kerning,d=u.fof?u.fof:1,f=e.doKerning!==!1,m=0,h=t.length,g=0,p=l[0]||c,v=[];for(r=0;r<h;r++)n=t.charCodeAt(r),typeof s.metadata.widthOfString=="function"?v.push((s.metadata.widthOfGlyph(s.metadata.characterToGlyph(n))+i*(1e3/a)||0)/1e3):(m=f&&yn(u[n])==="object"&&!isNaN(parseInt(u[n][g],10))?u[n][g]/d:0,v.push((l[n]||p)/c+m)),g=n;return v},Qk=n0.getStringUnitWidth=function(t,e){var r=(e=e||{}).fontSize||this.internal.getFontSize(),n=e.font||this.internal.getFont(),s=e.charSpace||this.internal.getCharSpace();return n0.processArabic&&(t=n0.processArabic(t)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(t,r,s)/r:ay.apply(this,arguments).reduce(function(a,i){return a+i},0)},Jk=function(t,e,r,n){for(var s=[],a=0,i=t.length,l=0;a!==i&&l+e[a]<r;)l+=e[a],a++;s.push(t.slice(0,a));var c=a;for(l=0;a!==i;)l+e[a]>n&&(s.push(t.slice(c,a)),l=0,c=a),l+=e[a],a++;return c!==a&&s.push(t.slice(c,a)),s},Zk=function(t,e,r){r||(r={});var n,s,a,i,l,c,u,d=[],f=[d],m=r.textIndent||0,h=0,g=0,p=t.split(" "),v=ay.apply(this,[" ",r])[0];if(c=r.lineIndent===-1?p[0].length+2:r.lineIndent||0){var b=Array(c).join(" "),w=[];p.map(function(j){(j=j.split(/\s*\n/)).length>1?w=w.concat(j.map(function(F,U){return(U&&F.length?`
`:"")+F})):w.push(j[0])}),p=w,c=Qk.apply(this,[b,r])}for(a=0,i=p.length;a<i;a++){var N=0;if(n=p[a],c&&n[0]==`
`&&(n=n.substr(1),N=1),m+h+(g=(s=ay.apply(this,[n,r])).reduce(function(j,F){return j+F},0))>e||N){if(g>e){for(l=Jk.apply(this,[n,s,e-(m+h),e]),d.push(l.shift()),d=[l.pop()];l.length;)f.push([l.shift()]);g=s.slice(n.length-(d[0]?d[0].length:0)).reduce(function(j,F){return j+F},0)}else d=[n];f.push(d),m=g+c,h=v}else d.push(n),m+=h+g,h=v}return u=c?function(j,F){return(F?b:"")+j.join(" ")}:function(j){return j.join(" ")},f.map(u)},n0.splitTextToSize=function(t,e,r){var n,s=(r=r||{}).fontSize||this.internal.getFontSize(),a=(function(d){if(d.widths&&d.kerning)return{widths:d.widths,kerning:d.kerning};var f=this.internal.getFont(d.fontName,d.fontStyle);return f.metadata.Unicode?{widths:f.metadata.Unicode.widths||{0:1},kerning:f.metadata.Unicode.kerning||{}}:{font:f.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);n=Array.isArray(t)?t:String(t).split(/\r?\n/);var i=1*this.internal.scaleFactor*e/s;a.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/s:0,a.lineIndent=r.lineIndent;var l,c,u=[];for(l=0,c=n.length;l<c;l++)u=u.concat(Zk.apply(this,[n[l],i,a]));return u},function(t){t.__fontmetrics__=t.__fontmetrics__||{};for(var e="klmnopqrstuvwxyz",r={},n={},s=0;s<e.length;s++)r[e[s]]="0123456789abcdef"[s],n["0123456789abcdef"[s]]=e[s];var a=function(f){return"0x"+parseInt(f,10).toString(16)},i=t.__fontmetrics__.compress=function(f){var m,h,g,p,v=["{"];for(var b in f){if(m=f[b],isNaN(parseInt(b,10))?h="'"+b+"'":(b=parseInt(b,10),h=(h=a(b).slice(2)).slice(0,-1)+n[h.slice(-1)]),typeof m=="number")m<0?(g=a(m).slice(3),p="-"):(g=a(m).slice(2),p=""),g=p+g.slice(0,-1)+n[g.slice(-1)];else{if(yn(m)!=="object")throw new Error("Don't know what to do with value type "+yn(m)+".");g=i(m)}v.push(h+g)}return v.push("}"),v.join("")},l=t.__fontmetrics__.uncompress=function(f){if(typeof f!="string")throw new Error("Invalid argument passed to uncompress.");for(var m,h,g,p,v={},b=1,w=v,N=[],j="",F="",U=f.length-1,A=1;A<U;A+=1)(p=f[A])=="'"?m?(g=m.join(""),m=void 0):m=[]:m?m.push(p):p=="{"?(N.push([w,g]),w={},g=void 0):p=="}"?((h=N.pop())[0][h[1]]=w,g=void 0,w=h[0]):p=="-"?b=-1:g===void 0?r.hasOwnProperty(p)?(j+=r[p],g=parseInt(j,16)*b,b=1,j=""):j+=p:r.hasOwnProperty(p)?(F+=r[p],w[g]=parseInt(F,16)*b,b=1,g=void 0,F=""):F+=p;return v},c={codePages:["WinAnsiEncoding"],WinAnsiEncoding:l("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},u={Unicode:{Courier:c,"Courier-Bold":c,"Courier-BoldOblique":c,"Courier-Oblique":c,Helvetica:c,"Helvetica-Bold":c,"Helvetica-BoldOblique":c,"Helvetica-Oblique":c,"Times-Roman":c,"Times-Bold":c,"Times-BoldItalic":c,"Times-Italic":c}},d={Unicode:{"Courier-Oblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":l("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":l("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:l("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:l("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":l("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":l("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};t.events.push(["addFont",function(f){var m=f.font,h=d.Unicode[m.postScriptName];h&&(m.metadata.Unicode={},m.metadata.Unicode.widths=h.widths,m.metadata.Unicode.kerning=h.kerning);var g=u.Unicode[m.postScriptName];g&&(m.metadata.Unicode.encoding=g,m.encoding=g.codePages[0])}])}(pr.API),function(t){var e=function(r){for(var n=r.length,s=new Uint8Array(n),a=0;a<n;a++)s[a]=r.charCodeAt(a);return s};t.API.events.push(["addFont",function(r){var n=void 0,s=r.font,a=r.instance;if(!s.isStandardFont){if(a===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");if(typeof(n=a.existsFileInVFS(s.postScriptName)===!1?a.loadFile(s.postScriptName):a.getFileFromVFS(s.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");(function(i,l){l=/^\x00\x01\x00\x00/.test(l)?e(l):e(lg(l)),i.metadata=t.API.TTFFont.open(l),i.metadata.Unicode=i.metadata.Unicode||{encoding:{},kerning:{},widths:[]},i.metadata.glyIdsUsed=[0]})(s,n)}}])}(pr),function(t){function e(){return(yr.canvg?Promise.resolve(yr.canvg):Bi(()=>import("./index.es-DXpwvFDo.js"),[])).catch(function(r){return Promise.reject(new Error("Could not load canvg: "+r))}).then(function(r){return r.default?r.default:r})}pr.API.addSvgAsImage=function(r,n,s,a,i,l,c,u){if(isNaN(n)||isNaN(s))throw An.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(a)||isNaN(i))throw An.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var d=document.createElement("canvas");d.width=a,d.height=i;var f=d.getContext("2d");f.fillStyle="#fff",f.fillRect(0,0,d.width,d.height);var m={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},h=this;return e().then(function(g){return g.fromString(f,r,m)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(g){return g.render(m)}).then(function(){h.addImage(d.toDataURL("image/jpeg",1),n,s,a,i,c,u)})}}(),pr.API.putTotalPages=function(t){var e,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(t,"g"),r=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(t,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var s=0;s<this.internal.pages[n].length;s++)this.internal.pages[n][s]=this.internal.pages[n][s].replace(e,r);return this},pr.API.viewerPreferences=function(t,e){var r;t=t||{},e=e||!1;var n,s,a,i={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},l=Object.keys(i),c=[],u=0,d=0,f=0;function m(g,p){var v,b=!1;for(v=0;v<g.length;v+=1)g[v]===p&&(b=!0);return b}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(i)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,t==="reset"||e===!0){var h=l.length;for(f=0;f<h;f+=1)r[l[f]].value=r[l[f]].defaultValue,r[l[f]].explicitSet=!1}if(yn(t)==="object"){for(s in t)if(a=t[s],m(l,s)&&a!==void 0){if(r[s].type==="boolean"&&typeof a=="boolean")r[s].value=a;else if(r[s].type==="name"&&m(r[s].valueSet,a))r[s].value=a;else if(r[s].type==="integer"&&Number.isInteger(a))r[s].value=a;else if(r[s].type==="array"){for(u=0;u<a.length;u+=1)if(n=!0,a[u].length===1&&typeof a[u][0]=="number")c.push(String(a[u]-1));else if(a[u].length>1){for(d=0;d<a[u].length;d+=1)typeof a[u][d]!="number"&&(n=!1);n===!0&&c.push([a[u][0]-1,a[u][1]-1].join(" "))}r[s].value="["+c.join(" ")+"]"}else r[s].value=r[s].defaultValue;r[s].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var g,p=[];for(g in r)r[g].explicitSet===!0&&(r[g].type==="name"?p.push("/"+g+" /"+r[g].value):p.push("/"+g+" "+r[g].value));p.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+p.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},function(t){var e=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',s=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),a=unescape(encodeURIComponent(n)),i=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),l=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),c=unescape(encodeURIComponent("</x:xmpmeta>")),u=a.length+i.length+l.length+s.length+c.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+u+" >>"),this.internal.write("stream"),this.internal.write(s+a+i+l+c),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};t.addMetadata=function(n,s){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:s||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",e)),this}}(pr.API),function(t){var e=t.API,r=e.pdfEscape16=function(a,i){for(var l,c=i.metadata.Unicode.widths,u=["","0","00","000","0000"],d=[""],f=0,m=a.length;f<m;++f){if(l=i.metadata.characterToGlyph(a.charCodeAt(f)),i.metadata.glyIdsUsed.push(l),i.metadata.toUnicode[l]=a.charCodeAt(f),c.indexOf(l)==-1&&(c.push(l),c.push([parseInt(i.metadata.widthOfGlyph(l),10)])),l=="0")return d.join("");l=l.toString(16),d.push(u[4-l.length],l)}return d.join("")},n=function(a){var i,l,c,u,d,f,m;for(d=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],f=0,m=(l=Object.keys(a).sort(function(h,g){return h-g})).length;f<m;f++)i=l[f],c.length>=100&&(d+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),a[i]!==void 0&&a[i]!==null&&typeof a[i].toString=="function"&&(u=("0000"+a[i].toString(16)).slice(-4),i=("0000"+(+i).toString(16)).slice(-4),c.push("<"+i+"><"+u+">"));return c.length&&(d+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),d+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(a){(function(i){var l=i.font,c=i.out,u=i.newObject,d=i.putStream;if(l.metadata instanceof t.API.TTFFont&&l.encoding==="Identity-H"){for(var f=l.metadata.Unicode.widths,m=l.metadata.subset.encode(l.metadata.glyIdsUsed,1),h="",g=0;g<m.length;g++)h+=String.fromCharCode(m[g]);var p=u();d({data:h,addLength1:!0,objectId:p}),c("endobj");var v=u();d({data:n(l.metadata.toUnicode),addLength1:!0,objectId:v}),c("endobj");var b=u();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+h0(l.fontName)),c("/FontFile2 "+p+" 0 R"),c("/FontBBox "+t.API.PDFObject.convert(l.metadata.bbox)),c("/Flags "+l.metadata.flags),c("/StemV "+l.metadata.stemV),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c(">>"),c("endobj");var w=u();c("<<"),c("/Type /Font"),c("/BaseFont /"+h0(l.fontName)),c("/FontDescriptor "+b+" 0 R"),c("/W "+t.API.PDFObject.convert(f)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+l.encoding+")"),c(">>"),c(">>"),c("endobj"),l.objectNumber=u(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+v+" 0 R"),c("/BaseFont /"+h0(l.fontName)),c("/Encoding /"+l.encoding),c("/DescendantFonts ["+w+" 0 R]"),c(">>"),c("endobj"),l.isAlreadyPutted=!0}})(a)}]),e.events.push(["putFont",function(a){(function(i){var l=i.font,c=i.out,u=i.newObject,d=i.putStream;if(l.metadata instanceof t.API.TTFFont&&l.encoding==="WinAnsiEncoding"){for(var f=l.metadata.rawData,m="",h=0;h<f.length;h++)m+=String.fromCharCode(f[h]);var g=u();d({data:m,addLength1:!0,objectId:g}),c("endobj");var p=u();d({data:n(l.metadata.toUnicode),addLength1:!0,objectId:p}),c("endobj");var v=u();c("<<"),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c("/StemV "+l.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+g+" 0 R"),c("/Flags 96"),c("/FontBBox "+t.API.PDFObject.convert(l.metadata.bbox)),c("/FontName /"+h0(l.fontName)),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c(">>"),c("endobj"),l.objectNumber=u();for(var b=0;b<l.metadata.hmtx.widths.length;b++)l.metadata.hmtx.widths[b]=parseInt(l.metadata.hmtx.widths[b]*(1e3/l.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+p+" 0 R/BaseFont/"+h0(l.fontName)+"/FontDescriptor "+v+" 0 R/Encoding/"+l.encoding+" /FirstChar 29 /LastChar 255 /Widths "+t.API.PDFObject.convert(l.metadata.hmtx.widths)+">>"),c("endobj"),l.isAlreadyPutted=!0}})(a)}]);var s=function(a){var i,l=a.text||"",c=a.x,u=a.y,d=a.options||{},f=a.mutex||{},m=f.pdfEscape,h=f.activeFontKey,g=f.fonts,p=h,v="",b=0,w="",N=g[p].encoding;if(g[p].encoding!=="Identity-H")return{text:l,x:c,y:u,options:d,mutex:f};for(w=l,p=h,Array.isArray(l)&&(w=l[0]),b=0;b<w.length;b+=1)g[p].metadata.hasOwnProperty("cmap")&&(i=g[p].metadata.cmap.unicode.codeMap[w[b].charCodeAt(0)]),i||w[b].charCodeAt(0)<256&&g[p].metadata.hasOwnProperty("Unicode")?v+=w[b]:v+="";var j="";return parseInt(p.slice(1))<14||N==="WinAnsiEncoding"?j=m(v,p).split("").map(function(F){return F.charCodeAt(0).toString(16)}).join(""):N==="Identity-H"&&(j=r(v,g[p])),f.isHex=!0,{text:j,x:c,y:u,options:d,mutex:f}};e.events.push(["postProcessText",function(a){var i=a.text||"",l=[],c={text:i,x:a.x,y:a.y,options:a.options,mutex:a.mutex};if(Array.isArray(i)){var u=0;for(u=0;u<i.length;u+=1)Array.isArray(i[u])&&i[u].length===3?l.push([s(Object.assign({},c,{text:i[u][0]})).text,i[u][1],i[u][2]]):l.push(s(Object.assign({},c,{text:i[u]})).text);a.text=l}else a.text=s(Object.assign({},c,{text:i})).text}])}(pr),function(t){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};t.existsFileInVFS=function(r){return e.call(this),this.internal.vFS[r]!==void 0},t.addFileToVFS=function(r,n){return e.call(this),this.internal.vFS[r]=n,this},t.getFileFromVFS=function(r){return e.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}}(pr.API),function(t){t.__bidiEngine__=t.prototype.__bidiEngine__=function(n){var s,a,i,l,c,u,d,f=e,m=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],h=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],g={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},p={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},v=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],b=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),w=!1,N=0;this.__bidiEngine__={};var j=function(I){var E=I.charCodeAt(),D=E>>8,G=p[D];return G!==void 0?f[256*G+(255&E)]:D===252||D===253?"AL":b.test(D)?"L":D===8?"R":"N"},F=function(I){for(var E,D=0;D<I.length;D++){if((E=j(I.charAt(D)))==="L")return!1;if(E==="R")return!0}return!1},U=function(I,E,D,G){var Z,ae,de,se,Y=E[G];switch(Y){case"L":case"R":w=!1;break;case"N":case"AN":break;case"EN":w&&(Y="AN");break;case"AL":w=!0,Y="R";break;case"WS":Y="N";break;case"CS":G<1||G+1>=E.length||(Z=D[G-1])!=="EN"&&Z!=="AN"||(ae=E[G+1])!=="EN"&&ae!=="AN"?Y="N":w&&(ae="AN"),Y=ae===Z?ae:"N";break;case"ES":Y=(Z=G>0?D[G-1]:"B")==="EN"&&G+1<E.length&&E[G+1]==="EN"?"EN":"N";break;case"ET":if(G>0&&D[G-1]==="EN"){Y="EN";break}if(w){Y="N";break}for(de=G+1,se=E.length;de<se&&E[de]==="ET";)de++;Y=de<se&&E[de]==="EN"?"EN":"N";break;case"NSM":if(i&&!l){for(se=E.length,de=G+1;de<se&&E[de]==="NSM";)de++;if(de<se){var ye=I[G],re=ye>=1425&&ye<=2303||ye===64286;if(Z=E[de],re&&(Z==="R"||Z==="AL")){Y="R";break}}}Y=G<1||(Z=E[G-1])==="B"?"N":D[G-1];break;case"B":w=!1,s=!0,Y=N;break;case"S":a=!0,Y="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":w=!1;break;case"BN":Y="N"}return Y},A=function(I,E,D){var G=I.split("");return D&&S(G,D,{hiLevel:N}),G.reverse(),E&&E.reverse(),G.join("")},S=function(I,E,D){var G,Z,ae,de,se,Y=-1,ye=I.length,re=0,C=[],O=N?h:m,L=[];for(w=!1,s=!1,a=!1,Z=0;Z<ye;Z++)L[Z]=j(I[Z]);for(ae=0;ae<ye;ae++){if(se=re,C[ae]=U(I,L,C,ae),G=240&(re=O[se][g[C[ae]]]),re&=15,E[ae]=de=O[re][5],G>0)if(G===16){for(Z=Y;Z<ae;Z++)E[Z]=1;Y=-1}else Y=-1;if(O[re][6])Y===-1&&(Y=ae);else if(Y>-1){for(Z=Y;Z<ae;Z++)E[Z]=de;Y=-1}L[ae]==="B"&&(E[ae]=0),D.hiLevel|=de}a&&function(H,K,q){for(var te=0;te<q;te++)if(H[te]==="S"){K[te]=N;for(var oe=te-1;oe>=0&&H[oe]==="WS";oe--)K[oe]=N}}(L,E,ye)},k=function(I,E,D,G,Z){if(!(Z.hiLevel<I)){if(I===1&&N===1&&!s)return E.reverse(),void(D&&D.reverse());for(var ae,de,se,Y,ye=E.length,re=0;re<ye;){if(G[re]>=I){for(se=re+1;se<ye&&G[se]>=I;)se++;for(Y=re,de=se-1;Y<de;Y++,de--)ae=E[Y],E[Y]=E[de],E[de]=ae,D&&(ae=D[Y],D[Y]=D[de],D[de]=ae);re=se}re++}}},M=function(I,E,D){var G=I.split(""),Z={hiLevel:N};return D||(D=[]),S(G,D,Z),function(ae,de,se){if(se.hiLevel!==0&&d)for(var Y,ye=0;ye<ae.length;ye++)de[ye]===1&&(Y=v.indexOf(ae[ye]))>=0&&(ae[ye]=v[Y+1])}(G,D,Z),k(2,G,E,D,Z),k(1,G,E,D,Z),G.join("")};return this.__bidiEngine__.doBidiReorder=function(I,E,D){if(function(Z,ae){if(ae)for(var de=0;de<Z.length;de++)ae[de]=de;l===void 0&&(l=F(Z)),u===void 0&&(u=F(Z))}(I,E),i||!c||u)if(i&&c&&l^u)N=l?1:0,I=A(I,E,D);else if(!i&&c&&u)N=l?1:0,I=M(I,E,D),I=A(I,E);else if(!i||l||c||u){if(i&&!c&&l^u)I=A(I,E),l?(N=0,I=M(I,E,D)):(N=1,I=M(I,E,D),I=A(I,E));else if(i&&l&&!c&&u)N=1,I=M(I,E,D),I=A(I,E);else if(!i&&!c&&l^u){var G=d;l?(N=1,I=M(I,E,D),N=0,d=!1,I=M(I,E,D),d=G):(N=0,I=M(I,E,D),I=A(I,E),N=1,d=!1,I=M(I,E,D),d=G,I=A(I,E))}}else N=0,I=M(I,E,D);else N=l?1:0,I=M(I,E,D);return I},this.__bidiEngine__.setOptions=function(I){I&&(i=I.isInputVisual,c=I.isOutputVisual,l=I.isInputRtl,u=I.isOutputRtl,d=I.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new t.__bidiEngine__({isInputVisual:!0});t.API.events.push(["postProcessText",function(n){var s=n.text;n.x,n.y;var a=n.options||{};n.mutex,a.lang;var i=[];if(a.isInputVisual=typeof a.isInputVisual!="boolean"||a.isInputVisual,r.setOptions(a),Object.prototype.toString.call(s)==="[object Array]"){var l=0;for(i=[],l=0;l<s.length;l+=1)Object.prototype.toString.call(s[l])==="[object Array]"?i.push([r.doBidiReorder(s[l][0]),s[l][1],s[l][2]]):i.push([r.doBidiReorder(s[l])]);n.text=i}else n.text=r.doBidiReorder(s);r.setOptions({isInputVisual:!0})}])}(pr),pr.API.TTFFont=function(){function t(e){var r;if(this.rawData=e,r=this.contents=new Ld(e),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new ale(this),this.registerTTF()}return t.open=function(e){return new t(e)},t.prototype.parse=function(){return this.directory=new Woe(this.contents),this.head=new Goe(this),this.name=new Joe(this),this.cmap=new UL(this),this.toUnicode={},this.hhea=new Koe(this),this.maxp=new Zoe(this),this.hmtx=new ele(this),this.post=new Xoe(this),this.os2=new Yoe(this),this.loca=new sle(this),this.glyf=new tle(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},t.prototype.registerTTF=function(){var e,r,n,s,a;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var i,l,c,u;for(u=[],i=0,l=(c=this.bbox).length;i<l;i++)e=c[i],u.push(Math.round(e*this.scaleFactor));return u}).call(this),this.stemV=0,this.post.exists?(n=255&(s=this.post.italic_angle),32768&(r=s>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(a=this.familyClass)===1||a===2||a===3||a===4||a===5||a===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},t.prototype.characterToGlyph=function(e){var r;return((r=this.cmap.unicode)!=null?r.codeMap[e]:void 0)||0},t.prototype.widthOfGlyph=function(e){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*r},t.prototype.widthOfString=function(e,r,n){var s,a,i,l;for(i=0,a=0,l=(e=""+e).length;0<=l?a<l:a>l;a=0<=l?++a:--a)s=e.charCodeAt(a),i+=this.widthOfGlyph(this.characterToGlyph(s))+n*(1e3/r)||0;return i*(r/1e3)},t.prototype.lineHeight=function(e,r){var n;return r==null&&(r=!1),n=r?this.lineGap:0,(this.ascender+n-this.decender)/1e3*e},t}();var ul,Ld=function(){function t(e){this.data=e??[],this.pos=0,this.length=this.data.length}return t.prototype.readByte=function(){return this.data[this.pos++]},t.prototype.writeByte=function(e){return this.data[this.pos++]=e},t.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},t.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},t.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},t.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},t.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},t.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},t.prototype.readString=function(e){var r,n;for(n=[],r=0;0<=e?r<e:r>e;r=0<=e?++r:--r)n[r]=String.fromCharCode(this.readByte());return n.join("")},t.prototype.writeString=function(e){var r,n,s;for(s=[],r=0,n=e.length;0<=n?r<n:r>n;r=0<=n?++r:--r)s.push(this.writeByte(e.charCodeAt(r)));return s},t.prototype.readShort=function(){return this.readInt16()},t.prototype.writeShort=function(e){return this.writeInt16(e)},t.prototype.readLongLong=function(){var e,r,n,s,a,i,l,c;return e=this.readByte(),r=this.readByte(),n=this.readByte(),s=this.readByte(),a=this.readByte(),i=this.readByte(),l=this.readByte(),c=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^r)+1099511627776*(255^n)+4294967296*(255^s)+16777216*(255^a)+65536*(255^i)+256*(255^l)+(255^c)+1):72057594037927940*e+281474976710656*r+1099511627776*n+4294967296*s+16777216*a+65536*i+256*l+c},t.prototype.writeLongLong=function(e){var r,n;return r=Math.floor(e/4294967296),n=4294967295&e,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},t.prototype.readInt=function(){return this.readInt32()},t.prototype.writeInt=function(e){return this.writeInt32(e)},t.prototype.read=function(e){var r,n;for(r=[],n=0;0<=e?n<e:n>e;n=0<=e?++n:--n)r.push(this.readByte());return r},t.prototype.write=function(e){var r,n,s,a;for(a=[],n=0,s=e.length;n<s;n++)r=e[n],a.push(this.writeByte(r));return a},t}(),Woe=function(){var t;function e(r){var n,s,a;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},s=0,a=this.tableCount;0<=a?s<a:s>a;s=0<=a?++s:--s)n={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[n.tag]=n}return e.prototype.encode=function(r){var n,s,a,i,l,c,u,d,f,m,h,g,p;for(p in h=Object.keys(r).length,c=Math.log(2),f=16*Math.floor(Math.log(h)/c),i=Math.floor(f/c),d=16*h-f,(s=new Ld).writeInt(this.scalarType),s.writeShort(h),s.writeShort(f),s.writeShort(i),s.writeShort(d),a=16*h,u=s.pos+a,l=null,g=[],r)for(m=r[p],s.writeString(p),s.writeInt(t(m)),s.writeInt(u),s.writeInt(m.length),g=g.concat(m),p==="head"&&(l=u),u+=m.length;u%4;)g.push(0),u++;return s.write(g),n=2981146554-t(s.data),s.pos=l+8,s.writeUInt32(n),s.data},t=function(r){var n,s,a,i;for(r=$L.call(r);r.length%4;)r.push(0);for(a=new Ld(r),s=0,n=0,i=r.length;n<i;n=n+=4)s+=a.readUInt32();return 4294967295&s},e}(),Hoe={}.hasOwnProperty,Kl=function(t,e){for(var r in e)Hoe.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};ul=function(){function t(e){var r;this.file=e,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return t.prototype.parse=function(){},t.prototype.encode=function(){},t.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},t}();var Goe=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return Kl(e,ul),e.prototype.tag="head",e.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.revision=r.readInt(),this.checkSumAdjustment=r.readInt(),this.magicNumber=r.readInt(),this.flags=r.readShort(),this.unitsPerEm=r.readShort(),this.created=r.readLongLong(),this.modified=r.readLongLong(),this.xMin=r.readShort(),this.yMin=r.readShort(),this.xMax=r.readShort(),this.yMax=r.readShort(),this.macStyle=r.readShort(),this.lowestRecPPEM=r.readShort(),this.fontDirectionHint=r.readShort(),this.indexToLocFormat=r.readShort(),this.glyphDataFormat=r.readShort()},e.prototype.encode=function(r){var n;return(n=new Ld).writeInt(this.version),n.writeInt(this.revision),n.writeInt(this.checkSumAdjustment),n.writeInt(this.magicNumber),n.writeShort(this.flags),n.writeShort(this.unitsPerEm),n.writeLongLong(this.created),n.writeLongLong(this.modified),n.writeShort(this.xMin),n.writeShort(this.yMin),n.writeShort(this.xMax),n.writeShort(this.yMax),n.writeShort(this.macStyle),n.writeShort(this.lowestRecPPEM),n.writeShort(this.fontDirectionHint),n.writeShort(r),n.writeShort(this.glyphDataFormat),n.data},e}(),r6=function(){function t(e,r){var n,s,a,i,l,c,u,d,f,m,h,g,p,v,b,w,N;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=r+e.readInt(),f=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=e.readByte();break;case 4:for(h=e.readUInt16(),m=h/2,e.pos+=6,a=function(){var j,F;for(F=[],c=j=0;0<=m?j<m:j>m;c=0<=m?++j:--j)F.push(e.readUInt16());return F}(),e.pos+=2,p=function(){var j,F;for(F=[],c=j=0;0<=m?j<m:j>m;c=0<=m?++j:--j)F.push(e.readUInt16());return F}(),u=function(){var j,F;for(F=[],c=j=0;0<=m?j<m:j>m;c=0<=m?++j:--j)F.push(e.readUInt16());return F}(),d=function(){var j,F;for(F=[],c=j=0;0<=m?j<m:j>m;c=0<=m?++j:--j)F.push(e.readUInt16());return F}(),s=(this.length-e.pos+this.offset)/2,l=function(){var j,F;for(F=[],c=j=0;0<=s?j<s:j>s;c=0<=s?++j:--j)F.push(e.readUInt16());return F}(),c=b=0,N=a.length;b<N;c=++b)for(v=a[c],n=w=g=p[c];g<=v?w<=v:w>=v;n=g<=v?++w:--w)d[c]===0?i=n+u[c]:(i=l[d[c]/2+(n-g)-(m-c)]||0)!==0&&(i+=u[c]),this.codeMap[n]=65535&i}e.pos=f}return t.encode=function(e,r){var n,s,a,i,l,c,u,d,f,m,h,g,p,v,b,w,N,j,F,U,A,S,k,M,I,E,D,G,Z,ae,de,se,Y,ye,re,C,O,L,H,K,q,te,oe,V,xe,B;switch(G=new Ld,i=Object.keys(e).sort(function(Ee,Me){return Ee-Me}),r){case"macroman":for(p=0,v=function(){var Ee=[];for(g=0;g<256;++g)Ee.push(0);return Ee}(),w={0:0},a={},Z=0,Y=i.length;Z<Y;Z++)w[oe=e[s=i[Z]]]==null&&(w[oe]=++p),a[s]={old:e[s],new:w[e[s]]},v[s]=w[e[s]];return G.writeUInt16(1),G.writeUInt16(0),G.writeUInt32(12),G.writeUInt16(0),G.writeUInt16(262),G.writeUInt16(0),G.write(v),{charMap:a,subtable:G.data,maxGlyphID:p+1};case"unicode":for(E=[],f=[],N=0,w={},n={},b=u=null,ae=0,ye=i.length;ae<ye;ae++)w[F=e[s=i[ae]]]==null&&(w[F]=++N),n[s]={old:F,new:w[F]},l=w[F]-s,b!=null&&l===u||(b&&f.push(b),E.push(s),u=l),b=s;for(b&&f.push(b),f.push(65535),E.push(65535),M=2*(k=E.length),S=2*Math.pow(Math.log(k)/Math.LN2,2),m=Math.log(S/2)/Math.LN2,A=2*k-S,c=[],U=[],h=[],g=de=0,re=E.length;de<re;g=++de){if(I=E[g],d=f[g],I===65535){c.push(0),U.push(0);break}if(I-(D=n[I].new)>=32768)for(c.push(0),U.push(2*(h.length+k-g)),s=se=I;I<=d?se<=d:se>=d;s=I<=d?++se:--se)h.push(n[s].new);else c.push(D-I),U.push(0)}for(G.writeUInt16(3),G.writeUInt16(1),G.writeUInt32(12),G.writeUInt16(4),G.writeUInt16(16+8*k+2*h.length),G.writeUInt16(0),G.writeUInt16(M),G.writeUInt16(S),G.writeUInt16(m),G.writeUInt16(A),q=0,C=f.length;q<C;q++)s=f[q],G.writeUInt16(s);for(G.writeUInt16(0),te=0,O=E.length;te<O;te++)s=E[te],G.writeUInt16(s);for(V=0,L=c.length;V<L;V++)l=c[V],G.writeUInt16(l);for(xe=0,H=U.length;xe<H;xe++)j=U[xe],G.writeUInt16(j);for(B=0,K=h.length;B<K;B++)p=h[B],G.writeUInt16(p);return{charMap:n,subtable:G.data,maxGlyphID:N+1}}},t}(),UL=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return Kl(e,ul),e.prototype.tag="cmap",e.prototype.parse=function(r){var n,s,a;for(r.pos=this.offset,this.version=r.readUInt16(),a=r.readUInt16(),this.tables=[],this.unicode=null,s=0;0<=a?s<a:s>a;s=0<=a?++s:--s)n=new r6(r,this.offset),this.tables.push(n),n.isUnicode&&this.unicode==null&&(this.unicode=n);return!0},e.encode=function(r,n){var s,a;return n==null&&(n="macroman"),s=r6.encode(r,n),(a=new Ld).writeUInt16(0),a.writeUInt16(1),s.table=a.data.concat(s.subtable),s},e}(),Koe=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return Kl(e,ul),e.prototype.tag="hhea",e.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.ascender=r.readShort(),this.decender=r.readShort(),this.lineGap=r.readShort(),this.advanceWidthMax=r.readShort(),this.minLeftSideBearing=r.readShort(),this.minRightSideBearing=r.readShort(),this.xMaxExtent=r.readShort(),this.caretSlopeRise=r.readShort(),this.caretSlopeRun=r.readShort(),this.caretOffset=r.readShort(),r.pos+=8,this.metricDataFormat=r.readShort(),this.numberOfMetrics=r.readUInt16()},e}(),Yoe=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return Kl(e,ul),e.prototype.tag="OS/2",e.prototype.parse=function(r){if(r.pos=this.offset,this.version=r.readUInt16(),this.averageCharWidth=r.readShort(),this.weightClass=r.readUInt16(),this.widthClass=r.readUInt16(),this.type=r.readShort(),this.ySubscriptXSize=r.readShort(),this.ySubscriptYSize=r.readShort(),this.ySubscriptXOffset=r.readShort(),this.ySubscriptYOffset=r.readShort(),this.ySuperscriptXSize=r.readShort(),this.ySuperscriptYSize=r.readShort(),this.ySuperscriptXOffset=r.readShort(),this.ySuperscriptYOffset=r.readShort(),this.yStrikeoutSize=r.readShort(),this.yStrikeoutPosition=r.readShort(),this.familyClass=r.readShort(),this.panose=function(){var n,s;for(s=[],n=0;n<10;++n)s.push(r.readByte());return s}(),this.charRange=function(){var n,s;for(s=[],n=0;n<4;++n)s.push(r.readInt());return s}(),this.vendorID=r.readString(4),this.selection=r.readShort(),this.firstCharIndex=r.readShort(),this.lastCharIndex=r.readShort(),this.version>0&&(this.ascent=r.readShort(),this.descent=r.readShort(),this.lineGap=r.readShort(),this.winAscent=r.readShort(),this.winDescent=r.readShort(),this.codePageRange=function(){var n,s;for(s=[],n=0;n<2;n=++n)s.push(r.readInt());return s}(),this.version>1))return this.xHeight=r.readShort(),this.capHeight=r.readShort(),this.defaultChar=r.readShort(),this.breakChar=r.readShort(),this.maxContext=r.readShort()},e}(),Xoe=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return Kl(e,ul),e.prototype.tag="post",e.prototype.parse=function(r){var n,s,a;switch(r.pos=this.offset,this.format=r.readInt(),this.italicAngle=r.readInt(),this.underlinePosition=r.readShort(),this.underlineThickness=r.readShort(),this.isFixedPitch=r.readInt(),this.minMemType42=r.readInt(),this.maxMemType42=r.readInt(),this.minMemType1=r.readInt(),this.maxMemType1=r.readInt(),this.format){case 65536:break;case 131072:var i;for(s=r.readUInt16(),this.glyphNameIndex=[],i=0;0<=s?i<s:i>s;i=0<=s?++i:--i)this.glyphNameIndex.push(r.readUInt16());for(this.names=[],a=[];r.pos<this.offset+this.length;)n=r.readByte(),a.push(this.names.push(r.readString(n)));return a;case 151552:return s=r.readUInt16(),this.offsets=r.read(s);case 196608:break;case 262144:return this.map=(function(){var l,c,u;for(u=[],i=l=0,c=this.file.maxp.numGlyphs;0<=c?l<c:l>c;i=0<=c?++l:--l)u.push(r.readUInt32());return u}).call(this)}},e}(),Qoe=function(t,e){this.raw=t,this.length=t.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},Joe=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return Kl(e,ul),e.prototype.tag="name",e.prototype.parse=function(r){var n,s,a,i,l,c,u,d,f,m,h;for(r.pos=this.offset,r.readShort(),n=r.readShort(),c=r.readShort(),s=[],i=0;0<=n?i<n:i>n;i=0<=n?++i:--i)s.push({platformID:r.readShort(),encodingID:r.readShort(),languageID:r.readShort(),nameID:r.readShort(),length:r.readShort(),offset:this.offset+c+r.readShort()});for(u={},i=f=0,m=s.length;f<m;i=++f)a=s[i],r.pos=a.offset,d=r.readString(a.length),l=new Qoe(d,a),u[h=a.nameID]==null&&(u[h]=[]),u[a.nameID].push(l);this.strings=u,this.copyright=u[0],this.fontFamily=u[1],this.fontSubfamily=u[2],this.uniqueSubfamily=u[3],this.fontName=u[4],this.version=u[5];try{this.postscriptName=u[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=u[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=u[7],this.manufacturer=u[8],this.designer=u[9],this.description=u[10],this.vendorUrl=u[11],this.designerUrl=u[12],this.license=u[13],this.licenseUrl=u[14],this.preferredFamily=u[15],this.preferredSubfamily=u[17],this.compatibleFull=u[18],this.sampleText=u[19]},e}(),Zoe=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return Kl(e,ul),e.prototype.tag="maxp",e.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.numGlyphs=r.readUInt16(),this.maxPoints=r.readUInt16(),this.maxContours=r.readUInt16(),this.maxCompositePoints=r.readUInt16(),this.maxComponentContours=r.readUInt16(),this.maxZones=r.readUInt16(),this.maxTwilightPoints=r.readUInt16(),this.maxStorage=r.readUInt16(),this.maxFunctionDefs=r.readUInt16(),this.maxInstructionDefs=r.readUInt16(),this.maxStackElements=r.readUInt16(),this.maxSizeOfInstructions=r.readUInt16(),this.maxComponentElements=r.readUInt16(),this.maxComponentDepth=r.readUInt16()},e}(),ele=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return Kl(e,ul),e.prototype.tag="hmtx",e.prototype.parse=function(r){var n,s,a,i,l,c,u;for(r.pos=this.offset,this.metrics=[],n=0,c=this.file.hhea.numberOfMetrics;0<=c?n<c:n>c;n=0<=c?++n:--n)this.metrics.push({advance:r.readUInt16(),lsb:r.readInt16()});for(a=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var d,f;for(f=[],n=d=0;0<=a?d<a:d>a;n=0<=a?++d:--d)f.push(r.readInt16());return f}(),this.widths=(function(){var d,f,m,h;for(h=[],d=0,f=(m=this.metrics).length;d<f;d++)i=m[d],h.push(i.advance);return h}).call(this),s=this.widths[this.widths.length-1],u=[],n=l=0;0<=a?l<a:l>a;n=0<=a?++l:--l)u.push(this.widths.push(s));return u},e.prototype.forGlyph=function(r){return r in this.metrics?this.metrics[r]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[r-this.metrics.length]}},e}(),$L=[].slice,tle=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return Kl(e,ul),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(r){var n,s,a,i,l,c,u,d,f,m;return r in this.cache?this.cache[r]:(i=this.file.loca,n=this.file.contents,s=i.indexOf(r),(a=i.lengthOf(r))===0?this.cache[r]=null:(n.pos=this.offset+s,l=(c=new Ld(n.read(a))).readShort(),d=c.readShort(),m=c.readShort(),u=c.readShort(),f=c.readShort(),this.cache[r]=l===-1?new nle(c,d,m,u,f):new rle(c,l,d,m,u,f),this.cache[r]))},e.prototype.encode=function(r,n,s){var a,i,l,c,u;for(l=[],i=[],c=0,u=n.length;c<u;c++)a=r[n[c]],i.push(l.length),a&&(l=l.concat(a.encode(s)));return i.push(l.length),{table:l,offsets:i}},e}(),rle=function(){function t(e,r,n,s,a,i){this.raw=e,this.numberOfContours=r,this.xMin=n,this.yMin=s,this.xMax=a,this.yMax=i,this.compound=!1}return t.prototype.encode=function(){return this.raw.data},t}(),nle=function(){function t(e,r,n,s,a){var i,l;for(this.raw=e,this.xMin=r,this.yMin=n,this.xMax=s,this.yMax=a,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],i=this.raw;l=i.readShort(),this.glyphOffsets.push(i.pos),this.glyphIDs.push(i.readUInt16()),32&l;)i.pos+=1&l?4:2,128&l?i.pos+=8:64&l?i.pos+=4:8&l&&(i.pos+=2)}return t.prototype.encode=function(){var e,r,n;for(r=new Ld($L.call(this.raw.data)),e=0,n=this.glyphIDs.length;e<n;++e)r.pos=this.glyphOffsets[e];return r.data},t}(),sle=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return Kl(e,ul),e.prototype.tag="loca",e.prototype.parse=function(r){var n,s;return r.pos=this.offset,n=this.file.head.indexToLocFormat,this.offsets=n===0?(function(){var a,i;for(i=[],s=0,a=this.length;s<a;s+=2)i.push(2*r.readUInt16());return i}).call(this):(function(){var a,i;for(i=[],s=0,a=this.length;s<a;s+=4)i.push(r.readUInt32());return i}).call(this)},e.prototype.indexOf=function(r){return this.offsets[r]},e.prototype.lengthOf=function(r){return this.offsets[r+1]-this.offsets[r]},e.prototype.encode=function(r,n){for(var s=new Uint32Array(this.offsets.length),a=0,i=0,l=0;l<s.length;++l)if(s[l]=a,i<n.length&&n[i]==l){++i,s[l]=a;var c=this.offsets[l],u=this.offsets[l+1]-c;u>0&&(a+=u)}for(var d=new Array(4*s.length),f=0;f<s.length;++f)d[4*f+3]=255&s[f],d[4*f+2]=(65280&s[f])>>8,d[4*f+1]=(16711680&s[f])>>16,d[4*f]=(4278190080&s[f])>>24;return d},e}(),ale=function(){function t(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return t.prototype.generateCmap=function(){var e,r,n,s,a;for(r in s=this.font.cmap.tables[0].codeMap,e={},a=this.subset)n=a[r],e[r]=s[n];return e},t.prototype.glyphsFor=function(e){var r,n,s,a,i,l,c;for(s={},i=0,l=e.length;i<l;i++)s[a=e[i]]=this.font.glyf.glyphFor(a);for(a in r=[],s)(n=s[a])!=null&&n.compound&&r.push.apply(r,n.glyphIDs);if(r.length>0)for(a in c=this.glyphsFor(r))n=c[a],s[a]=n;return s},t.prototype.encode=function(e,r){var n,s,a,i,l,c,u,d,f,m,h,g,p,v,b;for(s in n=UL.encode(this.generateCmap(),"unicode"),i=this.glyphsFor(e),h={0:0},b=n.charMap)h[(c=b[s]).old]=c.new;for(g in m=n.maxGlyphID,i)g in h||(h[g]=m++);return d=function(w){var N,j;for(N in j={},w)j[w[N]]=N;return j}(h),f=Object.keys(d).sort(function(w,N){return w-N}),p=function(){var w,N,j;for(j=[],w=0,N=f.length;w<N;w++)l=f[w],j.push(d[l]);return j}(),a=this.font.glyf.encode(i,p,h),u=this.font.loca.encode(a.offsets,p),v={cmap:this.font.cmap.raw(),glyf:a.table,loca:u,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(v["OS/2"]=this.font.os2.raw()),this.font.directory.encode(v)},t}();pr.API.PDFObject=function(){var t;function e(){}return t=function(r,n){return(Array(n+1).join("0")+r).slice(-n)},e.convert=function(r){var n,s,a,i;if(Array.isArray(r))return"["+function(){var l,c,u;for(u=[],l=0,c=r.length;l<c;l++)n=r[l],u.push(e.convert(n));return u}().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r!=null&&r.isString)return"("+r+")";if(r instanceof Date)return"(D:"+t(r.getUTCFullYear(),4)+t(r.getUTCMonth(),2)+t(r.getUTCDate(),2)+t(r.getUTCHours(),2)+t(r.getUTCMinutes(),2)+t(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(s in a=["<<"],r)i=r[s],a.push("/"+s+" "+e.convert(i));return a.push(">>"),a.join(`
`)}return""+r},e}();function zL(t,e,r,n,s){n=n||{};var a=1.15,i=s.internal.scaleFactor,l=s.internal.getFontSize()/i,c=s.getLineHeightFactor?s.getLineHeightFactor():a,u=l*c,d=/\r\n|\r|\n/g,f="",m=1;if((n.valign==="middle"||n.valign==="bottom"||n.halign==="center"||n.halign==="right")&&(f=typeof t=="string"?t.split(d):t,m=f.length||1),r+=l*(2-a),n.valign==="middle"?r-=m/2*u:n.valign==="bottom"&&(r-=m*u),n.halign==="center"||n.halign==="right"){var h=l;if(n.halign==="center"&&(h*=.5),f&&m>=1){for(var g=0;g<f.length;g++)s.text(f[g],e-s.getStringUnitWidth(f[g])*h,r),r+=u;return s}e-=s.getStringUnitWidth(t)*h}return n.halign==="justify"?s.text(t,e,r,{maxWidth:n.maxWidth||100,align:"justify"}):s.text(t,e,r),s}var n6={},K0=function(){function t(e){this.jsPDFDocument=e,this.userStyles={textColor:e.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:e.internal.getFontSize(),fontStyle:e.internal.getFont().fontStyle,font:e.internal.getFont().fontName,lineWidth:e.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:e.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return t.setDefaults=function(e,r){r===void 0&&(r=null),r?r.__autoTableDocumentDefaults=e:n6=e},t.unifyColor=function(e){return Array.isArray(e)?e:typeof e=="number"?[e,e,e]:typeof e=="string"?[e]:null},t.prototype.applyStyles=function(e,r){var n,s,a;r===void 0&&(r=!1),e.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(e.fontStyle);var i=this.jsPDFDocument.internal.getFont(),l=i.fontStyle,c=i.fontName;if(e.font&&(c=e.font),e.fontStyle){l=e.fontStyle;var u=this.getFontList()[c];u&&u.indexOf(l)===-1&&this.jsPDFDocument.setFontStyle&&(this.jsPDFDocument.setFontStyle(u[0]),l=u[0])}if(this.jsPDFDocument.setFont(c,l),e.fontSize&&this.jsPDFDocument.setFontSize(e.fontSize),!r){var d=t.unifyColor(e.fillColor);d&&(n=this.jsPDFDocument).setFillColor.apply(n,d),d=t.unifyColor(e.textColor),d&&(s=this.jsPDFDocument).setTextColor.apply(s,d),d=t.unifyColor(e.lineColor),d&&(a=this.jsPDFDocument).setDrawColor.apply(a,d),typeof e.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(e.lineWidth)}},t.prototype.splitTextToSize=function(e,r,n){return this.jsPDFDocument.splitTextToSize(e,r,n)},t.prototype.rect=function(e,r,n,s,a){return this.jsPDFDocument.rect(e,r,n,s,a)},t.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},t.prototype.getTextWidth=function(e){return this.jsPDFDocument.getTextWidth(e)},t.prototype.getDocument=function(){return this.jsPDFDocument},t.prototype.setPage=function(e){this.jsPDFDocument.setPage(e)},t.prototype.addPage=function(){return this.jsPDFDocument.addPage()},t.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},t.prototype.getGlobalOptions=function(){return n6||{}},t.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},t.prototype.pageSize=function(){var e=this.jsPDFDocument.internal.pageSize;return e.width==null&&(e={width:e.getWidth(),height:e.getHeight()}),e},t.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},t.prototype.getLineHeightFactor=function(){var e=this.jsPDFDocument;return e.getLineHeightFactor?e.getLineHeightFactor():1.15},t.prototype.getLineHeight=function(e){return e/this.scaleFactor()*this.getLineHeightFactor()},t.prototype.pageNumber=function(){var e=this.jsPDFDocument.internal.getCurrentPageInfo();return e?e.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},t}(),uN=function(t,e){return uN=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(r[s]=n[s])},uN(t,e)};function qL(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");uN(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var WL=function(t){qL(e,t);function e(r){var n=t.call(this)||this;return n._element=r,n}return e}(Array);function ile(t){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/t,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}function ole(t){var e={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return e[t]}function i2(t,e,r){r.applyStyles(e,!0);var n=Array.isArray(t)?t:[t],s=n.map(function(a){return r.getTextWidth(a)}).reduce(function(a,i){return Math.max(a,i)},0);return s}function HL(t,e,r,n){var s=e.settings.tableLineWidth,a=e.settings.tableLineColor;t.applyStyles({lineWidth:s,lineColor:a});var i=GL(s,!1);i&&t.rect(r.x,r.y,e.getWidth(t.pageSize().width),n.y-r.y,i)}function GL(t,e){var r=t>0,n=e||e===0;return r&&n?"DF":r?"S":n?"F":null}function hb(t,e){var r,n,s,a;if(t=t||e,Array.isArray(t)){if(t.length>=4)return{top:t[0],right:t[1],bottom:t[2],left:t[3]};if(t.length===3)return{top:t[0],right:t[1],bottom:t[2],left:t[1]};if(t.length===2)return{top:t[0],right:t[1],bottom:t[0],left:t[1]};t.length===1?t=t[0]:t=e}return typeof t=="object"?(typeof t.vertical=="number"&&(t.top=t.vertical,t.bottom=t.vertical),typeof t.horizontal=="number"&&(t.right=t.horizontal,t.left=t.horizontal),{left:(r=t.left)!==null&&r!==void 0?r:e,top:(n=t.top)!==null&&n!==void 0?n:e,right:(s=t.right)!==null&&s!==void 0?s:e,bottom:(a=t.bottom)!==null&&a!==void 0?a:e}):(typeof t!="number"&&(t=e),{top:t,right:t,bottom:t,left:t})}function KL(t,e){var r=hb(e.settings.margin,0);return t.pageSize().width-(r.left+r.right)}function lle(t,e,r,n,s){var a={},i=1.3333333333333333,l=Hw(e,function(N){return s.getComputedStyle(N).backgroundColor});l!=null&&(a.fillColor=l);var c=Hw(e,function(N){return s.getComputedStyle(N).color});c!=null&&(a.textColor=c);var u=ule(n,r);u&&(a.cellPadding=u);var d="borderTopColor",f=i*r,m=n.borderTopWidth;if(n.borderBottomWidth===m&&n.borderRightWidth===m&&n.borderLeftWidth===m){var h=(parseFloat(m)||0)/f;h&&(a.lineWidth=h)}else a.lineWidth={top:(parseFloat(n.borderTopWidth)||0)/f,right:(parseFloat(n.borderRightWidth)||0)/f,bottom:(parseFloat(n.borderBottomWidth)||0)/f,left:(parseFloat(n.borderLeftWidth)||0)/f},a.lineWidth.top||(a.lineWidth.right?d="borderRightColor":a.lineWidth.bottom?d="borderBottomColor":a.lineWidth.left&&(d="borderLeftColor"));var g=Hw(e,function(N){return s.getComputedStyle(N)[d]});g!=null&&(a.lineColor=g);var p=["left","right","center","justify"];p.indexOf(n.textAlign)!==-1&&(a.halign=n.textAlign),p=["middle","bottom","top"],p.indexOf(n.verticalAlign)!==-1&&(a.valign=n.verticalAlign);var v=parseInt(n.fontSize||"");isNaN(v)||(a.fontSize=v/i);var b=cle(n);b&&(a.fontStyle=b);var w=(n.fontFamily||"").toLowerCase();return t.indexOf(w)!==-1&&(a.font=w),a}function cle(t){var e="";return(t.fontWeight==="bold"||t.fontWeight==="bolder"||parseInt(t.fontWeight)>=700)&&(e="bold"),(t.fontStyle==="italic"||t.fontStyle==="oblique")&&(e+="italic"),e}function Hw(t,e){var r=YL(t,e);if(!r)return null;var n=r.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!n||!Array.isArray(n))return null;var s=[parseInt(n[1]),parseInt(n[2]),parseInt(n[3])],a=parseInt(n[4]);return a===0||isNaN(s[0])||isNaN(s[1])||isNaN(s[2])?null:s}function YL(t,e){var r=e(t);return r==="rgba(0, 0, 0, 0)"||r==="transparent"||r==="initial"||r==="inherit"?t.parentElement==null?null:YL(t.parentElement,e):r}function ule(t,e){var r=[t.paddingTop,t.paddingRight,t.paddingBottom,t.paddingLeft],n=96/(72/e),s=(parseInt(t.lineHeight)-parseInt(t.fontSize))/e/2,a=r.map(function(l){return parseInt(l||"0")/n}),i=hb(a,0);return s>i.top&&(i.top=s),s>i.bottom&&(i.bottom=s),i}function XL(t,e,r,n,s){var a,i;n===void 0&&(n=!1),s===void 0&&(s=!1);var l;typeof e=="string"?l=r.document.querySelector(e):l=e;var c=Object.keys(t.getFontList()),u=t.scaleFactor(),d=[],f=[],m=[];if(!l)return console.error("Html table could not be found with input: ",e),{head:d,body:f,foot:m};for(var h=0;h<l.rows.length;h++){var g=l.rows[h],p=(i=(a=g==null?void 0:g.parentElement)===null||a===void 0?void 0:a.tagName)===null||i===void 0?void 0:i.toLowerCase(),v=dle(c,u,r,g,n,s);v&&(p==="thead"?d.push(v):p==="tfoot"?m.push(v):f.push(v))}return{head:d,body:f,foot:m}}function dle(t,e,r,n,s,a){for(var i=new WL(n),l=0;l<n.cells.length;l++){var c=n.cells[l],u=r.getComputedStyle(c);if(s||u.display!=="none"){var d=void 0;a&&(d=lle(t,c,e,u,r)),i.push({rowSpan:c.rowSpan,colSpan:c.colSpan,styles:d,_element:c,content:fle(c)})}}var f=r.getComputedStyle(n);if(i.length>0&&(s||f.display!=="none"))return i}function fle(t){var e=t.cloneNode(!0);return e.innerHTML=e.innerHTML.replace(/\n/g,"").replace(/ +/g," "),e.innerHTML=e.innerHTML.split(/<br.*?>/).map(function(r){return r.trim()}).join(`
`),e.innerText||e.textContent||""}function hle(t,e,r){for(var n=0,s=[t,e,r];n<s.length;n++){var a=s[n];a&&typeof a!="object"&&console.error("The options parameter should be of type object, is: "+typeof a),a.startY&&typeof a.startY!="number"&&(console.error("Invalid value for startY option",a.startY),delete a.startY)}}function Tc(t,e,r,n,s){if(t==null)throw new TypeError("Cannot convert undefined or null to object");for(var a=Object(t),i=1;i<arguments.length;i++){var l=arguments[i];if(l!=null)for(var c in l)Object.prototype.hasOwnProperty.call(l,c)&&(a[c]=l[c])}return a}function mle(t,e){var r=new K0(t),n=r.getDocumentOptions(),s=r.getGlobalOptions();hle(s,n,e);var a=Tc({},s,n,e),i;typeof window<"u"&&(i=window);var l=ple(s,n,e),c=gle(s,n,e),u=xle(r,a),d=vle(r,a,i);return{id:e.tableId,content:d,hooks:c,styles:l,settings:u}}function ple(t,e,r){for(var n={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},s=function(c){if(c==="columnStyles"){var u=t[c],d=e[c],f=r[c];n.columnStyles=Tc({},u,d,f)}else{var m=[t,e,r],h=m.map(function(g){return g[c]||{}});n[c]=Tc({},h[0],h[1],h[2])}},a=0,i=Object.keys(n);a<i.length;a++){var l=i[a];s(l)}return n}function gle(t,e,r){for(var n=[t,e,r],s={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},a=0,i=n;a<i.length;a++){var l=i[a];l.didParseCell&&s.didParseCell.push(l.didParseCell),l.willDrawCell&&s.willDrawCell.push(l.willDrawCell),l.didDrawCell&&s.didDrawCell.push(l.didDrawCell),l.willDrawPage&&s.willDrawPage.push(l.willDrawPage),l.didDrawPage&&s.didDrawPage.push(l.didDrawPage)}return s}function xle(t,e){var r,n,s,a,i,l,c,u,d,f,m,h,g=hb(e.margin,40/t.scaleFactor()),p=(r=yle(t,e.startY))!==null&&r!==void 0?r:g.top,v;e.showFoot===!0?v="everyPage":e.showFoot===!1?v="never":v=(n=e.showFoot)!==null&&n!==void 0?n:"everyPage";var b;e.showHead===!0?b="everyPage":e.showHead===!1?b="never":b=(s=e.showHead)!==null&&s!==void 0?s:"everyPage";var w=(a=e.useCss)!==null&&a!==void 0?a:!1,N=e.theme||(w?"plain":"striped"),j=!!e.horizontalPageBreak,F=(i=e.horizontalPageBreakRepeat)!==null&&i!==void 0?i:null;return{includeHiddenHtml:(l=e.includeHiddenHtml)!==null&&l!==void 0?l:!1,useCss:w,theme:N,startY:p,margin:g,pageBreak:(c=e.pageBreak)!==null&&c!==void 0?c:"auto",rowPageBreak:(u=e.rowPageBreak)!==null&&u!==void 0?u:"auto",tableWidth:(d=e.tableWidth)!==null&&d!==void 0?d:"auto",showHead:b,showFoot:v,tableLineWidth:(f=e.tableLineWidth)!==null&&f!==void 0?f:0,tableLineColor:(m=e.tableLineColor)!==null&&m!==void 0?m:200,horizontalPageBreak:j,horizontalPageBreakRepeat:F,horizontalPageBreakBehaviour:(h=e.horizontalPageBreakBehaviour)!==null&&h!==void 0?h:"afterAllRows"}}function yle(t,e){var r=t.getLastAutoTable(),n=t.scaleFactor(),s=t.pageNumber(),a=!1;if(r&&r.startPageNumber){var i=r.startPageNumber+r.pageNumber-1;a=i===s}return typeof e=="number"?e:(e==null||e===!1)&&a&&(r==null?void 0:r.finalY)!=null?r.finalY+20/n:null}function vle(t,e,r){var n=e.head||[],s=e.body||[],a=e.foot||[];if(e.html){var i=e.includeHiddenHtml;if(r){var l=XL(t,e.html,r,i,e.useCss)||{};n=l.head||n,s=l.body||n,a=l.foot||n}else console.error("Cannot parse html in non browser environment")}var c=e.columns||ble(n,s,a);return{columns:c,head:n,body:s,foot:a}}function ble(t,e,r){var n=t[0]||e[0]||r[0]||[],s=[];return Object.keys(n).filter(function(a){return a!=="_element"}).forEach(function(a){var i=1,l;Array.isArray(n)?l=n[parseInt(a)]:l=n[a],typeof l=="object"&&!Array.isArray(l)&&(i=(l==null?void 0:l.colSpan)||1);for(var c=0;c<i;c++){var u=void 0;Array.isArray(n)?u=s.length:u=a+(c>0?"_".concat(c):"");var d={dataKey:u};s.push(d)}}),s}var dN=function(){function t(e,r,n){this.table=r,this.pageNumber=r.pageNumber,this.settings=r.settings,this.cursor=n,this.doc=e.getDocument()}return t}(),wle=function(t){qL(e,t);function e(r,n,s,a,i,l){var c=t.call(this,r,n,l)||this;return c.cell=s,c.row=a,c.column=i,c.section=a.section,c}return e}(dN),_le=function(){function t(e,r){this.pageNumber=1,this.id=e.id,this.settings=e.settings,this.styles=e.styles,this.hooks=e.hooks,this.columns=r.columns,this.head=r.head,this.body=r.body,this.foot=r.foot}return t.prototype.getHeadHeight=function(e){return this.head.reduce(function(r,n){return r+n.getMaxCellHeight(e)},0)},t.prototype.getFootHeight=function(e){return this.foot.reduce(function(r,n){return r+n.getMaxCellHeight(e)},0)},t.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},t.prototype.callCellHooks=function(e,r,n,s,a,i){for(var l=0,c=r;l<c.length;l++){var u=c[l],d=new wle(e,this,n,s,a,i),f=u(d)===!1;if(n.text=Array.isArray(n.text)?n.text:[n.text],f)return!1}return!0},t.prototype.callEndPageHooks=function(e,r){e.applyStyles(e.userStyles);for(var n=0,s=this.hooks.didDrawPage;n<s.length;n++){var a=s[n];a(new dN(e,this,r))}},t.prototype.callWillDrawPageHooks=function(e,r){for(var n=0,s=this.hooks.willDrawPage;n<s.length;n++){var a=s[n];a(new dN(e,this,r))}},t.prototype.getWidth=function(e){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var r=this.columns.reduce(function(s,a){return s+a.wrappedWidth},0);return r}else{var n=this.settings.margin;return e-n.left-n.right}},t}(),QL=function(){function t(e,r,n,s,a){a===void 0&&(a=!1),this.height=0,this.raw=e,e instanceof WL&&(this.raw=e._element,this.element=e._element),this.index=r,this.section=n,this.cells=s,this.spansMultiplePages=a}return t.prototype.getMaxCellHeight=function(e){var r=this;return e.reduce(function(n,s){var a;return Math.max(n,((a=r.cells[s.index])===null||a===void 0?void 0:a.height)||0)},0)},t.prototype.hasRowSpan=function(e){var r=this;return e.filter(function(n){var s=r.cells[n.index];return s?s.rowSpan>1:!1}).length>0},t.prototype.canEntireRowFit=function(e,r){return this.getMaxCellHeight(r)<=e},t.prototype.getMinimumRowHeight=function(e,r){var n=this;return e.reduce(function(s,a){var i=n.cells[a.index];if(!i)return 0;var l=r.getLineHeight(i.styles.fontSize),c=i.padding("vertical"),u=c+l;return u>s?u:s},0)},t}(),JL=function(){function t(e,r,n){var s;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=r,this.section=n,this.raw=e;var a=e;e!=null&&typeof e=="object"&&!Array.isArray(e)?(this.rowSpan=e.rowSpan||1,this.colSpan=e.colSpan||1,a=(s=e.content)!==null&&s!==void 0?s:e,e._element&&(this.raw=e._element)):(this.rowSpan=1,this.colSpan=1);var i=a!=null?""+a:"",l=/\r\n|\r|\n/g;this.text=i.split(l)}return t.prototype.getTextPos=function(){var e;if(this.styles.valign==="top")e=this.y+this.padding("top");else if(this.styles.valign==="bottom")e=this.y+this.height-this.padding("bottom");else{var r=this.height-this.padding("vertical");e=this.y+r/2+this.padding("top")}var n;if(this.styles.halign==="right")n=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var s=this.width-this.padding("horizontal");n=this.x+s/2+this.padding("left")}else n=this.x+this.padding("left");return{x:n,y:e}},t.prototype.getContentHeight=function(e,r){r===void 0&&(r=1.15);var n=Array.isArray(this.text)?this.text.length:1,s=this.styles.fontSize/e*r,a=n*s+this.padding("vertical");return Math.max(a,this.styles.minCellHeight)},t.prototype.padding=function(e){var r=hb(this.styles.cellPadding,0);return e==="vertical"?r.top+r.bottom:e==="horizontal"?r.left+r.right:r[e]},t}(),Nle=function(){function t(e,r,n){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=e,this.raw=r,this.index=n}return t.prototype.getMaxCustomCellWidth=function(e){for(var r=0,n=0,s=e.allRows();n<s.length;n++){var a=s[n],i=a.cells[this.index];i&&typeof i.styles.cellWidth=="number"&&(r=Math.max(r,i.styles.cellWidth))}return r},t}();function Sle(t,e){Tle(t,e);var r=[],n=0;e.columns.forEach(function(a){var i=a.getMaxCustomCellWidth(e);i?a.width=i:(a.width=a.wrappedWidth,r.push(a)),n+=a.width});var s=e.getWidth(t.pageSize().width)-n;s&&(s=fN(r,s,function(a){return Math.max(a.minReadableWidth,a.minWidth)})),s&&(s=fN(r,s,function(a){return a.minWidth})),s=Math.abs(s),!e.settings.horizontalPageBreak&&s>.1/t.scaleFactor()&&(s=s<1?s:Math.round(s),console.warn("Of the table content, ".concat(s," units width could not fit page"))),Ele(e),Cle(e,t),Ale(e)}function Tle(t,e){var r=t.scaleFactor(),n=e.settings.horizontalPageBreak,s=KL(t,e);e.allRows().forEach(function(a){for(var i=0,l=e.columns;i<l.length;i++){var c=l[i],u=a.cells[c.index];if(u){var d=e.hooks.didParseCell;e.callCellHooks(t,d,u,a,c,null);var f=u.padding("horizontal");u.contentWidth=i2(u.text,u.styles,t)+f;var m=i2(u.text.join(" ").split(/[^\S\u00A0]+/),u.styles,t);if(u.minReadableWidth=m+u.padding("horizontal"),typeof u.styles.cellWidth=="number")u.minWidth=u.styles.cellWidth,u.wrappedWidth=u.styles.cellWidth;else if(u.styles.cellWidth==="wrap"||n===!0)u.contentWidth>s?(u.minWidth=s,u.wrappedWidth=s):(u.minWidth=u.contentWidth,u.wrappedWidth=u.contentWidth);else{var h=10/r;u.minWidth=u.styles.minCellWidth||h,u.wrappedWidth=u.contentWidth,u.minWidth>u.wrappedWidth&&(u.wrappedWidth=u.minWidth)}}}}),e.allRows().forEach(function(a){for(var i=0,l=e.columns;i<l.length;i++){var c=l[i],u=a.cells[c.index];if(u&&u.colSpan===1)c.wrappedWidth=Math.max(c.wrappedWidth,u.wrappedWidth),c.minWidth=Math.max(c.minWidth,u.minWidth),c.minReadableWidth=Math.max(c.minReadableWidth,u.minReadableWidth);else{var d=e.styles.columnStyles[c.dataKey]||e.styles.columnStyles[c.index]||{},f=d.cellWidth||d.minCellWidth;f&&typeof f=="number"&&(c.minWidth=f,c.wrappedWidth=f)}u&&(u.colSpan>1&&!c.minWidth&&(c.minWidth=u.minWidth),u.colSpan>1&&!c.wrappedWidth&&(c.wrappedWidth=u.minWidth))}})}function fN(t,e,r){for(var n=e,s=t.reduce(function(h,g){return h+g.wrappedWidth},0),a=0;a<t.length;a++){var i=t[a],l=i.wrappedWidth/s,c=n*l,u=i.width+c,d=r(i),f=u<d?d:u;e-=f-i.width,i.width=f}if(e=Math.round(e*1e10)/1e10,e){var m=t.filter(function(h){return e<0?h.width>r(h):!0});m.length&&(e=fN(m,e,r))}return e}function Ale(t){for(var e={},r=1,n=t.allRows(),s=0;s<n.length;s++)for(var a=n[s],i=0,l=t.columns;i<l.length;i++){var c=l[i],u=e[c.index];if(r>1)r--,delete a.cells[c.index];else if(u)u.cell.height+=a.height,r=u.cell.colSpan,delete a.cells[c.index],u.left--,u.left<=1&&delete e[c.index];else{var d=a.cells[c.index];if(!d)continue;if(d.height=a.height,d.rowSpan>1){var f=n.length-s,m=d.rowSpan>f?f:d.rowSpan;e[c.index]={cell:d,left:m,row:a}}}}}function Ele(t){for(var e=t.allRows(),r=0;r<e.length;r++)for(var n=e[r],s=null,a=0,i=0,l=0;l<t.columns.length;l++){var c=t.columns[l];if(i-=1,i>1&&t.columns[l+1])a+=c.width,delete n.cells[c.index];else if(s){var u=s;delete n.cells[c.index],s=null,u.width=c.width+a}else{var u=n.cells[c.index];if(!u)continue;if(i=u.colSpan,a=0,u.colSpan>1){s=u,a+=c.width;continue}u.width=c.width+a}}}function Cle(t,e){for(var r={count:0,height:0},n=0,s=t.allRows();n<s.length;n++){for(var a=s[n],i=0,l=t.columns;i<l.length;i++){var c=l[i],u=a.cells[c.index];if(u){e.applyStyles(u.styles,!0);var d=u.width-u.padding("horizontal");if(u.styles.overflow==="linebreak")u.text=e.splitTextToSize(u.text,d+1/e.scaleFactor(),{fontSize:u.styles.fontSize});else if(u.styles.overflow==="ellipsize")u.text=s6(u.text,d,u.styles,e,"...");else if(u.styles.overflow==="hidden")u.text=s6(u.text,d,u.styles,e,"");else if(typeof u.styles.overflow=="function"){var f=u.styles.overflow(u.text,d);typeof f=="string"?u.text=[f]:u.text=f}u.contentHeight=u.getContentHeight(e.scaleFactor(),e.getLineHeightFactor());var m=u.contentHeight/u.rowSpan;u.rowSpan>1&&r.count*r.height<m*u.rowSpan?r={height:m,count:u.rowSpan}:r&&r.count>0&&r.height>m&&(m=r.height),m>a.height&&(a.height=m)}}r.count--}}function s6(t,e,r,n,s){return t.map(function(a){return kle(a,e,r,n,s)})}function kle(t,e,r,n,s){var a=1e4*n.scaleFactor();if(e=Math.ceil(e*a)/a,e>=i2(t,r,n))return t;for(;e<i2(t+s,r,n)&&!(t.length<=1);)t=t.substring(0,t.length-1);return t.trim()+s}function Ile(t,e){var r=new K0(t),n=jle(e,r.scaleFactor()),s=new _le(e,n);return Sle(r,s),r.applyStyles(r.userStyles),s}function jle(t,e){var r=t.content,n=Rle(r.columns);if(r.head.length===0){var s=a6(n,"head");s&&r.head.push(s)}if(r.foot.length===0){var s=a6(n,"foot");s&&r.foot.push(s)}var a=t.settings.theme,i=t.styles;return{columns:n,head:Gw("head",r.head,n,i,a,e),body:Gw("body",r.body,n,i,a,e),foot:Gw("foot",r.foot,n,i,a,e)}}function Gw(t,e,r,n,s,a){var i={},l=e.map(function(c,u){for(var d=0,f={},m=0,h=0,g=0,p=r;g<p.length;g++){var v=p[g];if(i[v.index]==null||i[v.index].left===0)if(h===0){var b=void 0;Array.isArray(c)?b=c[v.index-m-d]:b=c[v.dataKey];var w={};typeof b=="object"&&!Array.isArray(b)&&(w=(b==null?void 0:b.styles)||{});var N=Dle(t,v,u,s,n,a,w),j=new JL(b,N,t);f[v.dataKey]=j,f[v.index]=j,h=j.colSpan-1,i[v.index]={left:j.rowSpan-1,times:h}}else h--,m++;else i[v.index].left--,h=i[v.index].times,d++}return new QL(c,u,t,f)});return l}function a6(t,e){var r={};return t.forEach(function(n){if(n.raw!=null){var s=Ple(e,n.raw);s!=null&&(r[n.dataKey]=s)}}),Object.keys(r).length>0?r:null}function Ple(t,e){if(t==="head"){if(typeof e=="object")return e.header||null;if(typeof e=="string"||typeof e=="number")return e}else if(t==="foot"&&typeof e=="object")return e.footer;return null}function Rle(t){return t.map(function(e,r){var n,s;return typeof e=="object"?s=(n=e.dataKey)!==null&&n!==void 0?n:r:s=r,new Nle(s,e,r)})}function Dle(t,e,r,n,s,a,i){var l=ole(n),c;t==="head"?c=s.headStyles:t==="body"?c=s.bodyStyles:t==="foot"&&(c=s.footStyles);var u=Tc({},l.table,l[t],s.styles,c),d=s.columnStyles[e.dataKey]||s.columnStyles[e.index]||{},f=t==="body"?d:{},m=t==="body"&&r%2===0?Tc({},l.alternateRow,s.alternateRowStyles):{},h=ile(a),g=Tc({},h,u,m,f);return Tc(g,i)}function Fle(t,e,r){var n;r===void 0&&(r={});var s=KL(t,e),a=new Map,i=[],l=[],c=[];Array.isArray(e.settings.horizontalPageBreakRepeat)?c=e.settings.horizontalPageBreakRepeat:(typeof e.settings.horizontalPageBreakRepeat=="string"||typeof e.settings.horizontalPageBreakRepeat=="number")&&(c=[e.settings.horizontalPageBreakRepeat]),c.forEach(function(m){var h=e.columns.find(function(g){return g.dataKey===m||g.index===m});h&&!a.has(h.index)&&(a.set(h.index,!0),i.push(h.index),l.push(e.columns[h.index]),s-=h.wrappedWidth)});for(var u=!0,d=(n=r==null?void 0:r.start)!==null&&n!==void 0?n:0;d<e.columns.length;){if(a.has(d)){d++;continue}var f=e.columns[d].wrappedWidth;if(u||s>=f)u=!1,i.push(d),l.push(e.columns[d]),s-=f;else break;d++}return{colIndexes:i,columns:l,lastIndex:d-1}}function Lle(t,e){for(var r=[],n=0;n<e.columns.length;n++){var s=Fle(t,e,{start:n});s.columns.length&&(r.push(s),n=s.lastIndex)}return r}function Ole(t,e){var r=e.settings,n=r.startY,s=r.margin,a={x:s.left,y:n},i=e.getHeadHeight(e.columns)+e.getFootHeight(e.columns),l=n+s.bottom+i;if(r.pageBreak==="avoid"){var c=e.body,u=c.reduce(function(m,h){return m+h.height},0);l+=u}var d=new K0(t);(r.pageBreak==="always"||r.startY!=null&&l>d.pageSize().height)&&(e7(d),a.y=s.top),e.callWillDrawPageHooks(d,a);var f=Tc({},a);e.startPageNumber=d.pageNumber(),r.horizontalPageBreak?Mle(d,e,f,a):(d.applyStyles(d.userStyles),(r.showHead==="firstPage"||r.showHead==="everyPage")&&e.head.forEach(function(m){return Wc(d,e,m,a,e.columns)}),d.applyStyles(d.userStyles),e.body.forEach(function(m,h){var g=h===e.body.length-1;o2(d,e,m,g,f,a,e.columns)}),d.applyStyles(d.userStyles),(r.showFoot==="lastPage"||r.showFoot==="everyPage")&&e.foot.forEach(function(m){return Wc(d,e,m,a,e.columns)})),HL(d,e,f,a),e.callEndPageHooks(d,a),e.finalY=a.y,t.lastAutoTable=e,d.applyStyles(d.userStyles)}function Mle(t,e,r,n){var s=Lle(t,e),a=e.settings;if(a.horizontalPageBreakBehaviour==="afterAllRows")s.forEach(function(u,d){t.applyStyles(t.userStyles),d>0?cg(t,e,r,n,u.columns,!0):i6(t,e,n,u.columns),Vle(t,e,r,n,u.columns),Kw(t,e,n,u.columns)});else for(var i=-1,l=s[0],c=function(){var u=i;if(l){t.applyStyles(t.userStyles);var d=l.columns;i>=0?cg(t,e,r,n,d,!0):i6(t,e,n,d),u=o6(t,e,i+1,n,d),Kw(t,e,n,d)}var f=u-i;s.slice(1).forEach(function(m){t.applyStyles(t.userStyles),cg(t,e,r,n,m.columns,!0),o6(t,e,i+1,n,m.columns,f),Kw(t,e,n,m.columns)}),i=u};i<e.body.length-1;)c()}function i6(t,e,r,n){var s=e.settings;t.applyStyles(t.userStyles),(s.showHead==="firstPage"||s.showHead==="everyPage")&&e.head.forEach(function(a){return Wc(t,e,a,r,n)})}function Vle(t,e,r,n,s){t.applyStyles(t.userStyles),e.body.forEach(function(a,i){var l=i===e.body.length-1;o2(t,e,a,l,r,n,s)})}function o6(t,e,r,n,s,a){t.applyStyles(t.userStyles),a=a??e.body.length;var i=Math.min(r+a,e.body.length),l=-1;return e.body.slice(r,i).forEach(function(c,u){var d=r+u===e.body.length-1,f=ZL(t,e,d,n);c.canEntireRowFit(f,s)&&(Wc(t,e,c,n,s),l=r+u)}),l}function Kw(t,e,r,n){var s=e.settings;t.applyStyles(t.userStyles),(s.showFoot==="lastPage"||s.showFoot==="everyPage")&&e.foot.forEach(function(a){return Wc(t,e,a,r,n)})}function Ble(t,e,r){var n=r.getLineHeight(t.styles.fontSize),s=t.padding("vertical"),a=Math.floor((e-s)/n);return Math.max(0,a)}function Ule(t,e,r,n){var s={};t.spansMultiplePages=!0,t.height=0;for(var a=0,i=0,l=r.columns;i<l.length;i++){var c=l[i],u=t.cells[c.index];if(u){Array.isArray(u.text)||(u.text=[u.text]);var d=new JL(u.raw,u.styles,u.section);d=Tc(d,u),d.text=[];var f=Ble(u,e,n);u.text.length>f&&(d.text=u.text.splice(f,u.text.length));var m=n.scaleFactor(),h=n.getLineHeightFactor();u.contentHeight=u.getContentHeight(m,h),u.contentHeight>=e&&(u.contentHeight=e,d.styles.minCellHeight-=e),u.contentHeight>t.height&&(t.height=u.contentHeight),d.contentHeight=d.getContentHeight(m,h),d.contentHeight>a&&(a=d.contentHeight),s[c.index]=d}}var g=new QL(t.raw,-1,t.section,s,!0);g.height=a;for(var p=0,v=r.columns;p<v.length;p++){var c=v[p],d=g.cells[c.index];d&&(d.height=g.height);var u=t.cells[c.index];u&&(u.height=t.height)}return g}function $le(t,e,r,n){var s=t.pageSize().height,a=n.settings.margin,i=a.top+a.bottom,l=s-i;e.section==="body"&&(l-=n.getHeadHeight(n.columns)+n.getFootHeight(n.columns));var c=e.getMinimumRowHeight(n.columns,t),u=c<r;if(c>l)return console.error("Will not be able to print row ".concat(e.index," correctly since it's minimum height is larger than page height")),!0;if(!u)return!1;var d=e.hasRowSpan(n.columns),f=e.getMaxCellHeight(n.columns)>l;return f?(d&&console.error("The content of row ".concat(e.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(d||n.settings.rowPageBreak==="avoid")}function o2(t,e,r,n,s,a,i){var l=ZL(t,e,n,a);if(r.canEntireRowFit(l,i))Wc(t,e,r,a,i);else if($le(t,r,l,e)){var c=Ule(r,l,e,t);Wc(t,e,r,a,i),cg(t,e,s,a,i),o2(t,e,c,n,s,a,i)}else cg(t,e,s,a,i),o2(t,e,r,n,s,a,i)}function Wc(t,e,r,n,s){n.x=e.settings.margin.left;for(var a=0,i=s;a<i.length;a++){var l=i[a],c=r.cells[l.index];if(!c){n.x+=l.width;continue}t.applyStyles(c.styles),c.x=n.x,c.y=n.y;var u=e.callCellHooks(t,e.hooks.willDrawCell,c,r,l,n);if(u===!1){n.x+=l.width;continue}zle(t,c,n);var d=c.getTextPos();zL(c.text,d.x,d.y,{halign:c.styles.halign,valign:c.styles.valign,maxWidth:Math.ceil(c.width-c.padding("left")-c.padding("right"))},t.getDocument()),e.callCellHooks(t,e.hooks.didDrawCell,c,r,l,n),n.x+=l.width}n.y+=r.height}function zle(t,e,r){var n=e.styles;if(t.getDocument().setFillColor(t.getDocument().getFillColor()),typeof n.lineWidth=="number"){var s=GL(n.lineWidth,n.fillColor);s&&t.rect(e.x,r.y,e.width,e.height,s)}else typeof n.lineWidth=="object"&&(n.fillColor&&t.rect(e.x,r.y,e.width,e.height,"F"),qle(t,e,r,n.lineWidth))}function qle(t,e,r,n){var s,a,i,l;n.top&&(s=r.x,a=r.y,i=r.x+e.width,l=r.y,n.right&&(i+=.5*n.right),n.left&&(s-=.5*n.left),c(n.top,s,a,i,l)),n.bottom&&(s=r.x,a=r.y+e.height,i=r.x+e.width,l=r.y+e.height,n.right&&(i+=.5*n.right),n.left&&(s-=.5*n.left),c(n.bottom,s,a,i,l)),n.left&&(s=r.x,a=r.y,i=r.x,l=r.y+e.height,n.top&&(a-=.5*n.top),n.bottom&&(l+=.5*n.bottom),c(n.left,s,a,i,l)),n.right&&(s=r.x+e.width,a=r.y,i=r.x+e.width,l=r.y+e.height,n.top&&(a-=.5*n.top),n.bottom&&(l+=.5*n.bottom),c(n.right,s,a,i,l));function c(u,d,f,m,h){t.getDocument().setLineWidth(u),t.getDocument().line(d,f,m,h,"S")}}function ZL(t,e,r,n){var s=e.settings.margin.bottom,a=e.settings.showFoot;return(a==="everyPage"||a==="lastPage"&&r)&&(s+=e.getFootHeight(e.columns)),t.pageSize().height-n.y-s}function cg(t,e,r,n,s,a){s===void 0&&(s=[]),a===void 0&&(a=!1),t.applyStyles(t.userStyles),e.settings.showFoot==="everyPage"&&!a&&e.foot.forEach(function(l){return Wc(t,e,l,n,s)}),e.callEndPageHooks(t,n);var i=e.settings.margin;HL(t,e,r,n),e7(t),e.pageNumber++,n.x=i.left,n.y=i.top,r.y=i.top,e.callWillDrawPageHooks(t,n),e.settings.showHead==="everyPage"&&(e.head.forEach(function(l){return Wc(t,e,l,n,s)}),t.applyStyles(t.userStyles))}function e7(t){var e=t.pageNumber();t.setPage(e+1);var r=t.pageNumber();return r===e?(t.addPage(),!0):!1}function Wle(t){t.API.autoTable=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var n=e[0],s=mle(this,n),a=Ile(this,s);return Ole(this,a),this},t.API.lastAutoTable=!1,t.API.autoTableText=function(e,r,n,s){zL(e,r,n,s,this)},t.API.autoTableSetDefaults=function(e){return K0.setDefaults(e,this),this},t.autoTableSetDefaults=function(e,r){K0.setDefaults(e,r)},t.API.autoTableHtmlToJson=function(e,r){var n;if(r===void 0&&(r=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var s=new K0(this),a=XL(s,e,window,r,!1),i=a.head,l=a.body,c=((n=i[0])===null||n===void 0?void 0:n.map(function(u){return u.content}))||[];return{columns:c,rows:l,data:l}}}var Yw;try{if(typeof window<"u"&&window){var l6=window,c6=l6.jsPDF||((Yw=l6.jspdf)===null||Yw===void 0?void 0:Yw.jsPDF);c6&&Wle(c6)}}catch(t){console.error("Could not apply autoTable plugin",t)}class hN{static getDateRanges(){const e=new Date,r=new Date(e);r.setDate(r.getDate()-1);const n=new Date(e);n.setDate(n.getDate()-7);const s=new Date(e);s.setMonth(s.getMonth()-1);const a=new Date(e);a.setMonth(a.getMonth()-3);const i=new Date(e.getFullYear(),e.getMonth(),1),l=new Date(e),c=l.getDay(),u=l.getDate()-c+(c===0?-6:1);return l.setDate(u),[{startDate:new Date(r.setHours(0,0,0,0)),endDate:new Date(r.setHours(23,59,59,999)),label:"Yesterday"},{startDate:new Date(l.setHours(0,0,0,0)),endDate:new Date(e.setHours(23,59,59,999)),label:"This Week"},{startDate:new Date(n.setHours(0,0,0,0)),endDate:new Date(e.setHours(23,59,59,999)),label:"Last 7 Days"},{startDate:new Date(i.setHours(0,0,0,0)),endDate:new Date(e.setHours(23,59,59,999)),label:"This Month"},{startDate:new Date(s.setHours(0,0,0,0)),endDate:new Date(e.setHours(23,59,59,999)),label:"Last 30 Days"},{startDate:new Date(a.setHours(0,0,0,0)),endDate:new Date(e.setHours(23,59,59,999)),label:"Last 3 Months"}]}static async getOrdersInRange(e,r,n){try{try{const s=[Nr("restaurantId","==",e),Nr("createdAt",">=",ft.fromDate(r)),Nr("createdAt","<=",ft.fromDate(n))],a=br(hr(Ke,"orders"),...s);return{success:!0,data:(await Tr(a)).docs.map(c=>{var d,f;const u=c.data();return{id:c.id,...u,createdAt:((d=u.createdAt)==null?void 0:d.toDate())||new Date,updatedAt:((f=u.updatedAt)==null?void 0:f.toDate())||new Date}}).sort((c,u)=>u.createdAt.getTime()-c.createdAt.getTime())}}catch{console.warn("Composite index not found, using fallback query. Please create the required index for better performance."),console.warn("Index needed: Collection: orders, Fields: restaurantId (asc), createdAt (asc)");const a=[Nr("restaurantId","==",e),Nr("createdAt",">=",ft.fromDate(r)),Nr("createdAt","<=",ft.fromDate(n))],i=br(hr(Ke,"orders"),...a);return{success:!0,data:(await Tr(i)).docs.map(u=>{var f,m;const d=u.data();return{id:u.id,...d,createdAt:((f=d.createdAt)==null?void 0:f.toDate())||new Date,updatedAt:((m=d.updatedAt)==null?void 0:m.toDate())||new Date}}).sort((u,d)=>d.createdAt.getTime()-u.createdAt.getTime())}}}catch(s){return console.error("Error fetching orders in range:",s),{success:!1,error:s instanceof Error?s.message:"Failed to fetch orders"}}}static async generateSalesAnalytics(e,r,n,s=[],a=[],i=[]){try{const l=await this.getOrdersInRange(e,r,n);if(!l.success||!l.data)return{success:!1,error:"Failed to fetch orders for analytics"};const c=l.data,u=n.getTime()-r.getTime(),d=new Date(r.getTime()-u),f=new Date(n.getTime()-u),h=(await this.getOrdersInRange(e,d,f)).data||[],g=c.reduce((K,q)=>K+q.total,0),p=c.length,v=p>0?g/p:0,b=c.reduce((K,q)=>K+q.items.reduce((te,oe)=>te+oe.quantity,0),0),w=h.reduce((K,q)=>K+q.total,0),N=h.length,j=w>0?(g-w)/w*100:0,F=N>0?(p-N)/N*100:0,U=new Map;c.forEach(K=>{K.items.forEach(q=>{const te=U.get(q.menuItemId);te?(te.quantitySold+=q.quantity,te.revenue+=q.total):U.set(q.menuItemId,{name:q.name,quantitySold:q.quantity,revenue:q.total})})});const A=Array.from(U.entries()).map(([K,q])=>({menuItemId:K,name:q.name,quantitySold:q.quantitySold,revenue:q.revenue,percentage:g>0?q.revenue/g*100:0})).sort((K,q)=>q.revenue-K.revenue),S=new Map;c.forEach(K=>{K.items.forEach(q=>{const te=s.find(xe=>xe.id===q.menuItemId),oe=(te==null?void 0:te.categoryName)||"Uncategorized",V=S.get(oe);V?(V.quantitySold+=q.quantity,V.revenue+=q.total,V.itemCount++):S.set(oe,{quantitySold:q.quantity,revenue:q.total,itemCount:1})})});const k=Array.from(S.entries()).map(([K,q])=>({categoryName:K,quantitySold:q.quantitySold,revenue:q.revenue,percentage:g>0?q.revenue/g*100:0,itemCount:q.itemCount})).sort((K,q)=>q.revenue-K.revenue),M=new Map;c.forEach(K=>{if(K.tableId){const q=M.get(K.tableId);q?(q.orderCount++,q.revenue+=K.total):M.set(K.tableId,{orderCount:1,revenue:K.total})}});const I=Array.from(M.entries()).map(([K,q])=>{const te=a.find(oe=>oe.id===K);return{tableId:K,tableNumber:(te==null?void 0:te.number)||"Unknown",orderCount:q.orderCount,revenue:q.revenue,averageOrderValue:q.revenue/q.orderCount,utilizationRate:q.orderCount}}).sort((K,q)=>q.revenue-K.revenue),E=new Map;c.forEach(K=>{const q=K.createdAt.getHours(),te=E.get(q);te?(te.orderCount++,te.revenue+=K.total):E.set(q,{orderCount:1,revenue:K.total})});const D=Array.from({length:24},(K,q)=>{var te,oe;return{hour:q,orderCount:((te=E.get(q))==null?void 0:te.orderCount)||0,revenue:((oe=E.get(q))==null?void 0:oe.revenue)||0}}),G=new Map,Z=new Map;c.forEach(K=>{const q=Fs(K.createdAt),te=K.customerId||"anonymous",oe=G.get(q);oe?(oe.orderCount++,oe.revenue+=K.total):G.set(q,{orderCount:1,revenue:K.total,customerCount:0}),Z.has(q)||Z.set(q,new Set),Z.get(q).add(te)}),G.forEach((K,q)=>{var te;K.customerCount=((te=Z.get(q))==null?void 0:te.size)||0});const ae=Array.from(G.entries()).map(([K,q])=>({date:K,orderCount:q.orderCount,revenue:q.revenue,customerCount:q.customerCount})).sort((K,q)=>new Date(K.date).getTime()-new Date(q.date).getTime()),de=new Map;try{const K=br(hr(Ke,`restaurants/${e}/payments`),Nr("createdAt",">=",ft.fromDate(r)),Nr("createdAt","<=",ft.fromDate(n)),Nr("status","==","completed"));(await Tr(K)).docs.forEach(te=>{const oe=te.data(),V=this.formatPaymentMethod(oe.method),xe=de.get(V);xe?(xe.count++,xe.amount+=oe.amount||0):de.set(V,{count:1,amount:oe.amount||0})})}catch{console.log("Payment data not available, using order data as fallback"),c.forEach(q=>{const te=this.estimatePaymentMethod(q),oe=de.get(te);oe?(oe.count++,oe.amount+=q.total):de.set(te,{count:1,amount:q.total})})}const se=Array.from(de.entries()).map(([K,q])=>({method:K,count:q.count,amount:q.amount,percentage:g>0?q.amount/g*100:0})).sort((K,q)=>q.amount-K.amount),Y=new Map;c.forEach(K=>{const q=K.type||"dine_in",te=Y.get(q);te?(te.count++,te.revenue+=K.total):Y.set(q,{count:1,revenue:K.total})});const ye=Array.from(Y.entries()).map(([K,q])=>({type:K,count:q.count,revenue:q.revenue,percentage:g>0?q.revenue/g*100:0})),re=new Map;c.forEach(K=>{if(K.customerId){const q=re.get(K.customerId);if(q)q.orderCount++,q.totalSpent+=K.total,K.createdAt>q.lastOrderDate&&(q.lastOrderDate=K.createdAt);else{const te=i.find(oe=>oe.id===K.customerId);re.set(K.customerId,{customerName:te==null?void 0:te.name,orderCount:1,totalSpent:K.total,lastOrderDate:K.createdAt})}}});const C=Array.from(re.entries()).map(([K,q])=>({customerId:K,customerName:q.customerName,orderCount:q.orderCount,totalSpent:q.totalSpent,averageOrderValue:q.totalSpent/q.orderCount,lastOrderDate:q.lastOrderDate})).sort((K,q)=>q.totalSpent-K.totalSpent).slice(0,10),O=new Map;c.forEach(K=>{const q=K.staffId||"unknown",te=O.get(q);te?(te.orderCount++,te.totalRevenue+=K.total):O.set(q,{orderCount:1,totalRevenue:K.total})});const L=Array.from(O.entries()).map(([K,q])=>({staffId:K,orderCount:q.orderCount,totalRevenue:q.totalRevenue,averageOrderValue:q.totalRevenue/q.orderCount})).sort((K,q)=>q.totalRevenue-K.totalRevenue);return{success:!0,data:{totalRevenue:g,totalOrders:p,averageOrderValue:v,totalItems:b,totalCustomers:re.size,revenueGrowth:j,orderGrowth:F,customerGrowth:0,menuItemSales:A,categorySales:k,tableSales:I,hourlyBreakdown:D,dailyBreakdown:ae,paymentMethodBreakdown:se,orderTypeBreakdown:ye,topCustomers:C,staffPerformance:L,peakHours:D.filter(K=>K.orderCount>0).map(K=>({...K,isWeekend:!1})).sort((K,q)=>q.orderCount-K.orderCount).slice(0,5),itemCombinations:[]}}}catch(l){return console.error("Error generating sales analytics:",l),{success:!1,error:l instanceof Error?l.message:"Failed to generate analytics"}}}static async generatePDFReport(e,r,n,s={includeGraphs:!0,includeMenuAnalysis:!0,includeTableAnalysis:!0,includeCustomerAnalysis:!0,includeStaffAnalysis:!0,includeTimeAnalysis:!0,includeTaxBreakdown:!0,includeDiscountAnalysis:!0}){try{console.log(" Creating PDF document...");const a=new pr;let i=20;if(typeof a.autoTable!="function")return console.error(" jsPDF autoTable plugin not available"),this.generateSimplePDFReport(e,r,n,s);console.log(" jsPDF autoTable plugin available"),a.setFontSize(28),a.setFont("helvetica","bold"),a.setTextColor(33,37,41),a.text(s.reportTitle||"Sales Report",20,i),i+=18,a.setFontSize(20),a.setFont("helvetica","normal"),a.setTextColor(52,58,64),a.text(n,20,i),i+=12,a.setFontSize(12),a.setFont("helvetica","normal"),a.setTextColor(108,117,125),a.text(`Report Period: ${r.label}`,20,i),i+=7,a.text(`${Fs(r.startDate)} - ${Fs(r.endDate)}`,20,i),i+=10,a.setLineWidth(.5),a.setDrawColor(220,220,220),a.line(20,i+5,190,i+5),i+=20,a.setFontSize(18),a.setFont("helvetica","bold"),a.setTextColor(33,37,41),a.text("Executive Summary",20,i),i+=12,a.setTextColor(0,0,0);const l=[["Total Revenue",pt(e.totalRevenue)],["Total Orders",e.totalOrders.toString()],["Average Order Value",pt(e.averageOrderValue)],["Total Items Sold",e.totalItems.toString()],["Unique Customers",e.totalCustomers.toString()],["Revenue Growth",`${e.revenueGrowth.toFixed(1)}%`],["Order Growth",`${e.orderGrowth.toFixed(1)}%`]];if(a.autoTable({startY:i,head:[["Metric","Value"]],body:l,theme:"grid",styles:{fontSize:11,font:"helvetica",textColor:[33,37,41],cellPadding:8,lineColor:[220,220,220],lineWidth:.5},headStyles:{fillColor:[52,58,64],textColor:[255,255,255],fontSize:12,fontStyle:"bold",halign:"center"},columnStyles:{0:{fontStyle:"bold",cellWidth:80},1:{halign:"right",cellWidth:60}}}),i=a.lastAutoTable.finalY+20,s.includeMenuAnalysis&&e.menuItemSales.length>0){i>240&&(a.addPage(),i=20),a.setFontSize(16),a.setFont("helvetica","bold"),a.setTextColor(33,37,41),a.text("Top Selling Items",20,i),i+=12;const c=e.menuItemSales.slice(0,10).map(u=>[u.name,u.quantitySold.toString(),pt(u.revenue),`${u.percentage.toFixed(1)}%`]);a.autoTable({startY:i,head:[["Item Name","Qty Sold","Revenue","% of Total"]],body:c,theme:"grid",styles:{fontSize:10,font:"helvetica",textColor:[33,37,41],cellPadding:6,lineColor:[220,220,220],lineWidth:.5},headStyles:{fillColor:[40,167,69],textColor:[255,255,255],fontSize:11,fontStyle:"bold",halign:"center"},columnStyles:{0:{cellWidth:80},1:{halign:"center",cellWidth:30},2:{halign:"right",cellWidth:40},3:{halign:"center",cellWidth:30}}}),i=a.lastAutoTable.finalY+20}if(s.includeMenuAnalysis&&e.categorySales.length>0){i>240&&(a.addPage(),i=20),a.setFontSize(16),a.setFont("helvetica","bold"),a.setTextColor(33,37,41),a.text("Category Performance",20,i),i+=12;const c=e.categorySales.map(u=>[u.categoryName,u.quantitySold.toString(),pt(u.revenue),`${u.percentage.toFixed(1)}%`]);a.autoTable({startY:i,head:[["Category","Qty Sold","Revenue","% of Total"]],body:c,theme:"grid",styles:{fontSize:10,font:"helvetica",textColor:[33,37,41],cellPadding:6,lineColor:[220,220,220],lineWidth:.5},headStyles:{fillColor:[255,193,7],textColor:[33,37,41],fontSize:11,fontStyle:"bold",halign:"center"},columnStyles:{0:{cellWidth:80},1:{halign:"center",cellWidth:30},2:{halign:"right",cellWidth:40},3:{halign:"center",cellWidth:30}}}),i=a.lastAutoTable.finalY+20}if(s.includeTableAnalysis&&e.tableSales.length>0){i>240&&(a.addPage(),i=20),a.setFontSize(16),a.setFont("helvetica","bold"),a.text("Table Performance",20,i),i+=10;const c=e.tableSales.slice(0,10).map(u=>[u.tableNumber,u.orderCount.toString(),pt(u.revenue),pt(u.averageOrderValue)]);a.autoTable({startY:i,head:[["Table","Orders","Revenue","Avg Order Value"]],body:c,theme:"grid",styles:{fontSize:9},headStyles:{fillColor:[108,117,125]}}),i=a.lastAutoTable.finalY+20}if(s.includeOrderDetails&&e.detailedOrderList&&e.detailedOrderList.length>0){i>240&&(a.addPage(),i=20),a.setFontSize(16),a.setFont("helvetica","bold"),a.setTextColor(33,37,41),a.text("Detailed Order List",20,i),i+=12;const c=e.detailedOrderList.map(u=>[u.orderNumber,u.tableNumber,u.date,u.time,u.status.toUpperCase(),u.type.replace("_"," ").toUpperCase(),u.totalItems.toString(),pt(u.total)]);a.autoTable({startY:i,head:[["Order #","Table","Date","Time","Status","Type","Items","Total"]],body:c,theme:"grid",styles:{fontSize:9,font:"helvetica",textColor:[33,37,41],cellPadding:5,lineColor:[220,220,220],lineWidth:.5},headStyles:{fillColor:[52,58,64],textColor:[255,255,255],fontSize:10,fontStyle:"bold",halign:"center"},columnStyles:{0:{cellWidth:22,halign:"center"},1:{cellWidth:18,halign:"center"},2:{cellWidth:22,halign:"center"},3:{cellWidth:18,halign:"center"},4:{cellWidth:22,halign:"center"},5:{cellWidth:22,halign:"center"},6:{cellWidth:18,halign:"center"},7:{cellWidth:25,halign:"right"}}}),i=a.lastAutoTable.finalY+20}if(s.includeCustomerAnalysis&&e.topCustomers.length>0){i>240&&(a.addPage(),i=20),a.setFontSize(16),a.setFont("helvetica","bold"),a.text("Top Customers",20,i),i+=10;const c=e.topCustomers.slice(0,10).map(u=>[u.customerName||"Anonymous",u.orderCount.toString(),pt(u.totalSpent),pt(u.averageOrderValue),Fs(u.lastOrderDate)]);a.autoTable({startY:i,head:[["Customer","Orders","Total Spent","Avg Order","Last Order"]],body:c,theme:"grid",styles:{fontSize:8},headStyles:{fillColor:[220,53,69]}}),i=a.lastAutoTable.finalY+20}if(e.paymentMethodBreakdown.length>0){i>240&&(a.addPage(),i=20),a.setFontSize(16),a.setFont("helvetica","bold"),a.text("Payment Method Breakdown",20,i),i+=10;const c=e.paymentMethodBreakdown.map(u=>[u.method,u.count.toString(),pt(u.amount),`${u.percentage.toFixed(1)}%`]);a.autoTable({startY:i,head:[["Payment Method","Transactions","Amount","% of Total"]],body:c,theme:"grid",styles:{fontSize:10},headStyles:{fillColor:[156,39,176]}}),i=a.lastAutoTable.finalY+20}if(e.orderTypeBreakdown.length>0){i>240&&(a.addPage(),i=20),a.setFontSize(16),a.setFont("helvetica","bold"),a.text("Order Type Analysis",20,i),i+=10;const c=e.orderTypeBreakdown.map(u=>[u.type.replace("_"," ").toUpperCase(),u.count.toString(),pt(u.revenue),`${u.percentage.toFixed(1)}%`]);a.autoTable({startY:i,head:[["Order Type","Count","Revenue","% of Total"]],body:c,theme:"grid",styles:{fontSize:10},headStyles:{fillColor:[0,123,191]}}),i=a.lastAutoTable.finalY+20}if(s.includeStaffAnalysis&&e.staffPerformance.length>0){i>240&&(a.addPage(),i=20),a.setFontSize(16),a.setFont("helvetica","bold"),a.text("Staff Performance",20,i),i+=10;const c=e.staffPerformance.slice(0,10).map(u=>[u.staffName||`Staff ${u.staffId.slice(0,8)}`,u.orderCount.toString(),pt(u.totalRevenue),pt(u.averageOrderValue)]);a.autoTable({startY:i,head:[["Staff Member","Orders","Total Revenue","Avg Order Value"]],body:c,theme:"grid",styles:{fontSize:9},headStyles:{fillColor:[255,87,34]}}),i=a.lastAutoTable.finalY+20}if(s.includeTimeAnalysis&&e.dailyBreakdown.length>0){i>240&&(a.addPage(),i=20),a.setFontSize(16),a.setFont("helvetica","bold"),a.text("Daily Performance Analysis",20,i),i+=10;const c=e.dailyBreakdown.slice(-10).map(u=>[u.date,u.orderCount.toString(),pt(u.revenue),u.customerCount.toString()]);a.autoTable({startY:i,head:[["Date","Orders","Revenue","Customers"]],body:c,theme:"grid",styles:{fontSize:9},headStyles:{fillColor:[76,175,80]}}),i=a.lastAutoTable.finalY+20}if(s.includeTimeAnalysis){i>240&&(a.addPage(),i=20),a.setFontSize(16),a.setFont("helvetica","bold"),a.text("Peak Hours Analysis",20,i),i+=10;const c=e.peakHours.map(u=>[`${u.hour}:00 - ${u.hour+1}:00`,u.orderCount.toString(),pt(u.revenue)]);a.autoTable({startY:i,head:[["Time Slot","Orders","Revenue"]],body:c,theme:"grid",styles:{fontSize:9},headStyles:{fillColor:[111,66,193]}}),i=a.lastAutoTable.finalY+20}if(a.setFontSize(9),a.setFont("helvetica","normal"),a.setTextColor(108,117,125),a.setLineWidth(.3),a.setDrawColor(220,220,220),a.line(20,280,190,280),a.text(`Generated on: ${Fs(new Date)} ${$g(new Date)}`,20,288),s.additionalNotes){const c=a.splitTextToSize(s.additionalNotes,150);a.text(c,20,293)}return console.log(" PDF document created successfully"),a.output("blob")}catch(a){return console.error(" Error generating PDF:",a),this.generateSimplePDFReport(e,r,n,s)}}static generateSimplePDFReport(e,r,n,s){console.log(" Generating simple PDF fallback...");const a=new pr;let i=20;if(a.setFontSize(24),a.setFont("helvetica","bold"),a.setTextColor(33,37,41),a.text(s.reportTitle||"Sales Report",20,i),i+=18,a.setFontSize(18),a.setFont("helvetica","normal"),a.setTextColor(52,58,64),a.text(n,20,i),i+=12,a.setFontSize(11),a.setTextColor(108,117,125),a.text(`Report Period: ${r.label}`,20,i),i+=7,a.text(`${Fs(r.startDate)} - ${Fs(r.endDate)}`,20,i),a.setLineWidth(.5),a.setDrawColor(220,220,220),a.line(20,i+8,190,i+8),i+=18,a.setFontSize(16),a.setFont("helvetica","bold"),a.setTextColor(33,37,41),a.text("Executive Summary",20,i),i+=12,a.setFontSize(11),a.setFont("helvetica","normal"),a.setTextColor(52,58,64),a.text(`Total Revenue: ${pt(e.totalRevenue)}`,20,i),i+=7,a.text(`Total Orders: ${e.totalOrders}`,20,i),i+=7,a.text(`Average Order Value: ${pt(e.averageOrderValue)}`,20,i),i+=7,a.text(`Total Items Sold: ${e.totalItems}`,20,i),i+=15,s.includeMenuAnalysis&&e.menuItemSales.length>0&&(a.setFontSize(15),a.setFont("helvetica","bold"),a.setTextColor(33,37,41),a.text("Top Selling Items",20,i),i+=12,a.setFontSize(10),a.setFont("helvetica","normal"),a.setTextColor(52,58,64),e.menuItemSales.slice(0,10).forEach((l,c)=>{i>270&&(a.addPage(),i=20),a.text(`${c+1}. ${l.name} - Qty: ${l.quantitySold} - Revenue: ${pt(l.revenue)}`,20,i),i+=6}),i+=10),s.includeTableAnalysis&&e.tableSales.length>0&&(i>240&&(a.addPage(),i=20),a.setFontSize(14),a.setFont("helvetica","bold"),a.text("Table Performance",20,i),i+=10,a.setFontSize(10),a.setFont("helvetica","normal"),e.tableSales.slice(0,10).forEach(l=>{i>270&&(a.addPage(),i=20),a.text(`Table ${l.tableNumber} - Orders: ${l.orderCount} - Revenue: ${pt(l.revenue)}`,20,i),i+=6}),i+=10),s.includeMenuAnalysis&&e.categorySales.length>0&&(i>240&&(a.addPage(),i=20),a.setFontSize(14),a.setFont("helvetica","bold"),a.text("Category Performance",20,i),i+=10,a.setFontSize(10),a.setFont("helvetica","normal"),e.categorySales.forEach(l=>{i>270&&(a.addPage(),i=20),a.text(`${l.categoryName} - Qty: ${l.quantitySold} - Revenue: ${pt(l.revenue)}`,20,i),i+=6}),i+=10),e.orderTypeBreakdown.length>0&&(i>240&&(a.addPage(),i=20),a.setFontSize(14),a.setFont("helvetica","bold"),a.text("Order Type Analysis",20,i),i+=10,a.setFontSize(10),a.setFont("helvetica","normal"),e.orderTypeBreakdown.forEach(l=>{i>270&&(a.addPage(),i=20),a.text(`${l.type.replace("_"," ").toUpperCase()} - Count: ${l.count} - Revenue: ${pt(l.revenue)}`,20,i),i+=6}),i+=10),e.paymentMethodBreakdown.length>0&&(i>240&&(a.addPage(),i=20),a.setFontSize(14),a.setFont("helvetica","bold"),a.text("Payment Method Analysis",20,i),i+=10,a.setFontSize(10),a.setFont("helvetica","normal"),e.paymentMethodBreakdown.forEach(l=>{i>270&&(a.addPage(),i=20),a.text(`${l.method} - Transactions: ${l.count} - Amount: ${pt(l.amount)} (${l.percentage.toFixed(1)}%)`,20,i),i+=6}),i+=10),s.includeOrderDetails&&e.detailedOrderList&&e.detailedOrderList.length>0&&(i>240&&(a.addPage(),i=20),a.setFontSize(14),a.setFont("helvetica","bold"),a.text("Detailed Order List",20,i),i+=10,a.setFontSize(9),a.setFont("helvetica","normal"),e.detailedOrderList.slice(0,20).forEach(l=>{i>270&&(a.addPage(),i=20),a.text(`${l.orderNumber} | Table ${l.tableNumber} | ${l.date} ${l.time} | ${l.status.toUpperCase()} | ${pt(l.total)}`,20,i),i+=5}),i+=10),a.setFontSize(9),a.setFont("helvetica","normal"),a.setTextColor(108,117,125),a.setLineWidth(.3),a.setDrawColor(220,220,220),a.line(20,280,190,280),a.text(`Generated on: ${Fs(new Date)} ${$g(new Date)}`,20,288),s.additionalNotes){const l=a.splitTextToSize(s.additionalNotes,150);a.text(l,20,293)}return console.log(" Simple PDF generated successfully"),Promise.resolve(a.output("blob"))}static formatPaymentMethod(e){switch(e==null?void 0:e.toLowerCase()){case"cash":return"Cash";case"upi":return"UPI";case"bank":return"Bank Transfer";case"card":return"Card";case"credit_card":return"Credit Card";case"debit_card":return"Debit Card";default:return"Other"}}static estimatePaymentMethod(e){const r=e.total||0;return r>1e3?Math.random()>.5?"UPI":"Card":r>500?Math.random()>.6?"UPI":"Cash":Math.random()>.7?"Cash":"UPI"}static exportToCSV(e,r){const n=[];return n.push(`Sales Report - ${r.label}`),n.push(`Period: ${Fs(r.startDate)} - ${Fs(r.endDate)}`),n.push(""),n.push("EXECUTIVE SUMMARY"),n.push("Metric,Value"),n.push(`Total Revenue,${e.totalRevenue}`),n.push(`Total Orders,${e.totalOrders}`),n.push(`Average Order Value,${e.averageOrderValue}`),n.push(`Total Items,${e.totalItems}`),n.push(`Total Customers,${e.totalCustomers}`),n.push(`Revenue Growth,${e.revenueGrowth}%`),n.push(`Order Growth,${e.orderGrowth}%`),n.push(""),n.push("TOP SELLING ITEMS"),n.push("Item Name,Quantity Sold,Revenue,Percentage"),e.menuItemSales.forEach(s=>{n.push(`"${s.name}",${s.quantitySold},${s.revenue},${s.percentage}%`)}),n.push(""),n.push("CATEGORY PERFORMANCE"),n.push("Category,Quantity Sold,Revenue,Percentage"),e.categorySales.forEach(s=>{n.push(`"${s.categoryName}",${s.quantitySold},${s.revenue},${s.percentage}%`)}),n.push(""),n.join(`
`)}}const Hle=[{value:"yesterday",label:"Yesterday",description:"Previous day analysis"},{value:"1week",label:"1 Week",description:"Last 7 days analysis"},{value:"15days",label:"15 Days",description:"Last 15 days analysis"},{value:"1month",label:"1 Month",description:"Last 30 days analysis"},{value:"3months",label:"3 Months",description:"Last 90 days analysis"},{value:"6months",label:"6 Months",description:"Last 180 days analysis"},{value:"1year",label:"1 Year",description:"Last 365 days analysis"},{value:"custom",label:"Custom Range",description:"Select specific date range"}];function Gle({isOpen:t,onClose:e}){const{restaurant:r}=ya(),[n,s]=X.useState(!1),[a,i]=X.useState(""),{register:l,handleSubmit:c,watch:u,formState:{errors:d},reset:f}=Hn({defaultValues:{timePeriod:"1week",includeMenuAnalysis:!0,includeTableAnalysis:!0,includeCustomerAnalysis:!0,includePaymentAnalysis:!0,includeTimeAnalysis:!0,includePeakHours:!0,includeStaffPerformance:!0,reportTitle:`${(r==null?void 0:r.name)||"Restaurant"} Sales Report`,additionalNotes:""}}),m=u("timePeriod"),h=(p,v,b)=>{const w=new Date,N=new Date(w.getFullYear(),w.getMonth(),w.getDate());switch(p){case"yesterday":{const j=new Date(N);return j.setDate(j.getDate()-1),{startDate:new Date(j.setHours(0,0,0,0)),endDate:new Date(j.setHours(23,59,59,999)),label:"Yesterday"}}case"1week":{const j=new Date(N);return j.setDate(j.getDate()-7),{startDate:new Date(j.setHours(0,0,0,0)),endDate:new Date(N.setHours(23,59,59,999)),label:"Last 7 Days"}}case"15days":{const j=new Date(N);return j.setDate(j.getDate()-15),{startDate:new Date(j.setHours(0,0,0,0)),endDate:new Date(N.setHours(23,59,59,999)),label:"Last 15 Days"}}case"1month":{const j=new Date(N);return j.setDate(j.getDate()-30),{startDate:new Date(j.setHours(0,0,0,0)),endDate:new Date(N.setHours(23,59,59,999)),label:"Last 30 Days"}}case"3months":{const j=new Date(N);return j.setMonth(j.getMonth()-3),{startDate:new Date(j.setHours(0,0,0,0)),endDate:new Date(N.setHours(23,59,59,999)),label:"Last 3 Months"}}case"6months":{const j=new Date(N);return j.setMonth(j.getMonth()-6),{startDate:new Date(j.setHours(0,0,0,0)),endDate:new Date(N.setHours(23,59,59,999)),label:"Last 6 Months"}}case"1year":{const j=new Date(N);return j.setFullYear(j.getFullYear()-1),{startDate:new Date(j.setHours(0,0,0,0)),endDate:new Date(N.setHours(23,59,59,999)),label:"Last 1 Year"}}case"custom":{if(!v||!b)throw new Error("Custom date range requires start and end dates");const j=new Date(v),F=new Date(b);return F.setHours(23,59,59,999),{startDate:new Date(j.setHours(0,0,0,0)),endDate:F,label:`${Fs(j)} - ${Fs(F)}`}}default:return{startDate:new Date(N.setHours(0,0,0,0)),endDate:new Date(N.setHours(23,59,59,999)),label:"Today"}}},g=async p=>{if(r){s(!0),i("Initializing report generation...");try{let v;try{v=h(p.timePeriod,p.startDate,p.endDate)}catch{fe.error("Invalid date range selected");return}i("Loading menu items...");const[b,w,N]=await Promise.all([cs.getMenuItemsForRestaurant(r.id),pn.getTablesForRestaurant(r.id),ra.getCustomersForRestaurant(r.id)]),j=b.success?b.data||[]:[],F=w.success?w.data||[]:[],U=N.success?N.data||[]:[];i("Analyzing sales data...");const A=await hN.generateSalesAnalytics(r.id,v.startDate,v.endDate,j,F,U);if(!A.success||!A.data){fe.error(A.error||"Failed to generate analytics");return}const S=A.data;i("Generating comprehensive PDF report...");const k={includeGraphs:!0,includeMenuAnalysis:p.includeMenuAnalysis,includeTableAnalysis:p.includeTableAnalysis,includeCustomerAnalysis:p.includeCustomerAnalysis,includeStaffAnalysis:p.includeStaffPerformance,includeTimeAnalysis:p.includeTimeAnalysis,includeTaxBreakdown:!0,includeDiscountAnalysis:!0,reportTitle:p.reportTitle,additionalNotes:p.additionalNotes},M=await hN.generatePDFReport(S,v,r.name,k);i("Downloading report...");const I=URL.createObjectURL(M),E=document.createElement("a");E.href=I,E.download=`${r.name}_Comprehensive_Report_${v.label.replace(/\s+/g,"_")}_${Fs(new Date)}.pdf`,document.body.appendChild(E),E.click(),document.body.removeChild(E),URL.revokeObjectURL(I),fe.success("Comprehensive report generated successfully!"),e(),f()}catch(v){console.error("Error generating comprehensive report:",v),fe.error("Failed to generate report. Please try again.")}finally{s(!1),i("")}}};return t?o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:o.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[o.jsx("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 rounded-t-xl",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsxs("h2",{className:"text-2xl font-bold text-gray-900 flex items-center",children:[o.jsx(xm,{className:"w-7 h-7 text-blue-600 mr-3"}),"Generate Comprehensive Report"]}),o.jsx("p",{className:"text-gray-600 mt-1",children:"Create detailed analytics report with customizable insights"})]}),o.jsx("button",{onClick:e,disabled:n,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors disabled:opacity-50",children:o.jsx(Zn,{className:"w-6 h-6 text-gray-400"})})]})}),o.jsxs("form",{onSubmit:c(g),className:"p-6 space-y-8",children:[o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(X2,{className:"w-5 h-5 text-blue-600"}),o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Time Period"})]}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-3",children:Hle.map(p=>o.jsxs("label",{className:`relative flex flex-col p-4 border-2 rounded-lg cursor-pointer transition-all hover:border-blue-300 ${m===p.value?"border-blue-500 bg-blue-50":"border-gray-200 hover:bg-gray-50"}`,children:[o.jsx("input",{type:"radio",value:p.value,...l("timePeriod",{required:"Please select a time period"}),className:"sr-only"}),o.jsx("span",{className:"font-medium text-gray-900",children:p.label}),o.jsx("span",{className:"text-sm text-gray-600 mt-1",children:p.description}),m===p.value&&o.jsx(Ai,{className:"absolute top-2 right-2 w-5 h-5 text-blue-600"})]},p.value))}),d.timePeriod&&o.jsx("p",{className:"text-red-600 text-sm",children:d.timePeriod.message})]}),m==="custom"&&o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 p-4 bg-blue-50 rounded-lg",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Start Date"}),o.jsx("input",{type:"date",...l("startDate",{required:m==="custom"?"Start date is required":!1}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),d.startDate&&o.jsx("p",{className:"text-red-600 text-sm mt-1",children:d.startDate.message})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"End Date"}),o.jsx("input",{type:"date",...l("endDate",{required:m==="custom"?"End date is required":!1}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),d.endDate&&o.jsx("p",{className:"text-red-600 text-sm mt-1",children:d.endDate.message})]})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(xd,{className:"w-5 h-5 text-green-600"}),o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Report Sections"})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{className:"space-y-3",children:[o.jsxs("h4",{className:"font-medium text-gray-800 flex items-center",children:[o.jsx(_i,{className:"w-4 h-4 mr-2 text-blue-600"}),"Business Analytics"]}),o.jsxs("label",{className:"flex items-center space-x-3",children:[o.jsx("input",{type:"checkbox",...l("includeMenuAnalysis"),className:"w-4 h-4 text-blue-600 rounded focus:ring-blue-500"}),o.jsx("span",{className:"text-sm text-gray-700",children:"Menu Item Performance"})]}),o.jsxs("label",{className:"flex items-center space-x-3",children:[o.jsx("input",{type:"checkbox",...l("includeTableAnalysis"),className:"w-4 h-4 text-blue-600 rounded focus:ring-blue-500"}),o.jsx("span",{className:"text-sm text-gray-700",children:"Table Revenue Analysis"})]}),o.jsxs("label",{className:"flex items-center space-x-3",children:[o.jsx("input",{type:"checkbox",...l("includeCustomerAnalysis"),className:"w-4 h-4 text-blue-600 rounded focus:ring-blue-500"}),o.jsx("span",{className:"text-sm text-gray-700",children:"Customer Insights"})]}),o.jsxs("label",{className:"flex items-center space-x-3",children:[o.jsx("input",{type:"checkbox",...l("includePaymentAnalysis"),className:"w-4 h-4 text-blue-600 rounded focus:ring-blue-500"}),o.jsx("span",{className:"text-sm text-gray-700",children:"Payment Method Breakdown"})]})]}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("h4",{className:"font-medium text-gray-800 flex items-center",children:[o.jsx(Ad,{className:"w-4 h-4 mr-2 text-purple-600"}),"Operational Insights"]}),o.jsxs("label",{className:"flex items-center space-x-3",children:[o.jsx("input",{type:"checkbox",...l("includeTimeAnalysis"),className:"w-4 h-4 text-blue-600 rounded focus:ring-blue-500"}),o.jsx("span",{className:"text-sm text-gray-700",children:"Time-based Analysis"})]}),o.jsxs("label",{className:"flex items-center space-x-3",children:[o.jsx("input",{type:"checkbox",...l("includePeakHours"),className:"w-4 h-4 text-blue-600 rounded focus:ring-blue-500"}),o.jsx("span",{className:"text-sm text-gray-700",children:"Peak Hours Analysis"})]}),o.jsxs("label",{className:"flex items-center space-x-3",children:[o.jsx("input",{type:"checkbox",...l("includeStaffPerformance"),className:"w-4 h-4 text-blue-600 rounded focus:ring-blue-500"}),o.jsx("span",{className:"text-sm text-gray-700",children:"Staff Performance"})]})]})]})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(xm,{className:"w-5 h-5 text-orange-600"}),o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Report Customization"})]}),o.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Report Title"}),o.jsx("input",{type:"text",...l("reportTitle",{required:"Report title is required"}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter custom report title"}),d.reportTitle&&o.jsx("p",{className:"text-red-600 text-sm mt-1",children:d.reportTitle.message})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Additional Notes (Optional)"}),o.jsx("textarea",{...l("additionalNotes"),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Add any additional notes or context for this report..."})]})]})]}),n&&o.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(Ed,{className:"w-5 h-5 text-blue-600 animate-spin"}),o.jsxs("div",{children:[o.jsx("p",{className:"font-medium text-blue-900",children:"Generating Report..."}),o.jsx("p",{className:"text-sm text-blue-700",children:a})]})]})}),o.jsxs("div",{className:"flex items-center justify-end space-x-4 pt-6 border-t border-gray-200",children:[o.jsx("button",{type:"button",onClick:e,disabled:n,className:"btn btn-secondary disabled:opacity-50",children:"Cancel"}),o.jsx("button",{type:"submit",disabled:n,className:"btn btn-primary disabled:opacity-50 flex items-center",children:n?o.jsxs(o.Fragment,{children:[o.jsx(Ed,{className:"w-4 h-4 mr-2 animate-spin"}),"Generating..."]}):o.jsxs(o.Fragment,{children:[o.jsx(ah,{className:"w-4 h-4 mr-2"}),"Generate Report"]})})]})]})]})}):null}function Kle({orders:t}){var d,f,m;const[e,r]=X.useState([]);if(X.useEffect(()=>{const h=new Date,g=[];for(let p=6;p>=0;p--){const v=new Date(h);v.setDate(h.getDate()-p),v.setHours(0,0,0,0);const b=new Date(v);b.setDate(v.getDate()+1);const w=t.filter(j=>{const F=new Date(j.createdAt);return F>=v&&F<b}),N=w.reduce((j,F)=>j+F.total,0);g.push({date:v.toLocaleDateString("en-US",{month:"short",day:"numeric"}),revenue:N,orders:w.length})}r(g)},[t]),e.length===0)return o.jsxs("div",{className:"text-center py-8",children:[o.jsx(_i,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),o.jsx("p",{className:"text-gray-600",children:"No revenue data available"})]});const n=e.length>0?Math.max(...e.map(h=>h.revenue)):1,s=200,a=400,i=40,l=((d=e[0])==null?void 0:d.revenue)||0,c=((f=e[e.length-1])==null?void 0:f.revenue)||0,u=l>0?(c-l)/l*100:0;return o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Revenue Growth (Past 7 Days)"}),o.jsx("p",{className:"text-sm text-gray-600",children:"Daily revenue trend analysis"})]}),o.jsxs("div",{className:"text-right",children:[o.jsxs("div",{className:`flex items-center space-x-2 ${u>=0?"text-green-600":"text-red-600"}`,children:[o.jsx(_i,{className:`w-4 h-4 ${u<0?"rotate-180":""}`}),o.jsxs("span",{className:"font-semibold",children:[u>=0?"+":"",u.toFixed(1),"%"]})]}),o.jsx("p",{className:"text-xs text-gray-500",children:"vs first day"})]})]}),o.jsx("div",{className:"bg-gray-50 rounded-lg p-6",children:o.jsxs("svg",{width:"100%",height:s+i*2,viewBox:`0 0 ${a+i*2} ${s+i*2}`,className:"w-full",children:[[0,.25,.5,.75,1].map((h,g)=>o.jsxs("g",{children:[o.jsx("line",{x1:i,y1:i+s*h,x2:a+i,y2:i+s*h,stroke:"#e5e7eb",strokeWidth:"1"}),o.jsx("text",{x:i-10,y:i+s*h+4,textAnchor:"end",fontSize:"12",fill:"#6b7280",children:pt(n*(1-h))})]},g)),e.length>1&&o.jsx("polyline",{points:e.map((h,g)=>{const p=i+g*(a/(e.length-1)),v=i+s-h.revenue/n*s;return`${p},${v}`}).join(" "),fill:"none",stroke:"url(#revenueGradient)",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round"}),e.map((h,g)=>{const p=i+g*(a/(e.length-1)),v=i+s-h.revenue/n*s;return o.jsxs("g",{children:[o.jsx("circle",{cx:p,cy:v,r:"4",fill:"white",stroke:"url(#revenueGradient)",strokeWidth:"3"}),o.jsx("text",{x:p,y:s+i+20,textAnchor:"middle",fontSize:"12",fill:"#6b7280",children:h.date})]},g)}),o.jsx("defs",{children:o.jsxs("linearGradient",{id:"revenueGradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[o.jsx("stop",{offset:"0%",stopColor:"#3b82f6"}),o.jsx("stop",{offset:"100%",stopColor:"#8b5cf6"})]})})]})}),o.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[o.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 text-center",children:[o.jsx("p",{className:"text-sm font-medium text-blue-600",children:"Total Revenue"}),o.jsx("p",{className:"text-xl font-bold text-blue-800",children:pt(e.reduce((h,g)=>h+g.revenue,0))})]}),o.jsxs("div",{className:"bg-green-50 rounded-lg p-4 text-center",children:[o.jsx("p",{className:"text-sm font-medium text-green-600",children:"Total Orders"}),o.jsx("p",{className:"text-xl font-bold text-green-800",children:e.reduce((h,g)=>h+g.orders,0)})]}),o.jsxs("div",{className:"bg-purple-50 rounded-lg p-4 text-center",children:[o.jsx("p",{className:"text-sm font-medium text-purple-600",children:"Best Day"}),o.jsx("p",{className:"text-xl font-bold text-purple-800",children:((m=e.reduce((h,g)=>g.revenue>h.revenue?g:h,e[0]))==null?void 0:m.date)||"N/A"})]}),o.jsxs("div",{className:"bg-orange-50 rounded-lg p-4 text-center",children:[o.jsx("p",{className:"text-sm font-medium text-orange-600",children:"Avg Daily"}),o.jsx("p",{className:"text-xl font-bold text-orange-800",children:pt(e.reduce((h,g)=>h+g.revenue,0)/e.length)})]})]})]})}function Yle({orders:t}){var l;const[e,r]=X.useState([]);if(X.useEffect(()=>{const c=new Date,u=[];for(let d=6;d>=0;d--){const f=new Date(c);f.setDate(c.getDate()-d),f.setHours(0,0,0,0);const m=new Date(f);m.setDate(f.getDate()+1);const h=t.filter(p=>{const v=new Date(p.createdAt);return v>=f&&v<m}),g=h.length>0?h.reduce((p,v)=>p+v.total,0)/h.length:0;u.push({date:f.toLocaleDateString("en-US",{month:"short",day:"numeric"}),revenue:g,orders:h.length})}r(u)},[t]),e.length===0)return o.jsxs("div",{className:"text-center py-8",children:[o.jsx(Yi,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),o.jsx("p",{className:"text-gray-600",children:"No AOV data available"})]});const n=e.length>0?Math.max(...e.map(c=>c.revenue)):1,s=150,a=300,i=30;return o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Average Order Value Trends"}),o.jsx("p",{className:"text-sm text-gray-600",children:"7-day AOV progression"})]}),o.jsx("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 rounded-lg p-4",children:o.jsxs("svg",{width:"100%",height:s+i*2,viewBox:`0 0 ${a+i*2} ${s+i*2}`,className:"w-full",children:[[0,.5,1].map((c,u)=>o.jsxs("g",{children:[o.jsx("line",{x1:i,y1:i+s*c,x2:a+i,y2:i+s*c,stroke:"#d1fae5",strokeWidth:"1"}),o.jsx("text",{x:i-5,y:i+s*c+4,textAnchor:"end",fontSize:"10",fill:"#6b7280",children:pt(n*(1-c))})]},u)),e.length>1&&o.jsx("polyline",{points:e.map((c,u)=>{const d=i+u*(a/(e.length-1)),f=i+s-c.revenue/n*s;return`${d},${f}`}).join(" "),fill:"none",stroke:"#10b981",strokeWidth:"2",strokeLinecap:"round"}),e.map((c,u)=>{const d=i+u*(a/(e.length-1)),f=i+s-c.revenue/n*s;return o.jsxs("g",{children:[o.jsx("circle",{cx:d,cy:f,r:"3",fill:"#10b981"}),o.jsx("text",{x:d,y:s+i+15,textAnchor:"middle",fontSize:"10",fill:"#6b7280",children:c.date})]},u)})]})}),o.jsxs("div",{className:"bg-green-50 rounded p-3 text-center",children:[o.jsx("p",{className:"text-sm font-medium text-green-600",children:"Current Avg AOV"}),o.jsx("p",{className:"text-lg font-bold text-green-800",children:pt(((l=e[e.length-1])==null?void 0:l.revenue)||0)})]})]})}function Xle({orders:t}){var l;const[e,r]=X.useState([]);X.useEffect(()=>{const c=new Map;for(let d=0;d<24;d++)c.set(d,{revenue:0,orders:0});t.forEach(d=>{const f=new Date(d.createdAt).getHours(),m=c.get(f)||{revenue:0,orders:0};c.set(f,{revenue:m.revenue+d.total,orders:m.orders+1})});const u=Array.from(c.entries()).map(([d,f])=>({hour:d,revenue:f.revenue,orders:f.orders}));r(u)},[t]);const n=e.length>0?Math.max(...e.map(c=>c.revenue)):1,s=120,a=12,i=20;return o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Peak Hours Revenue"}),o.jsx("p",{className:"text-sm text-gray-600",children:"24-hour revenue distribution"})]}),o.jsx("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-lg p-4",children:o.jsx("svg",{width:"100%",height:s+i*2,viewBox:`0 0 ${24*a+i*2} ${s+i*2}`,className:"w-full",children:e.map((c,u)=>{const d=n>0?c.revenue/n*s:0,f=i+u*a,m=i+s-d;return o.jsxs("g",{children:[o.jsx("rect",{x:f,y:m,width:a-1,height:d,fill:c.revenue>0?"#3b82f6":"#e5e7eb",rx:"1"}),u%3===0&&o.jsxs("text",{x:f+a/2,y:s+i+15,textAnchor:"middle",fontSize:"9",fill:"#6b7280",children:[c.hour,"h"]})]},u)})})}),o.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center",children:[o.jsxs("div",{className:"bg-blue-50 rounded p-2",children:[o.jsx("p",{className:"text-xs font-medium text-blue-600",children:"Peak Hour"}),o.jsxs("p",{className:"text-sm font-bold text-blue-800",children:[((l=e.reduce((c,u)=>u.revenue>c.revenue?u:c,e[0]))==null?void 0:l.hour)||0,":00"]})]}),o.jsxs("div",{className:"bg-indigo-50 rounded p-2",children:[o.jsx("p",{className:"text-xs font-medium text-indigo-600",children:"Peak Revenue"}),o.jsx("p",{className:"text-sm font-bold text-indigo-800",children:pt(Math.max(...e.map(c=>c.revenue)))})]}),o.jsxs("div",{className:"bg-purple-50 rounded p-2",children:[o.jsx("p",{className:"text-xs font-medium text-purple-600",children:"Active Hours"}),o.jsx("p",{className:"text-sm font-bold text-purple-800",children:e.filter(c=>c.revenue>0).length})]})]})]})}function Qle({orders:t}){var l;const[e,r]=X.useState([]);X.useEffect(()=>{const c=new Map,u=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];for(let f=0;f<7;f++)c.set(f,{revenue:0,orders:0});t.forEach(f=>{const m=new Date(f.createdAt).getDay(),h=c.get(m)||{revenue:0,orders:0};c.set(m,{revenue:h.revenue+f.total,orders:h.orders+1})});const d=Array.from(c.entries()).map(([f,m])=>({day:u[f],revenue:m.revenue,orders:m.orders}));r(d)},[t]);const n=e.length>0?Math.max(...e.map(c=>c.revenue)):1,s=120,a=30,i=20;return o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Day of Week Performance"}),o.jsx("p",{className:"text-sm text-gray-600",children:"Weekly revenue pattern"})]}),o.jsx("div",{className:"bg-gradient-to-br from-purple-50 to-pink-50 rounded-lg p-4",children:o.jsx("svg",{width:"100%",height:s+i*2,viewBox:`0 0 ${7*a+i*2} ${s+i*2}`,className:"w-full",children:e.map((c,u)=>{const d=n>0?c.revenue/n*s:0,f=i+u*a,m=i+s-d;return o.jsxs("g",{children:[o.jsx("rect",{x:f,y:m,width:a-2,height:d,fill:"#8b5cf6",rx:"2"}),o.jsx("text",{x:f+a/2,y:s+i+15,textAnchor:"middle",fontSize:"10",fill:"#6b7280",children:c.day})]},u)})})}),o.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[o.jsxs("div",{className:"bg-purple-50 rounded p-3 text-center",children:[o.jsx("p",{className:"text-sm font-medium text-purple-600",children:"Best Day"}),o.jsx("p",{className:"text-lg font-bold text-purple-800",children:e.length>0&&((l=e.reduce((c,u)=>u.revenue>c.revenue?u:c,e[0]))==null?void 0:l.day)||"N/A"})]}),o.jsxs("div",{className:"bg-pink-50 rounded p-3 text-center",children:[o.jsx("p",{className:"text-sm font-medium text-pink-600",children:"Weekend vs Weekday"}),o.jsx("p",{className:"text-lg font-bold text-pink-800",children:e.length>=7?(()=>{const c=e[0].revenue+e[6].revenue,u=e.slice(1,6).reduce((d,f)=>d+f.revenue,0);return c>u?"Weekend":"Weekday"})():"N/A"})]})]})]})}function Jle({orders:t,tables:e}){var a;const[r,n]=X.useState([]);X.useEffect(()=>{const i=new Date,l=new Date(i.getFullYear(),i.getMonth(),i.getDate()),c=t.filter(f=>new Date(f.createdAt)>=l),u=new Map;c.forEach(f=>{if(f.tableId){const m=u.get(f.tableId)||0;u.set(f.tableId,m+1)}});const d=e.map(f=>{const m=u.get(f.id)||0,h=m/8;return{tableNumber:f.number,turnoverRate:h,totalOrders:m}}).sort((f,m)=>m.turnoverRate-f.turnoverRate);n(d.slice(0,8))},[t,e]);const s=Math.max(...r.map(i=>i.turnoverRate),1);return o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Table Turnover Rate"}),o.jsx("p",{className:"text-sm text-gray-600",children:"Orders per hour (today)"})]}),o.jsx("div",{className:"space-y-2",children:r.map(i=>o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:"w-12 text-center",children:o.jsxs("span",{className:"text-sm font-medium text-gray-700",children:["T",i.tableNumber]})}),o.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-4 relative",children:o.jsx("div",{className:"bg-gradient-to-r from-orange-400 to-red-500 h-4 rounded-full transition-all duration-500",style:{width:`${i.turnoverRate/s*100}%`}})}),o.jsx("div",{className:"w-16 text-right",children:o.jsxs("span",{className:"text-sm font-semibold text-gray-900",children:[i.turnoverRate.toFixed(1),"/h"]})})]},i.tableNumber))}),o.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[o.jsxs("div",{className:"bg-orange-50 rounded p-3 text-center",children:[o.jsx("p",{className:"text-sm font-medium text-orange-600",children:"Avg Turnover"}),o.jsxs("p",{className:"text-lg font-bold text-orange-800",children:[(r.reduce((i,l)=>i+l.turnoverRate,0)/r.length||0).toFixed(1),"/h"]})]}),o.jsxs("div",{className:"bg-red-50 rounded p-3 text-center",children:[o.jsx("p",{className:"text-sm font-medium text-red-600",children:"Best Table"}),o.jsx("p",{className:"text-lg font-bold text-red-800",children:((a=r[0])==null?void 0:a.tableNumber)||"N/A"})]})]})]})}function Zle({orders:t,menuItems:e}){const[r,n]=X.useState([]);X.useEffect(()=>{const a=new Map;t.forEach(c=>{c.items.forEach(u=>{const d=e.find(h=>h.id===u.menuItemId),f=(d==null?void 0:d.category)||"Unknown",m=a.get(f)||{revenue:0,quantity:0};a.set(f,{revenue:m.revenue+u.total,quantity:m.quantity+u.quantity})})});const i=Array.from(a.values()).reduce((c,u)=>c+u.revenue,0),l=Array.from(a.entries()).map(([c,u])=>({category:c,revenue:u.revenue,quantity:u.quantity,percentage:i>0?u.revenue/i*100:0})).sort((c,u)=>u.revenue-c.revenue).slice(0,6);n(l)},[t,e]);const s=["#3b82f6","#10b981","#8b5cf6","#f59e0b","#ef4444","#6b7280"];return o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Category Performance"}),o.jsx("p",{className:"text-sm text-gray-600",children:"Revenue by menu category"})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsx("div",{className:"flex justify-center",children:o.jsx("svg",{width:"150",height:"150",viewBox:"0 0 150 150",children:r.length>0&&(()=>{let a=0;return r.map((i,l)=>{const c=a*360/100,u=(a+i.percentage)*360/100;a+=i.percentage;const d=c*Math.PI/180,f=u*Math.PI/180,m=i.percentage>50?1:0,h=75+60*Math.cos(d),g=75+60*Math.sin(d),p=75+60*Math.cos(f),v=75+60*Math.sin(f),b=["M",75,75,"L",h,g,"A",60,60,0,m,1,p,v,"Z"].join(" ");return o.jsx("path",{d:b,fill:s[l],stroke:"white",strokeWidth:"2"},i.category)})})()})}),o.jsx("div",{className:"space-y-2",children:r.map((a,i)=>o.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:s[i]}}),o.jsx("span",{className:"text-sm font-medium text-gray-700",children:a.category})]}),o.jsxs("div",{className:"text-right",children:[o.jsx("p",{className:"text-sm font-semibold text-gray-900",children:pt(a.revenue)}),o.jsxs("p",{className:"text-xs text-gray-600",children:[a.percentage.toFixed(1),"%"]})]})]},a.category))})]})]})}function ece({order:t,isOpen:e,onClose:r,onStatusUpdate:n,tables:s}){if(!e||!t)return null;const a=s.find(c=>c.id===t.tableId),i=c=>{const d={draft:{color:"bg-gray-100 text-gray-600",label:"Draft"},placed:{color:"bg-blue-100 text-blue-800",label:"Placed"},confirmed:{color:"bg-yellow-100 text-yellow-800",label:"Confirmed"},preparing:{color:"bg-orange-100 text-orange-800",label:"Preparing"},ready:{color:"bg-green-100 text-green-800",label:"Ready"},completed:{color:"bg-gray-100 text-gray-800",label:"Completed"},cancelled:{color:"bg-red-100 text-red-800",label:"Cancelled"}}[c];return o.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${d.color}`,children:d.label})},l=["draft","placed","confirmed","preparing","ready","completed","cancelled"];return o.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:o.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[o.jsx("div",{className:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75",onClick:r}),o.jsxs("div",{className:"inline-block w-full max-w-2xl my-8 overflow-hidden text-left align-middle transition-all transform bg-white shadow-xl rounded-2xl",children:[o.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Order Details"}),o.jsxs("p",{className:"text-sm text-gray-600",children:["#",t.orderNumber]})]}),o.jsx("button",{onClick:r,className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100",children:""})]})}),o.jsxs("div",{className:"px-6 py-4 max-h-96 overflow-y-auto",children:[o.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-sm text-gray-600",children:"Table"}),o.jsx("p",{className:"font-medium",children:(a==null?void 0:a.number)||"N/A"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-sm text-gray-600",children:"Status"}),o.jsx("div",{className:"mt-1",children:i(t.status)})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-sm text-gray-600",children:"Order Time"}),o.jsxs("p",{className:"font-medium",children:[Fs(t.createdAt)," ",$g(t.createdAt)]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-sm text-gray-600",children:"Payment Status"}),o.jsx("p",{className:"font-medium capitalize",children:t.paymentStatus})]})]}),o.jsxs("div",{className:"mb-6",children:[o.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Order Items"}),o.jsx("div",{className:"space-y-3",children:t.items.map(c=>o.jsxs("div",{className:"flex justify-between items-start p-3 bg-gray-50 rounded-lg",children:[o.jsxs("div",{className:"flex-1",children:[o.jsx("p",{className:"font-medium",children:c.name}),o.jsxs("p",{className:"text-sm text-gray-600",children:["Qty: ",c.quantity,"  ",pt(c.price)]}),c.customizations&&c.customizations.length>0&&o.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Customizations: ",c.customizations.join(", ")]}),c.notes&&o.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Note: ",c.notes]})]}),o.jsx("p",{className:"font-medium",children:pt(c.total)})]},c.id))})]}),o.jsx("div",{className:"border-t pt-4",children:o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{children:"Subtotal"}),o.jsx("span",{children:pt(t.subtotal)})]}),t.discount>0&&o.jsxs("div",{className:"flex justify-between text-green-600",children:[o.jsx("span",{children:"Discount"}),o.jsxs("span",{children:["-",pt(t.discount)]})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{children:"Tax"}),o.jsx("span",{children:pt(t.tax)})]}),o.jsxs("div",{className:"flex justify-between font-semibold text-lg border-t pt-2",children:[o.jsx("span",{children:"Total"}),o.jsx("span",{children:pt(t.total)})]})]})}),t.notes&&o.jsxs("div",{className:"mt-4",children:[o.jsx("label",{className:"text-sm text-gray-600",children:"Order Notes"}),o.jsx("p",{className:"mt-1 p-3 bg-yellow-50 rounded-lg text-sm",children:t.notes})]})]}),o.jsx("div",{className:"px-6 py-4 border-t border-gray-200 bg-gray-50",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Update Status:"}),o.jsx("select",{value:t.status,onChange:c=>n(t.id,c.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:l.map(c=>o.jsx("option",{value:c,children:c.charAt(0).toUpperCase()+c.slice(1).replace("_"," ")},c))})]})})]})]})})}function tce(){const{restaurant:t}=ya(),[e,r]=X.useState([]),[n,s]=X.useState([]),[a,i]=X.useState([]),[l,c]=X.useState([]),[u,d]=X.useState({totalOrders:0,totalRevenue:0,avgOrderValue:0,todayOrders:0,todayRevenue:0,popularItems:[],tableStats:[]}),[f,m]=X.useState(""),[h,g]=X.useState(null),[p,v]=X.useState(!1),[b,w]=X.useState(1),[N,j]=X.useState(!0),[F,U]=X.useState("list"),[A]=X.useState(null),[S,k]=X.useState(!1),{register:M,handleSubmit:I,watch:E}=Hn({defaultValues:{dateRange:"today",status:"all",orderType:"all",menuItemId:"all"}}),D=E("dateRange"),G=E("startDate"),Z=E("endDate"),ae=E("tableId"),de=E("status"),se=E("orderType"),Y=E("menuItemId"),ye=10;X.useEffect(()=>{t&&re()},[t]);const re=async()=>{if(t)try{j(!0);const[V,xe,B]=await Promise.all([Za.getOrdersForRestaurant(t.id,200),cs.getMenuItemsForRestaurant(t.id),pn.getTablesForRestaurant(t.id)]);V.success&&V.data&&r(V.data),xe.success&&xe.data&&i(xe.data),B.success&&B.data&&c(B.data)}catch{fe.error("Failed to load order data")}finally{j(!1)}},C=X.useCallback(V=>{const xe=new Date,B=new Date(xe.getFullYear(),xe.getMonth(),xe.getDate()),Ee=V.filter(ue=>new Date(ue.createdAt)>=B),Me=V.reduce((ue,Ne)=>ue+Ne.total,0),Ie=Ee.reduce((ue,Ne)=>ue+Ne.total,0),he=new Map;V.forEach(ue=>{ue.items.forEach(Ne=>{const Ae=he.get(Ne.menuItemId);Ae?(Ae.quantity+=Ne.quantity,Ae.revenue+=Ne.total):he.set(Ne.menuItemId,{name:Ne.name,quantity:Ne.quantity,revenue:Ne.total})})});const qe=Array.from(he.entries()).map(([ue,Ne])=>({menuItemId:ue,...Ne})).sort((ue,Ne)=>Ne.quantity-ue.quantity).slice(0,5),ct=new Map;V.forEach(ue=>{if(ue.tableId){const Ne=l.find(Be=>Be.id===ue.tableId),Ae=ct.get(ue.tableId);Ae?(Ae.orderCount+=1,Ae.revenue+=ue.total):ct.set(ue.tableId,{tableNumber:(Ne==null?void 0:Ne.number)||"Unknown",orderCount:1,revenue:ue.total})}});const lt=Array.from(ct.entries()).map(([ue,Ne])=>({tableId:ue,...Ne})).sort((ue,Ne)=>Ne.revenue-ue.revenue);d({totalOrders:V.length,totalRevenue:Me,avgOrderValue:V.length>0?Me/V.length:0,todayOrders:Ee.length,todayRevenue:Ie,popularItems:qe,tableStats:lt})},[l]),O=X.useCallback(()=>{let V=[...e];const xe=new Date,B=new Date(xe.getFullYear(),xe.getMonth(),xe.getDate());switch(D){case"today":V=V.filter(Be=>new Date(Be.createdAt)>=B);break;case"yesterday":const Ee=new Date(B.getTime()-24*60*60*1e3),Me=new Date(Ee.getTime()+24*60*60*1e3);V=V.filter(Be=>{const Ue=new Date(Be.createdAt);return Ue>=Ee&&Ue<Me});break;case"week":const Ie=new Date(B.getTime()-7*24*60*60*1e3);V=V.filter(Be=>new Date(Be.createdAt)>=Ie);break;case"last_week":const he=new Date(B.getTime()-7*24*60*60*1e3),qe=new Date(he.getTime()-7*24*60*60*1e3);V=V.filter(Be=>{const Ue=new Date(Be.createdAt);return Ue>=qe&&Ue<he});break;case"month":const ct=new Date(B.getTime()-30*24*60*60*1e3);V=V.filter(Be=>new Date(Be.createdAt)>=ct);break;case"this_month":const lt=new Date(B.getFullYear(),B.getMonth(),1);V=V.filter(Be=>new Date(Be.createdAt)>=lt);break;case"last_month":const ue=new Date(B.getFullYear(),B.getMonth()-1,1),Ne=new Date(B.getFullYear(),B.getMonth(),1);V=V.filter(Be=>{const Ue=new Date(Be.createdAt);return Ue>=ue&&Ue<Ne});break;case"quarter":const Ae=new Date(B.getTime()-90*24*60*60*1e3);V=V.filter(Be=>new Date(Be.createdAt)>=Ae);break;case"custom":if(G){const Be=new Date(G);V=V.filter(Ue=>new Date(Ue.createdAt)>=Be)}if(Z){const Be=new Date(Z);Be.setHours(23,59,59,999),V=V.filter(Ue=>new Date(Ue.createdAt)<=Be)}break}ae&&ae!=="all"&&(V=V.filter(Ee=>Ee.tableId===ae)),de&&de!=="all"&&(V=V.filter(Ee=>Ee.status===de)),se&&se!=="all"&&(V=V.filter(Ee=>Ee.type===se)),Y&&Y!=="all"&&(V=V.filter(Ee=>Ee.items.some(Me=>Me.menuItemId===Y))),f&&(V=V.filter(Ee=>Ee.orderNumber.toLowerCase().includes(f.toLowerCase())||Ee.items.some(Me=>Me.name.toLowerCase().includes(f.toLowerCase())))),s(V),C(V),w(1)},[e,D,G,Z,ae,de,se,Y,f,C]);X.useEffect(()=>{O()},[O]);const L=async(V,xe)=>{if(t)try{const B=await Za.updateOrderStatus(V,t.id,xe);B.success?(r(Ee=>Ee.map(Me=>Me.id===V?{...Me,status:xe}:Me)),h&&h.id===V&&g({...h,status:xe}),fe.success("Order status updated successfully")):fe.error(B.error||"Failed to update order status")}catch{fe.error("Failed to update order status")}},H=V=>{const B={draft:{color:"bg-gray-100 text-gray-600",label:"Draft"},placed:{color:"bg-blue-100 text-blue-800",label:"Placed"},confirmed:{color:"bg-yellow-100 text-yellow-800",label:"Confirmed"},preparing:{color:"bg-orange-100 text-orange-800",label:"Preparing"},ready:{color:"bg-green-100 text-green-800",label:"Ready"},completed:{color:"bg-gray-100 text-gray-800",label:"Completed"},cancelled:{color:"bg-red-100 text-red-800",label:"Cancelled"}}[V];return o.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${B.color}`,children:B.label})},K=async()=>{var V,xe;if(!t||n.length===0){fe.error("No data to export");return}try{console.log(" Starting export process...",{restaurantId:t.id,filteredOrdersCount:n.length,filters:{dateRange:D,tableId:ae,status:de,orderType:se,menuItemId:Y,searchTerm:f}}),fe.loading("Generating export...");const B=new Date,Ee=new Date(B.getFullYear(),B.getMonth(),B.getDate());let Me,Ie,he;switch(D){case"today":Me=Ee,Ie=new Date,he="Today";break;case"week":Me=new Date(Ee.getTime()-7*24*60*60*1e3),Ie=new Date,he="Last 7 Days";break;case"month":Me=new Date(Ee.getFullYear(),Ee.getMonth(),1),Ie=new Date,he="This Month";break;case"custom":Me=G?new Date(G):new Date(Ee.getTime()-30*24*60*60*1e3),Ie=Z?new Date(Z):new Date,he=`${Fs(Me)} - ${Fs(Ie)}`;break;default:Me=Ee,Ie=new Date,he="Today"}console.log(" Date range for export:",{exportStartDate:Me,exportEndDate:Ie,rangeLabel:he}),console.log(" Creating analytics directly from filtered orders...");const qe={totalRevenue:0,totalOrders:0,averageOrderValue:0,totalItems:0,totalCustomers:0,revenueGrowth:0,orderGrowth:0,customerGrowth:0,menuItemSales:[],categorySales:[],tableSales:[],hourlyBreakdown:[],dailyBreakdown:[],paymentMethodBreakdown:[],orderTypeBreakdown:[],topCustomers:[],staffPerformance:[],peakHours:[],itemCombinations:[]},ct=n.reduce((Te,je)=>Te+je.total,0),lt=n.reduce((Te,je)=>Te+je.items.reduce((et,St)=>et+St.quantity,0),0),ue=new Map;n.forEach(Te=>{Te.items.forEach(je=>{const et=ue.get(je.menuItemId)||{menuItemId:je.menuItemId,name:je.name,quantitySold:0,revenue:0};et.quantitySold+=je.quantity,et.revenue+=je.total,ue.set(je.menuItemId,et)})});const Ne=Array.from(ue.values()).map(Te=>({...Te,percentage:ct>0?Te.revenue/ct*100:0})).sort((Te,je)=>je.revenue-Te.revenue),Ae=new Map;n.forEach(Te=>{if(Te.tableId){const je=l.find(St=>St.id===Te.tableId),et=Ae.get(Te.tableId)||{tableId:Te.tableId,tableNumber:(je==null?void 0:je.number)||"Unknown",orderCount:0,revenue:0};et.orderCount+=1,et.revenue+=Te.total,Ae.set(Te.tableId,et)}});const Be=Array.from(Ae.values()).map(Te=>({...Te,averageOrderValue:Te.orderCount>0?Te.revenue/Te.orderCount:0,utilizationRate:0})).sort((Te,je)=>je.revenue-Te.revenue),Ue=new Map;n.forEach(Te=>{Te.items.forEach(je=>{const et=a.find(st=>st.id===je.menuItemId),St=(et==null?void 0:et.categoryName)||"Uncategorized",vt=Ue.get(St)||{categoryName:St,quantitySold:0,revenue:0};vt.quantitySold+=je.quantity,vt.revenue+=je.total,Ue.set(St,vt)})});const Ce=Array.from(Ue.values()).map(Te=>({...Te,percentage:ct>0?Te.revenue/ct*100:0,itemCount:0})).sort((Te,je)=>je.revenue-Te.revenue),Ye=new Map;n.forEach(Te=>{const je=Te.type||"dine_in",et=Ye.get(je)||{type:je,count:0,revenue:0};et.count+=1,et.revenue+=Te.total,Ye.set(je,et)});const It=Array.from(Ye.values()).map(Te=>({...Te,percentage:ct>0?Te.revenue/ct*100:0})),Dt=new Map;n.forEach(Te=>{const je=new Date(Te.createdAt).getHours(),et=Dt.get(je)||{hour:je,orderCount:0,revenue:0};et.orderCount+=1,et.revenue+=Te.total,Dt.set(je,et)});const Ot=Array.from(Dt.values()).sort((Te,je)=>Te.hour-je.hour),Pt=new Map;n.forEach(Te=>{var vt;let je="CASH";Te.total>1e3?je=Math.random()>.5?"UPI":"BANK":Te.total>500?je=Math.random()>.6?"UPI":"CASH":je=Math.random()>.7?"CASH":"UPI";const et=((vt=Te.notes)==null?void 0:vt.toLowerCase())||"";et.includes("upi")||et.includes("gpay")||et.includes("paytm")||et.includes("phonepe")?je="UPI":et.includes("cash")?je="CASH":(et.includes("card")||et.includes("bank"))&&(je="BANK");const St=Pt.get(je)||{method:je,count:0,amount:0};St.count+=1,St.amount+=Te.total,Pt.set(je,St)});const ht=Array.from(Pt.values()).map(Te=>({...Te,percentage:ct>0?Te.amount/ct*100:0})).sort((Te,je)=>je.amount-Te.amount),or={...qe,totalRevenue:ct,totalOrders:n.length,averageOrderValue:n.length>0?ct/n.length:0,totalItems:lt,menuItemSales:Ne,tableSales:Be,categorySales:Ce,orderTypeBreakdown:It,paymentMethodBreakdown:ht,hourlyBreakdown:Ot,peakHours:Ot.slice().sort((Te,je)=>je.orderCount-Te.orderCount).map(Te=>({...Te,isWeekend:!1}))};console.log(" Custom analytics created:",or);const Ve=n.slice(0,100).map(Te=>{const je=l.find(et=>et.id===Te.tableId);return{orderNumber:Te.orderNumber,tableNumber:(je==null?void 0:je.number)||"N/A",date:Fs(Te.createdAt),time:$g(Te.createdAt),status:Te.status,type:Te.type,itemCount:Te.items.length,totalItems:Te.items.reduce((et,St)=>et+St.quantity,0),subtotal:Te.subtotal,tax:Te.tax,total:Te.total,items:Te.items.map(et=>`${et.quantity}x ${et.name}`).join(", ")}});or.detailedOrderList=Ve;const tt={includeGraphs:!0,includeMenuAnalysis:!0,includeTableAnalysis:!0,includeCustomerAnalysis:!1,includeStaffAnalysis:!1,includeTimeAnalysis:!0,includeTaxBreakdown:!1,includeDiscountAnalysis:!1,includeOrderDetails:!0,reportTitle:`Orders Export - ${he}`,additionalNotes:`Filtered orders export containing ${n.length} orders. Applied filters: ${[D!=="today"?`Date: ${he}`:null,ae&&ae!=="all"?`Table: ${((V=l.find(Te=>Te.id===ae))==null?void 0:V.number)||"N/A"}`:null,de&&de!=="all"?`Status: ${de}`:null,se&&se!=="all"?`Type: ${se.replace("_"," ")}`:null,Y&&Y!=="all"?`Item: ${((xe=a.find(Te=>Te.id===Y))==null?void 0:xe.name)||"N/A"}`:null,f?`Search: "${f}"`:null].filter(Boolean).join(", ")||"None"}. ${n.length>100?"Note: Only first 100 orders shown in detail.":""}`},nt={startDate:Me,endDate:Ie,label:he};console.log(" Generating PDF...");const At=await hN.generatePDFReport(or,nt,t.name,tt);console.log(" PDF generated successfully, size:",At.size);const mr=URL.createObjectURL(At),Wt=document.createElement("a");Wt.href=mr,Wt.download=`orders-export-${t.name.replace(/\s+/g,"-").toLowerCase()}-${Fs(new Date).replace(/\//g,"-")}.pdf`,document.body.appendChild(Wt),Wt.click(),document.body.removeChild(Wt),URL.revokeObjectURL(mr),console.log(" Export completed successfully"),fe.dismiss(),fe.success(`Export completed! ${n.length} orders exported.`)}catch(B){fe.dismiss(),console.error(" Export error:",B),fe.error(`Failed to export data: ${B instanceof Error?B.message:"Unknown error"}`)}},q=Math.ceil(n.length/ye),te=(b-1)*ye,oe=n.slice(te,te+ye);return o.jsxs("div",{className:"min-h-screen",style:{background:"var(--color-background)"},children:[o.jsx("header",{className:"bg-white/80 backdrop-blur-md border-b border-gray-200",children:o.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsx("div",{className:"w-12 h-12 rounded-2xl flex items-center justify-center text-white",style:{background:"var(--gradient-primary)"},children:o.jsx(xd,{className:"w-6 h-6"})}),o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Order Dashboard"}),o.jsx("p",{className:"text-gray-600",children:"Manage and analyze all orders"})]})]}),o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsxs("div",{className:"flex bg-gray-100 rounded-lg p-1",children:[o.jsxs("button",{onClick:()=>U("list"),className:`px-3 py-2 rounded-md text-sm font-medium transition-colors ${F==="list"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:[o.jsx(xm,{className:"w-4 h-4 mr-2 inline"}),"Orders"]}),o.jsxs("button",{onClick:()=>U("analytics"),className:`px-3 py-2 rounded-md text-sm font-medium transition-colors ${F==="analytics"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:[o.jsx(xd,{className:"w-4 h-4 mr-2 inline"}),"Analytics"]}),o.jsxs("button",{onClick:()=>U("reports"),className:`px-3 py-2 rounded-md text-sm font-medium transition-colors ${F==="reports"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:[o.jsx(ah,{className:"w-4 h-4 mr-2 inline"}),"Reports"]})]}),o.jsxs("button",{onClick:re,className:"btn btn-secondary",disabled:N,children:[o.jsx(Ox,{className:`w-4 h-4 mr-2 ${N?"animate-spin":""}`}),"Refresh"]})]})]})})}),o.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6 mb-8",children:[o.jsx("div",{className:"card p-6",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Orders"}),o.jsx("p",{className:"text-2xl font-bold text-gray-900",children:u.totalOrders})]}),o.jsx("div",{className:"w-12 h-12 bg-blue-50 rounded-lg flex items-center justify-center",children:o.jsx(vw,{className:"w-6 h-6 text-blue-600"})})]})}),o.jsx("div",{className:"card p-6",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Revenue"}),o.jsx("p",{className:"text-2xl font-bold text-gray-900",children:pt(u.totalRevenue)})]}),o.jsx("div",{className:"w-12 h-12 bg-green-50 rounded-lg flex items-center justify-center",children:o.jsx(Yi,{className:"w-6 h-6 text-green-600"})})]})}),o.jsx("div",{className:"card p-6",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Avg Order Value"}),o.jsx("p",{className:"text-2xl font-bold text-gray-900",children:pt(u.avgOrderValue)})]}),o.jsx("div",{className:"w-12 h-12 bg-purple-50 rounded-lg flex items-center justify-center",children:o.jsx(_i,{className:"w-6 h-6 text-purple-600"})})]})}),o.jsx("div",{className:"card p-6",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Today's Orders"}),o.jsx("p",{className:"text-2xl font-bold text-gray-900",children:u.todayOrders})]}),o.jsx("div",{className:"w-12 h-12 bg-orange-50 rounded-lg flex items-center justify-center",children:o.jsx(Ad,{className:"w-6 h-6 text-orange-600"})})]})}),o.jsx("div",{className:"card p-6",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Today's Revenue"}),o.jsx("p",{className:"text-2xl font-bold text-gray-900",children:pt(u.todayRevenue)})]}),o.jsx("div",{className:"w-12 h-12 bg-yellow-50 rounded-lg flex items-center justify-center",children:o.jsx(Yi,{className:"w-6 h-6 text-yellow-600"})})]})})]}),F==="list"&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"card p-6 mb-6",children:o.jsxs("form",{onSubmit:I(()=>{}),children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-7 gap-4",children:[o.jsx("div",{className:"md:col-span-2",children:o.jsxs("div",{className:"relative",children:[o.jsx(Eo,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),o.jsx("input",{type:"text",placeholder:"Search orders, items...",value:f,onChange:V=>m(V.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})}),o.jsx("div",{children:o.jsxs("select",{...M("dateRange"),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[o.jsx("option",{value:"today",children:"Today"}),o.jsx("option",{value:"week",children:"This Week"}),o.jsx("option",{value:"month",children:"This Month"}),o.jsx("option",{value:"custom",children:"Custom Range"})]})}),o.jsx("div",{children:o.jsxs("select",{...M("tableId"),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[o.jsx("option",{value:"",children:"All Tables"}),l.map(V=>o.jsxs("option",{value:V.id,children:["Table ",V.number]},V.id))]})}),o.jsx("div",{children:o.jsxs("select",{...M("status"),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[o.jsx("option",{value:"all",children:"All Status"}),o.jsx("option",{value:"placed",children:"Placed"}),o.jsx("option",{value:"confirmed",children:"Confirmed"}),o.jsx("option",{value:"preparing",children:"Preparing"}),o.jsx("option",{value:"ready",children:"Ready"}),o.jsx("option",{value:"delivered",children:"Delivered"}),o.jsx("option",{value:"completed",children:"Completed"}),o.jsx("option",{value:"cancelled",children:"Cancelled"})]})}),o.jsx("div",{children:o.jsxs("select",{...M("orderType"),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[o.jsx("option",{value:"all",children:"All Types"}),o.jsx("option",{value:"dine_in",children:"Dine In"}),o.jsx("option",{value:"takeaway",children:"Takeaway"}),o.jsx("option",{value:"delivery",children:"Delivery"})]})}),o.jsx("div",{children:o.jsxs("select",{...M("menuItemId"),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[o.jsx("option",{value:"all",children:"All Items"}),a.map(V=>o.jsx("option",{value:V.id,children:V.name},V.id))]})})]}),D==="custom"&&o.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Start Date"}),o.jsx("input",{type:"date",...M("startDate"),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"End Date"}),o.jsx("input",{type:"date",...M("endDate"),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]})]})}),o.jsxs("div",{className:"card",children:[o.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:["Orders (",n.length,")"]}),o.jsxs("button",{onClick:K,className:"btn btn-secondary",disabled:N||n.length===0,children:[o.jsx(ah,{className:"w-4 h-4 mr-2"}),"Export (",n.length,")"]})]})}),N?o.jsxs("div",{className:"text-center py-12",children:[o.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mb-4"}),o.jsx("p",{className:"text-gray-600",children:"Loading orders..."})]}):n.length===0?o.jsxs("div",{className:"text-center py-12",children:[o.jsx(vw,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),o.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No orders found"}),o.jsx("p",{className:"text-gray-600",children:"No orders match your current filters."})]}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"divide-y divide-gray-200",children:oe.map(V=>{const xe=l.find(B=>B.id===V.tableId);return o.jsx("div",{className:"p-6 hover:bg-gray-50",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex-1",children:[o.jsxs("div",{className:"flex items-center space-x-4 mb-2",children:[o.jsxs("h3",{className:"font-semibold text-gray-900",children:["#",V.orderNumber]}),H(V.status),o.jsxs("span",{className:"text-sm text-gray-600",children:["Table ",(xe==null?void 0:xe.number)||"N/A"]}),o.jsxs("span",{className:"text-sm text-gray-600",children:[Fs(V.createdAt)," ",$g(V.createdAt)]})]}),o.jsxs("div",{className:"text-sm text-gray-600 mb-2",children:[V.items.length," item",V.items.length!==1?"s":""," ",V.items.slice(0,3).map(B=>B.name).join(", "),V.items.length>3&&` + ${V.items.length-3} more`]}),o.jsxs("div",{className:"flex items-center space-x-4 text-sm",children:[o.jsxs("span",{className:"flex items-center text-gray-600",children:[o.jsx(ni,{className:"w-4 h-4 mr-1"}),V.type.replace("_"," ")]}),o.jsxs("span",{className:"flex items-center text-gray-600",children:[o.jsx(Yi,{className:"w-4 h-4 mr-1"}),V.paymentStatus]})]})]}),o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsxs("div",{className:"text-right",children:[o.jsx("p",{className:"font-semibold text-gray-900",children:pt(V.total)}),o.jsxs("p",{className:"text-sm text-gray-600",children:[V.items.reduce((B,Ee)=>B+Ee.quantity,0)," items"]})]}),o.jsxs("button",{onClick:()=>{g(V),v(!0)},className:"btn btn-secondary",children:[o.jsx(Ci,{className:"w-4 h-4 mr-2"}),"View"]})]})]})},V.id)})}),q>1&&o.jsx("div",{className:"px-6 py-4 border-t border-gray-200",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"text-sm text-gray-600",children:["Showing ",te+1," to ",Math.min(te+ye,n.length)," of ",n.length," orders"]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("button",{onClick:()=>w(V=>Math.max(1,V-1)),disabled:b===1,className:"p-2 border border-gray-300 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:o.jsx(KG,{className:"w-5 h-5"})}),o.jsxs("span",{className:"px-4 py-2 text-sm font-medium",children:["Page ",b," of ",q]}),o.jsx("button",{onClick:()=>w(V=>Math.min(q,V+1)),disabled:b===q,className:"p-2 border border-gray-300 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:o.jsx(YG,{className:"w-5 h-5"})})]})]})})]})]})]}),F==="analytics"&&o.jsxs("div",{className:"space-y-8",children:[o.jsxs("div",{className:"card p-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Analytics Filters"}),o.jsx("p",{className:"text-sm text-gray-600",children:"Select date range to analyze your data"})]}),o.jsxs("div",{className:"text-sm text-gray-500",children:["Showing ",n.length," orders"]})]}),o.jsx("form",{onSubmit:I(()=>{}),children:o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date Range"}),o.jsxs("select",{...M("dateRange"),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[o.jsx("option",{value:"today",children:"Today"}),o.jsx("option",{value:"yesterday",children:"Yesterday"}),o.jsx("option",{value:"week",children:"Last 7 Days"}),o.jsx("option",{value:"last_week",children:"Last Week"}),o.jsx("option",{value:"month",children:"Last 30 Days"}),o.jsx("option",{value:"this_month",children:"This Month"}),o.jsx("option",{value:"last_month",children:"Last Month"}),o.jsx("option",{value:"quarter",children:"Last 3 Months"}),o.jsx("option",{value:"custom",children:"Custom Range"})]})]}),D==="custom"&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Start Date"}),o.jsx("input",{type:"date",...M("startDate"),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"End Date"}),o.jsx("input",{type:"date",...M("endDate"),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),o.jsx("div",{className:"flex items-end",children:o.jsx("div",{className:"bg-blue-50 rounded-lg p-4 w-full",children:o.jsxs("div",{className:"text-center",children:[o.jsx("p",{className:"text-sm font-medium text-blue-700",children:"Selected Period"}),o.jsx("p",{className:"text-lg font-bold text-blue-900",children:pt(u.totalRevenue)}),o.jsxs("p",{className:"text-xs text-blue-600",children:[u.totalOrders," orders"]})]})})})]})})]}),o.jsx("div",{className:"card p-6",children:o.jsx(Kle,{orders:n})}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6",children:[o.jsx("div",{className:"card p-6",children:o.jsx(Yle,{orders:n})}),o.jsx("div",{className:"card p-6",children:o.jsx(Xle,{orders:n})}),o.jsx("div",{className:"card p-6",children:o.jsx(Qle,{orders:n})})]}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[o.jsx("div",{className:"card p-6",children:o.jsx(Jle,{orders:n,tables:l})}),o.jsx("div",{className:"card p-6",children:o.jsx(Zle,{orders:n,menuItems:a})})]}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[o.jsxs("div",{className:"card p-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Popular Menu Items"}),u.popularItems.length===0?o.jsxs("div",{className:"text-center py-8",children:[o.jsx(Zi,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),o.jsx("p",{className:"text-gray-600",children:"No data available"})]}):o.jsx("div",{className:"space-y-4",children:u.popularItems.map((V,xe)=>o.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center text-sm font-medium text-blue-600",children:xe+1}),o.jsxs("div",{children:[o.jsx("p",{className:"font-medium text-gray-900",children:V.name}),o.jsxs("p",{className:"text-sm text-gray-600",children:[V.quantity," sold"]})]})]}),o.jsxs("div",{className:"text-right",children:[o.jsx("p",{className:"font-semibold text-gray-900",children:pt(V.revenue)}),o.jsx("p",{className:"text-sm text-gray-600",children:"revenue"})]})]},V.menuItemId))})]}),o.jsxs("div",{className:"card p-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Table Performance Summary"}),u.tableStats.length===0?o.jsxs("div",{className:"text-center py-8",children:[o.jsx(vd,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),o.jsx("p",{className:"text-gray-600",children:"No data available"})]}):o.jsx("div",{className:"space-y-4",children:u.tableStats.slice(0,5).map(V=>o.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center",children:o.jsx(vd,{className:"w-4 h-4 text-green-600"})}),o.jsxs("div",{children:[o.jsxs("p",{className:"font-medium text-gray-900",children:["Table ",V.tableNumber]}),o.jsxs("p",{className:"text-sm text-gray-600",children:[V.orderCount," orders"]})]})]}),o.jsxs("div",{className:"text-right",children:[o.jsx("p",{className:"font-semibold text-gray-900",children:pt(V.revenue)}),o.jsx("p",{className:"text-sm text-gray-600",children:"revenue"})]})]},V.tableId))})]})]}),o.jsxs("div",{className:"card p-6 bg-gradient-to-r from-blue-50 to-purple-50",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Analytics Insights"}),o.jsx(_i,{className:"w-6 h-6 text-blue-600"})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsxs("div",{className:"text-center p-4 bg-white rounded-lg shadow-sm",children:[o.jsx("p",{className:"text-sm font-medium text-gray-600 mb-2",children:"Most Active Hour"}),o.jsx("p",{className:"text-xl font-bold text-blue-600",children:n.length>0?(()=>{const V=new Map;return n.forEach(B=>{const Ee=new Date(B.createdAt).getHours();V.set(Ee,(V.get(Ee)||0)+1)}),`${Array.from(V.entries()).reduce((B,[Ee,Me])=>Me>B.count?{hour:Ee,count:Me}:B,{hour:0,count:0}).hour}:00`})():"N/A"})]}),o.jsxs("div",{className:"text-center p-4 bg-white rounded-lg shadow-sm",children:[o.jsx("p",{className:"text-sm font-medium text-gray-600 mb-2",children:"Best Category"}),o.jsx("p",{className:"text-xl font-bold text-green-600",children:(()=>{const V=new Map;return n.forEach(B=>{B.items.forEach(Ee=>{const Me=a.find(he=>he.id===Ee.menuItemId),Ie=(Me==null?void 0:Me.category)||"Unknown";V.set(Ie,(V.get(Ie)||0)+Ee.total)})}),Array.from(V.entries()).reduce((B,[Ee,Me])=>Me>B.revenue?{cat:Ee,revenue:Me}:B,{cat:"N/A",revenue:0}).cat})()})]}),o.jsxs("div",{className:"text-center p-4 bg-white rounded-lg shadow-sm",children:[o.jsx("p",{className:"text-sm font-medium text-gray-600 mb-2",children:"Efficiency Score"}),o.jsx("p",{className:"text-xl font-bold text-purple-600",children:(()=>{const V=l.length,xe=u.tableStats.filter(Ee=>Ee.orderCount>0).length;return`${(V>0?xe/V*100:0).toFixed(0)}%`})()})]})]})]})]}),F==="reports"&&o.jsx("div",{className:"space-y-6",children:A?null:o.jsxs("div",{className:"card p-6",children:[o.jsxs("div",{className:"text-center mb-8",children:[o.jsx("div",{className:"w-20 h-20 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center mx-auto mb-6",children:o.jsx(xd,{className:"w-10 h-10 text-white"})}),o.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Business Analytics Center"}),o.jsx("p",{className:"text-lg text-gray-600 mb-8",children:"Generate comprehensive reports with detailed insights for your restaurant"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[o.jsxs("div",{className:"text-center p-4",children:[o.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-3",children:o.jsx(_i,{className:"w-6 h-6 text-green-600"})}),o.jsx("h3",{className:"font-semibold text-gray-900",children:"Sales Analytics"}),o.jsx("p",{className:"text-sm text-gray-600",children:"Revenue, orders, and growth metrics"})]}),o.jsxs("div",{className:"text-center p-4",children:[o.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-3",children:o.jsx(ni,{className:"w-6 h-6 text-blue-600"})}),o.jsx("h3",{className:"font-semibold text-gray-900",children:"Customer Insights"}),o.jsx("p",{className:"text-sm text-gray-600",children:"Customer behavior and preferences"})]}),o.jsxs("div",{className:"text-center p-4",children:[o.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-3",children:o.jsx(Zi,{className:"w-6 h-6 text-purple-600"})}),o.jsx("h3",{className:"font-semibold text-gray-900",children:"Operational Data"}),o.jsx("p",{className:"text-sm text-gray-600",children:"Menu, tables, and staff performance"})]})]}),o.jsxs("button",{onClick:()=>k(!0),className:"inline-flex items-center px-8 py-4 bg-gradient-to-r from-blue-600 to-purple-600 text-white font-semibold rounded-xl hover:from-blue-700 hover:to-purple-700 transform hover:scale-105 transition-all duration-200 shadow-lg hover:shadow-xl",children:[o.jsx(xm,{className:"w-6 h-6 mr-3"}),"Generate Comprehensive Report"]}),o.jsx("p",{className:"text-sm text-gray-500 mt-4",children:"Select time periods, customize sections, and download detailed PDF reports"})]}),o.jsxs("div",{className:"border-t pt-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Quick Analytics (Today)"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[o.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-blue-100 rounded-lg p-4 border border-blue-200",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm text-blue-700 font-medium",children:"Today's Revenue"}),o.jsx("p",{className:"text-xl font-bold text-blue-900",children:pt(u.todayRevenue)})]}),o.jsx(Yi,{className:"w-8 h-8 text-blue-600"})]})}),o.jsx("div",{className:"bg-gradient-to-r from-green-50 to-green-100 rounded-lg p-4 border border-green-200",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm text-green-700 font-medium",children:"Today's Orders"}),o.jsx("p",{className:"text-xl font-bold text-green-900",children:u.todayOrders})]}),o.jsx(vw,{className:"w-8 h-8 text-green-600"})]})}),o.jsx("div",{className:"bg-gradient-to-r from-purple-50 to-purple-100 rounded-lg p-4 border border-purple-200",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm text-purple-700 font-medium",children:"Avg Order Value"}),o.jsx("p",{className:"text-xl font-bold text-purple-900",children:pt(u.avgOrderValue)})]}),o.jsx(_i,{className:"w-8 h-8 text-purple-600"})]})}),o.jsx("div",{className:"bg-gradient-to-r from-orange-50 to-orange-100 rounded-lg p-4 border border-orange-200",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm text-orange-700 font-medium",children:"Total Orders"}),o.jsx("p",{className:"text-xl font-bold text-orange-900",children:u.totalOrders})]}),o.jsx(Zi,{className:"w-8 h-8 text-orange-600"})]})})]})]})]})})]}),o.jsx(ece,{order:h,isOpen:p,onClose:()=>v(!1),onStatusUpdate:L,tables:l}),o.jsx(Gle,{isOpen:S,onClose:()=>k(!1)})]})}function rce(){const{restaurant:t,updateRestaurant:e}=ya(),[r,n]=X.useState("business"),[s,a]=X.useState([]),[i,l]=X.useState([]),[c,u]=X.useState(!0),[d,f]=X.useState(!1),[m,h]=X.useState(!1),[g,p]=X.useState(null),[v,b]=X.useState(!1),[w,N]=X.useState(null),[j,F]=X.useState("all"),{register:U,handleSubmit:A,reset:S,formState:{errors:k}}=Hn(),{register:M,handleSubmit:I,reset:E,setValue:D}=Hn(),{register:G,handleSubmit:Z,reset:ae,setValue:de}=Hn();X.useEffect(()=>{t&&(se(),re())},[t]);const se=async()=>{if(t)try{u(!0),console.log(" Loading settings data for restaurant:",t.id);const[B,Ee]=await Promise.all([Ku.getTableAreasForRestaurant(t.id),pn.getTablesForRestaurant(t.id)]);if(console.log(" Areas result:",B),console.log(" Tables result:",Ee),Ee.success&&Ee.data&&(l(Ee.data),console.log(" Set tables:",Ee.data.length)),B.success&&B.data&&B.data.length>0)a(B.data),console.log(" Set table areas:",B.data.length);else if(console.log(" No formal table areas found, extracting from existing tables..."),Ee.success&&Ee.data&&Ee.data.length>0){const Me=[...new Set(Ee.data.map(he=>he.area).filter(Boolean))];console.log(" Found area names from tables:",Me);const Ie=Me.map((he,qe)=>({id:`virtual-${he.toLowerCase().replace(/\s+/g,"-")}`,restaurantId:t.id,name:he,description:`${he} seating area`,isActive:!0,sortOrder:qe+1,createdAt:new Date,updatedAt:new Date}));a(Ie),console.log(" Created virtual table areas from existing tables:",Ie.length)}else a([]),console.log(" No tables found either")}catch(B){console.error(" Error loading settings data:",B),fe.error("Failed to load settings data")}finally{u(!1)}},Y=async B=>{if(t)try{console.log(" [Settings] Starting migration: Creating table areas from existing tables...",B.length);const Ee=[...new Set(B.map(he=>he.area).filter(Boolean))];console.log(" [Settings] Unique area names found:",Ee);const Me=Ee.map(he=>({name:he}));console.log(" [Settings] Unique areas to create:",Me);const Ie=[];for(let he=0;he<Me.length;he++){const qe=Me[he];console.log(" [Settings] Creating area:",qe.name);const ct=await Ku.createTableArea(t.id,{name:qe.name,description:`${qe.name} seating area`,isActive:!0,sortOrder:he+1});console.log(" [Settings] Create area result:",ct),ct.success&&ct.data?Ie.push(ct.data):console.error("Failed to create area:",qe.name,ct.error)}Ie.length>0?(a(Ie),console.log(" [Settings] Created TableArea entities:",Ie.length),fe.success(`Created ${Ie.length} table area(s) from existing tables`)):(console.error(" [Settings] No areas were created successfully"),fe.error("Failed to create table areas from existing tables"))}catch(Ee){console.error("Failed to create table areas from existing tables:",Ee),fe.error("Migration failed: "+Ee.message)}},ye=async()=>{if(t)try{u(!0),console.log(" Initializing default tables and areas...");const B=await pn.initializeDefaultTables(t.id);B.success&&B.data?(await se(),fe.success("Default tables and areas created successfully!")):fe.error(B.error||"Failed to initialize default tables")}catch(B){console.error("Failed to initialize defaults:",B),fe.error("Failed to initialize default tables")}finally{u(!1)}},re=()=>{var B,Ee,Me,Ie,he,qe,ct,lt;t&&S({address:t.settings.address||"",phone:t.settings.phone||"",email:t.settings.email||"",taxRate:t.settings.taxRate||18,gstin:((B=t.settings.businessInfo)==null?void 0:B.gstin)||"",fssaiNumber:((Ee=t.settings.businessInfo)==null?void 0:Ee.fssaiNumber)||"",businessAddress:((Me=t.settings.businessInfo)==null?void 0:Me.businessAddress)||"",city:((Ie=t.settings.businessInfo)==null?void 0:Ie.city)||"",state:((he=t.settings.businessInfo)==null?void 0:he.state)||"",pincode:((qe=t.settings.businessInfo)==null?void 0:qe.pincode)||"",country:((ct=t.settings.businessInfo)==null?void 0:ct.country)||"India",website:((lt=t.settings.businessInfo)==null?void 0:lt.website)||""})},C=async B=>{if(t)try{f(!0);const Ee={...t.settings,address:B.address,phone:B.phone,email:B.email,taxRate:B.taxRate,businessInfo:{...t.settings.businessInfo,gstin:B.gstin,fssaiNumber:B.fssaiNumber,businessAddress:B.businessAddress,city:B.city,state:B.state,pincode:B.pincode,country:B.country,website:B.website}},Me=await To.updateRestaurant(t.id,{settings:Ee});Me.success?(await e({settings:Ee}),fe.success("Business information updated successfully")):fe.error(Me.error||"Failed to update business information")}catch{fe.error("Failed to update business information")}finally{f(!1)}},O=()=>{p(null),E({name:"",description:"",isActive:!0,sortOrder:s.length+1}),h(!0)},L=B=>{p(B),D("name",B.name),D("description",B.description||""),D("isActive",B.isActive),D("sortOrder",B.sortOrder),h(!0)},H=async B=>{if(t)try{let Ee;g?Ee=await Ku.updateTableArea(t.id,g.id,B):Ee=await Ku.createTableArea(t.id,B),Ee.success?(await se(),h(!1),p(null),E(),fe.success(Ee.message||"Area saved successfully")):fe.error(Ee.error||"Failed to save area")}catch{fe.error("Failed to save area")}},K=async B=>{if(!t)return;const Ee=i.filter(Me=>Me.areaId===B.id);if(Ee.length>0){fe.error(`Cannot delete area. It has ${Ee.length} table(s). Please move or delete the tables first.`);return}if(confirm(`Are you sure you want to delete the area "${B.name}"?`))try{const Me=await Ku.deleteTableArea(t.id,B.id);Me.success?(await se(),fe.success(Me.message||"Area deleted successfully")):fe.error(Me.error||"Failed to delete area")}catch{fe.error("Failed to delete area")}},q=()=>{var B;if(s.length===0){fe.error("Please create at least one table area first");return}N(null),ae({number:"",areaId:((B=s[0])==null?void 0:B.id)||"",capacity:4,description:"",isActive:!0}),b(!0)},te=B=>{N(B),de("number",B.number),de("areaId",B.areaId),de("capacity",B.capacity),de("description",B.description||""),de("isActive",B.isActive),b(!0)},oe=async B=>{if(t)try{const Ee=s.find(he=>he.id===B.areaId);if(!Ee){fe.error("Please select a valid area");return}const Me={...B,area:Ee.name,status:"available",restaurantId:t.id};let Ie;w?Ie=await pn.updateTable(w.id,t.id,Me):Ie=await pn.createTable(Me),Ie.success?(await se(),b(!1),N(null),ae(),fe.success(Ie.message||"Table saved successfully")):fe.error(Ie.error||"Failed to save table")}catch{fe.error("Failed to save table")}},V=async B=>{if(t){if(B.status==="occupied"){fe.error("Cannot delete an occupied table");return}if(confirm(`Are you sure you want to delete Table ${B.number}?`))try{const Ee=await pn.deleteTable(B.id,t.id);Ee.success?(await se(),fe.success(Ee.message||"Table deleted successfully")):fe.error(Ee.error||"Failed to delete table")}catch{fe.error("Failed to delete table")}}},xe=j==="all"||s.length===0?i:i.filter(B=>B.areaId===j);return t?o.jsxs("div",{className:"min-h-screen",style:{background:"var(--color-background)"},children:[o.jsx("header",{className:"bg-white/80 backdrop-blur-md border-b border-gray-200",children:o.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:o.jsx("div",{className:"flex items-center justify-between",children:o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsx("button",{onClick:()=>window.history.back(),className:"p-2 text-gray-600 hover:text-gray-900 rounded-lg hover:bg-gray-100",children:o.jsx(gm,{className:"w-5 h-5"})}),o.jsx("div",{className:"w-12 h-12 rounded-2xl flex items-center justify-center text-white",style:{background:"var(--gradient-primary)"},children:o.jsx(Id,{className:"w-6 h-6"})}),o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Restaurant Settings"}),o.jsx("p",{className:"text-gray-600",children:"Manage your restaurant configuration"})]})]})})})}),o.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[o.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 mb-6",children:o.jsxs("div",{className:"flex",children:[o.jsxs("button",{onClick:()=>n("business"),className:`flex-1 px-6 py-4 text-sm font-medium rounded-l-lg transition-colors ${r==="business"?"bg-blue-50 text-blue-700 border-b-2 border-blue-500":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"}`,children:[o.jsx(Vv,{className:"w-5 h-5 mr-2 inline"}),"Business Information"]}),o.jsxs("button",{onClick:()=>n("tables"),className:`flex-1 px-6 py-4 text-sm font-medium rounded-r-lg transition-colors ${r==="tables"?"bg-blue-50 text-blue-700 border-b-2 border-blue-500":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"}`,children:[o.jsx(ni,{className:"w-5 h-5 mr-2 inline"}),"Table Management"]})]})}),r==="business"&&o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-8",children:[o.jsxs("div",{className:"mb-6",children:[o.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Business Information"}),o.jsx("p",{className:"text-gray-600",children:"Update your restaurant's business details for bills and receipts"})]}),o.jsxs("form",{onSubmit:A(C),className:"space-y-8",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Basic Information"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Restaurant Name"}),o.jsx("input",{type:"text",value:t.name,disabled:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg bg-gray-50 text-gray-500 cursor-not-allowed"}),o.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Restaurant name cannot be changed"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Business Type"}),o.jsx("input",{type:"text",value:t.businessType.charAt(0).toUpperCase()+t.businessType.slice(1),disabled:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg bg-gray-50 text-gray-500 cursor-not-allowed"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone Number"}),o.jsxs("div",{className:"relative",children:[o.jsx(Lx,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),o.jsx("input",{...U("phone"),type:"tel",className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"+91 98765 43210"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address"}),o.jsxs("div",{className:"relative",children:[o.jsx(Z2,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),o.jsx("input",{...U("email"),type:"email",className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"restaurant@example.com"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Website"}),o.jsxs("div",{className:"relative",children:[o.jsx(QG,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),o.jsx("input",{...U("website"),type:"url",className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"https://restaurant.com"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tax Rate (%)"}),o.jsx("input",{...U("taxRate",{required:"Tax rate is required",min:{value:0,message:"Tax rate cannot be negative"},max:{value:100,message:"Tax rate cannot exceed 100%"}}),type:"number",step:"0.01",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"18.00"}),k.taxRate&&o.jsx("p",{className:"text-red-600 text-sm mt-1",children:k.taxRate.message})]})]})]}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Business Registration"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"GSTIN Number"}),o.jsxs("div",{className:"relative",children:[o.jsx(R_,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),o.jsx("input",{...U("gstin"),type:"text",className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"22AAAAA0000A1Z5"})]}),o.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"GST Identification Number for tax compliance"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"FSSAI License Number"}),o.jsxs("div",{className:"relative",children:[o.jsx(xm,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),o.jsx("input",{...U("fssaiNumber"),type:"text",className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"12345678901234"})]}),o.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Food Safety and Standards Authority of India License"})]})]})]}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Business Address"}),o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Full Business Address"}),o.jsxs("div",{className:"relative",children:[o.jsx(HG,{className:"absolute left-3 top-3 w-5 h-5 text-gray-400"}),o.jsx("textarea",{...U("businessAddress"),rows:3,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter complete business address for bills and legal documents"})]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"City"}),o.jsx("input",{...U("city"),type:"text",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Mumbai"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"State"}),o.jsx("input",{...U("state"),type:"text",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Maharashtra"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"PIN Code"}),o.jsx("input",{...U("pincode"),type:"text",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"400001"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Country"}),o.jsx("input",{...U("country"),type:"text",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"India"})]})]})]}),o.jsx("div",{className:"flex justify-end pt-6 border-t border-gray-200",children:o.jsx("button",{type:"submit",disabled:d,className:"btn btn-primary",children:d?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Saving..."]}):o.jsxs(o.Fragment,{children:[o.jsx(kd,{className:"w-4 h-4 mr-2"}),"Save Business Information"]})})})]})]}),r==="tables"&&o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-6",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Table Areas"}),o.jsx("p",{className:"text-gray-600",children:"Manage dining areas for better table organization"})]}),o.jsxs("button",{onClick:O,className:"btn btn-primary",children:[o.jsx(Wn,{className:"w-4 h-4 mr-2"}),"Add Area"]})]}),c?o.jsxs("div",{className:"text-center py-8",children:[o.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),o.jsx("p",{className:"text-gray-600 mt-2",children:"Loading areas..."})]}):s.length===0?o.jsxs("div",{className:"text-center py-8",children:[o.jsx(vd,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),o.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No table areas"}),o.jsx("p",{className:"text-gray-600 mb-4",children:"Create your first dining area to organize tables"}),o.jsxs("div",{className:"flex items-center justify-center space-x-3",children:[i.length===0&&o.jsxs("button",{onClick:ye,className:"btn btn-primary",disabled:c,children:[o.jsx(Wn,{className:"w-4 h-4 mr-2"}),"Setup Default Tables"]}),o.jsxs("button",{onClick:O,className:"btn btn-secondary",children:[o.jsx(Wn,{className:"w-4 h-4 mr-2"}),"Create First Area"]})]})]}):o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:s.map(B=>{const Ee=i.filter(Me=>Me.areaId===B.id).length;return o.jsxs("div",{className:`p-4 border rounded-lg ${B.isActive?"border-gray-200 bg-white":"border-gray-200 bg-gray-50"}`,children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsx("h3",{className:"font-medium text-gray-900",children:B.name}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("button",{onClick:()=>L(B),className:"p-1 text-gray-400 hover:text-blue-600 rounded",children:o.jsx(Hg,{className:"w-4 h-4"})}),o.jsx("button",{onClick:()=>K(B),className:"p-1 text-gray-400 hover:text-red-600 rounded",children:o.jsx(ga,{className:"w-4 h-4"})})]})]}),B.description&&o.jsx("p",{className:"text-sm text-gray-600 mb-2",children:B.description}),o.jsxs("div",{className:"flex items-center justify-between text-sm",children:[o.jsxs("span",{className:"text-gray-600",children:[Ee," tables"]}),o.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${B.isActive?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:B.isActive?"Active":"Inactive"})]})]},B.id)})})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-6",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Tables"}),o.jsx("p",{className:"text-gray-600",children:"Manage individual tables and their settings"})]}),o.jsxs("div",{className:"flex items-center space-x-4",children:[s.length>0&&o.jsxs("select",{value:j,onChange:B=>F(B.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[o.jsx("option",{value:"all",children:"All Areas"}),s.map(B=>o.jsx("option",{value:B.id,children:B.name},B.id))]}),o.jsxs("button",{onClick:q,className:"btn btn-primary",children:[o.jsx(Wn,{className:"w-4 h-4 mr-2"}),"Add Table"]})]})]}),s.length===0&&i.length>0&&o.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6",children:o.jsxs("div",{className:"flex items-center",children:[o.jsxs("div",{className:"text-yellow-600 text-sm",children:[" You have ",i.length," tables but no table areas configured. Consider organizing your tables into areas."]}),o.jsx("button",{onClick:()=>Y(i),className:"ml-4 px-3 py-1 bg-yellow-600 text-white text-xs rounded hover:bg-yellow-700",disabled:c,children:"Fix Table Areas Now"})]})}),i.length===0?o.jsxs("div",{className:"text-center py-8",children:[o.jsx(ni,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),o.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No tables found"}),o.jsx("p",{className:"text-gray-600 mb-4",children:"Get started by setting up your restaurant tables"}),o.jsxs("button",{onClick:ye,className:"btn btn-primary",disabled:c,children:[o.jsx(Wn,{className:"w-4 h-4 mr-2"}),"Setup Default Tables & Areas"]})]}):xe.length===0?o.jsxs("div",{className:"text-center py-8",children:[o.jsx(ni,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),o.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No tables found"}),o.jsx("p",{className:"text-gray-600",children:j==="all"?"Add your first table to get started":"No tables in the selected area"})]}):o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full table-fixed",children:[o.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:o.jsxs("tr",{children:[o.jsx("th",{className:"w-1/5 px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Table"}),o.jsx("th",{className:"w-1/5 px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Area"}),o.jsx("th",{className:"w-1/5 px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Capacity"}),o.jsx("th",{className:"w-1/5 px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),o.jsx("th",{className:"w-1/5 px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:xe.map(B=>o.jsxs("tr",{className:"hover:bg-gray-50",children:[o.jsx("td",{className:"px-6 py-4",children:o.jsxs("div",{children:[o.jsxs("div",{className:"font-medium text-gray-900",children:["Table ",B.number]}),B.description&&o.jsx("div",{className:"text-sm text-gray-500",children:B.description})]})}),o.jsx("td",{className:"px-6 py-4 bg-blue-50",children:o.jsx("div",{className:"font-medium text-blue-900",children:B.area||"No Area"})}),o.jsxs("td",{className:"px-6 py-4 text-sm text-gray-900",children:[B.capacity," guests"]}),o.jsx("td",{className:"px-6 py-4",children:o.jsxs("div",{className:"flex flex-col space-y-1",children:[o.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${B.status==="available"?"bg-green-100 text-green-800":B.status==="occupied"?"bg-red-100 text-red-800":B.status==="reserved"?"bg-yellow-100 text-yellow-800":B.status==="cleaning"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:B.status.replace("_"," ")}),o.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${B.isActive?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:B.isActive?"Active":"Inactive"})]})}),o.jsx("td",{className:"px-6 py-4",children:o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("button",{onClick:()=>te(B),className:"p-2 text-gray-400 hover:text-blue-600 rounded hover:bg-blue-50",children:o.jsx(Hg,{className:"w-4 h-4"})}),o.jsx("button",{onClick:()=>V(B),className:"p-2 text-gray-400 hover:text-red-600 rounded hover:bg-red-50",disabled:B.status==="occupied",children:o.jsx(ga,{className:"w-4 h-4"})})]})})]},B.id))})]})})]})]}),m&&o.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:o.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[o.jsx("div",{className:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75",onClick:()=>h(!1)}),o.jsxs("div",{className:"inline-block w-full max-w-md my-8 overflow-hidden text-left align-middle transition-all transform bg-white shadow-xl rounded-2xl",children:[o.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:g?"Edit Area":"Create New Area"})}),o.jsxs("form",{onSubmit:I(H),className:"p-6 space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Area Name *"}),o.jsx("input",{...M("name",{required:"Area name is required"}),type:"text",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Main Dining"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),o.jsx("textarea",{...M("description"),rows:3,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Optional description"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Sort Order"}),o.jsx("input",{...M("sortOrder",{required:!0,min:1}),type:"number",min:"1",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),o.jsxs("div",{className:"flex items-center",children:[o.jsx("input",{...M("isActive"),type:"checkbox",className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),o.jsx("label",{className:"ml-2 text-sm text-gray-700",children:"Active"})]}),o.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[o.jsx("button",{type:"button",onClick:()=>h(!1),className:"btn btn-secondary",children:"Cancel"}),o.jsxs("button",{type:"submit",className:"btn btn-primary",children:[g?"Update":"Create"," Area"]})]})]})]})]})}),v&&o.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:o.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[o.jsx("div",{className:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75",onClick:()=>b(!1)}),o.jsxs("div",{className:"inline-block w-full max-w-md my-8 overflow-hidden text-left align-middle transition-all transform bg-white shadow-xl rounded-2xl",children:[o.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:w?"Edit Table":"Create New Table"})}),o.jsxs("form",{onSubmit:Z(oe),className:"p-6 space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Table Number *"}),o.jsx("input",{...G("number",{required:"Table number is required"}),type:"text",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"1"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Area *"}),o.jsxs("select",{...G("areaId",{required:"Area is required"}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[o.jsx("option",{value:"",children:"Select an area"}),s.filter(B=>B.isActive).map(B=>o.jsx("option",{value:B.id,children:B.name},B.id))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Capacity *"}),o.jsx("input",{...G("capacity",{required:"Capacity is required",min:1}),type:"number",min:"1",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"4"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),o.jsx("input",{...G("description"),type:"text",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Window table"})]}),o.jsxs("div",{className:"flex items-center",children:[o.jsx("input",{...G("isActive"),type:"checkbox",className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),o.jsx("label",{className:"ml-2 text-sm text-gray-700",children:"Active"})]}),o.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[o.jsx("button",{type:"button",onClick:()=>b(!1),className:"btn btn-secondary",children:"Cancel"}),o.jsxs("button",{type:"submit",className:"btn btn-primary",children:[w?"Update":"Create"," Table"]})]})]})]})]})})]})]}):null}class Ja{static async createSpinWheel(e,r){try{const n=new Date,s=await Gr(Rt(Ke,"restaurants",e)),a=s.exists()?s.data().slug:e,i=`${window.location.origin}/${a}/spin-wheel`,l={...r,restaurantId:e,createdAt:n,updatedAt:n,shareableLink:i,totalSpins:0,totalRedemptions:0},c=await sh(hr(Ke,`restaurants/${e}/spinWheels`),{...l,createdAt:ft.fromDate(l.createdAt),updatedAt:ft.fromDate(l.updatedAt)});return{success:!0,data:{...l,id:c.id},message:"Spin wheel created successfully"}}catch(n){return console.error("Error creating spin wheel:",n),{success:!1,error:n instanceof Error?n.message:"Failed to create spin wheel"}}}static async getSpinWheelsForRestaurant(e){try{const r=br(hr(Ke,`restaurants/${e}/spinWheels`),Oa("createdAt","desc"));return{success:!0,data:(await Tr(r)).docs.map(a=>{var l,c;const i=a.data();return{id:a.id,...i,createdAt:((l=i.createdAt)==null?void 0:l.toDate())||new Date,updatedAt:((c=i.updatedAt)==null?void 0:c.toDate())||new Date}})}}catch(r){return console.error("Error fetching spin wheels:",r),{success:!1,error:r instanceof Error?r.message:"Failed to fetch spin wheels"}}}static async getSpinWheelById(e,r){var n,s;try{const a=Rt(Ke,`restaurants/${e}/spinWheels`,r),i=await Gr(a);if(!i.exists())return{success:!1,error:"Spin wheel not found"};const l=i.data();return{success:!0,data:{id:i.id,...l,createdAt:((n=l.createdAt)==null?void 0:n.toDate())||new Date,updatedAt:((s=l.updatedAt)==null?void 0:s.toDate())||new Date}}}catch(a){return console.error("Error fetching spin wheel:",a),{success:!1,error:a instanceof Error?a.message:"Failed to fetch spin wheel"}}}static async updateSpinWheel(e,r,n){var s,a;try{const i=Rt(Ke,`restaurants/${e}/spinWheels`,r),l={...n,updatedAt:ft.fromDate(new Date)};await nn(i,l);const c=await Gr(i),u=c.data();return{success:!0,data:{id:c.id,...u,createdAt:((s=u==null?void 0:u.createdAt)==null?void 0:s.toDate())||new Date,updatedAt:((a=u==null?void 0:u.updatedAt)==null?void 0:a.toDate())||new Date},message:"Spin wheel updated successfully"}}catch(i){return console.error("Error updating spin wheel:",i),{success:!1,error:i instanceof Error?i.message:"Failed to update spin wheel"}}}static async deleteSpinWheel(e,r){try{const n=Rt(Ke,`restaurants/${e}/spinWheels`,r);return await Uc(n),{success:!0,message:"Spin wheel deleted successfully"}}catch(n){return console.error("Error deleting spin wheel:",n),{success:!1,error:n instanceof Error?n.message:"Failed to delete spin wheel"}}}static async recordCustomerSpin(e){var r,n;try{const s=new Date,a=await this.getSpinWheelById(e.restaurantId,e.spinWheelId);let i=0;a.success&&((n=(r=a.data)==null?void 0:r.pointsConfig)!=null&&n.enabled)&&(i=a.data.pointsConfig.pointsPerSpin);const l={...e,pointsEarned:i,spinDate:s},c=await sh(hr(Ke,`restaurants/${e.restaurantId}/customerSpins`),{...l,spinDate:ft.fromDate(l.spinDate),redeemedAt:l.redeemedAt?ft.fromDate(l.redeemedAt):null});await this.incrementSpinWheelStats(e.restaurantId,e.spinWheelId,"spins");const u={...l,id:c.id};if(i>0&&e.customerId)try{const{LoyaltyPointsService:d}=await Bi(async()=>{const{LoyaltyPointsService:m}=await Promise.resolve().then(()=>t7);return{LoyaltyPointsService:m}},void 0),f=await d.awardSpinPoints(e.restaurantId,e.customerId,c.id,i);f.success||(console.warn("Points could not be awarded:",f.error),console.info("This is normal for gamification users who do not have corresponding customer records in CRM."))}catch(d){console.warn("Error awarding points:",d),console.info("This is normal for gamification users who do not have corresponding customer records in CRM.")}return{success:!0,data:u,message:"Spin recorded successfully"}}catch(s){return console.error("Error recording customer spin:",s),{success:!1,error:s instanceof Error?s.message:"Failed to record spin"}}}static async getCustomerSpinsToday(e,r){try{const n=new Date;n.setHours(0,0,0,0);const s=br(hr(Ke,`restaurants/${e}/customerSpins`),Nr("customerPhone","==",r));return{success:!0,data:(await Tr(s)).docs.map(c=>{var d,f;const u=c.data();return{id:c.id,...u,spinDate:((d=u.spinDate)==null?void 0:d.toDate())||new Date,redeemedAt:(f=u.redeemedAt)==null?void 0:f.toDate()}}).filter(c=>{const u=new Date(c.spinDate);return u.setHours(0,0,0,0),u.getTime()===n.getTime()})}}catch(n){return console.error("Error fetching customer spins today:",n),{success:!1,error:n instanceof Error?n.message:"Failed to fetch customer spins"}}}static async redeemSpin(e,r){try{const n=Rt(Ke,`restaurants/${e}/customerSpins`,r);await nn(n,{isRedeemed:!0,redeemedAt:ft.fromDate(new Date)});const s=await Gr(n);if(s.exists()){const a=s.data();await this.incrementSpinWheelStats(e,a.spinWheelId,"redemptions")}return{success:!0,message:"Spin redeemed successfully"}}catch(n){return console.error("Error redeeming spin:",n),{success:!1,error:n instanceof Error?n.message:"Failed to redeem spin"}}}static async claimSpinReward(e,r,n){try{const s=Rt(Ke,`restaurants/${e}/customerSpins`,r);return await nn(s,{customerName:n.customerName,customerPhone:n.customerPhone,customerEmail:n.customerEmail||null,couponCode:n.couponCode,isClaimed:!0,claimedAt:ft.fromDate(new Date)}),{success:!0,message:"Reward claimed successfully"}}catch(s){return console.error("Error claiming reward:",s),{success:!1,error:s instanceof Error?s.message:"Failed to claim reward"}}}static async getCustomerSpinsByPhone(e){try{return{success:!1,error:"This method needs restaurant context. Use getCustomerSpinsFromRestaurant instead."}}catch(r){return console.error("Error fetching customer spins:",r),{success:!1,error:r instanceof Error?r.message:"Failed to fetch customer spins"}}}static async getCustomerSpinsFromRestaurant(e,r){try{const n=br(hr(Ke,`restaurants/${e}/customerSpins`),Nr("customerPhone","==",r));return{success:!0,data:(await Tr(n)).docs.map(l=>{var u,d;const c=l.data();return{id:l.id,...c,spinDate:((u=c.spinDate)==null?void 0:u.toDate())||new Date,redeemedAt:(d=c.redeemedAt)==null?void 0:d.toDate()}}).sort((l,c)=>c.spinDate.getTime()-l.spinDate.getTime()).slice(0,50)}}catch(n){return console.error("Error fetching customer spins from restaurant:",n),{success:!1,error:n instanceof Error?n.message:"Failed to fetch customer spins"}}}static async getCustomerSpinsCountToday(e,r){try{const n=new Date;n.setHours(0,0,0,0);const s=new Date(n);s.setDate(s.getDate()+1);const a=br(hr(Ke,`restaurants/${e}/customerSpins`),Nr("customerPhone","==",r)),i=await Tr(a);let l=0;return i.docs.forEach(c=>{var f;const d=((f=c.data().spinDate)==null?void 0:f.toDate())||new Date;d.setHours(0,0,0,0),d.getTime()===n.getTime()&&l++}),{success:!0,data:l}}catch(n){return console.error("Error counting customer spins today:",n),{success:!1,error:n instanceof Error?n.message:"Failed to count customer spins"}}}static async getSpinWheelStats(e,r){try{const n=br(hr(Ke,`restaurants/${e}/customerSpins`),Nr("spinWheelId","==",r)),a=(await Tr(n)).docs.map(g=>{var v,b;const p=g.data();return{id:g.id,...p,spinDate:((v=p.spinDate)==null?void 0:v.toDate())||new Date,redeemedAt:(b=p.redeemedAt)==null?void 0:b.toDate()}}),i=a.length,l=a.filter(g=>g.isRedeemed).length,c=i>0?l/i*100:0,u={};a.forEach(g=>{u[g.resultSegmentId]||(u[g.resultSegmentId]={count:0,label:g.resultMessage}),u[g.resultSegmentId].count++});const d=Object.entries(u).map(([g,p])=>({segmentId:g,count:p.count,label:p.label})).sort((g,p)=>p.count-g.count),m=Array.from({length:30},(g,p)=>{const v=new Date;return v.setDate(v.getDate()-p),v.toISOString().split("T")[0]}).reverse().map(g=>{const p=a.filter(v=>v.spinDate.toISOString().split("T")[0]===g).length;return{date:g,count:p}});return{success:!0,data:{totalSpins:i,totalRedemptions:l,redemptionRate:c,popularSegments:d,dailySpins:m,customerEngagement:i>0?new Set(a.map(g=>g.customerPhone||g.customerEmail)).size/i*100:0}}}catch(n){return console.error("Error fetching spin wheel stats:",n),{success:!1,error:n instanceof Error?n.message:"Failed to fetch stats"}}}static async incrementSpinWheelStats(e,r,n){try{const s=Rt(Ke,`restaurants/${e}/spinWheels`,r),a=n==="spins"?"totalSpins":"totalRedemptions",i=await Gr(s);if(i.exists()){const l=i.data()[a]||0;await nn(s,{[a]:l+1,updatedAt:ft.fromDate(new Date)})}}catch(s){console.error(`Error incrementing ${n}:`,s)}}static getDefaultSegments(){return[{id:"1",label:"10% Off",value:"10% discount on your next order",color:"#FF6B6B",probability:20,rewardType:"discount_percentage",rewardValue:10},{id:"2",label:"Free Drink",value:"Free beverage with any meal",color:"#4ECDC4",probability:15,rewardType:"custom",customMessage:"Free drink with any meal purchase"},{id:"3",label:"5% Off",value:"5% discount on your order",color:"#45B7D1",probability:25,rewardType:"discount_percentage",rewardValue:5},{id:"4",label:"$5 Off",value:"$5 discount on orders over $25",color:"#96CEB4",probability:15,rewardType:"discount_fixed",rewardValue:5},{id:"5",label:"Better Luck",value:"Try again tomorrow!",color:"#FFEAA7",probability:10,rewardType:"custom",customMessage:"Better luck next time! Come back tomorrow."},{id:"6",label:"15% Off",value:"15% discount on your next order",color:"#DDA0DD",probability:8,rewardType:"discount_percentage",rewardValue:15},{id:"7",label:"Free Appetizer",value:"Free appetizer with main course",color:"#98D8C8",probability:5,rewardType:"custom",customMessage:"Free appetizer with any main course order"},{id:"8",label:"20% Off",value:"20% discount - Lucky you!",color:"#F7DC6F",probability:2,rewardType:"discount_percentage",rewardValue:20}]}}class rd{static async integrateSpinReward(e,r,n,s,a){var i,l,c,u;try{console.log(" Starting gamification integration...",{restaurantId:e,userId:r.id,userName:r.name,userPhone:r.phone,couponCode:s,spinResult:n.label});const d=await this.addUserToCRM(e,r);if(!d.success)return console.error(" CRM integration failed:",d.error),{success:!1,error:`Failed to add user to CRM: ${d.error}`};console.log(" User added to CRM successfully:",{customerId:(i=d.customer)==null?void 0:i.id,customerName:(l=d.customer)==null?void 0:l.name,customerPhone:(c=d.customer)==null?void 0:c.phone,preferences:(u=d.customer)==null?void 0:u.preferences});const f=await this.createGamificationCoupon(e,r,n,s,a);return f.success?(console.log(" Coupon created successfully:",{couponCode:s,type:n.rewardType,value:n.value}),console.log(" Integration completed successfully!"),console.log(" Next steps: Check CRM customers tab and coupon dashboard"),{success:!0,message:"Reward integrated successfully into CRM and coupon system"}):(console.error(" Coupon creation failed:",f.error),{success:!1,error:f.error||"Failed to create coupon"})}catch(d){return console.error("Error integrating spin reward:",d),{success:!1,error:"Failed to integrate reward"}}}static async addUserToCRM(e,r){var n,s;try{console.log(" Checking if customer exists in CRM...",{restaurantId:e,userPhone:r.phone,userName:r.name});const a=await ra.searchCustomers(e,r.phone);console.log(" Customer search result:",{success:a.success,found:((n=a.data)==null?void 0:n.length)||0,error:a.error});let i;if(a.success&&a.data&&a.data.length>0){const l=a.data[0],c={name:r.name,email:r.email||l.email,lastVisit:new Date,preferences:[...l.preferences||[],"gamification_user"]},u=await ra.updateCustomer(l.id,e,c);if(u.success&&u.data)i=u.data;else return{success:!1,error:"Failed to update existing customer"}}else{console.log(" Creating new customer in CRM...");const l={name:r.name,email:r.email||"",phone:r.phone,address:"",preferences:["gamification_user"],totalSpent:0,visitCount:1,lastVisit:new Date};console.log(" New customer data:",l);const c=await ra.createCustomer(e,l);if(console.log(" Customer creation result:",{success:c.success,customerId:(s=c.data)==null?void 0:s.id,error:c.error}),c.success&&c.data)i=c.data;else return{success:!1,error:"Failed to create customer"}}return{success:!0,customer:i}}catch(a){return console.error("Error adding user to CRM:",a),{success:!1,error:"Failed to add user to CRM"}}}static async createGamificationCoupon(e,r,n,s,a){try{const i=this.createCouponFromSpinResult(n,s,r,a),l=await Ui.createCoupon(e,i);return{success:l.success,error:l.error}}catch(i){return console.error("Error creating gamification coupon:",i),{success:!1,error:"Failed to create coupon"}}}static createCouponFromSpinResult(e,r,n,s){const a=new Date,i=new Date;i.setDate(i.getDate()+30);const l={name:`${e.label} - Spin Wheel Reward`,description:`Reward from spin wheel game: ${e.value}. Winner: ${n.name} (${n.phone})`,code:r.toUpperCase(),status:"active",validity:{startDate:a,endDate:i,usageLimit:1,perCustomerLimit:1,validDays:["monday","tuesday","wednesday","thursday","friday","saturday","sunday"]},targeting:{customerSegments:["all"],minOrderValue:0,applicableCategories:[],excludedCategories:[],paymentMethodRestriction:"all"},metadata:{source:"gamification_spin_wheel",spinRecordId:s.id,userId:n.id,userName:n.name,userPhone:n.phone,spinDate:s.spinDate,segmentId:e.id,segmentColor:e.color}};switch(e.rewardType){case"discount_percentage":const c=e.value.match(/(\d+)%/),u=c?parseInt(c[1]):10;return{...l,type:"percentage_discount",config:{percentage:u,maxDiscountAmount:1e3}};case"free_item":return{...l,type:"free_item",config:{freeItemName:e.label,freeItemValue:e.value}};case"points":const d=e.value.match(/(\d+)/),f=d?parseInt(d[1]):50;return{...l,type:"fixed_amount",config:{discountAmount:Math.min(f,500)}};case"custom":default:return{...l,type:"percentage_discount",config:{percentage:10,maxDiscountAmount:500}}}}static async searchGamificationCoupons(e,r){var n;try{console.log(" Searching for gamification coupons...",{restaurantId:e,searchTerm:r});const s=await Ui.getCouponsForRestaurant(e);if(console.log(" All coupons fetch result:",{success:s.success,totalCoupons:((n=s.data)==null?void 0:n.length)||0,error:s.error}),!s.success||!s.data)return{success:!1,error:"Failed to fetch coupons"};console.log(" All coupons in system:",s.data.map(i=>{var l;return{id:i.id,code:i.code,name:i.name,source:(l=i.metadata)==null?void 0:l.source,hasMetadata:!!i.metadata,metadataKeys:i.metadata?Object.keys(i.metadata):[]}}));const a=s.data.filter(i=>{var d,f,m,h,g,p,v,b,w;const l=((d=i.metadata)==null?void 0:d.source)==="gamification_spin_wheel";if(console.log(` Checking coupon ${i.code}:`,{hasMetadata:!!i.metadata,source:(f=i.metadata)==null?void 0:f.source,isGamificationCoupon:l}),!l)return!1;if(!r.trim())return!0;const c=r.toLowerCase(),u=i.code.toLowerCase().includes(c)||((h=(m=i.metadata)==null?void 0:m.userName)==null?void 0:h.toLowerCase().includes(c))||((p=(g=i.metadata)==null?void 0:g.userPhone)==null?void 0:p.includes(r))||i.name.toLowerCase().includes(c);return console.log(` Search match for ${i.code}:`,{searchTerm:c,code:i.code.toLowerCase(),userName:(b=(v=i.metadata)==null?void 0:v.userName)==null?void 0:b.toLowerCase(),userPhone:(w=i.metadata)==null?void 0:w.userPhone,name:i.name.toLowerCase(),matches:u}),u});return console.log(" Gamification coupons found:",{total:a.length,coupons:a.map(i=>{var l,c;return{id:i.id,code:i.code,name:i.name,userName:(l=i.metadata)==null?void 0:l.userName,userPhone:(c=i.metadata)==null?void 0:c.userPhone}})}),{success:!0,data:a}}catch(s){return console.error("Error searching gamification coupons:",s),{success:!1,error:"Failed to search coupons"}}}static async redeemGamificationCoupon(e,r,n){var s;try{const a=await Ui.getCouponsForRestaurant(e);if(!a.success||!a.data)return{success:!1,error:"Failed to fetch coupons"};const i=a.data.find(c=>{var u;return c.code.toUpperCase()===r.toUpperCase()&&((u=c.metadata)==null?void 0:u.source)==="gamification_spin_wheel"});if(!i)return{success:!1,error:"Coupon not found"};if(i.usageCount>=1)return{success:!1,error:"Coupon already redeemed"};const l=await Ui.markCouponAsUsed(i.id,e);return l.success?(n&&await Ui.recordCouponUsage(i.id,e,n,this.calculateDiscountAmount(i),0,0,(s=i.metadata)==null?void 0:s.userId),{success:!0,message:`Coupon redeemed successfully! ${i.name}`}):l}catch(a){return console.error("Error redeeming gamification coupon:",a),{success:!1,error:"Failed to redeem coupon"}}}static calculateDiscountAmount(e){var r,n;switch(e.type){case"percentage_discount":return((r=e.config)==null?void 0:r.percentage)||0;case"fixed_amount":return((n=e.config)==null?void 0:n.discountAmount)||0;default:return 0}}static async getGamificationCouponStats(e){try{const r=await Ui.getCouponsForRestaurant(e);if(!r.success||!r.data)return{success:!1,error:"Failed to fetch coupons"};const n=r.data.filter(a=>{var i;return((i=a.metadata)==null?void 0:i.source)==="gamification_spin_wheel"});return{success:!0,data:{totalCoupons:n.length,redeemedCoupons:n.filter(a=>a.usageCount>0).length,activeCoupons:n.filter(a=>a.status==="active"&&a.usageCount===0).length,redemptionRate:n.length>0?n.filter(a=>a.usageCount>0).length/n.length*100:0,totalDiscountGiven:n.filter(a=>a.usageCount>0).reduce((a,i)=>a+this.calculateDiscountAmount(i),0)}}}catch(r){return console.error("Error fetching gamification coupon stats:",r),{success:!1,error:"Failed to fetch stats"}}}static async getCustomerLoyaltyInfo(e,r){try{const n=await ra.searchCustomers(e,r);if(!n.success||!n.data||n.data.length===0)return{success:!1,error:"Customer not found in CRM"};const s=n.data[0],{LoyaltyPointsService:a}=await Bi(async()=>{const{LoyaltyPointsService:l}=await Promise.resolve().then(()=>t7);return{LoyaltyPointsService:l}},void 0),i=await a.getCustomerLoyaltyInfo(e,s.id);return i.success?{success:!0,data:{loyaltyInfo:i.data,customer:s}}:{success:!1,error:i.error||"Failed to get loyalty info"}}catch(n){return console.error("Error getting customer loyalty info:",n),{success:!1,error:"Failed to get loyalty information"}}}static async getCustomerGamificationHistory(e,r){var n;try{console.log(" Fetching gamification history for customer:",{restaurantId:e,customerPhone:r});const s=await Ja.getCustomerSpinsFromRestaurant(e,r);console.log(" Customer spins result:",{success:s.success,spinsCount:((n=s.data)==null?void 0:n.length)||0,error:s.error});const a=s.success&&s.data?s.data:[],i=await Ui.getCouponsForRestaurant(e);let l=[];i.success&&i.data&&(l=i.data.filter(m=>{var h,g;return((h=m.metadata)==null?void 0:h.source)==="gamification_spin_wheel"&&((g=m.metadata)==null?void 0:g.userPhone)===r})),console.log(" Customer coupons found:",{total:l.length,redeemed:l.filter(m=>m.usageCount>0).length});const c=l.reduce((m,h)=>m+this.calculateDiscountAmount(h),0),u=l.filter(m=>m.usageCount>0).reduce((m,h)=>m+this.calculateDiscountAmount(h),0),d=a.map(m=>new Date(m.spinDate)).sort((m,h)=>m.getTime()-h.getTime()),f={totalSpins:a.length,totalCoupons:l.length,redeemedCoupons:l.filter(m=>m.usageCount>0).length,totalDiscountEarned:c,totalDiscountUsed:u,firstSpinDate:d.length>0?d[0]:void 0,lastSpinDate:d.length>0?d[d.length-1]:void 0};return console.log(" Gamification stats for customer:",f),{success:!0,data:{spins:a.map(m=>({...m,spinDate:new Date(m.spinDate),restaurantName:"Current Restaurant"})),coupons:l.map(m=>({...m,createdAt:new Date(m.createdAt),validity:{...m.validity,startDate:new Date(m.validity.startDate),endDate:new Date(m.validity.endDate)}})),stats:f}}}catch(s){return console.error("Error fetching customer gamification history:",s),{success:!1,error:"Failed to fetch gamification history"}}}}function nce(){var q,te,oe;const{restaurant:t}=ya(),[e,r]=X.useState([]),[n,s]=X.useState([]),[a,i]=X.useState(null),[l,c]=X.useState([]),[u,d]=X.useState(null),[f,m]=X.useState(null),[h,g]=X.useState(!1),[p,v]=X.useState(""),[b,w]=X.useState(!0),[N,j]=X.useState(!1),[F,U]=X.useState(!1),[A,S]=X.useState(!1),[k,M]=X.useState(!1),[I,E]=X.useState(!1),[D,G]=X.useState("lastVisit"),{register:Z,handleSubmit:ae,reset:de,setValue:se}=Hn();X.useEffect(()=>{t&&Y()},[t]),X.useEffect(()=>{ye()},[e,p,D]);const Y=async()=>{if(t)try{w(!0);const V=await ra.getCustomersForRestaurant(t.id);if(V.success&&V.data){const xe=V.data.sort((B,Ee)=>{const Me=B.createdAt?new Date(B.createdAt).getTime():0;return(Ee.createdAt?new Date(Ee.createdAt).getTime():0)-Me});r(xe)}}catch{fe.error("Failed to load customers")}finally{w(!1)}},ye=()=>{let V=[...e];if(p){const xe=p.toLowerCase();V=V.filter(B=>{var Ee,Me,Ie;return((Ee=B.name)==null?void 0:Ee.toLowerCase().includes(xe))||((Me=B.email)==null?void 0:Me.toLowerCase().includes(xe))||((Ie=B.phone)==null?void 0:Ie.includes(p))})}V.sort((xe,B)=>{switch(D){case"name":return(xe.name||"").localeCompare(B.name||"");case"visits":return B.visitCount-xe.visitCount;case"spent":return B.totalSpent-xe.totalSpent;case"lastVisit":const Ee=xe.lastVisit?new Date(xe.lastVisit).getTime():0;return(B.lastVisit?new Date(B.lastVisit).getTime():0)-Ee;default:return 0}}),s(V)},re=async V=>{if(t)try{M(!0);const xe={...V,preferences:V.preferences?V.preferences.split(",").map(Ee=>Ee.trim()):[]},B=await ra.createCustomer(t.id,xe);B.success?(fe.success("Customer created successfully"),j(!1),de(),await Y()):fe.error(B.error||"Failed to create customer")}catch{fe.error("Failed to create customer")}finally{M(!1)}},C=V=>{var xe;i(V),se("name",V.name||""),se("email",V.email||""),se("phone",V.phone||""),se("address",V.address||""),se("preferences",((xe=V.preferences)==null?void 0:xe.join(", "))||""),U(!0)},O=async V=>{if(!(!t||!a))try{E(!0);const xe={...V,preferences:V.preferences?V.preferences.split(",").map(Ee=>Ee.trim()):[]},B=await ra.updateCustomer(a.id,t.id,xe);B.success?(fe.success("Customer updated successfully"),U(!1),i(null),de(),await Y()):fe.error(B.error||"Failed to update customer")}catch{fe.error("Failed to update customer")}finally{E(!1)}},L=async V=>{if(!(!t||!confirm(`Are you sure you want to delete customer "${V.name||V.phone}"?`)))try{const xe=await ra.deleteCustomer(V.id,t.id);xe.success?(fe.success("Customer deleted successfully"),await Y()):fe.error(xe.error||"Failed to delete customer")}catch{fe.error("Failed to delete customer")}},H=async V=>{if(t)try{if(i(V),S(!0),V.orderHistory.length>0){const xe=await Za.getOrdersByIds(V.orderHistory,t.id);xe.success&&xe.data?c(xe.data):(console.error("Failed to load customer orders:",xe.error),c([]))}else c([]);if(V.phone){g(!0);try{const xe=await rd.getCustomerGamificationHistory(t.id,V.phone);xe.success&&xe.data?d(xe.data):(console.log("No gamification history found for customer:",xe.error),d(null));const B=await rd.getCustomerLoyaltyInfo(t.id,V.phone);B.success&&B.data?m(B.data):(console.log("No loyalty info found for customer:",B.error),m(null))}catch(xe){console.error("Error loading gamification data:",xe),d(null),m(null)}finally{g(!1)}}else d(null),m(null)}catch(xe){console.error("Error loading customer data:",xe),fe.error("Failed to load customer data"),c([]),d(null),m(null)}},K=()=>{const V=[["Name","Email","Phone","Address","Total Spent","Visit Count","Last Visit"].join(","),...n.map(Me=>[Me.name||"",Me.email||"",Me.phone||"",Me.address||"",Me.totalSpent.toString(),Me.visitCount.toString(),Me.lastVisit?new Date(Me.lastVisit).toLocaleDateString():""].join(","))].join(`
`),xe=new Blob([V],{type:"text/csv"}),B=window.URL.createObjectURL(xe),Ee=document.createElement("a");Ee.href=B,Ee.download=`customers-${new Date().toISOString().split("T")[0]}.csv`,Ee.click(),window.URL.revokeObjectURL(B)};return t?o.jsxs("div",{className:"min-h-screen",style:{background:"var(--color-background)"},children:[o.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[o.jsx("div",{className:"mb-8",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Customer Management"}),o.jsx("p",{className:"text-gray-600 mt-1",children:"Manage your customer database and relationships"})]}),o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsxs("button",{onClick:K,className:"btn btn-secondary",children:[o.jsx(ah,{className:"w-4 h-4 mr-2"}),"Export"]}),o.jsxs("button",{onClick:()=>j(!0),className:"btn btn-theme-primary",children:[o.jsx(bw,{className:"w-4 h-4 mr-2"}),"Add Customer"]})]})]})}),o.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 mb-6",children:o.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[o.jsxs("div",{className:"flex-1 relative",children:[o.jsx(Eo,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),o.jsx("input",{type:"text",placeholder:"Search customers by name, email, or phone...",value:p,onChange:V=>v(V.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(Wg,{className:"w-4 h-4 text-gray-600"}),o.jsxs("select",{value:D,onChange:V=>G(V.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[o.jsx("option",{value:"lastVisit",children:"Last Visit"}),o.jsx("option",{value:"name",children:"Name"}),o.jsx("option",{value:"visits",children:"Most Visits"}),o.jsx("option",{value:"spent",children:"Highest Spent"})]})]})]})}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-6",children:[o.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:o.jsx(ni,{className:"w-6 h-6 text-blue-600"})}),o.jsxs("div",{className:"ml-4",children:[o.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Customers"}),o.jsx("p",{className:"text-2xl font-bold text-gray-900",children:e.length})]})]})}),o.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:o.jsx(Yi,{className:"w-6 h-6 text-green-600"})}),o.jsxs("div",{className:"ml-4",children:[o.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Revenue"}),o.jsx("p",{className:"text-2xl font-bold text-gray-900",children:pt(e.reduce((V,xe)=>V+xe.totalSpent,0))})]})]})}),o.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:o.jsx(Gg,{className:"w-6 h-6 text-purple-600"})}),o.jsxs("div",{className:"ml-4",children:[o.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Avg Order Value"}),o.jsx("p",{className:"text-2xl font-bold text-gray-900",children:pt(e.length>0?e.reduce((V,xe)=>V+(xe.visitCount>0?xe.totalSpent/xe.visitCount:0),0)/e.length:0)})]})]})}),o.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"p-2 bg-orange-100 rounded-lg",children:o.jsx(X2,{className:"w-6 h-6 text-orange-600"})}),o.jsxs("div",{className:"ml-4",children:[o.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Repeat Customers"}),o.jsx("p",{className:"text-2xl font-bold text-gray-900",children:e.filter(V=>V.visitCount>1).length})]})]})})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[o.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:o.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:["Customers (",n.length,")"]})}),b?o.jsxs("div",{className:"text-center py-12",children:[o.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mb-4"}),o.jsx("p",{className:"text-gray-600",children:"Loading customers..."})]}):n.length===0?o.jsxs("div",{className:"text-center py-12",children:[o.jsx(ni,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),o.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No customers found"}),o.jsx("p",{className:"text-gray-600 mb-4",children:p?"Try adjusting your search terms":"Get started by adding your first customer"}),!p&&o.jsxs("button",{onClick:()=>j(!0),className:"btn btn-theme-primary",children:[o.jsx(bw,{className:"w-4 h-4 mr-2"}),"Add First Customer"]})]}):o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Customer"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contact"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Visits"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total Spent"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Last Visit"}),o.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:n.map(V=>o.jsxs("tr",{className:"hover:bg-gray-50",children:[o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxs("div",{children:[o.jsx("div",{className:"text-sm font-medium text-gray-900",children:V.name||"N/A"}),V.address&&o.jsxs("div",{className:"text-sm text-gray-500 flex items-center",children:[o.jsx(vd,{className:"w-3 h-3 mr-1"}),V.address]})]})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxs("div",{className:"space-y-1",children:[V.phone&&o.jsxs("div",{className:"text-sm text-gray-900 flex items-center",children:[o.jsx(Lx,{className:"w-3 h-3 mr-1"}),V.phone]}),V.email&&o.jsxs("div",{className:"text-sm text-gray-500 flex items-center",children:[o.jsx(Z2,{className:"w-3 h-3 mr-1"}),V.email]})]})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("div",{className:"text-sm font-medium text-gray-900",children:V.visitCount})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("div",{className:"text-sm font-medium text-gray-900",children:pt(V.totalSpent)})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("div",{className:"text-sm text-gray-500",children:V.lastVisit?new Date(V.lastVisit).toLocaleDateString():"Never"})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:o.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[o.jsx("button",{onClick:()=>H(V),className:"p-2 text-gray-400 hover:text-blue-600 rounded hover:bg-blue-50",title:"View Orders",children:o.jsx(Ci,{className:"w-4 h-4"})}),o.jsx("button",{onClick:()=>C(V),className:"p-2 text-gray-400 hover:text-blue-600 rounded hover:bg-blue-50",title:"Edit Customer",children:o.jsx(Hg,{className:"w-4 h-4"})}),o.jsx("button",{onClick:()=>L(V),className:"p-2 text-gray-400 hover:text-red-600 rounded hover:bg-red-50",title:"Delete Customer",children:o.jsx(ga,{className:"w-4 h-4"})})]})})]},V.id))})]})})]})]}),N&&o.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:o.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[o.jsx("div",{className:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75",onClick:()=>j(!1)}),o.jsxs("div",{className:"inline-block w-full max-w-md my-8 overflow-hidden text-left align-middle transition-all transform bg-white shadow-xl rounded-2xl",children:[o.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Add New Customer"}),o.jsx("button",{onClick:()=>j(!1),className:"text-gray-400 hover:text-gray-600",children:o.jsx(Zn,{className:"w-5 h-5"})})]})}),o.jsxs("form",{onSubmit:ae(re),className:"p-6 space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Name *"}),o.jsx("input",{...Z("name",{required:"Name is required"}),type:"text",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Customer name"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone *"}),o.jsx("input",{...Z("phone",{required:"Phone is required"}),type:"tel",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Phone number"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),o.jsx("input",{...Z("email"),type:"email",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Email address"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Address"}),o.jsx("textarea",{...Z("address"),rows:2,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Customer address"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Preferences"}),o.jsx("input",{...Z("preferences"),type:"text",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Dietary preferences, separated by commas"})]}),o.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[o.jsx("button",{type:"button",onClick:()=>j(!1),className:"btn btn-secondary",children:"Cancel"}),o.jsx("button",{type:"submit",disabled:k,className:"btn btn-theme-primary",children:k?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Creating..."]}):o.jsxs(o.Fragment,{children:[o.jsx(bw,{className:"w-4 h-4 mr-2"}),"Create Customer"]})})]})]})]})]})}),F&&a&&o.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:o.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[o.jsx("div",{className:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75",onClick:()=>U(!1)}),o.jsxs("div",{className:"inline-block w-full max-w-md my-8 overflow-hidden text-left align-middle transition-all transform bg-white shadow-xl rounded-2xl",children:[o.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Edit Customer"}),o.jsx("button",{onClick:()=>U(!1),className:"text-gray-400 hover:text-gray-600",children:o.jsx(Zn,{className:"w-5 h-5"})})]})}),o.jsxs("form",{onSubmit:ae(O),className:"p-6 space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Name *"}),o.jsx("input",{...Z("name",{required:"Name is required"}),type:"text",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Customer name"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone *"}),o.jsx("input",{...Z("phone",{required:"Phone is required"}),type:"tel",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Phone number"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),o.jsx("input",{...Z("email"),type:"email",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Email address"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Address"}),o.jsx("textarea",{...Z("address"),rows:2,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Customer address"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Preferences"}),o.jsx("input",{...Z("preferences"),type:"text",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Dietary preferences, separated by commas"})]}),o.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[o.jsx("button",{type:"button",onClick:()=>U(!1),className:"btn btn-secondary",children:"Cancel"}),o.jsx("button",{type:"submit",disabled:I,className:"btn btn-theme-primary",children:I?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Updating..."]}):o.jsxs(o.Fragment,{children:[o.jsx(Hg,{className:"w-4 h-4 mr-2"}),"Update Customer"]})})]})]})]})]})}),A&&a&&o.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:o.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[o.jsx("div",{className:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75",onClick:()=>{S(!1),d(null),m(null),i(null)}}),o.jsxs("div",{className:"inline-block w-full max-w-4xl my-8 overflow-hidden text-left align-middle transition-all transform bg-white shadow-xl rounded-2xl",children:[o.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:[a.name||"Customer"," - Order History"]}),o.jsxs("p",{className:"text-sm text-gray-600",children:[a.visitCount," visits  ",pt(a.totalSpent)," total spent"]})]}),o.jsx("button",{onClick:()=>{S(!1),d(null),m(null),i(null)},className:"text-gray-400 hover:text-gray-600",children:o.jsx(Zn,{className:"w-5 h-5"})})]})}),o.jsxs("div",{className:"p-6",children:[f&&o.jsxs("div",{className:"mb-8",children:[o.jsxs("h4",{className:"text-lg font-medium text-gray-900 mb-4 flex items-center",children:[o.jsx(kp,{className:"w-5 h-5 mr-2 text-purple-600"}),"Loyalty Status & Points"]}),o.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-blue-50 p-6 rounded-lg border border-purple-200",children:[o.jsxs("div",{className:"flex items-center justify-between mb-6",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:"text-3xl",children:((q=f.loyaltyInfo.currentThreshold)==null?void 0:q.badgeIcon)||""}),o.jsxs("div",{children:[o.jsx("h5",{className:"text-xl font-bold text-gray-900",children:((te=f.loyaltyInfo.currentThreshold)==null?void 0:te.name)||"Bronze Member"}),o.jsxs("p",{className:"text-gray-600",children:[f.loyaltyInfo.currentPoints," loyalty points"]})]})]}),o.jsxs("div",{className:"text-right",children:[o.jsx("div",{className:"text-sm text-gray-600",children:"Member since"}),o.jsx("div",{className:"font-medium text-gray-900",children:new Date(f.loyaltyInfo.memberSince).toLocaleDateString()})]})]}),f.loyaltyInfo.nextThreshold&&o.jsxs("div",{className:"mb-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsxs("span",{className:"text-sm font-medium text-gray-700",children:["Progress to ",f.loyaltyInfo.nextThreshold.name]}),o.jsxs("span",{className:"text-sm font-medium text-gray-700",children:[f.loyaltyInfo.pointsToNext," points to go"]})]}),o.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:o.jsx("div",{className:"bg-gradient-to-r from-purple-500 to-blue-500 h-3 rounded-full transition-all duration-300",style:{width:`${f.loyaltyInfo.progressToNext}%`}})}),o.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:[f.loyaltyInfo.progressToNext.toFixed(1),"% complete"]})]}),((oe=f.loyaltyInfo.currentThreshold)==null?void 0:oe.benefits)&&o.jsxs("div",{className:"mb-4",children:[o.jsx("h6",{className:"text-sm font-medium text-gray-700 mb-2",children:"Current Level Benefits:"}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:f.loyaltyInfo.currentThreshold.benefits.map((V,xe)=>o.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[o.jsx(Ai,{className:"w-4 h-4 text-green-500 mr-2 flex-shrink-0"}),V]},xe))})]}),o.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4 mt-4",children:[o.jsxs("div",{className:"text-center p-3 bg-white rounded-lg",children:[o.jsx("div",{className:"text-2xl font-bold text-purple-600",children:f.loyaltyInfo.totalSpins}),o.jsx("div",{className:"text-xs text-gray-600",children:"Total Spins"})]}),o.jsxs("div",{className:"text-center p-3 bg-white rounded-lg",children:[o.jsx("div",{className:"text-2xl font-bold text-blue-600",children:f.loyaltyInfo.totalPointsEarned}),o.jsx("div",{className:"text-xs text-gray-600",children:"Points Earned"})]}),o.jsxs("div",{className:"text-center p-3 bg-white rounded-lg md:col-span-1 col-span-2",children:[o.jsx("div",{className:"text-2xl font-bold text-green-600",children:f.loyaltyInfo.currentPoints}),o.jsx("div",{className:"text-xs text-gray-600",children:"Current Balance"})]})]}),f.loyaltyInfo.nextThreshold&&o.jsx("div",{className:"mt-4 p-3 bg-white rounded-lg border border-dashed border-purple-300",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("span",{className:"text-lg",children:f.loyaltyInfo.nextThreshold.badgeIcon}),o.jsxs("div",{children:[o.jsx("div",{className:"font-medium text-gray-900",children:f.loyaltyInfo.nextThreshold.name}),o.jsxs("div",{className:"text-xs text-gray-600",children:["Unlock at ",f.loyaltyInfo.nextThreshold.pointsRequired," points"]})]})]}),o.jsx("div",{className:"text-xs text-gray-500",children:"Next Level"})]})})]})]}),o.jsxs("div",{className:"mb-8",children:[o.jsxs("h4",{className:"text-lg font-medium text-gray-900 mb-4 flex items-center",children:[o.jsx(Ia,{className:"w-5 h-5 mr-2 text-purple-600"}),"Gamification Activity"]}),h?o.jsxs("div",{className:"flex items-center justify-center py-6",children:[o.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-purple-600 mr-2"}),o.jsx("span",{className:"text-gray-600",children:"Loading gamification history..."})]}):u?o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[o.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-3",children:[o.jsx("div",{className:"text-2xl font-bold text-purple-600",children:u.stats.totalSpins}),o.jsx("div",{className:"text-sm text-purple-600",children:"Total Spins"})]}),o.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:[o.jsx("div",{className:"text-2xl font-bold text-green-600",children:u.stats.totalCoupons}),o.jsx("div",{className:"text-sm text-green-600",children:"Coupons Earned"})]}),o.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:[o.jsx("div",{className:"text-2xl font-bold text-blue-600",children:u.stats.redeemedCoupons}),o.jsx("div",{className:"text-sm text-blue-600",children:"Coupons Used"})]}),o.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-3",children:[o.jsx("div",{className:"text-2xl font-bold text-orange-600",children:pt(u.stats.totalDiscountEarned)}),o.jsx("div",{className:"text-sm text-orange-600",children:"Total Rewards"})]})]}),u.spins.length>0&&o.jsxs("div",{children:[o.jsx("h5",{className:"font-medium text-gray-900 mb-3",children:"Recent Spins"}),o.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:u.spins.slice(0,5).map((V,xe)=>o.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:"text-2xl",children:V.resultMessage.includes("luck")?"":V.resultMessage.includes("%")?"":V.resultMessage.includes("Free")?"":""}),o.jsxs("div",{children:[o.jsx("div",{className:"font-medium text-gray-900",children:V.resultMessage}),o.jsxs("div",{className:"text-sm text-gray-500",children:[new Date(V.spinDate).toLocaleDateString()," at ",new Date(V.spinDate).toLocaleTimeString()]})]})]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[V.isClaimed&&V.couponCode&&o.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full",children:"Claimed"}),V.isRedeemed&&o.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full",children:"Redeemed"})]})]},V.id||xe))})]}),u.coupons.length>0&&o.jsxs("div",{children:[o.jsx("h5",{className:"font-medium text-gray-900 mb-3",children:"Gamification Coupons"}),o.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:u.coupons.map((V,xe)=>o.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[o.jsxs("div",{children:[o.jsx("div",{className:"font-medium text-gray-900",children:V.name}),o.jsxs("div",{className:"text-sm text-gray-500",children:["Code: ",o.jsx("span",{className:"font-mono font-bold",children:V.code}),"  Expires: ",new Date(V.validity.endDate).toLocaleDateString()]})]}),o.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${V.usageCount>0?"bg-red-100 text-red-800":"bg-green-100 text-green-800"}`,children:V.usageCount>0?"Used":"Available"})]},V.id||xe))})]}),u.stats.firstSpinDate&&o.jsxs("div",{className:"text-sm text-gray-600 p-3 bg-gray-50 rounded-lg",children:[o.jsxs("div",{children:["First spin: ",new Date(u.stats.firstSpinDate).toLocaleDateString()]}),u.stats.lastSpinDate&&o.jsxs("div",{children:["Last spin: ",new Date(u.stats.lastSpinDate).toLocaleDateString()]})]})]}):o.jsxs("div",{className:"text-center py-8 bg-gray-50 rounded-lg",children:[o.jsx(Ia,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),o.jsx("h5",{className:"text-lg font-medium text-gray-600 mb-2",children:"No Gamification Activity"}),o.jsx("p",{className:"text-gray-500",children:"This customer hasn't participated in any spin wheel games yet."})]})]}),l.length===0?o.jsxs("div",{className:"text-center py-12",children:[o.jsx(Gg,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),o.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Order History"}),o.jsx("p",{className:"text-gray-600",children:"This customer hasn't placed any orders yet."})]}):o.jsxs("div",{className:"space-y-4",children:[o.jsxs("h4",{className:"text-lg font-medium text-gray-900 mb-4",children:["Order History (",l.length," orders)"]}),o.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:l.map(V=>o.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsxs("div",{children:[o.jsxs("h5",{className:"font-medium text-gray-900",children:["Order #",V.orderNumber]}),o.jsxs("p",{className:"text-sm text-gray-500",children:[new Date(V.createdAt).toLocaleDateString()," at"," ",new Date(V.createdAt).toLocaleTimeString()]})]}),o.jsxs("div",{className:"text-right",children:[o.jsx("div",{className:"text-lg font-medium text-gray-900",children:pt(V.total)}),o.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${V.status==="completed"?"bg-green-100 text-green-800":V.status==="cancelled"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:V.status})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[o.jsx("span",{className:"font-medium mr-2",children:"Table:"}),V.tableId||"N/A"]}),o.jsxs("div",{className:"border-t pt-2",children:[o.jsx("h6",{className:"text-sm font-medium text-gray-700 mb-1",children:"Items:"}),o.jsx("div",{className:"space-y-1",children:V.items.map((xe,B)=>o.jsxs("div",{className:"flex justify-between text-sm",children:[o.jsxs("span",{children:[xe.quantity,"x ",xe.name]}),o.jsx("span",{className:"text-gray-600",children:pt(xe.total)})]},B))})]}),o.jsxs("div",{className:"border-t pt-2 space-y-1",children:[o.jsxs("div",{className:"flex justify-between text-sm",children:[o.jsx("span",{children:"Subtotal:"}),o.jsx("span",{children:pt(V.subtotal)})]}),o.jsxs("div",{className:"flex justify-between text-sm",children:[o.jsx("span",{children:"Tax:"}),o.jsx("span",{children:pt(V.tax)})]}),V.discount>0&&o.jsxs("div",{className:"flex justify-between text-sm text-green-600",children:[o.jsx("span",{children:"Discount:"}),o.jsxs("span",{children:["-",pt(V.discount)]})]}),o.jsxs("div",{className:"flex justify-between font-medium",children:[o.jsx("span",{children:"Total:"}),o.jsx("span",{children:pt(V.total)})]})]}),V.notes&&o.jsxs("div",{className:"border-t pt-2",children:[o.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Notes:"}),o.jsx("p",{className:"text-sm text-gray-600 mt-1",children:V.notes})]})]})]},V.id))})]})]})]})]})})]}):o.jsx("div",{className:"min-h-screen flex items-center justify-center",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),o.jsx("p",{className:"text-gray-600",children:"Loading..."})]})})}function sce(){const{restaurant:t}=ya(),{user:e}=Xc(),[r,n]=X.useState(!1),[s,a]=X.useState(!1),[i,l]=X.useState(!1),[c,u]=X.useState([]),[d,f]=X.useState(!0),[m,h]=X.useState(""),[g,p]=X.useState([]),[v,b]=X.useState(!1),[w,N]=X.useState(!1),[j,F]=X.useState(null),[U,A]=X.useState({name:"",description:"",code:"",type:"percentage_discount",value:0,startDate:"",endDate:"",usageLimit:"",perCustomerLimit:"",validDays:[],validHours:{start:"00:00",end:"23:59"},customerSegments:[],minimumOrderValue:"",applicableCategories:[],excludedCategories:[],paymentMethods:"all",buyQuantity:2,getQuantity:1,buyCategories:[],getCategories:[],getDiscount:100,terms:""}),S=["monday","tuesday","wednesday","thursday","friday","saturday","sunday"];X.useEffect(()=>{(async()=>{if(!(t!=null&&t.id)){console.log("No restaurant ID available");return}try{console.log("Fetching coupons for restaurant:",t.id),f(!0);const Z=await Ui.getCouponsForRestaurant(t.id);console.log("Fetch coupons response:",Z),Z.success&&Z.data?(console.log("Found coupons:",Z.data),u(Z.data)):console.error("Failed to fetch coupons:",Z.error)}catch(Z){console.error("Error fetching coupons:",Z),fe.error("Failed to load coupons")}finally{f(!1)}})()},[t==null?void 0:t.id]);const k=async()=>{if(t!=null&&t.id){b(!0);try{const G=await rd.searchGamificationCoupons(t.id,m);G.success&&G.data?(p(G.data),G.data.length===0&&m&&fe.success("No coupons found")):(fe.error(G.error||"Failed to search coupons"),p([]))}catch(G){console.error("Error searching coupons:",G),fe.error("Failed to search coupons"),p([])}finally{b(!1)}}},M=async G=>{if(t!=null&&t.id){F(G);try{const Z=await rd.redeemGamificationCoupon(t.id,G);Z.success?(fe.success(Z.message||"Coupon redeemed successfully!"),k()):fe.error(Z.error||"Failed to redeem coupon")}catch(Z){console.error("Error redeeming coupon:",Z),fe.error("Failed to redeem coupon")}finally{F(null)}}},I=(G,Z)=>{A(ae=>({...ae,[G]:Z}))},E=()=>{const G="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let Z="";for(let ae=0;ae<8;ae++)Z+=G.charAt(Math.floor(Math.random()*G.length));A(ae=>({...ae,code:Z}))},D=async G=>{if(G.preventDefault(),!!(t!=null&&t.id)){l(!0);try{if(!U.name||!U.description||!U.code){fe.error("Please fill in all required fields");return}const Z={restaurantId:t.id,name:U.name,description:U.description,code:U.code,type:U.type,status:"active",validity:{startDate:U.startDate?new Date(U.startDate):new Date,endDate:U.endDate?new Date(U.endDate):new Date(Date.now()+30*24*60*60*1e3),validDays:U.validDays.length>0?U.validDays:S,...U.usageLimit&&{usageLimit:parseInt(U.usageLimit)},...U.perCustomerLimit&&{perCustomerLimit:parseInt(U.perCustomerLimit)}},targeting:{customerSegments:["all"],...U.minimumOrderValue&&{minOrderValue:parseFloat(U.minimumOrderValue)},applicableMenuItems:[],excludedMenuItems:[],applicableCategories:U.applicableCategories,excludedCategories:U.excludedCategories,paymentMethodRestriction:U.paymentMethods},config:U.type==="percentage_discount"?{percentage:U.value}:U.type==="fixed_amount"?{discountAmount:U.value,...U.minimumOrderValue&&{minimumOrderValue:parseFloat(U.minimumOrderValue)}}:U.type==="buy_x_get_y"?{buyXGetY:{buyQuantity:U.buyQuantity,getQuantity:U.getQuantity,getDiscountPercentage:U.getDiscount}}:{},termsAndConditions:U.terms||"",createdBy:"admin"};console.log("Creating coupon with data:",Z),console.log("Restaurant ID:",t.id);const ae=await Ui.createCoupon(t.id,Z);if(console.log("Create coupon response:",ae),ae.success&&ae.data)u(de=>[ae.data,...de]),fe.success(`Coupon "${U.name}" created successfully!`);else throw console.error("Failed to create coupon:",ae.error),new Error(ae.error||"Failed to create coupon");A({name:"",description:"",code:"",type:"percentage_discount",value:0,startDate:"",endDate:"",usageLimit:"",perCustomerLimit:"",validDays:[],validHours:{start:"00:00",end:"23:59"},customerSegments:[],minimumOrderValue:"",applicableCategories:[],excludedCategories:[],paymentMethods:"all",buyQuantity:2,getQuantity:1,buyCategories:[],getCategories:[],getDiscount:100,terms:""}),a(!1),n(!1)}catch(Z){console.error("Error creating coupon:",Z),fe.error("Failed to create coupon")}finally{l(!1)}}};return t?o.jsx("div",{className:"min-h-screen",style:{background:"var(--color-background)"},children:o.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[o.jsx("div",{className:"mb-8",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center",children:[o.jsx(Ia,{className:"w-8 h-8 mr-3 text-pink-600"}),"Coupon Dashboard"]}),o.jsx("p",{className:"text-gray-600 mt-1",children:"Manage your restaurant's promotional campaigns and track performance"})]}),o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsxs("button",{className:"btn btn-outline flex items-center",onClick:()=>N(!w),children:[o.jsx(Qh,{className:"w-4 h-4 mr-2"}),w?"Hide":"Show"," Spin Wheel Coupons"]}),o.jsxs("button",{className:"btn btn-outline flex items-center",onClick:()=>fe.success("Export functionality coming soon!"),children:[o.jsx(ah,{className:"w-4 h-4 mr-2"}),"Export"]}),o.jsxs("button",{className:"btn btn-theme-primary flex items-center",onClick:()=>n(!0),children:[o.jsx(Wn,{className:"w-4 h-4 mr-2"}),"Create Coupon"]})]})]})}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-6 mb-8",children:[o.jsx("div",{className:"card p-6",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Coupons"}),o.jsx("p",{className:"text-2xl font-bold text-gray-900",children:c.length})]}),o.jsx("div",{className:"w-12 h-12 bg-blue-50 rounded-lg flex items-center justify-center",children:o.jsx(Ia,{className:"w-6 h-6 text-blue-600"})})]})}),o.jsx("div",{className:"card p-6",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Active Coupons"}),o.jsx("p",{className:"text-2xl font-bold text-gray-900",children:c.filter(G=>G.status==="active").length})]}),o.jsx("div",{className:"w-12 h-12 bg-green-50 rounded-lg flex items-center justify-center",children:o.jsx(Ai,{className:"w-6 h-6 text-green-600"})})]})}),o.jsx("div",{className:"card p-6",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Usage"}),o.jsx("p",{className:"text-2xl font-bold text-gray-900",children:c.reduce((G,Z)=>G+Z.usageCount,0)})]}),o.jsx("div",{className:"w-12 h-12 bg-purple-50 rounded-lg flex items-center justify-center",children:o.jsx(ni,{className:"w-6 h-6 text-purple-600"})})]})}),o.jsx("div",{className:"card p-6",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Expired"}),o.jsx("p",{className:"text-2xl font-bold text-gray-900",children:c.filter(G=>G.status==="expired").length})]}),o.jsx("div",{className:"w-12 h-12 bg-red-50 rounded-lg flex items-center justify-center",children:o.jsx(Ad,{className:"w-6 h-6 text-red-600"})})]})}),o.jsx("div",{className:"card p-6",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Savings"}),o.jsx("p",{className:"text-2xl font-bold text-gray-900",children:"0"})]}),o.jsx("div",{className:"w-12 h-12 bg-orange-50 rounded-lg flex items-center justify-center",children:o.jsx(Yi,{className:"w-6 h-6 text-orange-600"})})]})}),o.jsx("div",{className:"card p-6",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Draft Coupons"}),o.jsx("p",{className:"text-2xl font-bold text-gray-900",children:c.filter(G=>G.status==="draft").length})]}),o.jsx("div",{className:"w-12 h-12 bg-teal-50 rounded-lg flex items-center justify-center",children:o.jsx(_i,{className:"w-6 h-6 text-teal-600"})})]})})]}),w&&o.jsxs("div",{className:"card p-6 mb-8",children:[o.jsx("div",{className:"flex items-center justify-between mb-6",children:o.jsxs("div",{children:[o.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[o.jsx(Qh,{className:"w-5 h-5 mr-2 text-purple-600"}),"Spin Wheel Coupons"]}),o.jsx("p",{className:"text-gray-600 text-sm",children:"Search and redeem coupons generated from spin wheel game"})]})}),o.jsxs("div",{className:"flex items-center space-x-4 mb-6",children:[o.jsx("div",{className:"flex-1 relative",children:o.jsx("input",{type:"text",placeholder:"Search by coupon code, customer name, or phone...",value:m,onChange:G=>h(G.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500",onKeyPress:G=>G.key==="Enter"&&k()})}),o.jsx("button",{onClick:k,disabled:v,className:"btn btn-theme-primary flex items-center",children:v?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Searching..."]}):o.jsxs(o.Fragment,{children:[o.jsx(Qh,{className:"w-4 h-4 mr-2"}),"Search"]})}),o.jsx("button",{onClick:()=>{h(""),k()},disabled:v,className:"btn btn-outline flex items-center",children:"Show All"}),o.jsx("button",{onClick:async()=>{if(!(t!=null&&t.id))return;const G={name:"Test Spin Wheel Reward",description:"Test reward from spin wheel game: 10% off. Winner: Test User (1234567890)",code:"TEST"+Date.now().toString().slice(-4),type:"percentage_discount",status:"active",createdBy:(e==null?void 0:e.id)||"test-user",restaurantId:t.id,termsAndConditions:"Valid for one-time use only. Cannot be combined with other offers.",validity:{startDate:new Date,endDate:new Date(Date.now()+30*24*60*60*1e3),usageLimit:1,perCustomerLimit:1,validDays:["monday","tuesday","wednesday","thursday","friday","saturday","sunday"]},targeting:{customerSegments:["all"],minOrderValue:0,applicableCategories:[],excludedCategories:[],paymentMethodRestriction:"all"},config:{percentage:10,maxDiscountAmount:500},metadata:{source:"gamification_spin_wheel",spinRecordId:"test-spin-123",userId:"test-user-123",userName:"Test User",userPhone:"1234567890",spinDate:new Date,segmentId:"test-segment",segmentColor:"#ff0000"}};try{const Z=await Ui.createCoupon(t.id,G);Z.success?(fe.success("Test coupon created successfully!"),k()):fe.error("Failed to create test coupon: "+Z.error)}catch(Z){console.error("Error creating test coupon:",Z),fe.error("Error creating test coupon")}},className:"btn btn-secondary flex items-center",children:" Create Test Coupon"})]}),g.length>0?o.jsxs("div",{className:"space-y-4",children:[o.jsxs("h3",{className:"font-medium text-gray-900",children:["Search Results (",g.length,")"]}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:g.map(G=>{var Z,ae,de;return o.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 bg-white hover:shadow-md transition-shadow",children:[o.jsxs("div",{className:"flex items-start justify-between mb-3",children:[o.jsxs("div",{className:"flex-1",children:[o.jsx("h4",{className:"font-medium text-gray-900",children:G.name}),o.jsx("p",{className:"text-sm text-gray-600 mt-1",children:G.description})]}),o.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${G.usageCount>0?"bg-red-100 text-red-800":"bg-green-100 text-green-800"}`,children:G.usageCount>0?"Used":"Available"})]}),o.jsx("div",{className:"bg-gray-50 rounded-lg p-3 mb-3",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm text-gray-600",children:"Coupon Code:"}),o.jsx("code",{className:"bg-white px-2 py-1 rounded text-sm font-mono border",children:G.code})]})}),o.jsxs("div",{className:"space-y-2 mb-4",children:[o.jsxs("div",{className:"flex justify-between text-sm",children:[o.jsx("span",{className:"text-gray-600",children:"Customer:"}),o.jsx("span",{className:"font-medium",children:(Z=G.metadata)==null?void 0:Z.userName})]}),o.jsxs("div",{className:"flex justify-between text-sm",children:[o.jsx("span",{className:"text-gray-600",children:"Phone:"}),o.jsx("span",{className:"font-medium",children:(ae=G.metadata)==null?void 0:ae.userPhone})]}),o.jsxs("div",{className:"flex justify-between text-sm",children:[o.jsx("span",{className:"text-gray-600",children:"Spin Date:"}),o.jsx("span",{className:"font-medium",children:(de=G.metadata)!=null&&de.spinDate?new Date(G.metadata.spinDate).toLocaleDateString():"N/A"})]}),o.jsxs("div",{className:"flex justify-between text-sm",children:[o.jsx("span",{className:"text-gray-600",children:"Expires:"}),o.jsx("span",{className:"font-medium",children:new Date(G.validity.endDate).toLocaleDateString()})]})]}),o.jsx("button",{onClick:()=>M(G.code),disabled:G.usageCount>0||j===G.code,className:`w-full py-2 px-4 rounded-lg font-medium transition-colors ${G.usageCount>0?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-purple-600 text-white hover:bg-purple-700"}`,children:j===G.code?o.jsxs("div",{className:"flex items-center justify-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Redeeming..."]}):G.usageCount>0?"Already Redeemed":"Redeem Coupon"})]},G.id)})})]}):m&&!v?o.jsxs("div",{className:"text-center py-8",children:[o.jsx(Qh,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),o.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No coupons found"}),o.jsx("p",{className:"text-gray-500",children:"Try searching with a different coupon code, name, or phone number."})]}):o.jsxs("div",{className:"text-center py-8",children:[o.jsx(Qh,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),o.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Search for Spin Wheel Coupons"}),o.jsx("p",{className:"text-gray-500",children:"Enter a coupon code, customer name, or phone number to find and redeem spin wheel coupons."})]})]}),o.jsxs("div",{className:"card p-6",children:[o.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Your Coupons"}),d?o.jsxs("div",{className:"flex items-center justify-center py-12",children:[o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),o.jsx("span",{className:"ml-2 text-gray-600",children:"Loading coupons..."})]}):c.length===0?o.jsxs("div",{className:"text-center py-12",children:[o.jsx(Ia,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),o.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No coupons yet"}),o.jsx("p",{className:"text-gray-500 mb-4",children:"Create your first coupon to start offering promotions to your customers."}),o.jsxs("button",{className:"btn btn-theme-primary",onClick:()=>n(!0),children:[o.jsx(Wn,{className:"w-4 h-4 mr-2"}),"Create Your First Coupon"]})]}):o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:c.map((G,Z)=>{var re;const ae=C=>{const O=["from-pink-500 to-pink-600","from-blue-500 to-blue-600","from-green-500 to-green-600","from-purple-500 to-purple-600","from-orange-500 to-orange-600","from-indigo-500 to-indigo-600"];return O[C%O.length]},de=C=>{switch(C){case"percentage_discount":return o.jsx(Dy,{className:"w-8 h-8"});case"fixed_amount":return o.jsx(Yi,{className:"w-8 h-8"});case"buy_x_get_y":return o.jsx(Ia,{className:"w-8 h-8"});default:return o.jsx(Ia,{className:"w-8 h-8"})}},se=C=>{switch(C){case"active":return"bg-green-500/20 text-green-100";case"draft":return"bg-yellow-500/20 text-yellow-100";case"expired":return"bg-red-500/20 text-red-100";case"paused":return"bg-gray-500/20 text-gray-100";default:return"bg-white/20 text-white"}},Y=((re=G.validity)==null?void 0:re.usageLimit)||0,ye=Y>0?G.usageCount/Y*100:0;return o.jsxs("div",{className:`bg-gradient-to-r ${ae(Z)} rounded-xl p-6 text-white`,children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[de(G.type),o.jsx("span",{className:`px-2 py-1 rounded-full text-sm ${se(G.status)}`,children:G.status.charAt(0).toUpperCase()+G.status.slice(1)})]}),o.jsx("h3",{className:"text-xl font-bold mb-2",children:G.name}),o.jsx("p",{className:"opacity-90 mb-4",children:G.description}),o.jsx("div",{className:"bg-white/20 rounded-lg p-3",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm",children:"Code:"}),o.jsx("code",{className:"bg-white text-gray-800 px-2 py-1 rounded text-sm font-mono",children:G.code})]})}),Y>0&&o.jsxs("div",{className:"mt-4 text-sm",children:[o.jsxs("div",{className:"flex justify-between",children:[o.jsxs("span",{children:["Used: ",G.usageCount,"/",Y]}),o.jsxs("span",{children:[Math.round(ye),"% usage"]})]}),o.jsx("div",{className:"w-full bg-white/20 rounded-full h-2 mt-2",children:o.jsx("div",{className:"bg-white h-2 rounded-full",style:{width:`${Math.min(ye,100)}%`}})})]})]},G.id)})}),o.jsxs("div",{className:"mt-8 text-center",children:[o.jsx("p",{className:"text-gray-500 mb-4",children:" Coupon Dashboard is now live! Features include:"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 text-sm",children:[o.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[o.jsx(Dy,{className:"w-6 h-6 text-blue-600 mx-auto mb-2"}),o.jsx("p",{className:"font-medium",children:"Percentage Discounts"}),o.jsx("p",{className:"text-gray-500 text-xs",children:"10%, 20%, 50% off"})]}),o.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[o.jsx(Yi,{className:"w-6 h-6 text-green-600 mx-auto mb-2"}),o.jsx("p",{className:"font-medium",children:"Fixed Amount Off"}),o.jsx("p",{className:"text-gray-500 text-xs",children:"50, 100, 200 off"})]}),o.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[o.jsx(Ia,{className:"w-6 h-6 text-purple-600 mx-auto mb-2"}),o.jsx("p",{className:"font-medium",children:"BOGO Deals"}),o.jsx("p",{className:"text-gray-500 text-xs",children:"Buy X Get Y Free"})]}),o.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[o.jsx(xd,{className:"w-6 h-6 text-orange-600 mx-auto mb-2"}),o.jsx("p",{className:"font-medium",children:"Smart Analytics"}),o.jsx("p",{className:"text-gray-500 text-xs",children:"Usage tracking & insights"})]})]})]})]}),r&&o.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 overflow-y-auto",onClick:()=>n(!1),children:o.jsx("div",{className:"min-h-full flex items-center justify-center p-4",children:o.jsx("div",{className:"bg-white rounded-xl shadow-2xl max-w-2xl w-full my-8",onClick:G=>G.stopPropagation(),children:o.jsxs("div",{className:"p-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-6",children:[o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center mr-4",children:o.jsx(Wn,{className:"w-6 h-6 text-blue-600"})}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Create New Coupon"}),o.jsx("p",{className:"text-sm text-gray-500",children:"Set up a promotional offer for your customers"})]})]}),o.jsx("button",{onClick:()=>n(!1),className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100",children:o.jsx(Zn,{className:"w-5 h-5"})})]}),!s&&o.jsxs("div",{className:"mb-6",children:[o.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-4",children:"Quick Templates"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("button",{className:"text-left p-4 border border-gray-200 rounded-lg hover:border-blue-500 hover:bg-blue-50 transition-colors",onClick:()=>{A({...U,name:"20% Welcome Discount",description:"Get 20% off on your first order",type:"percentage_discount",value:20,code:"WELCOME20"}),a(!0)},children:[o.jsxs("div",{className:"flex items-center mb-2",children:[o.jsx(Dy,{className:"w-5 h-5 text-blue-600 mr-2"}),o.jsx("span",{className:"font-medium",children:"Welcome Discount"})]}),o.jsx("p",{className:"text-sm text-gray-600",children:"20% off for new customers"}),o.jsx("div",{className:"mt-2 text-xs text-blue-600",children:"Click to customize"})]}),o.jsxs("button",{className:"text-left p-4 border border-gray-200 rounded-lg hover:border-green-500 hover:bg-green-50 transition-colors",onClick:()=>{A({...U,name:"Fixed 100 Off",description:"Get 100 off on orders above 500",type:"fixed_amount",value:100,code:"SAVE100",minimumOrderValue:"500"}),a(!0)},children:[o.jsxs("div",{className:"flex items-center mb-2",children:[o.jsx(Yi,{className:"w-5 h-5 text-green-600 mr-2"}),o.jsx("span",{className:"font-medium",children:"Fixed Amount Off"})]}),o.jsx("p",{className:"text-sm text-gray-600",children:"100 off on orders above 500"}),o.jsx("div",{className:"mt-2 text-xs text-green-600",children:"Click to customize"})]}),o.jsxs("button",{className:"text-left p-4 border border-gray-200 rounded-lg hover:border-purple-500 hover:bg-purple-50 transition-colors",onClick:()=>{A({...U,name:"Buy 1 Get 1 Free",description:"Free item on qualifying purchase",type:"buy_x_get_y",value:0,code:"BUY1GET1",buyQuantity:1,getQuantity:1}),a(!0)},children:[o.jsxs("div",{className:"flex items-center mb-2",children:[o.jsx(Ia,{className:"w-5 h-5 text-purple-600 mr-2"}),o.jsx("span",{className:"font-medium",children:"Buy 1 Get 1 Free"})]}),o.jsx("p",{className:"text-sm text-gray-600",children:"Free item on qualifying purchase"}),o.jsx("div",{className:"mt-2 text-xs text-purple-600",children:"Click to customize"})]}),o.jsxs("button",{className:"text-left p-4 border border-gray-200 rounded-lg hover:border-orange-500 hover:bg-orange-50 transition-colors",onClick:()=>a(!0),children:[o.jsxs("div",{className:"flex items-center mb-2",children:[o.jsx(Qh,{className:"w-5 h-5 text-orange-600 mr-2"}),o.jsx("span",{className:"font-medium",children:"Custom Coupon"})]}),o.jsx("p",{className:"text-sm text-gray-600",children:"Create from scratch with all options"}),o.jsx("div",{className:"mt-2 text-xs text-orange-600",children:"Full customization"})]})]})]}),s&&o.jsxs("form",{onSubmit:D,className:"space-y-6",children:[o.jsxs("div",{className:"space-y-4",children:[o.jsx("h5",{className:"text-md font-medium text-gray-900",children:"Basic Information"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Coupon Name *"}),o.jsx("input",{type:"text",value:U.name,onChange:G=>I("name",G.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., Welcome Discount",required:!0})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Coupon Code *"}),o.jsxs("div",{className:"flex",children:[o.jsx("input",{type:"text",value:U.code,onChange:G=>I("code",G.target.value.toUpperCase()),className:"flex-1 px-3 py-2 border border-gray-300 rounded-l-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"WELCOME20",required:!0}),o.jsx("button",{type:"button",onClick:E,className:"px-3 py-2 bg-gray-100 border border-l-0 border-gray-300 rounded-r-lg hover:bg-gray-200 text-sm",children:"Generate"})]})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description *"}),o.jsx("textarea",{value:U.description,onChange:G=>I("description",G.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:2,placeholder:"Brief description of the offer",required:!0})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Discount Type"}),o.jsxs("select",{value:U.type,onChange:G=>I("type",G.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[o.jsx("option",{value:"percentage_discount",children:"Percentage Discount"}),o.jsx("option",{value:"fixed_amount",children:"Fixed Amount Off"}),o.jsx("option",{value:"buy_x_get_y",children:"Buy X Get Y"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:U.type==="percentage_discount"?"Percentage (%)":U.type==="fixed_amount"?"Amount ()":"Value"}),o.jsx("input",{type:"number",value:U.value,onChange:G=>I("value",parseFloat(G.target.value)||0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",min:"0",max:U.type==="percentage_discount"?100:void 0})]})]})]}),o.jsxs("div",{className:"flex items-center justify-end space-x-3 pt-4 border-t",children:[o.jsx("button",{type:"button",onClick:()=>{a(!1),n(!1)},className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),o.jsx("button",{type:"submit",disabled:i,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center",children:i?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent mr-2"}),"Creating..."]}):"Create Coupon"})]})]})]})})})})]})}):o.jsx("div",{children:"Loading..."})}class Uy{static getDefaultThresholds(){return[{id:"bronze",name:"Bronze Member",pointsRequired:0,benefits:["Welcome to loyalty program","Spin wheel access"],color:"#CD7F32",badgeIcon:"",description:"Start your loyalty journey with us!"},{id:"silver",name:"Silver Member",pointsRequired:100,benefits:["5% extra discount","Priority customer support","Birthday rewards"],color:"#C0C0C0",badgeIcon:"",description:"Enjoy enhanced benefits as a valued customer!"},{id:"gold",name:"Gold Member",pointsRequired:250,benefits:["10% extra discount","Free delivery","Exclusive offers","Early access to new items"],color:"#FFD700",badgeIcon:"",description:"Premium benefits for our loyal customers!"},{id:"platinum",name:"Platinum Member",pointsRequired:500,benefits:["15% extra discount","Free premium items","VIP customer support","Personal offers"],color:"#E5E4E2",badgeIcon:"",description:"The ultimate loyalty experience!"},{id:"diamond",name:"Diamond Member",pointsRequired:1e3,benefits:["20% extra discount","Complimentary items","VIP events access","Personal account manager"],color:"#B9F2FF",badgeIcon:"",description:"Elite status with exceptional rewards!"}]}static getDefaultPointsConfig(){return{enabled:!0,pointsPerSpin:10,thresholds:this.getDefaultThresholds(),resetPeriod:"never"}}static async awardSpinPoints(e,r,n,s){try{const a=Rt(Ke,`restaurants/${e}/customers`,r);if(!(await Gr(a)).exists())return console.warn(`Customer ${r} not found in restaurant ${e}. Points cannot be awarded to non-existent customer.`),{success:!1,error:"Customer not found. Cannot award points to non-existent customer."};const l=Ki(Ke);l.update(a,{loyaltyPoints:vG(s),updatedAt:ft.fromDate(new Date)});const c=Rt(hr(Ke,`restaurants/${e}/pointsTransactions`)),u={customerId:r,restaurantId:e,type:"earned",points:s,source:"spin_wheel",sourceId:n,description:`Earned ${s} points from spin wheel`,createdAt:new Date};return l.set(c,{...u,createdAt:ft.fromDate(u.createdAt)}),await l.commit(),await this.updateCustomerThreshold(e,r),{success:!0,message:`Awarded ${s} points successfully`}}catch(a){return console.error("Error awarding spin points:",a),{success:!1,error:a instanceof Error?a.message:"Failed to award points"}}}static async updateCustomerThreshold(e,r){try{const n=Rt(Ke,`restaurants/${e}/customers`,r),s=await Gr(n);if(!s.exists())return;const a=s.data(),i=a.loyaltyPoints||0,l=br(hr(Ke,`restaurants/${e}/spinWheels`),Nr("isActive","==",!0),Nr("pointsConfig.enabled","==",!0),So(1)),c=await Tr(l);if(c.empty)return;const f=c.docs[0].data().pointsConfig.thresholds.filter(h=>i>=h.pointsRequired).sort((h,g)=>g.pointsRequired-h.pointsRequired),m=f.length>0?f[0].id:null;m!==a.currentThresholdId&&await nn(n,{currentThresholdId:m,updatedAt:ft.fromDate(new Date)})}catch(n){console.error("Error updating customer threshold:",n)}}static async getCustomerLoyaltyInfo(e,r){try{const n=Rt(Ke,`restaurants/${e}/customers`,r),s=await Gr(n);if(!s.exists())return{success:!1,error:"Customer not found"};const a=s.data(),i=a.loyaltyPoints||0,l=br(hr(Ke,`restaurants/${e}/spinWheels`),Nr("isActive","==",!0),Nr("pointsConfig.enabled","==",!0),So(1)),c=await Tr(l);if(c.empty)return{success:!1,error:"No active points program found"};const f=c.docs[0].data().pointsConfig.thresholds.sort((F,U)=>F.pointsRequired-U.pointsRequired),m=f.filter(F=>i>=F.pointsRequired).sort((F,U)=>U.pointsRequired-F.pointsRequired)[0]||f[0],h=f.find(F=>F.pointsRequired>i)||null;let g=0,p=0;if(h){const F=(m==null?void 0:m.pointsRequired)||0,U=h.pointsRequired-F,A=i-F;g=Math.min(100,A/U*100),p=h.pointsRequired-i}const v=br(hr(Ke,`restaurants/${e}/customerSpins`),Nr("customerId","==",r)),b=await Tr(v),w=b.size,N=b.docs.reduce((F,U)=>{const A=U.data();return F+(A.pointsEarned||0)},0);return{success:!0,data:{currentPoints:i,currentThreshold:m,nextThreshold:h,progressToNext:g,pointsToNext:p,totalSpins:w,totalPointsEarned:N,memberSince:a.createdAt instanceof Date?a.createdAt:new Date}}}catch(n){return console.error("Error getting customer loyalty info:",n),{success:!1,error:n instanceof Error?n.message:"Failed to get loyalty info"}}}static async getCustomerPointsHistory(e,r,n=50){try{const s=br(hr(Ke,`restaurants/${e}/pointsTransactions`),Nr("customerId","==",r),Oa("createdAt","desc"),So(n));return{success:!0,data:(await Tr(s)).docs.map(l=>{var u;const c=l.data();return{id:l.id,...c,createdAt:((u=c.createdAt)==null?void 0:u.toDate())||new Date}})}}catch(s){return console.error("Error getting points history:",s),{success:!1,error:s instanceof Error?s.message:"Failed to get points history"}}}static async getLoyaltyAnalytics(e){try{const r=br(hr(Ke,`restaurants/${e}/customers`),Nr("loyaltyPoints",">",0)),n=await Tr(r),s=br(hr(Ke,`restaurants/${e}/pointsTransactions`),Oa("createdAt","desc"),So(20)),i=(await Tr(s)).docs.map(d=>{var m;const f=d.data();return{id:d.id,...f,createdAt:((m=f.createdAt)==null?void 0:m.toDate())||new Date}});let l=0;const c={};return n.docs.forEach(d=>{const f=d.data();l+=f.loyaltyPoints||0;const m=f.currentThresholdId||"bronze";c[m]=(c[m]||0)+1}),{success:!0,data:{totalCustomersInProgram:n.size,totalPointsAwarded:l,averagePointsPerCustomer:n.size>0?l/n.size:0,thresholdDistribution:c,recentActivity:i}}}catch(r){return console.error("Error getting loyalty analytics:",r),{success:!1,error:r instanceof Error?r.message:"Failed to get analytics"}}}}const t7=Object.freeze(Object.defineProperty({__proto__:null,LoyaltyPointsService:Uy},Symbol.toStringTag,{value:"Module"}));function ace(){const{restaurant:t}=ya(),[e,r]=X.useState([]),[n,s]=X.useState(null),[a,i]=X.useState(null),[l,c]=X.useState(!0),[u,d]=X.useState(!1),[f,m]=X.useState(!1),[h,g]=X.useState(!1),[p,v]=X.useState([]),[b,w]=X.useState([]),[N,j]=X.useState([]),[F,U]=X.useState(Uy.getDefaultThresholds()),{register:A,handleSubmit:S,reset:k,formState:{errors:M}}=Hn({defaultValues:{maxSpinsPerCustomer:3,requiresContactInfo:!0,termsAndConditions:"Terms and conditions apply. Up to 3 spins per customer per day. Offers cannot be combined with other promotions.",enablePoints:!0,pointsPerSpin:10,resetPeriod:"never"}});X.useEffect(()=>{t&&I()},[t]);const I=async()=>{if(t)try{c(!0);const q=await Ja.getSpinWheelsForRestaurant(t.id);q.success&&q.data?r(q.data):fe.error(q.error||"Failed to load spin wheels")}catch{fe.error("Failed to load spin wheels")}finally{c(!1)}},E=async q=>{if(t)try{const te={enabled:q.enablePoints,pointsPerSpin:q.pointsPerSpin,thresholds:F,resetPeriod:q.resetPeriod},oe={name:q.name,maxSpinsPerCustomer:q.maxSpinsPerCustomer,requiresContactInfo:q.requiresContactInfo,termsAndConditions:q.termsAndConditions,restaurantId:t.id,isActive:!0,segments:b,pointsConfig:te},V=await Ja.createSpinWheel(t.id,oe);V.success?(fe.success("Spin wheel created successfully!"),d(!1),w([]),U(Uy.getDefaultThresholds()),k(),I()):fe.error(V.error||"Failed to create spin wheel")}catch{fe.error("Failed to create spin wheel")}},D=async q=>{if(!(!t||!n))try{const te={enabled:q.enablePoints,pointsPerSpin:q.pointsPerSpin,thresholds:N,resetPeriod:q.resetPeriod},oe={name:q.name,maxSpinsPerCustomer:q.maxSpinsPerCustomer,requiresContactInfo:q.requiresContactInfo,termsAndConditions:q.termsAndConditions,segments:p,pointsConfig:te},V=await Ja.updateSpinWheel(t.id,n.id,oe);V.success?(fe.success("Spin wheel updated successfully!"),m(!1),s(null),v([]),j([]),I()):fe.error(V.error||"Failed to update spin wheel")}catch{fe.error("Failed to update spin wheel")}},G=async q=>{if(t&&confirm("Are you sure you want to delete this spin wheel? This action cannot be undone."))try{const te=await Ja.deleteSpinWheel(t.id,q);te.success?(fe.success("Spin wheel deleted successfully"),I()):fe.error(te.error||"Failed to delete spin wheel")}catch{fe.error("Failed to delete spin wheel")}},Z=async q=>{if(t)try{const te=await Ja.updateSpinWheel(t.id,q.id,{isActive:!q.isActive});te.success?(fe.success(`Spin wheel ${q.isActive?"deactivated":"activated"}`),I()):fe.error(te.error||"Failed to update spin wheel")}catch{fe.error("Failed to update spin wheel")}},ae=async q=>{if(t)try{const te=await Ja.getSpinWheelStats(t.id,q.id);te.success&&te.data?(i(te.data),s(q),g(!0)):fe.error(te.error||"Failed to load stats")}catch{fe.error("Failed to load stats")}},de=q=>{navigator.clipboard.writeText(q),fe.success("Link copied to clipboard!")},se=q=>{var te,oe,V,xe;s(q),v([...q.segments]),j(((te=q.pointsConfig)==null?void 0:te.thresholds)||Uy.getDefaultThresholds()),k({name:q.name,maxSpinsPerCustomer:q.maxSpinsPerCustomer,requiresContactInfo:q.requiresContactInfo,termsAndConditions:q.termsAndConditions,enablePoints:((oe=q.pointsConfig)==null?void 0:oe.enabled)||!1,pointsPerSpin:((V=q.pointsConfig)==null?void 0:V.pointsPerSpin)||10,resetPeriod:((xe=q.pointsConfig)==null?void 0:xe.resetPeriod)||"never"}),m(!0)},Y=(q,te,oe)=>{const V=[...p];V[q]={...V[q],[te]:oe},v(V)},ye=(q,te,oe)=>{const V=[...b];V[q]={...V[q],[te]:oe},w(V)},re=(q,te,oe)=>{const V=[...F];V[q]={...V[q],[te]:oe},U(V)},C=(q,te,oe)=>{const V=[...N];V[q]={...V[q],[te]:oe},j(V)},O=()=>{const te={id:`custom_${Date.now()}`,name:"New Level",pointsRequired:100,benefits:["Custom benefit"],color:"#808080",badgeIcon:"",description:"Custom loyalty level"};U([...F,te])},L=q=>{if(F.length>1){const te=F.filter((oe,V)=>V!==q);U(te)}},H=()=>{const te={id:`custom_${Date.now()}`,name:"New Level",pointsRequired:100,benefits:["Custom benefit"],color:"#808080",badgeIcon:"",description:"Custom loyalty level"};j([...N,te])},K=q=>{if(N.length>1){const te=N.filter((oe,V)=>V!==q);j(te)}};return t?o.jsxs("div",{className:"min-h-screen",style:{background:"var(--color-background)"},children:[o.jsx("header",{className:"bg-white/80 backdrop-blur-md border-b border-gray-200",children:o.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsx("button",{onClick:()=>window.history.back(),className:"p-2 text-gray-600 hover:text-gray-900 rounded-lg hover:bg-gray-100",children:o.jsx(gm,{className:"w-5 h-5"})}),o.jsx("div",{className:"w-12 h-12 rounded-2xl flex items-center justify-center text-white",style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"},children:o.jsx(yd,{className:"w-6 h-6"})}),o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Gamification Tools"}),o.jsx("p",{className:"text-gray-600",children:"Create engaging spin wheel games for your customers"})]})]}),o.jsxs("button",{onClick:()=>{console.log("Create button clicked"),w(Ja.getDefaultSegments()),d(!0)},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center space-x-2",children:[o.jsx(Wn,{className:"w-4 h-4"}),o.jsx("span",{children:"Create Spin Wheel"})]})]})})}),o.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[o.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:o.jsx(yd,{className:"w-6 h-6 text-blue-600"})}),o.jsxs("div",{className:"ml-4",children:[o.jsx("p",{className:"text-sm text-gray-600",children:"Total Wheels"}),o.jsx("p",{className:"text-2xl font-bold text-gray-900",children:e.length})]})]})}),o.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"p-3 bg-green-100 rounded-lg",children:o.jsx(Ai,{className:"w-6 h-6 text-green-600"})}),o.jsxs("div",{className:"ml-4",children:[o.jsx("p",{className:"text-sm text-gray-600",children:"Active Wheels"}),o.jsx("p",{className:"text-2xl font-bold text-gray-900",children:e.filter(q=>q.isActive).length})]})]})}),o.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"p-3 bg-purple-100 rounded-lg",children:o.jsx(ni,{className:"w-6 h-6 text-purple-600"})}),o.jsxs("div",{className:"ml-4",children:[o.jsx("p",{className:"text-sm text-gray-600",children:"Total Spins"}),o.jsx("p",{className:"text-2xl font-bold text-gray-900",children:e.reduce((q,te)=>q+te.totalSpins,0)})]})]})}),o.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"p-3 bg-orange-100 rounded-lg",children:o.jsx(kp,{className:"w-6 h-6 text-orange-600"})}),o.jsxs("div",{className:"ml-4",children:[o.jsx("p",{className:"text-sm text-gray-600",children:"Redemptions"}),o.jsx("p",{className:"text-2xl font-bold text-gray-900",children:e.reduce((q,te)=>q+te.totalRedemptions,0)})]})]})})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[o.jsxs("div",{className:"p-6 border-b border-gray-200",children:[o.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Your Spin Wheels"}),o.jsx("p",{className:"text-gray-600",children:"Manage your customer engagement games"})]}),l?o.jsxs("div",{className:"p-12 text-center",children:[o.jsx(Ox,{className:"w-8 h-8 text-gray-400 mx-auto mb-4 animate-spin"}),o.jsx("p",{className:"text-gray-600",children:"Loading spin wheels..."})]}):e.length===0?o.jsxs("div",{className:"p-12 text-center",children:[o.jsx(yd,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),o.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Spin Wheels Yet"}),o.jsx("p",{className:"text-gray-600 mb-6",children:"Create your first spin wheel to start engaging customers with fun rewards!"}),o.jsx("button",{onClick:()=>{console.log("Create first button clicked"),w(Ja.getDefaultSegments()),d(!0)},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Create Your First Spin Wheel"})]}):o.jsx("div",{className:"divide-y divide-gray-200",children:e.map(q=>o.jsx("div",{className:"p-6",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex-1",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("h3",{className:"text-lg font-medium text-gray-900",children:q.name}),o.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${q.isActive?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:q.isActive?"Active":"Inactive"})]}),o.jsxs("div",{className:"mt-2 flex items-center space-x-6 text-sm text-gray-600",children:[o.jsxs("span",{children:[o.jsx(ni,{className:"w-4 h-4 inline mr-1"}),q.totalSpins," spins"]}),o.jsxs("span",{children:[o.jsx(kp,{className:"w-4 h-4 inline mr-1"}),q.totalRedemptions," redeemed"]}),o.jsxs("span",{children:["Max ",q.maxSpinsPerCustomer," per customer"]}),o.jsxs("span",{children:[q.segments.length," segments"]})]}),o.jsxs("div",{className:"mt-3 flex items-center space-x-2",children:[o.jsx("code",{className:"text-xs bg-gray-100 px-2 py-1 rounded",children:q.shareableLink}),o.jsx("button",{onClick:()=>de(q.shareableLink),className:"text-blue-600 hover:text-blue-800",title:"Copy link",children:o.jsx(Hu,{className:"w-4 h-4"})}),o.jsx("a",{href:q.shareableLink,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800",title:"Open in new tab",children:o.jsx(Q2,{className:"w-4 h-4"})})]})]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("button",{onClick:()=>ae(q),className:"p-2 bg-gray-100 text-gray-600 rounded-lg hover:bg-gray-200 transition-colors",title:"View analytics",children:o.jsx(xd,{className:"w-4 h-4"})}),o.jsx("button",{onClick:()=>se(q),className:"p-2 bg-gray-100 text-gray-600 rounded-lg hover:bg-gray-200 transition-colors",title:"Edit wheel",children:o.jsx(Cd,{className:"w-4 h-4"})}),o.jsx("button",{onClick:()=>Z(q),className:`p-2 rounded-lg transition-colors ${q.isActive?"bg-red-100 text-red-600 hover:bg-red-200":"bg-green-100 text-green-600 hover:bg-green-200"}`,title:q.isActive?"Deactivate":"Activate",children:q.isActive?o.jsx(M_,{className:"w-4 h-4"}):o.jsx(aK,{className:"w-4 h-4"})}),o.jsx("button",{onClick:()=>G(q.id),className:"p-2 bg-red-100 text-red-600 rounded-lg hover:bg-red-200 transition-colors",title:"Delete wheel",children:o.jsx(ga,{className:"w-4 h-4"})})]})]})},q.id))})]})]}),u&&o.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:o.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-5xl w-full max-h-[90vh] overflow-hidden",children:[o.jsxs("div",{className:"p-6 border-b border-gray-200",children:[o.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Create New Spin Wheel"}),o.jsx("p",{className:"text-gray-600 mt-1",children:"Configure your wheel settings and customize each segment's offers"})]}),o.jsxs("form",{onSubmit:S(E),className:"overflow-y-auto max-h-[calc(90vh-140px)]",children:[o.jsxs("div",{className:"p-6 space-y-6",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Wheel Name *"}),o.jsx("input",{type:"text",...A("name",{required:"Wheel name is required"}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., Weekend Special Rewards"}),M.name&&o.jsx("p",{className:"text-red-500 text-sm mt-1",children:M.name.message})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Max Spins Per Customer (Daily)"}),o.jsxs("select",{...A("maxSpinsPerCustomer"),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[o.jsx("option",{value:1,children:"1 spin per day"}),o.jsx("option",{value:2,children:"2 spins per day"}),o.jsx("option",{value:3,children:"3 spins per day"}),o.jsx("option",{value:0,children:"Unlimited"})]})]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"flex items-center space-x-2",children:[o.jsx("input",{type:"checkbox",...A("requiresContactInfo"),className:"rounded border-gray-300"}),o.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Require customer contact info before spinning"})]}),o.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Collect phone number or email to build your customer database"})]}),o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Configure Your 8 Wheel Segments"}),o.jsx("div",{className:"text-sm text-gray-500",children:"Customize offers, colors, and win probability for each segment"})]}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:b.map((q,te)=>o.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 bg-gray-50",children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsxs("h4",{className:"font-medium text-gray-900",children:["Segment ",te+1]}),o.jsx("div",{className:"w-8 h-8 rounded-full border-2 border-white shadow-sm",style:{backgroundColor:q.color}})]}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Offer Title (appears on wheel)"}),o.jsx("input",{type:"text",value:q.label,onChange:oe=>ye(te,"label",oe.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., 10% Off, Free Drink"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Full Offer Description"}),o.jsx("textarea",{rows:2,value:q.value,onChange:oe=>ye(te,"value",oe.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., 10% discount on your next order"})]}),o.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Color"}),o.jsx("input",{type:"color",value:q.color,onChange:oe=>ye(te,"color",oe.target.value),className:"w-full h-8 rounded border border-gray-300"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Win Chance"}),o.jsx("input",{type:"number",min:"1",max:"100",value:q.probability,onChange:oe=>ye(te,"probability",parseInt(oe.target.value)),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Type"}),o.jsxs("select",{value:q.rewardType,onChange:oe=>ye(te,"rewardType",oe.target.value),className:"w-full px-2 py-1 text-xs border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[o.jsx("option",{value:"discount_percentage",children:"% Off"}),o.jsx("option",{value:"discount_fixed",children:"$ Off"}),o.jsx("option",{value:"free_item",children:"Free Item"}),o.jsx("option",{value:"points",children:"Points"}),o.jsx("option",{value:"custom",children:"Custom"})]})]})]}),(q.rewardType==="discount_percentage"||q.rewardType==="discount_fixed")&&o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:q.rewardType==="discount_percentage"?"Percentage (%)":"Amount ($)"}),o.jsx("input",{type:"number",step:q.rewardType==="discount_percentage"?"1":"0.01",value:q.rewardValue||0,onChange:oe=>ye(te,"rewardValue",parseFloat(oe.target.value)),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:q.rewardType==="discount_percentage"?"10":"5.00"})]})]})]},q.id))}),o.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg mt-4",children:[o.jsx("h4",{className:"text-sm font-medium text-blue-900 mb-2",children:" Pro Tips:"}),o.jsxs("ul",{className:"text-xs text-blue-800 space-y-1",children:[o.jsx("li",{children:" Higher win chances = more customers win = higher engagement"}),o.jsx("li",{children:" Mix high-value prizes (low chance) with small prizes (high chance)"}),o.jsx("li",{children:" Use bright, contrasting colors for better visibility"}),o.jsx("li",{children:' "Better Luck" segments create anticipation for return visits'})]})]})]}),o.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-blue-50 p-6 rounded-lg",children:[o.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[o.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:o.jsx(kp,{className:"w-5 h-5 text-purple-600"})}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Loyalty Points System"}),o.jsx("p",{className:"text-sm text-gray-600",children:"Reward customers with points to build loyalty"})]})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("input",{type:"checkbox",...A("enablePoints"),className:"rounded border-gray-300 h-4 w-4 text-purple-600 focus:ring-purple-500"}),o.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Enable Points & Loyalty Levels"})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Points Per Spin"}),o.jsx("input",{type:"number",min:"1",max:"100",...A("pointsPerSpin"),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"10"}),o.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Points awarded for each spin"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Points Reset Period"}),o.jsxs("select",{...A("resetPeriod"),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[o.jsx("option",{value:"never",children:"Never Reset"}),o.jsx("option",{value:"yearly",children:"Reset Yearly"}),o.jsx("option",{value:"monthly",children:"Reset Monthly"})]})]})]}),o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsx("h4",{className:"text-sm font-medium text-gray-900",children:"Loyalty Levels & Rewards"}),o.jsx("button",{type:"button",onClick:O,className:"text-xs px-2 py-1 bg-purple-100 text-purple-700 rounded hover:bg-purple-200 transition-colors",children:"Add Level"})]}),o.jsx("div",{className:"space-y-3 max-h-60 overflow-y-auto",children:F.map((q,te)=>o.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("span",{className:"text-lg",children:q.badgeIcon}),o.jsx("input",{type:"text",value:q.name,onChange:oe=>re(te,"name",oe.target.value),className:"text-sm font-medium bg-transparent border-none focus:outline-none focus:ring-0 p-0",placeholder:"Level Name"})]}),F.length>1&&o.jsx("button",{type:"button",onClick:()=>L(te),className:"text-red-400 hover:text-red-600",children:o.jsx(ga,{className:"w-4 h-4"})})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Points Required"}),o.jsx("input",{type:"number",min:"0",value:q.pointsRequired,onChange:oe=>re(te,"pointsRequired",parseInt(oe.target.value)),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Badge Color"}),o.jsx("input",{type:"color",value:q.color,onChange:oe=>re(te,"color",oe.target.value),className:"w-full h-8 rounded border border-gray-300"})]})]}),o.jsxs("div",{className:"mt-3",children:[o.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Benefits (one per line)"}),o.jsx("textarea",{rows:2,value:q.benefits.join(`
`),onChange:oe=>re(te,"benefits",oe.target.value.split(`
`).filter(V=>V.trim())),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:`5% discount
Priority support`})]})]},q.id))})]}),o.jsxs("div",{className:"bg-purple-50 p-3 rounded-lg",children:[o.jsx("h5",{className:"text-xs font-medium text-purple-900 mb-1",children:" Points Strategy Tips:"}),o.jsxs("ul",{className:"text-xs text-purple-800 space-y-1",children:[o.jsx("li",{children:" Start with 10-20 points per spin for good engagement"}),o.jsx("li",{children:" Set achievable first level (50-100 points) for quick wins"}),o.jsx("li",{children:" Space out levels to maintain progression motivation"}),o.jsx("li",{children:" Offer meaningful benefits at each level"})]})]})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Terms & Conditions"}),o.jsx("textarea",{...A("termsAndConditions"),rows:3,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter terms and conditions for this promotion..."})]}),o.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[o.jsx("h3",{className:"text-sm font-medium text-green-900 mb-2",children:" Ready to Launch?"}),o.jsxs("ul",{className:"text-sm text-green-800 space-y-1",children:[o.jsx("li",{children:" Your spin wheel will be created with your custom segments"}),o.jsx("li",{children:" A unique shareable link will be generated automatically"}),o.jsx("li",{children:" Share via QR codes, social media, or directly with customers"}),o.jsx("li",{children:" Start tracking engagement and redemptions immediately!"})]})]})]}),o.jsxs("div",{className:"p-6 border-t border-gray-200 flex justify-end space-x-3",children:[o.jsx("button",{type:"button",onClick:()=>{d(!1),w([])},className:"px-6 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors",children:"Cancel"}),o.jsxs("button",{type:"submit",className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center",children:[o.jsx(ZR,{className:"w-4 h-4 mr-2"}),"Create Spin Wheel"]})]})]})]})}),f&&n&&o.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:o.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-hidden",children:[o.jsxs("div",{className:"p-6 border-b border-gray-200",children:[o.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Edit Spin Wheel"}),o.jsx("p",{className:"text-gray-600 mt-1",children:"Customize your spin wheel settings and segments"})]}),o.jsxs("form",{onSubmit:S(D),className:"overflow-y-auto max-h-[calc(90vh-140px)]",children:[o.jsxs("div",{className:"p-6 space-y-6",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Wheel Name *"}),o.jsx("input",{type:"text",...A("name",{required:"Wheel name is required"}),className:"input"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Max Spins Per Customer (Daily)"}),o.jsxs("select",{...A("maxSpinsPerCustomer"),className:"input",children:[o.jsx("option",{value:1,children:"1 spin per day"}),o.jsx("option",{value:2,children:"2 spins per day"}),o.jsx("option",{value:3,children:"3 spins per day"}),o.jsx("option",{value:0,children:"Unlimited"})]})]})]}),o.jsx("div",{children:o.jsxs("label",{className:"flex items-center space-x-2",children:[o.jsx("input",{type:"checkbox",...A("requiresContactInfo"),className:"rounded border-gray-300"}),o.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Require customer contact info"})]})}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Configure Segments"}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:p.map((q,te)=>o.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsxs("h4",{className:"font-medium text-gray-900",children:["Segment ",te+1]}),o.jsx("div",{className:"w-6 h-6 rounded-full border-2 border-gray-300",style:{backgroundColor:q.color}})]}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Label"}),o.jsx("input",{type:"text",value:q.label,onChange:oe=>Y(te,"label",oe.target.value),className:"input text-sm"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Description"}),o.jsx("input",{type:"text",value:q.value,onChange:oe=>Y(te,"value",oe.target.value),className:"input text-sm"})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Color"}),o.jsx("input",{type:"color",value:q.color,onChange:oe=>Y(te,"color",oe.target.value),className:"w-full h-8 rounded border border-gray-300"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Weight (1-100)"}),o.jsx("input",{type:"number",min:"1",max:"100",value:q.probability,onChange:oe=>Y(te,"probability",parseInt(oe.target.value)),className:"input text-sm"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Reward Type"}),o.jsxs("select",{value:q.rewardType,onChange:oe=>Y(te,"rewardType",oe.target.value),className:"input text-sm",children:[o.jsx("option",{value:"discount_percentage",children:"Percentage Discount"}),o.jsx("option",{value:"discount_fixed",children:"Fixed Amount Discount"}),o.jsx("option",{value:"free_item",children:"Free Item"}),o.jsx("option",{value:"points",children:"Loyalty Points"}),o.jsx("option",{value:"custom",children:"Custom Reward"})]})]}),(q.rewardType==="discount_percentage"||q.rewardType==="discount_fixed")&&o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:q.rewardType==="discount_percentage"?"Percentage":"Amount"}),o.jsx("input",{type:"number",value:q.rewardValue||0,onChange:oe=>Y(te,"rewardValue",parseFloat(oe.target.value)),className:"input text-sm"})]})]})]},q.id))})]}),o.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-blue-50 p-6 rounded-lg",children:[o.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[o.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:o.jsx(kp,{className:"w-5 h-5 text-purple-600"})}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Loyalty Points System"}),o.jsx("p",{className:"text-sm text-gray-600",children:"Manage customer loyalty and engagement"})]})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("input",{type:"checkbox",...A("enablePoints"),className:"rounded border-gray-300 h-4 w-4 text-purple-600 focus:ring-purple-500"}),o.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Enable Points & Loyalty Levels"})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Points Per Spin"}),o.jsx("input",{type:"number",min:"1",max:"100",...A("pointsPerSpin"),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Points Reset Period"}),o.jsxs("select",{...A("resetPeriod"),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[o.jsx("option",{value:"never",children:"Never Reset"}),o.jsx("option",{value:"yearly",children:"Reset Yearly"}),o.jsx("option",{value:"monthly",children:"Reset Monthly"})]})]})]}),o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsx("h4",{className:"text-sm font-medium text-gray-900",children:"Loyalty Levels & Rewards"}),o.jsx("button",{type:"button",onClick:H,className:"text-xs px-2 py-1 bg-purple-100 text-purple-700 rounded hover:bg-purple-200 transition-colors",children:"Add Level"})]}),o.jsx("div",{className:"space-y-3 max-h-60 overflow-y-auto",children:N.map((q,te)=>o.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("span",{className:"text-lg",children:q.badgeIcon}),o.jsx("input",{type:"text",value:q.name,onChange:oe=>C(te,"name",oe.target.value),className:"text-sm font-medium bg-transparent border-none focus:outline-none focus:ring-0 p-0"})]}),N.length>1&&o.jsx("button",{type:"button",onClick:()=>K(te),className:"text-red-400 hover:text-red-600",children:o.jsx(ga,{className:"w-4 h-4"})})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Points Required"}),o.jsx("input",{type:"number",min:"0",value:q.pointsRequired,onChange:oe=>C(te,"pointsRequired",parseInt(oe.target.value)),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Badge Color"}),o.jsx("input",{type:"color",value:q.color,onChange:oe=>C(te,"color",oe.target.value),className:"w-full h-8 rounded border border-gray-300"})]})]}),o.jsxs("div",{className:"mt-3",children:[o.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Benefits (one per line)"}),o.jsx("textarea",{rows:2,value:q.benefits.join(`
`),onChange:oe=>C(te,"benefits",oe.target.value.split(`
`).filter(V=>V.trim())),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]})]},q.id))})]})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Terms & Conditions"}),o.jsx("textarea",{...A("termsAndConditions"),rows:3,className:"input"})]})]}),o.jsxs("div",{className:"p-6 border-t border-gray-200 flex justify-end space-x-3",children:[o.jsx("button",{type:"button",onClick:()=>m(!1),className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors",children:"Cancel"}),o.jsxs("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center",children:[o.jsx(kd,{className:"w-4 h-4 mr-2"}),"Save Changes"]})]})]})]})}),h&&n&&a&&o.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:o.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-hidden",children:[o.jsxs("div",{className:"p-6 border-b border-gray-200",children:[o.jsxs("h2",{className:"text-xl font-semibold text-gray-900",children:[n.name," - Analytics"]}),o.jsx("p",{className:"text-gray-600 mt-1",children:"Performance insights and customer engagement metrics"})]}),o.jsxs("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-140px)]",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"text-3xl font-bold text-blue-600",children:a.totalSpins}),o.jsx("div",{className:"text-sm text-gray-600",children:"Total Spins"})]}),o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"text-3xl font-bold text-green-600",children:a.totalRedemptions}),o.jsx("div",{className:"text-sm text-gray-600",children:"Redeemed"})]}),o.jsxs("div",{className:"text-center",children:[o.jsxs("div",{className:"text-3xl font-bold text-purple-600",children:[a.redemptionRate.toFixed(1),"%"]}),o.jsx("div",{className:"text-sm text-gray-600",children:"Redemption Rate"})]}),o.jsxs("div",{className:"text-center",children:[o.jsxs("div",{className:"text-3xl font-bold text-orange-600",children:[a.customerEngagement.toFixed(1),"%"]}),o.jsx("div",{className:"text-sm text-gray-600",children:"Engagement"})]})]}),o.jsxs("div",{className:"mb-8",children:[o.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Most Popular Segments"}),o.jsx("div",{className:"space-y-3",children:a.popularSegments.slice(0,5).map((q,te)=>o.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsxs("span",{className:"text-sm font-medium text-gray-900",children:["#",te+1]}),o.jsx("span",{className:"text-sm text-gray-900",children:q.label})]}),o.jsxs("div",{className:"text-sm font-medium text-gray-600",children:[q.count," spins"]})]},q.segmentId))})]})]}),o.jsx("div",{className:"p-6 border-t border-gray-200 flex justify-end",children:o.jsx("button",{onClick:()=>g(!1),className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors",children:"Close"})})]})})]}):o.jsx("div",{children:"Loading..."})}const ice={};var mN=null;function oce(t){try{return crypto.getRandomValues(new Uint8Array(t))}catch{}try{return ice.randomBytes(t)}catch{}if(!mN)throw Error("Neither WebCryptoAPI nor a crypto module is available. Use bcrypt.setRandomFallback to set an alternative");return mN(t)}function lce(t){mN=t}function b3(t,e){if(t=t||w3,typeof t!="number")throw Error("Illegal arguments: "+typeof t+", "+typeof e);t<4?t=4:t>31&&(t=31);var r=[];return r.push("$2b$"),t<10&&r.push("0"),r.push(t.toString()),r.push("$"),r.push(l2(oce(lx),lx)),r.join("")}function r7(t,e,r){if(typeof e=="function"&&(r=e,e=void 0),typeof t=="function"&&(r=t,t=void 0),typeof t>"u")t=w3;else if(typeof t!="number")throw Error("illegal arguments: "+typeof t);function n(s){tl(function(){try{s(null,b3(t))}catch(a){s(a)}})}if(r){if(typeof r!="function")throw Error("Illegal callback: "+typeof r);n(r)}else return new Promise(function(s,a){n(function(i,l){if(i){a(i);return}s(l)})})}function n7(t,e){if(typeof e>"u"&&(e=w3),typeof e=="number"&&(e=b3(e)),typeof t!="string"||typeof e!="string")throw Error("Illegal arguments: "+typeof t+", "+typeof e);return pN(t,e)}function s7(t,e,r,n){function s(a){typeof t=="string"&&typeof e=="number"?r7(e,function(i,l){pN(t,l,a,n)}):typeof t=="string"&&typeof e=="string"?pN(t,e,a,n):tl(a.bind(this,Error("Illegal arguments: "+typeof t+", "+typeof e)))}if(r){if(typeof r!="function")throw Error("Illegal callback: "+typeof r);s(r)}else return new Promise(function(a,i){s(function(l,c){if(l){i(l);return}a(c)})})}function a7(t,e){for(var r=t.length^e.length,n=0;n<t.length;++n)r|=t.charCodeAt(n)^e.charCodeAt(n);return r===0}function cce(t,e){if(typeof t!="string"||typeof e!="string")throw Error("Illegal arguments: "+typeof t+", "+typeof e);return e.length!==60?!1:a7(n7(t,e.substring(0,e.length-31)),e)}function uce(t,e,r,n){function s(a){if(typeof t!="string"||typeof e!="string"){tl(a.bind(this,Error("Illegal arguments: "+typeof t+", "+typeof e)));return}if(e.length!==60){tl(a.bind(this,null,!1));return}s7(t,e.substring(0,29),function(i,l){i?a(i):a(null,a7(l,e))},n)}if(r){if(typeof r!="function")throw Error("Illegal callback: "+typeof r);s(r)}else return new Promise(function(a,i){s(function(l,c){if(l){i(l);return}a(c)})})}function dce(t){if(typeof t!="string")throw Error("Illegal arguments: "+typeof t);return parseInt(t.split("$")[2],10)}function fce(t){if(typeof t!="string")throw Error("Illegal arguments: "+typeof t);if(t.length!==60)throw Error("Illegal hash length: "+t.length+" != 60");return t.substring(0,29)}function hce(t){if(typeof t!="string")throw Error("Illegal arguments: "+typeof t);return i7(t)>72}var tl=typeof process<"u"&&process&&typeof process.nextTick=="function"?typeof setImmediate=="function"?setImmediate:process.nextTick:setTimeout;function i7(t){for(var e=0,r=0,n=0;n<t.length;++n)r=t.charCodeAt(n),r<128?e+=1:r<2048?e+=2:(r&64512)===55296&&(t.charCodeAt(n+1)&64512)===56320?(++n,e+=4):e+=3;return e}function mce(t){for(var e=0,r,n,s=new Array(i7(t)),a=0,i=t.length;a<i;++a)r=t.charCodeAt(a),r<128?s[e++]=r:r<2048?(s[e++]=r>>6|192,s[e++]=r&63|128):(r&64512)===55296&&((n=t.charCodeAt(a+1))&64512)===56320?(r=65536+((r&1023)<<10)+(n&1023),++a,s[e++]=r>>18|240,s[e++]=r>>12&63|128,s[e++]=r>>6&63|128,s[e++]=r&63|128):(s[e++]=r>>12|224,s[e++]=r>>6&63|128,s[e++]=r&63|128);return s}var s0="./ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),Du=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,54,55,56,57,58,59,60,61,62,63,-1,-1,-1,-1,-1,-1,-1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,-1,-1,-1,-1,-1,-1,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,-1,-1,-1,-1,-1];function l2(t,e){var r=0,n=[],s,a;if(e<=0||e>t.length)throw Error("Illegal len: "+e);for(;r<e;){if(s=t[r++]&255,n.push(s0[s>>2&63]),s=(s&3)<<4,r>=e){n.push(s0[s&63]);break}if(a=t[r++]&255,s|=a>>4&15,n.push(s0[s&63]),s=(a&15)<<2,r>=e){n.push(s0[s&63]);break}a=t[r++]&255,s|=a>>6&3,n.push(s0[s&63]),n.push(s0[a&63])}return n.join("")}function o7(t,e){var r=0,n=t.length,s=0,a=[],i,l,c,u,d,f;if(e<=0)throw Error("Illegal len: "+e);for(;r<n-1&&s<e&&(f=t.charCodeAt(r++),i=f<Du.length?Du[f]:-1,f=t.charCodeAt(r++),l=f<Du.length?Du[f]:-1,!(i==-1||l==-1||(d=i<<2>>>0,d|=(l&48)>>4,a.push(String.fromCharCode(d)),++s>=e||r>=n)||(f=t.charCodeAt(r++),c=f<Du.length?Du[f]:-1,c==-1)||(d=(l&15)<<4>>>0,d|=(c&60)>>2,a.push(String.fromCharCode(d)),++s>=e||r>=n)));)f=t.charCodeAt(r++),u=f<Du.length?Du[f]:-1,d=(c&3)<<6>>>0,d|=u,a.push(String.fromCharCode(d)),++s;var m=[];for(r=0;r<s;r++)m.push(a[r].charCodeAt(0));return m}var lx=16,w3=10,pce=16,gce=100,u6=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],d6=[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946,1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055,3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504,976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462],l7=[1332899944,1700884034,1701343084,1684370003,1668446532,1869963892];function cx(t,e,r,n){var s,a=t[e],i=t[e+1];return a^=r[0],s=n[a>>>24],s+=n[256|a>>16&255],s^=n[512|a>>8&255],s+=n[768|a&255],i^=s^r[1],s=n[i>>>24],s+=n[256|i>>16&255],s^=n[512|i>>8&255],s+=n[768|i&255],a^=s^r[2],s=n[a>>>24],s+=n[256|a>>16&255],s^=n[512|a>>8&255],s+=n[768|a&255],i^=s^r[3],s=n[i>>>24],s+=n[256|i>>16&255],s^=n[512|i>>8&255],s+=n[768|i&255],a^=s^r[4],s=n[a>>>24],s+=n[256|a>>16&255],s^=n[512|a>>8&255],s+=n[768|a&255],i^=s^r[5],s=n[i>>>24],s+=n[256|i>>16&255],s^=n[512|i>>8&255],s+=n[768|i&255],a^=s^r[6],s=n[a>>>24],s+=n[256|a>>16&255],s^=n[512|a>>8&255],s+=n[768|a&255],i^=s^r[7],s=n[i>>>24],s+=n[256|i>>16&255],s^=n[512|i>>8&255],s+=n[768|i&255],a^=s^r[8],s=n[a>>>24],s+=n[256|a>>16&255],s^=n[512|a>>8&255],s+=n[768|a&255],i^=s^r[9],s=n[i>>>24],s+=n[256|i>>16&255],s^=n[512|i>>8&255],s+=n[768|i&255],a^=s^r[10],s=n[a>>>24],s+=n[256|a>>16&255],s^=n[512|a>>8&255],s+=n[768|a&255],i^=s^r[11],s=n[i>>>24],s+=n[256|i>>16&255],s^=n[512|i>>8&255],s+=n[768|i&255],a^=s^r[12],s=n[a>>>24],s+=n[256|a>>16&255],s^=n[512|a>>8&255],s+=n[768|a&255],i^=s^r[13],s=n[i>>>24],s+=n[256|i>>16&255],s^=n[512|i>>8&255],s+=n[768|i&255],a^=s^r[14],s=n[a>>>24],s+=n[256|a>>16&255],s^=n[512|a>>8&255],s+=n[768|a&255],i^=s^r[15],s=n[i>>>24],s+=n[256|i>>16&255],s^=n[512|i>>8&255],s+=n[768|i&255],a^=s^r[16],t[e]=i^r[pce+1],t[e+1]=a,t}function m0(t,e){for(var r=0,n=0;r<4;++r)n=n<<8|t[e]&255,e=(e+1)%t.length;return{key:n,offp:e}}function f6(t,e,r){for(var n=0,s=[0,0],a=e.length,i=r.length,l,c=0;c<a;c++)l=m0(t,n),n=l.offp,e[c]=e[c]^l.key;for(c=0;c<a;c+=2)s=cx(s,0,e,r),e[c]=s[0],e[c+1]=s[1];for(c=0;c<i;c+=2)s=cx(s,0,e,r),r[c]=s[0],r[c+1]=s[1]}function xce(t,e,r,n){for(var s=0,a=[0,0],i=r.length,l=n.length,c,u=0;u<i;u++)c=m0(e,s),s=c.offp,r[u]=r[u]^c.key;for(s=0,u=0;u<i;u+=2)c=m0(t,s),s=c.offp,a[0]^=c.key,c=m0(t,s),s=c.offp,a[1]^=c.key,a=cx(a,0,r,n),r[u]=a[0],r[u+1]=a[1];for(u=0;u<l;u+=2)c=m0(t,s),s=c.offp,a[0]^=c.key,c=m0(t,s),s=c.offp,a[1]^=c.key,a=cx(a,0,r,n),n[u]=a[0],n[u+1]=a[1]}function h6(t,e,r,n,s){var a=l7.slice(),i=a.length,l;if(r<4||r>31)if(l=Error("Illegal number of rounds (4-31): "+r),n){tl(n.bind(this,l));return}else throw l;if(e.length!==lx)if(l=Error("Illegal salt length: "+e.length+" != "+lx),n){tl(n.bind(this,l));return}else throw l;r=1<<r>>>0;var c,u,d=0,f;typeof Int32Array=="function"?(c=new Int32Array(u6),u=new Int32Array(d6)):(c=u6.slice(),u=d6.slice()),xce(e,t,c,u);function m(){if(s&&s(d/r),d<r)for(var g=Date.now();d<r&&(d=d+1,f6(t,c,u),f6(e,c,u),!(Date.now()-g>gce)););else{for(d=0;d<64;d++)for(f=0;f<i>>1;f++)cx(a,f<<1,c,u);var p=[];for(d=0;d<i;d++)p.push((a[d]>>24&255)>>>0),p.push((a[d]>>16&255)>>>0),p.push((a[d]>>8&255)>>>0),p.push((a[d]&255)>>>0);if(n){n(null,p);return}else return p}n&&tl(m)}if(typeof n<"u")m();else for(var h;;)if(typeof(h=m())<"u")return h||[]}function pN(t,e,r,n){var s;if(typeof t!="string"||typeof e!="string")if(s=Error("Invalid string / salt: Not a string"),r){tl(r.bind(this,s));return}else throw s;var a,i;if(e.charAt(0)!=="$"||e.charAt(1)!=="2")if(s=Error("Invalid salt version: "+e.substring(0,2)),r){tl(r.bind(this,s));return}else throw s;if(e.charAt(2)==="$")a="\0",i=3;else{if(a=e.charAt(2),a!=="a"&&a!=="b"&&a!=="y"||e.charAt(3)!=="$")if(s=Error("Invalid salt revision: "+e.substring(2,4)),r){tl(r.bind(this,s));return}else throw s;i=4}if(e.charAt(i+2)>"$")if(s=Error("Missing salt rounds"),r){tl(r.bind(this,s));return}else throw s;var l=parseInt(e.substring(i,i+1),10)*10,c=parseInt(e.substring(i+1,i+2),10),u=l+c,d=e.substring(i+3,i+25);t+=a>="a"?"\0":"";var f=mce(t),m=o7(d,lx);function h(g){var p=[];return p.push("$2"),a>="a"&&p.push(a),p.push("$"),u<10&&p.push("0"),p.push(u.toString()),p.push("$"),p.push(l2(m,m.length)),p.push(l2(g,l7.length*4-1)),p.join("")}if(typeof r>"u")return h(h6(f,m,u));h6(f,m,u,function(g,p){g?r(g,null):r(null,h(p))},n)}function yce(t,e){return l2(t,e)}function vce(t,e){return o7(t,e)}const m6={setRandomFallback:lce,genSaltSync:b3,genSalt:r7,hashSync:n7,hash:s7,compareSync:cce,compare:uce,getRounds:dce,getSalt:fce,truncates:hce,encodeBase64:yce,decodeBase64:vce};class bce{constructor(e){Rr(this,"config");this.config=e}async sendSMSVerification(e,r,n){const s=`Your ${n} verification code is: ${r}. Valid for 10 minutes. Do not share this code.`;try{switch(this.config.sms.provider){case"twilio":return await this.sendTwilioSMS(e,s);case"firebase":return await this.sendFirebaseSMS(e,s);case"aws-sns":return await this.sendAWSSMS(e,s);case"fake":return this.sendFakeSMS(e,s,r);default:throw new Error("Invalid SMS provider configured")}}catch(a){return console.error("SMS sending error:",a),{success:!1,message:"Failed to send SMS verification code",error:a instanceof Error?a.message:"Unknown error"}}}async sendEmailVerification(e,r,n,s){try{switch(this.config.email.provider){case"emailjs":return await this.sendEmailJSVerification(e,r,n,s);case"nodemailer":return await this.sendNodemailerEmail(e,r,n,s);case"firebase":return await this.sendFirebaseEmail(e,r,n,s);case"fake":return this.sendFakeEmail(e,r,n,s);default:throw new Error("Invalid email provider configured")}}catch(a){return console.error("Email sending error:",a),{success:!1,message:"Failed to send email verification code",error:a instanceof Error?a.message:"Unknown error"}}}async sendTwilioSMS(e,r){var s,a;const{twilio:n}=this.config.sms;if(!n)throw new Error("Twilio configuration not provided");try{let i=!1;try{i=!0}catch{try{typeof process<"u"&&(i=!0)}catch{i=!1}}return i&&n.accountSid&&n.authToken?(await(await import("twilio")).default(n.accountSid,n.authToken).messages.create({body:r,from:n.fromNumber,to:e}),{success:!0,message:"SMS sent successfully via Twilio"}):this.sendFakeSMS(e,r,((s=r.match(/(\d{6})/))==null?void 0:s[1])||"123456")}catch(i){return console.warn("Twilio SMS failed, using fake SMS:",i),this.sendFakeSMS(e,r,((a=r.match(/(\d{6})/))==null?void 0:a[1])||"123456")}}async sendFirebaseSMS(e,r){return console.log("Firebase SMS would be sent here:",{phone:e,message:r}),{success:!0,message:"SMS sent successfully via Firebase"}}async sendAWSSMS(e,r){return console.log("AWS SNS SMS would be sent here:",{phone:e,message:r}),{success:!0,message:"SMS sent successfully via AWS SNS"}}sendFakeSMS(e,r,n){return console.log(" FAKE SMS SENT "),console.log(` To: ${e}`),console.log(` Message: ${r}`),console.log(` Code: ${n}`),console.log("Note: In development mode. Configure real SMS provider for production."),typeof window<"u"&&alert(`SMS Verification Code for ${e}: ${n}

(Development Mode - Check console for details)`),{success:!0,message:"SMS sent successfully (Development Mode)"}}async sendEmailJSVerification(e,r,n,s){const{emailjs:a}=this.config.email;if(!a)throw new Error("EmailJS configuration not provided");try{let i=!1;try{i=!0}catch{try{typeof process<"u"&&(i=!0)}catch{i=!1}}return i&&a.serviceId&&a.templateId&&a.publicKey?(await(await import("@emailjs/browser")).send(a.serviceId,a.templateId,{to_email:e,to_name:s,restaurant_name:n,verification_code:r,message:`Your verification code for ${n} is: ${r}. This code will expire in 10 minutes.`},a.publicKey),{success:!0,message:"Email sent successfully via EmailJS"}):this.sendFakeEmail(e,r,n,s)}catch(i){return console.warn("EmailJS failed, using fake email:",i),this.sendFakeEmail(e,r,n,s)}}async sendNodemailerEmail(e,r,n,s){return console.log("Nodemailer email would be sent here:",{email:e,code:r,restaurantName:n,userName:s}),{success:!0,message:"Email sent successfully via Nodemailer"}}async sendFirebaseEmail(e,r,n,s){return console.log("Firebase email would be sent here:",{email:e,code:r,restaurantName:n,userName:s}),{success:!0,message:"Email sent successfully via Firebase"}}sendFakeEmail(e,r,n,s){return console.log(" FAKE EMAIL SENT "),console.log(` To: ${e}`),console.log(` Name: ${s}`),console.log(` Restaurant: ${n}`),console.log(` Code: ${r}`),console.log("Note: In development mode. Configure real email provider for production."),typeof window<"u"&&alert(`Email Verification Code for ${e}: ${r}

(Development Mode - Check console for details)`),{success:!0,message:"Email sent successfully (Development Mode)"}}formatPhoneForSMS(e){const r=e.replace(/\D/g,"");return r.length===10?`+1${r}`:r.length===11&&r.startsWith("1")?`+${r}`:e}isValidEmail(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}isValidPhone(e){return/^\+?[\d\s\-\(\)\.]{10,}$/.test(e)}}const iy={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1};var oy={};const wce={sms:{provider:"fake"},email:{provider:"fake"}},a0=t=>{try{if(iy!=null&&iy[t])return iy[t]}catch{}try{if(typeof process<"u"&&(oy!=null&&oy[t]))return oy[t]}catch{}return""},_ce={sms:{provider:"twilio",twilio:{accountSid:a0("REACT_APP_TWILIO_ACCOUNT_SID"),authToken:a0("REACT_APP_TWILIO_AUTH_TOKEN"),fromNumber:a0("REACT_APP_TWILIO_FROM_NUMBER")}},email:{provider:"emailjs",emailjs:{serviceId:a0("REACT_APP_EMAILJS_SERVICE_ID"),templateId:a0("REACT_APP_EMAILJS_TEMPLATE_ID"),publicKey:a0("REACT_APP_EMAILJS_PUBLIC_KEY")}}},Nce=()=>{let t=!0;try{t=!1}catch{try{typeof process<"u"&&(t=!1)}catch{t=!0}}return t?wce:_ce};class Sce{constructor(){Rr(this,"verificationService");this.verificationService=new bce(Nce())}getCollection(e){return hr(Ke,`restaurants/${e}/gamificationUsers`)}generateDeviceFingerprint(){const e=document.createElement("canvas"),r=e.getContext("2d");r&&(r.textBaseline="top",r.font="14px Arial",r.fillText("Device fingerprint",2,2));const n={userAgent:navigator.userAgent,language:navigator.language,platform:navigator.platform,screenResolution:`${screen.width}x${screen.height}`,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,canvas:e.toDataURL(),timestamp:Date.now()};return btoa(JSON.stringify(n)).slice(0,32)}generateVerificationCode(){return Math.floor(1e5+Math.random()*9e5).toString()}async hashPassword(e){return await m6.hash(e,12)}async verifyPassword(e,r){return await m6.compare(e,r)}validatePhoneNumber(e){const r=e.replace(/\D/g,"");return r.length<10||r.length>15?!1:/^[\d\s\-\(\)\+]+$/.test(e)}validateEmail(e){return/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i.test(e)}async checkSuspiciousActivity(e,r,n,s){const a=this.getCollection(e);try{if(n){const i=br(a,Nr("deviceFingerprint","==",n));if((await Tr(i)).size>3)return{isSuspicious:!0,reason:"Multiple accounts from same device"}}if(s){const i=br(a,Nr("ipAddress","==",s)),l=await Tr(i),c=new Date,u=new Date(c.getTime()-60*60*1e3);if(l.docs.filter(f=>{var g;const h=(g=f.data().createdAt)==null?void 0:g.toDate();return h&&h>=u}).length>2)return{isSuspicious:!0,reason:"Too many accounts from same IP"}}return{isSuspicious:!1}}catch(i){return console.warn("Suspicious activity check failed:",i),{isSuspicious:!1}}}async registerUser(e,r){var n;try{if(!r.name.trim())return{success:!1,message:"Name is required"};if(!this.validatePhoneNumber(r.phone))return{success:!1,message:"Please enter a valid phone number"};if(r.email&&!this.validateEmail(r.email))return{success:!1,message:"Please enter a valid email address"};if(r.password.length<6)return{success:!1,message:"Password must be at least 6 characters long"};if(r.password!==r.confirmPassword)return{success:!1,message:"Passwords do not match"};const s=this.getCollection(e),a=br(s,Nr("phone","==",r.phone));if(!(await Tr(a)).empty)return{success:!1,message:"An account with this phone number already exists"};const l=await this.getClientIP(),c=await this.checkSuspiciousActivity(e,r.phone,r.deviceFingerprint,l);if(c.isSuspicious)return{success:!1,message:`Account creation blocked: ${c.reason}. Please contact support.`};const u=await this.hashPassword(r.password),d=this.generateVerificationCode(),f=new Date(Date.now()+10*60*1e3),m={restaurantId:e,name:r.name.trim(),phone:r.phone,email:((n=r.email)==null?void 0:n.trim())||void 0,passwordHash:u,isVerified:!1,phoneVerified:!1,emailVerified:!1,createdAt:new Date,totalSpins:0,totalWins:0,isBlocked:!1,verificationCode:d,verificationCodeExpiry:f,deviceFingerprint:r.deviceFingerprint,ipAddress:l},g={id:(await sh(s,{...m,createdAt:ft.fromDate(m.createdAt),verificationCodeExpiry:ft.fromDate(f)})).id,...m};try{const p="TenVerse Spin Wheel",v=await this.verificationService.sendSMSVerification(r.phone,d,p);if(v.success||console.warn("SMS sending failed:",v.error),r.email){const b=await this.verificationService.sendEmailVerification(r.email,d,p,r.name);console.log("Email verification result:",b)}}catch(p){console.error("Verification sending error:",p)}return{success:!0,user:g,message:"Account created successfully! Please check your phone for the verification code.",requiresVerification:!0}}catch(s){return console.error("Registration error:",s),{success:!1,message:"Registration failed. Please try again."}}}async loginUser(e,r){var n,s;try{const a=this.getCollection(e),l=this.validateEmail(r.phoneOrEmail)?"email":"phone",c=br(a,Nr(l,"==",r.phoneOrEmail)),u=await Tr(c);if(u.empty)return{success:!1,message:"Invalid phone number/email or password"};const d=u.docs[0],f=d.data(),m={id:d.id,...f,createdAt:f.createdAt.toDate(),lastLoginAt:(n=f.lastLoginAt)==null?void 0:n.toDate(),verificationCodeExpiry:(s=f.verificationCodeExpiry)==null?void 0:s.toDate()};return m.isBlocked?{success:!1,message:"Your account has been blocked. Please contact support."}:await this.verifyPassword(r.password,m.passwordHash)?(await nn(Rt(Ke,`restaurants/${e}/gamificationUsers`,m.id),{lastLoginAt:ft.fromDate(new Date),deviceFingerprint:r.deviceFingerprint}),m.phoneVerified?{success:!0,user:{...m,lastLoginAt:new Date},message:"Login successful!"}:{success:!0,user:m,message:"Please verify your phone number to continue",requiresVerification:!0}):{success:!1,message:"Invalid phone number/email or password"}}catch(a){return console.error("Login error:",a),{success:!1,message:"Login failed. Please try again."}}}async verifyUser(e){var r,n;try{const s=await Gr(Rt(Ke,`restaurants/${e.restaurantId}/gamificationUsers`,e.userId));if(!s.exists())return{success:!1,message:"User not found"};const a=s.data(),i={id:s.id,...a,createdAt:a.createdAt.toDate(),lastLoginAt:(r=a.lastLoginAt)==null?void 0:r.toDate(),verificationCodeExpiry:(n=a.verificationCodeExpiry)==null?void 0:n.toDate()};if(i.verificationCodeExpiry&&new Date>i.verificationCodeExpiry)return{success:!1,message:"Verification code has expired. Please request a new one."};if(i.verificationCode!==e.code)return{success:!1,message:"Invalid verification code"};const l={verificationCode:null,verificationCodeExpiry:null,isVerified:!0};return e.type==="phone"?l.phoneVerified=!0:e.type==="email"&&(l.emailVerified=!0),await nn(Rt(Ke,`restaurants/${e.restaurantId}/gamificationUsers`,e.userId),l),{success:!0,user:{...i,...l},message:"Verification successful!"}}catch(s){return console.error("Verification error:",s),{success:!1,message:"Verification failed. Please try again."}}}async getUserByPhone(e,r){var n,s;try{const a=this.getCollection(e),i=br(a,Nr("phone","==",r)),l=await Tr(i);if(l.empty)return null;const c=l.docs[0],u=c.data();return{id:c.id,...u,createdAt:u.createdAt.toDate(),lastLoginAt:(n=u.lastLoginAt)==null?void 0:n.toDate(),verificationCodeExpiry:(s=u.verificationCodeExpiry)==null?void 0:s.toDate()}}catch(a){return console.error("Error getting user by phone:",a),null}}async getUserById(e,r){var n,s;try{const a=await Gr(Rt(Ke,`restaurants/${e}/gamificationUsers`,r));if(!a.exists())return null;const i=a.data();return{id:a.id,...i,createdAt:i.createdAt.toDate(),lastLoginAt:(n=i.lastLoginAt)==null?void 0:n.toDate(),verificationCodeExpiry:(s=i.verificationCodeExpiry)==null?void 0:s.toDate()}}catch(a){return console.error("Error getting user by ID:",a),null}}async getClientIP(){try{return(await(await fetch("https://api.ipify.org?format=json")).json()).ip||"unknown"}catch{return"unknown"}}async updateUserProfile(e,r){try{const n=hr(Ke,"restaurants"),s=await Tr(n);let a=!1;for(const i of s.docs){const l=Rt(Ke,`restaurants/${i.id}/gamificationUsers`,e);if((await Gr(l)).exists()){await nn(l,{...r,updatedAt:ft.fromDate(new Date)}),a=!0;break}}return a?{success:!0,message:"Profile updated successfully"}:{success:!1,message:"User not found"}}catch(n){return console.error("Error updating user profile:",n),{success:!1,message:"Failed to update profile"}}}async checkUserExists(e,r){try{const n=this.getCollection(e),s=br(n,Nr("phone","==",r)),a=await Tr(s);return a.empty?{exists:!1}:{exists:!0,userId:a.docs[0].id}}catch(n){return console.error("Error checking user existence:",n),{exists:!1}}}async updateUser(e,r,n){try{const s=Rt(Ke,`restaurants/${e}/gamificationUsers`,r),a={...n};return a.lastLoginAt&&(a.lastLoginAt=ft.fromDate(a.lastLoginAt)),a.verificationCodeExpiry&&(a.verificationCodeExpiry=ft.fromDate(a.verificationCodeExpiry)),delete a.id,delete a.createdAt,await nn(s,a),!0}catch(s){return console.error("Error updating user:",s),!1}}async resendVerificationCode(e,r,n){try{const s=await this.getUserById(e,r);if(!s)return{success:!1,message:"User not found"};if(n==="phone"&&s.phoneVerified)return{success:!1,message:"Phone number is already verified"};if(n==="email"&&s.emailVerified)return{success:!1,message:"Email is already verified"};const a=this.generateVerificationCode(),i=new Date(Date.now()+10*60*1e3);await nn(Rt(Ke,`restaurants/${e}/gamificationUsers`,r),{verificationCode:a,verificationCodeExpiry:ft.fromDate(i)});const l="TenVerse Spin Wheel";if(n==="phone"){if(!(await this.verificationService.sendSMSVerification(s.phone,a,l)).success)return{success:!1,message:"Failed to send SMS verification code"}}else if(n==="email"&&s.email){if(!(await this.verificationService.sendEmailVerification(s.email,a,l,s.name)).success)return{success:!1,message:"Failed to send email verification code"}}else return{success:!1,message:"Email not available for this user"};return{success:!0,message:`Verification code sent to your ${n}`}}catch(s){return console.error("Error resending verification code:",s),{success:!1,message:"Failed to resend verification code"}}}async resetPassword(e,r){try{const n=await this.getUserByPhone(e,r);if(!n)return{success:!1,message:"No account found with this phone number"};const s=this.generateVerificationCode(),a=new Date(Date.now()+10*60*1e3);return await nn(Rt(Ke,`restaurants/${e}/gamificationUsers`,n.id),{verificationCode:s,verificationCodeExpiry:ft.fromDate(a)}),(await this.verificationService.sendSMSVerification(r,s,"TenVerse Spin Wheel")).success?{success:!0,message:"Password reset code sent to your phone",user:n}:{success:!1,message:"Failed to send reset code"}}catch(n){return console.error("Error resetting password:",n),{success:!1,message:"Failed to send reset code"}}}async updatePasswordWithCode(e,r,n,s){try{const a=await this.getUserByPhone(e,r);if(!a)return{success:!1,message:"User not found"};if(a.verificationCode!==n)return{success:!1,message:"Invalid reset code"};if(a.verificationCodeExpiry&&new Date>a.verificationCodeExpiry)return{success:!1,message:"Reset code has expired"};if(s.length<6)return{success:!1,message:"Password must be at least 6 characters long"};const i=await this.hashPassword(s);return await nn(Rt(Ke,`restaurants/${e}/gamificationUsers`,a.id),{passwordHash:i,verificationCode:null,verificationCodeExpiry:null}),{success:!0,message:"Password updated successfully",user:{...a,passwordHash:i}}}catch(a){return console.error("Error updating password:",a),{success:!1,message:"Failed to update password"}}}async createPhoneAuthUser(e,r){try{const n=this.getCollection(e),s=await this.getClientIP(),a={restaurantId:e,name:r.name||"Spin Wheel User",phone:r.phone||"",email:r.email||"",passwordHash:r.passwordHash||"phone_auth_user",isVerified:!0,phoneVerified:!0,emailVerified:!1,createdAt:new Date,lastLoginAt:new Date,totalSpins:0,totalWins:0,isBlocked:!1,deviceFingerprint:r.deviceFingerprint||`phone_${r.phone}`,ipAddress:s,...r};return{success:!0,user:{id:(await sh(n,{...a,createdAt:ft.fromDate(a.createdAt),lastLoginAt:ft.fromDate(a.lastLoginAt||new Date)})).id,...a},message:"Phone-authenticated user created successfully!"}}catch(n){return console.error("Phone auth user creation error:",n),{success:!1,message:"Failed to create phone-authenticated user"}}}}const pc=new Sce,Tce=()=>(X.useEffect(()=>{const t=document.createElement("script");return t.src="https://www.phone.email/sign_in_button_v1.js",t.async=!0,document.head.appendChild(t),()=>{document.head.removeChild(t)}},[]),o.jsx("div",{className:"pe_signin_button w-full flex justify-center","data-client-id":"19037279849489128239"}));function Ace({wheelConfig:t,restaurantName:e,onSpinComplete:r}){var qt,jt,$t;const[n,s]=X.useState(!1),[a,i]=X.useState(!1),[l,c]=X.useState(null),[u,d]=X.useState(!1),[f,m]=X.useState(!0),[h,g]=X.useState(t.maxSpinsPerCustomer),[p,v]=X.useState(0),[b,w]=X.useState(!1),[N,j]=X.useState(""),[F,U]=X.useState(null),[A,S]=X.useState(!1),[k,M]=X.useState(null),[I,E]=X.useState(!1),[D,G]=X.useState("login"),[Z,ae]=X.useState(!1),[de,se]=X.useState(!1),[Y,ye]=X.useState(!1),[re]=X.useState(""),[C,O]=X.useState(!1),[L,H]=X.useState(null),[K,q]=X.useState(!1),[te,oe]=X.useState(!1),[V,xe]=X.useState(null),[B,Ee]=X.useState(!1),[Me,Ie]=X.useState(!1),[he,qe]=X.useState([]),[ct,lt]=X.useState(null),[ue,Ne]=X.useState([]),[Ae,Be]=X.useState(!1),Ue=X.useRef(null),{register:Ce,handleSubmit:Ye,formState:{errors:It},reset:Dt}=Hn(),{register:Ot,handleSubmit:Pt,formState:{errors:ht},reset:or}=Hn(),{register:Ve,handleSubmit:tt,formState:{errors:nt},reset:At}=Hn(),{register:mr,handleSubmit:Wt,formState:{errors:Te},reset:je}=Hn();X.useEffect(()=>(St(),window.phoneEmailListener=vt,()=>{window.phoneEmailListener&&delete window.phoneEmailListener}),[]),X.useEffect(()=>{(Z&&k||K&&L)&&(dr(),et())},[Z,k,K,L]);const et=async()=>{var it;if(!(!(L||k)||!(K||Z)||!((it=t.pointsConfig)!=null&&it.enabled)))try{const _t=L?L.phone:k==null?void 0:k.phone;if(!_t)return;const cr=await rd.getCustomerLoyaltyInfo(t.restaurantId,_t);cr.success&&cr.data&&lt(cr.data.loyaltyInfo)}catch(_t){console.error("Error loading initial loyalty info:",_t)}},St=async()=>{const Ze=localStorage.getItem("spinWheelPhoneUser");if(Ze)try{const mt=JSON.parse(Ze),it=new Date(mt.lastAuthenticated);if((new Date().getTime()-it.getTime())/(1e3*60*60)<24){H(mt),q(!0);return}}catch(mt){console.error("Error restoring phone auth session:",mt)}localStorage.removeItem("spinWheelPhoneUser"),O(!0)},vt=async Ze=>{try{const it=await(await fetch(Ze.user_json_url)).json();let _t={country_code:it.user_country_code,phone:it.user_phone_number,firstName:it.user_first_name,lastName:it.user_last_name,fullName:`${it.user_first_name||""} ${it.user_last_name||""}`.trim(),lastAuthenticated:new Date().toISOString()};try{const cr=await ra.searchCustomers(t.restaurantId,_t.phone);if(cr.success&&cr.data&&cr.data.length>0){const Lr=cr.data[0];if(Lr.name&&Lr.name!=="Spin Wheel User"&&Lr.name.trim()!==""){console.log("Found existing customer with name:",Lr.name),_t.fullName=Lr.name;const an=Lr.name.split(" ");_t.firstName=an[0]||_t.firstName,_t.lastName=an.slice(1).join(" ")||_t.lastName}}const xr=await pc.getUserByPhone(t.restaurantId,_t.phone);if(xr&&xr.name&&xr.name!=="Spin Wheel User"&&xr.name.trim()!==""){console.log("Found existing gamification user with name:",xr.name),_t.fullName=xr.name;const Lr=xr.name.split(" ");_t.firstName=Lr[0]||_t.firstName,_t.lastName=Lr.slice(1).join(" ")||_t.lastName}}catch(cr){console.log("Could not fetch existing user data:",cr)}(!_t.fullName||_t.fullName.trim()==="")&&(_t.fullName="Spin Wheel User"),localStorage.setItem("spinWheelPhoneUser",JSON.stringify(_t)),await st(_t),H(_t),q(!0),O(!1),console.log("Phone verified successfully:",_t),fe.success(`Welcome back ${_t.fullName}! `)}catch(mt){console.error("Phone verification failed:",mt),fe.error("Phone verification failed. Please try again.")}},st=async Ze=>{try{const mt={name:Ze.fullName||"Spin Wheel User",phone:Ze.phone,email:"",address:"",preferences:["spin_wheel_user"],totalSpent:0,visitCount:1,lastVisit:new Date},it=await ra.searchCustomers(t.restaurantId,Ze.phone);if(it.success&&it.data&&it.data.length>0){const _t=it.data[0];console.log("Customer already exists in CRM:",_t);const cr={..._t,lastVisit:new Date,visitCount:(_t.visitCount||0)+1,name:Ze.fullName&&Ze.fullName!=="Spin Wheel User"?Ze.fullName:_t.name},xr=await ra.updateCustomer(_t.id,t.restaurantId,cr);xr.success&&console.log("Customer updated in CRM:",xr.data)}else{const _t=await ra.createCustomer(t.restaurantId,mt);_t.success?console.log("User saved to CRM successfully:",_t.data):console.error("Failed to save user to CRM:",_t.error)}await zt(Ze)}catch(mt){console.error("Error saving user to CRM:",mt)}},zt=async Ze=>{try{const mt=await pc.getUserByPhone(t.restaurantId,Ze.phone);if(mt){console.log("Gamification user already exists:",mt);try{const cr={lastLoginAt:new Date,name:Ze.fullName&&Ze.fullName!=="Spin Wheel User"?Ze.fullName:mt.name};pc.updateUser&&(await pc.updateUser(t.restaurantId,mt.id,cr),console.log("Updated existing gamification user login time and name"))}catch(cr){console.log("Could not update existing gamification user:",cr)}return}const it={restaurantId:t.restaurantId,name:Ze.fullName||"Spin Wheel User",phone:Ze.phone,email:"",passwordHash:"phone_auth_user",isVerified:!0,phoneVerified:!0,emailVerified:!1,isBlocked:!1,totalSpins:0,totalWins:0,createdAt:new Date,lastLoginAt:new Date,deviceFingerprint:`phone_${Ze.phone}`,ipAddress:"unknown"},_t=await pc.createPhoneAuthUser(t.restaurantId,it);_t.success?console.log("User saved to Gamification Users successfully:",_t.user):console.error("Failed to save user to Gamification Users:",_t.message)}catch(mt){console.error("Error saving user to Gamification Users:",mt)}},Qt=async Ze=>{if(!(!V||!L))try{const mt={...V,customerName:Ze.name,customerPhone:L.phone,claimedAt:new Date().toISOString()},it=JSON.parse(localStorage.getItem("claimedRewards")||"[]");it.push(mt),localStorage.setItem("claimedRewards",JSON.stringify(it));const _t={...L,fullName:Ze.name,firstName:Ze.name.split(" ")[0]||"",lastName:Ze.name.split(" ").slice(1).join(" ")||""};localStorage.setItem("spinWheelPhoneUser",JSON.stringify(_t)),H(_t),await nr(L.phone,Ze.name),fe.success(` Reward claimed successfully, ${Ze.name}!`),oe(!1),w(!0),je()}catch(mt){console.error("Error claiming reward:",mt),fe.error("Failed to claim reward. Please try again.")}},nr=async(Ze,mt)=>{try{const it=await ra.searchCustomers(t.restaurantId,Ze);if(it.success&&it.data&&it.data.length>0){const _t=it.data[0],cr={..._t,name:mt},xr=await ra.updateCustomer(_t.id,t.restaurantId,cr);xr.success&&console.log("Customer name updated in CRM:",xr.data)}}catch(it){console.error("Error updating customer name:",it)}},dr=async()=>{if(!(!(L||k)||!(K||Z))&&t.maxSpinsPerCustomer!==0)try{const it=L?L.phone:k==null?void 0:k.phone;if(!it)return;const _t=await Ja.getCustomerSpinsCountToday(t.restaurantId,it);if(_t.success&&typeof _t.data=="number"){const cr=_t.data,xr=Math.max(0,t.maxSpinsPerCustomer-cr);g(xr),m(xr>0),console.log(" Spin limit check:",{userPhone:it,spinsToday:cr,maxAllowed:t.maxSpinsPerCustomer,remaining:xr,canSpin:xr>0})}}catch(it){console.error("Error checking spin limit:",it),g(t.maxSpinsPerCustomer||999),m(!0)}},Vr=()=>{const Ze=t.segments.reduce((it,_t)=>it+_t.probability,0);let mt=Math.random()*Ze;for(const it of t.segments)if(mt-=it.probability,mt<=0)return it;return t.segments[0]},Et=Ze=>{const mt=t.segments.findIndex(Lr=>Lr.id===Ze.id),it=360/t.segments.length,_t=mt*it;return(8+Math.random()*5)*360+(360-_t)},qr=()=>{const Ze=t.name.substring(0,3).toUpperCase(),mt=Date.now().toString().slice(-6),it=Math.random().toString(36).substring(2,5).toUpperCase();return`${Ze}${mt}${it}`},Qr=async Ze=>{if(!Z){ye(!0);try{const mt={phoneOrEmail:Ze.phoneOrEmail,password:Ze.password,deviceFingerprint:re},it=await pc.loginUser(t.restaurantId,mt);it.success&&it.user?it.requiresVerification?(M(it.user),G("verify"),fe.error(it.message||"Please verify your account")):(M(it.user),ae(!0),E(!1),localStorage.setItem("gamificationUserId",it.user.id),localStorage.setItem("gamificationToken",it.token||"logged-in"),fe.success("Welcome back! "),Dt()):fe.error(it.message||"Login failed")}catch{fe.error("Login failed. Please try again.")}finally{ye(!1)}}},Wr=async Ze=>{ye(!0);try{const mt={name:Ze.name,phone:Ze.phone,email:Ze.email,password:Ze.password,confirmPassword:Ze.confirmPassword,deviceFingerprint:re},it=await pc.registerUser(t.restaurantId,mt);it.success&&it.user?(M(it.user),it.requiresVerification?(G("verify"),fe.success("Account created! Please verify your phone number.")):(ae(!0),E(!1),localStorage.setItem("gamificationUserId",it.user.id),localStorage.setItem("gamificationToken",it.token||"logged-in"),fe.success("Account created successfully! "),or())):fe.error(it.message||"Registration failed")}catch{fe.error("Registration failed. Please try again.")}finally{ye(!1)}},Nn=async Ze=>{if(k){ye(!0);try{const mt=await pc.verifyUser({userId:k.id,restaurantId:t.restaurantId,code:Ze.code,type:"phone"});mt.success&&mt.user?(M(mt.user),ae(!0),E(!1),localStorage.setItem("gamificationUserId",mt.user.id),localStorage.setItem("gamificationToken","verified"),fe.success("Phone verified successfully! "),At()):fe.error(mt.message||"Verification failed")}catch{fe.error("Verification failed. Please try again.")}finally{ye(!1)}}},ir=async()=>{if(k)try{const Ze=await pc.resendVerificationCode(t.restaurantId,k.id,"phone");Ze.success?fe.success(Ze.message||"Verification code sent successfully"):fe.error(Ze.message||"Failed to send verification code")}catch{fe.error("Failed to resend code")}},ee=()=>{M(null),ae(!1),E(!0),localStorage.removeItem("gamificationUserId"),localStorage.removeItem("gamificationToken"),i(!1),c(null),w(!1),j(""),U(null),S(!1),d(!1),fe.success("Logged out successfully")},be=()=>{if(!f||n||!(K||Z)||!(L||k))return;const it=Vr(),_t=p+Et(it);s(!0),v(_t),setTimeout(async()=>{var xr;s(!1),i(!0),c(it),d(!0);const cr=!(it.rewardType==="custom"&&it.label.toLowerCase().includes("luck"));cr&&(S(!0),setTimeout(()=>S(!1),3e3));try{const Lr={restaurantId:t.restaurantId,spinWheelId:t.id,customerId:L?`phone_user_${L.phone}`:(k==null?void 0:k.id)||"unknown",customerName:L?L.fullName||"Spin Wheel User":(k==null?void 0:k.name)||"User",customerPhone:L?L.phone:(k==null?void 0:k.phone)||"",customerEmail:L?"":(k==null?void 0:k.email)||"",resultSegmentId:it.id,resultMessage:it.value,isRedeemed:!1,ipAddress:"unknown"},an=await Ja.recordCustomerSpin(Lr);an.success&&an.data&&(U(an.data),r==null||r(an.data),g(As=>Math.max(0,As-1)),m(h-1>0),cr&&L&&!L.fullName&&(xe({spinResult:it,spinRecord:an.data,couponCode:qr()}),oe(!0)),(xr=t.pointsConfig)!=null&&xr.enabled&&setTimeout(()=>et(),500),Me&&setTimeout(()=>_e(),700))}catch(Lr){console.error("Error recording spin:",Lr)}},2500)},pe=async()=>{if(!l||!F||!(L||k))return;if(!!(l.rewardType==="custom"&&l.label.toLowerCase().includes("luck"))){fe.error("No reward to claim. Better luck next time!");return}if(L&&!L.fullName){xe({spinResult:l,spinRecord:F,couponCode:qr()}),oe(!0);return}Ee(!0);try{const it=qr();if((await Ja.claimSpinReward(t.restaurantId,F.id,{customerName:L?L.fullName:(k==null?void 0:k.name)||"User",customerPhone:L?L.phone:(k==null?void 0:k.phone)||"",customerEmail:L?"":(k==null?void 0:k.email)||"",couponCode:it})).success){let cr;if(L)cr={id:`phone_user_${L.phone}`,restaurantId:t.restaurantId,name:L.fullName||"Spin Wheel User",phone:L.phone,email:"",passwordHash:"",isVerified:!0,phoneVerified:!0,emailVerified:!1,isBlocked:!1,totalSpins:0,totalWins:0,createdAt:new Date,lastLoginAt:new Date};else if(k)cr=k;else{fe.error("User information not available");return}const xr=await rd.integrateSpinReward(t.restaurantId,cr,l,it,F);xr.success?(j(it),w(!0),fe.success(" Reward claimed and added to systems!"),console.log(" Customer added to CRM and coupon created in coupon dashboard")):(j(it),w(!0),fe.success(" Reward claimed successfully!"),console.warn(" Integration with CRM/Coupon system failed:",xr.error))}else fe.error("Failed to claim reward. Please try again.")}catch(it){console.error("Error claiming reward:",it),fe.error("Something went wrong. Please try again.")}finally{Ee(!1)}},ge=()=>{navigator.clipboard.writeText(N),fe.success("Coupon code copied! ")},we=()=>{i(!1),c(null),w(!1),j(""),U(null),S(!1),d(!1),dr(),Me&&_e()},_e=async()=>{var it,_t,cr,xr,Lr,an,As,ts;if(!(!(L||k)||!(K||Z))){Be(!0);try{const Kr=L?L.phone:k==null?void 0:k.phone;console.log(" Loading dashboard for user:",{phone:Kr,restaurantId:t.restaurantId,authType:L?"phone":"regular"});const En=await Ja.getCustomerSpinsFromRestaurant(t.restaurantId,Kr);if(console.log(" Spin history result:",{success:En.success,dataLength:((it=En.data)==null?void 0:it.length)||0,error:En.error}),En.success&&En.data?(console.log(" Setting spin history:",En.data),qe(En.data)):(console.log(" No spin history or error:",En.error),qe([])),(_t=t.pointsConfig)!=null&&_t.enabled){const dl=await rd.getCustomerLoyaltyInfo(t.restaurantId,Kr);dl.success&&dl.data&&lt(dl.data.loyaltyInfo)}const Es=await rd.getCustomerGamificationHistory(t.restaurantId,Kr);console.log(" Gamification history result:",{success:Es.success,dataExists:!!Es.data,spinsCount:((xr=(cr=Es.data)==null?void 0:cr.spins)==null?void 0:xr.length)||0,couponsCount:((an=(Lr=Es.data)==null?void 0:Lr.coupons)==null?void 0:an.length)||0}),Es.success&&Es.data?(Ne(Es.data.coupons||[]),Es.data.spins&&Es.data.spins.length>0?(console.log(" Using comprehensive gamification history spins"),qe(Es.data.spins)):En.success&&((As=En.data)!=null&&As.length)&&En.data.length>0?(console.log(" Using direct spin history as fallback"),qe(En.data)):F?(console.log(" Using current session spin as fallback"),qe([F])):(console.log(" No spin history found anywhere"),qe([]))):En.success&&((ts=En.data)!=null&&ts.length)&&En.data.length>0?(console.log(" Using direct spin history only"),qe(En.data)):F?(console.log(" Final fallback: current session spin"),qe([F])):(console.log(" No spin data available"),qe([]))}catch(Kr){console.error("Error loading user dashboard:",Kr),fe.error("Failed to load dashboard data")}finally{Be(!1)}}},$e=async()=>{Ie(!0),await _e()},rt=(Ze,mt)=>{const it=2*Math.PI/mt,_t=Ze*it-Math.PI/2,cr=(Ze+1)*it-Math.PI/2,xr=280,Lr=300,an=300,As=Lr+xr*Math.cos(_t),ts=an+xr*Math.sin(_t),Kr=Lr+xr*Math.cos(cr),En=an+xr*Math.sin(cr),Es=it>Math.PI?1:0;return`M ${Lr} ${an} L ${As} ${ts} A ${xr} ${xr} 0 ${Es} 1 ${Kr} ${En} Z`},ze=(Ze,mt)=>{const it=2*Math.PI*Ze/mt+Math.PI/mt-Math.PI/2,_t=180,cr=300+_t*Math.cos(it),xr=300+_t*Math.sin(it),Lr=360/mt*Ze+360/mt/2;return{x:cr,y:xr,rotation:Lr}},We=Ze=>{let mt=Ze.label;if(mt=mt.replace(/\b(Discount|Off|Free|Get|Win|Prize)\b/gi,"").trim(),Ze.rewardType==="discount_percentage"){const _t=Ze.value.match(/(\d+)%/);if(_t)return`${_t[1]}% OFF`}else if(Ze.rewardType==="discount_fixed"){const _t=Ze.value.match(/(\d+)/);if(_t)return`${_t[1]} OFF`}else{if(Ze.rewardType==="free_item")return"FREE ITEM";if(Ze.rewardType==="points"){const _t=Ze.value.match(/(\d+)/);if(_t)return`${_t[1]} PTS`}}const it=10;return mt.length>it?mt.substring(0,it-1)+"":mt.toUpperCase()},Xe=(Ze,mt)=>{const it=mt<=6?16:mt<=8?14:12,_t=Ze.length>8?-2:Ze.length<5?2:0;return Math.max(10,it+_t)},wt=Ze=>{let mt=Ze.value;mt=mt.replace(/\b(You get|You win|Prize:|Reward:)\b/gi,"").trim();const it=12;return mt.length>it?mt.substring(0,it-1)+"":mt},Lt=l&&!(l.rewardType==="custom"&&l.label.toLowerCase().includes("luck"));return o.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-purple-600 via-blue-500 to-indigo-600 relative overflow-hidden",children:[o.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[o.jsx("div",{className:"absolute top-20 left-10 w-8 h-8 bg-white/10 rounded-full animate-float"}),o.jsx("div",{className:"absolute top-40 right-20 w-12 h-12 bg-yellow-400/20 rounded-lg rotate-45 animate-float-delay-1"}),o.jsx("div",{className:"absolute bottom-32 left-32 w-6 h-6 bg-pink-400/20 rounded-full animate-float-delay-2"}),o.jsx("div",{className:"absolute bottom-60 right-40 w-10 h-10 bg-blue-300/20 rounded-lg rotate-12 animate-float-delay-3"}),o.jsx("div",{className:"absolute top-1/4 left-1/4 w-20 h-20 bg-gradient-to-r from-yellow-400/10 to-orange-400/10 rounded-full blur-xl animate-pulse"}),o.jsx("div",{className:"absolute bottom-1/4 right-1/4 w-16 h-16 bg-gradient-to-r from-purple-400/10 to-pink-400/10 rounded-full blur-xl animate-pulse delay-500"})]}),A&&o.jsx("div",{className:"absolute inset-0 pointer-events-none z-50",children:[...Array(15)].map((Ze,mt)=>o.jsx("div",{className:"absolute w-3 h-3 bg-yellow-400 rounded-full animate-ping",style:{top:`${20+Math.random()*60}%`,left:`${20+Math.random()*60}%`,animationDelay:`${Math.random()*1}s`,animationDuration:"1.5s"}},mt))}),o.jsxs("div",{className:"relative z-10 max-w-7xl mx-auto px-4 py-6",children:[o.jsxs("div",{className:"text-center mb-8",children:[(Z&&k||K&&L)&&o.jsx("div",{className:"bg-white/10 backdrop-blur-md rounded-2xl p-4 mb-6 border border-white/20",children:o.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-yellow-400 to-orange-500 rounded-full flex items-center justify-center",children:o.jsx(kc,{className:"w-5 h-5 text-white"})}),o.jsxs("div",{className:"text-left",children:[o.jsx("div",{className:"text-white font-semibold",children:L?L.fullName||"Spin Wheel User":(k==null?void 0:k.name)||"User"}),o.jsx("div",{className:"text-white/70 text-sm",children:L?L.phone:(k==null?void 0:k.phone)||""}),o.jsxs("div",{className:"text-green-400 text-sm font-medium",children:[" ",((qt=ct==null?void 0:ct.currentThreshold)==null?void 0:qt.name)||"Bronze"]})]})]}),o.jsxs("div",{className:"flex items-center space-x-4",children:[t.maxSpinsPerCustomer>0&&o.jsx("div",{className:"bg-blue-500/30 px-4 py-2 rounded-full border border-blue-400/50",children:o.jsxs("span",{className:"text-white text-sm font-semibold",children:[" ",h," spins left"]})}),o.jsxs("button",{onClick:$e,className:"bg-white/20 hover:bg-white/30 px-4 py-2 rounded-xl text-white font-medium transition-all duration-200 flex items-center space-x-2",children:[o.jsx(xd,{className:"w-4 h-4"}),o.jsx("span",{children:"Dashboard"})]}),o.jsx("button",{onClick:()=>{L?(localStorage.removeItem("spinWheelPhoneUser"),H(null),q(!1),O(!0),fe.success("Logged out successfully")):ee()},className:"bg-red-500/20 hover:bg-red-500/30 px-4 py-2 rounded-xl text-white font-medium transition-all duration-200",children:"Logout"})]})]})}),o.jsxs("div",{className:"mb-6",children:[o.jsx("h1",{className:"text-4xl md:text-5xl lg:text-6xl font-bold text-white mb-2",children:e}),o.jsx("div",{className:"h-1 w-24 bg-gradient-to-r from-yellow-400 to-orange-500 mx-auto rounded-full mb-4"}),o.jsx("h2",{className:"text-xl md:text-2xl text-white/90 font-medium",children:t.name})]})]}),o.jsxs("div",{className:"flex flex-col items-center space-y-8",children:[o.jsxs("div",{className:"w-full max-w-md",children:[o.jsxs("div",{className:"relative mb-8",children:[o.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-yellow-400/20 via-orange-500/20 to-yellow-400/20 rounded-full blur-2xl animate-pulse"}),o.jsx("div",{className:"absolute top-0 left-1/2 transform -translate-x-1/2 -translate-y-2 z-20",children:o.jsx("div",{className:"w-0 h-0 border-l-5 border-r-5 border-b-10 border-transparent border-b-white drop-shadow-lg"})}),o.jsx("div",{ref:Ue,className:"relative transition-transform ease-out rounded-full border-4 border-white shadow-2xl overflow-hidden mx-auto",style:{transform:`rotate(${p}deg)`,transitionDuration:n?"4s":"0.5s",transitionTimingFunction:n?"cubic-bezier(0.25, 0.46, 0.45, 0.94)":"ease",width:"480px",height:"480px"},children:o.jsxs("svg",{width:"480",height:"480",viewBox:"0 0 600 600",className:"w-full h-full block",children:[t.segments.map((Ze,mt)=>{const it=ze(mt,t.segments.length);return o.jsxs("g",{children:[o.jsx("path",{d:rt(mt,t.segments.length),fill:Ze.color,stroke:"#ffffff",strokeWidth:"3",className:"drop-shadow-sm"}),o.jsx("g",{transform:`translate(${it.x}, ${it.y}) rotate(${it.rotation})`,children:o.jsx("text",{x:"0",y:"0",textAnchor:"middle",dominantBaseline:"middle",fontSize:Math.max(16,Xe(Ze.label,t.segments.length)+4),fontWeight:"bold",fill:"black",style:{fontFamily:"Inter, sans-serif"},children:We(Ze)})}),o.jsxs("g",{transform:`translate(${300+240*Math.cos(2*Math.PI*mt/t.segments.length+Math.PI/t.segments.length-Math.PI/2)}, ${300+240*Math.sin(2*Math.PI*mt/t.segments.length+Math.PI/t.segments.length-Math.PI/2)})`,children:[o.jsx("circle",{r:"15",fill:"rgba(255,255,255,0.95)",stroke:Ze.color,strokeWidth:"2",className:"drop-shadow-md"}),o.jsx("text",{x:"0",y:"5",textAnchor:"middle",dominantBaseline:"middle",fontSize:"16",children:Ze.rewardType==="discount_percentage"?"":Ze.rewardType==="discount_fixed"?"":Ze.rewardType==="free_item"?"":Ze.rewardType==="points"?"":Ze.label.toLowerCase().includes("luck")?"":""})]})]},Ze.id)}),o.jsx("defs",{children:o.jsxs("radialGradient",{id:"centerGradient",cx:"50%",cy:"50%",r:"50%",children:[o.jsx("stop",{offset:"0%",stopColor:"#fbbf24"}),o.jsx("stop",{offset:"100%",stopColor:"#f59e0b"})]})}),o.jsx("circle",{cx:"300",cy:"300",r:"50",fill:"url(#centerGradient)",stroke:"#ffffff",strokeWidth:"4",className:"drop-shadow-lg"}),o.jsxs("g",{transform:"translate(300, 300)",children:[o.jsx("text",{x:"0",y:"-5",textAnchor:"middle",dominantBaseline:"middle",fontSize:"24",children:""}),o.jsx("text",{x:"0",y:"12",textAnchor:"middle",dominantBaseline:"middle",fontSize:"10",fontWeight:"bold",fill:"white",style:{fontFamily:"Inter, sans-serif"},children:"SPIN"})]})]})})]}),o.jsx("div",{className:"mb-8 w-full flex justify-center",children:o.jsx("button",{onClick:be,disabled:!f||n||!(Z||K),className:`relative px-8 py-4 text-xl font-bold rounded-2xl transition-all duration-200 transform w-full max-w-xs ${f&&!n&&(Z||K)?"bg-gradient-to-r from-yellow-400 to-orange-500 text-white hover:scale-105 shadow-xl":"bg-gray-400 text-gray-700 cursor-not-allowed"} border-2 border-white/20`,children:o.jsx("div",{className:"flex items-center justify-center space-x-3",children:n?o.jsxs(o.Fragment,{children:[o.jsx(Fy,{className:"w-6 h-6 animate-spin"}),o.jsx("span",{children:"Spinning..."})]}):Z||K?f?o.jsxs(o.Fragment,{children:[o.jsx(dK,{className:"w-6 h-6"}),o.jsx("span",{children:"Spin to Win!"})]}):o.jsxs(o.Fragment,{children:[o.jsx(M_,{className:"w-6 h-6"}),o.jsx("span",{children:"No Spins Left"})]}):o.jsxs(o.Fragment,{children:[o.jsx(QR,{className:"w-6 h-6"}),o.jsx("span",{children:"Verify Phone to Spin"})]})})})})]}),!a&&o.jsx("div",{className:"w-full max-w-4xl",children:o.jsxs("div",{className:"bg-white/10 backdrop-blur-md rounded-3xl p-6 border border-white/20",children:[o.jsxs("div",{className:"text-center mb-6",children:[o.jsx(Ia,{className:"w-16 h-16 text-yellow-400 mx-auto mb-4"}),o.jsx("h3",{className:"text-2xl font-bold text-white mb-2",children:"Amazing Rewards Await!"}),o.jsx("p",{className:"text-white/80",children:"Spin the wheel get rewards"})]}),o.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:t.segments.slice(0,4).map((Ze,mt)=>o.jsxs("div",{className:"bg-white/10 backdrop-blur-sm rounded-xl p-4 text-center border border-white/10",children:[o.jsx("div",{className:"w-8 h-8 rounded-full mx-auto mb-2 flex items-center justify-center text-white font-bold text-sm",style:{backgroundColor:Ze.color},children:mt+1}),o.jsx("div",{className:"text-white font-medium text-sm mb-1",children:Ze.label}),o.jsx("div",{className:"text-white/70 text-xs",children:wt(Ze)})]},Ze.id))}),t.segments.length>4&&o.jsx("div",{className:"text-center mt-4",children:o.jsxs("span",{className:"text-white/70 text-sm",children:["+ ",t.segments.length-4," more amazing rewards!"]})})]})})]})]}),u&&l&&o.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:o.jsxs("div",{className:"bg-white rounded-3xl p-8 max-w-md w-full max-h-[90vh] overflow-y-auto relative",children:[B&&o.jsx("div",{className:"absolute inset-0 bg-white/80 backdrop-blur-sm rounded-3xl flex items-center justify-center z-10",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-500 mx-auto mb-4"}),o.jsx("p",{className:"text-gray-600 font-medium",children:"Processing your reward..."}),o.jsx("p",{className:"text-gray-500 text-sm mt-2",children:"Please wait while we generate your coupon"})]})}),o.jsxs("div",{className:"text-center",children:[o.jsxs("div",{className:"mb-6",children:[Lt?o.jsx("div",{className:"w-20 h-20 bg-gradient-to-r from-green-400 to-emerald-500 rounded-full flex items-center justify-center mx-auto mb-4",children:o.jsx(Uv,{className:"w-10 h-10 text-white"})}):o.jsx("div",{className:"w-20 h-20 bg-gradient-to-r from-gray-400 to-gray-500 rounded-full flex items-center justify-center mx-auto mb-4",children:o.jsx(cK,{className:"w-10 h-10 text-white"})}),o.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:Lt?" Congratulations!":" Better Luck Next Time!"}),o.jsx("div",{className:"text-lg font-semibold text-gray-700 mb-2",children:l.label}),o.jsx("div",{className:"text-gray-600",children:l.value})]}),b&&N&&o.jsxs("div",{className:"bg-gradient-to-r from-yellow-50 to-orange-50 border-2 border-yellow-200 rounded-xl p-4 mb-6",children:[o.jsx("div",{className:"text-sm text-gray-600 mb-2",children:"Your Coupon Code"}),o.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[o.jsx("span",{className:"text-xl font-bold text-orange-600 bg-white px-4 py-2 rounded-lg border-2 border-orange-200",children:N}),o.jsx("button",{onClick:ge,className:"bg-orange-500 hover:bg-orange-600 text-white p-2 rounded-lg transition-colors",children:o.jsx(Hu,{className:"w-5 h-5"})})]}),o.jsx("div",{className:"text-xs text-gray-500 mt-2",children:"Show this code to redeem your reward"})]}),o.jsxs("div",{className:"space-y-3",children:[!b&&Lt&&o.jsx("button",{onClick:pe,disabled:B,className:`w-full font-bold py-4 px-6 rounded-xl transition-all duration-200 ${B?"bg-gray-400 cursor-not-allowed":"bg-gradient-to-r from-green-500 to-emerald-600 hover:shadow-lg"} text-white`,children:o.jsx("div",{className:"flex items-center justify-center space-x-2",children:B?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),o.jsx("span",{children:"Claiming Reward..."})]}):o.jsxs(o.Fragment,{children:[o.jsx(Qp,{className:"w-5 h-5"}),o.jsx("span",{children:"Claim Your Reward!"})]})})}),o.jsx("button",{onClick:we,disabled:B,className:`w-full font-bold py-4 px-6 rounded-xl transition-all duration-200 ${B?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-gradient-to-r from-purple-500 to-blue-600 text-white hover:shadow-lg"}`,children:o.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[o.jsx(Fy,{className:"w-5 h-5"}),o.jsx("span",{children:"Spin Again!"})]})}),o.jsx("button",{onClick:()=>d(!1),disabled:B,className:`w-full font-medium py-3 px-6 rounded-xl transition-colors ${B?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:"Close"})]})]})]})}),I&&o.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:o.jsxs("div",{className:"bg-white rounded-3xl p-8 max-w-md w-full max-h-[90vh] overflow-y-auto",children:[o.jsxs("div",{className:"text-center mb-6",children:[o.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-purple-500 to-blue-600 rounded-full flex items-center justify-center mx-auto mb-4",children:o.jsx(kc,{className:"w-8 h-8 text-white"})}),o.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:D==="login"?"Welcome Back!":D==="register"?"Create Account":"Verify Your Phone"}),o.jsx("p",{className:"text-gray-600 mt-2",children:D==="login"?"Sign in to start spinning":D==="register"?"Join the fun and win amazing rewards":"Enter the verification code sent to your phone"})]}),D==="login"&&o.jsxs("form",{onSubmit:Ye(Qr),className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("input",{...Ce("phoneOrEmail",{required:"Phone or email is required"}),type:"text",placeholder:"Phone number or email",className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent"}),It.phoneOrEmail&&o.jsx("p",{className:"text-red-500 text-sm mt-1",children:It.phoneOrEmail.message})]}),o.jsxs("div",{className:"relative",children:[o.jsx("input",{...Ce("password",{required:"Password is required"}),type:de?"text":"password",placeholder:"Password",className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent pr-12"}),o.jsx("button",{type:"button",onClick:()=>se(!de),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500",children:de?o.jsx(zc,{className:"w-5 h-5"}):o.jsx(Ci,{className:"w-5 h-5"})}),It.password&&o.jsx("p",{className:"text-red-500 text-sm mt-1",children:It.password.message})]}),o.jsx("button",{type:"submit",disabled:Y,className:"w-full bg-gradient-to-r from-purple-500 to-blue-600 text-white font-bold py-3 px-6 rounded-xl hover:shadow-lg transition-all duration-200 disabled:opacity-50",children:Y?"Signing In...":"Sign In"}),o.jsx("div",{className:"text-center",children:o.jsx("button",{type:"button",onClick:()=>G("register"),className:"text-purple-600 hover:text-purple-700 font-medium",children:"Don't have an account? Sign up"})})]}),D==="register"&&o.jsxs("form",{onSubmit:Pt(Wr),className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("input",{...Ot("name",{required:"Name is required"}),type:"text",placeholder:"Full name",className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent"}),ht.name&&o.jsx("p",{className:"text-red-500 text-sm mt-1",children:ht.name.message})]}),o.jsxs("div",{children:[o.jsx("input",{...Ot("phone",{required:"Phone number is required"}),type:"tel",placeholder:"Phone number",className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent"}),ht.phone&&o.jsx("p",{className:"text-red-500 text-sm mt-1",children:ht.phone.message})]}),o.jsx("div",{children:o.jsx("input",{...Ot("email"),type:"email",placeholder:"Email (optional)",className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent"})}),o.jsxs("div",{className:"relative",children:[o.jsx("input",{...Ot("password",{required:"Password is required",minLength:{value:6,message:"Password must be at least 6 characters"}}),type:de?"text":"password",placeholder:"Password",className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent pr-12"}),o.jsx("button",{type:"button",onClick:()=>se(!de),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500",children:de?o.jsx(zc,{className:"w-5 h-5"}):o.jsx(Ci,{className:"w-5 h-5"})}),ht.password&&o.jsx("p",{className:"text-red-500 text-sm mt-1",children:ht.password.message})]}),o.jsxs("div",{children:[o.jsx("input",{...Ot("confirmPassword",{required:"Please confirm your password",validate:(Ze,mt)=>Ze===mt.password||"Passwords do not match"}),type:"password",placeholder:"Confirm password",className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent"}),ht.confirmPassword&&o.jsx("p",{className:"text-red-500 text-sm mt-1",children:ht.confirmPassword.message})]}),o.jsx("button",{type:"submit",disabled:Y,className:"w-full bg-gradient-to-r from-purple-500 to-blue-600 text-white font-bold py-3 px-6 rounded-xl hover:shadow-lg transition-all duration-200 disabled:opacity-50",children:Y?"Creating Account...":"Create Account"}),o.jsx("div",{className:"text-center",children:o.jsx("button",{type:"button",onClick:()=>G("login"),className:"text-purple-600 hover:text-purple-700 font-medium",children:"Already have an account? Sign in"})})]}),D==="verify"&&o.jsxs("form",{onSubmit:tt(Nn),className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("input",{...Ve("code",{required:"Verification code is required"}),type:"text",placeholder:"Enter verification code",className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent text-center text-2xl tracking-widest",maxLength:6}),nt.code&&o.jsx("p",{className:"text-red-500 text-sm mt-1",children:nt.code.message})]}),o.jsx("button",{type:"submit",disabled:Y,className:"w-full bg-gradient-to-r from-purple-500 to-blue-600 text-white font-bold py-3 px-6 rounded-xl hover:shadow-lg transition-all duration-200 disabled:opacity-50",children:Y?"Verifying...":"Verify"}),o.jsx("div",{className:"text-center",children:o.jsx("button",{type:"button",onClick:ir,className:"text-purple-600 hover:text-purple-700 font-medium",children:"Didn't receive code? Resend"})})]})]})}),Me&&o.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:o.jsxs("div",{className:"bg-white rounded-3xl p-8 max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[o.jsxs("div",{className:"flex items-center justify-between mb-6",children:[o.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Your Dashboard"}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("button",{onClick:_e,disabled:Ae,className:"bg-blue-500 hover:bg-blue-600 text-white p-2 rounded-xl transition-colors disabled:opacity-50",title:"Refresh Data",children:o.jsx(Fy,{className:`w-5 h-5 ${Ae?"animate-spin":""}`})}),o.jsx("button",{onClick:()=>Ie(!1),className:"bg-gray-200 hover:bg-gray-300 p-2 rounded-xl transition-colors",children:o.jsx(Zn,{className:"w-5 h-5"})})]})]}),Ae?o.jsxs("div",{className:"text-center py-12",children:[o.jsx("div",{className:"animate-spin w-12 h-12 border-4 border-purple-500 border-t-transparent rounded-full mx-auto mb-4"}),o.jsx("p",{className:"text-gray-600",children:"Loading your data..."})]}):o.jsxs("div",{className:"space-y-6",children:[o.jsx("div",{className:"bg-gradient-to-r from-purple-50 to-blue-50 rounded-xl p-6 border border-purple-200",children:o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-purple-500 to-blue-600 rounded-full flex items-center justify-center",children:o.jsx(kc,{className:"w-8 h-8 text-white"})}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-xl font-bold text-gray-900",children:L?L.fullName||"Spin Wheel User":(k==null?void 0:k.name)||"User"}),o.jsx("p",{className:"text-gray-600",children:L?L.phone:(k==null?void 0:k.phone)||""}),ct&&o.jsxs("div",{className:"text-purple-600 font-medium",children:[" ",ct.currentPoints||0," points  ",((jt=ct.currentThreshold)==null?void 0:jt.name)||"Bronze Member"]})]})]})}),o.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[o.jsxs("h3",{className:"text-lg font-bold text-gray-900 mb-4 flex items-center",children:[o.jsx(_i,{className:"w-5 h-5 text-purple-500 mr-2"}),"Spin History (",he.length," spins)"]}),!1,he.length>0?o.jsx("div",{className:"space-y-3 max-h-60 overflow-y-auto",children:he.slice(0,10).map((Ze,mt)=>o.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-xl",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${Ze.resultMessage.toLowerCase().includes("luck")?"bg-gray-400":"bg-gradient-to-r from-green-400 to-emerald-500"}`,children:Ze.resultMessage.toLowerCase().includes("luck")?o.jsx(M_,{className:"w-4 h-4 text-white"}):o.jsx(Ia,{className:"w-4 h-4 text-white"})}),o.jsxs("div",{children:[o.jsx("div",{className:"font-medium text-gray-900",children:Ze.resultMessage}),o.jsx("div",{className:"text-sm text-gray-500",children:new Date(Ze.spinDate).toLocaleDateString()})]})]}),o.jsx("div",{className:`px-3 py-1 rounded-full text-sm font-medium ${Ze.isRedeemed?"bg-green-100 text-green-700":"bg-orange-100 text-orange-700"}`,children:Ze.isRedeemed?"Redeemed":"Pending"})]},mt))}):o.jsxs("div",{className:"text-center py-8",children:[o.jsx(Uv,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),o.jsx("p",{className:"text-gray-500",children:"No spins yet. Start spinning to see your history!"})]})]}),ue.length>0&&o.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[o.jsxs("h3",{className:"text-lg font-bold text-gray-900 mb-4 flex items-center",children:[o.jsx(Qp,{className:"w-5 h-5 text-orange-500 mr-2"}),"Your Coupons"]}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:ue.slice(0,4).map((Ze,mt)=>o.jsxs("div",{className:"bg-gradient-to-r from-orange-50 to-yellow-50 border-2 border-orange-200 rounded-xl p-4",children:[o.jsx("div",{className:"font-bold text-orange-600",children:Ze.code}),o.jsx("div",{className:"text-sm text-gray-600",children:Ze.description}),o.jsxs("div",{className:"text-xs text-gray-500 mt-2",children:["Expires: ",new Date(Ze.expiryDate).toLocaleDateString()]})]},mt))})]})]})]})}),C&&o.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:o.jsxs("div",{className:"bg-white rounded-3xl p-8 max-w-md w-full",children:[o.jsxs("div",{className:"text-center mb-6",children:[o.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-purple-500 to-blue-600 rounded-full flex items-center justify-center mx-auto mb-4",children:o.jsx(Lx,{className:"w-8 h-8 text-white"})}),o.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Verify Your Phone"}),o.jsx("p",{className:"text-gray-600",children:"Please verify your phone number to start spinning"})]}),o.jsx("div",{className:"space-y-4",children:o.jsx(Tce,{})}),o.jsx("p",{className:"text-xs text-gray-500 text-center mt-4",children:"By continuing, you agree to our terms and privacy policy"})]})}),te&&V&&o.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:o.jsxs("div",{className:"bg-white rounded-3xl p-8 max-w-md w-full",children:[o.jsxs("div",{className:"text-center mb-6",children:[o.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-green-500 to-emerald-600 rounded-full flex items-center justify-center mx-auto mb-4",children:o.jsx(Ia,{className:"w-8 h-8 text-white"})}),o.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:" Congratulations!"}),o.jsxs("p",{className:"text-gray-600 mb-4",children:["You won: ",o.jsx("span",{className:"font-semibold text-green-600",children:($t=V.spinResult)==null?void 0:$t.label})]}),o.jsx("p",{className:"text-sm text-gray-500",children:"Please enter your name to claim your reward"})]}),o.jsxs("form",{onSubmit:Wt(Qt),className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"rewardName",className:"block text-sm font-medium text-gray-700 mb-2",children:"Your Name"}),o.jsx("input",{...mr("name",{required:"Name is required",minLength:{value:2,message:"Name must be at least 2 characters"}}),type:"text",id:"rewardName",placeholder:"Enter your full name",className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent"}),Te.name&&o.jsx("p",{className:"text-red-500 text-sm mt-1",children:Te.name.message})]}),o.jsxs("div",{className:"flex space-x-3",children:[o.jsx("button",{type:"button",onClick:()=>{oe(!1),je()},className:"flex-1 bg-gray-200 hover:bg-gray-300 text-gray-700 font-bold py-3 px-6 rounded-xl transition-colors",children:"Skip"}),o.jsx("button",{type:"submit",className:"flex-1 bg-gradient-to-r from-green-500 to-emerald-600 text-white font-bold py-3 px-6 rounded-xl hover:shadow-lg transition-all duration-200",children:"Claim Reward"})]})]}),o.jsx("p",{className:"text-xs text-gray-500 text-center mt-4",children:"Your name will be saved for future rewards"})]})}),o.jsx("style",{children:`
        @keyframes float {
          0%, 100% { transform: translateY(0px) rotate(0deg); }
          50% { transform: translateY(-20px) rotate(10deg); }
        }
        @keyframes float-delay-1 {
          0%, 100% { transform: translateY(0px) rotate(45deg); }
          50% { transform: translateY(-15px) rotate(55deg); }
        }
        @keyframes float-delay-2 {
          0%, 100% { transform: translateY(0px) rotate(0deg); }
          50% { transform: translateY(-25px) rotate(-10deg); }
        }
        @keyframes float-delay-3 {
          0%, 100% { transform: translateY(0px) rotate(12deg); }
          50% { transform: translateY(-18px) rotate(22deg); }
        }
        .animate-float {
          animation: float 6s ease-in-out infinite;
        }
        .animate-float-delay-1 {
          animation: float-delay-1 8s ease-in-out infinite;
        }
        .animate-float-delay-2 {
          animation: float-delay-2 7s ease-in-out infinite;
        }
        .animate-float-delay-3 {
          animation: float-delay-3 9s ease-in-out infinite;
        }
      `})]})}function Ece(){const{slug:t}=px(),[e,r]=X.useState(null),[n,s]=X.useState(""),[a,i]=X.useState(""),[l,c]=X.useState(!0),[u,d]=X.useState(null);X.useEffect(()=>{t&&f()},[t]);const f=async()=>{if(t)try{c(!0);const h=await To.getRestaurantBySlug(t);if(h.success&&h.data){s(h.data.name),i(h.data.id);const g=await Ja.getSpinWheelsForRestaurant(h.data.id);if(g.success&&g.data){const p=g.data.find(v=>v.isActive);p?r(p):d("No active spin wheel found. Please contact the restaurant for more information.")}else d("Unable to load spin wheel. Please try again later.")}else d("Restaurant not found. Please check the URL and try again.")}catch(h){console.error("Error loading spin wheel:",h),d("Something went wrong. Please try again later.")}finally{c(!1)}},m=h=>{fe.success("Spin recorded successfully!")};return l?o.jsx("div",{className:"min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 flex items-center justify-center",children:o.jsxs("div",{className:"text-center",children:[o.jsx(Ed,{className:"w-12 h-12 text-white animate-spin mx-auto mb-4"}),o.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Loading Spin Wheel..."}),o.jsx("p",{className:"text-purple-200",children:"Preparing your game experience"})]})}):u?o.jsx("div",{className:"min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 flex items-center justify-center p-4",children:o.jsxs("div",{className:"max-w-md w-full bg-white/10 backdrop-blur-md rounded-2xl p-8 border border-white/20 text-center",children:[o.jsx($c,{className:"w-16 h-16 text-red-400 mx-auto mb-4"}),o.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"Oops!"}),o.jsx("p",{className:"text-purple-200 mb-6",children:u}),o.jsx("button",{onClick:()=>window.location.reload(),className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Try Again"})]})}):e?o.jsxs("div",{children:[o.jsx(Ace,{wheelConfig:e,restaurantName:n,onSpinComplete:m}),o.jsx("div",{className:"fixed bottom-4 right-4",children:o.jsxs("a",{href:`/${t}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center space-x-2 px-4 py-2 bg-white/20 backdrop-blur-md rounded-lg text-white hover:bg-white/30 transition-colors",children:[o.jsxs("span",{className:"text-sm",children:["Visit ",n," POS"]}),o.jsx(Q2,{className:"w-4 h-4"})]})})]}):o.jsx("div",{className:"min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 flex items-center justify-center p-4",children:o.jsxs("div",{className:"max-w-md w-full bg-white/10 backdrop-blur-md rounded-2xl p-8 border border-white/20 text-center",children:[o.jsx($c,{className:"w-16 h-16 text-yellow-400 mx-auto mb-4"}),o.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"Wheel Not Found"}),o.jsx("p",{className:"text-purple-200 mb-6",children:"No active spin wheel found for this restaurant."})]})})}function Cce(){const[t,e]=X.useState([]),[r,n]=X.useState([]),[s,a]=X.useState(!1),[i,l]=X.useState(!1),[c,u]=X.useState(""),{register:d,handleSubmit:f,formState:{errors:m}}=Hn();X.useEffect(()=>{const j=localStorage.getItem("customerPhone");j&&(u(j),h({phone:j}))},[]);const h=async j=>{a(!0),l(!0),u(j.phone),e([]),n([]);try{const F=await To.getAllActiveRestaurants();if(F.success&&F.data){const U=[],A=[];for(const S of F.data)try{const k=await Ja.getCustomerSpinsFromRestaurant(S.id,j.phone);if(k.success&&k.data&&k.data.length>0){const M=k.data.map(I=>({...I,restaurantName:S.name,restaurantSlug:S.slug}));U.push(...M),A.find(I=>I.id===S.id)||A.push({id:S.id,name:S.name,slug:S.slug})}}catch(k){console.error(`Error fetching spins from ${S.name}:`,k)}U.sort((S,k)=>new Date(k.spinDate).getTime()-new Date(S.spinDate).getTime()),e(U),n(A),U.length===0?fe.error("No spins found for this phone number"):fe.success(`Found ${U.length} spins from ${A.length} restaurants`)}}catch(F){console.error("Error searching spins:",F),fe.error("Failed to search for spins. Please try again.")}finally{a(!1)}},g=j=>{navigator.clipboard.writeText(j),fe.success("Coupon code copied!")},p=j=>new Intl.DateTimeFormat("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(new Date(j)),v=j=>j.isRedeemed?o.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[o.jsx(Ai,{className:"w-3 h-3 mr-1"}),"Redeemed"]}):j.couponCode?o.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:[o.jsx(Qp,{className:"w-3 h-3 mr-1"}),"Claimed"]}):o.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:[o.jsx(Ad,{className:"w-3 h-3 mr-1"}),"Not Claimed"]}),b=t.filter(j=>j.couponCode),w=t.length,N=t.filter(j=>j.isRedeemed).length;return o.jsx("div",{className:"min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900",children:o.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-8",children:[o.jsxs("div",{className:"text-center mb-8",children:[o.jsxs("div",{className:"flex items-center justify-center space-x-2 mb-4",children:[o.jsx(Uv,{className:"w-8 h-8 text-yellow-400"}),o.jsx("h1",{className:"text-4xl font-bold text-white",children:"My Rewards"}),o.jsx(ZR,{className:"w-8 h-8 text-yellow-400"})]}),o.jsx("p",{className:"text-purple-200 text-lg",children:"Track your coupons and rewards from all your favorite restaurants"})]}),o.jsxs("div",{className:"bg-white/10 backdrop-blur-md rounded-2xl p-6 border border-white/20 mb-8",children:[o.jsx("h2",{className:"text-xl font-semibold text-white mb-4",children:"Find Your Rewards"}),o.jsxs("form",{onSubmit:f(h),className:"flex flex-col sm:flex-row gap-4",children:[o.jsxs("div",{className:"flex-1",children:[o.jsxs("div",{className:"relative",children:[o.jsx(Lx,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),o.jsx("input",{type:"tel",...d("phone",{required:"Phone number is required",pattern:{value:/^[\d\s\-\(\)\+]+$/,message:"Please enter a valid phone number"}}),className:"w-full pl-12 pr-4 py-3 text-gray-900 bg-white rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter your phone number",defaultValue:c})]}),m.phone&&o.jsx("p",{className:"text-red-400 text-sm mt-1",children:m.phone.message})]}),o.jsx("button",{type:"submit",disabled:s,className:"px-6 py-3 bg-gradient-to-r from-blue-500 to-purple-600 text-white font-medium rounded-lg hover:shadow-lg transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:s?o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),o.jsx("span",{children:"Searching..."})]}):o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(Eo,{className:"w-4 h-4"}),o.jsx("span",{children:"Search Rewards"})]})})]})]}),i&&o.jsxs(o.Fragment,{children:[w>0&&o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[o.jsx("div",{className:"bg-white/10 backdrop-blur-md rounded-xl p-6 border border-white/20",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-purple-200 text-sm",children:"Total Spins"}),o.jsx("p",{className:"text-3xl font-bold text-white",children:w})]}),o.jsx(Uv,{className:"w-8 h-8 text-yellow-400"})]})}),o.jsx("div",{className:"bg-white/10 backdrop-blur-md rounded-xl p-6 border border-white/20",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-purple-200 text-sm",children:"Claimed Rewards"}),o.jsx("p",{className:"text-3xl font-bold text-white",children:b.length})]}),o.jsx(Qp,{className:"w-8 h-8 text-blue-400"})]})}),o.jsx("div",{className:"bg-white/10 backdrop-blur-md rounded-xl p-6 border border-white/20",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-purple-200 text-sm",children:"Redeemed"}),o.jsx("p",{className:"text-3xl font-bold text-white",children:N})]}),o.jsx(Ai,{className:"w-8 h-8 text-green-400"})]})})]}),r.length>0&&o.jsxs("div",{className:"bg-white/10 backdrop-blur-md rounded-2xl p-6 border border-white/20 mb-8",children:[o.jsx("h3",{className:"text-xl font-semibold text-white mb-4",children:"Your Restaurants"}),o.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:r.map(j=>o.jsxs("div",{className:"bg-white/10 rounded-lg p-4 border border-white/10",children:[o.jsx("h4",{className:"font-medium text-white",children:j.name}),o.jsxs("p",{className:"text-purple-200 text-sm",children:["/",j.slug]}),o.jsxs("p",{className:"text-purple-300 text-xs mt-1",children:[t.filter(F=>F.restaurantId===j.id).length," spins"]})]},j.id))})]}),o.jsxs("div",{className:"bg-white/10 backdrop-blur-md rounded-2xl border border-white/20 overflow-hidden",children:[o.jsxs("div",{className:"p-6 border-b border-white/20",children:[o.jsx("h3",{className:"text-xl font-semibold text-white",children:"Your Rewards History"}),o.jsx("p",{className:"text-purple-200 text-sm mt-1",children:"All your spins and rewards from participating restaurants"})]}),t.length===0?o.jsxs("div",{className:"p-8 text-center",children:[o.jsx(Ia,{className:"w-16 h-16 text-purple-300 mx-auto mb-4"}),o.jsx("h4",{className:"text-lg font-medium text-white mb-2",children:"No rewards found"}),o.jsx("p",{className:"text-purple-200",children:"No spins found for this phone number. Start playing spin the wheel games to earn rewards!"})]}):o.jsx("div",{className:"divide-y divide-white/10",children:t.map(j=>o.jsx("div",{className:"p-6",children:o.jsxs("div",{className:"flex items-start justify-between",children:[o.jsxs("div",{className:"flex-1",children:[o.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[o.jsx("h4",{className:"font-medium text-white",children:j.restaurantName}),v(j)]}),o.jsx("p",{className:"text-purple-200 mb-2",children:j.resultMessage}),j.couponCode&&o.jsx("div",{className:"bg-green-500/20 border border-green-500/40 rounded-lg p-3 mb-3",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-green-300 text-sm font-medium",children:"Coupon Code:"}),o.jsx("p",{className:"text-green-400 font-mono font-bold",children:j.couponCode})]}),o.jsx("button",{onClick:()=>g(j.couponCode),className:"p-2 text-green-400 hover:text-green-300 transition-colors",title:"Copy coupon code",children:o.jsx(Hu,{className:"w-4 h-4"})})]})}),o.jsxs("div",{className:"flex items-center space-x-4 text-sm text-purple-300",children:[o.jsxs("span",{className:"flex items-center space-x-1",children:[o.jsx(X2,{className:"w-4 h-4"}),o.jsx("span",{children:p(j.spinDate)})]}),j.redeemedAt&&o.jsxs("span",{className:"flex items-center space-x-1",children:[o.jsx(Qp,{className:"w-4 h-4"}),o.jsxs("span",{children:["Redeemed ",p(j.redeemedAt)]})]}),j.redeemedAt&&o.jsxs("span",{className:"flex items-center space-x-1",children:[o.jsx(Ai,{className:"w-4 h-4"}),o.jsxs("span",{children:["Redeemed ",p(j.redeemedAt)]})]})]})]}),o.jsx("div",{className:"ml-4",children:o.jsxs("a",{href:`/${j.restaurantSlug}`,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center space-x-1 text-blue-400 hover:text-blue-300 text-sm",children:[o.jsx("span",{children:"Visit Restaurant"}),o.jsx(Q2,{className:"w-3 h-3"})]})})]})},`${j.restaurantId}-${j.id}`))})]})]})]})})}function kce(){return o.jsx(Cce,{})}function p6(){return o.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 flex items-center justify-center p-4",children:o.jsxs("div",{className:"max-w-lg w-full text-center",children:[o.jsxs("div",{className:"mb-8",children:[o.jsx("div",{className:"text-9xl font-bold text-gray-300 mb-4 animate-pulse",children:"404"}),o.jsxs("div",{className:"flex justify-center space-x-2 mb-6",children:[o.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full animate-bounce"}),o.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),o.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})]}),o.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 animate-fade-in",children:[o.jsx("div",{className:"w-16 h-16 mx-auto bg-gray-100 rounded-full flex items-center justify-center mb-6",children:o.jsx(Eo,{className:"w-8 h-8 text-gray-400"})}),o.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Page Not Found"}),o.jsx("p",{className:"text-gray-600 mb-8",children:"The page you're looking for doesn't exist or may have been moved. Let's get you back on track."}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs(AV,{to:"/",className:"w-full btn btn-primary",children:[o.jsx(J2,{className:"w-4 h-4 mr-2"}),"Go to Homepage"]}),o.jsxs("button",{onClick:()=>window.history.back(),className:"w-full btn btn-secondary",children:[o.jsx(gm,{className:"w-4 h-4 mr-2"}),"Go Back"]})]}),o.jsx("div",{className:"mt-8 pt-6 border-t border-gray-200",children:o.jsx("p",{className:"text-sm text-gray-500",children:"Looking for a specific restaurant? Try checking the URL or contact support."})})]}),o.jsxs("div",{className:"mt-8 flex items-center justify-center space-x-3 text-gray-400",children:[o.jsx("div",{className:"w-6 h-6 bg-gradient-to-r from-blue-600 to-blue-700 rounded-lg flex items-center justify-center",children:o.jsx(Cc,{className:"w-4 h-4 text-white"})}),o.jsx("span",{className:"text-sm font-medium",children:"TenVerse POS"})]})]})})}class Ice extends X.Component{constructor(r){super(r);Rr(this,"handleRefresh",()=>{window.location.reload()});Rr(this,"handleGoHome",()=>{window.location.href="/"});this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(r){return{hasError:!0,error:r,errorInfo:null}}componentDidCatch(r,n){console.error("ErrorBoundary caught an error:",r,n),this.setState({error:r,errorInfo:n})}render(){return this.state.hasError?this.props.fallback?this.props.fallback:o.jsx("div",{className:"min-h-screen bg-gradient-to-br from-red-50 to-red-100 flex items-center justify-center p-4",children:o.jsxs("div",{className:"max-w-md w-full bg-white rounded-2xl shadow-xl p-8 text-center animate-fade-in",children:[o.jsx("div",{className:"w-16 h-16 mx-auto bg-red-100 rounded-full flex items-center justify-center mb-6",children:o.jsx(qg,{className:"w-8 h-8 text-red-600"})}),o.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Oops! Something went wrong"}),o.jsx("p",{className:"text-gray-600 mb-6",children:"We're sorry for the inconvenience. An unexpected error occurred while loading the application."}),!1,o.jsxs("div",{className:"space-y-3",children:[o.jsxs("button",{onClick:this.handleRefresh,className:"w-full btn btn-primary",children:[o.jsx(Ox,{className:"w-4 h-4 mr-2"}),"Refresh Page"]}),o.jsxs("button",{onClick:this.handleGoHome,className:"w-full btn btn-secondary",children:[o.jsx(J2,{className:"w-4 h-4 mr-2"}),"Go to Homepage"]})]}),o.jsx("div",{className:"mt-6 pt-6 border-t border-gray-200",children:o.jsx("p",{className:"text-xs text-gray-500",children:"If this problem persists, please contact our support team."})})]})}):this.props.children}}function jce({children:t}){const{isAuthenticated:e,loading:r,user:n,isPinAuthenticated:s}=Xc(),{slug:a}=px();return console.log(" RestaurantProtectedRoute check:",{slug:a,isAuthenticated:e,loading:r,hasUser:!!n,isPinAuthenticated:s,userName:n==null?void 0:n.name}),r?(console.log(" RestaurantProtectedRoute: Still loading..."),o.jsx(CS,{})):e?(console.log(" RestaurantProtectedRoute: Authenticated, allowing access"),o.jsx(o.Fragment,{children:t})):(console.log(" RestaurantProtectedRoute: Not authenticated, redirecting to login"),o.jsx(Mj,{to:`/${a}/login`,replace:!0}))}function Pce(){const t=Wl(),{slug:e}=px();return o.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 flex items-center justify-center p-4",children:o.jsxs("div",{className:"max-w-md w-full bg-white rounded-2xl shadow-xl p-8 text-center",children:[o.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-6",children:o.jsx(qg,{className:"w-8 h-8 text-red-600"})}),o.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Restaurant Not Found"}),o.jsxs("p",{className:"text-gray-600 mb-2",children:['The restaurant "',e,'" could not be found or may be temporarily unavailable.']}),o.jsx("p",{className:"text-sm text-gray-500 mb-8",children:"Please check the URL or contact the restaurant owner for assistance."}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("button",{onClick:()=>t(-1),className:"w-full flex items-center justify-center space-x-2 bg-gray-600 text-white py-3 px-4 rounded-xl font-medium hover:bg-gray-700 transition-colors",children:[o.jsx(gm,{className:"w-4 h-4"}),o.jsx("span",{children:"Go Back"})]}),o.jsxs("button",{onClick:()=>t("/admin/login"),className:"w-full flex items-center justify-center space-x-2 border border-gray-300 text-gray-700 py-3 px-4 rounded-xl font-medium hover:bg-gray-50 transition-colors",children:[o.jsx(J2,{className:"w-4 h-4"}),o.jsx("span",{children:"Admin Portal"})]})]}),o.jsx("div",{className:"mt-8 pt-6 border-t border-gray-200",children:o.jsx("p",{className:"text-xs text-gray-400",children:"Powered by TenVerse POS"})})]})})}function Rce({children:t}){const{restaurant:e,loading:r,error:n}=ya();return r?o.jsx(CS,{}):n||!e?o.jsx(Pce,{}):o.jsx(o.Fragment,{children:t})}function Dce(){const{restaurant:t}=ya(),{user:e,logout:r}=Xc(),n=Wl(),s=Ud(),[a,i]=X.useState(!1),[l,c]=X.useState(!1);if(!t)return null;const u=[{name:"Dashboard",href:`/${t.slug}/dashboard`,icon:J2,current:s.pathname===`/${t.slug}/dashboard`||s.pathname===`/${t.slug}`},{name:"Tables",href:`/${t.slug}/tables`,icon:ni,current:s.pathname===`/${t.slug}/tables`},{name:"Orders",href:`/${t.slug}/orders`,icon:Gg,current:s.pathname===`/${t.slug}/orders`}],d=[{name:"Menu Management",href:`/${t.slug}/menu`,icon:YR,description:"Manage menu items & categories"},{name:"Inventory",href:`/${t.slug}/inventory`,icon:Zi,description:"Track stock & inventory"},{name:"Customers",href:`/${t.slug}/customers`,icon:P_,description:"Manage customer database"},{name:"Coupons",href:`/${t.slug}/coupons`,icon:Ia,description:"Manage coupons & promotions"},{name:"Gamification",href:`/${t.slug}/gamification`,icon:yd,description:"Spin wheel & customer games"},{name:"Kitchen Display",href:`/${t.slug}/kitchen`,icon:Cc,description:"View kitchen orders"},{name:"Analytics",href:`/${t.slug}/analytics`,icon:_i,description:"View performance analytics"},{name:"Settings",href:`/${t.slug}/settings`,icon:Id,description:"Restaurant settings"}],f=h=>{n(h),i(!1),c(!1)},m=async()=>{try{await r(),n(`/${t.slug}/login`)}catch(h){console.error("Logout failed:",h)}};return o.jsxs(o.Fragment,{children:[o.jsx("nav",{className:"bg-white/95 backdrop-blur-md shadow-lg border-b border-gray-200 fixed top-0 left-0 right-0 z-50",children:o.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:o.jsxs("div",{className:"flex justify-between h-16",children:[o.jsx("div",{className:"flex items-center",children:o.jsxs("div",{className:"flex-shrink-0 flex items-center",children:[o.jsx("div",{className:"w-10 h-10 rounded-xl flex items-center justify-center text-white mr-3 shadow-lg",style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"},children:o.jsx(Cc,{className:"w-5 h-5"})}),o.jsxs("div",{className:"hidden sm:block",children:[o.jsx("h1",{className:"text-xl font-bold text-gray-900",children:t.name}),o.jsx("p",{className:"text-xs text-gray-500",children:"Restaurant POS"})]})]})}),o.jsxs("div",{className:"hidden lg:flex items-center space-x-2",children:[u.map(h=>{const g=h.icon;return o.jsxs("button",{onClick:()=>f(h.href),className:`flex items-center px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200 hover:scale-105 ${h.current?"bg-gradient-to-r from-blue-500 to-blue-600 text-white shadow-md transform scale-105":"text-gray-600 hover:text-gray-900 hover:bg-gray-100/80"}`,children:[o.jsx(g,{className:"w-4 h-4 mr-2"}),h.name]},h.name)}),o.jsxs("div",{className:"relative",children:[o.jsxs("button",{onClick:()=>c(!l),className:"flex items-center px-4 py-2 rounded-lg text-sm font-medium text-gray-600 hover:text-gray-900 hover:bg-gray-100/80 transition-all duration-200 hover:scale-105",children:[o.jsx(yd,{className:"w-4 h-4 mr-2"}),"Quick Menu",o.jsx(GG,{className:`w-4 h-4 ml-2 transition-transform duration-200 ${l?"rotate-180":""}`})]}),l&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>c(!1)}),o.jsxs("div",{className:"absolute top-full mt-2 w-80 bg-white rounded-xl shadow-2xl border border-gray-200 py-2 z-20",children:[o.jsxs("div",{className:"px-4 py-2 border-b border-gray-100",children:[o.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Quick Access"}),o.jsx("p",{className:"text-xs text-gray-500",children:"Manage your restaurant operations"})]}),o.jsx("div",{className:"py-2",children:d.map(h=>{const g=h.icon,p=s.pathname===h.href;return o.jsxs("button",{onClick:()=>f(h.href),className:`flex items-start w-full px-4 py-3 text-left hover:bg-gray-50 transition-colors ${p?"bg-blue-50 border-r-2 border-blue-500":""}`,children:[o.jsx(g,{className:`w-5 h-5 mr-3 mt-0.5 flex-shrink-0 ${p?"text-blue-600":"text-gray-400"}`}),o.jsxs("div",{children:[o.jsx("p",{className:`text-sm font-medium ${p?"text-blue-900":"text-gray-900"}`,children:h.name}),o.jsx("p",{className:"text-xs text-gray-500",children:h.description})]})]},h.name)})})]})]})]})]}),o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsxs("div",{className:"hidden xl:block relative",children:[o.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:o.jsx(Eo,{className:"h-4 w-4 text-gray-400"})}),o.jsx("input",{type:"text",placeholder:"Search...",className:"block w-48 pl-10 pr-3 py-2 border border-gray-300 rounded-xl text-sm placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-50"})]}),o.jsx("button",{className:"xl:hidden p-2.5 text-gray-400 hover:text-gray-600 rounded-xl hover:bg-gray-100 transition-colors",children:o.jsx(Eo,{className:"w-5 h-5"})}),o.jsxs("button",{className:"p-2.5 text-gray-400 hover:text-gray-600 rounded-xl hover:bg-gray-100 transition-colors relative",children:[o.jsx(qG,{className:"w-5 h-5"}),o.jsx("div",{className:"absolute -top-1 -right-1 w-3 h-3 bg-red-500 rounded-full"})]}),o.jsxs("div",{className:"hidden md:flex items-center space-x-3 bg-gray-50 rounded-xl px-3 py-2",children:[o.jsxs("div",{className:"text-right",children:[o.jsx("p",{className:"text-sm font-medium text-gray-900",children:(e==null?void 0:e.name)||"User"}),o.jsx("p",{className:"text-xs text-gray-500",children:(e==null?void 0:e.role)||"Staff"})]}),o.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-blue-500 to-blue-600 rounded-lg flex items-center justify-center",children:o.jsx(kc,{className:"w-4 h-4 text-white"})}),o.jsx("button",{onClick:m,className:"p-1.5 text-gray-400 hover:text-red-600 rounded-lg hover:bg-red-50 transition-colors",title:"Logout",children:o.jsx(D_,{className:"w-4 h-4"})})]}),o.jsx("div",{className:"lg:hidden",children:o.jsx("button",{onClick:()=>i(!a),className:"p-2.5 text-gray-600 hover:text-gray-900 rounded-xl hover:bg-gray-100 transition-colors",children:o.jsx(tK,{className:"w-6 h-6"})})})]})]})})}),a&&o.jsxs("div",{className:"lg:hidden fixed inset-0 z-50",children:[o.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm transition-all duration-300",onClick:()=>i(!1)}),o.jsxs("div",{className:"fixed inset-y-0 right-0 w-80 max-w-[85vw] bg-white shadow-2xl transform transition-transform ease-in-out duration-300",children:[o.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:"w-10 h-10 rounded-xl flex items-center justify-center text-white shadow-lg",style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"},children:o.jsx(Cc,{className:"w-5 h-5"})}),o.jsxs("div",{children:[o.jsx("h2",{className:"text-lg font-bold text-gray-900",children:t.name}),o.jsx("p",{className:"text-xs text-gray-500",children:"Restaurant POS"})]})]}),o.jsx("button",{onClick:()=>i(!1),className:"p-2 text-gray-400 hover:text-gray-600 rounded-xl hover:bg-gray-100",children:o.jsx(Zn,{className:"w-6 h-6"})})]}),o.jsxs("div",{className:"px-4 py-6 space-y-2",children:[o.jsxs("div",{className:"mb-6",children:[o.jsx("h3",{className:"text-sm font-semibold text-gray-500 uppercase tracking-wider mb-3 px-2",children:"Main Navigation"}),u.map(h=>{const g=h.icon;return o.jsxs("button",{onClick:()=>f(h.href),className:`flex items-center w-full px-4 py-3 rounded-xl text-sm font-medium transition-all duration-200 ${h.current?"bg-gradient-to-r from-blue-500 to-blue-600 text-white shadow-lg":"text-gray-700 hover:text-gray-900 hover:bg-gray-100"}`,children:[o.jsx(g,{className:"w-5 h-5 mr-3"}),h.name]},h.name)})]}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-sm font-semibold text-gray-500 uppercase tracking-wider mb-3 px-2",children:"Quick Access"}),d.map(h=>{const g=h.icon,p=s.pathname===h.href;return o.jsxs("button",{onClick:()=>f(h.href),className:`flex items-start w-full px-4 py-3 rounded-xl text-sm font-medium transition-all duration-200 ${p?"bg-gradient-to-r from-blue-500 to-blue-600 text-white shadow-lg":"text-gray-700 hover:text-gray-900 hover:bg-gray-100"}`,children:[o.jsx(g,{className:"w-5 h-5 mr-3 mt-0.5"}),o.jsxs("div",{className:"text-left",children:[o.jsx("div",{children:h.name}),o.jsx("div",{className:`text-xs mt-0.5 ${p?"text-blue-100":"text-gray-500"}`,children:h.description})]})]},h.name)})]})]}),o.jsx("div",{className:"px-6 py-4 border-t border-gray-200",children:o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:o.jsx(Eo,{className:"h-4 w-4 text-gray-400"})}),o.jsx("input",{type:"text",placeholder:"Search...",className:"block w-full pl-10 pr-3 py-3 border border-gray-300 rounded-xl text-sm placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})}),o.jsx("div",{className:"px-6 py-4 border-t border-gray-200",children:o.jsxs("div",{className:"flex items-center justify-between bg-gray-50 rounded-xl p-4",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-500 to-blue-600 rounded-xl flex items-center justify-center",children:o.jsx(kc,{className:"w-5 h-5 text-white"})}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-gray-900",children:(e==null?void 0:e.name)||"User"}),o.jsx("p",{className:"text-xs text-gray-500",children:(e==null?void 0:e.role)||"Staff"})]})]}),o.jsx("button",{onClick:m,className:"p-2 text-gray-400 hover:text-red-600 rounded-xl hover:bg-red-50 transition-colors",title:"Logout",children:o.jsx(D_,{className:"w-5 h-5"})})]})})]})]})]})}const Fce=`
  .animation-delay-150 { animation-delay: 150ms; }
  .animation-delay-300 { animation-delay: 300ms; }
  .shadow-3xl { box-shadow: 0 35px 60px -12px rgba(0, 0, 0, 0.25); }
  .hover\\:shadow-3xl:hover { box-shadow: 0 35px 60px -12px rgba(0, 0, 0, 0.35); }
`,Lce=()=>{try{const t=mK();return console.log(" VoiceButton: Voice context available:",!!t),o.jsx(Oce,{...t})}catch{return console.warn("VoiceButton: Voice context not available, hiding button"),null}},Oce=({isSupported:t,hasPermission:e,isListening:r,state:n,transcript:s,requestPermission:a,startListening:i,stopListening:l})=>{const[c,u]=X.useState(!1);X.useEffect(()=>{if(s){u(!0);const v=setTimeout(()=>u(!1),3e3);return()=>clearTimeout(v)}},[s]);const d=async()=>{!e&&await a()},f=()=>{if(!t){Xr.error("Voice commands not supported in this browser.");return}if(n==="processing"||n==="executing"){Xr("Please wait, processing previous command...",{icon:""});return}i()},m=()=>{r&&l()},h=()=>{switch(n){case"listening":return"bg-red-500 hover:bg-red-600 shadow-red-500/50";case"processing":return"bg-blue-500 hover:bg-blue-600 shadow-blue-500/50";case"executing":return"bg-green-500 hover:bg-green-600 shadow-green-500/50";case"error":return"bg-orange-500 hover:bg-orange-600 shadow-orange-500/50";default:return r?"bg-red-500 hover:bg-red-600 shadow-red-500/50":"bg-gray-700 hover:bg-gray-600 shadow-gray-500/50"}},g=()=>{switch(n){case"listening":return o.jsx(Xp,{className:"h-8 w-8 text-white drop-shadow-lg animate-pulse"});case"processing":return o.jsx(Ed,{className:"h-8 w-8 text-white drop-shadow-lg animate-spin"});case"executing":return o.jsx(WG,{className:"h-8 w-8 text-white drop-shadow-lg animate-bounce"});case"error":return o.jsx(rK,{className:"h-8 w-8 text-white drop-shadow-lg"});default:return r?o.jsx(Xp,{className:"h-8 w-8 text-white drop-shadow-lg animate-pulse"}):o.jsx(Xp,{className:"h-8 w-8 text-white drop-shadow-lg hover:scale-110 transition-transform duration-200"})}},p=()=>{switch(n){case"listening":return"Recording... (Release to send)";case"processing":return"Processing...";case"executing":return"Executing...";case"error":return"Error";default:return"Hold to record"}};return!t||!zg.isSupported()?null:o.jsxs(o.Fragment,{children:[o.jsx("style",{children:Fce}),o.jsxs("div",{className:"fixed bottom-28 right-4 lg:bottom-6 lg:right-6 z-50",children:[c&&s&&o.jsx("div",{className:"absolute bottom-24 right-0 mb-2 max-w-xs animate-in slide-in-from-bottom-2 duration-300",children:o.jsxs("div",{className:"bg-gray-900/95 backdrop-blur-md text-white text-sm rounded-xl px-4 py-3 shadow-2xl border border-gray-700/50",children:[o.jsx("div",{className:"text-xs text-gray-400 mb-1 font-medium",children:"You said:"}),o.jsx("div",{className:"font-medium leading-relaxed",children:s}),o.jsx("div",{className:"absolute -bottom-1 right-8 w-3 h-3 bg-gray-900/95 border-r border-b border-gray-700/50 transform rotate-45"})]})}),n!=="idle"&&o.jsx("div",{className:"absolute -top-10 left-1/2 transform -translate-x-1/2 whitespace-nowrap animate-in fade-in-0 duration-200",children:o.jsx("div",{className:"bg-gray-900/95 backdrop-blur-md text-white text-xs px-4 py-2 rounded-full shadow-xl border border-gray-700/50 font-medium",children:p()})}),o.jsxs("button",{onMouseDown:e?f:d,onMouseUp:m,onMouseLeave:m,onTouchStart:e?f:d,onTouchEnd:m,disabled:!t,className:`
            relative h-20 w-20 rounded-full shadow-2xl transition-all duration-300 transform
            ${h()}
            ${r?"ring-4 ring-red-300 ring-opacity-50 scale-110":""}
            active:scale-95 focus:outline-none focus:ring-4 focus:ring-blue-300 focus:ring-opacity-50
            backdrop-blur-lg border-2 border-white/30
            hover:shadow-3xl hover:scale-105
            before:absolute before:inset-0 before:rounded-full before:bg-gradient-to-r 
            before:from-white/20 before:to-transparent before:opacity-50
            select-none
          `,style:{background:n==="listening"||r?"linear-gradient(135deg, #ef4444 0%, #dc2626 50%, #b91c1c 100%)":n==="processing"?"linear-gradient(135deg, #3b82f6 0%, #2563eb 50%, #1d4ed8 100%)":n==="executing"?"linear-gradient(135deg, #10b981 0%, #059669 50%, #047857 100%)":"linear-gradient(135deg, #6366f1 0%, #4f46e5 50%, #4338ca 100%)"},"aria-label":"Voice command button - Hold to record",children:[r&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"absolute inset-0 rounded-full bg-red-400 animate-ping opacity-30"}),o.jsx("div",{className:"absolute inset-2 rounded-full bg-red-300 animate-ping opacity-20 animation-delay-150"}),o.jsx("div",{className:"absolute inset-4 rounded-full bg-red-200 animate-ping opacity-10 animation-delay-300"})]}),o.jsx("div",{className:"absolute inset-1 rounded-full bg-gradient-to-b from-white/30 to-transparent opacity-60"}),o.jsx("div",{className:"relative z-10 flex items-center justify-center h-full w-full",children:g()}),o.jsx("div",{className:"absolute -inset-1 rounded-full bg-gradient-to-r from-white/20 to-white/5 opacity-50 blur-sm"})]})]})]})},Mce=({showDetails:t=!1,className:e=""})=>{const[r,n]=X.useState({connected:!0,retryCount:0}),[s,a]=X.useState(!1),[i,l]=X.useState(new Date);X.useEffect(()=>{c();const g=setInterval(()=>{c()},1e4);return()=>clearInterval(g)},[]);const c=()=>{const g=PG();n(g),l(new Date)},u=async()=>{a(!0);try{console.log(" Connection retry requested - refreshing page..."),setTimeout(()=>{window.location.reload()},500)}catch(g){console.error("Manual retry failed:",g)}finally{}},d=async()=>{a(!0);try{await jG(),c()}catch(g){console.error("Connection check failed:",g)}finally{a(!1)}};if(!t&&r.connected)return null;const f=()=>s?o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-current"}):r.connected?o.jsx(Ai,{className:"w-4 h-4 text-green-500"}):r.retryCount>0?o.jsx($c,{className:"w-4 h-4 text-yellow-500"}):o.jsx(uK,{className:"w-4 h-4 text-red-500"}),m=()=>s?"Checking connection...":r.connected?"Connected":r.retryCount>0?`Retrying (${r.retryCount})`:"Connection issue",h=()=>r.connected?"text-green-600 bg-green-50 border-green-200":r.retryCount>0?"text-yellow-600 bg-yellow-50 border-yellow-200":"text-red-600 bg-red-50 border-red-200";return o.jsxs("div",{className:`${e}`,children:[t?o.jsxs("div",{className:`inline-flex items-center px-3 py-2 rounded-lg border text-sm ${h()}`,children:[f(),o.jsx("span",{className:"ml-2",children:m()}),!r.connected&&!s&&o.jsx("button",{onClick:u,className:"ml-3 px-2 py-1 text-xs bg-current bg-opacity-10 rounded hover:bg-opacity-20 transition-colors",children:"Refresh"}),r.connected&&o.jsx("button",{onClick:d,className:"ml-3 px-2 py-1 text-xs bg-current bg-opacity-10 rounded hover:bg-opacity-20 transition-colors",children:"Check"})]}):o.jsxs("div",{className:`inline-flex items-center px-2 py-1 rounded text-xs ${h()}`,children:[f(),o.jsx("span",{className:"ml-1",children:m()})]}),t&&o.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Last checked: ",i.toLocaleTimeString()]})]})};function Vce(){return o.jsxs("div",{className:"min-h-screen bg-gray-50",children:[o.jsx(Dce,{}),o.jsx("main",{className:"pt-16",children:o.jsx(mV,{})}),o.jsx(Lce,{}),o.jsx("div",{className:"fixed bottom-4 left-4 z-40",children:o.jsx(Mce,{})})]})}function Bce(){return X.useEffect(()=>{const t=async()=>{console.log(" TenVerse POS initialized successfully"),To.clearAllSubscriptions(),To.clearAllQueries(),HR()},e=r=>{var n,s,a,i;((s=(n=r.error)==null?void 0:n.message)!=null&&s.includes("INTERNAL ASSERTION FAILED")||(i=(a=r.error)==null?void 0:a.message)!=null&&i.includes("Unexpected state"))&&(console.error(" Global: Firestore assertion failure detected"),console.log(" Global: Auto-refreshing page to fix corrupted state..."),setTimeout(()=>{window.location.reload()},1e3))};return window.addEventListener("error",e),t(),()=>{window.removeEventListener("error",e)}},[]),o.jsx(Ice,{children:o.jsxs(NV,{children:[o.jsx(yB,{position:"top-right",gutter:12,containerStyle:{top:20,right:20},toastOptions:{duration:2500,style:{background:"rgba(31, 41, 55, 0.95)",color:"#fff",fontSize:"14px",fontWeight:"500",padding:"12px 16px",borderRadius:"12px",boxShadow:"0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)",backdropFilter:"blur(8px)",border:"1px solid rgba(255, 255, 255, 0.1)",maxWidth:"350px",wordWrap:"break-word"},success:{duration:2e3,style:{background:"rgba(16, 185, 129, 0.95)",color:"#fff",border:"1px solid rgba(34, 197, 94, 0.3)"},iconTheme:{primary:"#fff",secondary:"rgba(16, 185, 129, 0.95)"}},error:{duration:3500,style:{background:"rgba(239, 68, 68, 0.95)",color:"#fff",border:"1px solid rgba(248, 113, 113, 0.3)"},iconTheme:{primary:"#fff",secondary:"rgba(239, 68, 68, 0.95)"}},loading:{duration:1/0,style:{background:"rgba(59, 130, 246, 0.95)",color:"#fff",border:"1px solid rgba(96, 165, 250, 0.3)"},iconTheme:{primary:"#fff",secondary:"rgba(59, 130, 246, 0.95)"}}}}),o.jsxs(cA,{children:[o.jsx(ss,{path:"/admin/login",element:o.jsx(LK,{})}),o.jsx(ss,{path:"/admin/dashboard",element:o.jsx(OK,{})}),o.jsx(ss,{path:"/my-rewards",element:o.jsx(kce,{})}),o.jsx(ss,{path:"/",element:o.jsx(Mj,{to:"/admin/login",replace:!0})}),o.jsx(ss,{path:"/:slug/*",element:o.jsx(LG,{children:o.jsx(OG,{children:o.jsx(hK,{children:o.jsx(Rce,{children:o.jsxs(cA,{children:[o.jsx(ss,{path:"login",element:o.jsx(VK,{})}),o.jsx(ss,{path:"spin-wheel",element:o.jsx(Ece,{})}),o.jsxs(ss,{path:"/*",element:o.jsx(jce,{children:o.jsx(Vce,{})}),children:[o.jsx(ss,{path:"",element:o.jsx(wC,{})}),o.jsx(ss,{path:"dashboard",element:o.jsx(wC,{})}),o.jsx(ss,{path:"tables",element:o.jsx($K,{})}),o.jsx(ss,{path:"menu",element:o.jsx(Zie,{})}),o.jsx(ss,{path:"inventory",element:o.jsx(ooe,{})}),o.jsx(ss,{path:"orders",element:o.jsx(tce,{})}),o.jsx(ss,{path:"settings",element:o.jsx(rce,{})}),o.jsx(ss,{path:"customers",element:o.jsx(nce,{})}),o.jsx(ss,{path:"coupons",element:o.jsx(sce,{})}),o.jsx(ss,{path:"gamification",element:o.jsx(ace,{})}),o.jsx(ss,{path:"order/:tableId",element:o.jsx(GK,{})})]}),o.jsx(ss,{path:"*",element:o.jsx(p6,{})})]})})})})})}),o.jsx(ss,{path:"*",element:o.jsx(p6,{})})]})]})})}Xw.createRoot(document.getElementById("root")).render(o.jsx(mi.StrictMode,{children:o.jsx(Bce,{})}));export{yn as _,$ce as c,Y7 as g};
